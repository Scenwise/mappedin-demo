import{a as p,p as e,w as S}from"./chunk-UIGDSWPH-74DChMva.js";import{S as k,a as N,b as C,c as T,f as w,g as b,d as _}from"./select-CqISuW9W.js";import{c as v,V as j,Y as L}from"./index-CTgVHcLT.js";import{B as M}from"./button-D-wuaAT5.js";import{T as E,m as V,b as B}from"./tooltip-Cbn8UTTp.js";import{P as F}from"./PageHeader-DI9xyjIr.js";import{A as P}from"./AppContext-CqorEOdR.js";import"./index-Boai_r5o.js";import"./Combination-D4JSXCMs.js";const z=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M12 2v3",key:"qbqxhf"}],["path",{d:"M18.89 13.24a7 7 0 0 0-8.13-8.13",key:"1v9jrh"}],["path",{d:"M19 12h3",key:"osuazr"}],["path",{d:"M2 12h3",key:"1wrr53"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M7.05 7.05a7 7 0 0 0 9.9 9.9",key:"rc5l2e"}]],D=v("locate-off",z);const I=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}]],q=v("locate",I);function u({location:c,onLocationSelect:r}){const{mapData:o}=j(),i=o.getByType("floor").sort((t,a)=>t.elevation-a.elevation),l=o.getByType("space").filter(({name:t})=>t.length),n=i.map(t=>({floor:t,spaces:l.filter(a=>a.floor.id===t.id).sort((a,s)=>a.name.localeCompare(s.name))})),[m,d]=p.useState(c?.__type==="space"?c.id:" "),[x,f]=p.useState(c?.__type==="coordinate"?c:void 0);function y(t){d(t),f(void 0);const a=l.find(({id:s})=>s===t);a&&r(a)}const[h,g]=p.useState(!1);return L("click",({spaces:t,coordinate:a})=>{h&&(t.length?y(t[0].id):(d(" "),f(a),r(a)),g(!1))}),e.jsxs("div",{className:"flex items-center gap-2 w-full *:min-w-0",children:[e.jsxs(k,{value:m,onValueChange:y,children:[e.jsx(N,{className:"grow",children:e.jsx(C,{placeholder:"Select a space",className:"truncate",children:x?x.latitude+" "+x.longitude:l.find(({id:t})=>t===m)?.name})}),e.jsx(T,{children:n.map(({floor:t,spaces:a})=>e.jsxs(w,{children:[e.jsx(b,{children:t.name}),a.map(s=>e.jsx(_,{value:s.id,children:s.name},s.id))]},t.id))})]}),e.jsxs(E,{children:[e.jsx(V,{asChild:!0,children:e.jsx(M,{size:"icon",variant:"ghost",className:"size-8 shrink-0",onClick:()=>g(!h),children:h?e.jsx(D,{}):e.jsx(q,{})})}),e.jsx(B,{side:"right",children:"Select on map"})]})]})}const Q=S(function(){const{mapData:r,mapView:o}=j(),{navigationFrom:i,setNavigationFrom:l,navigationTo:n,setNavigationTo:m}=p.useContext(P);return p.useEffect(()=>{if(i&&n){const d=r.getDirections(i,n);if(!d)return;o.Navigation.clear(),o.Navigation.draw(d)}},[i,n,r,o.Navigation]),e.jsxs(e.Fragment,{children:[e.jsx(F,{title:"Navigation"}),e.jsxs("div",{className:"space-y-2 py-2",children:[e.jsx(u,{location:i,onLocationSelect:l}),e.jsx(u,{location:n,onLocationSelect:m})]})]})});export{Q as default};
