const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browser-6HMQAV4T-CLXjAgkv.js","assets/chunk-C37GKA54-Cea7C6Y9.js","assets/index-Ctv2K4ti.js","assets/dist-NFOUUHU5-BRD2siaB.js","assets/internal-A2RG32A3-BonDX0_Z.js","assets/text3d-ZRYODT3I-DACctRDC.js","assets/GLTFExporter-W4OR66GG-BecVXK8V.js","assets/GLTFLoader-CWW4SC4X-DhEbA_HU.js","assets/outdoor-context-v4-FKKIRNTV-BEC-Mt9T.js","assets/inspector-DPNZIY36-C9OE4xoN.js"])))=>i.map(i=>d[i]);
import{a as Jt,R as Cy,p as R2}from"./chunk-C37GKA54-Cea7C6Y9.js";import{a as Vue}from"./index-Ctv2K4ti.js";const jue="modulepreload",Gue=function(i){return"/"+i},M6={},_h=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){let u=function(h){return Promise.all(h.map(d=>Promise.resolve(d).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),s=o?.nonce||o?.getAttribute("nonce");r=u(t.map(h=>{if(h=Gue(h),h in M6)return;M6[h]=!0;const d=h.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${f}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":jue,d||(m.as="script"),m.crossOrigin="",m.href=h,s&&m.setAttribute("nonce",s),document.head.appendChild(m),d)return new Promise((v,b)=>{m.addEventListener("load",v),m.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${h}`)))})}))}function a(o){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return r.then(o=>{for(const s of o||[])s.status==="rejected"&&a(s.reason);return e().catch(a)})};var $ue=Object.create,C6=Object.freeze,kg=Object.defineProperty,Hue=Object.defineProperties,Wue=Object.getOwnPropertyDescriptor,que=Object.getOwnPropertyDescriptors,Xue=Object.getOwnPropertyNames,O2=Object.getOwnPropertySymbols,Zue=Object.getPrototypeOf,AP=Object.prototype.hasOwnProperty,U8=Object.prototype.propertyIsEnumerable,B_=(i,e)=>(e=Symbol[i])?e:Symbol.for("Symbol."+i),SP=i=>{throw TypeError(i)},kM=(i,e,t)=>e in i?kg(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Me=(i,e)=>{for(var t in e||(e={}))AP.call(e,t)&&kM(i,t,e[t]);if(O2)for(var t of O2(e))U8.call(e,t)&&kM(i,t,e[t]);return i},lt=(i,e)=>Hue(i,que(e)),l=(i,e)=>kg(i,"name",{value:e,configurable:!0}),oTe=i=>typeof i=="symbol"?i:i+"",Sc=(i,e)=>{var t={};for(var n in i)AP.call(i,n)&&e.indexOf(n)<0&&(t[n]=i[n]);if(i!=null&&O2)for(var n of O2(i))e.indexOf(n)<0&&U8.call(i,n)&&(t[n]=i[n]);return t},Yue=(i,e)=>()=>(i&&(e=i(i=0)),e),Et=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),xh=(i,e)=>{for(var t in e)kg(i,t,{get:e[t],enumerable:!0})},Jue=(i,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Xue(e))!AP.call(i,r)&&r!==t&&kg(i,r,{get:()=>e[r],enumerable:!(n=Wue(e,r))||n.enumerable});return i},ii=(i,e,t)=>(t=i!=null?$ue(Zue(i)):{},Jue(e||!i||!i.__esModule?kg(t,"default",{value:i,enumerable:!0}):t,i)),D=(i,e,t)=>kM(i,typeof e!="symbol"?e+"":e,t),MP=(i,e,t)=>e.has(i)||SP("Cannot "+t),y=(i,e,t)=>(MP(i,e,"read from private field"),t?t.call(i):e.get(i)),ge=(i,e,t)=>e.has(i)?SP("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),Ce=(i,e,t,n)=>(MP(i,e,"write to private field"),e.set(i,t),t),St=(i,e,t)=>(MP(i,e,"access private method"),t),sTe=(i,e)=>C6(kg(i,"raw",{value:C6(e||i.slice())})),V8=function(i,e){this[0]=i,this[1]=e},lTe=(i,e,t)=>{var n=(o,s,u,h)=>{try{var d=t[o](s),f=(s=d.value)instanceof V8,m=d.done;Promise.resolve(f?s[0]:s).then(v=>f?n(o==="return"?o:"next",s[1]?{done:v.done,value:v.value}:v,u,h):u({value:v,done:m})).catch(v=>n("throw",v,u,h))}catch(v){h(v)}},r=o=>a[o]=s=>new Promise((u,h)=>n(o,s,u,h)),a={};return t=t.apply(i,e),a[B_("asyncIterator")]=()=>a,r("next"),r("throw"),r("return"),a},uTe=i=>{var e=i[B_("asyncIterator")],t=!1,n,r={};return e==null?(e=i[B_("iterator")](),n=a=>r[a]=o=>e[a](o)):(e=e.call(i),n=a=>r[a]=o=>{if(t){if(t=!1,a==="throw")throw o;return o}return t=!0,{done:!1,value:new V8(new Promise(s=>{var u=e[a](o);u instanceof Object||SP("Object expected"),s(u)}),1)}}),r[B_("iterator")]=()=>r,n("next"),"throw"in e?n("throw"):r.throw=a=>{throw a},"return"in e&&n("return"),r},mr,R=Yue(()=>{mr={env:{NODE_ENV:"production",npm_package_version:"6.0.1-beta.53"}}});R();var CP="173",sS={LEFT:0,MIDDLE:1,RIGHT:2},Kue=0,E6=1,Que=2,j8=1,ehe=2,Fu=3,su=0,Eo=1,Go=2,Ic=0,Dm=1,I6=2,T6=3,P6=4,the=5,Fp=100,ihe=101,nhe=102,rhe=103,ahe=104,ohe=200,she=201,lhe=202,uhe=203,RM=204,OM=205,hhe=206,che=207,phe=208,dhe=209,fhe=210,mhe=211,ghe=212,yhe=213,vhe=214,NM=0,FM=1,BM=2,eg=3,zM=4,UM=5,VM=6,jM=7,EP=0,_he=1,xhe=2,Tc=0,bhe=1,whe=2,Ahe=3,She=4,Mhe=5,Che=6,Ehe=7,L6="attached",Ihe="detached",G8=300,tg=301,ig=302,N2=303,GM=304,Uw=306,fl=1e3,Zp=1001,$M=1002,ms=1003,The=1004,L0=1005,Yl=1006,lS=1007,Yp=1008,vl=1009,$8=1010,H8=1011,Kv=1012,IP=1013,Rc=1014,hs=1015,G1=1016,TP=1017,PP=1018,ng=1020,W8=35902,q8=1021,X8=1022,ao=1023,Z8=1024,Y8=1025,km=1026,rg=1027,LP=1028,Vw=1029,J8=1030,DP=1031,kP=1033,z_=33776,U_=33777,V_=33778,j_=33779,HM=35840,WM=35841,qM=35842,XM=35843,ZM=36196,YM=37492,JM=37496,KM=37808,QM=37809,eC=37810,tC=37811,iC=37812,nC=37813,rC=37814,aC=37815,oC=37816,sC=37817,lC=37818,uC=37819,hC=37820,cC=37821,G_=36492,pC=36494,dC=36495,K8=36283,fC=36284,mC=36285,gC=36286,F2=2300,yC=2301,uS=2302,D6=2400,k6=2401,R6=2402,Phe=2500,Lhe=0,Dhe=1,O6=2,khe=3200,Rhe=3201,RP=0,Ohe=1,bc="",io="srgb",pd="srgb-linear",B2="linear",Jn="srgb",ih=7680,hS=7681,Nhe=517,vC=519,Fhe=512,Bhe=513,zhe=514,Q8=515,Uhe=516,Vhe=517,jhe=518,Ghe=519,_C=35044,hTe=35048,xC="300 es",lh=2e3,z2=2001,e7=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){let n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){let n=this._listeners;if(n===void 0)return;let r=n[e];if(r!==void 0){let a=r.indexOf(t);a!==-1&&r.splice(a,1)}}dispatchEvent(e){let t=this._listeners;if(t===void 0)return;let n=t[e.type];if(n!==void 0){e.target=this;let r=n.slice(0);for(let a=0,o=r.length;a<o;a++)r[a].call(this,e);e.target=null}}};l(e7,"EventDispatcher");var Rg=e7,Za=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],N6=1234567,Rm=Math.PI/180,ag=180/Math.PI;function gs(){let i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Za[i&255]+Za[i>>8&255]+Za[i>>16&255]+Za[i>>24&255]+"-"+Za[e&255]+Za[e>>8&255]+"-"+Za[e>>16&15|64]+Za[e>>24&255]+"-"+Za[t&63|128]+Za[t>>8&255]+"-"+Za[t>>16&255]+Za[t>>24&255]+Za[n&255]+Za[n>>8&255]+Za[n>>16&255]+Za[n>>24&255]).toLowerCase()}l(gs,"generateUUID");function sn(i,e,t){return Math.max(e,Math.min(t,i))}l(sn,"clamp");function jw(i,e){return(i%e+e)%e}l(jw,"euclideanModulo");function t7(i,e,t,n,r){return n+(i-e)*(r-n)/(t-e)}l(t7,"mapLinear");function i7(i,e,t){return i!==e?(t-i)/(e-i):0}l(i7,"inverseLerp");function Om(i,e,t){return(1-t)*i+t*e}l(Om,"lerp");function n7(i,e,t,n){return Om(i,e,1-Math.exp(-t*n))}l(n7,"damp");function r7(i,e=1){return e-Math.abs(jw(i,e*2)-e)}l(r7,"pingpong");function a7(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}l(a7,"smoothstep");function o7(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}l(o7,"smootherstep");function s7(i,e){return i+Math.floor(Math.random()*(e-i+1))}l(s7,"randInt");function l7(i,e){return i+Math.random()*(e-i)}l(l7,"randFloat");function u7(i){return i*(.5-Math.random())}l(u7,"randFloatSpread");function h7(i){i!==void 0&&(N6=i);let e=N6+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}l(h7,"seededRandom");function c7(i){return i*Rm}l(c7,"degToRad");function p7(i){return i*ag}l(p7,"radToDeg");function d7(i){return(i&i-1)===0&&i!==0}l(d7,"isPowerOfTwo");function f7(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}l(f7,"ceilPowerOfTwo");function m7(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}l(m7,"floorPowerOfTwo");function g7(i,e,t,n,r){let a=Math.cos,o=Math.sin,s=a(t/2),u=o(t/2),h=a((e+n)/2),d=o((e+n)/2),f=a((e-n)/2),m=o((e-n)/2),v=a((n-e)/2),b=o((n-e)/2);switch(r){case"XYX":i.set(s*d,u*f,u*m,s*h);break;case"YZY":i.set(u*m,s*d,u*f,s*h);break;case"ZXZ":i.set(u*f,u*m,s*d,s*h);break;case"XZX":i.set(s*d,u*b,u*v,s*h);break;case"YXY":i.set(u*v,s*d,u*b,s*h);break;case"ZYZ":i.set(u*b,u*v,s*d,s*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}l(g7,"setQuaternionFromProperEuler");function Ns(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}l(Ns,"denormalize");function Un(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}l(Un,"normalize");var Bn={DEG2RAD:Rm,RAD2DEG:ag,generateUUID:gs,clamp:sn,euclideanModulo:jw,mapLinear:t7,inverseLerp:i7,lerp:Om,damp:n7,pingpong:r7,smoothstep:a7,smootherstep:o7,randInt:s7,randFloat:l7,randFloatSpread:u7,seededRandom:h7,degToRad:c7,radToDeg:p7,isPowerOfTwo:d7,ceilPowerOfTwo:f7,floorPowerOfTwo:m7,setQuaternionFromProperEuler:g7,normalize:Un,denormalize:Ns},y7=class v7{constructor(e=0,t=0){v7.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=sn(this.x,e.x,t.x),this.y=sn(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=sn(this.x,e,t),this.y=sn(this.y,e,t),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(sn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let n=this.dot(e)/t;return Math.acos(sn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let n=Math.cos(t),r=Math.sin(t),a=this.x-e.x,o=this.y-e.y;return this.x=a*n-o*r+e.x,this.y=a*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}};l(y7,"Vector2");var ft=y7,_7=class x7{constructor(e,t,n,r,a,o,s,u,h){x7.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,a,o,s,u,h)}set(e,t,n,r,a,o,s,u,h){let d=this.elements;return d[0]=e,d[1]=r,d[2]=s,d[3]=t,d[4]=a,d[5]=u,d[6]=n,d[7]=o,d[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let n=e.elements,r=t.elements,a=this.elements,o=n[0],s=n[3],u=n[6],h=n[1],d=n[4],f=n[7],m=n[2],v=n[5],b=n[8],w=r[0],A=r[3],E=r[6],I=r[1],C=r[4],T=r[7],k=r[2],F=r[5],B=r[8];return a[0]=o*w+s*I+u*k,a[3]=o*A+s*C+u*F,a[6]=o*E+s*T+u*B,a[1]=h*w+d*I+f*k,a[4]=h*A+d*C+f*F,a[7]=h*E+d*T+f*B,a[2]=m*w+v*I+b*k,a[5]=m*A+v*C+b*F,a[8]=m*E+v*T+b*B,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],n=e[1],r=e[2],a=e[3],o=e[4],s=e[5],u=e[6],h=e[7],d=e[8];return t*o*d-t*s*h-n*a*d+n*s*u+r*a*h-r*o*u}invert(){let e=this.elements,t=e[0],n=e[1],r=e[2],a=e[3],o=e[4],s=e[5],u=e[6],h=e[7],d=e[8],f=d*o-s*h,m=s*u-d*a,v=h*a-o*u,b=t*f+n*m+r*v;if(b===0)return this.set(0,0,0,0,0,0,0,0,0);let w=1/b;return e[0]=f*w,e[1]=(r*h-d*n)*w,e[2]=(s*n-r*o)*w,e[3]=m*w,e[4]=(d*t-r*u)*w,e[5]=(r*a-s*t)*w,e[6]=v*w,e[7]=(n*u-h*t)*w,e[8]=(o*t-n*a)*w,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,a,o,s){let u=Math.cos(a),h=Math.sin(a);return this.set(n*u,n*h,-n*(u*o+h*s)+o+e,-r*h,r*u,-r*(-h*o+u*s)+s+t,0,0,1),this}scale(e,t){return this.premultiply(cS.makeScale(e,t)),this}rotate(e){return this.premultiply(cS.makeRotation(-e)),this}translate(e,t){return this.premultiply(cS.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){let n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}};l(_7,"Matrix3");var fn=_7,cS=new fn;function OP(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}l(OP,"arrayNeedsUint32");function og(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}l(og,"createElementNS");function b7(){let i=og("canvas");return i.style.display="block",i}l(b7,"createCanvasElement");var F6={};function Bp(i){i in F6||(F6[i]=!0,console.warn(i))}l(Bp,"warnOnce");function w7(i,e,t){return new Promise(function(n,r){function a(){switch(i.clientWaitSync(e,i.SYNC_FLUSH_COMMANDS_BIT,0)){case i.WAIT_FAILED:r();break;case i.TIMEOUT_EXPIRED:setTimeout(a,t);break;default:n()}}l(a,"probe"),setTimeout(a,t)})}l(w7,"probeAsync");function A7(i){let e=i.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}l(A7,"toNormalizedProjectionMatrix");function S7(i){let e=i.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}l(S7,"toReversedProjectionMatrix");var B6=new fn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),z6=new fn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function M7(){let i={enabled:!0,workingColorSpace:pd,spaces:{},convert:l(function(r,a,o){return this.enabled===!1||a===o||!a||!o||(this.spaces[a].transfer===Jn&&(r.r=Ql(r.r),r.g=Ql(r.g),r.b=Ql(r.b)),this.spaces[a].primaries!==this.spaces[o].primaries&&(r.applyMatrix3(this.spaces[a].toXYZ),r.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===Jn&&(r.r=rd(r.r),r.g=rd(r.g),r.b=rd(r.b))),r},"convert"),fromWorkingColorSpace:l(function(r,a){return this.convert(r,this.workingColorSpace,a)},"fromWorkingColorSpace"),toWorkingColorSpace:l(function(r,a){return this.convert(r,a,this.workingColorSpace)},"toWorkingColorSpace"),getPrimaries:l(function(r){return this.spaces[r].primaries},"getPrimaries"),getTransfer:l(function(r){return r===bc?B2:this.spaces[r].transfer},"getTransfer"),getLuminanceCoefficients:l(function(r,a=this.workingColorSpace){return r.fromArray(this.spaces[a].luminanceCoefficients)},"getLuminanceCoefficients"),define:l(function(r){Object.assign(this.spaces,r)},"define"),_getMatrix:l(function(r,a,o){return r.copy(this.spaces[a].toXYZ).multiply(this.spaces[o].fromXYZ)},"_getMatrix"),_getDrawingBufferColorSpace:l(function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},"_getDrawingBufferColorSpace"),_getUnpackColorSpace:l(function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace},"_getUnpackColorSpace")},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return i.define({[pd]:{primaries:e,whitePoint:n,transfer:B2,toXYZ:B6,fromXYZ:z6,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:io},outputColorSpaceConfig:{drawingBufferColorSpace:io}},[io]:{primaries:e,whitePoint:n,transfer:Jn,toXYZ:B6,fromXYZ:z6,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:io}}}),i}l(M7,"createColorManagement");var kn=M7();function Ql(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}l(Ql,"SRGBToLinear");function rd(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}l(rd,"LinearToSRGB");var Hd,C7=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Hd===void 0&&(Hd=og("canvas")),Hd.width=e.width,Hd.height=e.height;let n=Hd.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Hd}return t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=og("canvas");t.width=e.width,t.height=e.height;let n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);let r=n.getImageData(0,0,e.width,e.height),a=r.data;for(let o=0;o<a.length;o++)a[o]=Ql(a[o]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){let t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(Ql(t[n]/255)*255):t[n]=Ql(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}};l(C7,"ImageUtils");var $he=C7,Hhe=0,E7=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Hhe++}),this.uuid=gs(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let a;if(Array.isArray(r)){a=[];for(let o=0,s=r.length;o<s;o++)r[o].isDataTexture?a.push($_(r[o].image)):a.push($_(r[o]))}else a=$_(r);n.url=a}return t||(e.images[this.uuid]=n),n}};l(E7,"Source");var I7=E7;function $_(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?$he.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}l($_,"serializeImage");var Whe=0,T7=class H_ extends Rg{constructor(e=H_.DEFAULT_IMAGE,t=H_.DEFAULT_MAPPING,n=Zp,r=Zp,a=Yl,o=Yp,s=ao,u=vl,h=H_.DEFAULT_ANISOTROPY,d=bc){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Whe++}),this.uuid=gs(),this.name="",this.source=new I7(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=a,this.minFilter=o,this.anisotropy=h,this.format=s,this.internalFormat=null,this.type=u,this.offset=new ft(0,0),this.repeat=new ft(1,1),this.center=new ft(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new fn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=d,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];let n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==G8)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case fl:e.x=e.x-Math.floor(e.x);break;case Zp:e.x=e.x<0?0:1;break;case $M:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case fl:e.y=e.y-Math.floor(e.y);break;case Zp:e.y=e.y<0?0:1;break;case $M:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}};l(T7,"Texture");var Zo=T7;Zo.DEFAULT_IMAGE=null;Zo.DEFAULT_MAPPING=G8;Zo.DEFAULT_ANISOTROPY=1;var P7=class L7{constructor(e=0,t=0,n=0,r=1){L7.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,n=this.y,r=this.z,a=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*a,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*a,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*a,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*a,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,a,o=e.elements,s=o[0],u=o[4],h=o[8],d=o[1],f=o[5],m=o[9],v=o[2],b=o[6],w=o[10];if(Math.abs(u-d)<.01&&Math.abs(h-v)<.01&&Math.abs(m-b)<.01){if(Math.abs(u+d)<.1&&Math.abs(h+v)<.1&&Math.abs(m+b)<.1&&Math.abs(s+f+w-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let E=(s+1)/2,I=(f+1)/2,C=(w+1)/2,T=(u+d)/4,k=(h+v)/4,F=(m+b)/4;return E>I&&E>C?E<.01?(n=0,r=.707106781,a=.707106781):(n=Math.sqrt(E),r=T/n,a=k/n):I>C?I<.01?(n=.707106781,r=0,a=.707106781):(r=Math.sqrt(I),n=T/r,a=F/r):C<.01?(n=.707106781,r=.707106781,a=0):(a=Math.sqrt(C),n=k/a,r=F/a),this.set(n,r,a,t),this}let A=Math.sqrt((b-m)*(b-m)+(h-v)*(h-v)+(d-u)*(d-u));return Math.abs(A)<.001&&(A=1),this.x=(b-m)/A,this.y=(h-v)/A,this.z=(d-u)/A,this.w=Math.acos((s+f+w-1)/2),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=sn(this.x,e.x,t.x),this.y=sn(this.y,e.y,t.y),this.z=sn(this.z,e.z,t.z),this.w=sn(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=sn(this.x,e,t),this.y=sn(this.y,e,t),this.z=sn(this.z,e,t),this.w=sn(this.w,e,t),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(sn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}};l(P7,"Vector4");var jn=P7,D7=class extends Rg{constructor(e=1,t=1,n={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new jn(0,0,e,t),this.scissorTest=!1,this.viewport=new jn(0,0,e,t);let r={width:e,height:t,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Yl,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},n);let a=new Zo(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);a.flipY=!1,a.generateMipmaps=n.generateMipmaps,a.internalFormat=n.internalFormat,this.textures=[];let o=n.count;for(let s=0;s<o;s++)this.textures[s]=a.clone(),this.textures[s].isRenderTargetTexture=!0,this.textures[s].renderTarget=this;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,a=this.textures.length;r<a;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,r=e.textures.length;n<r;n++)this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0,this.textures[n].renderTarget=this;let t=Object.assign({},e.texture.image);return this.texture.source=new I7(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}};l(D7,"RenderTarget");var qhe=D7,k7=class extends qhe{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}};l(k7,"WebGLRenderTarget");var Oc=k7,R7=class extends Zo{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=ms,this.minFilter=ms,this.wrapR=Zp,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}};l(R7,"DataArrayTexture");var O7=R7,N7=class extends Zo{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=ms,this.minFilter=ms,this.wrapR=Zp,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};l(N7,"Data3DTexture");var Xhe=N7,F7=class{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,a,o,s){let u=n[r+0],h=n[r+1],d=n[r+2],f=n[r+3],m=a[o+0],v=a[o+1],b=a[o+2],w=a[o+3];if(s===0){e[t+0]=u,e[t+1]=h,e[t+2]=d,e[t+3]=f;return}if(s===1){e[t+0]=m,e[t+1]=v,e[t+2]=b,e[t+3]=w;return}if(f!==w||u!==m||h!==v||d!==b){let A=1-s,E=u*m+h*v+d*b+f*w,I=E>=0?1:-1,C=1-E*E;if(C>Number.EPSILON){let k=Math.sqrt(C),F=Math.atan2(k,E*I);A=Math.sin(A*F)/k,s=Math.sin(s*F)/k}let T=s*I;if(u=u*A+m*T,h=h*A+v*T,d=d*A+b*T,f=f*A+w*T,A===1-s){let k=1/Math.sqrt(u*u+h*h+d*d+f*f);u*=k,h*=k,d*=k,f*=k}}e[t]=u,e[t+1]=h,e[t+2]=d,e[t+3]=f}static multiplyQuaternionsFlat(e,t,n,r,a,o){let s=n[r],u=n[r+1],h=n[r+2],d=n[r+3],f=a[o],m=a[o+1],v=a[o+2],b=a[o+3];return e[t]=s*b+d*f+u*v-h*m,e[t+1]=u*b+d*m+h*f-s*v,e[t+2]=h*b+d*v+s*m-u*f,e[t+3]=d*b-s*f-u*m-h*v,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){let n=e._x,r=e._y,a=e._z,o=e._order,s=Math.cos,u=Math.sin,h=s(n/2),d=s(r/2),f=s(a/2),m=u(n/2),v=u(r/2),b=u(a/2);switch(o){case"XYZ":this._x=m*d*f+h*v*b,this._y=h*v*f-m*d*b,this._z=h*d*b+m*v*f,this._w=h*d*f-m*v*b;break;case"YXZ":this._x=m*d*f+h*v*b,this._y=h*v*f-m*d*b,this._z=h*d*b-m*v*f,this._w=h*d*f+m*v*b;break;case"ZXY":this._x=m*d*f-h*v*b,this._y=h*v*f+m*d*b,this._z=h*d*b+m*v*f,this._w=h*d*f-m*v*b;break;case"ZYX":this._x=m*d*f-h*v*b,this._y=h*v*f+m*d*b,this._z=h*d*b-m*v*f,this._w=h*d*f+m*v*b;break;case"YZX":this._x=m*d*f+h*v*b,this._y=h*v*f+m*d*b,this._z=h*d*b-m*v*f,this._w=h*d*f-m*v*b;break;case"XZY":this._x=m*d*f-h*v*b,this._y=h*v*f-m*d*b,this._z=h*d*b+m*v*f,this._w=h*d*f+m*v*b;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,n=t[0],r=t[4],a=t[8],o=t[1],s=t[5],u=t[9],h=t[2],d=t[6],f=t[10],m=n+s+f;if(m>0){let v=.5/Math.sqrt(m+1);this._w=.25/v,this._x=(d-u)*v,this._y=(a-h)*v,this._z=(o-r)*v}else if(n>s&&n>f){let v=2*Math.sqrt(1+n-s-f);this._w=(d-u)/v,this._x=.25*v,this._y=(r+o)/v,this._z=(a+h)/v}else if(s>f){let v=2*Math.sqrt(1+s-n-f);this._w=(a-h)/v,this._x=(r+o)/v,this._y=.25*v,this._z=(u+d)/v}else{let v=2*Math.sqrt(1+f-n-s);this._w=(o-r)/v,this._x=(a+h)/v,this._y=(u+d)/v,this._z=.25*v}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(sn(this.dot(e),-1,1)))}rotateTowards(e,t){let n=this.angleTo(e);if(n===0)return this;let r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let n=e._x,r=e._y,a=e._z,o=e._w,s=t._x,u=t._y,h=t._z,d=t._w;return this._x=n*d+o*s+r*h-a*u,this._y=r*d+o*u+a*s-n*h,this._z=a*d+o*h+n*u-r*s,this._w=o*d-n*s-r*u-a*h,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let n=this._x,r=this._y,a=this._z,o=this._w,s=o*e._w+n*e._x+r*e._y+a*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=o,this._x=n,this._y=r,this._z=a,this;let u=1-s*s;if(u<=Number.EPSILON){let v=1-t;return this._w=v*o+t*this._w,this._x=v*n+t*this._x,this._y=v*r+t*this._y,this._z=v*a+t*this._z,this.normalize(),this}let h=Math.sqrt(u),d=Math.atan2(h,s),f=Math.sin((1-t)*d)/h,m=Math.sin(t*d)/h;return this._w=o*f+this._w*m,this._x=n*f+this._x*m,this._y=r*f+this._y*m,this._z=a*f+this._z*m,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){let e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),a=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),a*Math.sin(t),a*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}};l(F7,"Quaternion");var lu=F7,B7=class z7{constructor(e=0,t=0,n=0){z7.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(U6.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(U6.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,n=this.y,r=this.z,a=e.elements;return this.x=a[0]*t+a[3]*n+a[6]*r,this.y=a[1]*t+a[4]*n+a[7]*r,this.z=a[2]*t+a[5]*n+a[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,n=this.y,r=this.z,a=e.elements,o=1/(a[3]*t+a[7]*n+a[11]*r+a[15]);return this.x=(a[0]*t+a[4]*n+a[8]*r+a[12])*o,this.y=(a[1]*t+a[5]*n+a[9]*r+a[13])*o,this.z=(a[2]*t+a[6]*n+a[10]*r+a[14])*o,this}applyQuaternion(e){let t=this.x,n=this.y,r=this.z,a=e.x,o=e.y,s=e.z,u=e.w,h=2*(o*r-s*n),d=2*(s*t-a*r),f=2*(a*n-o*t);return this.x=t+u*h+o*f-s*d,this.y=n+u*d+s*h-a*f,this.z=r+u*f+a*d-o*h,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,n=this.y,r=this.z,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r,this.y=a[1]*t+a[5]*n+a[9]*r,this.z=a[2]*t+a[6]*n+a[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=sn(this.x,e.x,t.x),this.y=sn(this.y,e.y,t.y),this.z=sn(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=sn(this.x,e,t),this.y=sn(this.y,e,t),this.z=sn(this.z,e,t),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(sn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let n=e.x,r=e.y,a=e.z,o=t.x,s=t.y,u=t.z;return this.x=r*u-a*s,this.y=a*o-n*u,this.z=n*s-r*o,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return pS.copy(this).projectOnVector(e),this.sub(pS)}reflect(e){return this.sub(pS.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let n=this.dot(e)/t;return Math.acos(sn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){let r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};l(B7,"Vector3");var Ee=B7,pS=new Ee,U6=new lu,U7=class{constructor(e=new Ee(1/0,1/0,1/0),t=new Ee(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Zs.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Zs.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let n=Zs.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let n=e.geometry;if(n!==void 0){let a=n.getAttribute("position");if(t===!0&&a!==void 0&&e.isInstancedMesh!==!0)for(let o=0,s=a.count;o<s;o++)e.isMesh===!0?e.getVertexPosition(o,Zs):Zs.fromBufferAttribute(a,o),Zs.applyMatrix4(e.matrixWorld),this.expandByPoint(Zs);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),D0.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),D0.copy(n.boundingBox)),D0.applyMatrix4(e.matrixWorld),this.union(D0)}let r=e.children;for(let a=0,o=r.length;a<o;a++)this.expandByObject(r[a],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Zs),Zs.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(ay),k0.subVectors(this.max,ay),Wd.subVectors(e.a,ay),qd.subVectors(e.b,ay),Xd.subVectors(e.c,ay),kh.subVectors(qd,Wd),Rh.subVectors(Xd,qd),ap.subVectors(Wd,Xd);let t=[0,-kh.z,kh.y,0,-Rh.z,Rh.y,0,-ap.z,ap.y,kh.z,0,-kh.x,Rh.z,0,-Rh.x,ap.z,0,-ap.x,-kh.y,kh.x,0,-Rh.y,Rh.x,0,-ap.y,ap.x,0];return!W_(t,Wd,qd,Xd,k0)||(t=[1,0,0,0,1,0,0,0,1],!W_(t,Wd,qd,Xd,k0))?!1:(R0.crossVectors(kh,Rh),t=[R0.x,R0.y,R0.z],W_(t,Wd,qd,Xd,k0))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Zs).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Zs).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Iu[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Iu[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Iu[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Iu[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Iu[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Iu[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Iu[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Iu[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Iu),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}};l(U7,"Box3");var ur=U7,Iu=[new Ee,new Ee,new Ee,new Ee,new Ee,new Ee,new Ee,new Ee],Zs=new Ee,D0=new ur,Wd=new Ee,qd=new Ee,Xd=new Ee,kh=new Ee,Rh=new Ee,ap=new Ee,ay=new Ee,k0=new Ee,R0=new Ee,op=new Ee;function W_(i,e,t,n,r){for(let a=0,o=i.length-3;a<=o;a+=3){op.fromArray(i,a);let s=r.x*Math.abs(op.x)+r.y*Math.abs(op.y)+r.z*Math.abs(op.z),u=e.dot(op),h=t.dot(op),d=n.dot(op);if(Math.max(-Math.max(u,h,d),Math.min(u,h,d))>s)return!1}return!0}l(W_,"satForAxes");var Zhe=new ur,oy=new Ee,dS=new Ee,V7=class{constructor(e=new Ee,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let n=this.center;t!==void 0?n.copy(t):Zhe.setFromPoints(e).getCenter(n);let r=0;for(let a=0,o=e.length;a<o;a++)r=Math.max(r,n.distanceToSquared(e[a]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;oy.subVectors(e,this.center);let t=oy.lengthSq();if(t>this.radius*this.radius){let n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.addScaledVector(oy,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(dS.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(oy.copy(e.center).add(dS)),this.expandByPoint(oy.copy(e.center).sub(dS))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}};l(V7,"Sphere");var Ho=V7,Tu=new Ee,fS=new Ee,O0=new Ee,Oh=new Ee,mS=new Ee,N0=new Ee,gS=new Ee,j7=class{constructor(e=new Ee,t=new Ee(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Tu)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=Tu.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Tu.copy(this.origin).addScaledVector(this.direction,t),Tu.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){fS.copy(e).add(t).multiplyScalar(.5),O0.copy(t).sub(e).normalize(),Oh.copy(this.origin).sub(fS);let a=e.distanceTo(t)*.5,o=-this.direction.dot(O0),s=Oh.dot(this.direction),u=-Oh.dot(O0),h=Oh.lengthSq(),d=Math.abs(1-o*o),f,m,v,b;if(d>0)if(f=o*u-s,m=o*s-u,b=a*d,f>=0)if(m>=-b)if(m<=b){let w=1/d;f*=w,m*=w,v=f*(f+o*m+2*s)+m*(o*f+m+2*u)+h}else m=a,f=Math.max(0,-(o*m+s)),v=-f*f+m*(m+2*u)+h;else m=-a,f=Math.max(0,-(o*m+s)),v=-f*f+m*(m+2*u)+h;else m<=-b?(f=Math.max(0,-(-o*a+s)),m=f>0?-a:Math.min(Math.max(-a,-u),a),v=-f*f+m*(m+2*u)+h):m<=b?(f=0,m=Math.min(Math.max(-a,-u),a),v=m*(m+2*u)+h):(f=Math.max(0,-(o*a+s)),m=f>0?a:Math.min(Math.max(-a,-u),a),v=-f*f+m*(m+2*u)+h);else m=o>0?-a:a,f=Math.max(0,-(o*m+s)),v=-f*f+m*(m+2*u)+h;return n&&n.copy(this.origin).addScaledVector(this.direction,f),r&&r.copy(fS).addScaledVector(O0,m),v}intersectSphere(e,t){Tu.subVectors(e.center,this.origin);let n=Tu.dot(this.direction),r=Tu.dot(Tu)-n*n,a=e.radius*e.radius;if(r>a)return null;let o=Math.sqrt(a-r),s=n-o,u=n+o;return u<0?null:s<0?this.at(u,t):this.at(s,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){let n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,a,o,s,u,h=1/this.direction.x,d=1/this.direction.y,f=1/this.direction.z,m=this.origin;return h>=0?(n=(e.min.x-m.x)*h,r=(e.max.x-m.x)*h):(n=(e.max.x-m.x)*h,r=(e.min.x-m.x)*h),d>=0?(a=(e.min.y-m.y)*d,o=(e.max.y-m.y)*d):(a=(e.max.y-m.y)*d,o=(e.min.y-m.y)*d),n>o||a>r||((a>n||isNaN(n))&&(n=a),(o<r||isNaN(r))&&(r=o),f>=0?(s=(e.min.z-m.z)*f,u=(e.max.z-m.z)*f):(s=(e.max.z-m.z)*f,u=(e.min.z-m.z)*f),n>u||s>r)||((s>n||n!==n)&&(n=s),(u<r||r!==r)&&(r=u),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,Tu)!==null}intersectTriangle(e,t,n,r,a){mS.subVectors(t,e),N0.subVectors(n,e),gS.crossVectors(mS,N0);let o=this.direction.dot(gS),s;if(o>0){if(r)return null;s=1}else if(o<0)s=-1,o=-o;else return null;Oh.subVectors(this.origin,e);let u=s*this.direction.dot(N0.crossVectors(Oh,N0));if(u<0)return null;let h=s*this.direction.dot(mS.cross(Oh));if(h<0||u+h>o)return null;let d=-s*Oh.dot(gS);return d<0?null:this.at(d/o,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}};l(j7,"Ray");var $1=j7,G7=class bC{constructor(e,t,n,r,a,o,s,u,h,d,f,m,v,b,w,A){bC.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,r,a,o,s,u,h,d,f,m,v,b,w,A)}set(e,t,n,r,a,o,s,u,h,d,f,m,v,b,w,A){let E=this.elements;return E[0]=e,E[4]=t,E[8]=n,E[12]=r,E[1]=a,E[5]=o,E[9]=s,E[13]=u,E[2]=h,E[6]=d,E[10]=f,E[14]=m,E[3]=v,E[7]=b,E[11]=w,E[15]=A,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new bC().fromArray(this.elements)}copy(e){let t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){let t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,n=e.elements,r=1/Zd.setFromMatrixColumn(e,0).length(),a=1/Zd.setFromMatrixColumn(e,1).length(),o=1/Zd.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*a,t[5]=n[5]*a,t[6]=n[6]*a,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,n=e.x,r=e.y,a=e.z,o=Math.cos(n),s=Math.sin(n),u=Math.cos(r),h=Math.sin(r),d=Math.cos(a),f=Math.sin(a);if(e.order==="XYZ"){let m=o*d,v=o*f,b=s*d,w=s*f;t[0]=u*d,t[4]=-u*f,t[8]=h,t[1]=v+b*h,t[5]=m-w*h,t[9]=-s*u,t[2]=w-m*h,t[6]=b+v*h,t[10]=o*u}else if(e.order==="YXZ"){let m=u*d,v=u*f,b=h*d,w=h*f;t[0]=m+w*s,t[4]=b*s-v,t[8]=o*h,t[1]=o*f,t[5]=o*d,t[9]=-s,t[2]=v*s-b,t[6]=w+m*s,t[10]=o*u}else if(e.order==="ZXY"){let m=u*d,v=u*f,b=h*d,w=h*f;t[0]=m-w*s,t[4]=-o*f,t[8]=b+v*s,t[1]=v+b*s,t[5]=o*d,t[9]=w-m*s,t[2]=-o*h,t[6]=s,t[10]=o*u}else if(e.order==="ZYX"){let m=o*d,v=o*f,b=s*d,w=s*f;t[0]=u*d,t[4]=b*h-v,t[8]=m*h+w,t[1]=u*f,t[5]=w*h+m,t[9]=v*h-b,t[2]=-h,t[6]=s*u,t[10]=o*u}else if(e.order==="YZX"){let m=o*u,v=o*h,b=s*u,w=s*h;t[0]=u*d,t[4]=w-m*f,t[8]=b*f+v,t[1]=f,t[5]=o*d,t[9]=-s*d,t[2]=-h*d,t[6]=v*f+b,t[10]=m-w*f}else if(e.order==="XZY"){let m=o*u,v=o*h,b=s*u,w=s*h;t[0]=u*d,t[4]=-f,t[8]=h*d,t[1]=m*f+w,t[5]=o*d,t[9]=v*f-b,t[2]=b*f-v,t[6]=s*d,t[10]=w*f+m}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Yhe,e,Jhe)}lookAt(e,t,n){let r=this.elements;return ts.subVectors(e,t),ts.lengthSq()===0&&(ts.z=1),ts.normalize(),Nh.crossVectors(n,ts),Nh.lengthSq()===0&&(Math.abs(n.z)===1?ts.x+=1e-4:ts.z+=1e-4,ts.normalize(),Nh.crossVectors(n,ts)),Nh.normalize(),F0.crossVectors(ts,Nh),r[0]=Nh.x,r[4]=F0.x,r[8]=ts.x,r[1]=Nh.y,r[5]=F0.y,r[9]=ts.y,r[2]=Nh.z,r[6]=F0.z,r[10]=ts.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let n=e.elements,r=t.elements,a=this.elements,o=n[0],s=n[4],u=n[8],h=n[12],d=n[1],f=n[5],m=n[9],v=n[13],b=n[2],w=n[6],A=n[10],E=n[14],I=n[3],C=n[7],T=n[11],k=n[15],F=r[0],B=r[4],N=r[8],z=r[12],L=r[1],j=r[5],q=r[9],Z=r[13],O=r[2],Y=r[6],J=r[10],oe=r[14],$=r[3],K=r[7],te=r[11],ve=r[15];return a[0]=o*F+s*L+u*O+h*$,a[4]=o*B+s*j+u*Y+h*K,a[8]=o*N+s*q+u*J+h*te,a[12]=o*z+s*Z+u*oe+h*ve,a[1]=d*F+f*L+m*O+v*$,a[5]=d*B+f*j+m*Y+v*K,a[9]=d*N+f*q+m*J+v*te,a[13]=d*z+f*Z+m*oe+v*ve,a[2]=b*F+w*L+A*O+E*$,a[6]=b*B+w*j+A*Y+E*K,a[10]=b*N+w*q+A*J+E*te,a[14]=b*z+w*Z+A*oe+E*ve,a[3]=I*F+C*L+T*O+k*$,a[7]=I*B+C*j+T*Y+k*K,a[11]=I*N+C*q+T*J+k*te,a[15]=I*z+C*Z+T*oe+k*ve,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],n=e[4],r=e[8],a=e[12],o=e[1],s=e[5],u=e[9],h=e[13],d=e[2],f=e[6],m=e[10],v=e[14],b=e[3],w=e[7],A=e[11],E=e[15];return b*(+a*u*f-r*h*f-a*s*m+n*h*m+r*s*v-n*u*v)+w*(+t*u*v-t*h*m+a*o*m-r*o*v+r*h*d-a*u*d)+A*(+t*h*f-t*s*v-a*o*f+n*o*v+a*s*d-n*h*d)+E*(-r*s*d-t*u*f+t*s*m+r*o*f-n*o*m+n*u*d)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){let r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){let e=this.elements,t=e[0],n=e[1],r=e[2],a=e[3],o=e[4],s=e[5],u=e[6],h=e[7],d=e[8],f=e[9],m=e[10],v=e[11],b=e[12],w=e[13],A=e[14],E=e[15],I=f*A*h-w*m*h+w*u*v-s*A*v-f*u*E+s*m*E,C=b*m*h-d*A*h-b*u*v+o*A*v+d*u*E-o*m*E,T=d*w*h-b*f*h+b*s*v-o*w*v-d*s*E+o*f*E,k=b*f*u-d*w*u-b*s*m+o*w*m+d*s*A-o*f*A,F=t*I+n*C+r*T+a*k;if(F===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let B=1/F;return e[0]=I*B,e[1]=(w*m*a-f*A*a-w*r*v+n*A*v+f*r*E-n*m*E)*B,e[2]=(s*A*a-w*u*a+w*r*h-n*A*h-s*r*E+n*u*E)*B,e[3]=(f*u*a-s*m*a-f*r*h+n*m*h+s*r*v-n*u*v)*B,e[4]=C*B,e[5]=(d*A*a-b*m*a+b*r*v-t*A*v-d*r*E+t*m*E)*B,e[6]=(b*u*a-o*A*a-b*r*h+t*A*h+o*r*E-t*u*E)*B,e[7]=(o*m*a-d*u*a+d*r*h-t*m*h-o*r*v+t*u*v)*B,e[8]=T*B,e[9]=(b*f*a-d*w*a-b*n*v+t*w*v+d*n*E-t*f*E)*B,e[10]=(o*w*a-b*s*a+b*n*h-t*w*h-o*n*E+t*s*E)*B,e[11]=(d*s*a-o*f*a-d*n*h+t*f*h+o*n*v-t*s*v)*B,e[12]=k*B,e[13]=(d*w*r-b*f*r+b*n*m-t*w*m-d*n*A+t*f*A)*B,e[14]=(b*s*r-o*w*r-b*n*u+t*w*u+o*n*A-t*s*A)*B,e[15]=(o*f*r-d*s*r+d*n*u-t*f*u-o*n*m+t*s*m)*B,this}scale(e){let t=this.elements,n=e.x,r=e.y,a=e.z;return t[0]*=n,t[4]*=r,t[8]*=a,t[1]*=n,t[5]*=r,t[9]*=a,t[2]*=n,t[6]*=r,t[10]*=a,t[3]*=n,t[7]*=r,t[11]*=a,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let n=Math.cos(t),r=Math.sin(t),a=1-n,o=e.x,s=e.y,u=e.z,h=a*o,d=a*s;return this.set(h*o+n,h*s-r*u,h*u+r*s,0,h*s+r*u,d*s+n,d*u-r*o,0,h*u-r*s,d*u+r*o,a*u*u+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,a,o){return this.set(1,n,a,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){let r=this.elements,a=t._x,o=t._y,s=t._z,u=t._w,h=a+a,d=o+o,f=s+s,m=a*h,v=a*d,b=a*f,w=o*d,A=o*f,E=s*f,I=u*h,C=u*d,T=u*f,k=n.x,F=n.y,B=n.z;return r[0]=(1-(w+E))*k,r[1]=(v+T)*k,r[2]=(b-C)*k,r[3]=0,r[4]=(v-T)*F,r[5]=(1-(m+E))*F,r[6]=(A+I)*F,r[7]=0,r[8]=(b+C)*B,r[9]=(A-I)*B,r[10]=(1-(m+w))*B,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){let r=this.elements,a=Zd.set(r[0],r[1],r[2]).length(),o=Zd.set(r[4],r[5],r[6]).length(),s=Zd.set(r[8],r[9],r[10]).length();this.determinant()<0&&(a=-a),e.x=r[12],e.y=r[13],e.z=r[14],Ys.copy(this);let u=1/a,h=1/o,d=1/s;return Ys.elements[0]*=u,Ys.elements[1]*=u,Ys.elements[2]*=u,Ys.elements[4]*=h,Ys.elements[5]*=h,Ys.elements[6]*=h,Ys.elements[8]*=d,Ys.elements[9]*=d,Ys.elements[10]*=d,t.setFromRotationMatrix(Ys),n.x=a,n.y=o,n.z=s,this}makePerspective(e,t,n,r,a,o,s=lh){let u=this.elements,h=2*a/(t-e),d=2*a/(n-r),f=(t+e)/(t-e),m=(n+r)/(n-r),v,b;if(s===lh)v=-(o+a)/(o-a),b=-2*o*a/(o-a);else if(s===z2)v=-o/(o-a),b=-o*a/(o-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+s);return u[0]=h,u[4]=0,u[8]=f,u[12]=0,u[1]=0,u[5]=d,u[9]=m,u[13]=0,u[2]=0,u[6]=0,u[10]=v,u[14]=b,u[3]=0,u[7]=0,u[11]=-1,u[15]=0,this}makeOrthographic(e,t,n,r,a,o,s=lh){let u=this.elements,h=1/(t-e),d=1/(n-r),f=1/(o-a),m=(t+e)*h,v=(n+r)*d,b,w;if(s===lh)b=(o+a)*f,w=-2*f;else if(s===z2)b=a*f,w=-1*f;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+s);return u[0]=2*h,u[4]=0,u[8]=0,u[12]=-m,u[1]=0,u[5]=2*d,u[9]=0,u[13]=-v,u[2]=0,u[6]=0,u[10]=w,u[14]=-b,u[3]=0,u[7]=0,u[11]=0,u[15]=1,this}equals(e){let t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){let n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}};l(G7,"Matrix4");var qi=G7,Zd=new Ee,Ys=new qi,Yhe=new Ee(0,0,0),Jhe=new Ee(1,1,1),Nh=new Ee,F0=new Ee,ts=new Ee,V6=new qi,j6=new lu,$7=class H7{constructor(e=0,t=0,n=0,r=H7.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){let r=e.elements,a=r[0],o=r[4],s=r[8],u=r[1],h=r[5],d=r[9],f=r[2],m=r[6],v=r[10];switch(t){case"XYZ":this._y=Math.asin(sn(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-d,v),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(m,h),this._z=0);break;case"YXZ":this._x=Math.asin(-sn(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(s,v),this._z=Math.atan2(u,h)):(this._y=Math.atan2(-f,a),this._z=0);break;case"ZXY":this._x=Math.asin(sn(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(-f,v),this._z=Math.atan2(-o,h)):(this._y=0,this._z=Math.atan2(u,a));break;case"ZYX":this._y=Math.asin(-sn(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(m,v),this._z=Math.atan2(u,a)):(this._x=0,this._z=Math.atan2(-o,h));break;case"YZX":this._z=Math.asin(sn(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-d,h),this._y=Math.atan2(-f,a)):(this._x=0,this._y=Math.atan2(s,v));break;case"XZY":this._z=Math.asin(-sn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(m,h),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-d,v),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return V6.makeRotationFromQuaternion(e),this.setFromRotationMatrix(V6,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return j6.setFromEuler(this),this.setFromQuaternion(j6,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};l($7,"Euler");var Wo=$7;Wo.DEFAULT_ORDER="XYZ";var W7=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}};l(W7,"Layers");var NP=W7,Khe=0,G6=new Ee,Yd=new lu,Pu=new qi,B0=new Ee,sy=new Ee,Qhe=new Ee,ece=new lu,$6=new Ee(1,0,0),H6=new Ee(0,1,0),W6=new Ee(0,0,1),q6={type:"added"},tce={type:"removed"},Jd={type:"childadded",child:null},yS={type:"childremoved",child:null},q7=class q_ extends Rg{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Khe++}),this.uuid=gs(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=q_.DEFAULT_UP.clone();let e=new Ee,t=new Wo,n=new lu,r=new Ee(1,1,1);function a(){n.setFromEuler(t,!1)}l(a,"onRotationChange");function o(){t.setFromQuaternion(n,void 0,!1)}l(o,"onQuaternionChange"),t._onChange(a),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new qi},normalMatrix:{value:new fn}}),this.matrix=new qi,this.matrixWorld=new qi,this.matrixAutoUpdate=q_.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=q_.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new NP,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Yd.setFromAxisAngle(e,t),this.quaternion.multiply(Yd),this}rotateOnWorldAxis(e,t){return Yd.setFromAxisAngle(e,t),this.quaternion.premultiply(Yd),this}rotateX(e){return this.rotateOnAxis($6,e)}rotateY(e){return this.rotateOnAxis(H6,e)}rotateZ(e){return this.rotateOnAxis(W6,e)}translateOnAxis(e,t){return G6.copy(e).applyQuaternion(this.quaternion),this.position.add(G6.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis($6,e)}translateY(e){return this.translateOnAxis(H6,e)}translateZ(e){return this.translateOnAxis(W6,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Pu.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?B0.copy(e):B0.set(e,t,n);let r=this.parent;this.updateWorldMatrix(!0,!1),sy.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Pu.lookAt(sy,B0,this.up):Pu.lookAt(B0,sy,this.up),this.quaternion.setFromRotationMatrix(Pu),r&&(Pu.extractRotation(r.matrixWorld),Yd.setFromRotationMatrix(Pu),this.quaternion.premultiply(Yd.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(q6),Jd.child=e,this.dispatchEvent(Jd),Jd.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}let t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(tce),yS.child=e,this.dispatchEvent(yS),yS.child=null),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Pu.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Pu.multiply(e.parent.matrixWorld)),e.applyMatrix4(Pu),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(q6),Jd.child=e,this.dispatchEvent(Jd),Jd.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){let a=this.children[n].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);let r=this.children;for(let a=0,o=r.length;a<o;a++)r[a].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(sy,e,Qhe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(sy,ece,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){let t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){let n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){let r=this.children;for(let a=0,o=r.length;a<o;a++)r[a].updateWorldMatrix(!1,!0)}}toJSON(e){let t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});let r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map(s=>({boxInitialized:s.boxInitialized,boxMin:s.box.min.toArray(),boxMax:s.box.max.toArray(),sphereInitialized:s.sphereInitialized,sphereRadius:s.sphere.radius,sphereCenter:s.sphere.center.toArray()})),r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()}));function a(s,u){return s[u.uuid]===void 0&&(s[u.uuid]=u.toJSON(e)),u.uuid}if(l(a,"serialize"),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=a(e.geometries,this.geometry);let s=this.geometry.parameters;if(s!==void 0&&s.shapes!==void 0){let u=s.shapes;if(Array.isArray(u))for(let h=0,d=u.length;h<d;h++){let f=u[h];a(e.shapes,f)}else a(e.shapes,u)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let s=[];for(let u=0,h=this.material.length;u<h;u++)s.push(a(e.materials,this.material[u]));r.material=s}else r.material=a(e.materials,this.material);if(this.children.length>0){r.children=[];for(let s=0;s<this.children.length;s++)r.children.push(this.children[s].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let s=0;s<this.animations.length;s++){let u=this.animations[s];r.animations.push(a(e.animations,u))}}if(t){let s=o(e.geometries),u=o(e.materials),h=o(e.textures),d=o(e.images),f=o(e.shapes),m=o(e.skeletons),v=o(e.animations),b=o(e.nodes);s.length>0&&(n.geometries=s),u.length>0&&(n.materials=u),h.length>0&&(n.textures=h),d.length>0&&(n.images=d),f.length>0&&(n.shapes=f),m.length>0&&(n.skeletons=m),v.length>0&&(n.animations=v),b.length>0&&(n.nodes=b)}return n.object=r,n;function o(s){let u=[];for(let h in s){let d=s[h];delete d.metadata,u.push(d)}return u}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){let r=e.children[n];this.add(r.clone())}return this}};l(q7,"Object3D");var vr=q7;vr.DEFAULT_UP=new Ee(0,1,0);vr.DEFAULT_MATRIX_AUTO_UPDATE=!0;vr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var Js=new Ee,Lu=new Ee,vS=new Ee,Du=new Ee,Kd=new Ee,Qd=new Ee,X6=new Ee,_S=new Ee,xS=new Ee,bS=new Ee,wS=new jn,AS=new jn,SS=new jn,X7=class pf{constructor(e=new Ee,t=new Ee,n=new Ee){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),Js.subVectors(e,t),r.cross(Js);let a=r.lengthSq();return a>0?r.multiplyScalar(1/Math.sqrt(a)):r.set(0,0,0)}static getBarycoord(e,t,n,r,a){Js.subVectors(r,t),Lu.subVectors(n,t),vS.subVectors(e,t);let o=Js.dot(Js),s=Js.dot(Lu),u=Js.dot(vS),h=Lu.dot(Lu),d=Lu.dot(vS),f=o*h-s*s;if(f===0)return a.set(0,0,0),null;let m=1/f,v=(h*u-s*d)*m,b=(o*d-s*u)*m;return a.set(1-v-b,b,v)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,Du)===null?!1:Du.x>=0&&Du.y>=0&&Du.x+Du.y<=1}static getInterpolation(e,t,n,r,a,o,s,u){return this.getBarycoord(e,t,n,r,Du)===null?(u.x=0,u.y=0,"z"in u&&(u.z=0),"w"in u&&(u.w=0),null):(u.setScalar(0),u.addScaledVector(a,Du.x),u.addScaledVector(o,Du.y),u.addScaledVector(s,Du.z),u)}static getInterpolatedAttribute(e,t,n,r,a,o){return wS.setScalar(0),AS.setScalar(0),SS.setScalar(0),wS.fromBufferAttribute(e,t),AS.fromBufferAttribute(e,n),SS.fromBufferAttribute(e,r),o.setScalar(0),o.addScaledVector(wS,a.x),o.addScaledVector(AS,a.y),o.addScaledVector(SS,a.z),o}static isFrontFacing(e,t,n,r){return Js.subVectors(n,t),Lu.subVectors(e,t),Js.cross(Lu).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Js.subVectors(this.c,this.b),Lu.subVectors(this.a,this.b),Js.cross(Lu).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return pf.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return pf.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,a){return pf.getInterpolation(e,this.a,this.b,this.c,t,n,r,a)}containsPoint(e){return pf.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return pf.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let n=this.a,r=this.b,a=this.c,o,s;Kd.subVectors(r,n),Qd.subVectors(a,n),_S.subVectors(e,n);let u=Kd.dot(_S),h=Qd.dot(_S);if(u<=0&&h<=0)return t.copy(n);xS.subVectors(e,r);let d=Kd.dot(xS),f=Qd.dot(xS);if(d>=0&&f<=d)return t.copy(r);let m=u*f-d*h;if(m<=0&&u>=0&&d<=0)return o=u/(u-d),t.copy(n).addScaledVector(Kd,o);bS.subVectors(e,a);let v=Kd.dot(bS),b=Qd.dot(bS);if(b>=0&&v<=b)return t.copy(a);let w=v*h-u*b;if(w<=0&&h>=0&&b<=0)return s=h/(h-b),t.copy(n).addScaledVector(Qd,s);let A=d*b-v*f;if(A<=0&&f-d>=0&&v-b>=0)return X6.subVectors(a,r),s=(f-d)/(f-d+(v-b)),t.copy(r).addScaledVector(X6,s);let E=1/(A+w+m);return o=w*E,s=m*E,t.copy(n).addScaledVector(Kd,o).addScaledVector(Qd,s)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}};l(X7,"Triangle");var df=X7,Z7={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Fh={h:0,s:0,l:0},z0={h:0,s:0,l:0};function X_(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}l(X_,"hue2rgb");var Y7=class{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){let r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=io){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,kn.toWorkingColorSpace(this,t),this}setRGB(e,t,n,r=kn.workingColorSpace){return this.r=e,this.g=t,this.b=n,kn.toWorkingColorSpace(this,r),this}setHSL(e,t,n,r=kn.workingColorSpace){if(e=jw(e,1),t=sn(t,0,1),n=sn(n,0,1),t===0)this.r=this.g=this.b=n;else{let a=n<=.5?n*(1+t):n+t-n*t,o=2*n-a;this.r=X_(o,a,e+1/3),this.g=X_(o,a,e),this.b=X_(o,a,e-1/3)}return kn.toWorkingColorSpace(this,r),this}setStyle(e,t=io){function n(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}l(n,"handleAlpha");let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let a,o=r[1],s=r[2];switch(o){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,t);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,t);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){let a=r[1],o=a.length;if(o===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(a,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=io){let n=Z7[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Ql(e.r),this.g=Ql(e.g),this.b=Ql(e.b),this}copyLinearToSRGB(e){return this.r=rd(e.r),this.g=rd(e.g),this.b=rd(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=io){return kn.fromWorkingColorSpace(Ya.copy(this),e),Math.round(sn(Ya.r*255,0,255))*65536+Math.round(sn(Ya.g*255,0,255))*256+Math.round(sn(Ya.b*255,0,255))}getHexString(e=io){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=kn.workingColorSpace){kn.fromWorkingColorSpace(Ya.copy(this),t);let n=Ya.r,r=Ya.g,a=Ya.b,o=Math.max(n,r,a),s=Math.min(n,r,a),u,h,d=(s+o)/2;if(s===o)u=0,h=0;else{let f=o-s;switch(h=d<=.5?f/(o+s):f/(2-o-s),o){case n:u=(r-a)/f+(r<a?6:0);break;case r:u=(a-n)/f+2;break;case a:u=(n-r)/f+4;break}u/=6}return e.h=u,e.s=h,e.l=d,e}getRGB(e,t=kn.workingColorSpace){return kn.fromWorkingColorSpace(Ya.copy(this),t),e.r=Ya.r,e.g=Ya.g,e.b=Ya.b,e}getStyle(e=io){kn.fromWorkingColorSpace(Ya.copy(this),e);let t=Ya.r,n=Ya.g,r=Ya.b;return e!==io?"color(".concat(e," ").concat(t.toFixed(3)," ").concat(n.toFixed(3)," ").concat(r.toFixed(3),")"):"rgb(".concat(Math.round(t*255),",").concat(Math.round(n*255),",").concat(Math.round(r*255),")")}offsetHSL(e,t,n){return this.getHSL(Fh),this.setHSL(Fh.h+e,Fh.s+t,Fh.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Fh),e.getHSL(z0);let n=Om(Fh.h,z0.h,t),r=Om(Fh.s,z0.s,t),a=Om(Fh.l,z0.l,t);return this.setHSL(n,r,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){let t=this.r,n=this.g,r=this.b,a=e.elements;return this.r=a[0]*t+a[3]*n+a[6]*r,this.g=a[1]*t+a[4]*n+a[7]*r,this.b=a[2]*t+a[5]*n+a[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};l(Y7,"Color");var Mi=Y7,Ya=new Mi;Mi.NAMES=Z7;var ice=0,J7=class extends Rg{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:ice++}),this.uuid=gs(),this.name="",this.type="Material",this.blending=Dm,this.side=su,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=RM,this.blendDst=OM,this.blendEquation=Fp,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Mi(0,0,0),this.blendAlpha=0,this.depthFunc=eg,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=vC,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=ih,this.stencilZFail=ih,this.stencilZPass=ih,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let n=e[t];if(n===void 0){console.warn("THREE.Material: parameter '".concat(t,"' has value of undefined."));continue}let r=this[t];if(r===void 0){console.warn("THREE.Material: '".concat(t,"' is not a property of THREE.").concat(this.type,"."));continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Dm&&(n.blending=this.blending),this.side!==su&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==RM&&(n.blendSrc=this.blendSrc),this.blendDst!==OM&&(n.blendDst=this.blendDst),this.blendEquation!==Fp&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==eg&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==vC&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==ih&&(n.stencilFail=this.stencilFail),this.stencilZFail!==ih&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==ih&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(a){let o=[];for(let s in a){let u=a[s];delete u.metadata,o.push(u)}return o}if(l(r,"extractFromCache"),t){let a=r(e.textures),o=r(e.images);a.length>0&&(n.textures=a),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,n=null;if(t!==null){let r=t.length;n=new Array(r);for(let a=0;a!==r;++a)n[a]=t[a].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}};l(J7,"Material");var Hc=J7,K7=class extends Hc{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Mi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Wo,this.combine=EP,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}};l(K7,"MeshBasicMaterial");var _l=K7,oa=new Ee,U0=new ft,nce=0,Q7=class{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:nce++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=_C,this.updateRanges=[],this.gpuType=hs,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,a=this.itemSize;r<a;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)U0.fromBufferAttribute(this,t),U0.applyMatrix3(e),this.setXY(t,U0.x,U0.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)oa.fromBufferAttribute(this,t),oa.applyMatrix3(e),this.setXYZ(t,oa.x,oa.y,oa.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)oa.fromBufferAttribute(this,t),oa.applyMatrix4(e),this.setXYZ(t,oa.x,oa.y,oa.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)oa.fromBufferAttribute(this,t),oa.applyNormalMatrix(e),this.setXYZ(t,oa.x,oa.y,oa.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)oa.fromBufferAttribute(this,t),oa.transformDirection(e),this.setXYZ(t,oa.x,oa.y,oa.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=Ns(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Un(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Ns(t,this.array)),t}setX(e,t){return this.normalized&&(t=Un(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Ns(t,this.array)),t}setY(e,t){return this.normalized&&(t=Un(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Ns(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Un(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Ns(t,this.array)),t}setW(e,t){return this.normalized&&(t=Un(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Un(t,this.array),n=Un(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=Un(t,this.array),n=Un(n,this.array),r=Un(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,a){return e*=this.itemSize,this.normalized&&(t=Un(t,this.array),n=Un(n,this.array),r=Un(r,this.array),a=Un(a,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==_C&&(e.usage=this.usage),e}};l(Q7,"BufferAttribute");var gr=Q7,eO=class extends gr{constructor(e,t,n){super(new Uint16Array(e),t,n)}};l(eO,"Uint16BufferAttribute");var tO=eO,iO=class extends gr{constructor(e,t,n){super(new Uint32Array(e),t,n)}};l(iO,"Uint32BufferAttribute");var nO=iO,rO=class extends gr{constructor(e,t,n){super(new Float32Array(e),t,n)}};l(rO,"Float32BufferAttribute");var Fr=rO,rce=0,Is=new qi,MS=new vr,ef=new Ee,is=new ur,ly=new ur,Da=new Ee,aO=class oO extends Rg{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:rce++}),this.uuid=gs(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(OP(e)?nO:tO)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let n=this.attributes.normal;if(n!==void 0){let a=new fn().getNormalMatrix(e);n.applyNormalMatrix(a),n.needsUpdate=!0}let r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Is.makeRotationFromQuaternion(e),this.applyMatrix4(Is),this}rotateX(e){return Is.makeRotationX(e),this.applyMatrix4(Is),this}rotateY(e){return Is.makeRotationY(e),this.applyMatrix4(Is),this}rotateZ(e){return Is.makeRotationZ(e),this.applyMatrix4(Is),this}translate(e,t,n){return Is.makeTranslation(e,t,n),this.applyMatrix4(Is),this}scale(e,t,n){return Is.makeScale(e,t,n),this.applyMatrix4(Is),this}lookAt(e){return MS.lookAt(e),MS.updateMatrix(),this.applyMatrix4(MS.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ef).negate(),this.translate(ef.x,ef.y,ef.z),this}setFromPoints(e){let t=this.getAttribute("position");if(t===void 0){let n=[];for(let r=0,a=e.length;r<a;r++){let o=e[r];n.push(o.x,o.y,o.z||0)}this.setAttribute("position",new Fr(n,3))}else{let n=Math.min(e.length,t.count);for(let r=0;r<n;r++){let a=e[r];t.setXYZ(r,a.x,a.y,a.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ur);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Ee(-1/0,-1/0,-1/0),new Ee(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){let a=t[n];is.setFromBufferAttribute(a),this.morphTargetsRelative?(Da.addVectors(this.boundingBox.min,is.min),this.boundingBox.expandByPoint(Da),Da.addVectors(this.boundingBox.max,is.max),this.boundingBox.expandByPoint(Da)):(this.boundingBox.expandByPoint(is.min),this.boundingBox.expandByPoint(is.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ho);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Ee,1/0);return}if(e){let n=this.boundingSphere.center;if(is.setFromBufferAttribute(e),t)for(let a=0,o=t.length;a<o;a++){let s=t[a];ly.setFromBufferAttribute(s),this.morphTargetsRelative?(Da.addVectors(is.min,ly.min),is.expandByPoint(Da),Da.addVectors(is.max,ly.max),is.expandByPoint(Da)):(is.expandByPoint(ly.min),is.expandByPoint(ly.max))}is.getCenter(n);let r=0;for(let a=0,o=e.count;a<o;a++)Da.fromBufferAttribute(e,a),r=Math.max(r,n.distanceToSquared(Da));if(t)for(let a=0,o=t.length;a<o;a++){let s=t[a],u=this.morphTargetsRelative;for(let h=0,d=s.count;h<d;h++)Da.fromBufferAttribute(s,h),u&&(ef.fromBufferAttribute(e,h),Da.add(ef)),r=Math.max(r,n.distanceToSquared(Da))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let n=t.position,r=t.normal,a=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new gr(new Float32Array(4*n.count),4));let o=this.getAttribute("tangent"),s=[],u=[];for(let N=0;N<n.count;N++)s[N]=new Ee,u[N]=new Ee;let h=new Ee,d=new Ee,f=new Ee,m=new ft,v=new ft,b=new ft,w=new Ee,A=new Ee;function E(N,z,L){h.fromBufferAttribute(n,N),d.fromBufferAttribute(n,z),f.fromBufferAttribute(n,L),m.fromBufferAttribute(a,N),v.fromBufferAttribute(a,z),b.fromBufferAttribute(a,L),d.sub(h),f.sub(h),v.sub(m),b.sub(m);let j=1/(v.x*b.y-b.x*v.y);isFinite(j)&&(w.copy(d).multiplyScalar(b.y).addScaledVector(f,-v.y).multiplyScalar(j),A.copy(f).multiplyScalar(v.x).addScaledVector(d,-b.x).multiplyScalar(j),s[N].add(w),s[z].add(w),s[L].add(w),u[N].add(A),u[z].add(A),u[L].add(A))}l(E,"handleTriangle");let I=this.groups;I.length===0&&(I=[{start:0,count:e.count}]);for(let N=0,z=I.length;N<z;++N){let L=I[N],j=L.start,q=L.count;for(let Z=j,O=j+q;Z<O;Z+=3)E(e.getX(Z+0),e.getX(Z+1),e.getX(Z+2))}let C=new Ee,T=new Ee,k=new Ee,F=new Ee;function B(N){k.fromBufferAttribute(r,N),F.copy(k);let z=s[N];C.copy(z),C.sub(k.multiplyScalar(k.dot(z))).normalize(),T.crossVectors(F,z);let L=T.dot(u[N])<0?-1:1;o.setXYZW(N,C.x,C.y,C.z,L)}l(B,"handleVertex");for(let N=0,z=I.length;N<z;++N){let L=I[N],j=L.start,q=L.count;for(let Z=j,O=j+q;Z<O;Z+=3)B(e.getX(Z+0)),B(e.getX(Z+1)),B(e.getX(Z+2))}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new gr(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let m=0,v=n.count;m<v;m++)n.setXYZ(m,0,0,0);let r=new Ee,a=new Ee,o=new Ee,s=new Ee,u=new Ee,h=new Ee,d=new Ee,f=new Ee;if(e)for(let m=0,v=e.count;m<v;m+=3){let b=e.getX(m+0),w=e.getX(m+1),A=e.getX(m+2);r.fromBufferAttribute(t,b),a.fromBufferAttribute(t,w),o.fromBufferAttribute(t,A),d.subVectors(o,a),f.subVectors(r,a),d.cross(f),s.fromBufferAttribute(n,b),u.fromBufferAttribute(n,w),h.fromBufferAttribute(n,A),s.add(d),u.add(d),h.add(d),n.setXYZ(b,s.x,s.y,s.z),n.setXYZ(w,u.x,u.y,u.z),n.setXYZ(A,h.x,h.y,h.z)}else for(let m=0,v=t.count;m<v;m+=3)r.fromBufferAttribute(t,m+0),a.fromBufferAttribute(t,m+1),o.fromBufferAttribute(t,m+2),d.subVectors(o,a),f.subVectors(r,a),d.cross(f),n.setXYZ(m+0,d.x,d.y,d.z),n.setXYZ(m+1,d.x,d.y,d.z),n.setXYZ(m+2,d.x,d.y,d.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Da.fromBufferAttribute(e,t),Da.normalize(),e.setXYZ(t,Da.x,Da.y,Da.z)}toNonIndexed(){function e(s,u){let h=s.array,d=s.itemSize,f=s.normalized,m=new h.constructor(u.length*d),v=0,b=0;for(let w=0,A=u.length;w<A;w++){s.isInterleavedBufferAttribute?v=u[w]*s.data.stride+s.offset:v=u[w]*d;for(let E=0;E<d;E++)m[b++]=h[v++]}return new gr(m,d,f)}if(l(e,"convertBufferAttribute"),this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new oO,n=this.index.array,r=this.attributes;for(let s in r){let u=r[s],h=e(u,n);t.setAttribute(s,h)}let a=this.morphAttributes;for(let s in a){let u=[],h=a[s];for(let d=0,f=h.length;d<f;d++){let m=h[d],v=e(m,n);u.push(v)}t.morphAttributes[s]=u}t.morphTargetsRelative=this.morphTargetsRelative;let o=this.groups;for(let s=0,u=o.length;s<u;s++){let h=o[s];t.addGroup(h.start,h.count,h.materialIndex)}return t}toJSON(){let e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let u=this.parameters;for(let h in u)u[h]!==void 0&&(e[h]=u[h]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let n=this.attributes;for(let u in n){let h=n[u];e.data.attributes[u]=h.toJSON(e.data)}let r={},a=!1;for(let u in this.morphAttributes){let h=this.morphAttributes[u],d=[];for(let f=0,m=h.length;f<m;f++){let v=h[f];d.push(v.toJSON(e.data))}d.length>0&&(r[u]=d,a=!0)}a&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);let o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));let s=this.boundingSphere;return s!==null&&(e.data.boundingSphere={center:s.center.toArray(),radius:s.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let n=e.index;n!==null&&this.setIndex(n.clone(t));let r=e.attributes;for(let h in r){let d=r[h];this.setAttribute(h,d.clone(t))}let a=e.morphAttributes;for(let h in a){let d=[],f=a[h];for(let m=0,v=f.length;m<v;m++)d.push(f[m].clone(t));this.morphAttributes[h]=d}this.morphTargetsRelative=e.morphTargetsRelative;let o=e.groups;for(let h=0,d=o.length;h<d;h++){let f=o[h];this.addGroup(f.start,f.count,f.materialIndex)}let s=e.boundingBox;s!==null&&(this.boundingBox=s.clone());let u=e.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}};l(aO,"BufferGeometry");var Sa=aO,Z6=new qi,sp=new $1,V0=new Ho,Y6=new Ee,j0=new Ee,G0=new Ee,$0=new Ee,CS=new Ee,H0=new Ee,J6=new Ee,W0=new Ee,sO=class extends vr{constructor(e=new Sa,t=new _l){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let n=e[t[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,a=n.length;r<a;r++){let o=n[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=r}}}}getVertexPosition(e,t){let n=this.geometry,r=n.attributes.position,a=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(r,e);let s=this.morphTargetInfluences;if(a&&s){H0.set(0,0,0);for(let u=0,h=a.length;u<h;u++){let d=s[u],f=a[u];d!==0&&(CS.fromBufferAttribute(f,e),o?H0.addScaledVector(CS,d):H0.addScaledVector(CS.sub(t),d))}t.add(H0)}return t}raycast(e,t){let n=this.geometry,r=this.material,a=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),V0.copy(n.boundingSphere),V0.applyMatrix4(a),sp.copy(e.ray).recast(e.near),!(V0.containsPoint(sp.origin)===!1&&(sp.intersectSphere(V0,Y6)===null||sp.origin.distanceToSquared(Y6)>(e.far-e.near)**2))&&(Z6.copy(a).invert(),sp.copy(e.ray).applyMatrix4(Z6),!(n.boundingBox!==null&&sp.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,sp)))}_computeIntersections(e,t,n){let r,a=this.geometry,o=this.material,s=a.index,u=a.attributes.position,h=a.attributes.uv,d=a.attributes.uv1,f=a.attributes.normal,m=a.groups,v=a.drawRange;if(s!==null)if(Array.isArray(o))for(let b=0,w=m.length;b<w;b++){let A=m[b],E=o[A.materialIndex],I=Math.max(A.start,v.start),C=Math.min(s.count,Math.min(A.start+A.count,v.start+v.count));for(let T=I,k=C;T<k;T+=3){let F=s.getX(T),B=s.getX(T+1),N=s.getX(T+2);r=Ey(this,E,e,n,h,d,f,F,B,N),r&&(r.faceIndex=Math.floor(T/3),r.face.materialIndex=A.materialIndex,t.push(r))}}else{let b=Math.max(0,v.start),w=Math.min(s.count,v.start+v.count);for(let A=b,E=w;A<E;A+=3){let I=s.getX(A),C=s.getX(A+1),T=s.getX(A+2);r=Ey(this,o,e,n,h,d,f,I,C,T),r&&(r.faceIndex=Math.floor(A/3),t.push(r))}}else if(u!==void 0)if(Array.isArray(o))for(let b=0,w=m.length;b<w;b++){let A=m[b],E=o[A.materialIndex],I=Math.max(A.start,v.start),C=Math.min(u.count,Math.min(A.start+A.count,v.start+v.count));for(let T=I,k=C;T<k;T+=3){let F=T,B=T+1,N=T+2;r=Ey(this,E,e,n,h,d,f,F,B,N),r&&(r.faceIndex=Math.floor(T/3),r.face.materialIndex=A.materialIndex,t.push(r))}}else{let b=Math.max(0,v.start),w=Math.min(u.count,v.start+v.count);for(let A=b,E=w;A<E;A+=3){let I=A,C=A+1,T=A+2;r=Ey(this,o,e,n,h,d,f,I,C,T),r&&(r.faceIndex=Math.floor(A/3),t.push(r))}}}};l(sO,"Mesh");var ln=sO;function lO(i,e,t,n,r,a,o,s){let u;if(e.side===Eo?u=n.intersectTriangle(o,a,r,!0,s):u=n.intersectTriangle(r,a,o,e.side===su,s),u===null)return null;W0.copy(s),W0.applyMatrix4(i.matrixWorld);let h=t.ray.origin.distanceTo(W0);return h<t.near||h>t.far?null:{distance:h,point:W0.clone(),object:i}}l(lO,"checkIntersection$1");function Ey(i,e,t,n,r,a,o,s,u,h){i.getVertexPosition(s,j0),i.getVertexPosition(u,G0),i.getVertexPosition(h,$0);let d=lO(i,e,t,n,j0,G0,$0,J6);if(d){let f=new Ee;df.getBarycoord(J6,j0,G0,$0,f),r&&(d.uv=df.getInterpolatedAttribute(r,s,u,h,f,new ft)),a&&(d.uv1=df.getInterpolatedAttribute(a,s,u,h,f,new ft)),o&&(d.normal=df.getInterpolatedAttribute(o,s,u,h,f,new Ee),d.normal.dot(n.direction)>0&&d.normal.multiplyScalar(-1));let m={a:s,b:u,c:h,normal:new Ee,materialIndex:0};df.getNormal(j0,G0,$0,m.normal),d.face=m,d.barycoord=f}return d}l(Ey,"checkGeometryIntersection");var uO=class hO extends Sa{constructor(e=1,t=1,n=1,r=1,a=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:a,depthSegments:o};let s=this;r=Math.floor(r),a=Math.floor(a),o=Math.floor(o);let u=[],h=[],d=[],f=[],m=0,v=0;b("z","y","x",-1,-1,n,t,e,o,a,0),b("z","y","x",1,-1,n,t,-e,o,a,1),b("x","z","y",1,1,e,n,t,r,o,2),b("x","z","y",1,-1,e,n,-t,r,o,3),b("x","y","z",1,-1,e,t,n,r,a,4),b("x","y","z",-1,-1,e,t,-n,r,a,5),this.setIndex(u),this.setAttribute("position",new Fr(h,3)),this.setAttribute("normal",new Fr(d,3)),this.setAttribute("uv",new Fr(f,2));function b(w,A,E,I,C,T,k,F,B,N,z){let L=T/B,j=k/N,q=T/2,Z=k/2,O=F/2,Y=B+1,J=N+1,oe=0,$=0,K=new Ee;for(let te=0;te<J;te++){let ve=te*j-Z;for(let Q=0;Q<Y;Q++){let he=Q*L-q;K[w]=he*I,K[A]=ve*C,K[E]=O,h.push(K.x,K.y,K.z),K[w]=0,K[A]=0,K[E]=F>0?1:-1,d.push(K.x,K.y,K.z),f.push(Q/B),f.push(1-te/N),oe+=1}}for(let te=0;te<N;te++)for(let ve=0;ve<B;ve++){let Q=m+ve+Y*te,he=m+ve+Y*(te+1),se=m+(ve+1)+Y*(te+1),Ae=m+(ve+1)+Y*te;u.push(Q,he,Ae),u.push(he,se,Ae),$+=6}s.addGroup(v,$,z),v+=$,m+=oe}l(b,"buildPlane")}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new hO(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};l(uO,"BoxGeometry");var Nc=uO;function dd(i){let e={};for(let t in i){e[t]={};for(let n in i[t]){let r=i[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}l(dd,"cloneUniforms");function Qa(i){let e={};for(let t=0;t<i.length;t++){let n=dd(i[t]);for(let r in n)e[r]=n[r]}return e}l(Qa,"mergeUniforms");function cO(i){let e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}l(cO,"cloneUniformsGroups");function FP(i){let e=i.getRenderTarget();return e===null?i.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:kn.workingColorSpace}l(FP,"getUnlitUniformColorSpace");var ace={clone:dd,merge:Qa},oce=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,sce=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,pO=class extends Hc{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=oce,this.fragmentShader=sce,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=dd(e.uniforms),this.uniformsGroups=cO(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let r in this.uniforms){let a=this.uniforms[r].value;a&&a.isTexture?t.uniforms[r]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[r]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[r]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[r]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[r]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[r]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[r]={type:"m4",value:a.toArray()}:t.uniforms[r]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;let n={};for(let r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}};l(pO,"ShaderMaterial");var ys=pO,dO=class extends vr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new qi,this.projectionMatrix=new qi,this.projectionMatrixInverse=new qi,this.coordinateSystem=lh}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};l(dO,"Camera");var BP=dO,Bh=new Ee,K6=new ft,Q6=new ft,fO=class extends BP{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=ag*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(Rm*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return ag*2*Math.atan(Math.tan(Rm*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){Bh.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Bh.x,Bh.y).multiplyScalar(-e/Bh.z),Bh.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Bh.x,Bh.y).multiplyScalar(-e/Bh.z)}getViewSize(e,t){return this.getViewBounds(e,K6,Q6),t.subVectors(Q6,K6)}setViewOffset(e,t,n,r,a,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=a,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(Rm*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,a=-.5*r,o=this.view;if(this.view!==null&&this.view.enabled){let u=o.fullWidth,h=o.fullHeight;a+=o.offsetX*r/u,t-=o.offsetY*n/h,r*=o.width/u,n*=o.height/h}let s=this.filmOffset;s!==0&&(a+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+r,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}};l(fO,"PerspectiveCamera");var Ao=fO,tf=-90,nf=1,mO=class extends vr{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;let r=new Ao(tf,nf,e,t);r.layers=this.layers,this.add(r);let a=new Ao(tf,nf,e,t);a.layers=this.layers,this.add(a);let o=new Ao(tf,nf,e,t);o.layers=this.layers,this.add(o);let s=new Ao(tf,nf,e,t);s.layers=this.layers,this.add(s);let u=new Ao(tf,nf,e,t);u.layers=this.layers,this.add(u);let h=new Ao(tf,nf,e,t);h.layers=this.layers,this.add(h)}updateCoordinateSystem(){let e=this.coordinateSystem,t=this.children.concat(),[n,r,a,o,s,u]=t;for(let h of t)this.remove(h);if(e===lh)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),a.up.set(0,0,-1),a.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),s.up.set(0,1,0),s.lookAt(0,0,1),u.up.set(0,1,0),u.lookAt(0,0,-1);else if(e===z2)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),a.up.set(0,0,1),a.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),s.up.set(0,-1,0),s.lookAt(0,0,1),u.up.set(0,-1,0),u.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(let h of t)this.add(h),h.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();let{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());let[a,o,s,u,h,d]=this.children,f=e.getRenderTarget(),m=e.getActiveCubeFace(),v=e.getActiveMipmapLevel(),b=e.xr.enabled;e.xr.enabled=!1;let w=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,a),e.setRenderTarget(n,1,r),e.render(t,o),e.setRenderTarget(n,2,r),e.render(t,s),e.setRenderTarget(n,3,r),e.render(t,u),e.setRenderTarget(n,4,r),e.render(t,h),n.texture.generateMipmaps=w,e.setRenderTarget(n,5,r),e.render(t,d),e.setRenderTarget(f,m,v),e.xr.enabled=b,n.texture.needsPMREMUpdate=!0}};l(mO,"CubeCamera");var lce=mO,gO=class extends Zo{constructor(e,t,n,r,a,o,s,u,h,d){e=e!==void 0?e:[],t=t!==void 0?t:tg,super(e,t,n,r,a,o,s,u,h,d),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}};l(gO,"CubeTexture");var yO=gO,vO=class extends Oc{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new yO(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Yl}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new Nc(5,5,5),a=new ys({name:"CubemapFromEquirect",uniforms:dd(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:Eo,blending:Ic});a.uniforms.tEquirect.value=t;let o=new ln(r,a),s=t.minFilter;return t.minFilter===Yp&&(t.minFilter=Yl),new lce(1,10,this).update(e,o),t.minFilter=s,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,r){let a=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,r);e.setRenderTarget(a)}};l(vO,"WebGLCubeRenderTarget");var uce=vO,_O=class extends vr{constructor(){super(),this.isGroup=!0,this.type="Group"}};l(_O,"Group");var q0=_O,hce={type:"move"},xO=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new q0,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new q0,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ee,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ee),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new q0,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ee,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ee),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,a=null,o=null,s=this._targetRay,u=this._grip,h=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(h&&e.hand){o=!0;for(let w of e.hand.values()){let A=t.getJointPose(w,n),E=this._getHandJoint(h,w);A!==null&&(E.matrix.fromArray(A.transform.matrix),E.matrix.decompose(E.position,E.rotation,E.scale),E.matrixWorldNeedsUpdate=!0,E.jointRadius=A.radius),E.visible=A!==null}let d=h.joints["index-finger-tip"],f=h.joints["thumb-tip"],m=d.position.distanceTo(f.position),v=.02,b=.005;h.inputState.pinching&&m>v+b?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!h.inputState.pinching&&m<=v-b&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else u!==null&&e.gripSpace&&(a=t.getPose(e.gripSpace,n),a!==null&&(u.matrix.fromArray(a.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),u.matrixWorldNeedsUpdate=!0,a.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(a.linearVelocity)):u.hasLinearVelocity=!1,a.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(a.angularVelocity)):u.hasAngularVelocity=!1));s!==null&&(r=t.getPose(e.targetRaySpace,n),r===null&&a!==null&&(r=a),r!==null&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,r.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(r.linearVelocity)):s.hasLinearVelocity=!1,r.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(r.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(hce)))}return s!==null&&(s.visible=r!==null),u!==null&&(u.visible=a!==null),h!==null&&(h.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){let n=new q0;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}};l(xO,"WebXRController");var ES=xO,bO=class extends vr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Wo,this.environmentIntensity=1,this.environmentRotation=new Wo,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}};l(bO,"Scene");var zP=bO,wO=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=_C,this.updateRanges=[],this.version=0,this.uuid=gs()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,a=this.stride;r<a;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=gs()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=gs()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}};l(wO,"InterleavedBuffer");var VTe=wO,vo=new Ee,AO=class SO{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)vo.fromBufferAttribute(this,t),vo.applyMatrix4(e),this.setXYZ(t,vo.x,vo.y,vo.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)vo.fromBufferAttribute(this,t),vo.applyNormalMatrix(e),this.setXYZ(t,vo.x,vo.y,vo.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)vo.fromBufferAttribute(this,t),vo.transformDirection(e),this.setXYZ(t,vo.x,vo.y,vo.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=Ns(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Un(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=Un(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Un(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Un(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Un(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Ns(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Ns(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Ns(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Ns(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Un(t,this.array),n=Un(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Un(t,this.array),n=Un(n,this.array),r=Un(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,a){return e=e*this.data.stride+this.offset,this.normalized&&(t=Un(t,this.array),n=Un(n,this.array),r=Un(r,this.array),a=Un(a,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=a,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let n=0;n<this.count;n++){let r=n*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)t.push(this.data.array[r+a])}return new gr(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new SO(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let n=0;n<this.count;n++){let r=n*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)t.push(this.data.array[r+a])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}};l(AO,"InterleavedBufferAttribute");var jTe=AO,ek=new Ee,tk=new jn,ik=new jn,cce=new Ee,nk=new qi,X0=new Ee,IS=new Ho,rk=new qi,TS=new $1,MO=class extends ln{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=L6,this.bindMatrix=new qi,this.bindMatrixInverse=new qi,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){let e=this.geometry;this.boundingBox===null&&(this.boundingBox=new ur),this.boundingBox.makeEmpty();let t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,X0),this.boundingBox.expandByPoint(X0)}computeBoundingSphere(){let e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Ho),this.boundingSphere.makeEmpty();let t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,X0),this.boundingSphere.expandByPoint(X0)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){let n=this.material,r=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),IS.copy(this.boundingSphere),IS.applyMatrix4(r),e.ray.intersectsSphere(IS)!==!1&&(rk.copy(r).invert(),TS.copy(e.ray).applyMatrix4(rk),!(this.boundingBox!==null&&TS.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,TS)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let e=new jn,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);let a=1/e.manhattanLength();a!==1/0?e.multiplyScalar(a):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===L6?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===Ihe?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){let n=this.skeleton,r=this.geometry;tk.fromBufferAttribute(r.attributes.skinIndex,e),ik.fromBufferAttribute(r.attributes.skinWeight,e),ek.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let a=0;a<4;a++){let o=ik.getComponent(a);if(o!==0){let s=tk.getComponent(a);nk.multiplyMatrices(n.bones[s].matrixWorld,n.boneInverses[s]),t.addScaledVector(cce.copy(ek).applyMatrix4(nk),o)}}return t.applyMatrix4(this.bindMatrixInverse)}};l(MO,"SkinnedMesh");var $Te=MO,CO=class extends vr{constructor(){super(),this.isBone=!0,this.type="Bone"}};l(CO,"Bone");var pce=CO,EO=class extends Zo{constructor(e=null,t=1,n=1,r,a,o,s,u,h=ms,d=ms,f,m){super(null,o,s,u,h,d,r,a,f,m),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};l(EO,"DataTexture");var Nm=EO,ak=new qi,dce=new qi,IO=class TO{constructor(e=[],t=[]){this.uuid=gs(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new qi)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let n=new qi;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){let e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let a=0,o=e.length;a<o;a++){let s=e[a]?e[a].matrixWorld:dce;ak.multiplyMatrices(s,t[a]),ak.toArray(n,a*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new TO(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let n=new Nm(t,e,e,ao,hs);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){let r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){let a=e.bones[n],o=t[a];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",a),o=new pce),this.bones.push(o),this.boneInverses.push(new qi().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){let e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,n=this.boneInverses;for(let r=0,a=t.length;r<a;r++){let o=t[r];e.bones.push(o.uuid);let s=n[r];e.boneInverses.push(s.toArray())}return e}};l(IO,"Skeleton");var qTe=IO,PO=class extends gr{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}};l(PO,"InstancedBufferAttribute");var ok=PO,rf=new qi,sk=new qi,Z0=[],lk=new ur,fce=new qi,uy=new ln,hy=new Ho,LO=class extends ln{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new ok(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<n;r++)this.setMatrixAt(r,fce)}computeBoundingBox(){let e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new ur),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,rf),lk.copy(e.boundingBox).applyMatrix4(rf),this.boundingBox.union(lk)}computeBoundingSphere(){let e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new Ho),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,rf),hy.copy(e.boundingSphere).applyMatrix4(rf),this.boundingSphere.union(hy)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){let n=t.morphTargetInfluences,r=this.morphTexture.source.data.data,a=n.length+1,o=e*a+1;for(let s=0;s<n.length;s++)n[s]=r[o+s]}raycast(e,t){let n=this.matrixWorld,r=this.count;if(uy.geometry=this.geometry,uy.material=this.material,uy.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),hy.copy(this.boundingSphere),hy.applyMatrix4(n),e.ray.intersectsSphere(hy)!==!1))for(let a=0;a<r;a++){this.getMatrixAt(a,rf),sk.multiplyMatrices(n,rf),uy.matrixWorld=sk,uy.raycast(e,Z0);for(let o=0,s=Z0.length;o<s;o++){let u=Z0[o];u.instanceId=a,u.object=this,t.push(u)}Z0.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new ok(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){let n=t.morphTargetInfluences,r=n.length+1;this.morphTexture===null&&(this.morphTexture=new Nm(new Float32Array(r*this.count),r,this.count,LP,hs));let a=this.morphTexture.source.data.data,o=0;for(let h=0;h<n.length;h++)o+=n[h];let s=this.geometry.morphTargetsRelative?1:1-o,u=r*e;a[u]=s,a.set(n,u+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}};l(LO,"InstancedMesh");var U2=LO,PS=new Ee,mce=new Ee,gce=new fn,DO=class{constructor(e=new Ee(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){let r=PS.subVectors(n,t).cross(mce.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){let n=e.delta(PS),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let a=-(e.start.dot(this.normal)+this.constant)/r;return a<0||a>1?null:t.copy(e.start).addScaledVector(n,a)}intersectsLine(e){let t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let n=t||gce.getNormalMatrix(e),r=this.coplanarPoint(PS).applyMatrix4(e),a=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}};l(DO,"Plane");var gp=DO,lp=new Ho,Y0=new Ee,kO=class{constructor(e=new gp,t=new gp,n=new gp,r=new gp,a=new gp,o=new gp){this.planes=[e,t,n,r,a,o]}set(e,t,n,r,a,o){let s=this.planes;return s[0].copy(e),s[1].copy(t),s[2].copy(n),s[3].copy(r),s[4].copy(a),s[5].copy(o),this}copy(e){let t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=lh){let n=this.planes,r=e.elements,a=r[0],o=r[1],s=r[2],u=r[3],h=r[4],d=r[5],f=r[6],m=r[7],v=r[8],b=r[9],w=r[10],A=r[11],E=r[12],I=r[13],C=r[14],T=r[15];if(n[0].setComponents(u-a,m-h,A-v,T-E).normalize(),n[1].setComponents(u+a,m+h,A+v,T+E).normalize(),n[2].setComponents(u+o,m+d,A+b,T+I).normalize(),n[3].setComponents(u-o,m-d,A-b,T-I).normalize(),n[4].setComponents(u-s,m-f,A-w,T-C).normalize(),t===lh)n[5].setComponents(u+s,m+f,A+w,T+C).normalize();else if(t===z2)n[5].setComponents(s,f,w,C).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),lp.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{let t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),lp.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(lp)}intersectsSprite(e){return lp.center.set(0,0,0),lp.radius=.7071067811865476,lp.applyMatrix4(e.matrixWorld),this.intersectsSphere(lp)}intersectsSphere(e){let t=this.planes,n=e.center,r=-e.radius;for(let a=0;a<6;a++)if(t[a].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){let t=this.planes;for(let n=0;n<6;n++){let r=t[n];if(Y0.x=r.normal.x>0?e.max.x:e.min.x,Y0.y=r.normal.y>0?e.max.y:e.min.y,Y0.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Y0)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};l(kO,"Frustum");var H1=kO;function Z_(i,e){return i-e}l(Z_,"ascIdSort");function RO(i,e){return i.z-e.z}l(RO,"sortOpaque");function OO(i,e){return e.z-i.z}l(OO,"sortTransparent");var NO=class{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,r){let a=this.pool,o=this.list;this.index>=a.length&&a.push({start:-1,count:-1,z:-1,index:-1});let s=a[this.index];o.push(s),this.index++,s.start=e,s.count=t,s.z=n,s.index=r}reset(){this.list.length=0,this.index=0}};l(NO,"MultiDrawRenderList");var yce=NO,Ro=new qi,vce=new Mi(1,1,1),LS=new H1,J0=new ur,up=new Ho,cy=new Ee,uk=new Ee,_ce=new Ee,DS=new yce,Ja=new ln,K0=[];function FO(i,e,t=0){let n=e.itemSize;if(i.isInterleavedBufferAttribute||i.array.constructor!==e.array.constructor){let r=i.count;for(let a=0;a<r;a++)for(let o=0;o<n;o++)e.setComponent(a+t,o,i.getComponent(a,o))}else e.array.set(i.array,t*n);e.needsUpdate=!0}l(FO,"copyAttributeData");function Hh(i,e){if(i.constructor!==e.constructor){let t=Math.min(i.length,e.length);for(let n=0;n<t;n++)e[n]=i[n]}else{let t=Math.min(i.length,e.length);e.set(new i.constructor(i.buffer,0,t))}}l(Hh,"copyArrayContents");var BO=class extends ln{get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}constructor(e,t,n=t*2,r){super(new Sa,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);let t=new Float32Array(e*e*4),n=new Nm(t,e,e,ao,hs);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);let t=new Uint32Array(e*e),n=new Nm(t,e,e,Vw,Rc);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);let t=new Float32Array(e*e*4).fill(1),n=new Nm(t,e,e,ao,hs);n.colorSpace=kn.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){let t=this.geometry,n=this._maxVertexCount,r=this._maxIndexCount;if(this._geometryInitialized===!1){for(let a in e.attributes){let o=e.getAttribute(a),{array:s,itemSize:u,normalized:h}=o,d=new s.constructor(n*u),f=new gr(d,u,h);t.setAttribute(a,f)}if(e.getIndex()!==null){let a=n>65535?new Uint32Array(r):new Uint16Array(r);t.setIndex(new gr(a,1))}this._geometryInitialized=!0}}_validateGeometry(e){let t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(let n in t.attributes){if(!e.hasAttribute(n))throw new Error('THREE.BatchedMesh: Added geometry missing "'.concat(n,'". All geometries must have consistent attributes.'));let r=e.getAttribute(n),a=t.getAttribute(n);if(r.itemSize!==a.itemSize||r.normalized!==a.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){let t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error("THREE.BatchedMesh: Invalid instanceId ".concat(e,". Instance is either out of range or has been deleted."))}validateGeometryId(e){let t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error("THREE.BatchedMesh: Invalid geometryId ".concat(e,". Geometry is either out of range or has been deleted."))}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ur);let e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(t[n].active===!1)continue;let a=t[n].geometryIndex;this.getMatrixAt(n,Ro),this.getBoundingBoxAt(a,J0).applyMatrix4(Ro),e.union(J0)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ho);let e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(t[n].active===!1)continue;let a=t[n].geometryIndex;this.getMatrixAt(n,Ro),this.getBoundingSphereAt(a,up).applyMatrix4(Ro),e.union(up)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");let t={visible:!0,active:!0,geometryIndex:e},n=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(Z_),n=this._availableInstanceIds.shift(),this._instanceInfo[n]=t):(n=this._instanceInfo.length,this._instanceInfo.push(t));let r=this._matricesTexture;Ro.identity().toArray(r.image.data,n*16),r.needsUpdate=!0;let a=this._colorsTexture;return a&&(vce.toArray(a.image.data,n*4),a.needsUpdate=!0),this._visibilityChanged=!0,n}addGeometry(e,t=-1,n=-1){this._initializeGeometry(e),this._validateGeometry(e);let r={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},a=this._geometryInfo;r.vertexStart=this._nextVertexStart,r.reservedVertexCount=t===-1?e.getAttribute("position").count:t;let o=e.getIndex();if(o!==null&&(r.indexStart=this._nextIndexStart,r.reservedIndexCount=n===-1?o.count:n),r.indexStart!==-1&&r.indexStart+r.reservedIndexCount>this._maxIndexCount||r.vertexStart+r.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let s;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(Z_),s=this._availableGeometryIds.shift(),a[s]=r):(s=this._geometryCount,this._geometryCount++,a.push(r)),this.setGeometryAt(s,e),this._nextIndexStart=r.indexStart+r.reservedIndexCount,this._nextVertexStart=r.vertexStart+r.reservedVertexCount,s}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);let n=this.geometry,r=n.getIndex()!==null,a=n.getIndex(),o=t.getIndex(),s=this._geometryInfo[e];if(r&&o.count>s.reservedIndexCount||t.attributes.position.count>s.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");let u=s.vertexStart,h=s.reservedVertexCount;s.vertexCount=t.getAttribute("position").count;for(let d in n.attributes){let f=t.getAttribute(d),m=n.getAttribute(d);FO(f,m,u);let v=f.itemSize;for(let b=f.count,w=h;b<w;b++){let A=u+b;for(let E=0;E<v;E++)m.setComponent(A,E,0)}m.needsUpdate=!0,m.addUpdateRange(u*v,h*v)}if(r){let d=s.indexStart,f=s.reservedIndexCount;s.indexCount=t.getIndex().count;for(let m=0;m<o.count;m++)a.setX(d+m,u+o.getX(m));for(let m=o.count,v=f;m<v;m++)a.setX(d+m,u);a.needsUpdate=!0,a.addUpdateRange(d,s.reservedIndexCount)}return s.start=r?s.indexStart:s.vertexStart,s.count=r?s.indexCount:s.vertexCount,s.boundingBox=null,t.boundingBox!==null&&(s.boundingBox=t.boundingBox.clone()),s.boundingSphere=null,t.boundingSphere!==null&&(s.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){let t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;let n=this._instanceInfo;for(let r=0,a=n.length;r<a;r++)n[r].active&&n[r].geometryIndex===e&&this.deleteInstance(r);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0,n=this._geometryInfo,r=n.map((o,s)=>s).sort((o,s)=>n[o].vertexStart-n[s].vertexStart),a=this.geometry;for(let o=0,s=n.length;o<s;o++){let u=r[o],h=n[u];if(h.active!==!1){if(a.index!==null){if(h.indexStart!==t){let{indexStart:d,vertexStart:f,reservedIndexCount:m}=h,v=a.index,b=v.array,w=e-f;for(let A=d;A<d+m;A++)b[A]=b[A]+w;v.array.copyWithin(t,d,d+m),v.addUpdateRange(t,m),h.indexStart=t}t+=h.reservedIndexCount}if(h.vertexStart!==e){let{vertexStart:d,reservedVertexCount:f}=h,m=a.attributes;for(let v in m){let b=m[v],{array:w,itemSize:A}=b;w.copyWithin(e*A,d*A,(d+f)*A),b.addUpdateRange(e*A,f*A)}h.vertexStart=e}e+=h.reservedVertexCount,h.start=a.index?h.indexStart:h.vertexStart,this._nextIndexStart=a.index?h.indexStart+h.reservedIndexCount:0,this._nextVertexStart=h.vertexStart+h.reservedVertexCount}}return this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;let n=this.geometry,r=this._geometryInfo[e];if(r.boundingBox===null){let a=new ur,o=n.index,s=n.attributes.position;for(let u=r.start,h=r.start+r.count;u<h;u++){let d=u;o&&(d=o.getX(d)),a.expandByPoint(cy.fromBufferAttribute(s,d))}r.boundingBox=a}return t.copy(r.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;let n=this.geometry,r=this._geometryInfo[e];if(r.boundingSphere===null){let a=new Ho;this.getBoundingBoxAt(e,J0),J0.getCenter(a.center);let o=n.index,s=n.attributes.position,u=0;for(let h=r.start,d=r.start+r.count;h<d;h++){let f=h;o&&(f=o.getX(f)),cy.fromBufferAttribute(s,f),u=Math.max(u,a.center.distanceToSquared(cy))}a.radius=Math.sqrt(u),r.boundingSphere=a}return t.copy(r.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);let n=this._matricesTexture,r=this._matricesTexture.image.data;return t.toArray(r,e*16),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);let n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){let t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(Z_);t[t.length-1]===n.length;)n.pop(),t.pop();if(e<n.length)throw new Error("BatchedMesh: Instance ids outside the range ".concat(e," are being used. Cannot shrink instance count."));let r=new Int32Array(e),a=new Int32Array(e);Hh(this._multiDrawCounts,r),Hh(this._multiDrawStarts,a),this._multiDrawCounts=r,this._multiDrawStarts=a,this._maxInstanceCount=e;let o=this._indirectTexture,s=this._matricesTexture,u=this._colorsTexture;o.dispose(),this._initIndirectTexture(),Hh(o.image.data,this._indirectTexture.image.data),s.dispose(),this._initMatricesTexture(),Hh(s.image.data,this._matricesTexture.image.data),u&&(u.dispose(),this._initColorsTexture(),Hh(u.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){let n=[...this._geometryInfo].filter(o=>o.active);if(Math.max(...n.map(o=>o.vertexStart+o.reservedVertexCount))>e)throw new Error("BatchedMesh: Geometry vertex values are being used outside the range ".concat(t,". Cannot shrink further."));if(this.geometry.index&&Math.max(...n.map(o=>o.indexStart+o.reservedIndexCount))>t)throw new Error("BatchedMesh: Geometry index values are being used outside the range ".concat(t,". Cannot shrink further."));let r=this.geometry;r.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new Sa,this._initializeGeometry(r));let a=this.geometry;r.index&&Hh(r.index.array,a.index.array);for(let o in r.attributes)Hh(r.attributes[o].array,a.attributes[o].array)}raycast(e,t){let n=this._instanceInfo,r=this._geometryInfo,a=this.matrixWorld,o=this.geometry;Ja.material=this.material,Ja.geometry.index=o.index,Ja.geometry.attributes=o.attributes,Ja.geometry.boundingBox===null&&(Ja.geometry.boundingBox=new ur),Ja.geometry.boundingSphere===null&&(Ja.geometry.boundingSphere=new Ho);for(let s=0,u=n.length;s<u;s++){if(!n[s].visible||!n[s].active)continue;let h=n[s].geometryIndex,d=r[h];Ja.geometry.setDrawRange(d.start,d.count),this.getMatrixAt(s,Ja.matrixWorld).premultiply(a),this.getBoundingBoxAt(h,Ja.geometry.boundingBox),this.getBoundingSphereAt(h,Ja.geometry.boundingSphere),Ja.raycast(e,K0);for(let f=0,m=K0.length;f<m;f++){let v=K0[f];v.object=this,v.batchId=s,t.push(v)}K0.length=0}Ja.material=null,Ja.geometry.index=null,Ja.geometry.attributes={},Ja.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>lt(Me({},t),{boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>Me({},t)),this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null),this}onBeforeRender(e,t,n,r,a){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;let o=r.getIndex(),s=o===null?1:o.array.BYTES_PER_ELEMENT,u=this._instanceInfo,h=this._multiDrawStarts,d=this._multiDrawCounts,f=this._geometryInfo,m=this.perObjectFrustumCulled,v=this._indirectTexture,b=v.image.data;m&&(Ro.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),LS.setFromProjectionMatrix(Ro,e.coordinateSystem));let w=0;if(this.sortObjects){Ro.copy(this.matrixWorld).invert(),cy.setFromMatrixPosition(n.matrixWorld).applyMatrix4(Ro),uk.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(Ro);for(let I=0,C=u.length;I<C;I++)if(u[I].visible&&u[I].active){let T=u[I].geometryIndex;this.getMatrixAt(I,Ro),this.getBoundingSphereAt(T,up).applyMatrix4(Ro);let k=!1;if(m&&(k=!LS.intersectsSphere(up)),!k){let F=f[T],B=_ce.subVectors(up.center,cy).dot(uk);DS.push(F.start,F.count,B,I)}}let A=DS.list,E=this.customSort;E===null?A.sort(a.transparent?OO:RO):E.call(this,A,n);for(let I=0,C=A.length;I<C;I++){let T=A[I];h[w]=T.start*s,d[w]=T.count,b[w]=T.index,w++}DS.reset()}else for(let A=0,E=u.length;A<E;A++)if(u[A].visible&&u[A].active){let I=u[A].geometryIndex,C=!1;if(m&&(this.getMatrixAt(A,Ro),this.getBoundingSphereAt(I,up).applyMatrix4(Ro),C=!LS.intersectsSphere(up)),!C){let T=f[I];h[w]=T.start*s,d[w]=T.count,b[w]=A,w++}}v.needsUpdate=!0,this._multiDrawCount=w,this._visibilityChanged=!1}onBeforeShadow(e,t,n,r,a,o){this.onBeforeRender(e,null,r,a,o)}};l(BO,"BatchedMesh");var UP=BO,zO=class extends Hc{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Mi(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}};l(zO,"LineBasicMaterial");var VP=zO,V2=new Ee,j2=new Ee,hk=new qi,py=new $1,Q0=new Ho,kS=new Ee,ck=new Ee,UO=class extends vr{constructor(e=new Sa,t=new VP){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,n=[0];for(let r=1,a=t.count;r<a;r++)V2.fromBufferAttribute(t,r-1),j2.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=V2.distanceTo(j2);e.setAttribute("lineDistance",new Fr(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let n=this.geometry,r=this.matrixWorld,a=e.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Q0.copy(n.boundingSphere),Q0.applyMatrix4(r),Q0.radius+=a,e.ray.intersectsSphere(Q0)===!1)return;hk.copy(r).invert(),py.copy(e.ray).applyMatrix4(hk);let s=a/((this.scale.x+this.scale.y+this.scale.z)/3),u=s*s,h=this.isLineSegments?2:1,d=n.index,f=n.attributes.position;if(d!==null){let m=Math.max(0,o.start),v=Math.min(d.count,o.start+o.count);for(let b=m,w=v-1;b<w;b+=h){let A=d.getX(b),E=d.getX(b+1),I=Iy(this,e,py,u,A,E,b);I&&t.push(I)}if(this.isLineLoop){let b=d.getX(v-1),w=d.getX(m),A=Iy(this,e,py,u,b,w,v-1);A&&t.push(A)}}else{let m=Math.max(0,o.start),v=Math.min(f.count,o.start+o.count);for(let b=m,w=v-1;b<w;b+=h){let A=Iy(this,e,py,u,b,b+1,b);A&&t.push(A)}if(this.isLineLoop){let b=Iy(this,e,py,u,v-1,m,v-1);b&&t.push(b)}}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let n=e[t[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,a=n.length;r<a;r++){let o=n[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=r}}}}};l(UO,"Line");var VO=UO;function Iy(i,e,t,n,r,a,o){let s=i.geometry.attributes.position;if(V2.fromBufferAttribute(s,r),j2.fromBufferAttribute(s,a),t.distanceSqToSegment(V2,j2,kS,ck)>n)return;kS.applyMatrix4(i.matrixWorld);let u=e.ray.origin.distanceTo(kS);if(!(u<e.near||u>e.far))return{distance:u,point:ck.clone().applyMatrix4(i.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:i}}l(Iy,"checkIntersection");var pk=new Ee,dk=new Ee,jO=class extends VO{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,n=[];for(let r=0,a=t.count;r<a;r+=2)pk.fromBufferAttribute(t,r),dk.fromBufferAttribute(t,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+pk.distanceTo(dk);e.setAttribute("lineDistance",new Fr(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}};l(jO,"LineSegments");var Gw=jO,GO=class extends VO{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}};l(GO,"LineLoop");var rPe=GO,$O=class extends Hc{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Mi(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}};l($O,"PointsMaterial");var xce=$O,fk=new qi,wC=new $1,e_=new Ho,t_=new Ee,HO=class extends vr{constructor(e=new Sa,t=new xce){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){let n=this.geometry,r=this.matrixWorld,a=e.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),e_.copy(n.boundingSphere),e_.applyMatrix4(r),e_.radius+=a,e.ray.intersectsSphere(e_)===!1)return;fk.copy(r).invert(),wC.copy(e.ray).applyMatrix4(fk);let s=a/((this.scale.x+this.scale.y+this.scale.z)/3),u=s*s,h=n.index,d=n.attributes.position;if(h!==null){let f=Math.max(0,o.start),m=Math.min(h.count,o.start+o.count);for(let v=f,b=m;v<b;v++){let w=h.getX(v);t_.fromBufferAttribute(d,w),AC(t_,w,u,r,e,t,this)}}else{let f=Math.max(0,o.start),m=Math.min(d.count,o.start+o.count);for(let v=f,b=m;v<b;v++)t_.fromBufferAttribute(d,v),AC(t_,v,u,r,e,t,this)}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let n=e[t[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,a=n.length;r<a;r++){let o=n[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=r}}}}};l(HO,"Points");var sPe=HO;function AC(i,e,t,n,r,a,o){let s=wC.distanceSqToPoint(i);if(s<t){let u=new Ee;wC.closestPointToPoint(i,u),u.applyMatrix4(n);let h=r.ray.origin.distanceTo(u);if(h<r.near||h>r.far)return;a.push({distance:h,distanceToRay:Math.sqrt(s),point:u,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}l(AC,"testPoint");var WO=class extends Zo{constructor(e,t,n,r,a,o,s,u,h,d,f,m){super(null,o,s,u,h,d,r,a,f,m),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}};l(WO,"CompressedTexture");var uPe=WO,qO=class extends Zo{constructor(e,t,n,r,a,o,s,u,h,d=km){if(d!==km&&d!==rg)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&d===km&&(n=Rc),n===void 0&&d===rg&&(n=ng),super(null,r,a,o,s,u,d,n,h),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=s!==void 0?s:ms,this.minFilter=u!==void 0?u:ms,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){let t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}};l(qO,"DepthTexture");var XO=qO,ZO=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){let t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){let t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],n,r=this.getPoint(0),a=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),a+=n.distanceTo(r),t.push(a),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let n=this.getLengths(),r=0,a=n.length,o;t?o=t:o=e*n[a-1];let s=0,u=a-1,h;for(;s<=u;)if(r=Math.floor(s+(u-s)/2),h=n[r]-o,h<0)s=r+1;else if(h>0)u=r-1;else{u=r;break}if(r=u,n[r]===o)return r/(a-1);let d=n[r],f=n[r+1]-d,m=(o-d)/f;return(r+m)/(a-1)}getTangent(e,t){let n=e-1e-4,r=e+1e-4;n<0&&(n=0),r>1&&(r=1);let a=this.getPoint(n),o=this.getPoint(r),s=t||(a.isVector2?new ft:new Ee);return s.copy(o).sub(a).normalize(),s}getTangentAt(e,t){let n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){let n=new Ee,r=[],a=[],o=[],s=new Ee,u=new qi;for(let v=0;v<=e;v++){let b=v/e;r[v]=this.getTangentAt(b,new Ee)}a[0]=new Ee,o[0]=new Ee;let h=Number.MAX_VALUE,d=Math.abs(r[0].x),f=Math.abs(r[0].y),m=Math.abs(r[0].z);d<=h&&(h=d,n.set(1,0,0)),f<=h&&(h=f,n.set(0,1,0)),m<=h&&n.set(0,0,1),s.crossVectors(r[0],n).normalize(),a[0].crossVectors(r[0],s),o[0].crossVectors(r[0],a[0]);for(let v=1;v<=e;v++){if(a[v]=a[v-1].clone(),o[v]=o[v-1].clone(),s.crossVectors(r[v-1],r[v]),s.length()>Number.EPSILON){s.normalize();let b=Math.acos(sn(r[v-1].dot(r[v]),-1,1));a[v].applyMatrix4(u.makeRotationAxis(s,b))}o[v].crossVectors(r[v],a[v])}if(t===!0){let v=Math.acos(sn(a[0].dot(a[e]),-1,1));v/=e,r[0].dot(s.crossVectors(a[0],a[e]))>0&&(v=-v);for(let b=1;b<=e;b++)a[b].applyMatrix4(u.makeRotationAxis(r[b],v*b)),o[b].crossVectors(r[b],a[b])}return{tangents:r,normals:a,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}};l(ZO,"Curve");var du=ZO,YO=class extends du{constructor(e=0,t=0,n=1,r=1,a=0,o=Math.PI*2,s=!1,u=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=a,this.aEndAngle=o,this.aClockwise=s,this.aRotation=u}getPoint(e,t=new ft){let n=t,r=Math.PI*2,a=this.aEndAngle-this.aStartAngle,o=Math.abs(a)<Number.EPSILON;for(;a<0;)a+=r;for(;a>r;)a-=r;a<Number.EPSILON&&(o?a=0:a=r),this.aClockwise===!0&&!o&&(a===r?a=-r:a=a-r);let s=this.aStartAngle+e*a,u=this.aX+this.xRadius*Math.cos(s),h=this.aY+this.yRadius*Math.sin(s);if(this.aRotation!==0){let d=Math.cos(this.aRotation),f=Math.sin(this.aRotation),m=u-this.aX,v=h-this.aY;u=m*d-v*f+this.aX,h=m*f+v*d+this.aY}return n.set(u,h)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}};l(YO,"EllipseCurve");var jP=YO,JO=class extends jP{constructor(e,t,n,r,a,o){super(e,t,n,n,r,a,o),this.isArcCurve=!0,this.type="ArcCurve"}};l(JO,"ArcCurve");var bce=JO;function $w(){let i=0,e=0,t=0,n=0;function r(a,o,s,u){i=a,e=s,t=-3*a+3*o-2*s-u,n=2*a-2*o+s+u}return l(r,"init"),{initCatmullRom:l(function(a,o,s,u,h){r(o,s,h*(s-a),h*(u-o))},"initCatmullRom"),initNonuniformCatmullRom:l(function(a,o,s,u,h,d,f){let m=(o-a)/h-(s-a)/(h+d)+(s-o)/d,v=(s-o)/d-(u-o)/(d+f)+(u-s)/f;m*=d,v*=d,r(o,s,m,v)},"initNonuniformCatmullRom"),calc:l(function(a){let o=a*a,s=o*a;return i+e*a+t*o+n*s},"calc")}}l($w,"CubicPoly");var i_=new Ee,RS=new $w,OS=new $w,NS=new $w,KO=class extends du{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new Ee){let n=t,r=this.points,a=r.length,o=(a-(this.closed?0:1))*e,s=Math.floor(o),u=o-s;this.closed?s+=s>0?0:(Math.floor(Math.abs(s)/a)+1)*a:u===0&&s===a-1&&(s=a-2,u=1);let h,d;this.closed||s>0?h=r[(s-1)%a]:(i_.subVectors(r[0],r[1]).add(r[0]),h=i_);let f=r[s%a],m=r[(s+1)%a];if(this.closed||s+2<a?d=r[(s+2)%a]:(i_.subVectors(r[a-1],r[a-2]).add(r[a-1]),d=i_),this.curveType==="centripetal"||this.curveType==="chordal"){let v=this.curveType==="chordal"?.5:.25,b=Math.pow(h.distanceToSquared(f),v),w=Math.pow(f.distanceToSquared(m),v),A=Math.pow(m.distanceToSquared(d),v);w<1e-4&&(w=1),b<1e-4&&(b=w),A<1e-4&&(A=w),RS.initNonuniformCatmullRom(h.x,f.x,m.x,d.x,b,w,A),OS.initNonuniformCatmullRom(h.y,f.y,m.y,d.y,b,w,A),NS.initNonuniformCatmullRom(h.z,f.z,m.z,d.z,b,w,A)}else this.curveType==="catmullrom"&&(RS.initCatmullRom(h.x,f.x,m.x,d.x,this.tension),OS.initCatmullRom(h.y,f.y,m.y,d.y,this.tension),NS.initCatmullRom(h.z,f.z,m.z,d.z,this.tension));return n.set(RS.calc(u),OS.calc(u),NS.calc(u)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){let r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let r=e.points[t];this.points.push(new Ee().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};l(KO,"CatmullRomCurve3");var QO=KO;function SC(i,e,t,n,r){let a=(n-e)*.5,o=(r-t)*.5,s=i*i,u=i*s;return(2*t-2*n+a+o)*u+(-3*t+3*n-2*a-o)*s+a*i+t}l(SC,"CatmullRom");function e9(i,e){let t=1-i;return t*t*e}l(e9,"QuadraticBezierP0");function t9(i,e){return 2*(1-i)*i*e}l(t9,"QuadraticBezierP1");function i9(i,e){return i*i*e}l(i9,"QuadraticBezierP2");function Fm(i,e,t,n){return e9(i,e)+t9(i,t)+i9(i,n)}l(Fm,"QuadraticBezier");function n9(i,e){let t=1-i;return t*t*t*e}l(n9,"CubicBezierP0");function r9(i,e){let t=1-i;return 3*t*t*i*e}l(r9,"CubicBezierP1");function a9(i,e){return 3*(1-i)*i*i*e}l(a9,"CubicBezierP2");function o9(i,e){return i*i*i*e}l(o9,"CubicBezierP3");function Bm(i,e,t,n,r){return n9(i,e)+r9(i,t)+a9(i,n)+o9(i,r)}l(Bm,"CubicBezier");var s9=class extends du{constructor(e=new ft,t=new ft,n=new ft,r=new ft){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new ft){let n=t,r=this.v0,a=this.v1,o=this.v2,s=this.v3;return n.set(Bm(e,r.x,a.x,o.x,s.x),Bm(e,r.y,a.y,o.y,s.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}};l(s9,"CubicBezierCurve");var l9=s9,u9=class extends du{constructor(e=new Ee,t=new Ee,n=new Ee,r=new Ee){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new Ee){let n=t,r=this.v0,a=this.v1,o=this.v2,s=this.v3;return n.set(Bm(e,r.x,a.x,o.x,s.x),Bm(e,r.y,a.y,o.y,s.y),Bm(e,r.z,a.z,o.z,s.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}};l(u9,"CubicBezierCurve3");var wce=u9,h9=class extends du{constructor(e=new ft,t=new ft){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new ft){let n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new ft){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};l(h9,"LineCurve");var c9=h9,p9=class extends du{constructor(e=new Ee,t=new Ee){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new Ee){let n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Ee){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};l(p9,"LineCurve3");var Ace=p9,d9=class extends du{constructor(e=new ft,t=new ft,n=new ft){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new ft){let n=t,r=this.v0,a=this.v1,o=this.v2;return n.set(Fm(e,r.x,a.x,o.x),Fm(e,r.y,a.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};l(d9,"QuadraticBezierCurve");var f9=d9,m9=class extends du{constructor(e=new Ee,t=new Ee,n=new Ee){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Ee){let n=t,r=this.v0,a=this.v1,o=this.v2;return n.set(Fm(e,r.x,a.x,o.x),Fm(e,r.y,a.y,o.y),Fm(e,r.z,a.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};l(m9,"QuadraticBezierCurve3");var g9=m9,y9=class extends du{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new ft){let n=t,r=this.points,a=(r.length-1)*e,o=Math.floor(a),s=a-o,u=r[o===0?o:o-1],h=r[o],d=r[o>r.length-2?r.length-1:o+1],f=r[o>r.length-3?r.length-1:o+2];return n.set(SC(s,u.x,h.x,d.x,f.x),SC(s,u.y,h.y,d.y,f.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let r=e.points[t];this.points.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){let r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let r=e.points[t];this.points.push(new ft().fromArray(r))}return this}};l(y9,"SplineCurve");var v9=y9,G2=Object.freeze({__proto__:null,ArcCurve:bce,CatmullRomCurve3:QO,CubicBezierCurve:l9,CubicBezierCurve3:wce,EllipseCurve:jP,LineCurve:c9,LineCurve3:Ace,QuadraticBezierCurve:f9,QuadraticBezierCurve3:g9,SplineCurve:v9}),_9=class extends du{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){let n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new G2[n](t,e))}return this}getPoint(e,t){let n=e*this.getLength(),r=this.getCurveLengths(),a=0;for(;a<r.length;){if(r[a]>=n){let o=r[a]-n,s=this.curves[a],u=s.getLength(),h=u===0?0:1-o/u;return s.getPointAt(h,t)}a++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],n;for(let r=0,a=this.curves;r<a.length;r++){let o=a[r],s=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,u=o.getPoints(s);for(let h=0;h<u.length;h++){let d=u[h];n&&n.equals(d)||(t.push(d),n=d)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){let r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){let r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){let r=e.curves[t];this.curves.push(new G2[r.type]().fromJSON(r))}return this}};l(_9,"CurvePath");var Sce=_9,x9=class extends Sce{constructor(e){super(),this.type="Path",this.currentPoint=new ft,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let n=new c9(this.currentPoint.clone(),new ft(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){let a=new f9(this.currentPoint.clone(),new ft(e,t),new ft(n,r));return this.curves.push(a),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,a,o){let s=new l9(this.currentPoint.clone(),new ft(e,t),new ft(n,r),new ft(a,o));return this.curves.push(s),this.currentPoint.set(a,o),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),n=new v9(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,a,o){let s=this.currentPoint.x,u=this.currentPoint.y;return this.absarc(e+s,t+u,n,r,a,o),this}absarc(e,t,n,r,a,o){return this.absellipse(e,t,n,n,r,a,o),this}ellipse(e,t,n,r,a,o,s,u){let h=this.currentPoint.x,d=this.currentPoint.y;return this.absellipse(e+h,t+d,n,r,a,o,s,u),this}absellipse(e,t,n,r,a,o,s,u){let h=new jP(e,t,n,r,a,o,s,u);if(this.curves.length>0){let f=h.getPoint(0);f.equals(this.currentPoint)||this.lineTo(f.x,f.y)}this.curves.push(h);let d=h.getPoint(1);return this.currentPoint.copy(d),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}};l(x9,"Path");var sg=x9,b9=class w9 extends Sa{constructor(e=1,t=1,n=1,r=32,a=1,o=!1,s=0,u=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:a,openEnded:o,thetaStart:s,thetaLength:u};let h=this;r=Math.floor(r),a=Math.floor(a);let d=[],f=[],m=[],v=[],b=0,w=[],A=n/2,E=0;I(),o===!1&&(e>0&&C(!0),t>0&&C(!1)),this.setIndex(d),this.setAttribute("position",new Fr(f,3)),this.setAttribute("normal",new Fr(m,3)),this.setAttribute("uv",new Fr(v,2));function I(){let T=new Ee,k=new Ee,F=0,B=(t-e)/n;for(let N=0;N<=a;N++){let z=[],L=N/a,j=L*(t-e)+e;for(let q=0;q<=r;q++){let Z=q/r,O=Z*u+s,Y=Math.sin(O),J=Math.cos(O);k.x=j*Y,k.y=-L*n+A,k.z=j*J,f.push(k.x,k.y,k.z),T.set(Y,B,J).normalize(),m.push(T.x,T.y,T.z),v.push(Z,1-L),z.push(b++)}w.push(z)}for(let N=0;N<r;N++)for(let z=0;z<a;z++){let L=w[z][N],j=w[z+1][N],q=w[z+1][N+1],Z=w[z][N+1];(e>0||z!==0)&&(d.push(L,j,Z),F+=3),(t>0||z!==a-1)&&(d.push(j,q,Z),F+=3)}h.addGroup(E,F,0),E+=F}l(I,"generateTorso");function C(T){let k=b,F=new ft,B=new Ee,N=0,z=T===!0?e:t,L=T===!0?1:-1;for(let q=1;q<=r;q++)f.push(0,A*L,0),m.push(0,L,0),v.push(.5,.5),b++;let j=b;for(let q=0;q<=r;q++){let Z=q/r*u+s,O=Math.cos(Z),Y=Math.sin(Z);B.x=z*Y,B.y=A*L,B.z=z*O,f.push(B.x,B.y,B.z),m.push(0,L,0),F.x=O*.5+.5,F.y=Y*.5*L+.5,v.push(F.x,F.y),b++}for(let q=0;q<r;q++){let Z=k+q,O=j+q;T===!0?d.push(O,O+1,Z):d.push(O+1,O,Z),N+=3}h.addGroup(E,N,T===!0?1:2),E+=N}l(C,"generateCap")}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new w9(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}};l(b9,"CylinderGeometry");var MC=b9,n_=new Ee,r_=new Ee,FS=new Ee,a_=new df,A9=class extends Sa{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){let n=Math.pow(10,4),r=Math.cos(Rm*t),a=e.getIndex(),o=e.getAttribute("position"),s=a?a.count:o.count,u=[0,0,0],h=["a","b","c"],d=new Array(3),f={},m=[];for(let v=0;v<s;v+=3){a?(u[0]=a.getX(v),u[1]=a.getX(v+1),u[2]=a.getX(v+2)):(u[0]=v,u[1]=v+1,u[2]=v+2);let{a:b,b:w,c:A}=a_;if(b.fromBufferAttribute(o,u[0]),w.fromBufferAttribute(o,u[1]),A.fromBufferAttribute(o,u[2]),a_.getNormal(FS),d[0]="".concat(Math.round(b.x*n),",").concat(Math.round(b.y*n),",").concat(Math.round(b.z*n)),d[1]="".concat(Math.round(w.x*n),",").concat(Math.round(w.y*n),",").concat(Math.round(w.z*n)),d[2]="".concat(Math.round(A.x*n),",").concat(Math.round(A.y*n),",").concat(Math.round(A.z*n)),!(d[0]===d[1]||d[1]===d[2]||d[2]===d[0]))for(let E=0;E<3;E++){let I=(E+1)%3,C=d[E],T=d[I],k=a_[h[E]],F=a_[h[I]],B="".concat(C,"_").concat(T),N="".concat(T,"_").concat(C);N in f&&f[N]?(FS.dot(f[N].normal)<=r&&(m.push(k.x,k.y,k.z),m.push(F.x,F.y,F.z)),f[N]=null):B in f||(f[B]={index0:u[E],index1:u[I],normal:FS.clone()})}}for(let v in f)if(f[v]){let{index0:b,index1:w}=f[v];n_.fromBufferAttribute(o,b),r_.fromBufferAttribute(o,w),m.push(n_.x,n_.y,n_.z),m.push(r_.x,r_.y,r_.z)}this.setAttribute("position",new Fr(m,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}};l(A9,"EdgesGeometry");var Mce=A9,S9=class extends sg{constructor(e){super(e),this.uuid=gs(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){let r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){let r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){let r=e.holes[t];this.holes.push(new sg().fromJSON(r))}return this}};l(S9,"Shape");var Og=S9,Cce={triangulate:l(function(i,e,t=2){let n=e&&e.length,r=n?e[0]*t:i.length,a=GP(i,0,r,t,!0),o=[];if(!a||a.next===a.prev)return o;let s,u,h,d,f,m,v;if(n&&(a=T9(i,e,a,t)),i.length>80*t){s=h=i[0],u=d=i[1];for(let b=t;b<r;b+=t)f=i[b],m=i[b+1],f<s&&(s=f),m<u&&(u=m),f>h&&(h=f),m>d&&(d=m);v=Math.max(h-s,d-u),v=v!==0?32767/v:0}return lg(a,o,t,s,u,v,0),o},"triangulate")};function GP(i,e,t,n,r){let a,o;if(r===U9(i,e,t,n)>0)for(a=e;a<t;a+=n)o=CC(a,i[a],i[a+1],o);else for(a=t-n;a>=e;a-=n)o=CC(a,i[a],i[a+1],o);return o&&W1(o,o.next)&&(hg(o),o=o.next),o}l(GP,"linkedList");function Fc(i,e){if(!i)return i;e||(e=i);let t=i,n;do if(n=!1,!t.steiner&&(W1(t,t.next)||Er(t.prev,t,t.next)===0)){if(hg(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}l(Fc,"filterPoints");function lg(i,e,t,n,r,a,o){if(!i)return;!o&&a&&R9(i,n,r,a);let s=i,u,h;for(;i.prev!==i.next;){if(u=i.prev,h=i.next,a?C9(i,n,r,a):M9(i)){e.push(u.i/t|0),e.push(i.i/t|0),e.push(h.i/t|0),hg(i),i=h.next,s=h.next;continue}if(i=h,i===s){o?o===1?(i=E9(Fc(i),e,t),lg(i,e,t,n,r,a,2)):o===2&&I9(i,e,t,n,r,a):lg(Fc(i),e,t,n,r,a,1);break}}}l(lg,"earcutLinked");function M9(i){let e=i.prev,t=i,n=i.next;if(Er(e,t,n)>=0)return!1;let r=e.x,a=t.x,o=n.x,s=e.y,u=t.y,h=n.y,d=r<a?r<o?r:o:a<o?a:o,f=s<u?s<h?s:h:u<h?u:h,m=r>a?r>o?r:o:a>o?a:o,v=s>u?s>h?s:h:u>h?u:h,b=n.next;for(;b!==e;){if(b.x>=d&&b.x<=m&&b.y>=f&&b.y<=v&&Jp(r,s,a,u,o,h,b.x,b.y)&&Er(b.prev,b,b.next)>=0)return!1;b=b.next}return!0}l(M9,"isEar");function C9(i,e,t,n){let r=i.prev,a=i,o=i.next;if(Er(r,a,o)>=0)return!1;let s=r.x,u=a.x,h=o.x,d=r.y,f=a.y,m=o.y,v=s<u?s<h?s:h:u<h?u:h,b=d<f?d<m?d:m:f<m?f:m,w=s>u?s>h?s:h:u>h?u:h,A=d>f?d>m?d:m:f>m?f:m,E=$2(v,b,e,t,n),I=$2(w,A,e,t,n),C=i.prevZ,T=i.nextZ;for(;C&&C.z>=E&&T&&T.z<=I;){if(C.x>=v&&C.x<=w&&C.y>=b&&C.y<=A&&C!==r&&C!==o&&Jp(s,d,u,f,h,m,C.x,C.y)&&Er(C.prev,C,C.next)>=0||(C=C.prevZ,T.x>=v&&T.x<=w&&T.y>=b&&T.y<=A&&T!==r&&T!==o&&Jp(s,d,u,f,h,m,T.x,T.y)&&Er(T.prev,T,T.next)>=0))return!1;T=T.nextZ}for(;C&&C.z>=E;){if(C.x>=v&&C.x<=w&&C.y>=b&&C.y<=A&&C!==r&&C!==o&&Jp(s,d,u,f,h,m,C.x,C.y)&&Er(C.prev,C,C.next)>=0)return!1;C=C.prevZ}for(;T&&T.z<=I;){if(T.x>=v&&T.x<=w&&T.y>=b&&T.y<=A&&T!==r&&T!==o&&Jp(s,d,u,f,h,m,T.x,T.y)&&Er(T.prev,T,T.next)>=0)return!1;T=T.nextZ}return!0}l(C9,"isEarHashed");function E9(i,e,t){let n=i;do{let r=n.prev,a=n.next.next;!W1(r,a)&&$P(r,n,n.next,a)&&ug(r,a)&&ug(a,r)&&(e.push(r.i/t|0),e.push(n.i/t|0),e.push(a.i/t|0),hg(n),hg(n.next),n=i=a),n=n.next}while(n!==i);return Fc(n)}l(E9,"cureLocalIntersections");function I9(i,e,t,n,r,a){let o=i;do{let s=o.next.next;for(;s!==o.prev;){if(o.i!==s.i&&F9(o,s)){let u=HP(o,s);o=Fc(o,o.next),u=Fc(u,u.next),lg(o,e,t,n,r,a,0),lg(u,e,t,n,r,a,0);return}s=s.next}o=o.next}while(o!==i)}l(I9,"splitEarcut");function T9(i,e,t,n){let r=[],a,o,s,u,h;for(a=0,o=e.length;a<o;a++)s=e[a]*n,u=a<o-1?e[a+1]*n:i.length,h=GP(i,s,u,n,!1),h===h.next&&(h.steiner=!0),r.push(N9(h));for(r.sort(P9),a=0;a<r.length;a++)t=L9(r[a],t);return t}l(T9,"eliminateHoles");function P9(i,e){return i.x-e.x}l(P9,"compareX");function L9(i,e){let t=D9(i,e);if(!t)return e;let n=HP(t,i);return Fc(n,n.next),Fc(t,t.next)}l(L9,"eliminateHole");function D9(i,e){let t=e,n=-1/0,r,a=i.x,o=i.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){let m=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(m<=a&&m>n&&(n=m,r=t.x<t.next.x?t:t.next,m===a))return r}t=t.next}while(t!==e);if(!r)return null;let s=r,u=r.x,h=r.y,d=1/0,f;t=r;do a>=t.x&&t.x>=u&&a!==t.x&&Jp(o<h?a:n,o,u,h,o<h?n:a,o,t.x,t.y)&&(f=Math.abs(o-t.y)/(a-t.x),ug(t,i)&&(f<d||f===d&&(t.x>r.x||t.x===r.x&&k9(r,t)))&&(r=t,d=f)),t=t.next;while(t!==s);return r}l(D9,"findHoleBridge");function k9(i,e){return Er(i.prev,i,e.prev)<0&&Er(e.next,i,i.next)<0}l(k9,"sectorContainsSector");function R9(i,e,t,n){let r=i;do r.z===0&&(r.z=$2(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,O9(r)}l(R9,"indexCurve");function O9(i){let e,t,n,r,a,o,s,u,h=1;do{for(t=i,i=null,a=null,o=0;t;){for(o++,n=t,s=0,e=0;e<h&&(s++,n=n.nextZ,!!n);e++);for(u=h;s>0||u>0&&n;)s!==0&&(u===0||!n||t.z<=n.z)?(r=t,t=t.nextZ,s--):(r=n,n=n.nextZ,u--),a?a.nextZ=r:i=r,r.prevZ=a,a=r;t=n}a.nextZ=null,h*=2}while(o>1);return i}l(O9,"sortLinked");function $2(i,e,t,n,r){return i=(i-t)*r|0,e=(e-n)*r|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}l($2,"zOrder");function N9(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}l(N9,"getLeftmost");function Jp(i,e,t,n,r,a,o,s){return(r-o)*(e-s)>=(i-o)*(a-s)&&(i-o)*(n-s)>=(t-o)*(e-s)&&(t-o)*(a-s)>=(r-o)*(n-s)}l(Jp,"pointInTriangle");function F9(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!B9(i,e)&&(ug(i,e)&&ug(e,i)&&z9(i,e)&&(Er(i.prev,i,e.prev)||Er(i,e.prev,e))||W1(i,e)&&Er(i.prev,i,i.next)>0&&Er(e.prev,e,e.next)>0)}l(F9,"isValidDiagonal");function Er(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}l(Er,"area");function W1(i,e){return i.x===e.x&&i.y===e.y}l(W1,"equals");function $P(i,e,t,n){let r=Py(Er(i,e,t)),a=Py(Er(i,e,n)),o=Py(Er(t,n,i)),s=Py(Er(t,n,e));return!!(r!==a&&o!==s||r===0&&Ty(i,t,e)||a===0&&Ty(i,n,e)||o===0&&Ty(t,i,n)||s===0&&Ty(t,e,n))}l($P,"intersects");function Ty(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}l(Ty,"onSegment");function Py(i){return i>0?1:i<0?-1:0}l(Py,"sign");function B9(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&$P(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}l(B9,"intersectsPolygon");function ug(i,e){return Er(i.prev,i,i.next)<0?Er(i,e,i.next)>=0&&Er(i,i.prev,e)>=0:Er(i,e,i.prev)<0||Er(i,i.next,e)<0}l(ug,"locallyInside");function z9(i,e){let t=i,n=!1,r=(i.x+e.x)/2,a=(i.y+e.y)/2;do t.y>a!=t.next.y>a&&t.next.y!==t.y&&r<(t.next.x-t.x)*(a-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==i);return n}l(z9,"middleInside");function HP(i,e){let t=new H2(i.i,i.x,i.y),n=new H2(e.i,e.x,e.y),r=i.next,a=e.prev;return i.next=e,e.prev=i,t.next=r,r.prev=t,n.next=t,t.prev=n,a.next=n,n.prev=a,n}l(HP,"splitPolygon");function CC(i,e,t,n){let r=new H2(i,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}l(CC,"insertNode");function hg(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}l(hg,"removeNode");function H2(i,e,t){this.i=i,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}l(H2,"Node");function U9(i,e,t,n){let r=0;for(let a=e,o=t-n;a<t;a+=n)r+=(i[o]-i[a])*(i[a+1]+i[o+1]),o=a;return r}l(U9,"signedArea");var V9=class j9{static area(e){let t=e.length,n=0;for(let r=t-1,a=0;a<t;r=a++)n+=e[r].x*e[a].y-e[a].x*e[r].y;return n*.5}static isClockWise(e){return j9.area(e)<0}static triangulateShape(e,t){let n=[],r=[],a=[];EC(e),IC(n,e);let o=e.length;t.forEach(EC);for(let u=0;u<t.length;u++)r.push(o),o+=t[u].length,IC(n,t[u]);let s=Cce.triangulate(n,r);for(let u=0;u<s.length;u+=3)a.push(s.slice(u,u+3));return a}};l(V9,"ShapeUtils");var BS=V9;function EC(i){let e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}l(EC,"removeDupEndPts");function IC(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}l(IC,"addContour");var G9=class $9 extends Sa{constructor(e=new Og([new ft(.5,.5),new ft(-.5,.5),new ft(-.5,-.5),new ft(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];let n=this,r=[],a=[];for(let s=0,u=e.length;s<u;s++){let h=e[s];o(h)}this.setAttribute("position",new Fr(r,3)),this.setAttribute("uv",new Fr(a,2)),this.computeVertexNormals();function o(s){let u=[],h=t.curveSegments!==void 0?t.curveSegments:12,d=t.steps!==void 0?t.steps:1,f=t.depth!==void 0?t.depth:1,m=t.bevelEnabled!==void 0?t.bevelEnabled:!0,v=t.bevelThickness!==void 0?t.bevelThickness:.2,b=t.bevelSize!==void 0?t.bevelSize:v-.1,w=t.bevelOffset!==void 0?t.bevelOffset:0,A=t.bevelSegments!==void 0?t.bevelSegments:3,E=t.extrudePath,I=t.UVGenerator!==void 0?t.UVGenerator:Ece,C,T=!1,k,F,B,N;E&&(C=E.getSpacedPoints(d),T=!0,m=!1,k=E.computeFrenetFrames(d,!1),F=new Ee,B=new Ee,N=new Ee),m||(A=0,v=0,b=0,w=0);let z=s.extractPoints(h),L=z.shape,j=z.holes;if(!BS.isClockWise(L)){L=L.reverse();for(let Le=0,xe=j.length;Le<xe;Le++){let Ue=j[Le];BS.isClockWise(Ue)&&(j[Le]=Ue.reverse())}}let q=BS.triangulateShape(L,j),Z=L;for(let Le=0,xe=j.length;Le<xe;Le++){let Ue=j[Le];L=L.concat(Ue)}function O(Le,xe,Ue){return xe||console.error("THREE.ExtrudeGeometry: vec does not exist"),Le.clone().addScaledVector(xe,Ue)}l(O,"scalePt2");let Y=L.length,J=q.length;function oe(Le,xe,Ue){let de,ut,ot,He=Le.x-xe.x,Ke=Le.y-xe.y,Lt=Ue.x-Le.x,_t=Ue.y-Le.y,pe=He*He+Ke*Ke,re=He*_t-Ke*Lt;if(Math.abs(re)>Number.EPSILON){let ke=Math.sqrt(pe),at=Math.sqrt(Lt*Lt+_t*_t),ct=xe.x-Ke/ke,rt=xe.y+He/ke,Qe=Ue.x-_t/at,At=Ue.y+Lt/at,Dt=((Qe-ct)*_t-(At-rt)*Lt)/(He*_t-Ke*Lt);de=ct+He*Dt-Le.x,ut=rt+Ke*Dt-Le.y;let vt=de*de+ut*ut;if(vt<=2)return new ft(de,ut);ot=Math.sqrt(vt/2)}else{let ke=!1;He>Number.EPSILON?Lt>Number.EPSILON&&(ke=!0):He<-Number.EPSILON?Lt<-Number.EPSILON&&(ke=!0):Math.sign(Ke)===Math.sign(_t)&&(ke=!0),ke?(de=-Ke,ut=He,ot=Math.sqrt(pe)):(de=He,ut=Ke,ot=Math.sqrt(pe/2))}return new ft(de/ot,ut/ot)}l(oe,"getBevelVec");let $=[];for(let Le=0,xe=Z.length,Ue=xe-1,de=Le+1;Le<xe;Le++,Ue++,de++)Ue===xe&&(Ue=0),de===xe&&(de=0),$[Le]=oe(Z[Le],Z[Ue],Z[de]);let K=[],te,ve=$.concat();for(let Le=0,xe=j.length;Le<xe;Le++){let Ue=j[Le];te=[];for(let de=0,ut=Ue.length,ot=ut-1,He=de+1;de<ut;de++,ot++,He++)ot===ut&&(ot=0),He===ut&&(He=0),te[de]=oe(Ue[de],Ue[ot],Ue[He]);K.push(te),ve=ve.concat(te)}for(let Le=0;Le<A;Le++){let xe=Le/A,Ue=v*Math.cos(xe*Math.PI/2),de=b*Math.sin(xe*Math.PI/2)+w;for(let ut=0,ot=Z.length;ut<ot;ut++){let He=O(Z[ut],$[ut],de);Ie(He.x,He.y,-Ue)}for(let ut=0,ot=j.length;ut<ot;ut++){let He=j[ut];te=K[ut];for(let Ke=0,Lt=He.length;Ke<Lt;Ke++){let _t=O(He[Ke],te[Ke],de);Ie(_t.x,_t.y,-Ue)}}}let Q=b+w;for(let Le=0;Le<Y;Le++){let xe=m?O(L[Le],ve[Le],Q):L[Le];T?(B.copy(k.normals[0]).multiplyScalar(xe.x),F.copy(k.binormals[0]).multiplyScalar(xe.y),N.copy(C[0]).add(B).add(F),Ie(N.x,N.y,N.z)):Ie(xe.x,xe.y,0)}for(let Le=1;Le<=d;Le++)for(let xe=0;xe<Y;xe++){let Ue=m?O(L[xe],ve[xe],Q):L[xe];T?(B.copy(k.normals[Le]).multiplyScalar(Ue.x),F.copy(k.binormals[Le]).multiplyScalar(Ue.y),N.copy(C[Le]).add(B).add(F),Ie(N.x,N.y,N.z)):Ie(Ue.x,Ue.y,f/d*Le)}for(let Le=A-1;Le>=0;Le--){let xe=Le/A,Ue=v*Math.cos(xe*Math.PI/2),de=b*Math.sin(xe*Math.PI/2)+w;for(let ut=0,ot=Z.length;ut<ot;ut++){let He=O(Z[ut],$[ut],de);Ie(He.x,He.y,f+Ue)}for(let ut=0,ot=j.length;ut<ot;ut++){let He=j[ut];te=K[ut];for(let Ke=0,Lt=He.length;Ke<Lt;Ke++){let _t=O(He[Ke],te[Ke],de);T?Ie(_t.x,_t.y+C[d-1].y,C[d-1].x+Ue):Ie(_t.x,_t.y,f+Ue)}}}he(),se();function he(){let Le=r.length/3;if(m){let xe=0,Ue=Y*xe;for(let de=0;de<J;de++){let ut=q[de];we(ut[2]+Ue,ut[1]+Ue,ut[0]+Ue)}xe=d+A*2,Ue=Y*xe;for(let de=0;de<J;de++){let ut=q[de];we(ut[0]+Ue,ut[1]+Ue,ut[2]+Ue)}}else{for(let xe=0;xe<J;xe++){let Ue=q[xe];we(Ue[2],Ue[1],Ue[0])}for(let xe=0;xe<J;xe++){let Ue=q[xe];we(Ue[0]+Y*d,Ue[1]+Y*d,Ue[2]+Y*d)}}n.addGroup(Le,r.length/3-Le,0)}l(he,"buildLidFaces");function se(){let Le=r.length/3,xe=0;Ae(Z,xe),xe+=Z.length;for(let Ue=0,de=j.length;Ue<de;Ue++){let ut=j[Ue];Ae(ut,xe),xe+=ut.length}n.addGroup(Le,r.length/3-Le,1)}l(se,"buildSideFaces");function Ae(Le,xe){let Ue=Le.length;for(;--Ue>=0;){let de=Ue,ut=Ue-1;ut<0&&(ut=Le.length-1);for(let ot=0,He=d+A*2;ot<He;ot++){let Ke=Y*ot,Lt=Y*(ot+1),_t=xe+de+Ke,pe=xe+ut+Ke,re=xe+ut+Lt,ke=xe+de+Lt;Ne(_t,pe,re,ke)}}}l(Ae,"sidewalls");function Ie(Le,xe,Ue){u.push(Le),u.push(xe),u.push(Ue)}l(Ie,"v");function we(Le,xe,Ue){je(Le),je(xe),je(Ue);let de=r.length/3,ut=I.generateTopUV(n,r,de-3,de-2,de-1);Ve(ut[0]),Ve(ut[1]),Ve(ut[2])}l(we,"f3");function Ne(Le,xe,Ue,de){je(Le),je(xe),je(de),je(xe),je(Ue),je(de);let ut=r.length/3,ot=I.generateSideWallUV(n,r,ut-6,ut-3,ut-2,ut-1);Ve(ot[0]),Ve(ot[1]),Ve(ot[3]),Ve(ot[1]),Ve(ot[2]),Ve(ot[3])}l(Ne,"f4");function je(Le){r.push(u[Le*3+0]),r.push(u[Le*3+1]),r.push(u[Le*3+2])}l(je,"addVertex");function Ve(Le){a.push(Le.x),a.push(Le.y)}l(Ve,"addUV")}l(o,"addShape")}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return H9(t,n,e)}static fromJSON(e,t){let n=[];for(let a=0,o=e.shapes.length;a<o;a++){let s=t[e.shapes[a]];n.push(s)}let r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new G2[r.type]().fromJSON(r)),new $9(n,e.options)}};l(G9,"ExtrudeGeometry");var q1=G9,Ece={generateTopUV:l(function(i,e,t,n,r){let a=e[t*3],o=e[t*3+1],s=e[n*3],u=e[n*3+1],h=e[r*3],d=e[r*3+1];return[new ft(a,o),new ft(s,u),new ft(h,d)]},"generateTopUV"),generateSideWallUV:l(function(i,e,t,n,r,a){let o=e[t*3],s=e[t*3+1],u=e[t*3+2],h=e[n*3],d=e[n*3+1],f=e[n*3+2],m=e[r*3],v=e[r*3+1],b=e[r*3+2],w=e[a*3],A=e[a*3+1],E=e[a*3+2];return Math.abs(s-d)<Math.abs(o-h)?[new ft(o,1-u),new ft(h,1-f),new ft(m,1-b),new ft(w,1-E)]:[new ft(s,1-u),new ft(d,1-f),new ft(v,1-b),new ft(A,1-E)]},"generateSideWallUV")};function H9(i,e,t){if(t.shapes=[],Array.isArray(i))for(let n=0,r=i.length;n<r;n++){let a=i[n];t.shapes.push(a.uuid)}else t.shapes.push(i.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}l(H9,"toJSON$1");var W9=class q9 extends Sa{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};let a=e/2,o=t/2,s=Math.floor(n),u=Math.floor(r),h=s+1,d=u+1,f=e/s,m=t/u,v=[],b=[],w=[],A=[];for(let E=0;E<d;E++){let I=E*m-o;for(let C=0;C<h;C++){let T=C*f-a;b.push(T,-I,0),w.push(0,0,1),A.push(C/s),A.push(1-E/u)}}for(let E=0;E<u;E++)for(let I=0;I<s;I++){let C=I+h*E,T=I+h*(E+1),k=I+1+h*(E+1),F=I+1+h*E;v.push(C,T,F),v.push(T,k,F)}this.setIndex(v),this.setAttribute("position",new Fr(b,3)),this.setAttribute("normal",new Fr(w,3)),this.setAttribute("uv",new Fr(A,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new q9(e.width,e.height,e.widthSegments,e.heightSegments)}};l(W9,"PlaneGeometry");var Cd=W9,Ice=class X9 extends Sa{constructor(e=1,t=32,n=16,r=0,a=Math.PI*2,o=0,s=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:a,thetaStart:o,thetaLength:s},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));let u=Math.min(o+s,Math.PI),h=0,d=[],f=new Ee,m=new Ee,v=[],b=[],w=[],A=[];for(let E=0;E<=n;E++){let I=[],C=E/n,T=0;E===0&&o===0?T=.5/t:E===n&&u===Math.PI&&(T=-.5/t);for(let k=0;k<=t;k++){let F=k/t;f.x=-e*Math.cos(r+F*a)*Math.sin(o+C*s),f.y=e*Math.cos(o+C*s),f.z=e*Math.sin(r+F*a)*Math.sin(o+C*s),b.push(f.x,f.y,f.z),m.copy(f).normalize(),w.push(m.x,m.y,m.z),A.push(F+T,1-C),I.push(h++)}d.push(I)}for(let E=0;E<n;E++)for(let I=0;I<t;I++){let C=d[E][I+1],T=d[E][I],k=d[E+1][I],F=d[E+1][I+1];(E!==0||o>0)&&v.push(C,T,F),(E!==n-1||u<Math.PI)&&v.push(T,k,F)}this.setIndex(v),this.setAttribute("position",new Fr(b,3)),this.setAttribute("normal",new Fr(w,3)),this.setAttribute("uv",new Fr(A,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new X9(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}};l(Ice,"SphereGeometry");var Z9=class Y9 extends Sa{constructor(e=new g9(new Ee(-1,-1,0),new Ee(-1,1,0),new Ee(1,1,0)),t=64,n=1,r=8,a=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:a};let o=e.computeFrenetFrames(t,a);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;let s=new Ee,u=new Ee,h=new ft,d=new Ee,f=[],m=[],v=[],b=[];w(),this.setIndex(b),this.setAttribute("position",new Fr(f,3)),this.setAttribute("normal",new Fr(m,3)),this.setAttribute("uv",new Fr(v,2));function w(){for(let C=0;C<t;C++)A(C);A(a===!1?t:0),I(),E()}l(w,"generateBufferData");function A(C){d=e.getPointAt(C/t,d);let T=o.normals[C],k=o.binormals[C];for(let F=0;F<=r;F++){let B=F/r*Math.PI*2,N=Math.sin(B),z=-Math.cos(B);u.x=z*T.x+N*k.x,u.y=z*T.y+N*k.y,u.z=z*T.z+N*k.z,u.normalize(),m.push(u.x,u.y,u.z),s.x=d.x+n*u.x,s.y=d.y+n*u.y,s.z=d.z+n*u.z,f.push(s.x,s.y,s.z)}}l(A,"generateSegment");function E(){for(let C=1;C<=t;C++)for(let T=1;T<=r;T++){let k=(r+1)*(C-1)+(T-1),F=(r+1)*C+(T-1),B=(r+1)*C+T,N=(r+1)*(C-1)+T;b.push(k,F,N),b.push(F,B,N)}}l(E,"generateIndices");function I(){for(let C=0;C<=t;C++)for(let T=0;T<=r;T++)h.x=C/t,h.y=T/r,v.push(h.x,h.y)}l(I,"generateUVs")}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Y9(new G2[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}};l(Z9,"TubeGeometry");var Tce=Z9,J9=class extends Hc{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Mi(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Mi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=RP,this.normalScale=new ft(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Wo,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}};l(J9,"MeshStandardMaterial");var K9=J9,Q9=class extends K9{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ft(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:l(function(){return sn(2.5*(this.ior-1)/(this.ior+1),0,1)},"get"),set:l(function(t){this.ior=(1+.4*t)/(1-.4*t)},"set")}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Mi(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Mi(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Mi(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}};l(Q9,"MeshPhysicalMaterial");var IPe=Q9,eN=class extends Hc{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Mi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Mi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=RP,this.normalScale=new ft(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Wo,this.combine=EP,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}};l(eN,"MeshLambertMaterial");var cg=eN,tN=class extends Hc{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=khe,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}};l(tN,"MeshDepthMaterial");var Pce=tN,iN=class extends Hc{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}};l(iN,"MeshDistanceMaterial");var Lce=iN;function Ly(i,e,t){return!i||!t&&i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)}l(Ly,"convertArray");function nN(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}l(nN,"isTypedArray");function rN(i){function e(r,a){return i[r]-i[a]}l(e,"compareTime");let t=i.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(e),n}l(rN,"getKeyframeOrder");function TC(i,e,t){let n=i.length,r=new i.constructor(n);for(let a=0,o=0;o!==n;++a){let s=t[a]*e;for(let u=0;u!==e;++u)r[o++]=i[s+u]}return r}l(TC,"sortedArray");function WP(i,e,t,n){let r=1,a=i[0];for(;a!==void 0&&a[n]===void 0;)a=i[r++];if(a===void 0)return;let o=a[n];if(o!==void 0)if(Array.isArray(o))do o=a[n],o!==void 0&&(e.push(a.time),t.push.apply(t,o)),a=i[r++];while(a!==void 0);else if(o.toArray!==void 0)do o=a[n],o!==void 0&&(e.push(a.time),o.toArray(t,t.length)),a=i[r++];while(a!==void 0);else do o=a[n],o!==void 0&&(e.push(a.time),t.push(o)),a=i[r++];while(a!==void 0)}l(WP,"flattenJSON");var aN=class{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,n=this._cachedIndex,r=t[n],a=t[n-1];i:{e:{let o;t:{n:if(!(e<r)){for(let s=n+2;;){if(r===void 0){if(e<a)break n;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===s)break;if(a=r,r=t[++n],e<r)break e}o=t.length;break t}if(!(e>=a)){let s=t[1];e<s&&(n=2,a=s);for(let u=n-2;;){if(a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===u)break;if(r=a,a=t[--n-1],e>=a)break e}o=n,n=0;break t}break i}for(;n<o;){let s=n+o>>>1;e<t[s]?o=s:n=s+1}if(r=t[n],a=t[n-1],a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,a,r)}return this.interpolate_(n,a,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,a=e*r;for(let o=0;o!==r;++o)t[o]=n[a+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}};l(aN,"Interpolant");var Hw=aN,oN=class extends Hw{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:D6,endingEnd:D6}}intervalChanged_(e,t,n){let r=this.parameterPositions,a=e-2,o=e+1,s=r[a],u=r[o];if(s===void 0)switch(this.getSettings_().endingStart){case k6:a=e,s=2*t-n;break;case R6:a=r.length-2,s=t+r[a]-r[a+1];break;default:a=e,s=n}if(u===void 0)switch(this.getSettings_().endingEnd){case k6:o=e,u=2*n-t;break;case R6:o=1,u=n+r[1]-r[0];break;default:o=e-1,u=t}let h=(n-t)*.5,d=this.valueSize;this._weightPrev=h/(t-s),this._weightNext=h/(u-n),this._offsetPrev=a*d,this._offsetNext=o*d}interpolate_(e,t,n,r){let a=this.resultBuffer,o=this.sampleValues,s=this.valueSize,u=e*s,h=u-s,d=this._offsetPrev,f=this._offsetNext,m=this._weightPrev,v=this._weightNext,b=(n-t)/(r-t),w=b*b,A=w*b,E=-m*A+2*m*w-m*b,I=(1+m)*A+(-1.5-2*m)*w+(-.5+m)*b+1,C=(-1-v)*A+(1.5+v)*w+.5*b,T=v*A-v*w;for(let k=0;k!==s;++k)a[k]=E*o[d+k]+I*o[h+k]+C*o[u+k]+T*o[f+k];return a}};l(oN,"CubicInterpolant");var Dce=oN,sN=class extends Hw{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){let a=this.resultBuffer,o=this.sampleValues,s=this.valueSize,u=e*s,h=u-s,d=(n-t)/(r-t),f=1-d;for(let m=0;m!==s;++m)a[m]=o[h+m]*f+o[u+m]*d;return a}};l(sN,"LinearInterpolant");var kce=sN,lN=class extends Hw{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}};l(lN,"DiscreteInterpolant");var Rce=lN,uN=class{constructor(e,t,n,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Ly(t,this.TimeBufferType),this.values=Ly(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Ly(e.times,Array),values:Ly(e.values,Array)};let r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new Rce(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new kce(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Dce(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case F2:t=this.InterpolantFactoryMethodDiscrete;break;case yC:t=this.InterpolantFactoryMethodLinear;break;case uS:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return F2;case this.InterpolantFactoryMethodLinear:return yC;case this.InterpolantFactoryMethodSmooth:return uS}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){let n=this.times,r=n.length,a=0,o=r-1;for(;a!==r&&n[a]<e;)++a;for(;o!==-1&&n[o]>t;)--o;if(++o,a!==0||o!==r){a>=o&&(o=Math.max(o,1),a=o-1);let s=this.getValueSize();this.times=n.slice(a,o),this.values=this.values.slice(a*s,o*s)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let n=this.times,r=this.values,a=n.length;a===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let s=0;s!==a;s++){let u=n[s];if(typeof u=="number"&&isNaN(u)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,s,u),e=!1;break}if(o!==null&&o>u){console.error("THREE.KeyframeTrack: Out of order keys.",this,s,u,o),e=!1;break}o=u}if(r!==void 0&&nN(r))for(let s=0,u=r.length;s!==u;++s){let h=r[s];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,s,h),e=!1;break}}return e}optimize(){let e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===uS,a=e.length-1,o=1;for(let s=1;s<a;++s){let u=!1,h=e[s],d=e[s+1];if(h!==d&&(s!==1||h!==e[0]))if(r)u=!0;else{let f=s*n,m=f-n,v=f+n;for(let b=0;b!==n;++b){let w=t[f+b];if(w!==t[m+b]||w!==t[v+b]){u=!0;break}}}if(u){if(s!==o){e[o]=e[s];let f=s*n,m=o*n;for(let v=0;v!==n;++v)t[m+v]=t[f+v]}++o}}if(a>0){e[o]=e[a];for(let s=a*n,u=o*n,h=0;h!==n;++h)t[u+h]=t[s+h];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*n)):(this.times=e,this.values=t),this}clone(){let e=this.times.slice(),t=this.values.slice(),n=this.constructor,r=new n(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}};l(uN,"KeyframeTrack");var fu=uN;fu.prototype.TimeBufferType=Float32Array;fu.prototype.ValueBufferType=Float32Array;fu.prototype.DefaultInterpolation=yC;var hN=class extends fu{constructor(e,t,n){super(e,t,n)}};l(hN,"BooleanKeyframeTrack");var Ng=hN;Ng.prototype.ValueTypeName="bool";Ng.prototype.ValueBufferType=Array;Ng.prototype.DefaultInterpolation=F2;Ng.prototype.InterpolantFactoryMethodLinear=void 0;Ng.prototype.InterpolantFactoryMethodSmooth=void 0;var cN=class extends fu{};l(cN,"ColorKeyframeTrack");var pN=cN;pN.prototype.ValueTypeName="color";var dN=class extends fu{};l(dN,"NumberKeyframeTrack");var W2=dN;W2.prototype.ValueTypeName="number";var fN=class extends Hw{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){let a=this.resultBuffer,o=this.sampleValues,s=this.valueSize,u=(n-t)/(r-t),h=e*s;for(let d=h+s;h!==d;h+=4)lu.slerpFlat(a,0,o,h-s,o,h,u);return a}};l(fN,"QuaternionLinearInterpolant");var Oce=fN,mN=class extends fu{InterpolantFactoryMethodLinear(e){return new Oce(this.times,this.values,this.getValueSize(),e)}};l(mN,"QuaternionKeyframeTrack");var Ww=mN;Ww.prototype.ValueTypeName="quaternion";Ww.prototype.InterpolantFactoryMethodSmooth=void 0;var gN=class extends fu{constructor(e,t,n){super(e,t,n)}};l(gN,"StringKeyframeTrack");var Fg=gN;Fg.prototype.ValueTypeName="string";Fg.prototype.ValueBufferType=Array;Fg.prototype.DefaultInterpolation=F2;Fg.prototype.InterpolantFactoryMethodLinear=void 0;Fg.prototype.InterpolantFactoryMethodSmooth=void 0;var yN=class extends fu{};l(yN,"VectorKeyframeTrack");var q2=yN;q2.prototype.ValueTypeName="vector";var vN=class{constructor(e="",t=-1,n=[],r=Phe){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=gs(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],n=e.tracks,r=1/(e.fps||1);for(let o=0,s=n.length;o!==s;++o)t.push(xN(n[o]).scale(r));let a=new this(e.name,e.duration,t,e.blendMode);return a.uuid=e.uuid,a}static toJSON(e){let t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let a=0,o=n.length;a!==o;++a)t.push(fu.toJSON(n[a]));return r}static CreateFromMorphTargetSequence(e,t,n,r){let a=t.length,o=[];for(let s=0;s<a;s++){let u=[],h=[];u.push((s+a-1)%a,s,(s+1)%a),h.push(0,1,0);let d=rN(u);u=TC(u,1,d),h=TC(h,1,d),!r&&u[0]===0&&(u.push(a),h.push(h[0])),o.push(new W2(".morphTargetInfluences["+t[s].name+"]",u,h).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){let r=e;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){let r={},a=/^([\w-]*?)([\d]+)$/;for(let s=0,u=e.length;s<u;s++){let h=e[s],d=h.name.match(a);if(d&&d.length>1){let f=d[1],m=r[f];m||(r[f]=m=[]),m.push(h)}}let o=[];for(let s in r)o.push(this.CreateFromMorphTargetSequence(s,r[s],t,n));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let n=l(function(d,f,m,v,b){if(m.length!==0){let w=[],A=[];WP(m,w,A,v),w.length!==0&&b.push(new d(f,w,A))}},"addNonemptyTrack"),r=[],a=e.name||"default",o=e.fps||30,s=e.blendMode,u=e.length||-1,h=e.hierarchy||[];for(let d=0;d<h.length;d++){let f=h[d].keys;if(!(!f||f.length===0))if(f[0].morphTargets){let m={},v;for(v=0;v<f.length;v++)if(f[v].morphTargets)for(let b=0;b<f[v].morphTargets.length;b++)m[f[v].morphTargets[b]]=-1;for(let b in m){let w=[],A=[];for(let E=0;E!==f[v].morphTargets.length;++E){let I=f[v];w.push(I.time),A.push(I.morphTarget===b?1:0)}r.push(new W2(".morphTargetInfluence["+b+"]",w,A))}u=m.length*o}else{let m=".bones["+t[d].name+"]";n(q2,m+".position",f,"pos",r),n(Ww,m+".quaternion",f,"rot",r),n(q2,m+".scale",f,"scl",r)}}return r.length===0?null:new this(a,u,r,s)}resetDuration(){let e=this.tracks,t=0;for(let n=0,r=e.length;n!==r;++n){let a=this.tracks[n];t=Math.max(t,a.times[a.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};l(vN,"AnimationClip");var HPe=vN;function _N(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return W2;case"vector":case"vector2":case"vector3":case"vector4":return q2;case"color":return pN;case"quaternion":return Ww;case"bool":case"boolean":return Ng;case"string":return Fg}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}l(_N,"getTrackTypeForValueTypeName");function xN(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let e=_N(i.type);if(i.times===void 0){let t=[],n=[];WP(i.keys,t,n,"value"),i.times=t,i.values=n}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}l(xN,"parseKeyframeTrack");var Mc={enabled:!1,files:{},add:l(function(i,e){this.enabled!==!1&&(this.files[i]=e)},"add"),get:l(function(i){if(this.enabled!==!1)return this.files[i]},"get"),remove:l(function(i){delete this.files[i]},"remove"),clear:l(function(){this.files={}},"clear")},bN=class{constructor(e,t,n){let r=this,a=!1,o=0,s=0,u,h=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(d){s++,a===!1&&r.onStart!==void 0&&r.onStart(d,o,s),a=!0},this.itemEnd=function(d){o++,r.onProgress!==void 0&&r.onProgress(d,o,s),o===s&&(a=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(d){r.onError!==void 0&&r.onError(d)},this.resolveURL=function(d){return u?u(d):d},this.setURLModifier=function(d){return u=d,this},this.addHandler=function(d,f){return h.push(d,f),this},this.removeHandler=function(d){let f=h.indexOf(d);return f!==-1&&h.splice(f,2),this},this.getHandler=function(d){for(let f=0,m=h.length;f<m;f+=2){let v=h[f],b=h[f+1];if(v.global&&(v.lastIndex=0),v.test(d))return b}return null}}};l(bN,"LoadingManager");var Nce=bN,Fce=new Nce,wN=class{constructor(e){this.manager=e!==void 0?e:Fce,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){let n=this;return new Promise(function(r,a){n.load(e,r,t,a)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};l(wN,"Loader");var X1=wN;X1.DEFAULT_MATERIAL_NAME="__DEFAULT";var ku={},AN=class extends Error{constructor(e,t){super(e),this.response=t}};l(AN,"HttpError");var Bce=AN,SN=class extends X1{constructor(e){super(e)}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let a=Mc.get(e);if(a!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(a),this.manager.itemEnd(e)},0),a;if(ku[e]!==void 0){ku[e].push({onLoad:t,onProgress:n,onError:r});return}ku[e]=[],ku[e].push({onLoad:t,onProgress:n,onError:r});let o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),s=this.mimeType,u=this.responseType;fetch(o).then(h=>{if(h.status===200||h.status===0){if(h.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||h.body===void 0||h.body.getReader===void 0)return h;let d=ku[e],f=h.body.getReader(),m=h.headers.get("X-File-Size")||h.headers.get("Content-Length"),v=m?parseInt(m):0,b=v!==0,w=0,A=new ReadableStream({start(E){I();function I(){f.read().then(({done:C,value:T})=>{if(C)E.close();else{w+=T.byteLength;let k=new ProgressEvent("progress",{lengthComputable:b,loaded:w,total:v});for(let F=0,B=d.length;F<B;F++){let N=d[F];N.onProgress&&N.onProgress(k)}E.enqueue(T),I()}},C=>{E.error(C)})}l(I,"readData")}});return new Response(A)}else throw new Bce('fetch for "'.concat(h.url,'" responded with ').concat(h.status,": ").concat(h.statusText),h)}).then(h=>{switch(u){case"arraybuffer":return h.arrayBuffer();case"blob":return h.blob();case"document":return h.text().then(d=>new DOMParser().parseFromString(d,s));case"json":return h.json();default:if(s===void 0)return h.text();{let d=/charset="?([^;"\s]*)"?/i.exec(s),f=d&&d[1]?d[1].toLowerCase():void 0,m=new TextDecoder(f);return h.arrayBuffer().then(v=>m.decode(v))}}}).then(h=>{Mc.add(e,h);let d=ku[e];delete ku[e];for(let f=0,m=d.length;f<m;f++){let v=d[f];v.onLoad&&v.onLoad(h)}}).catch(h=>{let d=ku[e];if(d===void 0)throw this.manager.itemError(e),h;delete ku[e];for(let f=0,m=d.length;f<m;f++){let v=d[f];v.onError&&v.onError(h)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}};l(SN,"FileLoader");var YPe=SN,MN=class extends X1{constructor(e){super(e)}load(e,t,n,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let a=this,o=Mc.get(e);if(o!==void 0)return a.manager.itemStart(e),setTimeout(function(){t&&t(o),a.manager.itemEnd(e)},0),o;let s=og("img");function u(){d(),Mc.add(e,this),t&&t(this),a.manager.itemEnd(e)}l(u,"onImageLoad");function h(f){d(),r&&r(f),a.manager.itemError(e),a.manager.itemEnd(e)}l(h,"onImageError");function d(){s.removeEventListener("load",u,!1),s.removeEventListener("error",h,!1)}return l(d,"removeEventListeners"),s.addEventListener("load",u,!1),s.addEventListener("error",h,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(s.crossOrigin=this.crossOrigin),a.manager.itemStart(e),s.src=e,s}};l(MN,"ImageLoader");var zce=MN,CN=class extends X1{constructor(e){super(e)}load(e,t,n,r){let a=new Zo,o=new zce(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(s){a.image=s,a.needsUpdate=!0,t!==void 0&&t(a)},n,r),a}};l(CN,"TextureLoader");var qP=CN,EN=class extends vr{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Mi(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}};l(EN,"Light");var qw=EN,zS=new qi,mk=new Ee,gk=new Ee,IN=class{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ft(512,512),this.map=null,this.mapPass=null,this.matrix=new qi,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new H1,this._frameExtents=new ft(1,1),this._viewportCount=1,this._viewports=[new jn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,n=this.matrix;mk.setFromMatrixPosition(e.matrixWorld),t.position.copy(mk),gk.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(gk),t.updateMatrixWorld(),zS.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(zS),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(zS)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}};l(IN,"LightShadow");var XP=IN,TN=class extends XP{constructor(){super(new Ao(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,n=ag*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,a=e.distance||t.far;(n!==t.fov||r!==t.aspect||a!==t.far)&&(t.fov=n,t.aspect=r,t.far=a,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}};l(TN,"SpotLightShadow");var Uce=TN,PN=class extends qw{constructor(e,t,n=0,r=Math.PI/3,a=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(vr.DEFAULT_UP),this.updateMatrix(),this.target=new vr,this.distance=n,this.angle=r,this.penumbra=a,this.decay=o,this.map=null,this.shadow=new Uce}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}};l(PN,"SpotLight");var n5e=PN,yk=new qi,dy=new Ee,US=new Ee,LN=class extends XP{constructor(){super(new Ao(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new ft(4,2),this._viewportCount=6,this._viewports=[new jn(2,1,1,1),new jn(0,1,1,1),new jn(3,1,1,1),new jn(1,1,1,1),new jn(3,0,1,1),new jn(1,0,1,1)],this._cubeDirections=[new Ee(1,0,0),new Ee(-1,0,0),new Ee(0,0,1),new Ee(0,0,-1),new Ee(0,1,0),new Ee(0,-1,0)],this._cubeUps=[new Ee(0,1,0),new Ee(0,1,0),new Ee(0,1,0),new Ee(0,1,0),new Ee(0,0,1),new Ee(0,0,-1)]}updateMatrices(e,t=0){let n=this.camera,r=this.matrix,a=e.distance||n.far;a!==n.far&&(n.far=a,n.updateProjectionMatrix()),dy.setFromMatrixPosition(e.matrixWorld),n.position.copy(dy),US.copy(n.position),US.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(US),n.updateMatrixWorld(),r.makeTranslation(-dy.x,-dy.y,-dy.z),yk.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(yk)}};l(LN,"PointLightShadow");var Vce=LN,DN=class extends qw{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new Vce}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}};l(DN,"PointLight");var o5e=DN,kN=class extends BP{constructor(e=-1,t=1,n=1,r=-1,a=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=a,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,a,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=a,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,a=n-e,o=n+e,s=r+t,u=r-t;if(this.view!==null&&this.view.enabled){let h=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=h*this.view.offsetX,o=a+h*this.view.width,s-=d*this.view.offsetY,u=s-d*this.view.height}this.projectionMatrix.makeOrthographic(a,o,s,u,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}};l(kN,"OrthographicCamera");var RN=kN,ON=class extends XP{constructor(){super(new RN(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}};l(ON,"DirectionalLightShadow");var jce=ON,NN=class extends qw{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(vr.DEFAULT_UP),this.updateMatrix(),this.target=new vr,this.shadow=new jce}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}};l(NN,"DirectionalLight");var FN=NN,BN=class extends qw{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}};l(BN,"AmbientLight");var Gce=BN,zN=class{static decodeText(e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){let t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}};l(zN,"LoaderUtils");var p5e=zN,UN=class extends Sa{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}};l(UN,"InstancedBufferGeometry");var f5e=UN,VN=class extends X1{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let a=this,o=Mc.get(e);if(o!==void 0){if(a.manager.itemStart(e),o.then){o.then(h=>{t&&t(h),a.manager.itemEnd(e)}).catch(h=>{r&&r(h)});return}return setTimeout(function(){t&&t(o),a.manager.itemEnd(e)},0),o}let s={};s.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",s.headers=this.requestHeader;let u=fetch(e,s).then(function(h){return h.blob()}).then(function(h){return createImageBitmap(h,Object.assign(a.options,{colorSpaceConversion:"none"}))}).then(function(h){return Mc.add(e,h),t&&t(h),a.manager.itemEnd(e),h}).catch(function(h){r&&r(h),Mc.remove(e),a.manager.itemError(e),a.manager.itemEnd(e)});Mc.add(e,u),a.manager.itemStart(e)}};l(VN,"ImageBitmapLoader");var g5e=VN,jN=class extends Ao{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e,this.index=0}};l(jN,"ArrayCamera");var $ce=jN,GN=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=PC(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=PC();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};l(GN,"Clock");var Hce=GN;function PC(){return performance.now()}l(PC,"now");var ZP="\\[\\]\\.:\\/",Wce=new RegExp("["+ZP+"]","g"),YP="[^"+ZP+"]",qce="[^"+ZP.replace("\\.","")+"]",Xce=/((?:WC+[\/:])*)/.source.replace("WC",YP),Zce=/(WCOD+)?/.source.replace("WCOD",qce),Yce=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",YP),Jce=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",YP),Kce=new RegExp("^"+Xce+Zce+Yce+Jce+"$"),Qce=["material","materials","bones","map"],$N=class{constructor(e,t,n){let r=n||Gr.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();let n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(e,t)}setValue(e,t){let n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,a=n.length;r!==a;++r)n[r].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}};l($N,"Composite");var epe=$N,HN=class ff{constructor(e,t,n){this.path=t,this.parsedPath=n||ff.parseTrackName(t),this.node=ff.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new ff.Composite(e,t,n):new ff(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Wce,"")}static parseTrackName(e){let t=Kce.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){let a=n.nodeName.substring(r+1);Qce.indexOf(a)!==-1&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=a)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){let n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){let n=l(function(a){for(let o=0;o<a.length;o++){let s=a[o];if(s.name===t||s.uuid===t)return s;let u=n(s.children);if(u)return u}return null},"searchNodeSubtree"),r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let n=this.resolvedProperty;for(let r=0,a=n.length;r!==a;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let n=this.resolvedProperty;for(let r=0,a=n.length;r!==a;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let n=this.resolvedProperty;for(let r=0,a=n.length;r!==a;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let n=this.resolvedProperty;for(let r=0,a=n.length;r!==a;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,n=t.objectName,r=t.propertyName,a=t.propertyIndex;if(e||(e=ff.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let h=t.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let d=0;d<e.length;d++)if(e[d].name===h){h=d;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(h!==void 0){if(e[h]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[h]}}let o=e[r];if(o===void 0){let h=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+r+" but it wasn't found.",e);return}let s=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?s=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(s=this.Versioning.MatrixWorldNeedsUpdate);let u=this.BindingType.Direct;if(a!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[a]!==void 0&&(a=e.morphTargetDictionary[a])}u=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=a}else o.fromArray!==void 0&&o.toArray!==void 0?(u=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(u=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][s]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};l(HN,"PropertyBinding");var Gr=HN;Gr.Composite=epe;Gr.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Gr.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Gr.prototype.GetterByBindingType=[Gr.prototype._getValue_direct,Gr.prototype._getValue_array,Gr.prototype._getValue_arrayElement,Gr.prototype._getValue_toArray];Gr.prototype.SetterByBindingTypeAndVersioning=[[Gr.prototype._setValue_direct,Gr.prototype._setValue_direct_setNeedsUpdate,Gr.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Gr.prototype._setValue_array,Gr.prototype._setValue_array_setNeedsUpdate,Gr.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Gr.prototype._setValue_arrayElement,Gr.prototype._setValue_arrayElement_setNeedsUpdate,Gr.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Gr.prototype._setValue_fromArray,Gr.prototype._setValue_fromArray_setNeedsUpdate,Gr.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var vk=new qi,WN=class{constructor(e,t,n=0,r=1/0){this.ray=new $1(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new NP,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return vk.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(vk),this}intersectObject(e,t=!0,n=[]){return X2(e,this,n,t),n.sort(LC),n}intersectObjects(e,t=!0,n=[]){for(let r=0,a=e.length;r<a;r++)X2(e[r],this,n,t);return n.sort(LC),n}};l(WN,"Raycaster");var Z1=WN;function LC(i,e){return i.distance-e.distance}l(LC,"ascSort");function X2(i,e,t,n){let r=!0;if(i.layers.test(e.layers)&&i.raycast(e,t)===!1&&(r=!1),r===!0&&n===!0){let a=i.children;for(let o=0,s=a.length;o<s;o++)X2(a[o],e,t,!0)}}l(X2,"intersect");var _k=new ft,qN=class{constructor(e=new ft(1/0,1/0),t=new ft(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let n=_k.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,_k).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}};l(qN,"Box2");var JP=qN,tpe=class extends Gw{constructor(e=1){let t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new Sa;r.setAttribute("position",new Fr(t,3)),r.setAttribute("color",new Fr(n,3));let a=new VP({vertexColors:!0,toneMapped:!1});super(r,a),this.type="AxesHelper"}setColors(e,t,n){let r=new Mi,a=this.geometry.attributes.color.array;return r.set(e),r.toArray(a,0),r.toArray(a,3),r.set(t),r.toArray(a,6),r.toArray(a,9),r.set(n),r.toArray(a,12),r.toArray(a,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}};l(tpe,"AxesHelper");function DC(i,e,t,n){let r=XN(n);switch(t){case q8:return i*e;case Z8:return i*e;case Y8:return i*e*2;case LP:return i*e/r.components*r.byteLength;case Vw:return i*e/r.components*r.byteLength;case J8:return i*e*2/r.components*r.byteLength;case DP:return i*e*2/r.components*r.byteLength;case X8:return i*e*3/r.components*r.byteLength;case ao:return i*e*4/r.components*r.byteLength;case kP:return i*e*4/r.components*r.byteLength;case z_:case U_:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case V_:case j_:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case WM:case XM:return Math.max(i,16)*Math.max(e,8)/4;case HM:case qM:return Math.max(i,8)*Math.max(e,8)/2;case ZM:case YM:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case JM:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case KM:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case QM:return Math.floor((i+4)/5)*Math.floor((e+3)/4)*16;case eC:return Math.floor((i+4)/5)*Math.floor((e+4)/5)*16;case tC:return Math.floor((i+5)/6)*Math.floor((e+4)/5)*16;case iC:return Math.floor((i+5)/6)*Math.floor((e+5)/6)*16;case nC:return Math.floor((i+7)/8)*Math.floor((e+4)/5)*16;case rC:return Math.floor((i+7)/8)*Math.floor((e+5)/6)*16;case aC:return Math.floor((i+7)/8)*Math.floor((e+7)/8)*16;case oC:return Math.floor((i+9)/10)*Math.floor((e+4)/5)*16;case sC:return Math.floor((i+9)/10)*Math.floor((e+5)/6)*16;case lC:return Math.floor((i+9)/10)*Math.floor((e+7)/8)*16;case uC:return Math.floor((i+9)/10)*Math.floor((e+9)/10)*16;case hC:return Math.floor((i+11)/12)*Math.floor((e+9)/10)*16;case cC:return Math.floor((i+11)/12)*Math.floor((e+11)/12)*16;case G_:case pC:case dC:return Math.ceil(i/4)*Math.ceil(e/4)*16;case K8:case fC:return Math.ceil(i/4)*Math.ceil(e/4)*8;case mC:case gC:return Math.ceil(i/4)*Math.ceil(e/4)*16}throw new Error("Unable to determine texture byte length for ".concat(t," format."))}l(DC,"getByteLength");function XN(i){switch(i){case vl:case $8:return{byteLength:1,components:1};case Kv:case H8:case G1:return{byteLength:2,components:1};case TP:case PP:return{byteLength:2,components:4};case Rc:case IP:case hs:return{byteLength:4,components:1};case W8:return{byteLength:4,components:3}}throw new Error("Unknown texture type ".concat(i,"."))}l(XN,"getTextureTypeByteLength");typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:CP}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=CP);R();function KP(){let i=null,e=!1,t=null,n=null;function r(a,o){t(a,o),n=i.requestAnimationFrame(r)}return l(r,"onAnimationFrame"),{start:l(function(){e!==!0&&t!==null&&(n=i.requestAnimationFrame(r),e=!0)},"start"),stop:l(function(){i.cancelAnimationFrame(n),e=!1},"stop"),setAnimationLoop:l(function(a){t=a},"setAnimationLoop"),setContext:l(function(a){i=a},"setContext")}}l(KP,"WebGLAnimation");function ZN(i){let e=new WeakMap;function t(s,u){let h=s.array,d=s.usage,f=h.byteLength,m=i.createBuffer();i.bindBuffer(u,m),i.bufferData(u,h,d),s.onUploadCallback();let v;if(h instanceof Float32Array)v=i.FLOAT;else if(h instanceof Uint16Array)s.isFloat16BufferAttribute?v=i.HALF_FLOAT:v=i.UNSIGNED_SHORT;else if(h instanceof Int16Array)v=i.SHORT;else if(h instanceof Uint32Array)v=i.UNSIGNED_INT;else if(h instanceof Int32Array)v=i.INT;else if(h instanceof Int8Array)v=i.BYTE;else if(h instanceof Uint8Array)v=i.UNSIGNED_BYTE;else if(h instanceof Uint8ClampedArray)v=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:m,type:v,bytesPerElement:h.BYTES_PER_ELEMENT,version:s.version,size:f}}l(t,"createBuffer");function n(s,u,h){let d=u.array,f=u.updateRanges;if(i.bindBuffer(h,s),f.length===0)i.bufferSubData(h,0,d);else{f.sort((v,b)=>v.start-b.start);let m=0;for(let v=1;v<f.length;v++){let b=f[m],w=f[v];w.start<=b.start+b.count+1?b.count=Math.max(b.count,w.start+w.count-b.start):(++m,f[m]=w)}f.length=m+1;for(let v=0,b=f.length;v<b;v++){let w=f[v];i.bufferSubData(h,w.start*d.BYTES_PER_ELEMENT,d,w.start,w.count)}u.clearUpdateRanges()}u.onUploadCallback()}l(n,"updateBuffer");function r(s){return s.isInterleavedBufferAttribute&&(s=s.data),e.get(s)}l(r,"get");function a(s){s.isInterleavedBufferAttribute&&(s=s.data);let u=e.get(s);u&&(i.deleteBuffer(u.buffer),e.delete(s))}l(a,"remove");function o(s,u){if(s.isInterleavedBufferAttribute&&(s=s.data),s.isGLBufferAttribute){let d=e.get(s);(!d||d.version<s.version)&&e.set(s,{buffer:s.buffer,type:s.type,bytesPerElement:s.elementSize,version:s.version});return}let h=e.get(s);if(h===void 0)e.set(s,t(s,u));else if(h.version<s.version){if(h.size!==s.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(h.buffer,s,u),h.version=s.version}}return l(o,"update"),{get:r,remove:a,update:o}}l(ZN,"WebGLAttributes");var ipe=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,npe=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,rpe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,ape=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,ope=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,spe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,lpe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,upe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,hpe=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,cpe=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,ppe=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,dpe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,fpe=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,mpe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,gpe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,ype=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,vpe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,_pe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,xpe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,bpe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,wpe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Ape=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,Spe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,Mpe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,Cpe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Epe=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Ipe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Tpe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,Ppe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Lpe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Dpe="gl_FragColor = linearToOutputTexel( gl_FragColor );",kpe=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Rpe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Ope=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Npe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Fpe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Bpe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,zpe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Upe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Vpe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,jpe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Gpe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,$pe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Hpe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Wpe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,qpe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Xpe=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,Zpe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Ype=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Jpe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Kpe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Qpe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,ede=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,tde=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,ide=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,nde=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,rde=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,ade=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,ode=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,sde=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,lde=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,ude=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,hde=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,cde=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,pde=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,dde=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,fde=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,mde=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,gde=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,yde=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,vde=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,_de=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,xde=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,bde=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,wde=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Ade=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Sde=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,Mde=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,Cde=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,Ede=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,Ide=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Tde=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Pde=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Lde=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Dde=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,kde=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Rde=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Ode=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Nde=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Fde=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,Bde=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,zde=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Ude=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Vde=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,jde=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,Gde=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,$de=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Hde=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Wde=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,qde=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Xde=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Zde=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,Yde=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Jde=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Kde=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Qde=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,efe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,tfe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,ife=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,nfe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,rfe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,afe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,ofe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,sfe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,lfe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,ufe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,hfe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,cfe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,pfe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,dfe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,ffe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,mfe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,gfe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,yfe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,vfe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,_fe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,xfe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,bfe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,wfe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Afe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Sfe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Mfe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Cfe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Efe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Ife=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Tfe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Pfe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Lfe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Dfe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,kfe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Rfe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,an={alphahash_fragment:ipe,alphahash_pars_fragment:npe,alphamap_fragment:rpe,alphamap_pars_fragment:ape,alphatest_fragment:ope,alphatest_pars_fragment:spe,aomap_fragment:lpe,aomap_pars_fragment:upe,batching_pars_vertex:hpe,batching_vertex:cpe,begin_vertex:ppe,beginnormal_vertex:dpe,bsdfs:fpe,iridescence_fragment:mpe,bumpmap_pars_fragment:gpe,clipping_planes_fragment:ype,clipping_planes_pars_fragment:vpe,clipping_planes_pars_vertex:_pe,clipping_planes_vertex:xpe,color_fragment:bpe,color_pars_fragment:wpe,color_pars_vertex:Ape,color_vertex:Spe,common:Mpe,cube_uv_reflection_fragment:Cpe,defaultnormal_vertex:Epe,displacementmap_pars_vertex:Ipe,displacementmap_vertex:Tpe,emissivemap_fragment:Ppe,emissivemap_pars_fragment:Lpe,colorspace_fragment:Dpe,colorspace_pars_fragment:kpe,envmap_fragment:Rpe,envmap_common_pars_fragment:Ope,envmap_pars_fragment:Npe,envmap_pars_vertex:Fpe,envmap_physical_pars_fragment:Xpe,envmap_vertex:Bpe,fog_vertex:zpe,fog_pars_vertex:Upe,fog_fragment:Vpe,fog_pars_fragment:jpe,gradientmap_pars_fragment:Gpe,lightmap_pars_fragment:$pe,lights_lambert_fragment:Hpe,lights_lambert_pars_fragment:Wpe,lights_pars_begin:qpe,lights_toon_fragment:Zpe,lights_toon_pars_fragment:Ype,lights_phong_fragment:Jpe,lights_phong_pars_fragment:Kpe,lights_physical_fragment:Qpe,lights_physical_pars_fragment:ede,lights_fragment_begin:tde,lights_fragment_maps:ide,lights_fragment_end:nde,logdepthbuf_fragment:rde,logdepthbuf_pars_fragment:ade,logdepthbuf_pars_vertex:ode,logdepthbuf_vertex:sde,map_fragment:lde,map_pars_fragment:ude,map_particle_fragment:hde,map_particle_pars_fragment:cde,metalnessmap_fragment:pde,metalnessmap_pars_fragment:dde,morphinstance_vertex:fde,morphcolor_vertex:mde,morphnormal_vertex:gde,morphtarget_pars_vertex:yde,morphtarget_vertex:vde,normal_fragment_begin:_de,normal_fragment_maps:xde,normal_pars_fragment:bde,normal_pars_vertex:wde,normal_vertex:Ade,normalmap_pars_fragment:Sde,clearcoat_normal_fragment_begin:Mde,clearcoat_normal_fragment_maps:Cde,clearcoat_pars_fragment:Ede,iridescence_pars_fragment:Ide,opaque_fragment:Tde,packing:Pde,premultiplied_alpha_fragment:Lde,project_vertex:Dde,dithering_fragment:kde,dithering_pars_fragment:Rde,roughnessmap_fragment:Ode,roughnessmap_pars_fragment:Nde,shadowmap_pars_fragment:Fde,shadowmap_pars_vertex:Bde,shadowmap_vertex:zde,shadowmask_pars_fragment:Ude,skinbase_vertex:Vde,skinning_pars_vertex:jde,skinning_vertex:Gde,skinnormal_vertex:$de,specularmap_fragment:Hde,specularmap_pars_fragment:Wde,tonemapping_fragment:qde,tonemapping_pars_fragment:Xde,transmission_fragment:Zde,transmission_pars_fragment:Yde,uv_pars_fragment:Jde,uv_pars_vertex:Kde,uv_vertex:Qde,worldpos_vertex:efe,background_vert:tfe,background_frag:ife,backgroundCube_vert:nfe,backgroundCube_frag:rfe,cube_vert:afe,cube_frag:ofe,depth_vert:sfe,depth_frag:lfe,distanceRGBA_vert:ufe,distanceRGBA_frag:hfe,equirect_vert:cfe,equirect_frag:pfe,linedashed_vert:dfe,linedashed_frag:ffe,meshbasic_vert:mfe,meshbasic_frag:gfe,meshlambert_vert:yfe,meshlambert_frag:vfe,meshmatcap_vert:_fe,meshmatcap_frag:xfe,meshnormal_vert:bfe,meshnormal_frag:wfe,meshphong_vert:Afe,meshphong_frag:Sfe,meshphysical_vert:Mfe,meshphysical_frag:Cfe,meshtoon_vert:Efe,meshtoon_frag:Ife,points_vert:Tfe,points_frag:Pfe,shadow_vert:Lfe,shadow_frag:Dfe,sprite_vert:kfe,sprite_frag:Rfe},Xt={common:{diffuse:{value:new Mi(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new fn},alphaMap:{value:null},alphaMapTransform:{value:new fn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new fn}},envmap:{envMap:{value:null},envMapRotation:{value:new fn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new fn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new fn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new fn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new fn},normalScale:{value:new ft(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new fn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new fn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new fn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new fn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Mi(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Mi(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new fn},alphaTest:{value:0},uvTransform:{value:new fn}},sprite:{diffuse:{value:new Mi(16777215)},opacity:{value:1},center:{value:new ft(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new fn},alphaMap:{value:null},alphaMapTransform:{value:new fn},alphaTest:{value:0}}},Gl={basic:{uniforms:Qa([Xt.common,Xt.specularmap,Xt.envmap,Xt.aomap,Xt.lightmap,Xt.fog]),vertexShader:an.meshbasic_vert,fragmentShader:an.meshbasic_frag},lambert:{uniforms:Qa([Xt.common,Xt.specularmap,Xt.envmap,Xt.aomap,Xt.lightmap,Xt.emissivemap,Xt.bumpmap,Xt.normalmap,Xt.displacementmap,Xt.fog,Xt.lights,{emissive:{value:new Mi(0)}}]),vertexShader:an.meshlambert_vert,fragmentShader:an.meshlambert_frag},phong:{uniforms:Qa([Xt.common,Xt.specularmap,Xt.envmap,Xt.aomap,Xt.lightmap,Xt.emissivemap,Xt.bumpmap,Xt.normalmap,Xt.displacementmap,Xt.fog,Xt.lights,{emissive:{value:new Mi(0)},specular:{value:new Mi(1118481)},shininess:{value:30}}]),vertexShader:an.meshphong_vert,fragmentShader:an.meshphong_frag},standard:{uniforms:Qa([Xt.common,Xt.envmap,Xt.aomap,Xt.lightmap,Xt.emissivemap,Xt.bumpmap,Xt.normalmap,Xt.displacementmap,Xt.roughnessmap,Xt.metalnessmap,Xt.fog,Xt.lights,{emissive:{value:new Mi(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:an.meshphysical_vert,fragmentShader:an.meshphysical_frag},toon:{uniforms:Qa([Xt.common,Xt.aomap,Xt.lightmap,Xt.emissivemap,Xt.bumpmap,Xt.normalmap,Xt.displacementmap,Xt.gradientmap,Xt.fog,Xt.lights,{emissive:{value:new Mi(0)}}]),vertexShader:an.meshtoon_vert,fragmentShader:an.meshtoon_frag},matcap:{uniforms:Qa([Xt.common,Xt.bumpmap,Xt.normalmap,Xt.displacementmap,Xt.fog,{matcap:{value:null}}]),vertexShader:an.meshmatcap_vert,fragmentShader:an.meshmatcap_frag},points:{uniforms:Qa([Xt.points,Xt.fog]),vertexShader:an.points_vert,fragmentShader:an.points_frag},dashed:{uniforms:Qa([Xt.common,Xt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:an.linedashed_vert,fragmentShader:an.linedashed_frag},depth:{uniforms:Qa([Xt.common,Xt.displacementmap]),vertexShader:an.depth_vert,fragmentShader:an.depth_frag},normal:{uniforms:Qa([Xt.common,Xt.bumpmap,Xt.normalmap,Xt.displacementmap,{opacity:{value:1}}]),vertexShader:an.meshnormal_vert,fragmentShader:an.meshnormal_frag},sprite:{uniforms:Qa([Xt.sprite,Xt.fog]),vertexShader:an.sprite_vert,fragmentShader:an.sprite_frag},background:{uniforms:{uvTransform:{value:new fn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:an.background_vert,fragmentShader:an.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new fn}},vertexShader:an.backgroundCube_vert,fragmentShader:an.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:an.cube_vert,fragmentShader:an.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:an.equirect_vert,fragmentShader:an.equirect_frag},distanceRGBA:{uniforms:Qa([Xt.common,Xt.displacementmap,{referencePosition:{value:new Ee},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:an.distanceRGBA_vert,fragmentShader:an.distanceRGBA_frag},shadow:{uniforms:Qa([Xt.lights,Xt.fog,{color:{value:new Mi(0)},opacity:{value:1}}]),vertexShader:an.shadow_vert,fragmentShader:an.shadow_frag}};Gl.physical={uniforms:Qa([Gl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new fn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new fn},clearcoatNormalScale:{value:new ft(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new fn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new fn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new fn},sheen:{value:0},sheenColor:{value:new Mi(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new fn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new fn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new fn},transmissionSamplerSize:{value:new ft},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new fn},attenuationDistance:{value:0},attenuationColor:{value:new Mi(0)},specularColor:{value:new Mi(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new fn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new fn},anisotropyVector:{value:new ft},anisotropyMap:{value:null},anisotropyMapTransform:{value:new fn}}]),vertexShader:an.meshphysical_vert,fragmentShader:an.meshphysical_frag};var o_={r:0,b:0,g:0},hp=new Wo,Ofe=new qi;function YN(i,e,t,n,r,a,o){let s=new Mi(0),u=a===!0?0:1,h,d,f=null,m=0,v=null;function b(C){let T=C.isScene===!0?C.background:null;return T&&T.isTexture&&(T=(C.backgroundBlurriness>0?t:e).get(T)),T}l(b,"getBackground");function w(C){let T=!1,k=b(C);k===null?E(s,u):k&&k.isColor&&(E(k,1),T=!0);let F=i.xr.getEnvironmentBlendMode();F==="additive"?n.buffers.color.setClear(0,0,0,1,o):F==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,o),(i.autoClear||T)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil))}l(w,"render");function A(C,T){let k=b(T);k&&(k.isCubeTexture||k.mapping===Uw)?(d===void 0&&(d=new ln(new Nc(1,1,1),new ys({name:"BackgroundCubeMaterial",uniforms:dd(Gl.backgroundCube.uniforms),vertexShader:Gl.backgroundCube.vertexShader,fragmentShader:Gl.backgroundCube.fragmentShader,side:Eo,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),d.geometry.deleteAttribute("uv"),d.onBeforeRender=function(F,B,N){this.matrixWorld.copyPosition(N.matrixWorld)},Object.defineProperty(d.material,"envMap",{get:l(function(){return this.uniforms.envMap.value},"get")}),r.update(d)),hp.copy(T.backgroundRotation),hp.x*=-1,hp.y*=-1,hp.z*=-1,k.isCubeTexture&&k.isRenderTargetTexture===!1&&(hp.y*=-1,hp.z*=-1),d.material.uniforms.envMap.value=k,d.material.uniforms.flipEnvMap.value=k.isCubeTexture&&k.isRenderTargetTexture===!1?-1:1,d.material.uniforms.backgroundBlurriness.value=T.backgroundBlurriness,d.material.uniforms.backgroundIntensity.value=T.backgroundIntensity,d.material.uniforms.backgroundRotation.value.setFromMatrix4(Ofe.makeRotationFromEuler(hp)),d.material.toneMapped=kn.getTransfer(k.colorSpace)!==Jn,(f!==k||m!==k.version||v!==i.toneMapping)&&(d.material.needsUpdate=!0,f=k,m=k.version,v=i.toneMapping),d.layers.enableAll(),C.unshift(d,d.geometry,d.material,0,0,null)):k&&k.isTexture&&(h===void 0&&(h=new ln(new Cd(2,2),new ys({name:"BackgroundMaterial",uniforms:dd(Gl.background.uniforms),vertexShader:Gl.background.vertexShader,fragmentShader:Gl.background.fragmentShader,side:su,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),Object.defineProperty(h.material,"map",{get:l(function(){return this.uniforms.t2D.value},"get")}),r.update(h)),h.material.uniforms.t2D.value=k,h.material.uniforms.backgroundIntensity.value=T.backgroundIntensity,h.material.toneMapped=kn.getTransfer(k.colorSpace)!==Jn,k.matrixAutoUpdate===!0&&k.updateMatrix(),h.material.uniforms.uvTransform.value.copy(k.matrix),(f!==k||m!==k.version||v!==i.toneMapping)&&(h.material.needsUpdate=!0,f=k,m=k.version,v=i.toneMapping),h.layers.enableAll(),C.unshift(h,h.geometry,h.material,0,0,null))}l(A,"addToRenderList");function E(C,T){C.getRGB(o_,FP(i)),n.buffers.color.setClear(o_.r,o_.g,o_.b,T,o)}l(E,"setClear");function I(){d!==void 0&&(d.geometry.dispose(),d.material.dispose(),d=void 0),h!==void 0&&(h.geometry.dispose(),h.material.dispose(),h=void 0)}return l(I,"dispose"),{getClearColor:l(function(){return s},"getClearColor"),setClearColor:l(function(C,T=1){s.set(C),u=T,E(s,u)},"setClearColor"),getClearAlpha:l(function(){return u},"getClearAlpha"),setClearAlpha:l(function(C){u=C,E(s,u)},"setClearAlpha"),render:w,addToRenderList:A,dispose:I}}l(YN,"WebGLBackground");function JN(i,e){let t=i.getParameter(i.MAX_VERTEX_ATTRIBS),n={},r=m(null),a=r,o=!1;function s(L,j,q,Z,O){let Y=!1,J=f(Z,q,j);a!==J&&(a=J,h(a.object)),Y=v(L,Z,q,O),Y&&b(L,Z,q,O),O!==null&&e.update(O,i.ELEMENT_ARRAY_BUFFER),(Y||o)&&(o=!1,T(L,j,q,Z),O!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.get(O).buffer))}l(s,"setup");function u(){return i.createVertexArray()}l(u,"createVertexArrayObject");function h(L){return i.bindVertexArray(L)}l(h,"bindVertexArrayObject");function d(L){return i.deleteVertexArray(L)}l(d,"deleteVertexArrayObject");function f(L,j,q){let Z=q.wireframe===!0,O=n[L.id];O===void 0&&(O={},n[L.id]=O);let Y=O[j.id];Y===void 0&&(Y={},O[j.id]=Y);let J=Y[Z];return J===void 0&&(J=m(u()),Y[Z]=J),J}l(f,"getBindingState");function m(L){let j=[],q=[],Z=[];for(let O=0;O<t;O++)j[O]=0,q[O]=0,Z[O]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:j,enabledAttributes:q,attributeDivisors:Z,object:L,attributes:{},index:null}}l(m,"createBindingState");function v(L,j,q,Z){let O=a.attributes,Y=j.attributes,J=0,oe=q.getAttributes();for(let $ in oe)if(oe[$].location>=0){let K=O[$],te=Y[$];if(te===void 0&&($==="instanceMatrix"&&L.instanceMatrix&&(te=L.instanceMatrix),$==="instanceColor"&&L.instanceColor&&(te=L.instanceColor)),K===void 0||K.attribute!==te||te&&K.data!==te.data)return!0;J++}return a.attributesNum!==J||a.index!==Z}l(v,"needsUpdate");function b(L,j,q,Z){let O={},Y=j.attributes,J=0,oe=q.getAttributes();for(let $ in oe)if(oe[$].location>=0){let K=Y[$];K===void 0&&($==="instanceMatrix"&&L.instanceMatrix&&(K=L.instanceMatrix),$==="instanceColor"&&L.instanceColor&&(K=L.instanceColor));let te={};te.attribute=K,K&&K.data&&(te.data=K.data),O[$]=te,J++}a.attributes=O,a.attributesNum=J,a.index=Z}l(b,"saveCache");function w(){let L=a.newAttributes;for(let j=0,q=L.length;j<q;j++)L[j]=0}l(w,"initAttributes");function A(L){E(L,0)}l(A,"enableAttribute");function E(L,j){let q=a.newAttributes,Z=a.enabledAttributes,O=a.attributeDivisors;q[L]=1,Z[L]===0&&(i.enableVertexAttribArray(L),Z[L]=1),O[L]!==j&&(i.vertexAttribDivisor(L,j),O[L]=j)}l(E,"enableAttributeAndDivisor");function I(){let L=a.newAttributes,j=a.enabledAttributes;for(let q=0,Z=j.length;q<Z;q++)j[q]!==L[q]&&(i.disableVertexAttribArray(q),j[q]=0)}l(I,"disableUnusedAttributes");function C(L,j,q,Z,O,Y,J){J===!0?i.vertexAttribIPointer(L,j,q,O,Y):i.vertexAttribPointer(L,j,q,Z,O,Y)}l(C,"vertexAttribPointer");function T(L,j,q,Z){w();let O=Z.attributes,Y=q.getAttributes(),J=j.defaultAttributeValues;for(let oe in Y){let $=Y[oe];if($.location>=0){let K=O[oe];if(K===void 0&&(oe==="instanceMatrix"&&L.instanceMatrix&&(K=L.instanceMatrix),oe==="instanceColor"&&L.instanceColor&&(K=L.instanceColor)),K!==void 0){let te=K.normalized,ve=K.itemSize,Q=e.get(K);if(Q===void 0)continue;let he=Q.buffer,se=Q.type,Ae=Q.bytesPerElement,Ie=se===i.INT||se===i.UNSIGNED_INT||K.gpuType===IP;if(K.isInterleavedBufferAttribute){let we=K.data,Ne=we.stride,je=K.offset;if(we.isInstancedInterleavedBuffer){for(let Ve=0;Ve<$.locationSize;Ve++)E($.location+Ve,we.meshPerAttribute);L.isInstancedMesh!==!0&&Z._maxInstanceCount===void 0&&(Z._maxInstanceCount=we.meshPerAttribute*we.count)}else for(let Ve=0;Ve<$.locationSize;Ve++)A($.location+Ve);i.bindBuffer(i.ARRAY_BUFFER,he);for(let Ve=0;Ve<$.locationSize;Ve++)C($.location+Ve,ve/$.locationSize,se,te,Ne*Ae,(je+ve/$.locationSize*Ve)*Ae,Ie)}else{if(K.isInstancedBufferAttribute){for(let we=0;we<$.locationSize;we++)E($.location+we,K.meshPerAttribute);L.isInstancedMesh!==!0&&Z._maxInstanceCount===void 0&&(Z._maxInstanceCount=K.meshPerAttribute*K.count)}else for(let we=0;we<$.locationSize;we++)A($.location+we);i.bindBuffer(i.ARRAY_BUFFER,he);for(let we=0;we<$.locationSize;we++)C($.location+we,ve/$.locationSize,se,te,ve*Ae,ve/$.locationSize*we*Ae,Ie)}}else if(J!==void 0){let te=J[oe];if(te!==void 0)switch(te.length){case 2:i.vertexAttrib2fv($.location,te);break;case 3:i.vertexAttrib3fv($.location,te);break;case 4:i.vertexAttrib4fv($.location,te);break;default:i.vertexAttrib1fv($.location,te)}}}}I()}l(T,"setupVertexAttributes");function k(){N();for(let L in n){let j=n[L];for(let q in j){let Z=j[q];for(let O in Z)d(Z[O].object),delete Z[O];delete j[q]}delete n[L]}}l(k,"dispose");function F(L){if(n[L.id]===void 0)return;let j=n[L.id];for(let q in j){let Z=j[q];for(let O in Z)d(Z[O].object),delete Z[O];delete j[q]}delete n[L.id]}l(F,"releaseStatesOfGeometry");function B(L){for(let j in n){let q=n[j];if(q[L.id]===void 0)continue;let Z=q[L.id];for(let O in Z)d(Z[O].object),delete Z[O];delete q[L.id]}}l(B,"releaseStatesOfProgram");function N(){z(),o=!0,a!==r&&(a=r,h(a.object))}l(N,"reset");function z(){r.geometry=null,r.program=null,r.wireframe=!1}return l(z,"resetDefaultState"),{setup:s,reset:N,resetDefaultState:z,dispose:k,releaseStatesOfGeometry:F,releaseStatesOfProgram:B,initAttributes:w,enableAttribute:A,disableUnusedAttributes:I}}l(JN,"WebGLBindingStates");function KN(i,e,t){let n;function r(h){n=h}l(r,"setMode");function a(h,d){i.drawArrays(n,h,d),t.update(d,n,1)}l(a,"render");function o(h,d,f){f!==0&&(i.drawArraysInstanced(n,h,d,f),t.update(d,n,f))}l(o,"renderInstances");function s(h,d,f){if(f===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,h,0,d,0,f);let m=0;for(let v=0;v<f;v++)m+=d[v];t.update(m,n,1)}l(s,"renderMultiDraw");function u(h,d,f,m){if(f===0)return;let v=e.get("WEBGL_multi_draw");if(v===null)for(let b=0;b<h.length;b++)o(h[b],d[b],m[b]);else{v.multiDrawArraysInstancedWEBGL(n,h,0,d,0,m,0,f);let b=0;for(let w=0;w<f;w++)b+=d[w]*m[w];t.update(b,n,1)}}l(u,"renderMultiDrawInstances"),this.setMode=r,this.render=a,this.renderInstances=o,this.renderMultiDraw=s,this.renderMultiDrawInstances=u}l(KN,"WebGLBufferRenderer");function QN(i,e,t,n){let r;function a(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){let B=e.get("EXT_texture_filter_anisotropic");r=i.getParameter(B.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}l(a,"getMaxAnisotropy");function o(B){return!(B!==ao&&n.convert(B)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_FORMAT))}l(o,"textureFormatReadable");function s(B){let N=B===G1&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(B!==vl&&n.convert(B)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_TYPE)&&B!==hs&&!N)}l(s,"textureTypeReadable");function u(B){if(B==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";B="mediump"}return B==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}l(u,"getMaxPrecision");let h=t.precision!==void 0?t.precision:"highp",d=u(h);d!==h&&(console.warn("THREE.WebGLRenderer:",h,"not supported, using",d,"instead."),h=d);let f=t.logarithmicDepthBuffer===!0,m=t.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),v=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),b=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),w=i.getParameter(i.MAX_TEXTURE_SIZE),A=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),E=i.getParameter(i.MAX_VERTEX_ATTRIBS),I=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),C=i.getParameter(i.MAX_VARYING_VECTORS),T=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),k=b>0,F=i.getParameter(i.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:a,getMaxPrecision:u,textureFormatReadable:o,textureTypeReadable:s,precision:h,logarithmicDepthBuffer:f,reverseDepthBuffer:m,maxTextures:v,maxVertexTextures:b,maxTextureSize:w,maxCubemapSize:A,maxAttributes:E,maxVertexUniforms:I,maxVaryings:C,maxFragmentUniforms:T,vertexTextures:k,maxSamples:F}}l(QN,"WebGLCapabilities");function eF(i){let e=this,t=null,n=0,r=!1,a=!1,o=new gp,s=new fn,u={value:null,needsUpdate:!1};this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(f,m){let v=f.length!==0||m||n!==0||r;return r=m,n=f.length,v},this.beginShadows=function(){a=!0,d(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(f,m){t=d(f,m,0)},this.setState=function(f,m,v){let b=f.clippingPlanes,w=f.clipIntersection,A=f.clipShadows,E=i.get(f);if(!r||b===null||b.length===0||a&&!A)a?d(null):h();else{let I=a?0:n,C=I*4,T=E.clippingState||null;u.value=T,T=d(b,m,C,v);for(let k=0;k!==C;++k)T[k]=t[k];E.clippingState=T,this.numIntersection=w?this.numPlanes:0,this.numPlanes+=I}};function h(){u.value!==t&&(u.value=t,u.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}l(h,"resetGlobalState");function d(f,m,v,b){let w=f!==null?f.length:0,A=null;if(w!==0){if(A=u.value,b!==!0||A===null){let E=v+w*4,I=m.matrixWorldInverse;s.getNormalMatrix(I),(A===null||A.length<E)&&(A=new Float32Array(E));for(let C=0,T=v;C!==w;++C,T+=4)o.copy(f[C]).applyMatrix4(I,s),o.normal.toArray(A,T),A[T+3]=o.constant}u.value=A,u.needsUpdate=!0}return e.numPlanes=w,e.numIntersection=0,A}l(d,"projectPlanes")}l(eF,"WebGLClipping");function tF(i){let e=new WeakMap;function t(o,s){return s===N2?o.mapping=tg:s===GM&&(o.mapping=ig),o}l(t,"mapTextureMapping");function n(o){if(o&&o.isTexture){let s=o.mapping;if(s===N2||s===GM)if(e.has(o)){let u=e.get(o).texture;return t(u,o.mapping)}else{let u=o.image;if(u&&u.height>0){let h=new uce(u.height);return h.fromEquirectangularTexture(i,o),e.set(o,h),o.addEventListener("dispose",r),t(h.texture,o.mapping)}else return null}}return o}l(n,"get");function r(o){let s=o.target;s.removeEventListener("dispose",r);let u=e.get(s);u!==void 0&&(e.delete(s),u.dispose())}l(r,"onTextureDispose");function a(){e=new WeakMap}return l(a,"dispose"),{get:n,dispose:a}}l(tF,"WebGLCubeMaps");var _m=4,xk=[.125,.215,.35,.446,.526,.582],zp=20,VS=new RN,bk=new Mi,jS=null,GS=0,$S=0,HS=!1,yp=(1+Math.sqrt(5))/2,af=1/yp,wk=[new Ee(-yp,af,0),new Ee(yp,af,0),new Ee(-af,0,yp),new Ee(af,0,yp),new Ee(0,yp,-af),new Ee(0,yp,af),new Ee(-1,1,-1),new Ee(1,1,-1),new Ee(-1,1,1),new Ee(1,1,1)],iF=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100){jS=this._renderer.getRenderTarget(),GS=this._renderer.getActiveCubeFace(),$S=this._renderer.getActiveMipmapLevel(),HS=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);let a=this._allocateTargets();return a.depthBuffer=!0,this._sceneToCubeUV(e,n,r,a),t>0&&this._blur(a,0,0,t),this._applyPMREM(a),this._cleanup(a),a}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=OC(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=RC(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(jS,GS,$S),this._renderer.xr.enabled=HS,e.scissorTest=!1,Dy(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===tg||e.mapping===ig?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),jS=this._renderer.getRenderTarget(),GS=this._renderer.getActiveCubeFace(),$S=this._renderer.getActiveMipmapLevel(),HS=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;let n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Yl,minFilter:Yl,generateMipmaps:!1,type:G1,format:ao,colorSpace:pd,depthBuffer:!1},r=kC(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=kC(e,t,n);let{_lodMax:a}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=nF(a)),this._blurMaterial=rF(a,e,t)}return r}_compileMaterial(e){let t=new ln(this._lodPlanes[0],e);this._renderer.compile(t,VS)}_sceneToCubeUV(e,t,n,r){let a=new Ao(90,1,t,n),o=[1,-1,1,1,1,1],s=[1,1,1,-1,-1,-1],u=this._renderer,h=u.autoClear,d=u.toneMapping;u.getClearColor(bk),u.toneMapping=Tc,u.autoClear=!1;let f=new _l({name:"PMREM.Background",side:Eo,depthWrite:!1,depthTest:!1}),m=new ln(new Nc,f),v=!1,b=e.background;b?b.isColor&&(f.color.copy(b),e.background=null,v=!0):(f.color.copy(bk),v=!0);for(let w=0;w<6;w++){let A=w%3;A===0?(a.up.set(0,o[w],0),a.lookAt(s[w],0,0)):A===1?(a.up.set(0,0,o[w]),a.lookAt(0,s[w],0)):(a.up.set(0,o[w],0),a.lookAt(0,0,s[w]));let E=this._cubeSize;Dy(r,A*E,w>2?E:0,E,E),u.setRenderTarget(r),v&&u.render(m,a),u.render(e,a)}m.geometry.dispose(),m.material.dispose(),u.toneMapping=d,u.autoClear=h,e.background=b}_textureToCubeUV(e,t){let n=this._renderer,r=e.mapping===tg||e.mapping===ig;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=OC()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=RC());let a=r?this._cubemapMaterial:this._equirectMaterial,o=new ln(this._lodPlanes[0],a),s=a.uniforms;s.envMap.value=e;let u=this._cubeSize;Dy(t,0,0,3*u,2*u),n.setRenderTarget(t),n.render(o,VS)}_applyPMREM(e){let t=this._renderer,n=t.autoClear;t.autoClear=!1;let r=this._lodPlanes.length;for(let a=1;a<r;a++){let o=Math.sqrt(this._sigmas[a]*this._sigmas[a]-this._sigmas[a-1]*this._sigmas[a-1]),s=wk[(r-a-1)%wk.length];this._blur(e,a-1,a,o,s)}t.autoClear=n}_blur(e,t,n,r,a){let o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",a),this._halfBlur(o,e,n,n,r,"longitudinal",a)}_halfBlur(e,t,n,r,a,o,s){let u=this._renderer,h=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let d=3,f=new ln(this._lodPlanes[r],h),m=h.uniforms,v=this._sizeLods[n]-1,b=isFinite(a)?Math.PI/(2*v):2*Math.PI/(2*zp-1),w=a/b,A=isFinite(a)?1+Math.floor(d*w):zp;A>zp&&console.warn("sigmaRadians, ".concat(a,", is too large and will clip, as it requested ").concat(A," samples when the maximum is set to ").concat(zp));let E=[],I=0;for(let B=0;B<zp;++B){let N=B/w,z=Math.exp(-N*N/2);E.push(z),B===0?I+=z:B<A&&(I+=2*z)}for(let B=0;B<E.length;B++)E[B]=E[B]/I;m.envMap.value=e.texture,m.samples.value=A,m.weights.value=E,m.latitudinal.value=o==="latitudinal",s&&(m.poleAxis.value=s);let{_lodMax:C}=this;m.dTheta.value=b,m.mipInt.value=C-n;let T=this._sizeLods[r],k=3*T*(r>C-_m?r-C+_m:0),F=4*(this._cubeSize-T);Dy(t,k,F,3*T,2*T),u.setRenderTarget(t),u.render(f,VS)}};l(iF,"PMREMGenerator");var Ak=iF;function nF(i){let e=[],t=[],n=[],r=i,a=i-_m+1+xk.length;for(let o=0;o<a;o++){let s=Math.pow(2,r);t.push(s);let u=1/s;o>i-_m?u=xk[o-i+_m-1]:o===0&&(u=0),n.push(u);let h=1/(s-2),d=-h,f=1+h,m=[d,d,f,d,f,f,d,d,f,f,d,f],v=6,b=6,w=3,A=2,E=1,I=new Float32Array(w*b*v),C=new Float32Array(A*b*v),T=new Float32Array(E*b*v);for(let F=0;F<v;F++){let B=F%3*2/3-1,N=F>2?0:-1,z=[B,N,0,B+2/3,N,0,B+2/3,N+1,0,B,N,0,B+2/3,N+1,0,B,N+1,0];I.set(z,w*b*F),C.set(m,A*b*F);let L=[F,F,F,F,F,F];T.set(L,E*b*F)}let k=new Sa;k.setAttribute("position",new gr(I,w)),k.setAttribute("uv",new gr(C,A)),k.setAttribute("faceIndex",new gr(T,E)),e.push(k),r>_m&&r--}return{lodPlanes:e,sizeLods:t,sigmas:n}}l(nF,"_createPlanes");function kC(i,e,t){let n=new Oc(i,e,t);return n.texture.mapping=Uw,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}l(kC,"_createRenderTarget");function Dy(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}l(Dy,"_setViewport");function rF(i,e,t){let n=new Float32Array(zp),r=new Ee(0,1,0);return new ys({name:"SphericalGaussianBlur",defines:{n:zp,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:"".concat(i,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:Xw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Ic,depthTest:!1,depthWrite:!1})}l(rF,"_getBlurShader");function RC(){return new ys({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Xw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Ic,depthTest:!1,depthWrite:!1})}l(RC,"_getEquirectMaterial");function OC(){return new ys({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Xw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Ic,depthTest:!1,depthWrite:!1})}l(OC,"_getCubemapMaterial");function Xw(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}l(Xw,"_getCommonVertexShader");function aF(i){let e=new WeakMap,t=null;function n(s){if(s&&s.isTexture){let u=s.mapping,h=u===N2||u===GM,d=u===tg||u===ig;if(h||d){let f=e.get(s),m=f!==void 0?f.texture.pmremVersion:0;if(s.isRenderTargetTexture&&s.pmremVersion!==m)return t===null&&(t=new Ak(i)),f=h?t.fromEquirectangular(s,f):t.fromCubemap(s,f),f.texture.pmremVersion=s.pmremVersion,e.set(s,f),f.texture;if(f!==void 0)return f.texture;{let v=s.image;return h&&v&&v.height>0||d&&v&&r(v)?(t===null&&(t=new Ak(i)),f=h?t.fromEquirectangular(s):t.fromCubemap(s),f.texture.pmremVersion=s.pmremVersion,e.set(s,f),s.addEventListener("dispose",a),f.texture):null}}}return s}l(n,"get");function r(s){let u=0,h=6;for(let d=0;d<h;d++)s[d]!==void 0&&u++;return u===h}l(r,"isCubeTextureComplete");function a(s){let u=s.target;u.removeEventListener("dispose",a);let h=e.get(u);h!==void 0&&(e.delete(u),h.dispose())}l(a,"onTextureDispose");function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return l(o,"dispose"),{get:n,dispose:o}}l(aF,"WebGLCubeUVMaps");function oF(i){let e={};function t(n){if(e[n]!==void 0)return e[n];let r;switch(n){case"WEBGL_depth_texture":r=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=i.getExtension(n)}return e[n]=r,r}return l(t,"getExtension"),{has:l(function(n){return t(n)!==null},"has"),init:l(function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},"init"),get:l(function(n){let r=t(n);return r===null&&Bp("THREE.WebGLRenderer: "+n+" extension not supported."),r},"get")}}l(oF,"WebGLExtensions");function sF(i,e,t,n){let r={},a=new WeakMap;function o(f){let m=f.target;m.index!==null&&e.remove(m.index);for(let b in m.attributes)e.remove(m.attributes[b]);m.removeEventListener("dispose",o),delete r[m.id];let v=a.get(m);v&&(e.remove(v),a.delete(m)),n.releaseStatesOfGeometry(m),m.isInstancedBufferGeometry===!0&&delete m._maxInstanceCount,t.memory.geometries--}l(o,"onGeometryDispose");function s(f,m){return r[m.id]===!0||(m.addEventListener("dispose",o),r[m.id]=!0,t.memory.geometries++),m}l(s,"get");function u(f){let m=f.attributes;for(let v in m)e.update(m[v],i.ARRAY_BUFFER)}l(u,"update");function h(f){let m=[],v=f.index,b=f.attributes.position,w=0;if(v!==null){let I=v.array;w=v.version;for(let C=0,T=I.length;C<T;C+=3){let k=I[C+0],F=I[C+1],B=I[C+2];m.push(k,F,F,B,B,k)}}else if(b!==void 0){let I=b.array;w=b.version;for(let C=0,T=I.length/3-1;C<T;C+=3){let k=C+0,F=C+1,B=C+2;m.push(k,F,F,B,B,k)}}else return;let A=new(OP(m)?nO:tO)(m,1);A.version=w;let E=a.get(f);E&&e.remove(E),a.set(f,A)}l(h,"updateWireframeAttribute");function d(f){let m=a.get(f);if(m){let v=f.index;v!==null&&m.version<v.version&&h(f)}else h(f);return a.get(f)}return l(d,"getWireframeAttribute"),{get:s,update:u,getWireframeAttribute:d}}l(sF,"WebGLGeometries");function lF(i,e,t){let n;function r(m){n=m}l(r,"setMode");let a,o;function s(m){a=m.type,o=m.bytesPerElement}l(s,"setIndex");function u(m,v){i.drawElements(n,v,a,m*o),t.update(v,n,1)}l(u,"render");function h(m,v,b){b!==0&&(i.drawElementsInstanced(n,v,a,m*o,b),t.update(v,n,b))}l(h,"renderInstances");function d(m,v,b){if(b===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,v,0,a,m,0,b);let w=0;for(let A=0;A<b;A++)w+=v[A];t.update(w,n,1)}l(d,"renderMultiDraw");function f(m,v,b,w){if(b===0)return;let A=e.get("WEBGL_multi_draw");if(A===null)for(let E=0;E<m.length;E++)h(m[E]/o,v[E],w[E]);else{A.multiDrawElementsInstancedWEBGL(n,v,0,a,m,0,w,0,b);let E=0;for(let I=0;I<b;I++)E+=v[I]*w[I];t.update(E,n,1)}}l(f,"renderMultiDrawInstances"),this.setMode=r,this.setIndex=s,this.render=u,this.renderInstances=h,this.renderMultiDraw=d,this.renderMultiDrawInstances=f}l(lF,"WebGLIndexedBufferRenderer");function uF(i){let e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(a,o,s){switch(t.calls++,o){case i.TRIANGLES:t.triangles+=s*(a/3);break;case i.LINES:t.lines+=s*(a/2);break;case i.LINE_STRIP:t.lines+=s*(a-1);break;case i.LINE_LOOP:t.lines+=s*a;break;case i.POINTS:t.points+=s*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}l(n,"update");function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return l(r,"reset"),{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:n}}l(uF,"WebGLInfo");function hF(i,e,t){let n=new WeakMap,r=new jn;function a(o,s,u){let h=o.morphTargetInfluences,d=s.morphAttributes.position||s.morphAttributes.normal||s.morphAttributes.color,f=d!==void 0?d.length:0,m=n.get(s);if(m===void 0||m.count!==f){let v=function(){N.dispose(),n.delete(s),s.removeEventListener("dispose",v)};l(v,"disposeTexture"),m!==void 0&&m.texture.dispose();let b=s.morphAttributes.position!==void 0,w=s.morphAttributes.normal!==void 0,A=s.morphAttributes.color!==void 0,E=s.morphAttributes.position||[],I=s.morphAttributes.normal||[],C=s.morphAttributes.color||[],T=0;b===!0&&(T=1),w===!0&&(T=2),A===!0&&(T=3);let k=s.attributes.position.count*T,F=1;k>e.maxTextureSize&&(F=Math.ceil(k/e.maxTextureSize),k=e.maxTextureSize);let B=new Float32Array(k*F*4*f),N=new O7(B,k,F,f);N.type=hs,N.needsUpdate=!0;let z=T*4;for(let L=0;L<f;L++){let j=E[L],q=I[L],Z=C[L],O=k*F*4*L;for(let Y=0;Y<j.count;Y++){let J=Y*z;b===!0&&(r.fromBufferAttribute(j,Y),B[O+J+0]=r.x,B[O+J+1]=r.y,B[O+J+2]=r.z,B[O+J+3]=0),w===!0&&(r.fromBufferAttribute(q,Y),B[O+J+4]=r.x,B[O+J+5]=r.y,B[O+J+6]=r.z,B[O+J+7]=0),A===!0&&(r.fromBufferAttribute(Z,Y),B[O+J+8]=r.x,B[O+J+9]=r.y,B[O+J+10]=r.z,B[O+J+11]=Z.itemSize===4?r.w:1)}}m={count:f,texture:N,size:new ft(k,F)},n.set(s,m),s.addEventListener("dispose",v)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)u.getUniforms().setValue(i,"morphTexture",o.morphTexture,t);else{let v=0;for(let w=0;w<h.length;w++)v+=h[w];let b=s.morphTargetsRelative?1:1-v;u.getUniforms().setValue(i,"morphTargetBaseInfluence",b),u.getUniforms().setValue(i,"morphTargetInfluences",h)}u.getUniforms().setValue(i,"morphTargetsTexture",m.texture,t),u.getUniforms().setValue(i,"morphTargetsTextureSize",m.size)}return l(a,"update"),{update:a}}l(hF,"WebGLMorphtargets");function cF(i,e,t,n){let r=new WeakMap;function a(u){let h=n.render.frame,d=u.geometry,f=e.get(u,d);if(r.get(f)!==h&&(e.update(f),r.set(f,h)),u.isInstancedMesh&&(u.hasEventListener("dispose",s)===!1&&u.addEventListener("dispose",s),r.get(u)!==h&&(t.update(u.instanceMatrix,i.ARRAY_BUFFER),u.instanceColor!==null&&t.update(u.instanceColor,i.ARRAY_BUFFER),r.set(u,h))),u.isSkinnedMesh){let m=u.skeleton;r.get(m)!==h&&(m.update(),r.set(m,h))}return f}l(a,"update");function o(){r=new WeakMap}l(o,"dispose");function s(u){let h=u.target;h.removeEventListener("dispose",s),t.remove(h.instanceMatrix),h.instanceColor!==null&&t.remove(h.instanceColor)}return l(s,"onInstancedMeshDispose"),{update:a,dispose:o}}l(cF,"WebGLObjects");var pF=new Zo,Sk=new XO(1,1),dF=new O7,fF=new Xhe,mF=new yO,Mk=[],Ck=[],Ek=new Float32Array(16),Ik=new Float32Array(9),Tk=new Float32Array(4);function Ed(i,e,t){let n=i[0];if(n<=0||n>0)return i;let r=e*t,a=Mk[r];if(a===void 0&&(a=new Float32Array(r),Mk[r]=a),e!==0){n.toArray(a,0);for(let o=1,s=0;o!==e;++o)s+=t,i[o].toArray(a,s)}return a}l(Ed,"flatten");function ma(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}l(ma,"arraysEqual");function ga(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}l(ga,"copyArray");function Y1(i,e){let t=Ck[e];t===void 0&&(t=new Int32Array(e),Ck[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}l(Y1,"allocTexUnits");function gF(i,e){let t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}l(gF,"setValueV1f");function yF(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ma(t,e))return;i.uniform2fv(this.addr,e),ga(t,e)}}l(yF,"setValueV2f");function vF(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(ma(t,e))return;i.uniform3fv(this.addr,e),ga(t,e)}}l(vF,"setValueV3f");function _F(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ma(t,e))return;i.uniform4fv(this.addr,e),ga(t,e)}}l(_F,"setValueV4f");function xF(i,e){let t=this.cache,n=e.elements;if(n===void 0){if(ma(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),ga(t,e)}else{if(ma(t,n))return;Tk.set(n),i.uniformMatrix2fv(this.addr,!1,Tk),ga(t,n)}}l(xF,"setValueM2");function bF(i,e){let t=this.cache,n=e.elements;if(n===void 0){if(ma(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),ga(t,e)}else{if(ma(t,n))return;Ik.set(n),i.uniformMatrix3fv(this.addr,!1,Ik),ga(t,n)}}l(bF,"setValueM3");function wF(i,e){let t=this.cache,n=e.elements;if(n===void 0){if(ma(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),ga(t,e)}else{if(ma(t,n))return;Ek.set(n),i.uniformMatrix4fv(this.addr,!1,Ek),ga(t,n)}}l(wF,"setValueM4");function AF(i,e){let t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}l(AF,"setValueV1i");function SF(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ma(t,e))return;i.uniform2iv(this.addr,e),ga(t,e)}}l(SF,"setValueV2i");function MF(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ma(t,e))return;i.uniform3iv(this.addr,e),ga(t,e)}}l(MF,"setValueV3i");function CF(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ma(t,e))return;i.uniform4iv(this.addr,e),ga(t,e)}}l(CF,"setValueV4i");function EF(i,e){let t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}l(EF,"setValueV1ui");function IF(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ma(t,e))return;i.uniform2uiv(this.addr,e),ga(t,e)}}l(IF,"setValueV2ui");function TF(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ma(t,e))return;i.uniform3uiv(this.addr,e),ga(t,e)}}l(TF,"setValueV3ui");function PF(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ma(t,e))return;i.uniform4uiv(this.addr,e),ga(t,e)}}l(PF,"setValueV4ui");function LF(i,e,t){let n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r);let a;this.type===i.SAMPLER_2D_SHADOW?(Sk.compareFunction=Q8,a=Sk):a=pF,t.setTexture2D(e||a,r)}l(LF,"setValueT1");function DF(i,e,t){let n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||fF,r)}l(DF,"setValueT3D1");function kF(i,e,t){let n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||mF,r)}l(kF,"setValueT6");function RF(i,e,t){let n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||dF,r)}l(RF,"setValueT2DArray1");function OF(i){switch(i){case 5126:return gF;case 35664:return yF;case 35665:return vF;case 35666:return _F;case 35674:return xF;case 35675:return bF;case 35676:return wF;case 5124:case 35670:return AF;case 35667:case 35671:return SF;case 35668:case 35672:return MF;case 35669:case 35673:return CF;case 5125:return EF;case 36294:return IF;case 36295:return TF;case 36296:return PF;case 35678:case 36198:case 36298:case 36306:case 35682:return LF;case 35679:case 36299:case 36307:return DF;case 35680:case 36300:case 36308:case 36293:return kF;case 36289:case 36303:case 36311:case 36292:return RF}}l(OF,"getSingularSetter");function NF(i,e){i.uniform1fv(this.addr,e)}l(NF,"setValueV1fArray");function FF(i,e){let t=Ed(e,this.size,2);i.uniform2fv(this.addr,t)}l(FF,"setValueV2fArray");function BF(i,e){let t=Ed(e,this.size,3);i.uniform3fv(this.addr,t)}l(BF,"setValueV3fArray");function zF(i,e){let t=Ed(e,this.size,4);i.uniform4fv(this.addr,t)}l(zF,"setValueV4fArray");function UF(i,e){let t=Ed(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}l(UF,"setValueM2Array");function VF(i,e){let t=Ed(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}l(VF,"setValueM3Array");function jF(i,e){let t=Ed(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}l(jF,"setValueM4Array");function GF(i,e){i.uniform1iv(this.addr,e)}l(GF,"setValueV1iArray");function $F(i,e){i.uniform2iv(this.addr,e)}l($F,"setValueV2iArray");function HF(i,e){i.uniform3iv(this.addr,e)}l(HF,"setValueV3iArray");function WF(i,e){i.uniform4iv(this.addr,e)}l(WF,"setValueV4iArray");function qF(i,e){i.uniform1uiv(this.addr,e)}l(qF,"setValueV1uiArray");function XF(i,e){i.uniform2uiv(this.addr,e)}l(XF,"setValueV2uiArray");function ZF(i,e){i.uniform3uiv(this.addr,e)}l(ZF,"setValueV3uiArray");function YF(i,e){i.uniform4uiv(this.addr,e)}l(YF,"setValueV4uiArray");function JF(i,e,t){let n=this.cache,r=e.length,a=Y1(t,r);ma(n,a)||(i.uniform1iv(this.addr,a),ga(n,a));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||pF,a[o])}l(JF,"setValueT1Array");function KF(i,e,t){let n=this.cache,r=e.length,a=Y1(t,r);ma(n,a)||(i.uniform1iv(this.addr,a),ga(n,a));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||fF,a[o])}l(KF,"setValueT3DArray");function QF(i,e,t){let n=this.cache,r=e.length,a=Y1(t,r);ma(n,a)||(i.uniform1iv(this.addr,a),ga(n,a));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||mF,a[o])}l(QF,"setValueT6Array");function eB(i,e,t){let n=this.cache,r=e.length,a=Y1(t,r);ma(n,a)||(i.uniform1iv(this.addr,a),ga(n,a));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||dF,a[o])}l(eB,"setValueT2DArrayArray");function tB(i){switch(i){case 5126:return NF;case 35664:return FF;case 35665:return BF;case 35666:return zF;case 35674:return UF;case 35675:return VF;case 35676:return jF;case 5124:case 35670:return GF;case 35667:case 35671:return $F;case 35668:case 35672:return HF;case 35669:case 35673:return WF;case 5125:return qF;case 36294:return XF;case 36295:return ZF;case 36296:return YF;case 35678:case 36198:case 36298:case 36306:case 35682:return JF;case 35679:case 36299:case 36307:return KF;case 35680:case 36300:case 36308:case 36293:return QF;case 36289:case 36303:case 36311:case 36292:return eB}}l(tB,"getPureArraySetter");var iB=class{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=OF(t.type)}};l(iB,"SingleUniform");var Nfe=iB,nB=class{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=tB(t.type)}};l(nB,"PureArrayUniform");var Ffe=nB,rB=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){let r=this.seq;for(let a=0,o=r.length;a!==o;++a){let s=r[a];s.setValue(e,t[s.id],n)}}};l(rB,"StructuredUniform");var Bfe=rB,WS=/(\w+)(\])?(\[|\.)?/g;function NC(i,e){i.seq.push(e),i.map[e.id]=e}l(NC,"addUniform");function aB(i,e,t){let n=i.name,r=n.length;for(WS.lastIndex=0;;){let a=WS.exec(n),o=WS.lastIndex,s=a[1],u=a[2]==="]",h=a[3];if(u&&(s=s|0),h===void 0||h==="["&&o+2===r){NC(t,h===void 0?new Nfe(s,i,e):new Ffe(s,i,e));break}else{let d=t.map[s];d===void 0&&(d=new Bfe(s),NC(t,d)),t=d}}}l(aB,"parseUniform");var oB=class{constructor(e,t){this.seq=[],this.map={};let n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){let a=e.getActiveUniform(t,r),o=e.getUniformLocation(t,a.name);aB(a,o,this)}}setValue(e,t,n,r){let a=this.map[t];a!==void 0&&a.setValue(e,n,r)}setOptional(e,t,n){let r=t[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let a=0,o=t.length;a!==o;++a){let s=t[a],u=n[s.id];u.needsUpdate!==!1&&s.setValue(e,u.value,r)}}static seqWithValue(e,t){let n=[];for(let r=0,a=e.length;r!==a;++r){let o=e[r];o.id in t&&n.push(o)}return n}};l(oB,"WebGLUniforms");var Y_=oB;function FC(i,e,t){let n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}l(FC,"WebGLShader");var zfe=37297,Ufe=0;function sB(i,e){let t=i.split(`
`),n=[],r=Math.max(e-6,0),a=Math.min(e+6,t.length);for(let o=r;o<a;o++){let s=o+1;n.push("".concat(s===e?">":" "," ").concat(s,": ").concat(t[o]))}return n.join(`
`)}l(sB,"handleSource");var Pk=new fn;function lB(i){kn._getMatrix(Pk,kn.workingColorSpace,i);let e="mat3( ".concat(Pk.elements.map(t=>t.toFixed(4))," )");switch(kn.getTransfer(i)){case B2:return[e,"LinearTransferOETF"];case Jn:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",i),[e,"LinearTransferOETF"]}}l(lB,"getEncodingComponents");function BC(i,e,t){let n=i.getShaderParameter(e,i.COMPILE_STATUS),r=i.getShaderInfoLog(e).trim();if(n&&r==="")return"";let a=/ERROR: 0:(\d+)/.exec(r);if(a){let o=parseInt(a[1]);return t.toUpperCase()+`

`+r+`

`+sB(i.getShaderSource(e),o)}else return r}l(BC,"getShaderErrors");function uB(i,e){let t=lB(e);return["vec4 ".concat(i,"( vec4 value ) {"),"	return ".concat(t[1],"( vec4( value.rgb * ").concat(t[0],", value.a ) );"),"}"].join(`
`)}l(uB,"getTexelEncodingFunction");function hB(i,e){let t;switch(e){case bhe:t="Linear";break;case whe:t="Reinhard";break;case Ahe:t="Cineon";break;case She:t="ACESFilmic";break;case Che:t="AgX";break;case Ehe:t="Neutral";break;case Mhe:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}l(hB,"getToneMappingFunction");var s_=new Ee;function cB(){kn.getLuminanceCoefficients(s_);let i=s_.x.toFixed(4),e=s_.y.toFixed(4),t=s_.z.toFixed(4);return["float luminance( const in vec3 rgb ) {","	const vec3 weights = vec3( ".concat(i,", ").concat(e,", ").concat(t," );"),"	return dot( weights, rgb );","}"].join(`
`)}l(cB,"getLuminanceFunction");function pB(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(xm).join(`
`)}l(pB,"generateVertexExtensions");function dB(i){let e=[];for(let t in i){let n=i[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}l(dB,"generateDefines");function fB(i,e){let t={},n=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){let a=i.getActiveAttrib(e,r),o=a.name,s=1;a.type===i.FLOAT_MAT2&&(s=2),a.type===i.FLOAT_MAT3&&(s=3),a.type===i.FLOAT_MAT4&&(s=4),t[o]={type:a.type,location:i.getAttribLocation(e,o),locationSize:s}}return t}l(fB,"fetchAttributeLocations");function xm(i){return i!==""}l(xm,"filterEmptyLine");function zC(i,e){let t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}l(zC,"replaceLightNums");function UC(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}l(UC,"replaceClippingPlaneNums");var Vfe=/^[ \t]*#include +<([\w\d./]+)>/gm;function Z2(i){return i.replace(Vfe,mB)}l(Z2,"resolveIncludes");var jfe=new Map;function mB(i,e){let t=an[e];if(t===void 0){let n=jfe.get(e);if(n!==void 0)t=an[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return Z2(t)}l(mB,"includeReplacer");var Gfe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function VC(i){return i.replace(Gfe,gB)}l(VC,"unrollLoops");function gB(i,e,t,n){let r="";for(let a=parseInt(e);a<parseInt(t);a++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return r}l(gB,"loopReplacer");function jC(i){let e="precision ".concat(i.precision,` float;
	precision `).concat(i.precision,` int;
	precision `).concat(i.precision,` sampler2D;
	precision `).concat(i.precision,` samplerCube;
	precision `).concat(i.precision,` sampler3D;
	precision `).concat(i.precision,` sampler2DArray;
	precision `).concat(i.precision,` sampler2DShadow;
	precision `).concat(i.precision,` samplerCubeShadow;
	precision `).concat(i.precision,` sampler2DArrayShadow;
	precision `).concat(i.precision,` isampler2D;
	precision `).concat(i.precision,` isampler3D;
	precision `).concat(i.precision,` isamplerCube;
	precision `).concat(i.precision,` isampler2DArray;
	precision `).concat(i.precision,` usampler2D;
	precision `).concat(i.precision,` usampler3D;
	precision `).concat(i.precision,` usamplerCube;
	precision `).concat(i.precision,` usampler2DArray;
	`);return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}l(jC,"generatePrecision");function yB(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===j8?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===ehe?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===Fu&&(e="SHADOWMAP_TYPE_VSM"),e}l(yB,"generateShadowMapTypeDefine");function vB(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case tg:case ig:e="ENVMAP_TYPE_CUBE";break;case Uw:e="ENVMAP_TYPE_CUBE_UV";break}return e}l(vB,"generateEnvMapTypeDefine");function _B(i){let e="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case ig:e="ENVMAP_MODE_REFRACTION";break}return e}l(_B,"generateEnvMapModeDefine");function xB(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case EP:e="ENVMAP_BLENDING_MULTIPLY";break;case _he:e="ENVMAP_BLENDING_MIX";break;case xhe:e="ENVMAP_BLENDING_ADD";break}return e}l(xB,"generateEnvMapBlendingDefine");function bB(i){let e=i.envMapCubeUVHeight;if(e===null)return null;let t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}l(bB,"generateCubeUVSize");function wB(i,e,t,n){let r=i.getContext(),a=t.defines,o=t.vertexShader,s=t.fragmentShader,u=yB(t),h=vB(t),d=_B(t),f=xB(t),m=bB(t),v=pB(t),b=dB(a),w=r.createProgram(),A,E,I=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(A=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b].filter(xm).join(`
`),A.length>0&&(A+=`
`),E=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b].filter(xm).join(`
`),E.length>0&&(E+=`
`)):(A=[jC(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(xm).join(`
`),E=[jC(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.envMap?"#define "+d:"",t.envMap?"#define "+f:"",m?"#define CUBEUV_TEXEL_WIDTH "+m.texelWidth:"",m?"#define CUBEUV_TEXEL_HEIGHT "+m.texelHeight:"",m?"#define CUBEUV_MAX_MIP "+m.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Tc?"#define TONE_MAPPING":"",t.toneMapping!==Tc?an.tonemapping_pars_fragment:"",t.toneMapping!==Tc?hB("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",an.colorspace_pars_fragment,uB("linearToOutputTexel",t.outputColorSpace),cB(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(xm).join(`
`)),o=Z2(o),o=zC(o,t),o=UC(o,t),s=Z2(s),s=zC(s,t),s=UC(s,t),o=VC(o),s=VC(s),t.isRawShaderMaterial!==!0&&(I=`#version 300 es
`,A=[v,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+A,E=["#define varying in",t.glslVersion===xC?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===xC?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+E);let C=I+A+o,T=I+E+s,k=FC(r,r.VERTEX_SHADER,C),F=FC(r,r.FRAGMENT_SHADER,T);r.attachShader(w,k),r.attachShader(w,F),t.index0AttributeName!==void 0?r.bindAttribLocation(w,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(w,0,"position"),r.linkProgram(w);function B(j){if(i.debug.checkShaderErrors){let q=r.getProgramInfoLog(w).trim(),Z=r.getShaderInfoLog(k).trim(),O=r.getShaderInfoLog(F).trim(),Y=!0,J=!0;if(r.getProgramParameter(w,r.LINK_STATUS)===!1)if(Y=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(r,w,k,F);else{let oe=BC(r,k,"vertex"),$=BC(r,F,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(w,r.VALIDATE_STATUS)+`

Material Name: `+j.name+`
Material Type: `+j.type+`

Program Info Log: `+q+`
`+oe+`
`+$)}else q!==""?console.warn("THREE.WebGLProgram: Program Info Log:",q):(Z===""||O==="")&&(J=!1);J&&(j.diagnostics={runnable:Y,programLog:q,vertexShader:{log:Z,prefix:A},fragmentShader:{log:O,prefix:E}})}r.deleteShader(k),r.deleteShader(F),N=new Y_(r,w),z=fB(r,w)}l(B,"onFirstUse");let N;this.getUniforms=function(){return N===void 0&&B(this),N};let z;this.getAttributes=function(){return z===void 0&&B(this),z};let L=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return L===!1&&(L=r.getProgramParameter(w,zfe)),L},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(w),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=Ufe++,this.cacheKey=e,this.usedTimes=1,this.program=w,this.vertexShader=k,this.fragmentShader=F,this}l(wB,"WebGLProgram");var $fe=0,AB=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),a=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(a)===!1&&(o.add(a),a.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){let t=this.shaderCache,n=t.get(e);return n===void 0&&(n=new Wfe(e),t.set(e,n)),n}};l(AB,"WebGLShaderCache");var Hfe=AB,SB=class{constructor(e){this.id=$fe++,this.code=e,this.usedTimes=0}};l(SB,"WebGLShaderStage");var Wfe=SB;function MB(i,e,t,n,r,a,o){let s=new NP,u=new Hfe,h=new Set,d=[],f=r.logarithmicDepthBuffer,m=r.vertexTextures,v=r.precision,b={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function w(z){return h.add(z),z===0?"uv":"uv".concat(z)}l(w,"getChannel");function A(z,L,j,q,Z){let O=q.fog,Y=Z.geometry,J=z.isMeshStandardMaterial?q.environment:null,oe=(z.isMeshStandardMaterial?t:e).get(z.envMap||J),$=oe&&oe.mapping===Uw?oe.image.height:null,K=b[z.type];z.precision!==null&&(v=r.getMaxPrecision(z.precision),v!==z.precision&&console.warn("THREE.WebGLProgram.getParameters:",z.precision,"not supported, using",v,"instead."));let te=Y.morphAttributes.position||Y.morphAttributes.normal||Y.morphAttributes.color,ve=te!==void 0?te.length:0,Q=0;Y.morphAttributes.position!==void 0&&(Q=1),Y.morphAttributes.normal!==void 0&&(Q=2),Y.morphAttributes.color!==void 0&&(Q=3);let he,se,Ae,Ie;if(K){let Be=Gl[K];he=Be.vertexShader,se=Be.fragmentShader}else he=z.vertexShader,se=z.fragmentShader,u.update(z),Ae=u.getVertexShaderID(z),Ie=u.getFragmentShaderID(z);let we=i.getRenderTarget(),Ne=i.state.buffers.depth.getReversed(),je=Z.isInstancedMesh===!0,Ve=Z.isBatchedMesh===!0,Le=!!z.map,xe=!!z.matcap,Ue=!!oe,de=!!z.aoMap,ut=!!z.lightMap,ot=!!z.bumpMap,He=!!z.normalMap,Ke=!!z.displacementMap,Lt=!!z.emissiveMap,_t=!!z.metalnessMap,pe=!!z.roughnessMap,re=z.anisotropy>0,ke=z.clearcoat>0,at=z.dispersion>0,ct=z.iridescence>0,rt=z.sheen>0,Qe=z.transmission>0,At=re&&!!z.anisotropyMap,Dt=ke&&!!z.clearcoatMap,vt=ke&&!!z.clearcoatNormalMap,yt=ke&&!!z.clearcoatRoughnessMap,jt=ct&&!!z.iridescenceMap,Wt=ct&&!!z.iridescenceThicknessMap,Kt=rt&&!!z.sheenColorMap,Vt=rt&&!!z.sheenRoughnessMap,hi=!!z.specularMap,ui=!!z.specularColorMap,Zi=!!z.specularIntensityMap,Re=Qe&&!!z.transmissionMap,xt=Qe&&!!z.thicknessMap,me=!!z.gradientMap,W=!!z.alphaMap,X=z.alphaTest>0,ae=!!z.alphaHash,_e=!!z.extensions,fe=Tc;z.toneMapped&&(we===null||we.isXRRenderTarget===!0)&&(fe=i.toneMapping);let We={shaderID:K,shaderType:z.type,shaderName:z.name,vertexShader:he,fragmentShader:se,defines:z.defines,customVertexShaderID:Ae,customFragmentShaderID:Ie,isRawShaderMaterial:z.isRawShaderMaterial===!0,glslVersion:z.glslVersion,precision:v,batching:Ve,batchingColor:Ve&&Z._colorsTexture!==null,instancing:je,instancingColor:je&&Z.instanceColor!==null,instancingMorph:je&&Z.morphTexture!==null,supportsVertexTextures:m,outputColorSpace:we===null?i.outputColorSpace:we.isXRRenderTarget===!0?we.texture.colorSpace:pd,alphaToCoverage:!!z.alphaToCoverage,map:Le,matcap:xe,envMap:Ue,envMapMode:Ue&&oe.mapping,envMapCubeUVHeight:$,aoMap:de,lightMap:ut,bumpMap:ot,normalMap:He,displacementMap:m&&Ke,emissiveMap:Lt,normalMapObjectSpace:He&&z.normalMapType===Ohe,normalMapTangentSpace:He&&z.normalMapType===RP,metalnessMap:_t,roughnessMap:pe,anisotropy:re,anisotropyMap:At,clearcoat:ke,clearcoatMap:Dt,clearcoatNormalMap:vt,clearcoatRoughnessMap:yt,dispersion:at,iridescence:ct,iridescenceMap:jt,iridescenceThicknessMap:Wt,sheen:rt,sheenColorMap:Kt,sheenRoughnessMap:Vt,specularMap:hi,specularColorMap:ui,specularIntensityMap:Zi,transmission:Qe,transmissionMap:Re,thicknessMap:xt,gradientMap:me,opaque:z.transparent===!1&&z.blending===Dm&&z.alphaToCoverage===!1,alphaMap:W,alphaTest:X,alphaHash:ae,combine:z.combine,mapUv:Le&&w(z.map.channel),aoMapUv:de&&w(z.aoMap.channel),lightMapUv:ut&&w(z.lightMap.channel),bumpMapUv:ot&&w(z.bumpMap.channel),normalMapUv:He&&w(z.normalMap.channel),displacementMapUv:Ke&&w(z.displacementMap.channel),emissiveMapUv:Lt&&w(z.emissiveMap.channel),metalnessMapUv:_t&&w(z.metalnessMap.channel),roughnessMapUv:pe&&w(z.roughnessMap.channel),anisotropyMapUv:At&&w(z.anisotropyMap.channel),clearcoatMapUv:Dt&&w(z.clearcoatMap.channel),clearcoatNormalMapUv:vt&&w(z.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:yt&&w(z.clearcoatRoughnessMap.channel),iridescenceMapUv:jt&&w(z.iridescenceMap.channel),iridescenceThicknessMapUv:Wt&&w(z.iridescenceThicknessMap.channel),sheenColorMapUv:Kt&&w(z.sheenColorMap.channel),sheenRoughnessMapUv:Vt&&w(z.sheenRoughnessMap.channel),specularMapUv:hi&&w(z.specularMap.channel),specularColorMapUv:ui&&w(z.specularColorMap.channel),specularIntensityMapUv:Zi&&w(z.specularIntensityMap.channel),transmissionMapUv:Re&&w(z.transmissionMap.channel),thicknessMapUv:xt&&w(z.thicknessMap.channel),alphaMapUv:W&&w(z.alphaMap.channel),vertexTangents:!!Y.attributes.tangent&&(He||re),vertexColors:z.vertexColors,vertexAlphas:z.vertexColors===!0&&!!Y.attributes.color&&Y.attributes.color.itemSize===4,pointsUvs:Z.isPoints===!0&&!!Y.attributes.uv&&(Le||W),fog:!!O,useFog:z.fog===!0,fogExp2:!!O&&O.isFogExp2,flatShading:z.flatShading===!0,sizeAttenuation:z.sizeAttenuation===!0,logarithmicDepthBuffer:f,reverseDepthBuffer:Ne,skinning:Z.isSkinnedMesh===!0,morphTargets:Y.morphAttributes.position!==void 0,morphNormals:Y.morphAttributes.normal!==void 0,morphColors:Y.morphAttributes.color!==void 0,morphTargetsCount:ve,morphTextureStride:Q,numDirLights:L.directional.length,numPointLights:L.point.length,numSpotLights:L.spot.length,numSpotLightMaps:L.spotLightMap.length,numRectAreaLights:L.rectArea.length,numHemiLights:L.hemi.length,numDirLightShadows:L.directionalShadowMap.length,numPointLightShadows:L.pointShadowMap.length,numSpotLightShadows:L.spotShadowMap.length,numSpotLightShadowsWithMaps:L.numSpotLightShadowsWithMaps,numLightProbes:L.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:z.dithering,shadowMapEnabled:i.shadowMap.enabled&&j.length>0,shadowMapType:i.shadowMap.type,toneMapping:fe,decodeVideoTexture:Le&&z.map.isVideoTexture===!0&&kn.getTransfer(z.map.colorSpace)===Jn,decodeVideoTextureEmissive:Lt&&z.emissiveMap.isVideoTexture===!0&&kn.getTransfer(z.emissiveMap.colorSpace)===Jn,premultipliedAlpha:z.premultipliedAlpha,doubleSided:z.side===Go,flipSided:z.side===Eo,useDepthPacking:z.depthPacking>=0,depthPacking:z.depthPacking||0,index0AttributeName:z.index0AttributeName,extensionClipCullDistance:_e&&z.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(_e&&z.extensions.multiDraw===!0||Ve)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:z.customProgramCacheKey()};return We.vertexUv1s=h.has(1),We.vertexUv2s=h.has(2),We.vertexUv3s=h.has(3),h.clear(),We}l(A,"getParameters");function E(z){let L=[];if(z.shaderID?L.push(z.shaderID):(L.push(z.customVertexShaderID),L.push(z.customFragmentShaderID)),z.defines!==void 0)for(let j in z.defines)L.push(j),L.push(z.defines[j]);return z.isRawShaderMaterial===!1&&(I(L,z),C(L,z),L.push(i.outputColorSpace)),L.push(z.customProgramCacheKey),L.join()}l(E,"getProgramCacheKey");function I(z,L){z.push(L.precision),z.push(L.outputColorSpace),z.push(L.envMapMode),z.push(L.envMapCubeUVHeight),z.push(L.mapUv),z.push(L.alphaMapUv),z.push(L.lightMapUv),z.push(L.aoMapUv),z.push(L.bumpMapUv),z.push(L.normalMapUv),z.push(L.displacementMapUv),z.push(L.emissiveMapUv),z.push(L.metalnessMapUv),z.push(L.roughnessMapUv),z.push(L.anisotropyMapUv),z.push(L.clearcoatMapUv),z.push(L.clearcoatNormalMapUv),z.push(L.clearcoatRoughnessMapUv),z.push(L.iridescenceMapUv),z.push(L.iridescenceThicknessMapUv),z.push(L.sheenColorMapUv),z.push(L.sheenRoughnessMapUv),z.push(L.specularMapUv),z.push(L.specularColorMapUv),z.push(L.specularIntensityMapUv),z.push(L.transmissionMapUv),z.push(L.thicknessMapUv),z.push(L.combine),z.push(L.fogExp2),z.push(L.sizeAttenuation),z.push(L.morphTargetsCount),z.push(L.morphAttributeCount),z.push(L.numDirLights),z.push(L.numPointLights),z.push(L.numSpotLights),z.push(L.numSpotLightMaps),z.push(L.numHemiLights),z.push(L.numRectAreaLights),z.push(L.numDirLightShadows),z.push(L.numPointLightShadows),z.push(L.numSpotLightShadows),z.push(L.numSpotLightShadowsWithMaps),z.push(L.numLightProbes),z.push(L.shadowMapType),z.push(L.toneMapping),z.push(L.numClippingPlanes),z.push(L.numClipIntersection),z.push(L.depthPacking)}l(I,"getProgramCacheKeyParameters");function C(z,L){s.disableAll(),L.supportsVertexTextures&&s.enable(0),L.instancing&&s.enable(1),L.instancingColor&&s.enable(2),L.instancingMorph&&s.enable(3),L.matcap&&s.enable(4),L.envMap&&s.enable(5),L.normalMapObjectSpace&&s.enable(6),L.normalMapTangentSpace&&s.enable(7),L.clearcoat&&s.enable(8),L.iridescence&&s.enable(9),L.alphaTest&&s.enable(10),L.vertexColors&&s.enable(11),L.vertexAlphas&&s.enable(12),L.vertexUv1s&&s.enable(13),L.vertexUv2s&&s.enable(14),L.vertexUv3s&&s.enable(15),L.vertexTangents&&s.enable(16),L.anisotropy&&s.enable(17),L.alphaHash&&s.enable(18),L.batching&&s.enable(19),L.dispersion&&s.enable(20),L.batchingColor&&s.enable(21),z.push(s.mask),s.disableAll(),L.fog&&s.enable(0),L.useFog&&s.enable(1),L.flatShading&&s.enable(2),L.logarithmicDepthBuffer&&s.enable(3),L.reverseDepthBuffer&&s.enable(4),L.skinning&&s.enable(5),L.morphTargets&&s.enable(6),L.morphNormals&&s.enable(7),L.morphColors&&s.enable(8),L.premultipliedAlpha&&s.enable(9),L.shadowMapEnabled&&s.enable(10),L.doubleSided&&s.enable(11),L.flipSided&&s.enable(12),L.useDepthPacking&&s.enable(13),L.dithering&&s.enable(14),L.transmission&&s.enable(15),L.sheen&&s.enable(16),L.opaque&&s.enable(17),L.pointsUvs&&s.enable(18),L.decodeVideoTexture&&s.enable(19),L.decodeVideoTextureEmissive&&s.enable(20),L.alphaToCoverage&&s.enable(21),z.push(s.mask)}l(C,"getProgramCacheKeyBooleans");function T(z){let L=b[z.type],j;if(L){let q=Gl[L];j=ace.clone(q.uniforms)}else j=z.uniforms;return j}l(T,"getUniforms");function k(z,L){let j;for(let q=0,Z=d.length;q<Z;q++){let O=d[q];if(O.cacheKey===L){j=O,++j.usedTimes;break}}return j===void 0&&(j=new wB(i,L,z,a),d.push(j)),j}l(k,"acquireProgram");function F(z){if(--z.usedTimes===0){let L=d.indexOf(z);d[L]=d[d.length-1],d.pop(),z.destroy()}}l(F,"releaseProgram");function B(z){u.remove(z)}l(B,"releaseShaderCache");function N(){u.dispose()}return l(N,"dispose"),{getParameters:A,getProgramCacheKey:E,getUniforms:T,acquireProgram:k,releaseProgram:F,releaseShaderCache:B,programs:d,dispose:N}}l(MB,"WebGLPrograms");function CB(){let i=new WeakMap;function e(o){return i.has(o)}l(e,"has");function t(o){let s=i.get(o);return s===void 0&&(s={},i.set(o,s)),s}l(t,"get");function n(o){i.delete(o)}l(n,"remove");function r(o,s,u){i.get(o)[s]=u}l(r,"update");function a(){i=new WeakMap}return l(a,"dispose"),{has:e,get:t,remove:n,update:r,dispose:a}}l(CB,"WebGLProperties");function EB(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}l(EB,"painterSortStable");function GC(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}l(GC,"reversePainterSortStable");function $C(){let i=[],e=0,t=[],n=[],r=[];function a(){e=0,t.length=0,n.length=0,r.length=0}l(a,"init");function o(f,m,v,b,w,A){let E=i[e];return E===void 0?(E={id:f.id,object:f,geometry:m,material:v,groupOrder:b,renderOrder:f.renderOrder,z:w,group:A},i[e]=E):(E.id=f.id,E.object=f,E.geometry=m,E.material=v,E.groupOrder=b,E.renderOrder=f.renderOrder,E.z=w,E.group=A),e++,E}l(o,"getNextRenderItem");function s(f,m,v,b,w,A){let E=o(f,m,v,b,w,A);v.transmission>0?n.push(E):v.transparent===!0?r.push(E):t.push(E)}l(s,"push");function u(f,m,v,b,w,A){let E=o(f,m,v,b,w,A);v.transmission>0?n.unshift(E):v.transparent===!0?r.unshift(E):t.unshift(E)}l(u,"unshift");function h(f,m){t.length>1&&t.sort(f||EB),n.length>1&&n.sort(m||GC),r.length>1&&r.sort(m||GC)}l(h,"sort");function d(){for(let f=e,m=i.length;f<m;f++){let v=i[f];if(v.id===null)break;v.id=null,v.object=null,v.geometry=null,v.material=null,v.group=null}}return l(d,"finish"),{opaque:t,transmissive:n,transparent:r,init:a,push:s,unshift:u,finish:d,sort:h}}l($C,"WebGLRenderList");function IB(){let i=new WeakMap;function e(n,r){let a=i.get(n),o;return a===void 0?(o=new $C,i.set(n,[o])):r>=a.length?(o=new $C,a.push(o)):o=a[r],o}l(e,"get");function t(){i=new WeakMap}return l(t,"dispose"),{get:e,dispose:t}}l(IB,"WebGLRenderLists");function TB(){let i={};return{get:l(function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Ee,color:new Mi};break;case"SpotLight":t={position:new Ee,direction:new Ee,color:new Mi,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Ee,color:new Mi,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Ee,skyColor:new Mi,groundColor:new Mi};break;case"RectAreaLight":t={color:new Mi,position:new Ee,halfWidth:new Ee,halfHeight:new Ee};break}return i[e.id]=t,t},"get")}}l(TB,"UniformsCache");function PB(){let i={};return{get:l(function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ft};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ft};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ft,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t},"get")}}l(PB,"ShadowUniformsCache");var qfe=0;function LB(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}l(LB,"shadowCastingAndTexturingLightsFirst");function DB(i){let e=new TB,t=PB(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let h=0;h<9;h++)n.probe.push(new Ee);let r=new Ee,a=new qi,o=new qi;function s(h){let d=0,f=0,m=0;for(let z=0;z<9;z++)n.probe[z].set(0,0,0);let v=0,b=0,w=0,A=0,E=0,I=0,C=0,T=0,k=0,F=0,B=0;h.sort(LB);for(let z=0,L=h.length;z<L;z++){let j=h[z],q=j.color,Z=j.intensity,O=j.distance,Y=j.shadow&&j.shadow.map?j.shadow.map.texture:null;if(j.isAmbientLight)d+=q.r*Z,f+=q.g*Z,m+=q.b*Z;else if(j.isLightProbe){for(let J=0;J<9;J++)n.probe[J].addScaledVector(j.sh.coefficients[J],Z);B++}else if(j.isDirectionalLight){let J=e.get(j);if(J.color.copy(j.color).multiplyScalar(j.intensity),j.castShadow){let oe=j.shadow,$=t.get(j);$.shadowIntensity=oe.intensity,$.shadowBias=oe.bias,$.shadowNormalBias=oe.normalBias,$.shadowRadius=oe.radius,$.shadowMapSize=oe.mapSize,n.directionalShadow[v]=$,n.directionalShadowMap[v]=Y,n.directionalShadowMatrix[v]=j.shadow.matrix,I++}n.directional[v]=J,v++}else if(j.isSpotLight){let J=e.get(j);J.position.setFromMatrixPosition(j.matrixWorld),J.color.copy(q).multiplyScalar(Z),J.distance=O,J.coneCos=Math.cos(j.angle),J.penumbraCos=Math.cos(j.angle*(1-j.penumbra)),J.decay=j.decay,n.spot[w]=J;let oe=j.shadow;if(j.map&&(n.spotLightMap[k]=j.map,k++,oe.updateMatrices(j),j.castShadow&&F++),n.spotLightMatrix[w]=oe.matrix,j.castShadow){let $=t.get(j);$.shadowIntensity=oe.intensity,$.shadowBias=oe.bias,$.shadowNormalBias=oe.normalBias,$.shadowRadius=oe.radius,$.shadowMapSize=oe.mapSize,n.spotShadow[w]=$,n.spotShadowMap[w]=Y,T++}w++}else if(j.isRectAreaLight){let J=e.get(j);J.color.copy(q).multiplyScalar(Z),J.halfWidth.set(j.width*.5,0,0),J.halfHeight.set(0,j.height*.5,0),n.rectArea[A]=J,A++}else if(j.isPointLight){let J=e.get(j);if(J.color.copy(j.color).multiplyScalar(j.intensity),J.distance=j.distance,J.decay=j.decay,j.castShadow){let oe=j.shadow,$=t.get(j);$.shadowIntensity=oe.intensity,$.shadowBias=oe.bias,$.shadowNormalBias=oe.normalBias,$.shadowRadius=oe.radius,$.shadowMapSize=oe.mapSize,$.shadowCameraNear=oe.camera.near,$.shadowCameraFar=oe.camera.far,n.pointShadow[b]=$,n.pointShadowMap[b]=Y,n.pointShadowMatrix[b]=j.shadow.matrix,C++}n.point[b]=J,b++}else if(j.isHemisphereLight){let J=e.get(j);J.skyColor.copy(j.color).multiplyScalar(Z),J.groundColor.copy(j.groundColor).multiplyScalar(Z),n.hemi[E]=J,E++}}A>0&&(i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Xt.LTC_FLOAT_1,n.rectAreaLTC2=Xt.LTC_FLOAT_2):(n.rectAreaLTC1=Xt.LTC_HALF_1,n.rectAreaLTC2=Xt.LTC_HALF_2)),n.ambient[0]=d,n.ambient[1]=f,n.ambient[2]=m;let N=n.hash;(N.directionalLength!==v||N.pointLength!==b||N.spotLength!==w||N.rectAreaLength!==A||N.hemiLength!==E||N.numDirectionalShadows!==I||N.numPointShadows!==C||N.numSpotShadows!==T||N.numSpotMaps!==k||N.numLightProbes!==B)&&(n.directional.length=v,n.spot.length=w,n.rectArea.length=A,n.point.length=b,n.hemi.length=E,n.directionalShadow.length=I,n.directionalShadowMap.length=I,n.pointShadow.length=C,n.pointShadowMap.length=C,n.spotShadow.length=T,n.spotShadowMap.length=T,n.directionalShadowMatrix.length=I,n.pointShadowMatrix.length=C,n.spotLightMatrix.length=T+k-F,n.spotLightMap.length=k,n.numSpotLightShadowsWithMaps=F,n.numLightProbes=B,N.directionalLength=v,N.pointLength=b,N.spotLength=w,N.rectAreaLength=A,N.hemiLength=E,N.numDirectionalShadows=I,N.numPointShadows=C,N.numSpotShadows=T,N.numSpotMaps=k,N.numLightProbes=B,n.version=qfe++)}l(s,"setup");function u(h,d){let f=0,m=0,v=0,b=0,w=0,A=d.matrixWorldInverse;for(let E=0,I=h.length;E<I;E++){let C=h[E];if(C.isDirectionalLight){let T=n.directional[f];T.direction.setFromMatrixPosition(C.matrixWorld),r.setFromMatrixPosition(C.target.matrixWorld),T.direction.sub(r),T.direction.transformDirection(A),f++}else if(C.isSpotLight){let T=n.spot[v];T.position.setFromMatrixPosition(C.matrixWorld),T.position.applyMatrix4(A),T.direction.setFromMatrixPosition(C.matrixWorld),r.setFromMatrixPosition(C.target.matrixWorld),T.direction.sub(r),T.direction.transformDirection(A),v++}else if(C.isRectAreaLight){let T=n.rectArea[b];T.position.setFromMatrixPosition(C.matrixWorld),T.position.applyMatrix4(A),o.identity(),a.copy(C.matrixWorld),a.premultiply(A),o.extractRotation(a),T.halfWidth.set(C.width*.5,0,0),T.halfHeight.set(0,C.height*.5,0),T.halfWidth.applyMatrix4(o),T.halfHeight.applyMatrix4(o),b++}else if(C.isPointLight){let T=n.point[m];T.position.setFromMatrixPosition(C.matrixWorld),T.position.applyMatrix4(A),m++}else if(C.isHemisphereLight){let T=n.hemi[w];T.direction.setFromMatrixPosition(C.matrixWorld),T.direction.transformDirection(A),w++}}}return l(u,"setupView"),{setup:s,setupView:u,state:n}}l(DB,"WebGLLights");function HC(i){let e=new DB(i),t=[],n=[];function r(d){h.camera=d,t.length=0,n.length=0}l(r,"init");function a(d){t.push(d)}l(a,"pushLight");function o(d){n.push(d)}l(o,"pushShadow");function s(){e.setup(t)}l(s,"setupLights");function u(d){e.setupView(t,d)}l(u,"setupLightsView");let h={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:h,setupLights:s,setupLightsView:u,pushLight:a,pushShadow:o}}l(HC,"WebGLRenderState");function kB(i){let e=new WeakMap;function t(r,a=0){let o=e.get(r),s;return o===void 0?(s=new HC(i),e.set(r,[s])):a>=o.length?(s=new HC(i),o.push(s)):s=o[a],s}l(t,"get");function n(){e=new WeakMap}return l(n,"dispose"),{get:t,dispose:n}}l(kB,"WebGLRenderStates");var Xfe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Zfe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function RB(i,e,t){let n=new H1,r=new ft,a=new ft,o=new jn,s=new Pce({depthPacking:Rhe}),u=new Lce,h={},d=t.maxTextureSize,f={[su]:Eo,[Eo]:su,[Go]:Go},m=new ys({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ft},radius:{value:4}},vertexShader:Xfe,fragmentShader:Zfe}),v=m.clone();v.defines.HORIZONTAL_PASS=1;let b=new Sa;b.setAttribute("position",new gr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let w=new ln(b,m),A=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=j8;let E=this.type;this.render=function(F,B,N){if(A.enabled===!1||A.autoUpdate===!1&&A.needsUpdate===!1||F.length===0)return;let z=i.getRenderTarget(),L=i.getActiveCubeFace(),j=i.getActiveMipmapLevel(),q=i.state;q.setBlending(Ic),q.buffers.color.setClear(1,1,1,1),q.buffers.depth.setTest(!0),q.setScissorTest(!1);let Z=E!==Fu&&this.type===Fu,O=E===Fu&&this.type!==Fu;for(let Y=0,J=F.length;Y<J;Y++){let oe=F[Y],$=oe.shadow;if($===void 0){console.warn("THREE.WebGLShadowMap:",oe,"has no shadow.");continue}if($.autoUpdate===!1&&$.needsUpdate===!1)continue;r.copy($.mapSize);let K=$.getFrameExtents();if(r.multiply(K),a.copy($.mapSize),(r.x>d||r.y>d)&&(r.x>d&&(a.x=Math.floor(d/K.x),r.x=a.x*K.x,$.mapSize.x=a.x),r.y>d&&(a.y=Math.floor(d/K.y),r.y=a.y*K.y,$.mapSize.y=a.y)),$.map===null||Z===!0||O===!0){let ve=this.type!==Fu?{minFilter:ms,magFilter:ms}:{};$.map!==null&&$.map.dispose(),$.map=new Oc(r.x,r.y,ve),$.map.texture.name=oe.name+".shadowMap",$.camera.updateProjectionMatrix()}i.setRenderTarget($.map),i.clear();let te=$.getViewportCount();for(let ve=0;ve<te;ve++){let Q=$.getViewport(ve);o.set(a.x*Q.x,a.y*Q.y,a.x*Q.z,a.y*Q.w),q.viewport(o),$.updateMatrices(oe,ve),n=$.getFrustum(),T(B,N,$.camera,oe,this.type)}$.isPointLightShadow!==!0&&this.type===Fu&&I($,N),$.needsUpdate=!1}E=this.type,A.needsUpdate=!1,i.setRenderTarget(z,L,j)};function I(F,B){let N=e.update(w);m.defines.VSM_SAMPLES!==F.blurSamples&&(m.defines.VSM_SAMPLES=F.blurSamples,v.defines.VSM_SAMPLES=F.blurSamples,m.needsUpdate=!0,v.needsUpdate=!0),F.mapPass===null&&(F.mapPass=new Oc(r.x,r.y)),m.uniforms.shadow_pass.value=F.map.texture,m.uniforms.resolution.value=F.mapSize,m.uniforms.radius.value=F.radius,i.setRenderTarget(F.mapPass),i.clear(),i.renderBufferDirect(B,null,N,m,w,null),v.uniforms.shadow_pass.value=F.mapPass.texture,v.uniforms.resolution.value=F.mapSize,v.uniforms.radius.value=F.radius,i.setRenderTarget(F.map),i.clear(),i.renderBufferDirect(B,null,N,v,w,null)}l(I,"VSMPass");function C(F,B,N,z){let L=null,j=N.isPointLight===!0?F.customDistanceMaterial:F.customDepthMaterial;if(j!==void 0)L=j;else if(L=N.isPointLight===!0?u:s,i.localClippingEnabled&&B.clipShadows===!0&&Array.isArray(B.clippingPlanes)&&B.clippingPlanes.length!==0||B.displacementMap&&B.displacementScale!==0||B.alphaMap&&B.alphaTest>0||B.map&&B.alphaTest>0){let q=L.uuid,Z=B.uuid,O=h[q];O===void 0&&(O={},h[q]=O);let Y=O[Z];Y===void 0&&(Y=L.clone(),O[Z]=Y,B.addEventListener("dispose",k)),L=Y}if(L.visible=B.visible,L.wireframe=B.wireframe,z===Fu?L.side=B.shadowSide!==null?B.shadowSide:B.side:L.side=B.shadowSide!==null?B.shadowSide:f[B.side],L.alphaMap=B.alphaMap,L.alphaTest=B.alphaTest,L.map=B.map,L.clipShadows=B.clipShadows,L.clippingPlanes=B.clippingPlanes,L.clipIntersection=B.clipIntersection,L.displacementMap=B.displacementMap,L.displacementScale=B.displacementScale,L.displacementBias=B.displacementBias,L.wireframeLinewidth=B.wireframeLinewidth,L.linewidth=B.linewidth,N.isPointLight===!0&&L.isMeshDistanceMaterial===!0){let q=i.properties.get(L);q.light=N}return L}l(C,"getDepthMaterial");function T(F,B,N,z,L){if(F.visible===!1)return;if(F.layers.test(B.layers)&&(F.isMesh||F.isLine||F.isPoints)&&(F.castShadow||F.receiveShadow&&L===Fu)&&(!F.frustumCulled||n.intersectsObject(F))){F.modelViewMatrix.multiplyMatrices(N.matrixWorldInverse,F.matrixWorld);let q=e.update(F),Z=F.material;if(Array.isArray(Z)){let O=q.groups;for(let Y=0,J=O.length;Y<J;Y++){let oe=O[Y],$=Z[oe.materialIndex];if($&&$.visible){let K=C(F,$,z,L);F.onBeforeShadow(i,F,B,N,q,K,oe),i.renderBufferDirect(N,null,q,K,F,oe),F.onAfterShadow(i,F,B,N,q,K,oe)}}}else if(Z.visible){let O=C(F,Z,z,L);F.onBeforeShadow(i,F,B,N,q,O,null),i.renderBufferDirect(N,null,q,O,F,null),F.onAfterShadow(i,F,B,N,q,O,null)}}let j=F.children;for(let q=0,Z=j.length;q<Z;q++)T(j[q],B,N,z,L)}l(T,"renderObject");function k(F){F.target.removeEventListener("dispose",k);for(let B in h){let N=h[B],z=F.target.uuid;z in N&&(N[z].dispose(),delete N[z])}}l(k,"onMaterialDispose")}l(RB,"WebGLShadowMap");var Yfe={[NM]:FM,[BM]:VM,[zM]:jM,[eg]:UM,[FM]:NM,[VM]:BM,[jM]:zM,[UM]:eg};function OB(i,e){function t(){let Re=!1,xt=new jn,me=null,W=new jn(0,0,0,0);return{setMask:l(function(X){me!==X&&!Re&&(i.colorMask(X,X,X,X),me=X)},"setMask"),setLocked:l(function(X){Re=X},"setLocked"),setClear:l(function(X,ae,_e,fe,We){We===!0&&(X*=fe,ae*=fe,_e*=fe),xt.set(X,ae,_e,fe),W.equals(xt)===!1&&(i.clearColor(X,ae,_e,fe),W.copy(xt))},"setClear"),reset:l(function(){Re=!1,me=null,W.set(-1,0,0,0)},"reset")}}l(t,"ColorBuffer");function n(){let Re=!1,xt=!1,me=null,W=null,X=null;return{setReversed:l(function(ae){if(xt!==ae){let _e=e.get("EXT_clip_control");xt?_e.clipControlEXT(_e.LOWER_LEFT_EXT,_e.ZERO_TO_ONE_EXT):_e.clipControlEXT(_e.LOWER_LEFT_EXT,_e.NEGATIVE_ONE_TO_ONE_EXT);let fe=X;X=null,this.setClear(fe)}xt=ae},"setReversed"),getReversed:l(function(){return xt},"getReversed"),setTest:l(function(ae){ae?we(i.DEPTH_TEST):Ne(i.DEPTH_TEST)},"setTest"),setMask:l(function(ae){me!==ae&&!Re&&(i.depthMask(ae),me=ae)},"setMask"),setFunc:l(function(ae){if(xt&&(ae=Yfe[ae]),W!==ae){switch(ae){case NM:i.depthFunc(i.NEVER);break;case FM:i.depthFunc(i.ALWAYS);break;case BM:i.depthFunc(i.LESS);break;case eg:i.depthFunc(i.LEQUAL);break;case zM:i.depthFunc(i.EQUAL);break;case UM:i.depthFunc(i.GEQUAL);break;case VM:i.depthFunc(i.GREATER);break;case jM:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}W=ae}},"setFunc"),setLocked:l(function(ae){Re=ae},"setLocked"),setClear:l(function(ae){X!==ae&&(xt&&(ae=1-ae),i.clearDepth(ae),X=ae)},"setClear"),reset:l(function(){Re=!1,me=null,W=null,X=null,xt=!1},"reset")}}l(n,"DepthBuffer");function r(){let Re=!1,xt=null,me=null,W=null,X=null,ae=null,_e=null,fe=null,We=null;return{setTest:l(function(Be){Re||(Be?we(i.STENCIL_TEST):Ne(i.STENCIL_TEST))},"setTest"),setMask:l(function(Be){xt!==Be&&!Re&&(i.stencilMask(Be),xt=Be)},"setMask"),setFunc:l(function(Be,st,Xe){(me!==Be||W!==st||X!==Xe)&&(i.stencilFunc(Be,st,Xe),me=Be,W=st,X=Xe)},"setFunc"),setOp:l(function(Be,st,Xe){(ae!==Be||_e!==st||fe!==Xe)&&(i.stencilOp(Be,st,Xe),ae=Be,_e=st,fe=Xe)},"setOp"),setLocked:l(function(Be){Re=Be},"setLocked"),setClear:l(function(Be){We!==Be&&(i.clearStencil(Be),We=Be)},"setClear"),reset:l(function(){Re=!1,xt=null,me=null,W=null,X=null,ae=null,_e=null,fe=null,We=null},"reset")}}l(r,"StencilBuffer");let a=new t,o=new n,s=new r,u=new WeakMap,h=new WeakMap,d={},f={},m=new WeakMap,v=[],b=null,w=!1,A=null,E=null,I=null,C=null,T=null,k=null,F=null,B=new Mi(0,0,0),N=0,z=!1,L=null,j=null,q=null,Z=null,O=null,Y=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS),J=!1,oe=0,$=i.getParameter(i.VERSION);$.indexOf("WebGL")!==-1?(oe=parseFloat(/^WebGL (\d)/.exec($)[1]),J=oe>=1):$.indexOf("OpenGL ES")!==-1&&(oe=parseFloat(/^OpenGL ES (\d)/.exec($)[1]),J=oe>=2);let K=null,te={},ve=i.getParameter(i.SCISSOR_BOX),Q=i.getParameter(i.VIEWPORT),he=new jn().fromArray(ve),se=new jn().fromArray(Q);function Ae(Re,xt,me,W){let X=new Uint8Array(4),ae=i.createTexture();i.bindTexture(Re,ae),i.texParameteri(Re,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(Re,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let _e=0;_e<me;_e++)Re===i.TEXTURE_3D||Re===i.TEXTURE_2D_ARRAY?i.texImage3D(xt,0,i.RGBA,1,1,W,0,i.RGBA,i.UNSIGNED_BYTE,X):i.texImage2D(xt+_e,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,X);return ae}l(Ae,"createTexture");let Ie={};Ie[i.TEXTURE_2D]=Ae(i.TEXTURE_2D,i.TEXTURE_2D,1),Ie[i.TEXTURE_CUBE_MAP]=Ae(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),Ie[i.TEXTURE_2D_ARRAY]=Ae(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),Ie[i.TEXTURE_3D]=Ae(i.TEXTURE_3D,i.TEXTURE_3D,1,1),a.setClear(0,0,0,1),o.setClear(1),s.setClear(0),we(i.DEPTH_TEST),o.setFunc(eg),ot(!1),He(E6),we(i.CULL_FACE),de(Ic);function we(Re){d[Re]!==!0&&(i.enable(Re),d[Re]=!0)}l(we,"enable");function Ne(Re){d[Re]!==!1&&(i.disable(Re),d[Re]=!1)}l(Ne,"disable");function je(Re,xt){return f[Re]!==xt?(i.bindFramebuffer(Re,xt),f[Re]=xt,Re===i.DRAW_FRAMEBUFFER&&(f[i.FRAMEBUFFER]=xt),Re===i.FRAMEBUFFER&&(f[i.DRAW_FRAMEBUFFER]=xt),!0):!1}l(je,"bindFramebuffer");function Ve(Re,xt){let me=v,W=!1;if(Re){me=m.get(xt),me===void 0&&(me=[],m.set(xt,me));let X=Re.textures;if(me.length!==X.length||me[0]!==i.COLOR_ATTACHMENT0){for(let ae=0,_e=X.length;ae<_e;ae++)me[ae]=i.COLOR_ATTACHMENT0+ae;me.length=X.length,W=!0}}else me[0]!==i.BACK&&(me[0]=i.BACK,W=!0);W&&i.drawBuffers(me)}l(Ve,"drawBuffers");function Le(Re){return b!==Re?(i.useProgram(Re),b=Re,!0):!1}l(Le,"useProgram");let xe={[Fp]:i.FUNC_ADD,[ihe]:i.FUNC_SUBTRACT,[nhe]:i.FUNC_REVERSE_SUBTRACT};xe[rhe]=i.MIN,xe[ahe]=i.MAX;let Ue={[ohe]:i.ZERO,[she]:i.ONE,[lhe]:i.SRC_COLOR,[RM]:i.SRC_ALPHA,[fhe]:i.SRC_ALPHA_SATURATE,[phe]:i.DST_COLOR,[hhe]:i.DST_ALPHA,[uhe]:i.ONE_MINUS_SRC_COLOR,[OM]:i.ONE_MINUS_SRC_ALPHA,[dhe]:i.ONE_MINUS_DST_COLOR,[che]:i.ONE_MINUS_DST_ALPHA,[mhe]:i.CONSTANT_COLOR,[ghe]:i.ONE_MINUS_CONSTANT_COLOR,[yhe]:i.CONSTANT_ALPHA,[vhe]:i.ONE_MINUS_CONSTANT_ALPHA};function de(Re,xt,me,W,X,ae,_e,fe,We,Be){if(Re===Ic){w===!0&&(Ne(i.BLEND),w=!1);return}if(w===!1&&(we(i.BLEND),w=!0),Re!==the){if(Re!==A||Be!==z){if((E!==Fp||T!==Fp)&&(i.blendEquation(i.FUNC_ADD),E=Fp,T=Fp),Be)switch(Re){case Dm:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case I6:i.blendFunc(i.ONE,i.ONE);break;case T6:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case P6:i.blendFuncSeparate(i.ZERO,i.SRC_COLOR,i.ZERO,i.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Re);break}else switch(Re){case Dm:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case I6:i.blendFunc(i.SRC_ALPHA,i.ONE);break;case T6:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case P6:i.blendFunc(i.ZERO,i.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Re);break}I=null,C=null,k=null,F=null,B.set(0,0,0),N=0,A=Re,z=Be}return}X=X||xt,ae=ae||me,_e=_e||W,(xt!==E||X!==T)&&(i.blendEquationSeparate(xe[xt],xe[X]),E=xt,T=X),(me!==I||W!==C||ae!==k||_e!==F)&&(i.blendFuncSeparate(Ue[me],Ue[W],Ue[ae],Ue[_e]),I=me,C=W,k=ae,F=_e),(fe.equals(B)===!1||We!==N)&&(i.blendColor(fe.r,fe.g,fe.b,We),B.copy(fe),N=We),A=Re,z=!1}l(de,"setBlending");function ut(Re,xt){Re.side===Go?Ne(i.CULL_FACE):we(i.CULL_FACE);let me=Re.side===Eo;xt&&(me=!me),ot(me),Re.blending===Dm&&Re.transparent===!1?de(Ic):de(Re.blending,Re.blendEquation,Re.blendSrc,Re.blendDst,Re.blendEquationAlpha,Re.blendSrcAlpha,Re.blendDstAlpha,Re.blendColor,Re.blendAlpha,Re.premultipliedAlpha),o.setFunc(Re.depthFunc),o.setTest(Re.depthTest),o.setMask(Re.depthWrite),a.setMask(Re.colorWrite);let W=Re.stencilWrite;s.setTest(W),W&&(s.setMask(Re.stencilWriteMask),s.setFunc(Re.stencilFunc,Re.stencilRef,Re.stencilFuncMask),s.setOp(Re.stencilFail,Re.stencilZFail,Re.stencilZPass)),Lt(Re.polygonOffset,Re.polygonOffsetFactor,Re.polygonOffsetUnits),Re.alphaToCoverage===!0?we(i.SAMPLE_ALPHA_TO_COVERAGE):Ne(i.SAMPLE_ALPHA_TO_COVERAGE)}l(ut,"setMaterial");function ot(Re){L!==Re&&(Re?i.frontFace(i.CW):i.frontFace(i.CCW),L=Re)}l(ot,"setFlipSided");function He(Re){Re!==Kue?(we(i.CULL_FACE),Re!==j&&(Re===E6?i.cullFace(i.BACK):Re===Que?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):Ne(i.CULL_FACE),j=Re}l(He,"setCullFace");function Ke(Re){Re!==q&&(J&&i.lineWidth(Re),q=Re)}l(Ke,"setLineWidth");function Lt(Re,xt,me){Re?(we(i.POLYGON_OFFSET_FILL),(Z!==xt||O!==me)&&(i.polygonOffset(xt,me),Z=xt,O=me)):Ne(i.POLYGON_OFFSET_FILL)}l(Lt,"setPolygonOffset");function _t(Re){Re?we(i.SCISSOR_TEST):Ne(i.SCISSOR_TEST)}l(_t,"setScissorTest");function pe(Re){Re===void 0&&(Re=i.TEXTURE0+Y-1),K!==Re&&(i.activeTexture(Re),K=Re)}l(pe,"activeTexture");function re(Re,xt,me){me===void 0&&(K===null?me=i.TEXTURE0+Y-1:me=K);let W=te[me];W===void 0&&(W={type:void 0,texture:void 0},te[me]=W),(W.type!==Re||W.texture!==xt)&&(K!==me&&(i.activeTexture(me),K=me),i.bindTexture(Re,xt||Ie[Re]),W.type=Re,W.texture=xt)}l(re,"bindTexture");function ke(){let Re=te[K];Re!==void 0&&Re.type!==void 0&&(i.bindTexture(Re.type,null),Re.type=void 0,Re.texture=void 0)}l(ke,"unbindTexture");function at(){try{i.compressedTexImage2D.apply(i,arguments)}catch(Re){console.error("THREE.WebGLState:",Re)}}l(at,"compressedTexImage2D");function ct(){try{i.compressedTexImage3D.apply(i,arguments)}catch(Re){console.error("THREE.WebGLState:",Re)}}l(ct,"compressedTexImage3D");function rt(){try{i.texSubImage2D.apply(i,arguments)}catch(Re){console.error("THREE.WebGLState:",Re)}}l(rt,"texSubImage2D");function Qe(){try{i.texSubImage3D.apply(i,arguments)}catch(Re){console.error("THREE.WebGLState:",Re)}}l(Qe,"texSubImage3D");function At(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(Re){console.error("THREE.WebGLState:",Re)}}l(At,"compressedTexSubImage2D");function Dt(){try{i.compressedTexSubImage3D.apply(i,arguments)}catch(Re){console.error("THREE.WebGLState:",Re)}}l(Dt,"compressedTexSubImage3D");function vt(){try{i.texStorage2D.apply(i,arguments)}catch(Re){console.error("THREE.WebGLState:",Re)}}l(vt,"texStorage2D");function yt(){try{i.texStorage3D.apply(i,arguments)}catch(Re){console.error("THREE.WebGLState:",Re)}}l(yt,"texStorage3D");function jt(){try{i.texImage2D.apply(i,arguments)}catch(Re){console.error("THREE.WebGLState:",Re)}}l(jt,"texImage2D");function Wt(){try{i.texImage3D.apply(i,arguments)}catch(Re){console.error("THREE.WebGLState:",Re)}}l(Wt,"texImage3D");function Kt(Re){he.equals(Re)===!1&&(i.scissor(Re.x,Re.y,Re.z,Re.w),he.copy(Re))}l(Kt,"scissor");function Vt(Re){se.equals(Re)===!1&&(i.viewport(Re.x,Re.y,Re.z,Re.w),se.copy(Re))}l(Vt,"viewport");function hi(Re,xt){let me=h.get(xt);me===void 0&&(me=new WeakMap,h.set(xt,me));let W=me.get(Re);W===void 0&&(W=i.getUniformBlockIndex(xt,Re.name),me.set(Re,W))}l(hi,"updateUBOMapping");function ui(Re,xt){let me=h.get(xt).get(Re);u.get(xt)!==me&&(i.uniformBlockBinding(xt,me,Re.__bindingPointIndex),u.set(xt,me))}l(ui,"uniformBlockBinding");function Zi(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),o.setReversed(!1),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),d={},K=null,te={},f={},m=new WeakMap,v=[],b=null,w=!1,A=null,E=null,I=null,C=null,T=null,k=null,F=null,B=new Mi(0,0,0),N=0,z=!1,L=null,j=null,q=null,Z=null,O=null,he.set(0,0,i.canvas.width,i.canvas.height),se.set(0,0,i.canvas.width,i.canvas.height),a.reset(),o.reset(),s.reset()}return l(Zi,"reset"),{buffers:{color:a,depth:o,stencil:s},enable:we,disable:Ne,bindFramebuffer:je,drawBuffers:Ve,useProgram:Le,setBlending:de,setMaterial:ut,setFlipSided:ot,setCullFace:He,setLineWidth:Ke,setPolygonOffset:Lt,setScissorTest:_t,activeTexture:pe,bindTexture:re,unbindTexture:ke,compressedTexImage2D:at,compressedTexImage3D:ct,texImage2D:jt,texImage3D:Wt,updateUBOMapping:hi,uniformBlockBinding:ui,texStorage2D:vt,texStorage3D:yt,texSubImage2D:rt,texSubImage3D:Qe,compressedTexSubImage2D:At,compressedTexSubImage3D:Dt,scissor:Kt,viewport:Vt,reset:Zi}}l(OB,"WebGLState");function NB(i,e,t,n,r,a,o){let s=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,u=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),h=new ft,d=new WeakMap,f,m=new WeakMap,v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function b(pe,re){return v?new OffscreenCanvas(pe,re):og("canvas")}l(b,"createCanvas");function w(pe,re,ke){let at=1,ct=_t(pe);if((ct.width>ke||ct.height>ke)&&(at=ke/Math.max(ct.width,ct.height)),at<1)if(typeof HTMLImageElement<"u"&&pe instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&pe instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&pe instanceof ImageBitmap||typeof VideoFrame<"u"&&pe instanceof VideoFrame){let rt=Math.floor(at*ct.width),Qe=Math.floor(at*ct.height);f===void 0&&(f=b(rt,Qe));let At=re?b(rt,Qe):f;return At.width=rt,At.height=Qe,At.getContext("2d").drawImage(pe,0,0,rt,Qe),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ct.width+"x"+ct.height+") to ("+rt+"x"+Qe+")."),At}else return"data"in pe&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ct.width+"x"+ct.height+")."),pe;return pe}l(w,"resizeImage");function A(pe){return pe.generateMipmaps}l(A,"textureNeedsGenerateMipmaps");function E(pe){i.generateMipmap(pe)}l(E,"generateMipmap");function I(pe){return pe.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:pe.isWebGL3DRenderTarget?i.TEXTURE_3D:pe.isWebGLArrayRenderTarget||pe.isCompressedArrayTexture?i.TEXTURE_2D_ARRAY:i.TEXTURE_2D}l(I,"getTargetType");function C(pe,re,ke,at,ct=!1){if(pe!==null){if(i[pe]!==void 0)return i[pe];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+pe+"'")}let rt=re;if(re===i.RED&&(ke===i.FLOAT&&(rt=i.R32F),ke===i.HALF_FLOAT&&(rt=i.R16F),ke===i.UNSIGNED_BYTE&&(rt=i.R8)),re===i.RED_INTEGER&&(ke===i.UNSIGNED_BYTE&&(rt=i.R8UI),ke===i.UNSIGNED_SHORT&&(rt=i.R16UI),ke===i.UNSIGNED_INT&&(rt=i.R32UI),ke===i.BYTE&&(rt=i.R8I),ke===i.SHORT&&(rt=i.R16I),ke===i.INT&&(rt=i.R32I)),re===i.RG&&(ke===i.FLOAT&&(rt=i.RG32F),ke===i.HALF_FLOAT&&(rt=i.RG16F),ke===i.UNSIGNED_BYTE&&(rt=i.RG8)),re===i.RG_INTEGER&&(ke===i.UNSIGNED_BYTE&&(rt=i.RG8UI),ke===i.UNSIGNED_SHORT&&(rt=i.RG16UI),ke===i.UNSIGNED_INT&&(rt=i.RG32UI),ke===i.BYTE&&(rt=i.RG8I),ke===i.SHORT&&(rt=i.RG16I),ke===i.INT&&(rt=i.RG32I)),re===i.RGB_INTEGER&&(ke===i.UNSIGNED_BYTE&&(rt=i.RGB8UI),ke===i.UNSIGNED_SHORT&&(rt=i.RGB16UI),ke===i.UNSIGNED_INT&&(rt=i.RGB32UI),ke===i.BYTE&&(rt=i.RGB8I),ke===i.SHORT&&(rt=i.RGB16I),ke===i.INT&&(rt=i.RGB32I)),re===i.RGBA_INTEGER&&(ke===i.UNSIGNED_BYTE&&(rt=i.RGBA8UI),ke===i.UNSIGNED_SHORT&&(rt=i.RGBA16UI),ke===i.UNSIGNED_INT&&(rt=i.RGBA32UI),ke===i.BYTE&&(rt=i.RGBA8I),ke===i.SHORT&&(rt=i.RGBA16I),ke===i.INT&&(rt=i.RGBA32I)),re===i.RGB&&ke===i.UNSIGNED_INT_5_9_9_9_REV&&(rt=i.RGB9_E5),re===i.RGBA){let Qe=ct?B2:kn.getTransfer(at);ke===i.FLOAT&&(rt=i.RGBA32F),ke===i.HALF_FLOAT&&(rt=i.RGBA16F),ke===i.UNSIGNED_BYTE&&(rt=Qe===Jn?i.SRGB8_ALPHA8:i.RGBA8),ke===i.UNSIGNED_SHORT_4_4_4_4&&(rt=i.RGBA4),ke===i.UNSIGNED_SHORT_5_5_5_1&&(rt=i.RGB5_A1)}return(rt===i.R16F||rt===i.R32F||rt===i.RG16F||rt===i.RG32F||rt===i.RGBA16F||rt===i.RGBA32F)&&e.get("EXT_color_buffer_float"),rt}l(C,"getInternalFormat");function T(pe,re){let ke;return pe?re===null||re===Rc||re===ng?ke=i.DEPTH24_STENCIL8:re===hs?ke=i.DEPTH32F_STENCIL8:re===Kv&&(ke=i.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):re===null||re===Rc||re===ng?ke=i.DEPTH_COMPONENT24:re===hs?ke=i.DEPTH_COMPONENT32F:re===Kv&&(ke=i.DEPTH_COMPONENT16),ke}l(T,"getInternalDepthFormat");function k(pe,re){return A(pe)===!0||pe.isFramebufferTexture&&pe.minFilter!==ms&&pe.minFilter!==Yl?Math.log2(Math.max(re.width,re.height))+1:pe.mipmaps!==void 0&&pe.mipmaps.length>0?pe.mipmaps.length:pe.isCompressedTexture&&Array.isArray(pe.image)?re.mipmaps.length:1}l(k,"getMipLevels");function F(pe){let re=pe.target;re.removeEventListener("dispose",F),N(re),re.isVideoTexture&&d.delete(re)}l(F,"onTextureDispose");function B(pe){let re=pe.target;re.removeEventListener("dispose",B),L(re)}l(B,"onRenderTargetDispose");function N(pe){let re=n.get(pe);if(re.__webglInit===void 0)return;let ke=pe.source,at=m.get(ke);if(at){let ct=at[re.__cacheKey];ct.usedTimes--,ct.usedTimes===0&&z(pe),Object.keys(at).length===0&&m.delete(ke)}n.remove(pe)}l(N,"deallocateTexture");function z(pe){let re=n.get(pe);i.deleteTexture(re.__webglTexture);let ke=pe.source,at=m.get(ke);delete at[re.__cacheKey],o.memory.textures--}l(z,"deleteTexture");function L(pe){let re=n.get(pe);if(pe.depthTexture&&(pe.depthTexture.dispose(),n.remove(pe.depthTexture)),pe.isWebGLCubeRenderTarget)for(let at=0;at<6;at++){if(Array.isArray(re.__webglFramebuffer[at]))for(let ct=0;ct<re.__webglFramebuffer[at].length;ct++)i.deleteFramebuffer(re.__webglFramebuffer[at][ct]);else i.deleteFramebuffer(re.__webglFramebuffer[at]);re.__webglDepthbuffer&&i.deleteRenderbuffer(re.__webglDepthbuffer[at])}else{if(Array.isArray(re.__webglFramebuffer))for(let at=0;at<re.__webglFramebuffer.length;at++)i.deleteFramebuffer(re.__webglFramebuffer[at]);else i.deleteFramebuffer(re.__webglFramebuffer);if(re.__webglDepthbuffer&&i.deleteRenderbuffer(re.__webglDepthbuffer),re.__webglMultisampledFramebuffer&&i.deleteFramebuffer(re.__webglMultisampledFramebuffer),re.__webglColorRenderbuffer)for(let at=0;at<re.__webglColorRenderbuffer.length;at++)re.__webglColorRenderbuffer[at]&&i.deleteRenderbuffer(re.__webglColorRenderbuffer[at]);re.__webglDepthRenderbuffer&&i.deleteRenderbuffer(re.__webglDepthRenderbuffer)}let ke=pe.textures;for(let at=0,ct=ke.length;at<ct;at++){let rt=n.get(ke[at]);rt.__webglTexture&&(i.deleteTexture(rt.__webglTexture),o.memory.textures--),n.remove(ke[at])}n.remove(pe)}l(L,"deallocateRenderTarget");let j=0;function q(){j=0}l(q,"resetTextureUnits");function Z(){let pe=j;return pe>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+pe+" texture units while this GPU supports only "+r.maxTextures),j+=1,pe}l(Z,"allocateTextureUnit");function O(pe){let re=[];return re.push(pe.wrapS),re.push(pe.wrapT),re.push(pe.wrapR||0),re.push(pe.magFilter),re.push(pe.minFilter),re.push(pe.anisotropy),re.push(pe.internalFormat),re.push(pe.format),re.push(pe.type),re.push(pe.generateMipmaps),re.push(pe.premultiplyAlpha),re.push(pe.flipY),re.push(pe.unpackAlignment),re.push(pe.colorSpace),re.join()}l(O,"getTextureCacheKey");function Y(pe,re){let ke=n.get(pe);if(pe.isVideoTexture&&Ke(pe),pe.isRenderTargetTexture===!1&&pe.version>0&&ke.__version!==pe.version){let at=pe.image;if(at===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(at.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{se(ke,pe,re);return}}t.bindTexture(i.TEXTURE_2D,ke.__webglTexture,i.TEXTURE0+re)}l(Y,"setTexture2D");function J(pe,re){let ke=n.get(pe);if(pe.version>0&&ke.__version!==pe.version){se(ke,pe,re);return}t.bindTexture(i.TEXTURE_2D_ARRAY,ke.__webglTexture,i.TEXTURE0+re)}l(J,"setTexture2DArray");function oe(pe,re){let ke=n.get(pe);if(pe.version>0&&ke.__version!==pe.version){se(ke,pe,re);return}t.bindTexture(i.TEXTURE_3D,ke.__webglTexture,i.TEXTURE0+re)}l(oe,"setTexture3D");function $(pe,re){let ke=n.get(pe);if(pe.version>0&&ke.__version!==pe.version){Ae(ke,pe,re);return}t.bindTexture(i.TEXTURE_CUBE_MAP,ke.__webglTexture,i.TEXTURE0+re)}l($,"setTextureCube");let K={[fl]:i.REPEAT,[Zp]:i.CLAMP_TO_EDGE,[$M]:i.MIRRORED_REPEAT},te={[ms]:i.NEAREST,[The]:i.NEAREST_MIPMAP_NEAREST,[L0]:i.NEAREST_MIPMAP_LINEAR,[Yl]:i.LINEAR,[lS]:i.LINEAR_MIPMAP_NEAREST,[Yp]:i.LINEAR_MIPMAP_LINEAR},ve={[Fhe]:i.NEVER,[Ghe]:i.ALWAYS,[Bhe]:i.LESS,[Q8]:i.LEQUAL,[zhe]:i.EQUAL,[jhe]:i.GEQUAL,[Uhe]:i.GREATER,[Vhe]:i.NOTEQUAL};function Q(pe,re){if(re.type===hs&&e.has("OES_texture_float_linear")===!1&&(re.magFilter===Yl||re.magFilter===lS||re.magFilter===L0||re.magFilter===Yp||re.minFilter===Yl||re.minFilter===lS||re.minFilter===L0||re.minFilter===Yp)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),i.texParameteri(pe,i.TEXTURE_WRAP_S,K[re.wrapS]),i.texParameteri(pe,i.TEXTURE_WRAP_T,K[re.wrapT]),(pe===i.TEXTURE_3D||pe===i.TEXTURE_2D_ARRAY)&&i.texParameteri(pe,i.TEXTURE_WRAP_R,K[re.wrapR]),i.texParameteri(pe,i.TEXTURE_MAG_FILTER,te[re.magFilter]),i.texParameteri(pe,i.TEXTURE_MIN_FILTER,te[re.minFilter]),re.compareFunction&&(i.texParameteri(pe,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(pe,i.TEXTURE_COMPARE_FUNC,ve[re.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(re.magFilter===ms||re.minFilter!==L0&&re.minFilter!==Yp||re.type===hs&&e.has("OES_texture_float_linear")===!1)return;if(re.anisotropy>1||n.get(re).__currentAnisotropy){let ke=e.get("EXT_texture_filter_anisotropic");i.texParameterf(pe,ke.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(re.anisotropy,r.getMaxAnisotropy())),n.get(re).__currentAnisotropy=re.anisotropy}}}l(Q,"setTextureParameters");function he(pe,re){let ke=!1;pe.__webglInit===void 0&&(pe.__webglInit=!0,re.addEventListener("dispose",F));let at=re.source,ct=m.get(at);ct===void 0&&(ct={},m.set(at,ct));let rt=O(re);if(rt!==pe.__cacheKey){ct[rt]===void 0&&(ct[rt]={texture:i.createTexture(),usedTimes:0},o.memory.textures++,ke=!0),ct[rt].usedTimes++;let Qe=ct[pe.__cacheKey];Qe!==void 0&&(ct[pe.__cacheKey].usedTimes--,Qe.usedTimes===0&&z(re)),pe.__cacheKey=rt,pe.__webglTexture=ct[rt].texture}return ke}l(he,"initTexture");function se(pe,re,ke){let at=i.TEXTURE_2D;(re.isDataArrayTexture||re.isCompressedArrayTexture)&&(at=i.TEXTURE_2D_ARRAY),re.isData3DTexture&&(at=i.TEXTURE_3D);let ct=he(pe,re),rt=re.source;t.bindTexture(at,pe.__webglTexture,i.TEXTURE0+ke);let Qe=n.get(rt);if(rt.version!==Qe.__version||ct===!0){t.activeTexture(i.TEXTURE0+ke);let At=kn.getPrimaries(kn.workingColorSpace),Dt=re.colorSpace===bc?null:kn.getPrimaries(re.colorSpace),vt=re.colorSpace===bc||At===Dt?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,re.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,re.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,re.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,vt);let yt=w(re.image,!1,r.maxTextureSize);yt=Lt(re,yt);let jt=a.convert(re.format,re.colorSpace),Wt=a.convert(re.type),Kt=C(re.internalFormat,jt,Wt,re.colorSpace,re.isVideoTexture);Q(at,re);let Vt,hi=re.mipmaps,ui=re.isVideoTexture!==!0,Zi=Qe.__version===void 0||ct===!0,Re=rt.dataReady,xt=k(re,yt);if(re.isDepthTexture)Kt=T(re.format===rg,re.type),Zi&&(ui?t.texStorage2D(i.TEXTURE_2D,1,Kt,yt.width,yt.height):t.texImage2D(i.TEXTURE_2D,0,Kt,yt.width,yt.height,0,jt,Wt,null));else if(re.isDataTexture)if(hi.length>0){ui&&Zi&&t.texStorage2D(i.TEXTURE_2D,xt,Kt,hi[0].width,hi[0].height);for(let me=0,W=hi.length;me<W;me++)Vt=hi[me],ui?Re&&t.texSubImage2D(i.TEXTURE_2D,me,0,0,Vt.width,Vt.height,jt,Wt,Vt.data):t.texImage2D(i.TEXTURE_2D,me,Kt,Vt.width,Vt.height,0,jt,Wt,Vt.data);re.generateMipmaps=!1}else ui?(Zi&&t.texStorage2D(i.TEXTURE_2D,xt,Kt,yt.width,yt.height),Re&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,yt.width,yt.height,jt,Wt,yt.data)):t.texImage2D(i.TEXTURE_2D,0,Kt,yt.width,yt.height,0,jt,Wt,yt.data);else if(re.isCompressedTexture)if(re.isCompressedArrayTexture){ui&&Zi&&t.texStorage3D(i.TEXTURE_2D_ARRAY,xt,Kt,hi[0].width,hi[0].height,yt.depth);for(let me=0,W=hi.length;me<W;me++)if(Vt=hi[me],re.format!==ao)if(jt!==null)if(ui){if(Re)if(re.layerUpdates.size>0){let X=DC(Vt.width,Vt.height,re.format,re.type);for(let ae of re.layerUpdates){let _e=Vt.data.subarray(ae*X/Vt.data.BYTES_PER_ELEMENT,(ae+1)*X/Vt.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,me,0,0,ae,Vt.width,Vt.height,1,jt,_e)}re.clearLayerUpdates()}else t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,me,0,0,0,Vt.width,Vt.height,yt.depth,jt,Vt.data)}else t.compressedTexImage3D(i.TEXTURE_2D_ARRAY,me,Kt,Vt.width,Vt.height,yt.depth,0,Vt.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else ui?Re&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,me,0,0,0,Vt.width,Vt.height,yt.depth,jt,Wt,Vt.data):t.texImage3D(i.TEXTURE_2D_ARRAY,me,Kt,Vt.width,Vt.height,yt.depth,0,jt,Wt,Vt.data)}else{ui&&Zi&&t.texStorage2D(i.TEXTURE_2D,xt,Kt,hi[0].width,hi[0].height);for(let me=0,W=hi.length;me<W;me++)Vt=hi[me],re.format!==ao?jt!==null?ui?Re&&t.compressedTexSubImage2D(i.TEXTURE_2D,me,0,0,Vt.width,Vt.height,jt,Vt.data):t.compressedTexImage2D(i.TEXTURE_2D,me,Kt,Vt.width,Vt.height,0,Vt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ui?Re&&t.texSubImage2D(i.TEXTURE_2D,me,0,0,Vt.width,Vt.height,jt,Wt,Vt.data):t.texImage2D(i.TEXTURE_2D,me,Kt,Vt.width,Vt.height,0,jt,Wt,Vt.data)}else if(re.isDataArrayTexture)if(ui){if(Zi&&t.texStorage3D(i.TEXTURE_2D_ARRAY,xt,Kt,yt.width,yt.height,yt.depth),Re)if(re.layerUpdates.size>0){let me=DC(yt.width,yt.height,re.format,re.type);for(let W of re.layerUpdates){let X=yt.data.subarray(W*me/yt.data.BYTES_PER_ELEMENT,(W+1)*me/yt.data.BYTES_PER_ELEMENT);t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,W,yt.width,yt.height,1,jt,Wt,X)}re.clearLayerUpdates()}else t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,yt.width,yt.height,yt.depth,jt,Wt,yt.data)}else t.texImage3D(i.TEXTURE_2D_ARRAY,0,Kt,yt.width,yt.height,yt.depth,0,jt,Wt,yt.data);else if(re.isData3DTexture)ui?(Zi&&t.texStorage3D(i.TEXTURE_3D,xt,Kt,yt.width,yt.height,yt.depth),Re&&t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,yt.width,yt.height,yt.depth,jt,Wt,yt.data)):t.texImage3D(i.TEXTURE_3D,0,Kt,yt.width,yt.height,yt.depth,0,jt,Wt,yt.data);else if(re.isFramebufferTexture){if(Zi)if(ui)t.texStorage2D(i.TEXTURE_2D,xt,Kt,yt.width,yt.height);else{let me=yt.width,W=yt.height;for(let X=0;X<xt;X++)t.texImage2D(i.TEXTURE_2D,X,Kt,me,W,0,jt,Wt,null),me>>=1,W>>=1}}else if(hi.length>0){if(ui&&Zi){let me=_t(hi[0]);t.texStorage2D(i.TEXTURE_2D,xt,Kt,me.width,me.height)}for(let me=0,W=hi.length;me<W;me++)Vt=hi[me],ui?Re&&t.texSubImage2D(i.TEXTURE_2D,me,0,0,jt,Wt,Vt):t.texImage2D(i.TEXTURE_2D,me,Kt,jt,Wt,Vt);re.generateMipmaps=!1}else if(ui){if(Zi){let me=_t(yt);t.texStorage2D(i.TEXTURE_2D,xt,Kt,me.width,me.height)}Re&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,jt,Wt,yt)}else t.texImage2D(i.TEXTURE_2D,0,Kt,jt,Wt,yt);A(re)&&E(at),Qe.__version=rt.version,re.onUpdate&&re.onUpdate(re)}pe.__version=re.version}l(se,"uploadTexture");function Ae(pe,re,ke){if(re.image.length!==6)return;let at=he(pe,re),ct=re.source;t.bindTexture(i.TEXTURE_CUBE_MAP,pe.__webglTexture,i.TEXTURE0+ke);let rt=n.get(ct);if(ct.version!==rt.__version||at===!0){t.activeTexture(i.TEXTURE0+ke);let Qe=kn.getPrimaries(kn.workingColorSpace),At=re.colorSpace===bc?null:kn.getPrimaries(re.colorSpace),Dt=re.colorSpace===bc||Qe===At?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,re.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,re.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,re.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,Dt);let vt=re.isCompressedTexture||re.image[0].isCompressedTexture,yt=re.image[0]&&re.image[0].isDataTexture,jt=[];for(let W=0;W<6;W++)!vt&&!yt?jt[W]=w(re.image[W],!0,r.maxCubemapSize):jt[W]=yt?re.image[W].image:re.image[W],jt[W]=Lt(re,jt[W]);let Wt=jt[0],Kt=a.convert(re.format,re.colorSpace),Vt=a.convert(re.type),hi=C(re.internalFormat,Kt,Vt,re.colorSpace),ui=re.isVideoTexture!==!0,Zi=rt.__version===void 0||at===!0,Re=ct.dataReady,xt=k(re,Wt);Q(i.TEXTURE_CUBE_MAP,re);let me;if(vt){ui&&Zi&&t.texStorage2D(i.TEXTURE_CUBE_MAP,xt,hi,Wt.width,Wt.height);for(let W=0;W<6;W++){me=jt[W].mipmaps;for(let X=0;X<me.length;X++){let ae=me[X];re.format!==ao?Kt!==null?ui?Re&&t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W,X,0,0,ae.width,ae.height,Kt,ae.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W,X,hi,ae.width,ae.height,0,ae.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ui?Re&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W,X,0,0,ae.width,ae.height,Kt,Vt,ae.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W,X,hi,ae.width,ae.height,0,Kt,Vt,ae.data)}}}else{if(me=re.mipmaps,ui&&Zi){me.length>0&&xt++;let W=_t(jt[0]);t.texStorage2D(i.TEXTURE_CUBE_MAP,xt,hi,W.width,W.height)}for(let W=0;W<6;W++)if(yt){ui?Re&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W,0,0,0,jt[W].width,jt[W].height,Kt,Vt,jt[W].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W,0,hi,jt[W].width,jt[W].height,0,Kt,Vt,jt[W].data);for(let X=0;X<me.length;X++){let ae=me[X].image[W].image;ui?Re&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W,X+1,0,0,ae.width,ae.height,Kt,Vt,ae.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W,X+1,hi,ae.width,ae.height,0,Kt,Vt,ae.data)}}else{ui?Re&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W,0,0,0,Kt,Vt,jt[W]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W,0,hi,Kt,Vt,jt[W]);for(let X=0;X<me.length;X++){let ae=me[X];ui?Re&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W,X+1,0,0,Kt,Vt,ae.image[W]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W,X+1,hi,Kt,Vt,ae.image[W])}}}A(re)&&E(i.TEXTURE_CUBE_MAP),rt.__version=ct.version,re.onUpdate&&re.onUpdate(re)}pe.__version=re.version}l(Ae,"uploadCubeTexture");function Ie(pe,re,ke,at,ct,rt){let Qe=a.convert(ke.format,ke.colorSpace),At=a.convert(ke.type),Dt=C(ke.internalFormat,Qe,At,ke.colorSpace),vt=n.get(re),yt=n.get(ke);if(yt.__renderTarget=re,!vt.__hasExternalTextures){let jt=Math.max(1,re.width>>rt),Wt=Math.max(1,re.height>>rt);ct===i.TEXTURE_3D||ct===i.TEXTURE_2D_ARRAY?t.texImage3D(ct,rt,Dt,jt,Wt,re.depth,0,Qe,At,null):t.texImage2D(ct,rt,Dt,jt,Wt,0,Qe,At,null)}t.bindFramebuffer(i.FRAMEBUFFER,pe),He(re)?s.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,at,ct,yt.__webglTexture,0,ot(re)):(ct===i.TEXTURE_2D||ct>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&ct<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,at,ct,yt.__webglTexture,rt),t.bindFramebuffer(i.FRAMEBUFFER,null)}l(Ie,"setupFrameBufferTexture");function we(pe,re,ke){if(i.bindRenderbuffer(i.RENDERBUFFER,pe),re.depthBuffer){let at=re.depthTexture,ct=at&&at.isDepthTexture?at.type:null,rt=T(re.stencilBuffer,ct),Qe=re.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,At=ot(re);He(re)?s.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,At,rt,re.width,re.height):ke?i.renderbufferStorageMultisample(i.RENDERBUFFER,At,rt,re.width,re.height):i.renderbufferStorage(i.RENDERBUFFER,rt,re.width,re.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,Qe,i.RENDERBUFFER,pe)}else{let at=re.textures;for(let ct=0;ct<at.length;ct++){let rt=at[ct],Qe=a.convert(rt.format,rt.colorSpace),At=a.convert(rt.type),Dt=C(rt.internalFormat,Qe,At,rt.colorSpace),vt=ot(re);ke&&He(re)===!1?i.renderbufferStorageMultisample(i.RENDERBUFFER,vt,Dt,re.width,re.height):He(re)?s.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,vt,Dt,re.width,re.height):i.renderbufferStorage(i.RENDERBUFFER,Dt,re.width,re.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}l(we,"setupRenderBufferStorage");function Ne(pe,re){if(re&&re.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(i.FRAMEBUFFER,pe),!(re.depthTexture&&re.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");let ke=n.get(re.depthTexture);ke.__renderTarget=re,(!ke.__webglTexture||re.depthTexture.image.width!==re.width||re.depthTexture.image.height!==re.height)&&(re.depthTexture.image.width=re.width,re.depthTexture.image.height=re.height,re.depthTexture.needsUpdate=!0),Y(re.depthTexture,0);let at=ke.__webglTexture,ct=ot(re);if(re.depthTexture.format===km)He(re)?s.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,at,0,ct):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,at,0);else if(re.depthTexture.format===rg)He(re)?s.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,at,0,ct):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,at,0);else throw new Error("Unknown depthTexture format")}l(Ne,"setupDepthTexture");function je(pe){let re=n.get(pe),ke=pe.isWebGLCubeRenderTarget===!0;if(re.__boundDepthTexture!==pe.depthTexture){let at=pe.depthTexture;if(re.__depthDisposeCallback&&re.__depthDisposeCallback(),at){let ct=l(()=>{delete re.__boundDepthTexture,delete re.__depthDisposeCallback,at.removeEventListener("dispose",ct)},"disposeEvent");at.addEventListener("dispose",ct),re.__depthDisposeCallback=ct}re.__boundDepthTexture=at}if(pe.depthTexture&&!re.__autoAllocateDepthBuffer){if(ke)throw new Error("target.depthTexture not supported in Cube render targets");Ne(re.__webglFramebuffer,pe)}else if(ke){re.__webglDepthbuffer=[];for(let at=0;at<6;at++)if(t.bindFramebuffer(i.FRAMEBUFFER,re.__webglFramebuffer[at]),re.__webglDepthbuffer[at]===void 0)re.__webglDepthbuffer[at]=i.createRenderbuffer(),we(re.__webglDepthbuffer[at],pe,!1);else{let ct=pe.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,rt=re.__webglDepthbuffer[at];i.bindRenderbuffer(i.RENDERBUFFER,rt),i.framebufferRenderbuffer(i.FRAMEBUFFER,ct,i.RENDERBUFFER,rt)}}else if(t.bindFramebuffer(i.FRAMEBUFFER,re.__webglFramebuffer),re.__webglDepthbuffer===void 0)re.__webglDepthbuffer=i.createRenderbuffer(),we(re.__webglDepthbuffer,pe,!1);else{let at=pe.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,ct=re.__webglDepthbuffer;i.bindRenderbuffer(i.RENDERBUFFER,ct),i.framebufferRenderbuffer(i.FRAMEBUFFER,at,i.RENDERBUFFER,ct)}t.bindFramebuffer(i.FRAMEBUFFER,null)}l(je,"setupDepthRenderbuffer");function Ve(pe,re,ke){let at=n.get(pe);re!==void 0&&Ie(at.__webglFramebuffer,pe,pe.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),ke!==void 0&&je(pe)}l(Ve,"rebindTextures");function Le(pe){let re=pe.texture,ke=n.get(pe),at=n.get(re);pe.addEventListener("dispose",B);let ct=pe.textures,rt=pe.isWebGLCubeRenderTarget===!0,Qe=ct.length>1;if(Qe||(at.__webglTexture===void 0&&(at.__webglTexture=i.createTexture()),at.__version=re.version,o.memory.textures++),rt){ke.__webglFramebuffer=[];for(let At=0;At<6;At++)if(re.mipmaps&&re.mipmaps.length>0){ke.__webglFramebuffer[At]=[];for(let Dt=0;Dt<re.mipmaps.length;Dt++)ke.__webglFramebuffer[At][Dt]=i.createFramebuffer()}else ke.__webglFramebuffer[At]=i.createFramebuffer()}else{if(re.mipmaps&&re.mipmaps.length>0){ke.__webglFramebuffer=[];for(let At=0;At<re.mipmaps.length;At++)ke.__webglFramebuffer[At]=i.createFramebuffer()}else ke.__webglFramebuffer=i.createFramebuffer();if(Qe)for(let At=0,Dt=ct.length;At<Dt;At++){let vt=n.get(ct[At]);vt.__webglTexture===void 0&&(vt.__webglTexture=i.createTexture(),o.memory.textures++)}if(pe.samples>0&&He(pe)===!1){ke.__webglMultisampledFramebuffer=i.createFramebuffer(),ke.__webglColorRenderbuffer=[],t.bindFramebuffer(i.FRAMEBUFFER,ke.__webglMultisampledFramebuffer);for(let At=0;At<ct.length;At++){let Dt=ct[At];ke.__webglColorRenderbuffer[At]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,ke.__webglColorRenderbuffer[At]);let vt=a.convert(Dt.format,Dt.colorSpace),yt=a.convert(Dt.type),jt=C(Dt.internalFormat,vt,yt,Dt.colorSpace,pe.isXRRenderTarget===!0),Wt=ot(pe);i.renderbufferStorageMultisample(i.RENDERBUFFER,Wt,jt,pe.width,pe.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+At,i.RENDERBUFFER,ke.__webglColorRenderbuffer[At])}i.bindRenderbuffer(i.RENDERBUFFER,null),pe.depthBuffer&&(ke.__webglDepthRenderbuffer=i.createRenderbuffer(),we(ke.__webglDepthRenderbuffer,pe,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}}if(rt){t.bindTexture(i.TEXTURE_CUBE_MAP,at.__webglTexture),Q(i.TEXTURE_CUBE_MAP,re);for(let At=0;At<6;At++)if(re.mipmaps&&re.mipmaps.length>0)for(let Dt=0;Dt<re.mipmaps.length;Dt++)Ie(ke.__webglFramebuffer[At][Dt],pe,re,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+At,Dt);else Ie(ke.__webglFramebuffer[At],pe,re,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+At,0);A(re)&&E(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Qe){for(let At=0,Dt=ct.length;At<Dt;At++){let vt=ct[At],yt=n.get(vt);t.bindTexture(i.TEXTURE_2D,yt.__webglTexture),Q(i.TEXTURE_2D,vt),Ie(ke.__webglFramebuffer,pe,vt,i.COLOR_ATTACHMENT0+At,i.TEXTURE_2D,0),A(vt)&&E(i.TEXTURE_2D)}t.unbindTexture()}else{let At=i.TEXTURE_2D;if((pe.isWebGL3DRenderTarget||pe.isWebGLArrayRenderTarget)&&(At=pe.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(At,at.__webglTexture),Q(At,re),re.mipmaps&&re.mipmaps.length>0)for(let Dt=0;Dt<re.mipmaps.length;Dt++)Ie(ke.__webglFramebuffer[Dt],pe,re,i.COLOR_ATTACHMENT0,At,Dt);else Ie(ke.__webglFramebuffer,pe,re,i.COLOR_ATTACHMENT0,At,0);A(re)&&E(At),t.unbindTexture()}pe.depthBuffer&&je(pe)}l(Le,"setupRenderTarget");function xe(pe){let re=pe.textures;for(let ke=0,at=re.length;ke<at;ke++){let ct=re[ke];if(A(ct)){let rt=I(pe),Qe=n.get(ct).__webglTexture;t.bindTexture(rt,Qe),E(rt),t.unbindTexture()}}}l(xe,"updateRenderTargetMipmap");let Ue=[],de=[];function ut(pe){if(pe.samples>0){if(He(pe)===!1){let re=pe.textures,ke=pe.width,at=pe.height,ct=i.COLOR_BUFFER_BIT,rt=pe.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Qe=n.get(pe),At=re.length>1;if(At)for(let Dt=0;Dt<re.length;Dt++)t.bindFramebuffer(i.FRAMEBUFFER,Qe.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Dt,i.RENDERBUFFER,null),t.bindFramebuffer(i.FRAMEBUFFER,Qe.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+Dt,i.TEXTURE_2D,null,0);t.bindFramebuffer(i.READ_FRAMEBUFFER,Qe.__webglMultisampledFramebuffer),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Qe.__webglFramebuffer);for(let Dt=0;Dt<re.length;Dt++){if(pe.resolveDepthBuffer&&(pe.depthBuffer&&(ct|=i.DEPTH_BUFFER_BIT),pe.stencilBuffer&&pe.resolveStencilBuffer&&(ct|=i.STENCIL_BUFFER_BIT)),At){i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,Qe.__webglColorRenderbuffer[Dt]);let vt=n.get(re[Dt]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,vt,0)}i.blitFramebuffer(0,0,ke,at,0,0,ke,at,ct,i.NEAREST),u===!0&&(Ue.length=0,de.length=0,Ue.push(i.COLOR_ATTACHMENT0+Dt),pe.depthBuffer&&pe.resolveDepthBuffer===!1&&(Ue.push(rt),de.push(rt),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,de)),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,Ue))}if(t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),At)for(let Dt=0;Dt<re.length;Dt++){t.bindFramebuffer(i.FRAMEBUFFER,Qe.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Dt,i.RENDERBUFFER,Qe.__webglColorRenderbuffer[Dt]);let vt=n.get(re[Dt]).__webglTexture;t.bindFramebuffer(i.FRAMEBUFFER,Qe.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+Dt,i.TEXTURE_2D,vt,0)}t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Qe.__webglMultisampledFramebuffer)}else if(pe.depthBuffer&&pe.resolveDepthBuffer===!1&&u){let re=pe.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[re])}}}l(ut,"updateMultisampleRenderTarget");function ot(pe){return Math.min(r.maxSamples,pe.samples)}l(ot,"getRenderTargetSamples");function He(pe){let re=n.get(pe);return pe.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&re.__useRenderToTexture!==!1}l(He,"useMultisampledRTT");function Ke(pe){let re=o.render.frame;d.get(pe)!==re&&(d.set(pe,re),pe.update())}l(Ke,"updateVideoTexture");function Lt(pe,re){let ke=pe.colorSpace,at=pe.format,ct=pe.type;return pe.isCompressedTexture===!0||pe.isVideoTexture===!0||ke!==pd&&ke!==bc&&(kn.getTransfer(ke)===Jn?(at!==ao||ct!==vl)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ke)),re}l(Lt,"verifyColorSpace");function _t(pe){return typeof HTMLImageElement<"u"&&pe instanceof HTMLImageElement?(h.width=pe.naturalWidth||pe.width,h.height=pe.naturalHeight||pe.height):typeof VideoFrame<"u"&&pe instanceof VideoFrame?(h.width=pe.displayWidth,h.height=pe.displayHeight):(h.width=pe.width,h.height=pe.height),h}l(_t,"getDimensions"),this.allocateTextureUnit=Z,this.resetTextureUnits=q,this.setTexture2D=Y,this.setTexture2DArray=J,this.setTexture3D=oe,this.setTextureCube=$,this.rebindTextures=Ve,this.setupRenderTarget=Le,this.updateRenderTargetMipmap=xe,this.updateMultisampleRenderTarget=ut,this.setupDepthRenderbuffer=je,this.setupFrameBufferTexture=Ie,this.useMultisampledRTT=He}l(NB,"WebGLTextures");function FB(i,e){function t(n,r=bc){let a,o=kn.getTransfer(r);if(n===vl)return i.UNSIGNED_BYTE;if(n===TP)return i.UNSIGNED_SHORT_4_4_4_4;if(n===PP)return i.UNSIGNED_SHORT_5_5_5_1;if(n===W8)return i.UNSIGNED_INT_5_9_9_9_REV;if(n===$8)return i.BYTE;if(n===H8)return i.SHORT;if(n===Kv)return i.UNSIGNED_SHORT;if(n===IP)return i.INT;if(n===Rc)return i.UNSIGNED_INT;if(n===hs)return i.FLOAT;if(n===G1)return i.HALF_FLOAT;if(n===q8)return i.ALPHA;if(n===X8)return i.RGB;if(n===ao)return i.RGBA;if(n===Z8)return i.LUMINANCE;if(n===Y8)return i.LUMINANCE_ALPHA;if(n===km)return i.DEPTH_COMPONENT;if(n===rg)return i.DEPTH_STENCIL;if(n===LP)return i.RED;if(n===Vw)return i.RED_INTEGER;if(n===J8)return i.RG;if(n===DP)return i.RG_INTEGER;if(n===kP)return i.RGBA_INTEGER;if(n===z_||n===U_||n===V_||n===j_)if(o===Jn)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(n===z_)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===U_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===V_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===j_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(n===z_)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===U_)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===V_)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===j_)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===HM||n===WM||n===qM||n===XM)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(n===HM)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===WM)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===qM)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===XM)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===ZM||n===YM||n===JM)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(n===ZM||n===YM)return o===Jn?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(n===JM)return o===Jn?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===KM||n===QM||n===eC||n===tC||n===iC||n===nC||n===rC||n===aC||n===oC||n===sC||n===lC||n===uC||n===hC||n===cC)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(n===KM)return o===Jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===QM)return o===Jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===eC)return o===Jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===tC)return o===Jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===iC)return o===Jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===nC)return o===Jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===rC)return o===Jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===aC)return o===Jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===oC)return o===Jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===sC)return o===Jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===lC)return o===Jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===uC)return o===Jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===hC)return o===Jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===cC)return o===Jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===G_||n===pC||n===dC)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(n===G_)return o===Jn?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===pC)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===dC)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===K8||n===fC||n===mC||n===gC)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(n===G_)return a.COMPRESSED_RED_RGTC1_EXT;if(n===fC)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===mC)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===gC)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===ng?i.UNSIGNED_INT_24_8:i[n]!==void 0?i[n]:null}return l(t,"convert"),{convert:t}}l(FB,"WebGLUtils");var Jfe=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,Kfe=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`,BB=class{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(this.texture===null){let r=new Zo,a=e.properties.get(r);a.__webglTexture=t.texture,(t.depthNear!==n.depthNear||t.depthFar!==n.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}getMesh(e){if(this.texture!==null&&this.mesh===null){let t=e.cameras[0].viewport,n=new ys({vertexShader:Jfe,fragmentShader:Kfe,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new ln(new Cd(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}};l(BB,"WebXRDepthSensing");var Qfe=BB,zB=class extends Rg{constructor(e,t){super();let n=this,r=null,a=1,o=null,s="local-floor",u=1,h=null,d=null,f=null,m=null,v=null,b=null,w=new Qfe,A=t.getContextAttributes(),E=null,I=null,C=[],T=[],k=new ft,F=null,B=new Ao;B.viewport=new jn;let N=new Ao;N.viewport=new jn;let z=[B,N],L=new $ce,j=null,q=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(se){let Ae=C[se];return Ae===void 0&&(Ae=new ES,C[se]=Ae),Ae.getTargetRaySpace()},this.getControllerGrip=function(se){let Ae=C[se];return Ae===void 0&&(Ae=new ES,C[se]=Ae),Ae.getGripSpace()},this.getHand=function(se){let Ae=C[se];return Ae===void 0&&(Ae=new ES,C[se]=Ae),Ae.getHandSpace()};function Z(se){let Ae=T.indexOf(se.inputSource);if(Ae===-1)return;let Ie=C[Ae];Ie!==void 0&&(Ie.update(se.inputSource,se.frame,h||o),Ie.dispatchEvent({type:se.type,data:se.inputSource}))}l(Z,"onSessionEvent");function O(){r.removeEventListener("select",Z),r.removeEventListener("selectstart",Z),r.removeEventListener("selectend",Z),r.removeEventListener("squeeze",Z),r.removeEventListener("squeezestart",Z),r.removeEventListener("squeezeend",Z),r.removeEventListener("end",O),r.removeEventListener("inputsourceschange",Y);for(let se=0;se<C.length;se++){let Ae=T[se];Ae!==null&&(T[se]=null,C[se].disconnect(Ae))}j=null,q=null,w.reset(),e.setRenderTarget(E),v=null,m=null,f=null,r=null,I=null,he.stop(),n.isPresenting=!1,e.setPixelRatio(F),e.setSize(k.width,k.height,!1),n.dispatchEvent({type:"sessionend"})}l(O,"onSessionEnd"),this.setFramebufferScaleFactor=function(se){a=se,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(se){s=se,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return h||o},this.setReferenceSpace=function(se){h=se},this.getBaseLayer=function(){return m!==null?m:v},this.getBinding=function(){return f},this.getFrame=function(){return b},this.getSession=function(){return r},this.setSession=async function(se){if(r=se,r!==null){if(E=e.getRenderTarget(),r.addEventListener("select",Z),r.addEventListener("selectstart",Z),r.addEventListener("selectend",Z),r.addEventListener("squeeze",Z),r.addEventListener("squeezestart",Z),r.addEventListener("squeezeend",Z),r.addEventListener("end",O),r.addEventListener("inputsourceschange",Y),A.xrCompatible!==!0&&await t.makeXRCompatible(),F=e.getPixelRatio(),e.getSize(k),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let Ae=null,Ie=null,we=null;A.depth&&(we=A.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Ae=A.stencil?rg:km,Ie=A.stencil?ng:Rc);let Ne={colorFormat:t.RGBA8,depthFormat:we,scaleFactor:a};f=new XRWebGLBinding(r,t),m=f.createProjectionLayer(Ne),r.updateRenderState({layers:[m]}),e.setPixelRatio(1),e.setSize(m.textureWidth,m.textureHeight,!1),I=new Oc(m.textureWidth,m.textureHeight,{format:ao,type:vl,depthTexture:new XO(m.textureWidth,m.textureHeight,Ie,void 0,void 0,void 0,void 0,void 0,void 0,Ae),stencilBuffer:A.stencil,colorSpace:e.outputColorSpace,samples:A.antialias?4:0,resolveDepthBuffer:m.ignoreDepthValues===!1})}else{let Ae={antialias:A.antialias,alpha:!0,depth:A.depth,stencil:A.stencil,framebufferScaleFactor:a};v=new XRWebGLLayer(r,t,Ae),r.updateRenderState({baseLayer:v}),e.setPixelRatio(1),e.setSize(v.framebufferWidth,v.framebufferHeight,!1),I=new Oc(v.framebufferWidth,v.framebufferHeight,{format:ao,type:vl,colorSpace:e.outputColorSpace,stencilBuffer:A.stencil})}I.isXRRenderTarget=!0,this.setFoveation(u),h=null,o=await r.requestReferenceSpace(s),he.setContext(r),he.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return w.getDepthTexture()};function Y(se){for(let Ae=0;Ae<se.removed.length;Ae++){let Ie=se.removed[Ae],we=T.indexOf(Ie);we>=0&&(T[we]=null,C[we].disconnect(Ie))}for(let Ae=0;Ae<se.added.length;Ae++){let Ie=se.added[Ae],we=T.indexOf(Ie);if(we===-1){for(let je=0;je<C.length;je++)if(je>=T.length){T.push(Ie),we=je;break}else if(T[je]===null){T[je]=Ie,we=je;break}if(we===-1)break}let Ne=C[we];Ne&&Ne.connect(Ie)}}l(Y,"onInputSourcesChange");let J=new Ee,oe=new Ee;function $(se,Ae,Ie){J.setFromMatrixPosition(Ae.matrixWorld),oe.setFromMatrixPosition(Ie.matrixWorld);let we=J.distanceTo(oe),Ne=Ae.projectionMatrix.elements,je=Ie.projectionMatrix.elements,Ve=Ne[14]/(Ne[10]-1),Le=Ne[14]/(Ne[10]+1),xe=(Ne[9]+1)/Ne[5],Ue=(Ne[9]-1)/Ne[5],de=(Ne[8]-1)/Ne[0],ut=(je[8]+1)/je[0],ot=Ve*de,He=Ve*ut,Ke=we/(-de+ut),Lt=Ke*-de;if(Ae.matrixWorld.decompose(se.position,se.quaternion,se.scale),se.translateX(Lt),se.translateZ(Ke),se.matrixWorld.compose(se.position,se.quaternion,se.scale),se.matrixWorldInverse.copy(se.matrixWorld).invert(),Ne[10]===-1)se.projectionMatrix.copy(Ae.projectionMatrix),se.projectionMatrixInverse.copy(Ae.projectionMatrixInverse);else{let _t=Ve+Ke,pe=Le+Ke,re=ot-Lt,ke=He+(we-Lt),at=xe*Le/pe*_t,ct=Ue*Le/pe*_t;se.projectionMatrix.makePerspective(re,ke,at,ct,_t,pe),se.projectionMatrixInverse.copy(se.projectionMatrix).invert()}}l($,"setProjectionFromUnion");function K(se,Ae){Ae===null?se.matrixWorld.copy(se.matrix):se.matrixWorld.multiplyMatrices(Ae.matrixWorld,se.matrix),se.matrixWorldInverse.copy(se.matrixWorld).invert()}l(K,"updateCamera"),this.updateCamera=function(se){if(r===null)return;let Ae=se.near,Ie=se.far;w.texture!==null&&(w.depthNear>0&&(Ae=w.depthNear),w.depthFar>0&&(Ie=w.depthFar)),L.near=N.near=B.near=Ae,L.far=N.far=B.far=Ie,(j!==L.near||q!==L.far)&&(r.updateRenderState({depthNear:L.near,depthFar:L.far}),j=L.near,q=L.far),B.layers.mask=se.layers.mask|2,N.layers.mask=se.layers.mask|4,L.layers.mask=B.layers.mask|N.layers.mask;let we=se.parent,Ne=L.cameras;K(L,we);for(let je=0;je<Ne.length;je++)K(Ne[je],we);Ne.length===2?$(L,B,N):L.projectionMatrix.copy(B.projectionMatrix),te(se,L,we)};function te(se,Ae,Ie){Ie===null?se.matrix.copy(Ae.matrixWorld):(se.matrix.copy(Ie.matrixWorld),se.matrix.invert(),se.matrix.multiply(Ae.matrixWorld)),se.matrix.decompose(se.position,se.quaternion,se.scale),se.updateMatrixWorld(!0),se.projectionMatrix.copy(Ae.projectionMatrix),se.projectionMatrixInverse.copy(Ae.projectionMatrixInverse),se.isPerspectiveCamera&&(se.fov=ag*2*Math.atan(1/se.projectionMatrix.elements[5]),se.zoom=1)}l(te,"updateUserCamera"),this.getCamera=function(){return L},this.getFoveation=function(){if(!(m===null&&v===null))return u},this.setFoveation=function(se){u=se,m!==null&&(m.fixedFoveation=se),v!==null&&v.fixedFoveation!==void 0&&(v.fixedFoveation=se)},this.hasDepthSensing=function(){return w.texture!==null},this.getDepthSensingMesh=function(){return w.getMesh(L)};let ve=null;function Q(se,Ae){if(d=Ae.getViewerPose(h||o),b=Ae,d!==null){let Ie=d.views;v!==null&&(e.setRenderTargetFramebuffer(I,v.framebuffer),e.setRenderTarget(I));let we=!1;Ie.length!==L.cameras.length&&(L.cameras.length=0,we=!0);for(let je=0;je<Ie.length;je++){let Ve=Ie[je],Le=null;if(v!==null)Le=v.getViewport(Ve);else{let Ue=f.getViewSubImage(m,Ve);Le=Ue.viewport,je===0&&(e.setRenderTargetTextures(I,Ue.colorTexture,m.ignoreDepthValues?void 0:Ue.depthStencilTexture),e.setRenderTarget(I))}let xe=z[je];xe===void 0&&(xe=new Ao,xe.layers.enable(je),xe.viewport=new jn,z[je]=xe),xe.matrix.fromArray(Ve.transform.matrix),xe.matrix.decompose(xe.position,xe.quaternion,xe.scale),xe.projectionMatrix.fromArray(Ve.projectionMatrix),xe.projectionMatrixInverse.copy(xe.projectionMatrix).invert(),xe.viewport.set(Le.x,Le.y,Le.width,Le.height),je===0&&(L.matrix.copy(xe.matrix),L.matrix.decompose(L.position,L.quaternion,L.scale)),we===!0&&L.cameras.push(xe)}let Ne=r.enabledFeatures;if(Ne&&Ne.includes("depth-sensing")&&r.depthUsage=="gpu-optimized"&&f){let je=f.getDepthInformation(Ie[0]);je&&je.isValid&&je.texture&&w.init(e,je,r.renderState)}}for(let Ie=0;Ie<C.length;Ie++){let we=T[Ie],Ne=C[Ie];we!==null&&Ne!==void 0&&Ne.update(we,Ae,h||o)}ve&&ve(se,Ae),Ae.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:Ae}),b=null}l(Q,"onAnimationFrame");let he=new KP;he.setAnimationLoop(Q),this.setAnimationLoop=function(se){ve=se},this.dispose=function(){}}};l(zB,"WebXRManager");var eme=zB,cp=new Wo,tme=new qi;function UB(i,e){function t(A,E){A.matrixAutoUpdate===!0&&A.updateMatrix(),E.value.copy(A.matrix)}l(t,"refreshTransformUniform");function n(A,E){E.color.getRGB(A.fogColor.value,FP(i)),E.isFog?(A.fogNear.value=E.near,A.fogFar.value=E.far):E.isFogExp2&&(A.fogDensity.value=E.density)}l(n,"refreshFogUniforms");function r(A,E,I,C,T){E.isMeshBasicMaterial||E.isMeshLambertMaterial?a(A,E):E.isMeshToonMaterial?(a(A,E),f(A,E)):E.isMeshPhongMaterial?(a(A,E),d(A,E)):E.isMeshStandardMaterial?(a(A,E),m(A,E),E.isMeshPhysicalMaterial&&v(A,E,T)):E.isMeshMatcapMaterial?(a(A,E),b(A,E)):E.isMeshDepthMaterial?a(A,E):E.isMeshDistanceMaterial?(a(A,E),w(A,E)):E.isMeshNormalMaterial?a(A,E):E.isLineBasicMaterial?(o(A,E),E.isLineDashedMaterial&&s(A,E)):E.isPointsMaterial?u(A,E,I,C):E.isSpriteMaterial?h(A,E):E.isShadowMaterial?(A.color.value.copy(E.color),A.opacity.value=E.opacity):E.isShaderMaterial&&(E.uniformsNeedUpdate=!1)}l(r,"refreshMaterialUniforms");function a(A,E){A.opacity.value=E.opacity,E.color&&A.diffuse.value.copy(E.color),E.emissive&&A.emissive.value.copy(E.emissive).multiplyScalar(E.emissiveIntensity),E.map&&(A.map.value=E.map,t(E.map,A.mapTransform)),E.alphaMap&&(A.alphaMap.value=E.alphaMap,t(E.alphaMap,A.alphaMapTransform)),E.bumpMap&&(A.bumpMap.value=E.bumpMap,t(E.bumpMap,A.bumpMapTransform),A.bumpScale.value=E.bumpScale,E.side===Eo&&(A.bumpScale.value*=-1)),E.normalMap&&(A.normalMap.value=E.normalMap,t(E.normalMap,A.normalMapTransform),A.normalScale.value.copy(E.normalScale),E.side===Eo&&A.normalScale.value.negate()),E.displacementMap&&(A.displacementMap.value=E.displacementMap,t(E.displacementMap,A.displacementMapTransform),A.displacementScale.value=E.displacementScale,A.displacementBias.value=E.displacementBias),E.emissiveMap&&(A.emissiveMap.value=E.emissiveMap,t(E.emissiveMap,A.emissiveMapTransform)),E.specularMap&&(A.specularMap.value=E.specularMap,t(E.specularMap,A.specularMapTransform)),E.alphaTest>0&&(A.alphaTest.value=E.alphaTest);let I=e.get(E),C=I.envMap,T=I.envMapRotation;C&&(A.envMap.value=C,cp.copy(T),cp.x*=-1,cp.y*=-1,cp.z*=-1,C.isCubeTexture&&C.isRenderTargetTexture===!1&&(cp.y*=-1,cp.z*=-1),A.envMapRotation.value.setFromMatrix4(tme.makeRotationFromEuler(cp)),A.flipEnvMap.value=C.isCubeTexture&&C.isRenderTargetTexture===!1?-1:1,A.reflectivity.value=E.reflectivity,A.ior.value=E.ior,A.refractionRatio.value=E.refractionRatio),E.lightMap&&(A.lightMap.value=E.lightMap,A.lightMapIntensity.value=E.lightMapIntensity,t(E.lightMap,A.lightMapTransform)),E.aoMap&&(A.aoMap.value=E.aoMap,A.aoMapIntensity.value=E.aoMapIntensity,t(E.aoMap,A.aoMapTransform))}l(a,"refreshUniformsCommon");function o(A,E){A.diffuse.value.copy(E.color),A.opacity.value=E.opacity,E.map&&(A.map.value=E.map,t(E.map,A.mapTransform))}l(o,"refreshUniformsLine");function s(A,E){A.dashSize.value=E.dashSize,A.totalSize.value=E.dashSize+E.gapSize,A.scale.value=E.scale}l(s,"refreshUniformsDash");function u(A,E,I,C){A.diffuse.value.copy(E.color),A.opacity.value=E.opacity,A.size.value=E.size*I,A.scale.value=C*.5,E.map&&(A.map.value=E.map,t(E.map,A.uvTransform)),E.alphaMap&&(A.alphaMap.value=E.alphaMap,t(E.alphaMap,A.alphaMapTransform)),E.alphaTest>0&&(A.alphaTest.value=E.alphaTest)}l(u,"refreshUniformsPoints");function h(A,E){A.diffuse.value.copy(E.color),A.opacity.value=E.opacity,A.rotation.value=E.rotation,E.map&&(A.map.value=E.map,t(E.map,A.mapTransform)),E.alphaMap&&(A.alphaMap.value=E.alphaMap,t(E.alphaMap,A.alphaMapTransform)),E.alphaTest>0&&(A.alphaTest.value=E.alphaTest)}l(h,"refreshUniformsSprites");function d(A,E){A.specular.value.copy(E.specular),A.shininess.value=Math.max(E.shininess,1e-4)}l(d,"refreshUniformsPhong");function f(A,E){E.gradientMap&&(A.gradientMap.value=E.gradientMap)}l(f,"refreshUniformsToon");function m(A,E){A.metalness.value=E.metalness,E.metalnessMap&&(A.metalnessMap.value=E.metalnessMap,t(E.metalnessMap,A.metalnessMapTransform)),A.roughness.value=E.roughness,E.roughnessMap&&(A.roughnessMap.value=E.roughnessMap,t(E.roughnessMap,A.roughnessMapTransform)),E.envMap&&(A.envMapIntensity.value=E.envMapIntensity)}l(m,"refreshUniformsStandard");function v(A,E,I){A.ior.value=E.ior,E.sheen>0&&(A.sheenColor.value.copy(E.sheenColor).multiplyScalar(E.sheen),A.sheenRoughness.value=E.sheenRoughness,E.sheenColorMap&&(A.sheenColorMap.value=E.sheenColorMap,t(E.sheenColorMap,A.sheenColorMapTransform)),E.sheenRoughnessMap&&(A.sheenRoughnessMap.value=E.sheenRoughnessMap,t(E.sheenRoughnessMap,A.sheenRoughnessMapTransform))),E.clearcoat>0&&(A.clearcoat.value=E.clearcoat,A.clearcoatRoughness.value=E.clearcoatRoughness,E.clearcoatMap&&(A.clearcoatMap.value=E.clearcoatMap,t(E.clearcoatMap,A.clearcoatMapTransform)),E.clearcoatRoughnessMap&&(A.clearcoatRoughnessMap.value=E.clearcoatRoughnessMap,t(E.clearcoatRoughnessMap,A.clearcoatRoughnessMapTransform)),E.clearcoatNormalMap&&(A.clearcoatNormalMap.value=E.clearcoatNormalMap,t(E.clearcoatNormalMap,A.clearcoatNormalMapTransform),A.clearcoatNormalScale.value.copy(E.clearcoatNormalScale),E.side===Eo&&A.clearcoatNormalScale.value.negate())),E.dispersion>0&&(A.dispersion.value=E.dispersion),E.iridescence>0&&(A.iridescence.value=E.iridescence,A.iridescenceIOR.value=E.iridescenceIOR,A.iridescenceThicknessMinimum.value=E.iridescenceThicknessRange[0],A.iridescenceThicknessMaximum.value=E.iridescenceThicknessRange[1],E.iridescenceMap&&(A.iridescenceMap.value=E.iridescenceMap,t(E.iridescenceMap,A.iridescenceMapTransform)),E.iridescenceThicknessMap&&(A.iridescenceThicknessMap.value=E.iridescenceThicknessMap,t(E.iridescenceThicknessMap,A.iridescenceThicknessMapTransform))),E.transmission>0&&(A.transmission.value=E.transmission,A.transmissionSamplerMap.value=I.texture,A.transmissionSamplerSize.value.set(I.width,I.height),E.transmissionMap&&(A.transmissionMap.value=E.transmissionMap,t(E.transmissionMap,A.transmissionMapTransform)),A.thickness.value=E.thickness,E.thicknessMap&&(A.thicknessMap.value=E.thicknessMap,t(E.thicknessMap,A.thicknessMapTransform)),A.attenuationDistance.value=E.attenuationDistance,A.attenuationColor.value.copy(E.attenuationColor)),E.anisotropy>0&&(A.anisotropyVector.value.set(E.anisotropy*Math.cos(E.anisotropyRotation),E.anisotropy*Math.sin(E.anisotropyRotation)),E.anisotropyMap&&(A.anisotropyMap.value=E.anisotropyMap,t(E.anisotropyMap,A.anisotropyMapTransform))),A.specularIntensity.value=E.specularIntensity,A.specularColor.value.copy(E.specularColor),E.specularColorMap&&(A.specularColorMap.value=E.specularColorMap,t(E.specularColorMap,A.specularColorMapTransform)),E.specularIntensityMap&&(A.specularIntensityMap.value=E.specularIntensityMap,t(E.specularIntensityMap,A.specularIntensityMapTransform))}l(v,"refreshUniformsPhysical");function b(A,E){E.matcap&&(A.matcap.value=E.matcap)}l(b,"refreshUniformsMatcap");function w(A,E){let I=e.get(E).light;A.referencePosition.value.setFromMatrixPosition(I.matrixWorld),A.nearDistance.value=I.shadow.camera.near,A.farDistance.value=I.shadow.camera.far}return l(w,"refreshUniformsDistance"),{refreshFogUniforms:n,refreshMaterialUniforms:r}}l(UB,"WebGLMaterials");function VB(i,e,t,n){let r={},a={},o=[],s=i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS);function u(I,C){let T=C.program;n.uniformBlockBinding(I,T)}l(u,"bind");function h(I,C){let T=r[I.id];T===void 0&&(b(I),T=d(I),r[I.id]=T,I.addEventListener("dispose",A));let k=C.program;n.updateUBOMapping(I,k);let F=e.render.frame;a[I.id]!==F&&(m(I),a[I.id]=F)}l(h,"update");function d(I){let C=f();I.__bindingPointIndex=C;let T=i.createBuffer(),k=I.__size,F=I.usage;return i.bindBuffer(i.UNIFORM_BUFFER,T),i.bufferData(i.UNIFORM_BUFFER,k,F),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,C,T),T}l(d,"createBuffer");function f(){for(let I=0;I<s;I++)if(o.indexOf(I)===-1)return o.push(I),I;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}l(f,"allocateBindingPointIndex");function m(I){let C=r[I.id],T=I.uniforms,k=I.__cache;i.bindBuffer(i.UNIFORM_BUFFER,C);for(let F=0,B=T.length;F<B;F++){let N=Array.isArray(T[F])?T[F]:[T[F]];for(let z=0,L=N.length;z<L;z++){let j=N[z];if(v(j,F,z,k)===!0){let q=j.__offset,Z=Array.isArray(j.value)?j.value:[j.value],O=0;for(let Y=0;Y<Z.length;Y++){let J=Z[Y],oe=w(J);typeof J=="number"||typeof J=="boolean"?(j.__data[0]=J,i.bufferSubData(i.UNIFORM_BUFFER,q+O,j.__data)):J.isMatrix3?(j.__data[0]=J.elements[0],j.__data[1]=J.elements[1],j.__data[2]=J.elements[2],j.__data[3]=0,j.__data[4]=J.elements[3],j.__data[5]=J.elements[4],j.__data[6]=J.elements[5],j.__data[7]=0,j.__data[8]=J.elements[6],j.__data[9]=J.elements[7],j.__data[10]=J.elements[8],j.__data[11]=0):(J.toArray(j.__data,O),O+=oe.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,q,j.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}l(m,"updateBufferData");function v(I,C,T,k){let F=I.value,B=C+"_"+T;if(k[B]===void 0)return typeof F=="number"||typeof F=="boolean"?k[B]=F:k[B]=F.clone(),!0;{let N=k[B];if(typeof F=="number"||typeof F=="boolean"){if(N!==F)return k[B]=F,!0}else if(N.equals(F)===!1)return N.copy(F),!0}return!1}l(v,"hasUniformChanged");function b(I){let C=I.uniforms,T=0,k=16;for(let B=0,N=C.length;B<N;B++){let z=Array.isArray(C[B])?C[B]:[C[B]];for(let L=0,j=z.length;L<j;L++){let q=z[L],Z=Array.isArray(q.value)?q.value:[q.value];for(let O=0,Y=Z.length;O<Y;O++){let J=Z[O],oe=w(J),$=T%k,K=$%oe.boundary,te=$+K;T+=K,te!==0&&k-te<oe.storage&&(T+=k-te),q.__data=new Float32Array(oe.storage/Float32Array.BYTES_PER_ELEMENT),q.__offset=T,T+=oe.storage}}}let F=T%k;return F>0&&(T+=k-F),I.__size=T,I.__cache={},this}l(b,"prepareUniformsGroup");function w(I){let C={boundary:0,storage:0};return typeof I=="number"||typeof I=="boolean"?(C.boundary=4,C.storage=4):I.isVector2?(C.boundary=8,C.storage=8):I.isVector3||I.isColor?(C.boundary=16,C.storage=12):I.isVector4?(C.boundary=16,C.storage=16):I.isMatrix3?(C.boundary=48,C.storage=48):I.isMatrix4?(C.boundary=64,C.storage=64):I.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",I),C}l(w,"getUniformSize");function A(I){let C=I.target;C.removeEventListener("dispose",A);let T=o.indexOf(C.__bindingPointIndex);o.splice(T,1),i.deleteBuffer(r[C.id]),delete r[C.id],delete a[C.id]}l(A,"onUniformsGroupsDispose");function E(){for(let I in r)i.deleteBuffer(r[I]);o=[],r={},a={}}return l(E,"dispose"),{bind:u,update:h,dispose:E}}l(VB,"WebGLUniformsGroups");var jB=class{constructor(e={}){let{canvas:t=b7(),context:n=null,depth:r=!0,stencil:a=!1,alpha:o=!1,antialias:s=!1,premultipliedAlpha:u=!0,preserveDrawingBuffer:h=!1,powerPreference:d="default",failIfMajorPerformanceCaveat:f=!1,reverseDepthBuffer:m=!1}=e;this.isWebGLRenderer=!0;let v;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");v=n.getContextAttributes().alpha}else v=o;let b=new Uint32Array(4),w=new Int32Array(4),A=null,E=null,I=[],C=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=io,this.toneMapping=Tc,this.toneMappingExposure=1;let T=this,k=!1,F=0,B=0,N=null,z=-1,L=null,j=new jn,q=new jn,Z=null,O=new Mi(0),Y=0,J=t.width,oe=t.height,$=1,K=null,te=null,ve=new jn(0,0,J,oe),Q=new jn(0,0,J,oe),he=!1,se=new H1,Ae=!1,Ie=!1;this.transmissionResolutionScale=1;let we=new qi,Ne=new qi,je=new Ee,Ve=new jn,Le={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0},xe=!1;function Ue(){return N===null?$:1}l(Ue,"getTargetPixelRatio");let de=n;function ut(ue,Pe){return t.getContext(ue,Pe)}l(ut,"getContext");try{let ue={alpha:!0,depth:r,stencil:a,antialias:s,premultipliedAlpha:u,preserveDrawingBuffer:h,powerPreference:d,failIfMajorPerformanceCaveat:f};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r".concat(CP)),t.addEventListener("webglcontextlost",W,!1),t.addEventListener("webglcontextrestored",X,!1),t.addEventListener("webglcontextcreationerror",ae,!1),de===null){let Pe="webgl2";if(de=ut(Pe,ue),de===null)throw ut(Pe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(ue){throw console.error("THREE.WebGLRenderer: "+ue.message),ue}let ot,He,Ke,Lt,_t,pe,re,ke,at,ct,rt,Qe,At,Dt,vt,yt,jt,Wt,Kt,Vt,hi,ui,Zi,Re;function xt(){ot=new oF(de),ot.init(),ui=new FB(de,ot),He=new QN(de,ot,e,ui),Ke=new OB(de,ot),He.reverseDepthBuffer&&m&&Ke.buffers.depth.setReversed(!0),Lt=new uF(de),_t=new CB,pe=new NB(de,ot,Ke,_t,He,ui,Lt),re=new tF(T),ke=new aF(T),at=new ZN(de),Zi=new JN(de,at),ct=new sF(de,at,Lt,Zi),rt=new cF(de,ct,at,Lt),Kt=new hF(de,He,pe),yt=new eF(_t),Qe=new MB(T,re,ke,ot,He,Zi,yt),At=new UB(T,_t),Dt=new IB,vt=new kB(ot),Wt=new YN(T,re,ke,Ke,rt,v,u),jt=new RB(T,rt,He),Re=new VB(de,Lt,He,Ke),Vt=new KN(de,ot,Lt),hi=new lF(de,ot,Lt),Lt.programs=Qe.programs,T.capabilities=He,T.extensions=ot,T.properties=_t,T.renderLists=Dt,T.shadowMap=jt,T.state=Ke,T.info=Lt}l(xt,"initGLContext"),xt();let me=new eme(T,de);this.xr=me,this.getContext=function(){return de},this.getContextAttributes=function(){return de.getContextAttributes()},this.forceContextLoss=function(){let ue=ot.get("WEBGL_lose_context");ue&&ue.loseContext()},this.forceContextRestore=function(){let ue=ot.get("WEBGL_lose_context");ue&&ue.restoreContext()},this.getPixelRatio=function(){return $},this.setPixelRatio=function(ue){ue!==void 0&&($=ue,this.setSize(J,oe,!1))},this.getSize=function(ue){return ue.set(J,oe)},this.setSize=function(ue,Pe,Ze=!0){if(me.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}J=ue,oe=Pe,t.width=Math.floor(ue*$),t.height=Math.floor(Pe*$),Ze===!0&&(t.style.width=ue+"px",t.style.height=Pe+"px"),this.setViewport(0,0,ue,Pe)},this.getDrawingBufferSize=function(ue){return ue.set(J*$,oe*$).floor()},this.setDrawingBufferSize=function(ue,Pe,Ze){J=ue,oe=Pe,$=Ze,t.width=Math.floor(ue*Ze),t.height=Math.floor(Pe*Ze),this.setViewport(0,0,ue,Pe)},this.getCurrentViewport=function(ue){return ue.copy(j)},this.getViewport=function(ue){return ue.copy(ve)},this.setViewport=function(ue,Pe,Ze,Ge){ue.isVector4?ve.set(ue.x,ue.y,ue.z,ue.w):ve.set(ue,Pe,Ze,Ge),Ke.viewport(j.copy(ve).multiplyScalar($).round())},this.getScissor=function(ue){return ue.copy(Q)},this.setScissor=function(ue,Pe,Ze,Ge){ue.isVector4?Q.set(ue.x,ue.y,ue.z,ue.w):Q.set(ue,Pe,Ze,Ge),Ke.scissor(q.copy(Q).multiplyScalar($).round())},this.getScissorTest=function(){return he},this.setScissorTest=function(ue){Ke.setScissorTest(he=ue)},this.setOpaqueSort=function(ue){K=ue},this.setTransparentSort=function(ue){te=ue},this.getClearColor=function(ue){return ue.copy(Wt.getClearColor())},this.setClearColor=function(){Wt.setClearColor.apply(Wt,arguments)},this.getClearAlpha=function(){return Wt.getClearAlpha()},this.setClearAlpha=function(){Wt.setClearAlpha.apply(Wt,arguments)},this.clear=function(ue=!0,Pe=!0,Ze=!0){let Ge=0;if(ue){let Oe=!1;if(N!==null){let pt=N.texture.format;Oe=pt===kP||pt===DP||pt===Vw}if(Oe){let pt=N.texture.type,Ot=pt===vl||pt===Rc||pt===Kv||pt===ng||pt===TP||pt===PP,Ft=Wt.getClearColor(),$t=Wt.getClearAlpha(),si=Ft.r,Ci=Ft.g,xi=Ft.b;Ot?(b[0]=si,b[1]=Ci,b[2]=xi,b[3]=$t,de.clearBufferuiv(de.COLOR,0,b)):(w[0]=si,w[1]=Ci,w[2]=xi,w[3]=$t,de.clearBufferiv(de.COLOR,0,w))}else Ge|=de.COLOR_BUFFER_BIT}Pe&&(Ge|=de.DEPTH_BUFFER_BIT),Ze&&(Ge|=de.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),de.clear(Ge)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",W,!1),t.removeEventListener("webglcontextrestored",X,!1),t.removeEventListener("webglcontextcreationerror",ae,!1),Wt.dispose(),Dt.dispose(),vt.dispose(),_t.dispose(),re.dispose(),ke.dispose(),rt.dispose(),Zi.dispose(),Re.dispose(),Qe.dispose(),me.dispose(),me.removeEventListener("sessionstart",bt),me.removeEventListener("sessionend",Ye),dt.stop()};function W(ue){ue.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),k=!0}l(W,"onContextLost");function X(){console.log("THREE.WebGLRenderer: Context Restored."),k=!1;let ue=Lt.autoReset,Pe=jt.enabled,Ze=jt.autoUpdate,Ge=jt.needsUpdate,Oe=jt.type;xt(),Lt.autoReset=ue,jt.enabled=Pe,jt.autoUpdate=Ze,jt.needsUpdate=Ge,jt.type=Oe}l(X,"onContextRestore");function ae(ue){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ue.statusMessage)}l(ae,"onContextCreationError");function _e(ue){let Pe=ue.target;Pe.removeEventListener("dispose",_e),fe(Pe)}l(_e,"onMaterialDispose");function fe(ue){We(ue),_t.remove(ue)}l(fe,"deallocateMaterial");function We(ue){let Pe=_t.get(ue).programs;Pe!==void 0&&(Pe.forEach(function(Ze){Qe.releaseProgram(Ze)}),ue.isShaderMaterial&&Qe.releaseShaderCache(ue))}l(We,"releaseMaterialProgramReferences"),this.renderBufferDirect=function(ue,Pe,Ze,Ge,Oe,pt){Pe===null&&(Pe=Le);let Ot=Oe.isMesh&&Oe.matrixWorld.determinant()<0,Ft=Ti(ue,Pe,Ze,Ge,Oe);Ke.setMaterial(Ge,Ot);let $t=Ze.index,si=1;if(Ge.wireframe===!0){if($t=ct.getWireframeAttribute(Ze),$t===void 0)return;si=2}let Ci=Ze.drawRange,xi=Ze.attributes.position,ji=Ci.start*si,Xi=(Ci.start+Ci.count)*si;pt!==null&&(ji=Math.max(ji,pt.start*si),Xi=Math.min(Xi,(pt.start+pt.count)*si)),$t!==null?(ji=Math.max(ji,0),Xi=Math.min(Xi,$t.count)):xi!=null&&(ji=Math.max(ji,0),Xi=Math.min(Xi,xi.count));let ci=Xi-ji;if(ci<0||ci===1/0)return;Zi.setup(Oe,Ge,Ft,Ze,$t);let cn,Gi=Vt;if($t!==null&&(cn=at.get($t),Gi=hi,Gi.setIndex(cn)),Oe.isMesh)Ge.wireframe===!0?(Ke.setLineWidth(Ge.wireframeLinewidth*Ue()),Gi.setMode(de.LINES)):Gi.setMode(de.TRIANGLES);else if(Oe.isLine){let fi=Ge.linewidth;fi===void 0&&(fi=1),Ke.setLineWidth(fi*Ue()),Oe.isLineSegments?Gi.setMode(de.LINES):Oe.isLineLoop?Gi.setMode(de.LINE_LOOP):Gi.setMode(de.LINE_STRIP)}else Oe.isPoints?Gi.setMode(de.POINTS):Oe.isSprite&&Gi.setMode(de.TRIANGLES);if(Oe.isBatchedMesh)if(Oe._multiDrawInstances!==null)Gi.renderMultiDrawInstances(Oe._multiDrawStarts,Oe._multiDrawCounts,Oe._multiDrawCount,Oe._multiDrawInstances);else if(ot.get("WEBGL_multi_draw"))Gi.renderMultiDraw(Oe._multiDrawStarts,Oe._multiDrawCounts,Oe._multiDrawCount);else{let fi=Oe._multiDrawStarts,vi=Oe._multiDrawCounts,Li=Oe._multiDrawCount,Tr=$t?at.get($t).bytesPerElement:1,Qn=_t.get(Ge).currentProgram.getUniforms();for(let Gn=0;Gn<Li;Gn++)Qn.setValue(de,"_gl_DrawID",Gn),Gi.render(fi[Gn]/Tr,vi[Gn])}else if(Oe.isInstancedMesh)Gi.renderInstances(ji,ci,Oe.count);else if(Ze.isInstancedBufferGeometry){let fi=Ze._maxInstanceCount!==void 0?Ze._maxInstanceCount:1/0,vi=Math.min(Ze.instanceCount,fi);Gi.renderInstances(ji,ci,vi)}else Gi.render(ji,ci)};function Be(ue,Pe,Ze){ue.transparent===!0&&ue.side===Go&&ue.forceSinglePass===!1?(ue.side=Eo,ue.needsUpdate=!0,Ri(ue,Pe,Ze),ue.side=su,ue.needsUpdate=!0,Ri(ue,Pe,Ze),ue.side=Go):Ri(ue,Pe,Ze)}l(Be,"prepareMaterial"),this.compile=function(ue,Pe,Ze=null){Ze===null&&(Ze=ue),E=vt.get(Ze),E.init(Pe),C.push(E),Ze.traverseVisible(function(Oe){Oe.isLight&&Oe.layers.test(Pe.layers)&&(E.pushLight(Oe),Oe.castShadow&&E.pushShadow(Oe))}),ue!==Ze&&ue.traverseVisible(function(Oe){Oe.isLight&&Oe.layers.test(Pe.layers)&&(E.pushLight(Oe),Oe.castShadow&&E.pushShadow(Oe))}),E.setupLights();let Ge=new Set;return ue.traverse(function(Oe){if(!(Oe.isMesh||Oe.isPoints||Oe.isLine||Oe.isSprite))return;let pt=Oe.material;if(pt)if(Array.isArray(pt))for(let Ot=0;Ot<pt.length;Ot++){let Ft=pt[Ot];Be(Ft,Ze,Oe),Ge.add(Ft)}else Be(pt,Ze,Oe),Ge.add(pt)}),C.pop(),E=null,Ge},this.compileAsync=function(ue,Pe,Ze=null){let Ge=this.compile(ue,Pe,Ze);return new Promise(Oe=>{function pt(){if(Ge.forEach(function(Ot){_t.get(Ot).currentProgram.isReady()&&Ge.delete(Ot)}),Ge.size===0){Oe(ue);return}setTimeout(pt,10)}l(pt,"checkMaterialsReady"),ot.get("KHR_parallel_shader_compile")!==null?pt():setTimeout(pt,10)})};let st=null;function Xe(ue){st&&st(ue)}l(Xe,"onAnimationFrame");function bt(){dt.stop()}l(bt,"onXRSessionStart");function Ye(){dt.start()}l(Ye,"onXRSessionEnd");let dt=new KP;dt.setAnimationLoop(Xe),typeof self<"u"&&dt.setContext(self),this.setAnimationLoop=function(ue){st=ue,me.setAnimationLoop(ue),ue===null?dt.stop():dt.start()},me.addEventListener("sessionstart",bt),me.addEventListener("sessionend",Ye),this.render=function(ue,Pe){if(Pe!==void 0&&Pe.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(k===!0)return;if(ue.matrixWorldAutoUpdate===!0&&ue.updateMatrixWorld(),Pe.parent===null&&Pe.matrixWorldAutoUpdate===!0&&Pe.updateMatrixWorld(),me.enabled===!0&&me.isPresenting===!0&&(me.cameraAutoUpdate===!0&&me.updateCamera(Pe),Pe=me.getCamera()),ue.isScene===!0&&ue.onBeforeRender(T,ue,Pe,N),E=vt.get(ue,C.length),E.init(Pe),C.push(E),Ne.multiplyMatrices(Pe.projectionMatrix,Pe.matrixWorldInverse),se.setFromProjectionMatrix(Ne),Ie=this.localClippingEnabled,Ae=yt.init(this.clippingPlanes,Ie),A=Dt.get(ue,I.length),A.init(),I.push(A),me.enabled===!0&&me.isPresenting===!0){let pt=T.xr.getDepthSensingMesh();pt!==null&&Mt(pt,Pe,-1/0,T.sortObjects)}Mt(ue,Pe,0,T.sortObjects),A.finish(),T.sortObjects===!0&&A.sort(K,te),xe=me.enabled===!1||me.isPresenting===!1||me.hasDepthSensing()===!1,xe&&Wt.addToRenderList(A,ue),this.info.render.frame++,Ae===!0&&yt.beginShadows();let Ze=E.state.shadowsArray;jt.render(Ze,ue,Pe),Ae===!0&&yt.endShadows(),this.info.autoReset===!0&&this.info.reset();let Ge=A.opaque,Oe=A.transmissive;if(E.setupLights(),Pe.isArrayCamera){let pt=Pe.cameras;if(Oe.length>0)for(let Ot=0,Ft=pt.length;Ot<Ft;Ot++){let $t=pt[Ot];ni(Ge,Oe,ue,$t)}xe&&Wt.render(ue);for(let Ot=0,Ft=pt.length;Ot<Ft;Ot++){let $t=pt[Ot];bi(A,ue,$t,$t.viewport)}}else Oe.length>0&&ni(Ge,Oe,ue,Pe),xe&&Wt.render(ue),bi(A,ue,Pe);N!==null&&B===0&&(pe.updateMultisampleRenderTarget(N),pe.updateRenderTargetMipmap(N)),ue.isScene===!0&&ue.onAfterRender(T,ue,Pe),Zi.resetDefaultState(),z=-1,L=null,C.pop(),C.length>0?(E=C[C.length-1],Ae===!0&&yt.setGlobalState(T.clippingPlanes,E.state.camera)):E=null,I.pop(),I.length>0?A=I[I.length-1]:A=null};function Mt(ue,Pe,Ze,Ge){if(ue.visible===!1)return;if(ue.layers.test(Pe.layers)){if(ue.isGroup)Ze=ue.renderOrder;else if(ue.isLOD)ue.autoUpdate===!0&&ue.update(Pe);else if(ue.isLight)E.pushLight(ue),ue.castShadow&&E.pushShadow(ue);else if(ue.isSprite){if(!ue.frustumCulled||se.intersectsSprite(ue)){Ge&&Ve.setFromMatrixPosition(ue.matrixWorld).applyMatrix4(Ne);let pt=rt.update(ue),Ot=ue.material;Ot.visible&&A.push(ue,pt,Ot,Ze,Ve.z,null)}}else if((ue.isMesh||ue.isLine||ue.isPoints)&&(!ue.frustumCulled||se.intersectsObject(ue))){let pt=rt.update(ue),Ot=ue.material;if(Ge&&(ue.boundingSphere!==void 0?(ue.boundingSphere===null&&ue.computeBoundingSphere(),Ve.copy(ue.boundingSphere.center)):(pt.boundingSphere===null&&pt.computeBoundingSphere(),Ve.copy(pt.boundingSphere.center)),Ve.applyMatrix4(ue.matrixWorld).applyMatrix4(Ne)),Array.isArray(Ot)){let Ft=pt.groups;for(let $t=0,si=Ft.length;$t<si;$t++){let Ci=Ft[$t],xi=Ot[Ci.materialIndex];xi&&xi.visible&&A.push(ue,pt,xi,Ze,Ve.z,Ci)}}else Ot.visible&&A.push(ue,pt,Ot,Ze,Ve.z,null)}}let Oe=ue.children;for(let pt=0,Ot=Oe.length;pt<Ot;pt++)Mt(Oe[pt],Pe,Ze,Ge)}l(Mt,"projectObject");function bi(ue,Pe,Ze,Ge){let Oe=ue.opaque,pt=ue.transmissive,Ot=ue.transparent;E.setupLightsView(Ze),Ae===!0&&yt.setGlobalState(T.clippingPlanes,Ze),Ge&&Ke.viewport(j.copy(Ge)),Oe.length>0&&Ii(Oe,Pe,Ze),pt.length>0&&Ii(pt,Pe,Ze),Ot.length>0&&Ii(Ot,Pe,Ze),Ke.buffers.depth.setTest(!0),Ke.buffers.depth.setMask(!0),Ke.buffers.color.setMask(!0),Ke.setPolygonOffset(!1)}l(bi,"renderScene");function ni(ue,Pe,Ze,Ge){if((Ze.isScene===!0?Ze.overrideMaterial:null)!==null)return;E.state.transmissionRenderTarget[Ge.id]===void 0&&(E.state.transmissionRenderTarget[Ge.id]=new Oc(1,1,{generateMipmaps:!0,type:ot.has("EXT_color_buffer_half_float")||ot.has("EXT_color_buffer_float")?G1:vl,minFilter:Yp,samples:4,stencilBuffer:a,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:kn.workingColorSpace}));let Oe=E.state.transmissionRenderTarget[Ge.id],pt=Ge.viewport||j;Oe.setSize(pt.z*T.transmissionResolutionScale,pt.w*T.transmissionResolutionScale);let Ot=T.getRenderTarget();T.setRenderTarget(Oe),T.getClearColor(O),Y=T.getClearAlpha(),Y<1&&T.setClearColor(16777215,.5),T.clear(),xe&&Wt.render(Ze);let Ft=T.toneMapping;T.toneMapping=Tc;let $t=Ge.viewport;if(Ge.viewport!==void 0&&(Ge.viewport=void 0),E.setupLightsView(Ge),Ae===!0&&yt.setGlobalState(T.clippingPlanes,Ge),Ii(ue,Ze,Ge),pe.updateMultisampleRenderTarget(Oe),pe.updateRenderTargetMipmap(Oe),ot.has("WEBGL_multisampled_render_to_texture")===!1){let si=!1;for(let Ci=0,xi=Pe.length;Ci<xi;Ci++){let ji=Pe[Ci],Xi=ji.object,ci=ji.geometry,cn=ji.material,Gi=ji.group;if(cn.side===Go&&Xi.layers.test(Ge.layers)){let fi=cn.side;cn.side=Eo,cn.needsUpdate=!0,Nt(Xi,Ze,Ge,ci,cn,Gi),cn.side=fi,cn.needsUpdate=!0,si=!0}}si===!0&&(pe.updateMultisampleRenderTarget(Oe),pe.updateRenderTargetMipmap(Oe))}T.setRenderTarget(Ot),T.setClearColor(O,Y),$t!==void 0&&(Ge.viewport=$t),T.toneMapping=Ft}l(ni,"renderTransmissionPass");function Ii(ue,Pe,Ze){let Ge=Pe.isScene===!0?Pe.overrideMaterial:null;for(let Oe=0,pt=ue.length;Oe<pt;Oe++){let Ot=ue[Oe],Ft=Ot.object,$t=Ot.geometry,si=Ge===null?Ot.material:Ge,Ci=Ot.group;Ft.layers.test(Ze.layers)&&Nt(Ft,Pe,Ze,$t,si,Ci)}}l(Ii,"renderObjects");function Nt(ue,Pe,Ze,Ge,Oe,pt){ue.onBeforeRender(T,Pe,Ze,Ge,Oe,pt),ue.modelViewMatrix.multiplyMatrices(Ze.matrixWorldInverse,ue.matrixWorld),ue.normalMatrix.getNormalMatrix(ue.modelViewMatrix),Oe.onBeforeRender(T,Pe,Ze,Ge,ue,pt),Oe.transparent===!0&&Oe.side===Go&&Oe.forceSinglePass===!1?(Oe.side=Eo,Oe.needsUpdate=!0,T.renderBufferDirect(Ze,Pe,Ge,Oe,ue,pt),Oe.side=su,Oe.needsUpdate=!0,T.renderBufferDirect(Ze,Pe,Ge,Oe,ue,pt),Oe.side=Go):T.renderBufferDirect(Ze,Pe,Ge,Oe,ue,pt),ue.onAfterRender(T,Pe,Ze,Ge,Oe,pt)}l(Nt,"renderObject");function Ri(ue,Pe,Ze){Pe.isScene!==!0&&(Pe=Le);let Ge=_t.get(ue),Oe=E.state.lights,pt=E.state.shadowsArray,Ot=Oe.state.version,Ft=Qe.getParameters(ue,Oe.state,pt,Pe,Ze),$t=Qe.getProgramCacheKey(Ft),si=Ge.programs;Ge.environment=ue.isMeshStandardMaterial?Pe.environment:null,Ge.fog=Pe.fog,Ge.envMap=(ue.isMeshStandardMaterial?ke:re).get(ue.envMap||Ge.environment),Ge.envMapRotation=Ge.environment!==null&&ue.envMap===null?Pe.environmentRotation:ue.envMapRotation,si===void 0&&(ue.addEventListener("dispose",_e),si=new Map,Ge.programs=si);let Ci=si.get($t);if(Ci!==void 0){if(Ge.currentProgram===Ci&&Ge.lightsStateVersion===Ot)return Vi(ue,Ft),Ci}else Ft.uniforms=Qe.getUniforms(ue),ue.onBeforeCompile(Ft,T),Ci=Qe.acquireProgram(Ft,$t),si.set($t,Ci),Ge.uniforms=Ft.uniforms;let xi=Ge.uniforms;return(!ue.isShaderMaterial&&!ue.isRawShaderMaterial||ue.clipping===!0)&&(xi.clippingPlanes=yt.uniform),Vi(ue,Ft),Ge.needsLights=hn(ue),Ge.lightsStateVersion=Ot,Ge.needsLights&&(xi.ambientLightColor.value=Oe.state.ambient,xi.lightProbe.value=Oe.state.probe,xi.directionalLights.value=Oe.state.directional,xi.directionalLightShadows.value=Oe.state.directionalShadow,xi.spotLights.value=Oe.state.spot,xi.spotLightShadows.value=Oe.state.spotShadow,xi.rectAreaLights.value=Oe.state.rectArea,xi.ltc_1.value=Oe.state.rectAreaLTC1,xi.ltc_2.value=Oe.state.rectAreaLTC2,xi.pointLights.value=Oe.state.point,xi.pointLightShadows.value=Oe.state.pointShadow,xi.hemisphereLights.value=Oe.state.hemi,xi.directionalShadowMap.value=Oe.state.directionalShadowMap,xi.directionalShadowMatrix.value=Oe.state.directionalShadowMatrix,xi.spotShadowMap.value=Oe.state.spotShadowMap,xi.spotLightMatrix.value=Oe.state.spotLightMatrix,xi.spotLightMap.value=Oe.state.spotLightMap,xi.pointShadowMap.value=Oe.state.pointShadowMap,xi.pointShadowMatrix.value=Oe.state.pointShadowMatrix),Ge.currentProgram=Ci,Ge.uniformsList=null,Ci}l(Ri,"getProgram");function Ki(ue){if(ue.uniformsList===null){let Pe=ue.currentProgram.getUniforms();ue.uniformsList=Y_.seqWithValue(Pe.seq,ue.uniforms)}return ue.uniformsList}l(Ki,"getUniformList");function Vi(ue,Pe){let Ze=_t.get(ue);Ze.outputColorSpace=Pe.outputColorSpace,Ze.batching=Pe.batching,Ze.batchingColor=Pe.batchingColor,Ze.instancing=Pe.instancing,Ze.instancingColor=Pe.instancingColor,Ze.instancingMorph=Pe.instancingMorph,Ze.skinning=Pe.skinning,Ze.morphTargets=Pe.morphTargets,Ze.morphNormals=Pe.morphNormals,Ze.morphColors=Pe.morphColors,Ze.morphTargetsCount=Pe.morphTargetsCount,Ze.numClippingPlanes=Pe.numClippingPlanes,Ze.numIntersection=Pe.numClipIntersection,Ze.vertexAlphas=Pe.vertexAlphas,Ze.vertexTangents=Pe.vertexTangents,Ze.toneMapping=Pe.toneMapping}l(Vi,"updateCommonMaterialProperties");function Ti(ue,Pe,Ze,Ge,Oe){Pe.isScene!==!0&&(Pe=Le),pe.resetTextureUnits();let pt=Pe.fog,Ot=Ge.isMeshStandardMaterial?Pe.environment:null,Ft=N===null?T.outputColorSpace:N.isXRRenderTarget===!0?N.texture.colorSpace:pd,$t=(Ge.isMeshStandardMaterial?ke:re).get(Ge.envMap||Ot),si=Ge.vertexColors===!0&&!!Ze.attributes.color&&Ze.attributes.color.itemSize===4,Ci=!!Ze.attributes.tangent&&(!!Ge.normalMap||Ge.anisotropy>0),xi=!!Ze.morphAttributes.position,ji=!!Ze.morphAttributes.normal,Xi=!!Ze.morphAttributes.color,ci=Tc;Ge.toneMapped&&(N===null||N.isXRRenderTarget===!0)&&(ci=T.toneMapping);let cn=Ze.morphAttributes.position||Ze.morphAttributes.normal||Ze.morphAttributes.color,Gi=cn!==void 0?cn.length:0,fi=_t.get(Ge),vi=E.state.lights;if(Ae===!0&&(Ie===!0||ue!==L)){let V=ue===L&&Ge.id===z;yt.setState(Ge,ue,V)}let Li=!1;Ge.version===fi.__version?(fi.needsLights&&fi.lightsStateVersion!==vi.state.version||fi.outputColorSpace!==Ft||Oe.isBatchedMesh&&fi.batching===!1||!Oe.isBatchedMesh&&fi.batching===!0||Oe.isBatchedMesh&&fi.batchingColor===!0&&Oe.colorTexture===null||Oe.isBatchedMesh&&fi.batchingColor===!1&&Oe.colorTexture!==null||Oe.isInstancedMesh&&fi.instancing===!1||!Oe.isInstancedMesh&&fi.instancing===!0||Oe.isSkinnedMesh&&fi.skinning===!1||!Oe.isSkinnedMesh&&fi.skinning===!0||Oe.isInstancedMesh&&fi.instancingColor===!0&&Oe.instanceColor===null||Oe.isInstancedMesh&&fi.instancingColor===!1&&Oe.instanceColor!==null||Oe.isInstancedMesh&&fi.instancingMorph===!0&&Oe.morphTexture===null||Oe.isInstancedMesh&&fi.instancingMorph===!1&&Oe.morphTexture!==null||fi.envMap!==$t||Ge.fog===!0&&fi.fog!==pt||fi.numClippingPlanes!==void 0&&(fi.numClippingPlanes!==yt.numPlanes||fi.numIntersection!==yt.numIntersection)||fi.vertexAlphas!==si||fi.vertexTangents!==Ci||fi.morphTargets!==xi||fi.morphNormals!==ji||fi.morphColors!==Xi||fi.toneMapping!==ci||fi.morphTargetsCount!==Gi)&&(Li=!0):(Li=!0,fi.__version=Ge.version);let Tr=fi.currentProgram;Li===!0&&(Tr=Ri(Ge,Pe,Oe));let Qn=!1,Gn=!1,_i=!1,x=Tr.getUniforms(),M=fi.uniforms;if(Ke.useProgram(Tr.program)&&(Qn=!0,Gn=!0,_i=!0),Ge.id!==z&&(z=Ge.id,Gn=!0),Qn||L!==ue){Ke.buffers.depth.getReversed()?(we.copy(ue.projectionMatrix),A7(we),S7(we),x.setValue(de,"projectionMatrix",we)):x.setValue(de,"projectionMatrix",ue.projectionMatrix),x.setValue(de,"viewMatrix",ue.matrixWorldInverse);let V=x.map.cameraPosition;V!==void 0&&V.setValue(de,je.setFromMatrixPosition(ue.matrixWorld)),He.logarithmicDepthBuffer&&x.setValue(de,"logDepthBufFC",2/(Math.log(ue.far+1)/Math.LN2)),(Ge.isMeshPhongMaterial||Ge.isMeshToonMaterial||Ge.isMeshLambertMaterial||Ge.isMeshBasicMaterial||Ge.isMeshStandardMaterial||Ge.isShaderMaterial)&&x.setValue(de,"isOrthographic",ue.isOrthographicCamera===!0),L!==ue&&(L=ue,Gn=!0,_i=!0)}if(Oe.isSkinnedMesh){x.setOptional(de,Oe,"bindMatrix"),x.setOptional(de,Oe,"bindMatrixInverse");let V=Oe.skeleton;V&&(V.boneTexture===null&&V.computeBoneTexture(),x.setValue(de,"boneTexture",V.boneTexture,pe))}Oe.isBatchedMesh&&(x.setOptional(de,Oe,"batchingTexture"),x.setValue(de,"batchingTexture",Oe._matricesTexture,pe),x.setOptional(de,Oe,"batchingIdTexture"),x.setValue(de,"batchingIdTexture",Oe._indirectTexture,pe),x.setOptional(de,Oe,"batchingColorTexture"),Oe._colorsTexture!==null&&x.setValue(de,"batchingColorTexture",Oe._colorsTexture,pe));let P=Ze.morphAttributes;if((P.position!==void 0||P.normal!==void 0||P.color!==void 0)&&Kt.update(Oe,Ze,Tr),(Gn||fi.receiveShadow!==Oe.receiveShadow)&&(fi.receiveShadow=Oe.receiveShadow,x.setValue(de,"receiveShadow",Oe.receiveShadow)),Ge.isMeshGouraudMaterial&&Ge.envMap!==null&&(M.envMap.value=$t,M.flipEnvMap.value=$t.isCubeTexture&&$t.isRenderTargetTexture===!1?-1:1),Ge.isMeshStandardMaterial&&Ge.envMap===null&&Pe.environment!==null&&(M.envMapIntensity.value=Pe.environmentIntensity),Gn&&(x.setValue(de,"toneMappingExposure",T.toneMappingExposure),fi.needsLights&&yn(M,_i),pt&&Ge.fog===!0&&At.refreshFogUniforms(M,pt),At.refreshMaterialUniforms(M,Ge,$,oe,E.state.transmissionRenderTarget[ue.id]),Y_.upload(de,Ki(fi),M,pe)),Ge.isShaderMaterial&&Ge.uniformsNeedUpdate===!0&&(Y_.upload(de,Ki(fi),M,pe),Ge.uniformsNeedUpdate=!1),Ge.isSpriteMaterial&&x.setValue(de,"center",Oe.center),x.setValue(de,"modelViewMatrix",Oe.modelViewMatrix),x.setValue(de,"normalMatrix",Oe.normalMatrix),x.setValue(de,"modelMatrix",Oe.matrixWorld),Ge.isShaderMaterial||Ge.isRawShaderMaterial){let V=Ge.uniformsGroups;for(let H=0,ne=V.length;H<ne;H++){let le=V[H];Re.update(le,Tr),Re.bind(le,Tr)}}return Tr}l(Ti,"setProgram");function yn(ue,Pe){ue.ambientLightColor.needsUpdate=Pe,ue.lightProbe.needsUpdate=Pe,ue.directionalLights.needsUpdate=Pe,ue.directionalLightShadows.needsUpdate=Pe,ue.pointLights.needsUpdate=Pe,ue.pointLightShadows.needsUpdate=Pe,ue.spotLights.needsUpdate=Pe,ue.spotLightShadows.needsUpdate=Pe,ue.rectAreaLights.needsUpdate=Pe,ue.hemisphereLights.needsUpdate=Pe}l(yn,"markUniformsLightsNeedsUpdate");function hn(ue){return ue.isMeshLambertMaterial||ue.isMeshToonMaterial||ue.isMeshPhongMaterial||ue.isMeshStandardMaterial||ue.isShadowMaterial||ue.isShaderMaterial&&ue.lights===!0}l(hn,"materialNeedsLights"),this.getActiveCubeFace=function(){return F},this.getActiveMipmapLevel=function(){return B},this.getRenderTarget=function(){return N},this.setRenderTargetTextures=function(ue,Pe,Ze){_t.get(ue.texture).__webglTexture=Pe,_t.get(ue.depthTexture).__webglTexture=Ze;let Ge=_t.get(ue);Ge.__hasExternalTextures=!0,Ge.__autoAllocateDepthBuffer=Ze===void 0,Ge.__autoAllocateDepthBuffer||ot.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Ge.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(ue,Pe){let Ze=_t.get(ue);Ze.__webglFramebuffer=Pe,Ze.__useDefaultFramebuffer=Pe===void 0};let An=de.createFramebuffer();this.setRenderTarget=function(ue,Pe=0,Ze=0){N=ue,F=Pe,B=Ze;let Ge=!0,Oe=null,pt=!1,Ot=!1;if(ue){let Ft=_t.get(ue);if(Ft.__useDefaultFramebuffer!==void 0)Ke.bindFramebuffer(de.FRAMEBUFFER,null),Ge=!1;else if(Ft.__webglFramebuffer===void 0)pe.setupRenderTarget(ue);else if(Ft.__hasExternalTextures)pe.rebindTextures(ue,_t.get(ue.texture).__webglTexture,_t.get(ue.depthTexture).__webglTexture);else if(ue.depthBuffer){let Ci=ue.depthTexture;if(Ft.__boundDepthTexture!==Ci){if(Ci!==null&&_t.has(Ci)&&(ue.width!==Ci.image.width||ue.height!==Ci.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");pe.setupDepthRenderbuffer(ue)}}let $t=ue.texture;($t.isData3DTexture||$t.isDataArrayTexture||$t.isCompressedArrayTexture)&&(Ot=!0);let si=_t.get(ue).__webglFramebuffer;ue.isWebGLCubeRenderTarget?(Array.isArray(si[Pe])?Oe=si[Pe][Ze]:Oe=si[Pe],pt=!0):ue.samples>0&&pe.useMultisampledRTT(ue)===!1?Oe=_t.get(ue).__webglMultisampledFramebuffer:Array.isArray(si)?Oe=si[Ze]:Oe=si,j.copy(ue.viewport),q.copy(ue.scissor),Z=ue.scissorTest}else j.copy(ve).multiplyScalar($).floor(),q.copy(Q).multiplyScalar($).floor(),Z=he;if(Ze!==0&&(Oe=An),Ke.bindFramebuffer(de.FRAMEBUFFER,Oe)&&Ge&&Ke.drawBuffers(ue,Oe),Ke.viewport(j),Ke.scissor(q),Ke.setScissorTest(Z),pt){let Ft=_t.get(ue.texture);de.framebufferTexture2D(de.FRAMEBUFFER,de.COLOR_ATTACHMENT0,de.TEXTURE_CUBE_MAP_POSITIVE_X+Pe,Ft.__webglTexture,Ze)}else if(Ot){let Ft=_t.get(ue.texture),$t=Pe;de.framebufferTextureLayer(de.FRAMEBUFFER,de.COLOR_ATTACHMENT0,Ft.__webglTexture,Ze,$t)}else if(ue!==null&&Ze!==0){let Ft=_t.get(ue.texture);de.framebufferTexture2D(de.FRAMEBUFFER,de.COLOR_ATTACHMENT0,de.TEXTURE_2D,Ft.__webglTexture,Ze)}z=-1},this.readRenderTargetPixels=function(ue,Pe,Ze,Ge,Oe,pt,Ot){if(!(ue&&ue.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Ft=_t.get(ue).__webglFramebuffer;if(ue.isWebGLCubeRenderTarget&&Ot!==void 0&&(Ft=Ft[Ot]),Ft){Ke.bindFramebuffer(de.FRAMEBUFFER,Ft);try{let $t=ue.texture,si=$t.format,Ci=$t.type;if(!He.textureFormatReadable(si)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!He.textureTypeReadable(Ci)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Pe>=0&&Pe<=ue.width-Ge&&Ze>=0&&Ze<=ue.height-Oe&&de.readPixels(Pe,Ze,Ge,Oe,ui.convert(si),ui.convert(Ci),pt)}finally{let $t=N!==null?_t.get(N).__webglFramebuffer:null;Ke.bindFramebuffer(de.FRAMEBUFFER,$t)}}},this.readRenderTargetPixelsAsync=async function(ue,Pe,Ze,Ge,Oe,pt,Ot){if(!(ue&&ue.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Ft=_t.get(ue).__webglFramebuffer;if(ue.isWebGLCubeRenderTarget&&Ot!==void 0&&(Ft=Ft[Ot]),Ft){let $t=ue.texture,si=$t.format,Ci=$t.type;if(!He.textureFormatReadable(si))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!He.textureTypeReadable(Ci))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(Pe>=0&&Pe<=ue.width-Ge&&Ze>=0&&Ze<=ue.height-Oe){Ke.bindFramebuffer(de.FRAMEBUFFER,Ft);let xi=de.createBuffer();de.bindBuffer(de.PIXEL_PACK_BUFFER,xi),de.bufferData(de.PIXEL_PACK_BUFFER,pt.byteLength,de.STREAM_READ),de.readPixels(Pe,Ze,Ge,Oe,ui.convert(si),ui.convert(Ci),0);let ji=N!==null?_t.get(N).__webglFramebuffer:null;Ke.bindFramebuffer(de.FRAMEBUFFER,ji);let Xi=de.fenceSync(de.SYNC_GPU_COMMANDS_COMPLETE,0);return de.flush(),await w7(de,Xi,4),de.bindBuffer(de.PIXEL_PACK_BUFFER,xi),de.getBufferSubData(de.PIXEL_PACK_BUFFER,0,pt),de.deleteBuffer(xi),de.deleteSync(Xi),pt}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(ue,Pe=null,Ze=0){ue.isTexture!==!0&&(Bp("WebGLRenderer: copyFramebufferToTexture function signature has changed."),Pe=arguments[0]||null,ue=arguments[1]);let Ge=Math.pow(2,-Ze),Oe=Math.floor(ue.image.width*Ge),pt=Math.floor(ue.image.height*Ge),Ot=Pe!==null?Pe.x:0,Ft=Pe!==null?Pe.y:0;pe.setTexture2D(ue,0),de.copyTexSubImage2D(de.TEXTURE_2D,Ze,0,0,Ot,Ft,Oe,pt),Ke.unbindTexture()};let gn=de.createFramebuffer(),nr=de.createFramebuffer();this.copyTextureToTexture=function(ue,Pe,Ze=null,Ge=null,Oe=0,pt=null){ue.isTexture!==!0&&(Bp("WebGLRenderer: copyTextureToTexture function signature has changed."),Ge=arguments[0]||null,ue=arguments[1],Pe=arguments[2],pt=arguments[3]||0,Ze=null),pt===null&&(Oe!==0?(Bp("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),pt=Oe,Oe=0):pt=0);let Ot,Ft,$t,si,Ci,xi,ji,Xi,ci,cn=ue.isCompressedTexture?ue.mipmaps[pt]:ue.image;if(Ze!==null)Ot=Ze.max.x-Ze.min.x,Ft=Ze.max.y-Ze.min.y,$t=Ze.isBox3?Ze.max.z-Ze.min.z:1,si=Ze.min.x,Ci=Ze.min.y,xi=Ze.isBox3?Ze.min.z:0;else{let P=Math.pow(2,-Oe);Ot=Math.floor(cn.width*P),Ft=Math.floor(cn.height*P),ue.isDataArrayTexture?$t=cn.depth:ue.isData3DTexture?$t=Math.floor(cn.depth*P):$t=1,si=0,Ci=0,xi=0}Ge!==null?(ji=Ge.x,Xi=Ge.y,ci=Ge.z):(ji=0,Xi=0,ci=0);let Gi=ui.convert(Pe.format),fi=ui.convert(Pe.type),vi;Pe.isData3DTexture?(pe.setTexture3D(Pe,0),vi=de.TEXTURE_3D):Pe.isDataArrayTexture||Pe.isCompressedArrayTexture?(pe.setTexture2DArray(Pe,0),vi=de.TEXTURE_2D_ARRAY):(pe.setTexture2D(Pe,0),vi=de.TEXTURE_2D),de.pixelStorei(de.UNPACK_FLIP_Y_WEBGL,Pe.flipY),de.pixelStorei(de.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Pe.premultiplyAlpha),de.pixelStorei(de.UNPACK_ALIGNMENT,Pe.unpackAlignment);let Li=de.getParameter(de.UNPACK_ROW_LENGTH),Tr=de.getParameter(de.UNPACK_IMAGE_HEIGHT),Qn=de.getParameter(de.UNPACK_SKIP_PIXELS),Gn=de.getParameter(de.UNPACK_SKIP_ROWS),_i=de.getParameter(de.UNPACK_SKIP_IMAGES);de.pixelStorei(de.UNPACK_ROW_LENGTH,cn.width),de.pixelStorei(de.UNPACK_IMAGE_HEIGHT,cn.height),de.pixelStorei(de.UNPACK_SKIP_PIXELS,si),de.pixelStorei(de.UNPACK_SKIP_ROWS,Ci),de.pixelStorei(de.UNPACK_SKIP_IMAGES,xi);let x=ue.isDataArrayTexture||ue.isData3DTexture,M=Pe.isDataArrayTexture||Pe.isData3DTexture;if(ue.isDepthTexture){let P=_t.get(ue),V=_t.get(Pe),H=_t.get(P.__renderTarget),ne=_t.get(V.__renderTarget);Ke.bindFramebuffer(de.READ_FRAMEBUFFER,H.__webglFramebuffer),Ke.bindFramebuffer(de.DRAW_FRAMEBUFFER,ne.__webglFramebuffer);for(let le=0;le<$t;le++)x&&(de.framebufferTextureLayer(de.READ_FRAMEBUFFER,de.COLOR_ATTACHMENT0,_t.get(ue).__webglTexture,Oe,xi+le),de.framebufferTextureLayer(de.DRAW_FRAMEBUFFER,de.COLOR_ATTACHMENT0,_t.get(Pe).__webglTexture,pt,ci+le)),de.blitFramebuffer(si,Ci,Ot,Ft,ji,Xi,Ot,Ft,de.DEPTH_BUFFER_BIT,de.NEAREST);Ke.bindFramebuffer(de.READ_FRAMEBUFFER,null),Ke.bindFramebuffer(de.DRAW_FRAMEBUFFER,null)}else if(Oe!==0||ue.isRenderTargetTexture||_t.has(ue)){let P=_t.get(ue),V=_t.get(Pe);Ke.bindFramebuffer(de.READ_FRAMEBUFFER,gn),Ke.bindFramebuffer(de.DRAW_FRAMEBUFFER,nr);for(let H=0;H<$t;H++)x?de.framebufferTextureLayer(de.READ_FRAMEBUFFER,de.COLOR_ATTACHMENT0,P.__webglTexture,Oe,xi+H):de.framebufferTexture2D(de.READ_FRAMEBUFFER,de.COLOR_ATTACHMENT0,de.TEXTURE_2D,P.__webglTexture,Oe),M?de.framebufferTextureLayer(de.DRAW_FRAMEBUFFER,de.COLOR_ATTACHMENT0,V.__webglTexture,pt,ci+H):de.framebufferTexture2D(de.DRAW_FRAMEBUFFER,de.COLOR_ATTACHMENT0,de.TEXTURE_2D,V.__webglTexture,pt),Oe!==0?de.blitFramebuffer(si,Ci,Ot,Ft,ji,Xi,Ot,Ft,de.COLOR_BUFFER_BIT,de.NEAREST):M?de.copyTexSubImage3D(vi,pt,ji,Xi,ci+H,si,Ci,Ot,Ft):de.copyTexSubImage2D(vi,pt,ji,Xi,si,Ci,Ot,Ft);Ke.bindFramebuffer(de.READ_FRAMEBUFFER,null),Ke.bindFramebuffer(de.DRAW_FRAMEBUFFER,null)}else M?ue.isDataTexture||ue.isData3DTexture?de.texSubImage3D(vi,pt,ji,Xi,ci,Ot,Ft,$t,Gi,fi,cn.data):Pe.isCompressedArrayTexture?de.compressedTexSubImage3D(vi,pt,ji,Xi,ci,Ot,Ft,$t,Gi,cn.data):de.texSubImage3D(vi,pt,ji,Xi,ci,Ot,Ft,$t,Gi,fi,cn):ue.isDataTexture?de.texSubImage2D(de.TEXTURE_2D,pt,ji,Xi,Ot,Ft,Gi,fi,cn.data):ue.isCompressedTexture?de.compressedTexSubImage2D(de.TEXTURE_2D,pt,ji,Xi,cn.width,cn.height,Gi,cn.data):de.texSubImage2D(de.TEXTURE_2D,pt,ji,Xi,Ot,Ft,Gi,fi,cn);de.pixelStorei(de.UNPACK_ROW_LENGTH,Li),de.pixelStorei(de.UNPACK_IMAGE_HEIGHT,Tr),de.pixelStorei(de.UNPACK_SKIP_PIXELS,Qn),de.pixelStorei(de.UNPACK_SKIP_ROWS,Gn),de.pixelStorei(de.UNPACK_SKIP_IMAGES,_i),pt===0&&Pe.generateMipmaps&&de.generateMipmap(vi),Ke.unbindTexture()},this.copyTextureToTexture3D=function(ue,Pe,Ze=null,Ge=null,Oe=0){return ue.isTexture!==!0&&(Bp("WebGLRenderer: copyTextureToTexture3D function signature has changed."),Ze=arguments[0]||null,Ge=arguments[1]||null,ue=arguments[2],Pe=arguments[3],Oe=arguments[4]||0),Bp('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(ue,Pe,Ze,Ge,Oe)},this.initRenderTarget=function(ue){_t.get(ue).__webglFramebuffer===void 0&&pe.setupRenderTarget(ue)},this.initTexture=function(ue){ue.isCubeTexture?pe.setTextureCube(ue,0):ue.isData3DTexture?pe.setTexture3D(ue,0):ue.isDataArrayTexture||ue.isCompressedArrayTexture?pe.setTexture2DArray(ue,0):pe.setTexture2D(ue,0),Ke.unbindTexture()},this.resetState=function(){F=0,B=0,N=null,Ke.reset(),Zi.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return lh}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;let t=this.getContext();t.drawingBufferColorspace=kn._getDrawingBufferColorSpace(e),t.unpackColorSpace=kn._getUnpackColorSpace()}};l(jB,"WebGLRenderer");var ime=jB;R();function Id(i,e=!1){let t=i[0].index!==null,n=new Set(Object.keys(i[0].attributes)),r=new Set(Object.keys(i[0].morphAttributes)),a={},o={},s=i[0].morphTargetsRelative,u=new Sa,h=0;for(let d=0;d<i.length;++d){let f=i[d],m=0;if(t!==(f.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let v in f.attributes){if(!n.has(v))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+'. All geometries must have compatible attributes; make sure "'+v+'" attribute exists among all geometries, or in none of them.'),null;a[v]===void 0&&(a[v]=[]),a[v].push(f.attributes[v]),m++}if(m!==n.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+". Make sure all geometries have the same number of attributes."),null;if(s!==f.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let v in f.morphAttributes){if(!r.has(v))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+".  .morphAttributes must be consistent throughout all geometries."),null;o[v]===void 0&&(o[v]=[]),o[v].push(f.morphAttributes[v])}if(e){let v;if(t)v=f.index.count;else if(f.attributes.position!==void 0)v=f.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+". The geometry must have either an index or a position attribute"),null;u.addGroup(h,v,d),h+=v}}if(t){let d=0,f=[];for(let m=0;m<i.length;++m){let v=i[m].index;for(let b=0;b<v.count;++b)f.push(v.getX(b)+d);d+=i[m].attributes.position.count}u.setIndex(f)}for(let d in a){let f=WC(a[d]);if(!f)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+d+" attribute."),null;u.setAttribute(d,f)}for(let d in o){let f=o[d][0].length;if(f===0)break;u.morphAttributes=u.morphAttributes||{},u.morphAttributes[d]=[];for(let m=0;m<f;++m){let v=[];for(let w=0;w<o[d].length;++w)v.push(o[d][w][m]);let b=WC(v);if(!b)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+d+" morphAttribute."),null;u.morphAttributes[d].push(b)}}return u}l(Id,"mergeGeometries");function WC(i){let e,t,n,r=-1,a=0;for(let h=0;h<i.length;++h){let d=i[h];if(e===void 0&&(e=d.array.constructor),e!==d.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(t===void 0&&(t=d.itemSize),t!==d.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(n===void 0&&(n=d.normalized),n!==d.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(r===-1&&(r=d.gpuType),r!==d.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;a+=d.count*t}let o=new e(a),s=new gr(o,t,n),u=0;for(let h=0;h<i.length;++h){let d=i[h];if(d.isInterleavedBufferAttribute){let f=u/t;for(let m=0,v=d.count;m<v;m++)for(let b=0;b<t;b++){let w=d.getComponent(m,b);s.setComponent(m+f,b,w)}}else o.set(d.array,u);u+=d.count*t}return r!==void 0&&(s.gpuType=r),s}l(WC,"mergeAttributes");function nme(i,e){if(e===Lhe)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),i;if(e===O6||e===Dhe){let t=i.getIndex();if(t===null){let o=[],s=i.getAttribute("position");if(s!==void 0){for(let u=0;u<s.count;u++)o.push(u);i.setIndex(o),t=i.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i}let n=t.count-2,r=[];if(e===O6)for(let o=1;o<=n;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<n;o++)o%2===0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let a=i.clone();return a.setIndex(r),a.clearGroups(),a}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),i}l(nme,"toTrianglesDrawMode");var GB=Et((i,e)=>{R(),function(t,n){typeof i=="object"&&typeof e<"u"?e.exports=n():typeof define=="function"&&define.amd?define(n):(t=t||self,t.TinyQueue=n())}(i,function(){var t=l(function(r,a){if(r===void 0&&(r=[]),a===void 0&&(a=n),this.data=r,this.length=this.data.length,this.compare=a,this.length>0)for(var o=(this.length>>1)-1;o>=0;o--)this._down(o)},"TinyQueue");t.prototype.push=l(function(r){this.data.push(r),this.length++,this._up(this.length-1)},"push"),t.prototype.pop=l(function(){if(this.length!==0){var r=this.data[0],a=this.data.pop();return this.length--,this.length>0&&(this.data[0]=a,this._down(0)),r}},"pop"),t.prototype.peek=l(function(){return this.data[0]},"peek"),t.prototype._up=l(function(r){for(var a=this,o=a.data,s=a.compare,u=o[r];r>0;){var h=r-1>>1,d=o[h];if(s(u,d)>=0)break;o[r]=d,r=h}o[r]=u},"_up"),t.prototype._down=l(function(r){for(var a=this,o=a.data,s=a.compare,u=this.length>>1,h=o[r];r<u;){var d=(r<<1)+1,f=o[d],m=d+1;if(m<this.length&&s(o[m],f)<0&&(d=m,f=o[m]),s(f,h)>=0)break;o[r]=f,r=d}o[r]=h},"_down");function n(r,a){return r<a?-1:r>a?1:0}return l(n,"defaultCompare"),t})}),Rn=Et((i,e)=>{R(),e.exports=t;function t(n,r){this.x=n,this.y=r}l(t,"Point"),t.prototype={clone:l(function(){return new t(this.x,this.y)},"clone"),add:l(function(n){return this.clone()._add(n)},"add"),sub:l(function(n){return this.clone()._sub(n)},"sub"),multByPoint:l(function(n){return this.clone()._multByPoint(n)},"multByPoint"),divByPoint:l(function(n){return this.clone()._divByPoint(n)},"divByPoint"),mult:l(function(n){return this.clone()._mult(n)},"mult"),div:l(function(n){return this.clone()._div(n)},"div"),rotate:l(function(n){return this.clone()._rotate(n)},"rotate"),rotateAround:l(function(n,r){return this.clone()._rotateAround(n,r)},"rotateAround"),matMult:l(function(n){return this.clone()._matMult(n)},"matMult"),unit:l(function(){return this.clone()._unit()},"unit"),perp:l(function(){return this.clone()._perp()},"perp"),round:l(function(){return this.clone()._round()},"round"),mag:l(function(){return Math.sqrt(this.x*this.x+this.y*this.y)},"mag"),equals:l(function(n){return this.x===n.x&&this.y===n.y},"equals"),dist:l(function(n){return Math.sqrt(this.distSqr(n))},"dist"),distSqr:l(function(n){var r=n.x-this.x,a=n.y-this.y;return r*r+a*a},"distSqr"),angle:l(function(){return Math.atan2(this.y,this.x)},"angle"),angleTo:l(function(n){return Math.atan2(this.y-n.y,this.x-n.x)},"angleTo"),angleWith:l(function(n){return this.angleWithSep(n.x,n.y)},"angleWith"),angleWithSep:l(function(n,r){return Math.atan2(this.x*r-this.y*n,this.x*n+this.y*r)},"angleWithSep"),_matMult:l(function(n){var r=n[0]*this.x+n[1]*this.y,a=n[2]*this.x+n[3]*this.y;return this.x=r,this.y=a,this},"_matMult"),_add:l(function(n){return this.x+=n.x,this.y+=n.y,this},"_add"),_sub:l(function(n){return this.x-=n.x,this.y-=n.y,this},"_sub"),_mult:l(function(n){return this.x*=n,this.y*=n,this},"_mult"),_div:l(function(n){return this.x/=n,this.y/=n,this},"_div"),_multByPoint:l(function(n){return this.x*=n.x,this.y*=n.y,this},"_multByPoint"),_divByPoint:l(function(n){return this.x/=n.x,this.y/=n.y,this},"_divByPoint"),_unit:l(function(){return this._div(this.mag()),this},"_unit"),_perp:l(function(){var n=this.y;return this.y=this.x,this.x=-n,this},"_perp"),_rotate:l(function(n){var r=Math.cos(n),a=Math.sin(n),o=r*this.x-a*this.y,s=a*this.x+r*this.y;return this.x=o,this.y=s,this},"_rotate"),_rotateAround:l(function(n,r){var a=Math.cos(n),o=Math.sin(n),s=r.x+a*(this.x-r.x)-o*(this.y-r.y),u=r.y+o*(this.x-r.x)+a*(this.y-r.y);return this.x=s,this.y=u,this},"_rotateAround"),_round:l(function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},"_round")},t.convert=function(n){return n instanceof t?n:Array.isArray(n)?new t(n[0],n[1]):n}}),rme=Et((i,e)=>{R(),e.exports=t;function t(n,r,a,o){this.cx=3*n,this.bx=3*(a-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(o-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=r,this.p2x=a,this.p2y=o}l(t,"UnitBezier"),t.prototype={sampleCurveX:l(function(n){return((this.ax*n+this.bx)*n+this.cx)*n},"sampleCurveX"),sampleCurveY:l(function(n){return((this.ay*n+this.by)*n+this.cy)*n},"sampleCurveY"),sampleCurveDerivativeX:l(function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},"sampleCurveDerivativeX"),solveCurveX:l(function(n,r){if(r===void 0&&(r=1e-6),n<0)return 0;if(n>1)return 1;for(var a=n,o=0;o<8;o++){var s=this.sampleCurveX(a)-n;if(Math.abs(s)<r)return a;var u=this.sampleCurveDerivativeX(a);if(Math.abs(u)<1e-6)break;a=a-s/u}var h=0,d=1;for(a=n,o=0;o<20&&(s=this.sampleCurveX(a),!(Math.abs(s-n)<r));o++)n>s?h=a:d=a,a=(d-h)*.5+h;return a},"solveCurveX"),solve:l(function(n,r){return this.sampleCurveY(this.solveCurveX(n,r))},"solve")}}),ame=Et((i,e)=>{R();function t(n,r){var a,o,s,u,h,d,f,m;for(a=n.length&3,o=n.length-a,s=r,h=3432918353,d=461845907,m=0;m<o;)f=n.charCodeAt(m)&255|(n.charCodeAt(++m)&255)<<8|(n.charCodeAt(++m)&255)<<16|(n.charCodeAt(++m)&255)<<24,++m,f=(f&65535)*h+(((f>>>16)*h&65535)<<16)&4294967295,f=f<<15|f>>>17,f=(f&65535)*d+(((f>>>16)*d&65535)<<16)&4294967295,s^=f,s=s<<13|s>>>19,u=(s&65535)*5+(((s>>>16)*5&65535)<<16)&4294967295,s=(u&65535)+27492+(((u>>>16)+58964&65535)<<16);switch(f=0,a){case 3:f^=(n.charCodeAt(m+2)&255)<<16;case 2:f^=(n.charCodeAt(m+1)&255)<<8;case 1:f^=n.charCodeAt(m)&255,f=(f&65535)*h+(((f>>>16)*h&65535)<<16)&4294967295,f=f<<15|f>>>17,f=(f&65535)*d+(((f>>>16)*d&65535)<<16)&4294967295,s^=f}return s^=n.length,s^=s>>>16,s=(s&65535)*2246822507+(((s>>>16)*2246822507&65535)<<16)&4294967295,s^=s>>>13,s=(s&65535)*3266489909+(((s>>>16)*3266489909&65535)<<16)&4294967295,s^=s>>>16,s>>>0}l(t,"murmurhash3_32_gc"),typeof e<"u"&&(e.exports=t)}),ome=Et((i,e)=>{R();function t(n,r){for(var a=n.length,o=r^a,s=0,u;a>=4;)u=n.charCodeAt(s)&255|(n.charCodeAt(++s)&255)<<8|(n.charCodeAt(++s)&255)<<16|(n.charCodeAt(++s)&255)<<24,u=(u&65535)*1540483477+(((u>>>16)*1540483477&65535)<<16),u^=u>>>24,u=(u&65535)*1540483477+(((u>>>16)*1540483477&65535)<<16),o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16)^u,a-=4,++s;switch(a){case 3:o^=(n.charCodeAt(s+2)&255)<<16;case 2:o^=(n.charCodeAt(s+1)&255)<<8;case 1:o^=n.charCodeAt(s)&255,o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16)}return o^=o>>>13,o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16),o^=o>>>15,o>>>0}l(t,"murmurhash2_32_gc"),typeof e!==void 0&&(e.exports=t)}),$B=Et((i,e)=>{R();var t=ame(),n=ome();e.exports=t,e.exports.murmur3=t,e.exports.murmur2=n}),QP=Et((i,e)=>{R(),e.exports=t,e.exports.default=t;function t($,K,te){te=te||2;var ve=K&&K.length,Q=ve?K[0]*te:$.length,he=n($,0,Q,te,!0),se=[];if(!he||he.next===he.prev)return se;var Ae,Ie,we,Ne,je,Ve,Le;if(ve&&(he=d($,K,he,te)),$.length>80*te){Ae=we=$[0],Ie=Ne=$[1];for(var xe=te;xe<Q;xe+=te)je=$[xe],Ve=$[xe+1],je<Ae&&(Ae=je),Ve<Ie&&(Ie=Ve),je>we&&(we=je),Ve>Ne&&(Ne=Ve);Le=Math.max(we-Ae,Ne-Ie),Le=Le!==0?32767/Le:0}return a(he,se,te,Ae,Ie,Le,0),se}l(t,"earcut");function n($,K,te,ve,Q){var he,se;if(Q===oe($,K,te,ve)>0)for(he=K;he<te;he+=ve)se=O(he,$[he],$[he+1],se);else for(he=te-ve;he>=K;he-=ve)se=O(he,$[he],$[he+1],se);return se&&F(se,se.next)&&(Y(se),se=se.next),se}l(n,"linkedList");function r($,K){if(!$)return $;K||(K=$);var te=$,ve;do if(ve=!1,!te.steiner&&(F(te,te.next)||k(te.prev,te,te.next)===0)){if(Y(te),te=K=te.prev,te===te.next)break;ve=!0}else te=te.next;while(ve||te!==K);return K}l(r,"filterPoints");function a($,K,te,ve,Q,he,se){if($){!se&&he&&w($,ve,Q,he);for(var Ae=$,Ie,we;$.prev!==$.next;){if(Ie=$.prev,we=$.next,he?s($,ve,Q,he):o($)){K.push(Ie.i/te|0),K.push($.i/te|0),K.push(we.i/te|0),Y($),$=we.next,Ae=we.next;continue}if($=we,$===Ae){se?se===1?($=u(r($),K,te),a($,K,te,ve,Q,he,2)):se===2&&h($,K,te,ve,Q,he):a(r($),K,te,ve,Q,he,1);break}}}}l(a,"earcutLinked");function o($){var K=$.prev,te=$,ve=$.next;if(k(K,te,ve)>=0)return!1;for(var Q=K.x,he=te.x,se=ve.x,Ae=K.y,Ie=te.y,we=ve.y,Ne=Q<he?Q<se?Q:se:he<se?he:se,je=Ae<Ie?Ae<we?Ae:we:Ie<we?Ie:we,Ve=Q>he?Q>se?Q:se:he>se?he:se,Le=Ae>Ie?Ae>we?Ae:we:Ie>we?Ie:we,xe=ve.next;xe!==K;){if(xe.x>=Ne&&xe.x<=Ve&&xe.y>=je&&xe.y<=Le&&C(Q,Ae,he,Ie,se,we,xe.x,xe.y)&&k(xe.prev,xe,xe.next)>=0)return!1;xe=xe.next}return!0}l(o,"isEar");function s($,K,te,ve){var Q=$.prev,he=$,se=$.next;if(k(Q,he,se)>=0)return!1;for(var Ae=Q.x,Ie=he.x,we=se.x,Ne=Q.y,je=he.y,Ve=se.y,Le=Ae<Ie?Ae<we?Ae:we:Ie<we?Ie:we,xe=Ne<je?Ne<Ve?Ne:Ve:je<Ve?je:Ve,Ue=Ae>Ie?Ae>we?Ae:we:Ie>we?Ie:we,de=Ne>je?Ne>Ve?Ne:Ve:je>Ve?je:Ve,ut=E(Le,xe,K,te,ve),ot=E(Ue,de,K,te,ve),He=$.prevZ,Ke=$.nextZ;He&&He.z>=ut&&Ke&&Ke.z<=ot;){if(He.x>=Le&&He.x<=Ue&&He.y>=xe&&He.y<=de&&He!==Q&&He!==se&&C(Ae,Ne,Ie,je,we,Ve,He.x,He.y)&&k(He.prev,He,He.next)>=0||(He=He.prevZ,Ke.x>=Le&&Ke.x<=Ue&&Ke.y>=xe&&Ke.y<=de&&Ke!==Q&&Ke!==se&&C(Ae,Ne,Ie,je,we,Ve,Ke.x,Ke.y)&&k(Ke.prev,Ke,Ke.next)>=0))return!1;Ke=Ke.nextZ}for(;He&&He.z>=ut;){if(He.x>=Le&&He.x<=Ue&&He.y>=xe&&He.y<=de&&He!==Q&&He!==se&&C(Ae,Ne,Ie,je,we,Ve,He.x,He.y)&&k(He.prev,He,He.next)>=0)return!1;He=He.prevZ}for(;Ke&&Ke.z<=ot;){if(Ke.x>=Le&&Ke.x<=Ue&&Ke.y>=xe&&Ke.y<=de&&Ke!==Q&&Ke!==se&&C(Ae,Ne,Ie,je,we,Ve,Ke.x,Ke.y)&&k(Ke.prev,Ke,Ke.next)>=0)return!1;Ke=Ke.nextZ}return!0}l(s,"isEarHashed");function u($,K,te){var ve=$;do{var Q=ve.prev,he=ve.next.next;!F(Q,he)&&B(Q,ve,ve.next,he)&&j(Q,he)&&j(he,Q)&&(K.push(Q.i/te|0),K.push(ve.i/te|0),K.push(he.i/te|0),Y(ve),Y(ve.next),ve=$=he),ve=ve.next}while(ve!==$);return r(ve)}l(u,"cureLocalIntersections");function h($,K,te,ve,Q,he){var se=$;do{for(var Ae=se.next.next;Ae!==se.prev;){if(se.i!==Ae.i&&T(se,Ae)){var Ie=Z(se,Ae);se=r(se,se.next),Ie=r(Ie,Ie.next),a(se,K,te,ve,Q,he,0),a(Ie,K,te,ve,Q,he,0);return}Ae=Ae.next}se=se.next}while(se!==$)}l(h,"splitEarcut");function d($,K,te,ve){var Q=[],he,se,Ae,Ie,we;for(he=0,se=K.length;he<se;he++)Ae=K[he]*ve,Ie=he<se-1?K[he+1]*ve:$.length,we=n($,Ae,Ie,ve,!1),we===we.next&&(we.steiner=!0),Q.push(I(we));for(Q.sort(f),he=0;he<Q.length;he++)te=m(Q[he],te);return te}l(d,"eliminateHoles");function f($,K){return $.x-K.x}l(f,"compareX");function m($,K){var te=v($,K);if(!te)return K;var ve=Z(te,$);return r(ve,ve.next),r(te,te.next)}l(m,"eliminateHole");function v($,K){var te=K,ve=$.x,Q=$.y,he=-1/0,se;do{if(Q<=te.y&&Q>=te.next.y&&te.next.y!==te.y){var Ae=te.x+(Q-te.y)*(te.next.x-te.x)/(te.next.y-te.y);if(Ae<=ve&&Ae>he&&(he=Ae,se=te.x<te.next.x?te:te.next,Ae===ve))return se}te=te.next}while(te!==K);if(!se)return null;var Ie=se,we=se.x,Ne=se.y,je=1/0,Ve;te=se;do ve>=te.x&&te.x>=we&&ve!==te.x&&C(Q<Ne?ve:he,Q,we,Ne,Q<Ne?he:ve,Q,te.x,te.y)&&(Ve=Math.abs(Q-te.y)/(ve-te.x),j(te,$)&&(Ve<je||Ve===je&&(te.x>se.x||te.x===se.x&&b(se,te)))&&(se=te,je=Ve)),te=te.next;while(te!==Ie);return se}l(v,"findHoleBridge");function b($,K){return k($.prev,$,K.prev)<0&&k(K.next,$,$.next)<0}l(b,"sectorContainsSector");function w($,K,te,ve){var Q=$;do Q.z===0&&(Q.z=E(Q.x,Q.y,K,te,ve)),Q.prevZ=Q.prev,Q.nextZ=Q.next,Q=Q.next;while(Q!==$);Q.prevZ.nextZ=null,Q.prevZ=null,A(Q)}l(w,"indexCurve");function A($){var K,te,ve,Q,he,se,Ae,Ie,we=1;do{for(te=$,$=null,he=null,se=0;te;){for(se++,ve=te,Ae=0,K=0;K<we&&(Ae++,ve=ve.nextZ,!!ve);K++);for(Ie=we;Ae>0||Ie>0&&ve;)Ae!==0&&(Ie===0||!ve||te.z<=ve.z)?(Q=te,te=te.nextZ,Ae--):(Q=ve,ve=ve.nextZ,Ie--),he?he.nextZ=Q:$=Q,Q.prevZ=he,he=Q;te=ve}he.nextZ=null,we*=2}while(se>1);return $}l(A,"sortLinked");function E($,K,te,ve,Q){return $=($-te)*Q|0,K=(K-ve)*Q|0,$=($|$<<8)&16711935,$=($|$<<4)&252645135,$=($|$<<2)&858993459,$=($|$<<1)&1431655765,K=(K|K<<8)&16711935,K=(K|K<<4)&252645135,K=(K|K<<2)&858993459,K=(K|K<<1)&1431655765,$|K<<1}l(E,"zOrder");function I($){var K=$,te=$;do(K.x<te.x||K.x===te.x&&K.y<te.y)&&(te=K),K=K.next;while(K!==$);return te}l(I,"getLeftmost");function C($,K,te,ve,Q,he,se,Ae){return(Q-se)*(K-Ae)>=($-se)*(he-Ae)&&($-se)*(ve-Ae)>=(te-se)*(K-Ae)&&(te-se)*(he-Ae)>=(Q-se)*(ve-Ae)}l(C,"pointInTriangle");function T($,K){return $.next.i!==K.i&&$.prev.i!==K.i&&!L($,K)&&(j($,K)&&j(K,$)&&q($,K)&&(k($.prev,$,K.prev)||k($,K.prev,K))||F($,K)&&k($.prev,$,$.next)>0&&k(K.prev,K,K.next)>0)}l(T,"isValidDiagonal");function k($,K,te){return(K.y-$.y)*(te.x-K.x)-(K.x-$.x)*(te.y-K.y)}l(k,"area");function F($,K){return $.x===K.x&&$.y===K.y}l(F,"equals");function B($,K,te,ve){var Q=z(k($,K,te)),he=z(k($,K,ve)),se=z(k(te,ve,$)),Ae=z(k(te,ve,K));return!!(Q!==he&&se!==Ae||Q===0&&N($,te,K)||he===0&&N($,ve,K)||se===0&&N(te,$,ve)||Ae===0&&N(te,K,ve))}l(B,"intersects");function N($,K,te){return K.x<=Math.max($.x,te.x)&&K.x>=Math.min($.x,te.x)&&K.y<=Math.max($.y,te.y)&&K.y>=Math.min($.y,te.y)}l(N,"onSegment");function z($){return $>0?1:$<0?-1:0}l(z,"sign");function L($,K){var te=$;do{if(te.i!==$.i&&te.next.i!==$.i&&te.i!==K.i&&te.next.i!==K.i&&B(te,te.next,$,K))return!0;te=te.next}while(te!==$);return!1}l(L,"intersectsPolygon");function j($,K){return k($.prev,$,$.next)<0?k($,K,$.next)>=0&&k($,$.prev,K)>=0:k($,K,$.prev)<0||k($,$.next,K)<0}l(j,"locallyInside");function q($,K){var te=$,ve=!1,Q=($.x+K.x)/2,he=($.y+K.y)/2;do te.y>he!=te.next.y>he&&te.next.y!==te.y&&Q<(te.next.x-te.x)*(he-te.y)/(te.next.y-te.y)+te.x&&(ve=!ve),te=te.next;while(te!==$);return ve}l(q,"middleInside");function Z($,K){var te=new J($.i,$.x,$.y),ve=new J(K.i,K.x,K.y),Q=$.next,he=K.prev;return $.next=K,K.prev=$,te.next=Q,Q.prev=te,ve.next=te,te.prev=ve,he.next=ve,ve.prev=he,ve}l(Z,"splitPolygon");function O($,K,te,ve){var Q=new J($,K,te);return ve?(Q.next=ve.next,Q.prev=ve,ve.next.prev=Q,ve.next=Q):(Q.prev=Q,Q.next=Q),Q}l(O,"insertNode");function Y($){$.next.prev=$.prev,$.prev.next=$.next,$.prevZ&&($.prevZ.nextZ=$.nextZ),$.nextZ&&($.nextZ.prevZ=$.prevZ)}l(Y,"removeNode");function J($,K,te){this.i=$,this.x=K,this.y=te,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}l(J,"Node"),t.deviation=function($,K,te,ve){var Q=K&&K.length,he=Q?K[0]*te:$.length,se=Math.abs(oe($,0,he,te));if(Q)for(var Ae=0,Ie=K.length;Ae<Ie;Ae++){var we=K[Ae]*te,Ne=Ae<Ie-1?K[Ae+1]*te:$.length;se-=Math.abs(oe($,we,Ne,te))}var je=0;for(Ae=0;Ae<ve.length;Ae+=3){var Ve=ve[Ae]*te,Le=ve[Ae+1]*te,xe=ve[Ae+2]*te;je+=Math.abs(($[Ve]-$[xe])*($[Le+1]-$[Ve+1])-($[Ve]-$[Le])*($[xe+1]-$[Ve+1]))}return se===0&&je===0?0:Math.abs((je-se)/se)};function oe($,K,te,ve){for(var Q=0,he=K,se=te-ve;he<te;he+=ve)Q+=($[se]-$[he])*($[he+1]+$[se+1]),se=he;return Q}l(oe,"signedArea"),t.flatten=function($){for(var K=$[0][0].length,te={vertices:[],holes:[],dimensions:K},ve=0,Q=0;Q<$.length;Q++){for(var he=0;he<$[Q].length;he++)for(var se=0;se<K;se++)te.vertices.push($[Q][he][se]);Q>0&&(ve+=$[Q-1].length,te.holes.push(ve))}return te}}),HB=Et((i,e)=>{R();var t=Rn();e.exports=n;function n(u,h,d,f,m){this.properties={},this.extent=d,this.type=0,this._pbf=u,this._geometry=-1,this._keys=f,this._values=m,u.readFields(r,this,h)}l(n,"VectorTileFeature");function r(u,h,d){u==1?h.id=d.readVarint():u==2?a(d,h):u==3?h.type=d.readVarint():u==4&&(h._geometry=d.pos)}l(r,"readFeature");function a(u,h){for(var d=u.readVarint()+u.pos;u.pos<d;){var f=h._keys[u.readVarint()],m=h._values[u.readVarint()];h.properties[f]=m}}l(a,"readTag"),n.types=["Unknown","Point","LineString","Polygon"],n.prototype.loadGeometry=function(){var u=this._pbf;u.pos=this._geometry;for(var h=u.readVarint()+u.pos,d=1,f=0,m=0,v=0,b=[],w;u.pos<h;){if(f<=0){var A=u.readVarint();d=A&7,f=A>>3}if(f--,d===1||d===2)m+=u.readSVarint(),v+=u.readSVarint(),d===1&&(w&&b.push(w),w=[]),w.push(new t(m,v));else if(d===7)w&&w.push(w[0].clone());else throw new Error("unknown command "+d)}return w&&b.push(w),b},n.prototype.bbox=function(){var u=this._pbf;u.pos=this._geometry;for(var h=u.readVarint()+u.pos,d=1,f=0,m=0,v=0,b=1/0,w=-1/0,A=1/0,E=-1/0;u.pos<h;){if(f<=0){var I=u.readVarint();d=I&7,f=I>>3}if(f--,d===1||d===2)m+=u.readSVarint(),v+=u.readSVarint(),m<b&&(b=m),m>w&&(w=m),v<A&&(A=v),v>E&&(E=v);else if(d!==7)throw new Error("unknown command "+d)}return[b,A,w,E]},n.prototype.toGeoJSON=function(u,h,d){var f=this.extent*Math.pow(2,d),m=this.extent*u,v=this.extent*h,b=this.loadGeometry(),w=n.types[this.type],A,E;function I(k){for(var F=0;F<k.length;F++){var B=k[F],N=180-(B.y+v)*360/f;k[F]=[(B.x+m)*360/f-180,360/Math.PI*Math.atan(Math.exp(N*Math.PI/180))-90]}}switch(l(I,"project"),this.type){case 1:var C=[];for(A=0;A<b.length;A++)C[A]=b[A][0];b=C,I(b);break;case 2:for(A=0;A<b.length;A++)I(b[A]);break;case 3:for(b=o(b),A=0;A<b.length;A++)for(E=0;E<b[A].length;E++)I(b[A][E]);break}b.length===1?b=b[0]:w="Multi"+w;var T={type:"Feature",geometry:{type:w,coordinates:b},properties:this.properties};return"id"in this&&(T.id=this.id),T};function o(u){var h=u.length;if(h<=1)return[u];for(var d=[],f,m,v=0;v<h;v++){var b=s(u[v]);b!==0&&(m===void 0&&(m=b<0),m===b<0?(f&&d.push(f),f=[u[v]]):f.push(u[v]))}return f&&d.push(f),d}l(o,"classifyRings");function s(u){for(var h=0,d=0,f=u.length,m=f-1,v,b;d<f;m=d++)v=u[d],b=u[m],h+=(b.x-v.x)*(v.y+b.y);return h}l(s,"signedArea")}),WB=Et((i,e)=>{R();var t=HB();e.exports=n;function n(o,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],o.readFields(r,this,s),this.length=this._features.length}l(n,"VectorTileLayer");function r(o,s,u){o===15?s.version=u.readVarint():o===1?s.name=u.readString():o===5?s.extent=u.readVarint():o===2?s._features.push(u.pos):o===3?s._keys.push(u.readString()):o===4&&s._values.push(a(u))}l(r,"readLayer");function a(o){for(var s=null,u=o.readVarint()+o.pos;o.pos<u;){var h=o.readVarint()>>3;s=h===1?o.readString():h===2?o.readFloat():h===3?o.readDouble():h===4?o.readVarint64():h===5?o.readVarint():h===6?o.readSVarint():h===7?o.readBoolean():null}return s}l(a,"readValueMessage"),n.prototype.feature=function(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];var s=this._pbf.readVarint()+this._pbf.pos;return new t(this._pbf,s,this.extent,this._keys,this._values)}}),sme=Et((i,e)=>{R();var t=WB();e.exports=n;function n(a,o){this.layers=a.readFields(r,{},o)}l(n,"VectorTile");function r(a,o,s){if(a===3){var u=new t(s,s.readVarint()+s.pos);u.length&&(o[u.name]=u)}}l(r,"readTile")}),Zw=Et((i,e)=>{R(),e.exports.VectorTile=sme(),e.exports.VectorTileFeature=HB(),e.exports.VectorTileLayer=WB()}),lme=Et(i=>{R(),i.read=function(e,t,n,r,a){var o,s,u=a*8-r-1,h=(1<<u)-1,d=h>>1,f=-7,m=n?a-1:0,v=n?-1:1,b=e[t+m];for(m+=v,o=b&(1<<-f)-1,b>>=-f,f+=u;f>0;o=o*256+e[t+m],m+=v,f-=8);for(s=o&(1<<-f)-1,o>>=-f,f+=r;f>0;s=s*256+e[t+m],m+=v,f-=8);if(o===0)o=1-d;else{if(o===h)return s?NaN:(b?-1:1)*(1/0);s=s+Math.pow(2,r),o=o-d}return(b?-1:1)*s*Math.pow(2,o-r)},i.write=function(e,t,n,r,a,o){var s,u,h,d=o*8-a-1,f=(1<<d)-1,m=f>>1,v=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,b=r?0:o-1,w=r?1:-1,A=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,s=f):(s=Math.floor(Math.log(t)/Math.LN2),t*(h=Math.pow(2,-s))<1&&(s--,h*=2),s+m>=1?t+=v/h:t+=v*Math.pow(2,1-m),t*h>=2&&(s++,h/=2),s+m>=f?(u=0,s=f):s+m>=1?(u=(t*h-1)*Math.pow(2,a),s=s+m):(u=t*Math.pow(2,m-1)*Math.pow(2,a),s=0));a>=8;e[n+b]=u&255,b+=w,u/=256,a-=8);for(s=s<<a|u,d+=a;d>0;e[n+b]=s&255,b+=w,s/=256,d-=8);e[n+b-w]|=A*128}}),qB=Et((i,e)=>{R(),e.exports=n;var t=lme();function n(O){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(O)?O:new Uint8Array(O||0),this.pos=0,this.type=0,this.length=this.buf.length}l(n,"Pbf"),n.Varint=0,n.Fixed64=1,n.Bytes=2,n.Fixed32=5;var r=65536*65536,a=1/r,o=12,s=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");n.prototype={destroy:l(function(){this.buf=null},"destroy"),readFields:l(function(O,Y,J){for(J=J||this.length;this.pos<J;){var oe=this.readVarint(),$=oe>>3,K=this.pos;this.type=oe&7,O($,Y,this),this.pos===K&&this.skip(oe)}return Y},"readFields"),readMessage:l(function(O,Y){return this.readFields(O,Y,this.readVarint()+this.pos)},"readMessage"),readFixed32:l(function(){var O=N(this.buf,this.pos);return this.pos+=4,O},"readFixed32"),readSFixed32:l(function(){var O=L(this.buf,this.pos);return this.pos+=4,O},"readSFixed32"),readFixed64:l(function(){var O=N(this.buf,this.pos)+N(this.buf,this.pos+4)*r;return this.pos+=8,O},"readFixed64"),readSFixed64:l(function(){var O=N(this.buf,this.pos)+L(this.buf,this.pos+4)*r;return this.pos+=8,O},"readSFixed64"),readFloat:l(function(){var O=t.read(this.buf,this.pos,!0,23,4);return this.pos+=4,O},"readFloat"),readDouble:l(function(){var O=t.read(this.buf,this.pos,!0,52,8);return this.pos+=8,O},"readDouble"),readVarint:l(function(O){var Y=this.buf,J,oe;return oe=Y[this.pos++],J=oe&127,oe<128||(oe=Y[this.pos++],J|=(oe&127)<<7,oe<128)||(oe=Y[this.pos++],J|=(oe&127)<<14,oe<128)||(oe=Y[this.pos++],J|=(oe&127)<<21,oe<128)?J:(oe=Y[this.pos],J|=(oe&15)<<28,u(J,O,this))},"readVarint"),readVarint64:l(function(){return this.readVarint(!0)},"readVarint64"),readSVarint:l(function(){var O=this.readVarint();return O%2===1?(O+1)/-2:O/2},"readSVarint"),readBoolean:l(function(){return!!this.readVarint()},"readBoolean"),readString:l(function(){var O=this.readVarint()+this.pos,Y=this.pos;return this.pos=O,O-Y>=o&&s?q(this.buf,Y,O):j(this.buf,Y,O)},"readString"),readBytes:l(function(){var O=this.readVarint()+this.pos,Y=this.buf.subarray(this.pos,O);return this.pos=O,Y},"readBytes"),readPackedVarint:l(function(O,Y){if(this.type!==n.Bytes)return O.push(this.readVarint(Y));var J=h(this);for(O=O||[];this.pos<J;)O.push(this.readVarint(Y));return O},"readPackedVarint"),readPackedSVarint:l(function(O){if(this.type!==n.Bytes)return O.push(this.readSVarint());var Y=h(this);for(O=O||[];this.pos<Y;)O.push(this.readSVarint());return O},"readPackedSVarint"),readPackedBoolean:l(function(O){if(this.type!==n.Bytes)return O.push(this.readBoolean());var Y=h(this);for(O=O||[];this.pos<Y;)O.push(this.readBoolean());return O},"readPackedBoolean"),readPackedFloat:l(function(O){if(this.type!==n.Bytes)return O.push(this.readFloat());var Y=h(this);for(O=O||[];this.pos<Y;)O.push(this.readFloat());return O},"readPackedFloat"),readPackedDouble:l(function(O){if(this.type!==n.Bytes)return O.push(this.readDouble());var Y=h(this);for(O=O||[];this.pos<Y;)O.push(this.readDouble());return O},"readPackedDouble"),readPackedFixed32:l(function(O){if(this.type!==n.Bytes)return O.push(this.readFixed32());var Y=h(this);for(O=O||[];this.pos<Y;)O.push(this.readFixed32());return O},"readPackedFixed32"),readPackedSFixed32:l(function(O){if(this.type!==n.Bytes)return O.push(this.readSFixed32());var Y=h(this);for(O=O||[];this.pos<Y;)O.push(this.readSFixed32());return O},"readPackedSFixed32"),readPackedFixed64:l(function(O){if(this.type!==n.Bytes)return O.push(this.readFixed64());var Y=h(this);for(O=O||[];this.pos<Y;)O.push(this.readFixed64());return O},"readPackedFixed64"),readPackedSFixed64:l(function(O){if(this.type!==n.Bytes)return O.push(this.readSFixed64());var Y=h(this);for(O=O||[];this.pos<Y;)O.push(this.readSFixed64());return O},"readPackedSFixed64"),skip:l(function(O){var Y=O&7;if(Y===n.Varint)for(;this.buf[this.pos++]>127;);else if(Y===n.Bytes)this.pos=this.readVarint()+this.pos;else if(Y===n.Fixed32)this.pos+=4;else if(Y===n.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+Y)},"skip"),writeTag:l(function(O,Y){this.writeVarint(O<<3|Y)},"writeTag"),realloc:l(function(O){for(var Y=this.length||16;Y<this.pos+O;)Y*=2;if(Y!==this.length){var J=new Uint8Array(Y);J.set(this.buf),this.buf=J,this.length=Y}},"realloc"),finish:l(function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},"finish"),writeFixed32:l(function(O){this.realloc(4),z(this.buf,O,this.pos),this.pos+=4},"writeFixed32"),writeSFixed32:l(function(O){this.realloc(4),z(this.buf,O,this.pos),this.pos+=4},"writeSFixed32"),writeFixed64:l(function(O){this.realloc(8),z(this.buf,O&-1,this.pos),z(this.buf,Math.floor(O*a),this.pos+4),this.pos+=8},"writeFixed64"),writeSFixed64:l(function(O){this.realloc(8),z(this.buf,O&-1,this.pos),z(this.buf,Math.floor(O*a),this.pos+4),this.pos+=8},"writeSFixed64"),writeVarint:l(function(O){if(O=+O||0,O>268435455||O<0){f(O,this);return}this.realloc(4),this.buf[this.pos++]=O&127|(O>127?128:0),!(O<=127)&&(this.buf[this.pos++]=(O>>>=7)&127|(O>127?128:0),!(O<=127)&&(this.buf[this.pos++]=(O>>>=7)&127|(O>127?128:0),!(O<=127)&&(this.buf[this.pos++]=O>>>7&127)))},"writeVarint"),writeSVarint:l(function(O){this.writeVarint(O<0?-O*2-1:O*2)},"writeSVarint"),writeBoolean:l(function(O){this.writeVarint(!!O)},"writeBoolean"),writeString:l(function(O){O=String(O),this.realloc(O.length*4),this.pos++;var Y=this.pos;this.pos=Z(this.buf,O,this.pos);var J=this.pos-Y;J>=128&&b(Y,J,this),this.pos=Y-1,this.writeVarint(J),this.pos+=J},"writeString"),writeFloat:l(function(O){this.realloc(4),t.write(this.buf,O,this.pos,!0,23,4),this.pos+=4},"writeFloat"),writeDouble:l(function(O){this.realloc(8),t.write(this.buf,O,this.pos,!0,52,8),this.pos+=8},"writeDouble"),writeBytes:l(function(O){var Y=O.length;this.writeVarint(Y),this.realloc(Y);for(var J=0;J<Y;J++)this.buf[this.pos++]=O[J]},"writeBytes"),writeRawMessage:l(function(O,Y){this.pos++;var J=this.pos;O(Y,this);var oe=this.pos-J;oe>=128&&b(J,oe,this),this.pos=J-1,this.writeVarint(oe),this.pos+=oe},"writeRawMessage"),writeMessage:l(function(O,Y,J){this.writeTag(O,n.Bytes),this.writeRawMessage(Y,J)},"writeMessage"),writePackedVarint:l(function(O,Y){Y.length&&this.writeMessage(O,w,Y)},"writePackedVarint"),writePackedSVarint:l(function(O,Y){Y.length&&this.writeMessage(O,A,Y)},"writePackedSVarint"),writePackedBoolean:l(function(O,Y){Y.length&&this.writeMessage(O,C,Y)},"writePackedBoolean"),writePackedFloat:l(function(O,Y){Y.length&&this.writeMessage(O,E,Y)},"writePackedFloat"),writePackedDouble:l(function(O,Y){Y.length&&this.writeMessage(O,I,Y)},"writePackedDouble"),writePackedFixed32:l(function(O,Y){Y.length&&this.writeMessage(O,T,Y)},"writePackedFixed32"),writePackedSFixed32:l(function(O,Y){Y.length&&this.writeMessage(O,k,Y)},"writePackedSFixed32"),writePackedFixed64:l(function(O,Y){Y.length&&this.writeMessage(O,F,Y)},"writePackedFixed64"),writePackedSFixed64:l(function(O,Y){Y.length&&this.writeMessage(O,B,Y)},"writePackedSFixed64"),writeBytesField:l(function(O,Y){this.writeTag(O,n.Bytes),this.writeBytes(Y)},"writeBytesField"),writeFixed32Field:l(function(O,Y){this.writeTag(O,n.Fixed32),this.writeFixed32(Y)},"writeFixed32Field"),writeSFixed32Field:l(function(O,Y){this.writeTag(O,n.Fixed32),this.writeSFixed32(Y)},"writeSFixed32Field"),writeFixed64Field:l(function(O,Y){this.writeTag(O,n.Fixed64),this.writeFixed64(Y)},"writeFixed64Field"),writeSFixed64Field:l(function(O,Y){this.writeTag(O,n.Fixed64),this.writeSFixed64(Y)},"writeSFixed64Field"),writeVarintField:l(function(O,Y){this.writeTag(O,n.Varint),this.writeVarint(Y)},"writeVarintField"),writeSVarintField:l(function(O,Y){this.writeTag(O,n.Varint),this.writeSVarint(Y)},"writeSVarintField"),writeStringField:l(function(O,Y){this.writeTag(O,n.Bytes),this.writeString(Y)},"writeStringField"),writeFloatField:l(function(O,Y){this.writeTag(O,n.Fixed32),this.writeFloat(Y)},"writeFloatField"),writeDoubleField:l(function(O,Y){this.writeTag(O,n.Fixed64),this.writeDouble(Y)},"writeDoubleField"),writeBooleanField:l(function(O,Y){this.writeVarintField(O,!!Y)},"writeBooleanField")};function u(O,Y,J){var oe=J.buf,$,K;if(K=oe[J.pos++],$=(K&112)>>4,K<128||(K=oe[J.pos++],$|=(K&127)<<3,K<128)||(K=oe[J.pos++],$|=(K&127)<<10,K<128)||(K=oe[J.pos++],$|=(K&127)<<17,K<128)||(K=oe[J.pos++],$|=(K&127)<<24,K<128)||(K=oe[J.pos++],$|=(K&1)<<31,K<128))return d(O,$,Y);throw new Error("Expected varint not more than 10 bytes")}l(u,"readVarintRemainder");function h(O){return O.type===n.Bytes?O.readVarint()+O.pos:O.pos+1}l(h,"readPackedEnd");function d(O,Y,J){return J?Y*4294967296+(O>>>0):(Y>>>0)*4294967296+(O>>>0)}l(d,"toNum");function f(O,Y){var J,oe;if(O>=0?(J=O%4294967296|0,oe=O/4294967296|0):(J=~(-O%4294967296),oe=~(-O/4294967296),J^4294967295?J=J+1|0:(J=0,oe=oe+1|0)),O>=18446744073709552e3||O<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Y.realloc(10),m(J,oe,Y),v(oe,Y)}l(f,"writeBigVarint");function m(O,Y,J){J.buf[J.pos++]=O&127|128,O>>>=7,J.buf[J.pos++]=O&127|128,O>>>=7,J.buf[J.pos++]=O&127|128,O>>>=7,J.buf[J.pos++]=O&127|128,O>>>=7,J.buf[J.pos]=O&127}l(m,"writeBigVarintLow");function v(O,Y){var J=(O&7)<<4;Y.buf[Y.pos++]|=J|((O>>>=3)?128:0),O&&(Y.buf[Y.pos++]=O&127|((O>>>=7)?128:0),O&&(Y.buf[Y.pos++]=O&127|((O>>>=7)?128:0),O&&(Y.buf[Y.pos++]=O&127|((O>>>=7)?128:0),O&&(Y.buf[Y.pos++]=O&127|((O>>>=7)?128:0),O&&(Y.buf[Y.pos++]=O&127)))))}l(v,"writeBigVarintHigh");function b(O,Y,J){var oe=Y<=16383?1:Y<=2097151?2:Y<=268435455?3:Math.floor(Math.log(Y)/(Math.LN2*7));J.realloc(oe);for(var $=J.pos-1;$>=O;$--)J.buf[$+oe]=J.buf[$]}l(b,"makeRoomForExtraLength");function w(O,Y){for(var J=0;J<O.length;J++)Y.writeVarint(O[J])}l(w,"writePackedVarint");function A(O,Y){for(var J=0;J<O.length;J++)Y.writeSVarint(O[J])}l(A,"writePackedSVarint");function E(O,Y){for(var J=0;J<O.length;J++)Y.writeFloat(O[J])}l(E,"writePackedFloat");function I(O,Y){for(var J=0;J<O.length;J++)Y.writeDouble(O[J])}l(I,"writePackedDouble");function C(O,Y){for(var J=0;J<O.length;J++)Y.writeBoolean(O[J])}l(C,"writePackedBoolean");function T(O,Y){for(var J=0;J<O.length;J++)Y.writeFixed32(O[J])}l(T,"writePackedFixed32");function k(O,Y){for(var J=0;J<O.length;J++)Y.writeSFixed32(O[J])}l(k,"writePackedSFixed32");function F(O,Y){for(var J=0;J<O.length;J++)Y.writeFixed64(O[J])}l(F,"writePackedFixed64");function B(O,Y){for(var J=0;J<O.length;J++)Y.writeSFixed64(O[J])}l(B,"writePackedSFixed64");function N(O,Y){return(O[Y]|O[Y+1]<<8|O[Y+2]<<16)+O[Y+3]*16777216}l(N,"readUInt32");function z(O,Y,J){O[J]=Y,O[J+1]=Y>>>8,O[J+2]=Y>>>16,O[J+3]=Y>>>24}l(z,"writeInt32");function L(O,Y){return(O[Y]|O[Y+1]<<8|O[Y+2]<<16)+(O[Y+3]<<24)}l(L,"readInt32");function j(O,Y,J){for(var oe="",$=Y;$<J;){var K=O[$],te=null,ve=K>239?4:K>223?3:K>191?2:1;if($+ve>J)break;var Q,he,se;ve===1?K<128&&(te=K):ve===2?(Q=O[$+1],(Q&192)===128&&(te=(K&31)<<6|Q&63,te<=127&&(te=null))):ve===3?(Q=O[$+1],he=O[$+2],(Q&192)===128&&(he&192)===128&&(te=(K&15)<<12|(Q&63)<<6|he&63,(te<=2047||te>=55296&&te<=57343)&&(te=null))):ve===4&&(Q=O[$+1],he=O[$+2],se=O[$+3],(Q&192)===128&&(he&192)===128&&(se&192)===128&&(te=(K&15)<<18|(Q&63)<<12|(he&63)<<6|se&63,(te<=65535||te>=1114112)&&(te=null))),te===null?(te=65533,ve=1):te>65535&&(te-=65536,oe+=String.fromCharCode(te>>>10&1023|55296),te=56320|te&1023),oe+=String.fromCharCode(te),$+=ve}return oe}l(j,"readUtf8");function q(O,Y,J){return s.decode(O.subarray(Y,J))}l(q,"readUtf8TextDecoder");function Z(O,Y,J){for(var oe=0,$,K;oe<Y.length;oe++){if($=Y.charCodeAt(oe),$>55295&&$<57344)if(K)if($<56320){O[J++]=239,O[J++]=191,O[J++]=189,K=$;continue}else $=K-55296<<10|$-56320|65536,K=null;else{$>56319||oe+1===Y.length?(O[J++]=239,O[J++]=191,O[J++]=189):K=$;continue}else K&&(O[J++]=239,O[J++]=191,O[J++]=189,K=null);$<128?O[J++]=$:($<2048?O[J++]=$>>6|192:($<65536?O[J++]=$>>12|224:(O[J++]=$>>18|240,O[J++]=$>>12&63|128),O[J++]=$>>6&63|128),O[J++]=$&63|128)}return J}l(Z,"writeUtf8")});R();var XB={version:"6.0.1-beta.51"};R();R();var ume=ii(Rn(),1),hme=ii(rme(),1);R();R();var qS;function e5(){return qS==null&&(qS=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),qS}l(e5,"offscreenCanvasSupported");var l_;function ZB(){if(l_==null&&(l_=!1,e5())){let i=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(i){for(let t=0;t<25;t++){let n=t*4;i.fillStyle="rgb(".concat(n,",").concat(n+1,",").concat(n+2,")"),i.fillRect(t%5,Math.floor(t/5),1,1)}let e=i.getImageData(0,0,5,5).data;for(let t=0;t<100;t++)if(t%4!==3&&e[t]!==t){l_=!0;break}}}return l_||!1}l(ZB,"isOffscreenCanvasDistorted");function YB(i){if(i<=0)return 0;if(i>=1)return 1;let e=i*i,t=e*i;return 4*(i<.5?t:3*(i-e)+t-.75)}l(YB,"easeCubicInOut");function Yw(i,e,t,n){let r=new hme.default(i,e,t,n);return function(a){return r.solve(a)}}l(Yw,"bezier");var qC=Yw(.25,.1,.25,1);function da(i,e,t){return Math.min(t,Math.max(e,i))}l(da,"clamp");function Kp(i,e,t){let n=t-e,r=((i-e)%n+n)%n+e;return r===e?t:r}l(Kp,"wrap");function JB(i,e){let t=[];for(let n in i)n in e||t.push(n);return t}l(JB,"keysDifference");function ti(i,...e){for(let t of e)for(let n in t)i[n]=t[n];return i}l(ti,"extend");function J1(i,e){let t={};for(let n=0;n<e.length;n++){let r=e[n];r in i&&(t[r]=i[r])}return t}l(J1,"pick");var cme=1;function t5(){return cme++}l(t5,"uniqueId");function KB(i){return Math.log(i)/Math.LN2%1===0}l(KB,"isPowerOfTwo");function QB(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}l(QB,"nextPowerOfTwo");function Jw(i,e,t){let n={};for(let r in i)n[r]=e.call(t||this,i[r],r,i);return n}l(Jw,"mapObject");function i5(i,e,t){let n={};for(let r in i)e.call(t||this,i[r],r,i)&&(n[r]=i[r]);return n}l(i5,"filterObject");function Cc(i,e){if(Array.isArray(i)){if(!Array.isArray(e)||i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(!Cc(i[t],e[t]))return!1;return!0}if(typeof i=="object"&&i!==null&&e!==null){if(typeof e!="object"||Object.keys(i).length!==Object.keys(e).length)return!1;for(let t in i)if(!Cc(i[t],e[t]))return!1;return!0}return i===e}l(Cc,"deepEqual");function cs(i){return Array.isArray(i)?i.map(cs):typeof i=="object"&&i?Jw(i,cs):i}l(cs,"clone");function ez(i,e){for(let t=0;t<i.length;t++)if(e.indexOf(i[t])>=0)return!0;return!1}l(ez,"arraysIntersect");var Lk={};function lo(i){Lk[i]||(typeof console<"u"&&console.warn(i),Lk[i]=!0)}l(lo,"warnOnce");function uh(i,e,t){return(t.y-i.y)*(e.x-i.x)>(e.y-i.y)*(t.x-i.x)}l(uh,"isCounterClockwise");function tz(i,e,t,n){let r=e.y-i.y,a=e.x-i.x,o=n.y-t.y,s=n.x-t.x,u=o*a-s*r;if(u===0)return null;let h=i.y-t.y,d=i.x-t.x,f=(s*h-o*d)/u;return new ume.default(i.x+f*a,i.y+f*r)}l(tz,"findLineIntersection");function iz(i){let e=0;for(let t=0,n=i.length,r=n-1,a,o;t<n;r=t++)a=i[t],o=i[r],e+=(o.x-a.x)*(a.y+o.y);return e}l(iz,"calculateSignedArea");function nz([i,e,t]){return e+=90,e*=Math.PI/180,t*=Math.PI/180,{x:i*Math.cos(e)*Math.sin(t),y:i*Math.sin(e)*Math.sin(t),z:i*Math.cos(t)}}l(nz,"sphericalToCartesian");function fd(i){return typeof WorkerGlobalScope<"u"&&typeof i<"u"&&i instanceof WorkerGlobalScope}l(fd,"isWorker");function rz(i){let e=/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,t={};if(i.replace(e,(n,r,a,o)=>{let s=a||o;return t[r]=s?s.toLowerCase():!0,""}),t["max-age"]){let n=parseInt(t["max-age"],10);isNaN(n)?delete t["max-age"]:t["max-age"]=n}return t}l(rz,"parseCacheControl");var XS=null;function az(i){if(XS==null){let e=i.navigator?i.navigator.userAgent:null;XS=!!i.safari||!!(e&&(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return XS}l(az,"isSafari");function eu(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap}l(eu,"isImageBitmap");var pme=l(async i=>{if(i.byteLength===0)return createImageBitmap(new ImageData(1,1));let e=new Blob([new Uint8Array(i)],{type:"image/png"});try{return createImageBitmap(e)}catch(t){throw new Error("Could not load image because of ".concat(t.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))}},"arrayBufferToImageBitmap"),Dk="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",dme=l(i=>new Promise((e,t)=>{let n=new Image;n.onload=()=>{e(n),URL.revokeObjectURL(n.src),n.onload=null,window.requestAnimationFrame(()=>{n.src=Dk})},n.onerror=()=>t(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));let r=new Blob([new Uint8Array(i)],{type:"image/png"});n.src=i.byteLength?URL.createObjectURL(r):Dk}),"arrayBufferToImage");function oz(i,e,t,n,r){let a=Math.max(-e,0)*4,o=(Math.max(0,t)-t)*n*4+a,s=n*4,u=Math.max(0,e),h=Math.max(0,t),d=Math.min(i.width,e+n),f=Math.min(i.height,t+r);return{rect:{x:u,y:h,width:d-u,height:f-h},layout:[{offset:o,stride:s}]}}l(oz,"computeVideoFrameParameters");async function sz(i,e,t,n,r){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");let a=new VideoFrame(i,{timestamp:0});try{let o=a?.format;if(!o||!(o.startsWith("BGR")||o.startsWith("RGB")))throw new Error("Unrecognized format ".concat(o));let s=o.startsWith("BGR"),u=new Uint8ClampedArray(n*r*4);if(await a.copyTo(u,oz(i,e,t,n,r)),s)for(let h=0;h<u.length;h+=4){let d=u[h];u[h]=u[h+2],u[h+2]=d}return u}finally{a.close()}}l(sz,"readImageUsingVideoFrame");function lz(i,e,t,n){return i.addEventListener(e,t,n),{unsubscribe:l(()=>{i.removeEventListener(e,t,n)},"unsubscribe")}}l(lz,"subscribe");function XC(i){return i*Math.PI/180}l(XC,"degreesToRadians");R();R();var fme="AbortError";function K1(){return new Error(fme)}l(K1,"createAbortError");var mme=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),u_,ZS,Mn={now:mme,frameAsync(i){return new Promise((e,t)=>{let n=requestAnimationFrame(e);i.signal.addEventListener("abort",()=>{cancelAnimationFrame(n),t(K1())})})},getImageData(i,e=0){return this.getImageCanvasContext(i).getImageData(-e,-e,i.width+2*e,i.height+2*e)},getImageCanvasContext(i){let e=window.document.createElement("canvas"),t=e.getContext("2d",{willReadFrequently:!0});if(!t)throw new Error("failed to create canvas 2d context");return e.width=i.width,e.height=i.height,t.drawImage(i,0,0,i.width,i.height),t},resolveURL(i){return u_||(u_=document.createElement("a")),u_.href=i,u_.href},hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return matchMedia?(ZS==null&&(ZS=matchMedia("(prefers-reduced-motion: reduce)")),ZS.matches):!1}};R();var gme=ii(Rn(),1),vp=class Lr{static testProp(e){if(!Lr.docStyle)return e[0];for(let t=0;t<e.length;t++)if(e[t]in Lr.docStyle)return e[t];return e[0]}static create(e,t,n){let r=window.document.createElement(e);return t!==void 0&&(r.className=t),n&&n.appendChild(r),r}static createNS(e,t){return window.document.createElementNS(e,t)}static disableDrag(){Lr.docStyle&&Lr.selectProp&&(Lr.userSelect=Lr.docStyle[Lr.selectProp],Lr.docStyle[Lr.selectProp]="none")}static enableDrag(){Lr.docStyle&&Lr.selectProp&&(Lr.docStyle[Lr.selectProp]=Lr.userSelect)}static setTransform(e,t){e.style[Lr.transformProp]=t}static addEventListener(e,t,n,r={}){"passive"in r?e.addEventListener(t,n,r):e.addEventListener(t,n,r.capture)}static removeEventListener(e,t,n,r={}){"passive"in r?e.removeEventListener(t,n,r):e.removeEventListener(t,n,r.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",Lr.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",Lr.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",Lr.suppressClickInternal,!0)},0)}static getScale(e){let t=e.getBoundingClientRect();return{x:t.width/e.offsetWidth||1,y:t.height/e.offsetHeight||1,boundingClientRect:t}}static getPoint(e,t,n){let r=t.boundingClientRect;return new gme.default((n.clientX-r.left)/t.x-e.clientLeft,(n.clientY-r.top)/t.y-e.clientTop)}static mousePos(e,t){let n=Lr.getScale(e);return Lr.getPoint(e,n,t)}static touchPos(e,t){let n=[],r=Lr.getScale(e);for(let a=0;a<t.length;a++)n.push(Lr.getPoint(e,r,t[a]));return n}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}};l(vp,"DOM"),vp.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,vp.selectProp=vp.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),vp.transformProp=vp.testProp(["transform","WebkitTransform"]);var wt=vp;R();R();R();var _s={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function n5(i){return _s.REGISTERED_PROTOCOLS[i.substring(0,i.indexOf("://"))]}l(n5,"getProtocol");function yme(i,e){_s.REGISTERED_PROTOCOLS[i]=e}l(yme,"addProtocol");function vme(i){delete _s.REGISTERED_PROTOCOLS[i]}l(vme,"removeProtocol");R();var ZC="global-dispatcher",uz=class extends Error{constructor(e,t,n,r){super("AJAXError: ".concat(t," (").concat(e,"): ").concat(n)),this.status=e,this.statusText=t,this.url=n,this.body=r}};l(uz,"AJAXError");var r5=uz,a5=l(()=>fd(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,"getReferrer"),_me=l(i=>/^file:/.test(i)||/^file:/.test(a5())&&!/^\w+:/.test(i),"isFileURL");async function hz(i,e){let t=new Request(i.url,{method:i.method||"GET",body:i.body,credentials:i.credentials,headers:i.headers,cache:i.cache,referrer:a5(),signal:e.signal});i.type==="json"&&t.headers.set("Accept","application/json");let n=await fetch(t);if(!n.ok){let o=await n.blob();throw new r5(n.status,n.statusText,i.url,o)}let r;i.type==="arrayBuffer"||i.type==="image"?r=n.arrayBuffer():i.type==="json"?r=n.json():r=n.text();let a=await r;if(e.signal.aborted)throw K1();return{data:a,cacheControl:n.headers.get("Cache-Control"),expires:n.headers.get("Expires")}}l(hz,"makeFetchRequest");function cz(i,e){return new Promise((t,n)=>{let r=new XMLHttpRequest;r.open(i.method||"GET",i.url,!0),(i.type==="arrayBuffer"||i.type==="image")&&(r.responseType="arraybuffer");for(let a in i.headers)r.setRequestHeader(a,i.headers[a]);i.type==="json"&&(r.responseType="text",r.setRequestHeader("Accept","application/json")),r.withCredentials=i.credentials==="include",r.onerror=()=>{n(new Error(r.statusText))},r.onload=()=>{if(!e.signal.aborted)if((r.status>=200&&r.status<300||r.status===0)&&r.response!==null){let a=r.response;if(i.type==="json")try{a=JSON.parse(r.response)}catch(o){n(o);return}t({data:a,cacheControl:r.getResponseHeader("Cache-Control"),expires:r.getResponseHeader("Expires")})}else{let a=new Blob([r.response],{type:r.getResponseHeader("Content-Type")});n(new r5(r.status,r.statusText,i.url,a))}},e.signal.addEventListener("abort",()=>{r.abort(),n(K1())}),r.send(i.body)})}l(cz,"makeXMLHttpRequest");var Kw=l(function(i,e){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){let t=n5(i.url);if(t)return t(i,e);if(fd(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,targetMapId:ZC},e)}if(!_me(i.url)){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return hz(i,e);if(fd(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,mustQueue:!0,targetMapId:ZC},e)}return cz(i,e)},"makeRequest"),Qw=l((i,e)=>Kw(ti(i,{type:"json"}),e),"getJSON"),xme=l((i,e)=>Kw(ti(i,{type:"arrayBuffer"}),e),"getArrayBuffer");function o5(i){if(!i||i.indexOf("://")<=0||i.indexOf("data:image/")===0||i.indexOf("blob:")===0)return!0;let e=new URL(i),t=window.location;return e.protocol===t.protocol&&e.host===t.host}l(o5,"sameOrigin");var bme=l(i=>{let e=window.document.createElement("video");return e.muted=!0,new Promise(t=>{e.onloadstart=()=>{t(e)};for(let n of i){let r=window.document.createElement("source");o5(n)||(e.crossOrigin="Anonymous"),r.src=n,e.appendChild(r)}})},"getVideo");R();R();var s5={supported:!1,testSupport:dz},ky,l5=!1,bm,pz=!1;typeof document<"u"&&(bm=document.createElement("img"),bm.onload=function(){ky&&u5(ky),ky=null,pz=!0},bm.onerror=function(){l5=!0,ky=null},bm.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");function dz(i){l5||!bm||(pz?u5(i):ky=i)}l(dz,"testSupport");function u5(i){let e=i.createTexture();i.bindTexture(i.TEXTURE_2D,e);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,bm),i.isContextLost())return;s5.supported=!0}catch{}i.deleteTexture(e),l5=!0}l(u5,"testWebpTextureUpload");var tu;(i=>{let e,t,n,r;i.resetRequestQueue=l(()=>{e=[],t=0,n=0,r={}},"resetRequestQueue"),i.addThrottleControl=l(d=>{let f=n++;return r[f]=d,f},"addThrottleControl"),i.removeThrottleControl=l(d=>{delete r[d],u()},"removeThrottleControl");let a=l(()=>{for(let d of Object.keys(r))if(r[d]())return!0;return!1},"isThrottled");i.getImage=l((d,f,m=!0)=>new Promise((v,b)=>{s5.supported&&(d.headers||(d.headers={}),d.headers.accept="image/webp,*/*"),ti(d,{type:"image"});let w={abortController:f,requestParameters:d,supportImageRefresh:m,state:"queued",onError:l(A=>{b(A)},"onError"),onSuccess:l(A=>{v(A)},"onSuccess")};e.push(w),u()}),"getImage");let o=l(d=>typeof createImageBitmap=="function"?pme(d):dme(d),"arrayBufferToCanvasImageSource"),s=l(async d=>{d.state="running";let{requestParameters:f,supportImageRefresh:m,onError:v,onSuccess:b,abortController:w}=d,A=m===!1&&!fd(self)&&!n5(f.url)&&(!f.headers||Object.keys(f.headers).reduce((I,C)=>I&&C==="accept",!0));t++;let E=A?h(f,w):Kw(f,w);try{let I=await E;if(delete d.abortController,d.state="completed",I.data instanceof HTMLImageElement||eu(I.data))b(I);else if(I.data){let C=await o(I.data);b({data:C,cacheControl:I.cacheControl,expires:I.expires})}}catch(I){delete d.abortController,v(I)}finally{t--,u()}},"doImageRequest"),u=l(()=>{let d=a()?_s.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:_s.MAX_PARALLEL_IMAGE_REQUESTS;for(let f=t;f<d&&e.length>0;f++){let m=e.shift();if(m.abortController.signal.aborted){f--;continue}s(m)}},"processQueue"),h=l((d,f)=>new Promise((m,v)=>{let b=new Image,w=d.url,A=d.credentials;A&&A==="include"?b.crossOrigin="use-credentials":(A&&A==="same-origin"||!o5(w))&&(b.crossOrigin="anonymous"),f.signal.addEventListener("abort",()=>{b.src="",v(K1())}),b.fetchPriority="high",b.onload=()=>{b.onerror=b.onload=null,m({data:b})},b.onerror=()=>{b.onerror=b.onload=null,!f.signal.aborted&&v(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},b.src=w}),"getImageUsingHtmlImage")})(tu||(tu={}));tu.resetRequestQueue();R();var fz=class{constructor(e){this._transformRequestFn=e}transformRequest(e,t){return this._transformRequestFn?this._transformRequestFn(e,t)||{url:e}:{url:e}}normalizeSpriteURL(e,t,n){let r=mz(e);return r.path+="".concat(t).concat(n),gz(r)}setTransformRequest(e){this._transformRequestFn=e}};l(fz,"RequestManager");var wme=fz,Ame=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function mz(i){let e=i.match(Ame);if(!e)throw new Error('Unable to parse URL "'.concat(i,'"'));return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}l(mz,"parseUrl");function gz(i){let e=i.params.length?"?".concat(i.params.join("&")):"";return"".concat(i.protocol,"://").concat(i.authority).concat(i.path).concat(e)}l(gz,"formatUrl");R();R();function YC(i,e,t){t[i]&&t[i].indexOf(e)!==-1||(t[i]=t[i]||[],t[i].push(e))}l(YC,"_addEventListener");function J_(i,e,t){if(t&&t[i]){let n=t[i].indexOf(e);n!==-1&&t[i].splice(n,1)}}l(J_,"_removeEventListener");var yz=class{constructor(e,t={}){ti(this,t),this.type=e}};l(yz,"Event");var Tt=yz,vz=class extends Tt{constructor(e,t={}){super("error",ti({error:e},t))}};l(vz,"ErrorEvent");var ki=vz,_z=class{on(e,t){return this._listeners=this._listeners||{},YC(e,t,this._listeners),this}off(e,t){return J_(e,t,this._listeners),J_(e,t,this._oneTimeListeners),this}once(e,t){return t?(this._oneTimeListeners=this._oneTimeListeners||{},YC(e,t,this._oneTimeListeners),this):new Promise(n=>this.once(e,n))}fire(e,t){typeof e=="string"&&(e=new Tt(e,t||{}));let n=e.type;if(this.listens(n)){e.target=this;let r=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];for(let s of r)s.call(this,e);let a=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];for(let s of a)J_(n,s,this._oneTimeListeners),s.call(this,e);let o=this._eventedParent;o&&(ti(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),o.fire(e))}else e instanceof ki&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,t){return this._eventedParent=e,this._eventedParentData=t,this}};l(_z,"Evented");var uo=_z;R();R();R();R();var Sme=8,Mme={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},Cme={"*":{type:"source"}},Eme=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],Ime={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Tme={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Pme={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Lme={type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},Dme={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},kme={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Rme={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},Ome=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],Nme={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Fme={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Bme={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},zme={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Ume={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Vme={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},jme={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Gme={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},$me={type:"array",value:"*"},Hme={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},Wme={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},qme={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},Xme={type:"array",value:"*",minimum:1},Zme={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},Yme={"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},Jme={source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},Kme={type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},Qme=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],ege={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},tge={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},ige={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},nge={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},rge={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},age={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},oge={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},sge={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},lge={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},uge={"*":{type:"string"}},ht={$version:Sme,$root:Mme,sources:Cme,source:Eme,source_vector:Ime,source_raster:Tme,source_raster_dem:Pme,source_geojson:Lme,source_video:Dme,source_image:kme,layer:Rme,layout:Ome,layout_background:Nme,layout_fill:Fme,layout_circle:Bme,layout_heatmap:zme,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:Ume,layout_symbol:Vme,layout_raster:jme,layout_hillshade:Gme,filter:$me,filter_operator:Hme,geometry_type:Wme,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:qme,expression:Xme,light:Zme,sky:Yme,terrain:Jme,projection:Kme,paint:Qme,paint_fill:ege,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:tge,paint_circle:ige,paint_heatmap:nge,paint_symbol:rge,paint_raster:age,paint_hillshade:oge,paint_background:sge,transition:lge,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:uge},hge=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function xz(i,e){let t={};for(let n in i)n!=="ref"&&(t[n]=i[n]);return hge.forEach(n=>{n in e&&(t[n]=e[n])}),t}l(xz,"deref");function JC(i){i=i.slice();let e=Object.create(null);for(let t=0;t<i.length;t++)e[i[t].id]=i[t];for(let t=0;t<i.length;t++)"ref"in i[t]&&(i[t]=xz(i[t],e[i[t].ref]));return i}l(JC,"derefLayers");function Vn(i,e){if(Array.isArray(i)){if(!Array.isArray(e)||i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(!Vn(i[t],e[t]))return!1;return!0}if(typeof i=="object"&&i!==null&&e!==null){if(typeof e!="object"||Object.keys(i).length!==Object.keys(e).length)return!1;for(let t in i)if(!Vn(i[t],e[t]))return!1;return!0}return i===e}l(Vn,"deepEqual");function os(i,e){i.push(e)}l(os,"addCommand");function h5(i,e,t){os(t,{command:"addSource",args:[i,e[i]]})}l(h5,"addSource");function c5(i,e,t){os(e,{command:"removeSource",args:[i]}),t[i]=!0}l(c5,"removeSource");function bz(i,e,t,n){c5(i,t,n),h5(i,e,t)}l(bz,"updateSource");function wz(i,e,t){let n;for(n in i[t])if(Object.prototype.hasOwnProperty.call(i[t],n)&&n!=="data"&&!Vn(i[t][n],e[t][n]))return!1;for(n in e[t])if(Object.prototype.hasOwnProperty.call(e[t],n)&&n!=="data"&&!Vn(i[t][n],e[t][n]))return!1;return!0}l(wz,"canUpdateGeoJSON");function Az(i,e,t,n){i=i||{},e=e||{};let r;for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(Object.prototype.hasOwnProperty.call(e,r)||c5(r,t,n));for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&(Object.prototype.hasOwnProperty.call(i,r)?Vn(i[r],e[r])||(i[r].type==="geojson"&&e[r].type==="geojson"&&wz(i,e,r)?os(t,{command:"setGeoJSONSourceData",args:[r,e[r].data]}):bz(r,e,t,n)):h5(r,e,t))}l(Az,"diffSources");function Ry(i,e,t,n,r,a){i=i||{},e=e||{};for(let o in i)Object.prototype.hasOwnProperty.call(i,o)&&(Vn(i[o],e[o])||t.push({command:a,args:[n,o,e[o],r]}));for(let o in e)!Object.prototype.hasOwnProperty.call(e,o)||Object.prototype.hasOwnProperty.call(i,o)||Vn(i[o],e[o])||t.push({command:a,args:[n,o,e[o],r]})}l(Ry,"diffLayerPropertyChanges");function KC(i){return i.id}l(KC,"pluckId");function QC(i,e){return i[e.id]=e,i}l(QC,"indexById");function Sz(i,e,t){i=i||[],e=e||[];let n=i.map(KC),r=e.map(KC),a=i.reduce(QC,{}),o=e.reduce(QC,{}),s=n.slice(),u=Object.create(null),h,d,f,m,v;for(let b=0,w=0;b<n.length;b++)h=n[b],Object.prototype.hasOwnProperty.call(o,h)?w++:(os(t,{command:"removeLayer",args:[h]}),s.splice(s.indexOf(h,w),1));for(let b=0,w=0;b<r.length;b++)h=r[r.length-1-b],s[s.length-1-b]!==h&&(Object.prototype.hasOwnProperty.call(a,h)?(os(t,{command:"removeLayer",args:[h]}),s.splice(s.lastIndexOf(h,s.length-w),1)):w++,m=s[s.length-b],os(t,{command:"addLayer",args:[o[h],m]}),s.splice(s.length-b,0,h),u[h]=!0);for(let b=0;b<r.length;b++)if(h=r[b],d=a[h],f=o[h],!(u[h]||Vn(d,f))){if(!Vn(d.source,f.source)||!Vn(d["source-layer"],f["source-layer"])||!Vn(d.type,f.type)){os(t,{command:"removeLayer",args:[h]}),m=s[s.lastIndexOf(h)+1],os(t,{command:"addLayer",args:[f,m]});continue}Ry(d.layout,f.layout,t,h,null,"setLayoutProperty"),Ry(d.paint,f.paint,t,h,null,"setPaintProperty"),Vn(d.filter,f.filter)||os(t,{command:"setFilter",args:[h,f.filter]}),(!Vn(d.minzoom,f.minzoom)||!Vn(d.maxzoom,f.maxzoom))&&os(t,{command:"setLayerZoomRange",args:[h,f.minzoom,f.maxzoom]});for(v in d)Object.prototype.hasOwnProperty.call(d,v)&&(v==="layout"||v==="paint"||v==="filter"||v==="metadata"||v==="minzoom"||v==="maxzoom"||(v.indexOf("paint.")===0?Ry(d[v],f[v],t,h,v.slice(6),"setPaintProperty"):Vn(d[v],f[v])||os(t,{command:"setLayerProperty",args:[h,v,f[v]]})));for(v in f)!Object.prototype.hasOwnProperty.call(f,v)||Object.prototype.hasOwnProperty.call(d,v)||v==="layout"||v==="paint"||v==="filter"||v==="metadata"||v==="minzoom"||v==="maxzoom"||(v.indexOf("paint.")===0?Ry(d[v],f[v],t,h,v.slice(6),"setPaintProperty"):Vn(d[v],f[v])||os(t,{command:"setLayerProperty",args:[h,v,f[v]]}))}}l(Sz,"diffLayers");function Mz(i,e){if(!i)return[{command:"setStyle",args:[e]}];let t=[];try{if(!Vn(i.version,e.version))return[{command:"setStyle",args:[e]}];Vn(i.center,e.center)||t.push({command:"setCenter",args:[e.center]}),Vn(i.zoom,e.zoom)||t.push({command:"setZoom",args:[e.zoom]}),Vn(i.bearing,e.bearing)||t.push({command:"setBearing",args:[e.bearing]}),Vn(i.pitch,e.pitch)||t.push({command:"setPitch",args:[e.pitch]}),Vn(i.roll,e.roll)||t.push({command:"setRoll",args:[e.roll]}),Vn(i.sprite,e.sprite)||t.push({command:"setSprite",args:[e.sprite]}),Vn(i.glyphs,e.glyphs)||t.push({command:"setGlyphs",args:[e.glyphs]}),Vn(i.transition,e.transition)||t.push({command:"setTransition",args:[e.transition]}),Vn(i.light,e.light)||t.push({command:"setLight",args:[e.light]}),Vn(i.terrain,e.terrain)||t.push({command:"setTerrain",args:[e.terrain]}),Vn(i.sky,e.sky)||t.push({command:"setSky",args:[e.sky]}),Vn(i.projection,e.projection)||t.push({command:"setProjection",args:[e.projection]});let n={},r=[];Az(i.sources,e.sources,r,n);let a=[];i.layers&&i.layers.forEach(o=>{"source"in o&&n[o.source]?t.push({command:"removeLayer",args:[o.id]}):a.push(o)}),t=t.concat(r),Sz(a,e.layers,t)}catch(n){console.warn("Unable to compute style diff:",n),t=[{command:"setStyle",args:[e]}]}return t}l(Mz,"diffStyles");var Cz=class{constructor(e,t,n,r){this.message=(e?"".concat(e,": "):"")+n,r&&(this.identifier=r),t!=null&&t.__line__&&(this.line=t.__line__)}};l(Cz,"ValidationError");var Rt=Cz;function md(i,...e){for(let t of e)for(let n in t)i[n]=t[n];return i}l(md,"extendBy");var Ez=class extends Error{constructor(e,t){super(t),this.message=t,this.key=e}};l(Ez,"ExpressionParsingError");var Xl=Ez,Iz=class Tz{constructor(e,t=[]){this.parent=e,this.bindings={};for(let[n,r]of t)this.bindings[n]=r}concat(e){return new Tz(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error("".concat(e," not found in scope."))}has(e){return this.bindings[e]?!0:this.parent?this.parent.has(e):!1}};l(Iz,"Scope");var cge=Iz,Q1={kind:"null"},Gt={kind:"number"},dn={kind:"string"},Qi={kind:"boolean"},gl={kind:"color"},zm={kind:"object"},en={kind:"value"},pge={kind:"error"},eA={kind:"collator"},e0={kind:"formatted"},tA={kind:"padding"},t0={kind:"resolvedImage"},iA={kind:"variableAnchorOffsetCollection"};function $o(i,e){return{kind:"array",itemType:i,N:e}}l($o,"array$1");function yr(i){if(i.kind==="array"){let e=yr(i.itemType);return typeof i.N=="number"?"array<".concat(e,", ").concat(i.N,">"):i.itemType.kind==="value"?"array":"array<".concat(e,">")}else return i.kind}l(yr,"toString$1");var dge=[Q1,Gt,dn,Qi,gl,e0,zm,$o(en),tA,t0,iA];function pg(i,e){if(e.kind==="error")return null;if(i.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!pg(i.itemType,e.itemType))&&(typeof i.N!="number"||i.N===e.N))return null}else{if(i.kind===e.kind)return null;if(i.kind==="value"){for(let t of dge)if(!pg(t,e))return null}}return"Expected ".concat(yr(i)," but found ").concat(yr(e)," instead.")}l(pg,"checkSubtype");function nA(i,e){return e.some(t=>t.kind===i.kind)}l(nA,"isValidType");function Pc(i,e){return e.some(t=>t==="null"?i===null:t==="array"?Array.isArray(i):t==="object"?i&&!Array.isArray(i)&&typeof i=="object":t===typeof i)}l(Pc,"isValidNativeType");function mf(i,e){return i.kind==="array"&&e.kind==="array"?i.itemType.kind===e.itemType.kind&&typeof i.N=="number":i.kind===e.kind}l(mf,"verifyType");var Pz=.96422,Lz=1,Dz=.82521,kz=4/29,Um=6/29,Rz=3*Um*Um,fge=Um*Um*Um,mge=Math.PI/180,gge=180/Math.PI;function p5(i){return i=i%360,i<0&&(i+=360),i}l(p5,"constrainAngle");function d5([i,e,t,n]){i=K_(i),e=K_(e),t=K_(t);let r,a,o=Q_((.2225045*i+.7168786*e+.0606169*t)/Lz);i===e&&e===t?r=a=o:(r=Q_((.4360747*i+.3850649*e+.1430804*t)/Pz),a=Q_((.0139322*i+.0971045*e+.7141733*t)/Dz));let s=116*o-16;return[s<0?0:s,500*(r-o),200*(o-a),n]}l(d5,"rgbToLab");function K_(i){return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}l(K_,"rgb2xyz");function Q_(i){return i>fge?Math.pow(i,1/3):i/Rz+kz}l(Q_,"xyz2lab");function f5([i,e,t,n]){let r=(i+16)/116,a=isNaN(e)?r:r+e/500,o=isNaN(t)?r:r-t/200;return r=Lz*tx(r),a=Pz*tx(a),o=Dz*tx(o),[ex(3.1338561*a-1.6168667*r-.4906146*o),ex(-.9787684*a+1.9161415*r+.033454*o),ex(.0719453*a-.2289914*r+1.4052427*o),n]}l(f5,"labToRgb");function ex(i){return i=i<=.00304?12.92*i:1.055*Math.pow(i,1/2.4)-.055,i<0?0:i>1?1:i}l(ex,"xyz2rgb");function tx(i){return i>Um?i*i*i:Rz*(i-kz)}l(tx,"lab2xyz");function Oz(i){let[e,t,n,r]=d5(i),a=Math.sqrt(t*t+n*n);return[Math.round(a*1e4)?p5(Math.atan2(n,t)*gge):NaN,a,e,r]}l(Oz,"rgbToHcl");function Nz([i,e,t,n]){return i=isNaN(i)?0:i*mge,f5([t,Math.cos(i)*e,Math.sin(i)*e,n])}l(Nz,"hclToRgb");function Fz([i,e,t,n]){i=p5(i),e/=100,t/=100;function r(a){let o=(a+i/30)%12,s=e*Math.min(t,1-t);return t-s*Math.max(-1,Math.min(o-3,9-o,1))}return l(r,"f"),[r(0),r(8),r(4),n]}l(Fz,"hslToRgb");function Bz(i){if(i=i.toLowerCase().trim(),i==="transparent")return[0,0,0,0];let e=yge[i];if(e){let[r,a,o]=e;return[r/255,a/255,o/255,1]}if(i.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(i)){let r=i.length<6?1:2,a=1;return[Oy(i.slice(a,a+=r)),Oy(i.slice(a,a+=r)),Oy(i.slice(a,a+=r)),Oy(i.slice(a,a+r)||"ff")]}if(i.startsWith("rgb")){let r=/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,a=i.match(r);if(a){let[o,s,u,h,d,f,m,v,b,w,A,E]=a,I=[h||" ",m||" ",w].join("");if(I==="  "||I==="  /"||I===",,"||I===",,,"){let C=[u,f,b].join(""),T=C==="%%%"?100:C===""?255:0;if(T){let k=[Up(+s/T,0,1),Up(+d/T,0,1),Up(+v/T,0,1),A?e3(+A,E):1];if(t3(k))return k}}return}}let t=/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,n=i.match(t);if(n){let[r,a,o,s,u,h,d,f,m]=n,v=[o||" ",u||" ",d].join("");if(v==="  "||v==="  /"||v===",,"||v===",,,"){let b=[+a,Up(+s,0,100),Up(+h,0,100),f?e3(+f,m):1];if(t3(b))return Fz(b)}}}l(Bz,"parseCssColor");function Oy(i){return parseInt(i.padEnd(2,i),16)/255}l(Oy,"parseHex");function e3(i,e){return Up(e?i/100:i,0,1)}l(e3,"parseAlpha");function Up(i,e,t){return Math.min(Math.max(e,i),t)}l(Up,"clamp");function t3(i){return!i.some(Number.isNaN)}l(t3,"validateNumbers");var yge={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},zz=class i3{constructor(e,t,n,r=1,a=!0){this.r=e,this.g=t,this.b=n,this.a=r,a||(this.r*=r,this.g*=r,this.b*=r,r||this.overwriteGetter("rgb",[e,t,n,r]))}static parse(e){if(e instanceof i3)return e;if(typeof e!="string")return;let t=Bz(e);if(t)return new i3(...t,!1)}get rgb(){let{r:e,g:t,b:n,a:r}=this,a=r||1/0;return this.overwriteGetter("rgb",[e/a,t/a,n/a,r])}get hcl(){return this.overwriteGetter("hcl",Oz(this.rgb))}get lab(){return this.overwriteGetter("lab",d5(this.rgb))}overwriteGetter(e,t){return Object.defineProperty(this,e,{value:t}),t}toString(){let[e,t,n,r]=this.rgb;return"rgba(".concat([e,t,n].map(a=>Math.round(a*255)).join(","),",").concat(r,")")}};l(zz,"Color");var Wi=zz;Wi.black=new Wi(0,0,0,1);Wi.white=new Wi(1,1,1,1);Wi.transparent=new Wi(0,0,0,0);Wi.red=new Wi(1,0,0,1);var Uz=class{constructor(e,t,n){e?this.sensitivity=t?"variant":"case":this.sensitivity=t?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}};l(Uz,"Collator");var m5=Uz,Vz=class{constructor(e,t,n,r,a){this.text=e,this.image=t,this.scale=n,this.fontStack=r,this.textColor=a}};l(Vz,"FormattedSection");var n3=Vz,jz=class ix{constructor(e){this.sections=e}static fromString(e){return new ix([new n3(e,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof ix?e:ix.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}};l(jz,"Formatted");var fh=jz,Gz=class nx{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof nx)return e;if(typeof e=="number")return new nx([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(let t of e)if(typeof t!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]];break}return new nx(e)}}toString(){return JSON.stringify(this.values)}};l(Gz,"Padding");var bh=Gz,vge=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]),$z=class r3{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof r3)return e;if(!(!Array.isArray(e)||e.length<1||e.length%2!==0)){for(let t=0;t<e.length;t+=2){let n=e[t],r=e[t+1];if(typeof n!="string"||!vge.has(n)||!Array.isArray(r)||r.length!==2||typeof r[0]!="number"||typeof r[1]!="number")return}return new r3(e)}}toString(){return JSON.stringify(this.values)}};l($z,"VariableAnchorOffsetCollection");var Td=$z,Hz=class Wz{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Wz({name:e,available:!1}):null}};l(Hz,"ResolvedImage");var uu=Hz;function g5(i,e,t,n){if(!(typeof i=="number"&&i>=0&&i<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255)){let r=typeof n=="number"?[i,e,t,n]:[i,e,t];return"Invalid rgba value [".concat(r.join(", "),"]: 'r', 'g', and 'b' must be between 0 and 255.")}return typeof n>"u"||typeof n=="number"&&n>=0&&n<=1?null:"Invalid rgba value [".concat([i,e,t,n].join(", "),"]: 'a' must be between 0 and 1.")}l(g5,"validateRGBA");function dg(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof Wi||i instanceof m5||i instanceof fh||i instanceof bh||i instanceof Td||i instanceof uu)return!0;if(Array.isArray(i)){for(let e of i)if(!dg(e))return!1;return!0}else if(typeof i=="object"){for(let e in i)if(!dg(i[e]))return!1;return!0}else return!1}l(dg,"isValue");function Jr(i){if(i===null)return Q1;if(typeof i=="string")return dn;if(typeof i=="boolean")return Qi;if(typeof i=="number")return Gt;if(i instanceof Wi)return gl;if(i instanceof m5)return eA;if(i instanceof fh)return e0;if(i instanceof bh)return tA;if(i instanceof Td)return iA;if(i instanceof uu)return t0;if(Array.isArray(i)){let e=i.length,t;for(let n of i){let r=Jr(n);if(!t)t=r;else{if(t===r)continue;t=en;break}}return $o(t||en,e)}else return zm}l(Jr,"typeOf");function Vm(i){let e=typeof i;return i===null?"":e==="string"||e==="number"||e==="boolean"?String(i):i instanceof Wi||i instanceof fh||i instanceof bh||i instanceof Td||i instanceof uu?i.toString():JSON.stringify(i)}l(Vm,"toString");var qz=class Xz{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(!dg(e[1]))return t.error("invalid value");let n=e[1],r=Jr(n),a=t.expectedType;return r.kind==="array"&&r.N===0&&a&&a.kind==="array"&&(typeof a.N!="number"||a.N===0)&&(r=a),new Xz(r,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}};l(qz,"Literal");var Qv=qz,Zz=class{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}};l(Zz,"RuntimeError");var Kr=Zz,h_={string:dn,number:Gt,boolean:Qi,object:zm},Yz=class Jz{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let n=1,r,a=e[0];if(a==="array"){let s;if(e.length>2){let h=e[1];if(typeof h!="string"||!(h in h_)||h==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);s=h_[h],n++}else s=en;let u;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);u=e[2],n++}r=$o(s,u)}else{if(!h_[a])throw new Error("Types doesn't contain name = ".concat(a));r=h_[a]}let o=[];for(;n<e.length;n++){let s=t.parse(e[n],n,en);if(!s)return null;o.push(s)}return new Jz(r,o)}evaluate(e){for(let t=0;t<this.args.length;t++){let n=this.args[t].evaluate(e);if(pg(this.type,Jr(n))){if(t===this.args.length-1)throw new Kr("Expected value to be of type ".concat(yr(this.type),", but found ").concat(yr(Jr(n))," instead."))}else return n}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}};l(Yz,"Assertion");var oh=Yz,kk={"to-boolean":Qi,"to-color":gl,"to-number":Gt,"to-string":dn},Kz=class Qz{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let n=e[0];if(!kk[n])throw new Error("Can't parse ".concat(n," as it is not part of the known types"));if((n==="to-boolean"||n==="to-string")&&e.length!==2)return t.error("Expected one argument.");let r=kk[n],a=[];for(let o=1;o<e.length;o++){let s=t.parse(e[o],o,en);if(!s)return null;a.push(s)}return new Qz(r,a)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let t,n;for(let r of this.args){if(t=r.evaluate(e),n=null,t instanceof Wi)return t;if(typeof t=="string"){let a=e.parseColor(t);if(a)return a}else if(Array.isArray(t)&&(t.length<3||t.length>4?n="Invalid rgba value ".concat(JSON.stringify(t),": expected an array containing either three or four numeric values."):n=g5(t[0],t[1],t[2],t[3]),!n))return new Wi(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Kr(n||"Could not parse color from value '".concat(typeof t=="string"?t:JSON.stringify(t),"'"))}case"padding":{let t;for(let n of this.args){t=n.evaluate(e);let r=bh.parse(t);if(r)return r}throw new Kr("Could not parse padding from value '".concat(typeof t=="string"?t:JSON.stringify(t),"'"))}case"variableAnchorOffsetCollection":{let t;for(let n of this.args){t=n.evaluate(e);let r=Td.parse(t);if(r)return r}throw new Kr("Could not parse variableAnchorOffsetCollection from value '".concat(typeof t=="string"?t:JSON.stringify(t),"'"))}case"number":{let t=null;for(let n of this.args){if(t=n.evaluate(e),t===null)return 0;let r=Number(t);if(!isNaN(r))return r}throw new Kr("Could not convert ".concat(JSON.stringify(t)," to number."))}case"formatted":return fh.fromString(Vm(this.args[0].evaluate(e)));case"resolvedImage":return uu.fromString(Vm(this.args[0].evaluate(e)));default:return Vm(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}};l(Kz,"Coercion");var wm=Kz,_ge=["Unknown","Point","LineString","Polygon"],eU=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?_ge[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=Wi.parse(e)),t}};l(eU,"EvaluationContext");var tU=eU,iU=class nU{constructor(e,t,n=[],r,a=new cge,o=[]){this.registry=e,this.path=n,this.key=n.map(s=>"[".concat(s,"]")).join(""),this.scope=a,this.errors=o,this.expectedType=r,this._isConstant=t}parse(e,t,n,r,a={}){return t?this.concat(t,n,r)._parse(e,a):this._parse(e,a)}_parse(e,t){(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number")&&(e=["literal",e]);function n(r,a,o){return o==="assert"?new oh(a,[r]):o==="coerce"?new wm(a,[r]):r}if(l(n,"annotate"),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let r=e[0];if(typeof r!="string")return this.error("Expression name must be a string, but found ".concat(typeof r,' instead. If you wanted a literal array, use ["literal", [...]].'),0),null;let a=this.registry[r];if(a){let o=a.parse(e,this);if(!o)return null;if(this.expectedType){let s=this.expectedType,u=o.type;if((s.kind==="string"||s.kind==="number"||s.kind==="boolean"||s.kind==="object"||s.kind==="array")&&u.kind==="value")o=n(o,s,t.typeAnnotation||"assert");else if((s.kind==="color"||s.kind==="formatted"||s.kind==="resolvedImage")&&(u.kind==="value"||u.kind==="string"))o=n(o,s,t.typeAnnotation||"coerce");else if(s.kind==="padding"&&(u.kind==="value"||u.kind==="number"||u.kind==="array"))o=n(o,s,t.typeAnnotation||"coerce");else if(s.kind==="variableAnchorOffsetCollection"&&(u.kind==="value"||u.kind==="array"))o=n(o,s,t.typeAnnotation||"coerce");else if(this.checkSubtype(s,u))return null}if(!(o instanceof Qv)&&o.type.kind!=="resolvedImage"&&this._isConstant(o)){let s=new tU;try{o=new Qv(o.type,o.evaluate(s))}catch(u){return this.error(u.message),null}}return o}return this.error('Unknown expression "'.concat(r,'". If you wanted a literal array, use ["literal", [...]].'),0)}else return typeof e>"u"?this.error("'undefined' value invalid. Use null instead."):typeof e=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found ".concat(typeof e," instead."))}concat(e,t,n){let r=typeof e=="number"?this.path.concat(e):this.path,a=n?this.scope.concat(n):this.scope;return new nU(this.registry,this._isConstant,r,t||null,a,this.errors)}error(e,...t){let n="".concat(this.key).concat(t.map(r=>"[".concat(r,"]")).join(""));this.errors.push(new Xl(n,e))}checkSubtype(e,t){let n=pg(e,t);return n&&this.error(n),n}};l(iU,"ParsingContext");var rU=iU,aU=class oU{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(let t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found ".concat(e.length-1," instead."));let n=[];for(let a=1;a<e.length-1;a+=2){let o=e[a];if(typeof o!="string")return t.error("Expected string, but found ".concat(typeof o," instead."),a);if(/[^a-zA-Z0-9_]/.test(o))return t.error("Variable names must contain only alphanumeric characters or '_'.",a);let s=t.parse(e[a+1],a+1);if(!s)return null;n.push([o,s])}let r=t.parse(e[e.length-1],e.length-1,t.expectedType,n);return r?new oU(n,r):null}outputDefined(){return this.result.outputDefined()}};l(aU,"Let");var sU=aU,lU=class uU{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");let n=e[1];return t.scope.has(n)?new uU(n,t.scope.get(n)):t.error('Unknown variable "'.concat(n,'". Make sure "').concat(n,'" has been bound in an enclosing "let" expression before using it.'),1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}};l(lU,"Var");var hU=lU,cU=class pU{constructor(e,t,n){this.type=e,this.index=t,this.input=n}static parse(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found ".concat(e.length-1," instead."));let n=t.parse(e[1],1,Gt),r=t.parse(e[2],2,$o(t.expectedType||en));if(!n||!r)return null;let a=r.type;return new pU(a.itemType,n,r)}evaluate(e){let t=this.index.evaluate(e),n=this.input.evaluate(e);if(t<0)throw new Kr("Array index out of bounds: ".concat(t," < 0."));if(t>=n.length)throw new Kr("Array index out of bounds: ".concat(t," > ").concat(n.length-1,"."));if(t!==Math.floor(t))throw new Kr("Array index must be an integer, but found ".concat(t," instead."));return n[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}};l(cU,"At");var xge=cU,dU=class fU{constructor(e,t){this.type=Qi,this.needle=e,this.haystack=t}static parse(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found ".concat(e.length-1," instead."));let n=t.parse(e[1],1,en),r=t.parse(e[2],2,en);return!n||!r?null:nA(n.type,[Qi,dn,Gt,Q1,en])?new fU(n,r):t.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(yr(n.type)," instead"))}evaluate(e){let t=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(!n)return!1;if(!Pc(t,["boolean","string","number","null"]))throw new Kr("Expected first argument to be of type boolean, string, number or null, but found ".concat(yr(Jr(t))," instead."));if(!Pc(n,["string","array"]))throw new Kr("Expected second argument to be of type array or string, but found ".concat(yr(Jr(n))," instead."));return n.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}};l(dU,"In");var bge=dU,mU=class a3{constructor(e,t,n){this.type=Gt,this.needle=e,this.haystack=t,this.fromIndex=n}static parse(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found ".concat(e.length-1," instead."));let n=t.parse(e[1],1,en),r=t.parse(e[2],2,en);if(!n||!r)return null;if(!nA(n.type,[Qi,dn,Gt,Q1,en]))return t.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(yr(n.type)," instead"));if(e.length===4){let a=t.parse(e[3],3,Gt);return a?new a3(n,r,a):null}else return new a3(n,r)}evaluate(e){let t=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(!Pc(t,["boolean","string","number","null"]))throw new Kr("Expected first argument to be of type boolean, string, number or null, but found ".concat(yr(Jr(t))," instead."));let r;if(this.fromIndex&&(r=this.fromIndex.evaluate(e)),Pc(n,["string"])){let a=n.indexOf(t,r);return a===-1?-1:[...n.slice(0,a)].length}else{if(Pc(n,["array"]))return n.indexOf(t,r);throw new Kr("Expected second argument to be of type array or string, but found ".concat(yr(Jr(n))," instead."))}}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}};l(mU,"IndexOf");var wge=mU,gU=class yU{constructor(e,t,n,r,a,o){this.inputType=e,this.type=t,this.input=n,this.cases=r,this.outputs=a,this.otherwise=o}static parse(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if(e.length%2!==1)return t.error("Expected an even number of arguments.");let n,r;t.expectedType&&t.expectedType.kind!=="value"&&(r=t.expectedType);let a={},o=[];for(let h=2;h<e.length-1;h+=2){let d=e[h],f=e[h+1];Array.isArray(d)||(d=[d]);let m=t.concat(h);if(d.length===0)return m.error("Expected at least one branch label.");for(let b of d){if(typeof b!="number"&&typeof b!="string")return m.error("Branch labels must be numbers or strings.");if(typeof b=="number"&&Math.abs(b)>Number.MAX_SAFE_INTEGER)return m.error("Branch labels must be integers no larger than ".concat(Number.MAX_SAFE_INTEGER,"."));if(typeof b=="number"&&Math.floor(b)!==b)return m.error("Numeric branch labels must be integer values.");if(!n)n=Jr(b);else if(m.checkSubtype(n,Jr(b)))return null;if(typeof a[String(b)]<"u")return m.error("Branch labels must be unique.");a[String(b)]=o.length}let v=t.parse(f,h,r);if(!v)return null;r=r||v.type,o.push(v)}let s=t.parse(e[1],1,en);if(!s)return null;let u=t.parse(e[e.length-1],e.length-1,r);return!u||s.type.kind!=="value"&&t.concat(1).checkSubtype(n,s.type)?null:new yU(n,r,s,a,o,u)}evaluate(e){let t=this.input.evaluate(e);return(Jr(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}};l(gU,"Match");var Age=gU,vU=class _U{constructor(e,t,n){this.type=e,this.branches=t,this.otherwise=n}static parse(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only ".concat(e.length-1,"."));if(e.length%2!==0)return t.error("Expected an odd number of arguments.");let n;t.expectedType&&t.expectedType.kind!=="value"&&(n=t.expectedType);let r=[];for(let o=1;o<e.length-1;o+=2){let s=t.parse(e[o],o,Qi);if(!s)return null;let u=t.parse(e[o+1],o+1,n);if(!u)return null;r.push([s,u]),n=n||u.type}let a=t.parse(e[e.length-1],e.length-1,n);if(!a)return null;if(!n)throw new Error("Can't infer output type");return new _U(n,r,a)}evaluate(e){for(let[t,n]of this.branches)if(t.evaluate(e))return n.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(let[t,n]of this.branches)e(t),e(n);e(this.otherwise)}outputDefined(){return this.branches.every(([e,t])=>t.outputDefined())&&this.otherwise.outputDefined()}};l(vU,"Case");var Sge=vU,xU=class o3{constructor(e,t,n,r){this.type=e,this.input=t,this.beginIndex=n,this.endIndex=r}static parse(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found ".concat(e.length-1," instead."));let n=t.parse(e[1],1,en),r=t.parse(e[2],2,Gt);if(!n||!r)return null;if(!nA(n.type,[$o(en),dn,en]))return t.error("Expected first argument to be of type array or string, but found ".concat(yr(n.type)," instead"));if(e.length===4){let a=t.parse(e[3],3,Gt);return a?new o3(n.type,n,r,a):null}else return new o3(n.type,n,r)}evaluate(e){let t=this.input.evaluate(e),n=this.beginIndex.evaluate(e),r;if(this.endIndex&&(r=this.endIndex.evaluate(e)),Pc(t,["string"]))return[...t].slice(n,r).join("");if(Pc(t,["array"]))return t.slice(n,r);throw new Kr("Expected first argument to be of type array or string, but found ".concat(yr(Jr(t))," instead."))}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}};l(xU,"Slice");var Mge=xU;function i0(i,e){let t=i.length-1,n=0,r=t,a=0,o,s;for(;n<=r;)if(a=Math.floor((n+r)/2),o=i[a],s=i[a+1],o<=e){if(a===t||e<s)return a;n=a+1}else if(o>e)r=a-1;else throw new Kr("Input is not a number.");return 0}l(i0,"findStopLessThanOrEqualTo");var bU=class wU{constructor(e,t,n){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(let[r,a]of n)this.labels.push(r),this.outputs.push(a)}static parse(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if((e.length-1)%2!==0)return t.error("Expected an even number of arguments.");let n=t.parse(e[1],1,Gt);if(!n)return null;let r=[],a=null;t.expectedType&&t.expectedType.kind!=="value"&&(a=t.expectedType);for(let o=1;o<e.length;o+=2){let s=o===1?-1/0:e[o],u=e[o+1],h=o,d=o+1;if(typeof s!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',h);if(r.length&&r[r.length-1][0]>=s)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',h);let f=t.parse(u,d,a);if(!f)return null;a=a||f.type,r.push([s,f])}return new wU(a,n,r)}evaluate(e){let t=this.labels,n=this.outputs;if(t.length===1)return n[0].evaluate(e);let r=this.input.evaluate(e);if(r<=t[0])return n[0].evaluate(e);let a=t.length;if(r>=t[a-1])return n[a-1].evaluate(e);let o=i0(t,r);return n[o].evaluate(e)}eachChild(e){e(this.input);for(let t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}};l(bU,"Step");var y5=bU;function AU(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}l(AU,"getDefaultExportFromCjs");var YS,Rk;function SU(){if(Rk)return YS;Rk=1,YS=i;function i(e,t,n,r){this.cx=3*e,this.bx=3*(n-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(r-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=n,this.p2y=r}return l(i,"UnitBezier"),i.prototype={sampleCurveX:l(function(e){return((this.ax*e+this.bx)*e+this.cx)*e},"sampleCurveX"),sampleCurveY:l(function(e){return((this.ay*e+this.by)*e+this.cy)*e},"sampleCurveY"),sampleCurveDerivativeX:l(function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},"sampleCurveDerivativeX"),solveCurveX:l(function(e,t){if(t===void 0&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var n=e,r=0;r<8;r++){var a=this.sampleCurveX(n)-e;if(Math.abs(a)<t)return n;var o=this.sampleCurveDerivativeX(n);if(Math.abs(o)<1e-6)break;n=n-a/o}var s=0,u=1;for(n=e,r=0;r<20&&(a=this.sampleCurveX(n),!(Math.abs(a-e)<t));r++)e>a?s=n:u=n,n=(u-s)*.5+s;return n},"solveCurveX"),solve:l(function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))},"solve")},YS}l(SU,"requireUnitbezier");var Cge=SU(),Ege=AU(Cge);function MU(i){return i==="rgb"||i==="hcl"||i==="lab"}l(MU,"isSupportedInterpolationColorSpace");function Lc(i,e,t){return i+t*(e-i)}l(Lc,"number");function CU(i,e,t,n="rgb"){switch(n){case"rgb":{let[r,a,o,s]=e1(i.rgb,e.rgb,t);return new Wi(r,a,o,s,!1)}case"hcl":{let[r,a,o,s]=i.hcl,[u,h,d,f]=e.hcl,m,v;if(!isNaN(r)&&!isNaN(u)){let I=u-r;u>r&&I>180?I-=360:u<r&&r-u>180&&(I+=360),m=r+t*I}else isNaN(r)?isNaN(u)?m=NaN:(m=u,(o===1||o===0)&&(v=h)):(m=r,(d===1||d===0)&&(v=a));let[b,w,A,E]=Nz([m,v??Lc(a,h,t),Lc(o,d,t),Lc(s,f,t)]);return new Wi(b,w,A,E,!1)}case"lab":{let[r,a,o,s]=f5(e1(i.lab,e.lab,t));return new Wi(r,a,o,s,!1)}}}l(CU,"color");function e1(i,e,t){return i.map((n,r)=>Lc(n,e[r],t))}l(e1,"array");function EU(i,e,t){return new bh(e1(i.values,e.values,t))}l(EU,"padding");function IU(i,e,t){let n=i.values,r=e.values;if(n.length!==r.length)throw new Kr("Cannot interpolate values of different length. from: ".concat(i.toString(),", to: ").concat(e.toString()));let a=[];for(let o=0;o<n.length;o+=2){if(n[o]!==r[o])throw new Kr("Cannot interpolate values containing mismatched anchors. from[".concat(o,"]: ").concat(n[o],", to[").concat(o,"]: ").concat(r[o]));a.push(n[o]);let[s,u]=n[o+1],[h,d]=r[o+1];a.push([Lc(s,h,t),Lc(u,d,t)])}return new Td(a)}l(IU,"variableAnchorOffsetCollection");var Mr={number:Lc,color:CU,array:e1,padding:EU,variableAnchorOffsetCollection:IU},TU=class s3{constructor(e,t,n,r,a){this.type=e,this.operator=t,this.interpolation=n,this.input=r,this.labels=[],this.outputs=[];for(let[o,s]of a)this.labels.push(o),this.outputs.push(s)}static interpolationFactor(e,t,n,r){let a=0;if(e.name==="exponential")a=rx(t,e.base,n,r);else if(e.name==="linear")a=rx(t,1,n,r);else if(e.name==="cubic-bezier"){let o=e.controlPoints;a=new Ege(o[0],o[1],o[2],o[3]).solve(rx(t,1,n,r))}return a}static parse(e,t){let[n,r,a,...o]=e;if(!Array.isArray(r)||r.length===0)return t.error("Expected an interpolation type expression.",1);if(r[0]==="linear")r={name:"linear"};else if(r[0]==="exponential"){let h=r[1];if(typeof h!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:h}}else if(r[0]==="cubic-bezier"){let h=r.slice(1);if(h.length!==4||h.some(d=>typeof d!="number"||d<0||d>1))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:h}}else return t.error("Unknown interpolation type ".concat(String(r[0])),1,0);if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if((e.length-1)%2!==0)return t.error("Expected an even number of arguments.");if(a=t.parse(a,2,Gt),!a)return null;let s=[],u=null;n==="interpolate-hcl"||n==="interpolate-lab"?u=gl:t.expectedType&&t.expectedType.kind!=="value"&&(u=t.expectedType);for(let h=0;h<o.length;h+=2){let d=o[h],f=o[h+1],m=h+3,v=h+4;if(typeof d!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',m);if(s.length&&s[s.length-1][0]>=d)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',m);let b=t.parse(f,v,u);if(!b)return null;u=u||b.type,s.push([d,b])}return!mf(u,Gt)&&!mf(u,gl)&&!mf(u,tA)&&!mf(u,iA)&&!mf(u,$o(Gt))?t.error("Type ".concat(yr(u)," is not interpolatable.")):new s3(u,n,r,a,s)}evaluate(e){let t=this.labels,n=this.outputs;if(t.length===1)return n[0].evaluate(e);let r=this.input.evaluate(e);if(r<=t[0])return n[0].evaluate(e);let a=t.length;if(r>=t[a-1])return n[a-1].evaluate(e);let o=i0(t,r),s=t[o],u=t[o+1],h=s3.interpolationFactor(this.interpolation,r,s,u),d=n[o].evaluate(e),f=n[o+1].evaluate(e);switch(this.operator){case"interpolate":return Mr[this.type.kind](d,f,h);case"interpolate-hcl":return Mr.color(d,f,h,"hcl");case"interpolate-lab":return Mr.color(d,f,h,"lab")}}eachChild(e){e(this.input);for(let t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}};l(TU,"Interpolate");var iu=TU;function rx(i,e,t,n){let r=n-t,a=i-t;return r===0?0:e===1?a/r:(Math.pow(e,a)-1)/(Math.pow(e,r)-1)}l(rx,"exponentialInterpolation");var PU=class l3{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let n=null,r=t.expectedType;r&&r.kind!=="value"&&(n=r);let a=[];for(let o of e.slice(1)){let s=t.parse(o,1+a.length,n,void 0,{typeAnnotation:"omit"});if(!s)return null;n=n||s.type,a.push(s)}if(!n)throw new Error("No output type");return r&&a.some(o=>pg(r,o.type))?new l3(en,a):new l3(n,a)}evaluate(e){let t=null,n=0,r;for(let a of this.args)if(n++,t=a.evaluate(e),t&&t instanceof uu&&!t.available&&(r||(r=t.name),t=null,n===this.args.length&&(t=r)),t!==null)break;return t}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}};l(PU,"Coalesce");var LU=PU;function u3(i,e){return i==="=="||i==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}l(u3,"isComparableType");function DU(i,e,t){return e===t}l(DU,"eq");function kU(i,e,t){return e!==t}l(kU,"neq");function RU(i,e,t){return e<t}l(RU,"lt");function OU(i,e,t){return e>t}l(OU,"gt");function NU(i,e,t){return e<=t}l(NU,"lteq");function FU(i,e,t){return e>=t}l(FU,"gteq");function v5(i,e,t,n){return n.compare(e,t)===0}l(v5,"eqCollate");function BU(i,e,t,n){return!v5(i,e,t,n)}l(BU,"neqCollate");function zU(i,e,t,n){return n.compare(e,t)<0}l(zU,"ltCollate");function UU(i,e,t,n){return n.compare(e,t)>0}l(UU,"gtCollate");function VU(i,e,t,n){return n.compare(e,t)<=0}l(VU,"lteqCollate");function jU(i,e,t,n){return n.compare(e,t)>=0}l(jU,"gteqCollate");function Pd(i,e,t){var n;let r=i!=="=="&&i!=="!=";return n=class{constructor(a,o,s){this.type=Qi,this.lhs=a,this.rhs=o,this.collator=s,this.hasUntypedArgument=a.type.kind==="value"||o.type.kind==="value"}static parse(a,o){if(a.length!==3&&a.length!==4)return o.error("Expected two or three arguments.");let s=a[0],u=o.parse(a[1],1,en);if(!u)return null;if(!u3(s,u.type))return o.concat(1).error('"'.concat(s,`" comparisons are not supported for type '`).concat(yr(u.type),"'."));let h=o.parse(a[2],2,en);if(!h)return null;if(!u3(s,h.type))return o.concat(2).error('"'.concat(s,`" comparisons are not supported for type '`).concat(yr(h.type),"'."));if(u.type.kind!==h.type.kind&&u.type.kind!=="value"&&h.type.kind!=="value")return o.error("Cannot compare types '".concat(yr(u.type),"' and '").concat(yr(h.type),"'."));r&&(u.type.kind==="value"&&h.type.kind!=="value"?u=new oh(h.type,[u]):u.type.kind!=="value"&&h.type.kind==="value"&&(h=new oh(u.type,[h])));let d=null;if(a.length===4){if(u.type.kind!=="string"&&h.type.kind!=="string"&&u.type.kind!=="value"&&h.type.kind!=="value")return o.error("Cannot use collator to compare non-string types.");if(d=o.parse(a[3],3,eA),!d)return null}return new n(u,h,d)}evaluate(a){let o=this.lhs.evaluate(a),s=this.rhs.evaluate(a);if(r&&this.hasUntypedArgument){let u=Jr(o),h=Jr(s);if(u.kind!==h.kind||!(u.kind==="string"||u.kind==="number"))throw new Kr('Expected arguments for "'.concat(i,'" to be (string, string) or (number, number), but found (').concat(u.kind,", ").concat(h.kind,") instead."))}if(this.collator&&!r&&this.hasUntypedArgument){let u=Jr(o),h=Jr(s);if(u.kind!=="string"||h.kind!=="string")return e(a,o,s)}return this.collator?t(a,o,s,this.collator.evaluate(a)):e(a,o,s)}eachChild(a){a(this.lhs),a(this.rhs),this.collator&&a(this.collator)}outputDefined(){return!0}},l(n,"Comparison"),n}l(Pd,"makeComparison");var Ige=Pd("==",DU,v5),Tge=Pd("!=",kU,BU),Pge=Pd("<",RU,zU),Lge=Pd(">",OU,UU),Dge=Pd("<=",NU,VU),kge=Pd(">=",FU,jU),GU=class $U{constructor(e,t,n){this.type=eA,this.locale=n,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(e.length!==2)return t.error("Expected one argument.");let n=e[1];if(typeof n!="object"||Array.isArray(n))return t.error("Collator options argument must be an object.");let r=t.parse(n["case-sensitive"]===void 0?!1:n["case-sensitive"],1,Qi);if(!r)return null;let a=t.parse(n["diacritic-sensitive"]===void 0?!1:n["diacritic-sensitive"],1,Qi);if(!a)return null;let o=null;return n.locale&&(o=t.parse(n.locale,1,dn),!o)?null:new $U(r,a,o)}evaluate(e){return new m5(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}};l(GU,"CollatorExpression");var HU=GU,WU=class qU{constructor(e,t,n,r,a){this.type=dn,this.number=e,this.locale=t,this.currency=n,this.minFractionDigits=r,this.maxFractionDigits=a}static parse(e,t){if(e.length!==3)return t.error("Expected two arguments.");let n=t.parse(e[1],1,Gt);if(!n)return null;let r=e[2];if(typeof r!="object"||Array.isArray(r))return t.error("NumberFormat options argument must be an object.");let a=null;if(r.locale&&(a=t.parse(r.locale,1,dn),!a))return null;let o=null;if(r.currency&&(o=t.parse(r.currency,1,dn),!o))return null;let s=null;if(r["min-fraction-digits"]&&(s=t.parse(r["min-fraction-digits"],1,Gt),!s))return null;let u=null;return r["max-fraction-digits"]&&(u=t.parse(r["max-fraction-digits"],1,Gt),!u)?null:new qU(n,a,o,s,u)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}};l(WU,"NumberFormat");var Rge=WU,XU=class ZU{constructor(e){this.type=e0,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let n=e[1];if(!Array.isArray(n)&&typeof n=="object")return t.error("First argument must be an image or text section.");let r=[],a=!1;for(let o=1;o<=e.length-1;++o){let s=e[o];if(a&&typeof s=="object"&&!Array.isArray(s)){a=!1;let u=null;if(s["font-scale"]&&(u=t.parse(s["font-scale"],1,Gt),!u))return null;let h=null;if(s["text-font"]&&(h=t.parse(s["text-font"],1,$o(dn)),!h))return null;let d=null;if(s["text-color"]&&(d=t.parse(s["text-color"],1,gl),!d))return null;let f=r[r.length-1];f.scale=u,f.font=h,f.textColor=d}else{let u=t.parse(e[o],1,en);if(!u)return null;let h=u.type.kind;if(h!=="string"&&h!=="value"&&h!=="null"&&h!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");a=!0,r.push({content:u,scale:null,font:null,textColor:null})}}return new ZU(r)}evaluate(e){let t=l(n=>{let r=n.content.evaluate(e);return Jr(r)===t0?new n3("",r,null,null,null):new n3(Vm(r),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)},"evaluateSection");return new fh(this.sections.map(t))}eachChild(e){for(let t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor)}outputDefined(){return!1}};l(XU,"FormatExpression");var YU=XU,JU=class KU{constructor(e){this.type=t0,this.input=e}static parse(e,t){if(e.length!==2)return t.error("Expected two arguments.");let n=t.parse(e[1],1,dn);return n?new KU(n):t.error("No image name provided.")}evaluate(e){let t=this.input.evaluate(e),n=uu.fromString(t);return n&&e.availableImages&&(n.available=e.availableImages.indexOf(t)>-1),n}eachChild(e){e(this.input)}outputDefined(){return!1}};l(JU,"ImageExpression");var Oge=JU,QU=class eV{constructor(e){this.type=Gt,this.input=e}static parse(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found ".concat(e.length-1," instead."));let n=t.parse(e[1],1);return n?n.type.kind!=="array"&&n.type.kind!=="string"&&n.type.kind!=="value"?t.error("Expected argument of type string or array, but found ".concat(yr(n.type)," instead.")):new eV(n):null}evaluate(e){let t=this.input.evaluate(e);if(typeof t=="string")return[...t].length;if(Array.isArray(t))return t.length;throw new Kr("Expected value to be of type string or array, but found ".concat(yr(Jr(t))," instead."))}eachChild(e){e(this.input)}outputDefined(){return!1}};l(QU,"Length");var Nge=QU,nu=8192;function tV(i,e){let t=iV(i[0]),n=rV(i[1]),r=Math.pow(2,e.z);return[Math.round(t*r*nu),Math.round(n*r*nu)]}l(tV,"getTileCoordinates");function rA(i,e){let t=Math.pow(2,e.z),n=(i[0]/nu+e.x)/t,r=(i[1]/nu+e.y)/t;return[nV(n),aV(r)]}l(rA,"getLngLatFromTileCoord");function iV(i){return(180+i)/360}l(iV,"mercatorXfromLng");function nV(i){return i*360-180}l(nV,"lngFromMercatorXfromLng");function rV(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}l(rV,"mercatorYfromLat");function aV(i){return 360/Math.PI*Math.atan(Math.exp((180-i*360)*Math.PI/180))-90}l(aV,"latFromMercatorY");function Bg(i,e){i[0]=Math.min(i[0],e[0]),i[1]=Math.min(i[1],e[1]),i[2]=Math.max(i[2],e[0]),i[3]=Math.max(i[3],e[1])}l(Bg,"updateBBox");function fg(i,e){return!(i[0]<=e[0]||i[2]>=e[2]||i[1]<=e[1]||i[3]>=e[3])}l(fg,"boxWithinBox");function oV(i,e,t){return e[1]>i[1]!=t[1]>i[1]&&i[0]<(t[0]-e[0])*(i[1]-e[1])/(t[1]-e[1])+e[0]}l(oV,"rayIntersect");function sV(i,e,t){let n=i[0]-e[0],r=i[1]-e[1],a=i[0]-t[0],o=i[1]-t[1];return n*o-a*r===0&&n*a<=0&&r*o<=0}l(sV,"pointOnBoundary");function n0(i,e,t,n){let r=[e[0]-i[0],e[1]-i[1]],a=[n[0]-t[0],n[1]-t[1]];return cV(a,r)===0?!1:!!(h3(i,e,t,n)&&h3(t,n,i,e))}l(n0,"segmentIntersectSegment");function lV(i,e,t){for(let n of t)for(let r=0;r<n.length-1;++r)if(n0(i,e,n[r],n[r+1]))return!0;return!1}l(lV,"lineIntersectPolygon");function Ld(i,e,t=!1){let n=!1;for(let r of e)for(let a=0;a<r.length-1;a++){if(sV(i,r[a],r[a+1]))return t;oV(i,r[a],r[a+1])&&(n=!n)}return n}l(Ld,"pointWithinPolygon");function uV(i,e){for(let t of e)if(Ld(i,t))return!0;return!1}l(uV,"pointWithinPolygons");function _5(i,e){for(let t of i)if(!Ld(t,e))return!1;for(let t=0;t<i.length-1;++t)if(lV(i[t],i[t+1],e))return!1;return!0}l(_5,"lineStringWithinPolygon");function hV(i,e){for(let t of e)if(_5(i,t))return!0;return!1}l(hV,"lineStringWithinPolygons");function cV(i,e){return i[0]*e[1]-i[1]*e[0]}l(cV,"perp");function h3(i,e,t,n){let r=i[0]-t[0],a=i[1]-t[1],o=e[0]-t[0],s=e[1]-t[1],u=n[0]-t[0],h=n[1]-t[1],d=r*h-u*a,f=o*h-u*s;return d>0&&f<0||d<0&&f>0}l(h3,"twoSided");function aA(i,e,t){let n=[];for(let r=0;r<i.length;r++){let a=[];for(let o=0;o<i[r].length;o++){let s=tV(i[r][o],t);Bg(e,s),a.push(s)}n.push(a)}return n}l(aA,"getTilePolygon");function x5(i,e,t){let n=[];for(let r=0;r<i.length;r++){let a=aA(i[r],e,t);n.push(a)}return n}l(x5,"getTilePolygons");function b5(i,e,t,n){if(i[0]<t[0]||i[0]>t[2]){let r=n*.5,a=i[0]-t[0]>r?-n:t[0]-i[0]>r?n:0;a===0&&(a=i[0]-t[2]>r?-n:t[2]-i[0]>r?n:0),i[0]+=a}Bg(e,i)}l(b5,"updatePoint");function pV(i){i[0]=i[1]=1/0,i[2]=i[3]=-1/0}l(pV,"resetBBox");function c3(i,e,t,n){let r=Math.pow(2,n.z)*nu,a=[n.x*nu,n.y*nu],o=[];for(let s of i)for(let u of s){let h=[u.x+a[0],u.y+a[1]];b5(h,e,t,r),o.push(h)}return o}l(c3,"getTilePoints");function p3(i,e,t,n){let r=Math.pow(2,n.z)*nu,a=[n.x*nu,n.y*nu],o=[];for(let s of i){let u=[];for(let h of s){let d=[h.x+a[0],h.y+a[1]];Bg(e,d),u.push(d)}o.push(u)}if(e[2]-e[0]<=r/2){pV(e);for(let s of o)for(let u of s)b5(u,e,t,r)}return o}l(p3,"getTileLines");function dV(i,e){let t=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],r=i.canonicalID();if(e.type==="Polygon"){let a=aA(e.coordinates,n,r),o=c3(i.geometry(),t,n,r);if(!fg(t,n))return!1;for(let s of o)if(!Ld(s,a))return!1}if(e.type==="MultiPolygon"){let a=x5(e.coordinates,n,r),o=c3(i.geometry(),t,n,r);if(!fg(t,n))return!1;for(let s of o)if(!uV(s,a))return!1}return!0}l(dV,"pointsWithinPolygons");function fV(i,e){let t=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],r=i.canonicalID();if(e.type==="Polygon"){let a=aA(e.coordinates,n,r),o=p3(i.geometry(),t,n,r);if(!fg(t,n))return!1;for(let s of o)if(!_5(s,a))return!1}if(e.type==="MultiPolygon"){let a=x5(e.coordinates,n,r),o=p3(i.geometry(),t,n,r);if(!fg(t,n))return!1;for(let s of o)if(!hV(s,a))return!1}return!0}l(fV,"linesWithinPolygons");var mV=class ax{constructor(e,t){this.type=Qi,this.geojson=e,this.geometries=t}static parse(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(dg(e[1])){let n=e[1];if(n.type==="FeatureCollection"){let r=[];for(let a of n.features){let{type:o,coordinates:s}=a.geometry;o==="Polygon"&&r.push(s),o==="MultiPolygon"&&r.push(...s)}if(r.length){let a={type:"MultiPolygon",coordinates:r};return new ax(n,a)}}else if(n.type==="Feature"){let r=n.geometry.type;if(r==="Polygon"||r==="MultiPolygon")return new ax(n,n.geometry)}else if(n.type==="Polygon"||n.type==="MultiPolygon")return new ax(n,n)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return dV(e,this.geometries);if(e.geometryType()==="LineString")return fV(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}};l(mV,"Within");var w5=mV,gV=class{constructor(e=[],t=(n,r)=>n<r?-1:n>r?1:0){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;let e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:t,compare:n}=this,r=t[e];for(;e>0;){let a=e-1>>1,o=t[a];if(n(r,o)>=0)break;t[e]=o,e=a}t[e]=r}_down(e){let{data:t,compare:n}=this,r=this.length>>1,a=t[e];for(;e<r;){let o=(e<<1)+1,s=o+1;if(s<this.length&&n(t[s],t[o])<0&&(o=s),n(t[o],a)>=0)break;t[e]=t[o],e=o}t[e]=a}};l(gV,"TinyQueue");var yV=gV;function vV(i,e,t,n,r){A5(i,e,t,n||i.length-1,r||_V)}l(vV,"quickselect");function A5(i,e,t,n,r){for(;n>t;){if(n-t>600){var a=n-t+1,o=e-t+1,s=Math.log(a),u=.5*Math.exp(2*s/3),h=.5*Math.sqrt(s*u*(a-u)/a)*(o-a/2<0?-1:1),d=Math.max(t,Math.floor(e-o*u/a+h)),f=Math.min(n,Math.floor(e+(a-o)*u/a+h));A5(i,e,d,f,r)}var m=i[e],v=t,b=n;for(gf(i,t,e),r(i[n],m)>0&&gf(i,t,n);v<b;){for(gf(i,v,b),v++,b--;r(i[v],m)<0;)v++;for(;r(i[b],m)>0;)b--}r(i[t],m)===0?gf(i,t,b):(b++,gf(i,b,n)),b<=e&&(t=b+1),e<=b&&(n=b-1)}}l(A5,"quickselectStep");function gf(i,e,t){var n=i[e];i[e]=i[t],i[t]=n}l(gf,"swap");function _V(i,e){return i<e?-1:i>e?1:0}l(_V,"defaultCompare");function xV(i,e){if(i.length<=1)return[i];let t=[],n,r;for(let a of i){let o=wV(a);o!==0&&(a.area=Math.abs(o),r===void 0&&(r=o<0),r===o<0?(n&&t.push(n),n=[a]):n.push(a))}if(n&&t.push(n),e>1)for(let a=0;a<t.length;a++)t[a].length<=e||(vV(t[a],e,1,t[a].length-1,bV),t[a]=t[a].slice(0,e));return t}l(xV,"classifyRings");function bV(i,e){return e.area-i.area}l(bV,"compareAreas");function wV(i){let e=0;for(let t=0,n=i.length,r=n-1,a,o;t<n;r=t++)a=i[t],o=i[r],e+=(o.x-a.x)*(a.y+o.y);return e}l(wV,"calculateSignedArea");var Fge=6378.137,Ok=1/298.257223563,Nk=Ok*(2-Ok),Fk=Math.PI/180,AV=class{constructor(e){let t=Fk*Fge*1e3,n=Math.cos(e*Fk),r=1/(1-Nk*(1-n*n)),a=Math.sqrt(r);this.kx=t*a*n,this.ky=t*a*r*(1-Nk)}distance(e,t){let n=this.wrap(e[0]-t[0])*this.kx,r=(e[1]-t[1])*this.ky;return Math.sqrt(n*n+r*r)}pointOnLine(e,t){let n=1/0,r,a,o,s;for(let u=0;u<e.length-1;u++){let h=e[u][0],d=e[u][1],f=this.wrap(e[u+1][0]-h)*this.kx,m=(e[u+1][1]-d)*this.ky,v=0;(f!==0||m!==0)&&(v=(this.wrap(t[0]-h)*this.kx*f+(t[1]-d)*this.ky*m)/(f*f+m*m),v>1?(h=e[u+1][0],d=e[u+1][1]):v>0&&(h+=f/this.kx*v,d+=m/this.ky*v)),f=this.wrap(t[0]-h)*this.kx,m=(t[1]-d)*this.ky;let b=f*f+m*m;b<n&&(n=b,r=h,a=d,o=u,s=v)}return{point:[r,a],index:o,t:Math.max(0,Math.min(1,s))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}};l(AV,"CheapRuler");var S5=AV,d3=100,f3=50;function M5(i,e){return e[0]-i[0]}l(M5,"compareDistPair");function t1(i){return i[1]-i[0]+1}l(t1,"getRangeSize");function hu(i,e){return i[1]>=i[0]&&i[1]<e}l(hu,"isRangeSafe");function Y2(i,e){if(i[0]>i[1])return[null,null];let t=t1(i);if(e){if(t===2)return[i,null];let r=Math.floor(t/2);return[[i[0],i[0]+r],[i[0]+r,i[1]]]}if(t===1)return[i,null];let n=Math.floor(t/2)-1;return[[i[0],i[0]+n],[i[0]+n+1,i[1]]]}l(Y2,"splitRange");function J2(i,e){if(!hu(e,i.length))return[1/0,1/0,-1/0,-1/0];let t=[1/0,1/0,-1/0,-1/0];for(let n=e[0];n<=e[1];++n)Bg(t,i[n]);return t}l(J2,"getBBox");function K2(i){let e=[1/0,1/0,-1/0,-1/0];for(let t of i)for(let n of t)Bg(e,n);return e}l(K2,"getPolygonBBox");function m3(i){return i[0]!==-1/0&&i[1]!==-1/0&&i[2]!==1/0&&i[3]!==1/0}l(m3,"isValidBBox");function oA(i,e,t){if(!m3(i)||!m3(e))return NaN;let n=0,r=0;return i[2]<e[0]&&(n=e[0]-i[2]),i[0]>e[2]&&(n=i[0]-e[2]),i[1]>e[3]&&(r=i[1]-e[3]),i[3]<e[1]&&(r=e[1]-i[3]),t.distance([0,0],[n,r])}l(oA,"bboxToBBoxDistance");function Ec(i,e,t){let n=t.pointOnLine(e,i);return t.distance(i,n.point)}l(Ec,"pointToLineDistance");function sA(i,e,t,n,r){let a=Math.min(Ec(i,[t,n],r),Ec(e,[t,n],r)),o=Math.min(Ec(t,[i,e],r),Ec(n,[i,e],r));return Math.min(a,o)}l(sA,"segmentToSegmentDistance");function SV(i,e,t,n,r){if(!(hu(e,i.length)&&hu(n,t.length)))return 1/0;let a=1/0;for(let o=e[0];o<e[1];++o){let s=i[o],u=i[o+1];for(let h=n[0];h<n[1];++h){let d=t[h],f=t[h+1];if(n0(s,u,d,f))return 0;a=Math.min(a,sA(s,u,d,f,r))}}return a}l(SV,"lineToLineDistance");function MV(i,e,t,n,r){if(!(hu(e,i.length)&&hu(n,t.length)))return NaN;let a=1/0;for(let o=e[0];o<=e[1];++o)for(let s=n[0];s<=n[1];++s)if(a=Math.min(a,r.distance(i[o],t[s])),a===0)return a;return a}l(MV,"pointsToPointsDistance");function CV(i,e,t){if(Ld(i,e,!0))return 0;let n=1/0;for(let r of e){let a=r[0],o=r[r.length-1];if(a!==o&&(n=Math.min(n,Ec(i,[o,a],t)),n===0))return n;let s=t.pointOnLine(r,i);if(n=Math.min(n,t.distance(i,s.point)),n===0)return n}return n}l(CV,"pointToPolygonDistance");function EV(i,e,t,n){if(!hu(e,i.length))return NaN;for(let a=e[0];a<=e[1];++a)if(Ld(i[a],t,!0))return 0;let r=1/0;for(let a=e[0];a<e[1];++a){let o=i[a],s=i[a+1];for(let u of t)for(let h=0,d=u.length,f=d-1;h<d;f=h++){let m=u[f],v=u[h];if(n0(o,s,m,v))return 0;r=Math.min(r,sA(o,s,m,v,n))}}return r}l(EV,"lineToPolygonDistance");function g3(i,e){for(let t of i)for(let n of t)if(Ld(n,e,!0))return!0;return!1}l(g3,"polygonIntersect");function IV(i,e,t,n=1/0){let r=K2(i),a=K2(e);if(n!==1/0&&oA(r,a,t)>=n)return n;if(fg(r,a)){if(g3(i,e))return 0}else if(g3(e,i))return 0;let o=1/0;for(let s of i)for(let u=0,h=s.length,d=h-1;u<h;d=u++){let f=s[d],m=s[u];for(let v of e)for(let b=0,w=v.length,A=w-1;b<w;A=b++){let E=v[A],I=v[b];if(n0(f,m,E,I))return 0;o=Math.min(o,sA(f,m,E,I,t))}}return o}l(IV,"polygonToPolygonDistance");function y3(i,e,t,n,r,a){if(!a)return;let o=oA(J2(n,a),r,t);o<e&&i.push([o,a,[0,0]])}l(y3,"updateQueue");function Ny(i,e,t,n,r,a,o){if(!a||!o)return;let s=oA(J2(n,a),J2(r,o),t);s<e&&i.push([s,a,o])}l(Ny,"updateQueueTwoSets");function i1(i,e,t,n,r=1/0){let a=Math.min(n.distance(i[0],t[0][0]),r);if(a===0)return a;let o=new yV([[0,[0,i.length-1],[0,0]]],M5),s=K2(t);for(;o.length>0;){let u=o.pop();if(u[0]>=a)continue;let h=u[1],d=e?f3:d3;if(t1(h)<=d){if(!hu(h,i.length))return NaN;if(e){let f=EV(i,h,t,n);if(isNaN(f)||f===0)return f;a=Math.min(a,f)}else for(let f=h[0];f<=h[1];++f){let m=CV(i[f],t,n);if(a=Math.min(a,m),a===0)return 0}}else{let f=Y2(h,e);y3(o,a,n,i,s,f[0]),y3(o,a,n,i,s,f[1])}}return a}l(i1,"pointsToPolygonDistance");function n1(i,e,t,n,r,a=1/0){let o=Math.min(a,r.distance(i[0],t[0]));if(o===0)return o;let s=new yV([[0,[0,i.length-1],[0,t.length-1]]],M5);for(;s.length>0;){let u=s.pop();if(u[0]>=o)continue;let h=u[1],d=u[2],f=e?f3:d3,m=n?f3:d3;if(t1(h)<=f&&t1(d)<=m){if(!hu(h,i.length)&&hu(d,t.length))return NaN;let v;if(e&&n)v=SV(i,h,t,d,r),o=Math.min(o,v);else if(e&&!n){let b=i.slice(h[0],h[1]+1);for(let w=d[0];w<=d[1];++w)if(v=Ec(t[w],b,r),o=Math.min(o,v),o===0)return o}else if(!e&&n){let b=t.slice(d[0],d[1]+1);for(let w=h[0];w<=h[1];++w)if(v=Ec(i[w],b,r),o=Math.min(o,v),o===0)return o}else v=MV(i,h,t,d,r),o=Math.min(o,v)}else{let v=Y2(h,e),b=Y2(d,n);Ny(s,o,r,i,t,v[0],b[0]),Ny(s,o,r,i,t,v[0],b[1]),Ny(s,o,r,i,t,v[1],b[0]),Ny(s,o,r,i,t,v[1],b[1])}}return o}l(n1,"pointSetToPointSetDistance");function TV(i,e){let t=i.geometry(),n=t.flat().map(o=>rA([o.x,o.y],i.canonical));if(t.length===0)return NaN;let r=new S5(n[0][1]),a=1/0;for(let o of e){switch(o.type){case"Point":a=Math.min(a,n1(n,!1,[o.coordinates],!1,r,a));break;case"LineString":a=Math.min(a,n1(n,!1,o.coordinates,!0,r,a));break;case"Polygon":a=Math.min(a,i1(n,!1,o.coordinates,r,a));break}if(a===0)return a}return a}l(TV,"pointToGeometryDistance");function PV(i,e){let t=i.geometry(),n=t.flat().map(o=>rA([o.x,o.y],i.canonical));if(t.length===0)return NaN;let r=new S5(n[0][1]),a=1/0;for(let o of e){switch(o.type){case"Point":a=Math.min(a,n1(n,!0,[o.coordinates],!1,r,a));break;case"LineString":a=Math.min(a,n1(n,!0,o.coordinates,!0,r,a));break;case"Polygon":a=Math.min(a,i1(n,!0,o.coordinates,r,a));break}if(a===0)return a}return a}l(PV,"lineStringToGeometryDistance");function LV(i,e){let t=i.geometry();if(t.length===0||t[0].length===0)return NaN;let n=xV(t,0).map(o=>o.map(s=>s.map(u=>rA([u.x,u.y],i.canonical)))),r=new S5(n[0][0][0][1]),a=1/0;for(let o of e)for(let s of n){switch(o.type){case"Point":a=Math.min(a,i1([o.coordinates],!1,s,r,a));break;case"LineString":a=Math.min(a,i1(o.coordinates,!0,s,r,a));break;case"Polygon":a=Math.min(a,IV(s,o.coordinates,r,a));break}if(a===0)return a}return a}l(LV,"polygonToGeometryDistance");function ox(i){return i.type==="MultiPolygon"?i.coordinates.map(e=>({type:"Polygon",coordinates:e})):i.type==="MultiLineString"?i.coordinates.map(e=>({type:"LineString",coordinates:e})):i.type==="MultiPoint"?i.coordinates.map(e=>({type:"Point",coordinates:e})):[i]}l(ox,"toSimpleGeometry");var DV=class sx{constructor(e,t){this.type=Gt,this.geojson=e,this.geometries=t}static parse(e,t){if(e.length!==2)return t.error("'distance' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(dg(e[1])){let n=e[1];if(n.type==="FeatureCollection")return new sx(n,n.features.map(r=>ox(r.geometry)).flat());if(n.type==="Feature")return new sx(n,ox(n.geometry));if("type"in n&&"coordinates"in n)return new sx(n,ox(n))}return t.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return TV(e,this.geometries);if(e.geometryType()==="LineString")return PV(e,this.geometries);if(e.geometryType()==="Polygon")return LV(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}};l(DV,"Distance");var C5=DV,jm={"==":Ige,"!=":Tge,">":Lge,"<":Pge,">=":kge,"<=":Dge,array:oh,at:xge,boolean:oh,case:Sge,coalesce:LU,collator:HU,format:YU,image:Oge,in:bge,"index-of":wge,interpolate:iu,"interpolate-hcl":iu,"interpolate-lab":iu,length:Nge,let:sU,literal:Qv,match:Age,number:oh,"number-format":Rge,object:oh,slice:Mge,step:y5,string:oh,"to-boolean":wm,"to-color":wm,"to-number":wm,"to-string":wm,var:hU,within:w5,distance:C5},kV=class Fy{constructor(e,t,n,r){this.name=e,this.type=t,this._evaluate=n,this.args=r}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,t){let n=e[0],r=Fy.definitions[n];if(!r)return t.error('Unknown expression "'.concat(n,'". If you wanted a literal array, use ["literal", [...]].'),0);let a=Array.isArray(r)?r[0]:r.type,o=Array.isArray(r)?[[r[1],r[2]]]:r.overloads,s=o.filter(([h])=>!Array.isArray(h)||h.length===e.length-1),u=null;for(let[h,d]of s){u=new rU(t.registry,r1,t.path,null,t.scope);let f=[],m=!1;for(let v=1;v<e.length;v++){let b=e[v],w=Array.isArray(h)?h[v-1]:h.type,A=u.parse(b,1+f.length,w);if(!A){m=!0;break}f.push(A)}if(!m){if(Array.isArray(h)&&h.length!==f.length){u.error("Expected ".concat(h.length," arguments, but found ").concat(f.length," instead."));continue}for(let v=0;v<f.length;v++){let b=Array.isArray(h)?h[v]:h.type,w=f[v];u.concat(v+1).checkSubtype(b,w.type)}if(u.errors.length===0)return new Fy(n,a,d,f)}}if(s.length===1)t.errors.push(...u.errors);else{let h=(s.length?s:o).map(([f])=>OV(f)).join(" | "),d=[];for(let f=1;f<e.length;f++){let m=t.parse(e[f],1+d.length);if(!m)return null;d.push(yr(m.type))}t.error("Expected arguments of type ".concat(h,", but found (").concat(d.join(", "),") instead."))}return null}static register(e,t){Fy.definitions=t;for(let n in t)e[n]=Fy}};l(kV,"CompoundExpression");var Dd=kV;function v3(i,[e,t,n,r]){e=e.evaluate(i),t=t.evaluate(i),n=n.evaluate(i);let a=r?r.evaluate(i):1,o=g5(e,t,n,a);if(o)throw new Kr(o);return new Wi(e/255,t/255,n/255,a,!1)}l(v3,"rgba");function _3(i,e){return i in e}l(_3,"has");function lx(i,e){let t=e[i];return typeof t>"u"?null:t}l(lx,"get");function RV(i,e,t,n){for(;t<=n;){let r=t+n>>1;if(e[r]===i)return!0;e[r]>i?n=r-1:t=r+1}return!1}l(RV,"binarySearch");function Wh(i){return{type:i}}l(Wh,"varargs");Dd.register(jm,{error:[pge,[dn],(i,[e])=>{throw new Kr(e.evaluate(i))}],typeof:[dn,[en],(i,[e])=>yr(Jr(e.evaluate(i)))],"to-rgba":[$o(Gt,4),[gl],(i,[e])=>{let[t,n,r,a]=e.evaluate(i).rgb;return[t*255,n*255,r*255,a]}],rgb:[gl,[Gt,Gt,Gt],v3],rgba:[gl,[Gt,Gt,Gt,Gt],v3],has:{type:Qi,overloads:[[[dn],(i,[e])=>_3(e.evaluate(i),i.properties())],[[dn,zm],(i,[e,t])=>_3(e.evaluate(i),t.evaluate(i))]]},get:{type:en,overloads:[[[dn],(i,[e])=>lx(e.evaluate(i),i.properties())],[[dn,zm],(i,[e,t])=>lx(e.evaluate(i),t.evaluate(i))]]},"feature-state":[en,[dn],(i,[e])=>lx(e.evaluate(i),i.featureState||{})],properties:[zm,[],i=>i.properties()],"geometry-type":[dn,[],i=>i.geometryType()],id:[en,[],i=>i.id()],zoom:[Gt,[],i=>i.globals.zoom],"heatmap-density":[Gt,[],i=>i.globals.heatmapDensity||0],"line-progress":[Gt,[],i=>i.globals.lineProgress||0],accumulated:[en,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[Gt,Wh(Gt),(i,e)=>{let t=0;for(let n of e)t+=n.evaluate(i);return t}],"*":[Gt,Wh(Gt),(i,e)=>{let t=1;for(let n of e)t*=n.evaluate(i);return t}],"-":{type:Gt,overloads:[[[Gt,Gt],(i,[e,t])=>e.evaluate(i)-t.evaluate(i)],[[Gt],(i,[e])=>-e.evaluate(i)]]},"/":[Gt,[Gt,Gt],(i,[e,t])=>e.evaluate(i)/t.evaluate(i)],"%":[Gt,[Gt,Gt],(i,[e,t])=>e.evaluate(i)%t.evaluate(i)],ln2:[Gt,[],()=>Math.LN2],pi:[Gt,[],()=>Math.PI],e:[Gt,[],()=>Math.E],"^":[Gt,[Gt,Gt],(i,[e,t])=>Math.pow(e.evaluate(i),t.evaluate(i))],sqrt:[Gt,[Gt],(i,[e])=>Math.sqrt(e.evaluate(i))],log10:[Gt,[Gt],(i,[e])=>Math.log(e.evaluate(i))/Math.LN10],ln:[Gt,[Gt],(i,[e])=>Math.log(e.evaluate(i))],log2:[Gt,[Gt],(i,[e])=>Math.log(e.evaluate(i))/Math.LN2],sin:[Gt,[Gt],(i,[e])=>Math.sin(e.evaluate(i))],cos:[Gt,[Gt],(i,[e])=>Math.cos(e.evaluate(i))],tan:[Gt,[Gt],(i,[e])=>Math.tan(e.evaluate(i))],asin:[Gt,[Gt],(i,[e])=>Math.asin(e.evaluate(i))],acos:[Gt,[Gt],(i,[e])=>Math.acos(e.evaluate(i))],atan:[Gt,[Gt],(i,[e])=>Math.atan(e.evaluate(i))],min:[Gt,Wh(Gt),(i,e)=>Math.min(...e.map(t=>t.evaluate(i)))],max:[Gt,Wh(Gt),(i,e)=>Math.max(...e.map(t=>t.evaluate(i)))],abs:[Gt,[Gt],(i,[e])=>Math.abs(e.evaluate(i))],round:[Gt,[Gt],(i,[e])=>{let t=e.evaluate(i);return t<0?-Math.round(-t):Math.round(t)}],floor:[Gt,[Gt],(i,[e])=>Math.floor(e.evaluate(i))],ceil:[Gt,[Gt],(i,[e])=>Math.ceil(e.evaluate(i))],"filter-==":[Qi,[dn,en],(i,[e,t])=>i.properties()[e.value]===t.value],"filter-id-==":[Qi,[en],(i,[e])=>i.id()===e.value],"filter-type-==":[Qi,[dn],(i,[e])=>i.geometryType()===e.value],"filter-<":[Qi,[dn,en],(i,[e,t])=>{let n=i.properties()[e.value],r=t.value;return typeof n==typeof r&&n<r}],"filter-id-<":[Qi,[en],(i,[e])=>{let t=i.id(),n=e.value;return typeof t==typeof n&&t<n}],"filter->":[Qi,[dn,en],(i,[e,t])=>{let n=i.properties()[e.value],r=t.value;return typeof n==typeof r&&n>r}],"filter-id->":[Qi,[en],(i,[e])=>{let t=i.id(),n=e.value;return typeof t==typeof n&&t>n}],"filter-<=":[Qi,[dn,en],(i,[e,t])=>{let n=i.properties()[e.value],r=t.value;return typeof n==typeof r&&n<=r}],"filter-id-<=":[Qi,[en],(i,[e])=>{let t=i.id(),n=e.value;return typeof t==typeof n&&t<=n}],"filter->=":[Qi,[dn,en],(i,[e,t])=>{let n=i.properties()[e.value],r=t.value;return typeof n==typeof r&&n>=r}],"filter-id->=":[Qi,[en],(i,[e])=>{let t=i.id(),n=e.value;return typeof t==typeof n&&t>=n}],"filter-has":[Qi,[en],(i,[e])=>e.value in i.properties()],"filter-has-id":[Qi,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[Qi,[$o(dn)],(i,[e])=>e.value.indexOf(i.geometryType())>=0],"filter-id-in":[Qi,[$o(en)],(i,[e])=>e.value.indexOf(i.id())>=0],"filter-in-small":[Qi,[dn,$o(en)],(i,[e,t])=>t.value.indexOf(i.properties()[e.value])>=0],"filter-in-large":[Qi,[dn,$o(en)],(i,[e,t])=>RV(i.properties()[e.value],t.value,0,t.value.length-1)],all:{type:Qi,overloads:[[[Qi,Qi],(i,[e,t])=>e.evaluate(i)&&t.evaluate(i)],[Wh(Qi),(i,e)=>{for(let t of e)if(!t.evaluate(i))return!1;return!0}]]},any:{type:Qi,overloads:[[[Qi,Qi],(i,[e,t])=>e.evaluate(i)||t.evaluate(i)],[Wh(Qi),(i,e)=>{for(let t of e)if(t.evaluate(i))return!0;return!1}]]},"!":[Qi,[Qi],(i,[e])=>!e.evaluate(i)],"is-supported-script":[Qi,[dn],(i,[e])=>{let t=i.globals&&i.globals.isSupportedScript;return t?t(e.evaluate(i)):!0}],upcase:[dn,[dn],(i,[e])=>e.evaluate(i).toUpperCase()],downcase:[dn,[dn],(i,[e])=>e.evaluate(i).toLowerCase()],concat:[dn,Wh(en),(i,e)=>e.map(t=>Vm(t.evaluate(i))).join("")],"resolved-locale":[dn,[eA],(i,[e])=>e.evaluate(i).resolvedLocale()]});function OV(i){return Array.isArray(i)?"(".concat(i.map(yr).join(", "),")"):"(".concat(yr(i.type),"...)")}l(OV,"stringifySignature");function r1(i){if(i instanceof hU)return r1(i.boundExpression);if(i instanceof Dd&&i.name==="error"||i instanceof HU||i instanceof w5||i instanceof C5)return!1;let e=i instanceof wm||i instanceof oh,t=!0;return i.eachChild(n=>{e?t=t&&r1(n):t=t&&n instanceof Qv}),t?r0(i)&&a0(i,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}l(r1,"isExpressionConstant");function r0(i){if(i instanceof Dd&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof w5||i instanceof C5)return!1;let e=!0;return i.eachChild(t=>{e&&!r0(t)&&(e=!1)}),e}l(r0,"isFeatureConstant");function mg(i){if(i instanceof Dd&&i.name==="feature-state")return!1;let e=!0;return i.eachChild(t=>{e&&!mg(t)&&(e=!1)}),e}l(mg,"isStateConstant");function a0(i,e){if(i instanceof Dd&&e.indexOf(i.name)>=0)return!1;let t=!0;return i.eachChild(n=>{t&&!a0(n,e)&&(t=!1)}),t}l(a0,"isGlobalPropertyConstant");function Q2(i){return{result:"success",value:i}}l(Q2,"success");function Vp(i){return{result:"error",value:i}}l(Vp,"error");function gd(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}l(gd,"supportsPropertyExpression");function E5(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}l(E5,"supportsZoomExpression");function lA(i){return!!i.expression&&i.expression.interpolated}l(lA,"supportsInterpolation");function Tn(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}l(Tn,"getType");function o0(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}l(o0,"isFunction$1");function NV(i){return i}l(NV,"identityFunction");function I5(i,e){let t=e.type==="color",n=i.stops&&typeof i.stops[0][0]=="object",r=n||i.property!==void 0,a=n||!r,o=i.type||(lA(e)?"exponential":"interval");if(t||e.type==="padding"){let d=t?Wi.parse:bh.parse;i=md({},i),i.stops&&(i.stops=i.stops.map(f=>[f[0],d(f[1])])),i.default?i.default=d(i.default):i.default=d(e.default)}if(i.colorSpace&&!MU(i.colorSpace))throw new Error('Unknown color space: "'.concat(i.colorSpace,'"'));let s,u,h;if(o==="exponential")s=x3;else if(o==="interval")s=BV;else if(o==="categorical"){s=FV,u=Object.create(null);for(let d of i.stops)u[d[0]]=d[1];h=typeof i.stops[0][0]}else if(o==="identity")s=zV;else throw new Error('Unknown function type "'.concat(o,'"'));if(n){let d={},f=[];for(let b=0;b<i.stops.length;b++){let w=i.stops[b],A=w[0].zoom;d[A]===void 0&&(d[A]={zoom:A,type:i.type,property:i.property,default:i.default,stops:[]},f.push(A)),d[A].stops.push([w[0].value,w[1]])}let m=[];for(let b of f)m.push([d[b].zoom,I5(d[b],e)]);let v={name:"linear"};return{kind:"composite",interpolationType:v,interpolationFactor:iu.interpolationFactor.bind(void 0,v),zoomStops:m.map(b=>b[0]),evaluate({zoom:b},w){return x3({stops:m,base:i.base},e,b).evaluate(b,w)}}}else if(a){let d=o==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:d,interpolationFactor:iu.interpolationFactor.bind(void 0,d),zoomStops:i.stops.map(f=>f[0]),evaluate:l(({zoom:f})=>s(i,e,f,u,h),"evaluate")}}else return{kind:"source",evaluate(d,f){let m=f&&f.properties?f.properties[i.property]:void 0;return m===void 0?zg(i.default,e.default):s(i,e,m,u,h)}}}l(I5,"createFunction");function zg(i,e,t){if(i!==void 0)return i;if(e!==void 0)return e;if(t!==void 0)return t}l(zg,"coalesce$1");function FV(i,e,t,n,r){let a=typeof t===r?n[t]:void 0;return zg(a,i.default,e.default)}l(FV,"evaluateCategoricalFunction");function BV(i,e,t){if(Tn(t)!=="number")return zg(i.default,e.default);let n=i.stops.length;if(n===1||t<=i.stops[0][0])return i.stops[0][1];if(t>=i.stops[n-1][0])return i.stops[n-1][1];let r=i0(i.stops.map(a=>a[0]),t);return i.stops[r][1]}l(BV,"evaluateIntervalFunction");function x3(i,e,t){let n=i.base!==void 0?i.base:1;if(Tn(t)!=="number")return zg(i.default,e.default);let r=i.stops.length;if(r===1||t<=i.stops[0][0])return i.stops[0][1];if(t>=i.stops[r-1][0])return i.stops[r-1][1];let a=i0(i.stops.map(d=>d[0]),t),o=UV(t,n,i.stops[a][0],i.stops[a+1][0]),s=i.stops[a][1],u=i.stops[a+1][1],h=Mr[e.type]||NV;return typeof s.evaluate=="function"?{evaluate(...d){let f=s.evaluate.apply(void 0,d),m=u.evaluate.apply(void 0,d);if(!(f===void 0||m===void 0))return h(f,m,o,i.colorSpace)}}:h(s,u,o,i.colorSpace)}l(x3,"evaluateExponentialFunction");function zV(i,e,t){switch(e.type){case"color":t=Wi.parse(t);break;case"formatted":t=fh.fromString(t.toString());break;case"resolvedImage":t=uu.fromString(t.toString());break;case"padding":t=bh.parse(t);break;default:Tn(t)!==e.type&&(e.type!=="enum"||!e.values[t])&&(t=void 0)}return zg(t,i.default,e.default)}l(zV,"evaluateIdentityFunction");function UV(i,e,t,n){let r=n-t,a=i-t;return r===0?0:e===1?a/r:(Math.pow(e,a)-1)/(Math.pow(e,r)-1)}l(UV,"interpolationFactor");var VV=class{constructor(e,t){this.expression=e,this._warningHistory={},this._evaluator=new tU,this._defaultValue=t?ZV(t):null,this._enumValues=t&&t.type==="enum"?t.values:null}evaluateWithoutErrorHandling(e,t,n,r,a,o){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=n,this._evaluator.canonical=r,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=o,this.expression.evaluate(this._evaluator)}evaluate(e,t,n,r,a,o){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=n||null,this._evaluator.canonical=r,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=o||null;try{let s=this.expression.evaluate(this._evaluator);if(s==null||typeof s=="number"&&s!==s)return this._defaultValue;if(this._enumValues&&!(s in this._enumValues))throw new Kr("Expected value to be one of ".concat(Object.keys(this._enumValues).map(u=>JSON.stringify(u)).join(", "),", but found ").concat(JSON.stringify(s)," instead."));return s}catch(s){return this._warningHistory[s.message]||(this._warningHistory[s.message]=!0,typeof console<"u"&&console.warn(s.message)),this._defaultValue}}};l(VV,"StyleExpression");var T5=VV;function Ug(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in jm}l(Ug,"isExpression");function uA(i,e){let t=new rU(jm,r1,[],e?XV(e):void 0),n=t.parse(i,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return n?Q2(new T5(n,e)):Vp(t.errors)}l(uA,"createExpression");var jV=class{constructor(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!mg(t.expression)}evaluateWithoutErrorHandling(e,t,n,r,a,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,n,r,a,o)}evaluate(e,t,n,r,a,o){return this._styleExpression.evaluate(e,t,n,r,a,o)}};l(jV,"ZoomConstantExpression");var ew=jV,GV=class{constructor(e,t,n,r){this.kind=e,this.zoomStops=n,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!mg(t.expression),this.interpolationType=r}evaluateWithoutErrorHandling(e,t,n,r,a,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,n,r,a,o)}evaluate(e,t,n,r,a,o){return this._styleExpression.evaluate(e,t,n,r,a,o)}interpolationFactor(e,t,n){return this.interpolationType?iu.interpolationFactor(this.interpolationType,e,t,n):0}};l(GV,"ZoomDependentExpression");var tw=GV;function P5(i,e){let t=uA(i,e);if(t.result==="error")return t;let n=t.value.expression,r=r0(n);if(!r&&!gd(e))return Vp([new Xl("","data expressions not supported")]);let a=a0(n,["zoom"]);if(!a&&!E5(e))return Vp([new Xl("","zoom expressions not supported")]);let o=Uv(n);if(!o&&!a)return Vp([new Xl("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(o instanceof Xl)return Vp([o]);if(o instanceof iu&&!lA(e))return Vp([new Xl("",'"interpolate" expressions cannot be used with this property')]);if(!o)return Q2(r?new ew("constant",t.value):new ew("source",t.value));let s=o instanceof iu?o.interpolation:void 0;return Q2(r?new tw("camera",t.value,o.labels,s):new tw("composite",t.value,o.labels,s))}l(P5,"createPropertyExpression");var $V=class HV{constructor(e,t){this._parameters=e,this._specification=t,md(this,I5(this._parameters,this._specification))}static deserialize(e){return new HV(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}};l($V,"StylePropertyFunction");var WV=$V;function qV(i,e){if(o0(i))return new WV(i,e);if(Ug(i)){let t=P5(i,e);if(t.result==="error")throw new Error(t.value.map(n=>"".concat(n.key,": ").concat(n.message)).join(", "));return t.value}else{let t=i;return e.type==="color"&&typeof i=="string"?t=Wi.parse(i):e.type==="padding"&&(typeof i=="number"||Array.isArray(i))?t=bh.parse(i):e.type==="variableAnchorOffsetCollection"&&Array.isArray(i)&&(t=Td.parse(i)),{kind:"constant",evaluate:l(()=>t,"evaluate")}}}l(qV,"normalizePropertyExpression");function Uv(i){let e=null;if(i instanceof sU)e=Uv(i.result);else if(i instanceof LU){for(let t of i.args)if(e=Uv(t),e)break}else(i instanceof y5||i instanceof iu)&&i.input instanceof Dd&&i.input.name==="zoom"&&(e=i);return e instanceof Xl||i.eachChild(t=>{let n=Uv(t);n instanceof Xl?e=n:!e&&n?e=new Xl("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&n&&e!==n&&(e=new Xl("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}l(Uv,"findZoomCurve");function XV(i){let e={color:gl,string:dn,number:Gt,enum:dn,boolean:Qi,formatted:e0,padding:tA,resolvedImage:t0,variableAnchorOffsetCollection:iA};return i.type==="array"?$o(e[i.value]||en,i.length):e[i.type]}l(XV,"getExpectedType");function ZV(i){return i.type==="color"&&o0(i.default)?new Wi(0,0,0,0):i.type==="color"?Wi.parse(i.default)||null:i.type==="padding"?bh.parse(i.default)||null:i.type==="variableAnchorOffsetCollection"?Td.parse(i.default)||null:i.default===void 0?null:i.default}l(ZV,"getDefaultValue");function hA(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(let e of i.slice(1))if(!hA(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}l(hA,"isExpressionFilter");var Bge={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function iw(i){if(i==null)return{filter:l(()=>!0,"filter"),needGeometry:!1};hA(i)||(i=a1(i));let e=uA(i,Bge);if(e.result==="error")throw new Error(e.value.map(t=>"".concat(t.key,": ").concat(t.message)).join(", "));{let t=L5(i);return{filter:l((n,r,a)=>e.value.evaluate(n,r,{},a),"filter"),needGeometry:t}}}l(iw,"createFilter");function YV(i,e){return i<e?-1:i>e?1:0}l(YV,"compare");function L5(i){if(!Array.isArray(i))return!1;if(i[0]==="within"||i[0]==="distance")return!0;for(let e=1;e<i.length;e++)if(L5(i[e]))return!0;return!1}l(L5,"geometryNeeded");function a1(i){if(!i)return!0;let e=i[0];return i.length<=1?e!=="any":e==="=="?ux(i[1],i[2],"=="):e==="!="?By(ux(i[1],i[2],"==")):e==="<"||e===">"||e==="<="||e===">="?ux(i[1],i[2],e):e==="any"?JV(i.slice(1)):e==="all"?["all"].concat(i.slice(1).map(a1)):e==="none"?["all"].concat(i.slice(1).map(a1).map(By)):e==="in"?b3(i[1],i.slice(2)):e==="!in"?By(b3(i[1],i.slice(2))):e==="has"?w3(i[1]):e==="!has"?By(w3(i[1])):!0}l(a1,"convertFilter$1");function ux(i,e,t){switch(i){case"$type":return["filter-type-".concat(t),e];case"$id":return["filter-id-".concat(t),e];default:return["filter-".concat(t),i,e]}}l(ux,"convertComparisonOp$1");function JV(i){return["any"].concat(i.map(a1))}l(JV,"convertDisjunctionOp");function b3(i,e){if(e.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(t=>typeof t!=typeof e[0])?["filter-in-large",i,["literal",e.sort(YV)]]:["filter-in-small",i,["literal",e]]}}l(b3,"convertInOp$1");function w3(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}l(w3,"convertHasOp$1");function By(i){return["!",i]}l(By,"convertNegation");function KV(){let i={},e=ht.$version;for(let t in ht.$root){let n=ht.$root[t];if(n.required){let r=null;t==="version"?r=e:n.type==="array"?r=[]:r={},r!=null&&(i[t]=r)}}return i}l(KV,"emptyStyle");function D5(i){let e=i.key,t=i.value;return t?[new Rt(e,t,"constants have been deprecated as of v8")]:[]}l(D5,"validateConstants");function Rr(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}l(Rr,"unbundle");function Bc(i){if(Array.isArray(i))return i.map(Bc);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){let e={};for(let t in i)e[t]=Bc(i[t]);return e}return Rr(i)}l(Bc,"deepUnbundle");function ps(i){let e=i.key,t=i.value,n=i.valueSpec||{},r=i.objectElementValidators||{},a=i.style,o=i.styleSpec,s=i.validateSpec,u=[],h=Tn(t);if(h!=="object")return[new Rt(e,t,"object expected, ".concat(h," found"))];for(let d in t){let f=d.split(".")[0],m=n[f]||n["*"],v;if(r[f])v=r[f];else if(n[f])v=s;else if(r["*"])v=r["*"];else if(n["*"])v=s;else{u.push(new Rt(e,t[d],'unknown property "'.concat(d,'"')));continue}u=u.concat(v({key:(e&&"".concat(e,"."))+d,value:t[d],valueSpec:m,style:a,styleSpec:o,object:t,objectKey:d,validateSpec:s},t))}for(let d in n)r[d]||n[d].required&&n[d].default===void 0&&t[d]===void 0&&u.push(new Rt(e,t,'missing required property "'.concat(d,'"')));return u}l(ps,"validateObject");function cA(i){let e=i.value,t=i.valueSpec,n=i.validateSpec,r=i.style,a=i.styleSpec,o=i.key,s=i.arrayElementValidator||n;if(Tn(e)!=="array")return[new Rt(o,e,"array expected, ".concat(Tn(e)," found"))];if(t.length&&e.length!==t.length)return[new Rt(o,e,"array length ".concat(t.length," expected, length ").concat(e.length," found"))];if(t["min-length"]&&e.length<t["min-length"])return[new Rt(o,e,"array length at least ".concat(t["min-length"]," expected, length ").concat(e.length," found"))];let u={type:t.value,values:t.values};a.$version<7&&(u.function=t.function),Tn(t.value)==="object"&&(u=t.value);let h=[];for(let d=0;d<e.length;d++)h=h.concat(s({array:e,arrayIndex:d,value:e[d],valueSpec:u,validateSpec:i.validateSpec,style:r,styleSpec:a,key:"".concat(o,"[").concat(d,"]")}));return h}l(cA,"validateArray");function pA(i){let e=i.key,t=i.value,n=i.valueSpec,r=Tn(t);return r==="number"&&t!==t&&(r="NaN"),r!=="number"?[new Rt(e,t,"number expected, ".concat(r," found"))]:"minimum"in n&&t<n.minimum?[new Rt(e,t,"".concat(t," is less than the minimum value ").concat(n.minimum))]:"maximum"in n&&t>n.maximum?[new Rt(e,t,"".concat(t," is greater than the maximum value ").concat(n.maximum))]:[]}l(pA,"validateNumber");function k5(i){let e=i.valueSpec,t=Rr(i.value.type),n,r={},a,o,s=t!=="categorical"&&i.value.property===void 0,u=!s,h=Tn(i.value.stops)==="array"&&Tn(i.value.stops[0])==="array"&&Tn(i.value.stops[0][0])==="object",d=ps({key:i.key,value:i.value,valueSpec:i.styleSpec.function,validateSpec:i.validateSpec,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:f,default:b}});return t==="identity"&&s&&d.push(new Rt(i.key,i.value,'missing required property "property"')),t!=="identity"&&!i.value.stops&&d.push(new Rt(i.key,i.value,'missing required property "stops"')),t==="exponential"&&i.valueSpec.expression&&!lA(i.valueSpec)&&d.push(new Rt(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(u&&!gd(i.valueSpec)?d.push(new Rt(i.key,i.value,"property functions not supported")):s&&!E5(i.valueSpec)&&d.push(new Rt(i.key,i.value,"zoom functions not supported"))),(t==="categorical"||h)&&i.value.property===void 0&&d.push(new Rt(i.key,i.value,'"property" property is required')),d;function f(w){if(t==="identity")return[new Rt(w.key,w.value,'identity function may not have a "stops" property')];let A=[],E=w.value;return A=A.concat(cA({key:w.key,value:E,valueSpec:w.valueSpec,validateSpec:w.validateSpec,style:w.style,styleSpec:w.styleSpec,arrayElementValidator:m})),Tn(E)==="array"&&E.length===0&&A.push(new Rt(w.key,E,"array must have at least one stop")),A}function m(w){let A=[],E=w.value,I=w.key;if(Tn(E)!=="array")return[new Rt(I,E,"array expected, ".concat(Tn(E)," found"))];if(E.length!==2)return[new Rt(I,E,"array length 2 expected, length ".concat(E.length," found"))];if(h){if(Tn(E[0])!=="object")return[new Rt(I,E,"object expected, ".concat(Tn(E[0])," found"))];if(E[0].zoom===void 0)return[new Rt(I,E,"object stop key must have zoom")];if(E[0].value===void 0)return[new Rt(I,E,"object stop key must have value")];if(o&&o>Rr(E[0].zoom))return[new Rt(I,E[0].zoom,"stop zoom values must appear in ascending order")];Rr(E[0].zoom)!==o&&(o=Rr(E[0].zoom),a=void 0,r={}),A=A.concat(ps({key:"".concat(I,"[0]"),value:E[0],valueSpec:{zoom:{}},validateSpec:w.validateSpec,style:w.style,styleSpec:w.styleSpec,objectElementValidators:{zoom:pA,value:v}}))}else A=A.concat(v({key:"".concat(I,"[0]"),value:E[0],validateSpec:w.validateSpec,style:w.style,styleSpec:w.styleSpec},E));return Ug(Bc(E[1]))?A.concat([new Rt("".concat(I,"[1]"),E[1],"expressions are not allowed in function stops.")]):A.concat(w.validateSpec({key:"".concat(I,"[1]"),value:E[1],valueSpec:e,validateSpec:w.validateSpec,style:w.style,styleSpec:w.styleSpec}))}function v(w,A){let E=Tn(w.value),I=Rr(w.value),C=w.value!==null?w.value:A;if(!n)n=E;else if(E!==n)return[new Rt(w.key,C,"".concat(E," stop domain type must match previous stop domain type ").concat(n))];if(E!=="number"&&E!=="string"&&E!=="boolean")return[new Rt(w.key,C,"stop domain value must be a number, string, or boolean")];if(E!=="number"&&t!=="categorical"){let T="number expected, ".concat(E," found");return gd(e)&&t===void 0&&(T+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Rt(w.key,C,T)]}return t==="categorical"&&E==="number"&&(!isFinite(I)||Math.floor(I)!==I)?[new Rt(w.key,C,"integer expected, found ".concat(I))]:t!=="categorical"&&E==="number"&&a!==void 0&&I<a?[new Rt(w.key,C,"stop domain values must appear in ascending order")]:(a=I,t==="categorical"&&I in r?[new Rt(w.key,C,"stop domain values must be unique")]:(r[I]=!0,[]))}function b(w){return w.validateSpec({key:w.key,value:w.value,valueSpec:e,validateSpec:w.validateSpec,style:w.style,styleSpec:w.styleSpec})}}l(k5,"validateFunction");function yd(i){let e=(i.expressionContext==="property"?P5:uA)(Bc(i.value),i.valueSpec);if(e.result==="error")return e.value.map(n=>new Rt("".concat(i.key).concat(n.key),i.value,n.message));let t=e.value.expression||e.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!t.outputDefined())return[new Rt(i.key,i.value,'Invalid data expression for "'.concat(i.propertyKey,'". Output values must be contained as literals within the expression.'))];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!mg(t))return[new Rt(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!mg(t))return[new Rt(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!a0(t,["zoom","feature-state"]))return[new Rt(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!r0(t))return[new Rt(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}l(yd,"validateExpression");function QV(i){let e=i.value,t=i.key,n=Tn(e);return n!=="boolean"?[new Rt(t,e,"boolean expected, ".concat(n," found"))]:[]}l(QV,"validateBoolean");function ej(i){let e=i.key,t=i.value,n=Tn(t);return n!=="string"?[new Rt(e,t,"color expected, ".concat(n," found"))]:Wi.parse(String(t))?[]:[new Rt(e,t,'color expected, "'.concat(t,'" found'))]}l(ej,"validateColor");function gg(i){let e=i.key,t=i.value,n=i.valueSpec,r=[];return Array.isArray(n.values)?n.values.indexOf(Rr(t))===-1&&r.push(new Rt(e,t,"expected one of [".concat(n.values.join(", "),"], ").concat(JSON.stringify(t)," found"))):Object.keys(n.values).indexOf(Rr(t))===-1&&r.push(new Rt(e,t,"expected one of [".concat(Object.keys(n.values).join(", "),"], ").concat(JSON.stringify(t)," found"))),r}l(gg,"validateEnum");function dA(i){return hA(Bc(i.value))?yd(md({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):R5(i)}l(dA,"validateFilter");function R5(i){let e=i.value,t=i.key;if(Tn(e)!=="array")return[new Rt(t,e,"array expected, ".concat(Tn(e)," found"))];let n=i.styleSpec,r,a=[];if(e.length<1)return[new Rt(t,e,"filter array must have at least 1 element")];switch(a=a.concat(gg({key:"".concat(t,"[0]"),value:e[0],valueSpec:n.filter_operator,style:i.style,styleSpec:i.styleSpec})),Rr(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Rr(e[1])==="$type"&&a.push(new Rt(t,e,'"$type" cannot be use with operator "'.concat(e[0],'"')));case"==":case"!=":e.length!==3&&a.push(new Rt(t,e,'filter array for operator "'.concat(e[0],'" must have 3 elements')));case"in":case"!in":e.length>=2&&(r=Tn(e[1]),r!=="string"&&a.push(new Rt("".concat(t,"[1]"),e[1],"string expected, ".concat(r," found"))));for(let o=2;o<e.length;o++)r=Tn(e[o]),Rr(e[1])==="$type"?a=a.concat(gg({key:"".concat(t,"[").concat(o,"]"),value:e[o],valueSpec:n.geometry_type,style:i.style,styleSpec:i.styleSpec})):r!=="string"&&r!=="number"&&r!=="boolean"&&a.push(new Rt("".concat(t,"[").concat(o,"]"),e[o],"string, number, or boolean expected, ".concat(r," found")));break;case"any":case"all":case"none":for(let o=1;o<e.length;o++)a=a.concat(R5({key:"".concat(t,"[").concat(o,"]"),value:e[o],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":r=Tn(e[1]),e.length!==2?a.push(new Rt(t,e,'filter array for "'.concat(e[0],'" operator must have 2 elements'))):r!=="string"&&a.push(new Rt("".concat(t,"[1]"),e[1],"string expected, ".concat(r," found")));break}return a}l(R5,"validateNonExpressionFilter");function O5(i,e){let t=i.key,n=i.validateSpec,r=i.style,a=i.styleSpec,o=i.value,s=i.objectKey,u=a["".concat(e,"_").concat(i.layerType)];if(!u)return[];let h=s.match(/^(.*)-transition$/);if(e==="paint"&&h&&u[h[1]]&&u[h[1]].transition)return n({key:t,value:o,valueSpec:a.transition,style:r,styleSpec:a});let d=i.valueSpec||u[s];if(!d)return[new Rt(t,o,'unknown property "'.concat(s,'"'))];let f;if(Tn(o)==="string"&&gd(d)&&!d.tokens&&(f=/^{([^}]+)}$/.exec(o)))return[new Rt(t,o,'"'.concat(s,`" does not support interpolation syntax
`)+'Use an identity property function instead: `{ "type": "identity", "property": '.concat(JSON.stringify(f[1])," }`."))];let m=[];return i.layerType==="symbol"&&(s==="text-field"&&r&&!r.glyphs&&m.push(new Rt(t,o,'use of "text-field" requires a style "glyphs" property')),s==="text-font"&&o0(Bc(o))&&Rr(o.type)==="identity"&&m.push(new Rt(t,o,'"text-font" does not support identity functions'))),m.concat(n({key:i.key,value:o,valueSpec:d,style:r,styleSpec:a,expressionContext:"property",propertyType:e,propertyKey:s}))}l(O5,"validateProperty");function N5(i){return O5(i,"paint")}l(N5,"validatePaintProperty");function F5(i){return O5(i,"layout")}l(F5,"validateLayoutProperty");function B5(i){let e=[],t=i.value,n=i.key,r=i.style,a=i.styleSpec;!t.type&&!t.ref&&e.push(new Rt(n,t,'either "type" or "ref" is required'));let o=Rr(t.type),s=Rr(t.ref);if(t.id){let u=Rr(t.id);for(let h=0;h<i.arrayIndex;h++){let d=r.layers[h];Rr(d.id)===u&&e.push(new Rt(n,t.id,'duplicate layer id "'.concat(t.id,'", previously used at line ').concat(d.id.__line__)))}}if("ref"in t){["type","source","source-layer","filter","layout"].forEach(h=>{h in t&&e.push(new Rt(n,t[h],'"'.concat(h,'" is prohibited for ref layers')))});let u;r.layers.forEach(h=>{Rr(h.id)===s&&(u=h)}),u?u.ref?e.push(new Rt(n,t.ref,"ref cannot reference another ref layer")):o=Rr(u.type):e.push(new Rt(n,t.ref,'ref layer "'.concat(s,'" not found')))}else if(o!=="background")if(!t.source)e.push(new Rt(n,t,'missing required property "source"'));else{let u=r.sources&&r.sources[t.source],h=u&&Rr(u.type);u?h==="vector"&&o==="raster"?e.push(new Rt(n,t.source,'layer "'.concat(t.id,'" requires a raster source'))):h!=="raster-dem"&&o==="hillshade"?e.push(new Rt(n,t.source,'layer "'.concat(t.id,'" requires a raster-dem source'))):h==="raster"&&o!=="raster"?e.push(new Rt(n,t.source,'layer "'.concat(t.id,'" requires a vector source'))):h==="vector"&&!t["source-layer"]?e.push(new Rt(n,t,'layer "'.concat(t.id,'" must specify a "source-layer"'))):h==="raster-dem"&&o!=="hillshade"?e.push(new Rt(n,t.source,"raster-dem source can only be used with layer type 'hillshade'.")):o==="line"&&t.paint&&t.paint["line-gradient"]&&(h!=="geojson"||!u.lineMetrics)&&e.push(new Rt(n,t,'layer "'.concat(t.id,'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.'))):e.push(new Rt(n,t.source,'source "'.concat(t.source,'" not found')))}return e=e.concat(ps({key:n,value:t,valueSpec:a.layer,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,objectElementValidators:{"*"(){return[]},type(){return i.validateSpec({key:"".concat(n,".type"),value:t.type,valueSpec:a.layer.type,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,object:t,objectKey:"type"})},filter:dA,layout(u){return ps({layer:t,key:u.key,value:u.value,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,objectElementValidators:{"*"(h){return F5(md({layerType:o},h))}}})},paint(u){return ps({layer:t,key:u.key,value:u.value,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,objectElementValidators:{"*"(h){return N5(md({layerType:o},h))}}})}}})),e}l(B5,"validateLayer");function zc(i){let e=i.value,t=i.key,n=Tn(e);return n!=="string"?[new Rt(t,e,"string expected, ".concat(n," found"))]:[]}l(zc,"validateString");function tj(i){var e;let t=(e=i.sourceName)!==null&&e!==void 0?e:"",n=i.value,r=i.styleSpec,a=r.source_raster_dem,o=i.style,s=[],u=Tn(n);if(n===void 0)return s;if(u!=="object")return s.push(new Rt("source_raster_dem",n,"object expected, ".concat(u," found"))),s;let h=Rr(n.encoding)==="custom",d=["redFactor","greenFactor","blueFactor","baseShift"],f=i.value.encoding?'"'.concat(i.value.encoding,'"'):"Default";for(let m in n)!h&&d.includes(m)?s.push(new Rt(m,n[m],'In "'.concat(t,'": "').concat(m,'" is only valid when "encoding" is set to "custom". ').concat(f," encoding found"))):a[m]?s=s.concat(i.validateSpec({key:m,value:n[m],valueSpec:a[m],validateSpec:i.validateSpec,style:o,styleSpec:r})):s.push(new Rt(m,n[m],'unknown property "'.concat(m,'"')));return s}l(tj,"validateRasterDEMSource");var Bk={promoteId:ij};function z5(i){let e=i.value,t=i.key,n=i.styleSpec,r=i.style,a=i.validateSpec;if(!e.type)return[new Rt(t,e,'"type" is required')];let o=Rr(e.type),s;switch(o){case"vector":case"raster":return s=ps({key:t,value:e,valueSpec:n["source_".concat(o.replace("-","_"))],style:i.style,styleSpec:n,objectElementValidators:Bk,validateSpec:a}),s;case"raster-dem":return s=tj({sourceName:t,value:e,style:i.style,styleSpec:n,validateSpec:a}),s;case"geojson":if(s=ps({key:t,value:e,valueSpec:n.source_geojson,style:r,styleSpec:n,validateSpec:a,objectElementValidators:Bk}),e.cluster)for(let u in e.clusterProperties){let[h,d]=e.clusterProperties[u],f=typeof h=="string"?[h,["accumulated"],["get",u]]:h;s.push(...yd({key:"".concat(t,".").concat(u,".map"),value:d,expressionContext:"cluster-map"})),s.push(...yd({key:"".concat(t,".").concat(u,".reduce"),value:f,expressionContext:"cluster-reduce"}))}return s;case"video":return ps({key:t,value:e,valueSpec:n.source_video,style:r,validateSpec:a,styleSpec:n});case"image":return ps({key:t,value:e,valueSpec:n.source_image,style:r,validateSpec:a,styleSpec:n});case"canvas":return[new Rt(t,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return gg({key:"".concat(t,".type"),value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}l(z5,"validateSource");function ij({key:i,value:e}){if(Tn(e)==="string")return zc({key:i,value:e});{let t=[];for(let n in e)t.push(...zc({key:"".concat(i,".").concat(n),value:e[n]}));return t}}l(ij,"validatePromoteId");function U5(i){let e=i.value,t=i.styleSpec,n=t.light,r=i.style,a=[],o=Tn(e);if(e===void 0)return a;if(o!=="object")return a=a.concat([new Rt("light",e,"object expected, ".concat(o," found"))]),a;for(let s in e){let u=s.match(/^(.*)-transition$/);u&&n[u[1]]&&n[u[1]].transition?a=a.concat(i.validateSpec({key:s,value:e[s],valueSpec:t.transition,validateSpec:i.validateSpec,style:r,styleSpec:t})):n[s]?a=a.concat(i.validateSpec({key:s,value:e[s],valueSpec:n[s],validateSpec:i.validateSpec,style:r,styleSpec:t})):a=a.concat([new Rt(s,e[s],'unknown property "'.concat(s,'"'))])}return a}l(U5,"validateLight");function V5(i){let e=i.value,t=i.styleSpec,n=t.sky,r=i.style,a=Tn(e);if(e===void 0)return[];if(a!=="object")return[new Rt("sky",e,"object expected, ".concat(a," found"))];let o=[];for(let s in e)n[s]?o=o.concat(i.validateSpec({key:s,value:e[s],valueSpec:n[s],style:r,styleSpec:t})):o=o.concat([new Rt(s,e[s],'unknown property "'.concat(s,'"'))]);return o}l(V5,"validateSky");function j5(i){let e=i.value,t=i.styleSpec,n=t.terrain,r=i.style,a=[],o=Tn(e);if(e===void 0)return a;if(o!=="object")return a=a.concat([new Rt("terrain",e,"object expected, ".concat(o," found"))]),a;for(let s in e)n[s]?a=a.concat(i.validateSpec({key:s,value:e[s],valueSpec:n[s],validateSpec:i.validateSpec,style:r,styleSpec:t})):a=a.concat([new Rt(s,e[s],'unknown property "'.concat(s,'"'))]);return a}l(j5,"validateTerrain");function nj(i){return zc(i).length===0?[]:yd(i)}l(nj,"validateFormatted");function rj(i){return zc(i).length===0?[]:yd(i)}l(rj,"validateImage");function aj(i){let e=i.key,t=i.value;if(Tn(t)==="array"){if(t.length<1||t.length>4)return[new Rt(e,t,"padding requires 1 to 4 values; ".concat(t.length," values found"))];let n={type:"number"},r=[];for(let a=0;a<t.length;a++)r=r.concat(i.validateSpec({key:"".concat(e,"[").concat(a,"]"),value:t[a],validateSpec:i.validateSpec,valueSpec:n}));return r}else return pA({key:e,value:t,valueSpec:{}})}l(aj,"validatePadding");function oj(i){let e=i.key,t=i.value,n=Tn(t),r=i.styleSpec;if(n!=="array"||t.length<1||t.length%2!==0)return[new Rt(e,t,"variableAnchorOffsetCollection requires a non-empty array of even length")];let a=[];for(let o=0;o<t.length;o+=2)a=a.concat(gg({key:"".concat(e,"[").concat(o,"]"),value:t[o],valueSpec:r.layout_symbol["text-anchor"]})),a=a.concat(cA({key:"".concat(e,"[").concat(o+1,"]"),value:t[o+1],valueSpec:{length:2,value:"number"},validateSpec:i.validateSpec,style:i.style,styleSpec:r}));return a}l(oj,"validateVariableAnchorOffsetCollection");function G5(i){let e=[],t=i.value,n=i.key;if(Array.isArray(t)){let r=[],a=[];for(let o in t){t[o].id&&r.includes(t[o].id)&&e.push(new Rt(n,t,"all the sprites' ids must be unique, but ".concat(t[o].id," is duplicated"))),r.push(t[o].id),t[o].url&&a.includes(t[o].url)&&e.push(new Rt(n,t,"all the sprites' URLs must be unique, but ".concat(t[o].url," is duplicated"))),a.push(t[o].url);let s={id:{type:"string",required:!0},url:{type:"string",required:!0}};e=e.concat(ps({key:"".concat(n,"[").concat(o,"]"),value:t[o],valueSpec:s,validateSpec:i.validateSpec}))}return e}else return zc({key:n,value:t})}l(G5,"validateSprite");function sj(i){let e=i.value,t=i.styleSpec,n=t.projection,r=i.style,a=Tn(e);if(e===void 0)return[];if(a!=="object")return[new Rt("projection",e,"object expected, ".concat(a," found"))];let o=[];for(let s in e)n[s]?o=o.concat(i.validateSpec({key:s,value:e[s],valueSpec:n[s],style:r,styleSpec:t})):o=o.concat([new Rt(s,e[s],'unknown property "'.concat(s,'"'))]);return o}l(sj,"validateProjection");var zk={"*"(){return[]},array:cA,boolean:QV,number:pA,color:ej,constants:D5,enum:gg,filter:dA,function:k5,layer:B5,object:ps,source:z5,light:U5,sky:V5,terrain:j5,projection:sj,string:zc,formatted:nj,resolvedImage:rj,padding:aj,variableAnchorOffsetCollection:oj,sprite:G5};function o1(i){let e=i.value,t=i.valueSpec,n=i.styleSpec;return i.validateSpec=o1,t.expression&&o0(Rr(e))?k5(i):t.expression&&Ug(Bc(e))?yd(i):t.type&&zk[t.type]?zk[t.type](i):ps(md({},i,{valueSpec:t.type?n[t.type]:t}))}l(o1,"validate");function $5(i){let e=i.value,t=i.key,n=zc(i);return n.length||(e.indexOf("{fontstack}")===-1&&n.push(new Rt(t,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&n.push(new Rt(t,e,'"glyphs" url must include a "{range}" token'))),n}l($5,"validateGlyphsUrl");function Us(i,e=ht){let t=[];return t=t.concat(o1({key:"",value:i,valueSpec:e.$root,styleSpec:e,style:i,validateSpec:o1,objectElementValidators:{glyphs:$5,"*"(){return[]}}})),i.constants&&(t=t.concat(D5({key:"constants",value:i.constants}))),H5(t)}l(Us,"validateStyleMin");Us.source=Al(wl(z5));Us.sprite=Al(wl(G5));Us.glyphs=Al(wl($5));Us.light=Al(wl(U5));Us.sky=Al(wl(V5));Us.terrain=Al(wl(j5));Us.layer=Al(wl(B5));Us.filter=Al(wl(dA));Us.paintProperty=Al(wl(N5));Us.layoutProperty=Al(wl(F5));function wl(i){return function(e){return i(lt(Me({},e),{validateSpec:o1}))}}l(wl,"injectValidateSpec");function H5(i){return[].concat(i).sort((e,t)=>e.line-t.line)}l(H5,"sortErrors");function Al(i){return function(...e){return H5(i.apply(this,e))}}l(Al,"wrapCleanErrors");R();var wa=Us;wa.source;var zge=wa.light;wa.terrain;wa.filter;var Uge=wa.paintProperty,Vge=wa.layoutProperty;function fA(i,e){let t=!1;if(e&&e.length)for(let n of e)i.fire(new ki(new Error(n.message))),t=!0;return t}l(fA,"emitValidationErrors");R();R();R();var lj=class uj{constructor(e,t,n){let r=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;let o=new Int32Array(this.arrayBuffer);e=o[0],t=o[1],n=o[2],this.d=t+2*n;for(let h=0;h<this.d*this.d;h++){let d=o[3+h],f=o[3+h+1];r.push(d===f?null:o.subarray(d,f))}let s=o[3+r.length],u=o[3+r.length+1];this.keys=o.subarray(s,u),this.bboxes=o.subarray(u),this.insert=this._insertReadonly}else{this.d=t+2*n;for(let o=0;o<this.d*this.d;o++)r.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=n,this.scale=t/e,this.uid=0;let a=n/t*e;this.min=-a,this.max=e+a}insert(e,t,n,r,a){this._forEachCell(t,n,r,a,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(a)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,t,n,r,a,o){this.cells[a].push(o)}query(e,t,n,r,a){let o=this.min,s=this.max;if(e<=o&&t<=o&&s<=n&&s<=r&&!a)return Array.prototype.slice.call(this.keys);{let u=[],h={};return this._forEachCell(e,t,n,r,this._queryCell,u,h,a),u}}_queryCell(e,t,n,r,a,o,s,u){let h=this.cells[a];if(h!==null){let d=this.keys,f=this.bboxes;for(let m=0;m<h.length;m++){let v=h[m];if(s[v]===void 0){let b=v*4;(u?u(f[b+0],f[b+1],f[b+2],f[b+3]):e<=f[b+2]&&t<=f[b+3]&&n>=f[b+0]&&r>=f[b+1])?(s[v]=!0,o.push(d[v])):s[v]=!1}}}}_forEachCell(e,t,n,r,a,o,s,u){let h=this._convertToCellCoord(e),d=this._convertToCellCoord(t),f=this._convertToCellCoord(n),m=this._convertToCellCoord(r);for(let v=h;v<=f;v++)for(let b=d;b<=m;b++){let w=this.d*b+v;if(!(u&&!u(this._convertFromCellCoord(v),this._convertFromCellCoord(b),this._convertFromCellCoord(v+1),this._convertFromCellCoord(b+1)))&&a.call(this,e,t,n,r,w,o,s,u))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let e=this.cells,t=3+this.cells.length+1+1,n=0;for(let o=0;o<this.cells.length;o++)n+=this.cells[o].length;let r=new Int32Array(t+n+this.keys.length+this.bboxes.length);r[0]=this.extent,r[1]=this.n,r[2]=this.padding;let a=t;for(let o=0;o<e.length;o++){let s=e[o];r[3+o]=a,r.set(s,a),a+=s.length}return r[3+e.length]=a,r.set(this.keys,a),a+=this.keys.length,r[3+e.length+1]=a,r.set(this.bboxes,a),a+=this.bboxes.length,r.buffer}static serialize(e,t){let n=e.toArrayBuffer();return t&&t.push(n),{buffer:n}}static deserialize(e){return new uj(e.buffer)}};l(lj,"TransferableGridIndex");var A3=lj,Dc={};function Zt(i,e,t={}){if(Dc[i])throw new Error("".concat(i," is already registered."));Object.defineProperty(e,"_classRegistryKey",{value:i,writeable:!1}),Dc[i]={klass:e,omit:t.omit||[],shallow:t.shallow||[]}}l(Zt,"register");Zt("Object",Object);Zt("TransferableGridIndex",A3);Zt("Color",Wi);Zt("Error",Error);Zt("AJAXError",r5);Zt("ResolvedImage",uu);Zt("StylePropertyFunction",WV);Zt("StyleExpression",T5,{omit:["_evaluator"]});Zt("ZoomDependentExpression",tw);Zt("ZoomConstantExpression",ew);Zt("CompoundExpression",Dd,{omit:["_evaluate"]});for(let i in jm)jm[i]._classRegistryKey||Zt("Expression_".concat(i),jm[i]);function W5(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}l(W5,"isArrayBuffer");function Gm(i,e){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||i instanceof Error)return i;if(W5(i)||eu(i))return e&&e.push(i),i;if(ArrayBuffer.isView(i)){let t=i;return e&&e.push(t.buffer),t}if(i instanceof ImageData)return e&&e.push(i.data.buffer),i;if(Array.isArray(i)){let t=[];for(let n of i)t.push(Gm(n,e));return t}if(typeof i=="object"){let t=i.constructor,n=t._classRegistryKey;if(!n)throw new Error("can't serialize object of unregistered class ".concat(t.name));if(!Dc[n])throw new Error("".concat(n," is not registered."));let r=t.serialize?t.serialize(i,e):{};if(t.serialize){if(e&&r===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(let a in i){if(!i.hasOwnProperty(a)||Dc[n].omit.indexOf(a)>=0)continue;let o=i[a];r[a]=Dc[n].shallow.indexOf(a)>=0?o:Gm(o,e)}i instanceof Error&&(r.message=i.message)}if(r.$name)throw new Error("$name property is reserved for worker serialization logic.");return n!=="Object"&&(r.$name=n),r}throw new Error("can't serialize object of type ".concat(typeof i))}l(Gm,"serialize");function $m(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||i instanceof Error||W5(i)||eu(i)||ArrayBuffer.isView(i)||i instanceof ImageData)return i;if(Array.isArray(i))return i.map($m);if(typeof i=="object"){let e=i.$name||"Object";if(!Dc[e])throw new Error("can't deserialize unregistered class ".concat(e));let{klass:t}=Dc[e];if(!t)throw new Error("can't deserialize unregistered class ".concat(e));if(t.deserialize)return t.deserialize(i);let n=Object.create(t.prototype);for(let r of Object.keys(i)){if(r==="$name")continue;let a=i[r];n[r]=Dc[e].shallow.indexOf(r)>=0?a:$m(a)}return n}throw new Error("can't deserialize object of type ".concat(typeof i))}l($m,"deserialize");R();R();var hj=class{constructor(){this.first=!0}update(e,t){let n=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=t),e!==this.lastZoom?(this.lastZoom=e,this.lastFloorZoom=n,!0):!1)}};l(hj,"ZoomHistory");var cj=hj;R();R();var bn={"Latin-1 Supplement":l(i=>i>=128&&i<=255,"Latin-1 Supplement"),Arabic:l(i=>i>=1536&&i<=1791,"Arabic"),"Arabic Supplement":l(i=>i>=1872&&i<=1919,"Arabic Supplement"),"Arabic Extended-A":l(i=>i>=2208&&i<=2303,"Arabic Extended-A"),"Hangul Jamo":l(i=>i>=4352&&i<=4607,"Hangul Jamo"),"Unified Canadian Aboriginal Syllabics":l(i=>i>=5120&&i<=5759,"Unified Canadian Aboriginal Syllabics"),Khmer:l(i=>i>=6016&&i<=6143,"Khmer"),"Unified Canadian Aboriginal Syllabics Extended":l(i=>i>=6320&&i<=6399,"Unified Canadian Aboriginal Syllabics Extended"),"General Punctuation":l(i=>i>=8192&&i<=8303,"General Punctuation"),"Letterlike Symbols":l(i=>i>=8448&&i<=8527,"Letterlike Symbols"),"Number Forms":l(i=>i>=8528&&i<=8591,"Number Forms"),"Miscellaneous Technical":l(i=>i>=8960&&i<=9215,"Miscellaneous Technical"),"Control Pictures":l(i=>i>=9216&&i<=9279,"Control Pictures"),"Optical Character Recognition":l(i=>i>=9280&&i<=9311,"Optical Character Recognition"),"Enclosed Alphanumerics":l(i=>i>=9312&&i<=9471,"Enclosed Alphanumerics"),"Geometric Shapes":l(i=>i>=9632&&i<=9727,"Geometric Shapes"),"Miscellaneous Symbols":l(i=>i>=9728&&i<=9983,"Miscellaneous Symbols"),"Miscellaneous Symbols and Arrows":l(i=>i>=11008&&i<=11263,"Miscellaneous Symbols and Arrows"),"CJK Radicals Supplement":l(i=>i>=11904&&i<=12031,"CJK Radicals Supplement"),"Kangxi Radicals":l(i=>i>=12032&&i<=12255,"Kangxi Radicals"),"Ideographic Description Characters":l(i=>i>=12272&&i<=12287,"Ideographic Description Characters"),"CJK Symbols and Punctuation":l(i=>i>=12288&&i<=12351,"CJK Symbols and Punctuation"),Hiragana:l(i=>i>=12352&&i<=12447,"Hiragana"),Katakana:l(i=>i>=12448&&i<=12543,"Katakana"),Bopomofo:l(i=>i>=12544&&i<=12591,"Bopomofo"),"Hangul Compatibility Jamo":l(i=>i>=12592&&i<=12687,"Hangul Compatibility Jamo"),Kanbun:l(i=>i>=12688&&i<=12703,"Kanbun"),"Bopomofo Extended":l(i=>i>=12704&&i<=12735,"Bopomofo Extended"),"CJK Strokes":l(i=>i>=12736&&i<=12783,"CJK Strokes"),"Katakana Phonetic Extensions":l(i=>i>=12784&&i<=12799,"Katakana Phonetic Extensions"),"Enclosed CJK Letters and Months":l(i=>i>=12800&&i<=13055,"Enclosed CJK Letters and Months"),"CJK Compatibility":l(i=>i>=13056&&i<=13311,"CJK Compatibility"),"CJK Unified Ideographs Extension A":l(i=>i>=13312&&i<=19903,"CJK Unified Ideographs Extension A"),"Yijing Hexagram Symbols":l(i=>i>=19904&&i<=19967,"Yijing Hexagram Symbols"),"CJK Unified Ideographs":l(i=>i>=19968&&i<=40959,"CJK Unified Ideographs"),"Yi Syllables":l(i=>i>=40960&&i<=42127,"Yi Syllables"),"Yi Radicals":l(i=>i>=42128&&i<=42191,"Yi Radicals"),"Hangul Jamo Extended-A":l(i=>i>=43360&&i<=43391,"Hangul Jamo Extended-A"),"Hangul Syllables":l(i=>i>=44032&&i<=55215,"Hangul Syllables"),"Hangul Jamo Extended-B":l(i=>i>=55216&&i<=55295,"Hangul Jamo Extended-B"),"Private Use Area":l(i=>i>=57344&&i<=63743,"Private Use Area"),"CJK Compatibility Ideographs":l(i=>i>=63744&&i<=64255,"CJK Compatibility Ideographs"),"Arabic Presentation Forms-A":l(i=>i>=64336&&i<=65023,"Arabic Presentation Forms-A"),"Vertical Forms":l(i=>i>=65040&&i<=65055,"Vertical Forms"),"CJK Compatibility Forms":l(i=>i>=65072&&i<=65103,"CJK Compatibility Forms"),"Small Form Variants":l(i=>i>=65104&&i<=65135,"Small Form Variants"),"Arabic Presentation Forms-B":l(i=>i>=65136&&i<=65279,"Arabic Presentation Forms-B"),"Halfwidth and Fullwidth Forms":l(i=>i>=65280&&i<=65519,"Halfwidth and Fullwidth Forms")};function pj(i){for(let e of i)if(dj(e.charCodeAt(0)))return!0;return!1}l(pj,"allowsVerticalWritingMode");function dj(i){return i===746||i===747?!0:i<4352?!1:!!(bn["Bopomofo Extended"](i)||bn.Bopomofo(i)||bn["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||bn["CJK Compatibility Ideographs"](i)||bn["CJK Compatibility"](i)||bn["CJK Radicals Supplement"](i)||bn["CJK Strokes"](i)||bn["CJK Symbols and Punctuation"](i)&&!(i>=12296&&i<=12305)&&!(i>=12308&&i<=12319)&&i!==12336||bn["CJK Unified Ideographs Extension A"](i)||bn["CJK Unified Ideographs"](i)||bn["Enclosed CJK Letters and Months"](i)||bn["Hangul Compatibility Jamo"](i)||bn["Hangul Jamo Extended-A"](i)||bn["Hangul Jamo Extended-B"](i)||bn["Hangul Jamo"](i)||bn["Hangul Syllables"](i)||bn.Hiragana(i)||bn["Ideographic Description Characters"](i)||bn.Kanbun(i)||bn["Kangxi Radicals"](i)||bn["Katakana Phonetic Extensions"](i)||bn.Katakana(i)&&i!==12540||bn["Halfwidth and Fullwidth Forms"](i)&&i!==65288&&i!==65289&&i!==65293&&!(i>=65306&&i<=65310)&&i!==65339&&i!==65341&&i!==65343&&!(i>=65371&&i<=65503)&&i!==65507&&!(i>=65512&&i<=65519)||bn["Small Form Variants"](i)&&!(i>=65112&&i<=65118)&&!(i>=65123&&i<=65126)||bn["Unified Canadian Aboriginal Syllabics"](i)||bn["Unified Canadian Aboriginal Syllabics Extended"](i)||bn["Vertical Forms"](i)||bn["Yijing Hexagram Symbols"](i)||bn["Yi Syllables"](i)||bn["Yi Radicals"](i))}l(dj,"charHasUprightVerticalOrientation");function q5(i){return i>=1424&&i<=2303||bn["Arabic Presentation Forms-A"](i)||bn["Arabic Presentation Forms-B"](i)}l(q5,"charInRTLScript");function fj(i,e){return!(!e&&q5(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||bn.Khmer(i))}l(fj,"charInSupportedScript");function mj(i){for(let e of i)if(q5(e.charCodeAt(0)))return!0;return!1}l(mj,"stringContainsRTLText");function gj(i,e){for(let t of i)if(!fj(t.charCodeAt(0),e))return!1;return!0}l(gj,"isStringInSupportedScript");R();var yj=class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(e){this.pluginStatus=e.pluginStatus,this.pluginURL=e.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(e){this.applyArabicShaping=e.applyArabicShaping,this.processBidirectionalText=e.processBidirectionalText,this.processStyledBidirectionalText=e.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};l(yj,"RTLWorkerPlugin");var jge=yj,s1=new jge,vj=class{constructor(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new cj,this.transition={})}isSupportedScript(e){return gj(e,s1.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let e=this.zoom,t=e-Math.floor(e),n=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*t}}};l(vj,"EvaluationParameters");var fa=vj,_j=class{constructor(e,t){this.property=e,this.value=t,this.expression=qV(t===void 0?e.specification.default:t,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,t,n){return this.property.possiblyEvaluate(this,e,t,n)}};l(_j,"PropertyValue");var mA=_j,xj=class{constructor(e){this.property=e,this.value=new mA(e,void 0)}transitioned(e,t){return new Uk(this.property,this.value,t,ti({},e.transition,this.transition),e.now)}untransitioned(){return new Uk(this.property,this.value,null,{},0)}};l(xj,"TransitionablePropertyValue");var S3=xj,bj=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return cs(this._values[e].value.value)}setValue(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new S3(this._values[e].property)),this._values[e].value=new mA(this._values[e].property,t===null?void 0:cs(t))}getTransition(e){return cs(this._values[e].transition)}setTransition(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new S3(this._values[e].property)),this._values[e].transition=cs(t)||void 0}serialize(){let e={};for(let t of Object.keys(this._values)){let n=this.getValue(t);n!==void 0&&(e[t]=n);let r=this.getTransition(t);r!==void 0&&(e["".concat(t,"-transition")]=r)}return e}transitioned(e,t){let n=new Vk(this._properties);for(let r of Object.keys(this._values))n._values[r]=this._values[r].transitioned(e,t._values[r]);return n}untransitioned(){let e=new Vk(this._properties);for(let t of Object.keys(this._values))e._values[t]=this._values[t].untransitioned();return e}};l(bj,"Transitionable");var wj=bj,Aj=class{constructor(e,t,n,r,a){this.property=e,this.value=t,this.begin=a+r.delay||0,this.end=this.begin+r.duration||0,e.specification.transition&&(r.delay||r.duration)&&(this.prior=n)}possiblyEvaluate(e,t,n){let r=e.now||0,a=this.value.possiblyEvaluate(e,t,n),o=this.prior;if(o){if(r>this.end)return this.prior=null,a;if(this.value.isDataDriven())return this.prior=null,a;if(r<this.begin)return o.possiblyEvaluate(e,t,n);{let s=(r-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(e,t,n),a,YB(s))}}else return a}};l(Aj,"TransitioningPropertyValue");var Uk=Aj,Sj=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,t,n){let r=new gA(this._properties);for(let a of Object.keys(this._values))r._values[a]=this._values[a].possiblyEvaluate(e,t,n);return r}hasTransition(){for(let e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}};l(Sj,"Transitioning");var Vk=Sj,Mj=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return this._values[e].value!==void 0}getValue(e){return cs(this._values[e].value)}setValue(e,t){this._values[e]=new mA(this._values[e].property,t===null?void 0:cs(t))}serialize(){let e={};for(let t of Object.keys(this._values)){let n=this.getValue(t);n!==void 0&&(e[t]=n)}return e}possiblyEvaluate(e,t,n){let r=new gA(this._properties);for(let a of Object.keys(this._values))r._values[a]=this._values[a].possiblyEvaluate(e,t,n);return r}};l(Mj,"Layout");var Gge=Mj,Cj=class{constructor(e,t,n){this.property=e,this.value=t,this.parameters=n}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,t,n,r){return this.property.evaluate(this.value,this.parameters,e,t,n,r)}};l(Cj,"PossiblyEvaluatedPropertyValue");var ml=Cj,Ej=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}};l(Ej,"PossiblyEvaluated");var gA=Ej,Ij=class{constructor(e){this.specification=e}possiblyEvaluate(e,t){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(t)}interpolate(e,t,n){let r=this.specification.type,a=Mr[r];return a?a(e,t,n):e}};l(Ij,"DataConstantProperty");var li=Ij,Tj=class{constructor(e,t){this.specification=e,this.overrides=t}possiblyEvaluate(e,t,n,r){return e.expression.kind==="constant"||e.expression.kind==="camera"?new ml(this,{kind:"constant",value:e.expression.evaluate(t,null,{},n,r)},t):new ml(this,e.expression,t)}interpolate(e,t,n){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new ml(this,{kind:"constant",value:void 0},e.parameters);let r=this.specification.type,a=Mr[r];if(a){let o=a(e.value.value,t.value.value,n);return new ml(this,{kind:"constant",value:o},e.parameters)}else return e}evaluate(e,t,n,r,a,o){return e.kind==="constant"?e.value:e.evaluate(t,n,r,a,o)}};l(Tj,"DataDrivenProperty");var Pi=Tj,Pj=class extends Pi{possiblyEvaluate(e,t,n,r){if(e.value===void 0)return new ml(this,{kind:"constant",value:void 0},t);if(e.expression.kind==="constant"){let a=e.expression.evaluate(t,null,{},n,r),o=e.property.specification.type==="resolvedImage"&&typeof a!="string"?a.name:a,s=this._calculate(o,o,o,t);return new ml(this,{kind:"constant",value:s},t)}else if(e.expression.kind==="camera"){let a=this._calculate(e.expression.evaluate({zoom:t.zoom-1}),e.expression.evaluate({zoom:t.zoom}),e.expression.evaluate({zoom:t.zoom+1}),t);return new ml(this,{kind:"constant",value:a},t)}else return new ml(this,e.expression,t)}evaluate(e,t,n,r,a,o){if(e.kind==="source"){let s=e.evaluate(t,n,r,a,o);return this._calculate(s,s,s,t)}else return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(t.zoom)-1},n,r),e.evaluate({zoom:Math.floor(t.zoom)},n,r),e.evaluate({zoom:Math.floor(t.zoom)+1},n,r),t):e.value}_calculate(e,t,n,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:n,to:t}}interpolate(e){return e}};l(Pj,"CrossFadedDataDrivenProperty");var yA=Pj,Lj=class{constructor(e){this.specification=e}possiblyEvaluate(e,t,n,r){if(e.value!==void 0)if(e.expression.kind==="constant"){let a=e.expression.evaluate(t,null,{},n,r);return this._calculate(a,a,a,t)}else return this._calculate(e.expression.evaluate(new fa(Math.floor(t.zoom-1),t)),e.expression.evaluate(new fa(Math.floor(t.zoom),t)),e.expression.evaluate(new fa(Math.floor(t.zoom+1),t)),t)}_calculate(e,t,n,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:n,to:t}}interpolate(e){return e}};l(Lj,"CrossFadedProperty");var X5=Lj,Dj=class{constructor(e){this.specification=e}possiblyEvaluate(e,t,n,r){return!!e.expression.evaluate(t,null,{},n,r)}interpolate(){return!1}};l(Dj,"ColorRampProperty");var Z5=Dj,kj=class{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(let t in e){let n=e[t];n.specification.overridable&&this.overridableProperties.push(t);let r=this.defaultPropertyValues[t]=new mA(n,void 0),a=this.defaultTransitionablePropertyValues[t]=new S3(n);this.defaultTransitioningPropertyValues[t]=a.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=r.possiblyEvaluate({})}}};l(kj,"Properties");var Yo=kj;Zt("DataDrivenProperty",Pi);Zt("DataConstantProperty",li);Zt("CrossFadedDataDrivenProperty",yA);Zt("CrossFadedProperty",X5);Zt("ColorRampProperty",Z5);var c_="-transition",Rj=class extends uo{constructor(e,t){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:l(()=>!0,"filter"),needGeometry:!1},e.type!=="custom"&&(e=e,this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),t.layout&&(this._unevaluatedLayout=new Gge(t.layout)),t.paint)){this._transitionablePaint=new wj(t.paint);for(let n in e.paint)this.setPaintProperty(n,e.paint[n],{validate:!1});for(let n in e.layout)this.setLayoutProperty(n,e.layout[n],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new gA(t.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,t,n={}){if(t!=null){let r="layers.".concat(this.id,".layout.").concat(e);if(this._validate(Vge,r,e,t,n))return}if(e==="visibility"){this.visibility=t;return}this._unevaluatedLayout.setValue(e,t)}getPaintProperty(e){return e.endsWith(c_)?this._transitionablePaint.getTransition(e.slice(0,-c_.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,t,n={}){if(t!=null){let r="layers.".concat(this.id,".paint.").concat(e);if(this._validate(Uge,r,e,t,n))return!1}if(e.endsWith(c_))return this._transitionablePaint.setTransition(e.slice(0,-c_.length),t||void 0),!1;{let r=this._transitionablePaint._values[e],a=r.property.specification["property-type"]==="cross-faded-data-driven",o=r.value.isDataDriven(),s=r.value;this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e);let u=this._transitionablePaint._values[e].value;return u.isDataDriven()||o||a||this._handleOverridablePaintPropertyUpdate(e,s,u)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,t,n){return!1}isHidden(e){return this.minzoom&&e<this.minzoom||this.maxzoom&&e>=this.maxzoom?!0:this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,t){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)}serialize(){let e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),i5(e,(t,n)=>t!==void 0&&!(n==="layout"&&!Object.keys(t).length)&&!(n==="paint"&&!Object.keys(t).length))}_validate(e,t,n,r,a={}){return a&&a.validate===!1?!1:fA(this,e.call(wa,{key:t,layerType:this.type,objectKey:n,value:r,styleSpec:ht,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let e in this.paint._values){let t=this.paint.get(e);if(!(!(t instanceof ml)||!gd(t.property.specification))&&(t.value.kind==="source"||t.value.kind==="composite")&&t.value.isStateDependent)return!0}return!1}};l(Rj,"StyleLayer");var mu=Rj;R();R();R();var $ge={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Oj=class{constructor(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}};l(Oj,"Struct");var s0=Oj,Hge=128,Wge=5,Nj=class{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){let t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(this.capacity*Wge),Hge),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}};l(Nj,"StructArray");var Br=Nj;function Ir(i,e=1){let t=0,n=0,r=i.map(o=>{let s=Fj(o.type),u=t=M3(t,Math.max(e,s)),h=o.components||1;return n=Math.max(n,s),t+=s*h,{name:o.name,type:o.type,components:h,offset:u}}),a=M3(t,Math.max(n,e));return{members:r,size:a,alignment:e}}l(Ir,"createLayout");function Fj(i){return $ge[i].BYTES_PER_ELEMENT}l(Fj,"sizeOf");function M3(i,e){return Math.ceil(i/e)*e}l(M3,"align");var qge=ii(Rn(),1),Bj=class extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t){let n=this.length;return this.resize(n+1),this.emplace(n,e,t)}emplace(e,t,n){let r=e*2;return this.int16[r+0]=t,this.int16[r+1]=n,e}};l(Bj,"StructArrayLayout2i4");var l0=Bj;l0.prototype.bytesPerElement=4;Zt("StructArrayLayout2i4",l0);var zj=class extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n){let r=this.length;return this.resize(r+1),this.emplace(r,e,t,n)}emplace(e,t,n,r){let a=e*3;return this.int16[a+0]=t,this.int16[a+1]=n,this.int16[a+2]=r,e}};l(zj,"StructArrayLayout3i6");var vA=zj;vA.prototype.bytesPerElement=6;Zt("StructArrayLayout3i6",vA);var Uj=class extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,r){let a=this.length;return this.resize(a+1),this.emplace(a,e,t,n,r)}emplace(e,t,n,r,a){let o=e*4;return this.int16[o+0]=t,this.int16[o+1]=n,this.int16[o+2]=r,this.int16[o+3]=a,e}};l(Uj,"StructArrayLayout4i8");var Y5=Uj;Y5.prototype.bytesPerElement=8;Zt("StructArrayLayout4i8",Y5);var Vj=class extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,r,a,o){let s=this.length;return this.resize(s+1),this.emplace(s,e,t,n,r,a,o)}emplace(e,t,n,r,a,o,s){let u=e*6;return this.int16[u+0]=t,this.int16[u+1]=n,this.int16[u+2]=r,this.int16[u+3]=a,this.int16[u+4]=o,this.int16[u+5]=s,e}};l(Vj,"StructArrayLayout2i4i12");var J5=Vj;J5.prototype.bytesPerElement=12;Zt("StructArrayLayout2i4i12",J5);var jj=class extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,r,a,o){let s=this.length;return this.resize(s+1),this.emplace(s,e,t,n,r,a,o)}emplace(e,t,n,r,a,o,s){let u=e*4,h=e*8;return this.int16[u+0]=t,this.int16[u+1]=n,this.uint8[h+4]=r,this.uint8[h+5]=a,this.uint8[h+6]=o,this.uint8[h+7]=s,e}};l(jj,"StructArrayLayout2i4ub8");var K5=jj;K5.prototype.bytesPerElement=8;Zt("StructArrayLayout2i4ub8",K5);var Gj=class extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t){let n=this.length;return this.resize(n+1),this.emplace(n,e,t)}emplace(e,t,n){let r=e*2;return this.float32[r+0]=t,this.float32[r+1]=n,e}};l(Gj,"StructArrayLayout2f8");var l1=Gj;l1.prototype.bytesPerElement=8;Zt("StructArrayLayout2f8",l1);var $j=class extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,n,r,a,o,s,u,h,d){let f=this.length;return this.resize(f+1),this.emplace(f,e,t,n,r,a,o,s,u,h,d)}emplace(e,t,n,r,a,o,s,u,h,d,f){let m=e*10;return this.uint16[m+0]=t,this.uint16[m+1]=n,this.uint16[m+2]=r,this.uint16[m+3]=a,this.uint16[m+4]=o,this.uint16[m+5]=s,this.uint16[m+6]=u,this.uint16[m+7]=h,this.uint16[m+8]=d,this.uint16[m+9]=f,e}};l($j,"StructArrayLayout10ui20");var Q5=$j;Q5.prototype.bytesPerElement=20;Zt("StructArrayLayout10ui20",Q5);var Hj=class extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,n,r,a,o,s,u,h,d,f,m){let v=this.length;return this.resize(v+1),this.emplace(v,e,t,n,r,a,o,s,u,h,d,f,m)}emplace(e,t,n,r,a,o,s,u,h,d,f,m,v){let b=e*12;return this.int16[b+0]=t,this.int16[b+1]=n,this.int16[b+2]=r,this.int16[b+3]=a,this.uint16[b+4]=o,this.uint16[b+5]=s,this.uint16[b+6]=u,this.uint16[b+7]=h,this.int16[b+8]=d,this.int16[b+9]=f,this.int16[b+10]=m,this.int16[b+11]=v,e}};l(Hj,"StructArrayLayout4i4ui4i24");var e4=Hj;e4.prototype.bytesPerElement=24;Zt("StructArrayLayout4i4ui4i24",e4);var Wj=class extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n){let r=this.length;return this.resize(r+1),this.emplace(r,e,t,n)}emplace(e,t,n,r){let a=e*3;return this.float32[a+0]=t,this.float32[a+1]=n,this.float32[a+2]=r,e}};l(Wj,"StructArrayLayout3f12");var t4=Wj;t4.prototype.bytesPerElement=12;Zt("StructArrayLayout3f12",t4);var qj=class extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){let t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){let n=e*1;return this.uint32[n+0]=t,e}};l(qj,"StructArrayLayout1ul4");var i4=qj;i4.prototype.bytesPerElement=4;Zt("StructArrayLayout1ul4",i4);var Xj=class extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,n,r,a,o,s,u,h){let d=this.length;return this.resize(d+1),this.emplace(d,e,t,n,r,a,o,s,u,h)}emplace(e,t,n,r,a,o,s,u,h,d){let f=e*10,m=e*5;return this.int16[f+0]=t,this.int16[f+1]=n,this.int16[f+2]=r,this.int16[f+3]=a,this.int16[f+4]=o,this.int16[f+5]=s,this.uint32[m+3]=u,this.uint16[f+8]=h,this.uint16[f+9]=d,e}};l(Xj,"StructArrayLayout6i1ul2ui20");var n4=Xj;n4.prototype.bytesPerElement=20;Zt("StructArrayLayout6i1ul2ui20",n4);var Zj=class extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,r,a,o){let s=this.length;return this.resize(s+1),this.emplace(s,e,t,n,r,a,o)}emplace(e,t,n,r,a,o,s){let u=e*6;return this.int16[u+0]=t,this.int16[u+1]=n,this.int16[u+2]=r,this.int16[u+3]=a,this.int16[u+4]=o,this.int16[u+5]=s,e}};l(Zj,"StructArrayLayout2i2i2i12");var r4=Zj;r4.prototype.bytesPerElement=12;Zt("StructArrayLayout2i2i2i12",r4);var Yj=class extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,r,a){let o=this.length;return this.resize(o+1),this.emplace(o,e,t,n,r,a)}emplace(e,t,n,r,a,o){let s=e*4,u=e*8;return this.float32[s+0]=t,this.float32[s+1]=n,this.float32[s+2]=r,this.int16[u+6]=a,this.int16[u+7]=o,e}};l(Yj,"StructArrayLayout2f1f2i16");var a4=Yj;a4.prototype.bytesPerElement=16;Zt("StructArrayLayout2f1f2i16",a4);var Jj=class extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,r){let a=this.length;return this.resize(a+1),this.emplace(a,e,t,n,r)}emplace(e,t,n,r,a){let o=e*12,s=e*3;return this.uint8[o+0]=t,this.uint8[o+1]=n,this.float32[s+1]=r,this.float32[s+2]=a,e}};l(Jj,"StructArrayLayout2ub2f12");var o4=Jj;o4.prototype.bytesPerElement=12;Zt("StructArrayLayout2ub2f12",o4);var Kj=class extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,n){let r=this.length;return this.resize(r+1),this.emplace(r,e,t,n)}emplace(e,t,n,r){let a=e*3;return this.uint16[a+0]=t,this.uint16[a+1]=n,this.uint16[a+2]=r,e}};l(Kj,"StructArrayLayout3ui6");var _A=Kj;_A.prototype.bytesPerElement=6;Zt("StructArrayLayout3ui6",_A);var Qj=class extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,r,a,o,s,u,h,d,f,m,v,b,w,A,E){let I=this.length;return this.resize(I+1),this.emplace(I,e,t,n,r,a,o,s,u,h,d,f,m,v,b,w,A,E)}emplace(e,t,n,r,a,o,s,u,h,d,f,m,v,b,w,A,E,I){let C=e*24,T=e*12,k=e*48;return this.int16[C+0]=t,this.int16[C+1]=n,this.uint16[C+2]=r,this.uint16[C+3]=a,this.uint32[T+2]=o,this.uint32[T+3]=s,this.uint32[T+4]=u,this.uint16[C+10]=h,this.uint16[C+11]=d,this.uint16[C+12]=f,this.float32[T+7]=m,this.float32[T+8]=v,this.uint8[k+36]=b,this.uint8[k+37]=w,this.uint8[k+38]=A,this.uint32[T+10]=E,this.int16[C+22]=I,e}};l(Qj,"StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48");var s4=Qj;s4.prototype.bytesPerElement=48;Zt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",s4);var eG=class extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,r,a,o,s,u,h,d,f,m,v,b,w,A,E,I,C,T,k,F,B,N,z,L,j,q){let Z=this.length;return this.resize(Z+1),this.emplace(Z,e,t,n,r,a,o,s,u,h,d,f,m,v,b,w,A,E,I,C,T,k,F,B,N,z,L,j,q)}emplace(e,t,n,r,a,o,s,u,h,d,f,m,v,b,w,A,E,I,C,T,k,F,B,N,z,L,j,q,Z){let O=e*32,Y=e*16;return this.int16[O+0]=t,this.int16[O+1]=n,this.int16[O+2]=r,this.int16[O+3]=a,this.int16[O+4]=o,this.int16[O+5]=s,this.int16[O+6]=u,this.int16[O+7]=h,this.uint16[O+8]=d,this.uint16[O+9]=f,this.uint16[O+10]=m,this.uint16[O+11]=v,this.uint16[O+12]=b,this.uint16[O+13]=w,this.uint16[O+14]=A,this.uint16[O+15]=E,this.uint16[O+16]=I,this.uint16[O+17]=C,this.uint16[O+18]=T,this.uint16[O+19]=k,this.uint16[O+20]=F,this.uint16[O+21]=B,this.uint16[O+22]=N,this.uint32[Y+12]=z,this.float32[Y+13]=L,this.float32[Y+14]=j,this.uint16[O+30]=q,this.uint16[O+31]=Z,e}};l(eG,"StructArrayLayout8i15ui1ul2f2ui64");var l4=eG;l4.prototype.bytesPerElement=64;Zt("StructArrayLayout8i15ui1ul2f2ui64",l4);var tG=class extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){let t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){let n=e*1;return this.float32[n+0]=t,e}};l(tG,"StructArrayLayout1f4");var xA=tG;xA.prototype.bytesPerElement=4;Zt("StructArrayLayout1f4",xA);var iG=class extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n){let r=this.length;return this.resize(r+1),this.emplace(r,e,t,n)}emplace(e,t,n,r){let a=e*6,o=e*3;return this.uint16[a+0]=t,this.float32[o+1]=n,this.float32[o+2]=r,e}};l(iG,"StructArrayLayout1ui2f12");var u4=iG;u4.prototype.bytesPerElement=12;Zt("StructArrayLayout1ui2f12",u4);var nG=class extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,n){let r=this.length;return this.resize(r+1),this.emplace(r,e,t,n)}emplace(e,t,n,r){let a=e*2,o=e*4;return this.uint32[a+0]=t,this.uint16[o+2]=n,this.uint16[o+3]=r,e}};l(nG,"StructArrayLayout1ul2ui8");var h4=nG;h4.prototype.bytesPerElement=8;Zt("StructArrayLayout1ul2ui8",h4);var rG=class extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t){let n=this.length;return this.resize(n+1),this.emplace(n,e,t)}emplace(e,t,n){let r=e*2;return this.uint16[r+0]=t,this.uint16[r+1]=n,e}};l(rG,"StructArrayLayout2ui4");var c4=rG;c4.prototype.bytesPerElement=4;Zt("StructArrayLayout2ui4",c4);var aG=class extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){let t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){let n=e*1;return this.uint16[n+0]=t,e}};l(aG,"StructArrayLayout1ui2");var p4=aG;p4.prototype.bytesPerElement=2;Zt("StructArrayLayout1ui2",p4);var oG=class extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,r){let a=this.length;return this.resize(a+1),this.emplace(a,e,t,n,r)}emplace(e,t,n,r,a){let o=e*4;return this.float32[o+0]=t,this.float32[o+1]=n,this.float32[o+2]=r,this.float32[o+3]=a,e}};l(oG,"StructArrayLayout4f16");var d4=oG;d4.prototype.bytesPerElement=16;Zt("StructArrayLayout4f16",d4);var sG=class extends s0{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new qge.default(this.anchorPointX,this.anchorPointY)}};l(sG,"CollisionBoxStruct");var lG=sG;lG.prototype.size=20;var uG=class extends n4{get(e){return new lG(this,e)}};l(uG,"CollisionBoxArray");var hG=uG;Zt("CollisionBoxArray",hG);var cG=class extends s0{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}};l(cG,"PlacedSymbolStruct");var pG=cG;pG.prototype.size=48;var dG=class extends s4{get(e){return new pG(this,e)}};l(dG,"PlacedSymbolArray");var fG=dG;Zt("PlacedSymbolArray",fG);var mG=class extends s0{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}};l(mG,"SymbolInstanceStruct");var gG=mG;gG.prototype.size=64;var yG=class extends l4{get(e){return new gG(this,e)}};l(yG,"SymbolInstanceArray");var vG=yG;Zt("SymbolInstanceArray",vG);var _G=class extends xA{getoffsetX(e){return this.float32[e*1+0]}};l(_G,"GlyphOffsetArray");var xG=_G;Zt("GlyphOffsetArray",xG);var bG=class extends vA{getx(e){return this.int16[e*3+0]}gety(e){return this.int16[e*3+1]}gettileUnitDistanceFromAnchor(e){return this.int16[e*3+2]}};l(bG,"SymbolLineVertexArray");var wG=bG;Zt("SymbolLineVertexArray",wG);var AG=class extends s0{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}};l(AG,"TextAnchorOffsetStruct");var SG=AG;SG.prototype.size=12;var MG=class extends u4{get(e){return new SG(this,e)}};l(MG,"TextAnchorOffsetArray");var CG=MG;Zt("TextAnchorOffsetArray",CG);var EG=class extends s0{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}};l(EG,"FeatureIndexStruct");var IG=EG;IG.prototype.size=8;var TG=class extends h4{get(e){return new IG(this,e)}};l(TG,"FeatureIndexArray");var PG=TG;Zt("FeatureIndexArray",PG);var LG=class extends l0{};l(LG,"PosArray");var hx=LG,DG=class extends vA{};l(DG,"Pos3dArray");var Xge=DG,kG=class extends Y5{};l(kG,"RasterBoundsArray");var RG=kG,OG=class extends l0{};l(OG,"CircleLayoutArray");var Zge=OG,NG=class extends l0{};l(NG,"FillLayoutArray");var Yge=NG,FG=class extends J5{};l(FG,"FillExtrusionLayoutArray");var Jge=FG,BG=class extends K5{};l(BG,"LineLayoutArray");var Kge=BG,zG=class extends l1{};l(zG,"LineExtLayoutArray");var Qge=zG,UG=class extends Q5{};l(UG,"PatternLayoutArray");var of=UG,VG=class extends e4{};l(VG,"SymbolLayoutArray");var eye=VG,jG=class extends t4{};l(jG,"SymbolDynamicLayoutArray");var tye=jG,GG=class extends i4{};l(GG,"SymbolOpacityArray");var iye=GG,$G=class extends r4{};l($G,"CollisionBoxLayoutArray");var jk=$G,HG=class extends a4{};l(HG,"CollisionCircleLayoutArray");var nye=HG,WG=class extends o4{};l(WG,"CollisionVertexArray");var rye=WG,qG=class extends _A{};l(qG,"QuadTriangleArray");var aye=qG,XG=class extends _A{};l(XG,"TriangleIndexArray");var kd=XG,ZG=class extends c4{};l(ZG,"LineIndexArray");var C3=ZG,YG=class extends p4{};l(YG,"LineStripIndexArray");var oye=YG;R();var sye=Ir([{name:"a_pos",components:2,type:"Int16"}],4),{members:lye,size:mLe,alignment:gLe}=sye;R();var JG=class zy{constructor(e=[]){this.segments=e}prepareSegment(e,t,n,r){let a=this.segments[this.segments.length-1];return e>zy.MAX_VERTEX_ARRAY_LENGTH&&lo("Max vertices per segment is ".concat(zy.MAX_VERTEX_ARRAY_LENGTH,": bucket requested ").concat(e)),(!a||a.vertexLength+e>zy.MAX_VERTEX_ARRAY_LENGTH||a.sortKey!==r)&&(a={vertexOffset:t.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},r!==void 0&&(a.sortKey=r),this.segments.push(a)),a}get(){return this.segments}destroy(){for(let e of this.segments)for(let t in e.vaos)e.vaos[t].destroy()}static simpleSegment(e,t,n,r){return new zy([{vertexOffset:e,primitiveOffset:t,vertexLength:n,primitiveLength:r,vaos:{},sortKey:0}])}};l(JG,"SegmentVector");var $r=JG;$r.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1;Zt("SegmentVector",$r);R();R();function E3(i,e){return i=da(Math.floor(i),0,255),e=da(Math.floor(e),0,255),256*i+e}l(E3,"packUint8ToFloat");R();var nw=Ir([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);R();var uye=ii($B(),1),KG=class QG{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,t,n,r){this.ids.push(I3(e)),this.positions.push(t,n,r)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");let t=I3(e),n=0,r=this.ids.length-1;for(;n<r;){let o=n+r>>1;this.ids[o]>=t?r=o:n=o+1}let a=[];for(;this.ids[n]===t;){let o=this.positions[3*n],s=this.positions[3*n+1],u=this.positions[3*n+2];a.push({index:o,start:s,end:u}),n++}return a}static serialize(e,t){let n=new Float64Array(e.ids),r=new Uint32Array(e.positions);return rw(n,r,0,n.length-1),t&&t.push(n.buffer,r.buffer),{ids:n,positions:r}}static deserialize(e){let t=new QG;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t}};l(KG,"FeaturePositionMap");var e$=KG;function I3(i){let e=+i;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:(0,uye.default)(String(i))}l(I3,"getNumericId");function rw(i,e,t,n){for(;t<n;){let r=i[t+n>>1],a=t-1,o=n+1;for(;;){do a++;while(i[a]<r);do o--;while(i[o]>r);if(a>=o)break;Uy(i,a,o),Uy(e,3*a,3*o),Uy(e,3*a+1,3*o+1),Uy(e,3*a+2,3*o+2)}o-t<n-o?(rw(i,e,t,o),t=o+1):(rw(i,e,o+1,n),n=o)}}l(rw,"sort");function Uy(i,e,t){let n=i[e];i[e]=i[t],i[t]=n}l(Uy,"swap");Zt("FeaturePositionMap",e$);R();var t$=class{constructor(e,t){this.gl=e.gl,this.location=t}};l(t$,"Uniform");var Rd=t$,i$=class extends Rd{constructor(e,t){super(e,t),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1i(this.location,e))}};l(i$,"Uniform1i");var rn=i$,n$=class extends Rd{constructor(e,t){super(e,t),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}};l(n$,"Uniform1f");var Ht=n$,r$=class extends Rd{constructor(e,t){super(e,t),this.current=[0,0]}set(e){(e[0]!==this.current[0]||e[1]!==this.current[1])&&(this.current=e,this.gl.uniform2f(this.location,e[0],e[1]))}};l(r$,"Uniform2f");var mn=r$,a$=class extends Rd{constructor(e,t){super(e,t),this.current=[0,0,0]}set(e){(e[0]!==this.current[0]||e[1]!==this.current[1]||e[2]!==this.current[2])&&(this.current=e,this.gl.uniform3f(this.location,e[0],e[1],e[2]))}};l(a$,"Uniform3f");var ch=a$,o$=class extends Rd{constructor(e,t){super(e,t),this.current=[0,0,0,0]}set(e){(e[0]!==this.current[0]||e[1]!==this.current[1]||e[2]!==this.current[2]||e[3]!==this.current[3])&&(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}};l(o$,"Uniform4f");var f4=o$,s$=class extends Rd{constructor(e,t){super(e,t),this.current=Wi.transparent}set(e){(e.r!==this.current.r||e.g!==this.current.g||e.b!==this.current.b||e.a!==this.current.a)&&(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}};l(s$,"UniformColor");var Hm=s$,hye=new Float32Array(16),l$=class extends Rd{constructor(e,t){super(e,t),this.current=hye}set(e){if(e[12]!==this.current[12]||e[0]!==this.current[0]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);return}for(let t=1;t<16;t++)if(e[t]!==this.current[t]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);break}}};l(l$,"UniformMatrix4f");var Cn=l$;function aw(i){return[E3(255*i.r,255*i.g),E3(255*i.b,255*i.a)]}l(aw,"packColor");var u$=class{constructor(e,t,n){this.value=e,this.uniformNames=t.map(r=>"u_".concat(r)),this.type=n}setUniform(e,t,n){e.set(n.constantOr(this.value))}getBinding(e,t,n){return this.type==="color"?new Hm(e,t):new Ht(e,t)}};l(u$,"ConstantBinder");var Vy=u$,h$=class{constructor(e,t){this.uniformNames=t.map(n=>"u_".concat(n)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr}setUniform(e,t,n,r){let a=r==="u_pattern_to"?this.patternTo:r==="u_pattern_from"?this.patternFrom:r==="u_pixel_ratio_to"?this.pixelRatioTo:r==="u_pixel_ratio_from"?this.pixelRatioFrom:null;a&&e.set(a)}getBinding(e,t,n){return n.substr(0,9)==="u_pattern"?new f4(e,t):new Ht(e,t)}};l(h$,"CrossFadedConstantBinder");var yf=h$,c$=class{constructor(e,t,n,r){this.expression=e,this.type=n,this.maxValue=0,this.paintVertexAttributes=t.map(a=>({name:"a_".concat(a),type:"Float32",components:n==="color"?2:1,offset:0})),this.paintVertexArray=new r}populatePaintArray(e,t,n,r,a){let o=this.paintVertexArray.length,s=this.expression.evaluate(new fa(0),t,{},r,[],a);this.paintVertexArray.resize(e),this._setPaintValue(o,e,s)}updatePaintArray(e,t,n,r){let a=this.expression.evaluate({zoom:0},n,r);this._setPaintValue(e,t,a)}_setPaintValue(e,t,n){if(this.type==="color"){let r=aw(n);for(let a=e;a<t;a++)this.paintVertexArray.emplace(a,r[0],r[1])}else{for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}};l(c$,"SourceExpressionBinder");var Bu=c$,p$=class{constructor(e,t,n,r,a,o){this.expression=e,this.uniformNames=t.map(s=>"u_".concat(s,"_t")),this.type=n,this.useIntegerZoom=r,this.zoom=a,this.maxValue=0,this.paintVertexAttributes=t.map(s=>({name:"a_".concat(s),type:"Float32",components:n==="color"?4:2,offset:0})),this.paintVertexArray=new o}populatePaintArray(e,t,n,r,a){let o=this.expression.evaluate(new fa(this.zoom),t,{},r,[],a),s=this.expression.evaluate(new fa(this.zoom+1),t,{},r,[],a),u=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(u,e,o,s)}updatePaintArray(e,t,n,r){let a=this.expression.evaluate({zoom:this.zoom},n,r),o=this.expression.evaluate({zoom:this.zoom+1},n,r);this._setPaintValue(e,t,a,o)}_setPaintValue(e,t,n,r){if(this.type==="color"){let a=aw(n),o=aw(r);for(let s=e;s<t;s++)this.paintVertexArray.emplace(s,a[0],a[1],o[0],o[1])}else{for(let a=e;a<t;a++)this.paintVertexArray.emplace(a,n,r);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(r))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,t){let n=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,r=da(this.expression.interpolationFactor(n,this.zoom,this.zoom+1),0,1);e.set(r)}getBinding(e,t,n){return new Ht(e,t)}};l(p$,"CompositeExpressionBinder");var Ks=p$,d$=class{constructor(e,t,n,r,a,o){this.expression=e,this.type=t,this.useIntegerZoom=n,this.zoom=r,this.layerId=o,this.zoomInPaintVertexArray=new a,this.zoomOutPaintVertexArray=new a}populatePaintArray(e,t,n){let r=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(r,e,t.patterns&&t.patterns[this.layerId],n)}updatePaintArray(e,t,n,r,a){this._setPaintValues(e,t,n.patterns&&n.patterns[this.layerId],a)}_setPaintValues(e,t,n,r){if(!r||!n)return;let{min:a,mid:o,max:s}=n,u=r[a],h=r[o],d=r[s];if(!(!u||!h||!d))for(let f=e;f<t;f++)this.zoomInPaintVertexArray.emplace(f,h.tl[0],h.tl[1],h.br[0],h.br[1],u.tl[0],u.tl[1],u.br[0],u.br[1],h.pixelRatio,u.pixelRatio),this.zoomOutPaintVertexArray.emplace(f,h.tl[0],h.tl[1],h.br[0],h.br[1],d.tl[0],d.tl[1],d.br[0],d.br[1],h.pixelRatio,d.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,nw.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,nw.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}};l(d$,"CrossFadedCompositeBinder");var qh=d$,f$=class{constructor(e,t,n){this.binders={},this._buffers=[];let r=[];for(let a in e.paint._values){if(!n(a))continue;let o=e.paint.get(a);if(!(o instanceof ml)||!gd(o.property.specification))continue;let s=y$(a,e.type),u=o.value,h=o.property.specification.type,d=o.property.useIntegerZoom,f=o.property.specification["property-type"],m=f==="cross-faded"||f==="cross-faded-data-driven";if(u.kind==="constant")this.binders[a]=m?new yf(u.value,s):new Vy(u.value,s,h),r.push("/u_".concat(a));else if(u.kind==="source"||m){let v=T3(a,h,"source");this.binders[a]=m?new qh(u,h,d,t,v,e.id):new Bu(u,s,h,v),r.push("/a_".concat(a))}else{let v=T3(a,h,"composite");this.binders[a]=new Ks(u,s,h,d,t,v),r.push("/z_".concat(a))}}this.cacheKey=r.sort().join("")}getMaxValue(e){let t=this.binders[e];return t instanceof Bu||t instanceof Ks?t.maxValue:0}populatePaintArrays(e,t,n,r,a){for(let o in this.binders){let s=this.binders[o];(s instanceof Bu||s instanceof Ks||s instanceof qh)&&s.populatePaintArray(e,t,n,r,a)}}setConstantPatternPositions(e,t){for(let n in this.binders){let r=this.binders[n];r instanceof yf&&r.setConstantPatternPositions(e,t)}}updatePaintArrays(e,t,n,r,a){let o=!1;for(let s in e){let u=t.getPositions(s);for(let h of u){let d=n.feature(h.index);for(let f in this.binders){let m=this.binders[f];if((m instanceof Bu||m instanceof Ks||m instanceof qh)&&m.expression.isStateDependent===!0){let v=r.paint.get(f);m.expression=v.value,m.updatePaintArray(h.start,h.end,d,e[s],a),o=!0}}}}return o}defines(){let e=[];for(let t in this.binders){let n=this.binders[t];(n instanceof Vy||n instanceof yf)&&e.push(...n.uniformNames.map(r=>"#define HAS_UNIFORM_".concat(r)))}return e}getBinderAttributes(){let e=[];for(let t in this.binders){let n=this.binders[t];if(n instanceof Bu||n instanceof Ks)for(let r=0;r<n.paintVertexAttributes.length;r++)e.push(n.paintVertexAttributes[r].name);else if(n instanceof qh)for(let r=0;r<nw.members.length;r++)e.push(nw.members[r].name)}return e}getBinderUniforms(){let e=[];for(let t in this.binders){let n=this.binders[t];if(n instanceof Vy||n instanceof yf||n instanceof Ks)for(let r of n.uniformNames)e.push(r)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,t){let n=[];for(let r in this.binders){let a=this.binders[r];if(a instanceof Vy||a instanceof yf||a instanceof Ks){for(let o of a.uniformNames)if(t[o]){let s=a.getBinding(e,t[o],o);n.push({name:o,property:r,binding:s})}}}return n}setUniforms(e,t,n,r){for(let{name:a,property:o,binding:s}of t)this.binders[o].setUniform(s,r,n.get(o),a)}updatePaintBuffers(e){this._buffers=[];for(let t in this.binders){let n=this.binders[t];if(e&&n instanceof qh){let r=e.fromScale===2?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;r&&this._buffers.push(r)}else(n instanceof Bu||n instanceof Ks)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(e){for(let t in this.binders){let n=this.binders[t];(n instanceof Bu||n instanceof Ks||n instanceof qh)&&n.upload(e)}this.updatePaintBuffers()}destroy(){for(let e in this.binders){let t=this.binders[e];(t instanceof Bu||t instanceof Ks||t instanceof qh)&&t.destroy()}}};l(f$,"ProgramConfiguration");var m$=f$,g$=class{constructor(e,t,n=()=>!0){this.programConfigurations={};for(let r of e)this.programConfigurations[r.id]=new m$(r,t,n);this.needsUpload=!1,this._featureMap=new e$,this._bufferOffset=0}populatePaintArrays(e,t,n,r,a,o){for(let s in this.programConfigurations)this.programConfigurations[s].populatePaintArrays(e,t,r,a,o);t.id!==void 0&&this._featureMap.add(t.id,n,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,t,n,r){for(let a of n)this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(e,this._featureMap,t,a,r)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(let t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}}destroy(){for(let e in this.programConfigurations)this.programConfigurations[e].destroy()}};l(g$,"ProgramConfigurationSet");var vd=g$;function y$(i,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace("".concat(e,"-"),"").replace(/-/g,"_")]}l(y$,"paintAttributeNames");function v$(i){return{"line-pattern":{source:of,composite:of},"fill-pattern":{source:of,composite:of},"fill-extrusion-pattern":{source:of,composite:of}}[i]}l(v$,"getLayoutException");function T3(i,e,t){let n={color:{source:l1,composite:d4},number:{source:xA,composite:l1}},r=v$(i);return r&&r[t]||n[e][t]}l(T3,"layoutType");Zt("ConstantBinder",Vy);Zt("CrossFadedConstantBinder",yf);Zt("SourceExpressionBinder",Bu);Zt("CrossFadedCompositeBinder",qh);Zt("CompositeExpressionBinder",Ks);Zt("ProgramConfiguration",m$,{omit:["_buffers"]});Zt("ProgramConfigurationSet",vd);R();R();R();var cye=15,P3=Math.pow(2,cye-1)-1,Gk=-P3-1;function Wc(i){let e=8192/i.extent,t=i.loadGeometry();for(let n=0;n<t.length;n++){let r=t[n];for(let a=0;a<r.length;a++){let o=r[a],s=Math.round(o.x*e),u=Math.round(o.y*e);o.x=da(s,Gk,P3),o.y=da(u,Gk,P3),(s<o.x||s>o.x+1||u<o.y||u>o.y+1)&&lo("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return t}l(Wc,"loadGeometry");R();function qc(i,e){return{type:i.type,id:i.id,properties:i.properties,geometry:e?Wc(i):[]}}l(qc,"toEvaluationFeature");function jy(i,e,t,n,r){i.emplaceBack(e*2+(n+1)/2,t*2+(r+1)/2)}l(jy,"addCircleVertex");var _$=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(t=>t.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Zge,this.indexArray=new kd,this.segments=new $r,this.programConfigurations=new vd(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(e,t,n){let r=this.layers[0],a=[],o=null,s=!1;r.type==="circle"&&(o=r.layout.get("circle-sort-key"),s=!o.isConstant());for(let{feature:u,id:h,index:d,sourceLayerIndex:f}of e){let m=this.layers[0]._featureFilter.needGeometry,v=qc(u,m);if(!this.layers[0]._featureFilter.filter(new fa(this.zoom),v,n))continue;let b=s?o.evaluate(v,{},n):void 0,w={id:h,properties:u.properties,type:u.type,sourceLayerIndex:f,index:d,geometry:m?v.geometry:Wc(u),patterns:{},sortKey:b};a.push(w)}s&&a.sort((u,h)=>u.sortKey-h.sortKey);for(let u of a){let{geometry:h,index:d,sourceLayerIndex:f}=u,m=e[d].feature;this.addFeature(u,h,d,n),t.featureIndex.insert(m,h,d,f,this.index)}}update(e,t,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,n)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,lye),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,t,n,r){for(let a of t)for(let o of a){let s=o.x,u=o.y;if(s<0||s>=8192||u<0||u>=8192)continue;let h=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),d=h.vertexLength;jy(this.layoutVertexArray,s,u,-1,-1),jy(this.layoutVertexArray,s,u,1,-1),jy(this.layoutVertexArray,s,u,1,1),jy(this.layoutVertexArray,s,u,-1,1),this.indexArray.emplaceBack(d,d+1,d+2),this.indexArray.emplaceBack(d,d+3,d+2),h.vertexLength+=4,h.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,{},r)}};l(_$,"CircleBucket");var m4=_$;Zt("CircleBucket",m4,{omit:["layers"]});R();var p_=ii(Rn(),1);function g4(i,e){for(let t=0;t<i.length;t++)if(_d(e,i[t]))return!0;for(let t=0;t<e.length;t++)if(_d(i,e[t]))return!0;return!!bA(i,e)}l(g4,"polygonIntersectsPolygon");function x$(i,e,t){return!!(_d(i,e)||ow(e,i,t))}l(x$,"polygonIntersectsBufferedPoint");function y4(i,e){if(i.length===1)return L3(e,i[0]);for(let t=0;t<e.length;t++){let n=e[t];for(let r=0;r<n.length;r++)if(_d(i,n[r]))return!0}for(let t=0;t<i.length;t++)if(L3(e,i[t]))return!0;for(let t=0;t<e.length;t++)if(bA(i,e[t]))return!0;return!1}l(y4,"polygonIntersectsMultiPolygon");function b$(i,e,t){for(let n=0;n<e.length;n++){let r=e[n];if(i.length>=3){for(let a=0;a<r.length;a++)if(_d(i,r[a]))return!0}if(w$(i,r,t))return!0}return!1}l(b$,"polygonIntersectsBufferedMultiLine");function w$(i,e,t){if(i.length>1){if(bA(i,e))return!0;for(let n=0;n<e.length;n++)if(ow(e[n],i,t))return!0}for(let n=0;n<i.length;n++)if(ow(i[n],e,t))return!0;return!1}l(w$,"lineIntersectsBufferedLine");function bA(i,e){if(i.length===0||e.length===0)return!1;for(let t=0;t<i.length-1;t++){let n=i[t],r=i[t+1];for(let a=0;a<e.length-1;a++){let o=e[a],s=e[a+1];if(A$(n,r,o,s))return!0}}return!1}l(bA,"lineIntersectsLine");function A$(i,e,t,n){return uh(i,t,n)!==uh(e,t,n)&&uh(i,e,t)!==uh(i,e,n)}l(A$,"lineSegmentIntersectsLineSegment");function ow(i,e,t){let n=t*t;if(e.length===1)return i.distSqr(e[0])<n;for(let r=1;r<e.length;r++){let a=e[r-1],o=e[r];if(S$(i,a,o)<n)return!0}return!1}l(ow,"pointIntersectsBufferedLine");function S$(i,e,t){let n=e.distSqr(t);if(n===0)return i.distSqr(e);let r=((i.x-e.x)*(t.x-e.x)+(i.y-e.y)*(t.y-e.y))/n;return r<0?i.distSqr(e):r>1?i.distSqr(t):i.distSqr(t.sub(e)._mult(r)._add(e))}l(S$,"distToSegmentSquared");function L3(i,e){let t=!1,n,r,a;for(let o=0;o<i.length;o++){n=i[o];for(let s=0,u=n.length-1;s<n.length;u=s++)r=n[s],a=n[u],r.y>e.y!=a.y>e.y&&e.x<(a.x-r.x)*(e.y-r.y)/(a.y-r.y)+r.x&&(t=!t)}return t}l(L3,"multiPolygonContainsPoint");function _d(i,e){let t=!1;for(let n=0,r=i.length-1;n<i.length;r=n++){let a=i[n],o=i[r];a.y>e.y!=o.y>e.y&&e.x<(o.x-a.x)*(e.y-a.y)/(o.y-a.y)+a.x&&(t=!t)}return t}l(_d,"polygonContainsPoint");function M$(i,e,t,n,r){for(let o of i)if(e<=o.x&&t<=o.y&&n>=o.x&&r>=o.y)return!0;let a=[new p_.default(e,t),new p_.default(e,r),new p_.default(n,r),new p_.default(n,t)];if(i.length>2){for(let o of a)if(_d(i,o))return!0}for(let o=0;o<i.length-1;o++){let s=i[o],u=i[o+1];if(C$(s,u,a))return!0}return!1}l(M$,"polygonIntersectsBox");function C$(i,e,t){let n=t[0],r=t[2];if(i.x<n.x&&e.x<n.x||i.x>r.x&&e.x>r.x||i.y<n.y&&e.y<n.y||i.y>r.y&&e.y>r.y)return!1;let a=uh(i,e,t[0]);return a!==uh(i,e,t[1])||a!==uh(i,e,t[2])||a!==uh(i,e,t[3])}l(C$,"edgeIntersectsBox");R();var D3=ii(Rn(),1);function Wm(i,e,t){let n=e.paint.get(i).value;return n.kind==="constant"?n.value:t.programConfigurations.get(e.id).getMaxValue(i)}l(Wm,"getMaximumPaintValue");function u0(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}l(u0,"translateDistance");function h0(i,e,t,n,r){if(!e[0]&&!e[1])return i;let a=D3.default.convert(e)._mult(r);t==="viewport"&&a._rotate(-n);let o=[];for(let s=0;s<i.length;s++){let u=i[s];o.push(u.sub(a))}return o}l(h0,"translate");function E$(i,e){let t=[];for(let n=0;n<i.length;n++){let r=i[n],a=[];for(let o=0;o<r.length;o++){let s=r[o-1],u=r[o],h=r[o+1],d=o===0?new D3.default(0,0):u.sub(s)._unit()._perp(),f=o===r.length-1?new D3.default(0,0):h.sub(u)._unit()._perp(),m=d._add(f)._unit(),v=m.x*f.x+m.y*f.y;v!==0&&m._mult(1/v),a.push(m._mult(e)._add(u))}t.push(a)}return t}l(E$,"offsetLine");R();var $k,pye=l(()=>$k=$k||new Yo({"circle-sort-key":new Pi(ht.layout_circle["circle-sort-key"])}),"getLayout"),Hk,dye=l(()=>Hk=Hk||new Yo({"circle-radius":new Pi(ht.paint_circle["circle-radius"]),"circle-color":new Pi(ht.paint_circle["circle-color"]),"circle-blur":new Pi(ht.paint_circle["circle-blur"]),"circle-opacity":new Pi(ht.paint_circle["circle-opacity"]),"circle-translate":new li(ht.paint_circle["circle-translate"]),"circle-translate-anchor":new li(ht.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new li(ht.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new li(ht.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Pi(ht.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Pi(ht.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Pi(ht.paint_circle["circle-stroke-opacity"])}),"getPaint"),fye={get paint(){return dye()},get layout(){return pye()}};R();R();var Yi=1e-6,hr=typeof Float32Array<"u"?Float32Array:Array,Qp=Math.random;Math.hypot||(Math.hypot=function(){for(var i=0,e=arguments.length;e--;)i+=arguments[e]*arguments[e];return Math.sqrt(i)});var k3={};xh(k3,{LDU:()=>$$,add:()=>H$,adjoint:()=>N$,clone:()=>T$,copy:()=>P$,create:()=>I$,determinant:()=>F$,equals:()=>q$,exactEquals:()=>W$,frob:()=>G$,fromRotation:()=>U$,fromScaling:()=>V$,fromValues:()=>D$,identity:()=>L$,invert:()=>O$,mul:()=>mye,multiply:()=>v4,multiplyScalar:()=>X$,multiplyScalarAndAdd:()=>Z$,rotate:()=>B$,scale:()=>z$,set:()=>k$,str:()=>j$,sub:()=>gye,subtract:()=>_4,transpose:()=>R$});R();function I$(){var i=new hr(4);return hr!=Float32Array&&(i[1]=0,i[2]=0),i[0]=1,i[3]=1,i}l(I$,"create");function T$(i){var e=new hr(4);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e}l(T$,"clone");function P$(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i}l(P$,"copy");function L$(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=1,i}l(L$,"identity");function D$(i,e,t,n){var r=new hr(4);return r[0]=i,r[1]=e,r[2]=t,r[3]=n,r}l(D$,"fromValues");function k$(i,e,t,n,r){return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i}l(k$,"set");function R$(i,e){if(i===e){var t=e[1];i[1]=e[2],i[2]=t}else i[0]=e[0],i[1]=e[2],i[2]=e[1],i[3]=e[3];return i}l(R$,"transpose");function O$(i,e){var t=e[0],n=e[1],r=e[2],a=e[3],o=t*a-r*n;return o?(o=1/o,i[0]=a*o,i[1]=-n*o,i[2]=-r*o,i[3]=t*o,i):null}l(O$,"invert");function N$(i,e){var t=e[0];return i[0]=e[3],i[1]=-e[1],i[2]=-e[2],i[3]=t,i}l(N$,"adjoint");function F$(i){return i[0]*i[3]-i[2]*i[1]}l(F$,"determinant");function v4(i,e,t){var n=e[0],r=e[1],a=e[2],o=e[3],s=t[0],u=t[1],h=t[2],d=t[3];return i[0]=n*s+a*u,i[1]=r*s+o*u,i[2]=n*h+a*d,i[3]=r*h+o*d,i}l(v4,"multiply");function B$(i,e,t){var n=e[0],r=e[1],a=e[2],o=e[3],s=Math.sin(t),u=Math.cos(t);return i[0]=n*u+a*s,i[1]=r*u+o*s,i[2]=n*-s+a*u,i[3]=r*-s+o*u,i}l(B$,"rotate");function z$(i,e,t){var n=e[0],r=e[1],a=e[2],o=e[3],s=t[0],u=t[1];return i[0]=n*s,i[1]=r*s,i[2]=a*u,i[3]=o*u,i}l(z$,"scale");function U$(i,e){var t=Math.sin(e),n=Math.cos(e);return i[0]=n,i[1]=t,i[2]=-t,i[3]=n,i}l(U$,"fromRotation");function V$(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=e[1],i}l(V$,"fromScaling");function j$(i){return"mat2("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"}l(j$,"str");function G$(i){return Math.hypot(i[0],i[1],i[2],i[3])}l(G$,"frob");function $$(i,e,t,n){return i[2]=n[2]/n[0],t[0]=n[0],t[1]=n[1],t[3]=n[3]-i[2]*t[1],[i,e,t]}l($$,"LDU");function H$(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i}l(H$,"add");function _4(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i}l(_4,"subtract");function W$(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]}l(W$,"exactEquals");function q$(i,e){var t=i[0],n=i[1],r=i[2],a=i[3],o=e[0],s=e[1],u=e[2],h=e[3];return Math.abs(t-o)<=Yi*Math.max(1,Math.abs(t),Math.abs(o))&&Math.abs(n-s)<=Yi*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-u)<=Yi*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(a-h)<=Yi*Math.max(1,Math.abs(a),Math.abs(h))}l(q$,"equals");function X$(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i}l(X$,"multiplyScalar");function Z$(i,e,t,n){return i[0]=e[0]+t[0]*n,i[1]=e[1]+t[1]*n,i[2]=e[2]+t[2]*n,i[3]=e[3]+t[3]*n,i}l(Z$,"multiplyScalarAndAdd");var mye=v4,gye=_4,R3={};xh(R3,{add:()=>_H,adjoint:()=>aH,clone:()=>K$,copy:()=>Q$,create:()=>Y$,determinant:()=>oH,equals:()=>AH,exactEquals:()=>wH,frob:()=>vH,fromMat2d:()=>dH,fromMat4:()=>J$,fromQuat:()=>fH,fromRotation:()=>cH,fromScaling:()=>pH,fromTranslation:()=>hH,fromValues:()=>eH,identity:()=>iH,invert:()=>rH,mul:()=>yye,multiply:()=>x4,multiplyScalar:()=>xH,multiplyScalarAndAdd:()=>bH,normalFromMat4:()=>mH,projection:()=>gH,rotate:()=>lH,scale:()=>uH,set:()=>tH,str:()=>yH,sub:()=>vye,subtract:()=>b4,translate:()=>sH,transpose:()=>nH});R();function Y$(){var i=new hr(9);return hr!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}l(Y$,"create");function J$(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[4],i[4]=e[5],i[5]=e[6],i[6]=e[8],i[7]=e[9],i[8]=e[10],i}l(J$,"fromMat4");function K$(i){var e=new hr(9);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e}l(K$,"clone");function Q$(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i}l(Q$,"copy");function eH(i,e,t,n,r,a,o,s,u){var h=new hr(9);return h[0]=i,h[1]=e,h[2]=t,h[3]=n,h[4]=r,h[5]=a,h[6]=o,h[7]=s,h[8]=u,h}l(eH,"fromValues");function tH(i,e,t,n,r,a,o,s,u,h){return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i[4]=a,i[5]=o,i[6]=s,i[7]=u,i[8]=h,i}l(tH,"set");function iH(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=1,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i}l(iH,"identity");function nH(i,e){if(i===e){var t=e[1],n=e[2],r=e[5];i[1]=e[3],i[2]=e[6],i[3]=t,i[5]=e[7],i[6]=n,i[7]=r}else i[0]=e[0],i[1]=e[3],i[2]=e[6],i[3]=e[1],i[4]=e[4],i[5]=e[7],i[6]=e[2],i[7]=e[5],i[8]=e[8];return i}l(nH,"transpose");function rH(i,e){var t=e[0],n=e[1],r=e[2],a=e[3],o=e[4],s=e[5],u=e[6],h=e[7],d=e[8],f=d*o-s*h,m=-d*a+s*u,v=h*a-o*u,b=t*f+n*m+r*v;return b?(b=1/b,i[0]=f*b,i[1]=(-d*n+r*h)*b,i[2]=(s*n-r*o)*b,i[3]=m*b,i[4]=(d*t-r*u)*b,i[5]=(-s*t+r*a)*b,i[6]=v*b,i[7]=(-h*t+n*u)*b,i[8]=(o*t-n*a)*b,i):null}l(rH,"invert");function aH(i,e){var t=e[0],n=e[1],r=e[2],a=e[3],o=e[4],s=e[5],u=e[6],h=e[7],d=e[8];return i[0]=o*d-s*h,i[1]=r*h-n*d,i[2]=n*s-r*o,i[3]=s*u-a*d,i[4]=t*d-r*u,i[5]=r*a-t*s,i[6]=a*h-o*u,i[7]=n*u-t*h,i[8]=t*o-n*a,i}l(aH,"adjoint");function oH(i){var e=i[0],t=i[1],n=i[2],r=i[3],a=i[4],o=i[5],s=i[6],u=i[7],h=i[8];return e*(h*a-o*u)+t*(-h*r+o*s)+n*(u*r-a*s)}l(oH,"determinant");function x4(i,e,t){var n=e[0],r=e[1],a=e[2],o=e[3],s=e[4],u=e[5],h=e[6],d=e[7],f=e[8],m=t[0],v=t[1],b=t[2],w=t[3],A=t[4],E=t[5],I=t[6],C=t[7],T=t[8];return i[0]=m*n+v*o+b*h,i[1]=m*r+v*s+b*d,i[2]=m*a+v*u+b*f,i[3]=w*n+A*o+E*h,i[4]=w*r+A*s+E*d,i[5]=w*a+A*u+E*f,i[6]=I*n+C*o+T*h,i[7]=I*r+C*s+T*d,i[8]=I*a+C*u+T*f,i}l(x4,"multiply");function sH(i,e,t){var n=e[0],r=e[1],a=e[2],o=e[3],s=e[4],u=e[5],h=e[6],d=e[7],f=e[8],m=t[0],v=t[1];return i[0]=n,i[1]=r,i[2]=a,i[3]=o,i[4]=s,i[5]=u,i[6]=m*n+v*o+h,i[7]=m*r+v*s+d,i[8]=m*a+v*u+f,i}l(sH,"translate");function lH(i,e,t){var n=e[0],r=e[1],a=e[2],o=e[3],s=e[4],u=e[5],h=e[6],d=e[7],f=e[8],m=Math.sin(t),v=Math.cos(t);return i[0]=v*n+m*o,i[1]=v*r+m*s,i[2]=v*a+m*u,i[3]=v*o-m*n,i[4]=v*s-m*r,i[5]=v*u-m*a,i[6]=h,i[7]=d,i[8]=f,i}l(lH,"rotate");function uH(i,e,t){var n=t[0],r=t[1];return i[0]=n*e[0],i[1]=n*e[1],i[2]=n*e[2],i[3]=r*e[3],i[4]=r*e[4],i[5]=r*e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i}l(uH,"scale");function hH(i,e){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=1,i[5]=0,i[6]=e[0],i[7]=e[1],i[8]=1,i}l(hH,"fromTranslation");function cH(i,e){var t=Math.sin(e),n=Math.cos(e);return i[0]=n,i[1]=t,i[2]=0,i[3]=-t,i[4]=n,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i}l(cH,"fromRotation");function pH(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=0,i[4]=e[1],i[5]=0,i[6]=0,i[7]=0,i[8]=1,i}l(pH,"fromScaling");function dH(i,e){return i[0]=e[0],i[1]=e[1],i[2]=0,i[3]=e[2],i[4]=e[3],i[5]=0,i[6]=e[4],i[7]=e[5],i[8]=1,i}l(dH,"fromMat2d");function fH(i,e){var t=e[0],n=e[1],r=e[2],a=e[3],o=t+t,s=n+n,u=r+r,h=t*o,d=n*o,f=n*s,m=r*o,v=r*s,b=r*u,w=a*o,A=a*s,E=a*u;return i[0]=1-f-b,i[3]=d-E,i[6]=m+A,i[1]=d+E,i[4]=1-h-b,i[7]=v-w,i[2]=m-A,i[5]=v+w,i[8]=1-h-f,i}l(fH,"fromQuat");function mH(i,e){var t=e[0],n=e[1],r=e[2],a=e[3],o=e[4],s=e[5],u=e[6],h=e[7],d=e[8],f=e[9],m=e[10],v=e[11],b=e[12],w=e[13],A=e[14],E=e[15],I=t*s-n*o,C=t*u-r*o,T=t*h-a*o,k=n*u-r*s,F=n*h-a*s,B=r*h-a*u,N=d*w-f*b,z=d*A-m*b,L=d*E-v*b,j=f*A-m*w,q=f*E-v*w,Z=m*E-v*A,O=I*Z-C*q+T*j+k*L-F*z+B*N;return O?(O=1/O,i[0]=(s*Z-u*q+h*j)*O,i[1]=(u*L-o*Z-h*z)*O,i[2]=(o*q-s*L+h*N)*O,i[3]=(r*q-n*Z-a*j)*O,i[4]=(t*Z-r*L+a*z)*O,i[5]=(n*L-t*q-a*N)*O,i[6]=(w*B-A*F+E*k)*O,i[7]=(A*T-b*B-E*C)*O,i[8]=(b*F-w*T+E*I)*O,i):null}l(mH,"normalFromMat4");function gH(i,e,t){return i[0]=2/e,i[1]=0,i[2]=0,i[3]=0,i[4]=-2/t,i[5]=0,i[6]=-1,i[7]=1,i[8]=1,i}l(gH,"projection");function yH(i){return"mat3("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+", "+i[6]+", "+i[7]+", "+i[8]+")"}l(yH,"str");function vH(i){return Math.hypot(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8])}l(vH,"frob");function _H(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i[4]=e[4]+t[4],i[5]=e[5]+t[5],i[6]=e[6]+t[6],i[7]=e[7]+t[7],i[8]=e[8]+t[8],i}l(_H,"add");function b4(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i[4]=e[4]-t[4],i[5]=e[5]-t[5],i[6]=e[6]-t[6],i[7]=e[7]-t[7],i[8]=e[8]-t[8],i}l(b4,"subtract");function xH(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i[4]=e[4]*t,i[5]=e[5]*t,i[6]=e[6]*t,i[7]=e[7]*t,i[8]=e[8]*t,i}l(xH,"multiplyScalar");function bH(i,e,t,n){return i[0]=e[0]+t[0]*n,i[1]=e[1]+t[1]*n,i[2]=e[2]+t[2]*n,i[3]=e[3]+t[3]*n,i[4]=e[4]+t[4]*n,i[5]=e[5]+t[5]*n,i[6]=e[6]+t[6]*n,i[7]=e[7]+t[7]*n,i[8]=e[8]+t[8]*n,i}l(bH,"multiplyScalarAndAdd");function wH(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]&&i[4]===e[4]&&i[5]===e[5]&&i[6]===e[6]&&i[7]===e[7]&&i[8]===e[8]}l(wH,"exactEquals");function AH(i,e){var t=i[0],n=i[1],r=i[2],a=i[3],o=i[4],s=i[5],u=i[6],h=i[7],d=i[8],f=e[0],m=e[1],v=e[2],b=e[3],w=e[4],A=e[5],E=e[6],I=e[7],C=e[8];return Math.abs(t-f)<=Yi*Math.max(1,Math.abs(t),Math.abs(f))&&Math.abs(n-m)<=Yi*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(r-v)<=Yi*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(a-b)<=Yi*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(o-w)<=Yi*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(s-A)<=Yi*Math.max(1,Math.abs(s),Math.abs(A))&&Math.abs(u-E)<=Yi*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(h-I)<=Yi*Math.max(1,Math.abs(h),Math.abs(I))&&Math.abs(d-C)<=Yi*Math.max(1,Math.abs(d),Math.abs(C))}l(AH,"equals");var yye=x4,vye=b4,Qt={};xh(Qt,{add:()=>aW,adjoint:()=>LH,clone:()=>MH,copy:()=>CH,create:()=>SH,determinant:()=>DH,equals:()=>uW,exactEquals:()=>lW,frob:()=>rW,fromQuat:()=>YH,fromQuat2:()=>HH,fromRotation:()=>VH,fromRotationTranslation:()=>S4,fromRotationTranslationScale:()=>XH,fromRotationTranslationScaleOrigin:()=>ZH,fromScaling:()=>UH,fromTranslation:()=>zH,fromValues:()=>EH,fromXRotation:()=>jH,fromYRotation:()=>GH,fromZRotation:()=>$H,frustum:()=>JH,getRotation:()=>qH,getScaling:()=>M4,getTranslation:()=>WH,identity:()=>w4,invert:()=>PH,lookAt:()=>tW,mul:()=>bye,multiply:()=>A4,multiplyScalar:()=>oW,multiplyScalarAndAdd:()=>sW,ortho:()=>xye,orthoNO:()=>E4,orthoZO:()=>eW,perspective:()=>_ye,perspectiveFromFieldOfView:()=>QH,perspectiveNO:()=>C4,perspectiveZO:()=>KH,rotate:()=>OH,rotateX:()=>NH,rotateY:()=>FH,rotateZ:()=>BH,scale:()=>RH,set:()=>IH,str:()=>nW,sub:()=>wye,subtract:()=>I4,targetTo:()=>iW,translate:()=>kH,transpose:()=>TH});R();function SH(){var i=new hr(16);return hr!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i}l(SH,"create");function MH(i){var e=new hr(16);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],e}l(MH,"clone");function CH(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i}l(CH,"copy");function EH(i,e,t,n,r,a,o,s,u,h,d,f,m,v,b,w){var A=new hr(16);return A[0]=i,A[1]=e,A[2]=t,A[3]=n,A[4]=r,A[5]=a,A[6]=o,A[7]=s,A[8]=u,A[9]=h,A[10]=d,A[11]=f,A[12]=m,A[13]=v,A[14]=b,A[15]=w,A}l(EH,"fromValues");function IH(i,e,t,n,r,a,o,s,u,h,d,f,m,v,b,w,A){return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i[4]=a,i[5]=o,i[6]=s,i[7]=u,i[8]=h,i[9]=d,i[10]=f,i[11]=m,i[12]=v,i[13]=b,i[14]=w,i[15]=A,i}l(IH,"set");function w4(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}l(w4,"identity");function TH(i,e){if(i===e){var t=e[1],n=e[2],r=e[3],a=e[6],o=e[7],s=e[11];i[1]=e[4],i[2]=e[8],i[3]=e[12],i[4]=t,i[6]=e[9],i[7]=e[13],i[8]=n,i[9]=a,i[11]=e[14],i[12]=r,i[13]=o,i[14]=s}else i[0]=e[0],i[1]=e[4],i[2]=e[8],i[3]=e[12],i[4]=e[1],i[5]=e[5],i[6]=e[9],i[7]=e[13],i[8]=e[2],i[9]=e[6],i[10]=e[10],i[11]=e[14],i[12]=e[3],i[13]=e[7],i[14]=e[11],i[15]=e[15];return i}l(TH,"transpose");function PH(i,e){var t=e[0],n=e[1],r=e[2],a=e[3],o=e[4],s=e[5],u=e[6],h=e[7],d=e[8],f=e[9],m=e[10],v=e[11],b=e[12],w=e[13],A=e[14],E=e[15],I=t*s-n*o,C=t*u-r*o,T=t*h-a*o,k=n*u-r*s,F=n*h-a*s,B=r*h-a*u,N=d*w-f*b,z=d*A-m*b,L=d*E-v*b,j=f*A-m*w,q=f*E-v*w,Z=m*E-v*A,O=I*Z-C*q+T*j+k*L-F*z+B*N;return O?(O=1/O,i[0]=(s*Z-u*q+h*j)*O,i[1]=(r*q-n*Z-a*j)*O,i[2]=(w*B-A*F+E*k)*O,i[3]=(m*F-f*B-v*k)*O,i[4]=(u*L-o*Z-h*z)*O,i[5]=(t*Z-r*L+a*z)*O,i[6]=(A*T-b*B-E*C)*O,i[7]=(d*B-m*T+v*C)*O,i[8]=(o*q-s*L+h*N)*O,i[9]=(n*L-t*q-a*N)*O,i[10]=(b*F-w*T+E*I)*O,i[11]=(f*T-d*F-v*I)*O,i[12]=(s*z-o*j-u*N)*O,i[13]=(t*j-n*z+r*N)*O,i[14]=(w*C-b*k-A*I)*O,i[15]=(d*k-f*C+m*I)*O,i):null}l(PH,"invert");function LH(i,e){var t=e[0],n=e[1],r=e[2],a=e[3],o=e[4],s=e[5],u=e[6],h=e[7],d=e[8],f=e[9],m=e[10],v=e[11],b=e[12],w=e[13],A=e[14],E=e[15];return i[0]=s*(m*E-v*A)-f*(u*E-h*A)+w*(u*v-h*m),i[1]=-(n*(m*E-v*A)-f*(r*E-a*A)+w*(r*v-a*m)),i[2]=n*(u*E-h*A)-s*(r*E-a*A)+w*(r*h-a*u),i[3]=-(n*(u*v-h*m)-s*(r*v-a*m)+f*(r*h-a*u)),i[4]=-(o*(m*E-v*A)-d*(u*E-h*A)+b*(u*v-h*m)),i[5]=t*(m*E-v*A)-d*(r*E-a*A)+b*(r*v-a*m),i[6]=-(t*(u*E-h*A)-o*(r*E-a*A)+b*(r*h-a*u)),i[7]=t*(u*v-h*m)-o*(r*v-a*m)+d*(r*h-a*u),i[8]=o*(f*E-v*w)-d*(s*E-h*w)+b*(s*v-h*f),i[9]=-(t*(f*E-v*w)-d*(n*E-a*w)+b*(n*v-a*f)),i[10]=t*(s*E-h*w)-o*(n*E-a*w)+b*(n*h-a*s),i[11]=-(t*(s*v-h*f)-o*(n*v-a*f)+d*(n*h-a*s)),i[12]=-(o*(f*A-m*w)-d*(s*A-u*w)+b*(s*m-u*f)),i[13]=t*(f*A-m*w)-d*(n*A-r*w)+b*(n*m-r*f),i[14]=-(t*(s*A-u*w)-o*(n*A-r*w)+b*(n*u-r*s)),i[15]=t*(s*m-u*f)-o*(n*m-r*f)+d*(n*u-r*s),i}l(LH,"adjoint");function DH(i){var e=i[0],t=i[1],n=i[2],r=i[3],a=i[4],o=i[5],s=i[6],u=i[7],h=i[8],d=i[9],f=i[10],m=i[11],v=i[12],b=i[13],w=i[14],A=i[15],E=e*o-t*a,I=e*s-n*a,C=e*u-r*a,T=t*s-n*o,k=t*u-r*o,F=n*u-r*s,B=h*b-d*v,N=h*w-f*v,z=h*A-m*v,L=d*w-f*b,j=d*A-m*b,q=f*A-m*w;return E*q-I*j+C*L+T*z-k*N+F*B}l(DH,"determinant");function A4(i,e,t){var n=e[0],r=e[1],a=e[2],o=e[3],s=e[4],u=e[5],h=e[6],d=e[7],f=e[8],m=e[9],v=e[10],b=e[11],w=e[12],A=e[13],E=e[14],I=e[15],C=t[0],T=t[1],k=t[2],F=t[3];return i[0]=C*n+T*s+k*f+F*w,i[1]=C*r+T*u+k*m+F*A,i[2]=C*a+T*h+k*v+F*E,i[3]=C*o+T*d+k*b+F*I,C=t[4],T=t[5],k=t[6],F=t[7],i[4]=C*n+T*s+k*f+F*w,i[5]=C*r+T*u+k*m+F*A,i[6]=C*a+T*h+k*v+F*E,i[7]=C*o+T*d+k*b+F*I,C=t[8],T=t[9],k=t[10],F=t[11],i[8]=C*n+T*s+k*f+F*w,i[9]=C*r+T*u+k*m+F*A,i[10]=C*a+T*h+k*v+F*E,i[11]=C*o+T*d+k*b+F*I,C=t[12],T=t[13],k=t[14],F=t[15],i[12]=C*n+T*s+k*f+F*w,i[13]=C*r+T*u+k*m+F*A,i[14]=C*a+T*h+k*v+F*E,i[15]=C*o+T*d+k*b+F*I,i}l(A4,"multiply");function kH(i,e,t){var n=t[0],r=t[1],a=t[2],o,s,u,h,d,f,m,v,b,w,A,E;return e===i?(i[12]=e[0]*n+e[4]*r+e[8]*a+e[12],i[13]=e[1]*n+e[5]*r+e[9]*a+e[13],i[14]=e[2]*n+e[6]*r+e[10]*a+e[14],i[15]=e[3]*n+e[7]*r+e[11]*a+e[15]):(o=e[0],s=e[1],u=e[2],h=e[3],d=e[4],f=e[5],m=e[6],v=e[7],b=e[8],w=e[9],A=e[10],E=e[11],i[0]=o,i[1]=s,i[2]=u,i[3]=h,i[4]=d,i[5]=f,i[6]=m,i[7]=v,i[8]=b,i[9]=w,i[10]=A,i[11]=E,i[12]=o*n+d*r+b*a+e[12],i[13]=s*n+f*r+w*a+e[13],i[14]=u*n+m*r+A*a+e[14],i[15]=h*n+v*r+E*a+e[15]),i}l(kH,"translate");function RH(i,e,t){var n=t[0],r=t[1],a=t[2];return i[0]=e[0]*n,i[1]=e[1]*n,i[2]=e[2]*n,i[3]=e[3]*n,i[4]=e[4]*r,i[5]=e[5]*r,i[6]=e[6]*r,i[7]=e[7]*r,i[8]=e[8]*a,i[9]=e[9]*a,i[10]=e[10]*a,i[11]=e[11]*a,i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i}l(RH,"scale");function OH(i,e,t,n){var r=n[0],a=n[1],o=n[2],s=Math.hypot(r,a,o),u,h,d,f,m,v,b,w,A,E,I,C,T,k,F,B,N,z,L,j,q,Z,O,Y;return s<Yi?null:(s=1/s,r*=s,a*=s,o*=s,u=Math.sin(t),h=Math.cos(t),d=1-h,f=e[0],m=e[1],v=e[2],b=e[3],w=e[4],A=e[5],E=e[6],I=e[7],C=e[8],T=e[9],k=e[10],F=e[11],B=r*r*d+h,N=a*r*d+o*u,z=o*r*d-a*u,L=r*a*d-o*u,j=a*a*d+h,q=o*a*d+r*u,Z=r*o*d+a*u,O=a*o*d-r*u,Y=o*o*d+h,i[0]=f*B+w*N+C*z,i[1]=m*B+A*N+T*z,i[2]=v*B+E*N+k*z,i[3]=b*B+I*N+F*z,i[4]=f*L+w*j+C*q,i[5]=m*L+A*j+T*q,i[6]=v*L+E*j+k*q,i[7]=b*L+I*j+F*q,i[8]=f*Z+w*O+C*Y,i[9]=m*Z+A*O+T*Y,i[10]=v*Z+E*O+k*Y,i[11]=b*Z+I*O+F*Y,e!==i&&(i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i)}l(OH,"rotate");function NH(i,e,t){var n=Math.sin(t),r=Math.cos(t),a=e[4],o=e[5],s=e[6],u=e[7],h=e[8],d=e[9],f=e[10],m=e[11];return e!==i&&(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[4]=a*r+h*n,i[5]=o*r+d*n,i[6]=s*r+f*n,i[7]=u*r+m*n,i[8]=h*r-a*n,i[9]=d*r-o*n,i[10]=f*r-s*n,i[11]=m*r-u*n,i}l(NH,"rotateX");function FH(i,e,t){var n=Math.sin(t),r=Math.cos(t),a=e[0],o=e[1],s=e[2],u=e[3],h=e[8],d=e[9],f=e[10],m=e[11];return e!==i&&(i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=a*r-h*n,i[1]=o*r-d*n,i[2]=s*r-f*n,i[3]=u*r-m*n,i[8]=a*n+h*r,i[9]=o*n+d*r,i[10]=s*n+f*r,i[11]=u*n+m*r,i}l(FH,"rotateY");function BH(i,e,t){var n=Math.sin(t),r=Math.cos(t),a=e[0],o=e[1],s=e[2],u=e[3],h=e[4],d=e[5],f=e[6],m=e[7];return e!==i&&(i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=a*r+h*n,i[1]=o*r+d*n,i[2]=s*r+f*n,i[3]=u*r+m*n,i[4]=h*r-a*n,i[5]=d*r-o*n,i[6]=f*r-s*n,i[7]=m*r-u*n,i}l(BH,"rotateZ");function zH(i,e){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=e[0],i[13]=e[1],i[14]=e[2],i[15]=1,i}l(zH,"fromTranslation");function UH(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=e[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=e[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}l(UH,"fromScaling");function VH(i,e,t){var n=t[0],r=t[1],a=t[2],o=Math.hypot(n,r,a),s,u,h;return o<Yi?null:(o=1/o,n*=o,r*=o,a*=o,s=Math.sin(e),u=Math.cos(e),h=1-u,i[0]=n*n*h+u,i[1]=r*n*h+a*s,i[2]=a*n*h-r*s,i[3]=0,i[4]=n*r*h-a*s,i[5]=r*r*h+u,i[6]=a*r*h+n*s,i[7]=0,i[8]=n*a*h+r*s,i[9]=r*a*h-n*s,i[10]=a*a*h+u,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i)}l(VH,"fromRotation");function jH(i,e){var t=Math.sin(e),n=Math.cos(e);return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=n,i[6]=t,i[7]=0,i[8]=0,i[9]=-t,i[10]=n,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}l(jH,"fromXRotation");function GH(i,e){var t=Math.sin(e),n=Math.cos(e);return i[0]=n,i[1]=0,i[2]=-t,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=t,i[9]=0,i[10]=n,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}l(GH,"fromYRotation");function $H(i,e){var t=Math.sin(e),n=Math.cos(e);return i[0]=n,i[1]=t,i[2]=0,i[3]=0,i[4]=-t,i[5]=n,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}l($H,"fromZRotation");function S4(i,e,t){var n=e[0],r=e[1],a=e[2],o=e[3],s=n+n,u=r+r,h=a+a,d=n*s,f=n*u,m=n*h,v=r*u,b=r*h,w=a*h,A=o*s,E=o*u,I=o*h;return i[0]=1-(v+w),i[1]=f+I,i[2]=m-E,i[3]=0,i[4]=f-I,i[5]=1-(d+w),i[6]=b+A,i[7]=0,i[8]=m+E,i[9]=b-A,i[10]=1-(d+v),i[11]=0,i[12]=t[0],i[13]=t[1],i[14]=t[2],i[15]=1,i}l(S4,"fromRotationTranslation");function HH(i,e){var t=new hr(3),n=-e[0],r=-e[1],a=-e[2],o=e[3],s=e[4],u=e[5],h=e[6],d=e[7],f=n*n+r*r+a*a+o*o;return f>0?(t[0]=(s*o+d*n+u*a-h*r)*2/f,t[1]=(u*o+d*r+h*n-s*a)*2/f,t[2]=(h*o+d*a+s*r-u*n)*2/f):(t[0]=(s*o+d*n+u*a-h*r)*2,t[1]=(u*o+d*r+h*n-s*a)*2,t[2]=(h*o+d*a+s*r-u*n)*2),S4(i,e,t),i}l(HH,"fromQuat2");function WH(i,e){return i[0]=e[12],i[1]=e[13],i[2]=e[14],i}l(WH,"getTranslation");function M4(i,e){var t=e[0],n=e[1],r=e[2],a=e[4],o=e[5],s=e[6],u=e[8],h=e[9],d=e[10];return i[0]=Math.hypot(t,n,r),i[1]=Math.hypot(a,o,s),i[2]=Math.hypot(u,h,d),i}l(M4,"getScaling");function qH(i,e){var t=new hr(3);M4(t,e);var n=1/t[0],r=1/t[1],a=1/t[2],o=e[0]*n,s=e[1]*r,u=e[2]*a,h=e[4]*n,d=e[5]*r,f=e[6]*a,m=e[8]*n,v=e[9]*r,b=e[10]*a,w=o+d+b,A=0;return w>0?(A=Math.sqrt(w+1)*2,i[3]=.25*A,i[0]=(f-v)/A,i[1]=(m-u)/A,i[2]=(s-h)/A):o>d&&o>b?(A=Math.sqrt(1+o-d-b)*2,i[3]=(f-v)/A,i[0]=.25*A,i[1]=(s+h)/A,i[2]=(m+u)/A):d>b?(A=Math.sqrt(1+d-o-b)*2,i[3]=(m-u)/A,i[0]=(s+h)/A,i[1]=.25*A,i[2]=(f+v)/A):(A=Math.sqrt(1+b-o-d)*2,i[3]=(s-h)/A,i[0]=(m+u)/A,i[1]=(f+v)/A,i[2]=.25*A),i}l(qH,"getRotation");function XH(i,e,t,n){var r=e[0],a=e[1],o=e[2],s=e[3],u=r+r,h=a+a,d=o+o,f=r*u,m=r*h,v=r*d,b=a*h,w=a*d,A=o*d,E=s*u,I=s*h,C=s*d,T=n[0],k=n[1],F=n[2];return i[0]=(1-(b+A))*T,i[1]=(m+C)*T,i[2]=(v-I)*T,i[3]=0,i[4]=(m-C)*k,i[5]=(1-(f+A))*k,i[6]=(w+E)*k,i[7]=0,i[8]=(v+I)*F,i[9]=(w-E)*F,i[10]=(1-(f+b))*F,i[11]=0,i[12]=t[0],i[13]=t[1],i[14]=t[2],i[15]=1,i}l(XH,"fromRotationTranslationScale");function ZH(i,e,t,n,r){var a=e[0],o=e[1],s=e[2],u=e[3],h=a+a,d=o+o,f=s+s,m=a*h,v=a*d,b=a*f,w=o*d,A=o*f,E=s*f,I=u*h,C=u*d,T=u*f,k=n[0],F=n[1],B=n[2],N=r[0],z=r[1],L=r[2],j=(1-(w+E))*k,q=(v+T)*k,Z=(b-C)*k,O=(v-T)*F,Y=(1-(m+E))*F,J=(A+I)*F,oe=(b+C)*B,$=(A-I)*B,K=(1-(m+w))*B;return i[0]=j,i[1]=q,i[2]=Z,i[3]=0,i[4]=O,i[5]=Y,i[6]=J,i[7]=0,i[8]=oe,i[9]=$,i[10]=K,i[11]=0,i[12]=t[0]+N-(j*N+O*z+oe*L),i[13]=t[1]+z-(q*N+Y*z+$*L),i[14]=t[2]+L-(Z*N+J*z+K*L),i[15]=1,i}l(ZH,"fromRotationTranslationScaleOrigin");function YH(i,e){var t=e[0],n=e[1],r=e[2],a=e[3],o=t+t,s=n+n,u=r+r,h=t*o,d=n*o,f=n*s,m=r*o,v=r*s,b=r*u,w=a*o,A=a*s,E=a*u;return i[0]=1-f-b,i[1]=d+E,i[2]=m-A,i[3]=0,i[4]=d-E,i[5]=1-h-b,i[6]=v+w,i[7]=0,i[8]=m+A,i[9]=v-w,i[10]=1-h-f,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}l(YH,"fromQuat");function JH(i,e,t,n,r,a,o){var s=1/(t-e),u=1/(r-n),h=1/(a-o);return i[0]=a*2*s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=a*2*u,i[6]=0,i[7]=0,i[8]=(t+e)*s,i[9]=(r+n)*u,i[10]=(o+a)*h,i[11]=-1,i[12]=0,i[13]=0,i[14]=o*a*2*h,i[15]=0,i}l(JH,"frustum");function C4(i,e,t,n,r){var a=1/Math.tan(e/2),o;return i[0]=a/t,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=a,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,r!=null&&r!==1/0?(o=1/(n-r),i[10]=(r+n)*o,i[14]=2*r*n*o):(i[10]=-1,i[14]=-2*n),i}l(C4,"perspectiveNO");var _ye=C4;function KH(i,e,t,n,r){var a=1/Math.tan(e/2),o;return i[0]=a/t,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=a,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,r!=null&&r!==1/0?(o=1/(n-r),i[10]=r*o,i[14]=r*n*o):(i[10]=-1,i[14]=-n),i}l(KH,"perspectiveZO");function QH(i,e,t,n){var r=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(o+s),h=2/(r+a);return i[0]=u,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=h,i[6]=0,i[7]=0,i[8]=-((o-s)*u*.5),i[9]=(r-a)*h*.5,i[10]=n/(t-n),i[11]=-1,i[12]=0,i[13]=0,i[14]=n*t/(t-n),i[15]=0,i}l(QH,"perspectiveFromFieldOfView");function E4(i,e,t,n,r,a,o){var s=1/(e-t),u=1/(n-r),h=1/(a-o);return i[0]=-2*s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*u,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*h,i[11]=0,i[12]=(e+t)*s,i[13]=(r+n)*u,i[14]=(o+a)*h,i[15]=1,i}l(E4,"orthoNO");var xye=E4;function eW(i,e,t,n,r,a,o){var s=1/(e-t),u=1/(n-r),h=1/(a-o);return i[0]=-2*s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*u,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=h,i[11]=0,i[12]=(e+t)*s,i[13]=(r+n)*u,i[14]=a*h,i[15]=1,i}l(eW,"orthoZO");function tW(i,e,t,n){var r,a,o,s,u,h,d,f,m,v,b=e[0],w=e[1],A=e[2],E=n[0],I=n[1],C=n[2],T=t[0],k=t[1],F=t[2];return Math.abs(b-T)<Yi&&Math.abs(w-k)<Yi&&Math.abs(A-F)<Yi?w4(i):(d=b-T,f=w-k,m=A-F,v=1/Math.hypot(d,f,m),d*=v,f*=v,m*=v,r=I*m-C*f,a=C*d-E*m,o=E*f-I*d,v=Math.hypot(r,a,o),v?(v=1/v,r*=v,a*=v,o*=v):(r=0,a=0,o=0),s=f*o-m*a,u=m*r-d*o,h=d*a-f*r,v=Math.hypot(s,u,h),v?(v=1/v,s*=v,u*=v,h*=v):(s=0,u=0,h=0),i[0]=r,i[1]=s,i[2]=d,i[3]=0,i[4]=a,i[5]=u,i[6]=f,i[7]=0,i[8]=o,i[9]=h,i[10]=m,i[11]=0,i[12]=-(r*b+a*w+o*A),i[13]=-(s*b+u*w+h*A),i[14]=-(d*b+f*w+m*A),i[15]=1,i)}l(tW,"lookAt");function iW(i,e,t,n){var r=e[0],a=e[1],o=e[2],s=n[0],u=n[1],h=n[2],d=r-t[0],f=a-t[1],m=o-t[2],v=d*d+f*f+m*m;v>0&&(v=1/Math.sqrt(v),d*=v,f*=v,m*=v);var b=u*m-h*f,w=h*d-s*m,A=s*f-u*d;return v=b*b+w*w+A*A,v>0&&(v=1/Math.sqrt(v),b*=v,w*=v,A*=v),i[0]=b,i[1]=w,i[2]=A,i[3]=0,i[4]=f*A-m*w,i[5]=m*b-d*A,i[6]=d*w-f*b,i[7]=0,i[8]=d,i[9]=f,i[10]=m,i[11]=0,i[12]=r,i[13]=a,i[14]=o,i[15]=1,i}l(iW,"targetTo");function nW(i){return"mat4("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+", "+i[6]+", "+i[7]+", "+i[8]+", "+i[9]+", "+i[10]+", "+i[11]+", "+i[12]+", "+i[13]+", "+i[14]+", "+i[15]+")"}l(nW,"str");function rW(i){return Math.hypot(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],i[9],i[10],i[11],i[12],i[13],i[14],i[15])}l(rW,"frob");function aW(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i[4]=e[4]+t[4],i[5]=e[5]+t[5],i[6]=e[6]+t[6],i[7]=e[7]+t[7],i[8]=e[8]+t[8],i[9]=e[9]+t[9],i[10]=e[10]+t[10],i[11]=e[11]+t[11],i[12]=e[12]+t[12],i[13]=e[13]+t[13],i[14]=e[14]+t[14],i[15]=e[15]+t[15],i}l(aW,"add");function I4(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i[4]=e[4]-t[4],i[5]=e[5]-t[5],i[6]=e[6]-t[6],i[7]=e[7]-t[7],i[8]=e[8]-t[8],i[9]=e[9]-t[9],i[10]=e[10]-t[10],i[11]=e[11]-t[11],i[12]=e[12]-t[12],i[13]=e[13]-t[13],i[14]=e[14]-t[14],i[15]=e[15]-t[15],i}l(I4,"subtract");function oW(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i[4]=e[4]*t,i[5]=e[5]*t,i[6]=e[6]*t,i[7]=e[7]*t,i[8]=e[8]*t,i[9]=e[9]*t,i[10]=e[10]*t,i[11]=e[11]*t,i[12]=e[12]*t,i[13]=e[13]*t,i[14]=e[14]*t,i[15]=e[15]*t,i}l(oW,"multiplyScalar");function sW(i,e,t,n){return i[0]=e[0]+t[0]*n,i[1]=e[1]+t[1]*n,i[2]=e[2]+t[2]*n,i[3]=e[3]+t[3]*n,i[4]=e[4]+t[4]*n,i[5]=e[5]+t[5]*n,i[6]=e[6]+t[6]*n,i[7]=e[7]+t[7]*n,i[8]=e[8]+t[8]*n,i[9]=e[9]+t[9]*n,i[10]=e[10]+t[10]*n,i[11]=e[11]+t[11]*n,i[12]=e[12]+t[12]*n,i[13]=e[13]+t[13]*n,i[14]=e[14]+t[14]*n,i[15]=e[15]+t[15]*n,i}l(sW,"multiplyScalarAndAdd");function lW(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]&&i[4]===e[4]&&i[5]===e[5]&&i[6]===e[6]&&i[7]===e[7]&&i[8]===e[8]&&i[9]===e[9]&&i[10]===e[10]&&i[11]===e[11]&&i[12]===e[12]&&i[13]===e[13]&&i[14]===e[14]&&i[15]===e[15]}l(lW,"exactEquals");function uW(i,e){var t=i[0],n=i[1],r=i[2],a=i[3],o=i[4],s=i[5],u=i[6],h=i[7],d=i[8],f=i[9],m=i[10],v=i[11],b=i[12],w=i[13],A=i[14],E=i[15],I=e[0],C=e[1],T=e[2],k=e[3],F=e[4],B=e[5],N=e[6],z=e[7],L=e[8],j=e[9],q=e[10],Z=e[11],O=e[12],Y=e[13],J=e[14],oe=e[15];return Math.abs(t-I)<=Yi*Math.max(1,Math.abs(t),Math.abs(I))&&Math.abs(n-C)<=Yi*Math.max(1,Math.abs(n),Math.abs(C))&&Math.abs(r-T)<=Yi*Math.max(1,Math.abs(r),Math.abs(T))&&Math.abs(a-k)<=Yi*Math.max(1,Math.abs(a),Math.abs(k))&&Math.abs(o-F)<=Yi*Math.max(1,Math.abs(o),Math.abs(F))&&Math.abs(s-B)<=Yi*Math.max(1,Math.abs(s),Math.abs(B))&&Math.abs(u-N)<=Yi*Math.max(1,Math.abs(u),Math.abs(N))&&Math.abs(h-z)<=Yi*Math.max(1,Math.abs(h),Math.abs(z))&&Math.abs(d-L)<=Yi*Math.max(1,Math.abs(d),Math.abs(L))&&Math.abs(f-j)<=Yi*Math.max(1,Math.abs(f),Math.abs(j))&&Math.abs(m-q)<=Yi*Math.max(1,Math.abs(m),Math.abs(q))&&Math.abs(v-Z)<=Yi*Math.max(1,Math.abs(v),Math.abs(Z))&&Math.abs(b-O)<=Yi*Math.max(1,Math.abs(b),Math.abs(O))&&Math.abs(w-Y)<=Yi*Math.max(1,Math.abs(w),Math.abs(Y))&&Math.abs(A-J)<=Yi*Math.max(1,Math.abs(A),Math.abs(J))&&Math.abs(E-oe)<=Yi*Math.max(1,Math.abs(E),Math.abs(oe))}l(uW,"equals");var bye=A4,wye=I4,dl={};xh(dl,{add:()=>fW,angle:()=>NW,bezier:()=>IW,ceil:()=>mW,clone:()=>hW,copy:()=>pW,create:()=>T4,cross:()=>MW,dist:()=>Cye,distance:()=>R4,div:()=>Mye,divide:()=>k4,dot:()=>F4,equals:()=>UW,exactEquals:()=>zW,floor:()=>gW,forEach:()=>Pye,fromValues:()=>cW,hermite:()=>EW,inverse:()=>AW,len:()=>Iye,length:()=>P4,lerp:()=>CW,max:()=>vW,min:()=>yW,mul:()=>Sye,multiply:()=>D4,negate:()=>wW,normalize:()=>SW,random:()=>TW,rotateX:()=>kW,rotateY:()=>RW,rotateZ:()=>OW,round:()=>_W,scale:()=>xW,scaleAndAdd:()=>bW,set:()=>dW,sqrDist:()=>Eye,sqrLen:()=>Tye,squaredDistance:()=>O4,squaredLength:()=>N4,str:()=>BW,sub:()=>Aye,subtract:()=>L4,transformMat3:()=>LW,transformMat4:()=>PW,transformQuat:()=>DW,zero:()=>FW});R();function T4(){var i=new hr(3);return hr!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}l(T4,"create");function hW(i){var e=new hr(3);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e}l(hW,"clone");function P4(i){var e=i[0],t=i[1],n=i[2];return Math.hypot(e,t,n)}l(P4,"length");function cW(i,e,t){var n=new hr(3);return n[0]=i,n[1]=e,n[2]=t,n}l(cW,"fromValues");function pW(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i}l(pW,"copy");function dW(i,e,t,n){return i[0]=e,i[1]=t,i[2]=n,i}l(dW,"set");function fW(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i}l(fW,"add");function L4(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i}l(L4,"subtract");function D4(i,e,t){return i[0]=e[0]*t[0],i[1]=e[1]*t[1],i[2]=e[2]*t[2],i}l(D4,"multiply");function k4(i,e,t){return i[0]=e[0]/t[0],i[1]=e[1]/t[1],i[2]=e[2]/t[2],i}l(k4,"divide");function mW(i,e){return i[0]=Math.ceil(e[0]),i[1]=Math.ceil(e[1]),i[2]=Math.ceil(e[2]),i}l(mW,"ceil");function gW(i,e){return i[0]=Math.floor(e[0]),i[1]=Math.floor(e[1]),i[2]=Math.floor(e[2]),i}l(gW,"floor");function yW(i,e,t){return i[0]=Math.min(e[0],t[0]),i[1]=Math.min(e[1],t[1]),i[2]=Math.min(e[2],t[2]),i}l(yW,"min");function vW(i,e,t){return i[0]=Math.max(e[0],t[0]),i[1]=Math.max(e[1],t[1]),i[2]=Math.max(e[2],t[2]),i}l(vW,"max");function _W(i,e){return i[0]=Math.round(e[0]),i[1]=Math.round(e[1]),i[2]=Math.round(e[2]),i}l(_W,"round");function xW(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i}l(xW,"scale");function bW(i,e,t,n){return i[0]=e[0]+t[0]*n,i[1]=e[1]+t[1]*n,i[2]=e[2]+t[2]*n,i}l(bW,"scaleAndAdd");function R4(i,e){var t=e[0]-i[0],n=e[1]-i[1],r=e[2]-i[2];return Math.hypot(t,n,r)}l(R4,"distance");function O4(i,e){var t=e[0]-i[0],n=e[1]-i[1],r=e[2]-i[2];return t*t+n*n+r*r}l(O4,"squaredDistance");function N4(i){var e=i[0],t=i[1],n=i[2];return e*e+t*t+n*n}l(N4,"squaredLength");function wW(i,e){return i[0]=-e[0],i[1]=-e[1],i[2]=-e[2],i}l(wW,"negate");function AW(i,e){return i[0]=1/e[0],i[1]=1/e[1],i[2]=1/e[2],i}l(AW,"inverse");function SW(i,e){var t=e[0],n=e[1],r=e[2],a=t*t+n*n+r*r;return a>0&&(a=1/Math.sqrt(a)),i[0]=e[0]*a,i[1]=e[1]*a,i[2]=e[2]*a,i}l(SW,"normalize");function F4(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]}l(F4,"dot");function MW(i,e,t){var n=e[0],r=e[1],a=e[2],o=t[0],s=t[1],u=t[2];return i[0]=r*u-a*s,i[1]=a*o-n*u,i[2]=n*s-r*o,i}l(MW,"cross");function CW(i,e,t,n){var r=e[0],a=e[1],o=e[2];return i[0]=r+n*(t[0]-r),i[1]=a+n*(t[1]-a),i[2]=o+n*(t[2]-o),i}l(CW,"lerp");function EW(i,e,t,n,r,a){var o=a*a,s=o*(2*a-3)+1,u=o*(a-2)+a,h=o*(a-1),d=o*(3-2*a);return i[0]=e[0]*s+t[0]*u+n[0]*h+r[0]*d,i[1]=e[1]*s+t[1]*u+n[1]*h+r[1]*d,i[2]=e[2]*s+t[2]*u+n[2]*h+r[2]*d,i}l(EW,"hermite");function IW(i,e,t,n,r,a){var o=1-a,s=o*o,u=a*a,h=s*o,d=3*a*s,f=3*u*o,m=u*a;return i[0]=e[0]*h+t[0]*d+n[0]*f+r[0]*m,i[1]=e[1]*h+t[1]*d+n[1]*f+r[1]*m,i[2]=e[2]*h+t[2]*d+n[2]*f+r[2]*m,i}l(IW,"bezier");function TW(i,e){e=e||1;var t=Qp()*2*Math.PI,n=Qp()*2-1,r=Math.sqrt(1-n*n)*e;return i[0]=Math.cos(t)*r,i[1]=Math.sin(t)*r,i[2]=n*e,i}l(TW,"random");function PW(i,e,t){var n=e[0],r=e[1],a=e[2],o=t[3]*n+t[7]*r+t[11]*a+t[15];return o=o||1,i[0]=(t[0]*n+t[4]*r+t[8]*a+t[12])/o,i[1]=(t[1]*n+t[5]*r+t[9]*a+t[13])/o,i[2]=(t[2]*n+t[6]*r+t[10]*a+t[14])/o,i}l(PW,"transformMat4");function LW(i,e,t){var n=e[0],r=e[1],a=e[2];return i[0]=n*t[0]+r*t[3]+a*t[6],i[1]=n*t[1]+r*t[4]+a*t[7],i[2]=n*t[2]+r*t[5]+a*t[8],i}l(LW,"transformMat3");function DW(i,e,t){var n=t[0],r=t[1],a=t[2],o=t[3],s=e[0],u=e[1],h=e[2],d=r*h-a*u,f=a*s-n*h,m=n*u-r*s,v=r*m-a*f,b=a*d-n*m,w=n*f-r*d,A=o*2;return d*=A,f*=A,m*=A,v*=2,b*=2,w*=2,i[0]=s+d+v,i[1]=u+f+b,i[2]=h+m+w,i}l(DW,"transformQuat");function kW(i,e,t,n){var r=[],a=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],a[0]=r[0],a[1]=r[1]*Math.cos(n)-r[2]*Math.sin(n),a[2]=r[1]*Math.sin(n)+r[2]*Math.cos(n),i[0]=a[0]+t[0],i[1]=a[1]+t[1],i[2]=a[2]+t[2],i}l(kW,"rotateX");function RW(i,e,t,n){var r=[],a=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],a[0]=r[2]*Math.sin(n)+r[0]*Math.cos(n),a[1]=r[1],a[2]=r[2]*Math.cos(n)-r[0]*Math.sin(n),i[0]=a[0]+t[0],i[1]=a[1]+t[1],i[2]=a[2]+t[2],i}l(RW,"rotateY");function OW(i,e,t,n){var r=[],a=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],a[0]=r[0]*Math.cos(n)-r[1]*Math.sin(n),a[1]=r[0]*Math.sin(n)+r[1]*Math.cos(n),a[2]=r[2],i[0]=a[0]+t[0],i[1]=a[1]+t[1],i[2]=a[2]+t[2],i}l(OW,"rotateZ");function NW(i,e){var t=i[0],n=i[1],r=i[2],a=e[0],o=e[1],s=e[2],u=Math.sqrt(t*t+n*n+r*r),h=Math.sqrt(a*a+o*o+s*s),d=u*h,f=d&&F4(i,e)/d;return Math.acos(Math.min(Math.max(f,-1),1))}l(NW,"angle");function FW(i){return i[0]=0,i[1]=0,i[2]=0,i}l(FW,"zero");function BW(i){return"vec3("+i[0]+", "+i[1]+", "+i[2]+")"}l(BW,"str");function zW(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]}l(zW,"exactEquals");function UW(i,e){var t=i[0],n=i[1],r=i[2],a=e[0],o=e[1],s=e[2];return Math.abs(t-a)<=Yi*Math.max(1,Math.abs(t),Math.abs(a))&&Math.abs(n-o)<=Yi*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-s)<=Yi*Math.max(1,Math.abs(r),Math.abs(s))}l(UW,"equals");var Aye=L4,Sye=D4,Mye=k4,Cye=R4,Eye=O4,Iye=P4,Tye=N4,Pye=function(){var i=T4();return function(e,t,n,r,a,o){var s,u;for(t||(t=3),n||(n=0),r?u=Math.min(r*t+n,e.length):u=e.length,s=n;s<u;s+=t)i[0]=e[s],i[1]=e[s+1],i[2]=e[s+2],a(i,i,o),e[s]=i[0],e[s+1]=i[1],e[s+2]=i[2];return e}}(),Mo={};xh(Mo,{add:()=>HW,ceil:()=>WW,clone:()=>VW,copy:()=>GW,create:()=>B4,cross:()=>nq,dist:()=>Rye,distance:()=>j4,div:()=>kye,divide:()=>V4,dot:()=>iq,equals:()=>cq,exactEquals:()=>hq,floor:()=>qW,forEach:()=>Bye,fromValues:()=>jW,inverse:()=>eq,len:()=>Nye,length:()=>$4,lerp:()=>rq,max:()=>ZW,min:()=>XW,mul:()=>Dye,multiply:()=>U4,negate:()=>QW,normalize:()=>tq,random:()=>aq,round:()=>YW,scale:()=>JW,scaleAndAdd:()=>KW,set:()=>$W,sqrDist:()=>Oye,sqrLen:()=>Fye,squaredDistance:()=>G4,squaredLength:()=>H4,str:()=>uq,sub:()=>Lye,subtract:()=>z4,transformMat4:()=>oq,transformQuat:()=>sq,zero:()=>lq});R();function B4(){var i=new hr(4);return hr!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0,i[3]=0),i}l(B4,"create");function VW(i){var e=new hr(4);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e}l(VW,"clone");function jW(i,e,t,n){var r=new hr(4);return r[0]=i,r[1]=e,r[2]=t,r[3]=n,r}l(jW,"fromValues");function GW(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i}l(GW,"copy");function $W(i,e,t,n,r){return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i}l($W,"set");function HW(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i}l(HW,"add");function z4(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i}l(z4,"subtract");function U4(i,e,t){return i[0]=e[0]*t[0],i[1]=e[1]*t[1],i[2]=e[2]*t[2],i[3]=e[3]*t[3],i}l(U4,"multiply");function V4(i,e,t){return i[0]=e[0]/t[0],i[1]=e[1]/t[1],i[2]=e[2]/t[2],i[3]=e[3]/t[3],i}l(V4,"divide");function WW(i,e){return i[0]=Math.ceil(e[0]),i[1]=Math.ceil(e[1]),i[2]=Math.ceil(e[2]),i[3]=Math.ceil(e[3]),i}l(WW,"ceil");function qW(i,e){return i[0]=Math.floor(e[0]),i[1]=Math.floor(e[1]),i[2]=Math.floor(e[2]),i[3]=Math.floor(e[3]),i}l(qW,"floor");function XW(i,e,t){return i[0]=Math.min(e[0],t[0]),i[1]=Math.min(e[1],t[1]),i[2]=Math.min(e[2],t[2]),i[3]=Math.min(e[3],t[3]),i}l(XW,"min");function ZW(i,e,t){return i[0]=Math.max(e[0],t[0]),i[1]=Math.max(e[1],t[1]),i[2]=Math.max(e[2],t[2]),i[3]=Math.max(e[3],t[3]),i}l(ZW,"max");function YW(i,e){return i[0]=Math.round(e[0]),i[1]=Math.round(e[1]),i[2]=Math.round(e[2]),i[3]=Math.round(e[3]),i}l(YW,"round");function JW(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i}l(JW,"scale");function KW(i,e,t,n){return i[0]=e[0]+t[0]*n,i[1]=e[1]+t[1]*n,i[2]=e[2]+t[2]*n,i[3]=e[3]+t[3]*n,i}l(KW,"scaleAndAdd");function j4(i,e){var t=e[0]-i[0],n=e[1]-i[1],r=e[2]-i[2],a=e[3]-i[3];return Math.hypot(t,n,r,a)}l(j4,"distance");function G4(i,e){var t=e[0]-i[0],n=e[1]-i[1],r=e[2]-i[2],a=e[3]-i[3];return t*t+n*n+r*r+a*a}l(G4,"squaredDistance");function $4(i){var e=i[0],t=i[1],n=i[2],r=i[3];return Math.hypot(e,t,n,r)}l($4,"length");function H4(i){var e=i[0],t=i[1],n=i[2],r=i[3];return e*e+t*t+n*n+r*r}l(H4,"squaredLength");function QW(i,e){return i[0]=-e[0],i[1]=-e[1],i[2]=-e[2],i[3]=-e[3],i}l(QW,"negate");function eq(i,e){return i[0]=1/e[0],i[1]=1/e[1],i[2]=1/e[2],i[3]=1/e[3],i}l(eq,"inverse");function tq(i,e){var t=e[0],n=e[1],r=e[2],a=e[3],o=t*t+n*n+r*r+a*a;return o>0&&(o=1/Math.sqrt(o)),i[0]=t*o,i[1]=n*o,i[2]=r*o,i[3]=a*o,i}l(tq,"normalize");function iq(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]+i[3]*e[3]}l(iq,"dot");function nq(i,e,t,n){var r=t[0]*n[1]-t[1]*n[0],a=t[0]*n[2]-t[2]*n[0],o=t[0]*n[3]-t[3]*n[0],s=t[1]*n[2]-t[2]*n[1],u=t[1]*n[3]-t[3]*n[1],h=t[2]*n[3]-t[3]*n[2],d=e[0],f=e[1],m=e[2],v=e[3];return i[0]=f*h-m*u+v*s,i[1]=-(d*h)+m*o-v*a,i[2]=d*u-f*o+v*r,i[3]=-(d*s)+f*a-m*r,i}l(nq,"cross");function rq(i,e,t,n){var r=e[0],a=e[1],o=e[2],s=e[3];return i[0]=r+n*(t[0]-r),i[1]=a+n*(t[1]-a),i[2]=o+n*(t[2]-o),i[3]=s+n*(t[3]-s),i}l(rq,"lerp");function aq(i,e){e=e||1;var t,n,r,a,o,s;do t=Qp()*2-1,n=Qp()*2-1,o=t*t+n*n;while(o>=1);do r=Qp()*2-1,a=Qp()*2-1,s=r*r+a*a;while(s>=1);var u=Math.sqrt((1-o)/s);return i[0]=e*t,i[1]=e*n,i[2]=e*r*u,i[3]=e*a*u,i}l(aq,"random");function oq(i,e,t){var n=e[0],r=e[1],a=e[2],o=e[3];return i[0]=t[0]*n+t[4]*r+t[8]*a+t[12]*o,i[1]=t[1]*n+t[5]*r+t[9]*a+t[13]*o,i[2]=t[2]*n+t[6]*r+t[10]*a+t[14]*o,i[3]=t[3]*n+t[7]*r+t[11]*a+t[15]*o,i}l(oq,"transformMat4");function sq(i,e,t){var n=e[0],r=e[1],a=e[2],o=t[0],s=t[1],u=t[2],h=t[3],d=h*n+s*a-u*r,f=h*r+u*n-o*a,m=h*a+o*r-s*n,v=-o*n-s*r-u*a;return i[0]=d*h+v*-o+f*-u-m*-s,i[1]=f*h+v*-s+m*-o-d*-u,i[2]=m*h+v*-u+d*-s-f*-o,i[3]=e[3],i}l(sq,"transformQuat");function lq(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=0,i}l(lq,"zero");function uq(i){return"vec4("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"}l(uq,"str");function hq(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]}l(hq,"exactEquals");function cq(i,e){var t=i[0],n=i[1],r=i[2],a=i[3],o=e[0],s=e[1],u=e[2],h=e[3];return Math.abs(t-o)<=Yi*Math.max(1,Math.abs(t),Math.abs(o))&&Math.abs(n-s)<=Yi*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-u)<=Yi*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(a-h)<=Yi*Math.max(1,Math.abs(a),Math.abs(h))}l(cq,"equals");var Lye=z4,Dye=U4,kye=V4,Rye=j4,Oye=G4,Nye=$4,Fye=H4,Bye=function(){var i=B4();return function(e,t,n,r,a,o){var s,u;for(t||(t=4),n||(n=0),r?u=Math.min(r*t+n,e.length):u=e.length,s=n;s<u;s+=t)i[0]=e[s],i[1]=e[s+1],i[2]=e[s+2],i[3]=e[s+3],a(i,i,o),e[s]=i[0],e[s+1]=i[1],e[s+2]=i[2],e[s+3]=i[3];return e}}(),W4={};xh(W4,{add:()=>gq,angle:()=>Nq,ceil:()=>yq,clone:()=>pq,copy:()=>fq,create:()=>q4,cross:()=>Iq,dist:()=>Gye,distance:()=>J4,div:()=>jye,divide:()=>Y4,dot:()=>Eq,equals:()=>Uq,exactEquals:()=>zq,floor:()=>vq,forEach:()=>Wye,fromValues:()=>dq,inverse:()=>Mq,len:()=>zye,length:()=>Q4,lerp:()=>Tq,max:()=>xq,min:()=>_q,mul:()=>Vye,multiply:()=>Z4,negate:()=>Sq,normalize:()=>Cq,random:()=>Pq,rotate:()=>Oq,round:()=>bq,scale:()=>wq,scaleAndAdd:()=>Aq,set:()=>mq,sqrDist:()=>$ye,sqrLen:()=>Hye,squaredDistance:()=>K4,squaredLength:()=>eL,str:()=>Bq,sub:()=>Uye,subtract:()=>X4,transformMat2:()=>Lq,transformMat2d:()=>Dq,transformMat3:()=>kq,transformMat4:()=>Rq,zero:()=>Fq});R();function q4(){var i=new hr(2);return hr!=Float32Array&&(i[0]=0,i[1]=0),i}l(q4,"create");function pq(i){var e=new hr(2);return e[0]=i[0],e[1]=i[1],e}l(pq,"clone");function dq(i,e){var t=new hr(2);return t[0]=i,t[1]=e,t}l(dq,"fromValues");function fq(i,e){return i[0]=e[0],i[1]=e[1],i}l(fq,"copy");function mq(i,e,t){return i[0]=e,i[1]=t,i}l(mq,"set");function gq(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i}l(gq,"add");function X4(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i}l(X4,"subtract");function Z4(i,e,t){return i[0]=e[0]*t[0],i[1]=e[1]*t[1],i}l(Z4,"multiply");function Y4(i,e,t){return i[0]=e[0]/t[0],i[1]=e[1]/t[1],i}l(Y4,"divide");function yq(i,e){return i[0]=Math.ceil(e[0]),i[1]=Math.ceil(e[1]),i}l(yq,"ceil");function vq(i,e){return i[0]=Math.floor(e[0]),i[1]=Math.floor(e[1]),i}l(vq,"floor");function _q(i,e,t){return i[0]=Math.min(e[0],t[0]),i[1]=Math.min(e[1],t[1]),i}l(_q,"min");function xq(i,e,t){return i[0]=Math.max(e[0],t[0]),i[1]=Math.max(e[1],t[1]),i}l(xq,"max");function bq(i,e){return i[0]=Math.round(e[0]),i[1]=Math.round(e[1]),i}l(bq,"round");function wq(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i}l(wq,"scale");function Aq(i,e,t,n){return i[0]=e[0]+t[0]*n,i[1]=e[1]+t[1]*n,i}l(Aq,"scaleAndAdd");function J4(i,e){var t=e[0]-i[0],n=e[1]-i[1];return Math.hypot(t,n)}l(J4,"distance");function K4(i,e){var t=e[0]-i[0],n=e[1]-i[1];return t*t+n*n}l(K4,"squaredDistance");function Q4(i){var e=i[0],t=i[1];return Math.hypot(e,t)}l(Q4,"length");function eL(i){var e=i[0],t=i[1];return e*e+t*t}l(eL,"squaredLength");function Sq(i,e){return i[0]=-e[0],i[1]=-e[1],i}l(Sq,"negate");function Mq(i,e){return i[0]=1/e[0],i[1]=1/e[1],i}l(Mq,"inverse");function Cq(i,e){var t=e[0],n=e[1],r=t*t+n*n;return r>0&&(r=1/Math.sqrt(r)),i[0]=e[0]*r,i[1]=e[1]*r,i}l(Cq,"normalize");function Eq(i,e){return i[0]*e[0]+i[1]*e[1]}l(Eq,"dot");function Iq(i,e,t){var n=e[0]*t[1]-e[1]*t[0];return i[0]=i[1]=0,i[2]=n,i}l(Iq,"cross");function Tq(i,e,t,n){var r=e[0],a=e[1];return i[0]=r+n*(t[0]-r),i[1]=a+n*(t[1]-a),i}l(Tq,"lerp");function Pq(i,e){e=e||1;var t=Qp()*2*Math.PI;return i[0]=Math.cos(t)*e,i[1]=Math.sin(t)*e,i}l(Pq,"random");function Lq(i,e,t){var n=e[0],r=e[1];return i[0]=t[0]*n+t[2]*r,i[1]=t[1]*n+t[3]*r,i}l(Lq,"transformMat2");function Dq(i,e,t){var n=e[0],r=e[1];return i[0]=t[0]*n+t[2]*r+t[4],i[1]=t[1]*n+t[3]*r+t[5],i}l(Dq,"transformMat2d");function kq(i,e,t){var n=e[0],r=e[1];return i[0]=t[0]*n+t[3]*r+t[6],i[1]=t[1]*n+t[4]*r+t[7],i}l(kq,"transformMat3");function Rq(i,e,t){var n=e[0],r=e[1];return i[0]=t[0]*n+t[4]*r+t[12],i[1]=t[1]*n+t[5]*r+t[13],i}l(Rq,"transformMat4");function Oq(i,e,t,n){var r=e[0]-t[0],a=e[1]-t[1],o=Math.sin(n),s=Math.cos(n);return i[0]=r*s-a*o+t[0],i[1]=r*o+a*s+t[1],i}l(Oq,"rotate");function Nq(i,e){var t=i[0],n=i[1],r=e[0],a=e[1],o=Math.sqrt(t*t+n*n)*Math.sqrt(r*r+a*a),s=o&&(t*r+n*a)/o;return Math.acos(Math.min(Math.max(s,-1),1))}l(Nq,"angle");function Fq(i){return i[0]=0,i[1]=0,i}l(Fq,"zero");function Bq(i){return"vec2("+i[0]+", "+i[1]+")"}l(Bq,"str");function zq(i,e){return i[0]===e[0]&&i[1]===e[1]}l(zq,"exactEquals");function Uq(i,e){var t=i[0],n=i[1],r=e[0],a=e[1];return Math.abs(t-r)<=Yi*Math.max(1,Math.abs(t),Math.abs(r))&&Math.abs(n-a)<=Yi*Math.max(1,Math.abs(n),Math.abs(a))}l(Uq,"equals");var zye=Q4,Uye=X4,Vye=Z4,jye=Y4,Gye=J4,$ye=K4,Hye=eL,Wye=function(){var i=q4();return function(e,t,n,r,a,o){var s,u;for(t||(t=2),n||(n=0),r?u=Math.min(r*t+n,e.length):u=e.length,s=n;s<u;s+=t)i[0]=e[s],i[1]=e[s+1],a(i,i,o),e[s]=i[0],e[s+1]=i[1];return e}}(),qye=ii(Rn(),1),Vq=class extends mu{constructor(e){super(e,fye)}createBucket(e){return new m4(e)}queryRadius(e){let t=e;return Wm("circle-radius",this,t)+Wm("circle-stroke-width",this,t)+u0(this.paint.get("circle-translate"))}queryIntersectsFeature(e,t,n,r,a,o,s,u){let h=h0(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,s),d=this.paint.get("circle-radius").evaluate(t,n),f=this.paint.get("circle-stroke-width").evaluate(t,n),m=d+f,v=this.paint.get("circle-pitch-alignment")==="map",b=v?h:jq(h,u),w=v?m*s:m;for(let A of r)for(let E of A){let I=v?E:tL(E,u),C=w,T=Mo.transformMat4([],[E.x,E.y,0,1],u);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?C*=T[3]/o.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(C*=o.cameraToCenterDistance/T[3]),x$(b,I,C))return!0}return!1}};l(Vq,"CircleStyleLayer");var Xye=Vq;function tL(i,e){let t=Mo.transformMat4([],[i.x,i.y,0,1],e);return new qye.default(t[0]/t[3],t[1]/t[3])}l(tL,"projectPoint");function jq(i,e){return i.map(t=>tL(t,e))}l(jq,"projectQueryGeometry");R();R();var Gq=class extends m4{};l(Gq,"HeatmapBucket");var $q=Gq;Zt("HeatmapBucket",$q,{omit:["layers"]});R();var Wk,Zye=l(()=>Wk=Wk||new Yo({"heatmap-radius":new Pi(ht.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Pi(ht.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new li(ht.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Z5(ht.paint_heatmap["heatmap-color"]),"heatmap-opacity":new li(ht.paint_heatmap["heatmap-opacity"])}),"getPaint"),Yye={get paint(){return Zye()}};R();R();function wA(i,{width:e,height:t},n,r){if(!r)r=new Uint8Array(e*t*n);else if(r instanceof Uint8ClampedArray)r=new Uint8Array(r.buffer);else if(r.length!==e*t*n)throw new RangeError("mismatched image size. expected: ".concat(r.length," but got: ").concat(e*t*n));return i.width=e,i.height=t,i.data=r,i}l(wA,"createImage");function iL(i,{width:e,height:t},n){if(e===i.width&&t===i.height)return;let r=wA({},{width:e,height:t},n);AA(i,r,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,e),height:Math.min(i.height,t)},n),i.width=e,i.height=t,i.data=r.data}l(iL,"resizeImage");function AA(i,e,t,n,r,a){if(r.width===0||r.height===0)return e;if(r.width>i.width||r.height>i.height||t.x>i.width-r.width||t.y>i.height-r.height)throw new RangeError("out of range source coordinates for image copy");if(r.width>e.width||r.height>e.height||n.x>e.width-r.width||n.y>e.height-r.height)throw new RangeError("out of range destination coordinates for image copy");let o=i.data,s=e.data;if(o===s)throw new Error("srcData equals dstData, so image is already copied");for(let u=0;u<r.height;u++){let h=((t.y+u)*i.width+t.x)*a,d=((n.y+u)*e.width+n.x)*a;for(let f=0;f<r.width*a;f++)s[d+f]=o[h+f]}return e}l(AA,"copyImage");var Hq=class Wq{constructor(e,t){wA(this,e,1,t)}resize(e){iL(this,e,1)}clone(){return new Wq({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,n,r,a){AA(e,t,n,r,a,1)}};l(Hq,"AlphaImage");var nL=Hq,qq=class Xq{constructor(e,t){wA(this,e,4,t)}resize(e){iL(this,e,4)}replace(e,t){t?this.data.set(e):e instanceof Uint8ClampedArray?this.data=new Uint8Array(e.buffer):this.data=e}clone(){return new Xq({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,n,r,a){AA(e,t,n,r,a,4)}};l(qq,"RGBAImage");var Or=qq;Zt("AlphaImage",nL);Zt("RGBAImage",Or);function rL(i){let e={},t=i.resolution||256,n=i.clips?i.clips.length:1,r=i.image||new Or({width:t,height:n});if(!KB(t))throw new Error("width is not a power of 2 - ".concat(t));let a=l((o,s,u)=>{e[i.evaluationKey]=u;let h=i.expression.evaluate(e);r.data[o+s+0]=Math.floor(h.r*255/h.a),r.data[o+s+1]=Math.floor(h.g*255/h.a),r.data[o+s+2]=Math.floor(h.b*255/h.a),r.data[o+s+3]=Math.floor(h.a*255)},"renderPixel");if(i.clips)for(let o=0,s=0;o<n;++o,s+=t*4)for(let u=0,h=0;u<t;u++,h+=4){let d=u/(t-1),{start:f,end:m}=i.clips[o],v=f*(1-d)+m*d;a(s,h,v)}else for(let o=0,s=0;o<t;o++,s+=4){let u=o/(t-1);a(0,s,u)}return r}l(rL,"renderColorRamp");var Zq=class extends mu{createBucket(e){return new $q(e)}constructor(e){super(e,Yye),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){let e=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=rL({expression:e,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}};l(Zq,"HeatmapStyleLayer");var Jye=Zq;R();R();var qk,Kye=l(()=>qk=qk||new Yo({"hillshade-illumination-direction":new li(ht.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new li(ht.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new li(ht.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new li(ht.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new li(ht.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new li(ht.paint_hillshade["hillshade-accent-color"])}),"getPaint"),Qye={get paint(){return Kye()}},Yq=class extends mu{constructor(e){super(e,Qye)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}};l(Yq,"HillshadeStyleLayer");var eve=Yq;R();R();R();var tve=Ir([{name:"a_pos",components:2,type:"Int16"}],4),{members:ive,size:FLe,alignment:BLe}=tve,nve=ii(QP(),1);R();R();function Jq(i,e,t,n,r){aL(i,e,t||0,n||i.length-1,r||Kq)}l(Jq,"quickselect");function aL(i,e,t,n,r){for(;n>t;){if(n-t>600){var a=n-t+1,o=e-t+1,s=Math.log(a),u=.5*Math.exp(2*s/3),h=.5*Math.sqrt(s*u*(a-u)/a)*(o-a/2<0?-1:1),d=Math.max(t,Math.floor(e-o*u/a+h)),f=Math.min(n,Math.floor(e+(a-o)*u/a+h));aL(i,e,d,f,r)}var m=i[e],v=t,b=n;for(vf(i,t,e),r(i[n],m)>0&&vf(i,t,n);v<b;){for(vf(i,v,b),v++,b--;r(i[v],m)<0;)v++;for(;r(i[b],m)>0;)b--}r(i[t],m)===0?vf(i,t,b):(b++,vf(i,b,n)),b<=e&&(t=b+1),e<=b&&(n=b-1)}}l(aL,"quickselectStep");function vf(i,e,t){var n=i[e];i[e]=i[t],i[t]=n}l(vf,"swap");function Kq(i,e){return i<e?-1:i>e?1:0}l(Kq,"defaultCompare");function oL(i,e){let t=i.length;if(t<=1)return[i];let n=[],r,a;for(let o=0;o<t;o++){let s=iz(i[o]);s!==0&&(i[o].area=Math.abs(s),a===void 0&&(a=s<0),a===s<0?(r&&n.push(r),r=[i[o]]):r.push(i[o]))}if(r&&n.push(r),e>1)for(let o=0;o<n.length;o++)n[o].length<=e||(Jq(n[o],e,1,n[o].length-1,Qq),n[o]=n[o].slice(0,e));return n}l(oL,"classifyRings");function Qq(i,e){return e.area-i.area}l(Qq,"compareAreas");R();function SA(i,e,t){let n=t.patternDependencies,r=!1;for(let a of e){let o=a.paint.get("".concat(i,"-pattern"));o.isConstant()||(r=!0);let s=o.constantOr(null);s&&(r=!0,n[s.to]=!0,n[s.from]=!0)}return r}l(SA,"hasPattern");function MA(i,e,t,n,r){let a=r.patternDependencies;for(let o of e){let s=o.paint.get("".concat(i,"-pattern")).value;if(s.kind!=="constant"){let u=s.evaluate({zoom:n-1},t,{},r.availableImages),h=s.evaluate({zoom:n},t,{},r.availableImages),d=s.evaluate({zoom:n+1},t,{},r.availableImages);u=u&&u.name?u.name:u,h=h&&h.name?h.name:h,d=d&&d.name?d.name:d,a[u]=!0,a[h]=!0,a[d]=!0,t.patterns[o.id]={min:u,mid:h,max:d}}}return t}l(MA,"addPatternDependencies");var rve=500,eX=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(t=>t.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Yge,this.indexArray=new kd,this.indexArray2=new C3,this.programConfigurations=new vd(e.layers,e.zoom),this.segments=new $r,this.segments2=new $r,this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(e,t,n){this.hasPattern=SA("fill",this.layers,t);let r=this.layers[0].layout.get("fill-sort-key"),a=!r.isConstant(),o=[];for(let{feature:s,id:u,index:h,sourceLayerIndex:d}of e){let f=this.layers[0]._featureFilter.needGeometry,m=qc(s,f);if(!this.layers[0]._featureFilter.filter(new fa(this.zoom),m,n))continue;let v=a?r.evaluate(m,{},n,t.availableImages):void 0,b={id:u,properties:s.properties,type:s.type,sourceLayerIndex:d,index:h,geometry:f?m.geometry:Wc(s),patterns:{},sortKey:v};o.push(b)}a&&o.sort((s,u)=>s.sortKey-u.sortKey);for(let s of o){let{geometry:u,index:h,sourceLayerIndex:d}=s;if(this.hasPattern){let m=MA("fill",this.layers,s,this.zoom,t);this.patternFeatures.push(m)}else this.addFeature(s,u,h,n,{});let f=e[h].feature;t.featureIndex.insert(f,u,h,d,this.index)}}update(e,t,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,n)}addFeatures(e,t,n){for(let r of this.patternFeatures)this.addFeature(r,r.geometry,r.index,t,n)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ive),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,t,n,r,a){for(let o of oL(t,rve)){let s=0;for(let v of o)s+=v.length;let u=this.segments.prepareSegment(s,this.layoutVertexArray,this.indexArray),h=u.vertexLength,d=[],f=[];for(let v of o){if(v.length===0)continue;v!==o[0]&&f.push(d.length/2);let b=this.segments2.prepareSegment(v.length,this.layoutVertexArray,this.indexArray2),w=b.vertexLength;this.layoutVertexArray.emplaceBack(v[0].x,v[0].y),this.indexArray2.emplaceBack(w+v.length-1,w),d.push(v[0].x),d.push(v[0].y);for(let A=1;A<v.length;A++)this.layoutVertexArray.emplaceBack(v[A].x,v[A].y),this.indexArray2.emplaceBack(w+A-1,w+A),d.push(v[A].x),d.push(v[A].y);b.vertexLength+=v.length,b.primitiveLength+=v.length}let m=(0,nve.default)(d,f);for(let v=0;v<m.length;v+=3)this.indexArray.emplaceBack(h+m[v],h+m[v+1],h+m[v+2]);u.vertexLength+=s,u.primitiveLength+=m.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,a,r)}};l(eX,"FillBucket");var tX=eX;Zt("FillBucket",tX,{omit:["layers","patternFeatures"]});R();var Xk,ave=l(()=>Xk=Xk||new Yo({"fill-sort-key":new Pi(ht.layout_fill["fill-sort-key"])}),"getLayout"),Zk,ove=l(()=>Zk=Zk||new Yo({"fill-antialias":new li(ht.paint_fill["fill-antialias"]),"fill-opacity":new Pi(ht.paint_fill["fill-opacity"]),"fill-color":new Pi(ht.paint_fill["fill-color"]),"fill-outline-color":new Pi(ht.paint_fill["fill-outline-color"]),"fill-translate":new li(ht.paint_fill["fill-translate"]),"fill-translate-anchor":new li(ht.paint_fill["fill-translate-anchor"]),"fill-pattern":new yA(ht.paint_fill["fill-pattern"])}),"getPaint"),sve={get paint(){return ove()},get layout(){return ave()}},iX=class extends mu{constructor(e){super(e,sve)}recalculate(e,t){super.recalculate(e,t);let n=this.paint._values["fill-outline-color"];n.value.kind==="constant"&&n.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new tX(e)}queryRadius(){return u0(this.paint.get("fill-translate"))}queryIntersectsFeature(e,t,n,r,a,o,s){let u=h0(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,s);return y4(u,r)}isTileClipped(){return!0}};l(iX,"FillStyleLayer");var lve=iX;R();R();R();var uve=Ir([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),hve=Ir([{name:"a_centroid",components:2,type:"Int16"}],4),{members:cve,size:VLe,alignment:jLe}=uve,pve=ii(QP(),1),dve=ii(Zw(),1),fve=dve.default.VectorTileFeature.types,mve=500,JS=Math.pow(2,13);function _f(i,e,t,n,r,a,o,s){i.emplaceBack(e,t,Math.floor(n*JS)*2+o,r*JS*2,a*JS*2,Math.round(s))}l(_f,"addVertex");var nX=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(t=>t.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Jge,this.centroidVertexArray=new hx,this.indexArray=new kd,this.programConfigurations=new vd(e.layers,e.zoom),this.segments=new $r,this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(e,t,n){this.features=[],this.hasPattern=SA("fill-extrusion",this.layers,t);for(let{feature:r,id:a,index:o,sourceLayerIndex:s}of e){let u=this.layers[0]._featureFilter.needGeometry,h=qc(r,u);if(!this.layers[0]._featureFilter.filter(new fa(this.zoom),h,n))continue;let d={id:a,sourceLayerIndex:s,index:o,geometry:u?h.geometry:Wc(r),properties:r.properties,type:r.type,patterns:{}};this.hasPattern?this.features.push(MA("fill-extrusion",this.layers,d,this.zoom,t)):this.addFeature(d,d.geometry,o,n,{}),t.featureIndex.insert(r,d.geometry,o,s,this.index,!0)}}addFeatures(e,t,n){for(let r of this.features){let{geometry:a}=r;this.addFeature(r,a,r.index,t,n)}}update(e,t,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,n)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,cve),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,hve.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,t,n,r,a){let o={x:0,y:0,vertexCount:0};for(let s of oL(t,mve)){let u=0;for(let b of s)u+=b.length;let h=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let b of s){if(b.length===0||oX(b))continue;let w=0;for(let A=0;A<b.length;A++){let E=b[A];if(A>=1){let I=b[A-1];if(!aX(E,I)){h.vertexLength+4>$r.MAX_VERTEX_ARRAY_LENGTH&&(h=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let C=E.sub(I)._perp()._unit(),T=I.dist(E);w+T>32768&&(w=0),_f(this.layoutVertexArray,E.x,E.y,C.x,C.y,0,0,w),_f(this.layoutVertexArray,E.x,E.y,C.x,C.y,0,1,w),o.x+=2*E.x,o.y+=2*E.y,o.vertexCount+=2,w+=T,_f(this.layoutVertexArray,I.x,I.y,C.x,C.y,0,0,w),_f(this.layoutVertexArray,I.x,I.y,C.x,C.y,0,1,w),o.x+=2*I.x,o.y+=2*I.y,o.vertexCount+=2;let k=h.vertexLength;this.indexArray.emplaceBack(k,k+2,k+1),this.indexArray.emplaceBack(k+1,k+2,k+3),h.vertexLength+=4,h.primitiveLength+=2}}}}if(h.vertexLength+u>$r.MAX_VERTEX_ARRAY_LENGTH&&(h=this.segments.prepareSegment(u,this.layoutVertexArray,this.indexArray)),fve[e.type]!=="Polygon")continue;let d=[],f=[],m=h.vertexLength;for(let b of s)if(b.length!==0){b!==s[0]&&f.push(d.length/2);for(let w=0;w<b.length;w++){let A=b[w];_f(this.layoutVertexArray,A.x,A.y,0,0,1,1,0),o.x+=A.x,o.y+=A.y,o.vertexCount+=1,d.push(A.x),d.push(A.y)}}let v=(0,pve.default)(d,f);for(let b=0;b<v.length;b+=3)this.indexArray.emplaceBack(m+v[b],m+v[b+2],m+v[b+1]);h.primitiveLength+=v.length/3,h.vertexLength+=u}for(let s=0;s<o.vertexCount;s++)this.centroidVertexArray.emplaceBack(Math.floor(o.x/o.vertexCount),Math.floor(o.y/o.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,a,r)}};l(nX,"FillExtrusionBucket");var rX=nX;Zt("FillExtrusionBucket",rX,{omit:["layers","features"]});function aX(i,e){return i.x===e.x&&(i.x<0||i.x>8192)||i.y===e.y&&(i.y<0||i.y>8192)}l(aX,"isBoundaryEdge");function oX(i){return i.every(e=>e.x<0)||i.every(e=>e.x>8192)||i.every(e=>e.y<0)||i.every(e=>e.y>8192)}l(oX,"isEntirelyOutside");R();var Yk,gve=l(()=>Yk=Yk||new Yo({"fill-extrusion-opacity":new li(ht["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Pi(ht["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new li(ht["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new li(ht["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new yA(ht["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Pi(ht["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Pi(ht["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new li(ht["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])}),"getPaint"),yve={get paint(){return gve()}},O3=ii(Rn(),1),sX=class extends mu{constructor(e){super(e,yve)}createBucket(e){return new rX(e)}queryRadius(){return u0(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(e,t,n,r,a,o,s,u){let h=h0(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,s),d=this.paint.get("fill-extrusion-height").evaluate(t,n),f=this.paint.get("fill-extrusion-base").evaluate(t,n),m=hX(h,u,o,0),v=uX(r,f,d,u),b=v[0],w=v[1];return lX(b,w,m)}};l(sX,"FillExtrusionStyleLayer");var vve=sX;function xf(i,e){return i.x*e.x+i.y*e.y}l(xf,"dot");function N3(i,e){if(i.length===1){let t=0,n=e[t++],r;for(;!r||n.equals(r);)if(r=e[t++],!r)return 1/0;for(;t<e.length;t++){let a=e[t],o=i[0],s=r.sub(n),u=a.sub(n),h=o.sub(n),d=xf(s,s),f=xf(s,u),m=xf(u,u),v=xf(h,s),b=xf(h,u),w=d*m-f*f,A=(m*v-f*b)/w,E=(d*b-f*v)/w,I=1-A-E,C=n.z*I+r.z*A+a.z*E;if(isFinite(C))return C}return 1/0}else{let t=1/0;for(let n of e)t=Math.min(t,n.z);return t}}l(N3,"getIntersectionDistance");function lX(i,e,t){let n=1/0;y4(t,e)&&(n=N3(t,e[0]));for(let r=0;r<e.length;r++){let a=e[r],o=i[r];for(let s=0;s<a.length-1;s++){let u=a[s],h=a[s+1],d=o[s],f=o[s+1],m=[u,h,f,d,u];g4(t,m)&&(n=Math.min(n,N3(t,m)))}}return n===1/0?!1:n}l(lX,"checkIntersection");function uX(i,e,t,n){let r=[],a=[],o=n[8]*e,s=n[9]*e,u=n[10]*e,h=n[11]*e,d=n[8]*t,f=n[9]*t,m=n[10]*t,v=n[11]*t;for(let b of i){let w=[],A=[];for(let E of b){let I=E.x,C=E.y,T=n[0]*I+n[4]*C+n[12],k=n[1]*I+n[5]*C+n[13],F=n[2]*I+n[6]*C+n[14],B=n[3]*I+n[7]*C+n[15],N=T+o,z=k+s,L=F+u,j=B+h,q=T+d,Z=k+f,O=F+m,Y=B+v,J=new O3.default(N/j,z/j);J.z=L/j,w.push(J);let oe=new O3.default(q/Y,Z/Y);oe.z=O/Y,A.push(oe)}r.push(w),a.push(A)}return[r,a]}l(uX,"projectExtrusion");function hX(i,e,t,n){let r=[];for(let a of i){let o=[a.x,a.y,n,1];Mo.transformMat4(o,o,e),r.push(new O3.default(o[0]/o[3],o[1]/o[3]))}return r}l(hX,"projectQueryGeometry");R();R();R();var _ve=Ir([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:xve,size:HLe,alignment:WLe}=_ve;R();var bve=Ir([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:wve,size:qLe,alignment:XLe}=bve,Ave=ii(Zw(),1),Sve=Ave.default.VectorTileFeature.types,Jk=63,Mve=Math.cos(75/2*(Math.PI/180)),Cve=15,Eve=20,Ive=15,cX=1/2,Kk=Math.pow(2,Ive-1)/cX,pX=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(t=>t.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(t=>{this.gradients[t.id]={}}),this.layoutVertexArray=new Kge,this.layoutVertexArray2=new Qge,this.indexArray=new kd,this.programConfigurations=new vd(e.layers,e.zoom),this.segments=new $r,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(e,t,n){this.hasPattern=SA("line",this.layers,t);let r=this.layers[0].layout.get("line-sort-key"),a=!r.isConstant(),o=[];for(let{feature:s,id:u,index:h,sourceLayerIndex:d}of e){let f=this.layers[0]._featureFilter.needGeometry,m=qc(s,f);if(!this.layers[0]._featureFilter.filter(new fa(this.zoom),m,n))continue;let v=a?r.evaluate(m,{},n):void 0,b={id:u,properties:s.properties,type:s.type,sourceLayerIndex:d,index:h,geometry:f?m.geometry:Wc(s),patterns:{},sortKey:v};o.push(b)}a&&o.sort((s,u)=>s.sortKey-u.sortKey);for(let s of o){let{geometry:u,index:h,sourceLayerIndex:d}=s;if(this.hasPattern){let m=MA("line",this.layers,s,this.zoom,t);this.patternFeatures.push(m)}else this.addFeature(s,u,h,n,{});let f=e[h].feature;t.featureIndex.insert(f,u,h,d,this.index)}}update(e,t,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,n)}addFeatures(e,t,n){for(let r of this.patternFeatures)this.addFeature(r,r.geometry,r.index,t,n)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,wve)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,xve),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end")){let t=+e.properties.mapbox_clip_start,n=+e.properties.mapbox_clip_end;return{start:t,end:n}}}addFeature(e,t,n,r,a){let o=this.layers[0].layout,s=o.get("line-join").evaluate(e,{}),u=o.get("line-cap"),h=o.get("line-miter-limit"),d=o.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(let f of t)this.addLine(f,e,s,u,h,d);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,a,r)}addLine(e,t,n,r,a,o){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let E=0;E<e.length-1;E++)this.totalDistance+=e[E].dist(e[E+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let s=Sve[t.type]==="Polygon",u=e.length;for(;u>=2&&e[u-1].equals(e[u-2]);)u--;let h=0;for(;h<u-1&&e[h].equals(e[h+1]);)h++;if(u<(s?3:2))return;n==="bevel"&&(a=1.05);let d=this.overscaling<=16?Cve*8192/(512*this.overscaling):0,f=this.segments.prepareSegment(u*10,this.layoutVertexArray,this.indexArray),m,v,b,w,A;this.e1=this.e2=-1,s&&(m=e[u-2],A=e[h].sub(m)._unit()._perp());for(let E=h;E<u;E++){if(b=E===u-1?s?e[h+1]:void 0:e[E+1],b&&e[E].equals(b))continue;A&&(w=A),m&&(v=m),m=e[E],A=b?b.sub(m)._unit()._perp():w,w=w||A;let I=w.add(A);(I.x!==0||I.y!==0)&&I._unit();let C=w.x*A.x+w.y*A.y,T=I.x*A.x+I.y*A.y,k=T!==0?1/T:1/0,F=2*Math.sqrt(2-2*T),B=T<Mve&&v&&b,N=w.x*A.y-w.y*A.x>0;if(B&&E>h){let j=m.dist(v);if(j>2*d){let q=m.sub(m.sub(v)._mult(d/j)._round());this.updateDistance(v,q),this.addCurrentVertex(q,w,0,0,f),v=q}}let z=v&&b,L=z?n:s?"butt":r;if(z&&L==="round"&&(k<o?L="miter":k<=2&&(L="fakeround")),L==="miter"&&k>a&&(L="bevel"),L==="bevel"&&(k>2&&(L="flipbevel"),k<a&&(L="miter")),v&&this.updateDistance(v,m),L==="miter")I._mult(k),this.addCurrentVertex(m,I,0,0,f);else if(L==="flipbevel"){if(k>100)I=A.mult(-1);else{let j=k*w.add(A).mag()/w.sub(A).mag();I._perp()._mult(j*(N?-1:1))}this.addCurrentVertex(m,I,0,0,f),this.addCurrentVertex(m,I.mult(-1),0,0,f)}else if(L==="bevel"||L==="fakeround"){let j=-Math.sqrt(k*k-1),q=N?j:0,Z=N?0:j;if(v&&this.addCurrentVertex(m,w,q,Z,f),L==="fakeround"){let O=Math.round(F*180/Math.PI/Eve);for(let Y=1;Y<O;Y++){let J=Y/O;if(J!==.5){let $=J-.5,K=1.0904+C*(-3.2452+C*(3.55645-C*1.43519)),te=.848013+C*(-1.06021+C*.215638);J=J+J*$*(J-1)*(K*$*$+te)}let oe=A.sub(w)._mult(J)._add(w)._unit()._mult(N?-1:1);this.addHalfVertex(m,oe.x,oe.y,!1,N,0,f)}}b&&this.addCurrentVertex(m,A,-q,-Z,f)}else if(L==="butt")this.addCurrentVertex(m,I,0,0,f);else if(L==="square"){let j=v?1:-1;this.addCurrentVertex(m,I,j,j,f)}else L==="round"&&(v&&(this.addCurrentVertex(m,w,0,0,f),this.addCurrentVertex(m,w,1,1,f,!0)),b&&(this.addCurrentVertex(m,A,-1,-1,f,!0),this.addCurrentVertex(m,A,0,0,f)));if(B&&E<u-1){let j=m.dist(b);if(j>2*d){let q=m.add(b.sub(m)._mult(d/j)._round());this.updateDistance(m,q),this.addCurrentVertex(q,A,0,0,f),m=q}}}}addCurrentVertex(e,t,n,r,a,o=!1){let s=t.x+t.y*n,u=t.y-t.x*n,h=-t.x+t.y*r,d=-t.y-t.x*r;this.addHalfVertex(e,s,u,o,!1,n,a),this.addHalfVertex(e,h,d,o,!0,-r,a),this.distance>Kk/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,t,n,r,a,o))}addHalfVertex({x:e,y:t},n,r,a,o,s,u){let h=(this.lineClips?this.scaledDistance*(Kk-1):this.scaledDistance)*cX;if(this.layoutVertexArray.emplaceBack((e<<1)+(a?1:0),(t<<1)+(o?1:0),Math.round(Jk*n)+128,Math.round(Jk*r)+128,(s===0?0:s<0?-1:1)+1|(h&63)<<2,h>>6),this.lineClips){let f=this.scaledDistance-this.lineClips.start,m=this.lineClips.end-this.lineClips.start,v=f/m;this.layoutVertexArray2.emplaceBack(v,this.lineClipsArray.length)}let d=u.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,d),u.primitiveLength++),o?this.e2=d:this.e1=d}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,t){this.distance+=e.dist(t),this.updateScaledDistance()}};l(pX,"LineBucket");var dX=pX;Zt("LineBucket",dX,{omit:["layers","patternFeatures"]});R();var Qk,Tve=l(()=>Qk=Qk||new Yo({"line-cap":new li(ht.layout_line["line-cap"]),"line-join":new Pi(ht.layout_line["line-join"]),"line-miter-limit":new li(ht.layout_line["line-miter-limit"]),"line-round-limit":new li(ht.layout_line["line-round-limit"]),"line-sort-key":new Pi(ht.layout_line["line-sort-key"])}),"getLayout"),eR,Pve=l(()=>eR=eR||new Yo({"line-opacity":new Pi(ht.paint_line["line-opacity"]),"line-color":new Pi(ht.paint_line["line-color"]),"line-translate":new li(ht.paint_line["line-translate"]),"line-translate-anchor":new li(ht.paint_line["line-translate-anchor"]),"line-width":new Pi(ht.paint_line["line-width"]),"line-gap-width":new Pi(ht.paint_line["line-gap-width"]),"line-offset":new Pi(ht.paint_line["line-offset"]),"line-blur":new Pi(ht.paint_line["line-blur"]),"line-dasharray":new X5(ht.paint_line["line-dasharray"]),"line-pattern":new yA(ht.paint_line["line-pattern"]),"line-gradient":new Z5(ht.paint_line["line-gradient"])}),"getPaint"),tR={get paint(){return Pve()},get layout(){return Tve()}},fX=class extends Pi{possiblyEvaluate(e,t){return t=new fa(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,zoomHistory:t.zoomHistory,transition:t.transition}),super.possiblyEvaluate(e,t)}evaluate(e,t,n,r){return t=ti({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(e,t,n,r)}};l(fX,"LineFloorwidthProperty");var Lve=fX,d_,mX=class extends mu{constructor(e){super(e,tR),this.gradientVersion=0,d_||(d_=new Lve(tR.paint.properties["line-width"].specification),d_.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){let t=this.gradientExpression();Ug(t)?this.stepInterpolant=t._styleExpression.expression instanceof y5:this.stepInterpolant=!1,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,t){super.recalculate(e,t),this.paint._values["line-floorwidth"]=d_.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new dX(e)}queryRadius(e){let t=e,n=F3(Wm("line-width",this,t),Wm("line-gap-width",this,t)),r=Wm("line-offset",this,t);return n/2+Math.abs(r)+u0(this.paint.get("line-translate"))}queryIntersectsFeature(e,t,n,r,a,o,s){let u=h0(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),o.angle,s),h=s/2*F3(this.paint.get("line-width").evaluate(t,n),this.paint.get("line-gap-width").evaluate(t,n)),d=this.paint.get("line-offset").evaluate(t,n);return d&&(r=E$(r,d*s)),b$(u,r,h)}isTileClipped(){return!0}};l(mX,"LineStyleLayer");var Dve=mX;function F3(i,e){return e>0?e+2*i:i}l(F3,"getLineWidth");R();R();R();var kve=Ir([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Rve=Ir([{name:"a_projected_pos",components:3,type:"Float32"}],4);Ir([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);var Ove=Ir([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Ir([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);var iR=Ir([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Nve=Ir([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Ir([{name:"triangle",components:3,type:"Uint16"}]);Ir([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]);Ir([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]);Ir([{type:"Float32",name:"offsetX"}]);Ir([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);Ir([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var f_=ii(Rn(),1);R();function gX(i,e,t){let n=e.layout.get("text-transform").evaluate(t,{});return n==="uppercase"?i=i.toLocaleUpperCase():n==="lowercase"&&(i=i.toLocaleLowerCase()),s1.applyArabicShaping&&(i=s1.applyArabicShaping(i)),i}l(gX,"transformTextInternal");function yX(i,e,t){return i.sections.forEach(n=>{n.text=gX(n.text,e,t)}),i}l(yX,"transformText");R();function vX(i){let e={},t={},n=[],r=0;function a(h){n.push(i[h]),r++}l(a,"add");function o(h,d,f){let m=t[h];return delete t[h],t[d]=m,n[m].geometry[0].pop(),n[m].geometry[0]=n[m].geometry[0].concat(f[0]),m}l(o,"mergeFromRight");function s(h,d,f){let m=e[d];return delete e[d],e[h]=m,n[m].geometry[0].shift(),n[m].geometry[0]=f[0].concat(n[m].geometry[0]),m}l(s,"mergeFromLeft");function u(h,d,f){let m=f?d[0][d[0].length-1]:d[0][0];return"".concat(h,":").concat(m.x,":").concat(m.y)}l(u,"getKey");for(let h=0;h<i.length;h++){let d=i[h],f=d.geometry,m=d.text?d.text.toString():null;if(!m){a(h);continue}let v=u(m,f),b=u(m,f,!0);if(v in t&&b in e&&t[v]!==e[b]){let w=s(v,b,f),A=o(v,b,n[w].geometry);delete e[v],delete t[b],t[u(m,n[A].geometry,!0)]=A,n[w].geometry=null}else v in t?o(v,b,f):b in e?s(v,b,f):(a(h),e[v]=r-1,t[b]=r-1)}return n.filter(h=>h.geometry)}l(vX,"mergeLines");R();R();var Fve={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};R();var _X=24;R();var Bve=ii(qB(),1),nR=3;function xX(i,e,t){i===1&&t.readMessage(bX,e)}l(xX,"readFontstacks");function bX(i,e,t){if(i===3){let{id:n,bitmap:r,width:a,height:o,left:s,top:u,advance:h}=t.readMessage(wX,{});e.push({id:n,bitmap:new nL({width:a+2*nR,height:o+2*nR},r),metrics:{width:a,height:o,left:s,top:u,advance:h}})}}l(bX,"readFontstack");function wX(i,e,t){i===1?e.id=t.readVarint():i===2?e.bitmap=t.readBytes():i===3?e.width=t.readVarint():i===4?e.height=t.readVarint():i===5?e.left=t.readSVarint():i===6?e.top=t.readSVarint():i===7&&(e.advance=t.readVarint())}l(wX,"readGlyph");function AX(i){return new Bve.default(i).readFields(xX,[])}l(AX,"parseGlyphPbf");R();R();function sL(i){let e=0,t=0;for(let o of i)e+=o.w*o.h,t=Math.max(t,o.w);i.sort((o,s)=>s.h-o.h);let n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),t),h:1/0}],r=0,a=0;for(let o of i)for(let s=n.length-1;s>=0;s--){let u=n[s];if(!(o.w>u.w||o.h>u.h)){if(o.x=u.x,o.y=u.y,a=Math.max(a,o.y+o.h),r=Math.max(r,o.x+o.w),o.w===u.w&&o.h===u.h){let h=n.pop();s<n.length&&(n[s]=h)}else o.h===u.h?(u.x+=o.w,u.w-=o.w):o.w===u.w?(u.y+=o.h,u.h-=o.h):(n.push({x:u.x+o.w,y:u.y,w:u.w-o.w,h:o.h}),u.y+=o.h,u.h-=o.h);break}}return{w:r,h:a,fill:e/(r*a)||0}}l(sL,"potpack");var Rs=1,SX=class{constructor(e,{pixelRatio:t,version:n,stretchX:r,stretchY:a,content:o}){this.paddedRect=e,this.pixelRatio=t,this.stretchX=r,this.stretchY=a,this.content=o,this.version=n}get tl(){return[this.paddedRect.x+Rs,this.paddedRect.y+Rs]}get br(){return[this.paddedRect.x+this.paddedRect.w-Rs,this.paddedRect.y+this.paddedRect.h-Rs]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-Rs*2)/this.pixelRatio,(this.paddedRect.h-Rs*2)/this.pixelRatio]}};l(SX,"ImagePosition");var lL=SX,MX=class{constructor(e,t){let n={},r={};this.haveRenderCallbacks=[];let a=[];this.addImages(e,n,a),this.addImages(t,r,a);let{w:o,h:s}=sL(a),u=new Or({width:o||1,height:s||1});for(let h in e){let d=e[h],f=n[h].paddedRect;Or.copy(d.data,u,{x:0,y:0},{x:f.x+Rs,y:f.y+Rs},d.data)}for(let h in t){let d=t[h],f=r[h].paddedRect,m=f.x+Rs,v=f.y+Rs,b=d.data.width,w=d.data.height;Or.copy(d.data,u,{x:0,y:0},{x:m,y:v},d.data),Or.copy(d.data,u,{x:0,y:w-1},{x:m,y:v-1},{width:b,height:1}),Or.copy(d.data,u,{x:0,y:0},{x:m,y:v+w},{width:b,height:1}),Or.copy(d.data,u,{x:b-1,y:0},{x:m-1,y:v},{width:1,height:w}),Or.copy(d.data,u,{x:0,y:0},{x:m+b,y:v},{width:1,height:w})}this.image=u,this.iconPositions=n,this.patternPositions=r}addImages(e,t,n){for(let r in e){let a=e[r],o={x:0,y:0,w:a.data.width+2*Rs,h:a.data.height+2*Rs};n.push(o),t[r]=new lL(o,a),a.hasRenderCallback&&this.haveRenderCallbacks.push(r)}}patchUpdatedImages(e,t){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let n in e.updatedImages)this.patchUpdatedImage(this.iconPositions[n],e.getImage(n),t),this.patchUpdatedImage(this.patternPositions[n],e.getImage(n),t)}patchUpdatedImage(e,t,n){if(!e||!t||e.version===t.version)return;e.version=t.version;let[r,a]=e.tl;n.update(t.data,void 0,{x:r,y:a})}};l(MX,"ImageAtlas");var zve=MX;Zt("ImagePosition",lL);Zt("ImageAtlas",zve);var CX=(i=>(i[i.none=0]="none",i[i.horizontal=1]="horizontal",i[i.vertical=2]="vertical",i[i.horizontalOnly=3]="horizontalOnly",i))(CX||{});function uL(i){let e=.5,t=.5;switch(i){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0;break}switch(i){case"bottom":case"bottom-right":case"bottom-left":t=1;break;case"top":case"top-right":case"top-left":t=0;break}return{horizontalAlign:e,verticalAlign:t}}l(uL,"getAnchorAlignment");var Uve=ii(Zw(),1);R();var Vve=255,cx=128,rR=Vve*cx;function B3(i,e){let{expression:t}=e;if(t.kind==="constant")return{kind:"constant",layoutSize:t.evaluate(new fa(i+1))};if(t.kind==="source")return{kind:"source"};{let{zoomStops:n,interpolationType:r}=t,a=0;for(;a<n.length&&n[a]<=i;)a++;a=Math.max(0,a-1);let o=a;for(;o<n.length&&n[o]<i+1;)o++;o=Math.min(n.length-1,o);let s=n[a],u=n[o];if(t.kind==="composite")return{kind:"composite",minZoom:s,maxZoom:u,interpolationType:r};let h=t.evaluate(new fa(s)),d=t.evaluate(new fa(u));return{kind:"camera",minZoom:s,maxZoom:u,minSize:h,maxSize:d,interpolationType:r}}}l(B3,"getSizeData");function CA(i,{uSize:e,uSizeT:t},{lowerSize:n,upperSize:r}){return i.kind==="source"?n/cx:i.kind==="composite"?Mr.number(n/cx,r/cx,t):e}l(CA,"evaluateSizeForFeature");function c0(i,e){let t=0,n=0;if(i.kind==="constant")n=i.layoutSize;else if(i.kind!=="source"){let{interpolationType:r,minZoom:a,maxZoom:o}=i,s=r?da(iu.interpolationFactor(r,e,a,o),0,1):0;i.kind==="camera"?n=Mr.number(i.minSize,i.maxSize,s):t=s}return{uSizeT:t,uSize:n}}l(c0,"evaluateSizeForZoom");R();function u1(i,e,t){let n="never",r=i.get(e);return r?n=r:i.get(t)&&(n="always"),n}l(u1,"getOverlapMode");var jve=Uve.default.VectorTileFeature.types,Gve=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Gy(i,e,t,n,r,a,o,s,u,h,d,f,m){let v=s?Math.min(rR,Math.round(s[0])):0,b=s?Math.min(rR,Math.round(s[1])):0;i.emplaceBack(e,t,Math.round(n*32),Math.round(r*32),a,o,(v<<1)+(u?1:0),b,h*16,d*16,f*256,m*256)}l(Gy,"addVertex");function yg(i,e,t){i.emplaceBack(e.x,e.y,t),i.emplaceBack(e.x,e.y,t),i.emplaceBack(e.x,e.y,t),i.emplaceBack(e.x,e.y,t)}l(yg,"addDynamicAttributes");function EX(i){for(let e of i.sections)if(mj(e.text))return!0;return!1}l(EX,"containsRTLText");var IX=class{constructor(e){this.layoutVertexArray=new eye,this.indexArray=new kd,this.programConfigurations=e,this.segments=new $r,this.dynamicLayoutVertexArray=new tye,this.opacityVertexArray=new iye,this.hasVisibleVertices=!1,this.placedSymbolArray=new fG}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,t,n,r){this.isEmpty()||(n&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,kve.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Rve.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Gve,!0),this.opacityVertexBuffer.itemSize=1),(n||r)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}};l(IX,"SymbolBuffers");var z3=IX;Zt("SymbolBuffers",z3);var TX=class{constructor(e,t,n){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new n,this.segments=new $r,this.collisionVertexArray=new rye}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Ove.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}};l(TX,"CollisionBuffers");var U3=TX;Zt("CollisionBuffers",U3);var PX=class{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(s=>s.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Qt.identity([]),this.placementViewportMatrix=Qt.identity([]);let t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=B3(this.zoom,t["text-size"]),this.iconSizeData=B3(this.zoom,t["icon-size"]);let n=this.layers[0].layout,r=n.get("symbol-sort-key"),a=n.get("symbol-z-order");this.canOverlap=u1(n,"text-overlap","text-allow-overlap")!=="never"||u1(n,"icon-overlap","icon-allow-overlap")!=="never"||n.get("text-ignore-placement")||n.get("icon-ignore-placement"),this.sortFeaturesByKey=a!=="viewport-y"&&!r.isConstant();let o=a==="viewport-y"||a==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=o&&this.canOverlap,n.get("symbol-placement")==="point"&&(this.writingModes=n.get("text-writing-mode").map(s=>CX[s])),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.sourceID=e.sourceID}createArrays(){this.text=new z3(new vd(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new z3(new vd(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new xG,this.lineVertexArray=new wG,this.symbolInstances=new vG,this.textAnchorOffsets=new CG}calculateGlyphDependencies(e,t,n,r,a){for(let o=0;o<e.length;o++)if(t[e.charCodeAt(o)]=!0,(n||r)&&a){let s=Fve[e.charAt(o)];s&&(t[s.charCodeAt(0)]=!0)}}populate(e,t,n){let r=this.layers[0],a=r.layout,o=a.get("text-font"),s=a.get("text-field"),u=a.get("icon-image"),h=(s.value.kind!=="constant"||s.value.value instanceof fh&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&(o.value.kind!=="constant"||o.value.value.length>0),d=u.value.kind!=="constant"||!!u.value.value||Object.keys(u.parameters).length>0,f=a.get("symbol-sort-key");if(this.features=[],!h&&!d)return;let m=t.iconDependencies,v=t.glyphDependencies,b=t.availableImages,w=new fa(this.zoom);for(let{feature:A,id:E,index:I,sourceLayerIndex:C}of e){let T=r._featureFilter.needGeometry,k=qc(A,T);if(!r._featureFilter.filter(w,k,n))continue;T||(k.geometry=Wc(A));let F;if(h){let L=r.getValueAndResolveTokens("text-field",k,n,b),j=fh.factory(L),q=this.hasRTLText=this.hasRTLText||EX(j);(!q||s1.getRTLTextPluginStatus()==="unavailable"||q&&s1.isParsed())&&(F=yX(j,r,k))}let B;if(d){let L=r.getValueAndResolveTokens("icon-image",k,n,b);L instanceof uu?B=L:B=uu.fromString(L)}if(!F&&!B)continue;let N=this.sortFeaturesByKey?f.evaluate(k,{},n):void 0,z={id:E,text:F,icon:B,index:I,sourceLayerIndex:C,geometry:k.geometry,properties:A.properties,type:jve[A.type],sortKey:N};if(this.features.push(z),B&&(m[B.name]=!0),F){let L=o.evaluate(k,{},n).join(","),j=a.get("text-rotation-alignment")!=="viewport"&&a.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(2)>=0;for(let q of F.sections)if(q.image)m[q.image.name]=!0;else{let Z=pj(F.toString()),O=q.fontStack||L,Y=v[O]=v[O]||{};this.calculateGlyphDependencies(q.text,Y,j,this.allowVerticalPlacement,Z)}}}a.get("symbol-placement")==="line"&&(this.features=vX(this.features)),this.sortFeaturesByKey&&this.features.sort((A,E)=>A.sortKey-E.sortKey)}update(e,t,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,n),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,n))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,t){let n=this.lineVertexArray.length;if(e.segment!==void 0){let r=e.dist(t[e.segment+1]),a=e.dist(t[e.segment]),o={};for(let s=e.segment+1;s<t.length;s++)o[s]={x:t[s].x,y:t[s].y,tileUnitDistanceFromAnchor:r},s<t.length-1&&(r+=t[s+1].dist(t[s]));for(let s=e.segment||0;s>=0;s--)o[s]={x:t[s].x,y:t[s].y,tileUnitDistanceFromAnchor:a},s>0&&(a+=t[s-1].dist(t[s]));for(let s=0;s<t.length;s++){let u=o[s];this.lineVertexArray.emplaceBack(u.x,u.y,u.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}addSymbols(e,t,n,r,a,o,s,u,h,d,f,m){let v=e.indexArray,b=e.layoutVertexArray,w=e.segments.prepareSegment(4*t.length,b,v,this.canOverlap?o.sortKey:void 0),A=this.glyphOffsetArray.length,E=w.vertexLength,I=this.allowVerticalPlacement&&s===2?Math.PI/2:0,C=o.text&&o.text.sections;for(let T=0;T<t.length;T++){let{tl:k,tr:F,bl:B,br:N,tex:z,pixelOffsetTL:L,pixelOffsetBR:j,minFontScaleX:q,minFontScaleY:Z,glyphOffset:O,isSDF:Y,sectionIndex:J}=t[T],oe=w.vertexLength,$=O[1];Gy(b,u.x,u.y,k.x,$+k.y,z.x,z.y,n,Y,L.x,L.y,q,Z),Gy(b,u.x,u.y,F.x,$+F.y,z.x+z.w,z.y,n,Y,j.x,L.y,q,Z),Gy(b,u.x,u.y,B.x,$+B.y,z.x,z.y+z.h,n,Y,L.x,j.y,q,Z),Gy(b,u.x,u.y,N.x,$+N.y,z.x+z.w,z.y+z.h,n,Y,j.x,j.y,q,Z),yg(e.dynamicLayoutVertexArray,u,I),v.emplaceBack(oe,oe+1,oe+2),v.emplaceBack(oe+1,oe+2,oe+3),w.vertexLength+=4,w.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(O[0]),(T===t.length-1||J!==t[T+1].sectionIndex)&&e.programConfigurations.populatePaintArrays(b.length,o,o.index,{},m,C&&C[J])}e.placedSymbolArray.emplaceBack(u.x,u.y,A,this.glyphOffsetArray.length-A,E,h,d,u.segment,n?n[0]:0,n?n[1]:0,r[0],r[1],s,0,!1,0,f)}_addCollisionDebugVertex(e,t,n,r,a,o){return t.emplaceBack(0,0),e.emplaceBack(n.x,n.y,r,a,Math.round(o.x),Math.round(o.y))}addCollisionDebugVertices(e,t,n,r,a,o,s){let u=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),h=u.vertexLength,d=a.layoutVertexArray,f=a.collisionVertexArray,m=s.anchorX,v=s.anchorY;this._addCollisionDebugVertex(d,f,o,m,v,new f_.default(e,t)),this._addCollisionDebugVertex(d,f,o,m,v,new f_.default(n,t)),this._addCollisionDebugVertex(d,f,o,m,v,new f_.default(n,r)),this._addCollisionDebugVertex(d,f,o,m,v,new f_.default(e,r)),u.vertexLength+=4;let b=a.indexArray;b.emplaceBack(h,h+1),b.emplaceBack(h+1,h+2),b.emplaceBack(h+2,h+3),b.emplaceBack(h+3,h),u.primitiveLength+=4}addDebugCollisionBoxes(e,t,n,r){for(let a=e;a<t;a++){let o=this.collisionBoxArray.get(a),s=o.x1,u=o.y1,h=o.x2,d=o.y2;this.addCollisionDebugVertices(s,u,h,d,r?this.textCollisionBox:this.iconCollisionBox,o.anchorPoint,n)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new U3(jk,iR.members,C3),this.iconCollisionBox=new U3(jk,iR.members,C3);for(let e=0;e<this.symbolInstances.length;e++){let t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}}_deserializeCollisionBoxesForSymbol(e,t,n,r,a,o,s,u,h){let d={};for(let f=t;f<n;f++){let m=e.get(f);d.textBox={x1:m.x1,y1:m.y1,x2:m.x2,y2:m.y2,anchorPointX:m.anchorPointX,anchorPointY:m.anchorPointY},d.textFeatureIndex=m.featureIndex;break}for(let f=r;f<a;f++){let m=e.get(f);d.verticalTextBox={x1:m.x1,y1:m.y1,x2:m.x2,y2:m.y2,anchorPointX:m.anchorPointX,anchorPointY:m.anchorPointY},d.verticalTextFeatureIndex=m.featureIndex;break}for(let f=o;f<s;f++){let m=e.get(f);d.iconBox={x1:m.x1,y1:m.y1,x2:m.x2,y2:m.y2,anchorPointX:m.anchorPointX,anchorPointY:m.anchorPointY},d.iconFeatureIndex=m.featureIndex;break}for(let f=u;f<h;f++){let m=e.get(f);d.verticalIconBox={x1:m.x1,y1:m.y1,x2:m.x2,y2:m.y2,anchorPointX:m.anchorPointX,anchorPointY:m.anchorPointY},d.verticalIconFeatureIndex=m.featureIndex;break}return d}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let t=0;t<this.symbolInstances.length;t++){let n=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,t){let n=e.placedSymbolArray.get(t),r=n.vertexStartIndex+n.numGlyphs*4;for(let a=n.vertexStartIndex;a<r;a+=4)e.indexArray.emplaceBack(a,a+1,a+2),e.indexArray.emplaceBack(a+1,a+2,a+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let t=Math.sin(e),n=Math.cos(e),r=[],a=[],o=[];for(let s=0;s<this.symbolInstances.length;++s){o.push(s);let u=this.symbolInstances.get(s);r.push(Math.round(t*u.anchorX+n*u.anchorY)|0),a.push(u.featureIndex)}return o.sort((s,u)=>r[s]-r[u]||a[u]-a[s]),o}addToSortKeyRanges(e,t){let n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===t?n.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let t of this.symbolInstanceIndexes){let n=this.symbolInstances.get(t);this.featureSortOrder.push(n.featureIndex),[n.rightJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.leftJustifiedTextSymbolIndex].forEach((r,a,o)=>{r>=0&&o.indexOf(r)===a&&this.addIndicesForPlacedSymbol(this.text,r)}),n.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,n.verticalPlacedTextSymbolIndex),n.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,n.placedIconSymbolIndex),n.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,n.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}};l(PX,"SymbolBucket");var vg=PX;Zt("SymbolBucket",vg,{omit:["layers","collisionBoxArray","features","compareText"]});vg.MAX_GLYPHS=65535;vg.addDynamicAttributes=yg;R();function LX(i,e){return e.replace(/{([^{}]+)}/g,(t,n)=>i&&n in i?String(i[n]):"")}l(LX,"resolveTokens");R();var aR,$ve=l(()=>aR=aR||new Yo({"symbol-placement":new li(ht.layout_symbol["symbol-placement"]),"symbol-spacing":new li(ht.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new li(ht.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Pi(ht.layout_symbol["symbol-sort-key"]),"symbol-z-order":new li(ht.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new li(ht.layout_symbol["icon-allow-overlap"]),"icon-overlap":new li(ht.layout_symbol["icon-overlap"]),"icon-ignore-placement":new li(ht.layout_symbol["icon-ignore-placement"]),"icon-optional":new li(ht.layout_symbol["icon-optional"]),"icon-rotation-alignment":new li(ht.layout_symbol["icon-rotation-alignment"]),"icon-size":new Pi(ht.layout_symbol["icon-size"]),"icon-text-fit":new li(ht.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new li(ht.layout_symbol["icon-text-fit-padding"]),"icon-image":new Pi(ht.layout_symbol["icon-image"]),"icon-rotate":new Pi(ht.layout_symbol["icon-rotate"]),"icon-padding":new Pi(ht.layout_symbol["icon-padding"]),"icon-keep-upright":new li(ht.layout_symbol["icon-keep-upright"]),"icon-offset":new Pi(ht.layout_symbol["icon-offset"]),"icon-anchor":new Pi(ht.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new li(ht.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new li(ht.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new li(ht.layout_symbol["text-rotation-alignment"]),"text-field":new Pi(ht.layout_symbol["text-field"]),"text-font":new Pi(ht.layout_symbol["text-font"]),"text-size":new Pi(ht.layout_symbol["text-size"]),"text-max-width":new Pi(ht.layout_symbol["text-max-width"]),"text-line-height":new li(ht.layout_symbol["text-line-height"]),"text-letter-spacing":new Pi(ht.layout_symbol["text-letter-spacing"]),"text-justify":new Pi(ht.layout_symbol["text-justify"]),"text-radial-offset":new Pi(ht.layout_symbol["text-radial-offset"]),"text-variable-anchor":new li(ht.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Pi(ht.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Pi(ht.layout_symbol["text-anchor"]),"text-max-angle":new li(ht.layout_symbol["text-max-angle"]),"text-writing-mode":new li(ht.layout_symbol["text-writing-mode"]),"text-rotate":new Pi(ht.layout_symbol["text-rotate"]),"text-padding":new li(ht.layout_symbol["text-padding"]),"text-keep-upright":new li(ht.layout_symbol["text-keep-upright"]),"text-transform":new Pi(ht.layout_symbol["text-transform"]),"text-offset":new Pi(ht.layout_symbol["text-offset"]),"text-allow-overlap":new li(ht.layout_symbol["text-allow-overlap"]),"text-overlap":new li(ht.layout_symbol["text-overlap"]),"text-ignore-placement":new li(ht.layout_symbol["text-ignore-placement"]),"text-optional":new li(ht.layout_symbol["text-optional"])}),"getLayout"),oR,Hve=l(()=>oR=oR||new Yo({"icon-opacity":new Pi(ht.paint_symbol["icon-opacity"]),"icon-color":new Pi(ht.paint_symbol["icon-color"]),"icon-halo-color":new Pi(ht.paint_symbol["icon-halo-color"]),"icon-halo-width":new Pi(ht.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Pi(ht.paint_symbol["icon-halo-blur"]),"icon-translate":new li(ht.paint_symbol["icon-translate"]),"icon-translate-anchor":new li(ht.paint_symbol["icon-translate-anchor"]),"text-opacity":new Pi(ht.paint_symbol["text-opacity"]),"text-color":new Pi(ht.paint_symbol["text-color"],{runtimeType:gl,getOverride:l(i=>i.textColor,"getOverride"),hasOverride:l(i=>!!i.textColor,"hasOverride")}),"text-halo-color":new Pi(ht.paint_symbol["text-halo-color"]),"text-halo-width":new Pi(ht.paint_symbol["text-halo-width"]),"text-halo-blur":new Pi(ht.paint_symbol["text-halo-blur"]),"text-translate":new li(ht.paint_symbol["text-translate"]),"text-translate-anchor":new li(ht.paint_symbol["text-translate-anchor"])}),"getPaint"),KS={get paint(){return Hve()},get layout(){return $ve()}};R();var DX=class{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:Q1,this.defaultValue=e}evaluate(e){if(e.formattedSection){let t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){if(!this.defaultValue.isConstant()){let t=this.defaultValue.value;e(t._styleExpression.expression)}}outputDefined(){return!1}serialize(){return null}};l(DX,"FormatSectionOverride");var kX=DX;Zt("FormatSectionOverride",kX,{omit:["defaultValue"]});var RX=class V3 extends mu{constructor(e){super(e,KS)}recalculate(e,t){if(super.recalculate(e,t),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){let n=this.layout.get("text-writing-mode");if(n){let r=[];for(let a of n)r.indexOf(a)<0&&r.push(a);this.layout._values["text-writing-mode"]=r}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,t,n,r){let a=this.layout.get(e).evaluate(t,{},n,r),o=this._unevaluatedLayout._values[e];return!o.isDataDriven()&&!Ug(o.value)&&a?LX(t.properties,a):a}createBucket(e){return new vg(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let e of KS.paint.overridableProperties){if(!V3.hasPaintOverride(this.layout,e))continue;let t=this.paint.get(e),n=new kX(t),r=new T5(n,t.property.specification),a=null;t.value.kind==="constant"||t.value.kind==="source"?a=new ew("source",r):a=new tw("composite",r,t.value.zoomStops),this.paint._values[e]=new ml(t.property,a,t.parameters)}}_handleOverridablePaintPropertyUpdate(e,t,n){return!this.layout||t.isDataDriven()||n.isDataDriven()?!1:V3.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,t){let n=e.get("text-field"),r=KS.paint.properties[t],a=!1,o=l(s=>{for(let u of s)if(r.overrides&&r.overrides.hasOverride(u)){a=!0;return}},"checkSections");if(n.value.kind==="constant"&&n.value.value instanceof fh)o(n.value.value.sections);else if(n.value.kind==="source"){let s=l(h=>{if(!a)if(h instanceof Qv&&Jr(h.value)===e0){let d=h.value;o(d.sections)}else h instanceof YU?o(h.sections):h.eachChild(s)},"checkExpression"),u=n.value;u._styleExpression&&s(u._styleExpression.expression)}return a}};l(RX,"SymbolStyleLayer");var Wve=RX;R();R();var sR,qve=l(()=>sR=sR||new Yo({"background-color":new li(ht.paint_background["background-color"]),"background-pattern":new X5(ht.paint_background["background-pattern"]),"background-opacity":new li(ht.paint_background["background-opacity"])}),"getPaint"),Xve={get paint(){return qve()}},OX=class extends mu{constructor(e){super(e,Xve)}};l(OX,"BackgroundStyleLayer");var Zve=OX;R();R();var lR,Yve=l(()=>lR=lR||new Yo({"raster-opacity":new li(ht.paint_raster["raster-opacity"]),"raster-hue-rotate":new li(ht.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new li(ht.paint_raster["raster-brightness-min"]),"raster-brightness-max":new li(ht.paint_raster["raster-brightness-max"]),"raster-saturation":new li(ht.paint_raster["raster-saturation"]),"raster-contrast":new li(ht.paint_raster["raster-contrast"]),"raster-resampling":new li(ht.paint_raster["raster-resampling"]),"raster-fade-duration":new li(ht.paint_raster["raster-fade-duration"])}),"getPaint"),Jve={get paint(){return Yve()}},NX=class extends mu{constructor(e){super(e,Jve)}};l(NX,"RasterStyleLayer");var Kve=NX;R();function FX(i){let e=[],t=i.id;return t===void 0&&e.push({message:"layers.".concat(t,': missing required property "id"')}),i.render===void 0&&e.push({message:"layers.".concat(t,': missing required method "render"')}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&e.push({message:"layers.".concat(t,': property "renderingMode" must be either "2d" or "3d"')}),e}l(FX,"validateCustomStyleLayer");var BX=class extends mu{constructor(e){super(e,{}),this.onAdd=l(t=>{this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)},"onAdd"),this.onRemove=l(t=>{this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)},"onRemove"),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}};l(BX,"CustomStyleLayer");var Qve=BX;function px(i){if(i.type==="custom")return new Qve(i);switch(i.type){case"background":return new Zve(i);case"circle":return new Xye(i);case"fill":return new lve(i);case"fill-extrusion":return new vve(i);case"heatmap":return new Jye(i);case"hillshade":return new eve(i);case"line":return new Dve(i);case"raster":return new Kve(i);case"symbol":return new Wve(i)}}l(px,"createStyleLayer");R();R();function Vv(i){let e=[];if(typeof i=="string")e.push({id:"default",url:i});else if(i&&i.length>0){let t=[];for(let{id:n,url:r}of i){let a="".concat(n).concat(r);t.indexOf(a)===-1&&(t.push(a),e.push({id:n,url:r}))}}return e}l(Vv,"coerceSpriteToArray");async function zX(i,e,t,n){let r=Vv(i),a=t>1?"@2x":"",o={},s={};for(let{id:u,url:h}of r){let d=e.transformRequest(e.normalizeSpriteURL(h,a,".json"),"SpriteJSON");o[u]=Qw(d,n);let f=e.transformRequest(e.normalizeSpriteURL(h,a,".png"),"SpriteImage");s[u]=tu.getImage(f,n)}return await Promise.all([...Object.values(o),...Object.values(s)]),UX(o,s)}l(zX,"loadSprite");async function UX(i,e){let t={};for(let n in i){t[n]={};let r=Mn.getImageCanvasContext((await e[n]).data),a=(await i[n]).data;for(let o in a){let{width:s,height:u,x:h,y:d,sdf:f,pixelRatio:m,stretchX:v,stretchY:b,content:w}=a[o],A={width:s,height:u,x:h,y:d,context:r};t[n][o]={data:null,pixelRatio:m,sdf:f,stretchX:v,stretchY:b,content:w,spriteData:A}}}return t}l(UX,"doOnceCompleted");R();R();var VX=class{constructor(e,t,n,r){this.context=e,this.format=n,this.texture=e.gl.createTexture(),this.update(t,r)}update(e,t,n){let{width:r,height:a}=e,o=(!this.size||this.size[0]!==r||this.size[1]!==a)&&!n,{context:s}=this,{gl:u}=s;if(this.useMipmap=!!(t&&t.useMipmap),u.bindTexture(u.TEXTURE_2D,this.texture),s.pixelStoreUnpackFlipY.set(!1),s.pixelStoreUnpack.set(1),s.pixelStoreUnpackPremultiplyAlpha.set(this.format===u.RGBA&&(!t||t.premultiply!==!1)),o)this.size=[r,a],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||eu(e)?u.texImage2D(u.TEXTURE_2D,0,this.format,this.format,u.UNSIGNED_BYTE,e):u.texImage2D(u.TEXTURE_2D,0,this.format,r,a,0,this.format,u.UNSIGNED_BYTE,e.data);else{let{x:h,y:d}=n||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||eu(e)?u.texSubImage2D(u.TEXTURE_2D,0,h,d,u.RGBA,u.UNSIGNED_BYTE,e):u.texSubImage2D(u.TEXTURE_2D,0,h,d,r,a,u.RGBA,u.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&u.generateMipmap(u.TEXTURE_2D)}bind(e,t,n){let{context:r}=this,{gl:a}=r;a.bindTexture(a.TEXTURE_2D,this.texture),n===a.LINEAR_MIPMAP_NEAREST&&!this.isSizePowerOfTwo()&&(n=a.LINEAR),e!==this.filter&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,e),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,n||e),this.filter=e),t!==this.wrap&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,t),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,t),this.wrap=t)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1===0}destroy(){let{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}};l(VX,"Texture");var Aa=VX;R();function jX(i){let{userImage:e}=i;return e&&e.render&&e.render()?(i.data.replace(new Uint8Array(e.data.buffer)),!0):!1}l(jX,"renderStyleImage");var m_=1,GX=class extends uo{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new Or({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(let{ids:t,promiseResolve:n}of this.requestors)n(this._getImagesForIds(t));this.requestors=[]}}getImage(e){let t=this.images[e];if(t&&!t.data&&t.spriteData){let n=t.spriteData;t.data=new Or({width:n.width,height:n.height},n.context.getImageData(n.x,n.y,n.width,n.height).data),t.spriteData=null}return t}addImage(e,t){if(this.images[e])throw new Error("Image id ".concat(e," already exist, use updateImage instead"));this._validate(e,t)&&(this.images[e]=t)}_validate(e,t){let n=!0,r=t.data||t.spriteData;return this._validateStretch(t.stretchX,r&&r.width)||(this.fire(new ki(new Error('Image "'.concat(e,'" has invalid "stretchX" value')))),n=!1),this._validateStretch(t.stretchY,r&&r.height)||(this.fire(new ki(new Error('Image "'.concat(e,'" has invalid "stretchY" value')))),n=!1),this._validateContent(t.content,t)||(this.fire(new ki(new Error('Image "'.concat(e,'" has invalid "content" value')))),n=!1),n}_validateStretch(e,t){if(!e)return!0;let n=0;for(let r of e){if(r[0]<n||r[1]<r[0]||t<r[1])return!1;n=r[1]}return!0}_validateContent(e,t){if(!e)return!0;if(e.length!==4)return!1;let n=t.spriteData,r=n&&n.width||t.data.width,a=n&&n.height||t.data.height;return!(e[0]<0||r<e[0]||e[1]<0||a<e[1]||e[2]<0||r<e[2]||e[3]<0||a<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,t,n=!0){let r=this.getImage(e);if(n&&(r.data.width!==t.data.width||r.data.height!==t.data.height))throw new Error("size mismatch between old image (".concat(r.data.width,"x").concat(r.data.height,") and new image (").concat(t.data.width,"x").concat(t.data.height,")."));t.version=r.version+1,this.images[e]=t,this.updatedImages[e]=!0}removeImage(e){let t=this.images[e];delete this.images[e],delete this.patterns[e],t.userImage&&t.userImage.onRemove&&t.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((t,n)=>{let r=!0;if(!this.isLoaded())for(let a of e)this.images[a]||(r=!1);this.isLoaded()||r?t(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:t})})}_getImagesForIds(e){let t={};for(let n of e){let r=this.getImage(n);r||(this.fire(new Tt("styleimagemissing",{id:n})),r=this.getImage(n)),r?t[n]={data:r.data.clone(),pixelRatio:r.pixelRatio,sdf:r.sdf,version:r.version,stretchX:r.stretchX,stretchY:r.stretchY,content:r.content,hasRenderCallback:!!(r.userImage&&r.userImage.render)}:lo('Image "'.concat(n,'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.'))}return t}getPixelSize(){let{width:e,height:t}=this.atlasImage;return{width:e,height:t}}getPattern(e){let t=this.patterns[e],n=this.getImage(e);if(!n)return null;if(t&&t.position.version===n.version)return t.position;if(t)t.position.version=n.version;else{let r=n.data.width+m_*2,a=n.data.height+m_*2,o={w:r,h:a,x:0,y:0},s=new lL(o,n);this.patterns[e]={bin:o,position:s}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){let t=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Aa(e,this.atlasImage,t.RGBA),this.atlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE)}_updatePatternAtlas(){let e=[];for(let a in this.patterns)e.push(this.patterns[a].bin);let{w:t,h:n}=sL(e),r=this.atlasImage;r.resize({width:t||1,height:n||1});for(let a in this.patterns){let{bin:o}=this.patterns[a],s=o.x+m_,u=o.y+m_,h=this.getImage(a).data,d=h.width,f=h.height;Or.copy(h,r,{x:0,y:0},{x:s,y:u},{width:d,height:f}),Or.copy(h,r,{x:0,y:f-1},{x:s,y:u-1},{width:d,height:1}),Or.copy(h,r,{x:0,y:0},{x:s,y:u+f},{width:d,height:1}),Or.copy(h,r,{x:d-1,y:0},{x:s-1,y:u},{width:1,height:f}),Or.copy(h,r,{x:0,y:0},{x:s+d,y:u},{width:1,height:f})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(let t of e){if(this.callbackDispatchedThisFrame[t])continue;this.callbackDispatchedThisFrame[t]=!0;let n=this.getImage(t);n||lo('Image with ID: "'.concat(t,'" was not found')),jX(n)&&this.updateImage(t,n)}}};l(GX,"ImageManager");var e1e=GX;R();R();async function $X(i,e,t,n){let r=e*256,a=r+255,o=n.transformRequest(t.replace("{fontstack}",i).replace("{range}","".concat(r,"-").concat(a)),"Glyphs"),s=await xme(o,new AbortController);if(!s||!s.data)throw new Error("Could not load glyph range. range: ".concat(e,", ").concat(r,"-").concat(a));let u={};for(let h of AX(s.data))u[h.id]=h;return u}l($X,"loadGlyphRange");R();var HX=class{constructor({fontSize:e=24,buffer:t=3,radius:n=8,cutoff:r=.25,fontFamily:a="sans-serif",fontWeight:o="normal",fontStyle:s="normal"}={}){this.buffer=t,this.cutoff=r,this.radius=n;let u=this.size=e+t*4,h=this._createCanvas(u),d=this.ctx=h.getContext("2d",{willReadFrequently:!0});d.font="".concat(s," ").concat(o," ").concat(e,"px ").concat(a),d.textBaseline="alphabetic",d.textAlign="left",d.fillStyle="black",this.gridOuter=new Float64Array(u*u),this.gridInner=new Float64Array(u*u),this.f=new Float64Array(u),this.z=new Float64Array(u+1),this.v=new Uint16Array(u)}_createCanvas(e){let t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){let{width:t,actualBoundingBoxAscent:n,actualBoundingBoxDescent:r,actualBoundingBoxLeft:a,actualBoundingBoxRight:o}=this.ctx.measureText(e),s=Math.ceil(n),u=0,h=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-a))),d=Math.min(this.size-this.buffer,s+Math.ceil(r)),f=h+2*this.buffer,m=d+2*this.buffer,v=Math.max(f*m,0),b=new Uint8ClampedArray(v),w={data:b,width:f,height:m,glyphWidth:h,glyphHeight:d,glyphTop:s,glyphLeft:u,glyphAdvance:t};if(h===0||d===0)return w;let{ctx:A,buffer:E,gridInner:I,gridOuter:C}=this;A.clearRect(E,E,h,d),A.fillText(e,E,E+s);let T=A.getImageData(E,E,h,d);C.fill(1e20,0,v),I.fill(0,0,v);for(let k=0;k<d;k++)for(let F=0;F<h;F++){let B=T.data[4*(k*h+F)+3]/255;if(B===0)continue;let N=(k+E)*f+F+E;if(B===1)C[N]=0,I[N]=1e20;else{let z=.5-B;C[N]=z>0?z*z:0,I[N]=z<0?z*z:0}}j3(C,0,0,f,m,f,this.f,this.v,this.z),j3(I,E,E,h,d,f,this.f,this.v,this.z);for(let k=0;k<v;k++){let F=Math.sqrt(C[k])-Math.sqrt(I[k]);b[k]=Math.round(255-255*(F/this.radius+this.cutoff))}return w}};l(HX,"TinySDF");var t1e=HX;function j3(i,e,t,n,r,a,o,s,u){for(let h=e;h<e+n;h++)G3(i,t*a+h,a,r,o,s,u);for(let h=t;h<t+r;h++)G3(i,h*a+e,1,n,o,s,u)}l(j3,"edt");function G3(i,e,t,n,r,a,o){a[0]=0,o[0]=-1e20,o[1]=1e20,r[0]=i[e];for(let s=1,u=0,h=0;s<n;s++){r[s]=i[e+s*t];let d=s*s;do{let f=a[u];h=(r[s]-r[f]+d-f*f)/(s-f)/2}while(h<=o[u]&&--u>-1);u++,a[u]=s,o[u]=h,o[u+1]=1e20}for(let s=0,u=0;s<n;s++){for(;o[u+1]<s;)u++;let h=a[u],d=s-h;i[e+s*t]=r[h]+d*d}}l(G3,"edt1d");var dx=class $3{constructor(e,t){this.requestManager=e,this.localIdeographFontFamily=t,this.entries={}}setURL(e){this.url=e}async getGlyphs(e){let t=[];for(let a in e)for(let o of e[a])t.push(this._getAndCacheGlyphsPromise(a,o));let n=await Promise.all(t),r={};for(let{stack:a,id:o,glyph:s}of n)r[a]||(r[a]={}),r[a][o]=s&&{id:s.id,bitmap:s.bitmap.clone(),metrics:s.metrics};return r}async _getAndCacheGlyphsPromise(e,t){let n=this.entries[e];n||(n=this.entries[e]={glyphs:{},requests:{},ranges:{}});let r=n.glyphs[t];if(r!==void 0)return{stack:e,id:t,glyph:r};if(r=this._tinySDF(n,e,t),r)return n.glyphs[t]=r,{stack:e,id:t,glyph:r};let a=Math.floor(t/256);if(a*256>65535)throw new Error("glyphs > 65535 not supported");if(n.ranges[a])return{stack:e,id:t,glyph:r};if(!this.url)throw new Error("glyphsUrl is not set");if(!n.requests[a]){let s=$3.loadGlyphRange(e,a,this.url,this.requestManager);n.requests[a]=s}let o=await n.requests[a];for(let s in o)this._doesCharSupportLocalGlyph(+s)||(n.glyphs[+s]=o[+s]);return n.ranges[a]=!0,{stack:e,id:t,glyph:o[t]||null}}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(bn["CJK Unified Ideographs"](e)||bn["Hangul Syllables"](e)||bn.Hiragana(e)||bn.Katakana(e))}_tinySDF(e,t,n){let r=this.localIdeographFontFamily;if(!r||!this._doesCharSupportLocalGlyph(n))return;let a=2,o=e.tinySDF;if(!o){let u="400";/bold/i.test(t)?u="900":/medium/i.test(t)?u="500":/light/i.test(t)&&(u="200"),o=e.tinySDF=new $3.TinySDF({fontSize:24*a,buffer:3*a,radius:8*a,cutoff:.25,fontFamily:r,fontWeight:u})}let s=o.draw(String.fromCharCode(n));return{id:n,bitmap:new nL({width:s.width||30*a,height:s.height||30*a},s.data),metrics:{width:s.glyphWidth/a||24,height:s.glyphHeight/a||24,left:s.glyphLeft/a+.5||0,top:s.glyphTop/a-27.5||-8,advance:s.glyphAdvance/a||24,isDoubleResolution:!0}}}};l(dx,"GlyphManager"),dx.loadGlyphRange=$X,dx.TinySDF=t1e;var i1e=dx;R();var WX=class{constructor(){this.specification=ht.light.position}possiblyEvaluate(e,t){return nz(e.expression.evaluate(t))}interpolate(e,t,n){return{x:Mr.number(e.x,t.x,n),y:Mr.number(e.y,t.y,n),z:Mr.number(e.z,t.z,n)}}};l(WX,"LightPositionProperty");var n1e=WX,uR="-transition",QS,qX=class extends uo{constructor(e){super(),QS=QS||new Yo({anchor:new li(ht.light.anchor),position:new n1e,color:new li(ht.light.color),intensity:new li(ht.light.intensity)}),this._transitionable=new wj(QS),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,t={}){if(!this._validate(zge,e,t))for(let n in e){let r=e[n];n.endsWith(uR)?this._transitionable.setTransition(n.slice(0,-uR.length),r):this._transitionable.setValue(n,r)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,t,n){return n&&n.validate===!1?!1:fA(this,e.call(wa,{value:t,style:{glyphs:!0,sprite:!0},styleSpec:ht}))}};l(qX,"Light");var r1e=qX;R();var XX=class{constructor(e,t){this.width=e,this.height=t,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,t){let n=e.join(",")+String(t);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(e,t)),this.dashEntry[n]}getDashRanges(e,t,n){let r=e.length%2===1,a=[],o=r?-e[e.length-1]*n:0,s=e[0]*n,u=!0;a.push({left:o,right:s,isDash:u,zeroLength:e[0]===0});let h=e[0];for(let d=1;d<e.length;d++){u=!u;let f=e[d];o=h*n,h+=f,s=h*n,a.push({left:o,right:s,isDash:u,zeroLength:f===0})}return a}addRoundDash(e,t,n){let r=t/2;for(let a=-n;a<=n;a++){let o=this.nextRow+n+a,s=this.width*o,u=0,h=e[u];for(let d=0;d<this.width;d++){d/h.right>1&&(h=e[++u]);let f=Math.abs(d-h.left),m=Math.abs(d-h.right),v=Math.min(f,m),b,w=a/n*(r+1);if(h.isDash){let A=r-Math.abs(w);b=Math.sqrt(v*v+A*A)}else b=r-Math.sqrt(v*v+w*w);this.data[s+d]=Math.max(0,Math.min(255,b+128))}}}addRegularDash(e){for(let s=e.length-1;s>=0;--s){let u=e[s],h=e[s+1];u.zeroLength?e.splice(s,1):h&&h.isDash===u.isDash&&(h.left=u.left,e.splice(s,1))}let t=e[0],n=e[e.length-1];t.isDash===n.isDash&&(t.left=n.left-this.width,n.right=t.right+this.width);let r=this.width*this.nextRow,a=0,o=e[a];for(let s=0;s<this.width;s++){s/o.right>1&&(o=e[++a]);let u=Math.abs(s-o.left),h=Math.abs(s-o.right),d=Math.min(u,h),f=o.isDash?d:-d;this.data[r+s]=Math.max(0,Math.min(255,f+128))}}addDash(e,t){let n=t?7:0,r=2*n+1;if(this.nextRow+r>this.height)return lo("LineAtlas out of space"),null;let a=0;for(let s=0;s<e.length;s++)a+=e[s];if(a!==0){let s=this.width/a,u=this.getDashRanges(e,this.width,s);t?this.addRoundDash(u,s,n):this.addRegularDash(u)}let o={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:a};return this.nextRow+=r,this.dirty=!0,o}bind(e){let t=e.gl;this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.ALPHA,t.UNSIGNED_BYTE,this.data))):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,this.width,this.height,0,t.ALPHA,t.UNSIGNED_BYTE,this.data))}};l(XX,"LineAtlas");var a1e=XX;R();R();R();var ZX=class{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}};l(ZX,"ThrottledInvoker");var o1e=ZX,YX=class{constructor(e,t){this.target=e,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new o1e(()=>this.process()),this.subscription=lz(this.target,"message",n=>this.receive(n),!1),this.globalScope=fd(self)?e:window}registerMessageHandler(e,t){this.messageHandlers[e]=t}sendAsync(e,t){return new Promise((n,r)=>{let a=Math.round(Math.random()*1e18).toString(36).substring(0,10);this.resolveRejects[a]={resolve:n,reject:r},t&&t.signal.addEventListener("abort",()=>{delete this.resolveRejects[a];let u={id:a,type:"<cancel>",origin:location.origin,targetMapId:e.targetMapId,sourceMapId:this.mapId};this.target.postMessage(u)},{once:!0});let o=[],s=lt(Me({},e),{id:a,sourceMapId:this.mapId,origin:location.origin,data:Gm(e.data,o)});this.target.postMessage(s,{transfer:o})})}receive(e){let t=e.data,n=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!==location.origin)&&!(t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[n];let r=this.abortControllers[n];delete this.abortControllers[n],r&&r.abort();return}if(fd(self)||t.mustQueue){this.tasks[n]=t,this.taskQueue.push(n),this.invoker.trigger();return}this.processTask(n,t)}}process(){if(this.taskQueue.length===0)return;let e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(e,t)}async processTask(e,t){if(t.type==="<response>"){let a=this.resolveRejects[e];if(delete this.resolveRejects[e],!a)return;t.error?a.reject($m(t.error)):a.resolve($m(t.data));return}if(!this.messageHandlers[t.type]){this.completeTask(e,new Error("Could not find a registered handler for ".concat(t.type,", map ID: ").concat(this.mapId,", available handlers: ").concat(Object.keys(this.messageHandlers).join(", "))));return}let n=$m(t.data),r=new AbortController;this.abortControllers[e]=r;try{let a=await this.messageHandlers[t.type](t.sourceMapId,n,r);this.completeTask(e,null,a)}catch(a){this.completeTask(e,a)}}completeTask(e,t,n){let r=[];delete this.abortControllers[e];let a={id:e,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?Gm(t):null,data:Gm(n,r)};this.target.postMessage(a,{transfer:r})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}};l(YX,"Actor");var s1e=YX;R();R();R();R();var l1e=`(()=>{var _y=Object.create;var Ti=Object.defineProperty,Iy=Object.defineProperties,Ty=Object.getOwnPropertyDescriptor,Cy=Object.getOwnPropertyDescriptors,ky=Object.getOwnPropertyNames,Bl=Object.getOwnPropertySymbols,My=Object.getPrototypeOf,Rl=Object.prototype.hasOwnProperty,Ey=Object.prototype.propertyIsEnumerable;var zl=(t,e,r)=>e in t?Ti(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Dt=(t,e)=>{for(var r in e||(e={}))Rl.call(e,r)&&zl(t,r,e[r]);if(Bl)for(var r of Bl(e))Ey.call(e,r)&&zl(t,r,e[r]);return t},Ci=(t,e)=>Iy(t,Cy(e));var Ae=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Ol=(t,e)=>{for(var r in e)Ti(t,r,{get:e[r],enumerable:!0})},Fy=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of ky(e))!Rl.call(t,i)&&i!==r&&Ti(t,i,{get:()=>e[i],enumerable:!(n=Ty(e,i))||n.enumerable});return t};var Z=(t,e,r)=>(r=t!=null?_y(My(t)):{},Fy(e||!t||!t.__esModule?Ti(r,"default",{value:t,enumerable:!0}):r,t));var he=Ae((d0,Nl)=>{"use strict";Nl.exports=sr;function sr(t,e){this.x=t,this.y=e}sr.prototype={clone:function(){return new sr(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,r=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),n=e*this.x-r*this.y,i=r*this.x+e*this.y;return this.x=n,this.y=i,this},_rotateAround:function(t,e){var r=Math.cos(t),n=Math.sin(t),i=e.x+r*(this.x-e.x)-n*(this.y-e.y),o=e.y+n*(this.x-e.x)+r*(this.y-e.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}};sr.convert=function(t){return t instanceof sr?t:Array.isArray(t)?new sr(t[0],t[1]):t}});var Gl=Ae((g0,$l)=>{"use strict";$l.exports=Ul;function Ul(t,e,r,n){this.cx=3*t,this.bx=3*(r-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=r,this.p2y=n}Ul.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(e===void 0&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var r=t,n=0;n<8;n++){var i=this.sampleCurveX(r)-t;if(Math.abs(i)<e)return r;var o=this.sampleCurveDerivativeX(r);if(Math.abs(o)<1e-6)break;r=r-i/o}var a=0,s=1;for(r=t,n=0;n<20&&(i=this.sampleCurveX(r),!(Math.abs(i-t)<e));n++)t>i?a=r:s=r,r=(s-a)*.5+a;return r},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}}});var Mc=Ae((Yv,Ts)=>{function hd(t,e){var r,n,i,o,a,s,l,u,c,p;for(r=t.length&3,n=t.length-r,i=e,a=3432918353,l=461845907,p=0;p<n;)c=t.charCodeAt(p)&255|(t.charCodeAt(++p)&255)<<8|(t.charCodeAt(++p)&255)<<16|(t.charCodeAt(++p)&255)<<24,++p,c=(c&65535)*a+(((c>>>16)*a&65535)<<16)&4294967295,c=c<<15|c>>>17,c=(c&65535)*l+(((c>>>16)*l&65535)<<16)&4294967295,i^=c,i=i<<13|i>>>19,o=(i&65535)*5+(((i>>>16)*5&65535)<<16)&4294967295,i=(o&65535)+27492+(((o>>>16)+58964&65535)<<16);switch(c=0,r){case 3:c^=(t.charCodeAt(p+2)&255)<<16;case 2:c^=(t.charCodeAt(p+1)&255)<<8;case 1:c^=t.charCodeAt(p)&255,c=(c&65535)*a+(((c>>>16)*a&65535)<<16)&4294967295,c=c<<15|c>>>17,c=(c&65535)*l+(((c>>>16)*l&65535)<<16)&4294967295,i^=c}return i^=t.length,i^=i>>>16,i=(i&65535)*2246822507+(((i>>>16)*2246822507&65535)<<16)&4294967295,i^=i>>>13,i=(i&65535)*3266489909+(((i>>>16)*3266489909&65535)<<16)&4294967295,i^=i>>>16,i>>>0}typeof Ts<"u"&&(Ts.exports=hd)});var Ec=Ae((Qv,Cs)=>{function dd(t,e){for(var r=t.length,n=e^r,i=0,o;r>=4;)o=t.charCodeAt(i)&255|(t.charCodeAt(++i)&255)<<8|(t.charCodeAt(++i)&255)<<16|(t.charCodeAt(++i)&255)<<24,o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16),o^=o>>>24,o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16),n=(n&65535)*1540483477+(((n>>>16)*1540483477&65535)<<16)^o,r-=4,++i;switch(r){case 3:n^=(t.charCodeAt(i+2)&255)<<16;case 2:n^=(t.charCodeAt(i+1)&255)<<8;case 1:n^=t.charCodeAt(i)&255,n=(n&65535)*1540483477+(((n>>>16)*1540483477&65535)<<16)}return n^=n>>>13,n=(n&65535)*1540483477+(((n>>>16)*1540483477&65535)<<16),n^=n>>>15,n>>>0}typeof Cs!==void 0&&(Cs.exports=dd)});var ks=Ae((e1,Lo)=>{var Fc=Mc(),gd=Ec();Lo.exports=Fc;Lo.exports.murmur3=Fc;Lo.exports.murmur2=gd});var $s=Ae((JP,Us)=>{"use strict";Us.exports=Jo;Us.exports.default=Jo;function Jo(t,e,r){r=r||2;var n=e&&e.length,i=n?e[0]*r:t.length,o=xp(t,0,i,r,!0),a=[];if(!o||o.next===o.prev)return a;var s,l,u,c,p,f,y;if(n&&(o=nx(t,e,o,r)),t.length>80*r){s=u=t[0],l=c=t[1];for(var m=r;m<i;m+=r)p=t[m],f=t[m+1],p<s&&(s=p),f<l&&(l=f),p>u&&(u=p),f>c&&(c=f);y=Math.max(u-s,c-l),y=y!==0?32767/y:0}return Wn(o,a,r,s,l,y,0),a}function xp(t,e,r,n,i){var o,a;if(i===Ns(t,e,r,n)>0)for(o=e;o<r;o+=n)a=gp(o,t[o],t[o+1],a);else for(o=r-n;o>=e;o-=n)a=gp(o,t[o],t[o+1],a);return a&&Zo(a,a.next)&&(Xn(a),a=a.next),a}function tr(t,e){if(!t)return t;e||(e=t);var r=t,n;do if(n=!1,!r.steiner&&(Zo(r,r.next)||oe(r.prev,r,r.next)===0)){if(Xn(r),r=e=r.prev,r===r.next)break;n=!0}else r=r.next;while(n||r!==e);return e}function Wn(t,e,r,n,i,o,a){if(t){!a&&o&&lx(t,n,i,o);for(var s=t,l,u;t.prev!==t.next;){if(l=t.prev,u=t.next,o?ex(t,n,i,o):Qg(t)){e.push(l.i/r|0),e.push(t.i/r|0),e.push(u.i/r|0),Xn(t),t=u.next,s=u.next;continue}if(t=u,t===s){a?a===1?(t=tx(tr(t),e,r),Wn(t,e,r,n,i,o,2)):a===2&&rx(t,e,r,n,i,o):Wn(tr(t),e,r,n,i,o,1);break}}}}function Qg(t){var e=t.prev,r=t,n=t.next;if(oe(e,r,n)>=0)return!1;for(var i=e.x,o=r.x,a=n.x,s=e.y,l=r.y,u=n.y,c=i<o?i<a?i:a:o<a?o:a,p=s<l?s<u?s:u:l<u?l:u,f=i>o?i>a?i:a:o>a?o:a,y=s>l?s>u?s:u:l>u?l:u,m=n.next;m!==e;){if(m.x>=c&&m.x<=f&&m.y>=p&&m.y<=y&&Ir(i,s,o,l,a,u,m.x,m.y)&&oe(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function ex(t,e,r,n){var i=t.prev,o=t,a=t.next;if(oe(i,o,a)>=0)return!1;for(var s=i.x,l=o.x,u=a.x,c=i.y,p=o.y,f=a.y,y=s<l?s<u?s:u:l<u?l:u,m=c<p?c<f?c:f:p<f?p:f,h=s>l?s>u?s:u:l>u?l:u,d=c>p?c>f?c:f:p>f?p:f,g=Rs(y,m,e,r,n),b=Rs(h,d,e,r,n),x=t.prevZ,v=t.nextZ;x&&x.z>=g&&v&&v.z<=b;){if(x.x>=y&&x.x<=h&&x.y>=m&&x.y<=d&&x!==i&&x!==a&&Ir(s,c,l,p,u,f,x.x,x.y)&&oe(x.prev,x,x.next)>=0||(x=x.prevZ,v.x>=y&&v.x<=h&&v.y>=m&&v.y<=d&&v!==i&&v!==a&&Ir(s,c,l,p,u,f,v.x,v.y)&&oe(v.prev,v,v.next)>=0))return!1;v=v.nextZ}for(;x&&x.z>=g;){if(x.x>=y&&x.x<=h&&x.y>=m&&x.y<=d&&x!==i&&x!==a&&Ir(s,c,l,p,u,f,x.x,x.y)&&oe(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;v&&v.z<=b;){if(v.x>=y&&v.x<=h&&v.y>=m&&v.y<=d&&v!==i&&v!==a&&Ir(s,c,l,p,u,f,v.x,v.y)&&oe(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function tx(t,e,r){var n=t;do{var i=n.prev,o=n.next.next;!Zo(i,o)&&bp(i,n,n.next,o)&&Hn(i,o)&&Hn(o,i)&&(e.push(i.i/r|0),e.push(n.i/r|0),e.push(o.i/r|0),Xn(n),Xn(n.next),n=t=o),n=n.next}while(n!==t);return tr(n)}function rx(t,e,r,n,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&px(a,s)){var l=vp(a,s);a=tr(a,a.next),l=tr(l,l.next),Wn(a,e,r,n,i,o,0),Wn(l,e,r,n,i,o,0);return}s=s.next}a=a.next}while(a!==t)}function nx(t,e,r,n){var i=[],o,a,s,l,u;for(o=0,a=e.length;o<a;o++)s=e[o]*n,l=o<a-1?e[o+1]*n:t.length,u=xp(t,s,l,n,!1),u===u.next&&(u.steiner=!0),i.push(cx(u));for(i.sort(ix),o=0;o<i.length;o++)r=ox(i[o],r);return r}function ix(t,e){return t.x-e.x}function ox(t,e){var r=ax(t,e);if(!r)return e;var n=vp(r,t);return tr(n,n.next),tr(r,r.next)}function ax(t,e){var r=e,n=t.x,i=t.y,o=-1/0,a;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var s=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=n&&s>o&&(o=s,a=r.x<r.next.x?r:r.next,s===n))return a}r=r.next}while(r!==e);if(!a)return null;var l=a,u=a.x,c=a.y,p=1/0,f;r=a;do n>=r.x&&r.x>=u&&n!==r.x&&Ir(i<c?n:o,i,u,c,i<c?o:n,i,r.x,r.y)&&(f=Math.abs(i-r.y)/(n-r.x),Hn(r,t)&&(f<p||f===p&&(r.x>a.x||r.x===a.x&&sx(a,r)))&&(a=r,p=f)),r=r.next;while(r!==l);return a}function sx(t,e){return oe(t.prev,t,e.prev)<0&&oe(e.next,t,t.next)<0}function lx(t,e,r,n){var i=t;do i.z===0&&(i.z=Rs(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,ux(i)}function ux(t){var e,r,n,i,o,a,s,l,u=1;do{for(r=t,t=null,o=null,a=0;r;){for(a++,n=r,s=0,e=0;e<u&&(s++,n=n.nextZ,!!n);e++);for(l=u;s>0||l>0&&n;)s!==0&&(l===0||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,l--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;r=n}o.nextZ=null,u*=2}while(a>1);return t}function Rs(t,e,r,n,i){return t=(t-r)*i|0,e=(e-n)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function cx(t){var e=t,r=t;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==t);return r}function Ir(t,e,r,n,i,o,a,s){return(i-a)*(e-s)>=(t-a)*(o-s)&&(t-a)*(n-s)>=(r-a)*(e-s)&&(r-a)*(o-s)>=(i-a)*(n-s)}function px(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!fx(t,e)&&(Hn(t,e)&&Hn(e,t)&&yx(t,e)&&(oe(t.prev,t,e.prev)||oe(t,e.prev,e))||Zo(t,e)&&oe(t.prev,t,t.next)>0&&oe(e.prev,e,e.next)>0)}function oe(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Zo(t,e){return t.x===e.x&&t.y===e.y}function bp(t,e,r,n){var i=jo(oe(t,e,r)),o=jo(oe(t,e,n)),a=jo(oe(r,n,t)),s=jo(oe(r,n,e));return!!(i!==o&&a!==s||i===0&&qo(t,r,e)||o===0&&qo(t,n,e)||a===0&&qo(r,t,n)||s===0&&qo(r,e,n))}function qo(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function jo(t){return t>0?1:t<0?-1:0}function fx(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&bp(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}function Hn(t,e){return oe(t.prev,t,t.next)<0?oe(t,e,t.next)>=0&&oe(t,t.prev,e)>=0:oe(t,e,t.prev)<0||oe(t,t.next,e)<0}function yx(t,e){var r=t,n=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==t);return n}function vp(t,e){var r=new Os(t.i,t.x,t.y),n=new Os(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function gp(t,e,r,n){var i=new Os(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Xn(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Os(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Jo.deviation=function(t,e,r,n){var i=e&&e.length,o=i?e[0]*r:t.length,a=Math.abs(Ns(t,0,o,r));if(i)for(var s=0,l=e.length;s<l;s++){var u=e[s]*r,c=s<l-1?e[s+1]*r:t.length;a-=Math.abs(Ns(t,u,c,r))}var p=0;for(s=0;s<n.length;s+=3){var f=n[s]*r,y=n[s+1]*r,m=n[s+2]*r;p+=Math.abs((t[f]-t[m])*(t[y+1]-t[f+1])-(t[f]-t[y])*(t[m+1]-t[f+1]))}return a===0&&p===0?0:Math.abs((p-a)/a)};function Ns(t,e,r,n){for(var i=0,o=e,a=r-n;o<r;o+=n)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}Jo.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)r.vertices.push(t[i][o][a]);i>0&&(n+=t[i-1].length,r.holes.push(n))}return r}});var qs=Ae((kS,Cp)=>{"use strict";var vx=he();Cp.exports=Mr;function Mr(t,e,r,n,i){this.properties={},this.extent=r,this.type=0,this._pbf=t,this._geometry=-1,this._keys=n,this._values=i,t.readFields(Px,this,e)}function Px(t,e,r){t==1?e.id=r.readVarint():t==2?Sx(r,e):t==3?e.type=r.readVarint():t==4&&(e._geometry=r.pos)}function Sx(t,e){for(var r=t.readVarint()+t.pos;t.pos<r;){var n=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[n]=i}}Mr.types=["Unknown","Point","LineString","Polygon"];Mr.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,n=0,i=0,o=0,a=[],s;t.pos<e;){if(n<=0){var l=t.readVarint();r=l&7,n=l>>3}if(n--,r===1||r===2)i+=t.readSVarint(),o+=t.readSVarint(),r===1&&(s&&a.push(s),s=[]),s.push(new vx(i,o));else if(r===7)s&&s.push(s[0].clone());else throw new Error("unknown command "+r)}return s&&a.push(s),a};Mr.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,n=0,i=0,o=0,a=1/0,s=-1/0,l=1/0,u=-1/0;t.pos<e;){if(n<=0){var c=t.readVarint();r=c&7,n=c>>3}if(n--,r===1||r===2)i+=t.readSVarint(),o+=t.readSVarint(),i<a&&(a=i),i>s&&(s=i),o<l&&(l=o),o>u&&(u=o);else if(r!==7)throw new Error("unknown command "+r)}return[a,l,s,u]};Mr.prototype.toGeoJSON=function(t,e,r){var n=this.extent*Math.pow(2,r),i=this.extent*t,o=this.extent*e,a=this.loadGeometry(),s=Mr.types[this.type],l,u;function c(y){for(var m=0;m<y.length;m++){var h=y[m],d=180-(h.y+o)*360/n;y[m]=[(h.x+i)*360/n-180,360/Math.PI*Math.atan(Math.exp(d*Math.PI/180))-90]}}switch(this.type){case 1:var p=[];for(l=0;l<a.length;l++)p[l]=a[l][0];a=p,c(a);break;case 2:for(l=0;l<a.length;l++)c(a[l]);break;case 3:for(a=wx(a),l=0;l<a.length;l++)for(u=0;u<a[l].length;u++)c(a[l][u]);break}a.length===1?a=a[0]:s="Multi"+s;var f={type:"Feature",geometry:{type:s,coordinates:a},properties:this.properties};return"id"in this&&(f.id=this.id),f};function wx(t){var e=t.length;if(e<=1)return[t];for(var r=[],n,i,o=0;o<e;o++){var a=Ax(t[o]);a!==0&&(i===void 0&&(i=a<0),i===a<0?(n&&r.push(n),n=[t[o]]):n.push(t[o]))}return n&&r.push(n),r}function Ax(t){for(var e=0,r=0,n=t.length,i=n-1,o,a;r<n;i=r++)o=t[r],a=t[i],e+=(a.x-o.x)*(o.y+a.y);return e}});var js=Ae((MS,Mp)=>{"use strict";var _x=qs();Mp.exports=kp;function kp(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Ix,this,e),this.length=this._features.length}function Ix(t,e,r){t===15?e.version=r.readVarint():t===1?e.name=r.readString():t===5?e.extent=r.readVarint():t===2?e._features.push(r.pos):t===3?e._keys.push(r.readString()):t===4&&e._values.push(Tx(r))}function Tx(t){for(var e=null,r=t.readVarint()+t.pos;t.pos<r;){var n=t.readVarint()>>3;e=n===1?t.readString():n===2?t.readFloat():n===3?t.readDouble():n===4?t.readVarint64():n===5?t.readVarint():n===6?t.readSVarint():n===7?t.readBoolean():null}return e}kp.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new _x(this._pbf,e,this.extent,this._keys,this._values)}});var Fp=Ae((ES,Ep)=>{"use strict";var Cx=js();Ep.exports=kx;function kx(t,e){this.layers=t.readFields(Mx,{},e)}function Mx(t,e,r){if(t===3){var n=new Cx(r,r.readVarint()+r.pos);n.length&&(e[n.name]=n)}}});var Tt=Ae((FS,Ho)=>{Ho.exports.VectorTile=Fp();Ho.exports.VectorTileFeature=qs();Ho.exports.VectorTileLayer=js()});var Qp=Ae(Xs=>{Xs.read=function(t,e,r,n,i){var o,a,s=i*8-n-1,l=(1<<s)-1,u=l>>1,c=-7,p=r?i-1:0,f=r?-1:1,y=t[e+p];for(p+=f,o=y&(1<<-c)-1,y>>=-c,c+=s;c>0;o=o*256+t[e+p],p+=f,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=n;c>0;a=a*256+t[e+p],p+=f,c-=8);if(o===0)o=1-u;else{if(o===l)return a?NaN:(y?-1:1)*(1/0);a=a+Math.pow(2,n),o=o-u}return(y?-1:1)*a*Math.pow(2,o-n)};Xs.write=function(t,e,r,n,i,o){var a,s,l,u=o*8-i-1,c=(1<<u)-1,p=c>>1,f=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=n?0:o-1,m=n?1:-1,h=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+p>=1?e+=f/l:e+=f*Math.pow(2,1-p),e*l>=2&&(a++,l/=2),a+p>=c?(s=0,a=c):a+p>=1?(s=(e*l-1)*Math.pow(2,i),a=a+p):(s=e*Math.pow(2,p-1)*Math.pow(2,i),a=0));i>=8;t[r+y]=s&255,y+=m,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;t[r+y]=a&255,y+=m,a/=256,u-=8);t[r+y-m]|=h*128}});var ei=Ae((m2,of)=>{"use strict";of.exports=J;var ea=Qp();function J(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}J.Varint=0;J.Fixed64=1;J.Bytes=2;J.Fixed32=5;var Ks=65536*65536,ef=1/Ks,Hx=12,nf=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");J.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,o=this.pos;this.type=n&7,t(i,e,this),this.pos===o&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=ta(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=rf(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=ta(this.buf,this.pos)+ta(this.buf,this.pos+4)*Ks;return this.pos+=8,t},readSFixed64:function(){var t=ta(this.buf,this.pos)+rf(this.buf,this.pos+4)*Ks;return this.pos+=8,t},readFloat:function(){var t=ea.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=ea.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e=this.buf,r,n;return n=e[this.pos++],r=n&127,n<128||(n=e[this.pos++],r|=(n&127)<<7,n<128)||(n=e[this.pos++],r|=(n&127)<<14,n<128)||(n=e[this.pos++],r|=(n&127)<<21,n<128)?r:(n=e[this.pos],r|=(n&15)<<28,Xx(r,t,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2===1?(t+1)/-2:t/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=Hx&&nf?cb(this.buf,e,t):ub(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==J.Bytes)return t.push(this.readVarint(e));var r=ct(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==J.Bytes)return t.push(this.readSVarint());var e=ct(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==J.Bytes)return t.push(this.readBoolean());var e=ct(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==J.Bytes)return t.push(this.readFloat());var e=ct(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==J.Bytes)return t.push(this.readDouble());var e=ct(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==J.Bytes)return t.push(this.readFixed32());var e=ct(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==J.Bytes)return t.push(this.readSFixed32());var e=ct(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==J.Bytes)return t.push(this.readFixed64());var e=ct(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==J.Bytes)return t.push(this.readSFixed64());var e=ct(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=t&7;if(e===J.Varint)for(;this.buf[this.pos++]>127;);else if(e===J.Bytes)this.pos=this.readVarint()+this.pos;else if(e===J.Fixed32)this.pos+=4;else if(e===J.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+e)},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Lr(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Lr(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Lr(this.buf,t&-1,this.pos),Lr(this.buf,Math.floor(t*ef),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Lr(this.buf,t&-1,this.pos),Lr(this.buf,Math.floor(t*ef),this.pos+4),this.pos+=8},writeVarint:function(t){if(t=+t||0,t>268435455||t<0){Kx(t,this);return}this.realloc(4),this.buf[this.pos++]=t&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=t>>>7&127)))},writeSVarint:function(t){this.writeVarint(t<0?-t*2-1:t*2)},writeBoolean:function(t){this.writeVarint(!!t)},writeString:function(t){t=String(t),this.realloc(t.length*4),this.pos++;var e=this.pos;this.pos=pb(this.buf,t,this.pos);var r=this.pos-e;r>=128&&tf(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),ea.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),ea.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var n=this.pos-r;n>=128&&tf(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,r){this.writeTag(t,J.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,eb,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,tb,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,ib,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,rb,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,nb,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,ob,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,ab,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,sb,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,lb,e)},writeBytesField:function(t,e){this.writeTag(t,J.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,J.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,J.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,J.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,J.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,J.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,J.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,J.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,J.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,J.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,!!e)}};function Xx(t,e,r){var n=r.buf,i,o;if(o=n[r.pos++],i=(o&112)>>4,o<128||(o=n[r.pos++],i|=(o&127)<<3,o<128)||(o=n[r.pos++],i|=(o&127)<<10,o<128)||(o=n[r.pos++],i|=(o&127)<<17,o<128)||(o=n[r.pos++],i|=(o&127)<<24,o<128)||(o=n[r.pos++],i|=(o&1)<<31,o<128))return Fr(t,i,e);throw new Error("Expected varint not more than 10 bytes")}function ct(t){return t.type===J.Bytes?t.readVarint()+t.pos:t.pos+1}function Fr(t,e,r){return r?e*4294967296+(t>>>0):(e>>>0)*4294967296+(t>>>0)}function Kx(t,e){var r,n;if(t>=0?(r=t%4294967296|0,n=t/4294967296|0):(r=~(-t%4294967296),n=~(-t/4294967296),r^4294967295?r=r+1|0:(r=0,n=n+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),Yx(r,n,e),Qx(n,e)}function Yx(t,e,r){r.buf[r.pos++]=t&127|128,t>>>=7,r.buf[r.pos++]=t&127|128,t>>>=7,r.buf[r.pos++]=t&127|128,t>>>=7,r.buf[r.pos++]=t&127|128,t>>>=7,r.buf[r.pos]=t&127}function Qx(t,e){var r=(t&7)<<4;e.buf[e.pos++]|=r|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127)))))}function tf(t,e,r){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(Math.LN2*7));r.realloc(n);for(var i=r.pos-1;i>=t;i--)r.buf[i+n]=r.buf[i]}function eb(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function tb(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function rb(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function nb(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function ib(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function ob(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function ab(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function sb(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function lb(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function ta(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+t[e+3]*16777216}function Lr(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function rf(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function ub(t,e,r){for(var n="",i=e;i<r;){var o=t[i],a=null,s=o>239?4:o>223?3:o>191?2:1;if(i+s>r)break;var l,u,c;s===1?o<128&&(a=o):s===2?(l=t[i+1],(l&192)===128&&(a=(o&31)<<6|l&63,a<=127&&(a=null))):s===3?(l=t[i+1],u=t[i+2],(l&192)===128&&(u&192)===128&&(a=(o&15)<<12|(l&63)<<6|u&63,(a<=2047||a>=55296&&a<=57343)&&(a=null))):s===4&&(l=t[i+1],u=t[i+2],c=t[i+3],(l&192)===128&&(u&192)===128&&(c&192)===128&&(a=(o&15)<<18|(l&63)<<12|(u&63)<<6|c&63,(a<=65535||a>=1114112)&&(a=null))),a===null?(a=65533,s=1):a>65535&&(a-=65536,n+=String.fromCharCode(a>>>10&1023|55296),a=56320|a&1023),n+=String.fromCharCode(a),i+=s}return n}function cb(t,e,r){return nf.decode(t.subarray(e,r))}function pb(t,e,r){for(var n=0,i,o;n<e.length;n++){if(i=e.charCodeAt(n),i>55295&&i<57344)if(o)if(i<56320){t[r++]=239,t[r++]=191,t[r++]=189,o=i;continue}else i=o-55296<<10|i-56320|65536,o=null;else{i>56319||n+1===e.length?(t[r++]=239,t[r++]=191,t[r++]=189):o=i;continue}else o&&(t[r++]=239,t[r++]=191,t[r++]=189,o=null);i<128?t[r++]=i:(i<2048?t[r++]=i>>6|192:(i<65536?t[r++]=i>>12|224:(t[r++]=i>>18|240,t[r++]=i>>12&63|128),t[r++]=i>>6&63|128),t[r++]=i&63|128)}return r}});var ey=Ae((pT,Qf)=>{Qf.exports=Aa;function Aa(t,e){var r=t&&t.type,n;if(r==="FeatureCollection")for(n=0;n<t.features.length;n++)Aa(t.features[n],e);else if(r==="GeometryCollection")for(n=0;n<t.geometries.length;n++)Aa(t.geometries[n],e);else if(r==="Feature")Aa(t.geometry,e);else if(r==="Polygon")Kf(t.coordinates,e);else if(r==="MultiPolygon")for(n=0;n<t.coordinates.length;n++)Kf(t.coordinates[n],e);return t}function Kf(t,e){if(t.length!==0){Yf(t[0],e);for(var r=1;r<t.length;r++)Yf(t[r],!e)}}function Yf(t,e){for(var r=0,n=0,i=0,o=t.length,a=o-1;i<o;a=i++){var s=(t[i][0]-t[a][0])*(t[a][1]+t[i][1]),l=r+s;n+=Math.abs(r)>=Math.abs(s)?r-l+s:s-l+r,r=l}r+n>=0!=!!e&&t.reverse()}});var iy=Ae((mT,ny)=>{"use strict";var Zb=he(),Wb=Tt().VectorTileFeature;ny.exports=ry;function ry(t,e){this.options=e||{},this.features=t,this.length=t.length}ry.prototype.feature=function(t){return new Ia(this.features[t],this.options.extent)};function Ia(t,e){this.id=typeof t.id=="number"?t.id:void 0,this.type=t.type,this.rawGeometry=t.type===1?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}Ia.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var e=0;e<t.length;e++){for(var r=t[e],n=[],i=0;i<r.length;i++)n.push(new Zb(r[i][0],r[i][1]));this.geometry.push(n)}return this.geometry};Ia.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,r=-1/0,n=1/0,i=-1/0,o=0;o<t.length;o++)for(var a=t[o],s=0;s<a.length;s++){var l=a[s];e=Math.min(e,l.x),r=Math.max(r,l.x),n=Math.min(n,l.y),i=Math.max(i,l.y)}return[e,n,r,i]};Ia.prototype.toGeoJSON=Wb.prototype.toGeoJSON});var sy=Ae((hT,gi)=>{var Hb=ei(),ay=iy();gi.exports=dl;gi.exports.fromVectorTileJs=dl;gi.exports.fromGeojsonVt=Xb;gi.exports.GeoJSONWrapper=ay;function dl(t){var e=new Hb;return Kb(t,e),e.finish()}function Xb(t,e){e=e||{};var r={};for(var n in t)r[n]=new ay(t[n].features,e),r[n].name=n,r[n].version=e.version,r[n].extent=e.extent;return dl({layers:r})}function Kb(t,e){for(var r in t.layers)e.writeMessage(3,Yb,t.layers[r])}function Yb(t,e){e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var r,n={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<t.length;r++)n.feature=t.feature(r),e.writeMessage(2,Qb,n);var i=n.keys;for(r=0;r<i.length;r++)e.writeStringField(3,i[r]);var o=n.values;for(r=0;r<o.length;r++)e.writeMessage(4,r0,o[r])}function Qb(t,e){var r=t.feature;r.id!==void 0&&e.writeVarintField(1,r.id),e.writeMessage(2,e0,t),e.writeVarintField(3,r.type),e.writeMessage(4,t0,r)}function e0(t,e){var r=t.feature,n=t.keys,i=t.values,o=t.keycache,a=t.valuecache;for(var s in r.properties){var l=r.properties[s],u=o[s];if(l!==null){typeof u>"u"&&(n.push(s),u=n.length-1,o[s]=u),e.writeVarint(u);var c=typeof l;c!=="string"&&c!=="boolean"&&c!=="number"&&(l=JSON.stringify(l));var p=c+":"+l,f=a[p];typeof f>"u"&&(i.push(l),f=i.length-1,a[p]=f),e.writeVarint(f)}}}function hl(t,e){return(e<<3)+(t&7)}function oy(t){return t<<1^t>>31}function t0(t,e){for(var r=t.loadGeometry(),n=t.type,i=0,o=0,a=r.length,s=0;s<a;s++){var l=r[s],u=1;n===1&&(u=l.length),e.writeVarint(hl(1,u));for(var c=n===3?l.length-1:l.length,p=0;p<c;p++){p===1&&n!==1&&e.writeVarint(hl(2,c-1));var f=l[p].x-i,y=l[p].y-o;e.writeVarint(oy(f)),e.writeVarint(oy(y)),i+=f,o+=y}n===3&&e.writeVarint(hl(7,1))}}function r0(t,e){var r=typeof t;r==="string"?e.writeStringField(1,t):r==="boolean"?e.writeBooleanField(7,t):r==="number"&&(t%1!==0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}});var Ly=Z(he(),1),Zl=Z(Gl(),1);var Oa;function ql(){return Oa==null&&(Oa=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Oa}var ki;function jl(){if(ki==null&&(ki=!1,ql())){let r=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(r){for(let i=0;i<5*5;i++){let o=i*4;r.fillStyle="rgb(".concat(o,",").concat(o+1,",").concat(o+2,")"),r.fillRect(i%5,Math.floor(i/5),1,1)}let n=r.getImageData(0,0,5,5).data;for(let i=0;i<5*5*4;i++)if(i%4!==3&&n[i]!==i){ki=!0;break}}}return ki||!1}function Wl(t){if(t<=0)return 0;if(t>=1)return 1;let e=t*t,r=e*t;return 4*(t<.5?r:3*(t-e)+r-.75)}function Dy(t,e,r,n){let i=new Zl.default(t,e,r,n);return function(o){return i.solve(o)}}var S0=Dy(.25,.1,.25,1);function it(t,e,r){return Math.min(r,Math.max(e,t))}function Hl(t,e,r){let n=r-e,i=((t-e)%n+n)%n+e;return i===e?r:i}function Pe(t,...e){for(let r of e)for(let n in r)t[n]=r[n];return t}function Xl(t){return Math.log(t)/Math.LN2%1===0}function jr(t,e,r){let n={};for(let i in t)n[i]=e.call(r||this,t[i],i,t);return n}function Kl(t,e,r){let n={};for(let i in t)e.call(r||this,t[i],i,t)&&(n[i]=t[i]);return n}function nt(t){return Array.isArray(t)?t.map(nt):typeof t=="object"&&t?jr(t,nt):t}function Yl(t,e){for(let r=0;r<t.length;r++)if(e.indexOf(t[r])>=0)return!0;return!1}var Jl={};function fe(t){Jl[t]||(typeof console<"u"&&console.warn(t),Jl[t]=!0)}function ot(t,e,r){return(r.y-t.y)*(e.x-t.x)>(e.y-t.y)*(r.x-t.x)}function Ql(t){let e=0;for(let r=0,n=t.length,i=n-1,o,a;r<n;i=r++)o=t[r],a=t[i],e+=(a.x-o.x)*(o.y+a.y);return e}function at(t){return typeof WorkerGlobalScope<"u"&&typeof t<"u"&&t instanceof WorkerGlobalScope}function Jr(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap}function Vy(t,e,r,n,i){let o=Math.max(-e,0)*4,l=(Math.max(0,r)-r)*n*4+o,u=n*4,c=Math.max(0,e),p=Math.max(0,r),f=Math.min(t.width,e+n),y=Math.min(t.height,r+i);return{rect:{x:c,y:p,width:f-c,height:y-p},layout:[{offset:l,stride:u}]}}async function By(t,e,r,n,i){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");let o=new VideoFrame(t,{timestamp:0});try{let a=o==null?void 0:o.format;if(!a||!(a.startsWith("BGR")||a.startsWith("RGB")))throw new Error("Unrecognized format ".concat(a));let s=a.startsWith("BGR"),l=new Uint8ClampedArray(n*i*4);if(await o.copyTo(l,Vy(t,e,r,n,i)),s)for(let u=0;u<l.length;u+=4){let c=l[u];l[u]=l[u+2],l[u+2]=c}return l}finally{o.close()}}var Gr,qr;function zy(t,e,r,n,i){let o=t.width,a=t.height;(!Gr||!qr)&&(Gr=new OffscreenCanvas(o,a),qr=Gr.getContext("2d",{willReadFrequently:!0})),Gr.width=o,Gr.height=a,qr.drawImage(t,0,0,o,a);let s=qr.getImageData(e,r,n,i);return qr.clearRect(0,0,o,a),s.data}async function eu(t,e,r,n,i){if(jl())try{return await By(t,e,r,n,i)}catch(o){}return zy(t,e,r,n,i)}function tu(t,e,r,n){return t.addEventListener(e,r,n),{unsubscribe:()=>{t.removeEventListener(e,r,n)}}}var Vt=class t{constructor(e,r,n){let i=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;let a=new Int32Array(this.arrayBuffer);e=a[0],r=a[1],n=a[2],this.d=r+2*n;for(let u=0;u<this.d*this.d;u++){let c=a[3+u],p=a[3+u+1];i.push(c===p?null:a.subarray(c,p))}let s=a[3+i.length],l=a[3+i.length+1];this.keys=a.subarray(s,l),this.bboxes=a.subarray(l),this.insert=this._insertReadonly}else{this.d=r+2*n;for(let a=0;a<this.d*this.d;a++)i.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=e,this.padding=n,this.scale=r/e,this.uid=0;let o=n/r*e;this.min=-o,this.max=e+o}insert(e,r,n,i,o){this._forEachCell(r,n,i,o,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(o)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,r,n,i,o,a){this.cells[o].push(a)}query(e,r,n,i,o){let a=this.min,s=this.max;if(e<=a&&r<=a&&s<=n&&s<=i&&!o)return Array.prototype.slice.call(this.keys);{let l=[],u={};return this._forEachCell(e,r,n,i,this._queryCell,l,u,o),l}}_queryCell(e,r,n,i,o,a,s,l){let u=this.cells[o];if(u!==null){let c=this.keys,p=this.bboxes;for(let f=0;f<u.length;f++){let y=u[f];if(s[y]===void 0){let m=y*4;(l?l(p[m+0],p[m+1],p[m+2],p[m+3]):e<=p[m+2]&&r<=p[m+3]&&n>=p[m+0]&&i>=p[m+1])?(s[y]=!0,a.push(c[y])):s[y]=!1}}}}_forEachCell(e,r,n,i,o,a,s,l){let u=this._convertToCellCoord(e),c=this._convertToCellCoord(r),p=this._convertToCellCoord(n),f=this._convertToCellCoord(i);for(let y=u;y<=p;y++)for(let m=c;m<=f;m++){let h=this.d*m+y;if(!(l&&!l(this._convertFromCellCoord(y),this._convertFromCellCoord(m),this._convertFromCellCoord(y+1),this._convertFromCellCoord(m+1)))&&o.call(this,e,r,n,i,h,a,s,l))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let e=this.cells,r=3+this.cells.length+1+1,n=0;for(let a=0;a<this.cells.length;a++)n+=this.cells[a].length;let i=new Int32Array(r+n+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;let o=r;for(let a=0;a<e.length;a++){let s=e[a];i[3+a]=o,i.set(s,o),o+=s.length}return i[3+e.length]=o,i.set(this.keys,o),o+=this.keys.length,i[3+e.length+1]=o,i.set(this.bboxes,o),o+=this.bboxes.length,i.buffer}static serialize(e,r){let n=e.toArrayBuffer();return r&&r.push(n),{buffer:n}}static deserialize(e){return new t(e.buffer)}};var Ry=8,Oy={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},Ny={"*":{type:"source"}},Uy=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],$y={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Gy={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},qy={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},jy={type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},Jy={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Zy={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Wy={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},Hy=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],Xy={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Ky={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Yy={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Qy={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},em={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},tm={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},rm={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},nm={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},im={type:"array",value:"*"},om={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},am={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},sm={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},lm={type:"array",value:"*",minimum:1},um={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},cm={"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},pm={source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},fm={type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},ym=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],mm={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},hm={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},dm={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},gm={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},xm={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},bm={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},vm={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Pm={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Sm={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},wm={"*":{type:"string"}},S={$version:Ry,$root:Oy,sources:Ny,source:Uy,source_vector:$y,source_raster:Gy,source_raster_dem:qy,source_geojson:jy,source_video:Jy,source_image:Zy,layer:Wy,layout:Hy,layout_background:Xy,layout_fill:Ky,layout_circle:Yy,layout_heatmap:Qy,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:em,layout_symbol:tm,layout_raster:rm,layout_hillshade:nm,filter:im,filter_operator:om,geometry_type:am,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:sm,expression:lm,light:um,sky:cm,terrain:pm,projection:fm,paint:ym,paint_fill:mm,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:hm,paint_circle:dm,paint_heatmap:gm,paint_symbol:xm,paint_raster:bm,paint_hillshade:vm,paint_background:Pm,transition:Sm,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:wm},Am=["type","source","source-layer","minzoom","maxzoom","filter","layout"];var M=class{constructor(e,r,n,i){this.message=(e?"".concat(e,": "):"")+n,i&&(this.identifier=i),r!=null&&r.__line__&&(this.line=r.__line__)}};function fr(t,...e){for(let r of e)for(let n in r)t[n]=r[n];return t}var Be=class extends Error{constructor(e,r){super(r),this.message=r,this.key=e}},Ha=class t{constructor(e,r=[]){this.parent=e,this.bindings={};for(let[n,i]of r)this.bindings[n]=i}concat(e){return new t(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error("".concat(e," not found in scope."))}has(e){return this.bindings[e]?!0:this.parent?this.parent.has(e):!1}},hr={kind:"null"},L={kind:"number"},G={kind:"string"},U={kind:"boolean"},Re={kind:"color"},cr={kind:"object"},$={kind:"value"},_m={kind:"error"},Wi={kind:"collator"},dr={kind:"formatted"},Hi={kind:"padding"},cn={kind:"resolvedImage"},Xi={kind:"variableAnchorOffsetCollection"};function Ee(t,e){return{kind:"array",itemType:t,N:e}}function te(t){if(t.kind==="array"){let e=te(t.itemType);return typeof t.N=="number"?"array<".concat(e,", ").concat(t.N,">"):t.itemType.kind==="value"?"array":"array<".concat(e,">")}else return t.kind}var Im=[hr,L,G,U,Re,dr,cr,Ee($),Hi,cn,Xi];function Kr(t,e){if(e.kind==="error")return null;if(t.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!Kr(t.itemType,e.itemType))&&(typeof t.N!="number"||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if(t.kind==="value"){for(let r of Im)if(!Kr(r,e))return null}}return"Expected ".concat(te(t)," but found ").concat(te(e)," instead.")}function fs(t,e){return e.some(r=>r.kind===t.kind)}function Rt(t,e){return e.some(r=>r==="null"?t===null:r==="array"?Array.isArray(t):r==="object"?t&&!Array.isArray(t)&&typeof t=="object":r===typeof t)}function Zr(t,e){return t.kind==="array"&&e.kind==="array"?t.itemType.kind===e.itemType.kind&&typeof t.N=="number":t.kind===e.kind}var wu=.96422,Au=1,_u=.82521,Iu=4/29,pr=6/29,Tu=3*pr*pr,Tm=pr*pr*pr,Cm=Math.PI/180,km=180/Math.PI;function Cu(t){return t=t%360,t<0&&(t+=360),t}function ku([t,e,r,n]){t=Na(t),e=Na(e),r=Na(r);let i,o,a=Ua((.2225045*t+.7168786*e+.0606169*r)/Au);t===e&&e===r?i=o=a:(i=Ua((.4360747*t+.3850649*e+.1430804*r)/wu),o=Ua((.0139322*t+.0971045*e+.7141733*r)/_u));let s=116*a-16;return[s<0?0:s,500*(i-a),200*(a-o),n]}function Na(t){return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Ua(t){return t>Tm?Math.pow(t,1/3):t/Tu+Iu}function Mu([t,e,r,n]){let i=(t+16)/116,o=isNaN(e)?i:i+e/500,a=isNaN(r)?i:i-r/200;return i=Au*Ga(i),o=wu*Ga(o),a=_u*Ga(a),[$a(3.1338561*o-1.6168667*i-.4906146*a),$a(-.9787684*o+1.9161415*i+.033454*a),$a(.0719453*o-.2289914*i+1.4052427*a),n]}function $a(t){return t=t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055,t<0?0:t>1?1:t}function Ga(t){return t>pr?t*t*t:Tu*(t-Iu)}function Mm(t){let[e,r,n,i]=ku(t),o=Math.sqrt(r*r+n*n);return[Math.round(o*1e4)?Cu(Math.atan2(n,r)*km):NaN,o,e,i]}function Em([t,e,r,n]){return t=isNaN(t)?0:t*Cm,Mu([r,Math.cos(t)*e,Math.sin(t)*e,n])}function Fm([t,e,r,n]){t=Cu(t),e/=100,r/=100;function i(o){let a=(o+t/30)%12,s=e*Math.min(r,1-r);return r-s*Math.max(-1,Math.min(a-3,9-a,1))}return[i(0),i(8),i(4),n]}function Lm(t){if(t=t.toLowerCase().trim(),t==="transparent")return[0,0,0,0];let e=Dm[t];if(e){let[i,o,a]=e;return[i/255,o/255,a/255,1]}if(t.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(t)){let o=t.length<6?1:2,a=1;return[Mi(t.slice(a,a+=o)),Mi(t.slice(a,a+=o)),Mi(t.slice(a,a+=o)),Mi(t.slice(a,a+o)||"ff")]}if(t.startsWith("rgb")){let i=/^rgba?\\(\\s*([\\de.+-]+)(%)?(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)(%)?(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)(%)?(?:\\s*([,\\/])\\s*([\\de.+-]+)(%)?)?\\s*\\)$/,o=t.match(i);if(o){let[a,s,l,u,c,p,f,y,m,h,d,g]=o,b=[u||" ",f||" ",h].join("");if(b==="  "||b==="  /"||b===",,"||b===",,,"){let x=[l,p,m].join(""),v=x==="%%%"?100:x===""?255:0;if(v){let P=[lr(+s/v,0,1),lr(+c/v,0,1),lr(+y/v,0,1),d?ru(+d,g):1];if(nu(P))return P}}return}}let r=/^hsla?\\(\\s*([\\de.+-]+)(?:deg)?(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)%(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)%(?:\\s*([,\\/])\\s*([\\de.+-]+)(%)?)?\\s*\\)$/,n=t.match(r);if(n){let[i,o,a,s,l,u,c,p,f]=n,y=[a||" ",l||" ",c].join("");if(y==="  "||y==="  /"||y===",,"||y===",,,"){let m=[+o,lr(+s,0,100),lr(+u,0,100),p?ru(+p,f):1];if(nu(m))return Fm(m)}}}function Mi(t){return parseInt(t.padEnd(2,t),16)/255}function ru(t,e){return lr(e?t/100:t,0,1)}function lr(t,e,r){return Math.min(Math.max(e,t),r)}function nu(t){return!t.some(Number.isNaN)}var Dm={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},W=class t{constructor(e,r,n,i=1,o=!0){this.r=e,this.g=r,this.b=n,this.a=i,o||(this.r*=i,this.g*=i,this.b*=i,i||this.overwriteGetter("rgb",[e,r,n,i]))}static parse(e){if(e instanceof t)return e;if(typeof e!="string")return;let r=Lm(e);if(r)return new t(...r,!1)}get rgb(){let{r:e,g:r,b:n,a:i}=this,o=i||1/0;return this.overwriteGetter("rgb",[e/o,r/o,n/o,i])}get hcl(){return this.overwriteGetter("hcl",Mm(this.rgb))}get lab(){return this.overwriteGetter("lab",ku(this.rgb))}overwriteGetter(e,r){return Object.defineProperty(this,e,{value:r}),r}toString(){let[e,r,n,i]=this.rgb;return"rgba(".concat([e,r,n].map(o=>Math.round(o*255)).join(","),",").concat(i,")")}};W.black=new W(0,0,0,1);W.white=new W(1,1,1,1);W.transparent=new W(0,0,0,0);W.red=new W(1,0,0,1);var Yr=class{constructor(e,r,n){e?this.sensitivity=r?"variant":"case":this.sensitivity=r?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,r){return this.collator.compare(e,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}},Qr=class{constructor(e,r,n,i,o){this.text=e,this.image=r,this.scale=n,this.fontStack=i,this.textColor=o}},Fe=class t{constructor(e){this.sections=e}static fromString(e){return new t([new Qr(e,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof t?e:t.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}},Ze=class t{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof t)return e;if(typeof e=="number")return new t([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(let r of e)if(typeof r!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]];break}return new t(e)}}toString(){return JSON.stringify(this.values)}},Vm=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]),Ne=class t{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof t)return e;if(!(!Array.isArray(e)||e.length<1||e.length%2!==0)){for(let r=0;r<e.length;r+=2){let n=e[r],i=e[r+1];if(typeof n!="string"||!Vm.has(n)||!Array.isArray(i)||i.length!==2||typeof i[0]!="number"||typeof i[1]!="number")return}return new t(e)}}toString(){return JSON.stringify(this.values)}},Te=class t{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new t({name:e,available:!1}):null}};function Eu(t,e,r,n){if(!(typeof t=="number"&&t>=0&&t<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof r=="number"&&r>=0&&r<=255)){let i=typeof n=="number"?[t,e,r,n]:[t,e,r];return"Invalid rgba value [".concat(i.join(", "),"]: 'r', 'g', and 'b' must be between 0 and 255.")}return typeof n>"u"||typeof n=="number"&&n>=0&&n<=1?null:"Invalid rgba value [".concat([t,e,r,n].join(", "),"]: 'a' must be between 0 and 1.")}function en(t){if(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||t instanceof W||t instanceof Yr||t instanceof Fe||t instanceof Ze||t instanceof Ne||t instanceof Te)return!0;if(Array.isArray(t)){for(let e of t)if(!en(e))return!1;return!0}else if(typeof t=="object"){for(let e in t)if(!en(t[e]))return!1;return!0}else return!1}function ue(t){if(t===null)return hr;if(typeof t=="string")return G;if(typeof t=="boolean")return U;if(typeof t=="number")return L;if(t instanceof W)return Re;if(t instanceof Yr)return Wi;if(t instanceof Fe)return dr;if(t instanceof Ze)return Hi;if(t instanceof Ne)return Xi;if(t instanceof Te)return cn;if(Array.isArray(t)){let e=t.length,r;for(let n of t){let i=ue(n);if(!r)r=i;else{if(r===i)continue;r=$;break}}return Ee(r||$,e)}else return cr}function Hr(t){let e=typeof t;return t===null?"":e==="string"||e==="number"||e==="boolean"?String(t):t instanceof W||t instanceof Fe||t instanceof Ze||t instanceof Ne||t instanceof Te?t.toString():JSON.stringify(t)}var mt=class t{constructor(e,r){this.type=e,this.value=r}static parse(e,r){if(e.length!==2)return r.error("'literal' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(!en(e[1]))return r.error("invalid value");let n=e[1],i=ue(n),o=r.expectedType;return i.kind==="array"&&i.N===0&&o&&o.kind==="array"&&(typeof o.N!="number"||o.N===0)&&(i=o),new t(i,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}},ie=class{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}},Ei={string:G,number:L,boolean:U,object:cr},je=class t{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let n=1,i,o=e[0];if(o==="array"){let s;if(e.length>2){let u=e[1];if(typeof u!="string"||!(u in Ei)||u==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);s=Ei[u],n++}else s=$;let l;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return r.error('The length argument to "array" must be a positive integer literal',2);l=e[2],n++}i=Ee(s,l)}else{if(!Ei[o])throw new Error("Types doesn't contain name = ".concat(o));i=Ei[o]}let a=[];for(;n<e.length;n++){let s=r.parse(e[n],n,$);if(!s)return null;a.push(s)}return new t(i,a)}evaluate(e){for(let r=0;r<this.args.length;r++){let n=this.args[r].evaluate(e);if(Kr(this.type,ue(n))){if(r===this.args.length-1)throw new ie("Expected value to be of type ".concat(te(this.type),", but found ").concat(te(ue(n))," instead."))}else return n}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}},iu={"to-boolean":U,"to-color":Re,"to-number":L,"to-string":G},yt=class t{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let n=e[0];if(!iu[n])throw new Error("Can't parse ".concat(n," as it is not part of the known types"));if((n==="to-boolean"||n==="to-string")&&e.length!==2)return r.error("Expected one argument.");let i=iu[n],o=[];for(let a=1;a<e.length;a++){let s=r.parse(e[a],a,$);if(!s)return null;o.push(s)}return new t(i,o)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let r,n;for(let i of this.args){if(r=i.evaluate(e),n=null,r instanceof W)return r;if(typeof r=="string"){let o=e.parseColor(r);if(o)return o}else if(Array.isArray(r)&&(r.length<3||r.length>4?n="Invalid rgba value ".concat(JSON.stringify(r),": expected an array containing either three or four numeric values."):n=Eu(r[0],r[1],r[2],r[3]),!n))return new W(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new ie(n||"Could not parse color from value '".concat(typeof r=="string"?r:JSON.stringify(r),"'"))}case"padding":{let r;for(let n of this.args){r=n.evaluate(e);let i=Ze.parse(r);if(i)return i}throw new ie("Could not parse padding from value '".concat(typeof r=="string"?r:JSON.stringify(r),"'"))}case"variableAnchorOffsetCollection":{let r;for(let n of this.args){r=n.evaluate(e);let i=Ne.parse(r);if(i)return i}throw new ie("Could not parse variableAnchorOffsetCollection from value '".concat(typeof r=="string"?r:JSON.stringify(r),"'"))}case"number":{let r=null;for(let n of this.args){if(r=n.evaluate(e),r===null)return 0;let i=Number(r);if(!isNaN(i))return i}throw new ie("Could not convert ".concat(JSON.stringify(r)," to number."))}case"formatted":return Fe.fromString(Hr(this.args[0].evaluate(e)));case"resolvedImage":return Te.fromString(Hr(this.args[0].evaluate(e)));default:return Hr(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}},Bm=["Unknown","Point","LineString","Polygon"],Vi=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Bm[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let r=this._parseColorCache[e];return r||(r=this._parseColorCache[e]=W.parse(e)),r}},Bi=class t{constructor(e,r,n=[],i,o=new Ha,a=[]){this.registry=e,this.path=n,this.key=n.map(s=>"[".concat(s,"]")).join(""),this.scope=o,this.errors=a,this.expectedType=i,this._isConstant=r}parse(e,r,n,i,o={}){return r?this.concat(r,n,i)._parse(e,o):this._parse(e,o)}_parse(e,r){(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number")&&(e=["literal",e]);function n(i,o,a){return a==="assert"?new je(o,[i]):a==="coerce"?new yt(o,[i]):i}if(Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let i=e[0];if(typeof i!="string")return this.error("Expression name must be a string, but found ".concat(typeof i,' instead. If you wanted a literal array, use ["literal", [...]].'),0),null;let o=this.registry[i];if(o){let a=o.parse(e,this);if(!a)return null;if(this.expectedType){let s=this.expectedType,l=a.type;if((s.kind==="string"||s.kind==="number"||s.kind==="boolean"||s.kind==="object"||s.kind==="array")&&l.kind==="value")a=n(a,s,r.typeAnnotation||"assert");else if((s.kind==="color"||s.kind==="formatted"||s.kind==="resolvedImage")&&(l.kind==="value"||l.kind==="string"))a=n(a,s,r.typeAnnotation||"coerce");else if(s.kind==="padding"&&(l.kind==="value"||l.kind==="number"||l.kind==="array"))a=n(a,s,r.typeAnnotation||"coerce");else if(s.kind==="variableAnchorOffsetCollection"&&(l.kind==="value"||l.kind==="array"))a=n(a,s,r.typeAnnotation||"coerce");else if(this.checkSubtype(s,l))return null}if(!(a instanceof mt)&&a.type.kind!=="resolvedImage"&&this._isConstant(a)){let s=new Vi;try{a=new mt(a.type,a.evaluate(s))}catch(l){return this.error(l.message),null}}return a}return this.error('Unknown expression "'.concat(i,'". If you wanted a literal array, use ["literal", [...]].'),0)}else return typeof e>"u"?this.error("'undefined' value invalid. Use null instead."):typeof e=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found ".concat(typeof e," instead."))}concat(e,r,n){let i=typeof e=="number"?this.path.concat(e):this.path,o=n?this.scope.concat(n):this.scope;return new t(this.registry,this._isConstant,i,r||null,o,this.errors)}error(e,...r){let n="".concat(this.key).concat(r.map(i=>"[".concat(i,"]")).join(""));this.errors.push(new Be(n,e))}checkSubtype(e,r){let n=Kr(e,r);return n&&this.error(n),n}},zi=class t{constructor(e,r){this.type=r.type,this.bindings=[].concat(e),this.result=r}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(let r of this.bindings)e(r[1]);e(this.result)}static parse(e,r){if(e.length<4)return r.error("Expected at least 3 arguments, but found ".concat(e.length-1," instead."));let n=[];for(let o=1;o<e.length-1;o+=2){let a=e[o];if(typeof a!="string")return r.error("Expected string, but found ".concat(typeof a," instead."),o);if(/[^a-zA-Z0-9_]/.test(a))return r.error("Variable names must contain only alphanumeric characters or '_'.",o);let s=r.parse(e[o+1],o+1);if(!s)return null;n.push([a,s])}let i=r.parse(e[e.length-1],e.length-1,r.expectedType,n);return i?new t(n,i):null}outputDefined(){return this.result.outputDefined()}},Ri=class t{constructor(e,r){this.type=r.type,this.name=e,this.boundExpression=r}static parse(e,r){if(e.length!==2||typeof e[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");let n=e[1];return r.scope.has(n)?new t(n,r.scope.get(n)):r.error('Unknown variable "'.concat(n,'". Make sure "').concat(n,'" has been bound in an enclosing "let" expression before using it.'),1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}},Xa=class t{constructor(e,r,n){this.type=e,this.index=r,this.input=n}static parse(e,r){if(e.length!==3)return r.error("Expected 2 arguments, but found ".concat(e.length-1," instead."));let n=r.parse(e[1],1,L),i=r.parse(e[2],2,Ee(r.expectedType||$));if(!n||!i)return null;let o=i.type;return new t(o.itemType,n,i)}evaluate(e){let r=this.index.evaluate(e),n=this.input.evaluate(e);if(r<0)throw new ie("Array index out of bounds: ".concat(r," < 0."));if(r>=n.length)throw new ie("Array index out of bounds: ".concat(r," > ").concat(n.length-1,"."));if(r!==Math.floor(r))throw new ie("Array index must be an integer, but found ".concat(r," instead."));return n[r]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}},Ka=class t{constructor(e,r){this.type=U,this.needle=e,this.haystack=r}static parse(e,r){if(e.length!==3)return r.error("Expected 2 arguments, but found ".concat(e.length-1," instead."));let n=r.parse(e[1],1,$),i=r.parse(e[2],2,$);return!n||!i?null:fs(n.type,[U,G,L,hr,$])?new t(n,i):r.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(te(n.type)," instead"))}evaluate(e){let r=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(!n)return!1;if(!Rt(r,["boolean","string","number","null"]))throw new ie("Expected first argument to be of type boolean, string, number or null, but found ".concat(te(ue(r))," instead."));if(!Rt(n,["string","array"]))throw new ie("Expected second argument to be of type array or string, but found ".concat(te(ue(n))," instead."));return n.indexOf(r)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}},Ya=class t{constructor(e,r,n){this.type=L,this.needle=e,this.haystack=r,this.fromIndex=n}static parse(e,r){if(e.length<=2||e.length>=5)return r.error("Expected 3 or 4 arguments, but found ".concat(e.length-1," instead."));let n=r.parse(e[1],1,$),i=r.parse(e[2],2,$);if(!n||!i)return null;if(!fs(n.type,[U,G,L,hr,$]))return r.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(te(n.type)," instead"));if(e.length===4){let o=r.parse(e[3],3,L);return o?new t(n,i,o):null}else return new t(n,i)}evaluate(e){let r=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(!Rt(r,["boolean","string","number","null"]))throw new ie("Expected first argument to be of type boolean, string, number or null, but found ".concat(te(ue(r))," instead."));let i;if(this.fromIndex&&(i=this.fromIndex.evaluate(e)),Rt(n,["string"])){let o=n.indexOf(r,i);return o===-1?-1:[...n.slice(0,o)].length}else{if(Rt(n,["array"]))return n.indexOf(r,i);throw new ie("Expected second argument to be of type array or string, but found ".concat(te(ue(n))," instead."))}}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}},Qa=class t{constructor(e,r,n,i,o,a){this.inputType=e,this.type=r,this.input=n,this.cases=i,this.outputs=o,this.otherwise=a}static parse(e,r){if(e.length<5)return r.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if(e.length%2!==1)return r.error("Expected an even number of arguments.");let n,i;r.expectedType&&r.expectedType.kind!=="value"&&(i=r.expectedType);let o={},a=[];for(let u=2;u<e.length-1;u+=2){let c=e[u],p=e[u+1];Array.isArray(c)||(c=[c]);let f=r.concat(u);if(c.length===0)return f.error("Expected at least one branch label.");for(let m of c){if(typeof m!="number"&&typeof m!="string")return f.error("Branch labels must be numbers or strings.");if(typeof m=="number"&&Math.abs(m)>Number.MAX_SAFE_INTEGER)return f.error("Branch labels must be integers no larger than ".concat(Number.MAX_SAFE_INTEGER,"."));if(typeof m=="number"&&Math.floor(m)!==m)return f.error("Numeric branch labels must be integer values.");if(!n)n=ue(m);else if(f.checkSubtype(n,ue(m)))return null;if(typeof o[String(m)]<"u")return f.error("Branch labels must be unique.");o[String(m)]=a.length}let y=r.parse(p,u,i);if(!y)return null;i=i||y.type,a.push(y)}let s=r.parse(e[1],1,$);if(!s)return null;let l=r.parse(e[e.length-1],e.length-1,i);return!l||s.type.kind!=="value"&&r.concat(1).checkSubtype(n,s.type)?null:new t(n,i,s,o,a,l)}evaluate(e){let r=this.input.evaluate(e);return(ue(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}},es=class t{constructor(e,r,n){this.type=e,this.branches=r,this.otherwise=n}static parse(e,r){if(e.length<4)return r.error("Expected at least 3 arguments, but found only ".concat(e.length-1,"."));if(e.length%2!==0)return r.error("Expected an odd number of arguments.");let n;r.expectedType&&r.expectedType.kind!=="value"&&(n=r.expectedType);let i=[];for(let a=1;a<e.length-1;a+=2){let s=r.parse(e[a],a,U);if(!s)return null;let l=r.parse(e[a+1],a+1,n);if(!l)return null;i.push([s,l]),n=n||l.type}let o=r.parse(e[e.length-1],e.length-1,n);if(!o)return null;if(!n)throw new Error("Can't infer output type");return new t(n,i,o)}evaluate(e){for(let[r,n]of this.branches)if(r.evaluate(e))return n.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(let[r,n]of this.branches)e(r),e(n);e(this.otherwise)}outputDefined(){return this.branches.every(([e,r])=>r.outputDefined())&&this.otherwise.outputDefined()}},ts=class t{constructor(e,r,n,i){this.type=e,this.input=r,this.beginIndex=n,this.endIndex=i}static parse(e,r){if(e.length<=2||e.length>=5)return r.error("Expected 3 or 4 arguments, but found ".concat(e.length-1," instead."));let n=r.parse(e[1],1,$),i=r.parse(e[2],2,L);if(!n||!i)return null;if(!fs(n.type,[Ee($),G,$]))return r.error("Expected first argument to be of type array or string, but found ".concat(te(n.type)," instead"));if(e.length===4){let o=r.parse(e[3],3,L);return o?new t(n.type,n,i,o):null}else return new t(n.type,n,i)}evaluate(e){let r=this.input.evaluate(e),n=this.beginIndex.evaluate(e),i;if(this.endIndex&&(i=this.endIndex.evaluate(e)),Rt(r,["string"]))return[...r].slice(n,i).join("");if(Rt(r,["array"]))return r.slice(n,i);throw new ie("Expected first argument to be of type array or string, but found ".concat(te(ue(r))," instead."))}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}};function Ki(t,e){let r=t.length-1,n=0,i=r,o=0,a,s;for(;n<=i;)if(o=Math.floor((n+i)/2),a=t[o],s=t[o+1],a<=e){if(o===r||e<s)return o;n=o+1}else if(a>e)i=o-1;else throw new ie("Input is not a number.");return 0}var yr=class t{constructor(e,r,n){this.type=e,this.input=r,this.labels=[],this.outputs=[];for(let[i,o]of n)this.labels.push(i),this.outputs.push(o)}static parse(e,r){if(e.length-1<4)return r.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if((e.length-1)%2!==0)return r.error("Expected an even number of arguments.");let n=r.parse(e[1],1,L);if(!n)return null;let i=[],o=null;r.expectedType&&r.expectedType.kind!=="value"&&(o=r.expectedType);for(let a=1;a<e.length;a+=2){let s=a===1?-1/0:e[a],l=e[a+1],u=a,c=a+1;if(typeof s!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(i.length&&i[i.length-1][0]>=s)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);let p=r.parse(l,c,o);if(!p)return null;o=o||p.type,i.push([s,p])}return new t(o,n,i)}evaluate(e){let r=this.labels,n=this.outputs;if(r.length===1)return n[0].evaluate(e);let i=this.input.evaluate(e);if(i<=r[0])return n[0].evaluate(e);let o=r.length;if(i>=r[o-1])return n[o-1].evaluate(e);let a=Ki(r,i);return n[a].evaluate(e)}eachChild(e){e(this.input);for(let r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}};function zm(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var qa,ou;function Rm(){if(ou)return qa;ou=1,qa=t;function t(e,r,n,i){this.cx=3*e,this.bx=3*(n-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(i-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=r,this.p2x=n,this.p2y=i}return t.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,r){if(r===void 0&&(r=1e-6),e<0)return 0;if(e>1)return 1;for(var n=e,i=0;i<8;i++){var o=this.sampleCurveX(n)-e;if(Math.abs(o)<r)return n;var a=this.sampleCurveDerivativeX(n);if(Math.abs(a)<1e-6)break;n=n-o/a}var s=0,l=1;for(n=e,i=0;i<20&&(o=this.sampleCurveX(n),!(Math.abs(o-e)<r));i++)e>o?s=n:l=n,n=(l-s)*.5+s;return n},solve:function(e,r){return this.sampleCurveY(this.solveCurveX(e,r))}},qa}var Om=Rm(),Nm=zm(Om);function Um(t){return t==="rgb"||t==="hcl"||t==="lab"}function Ot(t,e,r){return t+r*(e-t)}function $m(t,e,r,n="rgb"){switch(n){case"rgb":{let[i,o,a,s]=Oi(t.rgb,e.rgb,r);return new W(i,o,a,s,!1)}case"hcl":{let[i,o,a,s]=t.hcl,[l,u,c,p]=e.hcl,f,y;if(!isNaN(i)&&!isNaN(l)){let b=l-i;l>i&&b>180?b-=360:l<i&&i-l>180&&(b+=360),f=i+r*b}else isNaN(i)?isNaN(l)?f=NaN:(f=l,(a===1||a===0)&&(y=u)):(f=i,(c===1||c===0)&&(y=o));let[m,h,d,g]=Em([f,y!=null?y:Ot(o,u,r),Ot(a,c,r),Ot(s,p,r)]);return new W(m,h,d,g,!1)}case"lab":{let[i,o,a,s]=Mu(Oi(t.lab,e.lab,r));return new W(i,o,a,s,!1)}}}function Oi(t,e,r){return t.map((n,i)=>Ot(n,e[i],r))}function Gm(t,e,r){return new Ze(Oi(t.values,e.values,r))}function qm(t,e,r){let n=t.values,i=e.values;if(n.length!==i.length)throw new ie("Cannot interpolate values of different length. from: ".concat(t.toString(),", to: ").concat(e.toString()));let o=[];for(let a=0;a<n.length;a+=2){if(n[a]!==i[a])throw new ie("Cannot interpolate values containing mismatched anchors. from[".concat(a,"]: ").concat(n[a],", to[").concat(a,"]: ").concat(i[a]));o.push(n[a]);let[s,l]=n[a+1],[u,c]=i[a+1];o.push([Ot(s,u,r),Ot(l,c,r)])}return new Ne(o)}var Oe={number:Ot,color:$m,array:Oi,padding:Gm,variableAnchorOffsetCollection:qm},Je=class t{constructor(e,r,n,i,o){this.type=e,this.operator=r,this.interpolation=n,this.input=i,this.labels=[],this.outputs=[];for(let[a,s]of o)this.labels.push(a),this.outputs.push(s)}static interpolationFactor(e,r,n,i){let o=0;if(e.name==="exponential")o=ja(r,e.base,n,i);else if(e.name==="linear")o=ja(r,1,n,i);else if(e.name==="cubic-bezier"){let a=e.controlPoints;o=new Nm(a[0],a[1],a[2],a[3]).solve(ja(r,1,n,i))}return o}static parse(e,r){let[n,i,o,...a]=e;if(!Array.isArray(i)||i.length===0)return r.error("Expected an interpolation type expression.",1);if(i[0]==="linear")i={name:"linear"};else if(i[0]==="exponential"){let u=i[1];if(typeof u!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:u}}else if(i[0]==="cubic-bezier"){let u=i.slice(1);if(u.length!==4||u.some(c=>typeof c!="number"||c<0||c>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:u}}else return r.error("Unknown interpolation type ".concat(String(i[0])),1,0);if(e.length-1<4)return r.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if((e.length-1)%2!==0)return r.error("Expected an even number of arguments.");if(o=r.parse(o,2,L),!o)return null;let s=[],l=null;n==="interpolate-hcl"||n==="interpolate-lab"?l=Re:r.expectedType&&r.expectedType.kind!=="value"&&(l=r.expectedType);for(let u=0;u<a.length;u+=2){let c=a[u],p=a[u+1],f=u+3,y=u+4;if(typeof c!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',f);if(s.length&&s[s.length-1][0]>=c)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',f);let m=r.parse(p,y,l);if(!m)return null;l=l||m.type,s.push([c,m])}return!Zr(l,L)&&!Zr(l,Re)&&!Zr(l,Hi)&&!Zr(l,Xi)&&!Zr(l,Ee(L))?r.error("Type ".concat(te(l)," is not interpolatable.")):new t(l,n,i,o,s)}evaluate(e){let r=this.labels,n=this.outputs;if(r.length===1)return n[0].evaluate(e);let i=this.input.evaluate(e);if(i<=r[0])return n[0].evaluate(e);let o=r.length;if(i>=r[o-1])return n[o-1].evaluate(e);let a=Ki(r,i),s=r[a],l=r[a+1],u=t.interpolationFactor(this.interpolation,i,s,l),c=n[a].evaluate(e),p=n[a+1].evaluate(e);switch(this.operator){case"interpolate":return Oe[this.type.kind](c,p,u);case"interpolate-hcl":return Oe.color(c,p,u,"hcl");case"interpolate-lab":return Oe.color(c,p,u,"lab")}}eachChild(e){e(this.input);for(let r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}};function ja(t,e,r,n){let i=n-r,o=t-r;return i===0?0:e===1?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}var Ni=class t{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let n=null,i=r.expectedType;i&&i.kind!=="value"&&(n=i);let o=[];for(let s of e.slice(1)){let l=r.parse(s,1+o.length,n,void 0,{typeAnnotation:"omit"});if(!l)return null;n=n||l.type,o.push(l)}if(!n)throw new Error("No output type");return i&&o.some(s=>Kr(i,s.type))?new t($,o):new t(n,o)}evaluate(e){let r=null,n=0,i;for(let o of this.args)if(n++,r=o.evaluate(e),r&&r instanceof Te&&!r.available&&(i||(i=r.name),r=null,n===this.args.length&&(r=i)),r!==null)break;return r}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}};function au(t,e){return t==="=="||t==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function jm(t,e,r){return e===r}function Jm(t,e,r){return e!==r}function Zm(t,e,r){return e<r}function Wm(t,e,r){return e>r}function Hm(t,e,r){return e<=r}function Xm(t,e,r){return e>=r}function Fu(t,e,r,n){return n.compare(e,r)===0}function Km(t,e,r,n){return!Fu(t,e,r,n)}function Ym(t,e,r,n){return n.compare(e,r)<0}function Qm(t,e,r,n){return n.compare(e,r)>0}function eh(t,e,r,n){return n.compare(e,r)<=0}function th(t,e,r,n){return n.compare(e,r)>=0}function gr(t,e,r){let n=t!=="=="&&t!=="!=";return class Lu{constructor(o,a,s){this.type=U,this.lhs=o,this.rhs=a,this.collator=s,this.hasUntypedArgument=o.type.kind==="value"||a.type.kind==="value"}static parse(o,a){if(o.length!==3&&o.length!==4)return a.error("Expected two or three arguments.");let s=o[0],l=a.parse(o[1],1,$);if(!l)return null;if(!au(s,l.type))return a.concat(1).error('"'.concat(s,"\\" comparisons are not supported for type '").concat(te(l.type),"'."));let u=a.parse(o[2],2,$);if(!u)return null;if(!au(s,u.type))return a.concat(2).error('"'.concat(s,"\\" comparisons are not supported for type '").concat(te(u.type),"'."));if(l.type.kind!==u.type.kind&&l.type.kind!=="value"&&u.type.kind!=="value")return a.error("Cannot compare types '".concat(te(l.type),"' and '").concat(te(u.type),"'."));n&&(l.type.kind==="value"&&u.type.kind!=="value"?l=new je(u.type,[l]):l.type.kind!=="value"&&u.type.kind==="value"&&(u=new je(l.type,[u])));let c=null;if(o.length===4){if(l.type.kind!=="string"&&u.type.kind!=="string"&&l.type.kind!=="value"&&u.type.kind!=="value")return a.error("Cannot use collator to compare non-string types.");if(c=a.parse(o[3],3,Wi),!c)return null}return new Lu(l,u,c)}evaluate(o){let a=this.lhs.evaluate(o),s=this.rhs.evaluate(o);if(n&&this.hasUntypedArgument){let l=ue(a),u=ue(s);if(l.kind!==u.kind||!(l.kind==="string"||l.kind==="number"))throw new ie('Expected arguments for "'.concat(t,'" to be (string, string) or (number, number), but found (').concat(l.kind,", ").concat(u.kind,") instead."))}if(this.collator&&!n&&this.hasUntypedArgument){let l=ue(a),u=ue(s);if(l.kind!=="string"||u.kind!=="string")return e(o,a,s)}return this.collator?r(o,a,s,this.collator.evaluate(o)):e(o,a,s)}eachChild(o){o(this.lhs),o(this.rhs),this.collator&&o(this.collator)}outputDefined(){return!0}}}var rh=gr("==",jm,Fu),nh=gr("!=",Jm,Km),ih=gr("<",Zm,Ym),oh=gr(">",Wm,Qm),ah=gr("<=",Hm,eh),sh=gr(">=",Xm,th),Ui=class t{constructor(e,r,n){this.type=Wi,this.locale=n,this.caseSensitive=e,this.diacriticSensitive=r}static parse(e,r){if(e.length!==2)return r.error("Expected one argument.");let n=e[1];if(typeof n!="object"||Array.isArray(n))return r.error("Collator options argument must be an object.");let i=r.parse(n["case-sensitive"]===void 0?!1:n["case-sensitive"],1,U);if(!i)return null;let o=r.parse(n["diacritic-sensitive"]===void 0?!1:n["diacritic-sensitive"],1,U);if(!o)return null;let a=null;return n.locale&&(a=r.parse(n.locale,1,G),!a)?null:new t(i,o,a)}evaluate(e){return new Yr(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}},rs=class t{constructor(e,r,n,i,o){this.type=G,this.number=e,this.locale=r,this.currency=n,this.minFractionDigits=i,this.maxFractionDigits=o}static parse(e,r){if(e.length!==3)return r.error("Expected two arguments.");let n=r.parse(e[1],1,L);if(!n)return null;let i=e[2];if(typeof i!="object"||Array.isArray(i))return r.error("NumberFormat options argument must be an object.");let o=null;if(i.locale&&(o=r.parse(i.locale,1,G),!o))return null;let a=null;if(i.currency&&(a=r.parse(i.currency,1,G),!a))return null;let s=null;if(i["min-fraction-digits"]&&(s=r.parse(i["min-fraction-digits"],1,L),!s))return null;let l=null;return i["max-fraction-digits"]&&(l=r.parse(i["max-fraction-digits"],1,L),!l)?null:new t(n,o,a,s,l)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}},tn=class t{constructor(e){this.type=dr,this.sections=e}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let n=e[1];if(!Array.isArray(n)&&typeof n=="object")return r.error("First argument must be an image or text section.");let i=[],o=!1;for(let a=1;a<=e.length-1;++a){let s=e[a];if(o&&typeof s=="object"&&!Array.isArray(s)){o=!1;let l=null;if(s["font-scale"]&&(l=r.parse(s["font-scale"],1,L),!l))return null;let u=null;if(s["text-font"]&&(u=r.parse(s["text-font"],1,Ee(G)),!u))return null;let c=null;if(s["text-color"]&&(c=r.parse(s["text-color"],1,Re),!c))return null;let p=i[i.length-1];p.scale=l,p.font=u,p.textColor=c}else{let l=r.parse(e[a],1,$);if(!l)return null;let u=l.type.kind;if(u!=="string"&&u!=="value"&&u!=="null"&&u!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");o=!0,i.push({content:l,scale:null,font:null,textColor:null})}}return new t(i)}evaluate(e){let r=n=>{let i=n.content.evaluate(e);return ue(i)===cn?new Qr("",i,null,null,null):new Qr(Hr(i),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)};return new Fe(this.sections.map(r))}eachChild(e){for(let r of this.sections)e(r.content),r.scale&&e(r.scale),r.font&&e(r.font),r.textColor&&e(r.textColor)}outputDefined(){return!1}},ns=class t{constructor(e){this.type=cn,this.input=e}static parse(e,r){if(e.length!==2)return r.error("Expected two arguments.");let n=r.parse(e[1],1,G);return n?new t(n):r.error("No image name provided.")}evaluate(e){let r=this.input.evaluate(e),n=Te.fromString(r);return n&&e.availableImages&&(n.available=e.availableImages.indexOf(r)>-1),n}eachChild(e){e(this.input)}outputDefined(){return!1}},is=class t{constructor(e){this.type=L,this.input=e}static parse(e,r){if(e.length!==2)return r.error("Expected 1 argument, but found ".concat(e.length-1," instead."));let n=r.parse(e[1],1);return n?n.type.kind!=="array"&&n.type.kind!=="string"&&n.type.kind!=="value"?r.error("Expected argument of type string or array, but found ".concat(te(n.type)," instead.")):new t(n):null}evaluate(e){let r=this.input.evaluate(e);if(typeof r=="string")return[...r].length;if(Array.isArray(r))return r.length;throw new ie("Expected value to be of type string or array, but found ".concat(te(ue(r))," instead."))}eachChild(e){e(this.input)}outputDefined(){return!1}},Xe=8192;function lh(t,e){let r=uh(t[0]),n=ph(t[1]),i=Math.pow(2,e.z);return[Math.round(r*i*Xe),Math.round(n*i*Xe)]}function ys(t,e){let r=Math.pow(2,e.z),n=(t[0]/Xe+e.x)/r,i=(t[1]/Xe+e.y)/r;return[ch(n),fh(i)]}function uh(t){return(180+t)/360}function ch(t){return t*360-180}function ph(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function fh(t){return 360/Math.PI*Math.atan(Math.exp((180-t*360)*Math.PI/180))-90}function pn(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function rn(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function yh(t,e,r){return e[1]>t[1]!=r[1]>t[1]&&t[0]<(r[0]-e[0])*(t[1]-e[1])/(r[1]-e[1])+e[0]}function mh(t,e,r){let n=t[0]-e[0],i=t[1]-e[1],o=t[0]-r[0],a=t[1]-r[1];return n*a-o*i===0&&n*o<=0&&i*a<=0}function Yi(t,e,r,n){let i=[e[0]-t[0],e[1]-t[1]],o=[n[0]-r[0],n[1]-r[1]];return xh(o,i)===0?!1:!!(su(t,e,r,n)&&su(r,n,t,e))}function hh(t,e,r){for(let n of r)for(let i=0;i<n.length-1;++i)if(Yi(t,e,n[i],n[i+1]))return!0;return!1}function xr(t,e,r=!1){let n=!1;for(let i of e)for(let o=0;o<i.length-1;o++){if(mh(t,i[o],i[o+1]))return r;yh(t,i[o],i[o+1])&&(n=!n)}return n}function dh(t,e){for(let r of e)if(xr(t,r))return!0;return!1}function Du(t,e){for(let r of t)if(!xr(r,e))return!1;for(let r=0;r<t.length-1;++r)if(hh(t[r],t[r+1],e))return!1;return!0}function gh(t,e){for(let r of e)if(Du(t,r))return!0;return!1}function xh(t,e){return t[0]*e[1]-t[1]*e[0]}function su(t,e,r,n){let i=t[0]-r[0],o=t[1]-r[1],a=e[0]-r[0],s=e[1]-r[1],l=n[0]-r[0],u=n[1]-r[1],c=i*u-l*o,p=a*u-l*s;return c>0&&p<0||c<0&&p>0}function ms(t,e,r){let n=[];for(let i=0;i<t.length;i++){let o=[];for(let a=0;a<t[i].length;a++){let s=lh(t[i][a],r);pn(e,s),o.push(s)}n.push(o)}return n}function Vu(t,e,r){let n=[];for(let i=0;i<t.length;i++){let o=ms(t[i],e,r);n.push(o)}return n}function Bu(t,e,r,n){if(t[0]<r[0]||t[0]>r[2]){let i=n*.5,o=t[0]-r[0]>i?-n:r[0]-t[0]>i?n:0;o===0&&(o=t[0]-r[2]>i?-n:r[2]-t[0]>i?n:0),t[0]+=o}pn(e,t)}function bh(t){t[0]=t[1]=1/0,t[2]=t[3]=-1/0}function lu(t,e,r,n){let i=Math.pow(2,n.z)*Xe,o=[n.x*Xe,n.y*Xe],a=[];for(let s of t)for(let l of s){let u=[l.x+o[0],l.y+o[1]];Bu(u,e,r,i),a.push(u)}return a}function uu(t,e,r,n){let i=Math.pow(2,n.z)*Xe,o=[n.x*Xe,n.y*Xe],a=[];for(let s of t){let l=[];for(let u of s){let c=[u.x+o[0],u.y+o[1]];pn(e,c),l.push(c)}a.push(l)}if(e[2]-e[0]<=i/2){bh(e);for(let s of a)for(let l of s)Bu(l,e,r,i)}return a}function vh(t,e){let r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if(e.type==="Polygon"){let o=ms(e.coordinates,n,i),a=lu(t.geometry(),r,n,i);if(!rn(r,n))return!1;for(let s of a)if(!xr(s,o))return!1}if(e.type==="MultiPolygon"){let o=Vu(e.coordinates,n,i),a=lu(t.geometry(),r,n,i);if(!rn(r,n))return!1;for(let s of a)if(!dh(s,o))return!1}return!0}function Ph(t,e){let r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if(e.type==="Polygon"){let o=ms(e.coordinates,n,i),a=uu(t.geometry(),r,n,i);if(!rn(r,n))return!1;for(let s of a)if(!Du(s,o))return!1}if(e.type==="MultiPolygon"){let o=Vu(e.coordinates,n,i),a=uu(t.geometry(),r,n,i);if(!rn(r,n))return!1;for(let s of a)if(!gh(s,o))return!1}return!0}var nn=class t{constructor(e,r){this.type=U,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error("'within' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(en(e[1])){let n=e[1];if(n.type==="FeatureCollection"){let i=[];for(let o of n.features){let{type:a,coordinates:s}=o.geometry;a==="Polygon"&&i.push(s),a==="MultiPolygon"&&i.push(...s)}if(i.length){let o={type:"MultiPolygon",coordinates:i};return new t(n,o)}}else if(n.type==="Feature"){let i=n.geometry.type;if(i==="Polygon"||i==="MultiPolygon")return new t(n,n.geometry)}else if(n.type==="Polygon"||n.type==="MultiPolygon")return new t(n,n)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return vh(e,this.geometries);if(e.geometryType()==="LineString")return Ph(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}},$i=class{constructor(e=[],r=(n,i)=>n<i?-1:n>i?1:0){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;let e=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:r,compare:n}=this,i=r[e];for(;e>0;){let o=e-1>>1,a=r[o];if(n(i,a)>=0)break;r[e]=a,e=o}r[e]=i}_down(e){let{data:r,compare:n}=this,i=this.length>>1,o=r[e];for(;e<i;){let a=(e<<1)+1,s=a+1;if(s<this.length&&n(r[s],r[a])<0&&(a=s),n(r[a],o)>=0)break;r[e]=r[a],e=a}r[e]=o}};function Sh(t,e,r,n,i){zu(t,e,r,n||t.length-1,i||wh)}function zu(t,e,r,n,i){for(;n>r;){if(n-r>600){var o=n-r+1,a=e-r+1,s=Math.log(o),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(o-l)/o)*(a-o/2<0?-1:1),c=Math.max(r,Math.floor(e-a*l/o+u)),p=Math.min(n,Math.floor(e+(o-a)*l/o+u));zu(t,e,c,p,i)}var f=t[e],y=r,m=n;for(Wr(t,r,e),i(t[n],f)>0&&Wr(t,r,n);y<m;){for(Wr(t,y,m),y++,m--;i(t[y],f)<0;)y++;for(;i(t[m],f)>0;)m--}i(t[r],f)===0?Wr(t,r,m):(m++,Wr(t,m,n)),m<=e&&(r=m+1),e<=m&&(n=m-1)}}function Wr(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function wh(t,e){return t<e?-1:t>e?1:0}function Ah(t,e){if(t.length<=1)return[t];let n=[],i,o;for(let a of t){let s=Ih(a);s!==0&&(a.area=Math.abs(s),o===void 0&&(o=s<0),o===s<0?(i&&n.push(i),i=[a]):i.push(a))}if(i&&n.push(i),e>1)for(let a=0;a<n.length;a++)n[a].length<=e||(Sh(n[a],e,1,n[a].length-1,_h),n[a]=n[a].slice(0,e));return n}function _h(t,e){return e.area-t.area}function Ih(t){let e=0;for(let r=0,n=t.length,i=n-1,o,a;r<n;i=r++)o=t[r],a=t[i],e+=(a.x-o.x)*(o.y+a.y);return e}var Th=6378.137,cu=1/298.257223563,pu=cu*(2-cu),fu=Math.PI/180,on=class{constructor(e){let r=fu*Th*1e3,n=Math.cos(e*fu),i=1/(1-pu*(1-n*n)),o=Math.sqrt(i);this.kx=r*o*n,this.ky=r*o*i*(1-pu)}distance(e,r){let n=this.wrap(e[0]-r[0])*this.kx,i=(e[1]-r[1])*this.ky;return Math.sqrt(n*n+i*i)}pointOnLine(e,r){let n=1/0,i,o,a,s;for(let l=0;l<e.length-1;l++){let u=e[l][0],c=e[l][1],p=this.wrap(e[l+1][0]-u)*this.kx,f=(e[l+1][1]-c)*this.ky,y=0;(p!==0||f!==0)&&(y=(this.wrap(r[0]-u)*this.kx*p+(r[1]-c)*this.ky*f)/(p*p+f*f),y>1?(u=e[l+1][0],c=e[l+1][1]):y>0&&(u+=p/this.kx*y,c+=f/this.ky*y)),p=this.wrap(r[0]-u)*this.kx,f=(r[1]-c)*this.ky;let m=p*p+f*f;m<n&&(n=m,i=u,o=c,a=l,s=y)}return{point:[i,o],index:a,t:Math.max(0,Math.min(1,s))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}},os=100,as=50;function Ru(t,e){return e[0]-t[0]}function Gi(t){return t[1]-t[0]+1}function st(t,e){return t[1]>=t[0]&&t[1]<e}function ss(t,e){if(t[0]>t[1])return[null,null];let r=Gi(t);if(e){if(r===2)return[t,null];let i=Math.floor(r/2);return[[t[0],t[0]+i],[t[0]+i,t[1]]]}if(r===1)return[t,null];let n=Math.floor(r/2)-1;return[[t[0],t[0]+n],[t[0]+n+1,t[1]]]}function ls(t,e){if(!st(e,t.length))return[1/0,1/0,-1/0,-1/0];let r=[1/0,1/0,-1/0,-1/0];for(let n=e[0];n<=e[1];++n)pn(r,t[n]);return r}function us(t){let e=[1/0,1/0,-1/0,-1/0];for(let r of t)for(let n of r)pn(e,n);return e}function yu(t){return t[0]!==-1/0&&t[1]!==-1/0&&t[2]!==1/0&&t[3]!==1/0}function hs(t,e,r){if(!yu(t)||!yu(e))return NaN;let n=0,i=0;return t[2]<e[0]&&(n=e[0]-t[2]),t[0]>e[2]&&(n=t[0]-e[2]),t[1]>e[3]&&(i=t[1]-e[3]),t[3]<e[1]&&(i=e[1]-t[3]),r.distance([0,0],[n,i])}function zt(t,e,r){let n=r.pointOnLine(e,t);return r.distance(t,n.point)}function ds(t,e,r,n,i){let o=Math.min(zt(t,[r,n],i),zt(e,[r,n],i)),a=Math.min(zt(r,[t,e],i),zt(n,[t,e],i));return Math.min(o,a)}function Ch(t,e,r,n,i){if(!(st(e,t.length)&&st(n,r.length)))return 1/0;let a=1/0;for(let s=e[0];s<e[1];++s){let l=t[s],u=t[s+1];for(let c=n[0];c<n[1];++c){let p=r[c],f=r[c+1];if(Yi(l,u,p,f))return 0;a=Math.min(a,ds(l,u,p,f,i))}}return a}function kh(t,e,r,n,i){if(!(st(e,t.length)&&st(n,r.length)))return NaN;let a=1/0;for(let s=e[0];s<=e[1];++s)for(let l=n[0];l<=n[1];++l)if(a=Math.min(a,i.distance(t[s],r[l])),a===0)return a;return a}function Mh(t,e,r){if(xr(t,e,!0))return 0;let n=1/0;for(let i of e){let o=i[0],a=i[i.length-1];if(o!==a&&(n=Math.min(n,zt(t,[a,o],r)),n===0))return n;let s=r.pointOnLine(i,t);if(n=Math.min(n,r.distance(t,s.point)),n===0)return n}return n}function Eh(t,e,r,n){if(!st(e,t.length))return NaN;for(let o=e[0];o<=e[1];++o)if(xr(t[o],r,!0))return 0;let i=1/0;for(let o=e[0];o<e[1];++o){let a=t[o],s=t[o+1];for(let l of r)for(let u=0,c=l.length,p=c-1;u<c;p=u++){let f=l[p],y=l[u];if(Yi(a,s,f,y))return 0;i=Math.min(i,ds(a,s,f,y,n))}}return i}function mu(t,e){for(let r of t)for(let n of r)if(xr(n,e,!0))return!0;return!1}function Fh(t,e,r,n=1/0){let i=us(t),o=us(e);if(n!==1/0&&hs(i,o,r)>=n)return n;if(rn(i,o)){if(mu(t,e))return 0}else if(mu(e,t))return 0;let a=1/0;for(let s of t)for(let l=0,u=s.length,c=u-1;l<u;c=l++){let p=s[c],f=s[l];for(let y of e)for(let m=0,h=y.length,d=h-1;m<h;d=m++){let g=y[d],b=y[m];if(Yi(p,f,g,b))return 0;a=Math.min(a,ds(p,f,g,b,r))}}return a}function hu(t,e,r,n,i,o){if(!o)return;let a=hs(ls(n,o),i,r);a<e&&t.push([a,o,[0,0]])}function Fi(t,e,r,n,i,o,a){if(!o||!a)return;let s=hs(ls(n,o),ls(i,a),r);s<e&&t.push([s,o,a])}function qi(t,e,r,n,i=1/0){let o=Math.min(n.distance(t[0],r[0][0]),i);if(o===0)return o;let a=new $i([[0,[0,t.length-1],[0,0]]],Ru),s=us(r);for(;a.length>0;){let l=a.pop();if(l[0]>=o)continue;let u=l[1],c=e?as:os;if(Gi(u)<=c){if(!st(u,t.length))return NaN;if(e){let p=Eh(t,u,r,n);if(isNaN(p)||p===0)return p;o=Math.min(o,p)}else for(let p=u[0];p<=u[1];++p){let f=Mh(t[p],r,n);if(o=Math.min(o,f),o===0)return 0}}else{let p=ss(u,e);hu(a,o,n,t,s,p[0]),hu(a,o,n,t,s,p[1])}}return o}function ji(t,e,r,n,i,o=1/0){let a=Math.min(o,i.distance(t[0],r[0]));if(a===0)return a;let s=new $i([[0,[0,t.length-1],[0,r.length-1]]],Ru);for(;s.length>0;){let l=s.pop();if(l[0]>=a)continue;let u=l[1],c=l[2],p=e?as:os,f=n?as:os;if(Gi(u)<=p&&Gi(c)<=f){if(!st(u,t.length)&&st(c,r.length))return NaN;let y;if(e&&n)y=Ch(t,u,r,c,i),a=Math.min(a,y);else if(e&&!n){let m=t.slice(u[0],u[1]+1);for(let h=c[0];h<=c[1];++h)if(y=zt(r[h],m,i),a=Math.min(a,y),a===0)return a}else if(!e&&n){let m=r.slice(c[0],c[1]+1);for(let h=u[0];h<=u[1];++h)if(y=zt(t[h],m,i),a=Math.min(a,y),a===0)return a}else y=kh(t,u,r,c,i),a=Math.min(a,y)}else{let y=ss(u,e),m=ss(c,n);Fi(s,a,i,t,r,y[0],m[0]),Fi(s,a,i,t,r,y[0],m[1]),Fi(s,a,i,t,r,y[1],m[0]),Fi(s,a,i,t,r,y[1],m[1])}}return a}function Lh(t,e){let r=t.geometry(),n=r.flat().map(a=>ys([a.x,a.y],t.canonical));if(r.length===0)return NaN;let i=new on(n[0][1]),o=1/0;for(let a of e){switch(a.type){case"Point":o=Math.min(o,ji(n,!1,[a.coordinates],!1,i,o));break;case"LineString":o=Math.min(o,ji(n,!1,a.coordinates,!0,i,o));break;case"Polygon":o=Math.min(o,qi(n,!1,a.coordinates,i,o));break}if(o===0)return o}return o}function Dh(t,e){let r=t.geometry(),n=r.flat().map(a=>ys([a.x,a.y],t.canonical));if(r.length===0)return NaN;let i=new on(n[0][1]),o=1/0;for(let a of e){switch(a.type){case"Point":o=Math.min(o,ji(n,!0,[a.coordinates],!1,i,o));break;case"LineString":o=Math.min(o,ji(n,!0,a.coordinates,!0,i,o));break;case"Polygon":o=Math.min(o,qi(n,!0,a.coordinates,i,o));break}if(o===0)return o}return o}function Vh(t,e){let r=t.geometry();if(r.length===0||r[0].length===0)return NaN;let n=Ah(r,0).map(a=>a.map(s=>s.map(l=>ys([l.x,l.y],t.canonical)))),i=new on(n[0][0][0][1]),o=1/0;for(let a of e)for(let s of n){switch(a.type){case"Point":o=Math.min(o,qi([a.coordinates],!1,s,i,o));break;case"LineString":o=Math.min(o,qi(a.coordinates,!0,s,i,o));break;case"Polygon":o=Math.min(o,Fh(s,a.coordinates,i,o));break}if(o===0)return o}return o}function Ja(t){return t.type==="MultiPolygon"?t.coordinates.map(e=>({type:"Polygon",coordinates:e})):t.type==="MultiLineString"?t.coordinates.map(e=>({type:"LineString",coordinates:e})):t.type==="MultiPoint"?t.coordinates.map(e=>({type:"Point",coordinates:e})):[t]}var an=class t{constructor(e,r){this.type=L,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error("'distance' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(en(e[1])){let n=e[1];if(n.type==="FeatureCollection")return new t(n,n.features.map(i=>Ja(i.geometry)).flat());if(n.type==="Feature")return new t(n,Ja(n.geometry));if("type"in n&&"coordinates"in n)return new t(n,Ja(n))}return r.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return Lh(e,this.geometries);if(e.geometryType()==="LineString")return Dh(e,this.geometries);if(e.geometryType()==="Polygon")return Vh(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}},Gt={"==":rh,"!=":nh,">":oh,"<":ih,">=":sh,"<=":ah,array:je,at:Xa,boolean:je,case:es,coalesce:Ni,collator:Ui,format:tn,image:ns,in:Ka,"index-of":Ya,interpolate:Je,"interpolate-hcl":Je,"interpolate-lab":Je,length:is,let:zi,literal:mt,match:Qa,number:je,"number-format":rs,object:je,slice:ts,step:yr,string:je,"to-boolean":yt,"to-color":yt,"to-number":yt,"to-string":yt,var:Ri,within:nn,distance:an},Ke=class t{constructor(e,r,n,i){this.name=e,this.type=r,this._evaluate=n,this.args=i}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,r){let n=e[0],i=t.definitions[n];if(!i)return r.error('Unknown expression "'.concat(n,'". If you wanted a literal array, use ["literal", [...]].'),0);let o=Array.isArray(i)?i[0]:i.type,a=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,s=a.filter(([u])=>!Array.isArray(u)||u.length===e.length-1),l=null;for(let[u,c]of s){l=new Bi(r.registry,Ji,r.path,null,r.scope);let p=[],f=!1;for(let y=1;y<e.length;y++){let m=e[y],h=Array.isArray(u)?u[y-1]:u.type,d=l.parse(m,1+p.length,h);if(!d){f=!0;break}p.push(d)}if(!f){if(Array.isArray(u)&&u.length!==p.length){l.error("Expected ".concat(u.length," arguments, but found ").concat(p.length," instead."));continue}for(let y=0;y<p.length;y++){let m=Array.isArray(u)?u[y]:u.type,h=p[y];l.concat(y+1).checkSubtype(m,h.type)}if(l.errors.length===0)return new t(n,o,c,p)}}if(s.length===1)r.errors.push(...l.errors);else{let c=(s.length?s:a).map(([f])=>zh(f)).join(" | "),p=[];for(let f=1;f<e.length;f++){let y=r.parse(e[f],1+p.length);if(!y)return null;p.push(te(y.type))}r.error("Expected arguments of type ".concat(c,", but found (").concat(p.join(", "),") instead."))}return null}static register(e,r){t.definitions=r;for(let n in r)e[n]=t}};function du(t,[e,r,n,i]){e=e.evaluate(t),r=r.evaluate(t),n=n.evaluate(t);let o=i?i.evaluate(t):1,a=Eu(e,r,n,o);if(a)throw new ie(a);return new W(e/255,r/255,n/255,o,!1)}function gu(t,e){return t in e}function Za(t,e){let r=e[t];return typeof r>"u"?null:r}function Bh(t,e,r,n){for(;r<=n;){let i=r+n>>1;if(e[i]===t)return!0;e[i]>t?n=i-1:r=i+1}return!1}function Bt(t){return{type:t}}Ke.register(Gt,{error:[_m,[G],(t,[e])=>{throw new ie(e.evaluate(t))}],typeof:[G,[$],(t,[e])=>te(ue(e.evaluate(t)))],"to-rgba":[Ee(L,4),[Re],(t,[e])=>{let[r,n,i,o]=e.evaluate(t).rgb;return[r*255,n*255,i*255,o]}],rgb:[Re,[L,L,L],du],rgba:[Re,[L,L,L,L],du],has:{type:U,overloads:[[[G],(t,[e])=>gu(e.evaluate(t),t.properties())],[[G,cr],(t,[e,r])=>gu(e.evaluate(t),r.evaluate(t))]]},get:{type:$,overloads:[[[G],(t,[e])=>Za(e.evaluate(t),t.properties())],[[G,cr],(t,[e,r])=>Za(e.evaluate(t),r.evaluate(t))]]},"feature-state":[$,[G],(t,[e])=>Za(e.evaluate(t),t.featureState||{})],properties:[cr,[],t=>t.properties()],"geometry-type":[G,[],t=>t.geometryType()],id:[$,[],t=>t.id()],zoom:[L,[],t=>t.globals.zoom],"heatmap-density":[L,[],t=>t.globals.heatmapDensity||0],"line-progress":[L,[],t=>t.globals.lineProgress||0],accumulated:[$,[],t=>t.globals.accumulated===void 0?null:t.globals.accumulated],"+":[L,Bt(L),(t,e)=>{let r=0;for(let n of e)r+=n.evaluate(t);return r}],"*":[L,Bt(L),(t,e)=>{let r=1;for(let n of e)r*=n.evaluate(t);return r}],"-":{type:L,overloads:[[[L,L],(t,[e,r])=>e.evaluate(t)-r.evaluate(t)],[[L],(t,[e])=>-e.evaluate(t)]]},"/":[L,[L,L],(t,[e,r])=>e.evaluate(t)/r.evaluate(t)],"%":[L,[L,L],(t,[e,r])=>e.evaluate(t)%r.evaluate(t)],ln2:[L,[],()=>Math.LN2],pi:[L,[],()=>Math.PI],e:[L,[],()=>Math.E],"^":[L,[L,L],(t,[e,r])=>Math.pow(e.evaluate(t),r.evaluate(t))],sqrt:[L,[L],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[L,[L],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[L,[L],(t,[e])=>Math.log(e.evaluate(t))],log2:[L,[L],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[L,[L],(t,[e])=>Math.sin(e.evaluate(t))],cos:[L,[L],(t,[e])=>Math.cos(e.evaluate(t))],tan:[L,[L],(t,[e])=>Math.tan(e.evaluate(t))],asin:[L,[L],(t,[e])=>Math.asin(e.evaluate(t))],acos:[L,[L],(t,[e])=>Math.acos(e.evaluate(t))],atan:[L,[L],(t,[e])=>Math.atan(e.evaluate(t))],min:[L,Bt(L),(t,e)=>Math.min(...e.map(r=>r.evaluate(t)))],max:[L,Bt(L),(t,e)=>Math.max(...e.map(r=>r.evaluate(t)))],abs:[L,[L],(t,[e])=>Math.abs(e.evaluate(t))],round:[L,[L],(t,[e])=>{let r=e.evaluate(t);return r<0?-Math.round(-r):Math.round(r)}],floor:[L,[L],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[L,[L],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[U,[G,$],(t,[e,r])=>t.properties()[e.value]===r.value],"filter-id-==":[U,[$],(t,[e])=>t.id()===e.value],"filter-type-==":[U,[G],(t,[e])=>t.geometryType()===e.value],"filter-<":[U,[G,$],(t,[e,r])=>{let n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n<i}],"filter-id-<":[U,[$],(t,[e])=>{let r=t.id(),n=e.value;return typeof r==typeof n&&r<n}],"filter->":[U,[G,$],(t,[e,r])=>{let n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n>i}],"filter-id->":[U,[$],(t,[e])=>{let r=t.id(),n=e.value;return typeof r==typeof n&&r>n}],"filter-<=":[U,[G,$],(t,[e,r])=>{let n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n<=i}],"filter-id-<=":[U,[$],(t,[e])=>{let r=t.id(),n=e.value;return typeof r==typeof n&&r<=n}],"filter->=":[U,[G,$],(t,[e,r])=>{let n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n>=i}],"filter-id->=":[U,[$],(t,[e])=>{let r=t.id(),n=e.value;return typeof r==typeof n&&r>=n}],"filter-has":[U,[$],(t,[e])=>e.value in t.properties()],"filter-has-id":[U,[],t=>t.id()!==null&&t.id()!==void 0],"filter-type-in":[U,[Ee(G)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[U,[Ee($)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[U,[G,Ee($)],(t,[e,r])=>r.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[U,[G,Ee($)],(t,[e,r])=>Bh(t.properties()[e.value],r.value,0,r.value.length-1)],all:{type:U,overloads:[[[U,U],(t,[e,r])=>e.evaluate(t)&&r.evaluate(t)],[Bt(U),(t,e)=>{for(let r of e)if(!r.evaluate(t))return!1;return!0}]]},any:{type:U,overloads:[[[U,U],(t,[e,r])=>e.evaluate(t)||r.evaluate(t)],[Bt(U),(t,e)=>{for(let r of e)if(r.evaluate(t))return!0;return!1}]]},"!":[U,[U],(t,[e])=>!e.evaluate(t)],"is-supported-script":[U,[G],(t,[e])=>{let r=t.globals&&t.globals.isSupportedScript;return r?r(e.evaluate(t)):!0}],upcase:[G,[G],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[G,[G],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[G,Bt($),(t,e)=>e.map(r=>Hr(r.evaluate(t))).join("")],"resolved-locale":[G,[Wi],(t,[e])=>e.evaluate(t).resolvedLocale()]});function zh(t){return Array.isArray(t)?"(".concat(t.map(te).join(", "),")"):"(".concat(te(t.type),"...)")}function Ji(t){if(t instanceof Ri)return Ji(t.boundExpression);if(t instanceof Ke&&t.name==="error")return!1;if(t instanceof Ui)return!1;if(t instanceof nn)return!1;if(t instanceof an)return!1;let e=t instanceof yt||t instanceof je,r=!0;return t.eachChild(n=>{e?r=r&&Ji(n):r=r&&n instanceof mt}),r?Qi(t)&&eo(t,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}function Qi(t){if(t instanceof Ke){if(t.name==="get"&&t.args.length===1)return!1;if(t.name==="feature-state")return!1;if(t.name==="has"&&t.args.length===1)return!1;if(t.name==="properties"||t.name==="geometry-type"||t.name==="id")return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof nn||t instanceof an)return!1;let e=!0;return t.eachChild(r=>{e&&!Qi(r)&&(e=!1)}),e}function sn(t){if(t instanceof Ke&&t.name==="feature-state")return!1;let e=!0;return t.eachChild(r=>{e&&!sn(r)&&(e=!1)}),e}function eo(t,e){if(t instanceof Ke&&e.indexOf(t.name)>=0)return!1;let r=!0;return t.eachChild(n=>{r&&!eo(n,e)&&(r=!1)}),r}function cs(t){return{result:"success",value:t}}function ur(t){return{result:"error",value:t}}function ht(t){return t["property-type"]==="data-driven"||t["property-type"]==="cross-faded-data-driven"}function Ou(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function gs(t){return!!t.expression&&t.expression.interpolated}function j(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":t===null?"null":typeof t}function to(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function Rh(t){return t}function Nu(t,e){let r=e.type==="color",n=t.stops&&typeof t.stops[0][0]=="object",i=n||t.property!==void 0,o=n||!i,a=t.type||(gs(e)?"exponential":"interval");if(r||e.type==="padding"){let c=r?W.parse:Ze.parse;t=fr({},t),t.stops&&(t.stops=t.stops.map(p=>[p[0],c(p[1])])),t.default?t.default=c(t.default):t.default=c(e.default)}if(t.colorSpace&&!Um(t.colorSpace))throw new Error('Unknown color space: "'.concat(t.colorSpace,'"'));let s,l,u;if(a==="exponential")s=xu;else if(a==="interval")s=Nh;else if(a==="categorical"){s=Oh,l=Object.create(null);for(let c of t.stops)l[c[0]]=c[1];u=typeof t.stops[0][0]}else if(a==="identity")s=Uh;else throw new Error('Unknown function type "'.concat(a,'"'));if(n){let c={},p=[];for(let m=0;m<t.stops.length;m++){let h=t.stops[m],d=h[0].zoom;c[d]===void 0&&(c[d]={zoom:d,type:t.type,property:t.property,default:t.default,stops:[]},p.push(d)),c[d].stops.push([h[0].value,h[1]])}let f=[];for(let m of p)f.push([c[m].zoom,Nu(c[m],e)]);let y={name:"linear"};return{kind:"composite",interpolationType:y,interpolationFactor:Je.interpolationFactor.bind(void 0,y),zoomStops:f.map(m=>m[0]),evaluate({zoom:m},h){return xu({stops:f,base:t.base},e,m).evaluate(m,h)}}}else if(o){let c=a==="exponential"?{name:"exponential",base:t.base!==void 0?t.base:1}:null;return{kind:"camera",interpolationType:c,interpolationFactor:Je.interpolationFactor.bind(void 0,c),zoomStops:t.stops.map(p=>p[0]),evaluate:({zoom:p})=>s(t,e,p,l,u)}}else return{kind:"source",evaluate(c,p){let f=p&&p.properties?p.properties[t.property]:void 0;return f===void 0?fn(t.default,e.default):s(t,e,f,l,u)}}}function fn(t,e,r){if(t!==void 0)return t;if(e!==void 0)return e;if(r!==void 0)return r}function Oh(t,e,r,n,i){let o=typeof r===i?n[r]:void 0;return fn(o,t.default,e.default)}function Nh(t,e,r){if(j(r)!=="number")return fn(t.default,e.default);let n=t.stops.length;if(n===1||r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[n-1][0])return t.stops[n-1][1];let i=Ki(t.stops.map(o=>o[0]),r);return t.stops[i][1]}function xu(t,e,r){let n=t.base!==void 0?t.base:1;if(j(r)!=="number")return fn(t.default,e.default);let i=t.stops.length;if(i===1||r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[i-1][0])return t.stops[i-1][1];let o=Ki(t.stops.map(c=>c[0]),r),a=$h(r,n,t.stops[o][0],t.stops[o+1][0]),s=t.stops[o][1],l=t.stops[o+1][1],u=Oe[e.type]||Rh;return typeof s.evaluate=="function"?{evaluate(...c){let p=s.evaluate.apply(void 0,c),f=l.evaluate.apply(void 0,c);if(!(p===void 0||f===void 0))return u(p,f,a,t.colorSpace)}}:u(s,l,a,t.colorSpace)}function Uh(t,e,r){switch(e.type){case"color":r=W.parse(r);break;case"formatted":r=Fe.fromString(r.toString());break;case"resolvedImage":r=Te.fromString(r.toString());break;case"padding":r=Ze.parse(r);break;default:j(r)!==e.type&&(e.type!=="enum"||!e.values[r])&&(r=void 0)}return fn(r,t.default,e.default)}function $h(t,e,r,n){let i=n-r,o=t-r;return i===0?0:e===1?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}var Nt=class{constructor(e,r){this.expression=e,this._warningHistory={},this._evaluator=new Vi,this._defaultValue=r?qh(r):null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(e,r,n,i,o,a){return this._evaluator.globals=e,this._evaluator.feature=r,this._evaluator.featureState=n,this._evaluator.canonical=i,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=a,this.expression.evaluate(this._evaluator)}evaluate(e,r,n,i,o,a){this._evaluator.globals=e,this._evaluator.feature=r||null,this._evaluator.featureState=n||null,this._evaluator.canonical=i,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=a||null;try{let s=this.expression.evaluate(this._evaluator);if(s==null||typeof s=="number"&&s!==s)return this._defaultValue;if(this._enumValues&&!(s in this._enumValues))throw new ie("Expected value to be one of ".concat(Object.keys(this._enumValues).map(l=>JSON.stringify(l)).join(", "),", but found ").concat(JSON.stringify(s)," instead."));return s}catch(s){return this._warningHistory[s.message]||(this._warningHistory[s.message]=!0,typeof console<"u"&&console.warn(s.message)),this._defaultValue}}};function qt(t){return Array.isArray(t)&&t.length>0&&typeof t[0]=="string"&&t[0]in Gt}function jt(t,e){let r=new Bi(Gt,Ji,[],e?Gh(e):void 0),n=r.parse(t,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return n?cs(new Nt(n,e)):ur(r.errors)}var dt=class{constructor(e,r){this.kind=e,this._styleExpression=r,this.isStateDependent=e!=="constant"&&!sn(r.expression)}evaluateWithoutErrorHandling(e,r,n,i,o,a){return this._styleExpression.evaluateWithoutErrorHandling(e,r,n,i,o,a)}evaluate(e,r,n,i,o,a){return this._styleExpression.evaluate(e,r,n,i,o,a)}},gt=class{constructor(e,r,n,i){this.kind=e,this.zoomStops=n,this._styleExpression=r,this.isStateDependent=e!=="camera"&&!sn(r.expression),this.interpolationType=i}evaluateWithoutErrorHandling(e,r,n,i,o,a){return this._styleExpression.evaluateWithoutErrorHandling(e,r,n,i,o,a)}evaluate(e,r,n,i,o,a){return this._styleExpression.evaluate(e,r,n,i,o,a)}interpolationFactor(e,r,n){return this.interpolationType?Je.interpolationFactor(this.interpolationType,e,r,n):0}};function Uu(t,e){let r=jt(t,e);if(r.result==="error")return r;let n=r.value.expression,i=Qi(n);if(!i&&!ht(e))return ur([new Be("","data expressions not supported")]);let o=eo(n,["zoom"]);if(!o&&!Ou(e))return ur([new Be("","zoom expressions not supported")]);let a=Di(n);if(!a&&!o)return ur([new Be("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(a instanceof Be)return ur([a]);if(a instanceof Je&&!gs(e))return ur([new Be("",'"interpolate" expressions cannot be used with this property')]);if(!a)return cs(i?new dt("constant",r.value):new dt("source",r.value));let s=a instanceof Je?a.interpolation:void 0;return cs(i?new gt("camera",r.value,a.labels,s):new gt("composite",r.value,a.labels,s))}var ln=class t{constructor(e,r){this._parameters=e,this._specification=r,fr(this,Nu(this._parameters,this._specification))}static deserialize(e){return new t(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}};function $u(t,e){if(to(t))return new ln(t,e);if(qt(t)){let r=Uu(t,e);if(r.result==="error")throw new Error(r.value.map(n=>"".concat(n.key,": ").concat(n.message)).join(", "));return r.value}else{let r=t;return e.type==="color"&&typeof t=="string"?r=W.parse(t):e.type==="padding"&&(typeof t=="number"||Array.isArray(t))?r=Ze.parse(t):e.type==="variableAnchorOffsetCollection"&&Array.isArray(t)&&(r=Ne.parse(t)),{kind:"constant",evaluate:()=>r}}}function Di(t){let e=null;if(t instanceof zi)e=Di(t.result);else if(t instanceof Ni){for(let r of t.args)if(e=Di(r),e)break}else(t instanceof yr||t instanceof Je)&&t.input instanceof Ke&&t.input.name==="zoom"&&(e=t);return e instanceof Be||t.eachChild(r=>{let n=Di(r);n instanceof Be?e=n:!e&&n?e=new Be("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&n&&e!==n&&(e=new Be("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function Gh(t){let e={color:Re,string:G,number:L,enum:G,boolean:U,formatted:dr,padding:Hi,resolvedImage:cn,variableAnchorOffsetCollection:Xi};return t.type==="array"?Ee(e[t.value]||$,t.length):e[t.type]}function qh(t){return t.type==="color"&&to(t.default)?new W(0,0,0,0):t.type==="color"?W.parse(t.default)||null:t.type==="padding"?Ze.parse(t.default)||null:t.type==="variableAnchorOffsetCollection"?Ne.parse(t.default)||null:t.default===void 0?null:t.default}function xs(t){if(t===!0||t===!1)return!0;if(!Array.isArray(t)||t.length===0)return!1;switch(t[0]){case"has":return t.length>=2&&t[1]!=="$id"&&t[1]!=="$type";case"in":return t.length>=3&&(typeof t[1]!="string"||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return t.length!==3||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(let e of t.slice(1))if(!xs(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}var jh={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function yn(t){if(t==null)return{filter:()=>!0,needGeometry:!1};xs(t)||(t=Zi(t));let e=jt(t,jh);if(e.result==="error")throw new Error(e.value.map(r=>"".concat(r.key,": ").concat(r.message)).join(", "));{let r=Gu(t);return{filter:(n,i,o)=>e.value.evaluate(n,i,{},o),needGeometry:r}}}function Jh(t,e){return t<e?-1:t>e?1:0}function Gu(t){if(!Array.isArray(t))return!1;if(t[0]==="within"||t[0]==="distance")return!0;for(let e=1;e<t.length;e++)if(Gu(t[e]))return!0;return!1}function Zi(t){if(!t)return!0;let e=t[0];return t.length<=1?e!=="any":e==="=="?Wa(t[1],t[2],"=="):e==="!="?Li(Wa(t[1],t[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Wa(t[1],t[2],e):e==="any"?Zh(t.slice(1)):e==="all"?["all"].concat(t.slice(1).map(Zi)):e==="none"?["all"].concat(t.slice(1).map(Zi).map(Li)):e==="in"?bu(t[1],t.slice(2)):e==="!in"?Li(bu(t[1],t.slice(2))):e==="has"?vu(t[1]):e==="!has"?Li(vu(t[1])):!0}function Wa(t,e,r){switch(t){case"$type":return["filter-type-".concat(r),e];case"$id":return["filter-id-".concat(r),e];default:return["filter-".concat(r),t,e]}}function Zh(t){return["any"].concat(t.map(Zi))}function bu(t,e){if(e.length===0)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(r=>typeof r!=typeof e[0])?["filter-in-large",t,["literal",e.sort(Jh)]]:["filter-in-small",t,["literal",e]]}}function vu(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Li(t){return["!",t]}function ps(t){let e=typeof t;if(e==="number"||e==="boolean"||e==="string"||t===void 0||t===null)return JSON.stringify(t);if(Array.isArray(t)){let i="[";for(let o of t)i+="".concat(ps(o),",");return"".concat(i,"]")}let r=Object.keys(t).sort(),n="{";for(let i=0;i<r.length;i++)n+="".concat(JSON.stringify(r[i]),":").concat(ps(t[r[i]]),",");return"".concat(n,"}")}function Wh(t){let e="";for(let r of Am)e+="/".concat(ps(t[r]));return e}function qu(t,e){let r={};for(let i=0;i<t.length;i++){let o=e&&e[t[i].id]||Wh(t[i]);e&&(e[t[i].id]=o);let a=r[o];a||(a=r[o]=[]),a.push(t[i])}let n=[];for(let i in r)n.push(r[i]);return n}function ju(t){let e=t.key,r=t.value;return r?[new M(e,r,"constants have been deprecated as of v8")]:[]}function ae(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Ut(t){if(Array.isArray(t))return t.map(Ut);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){let e={};for(let r in t)e[r]=Ut(t[r]);return e}return ae(t)}function ze(t){let e=t.key,r=t.value,n=t.valueSpec||{},i=t.objectElementValidators||{},o=t.style,a=t.styleSpec,s=t.validateSpec,l=[],u=j(r);if(u!=="object")return[new M(e,r,"object expected, ".concat(u," found"))];for(let c in r){let p=c.split(".")[0],f=n[p]||n["*"],y;if(i[p])y=i[p];else if(n[p])y=s;else if(i["*"])y=i["*"];else if(n["*"])y=s;else{l.push(new M(e,r[c],'unknown property "'.concat(c,'"')));continue}l=l.concat(y({key:(e&&"".concat(e,"."))+c,value:r[c],valueSpec:f,style:o,styleSpec:a,object:r,objectKey:c,validateSpec:s},r))}for(let c in n)i[c]||n[c].required&&n[c].default===void 0&&r[c]===void 0&&l.push(new M(e,r,'missing required property "'.concat(c,'"')));return l}function bs(t){let e=t.value,r=t.valueSpec,n=t.validateSpec,i=t.style,o=t.styleSpec,a=t.key,s=t.arrayElementValidator||n;if(j(e)!=="array")return[new M(a,e,"array expected, ".concat(j(e)," found"))];if(r.length&&e.length!==r.length)return[new M(a,e,"array length ".concat(r.length," expected, length ").concat(e.length," found"))];if(r["min-length"]&&e.length<r["min-length"])return[new M(a,e,"array length at least ".concat(r["min-length"]," expected, length ").concat(e.length," found"))];let l={type:r.value,values:r.values};o.$version<7&&(l.function=r.function),j(r.value)==="object"&&(l=r.value);let u=[];for(let c=0;c<e.length;c++)u=u.concat(s({array:e,arrayIndex:c,value:e[c],valueSpec:l,validateSpec:t.validateSpec,style:i,styleSpec:o,key:"".concat(a,"[").concat(c,"]")}));return u}function vs(t){let e=t.key,r=t.value,n=t.valueSpec,i=j(r);return i==="number"&&r!==r&&(i="NaN"),i!=="number"?[new M(e,r,"number expected, ".concat(i," found"))]:"minimum"in n&&r<n.minimum?[new M(e,r,"".concat(r," is less than the minimum value ").concat(n.minimum))]:"maximum"in n&&r>n.maximum?[new M(e,r,"".concat(r," is greater than the maximum value ").concat(n.maximum))]:[]}function Ju(t){let e=t.valueSpec,r=ae(t.value.type),n,i={},o,a,s=r!=="categorical"&&t.value.property===void 0,l=!s,u=j(t.value.stops)==="array"&&j(t.value.stops[0])==="array"&&j(t.value.stops[0][0])==="object",c=ze({key:t.key,value:t.value,valueSpec:t.styleSpec.function,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:p,default:m}});return r==="identity"&&s&&c.push(new M(t.key,t.value,'missing required property "property"')),r!=="identity"&&!t.value.stops&&c.push(new M(t.key,t.value,'missing required property "stops"')),r==="exponential"&&t.valueSpec.expression&&!gs(t.valueSpec)&&c.push(new M(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!ht(t.valueSpec)?c.push(new M(t.key,t.value,"property functions not supported")):s&&!Ou(t.valueSpec)&&c.push(new M(t.key,t.value,"zoom functions not supported"))),(r==="categorical"||u)&&t.value.property===void 0&&c.push(new M(t.key,t.value,'"property" property is required')),c;function p(h){if(r==="identity")return[new M(h.key,h.value,'identity function may not have a "stops" property')];let d=[],g=h.value;return d=d.concat(bs({key:h.key,value:g,valueSpec:h.valueSpec,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec,arrayElementValidator:f})),j(g)==="array"&&g.length===0&&d.push(new M(h.key,g,"array must have at least one stop")),d}function f(h){let d=[],g=h.value,b=h.key;if(j(g)!=="array")return[new M(b,g,"array expected, ".concat(j(g)," found"))];if(g.length!==2)return[new M(b,g,"array length 2 expected, length ".concat(g.length," found"))];if(u){if(j(g[0])!=="object")return[new M(b,g,"object expected, ".concat(j(g[0])," found"))];if(g[0].zoom===void 0)return[new M(b,g,"object stop key must have zoom")];if(g[0].value===void 0)return[new M(b,g,"object stop key must have value")];if(a&&a>ae(g[0].zoom))return[new M(b,g[0].zoom,"stop zoom values must appear in ascending order")];ae(g[0].zoom)!==a&&(a=ae(g[0].zoom),o=void 0,i={}),d=d.concat(ze({key:"".concat(b,"[0]"),value:g[0],valueSpec:{zoom:{}},validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{zoom:vs,value:y}}))}else d=d.concat(y({key:"".concat(b,"[0]"),value:g[0],valueSpec:{},validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec},g));return qt(Ut(g[1]))?d.concat([new M("".concat(b,"[1]"),g[1],"expressions are not allowed in function stops.")]):d.concat(h.validateSpec({key:"".concat(b,"[1]"),value:g[1],valueSpec:e,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec}))}function y(h,d){let g=j(h.value),b=ae(h.value),x=h.value!==null?h.value:d;if(!n)n=g;else if(g!==n)return[new M(h.key,x,"".concat(g," stop domain type must match previous stop domain type ").concat(n))];if(g!=="number"&&g!=="string"&&g!=="boolean")return[new M(h.key,x,"stop domain value must be a number, string, or boolean")];if(g!=="number"&&r!=="categorical"){let v="number expected, ".concat(g," found");return ht(e)&&r===void 0&&(v+='\\nIf you intended to use a categorical function, specify \`"type": "categorical"\`.'),[new M(h.key,x,v)]}return r==="categorical"&&g==="number"&&(!isFinite(b)||Math.floor(b)!==b)?[new M(h.key,x,"integer expected, found ".concat(b))]:r!=="categorical"&&g==="number"&&o!==void 0&&b<o?[new M(h.key,x,"stop domain values must appear in ascending order")]:(o=b,r==="categorical"&&b in i?[new M(h.key,x,"stop domain values must be unique")]:(i[b]=!0,[]))}function m(h){return h.validateSpec({key:h.key,value:h.value,valueSpec:e,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec})}}function mr(t){let e=(t.expressionContext==="property"?Uu:jt)(Ut(t.value),t.valueSpec);if(e.result==="error")return e.value.map(n=>new M("".concat(t.key).concat(n.key),t.value,n.message));let r=e.value.expression||e.value._styleExpression.expression;if(t.expressionContext==="property"&&t.propertyKey==="text-font"&&!r.outputDefined())return[new M(t.key,t.value,'Invalid data expression for "'.concat(t.propertyKey,'". Output values must be contained as literals within the expression.'))];if(t.expressionContext==="property"&&t.propertyType==="layout"&&!sn(r))return[new M(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if(t.expressionContext==="filter"&&!sn(r))return[new M(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&t.expressionContext.indexOf("cluster")===0){if(!eo(r,["zoom","feature-state"]))return[new M(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(t.expressionContext==="cluster-initial"&&!Qi(r))return[new M(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Hh(t){let e=t.value,r=t.key,n=j(e);return n!=="boolean"?[new M(r,e,"boolean expected, ".concat(n," found"))]:[]}function Xh(t){let e=t.key,r=t.value,n=j(r);return n!=="string"?[new M(e,r,"color expected, ".concat(n," found"))]:W.parse(String(r))?[]:[new M(e,r,'color expected, "'.concat(r,'" found'))]}function un(t){let e=t.key,r=t.value,n=t.valueSpec,i=[];return Array.isArray(n.values)?n.values.indexOf(ae(r))===-1&&i.push(new M(e,r,"expected one of [".concat(n.values.join(", "),"], ").concat(JSON.stringify(r)," found"))):Object.keys(n.values).indexOf(ae(r))===-1&&i.push(new M(e,r,"expected one of [".concat(Object.keys(n.values).join(", "),"], ").concat(JSON.stringify(r)," found"))),i}function Ps(t){return xs(Ut(t.value))?mr(fr({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Zu(t)}function Zu(t){let e=t.value,r=t.key;if(j(e)!=="array")return[new M(r,e,"array expected, ".concat(j(e)," found"))];let n=t.styleSpec,i,o=[];if(e.length<1)return[new M(r,e,"filter array must have at least 1 element")];switch(o=o.concat(un({key:"".concat(r,"[0]"),value:e[0],valueSpec:n.filter_operator,style:t.style,styleSpec:t.styleSpec})),ae(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&ae(e[1])==="$type"&&o.push(new M(r,e,'"$type" cannot be use with operator "'.concat(e[0],'"')));case"==":case"!=":e.length!==3&&o.push(new M(r,e,'filter array for operator "'.concat(e[0],'" must have 3 elements')));case"in":case"!in":e.length>=2&&(i=j(e[1]),i!=="string"&&o.push(new M("".concat(r,"[1]"),e[1],"string expected, ".concat(i," found"))));for(let a=2;a<e.length;a++)i=j(e[a]),ae(e[1])==="$type"?o=o.concat(un({key:"".concat(r,"[").concat(a,"]"),value:e[a],valueSpec:n.geometry_type,style:t.style,styleSpec:t.styleSpec})):i!=="string"&&i!=="number"&&i!=="boolean"&&o.push(new M("".concat(r,"[").concat(a,"]"),e[a],"string, number, or boolean expected, ".concat(i," found")));break;case"any":case"all":case"none":for(let a=1;a<e.length;a++)o=o.concat(Zu({key:"".concat(r,"[").concat(a,"]"),value:e[a],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":i=j(e[1]),e.length!==2?o.push(new M(r,e,'filter array for "'.concat(e[0],'" operator must have 2 elements'))):i!=="string"&&o.push(new M("".concat(r,"[1]"),e[1],"string expected, ".concat(i," found")));break}return o}function Wu(t,e){let r=t.key,n=t.validateSpec,i=t.style,o=t.styleSpec,a=t.value,s=t.objectKey,l=o["".concat(e,"_").concat(t.layerType)];if(!l)return[];let u=s.match(/^(.*)-transition$/);if(e==="paint"&&u&&l[u[1]]&&l[u[1]].transition)return n({key:r,value:a,valueSpec:o.transition,style:i,styleSpec:o});let c=t.valueSpec||l[s];if(!c)return[new M(r,a,'unknown property "'.concat(s,'"'))];let p;if(j(a)==="string"&&ht(c)&&!c.tokens&&(p=/^{([^}]+)}$/.exec(a)))return[new M(r,a,'"'.concat(s,'" does not support interpolation syntax\\n')+'Use an identity property function instead: \`{ "type": "identity", "property": '.concat(JSON.stringify(p[1])," }\`."))];let f=[];return t.layerType==="symbol"&&(s==="text-field"&&i&&!i.glyphs&&f.push(new M(r,a,'use of "text-field" requires a style "glyphs" property')),s==="text-font"&&to(Ut(a))&&ae(a.type)==="identity"&&f.push(new M(r,a,'"text-font" does not support identity functions'))),f.concat(n({key:t.key,value:a,valueSpec:c,style:i,styleSpec:o,expressionContext:"property",propertyType:e,propertyKey:s}))}function Hu(t){return Wu(t,"paint")}function Xu(t){return Wu(t,"layout")}function Ku(t){let e=[],r=t.value,n=t.key,i=t.style,o=t.styleSpec;!r.type&&!r.ref&&e.push(new M(n,r,'either "type" or "ref" is required'));let a=ae(r.type),s=ae(r.ref);if(r.id){let l=ae(r.id);for(let u=0;u<t.arrayIndex;u++){let c=i.layers[u];ae(c.id)===l&&e.push(new M(n,r.id,'duplicate layer id "'.concat(r.id,'", previously used at line ').concat(c.id.__line__)))}}if("ref"in r){["type","source","source-layer","filter","layout"].forEach(u=>{u in r&&e.push(new M(n,r[u],'"'.concat(u,'" is prohibited for ref layers')))});let l;i.layers.forEach(u=>{ae(u.id)===s&&(l=u)}),l?l.ref?e.push(new M(n,r.ref,"ref cannot reference another ref layer")):a=ae(l.type):e.push(new M(n,r.ref,'ref layer "'.concat(s,'" not found')))}else if(a!=="background")if(!r.source)e.push(new M(n,r,'missing required property "source"'));else{let l=i.sources&&i.sources[r.source],u=l&&ae(l.type);l?u==="vector"&&a==="raster"?e.push(new M(n,r.source,'layer "'.concat(r.id,'" requires a raster source'))):u!=="raster-dem"&&a==="hillshade"?e.push(new M(n,r.source,'layer "'.concat(r.id,'" requires a raster-dem source'))):u==="raster"&&a!=="raster"?e.push(new M(n,r.source,'layer "'.concat(r.id,'" requires a vector source'))):u==="vector"&&!r["source-layer"]?e.push(new M(n,r,'layer "'.concat(r.id,'" must specify a "source-layer"'))):u==="raster-dem"&&a!=="hillshade"?e.push(new M(n,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):a==="line"&&r.paint&&r.paint["line-gradient"]&&(u!=="geojson"||!l.lineMetrics)&&e.push(new M(n,r,'layer "'.concat(r.id,'" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.'))):e.push(new M(n,r.source,'source "'.concat(r.source,'" not found')))}return e=e.concat(ze({key:n,value:r,valueSpec:o.layer,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{"*"(){return[]},type(){return t.validateSpec({key:"".concat(n,".type"),value:r.type,valueSpec:o.layer.type,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,object:r,objectKey:"type"})},filter:Ps,layout(l){return ze({layer:r,key:l.key,value:l.value,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*"(u){return Xu(fr({layerType:a},u))}}})},paint(l){return ze({layer:r,key:l.key,value:l.value,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*"(u){return Hu(fr({layerType:a},u))}}})}}})),e}function $t(t){let e=t.value,r=t.key,n=j(e);return n!=="string"?[new M(r,e,"string expected, ".concat(n," found"))]:[]}function Kh(t){var e;let r=(e=t.sourceName)!==null&&e!==void 0?e:"",n=t.value,i=t.styleSpec,o=i.source_raster_dem,a=t.style,s=[],l=j(n);if(n===void 0)return s;if(l!=="object")return s.push(new M("source_raster_dem",n,"object expected, ".concat(l," found"))),s;let c=ae(n.encoding)==="custom",p=["redFactor","greenFactor","blueFactor","baseShift"],f=t.value.encoding?'"'.concat(t.value.encoding,'"'):"Default";for(let y in n)!c&&p.includes(y)?s.push(new M(y,n[y],'In "'.concat(r,'": "').concat(y,'" is only valid when "encoding" is set to "custom". ').concat(f," encoding found"))):o[y]?s=s.concat(t.validateSpec({key:y,value:n[y],valueSpec:o[y],validateSpec:t.validateSpec,style:a,styleSpec:i})):s.push(new M(y,n[y],'unknown property "'.concat(y,'"')));return s}var Pu={promoteId:Yh};function Yu(t){let e=t.value,r=t.key,n=t.styleSpec,i=t.style,o=t.validateSpec;if(!e.type)return[new M(r,e,'"type" is required')];let a=ae(e.type),s;switch(a){case"vector":case"raster":return s=ze({key:r,value:e,valueSpec:n["source_".concat(a.replace("-","_"))],style:t.style,styleSpec:n,objectElementValidators:Pu,validateSpec:o}),s;case"raster-dem":return s=Kh({sourceName:r,value:e,style:t.style,styleSpec:n,validateSpec:o}),s;case"geojson":if(s=ze({key:r,value:e,valueSpec:n.source_geojson,style:i,styleSpec:n,validateSpec:o,objectElementValidators:Pu}),e.cluster)for(let l in e.clusterProperties){let[u,c]=e.clusterProperties[l],p=typeof u=="string"?[u,["accumulated"],["get",l]]:u;s.push(...mr({key:"".concat(r,".").concat(l,".map"),value:c,validateSpec:o,expressionContext:"cluster-map"})),s.push(...mr({key:"".concat(r,".").concat(l,".reduce"),value:p,validateSpec:o,expressionContext:"cluster-reduce"}))}return s;case"video":return ze({key:r,value:e,valueSpec:n.source_video,style:i,validateSpec:o,styleSpec:n});case"image":return ze({key:r,value:e,valueSpec:n.source_image,style:i,validateSpec:o,styleSpec:n});case"canvas":return[new M(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return un({key:"".concat(r,".type"),value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:i,validateSpec:o,styleSpec:n})}}function Yh({key:t,value:e}){if(j(e)==="string")return $t({key:t,value:e});{let r=[];for(let n in e)r.push(...$t({key:"".concat(t,".").concat(n),value:e[n]}));return r}}function Qu(t){let e=t.value,r=t.styleSpec,n=r.light,i=t.style,o=[],a=j(e);if(e===void 0)return o;if(a!=="object")return o=o.concat([new M("light",e,"object expected, ".concat(a," found"))]),o;for(let s in e){let l=s.match(/^(.*)-transition$/);l&&n[l[1]]&&n[l[1]].transition?o=o.concat(t.validateSpec({key:s,value:e[s],valueSpec:r.transition,validateSpec:t.validateSpec,style:i,styleSpec:r})):n[s]?o=o.concat(t.validateSpec({key:s,value:e[s],valueSpec:n[s],validateSpec:t.validateSpec,style:i,styleSpec:r})):o=o.concat([new M(s,e[s],'unknown property "'.concat(s,'"'))])}return o}function ec(t){let e=t.value,r=t.styleSpec,n=r.sky,i=t.style,o=j(e);if(e===void 0)return[];if(o!=="object")return[new M("sky",e,"object expected, ".concat(o," found"))];let a=[];for(let s in e)n[s]?a=a.concat(t.validateSpec({key:s,value:e[s],valueSpec:n[s],style:i,styleSpec:r})):a=a.concat([new M(s,e[s],'unknown property "'.concat(s,'"'))]);return a}function tc(t){let e=t.value,r=t.styleSpec,n=r.terrain,i=t.style,o=[],a=j(e);if(e===void 0)return o;if(a!=="object")return o=o.concat([new M("terrain",e,"object expected, ".concat(a," found"))]),o;for(let s in e)n[s]?o=o.concat(t.validateSpec({key:s,value:e[s],valueSpec:n[s],validateSpec:t.validateSpec,style:i,styleSpec:r})):o=o.concat([new M(s,e[s],'unknown property "'.concat(s,'"'))]);return o}function Qh(t){return $t(t).length===0?[]:mr(t)}function ed(t){return $t(t).length===0?[]:mr(t)}function td(t){let e=t.key,r=t.value;if(j(r)==="array"){if(r.length<1||r.length>4)return[new M(e,r,"padding requires 1 to 4 values; ".concat(r.length," values found"))];let i={type:"number"},o=[];for(let a=0;a<r.length;a++)o=o.concat(t.validateSpec({key:"".concat(e,"[").concat(a,"]"),value:r[a],validateSpec:t.validateSpec,valueSpec:i}));return o}else return vs({key:e,value:r,valueSpec:{}})}function rd(t){let e=t.key,r=t.value,n=j(r),i=t.styleSpec;if(n!=="array"||r.length<1||r.length%2!==0)return[new M(e,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let o=[];for(let a=0;a<r.length;a+=2)o=o.concat(un({key:"".concat(e,"[").concat(a,"]"),value:r[a],valueSpec:i.layout_symbol["text-anchor"]})),o=o.concat(bs({key:"".concat(e,"[").concat(a+1,"]"),value:r[a+1],valueSpec:{length:2,value:"number"},validateSpec:t.validateSpec,style:t.style,styleSpec:i}));return o}function rc(t){let e=[],r=t.value,n=t.key;if(Array.isArray(r)){let i=[],o=[];for(let a in r){r[a].id&&i.includes(r[a].id)&&e.push(new M(n,r,"all the sprites' ids must be unique, but ".concat(r[a].id," is duplicated"))),i.push(r[a].id),r[a].url&&o.includes(r[a].url)&&e.push(new M(n,r,"all the sprites' URLs must be unique, but ".concat(r[a].url," is duplicated"))),o.push(r[a].url);let s={id:{type:"string",required:!0},url:{type:"string",required:!0}};e=e.concat(ze({key:"".concat(n,"[").concat(a,"]"),value:r[a],valueSpec:s,validateSpec:t.validateSpec}))}return e}else return $t({key:n,value:r})}function nd(t){let e=t.value,r=t.styleSpec,n=r.projection,i=t.style,o=j(e);if(e===void 0)return[];if(o!=="object")return[new M("projection",e,"object expected, ".concat(o," found"))];let a=[];for(let s in e)n[s]?a=a.concat(t.validateSpec({key:s,value:e[s],valueSpec:n[s],style:i,styleSpec:r})):a=a.concat([new M(s,e[s],'unknown property "'.concat(s,'"'))]);return a}var Su={"*"(){return[]},array:bs,boolean:Hh,number:vs,color:Xh,constants:ju,enum:un,filter:Ps,function:Ju,layer:Ku,object:ze,source:Yu,light:Qu,sky:ec,terrain:tc,projection:nd,string:$t,formatted:Qh,resolvedImage:ed,padding:td,variableAnchorOffsetCollection:rd,sprite:rc};function Xr(t){let e=t.value,r=t.valueSpec,n=t.styleSpec;return t.validateSpec=Xr,r.expression&&to(ae(e))?Ju(t):r.expression&&qt(Ut(e))?mr(t):r.type&&Su[r.type]?Su[r.type](t):ze(fr({},t,{valueSpec:r.type?n[r.type]:r}))}function nc(t){let e=t.value,r=t.key,n=$t(t);return n.length||(e.indexOf("{fontstack}")===-1&&n.push(new M(r,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&n.push(new M(r,e,'"glyphs" url must include a "{range}" token'))),n}function Ue(t,e=S){let r=[];return r=r.concat(Xr({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,validateSpec:Xr,objectElementValidators:{glyphs:nc,"*"(){return[]}}})),t.constants&&(r=r.concat(ju({key:"constants",value:t.constants,style:t,styleSpec:e,validateSpec:Xr}))),ic(r)}Ue.source=Qe(Ye(Yu));Ue.sprite=Qe(Ye(rc));Ue.glyphs=Qe(Ye(nc));Ue.light=Qe(Ye(Qu));Ue.sky=Qe(Ye(ec));Ue.terrain=Qe(Ye(tc));Ue.layer=Qe(Ye(Ku));Ue.filter=Qe(Ye(Ps));Ue.paintProperty=Qe(Ye(Hu));Ue.layoutProperty=Qe(Ye(Xu));function Ye(t){return function(e){return t(Ci(Dt({},e),{validateSpec:Xr}))}}function ic(t){return[].concat(t).sort((e,r)=>e.line-r.line)}function Qe(t){return function(...e){return ic(t.apply(this,e))}}var oc="AbortError";function ac(t){return t.message===oc}function Ss(){return new Error(oc)}var ro={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function sc(t){return ro.REGISTERED_PROTOCOLS[t.substring(0,t.indexOf("://"))]}function lc(t,e){ro.REGISTERED_PROTOCOLS[t]=e}function uc(t){delete ro.REGISTERED_PROTOCOLS[t]}var cc="global-dispatcher",br=class extends Error{constructor(e,r,n,i){super("AJAXError: ".concat(r," (").concat(e,"): ").concat(n)),this.status=e,this.statusText=r,this.url=n,this.body=i}},fc=()=>at(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,id=t=>/^file:/.test(t)||/^file:/.test(fc())&&!/^\\w+:/.test(t);async function od(t,e){let r=new Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,cache:t.cache,referrer:fc(),signal:e.signal});t.type==="json"&&r.headers.set("Accept","application/json");let n=await fetch(r);if(!n.ok){let a=await n.blob();throw new br(n.status,n.statusText,t.url,a)}let i;t.type==="arrayBuffer"||t.type==="image"?i=n.arrayBuffer():t.type==="json"?i=n.json():i=n.text();let o=await i;if(e.signal.aborted)throw Ss();return{data:o,cacheControl:n.headers.get("Cache-Control"),expires:n.headers.get("Expires")}}function ad(t,e){return new Promise((r,n)=>{let i=new XMLHttpRequest;i.open(t.method||"GET",t.url,!0),(t.type==="arrayBuffer"||t.type==="image")&&(i.responseType="arraybuffer");for(let o in t.headers)i.setRequestHeader(o,t.headers[o]);t.type==="json"&&(i.responseType="text",i.setRequestHeader("Accept","application/json")),i.withCredentials=t.credentials==="include",i.onerror=()=>{n(new Error(i.statusText))},i.onload=()=>{if(!e.signal.aborted)if((i.status>=200&&i.status<300||i.status===0)&&i.response!==null){let o=i.response;if(t.type==="json")try{o=JSON.parse(i.response)}catch(a){n(a);return}r({data:o,cacheControl:i.getResponseHeader("Cache-Control"),expires:i.getResponseHeader("Expires")})}else{let o=new Blob([i.response],{type:i.getResponseHeader("Content-Type")});n(new br(i.status,i.statusText,t.url,o))}},e.signal.addEventListener("abort",()=>{i.abort(),n(Ss())}),i.send(t.body)})}var yc=function(t,e){if(/:\\/\\//.test(t.url)&&!/^https?:|^file:/.test(t.url)){let r=sc(t.url);if(r)return r(t,e);if(at(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:t,targetMapId:cc},e)}if(!id(t.url)){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return od(t,e);if(at(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:t,mustQueue:!0,targetMapId:cc},e)}return ad(t,e)},mc=(t,e)=>yc(Pe(t,{type:"json"}),e),hc=(t,e)=>yc(Pe(t,{type:"arrayBuffer"}),e);var xt={};function C(t,e,r={}){if(xt[t])throw new Error("".concat(t," is already registered."));Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),xt[t]={klass:e,omit:r.omit||[],shallow:r.shallow||[]}}C("Object",Object);C("TransferableGridIndex",Vt);C("Color",W);C("Error",Error);C("AJAXError",br);C("ResolvedImage",Te);C("StylePropertyFunction",ln);C("StyleExpression",Nt,{omit:["_evaluator"]});C("ZoomDependentExpression",gt);C("ZoomConstantExpression",dt);C("CompoundExpression",Ke,{omit:["_evaluate"]});for(let t in Gt)Gt[t]._classRegistryKey||C("Expression_".concat(t),Gt[t]);function dc(t){return t&&typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||t.constructor&&t.constructor.name==="ArrayBuffer")}function vr(t,e){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob||t instanceof Error)return t;if(dc(t)||Jr(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){let r=t;return e&&e.push(r.buffer),r}if(t instanceof ImageData)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){let r=[];for(let n of t)r.push(vr(n,e));return r}if(typeof t=="object"){let r=t.constructor,n=r._classRegistryKey;if(!n)throw new Error("can't serialize object of unregistered class ".concat(r.name));if(!xt[n])throw new Error("".concat(n," is not registered."));let i=r.serialize?r.serialize(t,e):{};if(r.serialize){if(e&&i===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(let o in t){if(!t.hasOwnProperty(o)||xt[n].omit.indexOf(o)>=0)continue;let a=t[o];i[o]=xt[n].shallow.indexOf(o)>=0?a:vr(a,e)}t instanceof Error&&(i.message=t.message)}if(i.$name)throw new Error("$name property is reserved for worker serialization logic.");return n!=="Object"&&(i.$name=n),i}throw new Error("can't serialize object of type ".concat(typeof t))}function Pr(t){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob||t instanceof Error||dc(t)||Jr(t)||ArrayBuffer.isView(t)||t instanceof ImageData)return t;if(Array.isArray(t))return t.map(Pr);if(typeof t=="object"){let e=t.$name||"Object";if(!xt[e])throw new Error("can't deserialize unregistered class ".concat(e));let{klass:r}=xt[e];if(!r)throw new Error("can't deserialize unregistered class ".concat(e));if(r.deserialize)return r.deserialize(t);let n=Object.create(r.prototype);for(let i of Object.keys(t)){if(i==="$name")continue;let o=t[i];n[i]=xt[e].shallow.indexOf(i)>=0?o:Pr(o)}return n}throw new Error("can't deserialize object of type ".concat(typeof t))}var no=class{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}};var io=class{constructor(e,r){this.target=e,this.mapId=r,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new no(()=>this.process()),this.subscription=tu(this.target,"message",n=>this.receive(n),!1),this.globalScope=at(self)?e:window}registerMessageHandler(e,r){this.messageHandlers[e]=r}sendAsync(e,r){return new Promise((n,i)=>{let o=Math.round(Math.random()*1e18).toString(36).substring(0,10);this.resolveRejects[o]={resolve:n,reject:i},r&&r.signal.addEventListener("abort",()=>{delete this.resolveRejects[o];let l={id:o,type:"<cancel>",origin:location.origin,targetMapId:e.targetMapId,sourceMapId:this.mapId};this.target.postMessage(l)},{once:!0});let a=[],s=Ci(Dt({},e),{id:o,sourceMapId:this.mapId,origin:location.origin,data:vr(e.data,a)});this.target.postMessage(s,{transfer:a})})}receive(e){let r=e.data,n=r.id;if(!(r.origin!=="file://"&&location.origin!=="file://"&&r.origin!==location.origin)&&!(r.targetMapId&&this.mapId!==r.targetMapId)){if(r.type==="<cancel>"){delete this.tasks[n];let i=this.abortControllers[n];delete this.abortControllers[n],i&&i.abort();return}if(at(self)||r.mustQueue){this.tasks[n]=r,this.taskQueue.push(n),this.invoker.trigger();return}this.processTask(n,r)}}process(){if(this.taskQueue.length===0)return;let e=this.taskQueue.shift(),r=this.tasks[e];delete this.tasks[e],this.taskQueue.length>0&&this.invoker.trigger(),r&&this.processTask(e,r)}async processTask(e,r){if(r.type==="<response>"){let o=this.resolveRejects[e];if(delete this.resolveRejects[e],!o)return;r.error?o.reject(Pr(r.error)):o.resolve(Pr(r.data));return}if(!this.messageHandlers[r.type]){this.completeTask(e,new Error("Could not find a registered handler for ".concat(r.type,", map ID: ").concat(this.mapId,", available handlers: ").concat(Object.keys(this.messageHandlers).join(", "))));return}let n=Pr(r.data),i=new AbortController;this.abortControllers[e]=i;try{let o=await this.messageHandlers[r.type](r.sourceMapId,n,i);this.completeTask(e,null,o)}catch(o){this.completeTask(e,o)}}completeTask(e,r,n){let i=[];delete this.abortControllers[e];let o={id:e,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:r?vr(r):null,data:vr(n,i)};this.target.postMessage(o,{transfer:i})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}};function gc(t,e,r){r[t]&&r[t].indexOf(e)!==-1||(r[t]=r[t]||[],r[t].push(e))}function ws(t,e,r){if(r&&r[t]){let n=r[t].indexOf(e);n!==-1&&r[t].splice(n,1)}}var oo=class{constructor(e,r={}){Pe(this,r),this.type=e}},mn=class extends oo{constructor(e,r={}){super("error",Pe({error:e},r))}},ao=class{on(e,r){return this._listeners=this._listeners||{},gc(e,r,this._listeners),this}off(e,r){return ws(e,r,this._listeners),ws(e,r,this._oneTimeListeners),this}once(e,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},gc(e,r,this._oneTimeListeners),this):new Promise(n=>this.once(e,n))}fire(e,r){typeof e=="string"&&(e=new oo(e,r||{}));let n=e.type;if(this.listens(n)){e.target=this;let i=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];for(let s of i)s.call(this,e);let o=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];for(let s of o)ws(n,s,this._oneTimeListeners),s.call(this,e);let a=this._eventedParent;a&&(Pe(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),a.fire(e))}else e instanceof mn&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,r){return this._eventedParent=e,this._eventedParentData=r,this}};var bt=Ue,tv=bt.source,rv=bt.light,nv=bt.terrain,iv=bt.filter,xc=bt.paintProperty,bc=bt.layoutProperty;function vc(t,e){let r=!1;if(e&&e.length)for(let n of e)t.fire(new mn(new Error(n.message))),r=!0;return r}var so=class{constructor(){this.first=!0}update(e,r){let n=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=r),e!==this.lastZoom?(this.lastZoom=e,this.lastFloorZoom=n,!0):!1)}};var D={"Latin-1 Supplement":t=>t>=128&&t<=255,Arabic:t=>t>=1536&&t<=1791,"Arabic Supplement":t=>t>=1872&&t<=1919,"Arabic Extended-A":t=>t>=2208&&t<=2303,"Hangul Jamo":t=>t>=4352&&t<=4607,"Unified Canadian Aboriginal Syllabics":t=>t>=5120&&t<=5759,Khmer:t=>t>=6016&&t<=6143,"Unified Canadian Aboriginal Syllabics Extended":t=>t>=6320&&t<=6399,"General Punctuation":t=>t>=8192&&t<=8303,"Letterlike Symbols":t=>t>=8448&&t<=8527,"Number Forms":t=>t>=8528&&t<=8591,"Miscellaneous Technical":t=>t>=8960&&t<=9215,"Control Pictures":t=>t>=9216&&t<=9279,"Optical Character Recognition":t=>t>=9280&&t<=9311,"Enclosed Alphanumerics":t=>t>=9312&&t<=9471,"Geometric Shapes":t=>t>=9632&&t<=9727,"Miscellaneous Symbols":t=>t>=9728&&t<=9983,"Miscellaneous Symbols and Arrows":t=>t>=11008&&t<=11263,"CJK Radicals Supplement":t=>t>=11904&&t<=12031,"Kangxi Radicals":t=>t>=12032&&t<=12255,"Ideographic Description Characters":t=>t>=12272&&t<=12287,"CJK Symbols and Punctuation":t=>t>=12288&&t<=12351,Hiragana:t=>t>=12352&&t<=12447,Katakana:t=>t>=12448&&t<=12543,Bopomofo:t=>t>=12544&&t<=12591,"Hangul Compatibility Jamo":t=>t>=12592&&t<=12687,Kanbun:t=>t>=12688&&t<=12703,"Bopomofo Extended":t=>t>=12704&&t<=12735,"CJK Strokes":t=>t>=12736&&t<=12783,"Katakana Phonetic Extensions":t=>t>=12784&&t<=12799,"Enclosed CJK Letters and Months":t=>t>=12800&&t<=13055,"CJK Compatibility":t=>t>=13056&&t<=13311,"CJK Unified Ideographs Extension A":t=>t>=13312&&t<=19903,"Yijing Hexagram Symbols":t=>t>=19904&&t<=19967,"CJK Unified Ideographs":t=>t>=19968&&t<=40959,"Yi Syllables":t=>t>=40960&&t<=42127,"Yi Radicals":t=>t>=42128&&t<=42191,"Hangul Jamo Extended-A":t=>t>=43360&&t<=43391,"Hangul Syllables":t=>t>=44032&&t<=55215,"Hangul Jamo Extended-B":t=>t>=55216&&t<=55295,"Private Use Area":t=>t>=57344&&t<=63743,"CJK Compatibility Ideographs":t=>t>=63744&&t<=64255,"Arabic Presentation Forms-A":t=>t>=64336&&t<=65023,"Vertical Forms":t=>t>=65040&&t<=65055,"CJK Compatibility Forms":t=>t>=65072&&t<=65103,"Small Form Variants":t=>t>=65104&&t<=65135,"Arabic Presentation Forms-B":t=>t>=65136&&t<=65279,"Halfwidth and Fullwidth Forms":t=>t>=65280&&t<=65519};function hn(t){for(let e of t)if(lo(e.charCodeAt(0)))return!0;return!1}function Pc(t){for(let e of t)if(!sd(e.charCodeAt(0)))return!1;return!0}function sd(t){return!(D.Arabic(t)||D["Arabic Supplement"](t)||D["Arabic Extended-A"](t)||D["Arabic Presentation Forms-A"](t)||D["Arabic Presentation Forms-B"](t))}function Sc(t){return t<11904?!1:!!(D["Bopomofo Extended"](t)||D.Bopomofo(t)||D["CJK Compatibility Forms"](t)||D["CJK Compatibility Ideographs"](t)||D["CJK Compatibility"](t)||D["CJK Radicals Supplement"](t)||D["CJK Strokes"](t)||D["CJK Symbols and Punctuation"](t)||D["CJK Unified Ideographs Extension A"](t)||D["CJK Unified Ideographs"](t)||D["Enclosed CJK Letters and Months"](t)||D["Halfwidth and Fullwidth Forms"](t)||D.Hiragana(t)||D["Ideographic Description Characters"](t)||D["Kangxi Radicals"](t)||D["Katakana Phonetic Extensions"](t)||D.Katakana(t)||D["Vertical Forms"](t)||D["Yi Radicals"](t)||D["Yi Syllables"](t))}function lo(t){return t===746||t===747?!0:t<4352?!1:!!(D["Bopomofo Extended"](t)||D.Bopomofo(t)||D["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||D["CJK Compatibility Ideographs"](t)||D["CJK Compatibility"](t)||D["CJK Radicals Supplement"](t)||D["CJK Strokes"](t)||D["CJK Symbols and Punctuation"](t)&&!(t>=12296&&t<=12305)&&!(t>=12308&&t<=12319)&&t!==12336||D["CJK Unified Ideographs Extension A"](t)||D["CJK Unified Ideographs"](t)||D["Enclosed CJK Letters and Months"](t)||D["Hangul Compatibility Jamo"](t)||D["Hangul Jamo Extended-A"](t)||D["Hangul Jamo Extended-B"](t)||D["Hangul Jamo"](t)||D["Hangul Syllables"](t)||D.Hiragana(t)||D["Ideographic Description Characters"](t)||D.Kanbun(t)||D["Kangxi Radicals"](t)||D["Katakana Phonetic Extensions"](t)||D.Katakana(t)&&t!==12540||D["Halfwidth and Fullwidth Forms"](t)&&t!==65288&&t!==65289&&t!==65293&&!(t>=65306&&t<=65310)&&t!==65339&&t!==65341&&t!==65343&&!(t>=65371&&t<=65503)&&t!==65507&&!(t>=65512&&t<=65519)||D["Small Form Variants"](t)&&!(t>=65112&&t<=65118)&&!(t>=65123&&t<=65126)||D["Unified Canadian Aboriginal Syllabics"](t)||D["Unified Canadian Aboriginal Syllabics Extended"](t)||D["Vertical Forms"](t)||D["Yijing Hexagram Symbols"](t)||D["Yi Syllables"](t)||D["Yi Radicals"](t))}function ld(t){return!!(D["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||D["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||D["Letterlike Symbols"](t)||D["Number Forms"](t)||D["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||D["Control Pictures"](t)&&t!==9251||D["Optical Character Recognition"](t)||D["Enclosed Alphanumerics"](t)||D["Geometric Shapes"](t)||D["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||D["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||D["CJK Symbols and Punctuation"](t)||D.Katakana(t)||D["Private Use Area"](t)||D["CJK Compatibility Forms"](t)||D["Small Form Variants"](t)||D["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}function As(t){return!(lo(t)||ld(t))}function wc(t){return D.Arabic(t)||D["Arabic Supplement"](t)||D["Arabic Extended-A"](t)||D["Arabic Presentation Forms-A"](t)||D["Arabic Presentation Forms-B"](t)}function Ac(t){return t>=1424&&t<=2303||D["Arabic Presentation Forms-A"](t)||D["Arabic Presentation Forms-B"](t)}function ud(t,e){return!(!e&&Ac(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||D.Khmer(t))}function _c(t){for(let e of t)if(Ac(e.charCodeAt(0)))return!0;return!1}function Ic(t,e){for(let r of t)if(!ud(r.charCodeAt(0),e))return!1;return!0}var _s=class{constructor(){this.applyArabicShaping=null;this.processBidirectionalText=null;this.processStyledBidirectionalText=null;this.pluginStatus="unavailable";this.pluginURL=null}setState(e){this.pluginStatus=e.pluginStatus,this.pluginURL=e.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(e){this.applyArabicShaping=e.applyArabicShaping,this.processBidirectionalText=e.processBidirectionalText,this.processStyledBidirectionalText=e.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}},ye=new _s;var q=class{constructor(e,r){this.zoom=e,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new so,this.transition={})}isSupportedScript(e){return Ic(e,ye.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let e=this.zoom,r=e-Math.floor(e),n=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*r}}};var Sr=class{constructor(e,r){this.property=e,this.value=r,this.expression=$u(r===void 0?e.specification.default:r,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,r,n){return this.property.possiblyEvaluate(this,e,r,n)}},dn=class{constructor(e){this.property=e,this.value=new Sr(e,void 0)}transitioned(e,r){return new co(this.property,this.value,r,Pe({},e.transition,this.transition),e.now)}untransitioned(){return new co(this.property,this.value,null,{},0)}},uo=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return nt(this._values[e].value.value)}setValue(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new dn(this._values[e].property)),this._values[e].value=new Sr(this._values[e].property,r===null?void 0:nt(r))}getTransition(e){return nt(this._values[e].transition)}setTransition(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new dn(this._values[e].property)),this._values[e].transition=nt(r)||void 0}serialize(){let e={};for(let r of Object.keys(this._values)){let n=this.getValue(r);n!==void 0&&(e[r]=n);let i=this.getTransition(r);i!==void 0&&(e["".concat(r,"-transition")]=i)}return e}transitioned(e,r){let n=new po(this._properties);for(let i of Object.keys(this._values))n._values[i]=this._values[i].transitioned(e,r._values[i]);return n}untransitioned(){let e=new po(this._properties);for(let r of Object.keys(this._values))e._values[r]=this._values[r].untransitioned();return e}},co=class{constructor(e,r,n,i,o){this.property=e,this.value=r,this.begin=o+i.delay||0,this.end=this.begin+i.duration||0,e.specification.transition&&(i.delay||i.duration)&&(this.prior=n)}possiblyEvaluate(e,r,n){let i=e.now||0,o=this.value.possiblyEvaluate(e,r,n),a=this.prior;if(a){if(i>this.end)return this.prior=null,o;if(this.value.isDataDriven())return this.prior=null,o;if(i<this.begin)return a.possiblyEvaluate(e,r,n);{let s=(i-this.begin)/(this.end-this.begin);return this.property.interpolate(a.possiblyEvaluate(e,r,n),o,Wl(s))}}else return o}},po=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,r,n){let i=new vt(this._properties);for(let o of Object.keys(this._values))i._values[o]=this._values[o].possiblyEvaluate(e,r,n);return i}hasTransition(){for(let e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}},fo=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return this._values[e].value!==void 0}getValue(e){return nt(this._values[e].value)}setValue(e,r){this._values[e]=new Sr(this._values[e].property,r===null?void 0:nt(r))}serialize(){let e={};for(let r of Object.keys(this._values)){let n=this.getValue(r);n!==void 0&&(e[r]=n)}return e}possiblyEvaluate(e,r,n){let i=new vt(this._properties);for(let o of Object.keys(this._values))i._values[o]=this._values[o].possiblyEvaluate(e,r,n);return i}},Se=class{constructor(e,r,n){this.property=e,this.value=r,this.parameters=n}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,r,n,i){return this.property.evaluate(this.value,this.parameters,e,r,n,i)}},vt=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}},B=class{constructor(e){this.specification=e}possiblyEvaluate(e,r){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(r)}interpolate(e,r,n){let i=this.specification.type,o=Oe[i];return o?o(e,r,n):e}},R=class{constructor(e,r){this.specification=e,this.overrides=r}possiblyEvaluate(e,r,n,i){return e.expression.kind==="constant"||e.expression.kind==="camera"?new Se(this,{kind:"constant",value:e.expression.evaluate(r,null,{},n,i)},r):new Se(this,e.expression,r)}interpolate(e,r,n){if(e.value.kind!=="constant"||r.value.kind!=="constant")return e;if(e.value.value===void 0||r.value.value===void 0)return new Se(this,{kind:"constant",value:void 0},e.parameters);let i=this.specification.type,o=Oe[i];if(o){let a=o(e.value.value,r.value.value,n);return new Se(this,{kind:"constant",value:a},e.parameters)}else return e}evaluate(e,r,n,i,o,a){return e.kind==="constant"?e.value:e.evaluate(r,n,i,o,a)}},lt=class extends R{possiblyEvaluate(e,r,n,i){if(e.value===void 0)return new Se(this,{kind:"constant",value:void 0},r);if(e.expression.kind==="constant"){let o=e.expression.evaluate(r,null,{},n,i),s=e.property.specification.type==="resolvedImage"&&typeof o!="string"?o.name:o,l=this._calculate(s,s,s,r);return new Se(this,{kind:"constant",value:l},r)}else if(e.expression.kind==="camera"){let o=this._calculate(e.expression.evaluate({zoom:r.zoom-1}),e.expression.evaluate({zoom:r.zoom}),e.expression.evaluate({zoom:r.zoom+1}),r);return new Se(this,{kind:"constant",value:o},r)}else return new Se(this,e.expression,r)}evaluate(e,r,n,i,o,a){if(e.kind==="source"){let s=e.evaluate(r,n,i,o,a);return this._calculate(s,s,s,r)}else return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(r.zoom)-1},n,i),e.evaluate({zoom:Math.floor(r.zoom)},n,i),e.evaluate({zoom:Math.floor(r.zoom)+1},n,i),r):e.value}_calculate(e,r,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:n,to:r}}interpolate(e){return e}},Jt=class{constructor(e){this.specification=e}possiblyEvaluate(e,r,n,i){if(e.value!==void 0)if(e.expression.kind==="constant"){let o=e.expression.evaluate(r,null,{},n,i);return this._calculate(o,o,o,r)}else return this._calculate(e.expression.evaluate(new q(Math.floor(r.zoom-1),r)),e.expression.evaluate(new q(Math.floor(r.zoom),r)),e.expression.evaluate(new q(Math.floor(r.zoom+1),r)),r)}_calculate(e,r,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:n,to:r}}interpolate(e){return e}},Zt=class{constructor(e){this.specification=e}possiblyEvaluate(e,r,n,i){return!!e.expression.evaluate(r,null,{},n,i)}interpolate(){return!1}},re=class{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(let r in e){let n=e[r];n.specification.overridable&&this.overridableProperties.push(r);let i=this.defaultPropertyValues[r]=new Sr(n,void 0),o=this.defaultTransitionablePropertyValues[r]=new dn(n);this.defaultTransitioningPropertyValues[r]=o.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=i.possiblyEvaluate({})}}};C("DataDrivenProperty",R);C("DataConstantProperty",B);C("CrossFadedDataDrivenProperty",lt);C("CrossFadedProperty",Jt);C("ColorRampProperty",Zt);var yo="-transition",se=class extends ao{constructor(e,r){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},e.type!=="custom"&&(e=e,this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),r.layout&&(this._unevaluatedLayout=new fo(r.layout)),r.paint)){this._transitionablePaint=new uo(r.paint);for(let n in e.paint)this.setPaintProperty(n,e.paint[n],{validate:!1});for(let n in e.layout)this.setLayoutProperty(n,e.layout[n],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new vt(r.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,r,n={}){if(r!=null){let i="layers.".concat(this.id,".layout.").concat(e);if(this._validate(bc,i,e,r,n))return}if(e==="visibility"){this.visibility=r;return}this._unevaluatedLayout.setValue(e,r)}getPaintProperty(e){return e.endsWith(yo)?this._transitionablePaint.getTransition(e.slice(0,-yo.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,r,n={}){if(r!=null){let i="layers.".concat(this.id,".paint.").concat(e);if(this._validate(xc,i,e,r,n))return!1}if(e.endsWith(yo))return this._transitionablePaint.setTransition(e.slice(0,-yo.length),r||void 0),!1;{let i=this._transitionablePaint._values[e],o=i.property.specification["property-type"]==="cross-faded-data-driven",a=i.value.isDataDriven(),s=i.value;this._transitionablePaint.setValue(e,r),this._handleSpecialPaintPropertyUpdate(e);let l=this._transitionablePaint._values[e].value;return l.isDataDriven()||a||o||this._handleOverridablePaintPropertyUpdate(e,s,l)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,r,n){return!1}isHidden(e){return this.minzoom&&e<this.minzoom||this.maxzoom&&e>=this.maxzoom?!0:this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,r){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,r)}serialize(){let e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Kl(e,(r,n)=>r!==void 0&&!(n==="layout"&&!Object.keys(r).length)&&!(n==="paint"&&!Object.keys(r).length))}_validate(e,r,n,i,o={}){return o&&o.validate===!1?!1:vc(this,e.call(bt,{key:r,layerType:this.type,objectKey:n,value:i,styleSpec:S,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let e in this.paint._values){let r=this.paint.get(e);if(!(!(r instanceof Se)||!ht(r.property.specification))&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}};var cd={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Pt=class{constructor(e,r){this._structArray=e,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}},pd=128,fd=5,ee=class{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,r){return e._trim(),r&&(e.isTransferred=!0,r.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){let r=Object.create(this.prototype);return r.arrayBuffer=e.arrayBuffer,r.length=e.length,r.capacity=e.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(this.capacity*fd),pd),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}};function Y(t,e=1){let r=0,n=0,i=t.map(a=>{let s=yd(a.type),l=r=Tc(r,Math.max(e,s)),u=a.components||1;return n=Math.max(n,s),r+=s*u,{name:a.name,type:a.type,components:u,offset:l}}),o=Tc(r,Math.max(n,e));return{members:i,size:o,alignment:e}}function yd(t){return cd[t].BYTES_PER_ELEMENT}function Tc(t,e){return Math.ceil(t/e)*e}var Cc=Z(he(),1),Wt=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r){let n=this.length;return this.resize(n+1),this.emplace(n,e,r)}emplace(e,r,n){let i=e*2;return this.int16[i+0]=r,this.int16[i+1]=n,e}};Wt.prototype.bytesPerElement=4;C("StructArrayLayout2i4",Wt);var gn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,e,r,n)}emplace(e,r,n,i){let o=e*3;return this.int16[o+0]=r,this.int16[o+1]=n,this.int16[o+2]=i,e}};gn.prototype.bytesPerElement=6;C("StructArrayLayout3i6",gn);var mo=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i){let o=this.length;return this.resize(o+1),this.emplace(o,e,r,n,i)}emplace(e,r,n,i,o){let a=e*4;return this.int16[a+0]=r,this.int16[a+1]=n,this.int16[a+2]=i,this.int16[a+3]=o,e}};mo.prototype.bytesPerElement=8;C("StructArrayLayout4i8",mo);var xn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a){let s=this.length;return this.resize(s+1),this.emplace(s,e,r,n,i,o,a)}emplace(e,r,n,i,o,a,s){let l=e*6;return this.int16[l+0]=r,this.int16[l+1]=n,this.int16[l+2]=i,this.int16[l+3]=o,this.int16[l+4]=a,this.int16[l+5]=s,e}};xn.prototype.bytesPerElement=12;C("StructArrayLayout2i4i12",xn);var bn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a){let s=this.length;return this.resize(s+1),this.emplace(s,e,r,n,i,o,a)}emplace(e,r,n,i,o,a,s){let l=e*4,u=e*8;return this.int16[l+0]=r,this.int16[l+1]=n,this.uint8[u+4]=i,this.uint8[u+5]=o,this.uint8[u+6]=a,this.uint8[u+7]=s,e}};bn.prototype.bytesPerElement=8;C("StructArrayLayout2i4ub8",bn);var St=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r){let n=this.length;return this.resize(n+1),this.emplace(n,e,r)}emplace(e,r,n){let i=e*2;return this.float32[i+0]=r,this.float32[i+1]=n,e}};St.prototype.bytesPerElement=8;C("StructArrayLayout2f8",St);var vn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a,s,l,u,c){let p=this.length;return this.resize(p+1),this.emplace(p,e,r,n,i,o,a,s,l,u,c)}emplace(e,r,n,i,o,a,s,l,u,c,p){let f=e*10;return this.uint16[f+0]=r,this.uint16[f+1]=n,this.uint16[f+2]=i,this.uint16[f+3]=o,this.uint16[f+4]=a,this.uint16[f+5]=s,this.uint16[f+6]=l,this.uint16[f+7]=u,this.uint16[f+8]=c,this.uint16[f+9]=p,e}};vn.prototype.bytesPerElement=20;C("StructArrayLayout10ui20",vn);var Pn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a,s,l,u,c,p,f){let y=this.length;return this.resize(y+1),this.emplace(y,e,r,n,i,o,a,s,l,u,c,p,f)}emplace(e,r,n,i,o,a,s,l,u,c,p,f,y){let m=e*12;return this.int16[m+0]=r,this.int16[m+1]=n,this.int16[m+2]=i,this.int16[m+3]=o,this.uint16[m+4]=a,this.uint16[m+5]=s,this.uint16[m+6]=l,this.uint16[m+7]=u,this.int16[m+8]=c,this.int16[m+9]=p,this.int16[m+10]=f,this.int16[m+11]=y,e}};Pn.prototype.bytesPerElement=24;C("StructArrayLayout4i4ui4i24",Pn);var Sn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,e,r,n)}emplace(e,r,n,i){let o=e*3;return this.float32[o+0]=r,this.float32[o+1]=n,this.float32[o+2]=i,e}};Sn.prototype.bytesPerElement=12;C("StructArrayLayout3f12",Sn);var wn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){let n=e*1;return this.uint32[n+0]=r,e}};wn.prototype.bytesPerElement=4;C("StructArrayLayout1ul4",wn);var An=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a,s,l,u){let c=this.length;return this.resize(c+1),this.emplace(c,e,r,n,i,o,a,s,l,u)}emplace(e,r,n,i,o,a,s,l,u,c){let p=e*10,f=e*5;return this.int16[p+0]=r,this.int16[p+1]=n,this.int16[p+2]=i,this.int16[p+3]=o,this.int16[p+4]=a,this.int16[p+5]=s,this.uint32[f+3]=l,this.uint16[p+8]=u,this.uint16[p+9]=c,e}};An.prototype.bytesPerElement=20;C("StructArrayLayout6i1ul2ui20",An);var _n=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a){let s=this.length;return this.resize(s+1),this.emplace(s,e,r,n,i,o,a)}emplace(e,r,n,i,o,a,s){let l=e*6;return this.int16[l+0]=r,this.int16[l+1]=n,this.int16[l+2]=i,this.int16[l+3]=o,this.int16[l+4]=a,this.int16[l+5]=s,e}};_n.prototype.bytesPerElement=12;C("StructArrayLayout2i2i2i12",_n);var ho=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o){let a=this.length;return this.resize(a+1),this.emplace(a,e,r,n,i,o)}emplace(e,r,n,i,o,a){let s=e*4,l=e*8;return this.float32[s+0]=r,this.float32[s+1]=n,this.float32[s+2]=i,this.int16[l+6]=o,this.int16[l+7]=a,e}};ho.prototype.bytesPerElement=16;C("StructArrayLayout2f1f2i16",ho);var In=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,i){let o=this.length;return this.resize(o+1),this.emplace(o,e,r,n,i)}emplace(e,r,n,i,o){let a=e*12,s=e*3;return this.uint8[a+0]=r,this.uint8[a+1]=n,this.float32[s+1]=i,this.float32[s+2]=o,e}};In.prototype.bytesPerElement=12;C("StructArrayLayout2ub2f12",In);var Tn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,e,r,n)}emplace(e,r,n,i){let o=e*3;return this.uint16[o+0]=r,this.uint16[o+1]=n,this.uint16[o+2]=i,e}};Tn.prototype.bytesPerElement=6;C("StructArrayLayout3ui6",Tn);var Cn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g){let b=this.length;return this.resize(b+1),this.emplace(b,e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g)}emplace(e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g,b){let x=e*24,v=e*12,P=e*48;return this.int16[x+0]=r,this.int16[x+1]=n,this.uint16[x+2]=i,this.uint16[x+3]=o,this.uint32[v+2]=a,this.uint32[v+3]=s,this.uint32[v+4]=l,this.uint16[x+10]=u,this.uint16[x+11]=c,this.uint16[x+12]=p,this.float32[v+7]=f,this.float32[v+8]=y,this.uint8[P+36]=m,this.uint8[P+37]=h,this.uint8[P+38]=d,this.uint32[v+10]=g,this.int16[x+22]=b,e}};Cn.prototype.bytesPerElement=48;C("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Cn);var kn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g,b,x,v,P,w,T,F,E,_,I,k){let V=this.length;return this.resize(V+1),this.emplace(V,e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g,b,x,v,P,w,T,F,E,_,I,k)}emplace(e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g,b,x,v,P,w,T,F,E,_,I,k,V){let A=e*32,z=e*16;return this.int16[A+0]=r,this.int16[A+1]=n,this.int16[A+2]=i,this.int16[A+3]=o,this.int16[A+4]=a,this.int16[A+5]=s,this.int16[A+6]=l,this.int16[A+7]=u,this.uint16[A+8]=c,this.uint16[A+9]=p,this.uint16[A+10]=f,this.uint16[A+11]=y,this.uint16[A+12]=m,this.uint16[A+13]=h,this.uint16[A+14]=d,this.uint16[A+15]=g,this.uint16[A+16]=b,this.uint16[A+17]=x,this.uint16[A+18]=v,this.uint16[A+19]=P,this.uint16[A+20]=w,this.uint16[A+21]=T,this.uint16[A+22]=F,this.uint32[z+12]=E,this.float32[z+13]=_,this.float32[z+14]=I,this.uint16[A+30]=k,this.uint16[A+31]=V,e}};kn.prototype.bytesPerElement=64;C("StructArrayLayout8i15ui1ul2f2ui64",kn);var Ht=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){let n=e*1;return this.float32[n+0]=r,e}};Ht.prototype.bytesPerElement=4;C("StructArrayLayout1f4",Ht);var Mn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,e,r,n)}emplace(e,r,n,i){let o=e*6,a=e*3;return this.uint16[o+0]=r,this.float32[a+1]=n,this.float32[a+2]=i,e}};Mn.prototype.bytesPerElement=12;C("StructArrayLayout1ui2f12",Mn);var En=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,e,r,n)}emplace(e,r,n,i){let o=e*2,a=e*4;return this.uint32[o+0]=r,this.uint16[a+2]=n,this.uint16[a+3]=i,e}};En.prototype.bytesPerElement=8;C("StructArrayLayout1ul2ui8",En);var Fn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r){let n=this.length;return this.resize(n+1),this.emplace(n,e,r)}emplace(e,r,n){let i=e*2;return this.uint16[i+0]=r,this.uint16[i+1]=n,e}};Fn.prototype.bytesPerElement=4;C("StructArrayLayout2ui4",Fn);var go=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){let n=e*1;return this.uint16[n+0]=r,e}};go.prototype.bytesPerElement=2;C("StructArrayLayout1ui2",go);var wr=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,i){let o=this.length;return this.resize(o+1),this.emplace(o,e,r,n,i)}emplace(e,r,n,i,o){let a=e*4;return this.float32[a+0]=r,this.float32[a+1]=n,this.float32[a+2]=i,this.float32[a+3]=o,e}};wr.prototype.bytesPerElement=16;C("StructArrayLayout4f16",wr);var xo=class extends Pt{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Cc.default(this.anchorPointX,this.anchorPointY)}};xo.prototype.size=20;var Ln=class extends An{get(e){return new xo(this,e)}};C("CollisionBoxArray",Ln);var bo=class extends Pt{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}};bo.prototype.size=48;var Dn=class extends Cn{get(e){return new bo(this,e)}};C("PlacedSymbolArray",Dn);var vo=class extends Pt{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}};vo.prototype.size=64;var Vn=class extends kn{get(e){return new vo(this,e)}};C("SymbolInstanceArray",Vn);var Bn=class extends Ht{getoffsetX(e){return this.float32[e*1+0]}};C("GlyphOffsetArray",Bn);var zn=class extends gn{getx(e){return this.int16[e*3+0]}gety(e){return this.int16[e*3+1]}gettileUnitDistanceFromAnchor(e){return this.int16[e*3+2]}};C("SymbolLineVertexArray",zn);var Po=class extends Pt{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}};Po.prototype.size=12;var Rn=class extends Mn{get(e){return new Po(this,e)}};C("TextAnchorOffsetArray",Rn);var So=class extends Pt{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}};So.prototype.size=8;var On=class extends En{get(e){return new So(this,e)}};C("FeatureIndexArray",On);var wo=class extends Wt{};var Ao=class extends Wt{},_o=class extends Wt{},Io=class extends xn{};var To=class extends bn{},Co=class extends St{},ut=class extends vn{},ko=class extends Pn{},Mo=class extends Sn{},Eo=class extends wn{},Nn=class extends _n{};var Fo=class extends In{};var Le=class extends Tn{},wt=class extends Fn{};var md=Y([{name:"a_pos",components:2,type:"Int16"}],4);var{members:kc,size:$v,alignment:Gv}=md;var me=class t{constructor(e=[]){this.segments=e}prepareSegment(e,r,n,i){let o=this.segments[this.segments.length-1];return e>t.MAX_VERTEX_ARRAY_LENGTH&&fe("Max vertices per segment is ".concat(t.MAX_VERTEX_ARRAY_LENGTH,": bucket requested ").concat(e)),(!o||o.vertexLength+e>t.MAX_VERTEX_ARRAY_LENGTH||o.sortKey!==i)&&(o={vertexOffset:r.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},i!==void 0&&(o.sortKey=i),this.segments.push(o)),o}get(){return this.segments}destroy(){for(let e of this.segments)for(let r in e.vaos)e.vaos[r].destroy()}static simpleSegment(e,r,n,i){return new t([{vertexOffset:e,primitiveOffset:r,vertexLength:n,primitiveLength:i,vaos:{},sortKey:0}])}};me.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1;C("SegmentVector",me);function Is(t,e){return t=it(Math.floor(t),0,255),e=it(Math.floor(e),0,255),256*t+e}var Un=Y([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Dc=Z(ks(),1);var $n=class t{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,r,n,i){this.ids.push(Lc(e)),this.positions.push(r,n,i)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");let r=Lc(e),n=0,i=this.ids.length-1;for(;n<i;){let a=n+i>>1;this.ids[a]>=r?i=a:n=a+1}let o=[];for(;this.ids[n]===r;){let a=this.positions[3*n],s=this.positions[3*n+1],l=this.positions[3*n+2];o.push({index:a,start:s,end:l}),n++}return o}static serialize(e,r){let n=new Float64Array(e.ids),i=new Uint32Array(e.positions);return Ms(n,i,0,n.length-1),r&&r.push(n.buffer,i.buffer),{ids:n,positions:i}}static deserialize(e){let r=new t;return r.ids=e.ids,r.positions=e.positions,r.indexed=!0,r}};function Lc(t){let e=+t;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:(0,Dc.default)(String(t))}function Ms(t,e,r,n){for(;r<n;){let i=t[r+n>>1],o=r-1,a=n+1;for(;;){do o++;while(t[o]<i);do a--;while(t[a]>i);if(o>=a)break;Do(t,o,a),Do(e,3*o,3*a),Do(e,3*o+1,3*a+1),Do(e,3*o+2,3*a+2)}a-r<n-a?(Ms(t,e,r,a),r=a+1):(Ms(t,e,a+1,n),n=a)}}function Do(t,e,r){let n=t[e];t[e]=t[r],t[r]=n}C("FeaturePositionMap",$n);var Gn=class{constructor(e,r){this.gl=e.gl,this.location=r}};var Ar=class extends Gn{constructor(e,r){super(e,r),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}};var Vo=class extends Gn{constructor(e,r){super(e,r),this.current=[0,0,0,0]}set(e){(e[0]!==this.current[0]||e[1]!==this.current[1]||e[2]!==this.current[2]||e[3]!==this.current[3])&&(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}},Bo=class extends Gn{constructor(e,r){super(e,r),this.current=W.transparent}set(e){(e.r!==this.current.r||e.g!==this.current.g||e.b!==this.current.b||e.a!==this.current.a)&&(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}},i1=new Float32Array(16);function Es(t){return[Is(255*t.r,255*t.g),Is(255*t.b,255*t.a)]}var Xt=class{constructor(e,r,n){this.value=e,this.uniformNames=r.map(i=>"u_".concat(i)),this.type=n}setUniform(e,r,n){e.set(n.constantOr(this.value))}getBinding(e,r,n){return this.type==="color"?new Bo(e,r):new Ar(e,r)}},At=class{constructor(e,r){this.uniformNames=r.map(n=>"u_".concat(n)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=e.tlbr}setUniform(e,r,n,i){let o=i==="u_pattern_to"?this.patternTo:i==="u_pattern_from"?this.patternFrom:i==="u_pixel_ratio_to"?this.pixelRatioTo:i==="u_pixel_ratio_from"?this.pixelRatioFrom:null;o&&e.set(o)}getBinding(e,r,n){return n.substr(0,9)==="u_pattern"?new Vo(e,r):new Ar(e,r)}},We=class{constructor(e,r,n,i){this.expression=e,this.type=n,this.maxValue=0,this.paintVertexAttributes=r.map(o=>({name:"a_".concat(o),type:"Float32",components:n==="color"?2:1,offset:0})),this.paintVertexArray=new i}populatePaintArray(e,r,n,i,o){let a=this.paintVertexArray.length,s=this.expression.evaluate(new q(0),r,{},i,[],o);this.paintVertexArray.resize(e),this._setPaintValue(a,e,s)}updatePaintArray(e,r,n,i){let o=this.expression.evaluate({zoom:0},n,i);this._setPaintValue(e,r,o)}_setPaintValue(e,r,n){if(this.type==="color"){let i=Es(n);for(let o=e;o<r;o++)this.paintVertexArray.emplace(o,i[0],i[1])}else{for(let i=e;i<r;i++)this.paintVertexArray.emplace(i,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}},De=class{constructor(e,r,n,i,o,a){this.expression=e,this.uniformNames=r.map(s=>"u_".concat(s,"_t")),this.type=n,this.useIntegerZoom=i,this.zoom=o,this.maxValue=0,this.paintVertexAttributes=r.map(s=>({name:"a_".concat(s),type:"Float32",components:n==="color"?4:2,offset:0})),this.paintVertexArray=new a}populatePaintArray(e,r,n,i,o){let a=this.expression.evaluate(new q(this.zoom),r,{},i,[],o),s=this.expression.evaluate(new q(this.zoom+1),r,{},i,[],o),l=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(l,e,a,s)}updatePaintArray(e,r,n,i){let o=this.expression.evaluate({zoom:this.zoom},n,i),a=this.expression.evaluate({zoom:this.zoom+1},n,i);this._setPaintValue(e,r,o,a)}_setPaintValue(e,r,n,i){if(this.type==="color"){let o=Es(n),a=Es(i);for(let s=e;s<r;s++)this.paintVertexArray.emplace(s,o[0],o[1],a[0],a[1])}else{for(let o=e;o<r;o++)this.paintVertexArray.emplace(o,n,i);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(i))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,r){let n=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,i=it(this.expression.interpolationFactor(n,this.zoom,this.zoom+1),0,1);e.set(i)}getBinding(e,r,n){return new Ar(e,r)}},et=class{constructor(e,r,n,i,o,a){this.expression=e,this.type=r,this.useIntegerZoom=n,this.zoom=i,this.layerId=a,this.zoomInPaintVertexArray=new o,this.zoomOutPaintVertexArray=new o}populatePaintArray(e,r,n){let i=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(i,e,r.patterns&&r.patterns[this.layerId],n)}updatePaintArray(e,r,n,i,o){this._setPaintValues(e,r,n.patterns&&n.patterns[this.layerId],o)}_setPaintValues(e,r,n,i){if(!i||!n)return;let{min:o,mid:a,max:s}=n,l=i[o],u=i[a],c=i[s];if(!(!l||!u||!c))for(let p=e;p<r;p++)this.zoomInPaintVertexArray.emplace(p,u.tl[0],u.tl[1],u.br[0],u.br[1],l.tl[0],l.tl[1],l.br[0],l.br[1],u.pixelRatio,l.pixelRatio),this.zoomOutPaintVertexArray.emplace(p,u.tl[0],u.tl[1],u.br[0],u.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1],u.pixelRatio,c.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Un.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Un.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}},zo=class{constructor(e,r,n){this.binders={},this._buffers=[];let i=[];for(let o in e.paint._values){if(!n(o))continue;let a=e.paint.get(o);if(!(a instanceof Se)||!ht(a.property.specification))continue;let s=xd(o,e.type),l=a.value,u=a.property.specification.type,c=a.property.useIntegerZoom,p=a.property.specification["property-type"],f=p==="cross-faded"||p==="cross-faded-data-driven";if(l.kind==="constant")this.binders[o]=f?new At(l.value,s):new Xt(l.value,s,u),i.push("/u_".concat(o));else if(l.kind==="source"||f){let y=Vc(o,u,"source");this.binders[o]=f?new et(l,u,c,r,y,e.id):new We(l,s,u,y),i.push("/a_".concat(o))}else{let y=Vc(o,u,"composite");this.binders[o]=new De(l,s,u,c,r,y),i.push("/z_".concat(o))}}this.cacheKey=i.sort().join("")}getMaxValue(e){let r=this.binders[e];return r instanceof We||r instanceof De?r.maxValue:0}populatePaintArrays(e,r,n,i,o){for(let a in this.binders){let s=this.binders[a];(s instanceof We||s instanceof De||s instanceof et)&&s.populatePaintArray(e,r,n,i,o)}}setConstantPatternPositions(e,r){for(let n in this.binders){let i=this.binders[n];i instanceof At&&i.setConstantPatternPositions(e,r)}}updatePaintArrays(e,r,n,i,o){let a=!1;for(let s in e){let l=r.getPositions(s);for(let u of l){let c=n.feature(u.index);for(let p in this.binders){let f=this.binders[p];if((f instanceof We||f instanceof De||f instanceof et)&&f.expression.isStateDependent===!0){let y=i.paint.get(p);f.expression=y.value,f.updatePaintArray(u.start,u.end,c,e[s],o),a=!0}}}}return a}defines(){let e=[];for(let r in this.binders){let n=this.binders[r];(n instanceof Xt||n instanceof At)&&e.push(...n.uniformNames.map(i=>"#define HAS_UNIFORM_".concat(i)))}return e}getBinderAttributes(){let e=[];for(let r in this.binders){let n=this.binders[r];if(n instanceof We||n instanceof De)for(let i=0;i<n.paintVertexAttributes.length;i++)e.push(n.paintVertexAttributes[i].name);else if(n instanceof et)for(let i=0;i<Un.members.length;i++)e.push(Un.members[i].name)}return e}getBinderUniforms(){let e=[];for(let r in this.binders){let n=this.binders[r];if(n instanceof Xt||n instanceof At||n instanceof De)for(let i of n.uniformNames)e.push(i)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,r){let n=[];for(let i in this.binders){let o=this.binders[i];if(o instanceof Xt||o instanceof At||o instanceof De){for(let a of o.uniformNames)if(r[a]){let s=o.getBinding(e,r[a],a);n.push({name:a,property:i,binding:s})}}}return n}setUniforms(e,r,n,i){for(let{name:o,property:a,binding:s}of r)this.binders[a].setUniform(s,i,n.get(a),o)}updatePaintBuffers(e){this._buffers=[];for(let r in this.binders){let n=this.binders[r];if(e&&n instanceof et){let i=e.fromScale===2?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;i&&this._buffers.push(i)}else(n instanceof We||n instanceof De)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(e){for(let r in this.binders){let n=this.binders[r];(n instanceof We||n instanceof De||n instanceof et)&&n.upload(e)}this.updatePaintBuffers()}destroy(){for(let e in this.binders){let r=this.binders[e];(r instanceof We||r instanceof De||r instanceof et)&&r.destroy()}}},Ce=class{constructor(e,r,n=()=>!0){this.programConfigurations={};for(let i of e)this.programConfigurations[i.id]=new zo(i,r,n);this.needsUpload=!1,this._featureMap=new $n,this._bufferOffset=0}populatePaintArrays(e,r,n,i,o,a){for(let s in this.programConfigurations)this.programConfigurations[s].populatePaintArrays(e,r,i,o,a);r.id!==void 0&&this._featureMap.add(r.id,n,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,r,n,i){for(let o of n)this.needsUpload=this.programConfigurations[o.id].updatePaintArrays(e,this._featureMap,r,o,i)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(let r in this.programConfigurations)this.programConfigurations[r].upload(e);this.needsUpload=!1}}destroy(){for(let e in this.programConfigurations)this.programConfigurations[e].destroy()}};function xd(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace("".concat(e,"-"),"").replace(/-/g,"_")]}function bd(t){return{"line-pattern":{source:ut,composite:ut},"fill-pattern":{source:ut,composite:ut},"fill-extrusion-pattern":{source:ut,composite:ut}}[t]}function Vc(t,e,r){let n={color:{source:St,composite:wr},number:{source:Ht,composite:St}},i=bd(t);return i&&i[r]||n[e][r]}C("ConstantBinder",Xt);C("CrossFadedConstantBinder",At);C("SourceExpressionBinder",We);C("CrossFadedCompositeBinder",et);C("CompositeExpressionBinder",De);C("ProgramConfiguration",zo,{omit:["_buffers"]});C("ProgramConfigurationSet",Ce);var vd=15,Fs=Math.pow(2,vd-1)-1,Bc=-Fs-1;function ke(t){let e=8192/t.extent,r=t.loadGeometry();for(let n=0;n<r.length;n++){let i=r[n];for(let o=0;o<i.length;o++){let a=i[o],s=Math.round(a.x*e),l=Math.round(a.y*e);a.x=it(s,Bc,Fs),a.y=it(l,Bc,Fs),(s<a.x||s>a.x+1||l<a.y||l>a.y+1)&&fe("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function $e(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?ke(t):[]}}function Ro(t,e,r,n,i){t.emplaceBack(e*2+(n+1)/2,r*2+(i+1)/2)}var Kt=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Ao,this.indexArray=new Le,this.segments=new me,this.programConfigurations=new Ce(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,n){let i=this.layers[0],o=[],a=null,s=!1;i.type==="circle"&&(a=i.layout.get("circle-sort-key"),s=!a.isConstant());for(let{feature:l,id:u,index:c,sourceLayerIndex:p}of e){let f=this.layers[0]._featureFilter.needGeometry,y=$e(l,f);if(!this.layers[0]._featureFilter.filter(new q(this.zoom),y,n))continue;let m=s?a.evaluate(y,{},n):void 0,h={id:u,properties:l.properties,type:l.type,sourceLayerIndex:p,index:c,geometry:f?y.geometry:ke(l),patterns:{},sortKey:m};o.push(h)}s&&o.sort((l,u)=>l.sortKey-u.sortKey);for(let l of o){let{geometry:u,index:c,sourceLayerIndex:p}=l,f=e[c].feature;this.addFeature(l,u,c,n),r.featureIndex.insert(f,u,c,p,this.index)}}update(e,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,kc),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,r,n,i){for(let o of r)for(let a of o){let s=a.x,l=a.y;if(s<0||s>=8192||l<0||l>=8192)continue;let u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),c=u.vertexLength;Ro(this.layoutVertexArray,s,l,-1,-1),Ro(this.layoutVertexArray,s,l,1,-1),Ro(this.layoutVertexArray,s,l,1,1),Ro(this.layoutVertexArray,s,l,-1,1),this.indexArray.emplaceBack(c,c+1,c+2),this.indexArray.emplaceBack(c,c+3,c+2),u.vertexLength+=4,u.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,{},i)}};C("CircleBucket",Kt,{omit:["layers"]});var qn=Z(he(),1);function Rc(t,e){for(let r=0;r<t.length;r++)if(_r(e,t[r]))return!0;for(let r=0;r<e.length;r++)if(_r(t,e[r]))return!0;return!!Ds(t,e)}function Oc(t,e,r){return!!(_r(t,e)||Ls(e,t,r))}function Oo(t,e){if(t.length===1)return zc(e,t[0]);for(let r=0;r<e.length;r++){let n=e[r];for(let i=0;i<n.length;i++)if(_r(t,n[i]))return!0}for(let r=0;r<t.length;r++)if(zc(e,t[r]))return!0;for(let r=0;r<e.length;r++)if(Ds(t,e[r]))return!0;return!1}function Nc(t,e,r){for(let n=0;n<e.length;n++){let i=e[n];if(t.length>=3){for(let o=0;o<i.length;o++)if(_r(t,i[o]))return!0}if(Pd(t,i,r))return!0}return!1}function Pd(t,e,r){if(t.length>1){if(Ds(t,e))return!0;for(let n=0;n<e.length;n++)if(Ls(e[n],t,r))return!0}for(let n=0;n<t.length;n++)if(Ls(t[n],e,r))return!0;return!1}function Ds(t,e){if(t.length===0||e.length===0)return!1;for(let r=0;r<t.length-1;r++){let n=t[r],i=t[r+1];for(let o=0;o<e.length-1;o++){let a=e[o],s=e[o+1];if(Sd(n,i,a,s))return!0}}return!1}function Sd(t,e,r,n){return ot(t,r,n)!==ot(e,r,n)&&ot(t,e,r)!==ot(t,e,n)}function Ls(t,e,r){let n=r*r;if(e.length===1)return t.distSqr(e[0])<n;for(let i=1;i<e.length;i++){let o=e[i-1],a=e[i];if(Vs(t,o,a)<n)return!0}return!1}function Vs(t,e,r){let n=e.distSqr(r);if(n===0)return t.distSqr(e);let i=((t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y))/n;return i<0?t.distSqr(e):i>1?t.distSqr(r):t.distSqr(r.sub(e)._mult(i)._add(e))}function zc(t,e){let r=!1,n,i,o;for(let a=0;a<t.length;a++){n=t[a];for(let s=0,l=n.length-1;s<n.length;l=s++)i=n[s],o=n[l],i.y>e.y!=o.y>e.y&&e.x<(o.x-i.x)*(e.y-i.y)/(o.y-i.y)+i.x&&(r=!r)}return r}function _r(t,e){let r=!1;for(let n=0,i=t.length-1;n<t.length;i=n++){let o=t[n],a=t[i];o.y>e.y!=a.y>e.y&&e.x<(a.x-o.x)*(e.y-o.y)/(a.y-o.y)+o.x&&(r=!r)}return r}function Uc(t,e,r,n,i){for(let a of t)if(e<=a.x&&r<=a.y&&n>=a.x&&i>=a.y)return!0;let o=[new qn.default(e,r),new qn.default(e,i),new qn.default(n,i),new qn.default(n,r)];if(t.length>2){for(let a of o)if(_r(t,a))return!0}for(let a=0;a<t.length-1;a++){let s=t[a],l=t[a+1];if(wd(s,l,o))return!0}return!1}function wd(t,e,r){let n=r[0],i=r[2];if(t.x<n.x&&e.x<n.x||t.x>i.x&&e.x>i.x||t.y<n.y&&e.y<n.y||t.y>i.y&&e.y>i.y)return!1;let o=ot(t,e,r[0]);return o!==ot(t,e,r[1])||o!==ot(t,e,r[2])||o!==ot(t,e,r[3])}var No=Z(he(),1);function Yt(t,e,r){let n=e.paint.get(t).value;return n.kind==="constant"?n.value:r.programConfigurations.get(e.id).getMaxValue(t)}function _t(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function It(t,e,r,n,i){if(!e[0]&&!e[1])return t;let o=No.default.convert(e)._mult(i);r==="viewport"&&o._rotate(-n);let a=[];for(let s=0;s<t.length;s++){let l=t[s];a.push(l.sub(o))}return a}function $c(t,e){let r=[];for(let n=0;n<t.length;n++){let i=t[n],o=[];for(let a=0;a<i.length;a++){let s=i[a-1],l=i[a],u=i[a+1],c=a===0?new No.default(0,0):l.sub(s)._unit()._perp(),p=a===i.length-1?new No.default(0,0):u.sub(l)._unit()._perp(),f=c._add(p)._unit(),y=f.x*p.x+f.y*p.y;y!==0&&f._mult(1/y),o.push(f._mult(e)._add(l))}r.push(o)}return r}var Gc,Ad=()=>Gc=Gc||new re({"circle-sort-key":new R(S.layout_circle["circle-sort-key"])}),qc,_d=()=>qc=qc||new re({"circle-radius":new R(S.paint_circle["circle-radius"]),"circle-color":new R(S.paint_circle["circle-color"]),"circle-blur":new R(S.paint_circle["circle-blur"]),"circle-opacity":new R(S.paint_circle["circle-opacity"]),"circle-translate":new B(S.paint_circle["circle-translate"]),"circle-translate-anchor":new B(S.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new B(S.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new B(S.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new R(S.paint_circle["circle-stroke-width"]),"circle-stroke-color":new R(S.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new R(S.paint_circle["circle-stroke-opacity"])}),jc={get paint(){return _d()},get layout(){return Ad()}};var Q=1e-6,Ge=typeof Float32Array<"u"?Float32Array:Array,jn=Math.random;var X1=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Jn={};Ol(Jn,{add:()=>ug,adjoint:()=>Ld,clone:()=>Td,copy:()=>Cd,create:()=>Id,determinant:()=>Dd,equals:()=>yg,exactEquals:()=>fg,frob:()=>lg,fromQuat:()=>Yd,fromQuat2:()=>Zd,fromRotation:()=>Gd,fromRotationTranslation:()=>Hc,fromRotationTranslationScale:()=>Xd,fromRotationTranslationScaleOrigin:()=>Kd,fromScaling:()=>$d,fromTranslation:()=>Ud,fromValues:()=>kd,fromXRotation:()=>qd,fromYRotation:()=>jd,fromZRotation:()=>Jd,frustum:()=>Qd,getRotation:()=>Hd,getScaling:()=>Xc,getTranslation:()=>Wd,identity:()=>Zc,invert:()=>Fd,lookAt:()=>og,mul:()=>mg,multiply:()=>Wc,multiplyScalar:()=>cg,multiplyScalarAndAdd:()=>pg,ortho:()=>ng,orthoNO:()=>Yc,orthoZO:()=>ig,perspective:()=>eg,perspectiveFromFieldOfView:()=>rg,perspectiveNO:()=>Kc,perspectiveZO:()=>tg,rotate:()=>zd,rotateX:()=>Rd,rotateY:()=>Od,rotateZ:()=>Nd,scale:()=>Bd,set:()=>Md,str:()=>sg,sub:()=>hg,subtract:()=>Qc,targetTo:()=>ag,translate:()=>Vd,transpose:()=>Ed});function Id(){var t=new Ge(16);return Ge!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Td(t){var e=new Ge(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Cd(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function kd(t,e,r,n,i,o,a,s,l,u,c,p,f,y,m,h){var d=new Ge(16);return d[0]=t,d[1]=e,d[2]=r,d[3]=n,d[4]=i,d[5]=o,d[6]=a,d[7]=s,d[8]=l,d[9]=u,d[10]=c,d[11]=p,d[12]=f,d[13]=y,d[14]=m,d[15]=h,d}function Md(t,e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=l,t[8]=u,t[9]=c,t[10]=p,t[11]=f,t[12]=y,t[13]=m,t[14]=h,t[15]=d,t}function Zc(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ed(t,e){if(t===e){var r=e[1],n=e[2],i=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Fd(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],p=e[9],f=e[10],y=e[11],m=e[12],h=e[13],d=e[14],g=e[15],b=r*s-n*a,x=r*l-i*a,v=r*u-o*a,P=n*l-i*s,w=n*u-o*s,T=i*u-o*l,F=c*h-p*m,E=c*d-f*m,_=c*g-y*m,I=p*d-f*h,k=p*g-y*h,V=f*g-y*d,A=b*V-x*k+v*I+P*_-w*E+T*F;return A?(A=1/A,t[0]=(s*V-l*k+u*I)*A,t[1]=(i*k-n*V-o*I)*A,t[2]=(h*T-d*w+g*P)*A,t[3]=(f*w-p*T-y*P)*A,t[4]=(l*_-a*V-u*E)*A,t[5]=(r*V-i*_+o*E)*A,t[6]=(d*v-m*T-g*x)*A,t[7]=(c*T-f*v+y*x)*A,t[8]=(a*k-s*_+u*F)*A,t[9]=(n*_-r*k-o*F)*A,t[10]=(m*w-h*v+g*b)*A,t[11]=(p*v-c*w-y*b)*A,t[12]=(s*E-a*I-l*F)*A,t[13]=(r*I-n*E+i*F)*A,t[14]=(h*x-m*P-d*b)*A,t[15]=(c*P-p*x+f*b)*A,t):null}function Ld(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],p=e[9],f=e[10],y=e[11],m=e[12],h=e[13],d=e[14],g=e[15];return t[0]=s*(f*g-y*d)-p*(l*g-u*d)+h*(l*y-u*f),t[1]=-(n*(f*g-y*d)-p*(i*g-o*d)+h*(i*y-o*f)),t[2]=n*(l*g-u*d)-s*(i*g-o*d)+h*(i*u-o*l),t[3]=-(n*(l*y-u*f)-s*(i*y-o*f)+p*(i*u-o*l)),t[4]=-(a*(f*g-y*d)-c*(l*g-u*d)+m*(l*y-u*f)),t[5]=r*(f*g-y*d)-c*(i*g-o*d)+m*(i*y-o*f),t[6]=-(r*(l*g-u*d)-a*(i*g-o*d)+m*(i*u-o*l)),t[7]=r*(l*y-u*f)-a*(i*y-o*f)+c*(i*u-o*l),t[8]=a*(p*g-y*h)-c*(s*g-u*h)+m*(s*y-u*p),t[9]=-(r*(p*g-y*h)-c*(n*g-o*h)+m*(n*y-o*p)),t[10]=r*(s*g-u*h)-a*(n*g-o*h)+m*(n*u-o*s),t[11]=-(r*(s*y-u*p)-a*(n*y-o*p)+c*(n*u-o*s)),t[12]=-(a*(p*d-f*h)-c*(s*d-l*h)+m*(s*f-l*p)),t[13]=r*(p*d-f*h)-c*(n*d-i*h)+m*(n*f-i*p),t[14]=-(r*(s*d-l*h)-a*(n*d-i*h)+m*(n*l-i*s)),t[15]=r*(s*f-l*p)-a*(n*f-i*p)+c*(n*l-i*s),t}function Dd(t){var e=t[0],r=t[1],n=t[2],i=t[3],o=t[4],a=t[5],s=t[6],l=t[7],u=t[8],c=t[9],p=t[10],f=t[11],y=t[12],m=t[13],h=t[14],d=t[15],g=e*a-r*o,b=e*s-n*o,x=e*l-i*o,v=r*s-n*a,P=r*l-i*a,w=n*l-i*s,T=u*m-c*y,F=u*h-p*y,E=u*d-f*y,_=c*h-p*m,I=c*d-f*m,k=p*d-f*h;return g*k-b*I+x*_+v*E-P*F+w*T}function Wc(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],p=e[8],f=e[9],y=e[10],m=e[11],h=e[12],d=e[13],g=e[14],b=e[15],x=r[0],v=r[1],P=r[2],w=r[3];return t[0]=x*n+v*s+P*p+w*h,t[1]=x*i+v*l+P*f+w*d,t[2]=x*o+v*u+P*y+w*g,t[3]=x*a+v*c+P*m+w*b,x=r[4],v=r[5],P=r[6],w=r[7],t[4]=x*n+v*s+P*p+w*h,t[5]=x*i+v*l+P*f+w*d,t[6]=x*o+v*u+P*y+w*g,t[7]=x*a+v*c+P*m+w*b,x=r[8],v=r[9],P=r[10],w=r[11],t[8]=x*n+v*s+P*p+w*h,t[9]=x*i+v*l+P*f+w*d,t[10]=x*o+v*u+P*y+w*g,t[11]=x*a+v*c+P*m+w*b,x=r[12],v=r[13],P=r[14],w=r[15],t[12]=x*n+v*s+P*p+w*h,t[13]=x*i+v*l+P*f+w*d,t[14]=x*o+v*u+P*y+w*g,t[15]=x*a+v*c+P*m+w*b,t}function Vd(t,e,r){var n=r[0],i=r[1],o=r[2],a,s,l,u,c,p,f,y,m,h,d,g;return e===t?(t[12]=e[0]*n+e[4]*i+e[8]*o+e[12],t[13]=e[1]*n+e[5]*i+e[9]*o+e[13],t[14]=e[2]*n+e[6]*i+e[10]*o+e[14],t[15]=e[3]*n+e[7]*i+e[11]*o+e[15]):(a=e[0],s=e[1],l=e[2],u=e[3],c=e[4],p=e[5],f=e[6],y=e[7],m=e[8],h=e[9],d=e[10],g=e[11],t[0]=a,t[1]=s,t[2]=l,t[3]=u,t[4]=c,t[5]=p,t[6]=f,t[7]=y,t[8]=m,t[9]=h,t[10]=d,t[11]=g,t[12]=a*n+c*i+m*o+e[12],t[13]=s*n+p*i+h*o+e[13],t[14]=l*n+f*i+d*o+e[14],t[15]=u*n+y*i+g*o+e[15]),t}function Bd(t,e,r){var n=r[0],i=r[1],o=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function zd(t,e,r,n){var i=n[0],o=n[1],a=n[2],s=Math.hypot(i,o,a),l,u,c,p,f,y,m,h,d,g,b,x,v,P,w,T,F,E,_,I,k,V,A,z;return s<Q?null:(s=1/s,i*=s,o*=s,a*=s,l=Math.sin(r),u=Math.cos(r),c=1-u,p=e[0],f=e[1],y=e[2],m=e[3],h=e[4],d=e[5],g=e[6],b=e[7],x=e[8],v=e[9],P=e[10],w=e[11],T=i*i*c+u,F=o*i*c+a*l,E=a*i*c-o*l,_=i*o*c-a*l,I=o*o*c+u,k=a*o*c+i*l,V=i*a*c+o*l,A=o*a*c-i*l,z=a*a*c+u,t[0]=p*T+h*F+x*E,t[1]=f*T+d*F+v*E,t[2]=y*T+g*F+P*E,t[3]=m*T+b*F+w*E,t[4]=p*_+h*I+x*k,t[5]=f*_+d*I+v*k,t[6]=y*_+g*I+P*k,t[7]=m*_+b*I+w*k,t[8]=p*V+h*A+x*z,t[9]=f*V+d*A+v*z,t[10]=y*V+g*A+P*z,t[11]=m*V+b*A+w*z,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Rd(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[4],a=e[5],s=e[6],l=e[7],u=e[8],c=e[9],p=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+u*n,t[5]=a*i+c*n,t[6]=s*i+p*n,t[7]=l*i+f*n,t[8]=u*i-o*n,t[9]=c*i-a*n,t[10]=p*i-s*n,t[11]=f*i-l*n,t}function Od(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[0],a=e[1],s=e[2],l=e[3],u=e[8],c=e[9],p=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-u*n,t[1]=a*i-c*n,t[2]=s*i-p*n,t[3]=l*i-f*n,t[8]=o*n+u*i,t[9]=a*n+c*i,t[10]=s*n+p*i,t[11]=l*n+f*i,t}function Nd(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[0],a=e[1],s=e[2],l=e[3],u=e[4],c=e[5],p=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+u*n,t[1]=a*i+c*n,t[2]=s*i+p*n,t[3]=l*i+f*n,t[4]=u*i-o*n,t[5]=c*i-a*n,t[6]=p*i-s*n,t[7]=f*i-l*n,t}function Ud(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function $d(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Gd(t,e,r){var n=r[0],i=r[1],o=r[2],a=Math.hypot(n,i,o),s,l,u;return a<Q?null:(a=1/a,n*=a,i*=a,o*=a,s=Math.sin(e),l=Math.cos(e),u=1-l,t[0]=n*n*u+l,t[1]=i*n*u+o*s,t[2]=o*n*u-i*s,t[3]=0,t[4]=n*i*u-o*s,t[5]=i*i*u+l,t[6]=o*i*u+n*s,t[7]=0,t[8]=n*o*u+i*s,t[9]=i*o*u-n*s,t[10]=o*o*u+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function qd(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function jd(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Jd(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Hc(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=n+n,l=i+i,u=o+o,c=n*s,p=n*l,f=n*u,y=i*l,m=i*u,h=o*u,d=a*s,g=a*l,b=a*u;return t[0]=1-(y+h),t[1]=p+b,t[2]=f-g,t[3]=0,t[4]=p-b,t[5]=1-(c+h),t[6]=m+d,t[7]=0,t[8]=f+g,t[9]=m-d,t[10]=1-(c+y),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function Zd(t,e){var r=new Ge(3),n=-e[0],i=-e[1],o=-e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],p=n*n+i*i+o*o+a*a;return p>0?(r[0]=(s*a+c*n+l*o-u*i)*2/p,r[1]=(l*a+c*i+u*n-s*o)*2/p,r[2]=(u*a+c*o+s*i-l*n)*2/p):(r[0]=(s*a+c*n+l*o-u*i)*2,r[1]=(l*a+c*i+u*n-s*o)*2,r[2]=(u*a+c*o+s*i-l*n)*2),Hc(t,e,r),t}function Wd(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function Xc(t,e){var r=e[0],n=e[1],i=e[2],o=e[4],a=e[5],s=e[6],l=e[8],u=e[9],c=e[10];return t[0]=Math.hypot(r,n,i),t[1]=Math.hypot(o,a,s),t[2]=Math.hypot(l,u,c),t}function Hd(t,e){var r=new Ge(3);Xc(r,e);var n=1/r[0],i=1/r[1],o=1/r[2],a=e[0]*n,s=e[1]*i,l=e[2]*o,u=e[4]*n,c=e[5]*i,p=e[6]*o,f=e[8]*n,y=e[9]*i,m=e[10]*o,h=a+c+m,d=0;return h>0?(d=Math.sqrt(h+1)*2,t[3]=.25*d,t[0]=(p-y)/d,t[1]=(f-l)/d,t[2]=(s-u)/d):a>c&&a>m?(d=Math.sqrt(1+a-c-m)*2,t[3]=(p-y)/d,t[0]=.25*d,t[1]=(s+u)/d,t[2]=(f+l)/d):c>m?(d=Math.sqrt(1+c-a-m)*2,t[3]=(f-l)/d,t[0]=(s+u)/d,t[1]=.25*d,t[2]=(p+y)/d):(d=Math.sqrt(1+m-a-c)*2,t[3]=(s-u)/d,t[0]=(f+l)/d,t[1]=(p+y)/d,t[2]=.25*d),t}function Xd(t,e,r,n){var i=e[0],o=e[1],a=e[2],s=e[3],l=i+i,u=o+o,c=a+a,p=i*l,f=i*u,y=i*c,m=o*u,h=o*c,d=a*c,g=s*l,b=s*u,x=s*c,v=n[0],P=n[1],w=n[2];return t[0]=(1-(m+d))*v,t[1]=(f+x)*v,t[2]=(y-b)*v,t[3]=0,t[4]=(f-x)*P,t[5]=(1-(p+d))*P,t[6]=(h+g)*P,t[7]=0,t[8]=(y+b)*w,t[9]=(h-g)*w,t[10]=(1-(p+m))*w,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function Kd(t,e,r,n,i){var o=e[0],a=e[1],s=e[2],l=e[3],u=o+o,c=a+a,p=s+s,f=o*u,y=o*c,m=o*p,h=a*c,d=a*p,g=s*p,b=l*u,x=l*c,v=l*p,P=n[0],w=n[1],T=n[2],F=i[0],E=i[1],_=i[2],I=(1-(h+g))*P,k=(y+v)*P,V=(m-x)*P,A=(y-v)*w,z=(1-(f+g))*w,O=(d+b)*w,N=(m+x)*T,K=(d-b)*T,xe=(1-(f+h))*T;return t[0]=I,t[1]=k,t[2]=V,t[3]=0,t[4]=A,t[5]=z,t[6]=O,t[7]=0,t[8]=N,t[9]=K,t[10]=xe,t[11]=0,t[12]=r[0]+F-(I*F+A*E+N*_),t[13]=r[1]+E-(k*F+z*E+K*_),t[14]=r[2]+_-(V*F+O*E+xe*_),t[15]=1,t}function Yd(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r+r,s=n+n,l=i+i,u=r*a,c=n*a,p=n*s,f=i*a,y=i*s,m=i*l,h=o*a,d=o*s,g=o*l;return t[0]=1-p-m,t[1]=c+g,t[2]=f-d,t[3]=0,t[4]=c-g,t[5]=1-u-m,t[6]=y+h,t[7]=0,t[8]=f+d,t[9]=y-h,t[10]=1-u-p,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Qd(t,e,r,n,i,o,a){var s=1/(r-e),l=1/(i-n),u=1/(o-a);return t[0]=o*2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o*2*l,t[6]=0,t[7]=0,t[8]=(r+e)*s,t[9]=(i+n)*l,t[10]=(a+o)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*u,t[15]=0,t}function Kc(t,e,r,n,i){var o=1/Math.tan(e/2),a;return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(a=1/(n-i),t[10]=(i+n)*a,t[14]=2*i*n*a):(t[10]=-1,t[14]=-2*n),t}var eg=Kc;function tg(t,e,r,n,i){var o=1/Math.tan(e/2),a;return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(a=1/(n-i),t[10]=i*a,t[14]=i*n*a):(t[10]=-1,t[14]=-n),t}function rg(t,e,r,n){var i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),l=2/(a+s),u=2/(i+o);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-((a-s)*l*.5),t[9]=(i-o)*u*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t}function Yc(t,e,r,n,i,o,a){var s=1/(e-r),l=1/(n-i),u=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+r)*s,t[13]=(i+n)*l,t[14]=(a+o)*u,t[15]=1,t}var ng=Yc;function ig(t,e,r,n,i,o,a){var s=1/(e-r),l=1/(n-i),u=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=u,t[11]=0,t[12]=(e+r)*s,t[13]=(i+n)*l,t[14]=o*u,t[15]=1,t}function og(t,e,r,n){var i,o,a,s,l,u,c,p,f,y,m=e[0],h=e[1],d=e[2],g=n[0],b=n[1],x=n[2],v=r[0],P=r[1],w=r[2];return Math.abs(m-v)<Q&&Math.abs(h-P)<Q&&Math.abs(d-w)<Q?Zc(t):(c=m-v,p=h-P,f=d-w,y=1/Math.hypot(c,p,f),c*=y,p*=y,f*=y,i=b*f-x*p,o=x*c-g*f,a=g*p-b*c,y=Math.hypot(i,o,a),y?(y=1/y,i*=y,o*=y,a*=y):(i=0,o=0,a=0),s=p*a-f*o,l=f*i-c*a,u=c*o-p*i,y=Math.hypot(s,l,u),y?(y=1/y,s*=y,l*=y,u*=y):(s=0,l=0,u=0),t[0]=i,t[1]=s,t[2]=c,t[3]=0,t[4]=o,t[5]=l,t[6]=p,t[7]=0,t[8]=a,t[9]=u,t[10]=f,t[11]=0,t[12]=-(i*m+o*h+a*d),t[13]=-(s*m+l*h+u*d),t[14]=-(c*m+p*h+f*d),t[15]=1,t)}function ag(t,e,r,n){var i=e[0],o=e[1],a=e[2],s=n[0],l=n[1],u=n[2],c=i-r[0],p=o-r[1],f=a-r[2],y=c*c+p*p+f*f;y>0&&(y=1/Math.sqrt(y),c*=y,p*=y,f*=y);var m=l*f-u*p,h=u*c-s*f,d=s*p-l*c;return y=m*m+h*h+d*d,y>0&&(y=1/Math.sqrt(y),m*=y,h*=y,d*=y),t[0]=m,t[1]=h,t[2]=d,t[3]=0,t[4]=p*d-f*h,t[5]=f*m-c*d,t[6]=c*h-p*m,t[7]=0,t[8]=c,t[9]=p,t[10]=f,t[11]=0,t[12]=i,t[13]=o,t[14]=a,t[15]=1,t}function sg(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function lg(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function ug(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function Qc(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function cg(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}function pg(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t}function fg(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function yg(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],p=t[9],f=t[10],y=t[11],m=t[12],h=t[13],d=t[14],g=t[15],b=e[0],x=e[1],v=e[2],P=e[3],w=e[4],T=e[5],F=e[6],E=e[7],_=e[8],I=e[9],k=e[10],V=e[11],A=e[12],z=e[13],O=e[14],N=e[15];return Math.abs(r-b)<=Q*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(n-x)<=Q*Math.max(1,Math.abs(n),Math.abs(x))&&Math.abs(i-v)<=Q*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(o-P)<=Q*Math.max(1,Math.abs(o),Math.abs(P))&&Math.abs(a-w)<=Q*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(s-T)<=Q*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(l-F)<=Q*Math.max(1,Math.abs(l),Math.abs(F))&&Math.abs(u-E)<=Q*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(c-_)<=Q*Math.max(1,Math.abs(c),Math.abs(_))&&Math.abs(p-I)<=Q*Math.max(1,Math.abs(p),Math.abs(I))&&Math.abs(f-k)<=Q*Math.max(1,Math.abs(f),Math.abs(k))&&Math.abs(y-V)<=Q*Math.max(1,Math.abs(y),Math.abs(V))&&Math.abs(m-A)<=Q*Math.max(1,Math.abs(m),Math.abs(A))&&Math.abs(h-z)<=Q*Math.max(1,Math.abs(h),Math.abs(z))&&Math.abs(d-O)<=Q*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(g-N)<=Q*Math.max(1,Math.abs(g),Math.abs(N))}var mg=Wc,hg=Qc;var Qt={};Ol(Qt,{add:()=>vg,ceil:()=>Pg,clone:()=>dg,copy:()=>xg,create:()=>ep,cross:()=>Fg,dist:()=>qg,distance:()=>ip,div:()=>Gg,divide:()=>np,dot:()=>Eg,equals:()=>Ng,exactEquals:()=>Og,floor:()=>Sg,forEach:()=>Wg,fromValues:()=>gg,inverse:()=>kg,len:()=>Jg,length:()=>ap,lerp:()=>Lg,max:()=>Ag,min:()=>wg,mul:()=>$g,multiply:()=>rp,negate:()=>Cg,normalize:()=>Mg,random:()=>Dg,round:()=>_g,scale:()=>Ig,scaleAndAdd:()=>Tg,set:()=>bg,sqrDist:()=>jg,sqrLen:()=>Zg,squaredDistance:()=>op,squaredLength:()=>sp,str:()=>Rg,sub:()=>Ug,subtract:()=>tp,transformMat4:()=>Vg,transformQuat:()=>Bg,zero:()=>zg});function ep(){var t=new Ge(4);return Ge!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function dg(t){var e=new Ge(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function gg(t,e,r,n){var i=new Ge(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i}function xg(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function bg(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t}function vg(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function tp(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function rp(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function np(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function Pg(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Sg(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function wg(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t}function Ag(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t}function _g(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function Ig(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function Tg(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t}function ip(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.hypot(r,n,i,o)}function op(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return r*r+n*n+i*i+o*o}function ap(t){var e=t[0],r=t[1],n=t[2],i=t[3];return Math.hypot(e,r,n,i)}function sp(t){var e=t[0],r=t[1],n=t[2],i=t[3];return e*e+r*r+n*n+i*i}function Cg(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function kg(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function Mg(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r*r+n*n+i*i+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=r*a,t[1]=n*a,t[2]=i*a,t[3]=o*a,t}function Eg(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Fg(t,e,r,n){var i=r[0]*n[1]-r[1]*n[0],o=r[0]*n[2]-r[2]*n[0],a=r[0]*n[3]-r[3]*n[0],s=r[1]*n[2]-r[2]*n[1],l=r[1]*n[3]-r[3]*n[1],u=r[2]*n[3]-r[3]*n[2],c=e[0],p=e[1],f=e[2],y=e[3];return t[0]=p*u-f*l+y*s,t[1]=-(c*u)+f*a-y*o,t[2]=c*l-p*a+y*i,t[3]=-(c*s)+p*o-f*i,t}function Lg(t,e,r,n){var i=e[0],o=e[1],a=e[2],s=e[3];return t[0]=i+n*(r[0]-i),t[1]=o+n*(r[1]-o),t[2]=a+n*(r[2]-a),t[3]=s+n*(r[3]-s),t}function Dg(t,e){e=e||1;var r,n,i,o,a,s;do r=jn()*2-1,n=jn()*2-1,a=r*r+n*n;while(a>=1);do i=jn()*2-1,o=jn()*2-1,s=i*i+o*o;while(s>=1);var l=Math.sqrt((1-a)/s);return t[0]=e*r,t[1]=e*n,t[2]=e*i*l,t[3]=e*o*l,t}function Vg(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*a,t[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*a,t[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*a,t[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*a,t}function Bg(t,e,r){var n=e[0],i=e[1],o=e[2],a=r[0],s=r[1],l=r[2],u=r[3],c=u*n+s*o-l*i,p=u*i+l*n-a*o,f=u*o+a*i-s*n,y=-a*n-s*i-l*o;return t[0]=c*u+y*-a+p*-l-f*-s,t[1]=p*u+y*-s+f*-a-c*-l,t[2]=f*u+y*-l+c*-s-p*-a,t[3]=e[3],t}function zg(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function Rg(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function Og(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function Ng(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=e[0],s=e[1],l=e[2],u=e[3];return Math.abs(r-a)<=Q*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-s)<=Q*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-l)<=Q*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-u)<=Q*Math.max(1,Math.abs(o),Math.abs(u))}var Ug=tp,$g=rp,Gg=np,qg=ip,jg=op,Jg=ap,Zg=sp,Wg=function(){var t=ep();return function(e,r,n,i,o,a){var s,l;for(r||(r=4),n||(n=0),i?l=Math.min(i*r+n,e.length):l=e.length,s=n;s<l;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}();var lp=Z(he(),1),Uo=class extends se{constructor(e){super(e,jc)}createBucket(e){return new Kt(e)}queryRadius(e){let r=e;return Yt("circle-radius",this,r)+Yt("circle-stroke-width",this,r)+_t(this.paint.get("circle-translate"))}queryIntersectsFeature(e,r,n,i,o,a,s,l){let u=It(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),a.angle,s),c=this.paint.get("circle-radius").evaluate(r,n),p=this.paint.get("circle-stroke-width").evaluate(r,n),f=c+p,y=this.paint.get("circle-pitch-alignment")==="map",m=y?u:Hg(u,l),h=y?f*s:f;for(let d of i)for(let g of d){let b=y?g:up(g,l),x=h,v=Qt.transformMat4([],[g.x,g.y,0,1],l);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?x*=v[3]/a.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(x*=a.cameraToCenterDistance/v[3]),Oc(m,b,x))return!0}return!1}};function up(t,e){let r=Qt.transformMat4([],[t.x,t.y,0,1],e);return new lp.default(r[0]/r[3],r[1]/r[3])}function Hg(t,e){return t.map(r=>up(r,e))}var Zn=class extends Kt{};C("HeatmapBucket",Zn,{omit:["layers"]});var cp,Xg=()=>cp=cp||new re({"heatmap-radius":new R(S.paint_heatmap["heatmap-radius"]),"heatmap-weight":new R(S.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new B(S.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Zt(S.paint_heatmap["heatmap-color"]),"heatmap-opacity":new B(S.paint_heatmap["heatmap-opacity"])}),pp={get paint(){return Xg()}};function Bs(t,{width:e,height:r},n,i){if(!i)i=new Uint8Array(e*r*n);else if(i instanceof Uint8ClampedArray)i=new Uint8Array(i.buffer);else if(i.length!==e*r*n)throw new RangeError("mismatched image size. expected: ".concat(i.length," but got: ").concat(e*r*n));return t.width=e,t.height=r,t.data=i,t}function fp(t,{width:e,height:r},n){if(e===t.width&&r===t.height)return;let i=Bs({},{width:e,height:r},n);zs(t,i,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,e),height:Math.min(t.height,r)},n),t.width=e,t.height=r,t.data=i.data}function zs(t,e,r,n,i,o){if(i.width===0||i.height===0)return e;if(i.width>t.width||i.height>t.height||r.x>t.width-i.width||r.y>t.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>e.width||i.height>e.height||n.x>e.width-i.width||n.y>e.height-i.height)throw new RangeError("out of range destination coordinates for image copy");let a=t.data,s=e.data;if(a===s)throw new Error("srcData equals dstData, so image is already copied");for(let l=0;l<i.height;l++){let u=((r.y+l)*t.width+r.x)*o,c=((n.y+l)*e.width+n.x)*o;for(let p=0;p<i.width*o;p++)s[c+p]=a[u+p]}return e}var er=class t{constructor(e,r){Bs(this,e,1,r)}resize(e){fp(this,e,1)}clone(){return new t({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,n,i,o){zs(e,r,n,i,o,1)}},de=class t{constructor(e,r){Bs(this,e,4,r)}resize(e){fp(this,e,4)}replace(e,r){r?this.data.set(e):e instanceof Uint8ClampedArray?this.data=new Uint8Array(e.buffer):this.data=e}clone(){return new t({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,n,i,o){zs(e,r,n,i,o,4)}};C("AlphaImage",er);C("RGBAImage",de);function yp(t){let e={},r=t.resolution||256,n=t.clips?t.clips.length:1,i=t.image||new de({width:r,height:n});if(!Xl(r))throw new Error("width is not a power of 2 - ".concat(r));let o=(a,s,l)=>{e[t.evaluationKey]=l;let u=t.expression.evaluate(e);i.data[a+s+0]=Math.floor(u.r*255/u.a),i.data[a+s+1]=Math.floor(u.g*255/u.a),i.data[a+s+2]=Math.floor(u.b*255/u.a),i.data[a+s+3]=Math.floor(u.a*255)};if(t.clips)for(let a=0,s=0;a<n;++a,s+=r*4)for(let l=0,u=0;l<r;l++,u+=4){let c=l/(r-1),{start:p,end:f}=t.clips[a],y=p*(1-c)+f*c;o(s,u,y)}else for(let a=0,s=0;a<r;a++,s+=4){let l=a/(r-1);o(0,s,l)}return i}var $o=class extends se{createBucket(e){return new Zn(e)}constructor(e){super(e,pp),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){let e=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=yp({expression:e,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}};var mp,Kg=()=>mp=mp||new re({"hillshade-illumination-direction":new B(S.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new B(S.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new B(S.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new B(S.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new B(S.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new B(S.paint_hillshade["hillshade-accent-color"])}),hp={get paint(){return Kg()}};var Go=class extends se{constructor(e){super(e,hp)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}};var Yg=Y([{name:"a_pos",components:2,type:"Int16"}],4);var{members:dp,size:GP,alignment:qP}=Yg;var Sp=Z($s(),1);function Gs(t,e,r,n,i){Pp(t,e,r||0,n||t.length-1,i||mx)}function Pp(t,e,r,n,i){for(;n>r;){if(n-r>600){var o=n-r+1,a=e-r+1,s=Math.log(o),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(o-l)/o)*(a-o/2<0?-1:1),c=Math.max(r,Math.floor(e-a*l/o+u)),p=Math.min(n,Math.floor(e+(o-a)*l/o+u));Pp(t,e,c,p,i)}var f=t[e],y=r,m=n;for(Kn(t,r,e),i(t[n],f)>0&&Kn(t,r,n);y<m;){for(Kn(t,y,m),y++,m--;i(t[y],f)<0;)y++;for(;i(t[m],f)>0;)m--}i(t[r],f)===0?Kn(t,r,m):(m++,Kn(t,m,n)),m<=e&&(r=m+1),e<=m&&(n=m-1)}}function Kn(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function mx(t,e){return t<e?-1:t>e?1:0}function Tr(t,e){let r=t.length;if(r<=1)return[t];let n=[],i,o;for(let a=0;a<r;a++){let s=Ql(t[a]);s!==0&&(t[a].area=Math.abs(s),o===void 0&&(o=s<0),o===s<0?(i&&n.push(i),i=[t[a]]):i.push(t[a]))}if(i&&n.push(i),e>1)for(let a=0;a<n.length;a++)n[a].length<=e||(Gs(n[a],e,1,n[a].length-1,hx),n[a]=n[a].slice(0,e));return n}function hx(t,e){return e.area-t.area}function Cr(t,e,r){let n=r.patternDependencies,i=!1;for(let o of e){let a=o.paint.get("".concat(t,"-pattern"));a.isConstant()||(i=!0);let s=a.constantOr(null);s&&(i=!0,n[s.to]=!0,n[s.from]=!0)}return i}function kr(t,e,r,n,i){let o=i.patternDependencies;for(let a of e){let l=a.paint.get("".concat(t,"-pattern")).value;if(l.kind!=="constant"){let u=l.evaluate({zoom:n-1},r,{},i.availableImages),c=l.evaluate({zoom:n},r,{},i.availableImages),p=l.evaluate({zoom:n+1},r,{},i.availableImages);u=u&&u.name?u.name:u,c=c&&c.name?c.name:c,p=p&&p.name?p.name:p,o[u]=!0,o[c]=!0,o[p]=!0,r.patterns[a.id]={min:u,mid:c,max:p}}}return r}var dx=500,rr=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new _o,this.indexArray=new Le,this.indexArray2=new wt,this.programConfigurations=new Ce(e.layers,e.zoom),this.segments=new me,this.segments2=new me,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,n){this.hasPattern=Cr("fill",this.layers,r);let i=this.layers[0].layout.get("fill-sort-key"),o=!i.isConstant(),a=[];for(let{feature:s,id:l,index:u,sourceLayerIndex:c}of e){let p=this.layers[0]._featureFilter.needGeometry,f=$e(s,p);if(!this.layers[0]._featureFilter.filter(new q(this.zoom),f,n))continue;let y=o?i.evaluate(f,{},n,r.availableImages):void 0,m={id:l,properties:s.properties,type:s.type,sourceLayerIndex:c,index:u,geometry:p?f.geometry:ke(s),patterns:{},sortKey:y};a.push(m)}o&&a.sort((s,l)=>s.sortKey-l.sortKey);for(let s of a){let{geometry:l,index:u,sourceLayerIndex:c}=s;if(this.hasPattern){let f=kr("fill",this.layers,s,this.zoom,r);this.patternFeatures.push(f)}else this.addFeature(s,l,u,n,{});let p=e[u].feature;r.featureIndex.insert(p,l,u,c,this.index)}}update(e,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n)}addFeatures(e,r,n){for(let i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,r,n)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,dp),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,r,n,i,o){for(let a of Tr(r,dx)){let s=0;for(let y of a)s+=y.length;let l=this.segments.prepareSegment(s,this.layoutVertexArray,this.indexArray),u=l.vertexLength,c=[],p=[];for(let y of a){if(y.length===0)continue;y!==a[0]&&p.push(c.length/2);let m=this.segments2.prepareSegment(y.length,this.layoutVertexArray,this.indexArray2),h=m.vertexLength;this.layoutVertexArray.emplaceBack(y[0].x,y[0].y),this.indexArray2.emplaceBack(h+y.length-1,h),c.push(y[0].x),c.push(y[0].y);for(let d=1;d<y.length;d++)this.layoutVertexArray.emplaceBack(y[d].x,y[d].y),this.indexArray2.emplaceBack(h+d-1,h+d),c.push(y[d].x),c.push(y[d].y);m.vertexLength+=y.length,m.primitiveLength+=y.length}let f=(0,Sp.default)(c,p);for(let y=0;y<f.length;y+=3)this.indexArray.emplaceBack(u+f[y],u+f[y+1],u+f[y+2]);l.vertexLength+=s,l.primitiveLength+=f.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,o,i)}};C("FillBucket",rr,{omit:["layers","patternFeatures"]});var wp,gx=()=>wp=wp||new re({"fill-sort-key":new R(S.layout_fill["fill-sort-key"])}),Ap,xx=()=>Ap=Ap||new re({"fill-antialias":new B(S.paint_fill["fill-antialias"]),"fill-opacity":new R(S.paint_fill["fill-opacity"]),"fill-color":new R(S.paint_fill["fill-color"]),"fill-outline-color":new R(S.paint_fill["fill-outline-color"]),"fill-translate":new B(S.paint_fill["fill-translate"]),"fill-translate-anchor":new B(S.paint_fill["fill-translate-anchor"]),"fill-pattern":new lt(S.paint_fill["fill-pattern"])}),_p={get paint(){return xx()},get layout(){return gx()}};var Wo=class extends se{constructor(e){super(e,_p)}recalculate(e,r){super.recalculate(e,r);let n=this.paint._values["fill-outline-color"];n.value.kind==="constant"&&n.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new rr(e)}queryRadius(){return _t(this.paint.get("fill-translate"))}queryIntersectsFeature(e,r,n,i,o,a,s){let l=It(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),a.angle,s);return Oo(l,i)}isTileClipped(){return!0}};var bx=Y([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Ip=Y([{name:"a_centroid",components:2,type:"Int16"}],4);var{members:Tp,size:IS,alignment:TS}=bx;var Lp=Z($s(),1),Dp=Z(Tt(),1);var Ex=Dp.default.VectorTileFeature.types,Fx=500,Js=Math.pow(2,13);function Yn(t,e,r,n,i,o,a,s){t.emplaceBack(e,r,Math.floor(n*Js)*2+a,i*Js*2,o*Js*2,Math.round(s))}var nr=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Io,this.centroidVertexArray=new wo,this.indexArray=new Le,this.programConfigurations=new Ce(e.layers,e.zoom),this.segments=new me,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,n){this.features=[],this.hasPattern=Cr("fill-extrusion",this.layers,r);for(let{feature:i,id:o,index:a,sourceLayerIndex:s}of e){let l=this.layers[0]._featureFilter.needGeometry,u=$e(i,l);if(!this.layers[0]._featureFilter.filter(new q(this.zoom),u,n))continue;let c={id:o,sourceLayerIndex:s,index:a,geometry:l?u.geometry:ke(i),properties:i.properties,type:i.type,patterns:{}};this.hasPattern?this.features.push(kr("fill-extrusion",this.layers,c,this.zoom,r)):this.addFeature(c,c.geometry,a,n,{}),r.featureIndex.insert(i,c.geometry,a,s,this.index,!0)}}addFeatures(e,r,n){for(let i of this.features){let{geometry:o}=i;this.addFeature(i,o,i.index,r,n)}}update(e,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Tp),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Ip.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,r,n,i,o){let a={x:0,y:0,vertexCount:0};for(let s of Tr(r,Fx)){let l=0;for(let m of s)l+=m.length;let u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let m of s){if(m.length===0||Dx(m))continue;let h=0;for(let d=0;d<m.length;d++){let g=m[d];if(d>=1){let b=m[d-1];if(!Lx(g,b)){u.vertexLength+4>me.MAX_VERTEX_ARRAY_LENGTH&&(u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let x=g.sub(b)._perp()._unit(),v=b.dist(g);h+v>32768&&(h=0),Yn(this.layoutVertexArray,g.x,g.y,x.x,x.y,0,0,h),Yn(this.layoutVertexArray,g.x,g.y,x.x,x.y,0,1,h),a.x+=2*g.x,a.y+=2*g.y,a.vertexCount+=2,h+=v,Yn(this.layoutVertexArray,b.x,b.y,x.x,x.y,0,0,h),Yn(this.layoutVertexArray,b.x,b.y,x.x,x.y,0,1,h),a.x+=2*b.x,a.y+=2*b.y,a.vertexCount+=2;let P=u.vertexLength;this.indexArray.emplaceBack(P,P+2,P+1),this.indexArray.emplaceBack(P+1,P+2,P+3),u.vertexLength+=4,u.primitiveLength+=2}}}}if(u.vertexLength+l>me.MAX_VERTEX_ARRAY_LENGTH&&(u=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray)),Ex[e.type]!=="Polygon")continue;let c=[],p=[],f=u.vertexLength;for(let m of s)if(m.length!==0){m!==s[0]&&p.push(c.length/2);for(let h=0;h<m.length;h++){let d=m[h];Yn(this.layoutVertexArray,d.x,d.y,0,0,1,1,0),a.x+=d.x,a.y+=d.y,a.vertexCount+=1,c.push(d.x),c.push(d.y)}}let y=(0,Lp.default)(c,p);for(let m=0;m<y.length;m+=3)this.indexArray.emplaceBack(f+y[m],f+y[m+2],f+y[m+1]);u.primitiveLength+=y.length/3,u.vertexLength+=l}for(let s=0;s<a.vertexCount;s++)this.centroidVertexArray.emplaceBack(Math.floor(a.x/a.vertexCount),Math.floor(a.y/a.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,o,i)}};C("FillExtrusionBucket",nr,{omit:["layers","features"]});function Lx(t,e){return t.x===e.x&&(t.x<0||t.x>8192)||t.y===e.y&&(t.y<0||t.y>8192)}function Dx(t){return t.every(e=>e.x<0)||t.every(e=>e.x>8192)||t.every(e=>e.y<0)||t.every(e=>e.y>8192)}var Vp,Vx=()=>Vp=Vp||new re({"fill-extrusion-opacity":new B(S["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new R(S["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new B(S["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new B(S["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new lt(S["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new R(S["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new R(S["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new B(S["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])}),Bp={get paint(){return Vx()}};var Xo=Z(he(),1);var Ko=class extends se{constructor(e){super(e,Bp)}createBucket(e){return new nr(e)}queryRadius(){return _t(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(e,r,n,i,o,a,s,l){let u=It(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),a.angle,s),c=this.paint.get("fill-extrusion-height").evaluate(r,n),p=this.paint.get("fill-extrusion-base").evaluate(r,n),f=Rx(u,l,a,0),y=zx(i,p,c,l),m=y[0],h=y[1];return Bx(m,h,f)}};function Qn(t,e){return t.x*e.x+t.y*e.y}function zp(t,e){if(t.length===1){let r=0,n=e[r++],i;for(;!i||n.equals(i);)if(i=e[r++],!i)return 1/0;for(;r<e.length;r++){let o=e[r],a=t[0],s=i.sub(n),l=o.sub(n),u=a.sub(n),c=Qn(s,s),p=Qn(s,l),f=Qn(l,l),y=Qn(u,s),m=Qn(u,l),h=c*f-p*p,d=(f*y-p*m)/h,g=(c*m-p*y)/h,b=1-d-g,x=n.z*b+i.z*d+o.z*g;if(isFinite(x))return x}return 1/0}else{let r=1/0;for(let n of e)r=Math.min(r,n.z);return r}}function Bx(t,e,r){let n=1/0;Oo(r,e)&&(n=zp(r,e[0]));for(let i=0;i<e.length;i++){let o=e[i],a=t[i];for(let s=0;s<o.length-1;s++){let l=o[s],u=o[s+1],c=a[s],p=a[s+1],f=[l,u,p,c,l];Rc(r,f)&&(n=Math.min(n,zp(r,f)))}}return n===1/0?!1:n}function zx(t,e,r,n){let i=[],o=[],a=n[8]*e,s=n[9]*e,l=n[10]*e,u=n[11]*e,c=n[8]*r,p=n[9]*r,f=n[10]*r,y=n[11]*r;for(let m of t){let h=[],d=[];for(let g of m){let b=g.x,x=g.y,v=n[0]*b+n[4]*x+n[12],P=n[1]*b+n[5]*x+n[13],w=n[2]*b+n[6]*x+n[14],T=n[3]*b+n[7]*x+n[15],F=v+a,E=P+s,_=w+l,I=T+u,k=v+c,V=P+p,A=w+f,z=T+y,O=new Xo.default(F/I,E/I);O.z=_/I,h.push(O);let N=new Xo.default(k/z,V/z);N.z=A/z,d.push(N)}i.push(h),o.push(d)}return[i,o]}function Rx(t,e,r,n){let i=[];for(let o of t){let a=[o.x,o.y,n,1];Qt.transformMat4(a,a,e),i.push(new Xo.default(a[0]/a[3],a[1]/a[3]))}return i}var Ox=Y([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Rp,size:uw,alignment:cw}=Ox;var Nx=Y([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Op,size:yw,alignment:mw}=Nx;var $p=Z(Tt(),1);var Ux=$p.default.VectorTileFeature.types,Np=63,$x=Math.cos(75/2*(Math.PI/180)),Gx=15,qx=20,jx=15,Gp=1/2,Up=Math.pow(2,jx-1)/Gp,ir=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new To,this.layoutVertexArray2=new Co,this.indexArray=new Le,this.programConfigurations=new Ce(e.layers,e.zoom),this.segments=new me,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,n){this.hasPattern=Cr("line",this.layers,r);let i=this.layers[0].layout.get("line-sort-key"),o=!i.isConstant(),a=[];for(let{feature:s,id:l,index:u,sourceLayerIndex:c}of e){let p=this.layers[0]._featureFilter.needGeometry,f=$e(s,p);if(!this.layers[0]._featureFilter.filter(new q(this.zoom),f,n))continue;let y=o?i.evaluate(f,{},n):void 0,m={id:l,properties:s.properties,type:s.type,sourceLayerIndex:c,index:u,geometry:p?f.geometry:ke(s),patterns:{},sortKey:y};a.push(m)}o&&a.sort((s,l)=>s.sortKey-l.sortKey);for(let s of a){let{geometry:l,index:u,sourceLayerIndex:c}=s;if(this.hasPattern){let f=kr("line",this.layers,s,this.zoom,r);this.patternFeatures.push(f)}else this.addFeature(s,l,u,n,{});let p=e[u].feature;r.featureIndex.insert(p,l,u,c,this.index)}}update(e,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n)}addFeatures(e,r,n){for(let i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,r,n)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Op)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Rp),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end")){let r=+e.properties.mapbox_clip_start,n=+e.properties.mapbox_clip_end;return{start:r,end:n}}}addFeature(e,r,n,i,o){let a=this.layers[0].layout,s=a.get("line-join").evaluate(e,{}),l=a.get("line-cap"),u=a.get("line-miter-limit"),c=a.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(let p of r)this.addLine(p,e,s,l,u,c);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,o,i)}addLine(e,r,n,i,o,a){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let g=0;g<e.length-1;g++)this.totalDistance+=e[g].dist(e[g+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let s=Ux[r.type]==="Polygon",l=e.length;for(;l>=2&&e[l-1].equals(e[l-2]);)l--;let u=0;for(;u<l-1&&e[u].equals(e[u+1]);)u++;if(l<(s?3:2))return;n==="bevel"&&(o=1.05);let c=this.overscaling<=16?Gx*8192/(512*this.overscaling):0,p=this.segments.prepareSegment(l*10,this.layoutVertexArray,this.indexArray),f,y,m,h,d;this.e1=this.e2=-1,s&&(f=e[l-2],d=e[u].sub(f)._unit()._perp());for(let g=u;g<l;g++){if(m=g===l-1?s?e[u+1]:void 0:e[g+1],m&&e[g].equals(m))continue;d&&(h=d),f&&(y=f),f=e[g],d=m?m.sub(f)._unit()._perp():h,h=h||d;let b=h.add(d);(b.x!==0||b.y!==0)&&b._unit();let x=h.x*d.x+h.y*d.y,v=b.x*d.x+b.y*d.y,P=v!==0?1/v:1/0,w=2*Math.sqrt(2-2*v),T=v<$x&&y&&m,F=h.x*d.y-h.y*d.x>0;if(T&&g>u){let I=f.dist(y);if(I>2*c){let k=f.sub(f.sub(y)._mult(c/I)._round());this.updateDistance(y,k),this.addCurrentVertex(k,h,0,0,p),y=k}}let E=y&&m,_=E?n:s?"butt":i;if(E&&_==="round"&&(P<a?_="miter":P<=2&&(_="fakeround")),_==="miter"&&P>o&&(_="bevel"),_==="bevel"&&(P>2&&(_="flipbevel"),P<o&&(_="miter")),y&&this.updateDistance(y,f),_==="miter")b._mult(P),this.addCurrentVertex(f,b,0,0,p);else if(_==="flipbevel"){if(P>100)b=d.mult(-1);else{let I=P*h.add(d).mag()/h.sub(d).mag();b._perp()._mult(I*(F?-1:1))}this.addCurrentVertex(f,b,0,0,p),this.addCurrentVertex(f,b.mult(-1),0,0,p)}else if(_==="bevel"||_==="fakeround"){let I=-Math.sqrt(P*P-1),k=F?I:0,V=F?0:I;if(y&&this.addCurrentVertex(f,h,k,V,p),_==="fakeround"){let A=Math.round(w*180/Math.PI/qx);for(let z=1;z<A;z++){let O=z/A;if(O!==.5){let K=O-.5,xe=1.0904+x*(-3.2452+x*(3.55645-x*1.43519)),X=.848013+x*(-1.06021+x*.215638);O=O+O*K*(O-1)*(xe*K*K+X)}let N=d.sub(h)._mult(O)._add(h)._unit()._mult(F?-1:1);this.addHalfVertex(f,N.x,N.y,!1,F,0,p)}}m&&this.addCurrentVertex(f,d,-k,-V,p)}else if(_==="butt")this.addCurrentVertex(f,b,0,0,p);else if(_==="square"){let I=y?1:-1;this.addCurrentVertex(f,b,I,I,p)}else _==="round"&&(y&&(this.addCurrentVertex(f,h,0,0,p),this.addCurrentVertex(f,h,1,1,p,!0)),m&&(this.addCurrentVertex(f,d,-1,-1,p,!0),this.addCurrentVertex(f,d,0,0,p)));if(T&&g<l-1){let I=f.dist(m);if(I>2*c){let k=f.add(m.sub(f)._mult(c/I)._round());this.updateDistance(f,k),this.addCurrentVertex(k,d,0,0,p),f=k}}}}addCurrentVertex(e,r,n,i,o,a=!1){let s=r.x+r.y*n,l=r.y-r.x*n,u=-r.x+r.y*i,c=-r.y-r.x*i;this.addHalfVertex(e,s,l,a,!1,n,o),this.addHalfVertex(e,u,c,a,!0,-i,o),this.distance>Up/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,r,n,i,o,a))}addHalfVertex({x:e,y:r},n,i,o,a,s,l){let c=(this.lineClips?this.scaledDistance*(Up-1):this.scaledDistance)*Gp;if(this.layoutVertexArray.emplaceBack((e<<1)+(o?1:0),(r<<1)+(a?1:0),Math.round(Np*n)+128,Math.round(Np*i)+128,(s===0?0:s<0?-1:1)+1|(c&63)<<2,c>>6),this.lineClips){let f=this.scaledDistance-this.lineClips.start,y=this.lineClips.end-this.lineClips.start,m=f/y;this.layoutVertexArray2.emplaceBack(m,this.lineClipsArray.length)}let p=l.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,p),l.primitiveLength++),a?this.e2=p:this.e1=p}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,r){this.distance+=e.dist(r),this.updateScaledDistance()}};C("LineBucket",ir,{omit:["layers","patternFeatures"]});var qp,Jx=()=>qp=qp||new re({"line-cap":new B(S.layout_line["line-cap"]),"line-join":new R(S.layout_line["line-join"]),"line-miter-limit":new B(S.layout_line["line-miter-limit"]),"line-round-limit":new B(S.layout_line["line-round-limit"]),"line-sort-key":new R(S.layout_line["line-sort-key"])}),jp,Zx=()=>jp=jp||new re({"line-opacity":new R(S.paint_line["line-opacity"]),"line-color":new R(S.paint_line["line-color"]),"line-translate":new B(S.paint_line["line-translate"]),"line-translate-anchor":new B(S.paint_line["line-translate-anchor"]),"line-width":new R(S.paint_line["line-width"]),"line-gap-width":new R(S.paint_line["line-gap-width"]),"line-offset":new R(S.paint_line["line-offset"]),"line-blur":new R(S.paint_line["line-blur"]),"line-dasharray":new Jt(S.paint_line["line-dasharray"]),"line-pattern":new lt(S.paint_line["line-pattern"]),"line-gradient":new Zt(S.paint_line["line-gradient"])}),Zs={get paint(){return Zx()},get layout(){return Jx()}};var Ws=class extends R{possiblyEvaluate(e,r){return r=new q(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(e,r)}evaluate(e,r,n,i){return r=Pe({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(e,r,n,i)}},Yo,Qo=class extends se{constructor(e){super(e,Zs),this.gradientVersion=0,Yo||(Yo=new Ws(Zs.paint.properties["line-width"].specification),Yo.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){let r=this.gradientExpression();qt(r)?this.stepInterpolant=r._styleExpression.expression instanceof yr:this.stepInterpolant=!1,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,r){super.recalculate(e,r),this.paint._values["line-floorwidth"]=Yo.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new ir(e)}queryRadius(e){let r=e,n=Jp(Yt("line-width",this,r),Yt("line-gap-width",this,r)),i=Yt("line-offset",this,r);return n/2+Math.abs(i)+_t(this.paint.get("line-translate"))}queryIntersectsFeature(e,r,n,i,o,a,s){let l=It(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,s),u=s/2*Jp(this.paint.get("line-width").evaluate(r,n),this.paint.get("line-gap-width").evaluate(r,n)),c=this.paint.get("line-offset").evaluate(r,n);return c&&(i=$c(i,c*s)),Nc(l,i,u)}isTileClipped(){return!0}};function Jp(t,e){return e>0?e+2*t:t}var Zp=Y([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Wp=Y([{name:"a_projected_pos",components:3,type:"Float32"}],4),Kw=Y([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Hp=Y([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Yw=Y([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Hs=Y([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Qw=Y([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4),e2=Y([{name:"triangle",components:3,type:"Uint16"}]),t2=Y([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),r2=Y([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),n2=Y([{type:"Float32",name:"offsetX"}]),i2=Y([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),o2=Y([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var oi=Z(he(),1);function Wx(t,e,r){let n=e.layout.get("text-transform").evaluate(r,{});return n==="uppercase"?t=t.toLocaleUpperCase():n==="lowercase"&&(t=t.toLocaleLowerCase()),ye.applyArabicShaping&&(t=ye.applyArabicShaping(t)),t}function Xp(t,e,r){return t.sections.forEach(n=>{n.text=Wx(n.text,e,r)}),t}function Kp(t){let e={},r={},n=[],i=0;function o(u){n.push(t[u]),i++}function a(u,c,p){let f=r[u];return delete r[u],r[c]=f,n[f].geometry[0].pop(),n[f].geometry[0]=n[f].geometry[0].concat(p[0]),f}function s(u,c,p){let f=e[c];return delete e[c],e[u]=f,n[f].geometry[0].shift(),n[f].geometry[0]=p[0].concat(n[f].geometry[0]),f}function l(u,c,p){let f=p?c[0][c[0].length-1]:c[0][0];return"".concat(u,":").concat(f.x,":").concat(f.y)}for(let u=0;u<t.length;u++){let c=t[u],p=c.geometry,f=c.text?c.text.toString():null;if(!f){o(u);continue}let y=l(f,p),m=l(f,p,!0);if(y in r&&m in e&&r[y]!==e[m]){let h=s(y,m,p),d=a(y,m,n[h].geometry);delete e[y],delete r[m],r[l(f,n[d].geometry,!0)]=d,n[h].geometry=null}else y in r?a(y,m,p):m in e?s(y,m,p):(o(u),e[y]=i-1,r[m]=i-1)}return n.filter(u=>u.geometry)}var Er={"!":"\\uFE15","#":"\\uFF03",$:"\\uFF04","%":"\\uFF05","&":"\\uFF06","(":"\\uFE35",")":"\\uFE36","*":"\\uFF0A","+":"\\uFF0B",",":"\\uFE10","-":"\\uFE32",".":"\\u30FB","/":"\\uFF0F",":":"\\uFE13",";":"\\uFE14","<":"\\uFE3F","=":"\\uFF1D",">":"\\uFE40","?":"\\uFE16","@":"\\uFF20","[":"\\uFE47","\\\\":"\\uFF3C","]":"\\uFE48","^":"\\uFF3E",_:"\\uFE33","\`":"\\uFF40","{":"\\uFE37","|":"\\u2015","}":"\\uFE38","~":"\\uFF5E","\\xA2":"\\uFFE0","\\xA3":"\\uFFE1","\\xA5":"\\uFFE5","\\xA6":"\\uFFE4","\\xAC":"\\uFFE2","\\xAF":"\\uFFE3","\\u2013":"\\uFE32","\\u2014":"\\uFE31","\\u2018":"\\uFE43","\\u2019":"\\uFE44","\\u201C":"\\uFE41","\\u201D":"\\uFE42","\\u2026":"\\uFE19","\\u2027":"\\u30FB","\\u20A9":"\\uFFE6","\\u3001":"\\uFE11","\\u3002":"\\uFE12","\\u3008":"\\uFE3F","\\u3009":"\\uFE40","\\u300A":"\\uFE3D","\\u300B":"\\uFE3E","\\u300C":"\\uFE41","\\u300D":"\\uFE42","\\u300E":"\\uFE43","\\u300F":"\\uFE44","\\u3010":"\\uFE3B","\\u3011":"\\uFE3C","\\u3014":"\\uFE39","\\u3015":"\\uFE3A","\\u3016":"\\uFE17","\\u3017":"\\uFE18","\\uFF01":"\\uFE15","\\uFF08":"\\uFE35","\\uFF09":"\\uFE36","\\uFF0C":"\\uFE10","\\uFF0D":"\\uFE32","\\uFF0E":"\\u30FB","\\uFF1A":"\\uFE13","\\uFF1B":"\\uFE14","\\uFF1C":"\\uFE3F","\\uFF1E":"\\uFE40","\\uFF1F":"\\uFE16","\\uFF3B":"\\uFE47","\\uFF3D":"\\uFE48","\\uFF3F":"\\uFE33","\\uFF5B":"\\uFE37","\\uFF5C":"\\u2015","\\uFF5D":"\\uFE38","\\uFF5F":"\\uFE35","\\uFF60":"\\uFE36","\\uFF61":"\\uFE12","\\uFF62":"\\uFE41","\\uFF63":"\\uFE42"};function Yp(t){let e="";for(let r=0;r<t.length;r++){let n=t.charCodeAt(r+1)||null,i=t.charCodeAt(r-1)||null;(!n||!As(n)||Er[t[r+1]])&&(!i||!As(i)||Er[t[r-1]])&&Er[t[r]]?e+=Er[t[r]]:e+=t[r]}return e}var ne=24;var fb=Z(ei(),1),yb=3;var ra=yb;function ti(t){let e=0,r=0;for(let s of t)e+=s.w*s.h,r=Math.max(r,s.w);t.sort((s,l)=>l.h-s.h);let i=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}],o=0,a=0;for(let s of t)for(let l=i.length-1;l>=0;l--){let u=i[l];if(!(s.w>u.w||s.h>u.h)){if(s.x=u.x,s.y=u.y,a=Math.max(a,s.y+s.h),o=Math.max(o,s.x+s.w),s.w===u.w&&s.h===u.h){let c=i.pop();l<i.length&&(i[l]=c)}else s.h===u.h?(u.x+=s.w,u.w-=s.w):s.w===u.w?(u.y+=s.h,u.h-=s.h):(i.push({x:u.x+s.w,y:u.y,w:u.w-s.w,h:s.h}),u.y+=s.h,u.h-=s.h);break}}return{w:o,h:a,fill:e/(o*a)||0}}var ge=1;var na=class{constructor(e,{pixelRatio:r,version:n,stretchX:i,stretchY:o,content:a}){this.paddedRect=e,this.pixelRatio=r,this.stretchX=i,this.stretchY=o,this.content=a,this.version=n}get tl(){return[this.paddedRect.x+ge,this.paddedRect.y+ge]}get br(){return[this.paddedRect.x+this.paddedRect.w-ge,this.paddedRect.y+this.paddedRect.h-ge]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-ge*2)/this.pixelRatio,(this.paddedRect.h-ge*2)/this.pixelRatio]}},ri=class{constructor(e,r){let n={},i={};this.haveRenderCallbacks=[];let o=[];this.addImages(e,n,o),this.addImages(r,i,o);let{w:a,h:s}=ti(o),l=new de({width:a||1,height:s||1});for(let u in e){let c=e[u],p=n[u].paddedRect;de.copy(c.data,l,{x:0,y:0},{x:p.x+ge,y:p.y+ge},c.data)}for(let u in r){let c=r[u],p=i[u].paddedRect,f=p.x+ge,y=p.y+ge,m=c.data.width,h=c.data.height;de.copy(c.data,l,{x:0,y:0},{x:f,y},c.data),de.copy(c.data,l,{x:0,y:h-1},{x:f,y:y-1},{width:m,height:1}),de.copy(c.data,l,{x:0,y:0},{x:f,y:y+h},{width:m,height:1}),de.copy(c.data,l,{x:m-1,y:0},{x:f-1,y},{width:1,height:h}),de.copy(c.data,l,{x:0,y:0},{x:f+m,y},{width:1,height:h})}this.image=l,this.iconPositions=n,this.patternPositions=i}addImages(e,r,n){for(let i in e){let o=e[i],a={x:0,y:0,w:o.data.width+2*ge,h:o.data.height+2*ge};n.push(a),r[i]=new na(a,o),o.hasRenderCallback&&this.haveRenderCallbacks.push(i)}}patchUpdatedImages(e,r){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let n in e.updatedImages)this.patchUpdatedImage(this.iconPositions[n],e.getImage(n),r),this.patchUpdatedImage(this.patternPositions[n],e.getImage(n),r)}patchUpdatedImage(e,r,n){if(!e||!r||e.version===r.version)return;e.version=r.version;let[i,o]=e.tl;n.update(r.data,void 0,{x:i,y:o})}};C("ImagePosition",na);C("ImageAtlas",ri);var aa=(i=>(i[i.none=0]="none",i[i.horizontal=1]="horizontal",i[i.vertical=2]="vertical",i[i.horizontalOnly=3]="horizontalOnly",i))(aa||{}),Dr=-17;function mb(t){for(let e of t)if(e.positionedGlyphs.length!==0)return!1;return!0}var af=57344,sf=63743,ia=class t{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,r){let n=new t;return n.scale=e||1,n.fontStack=r,n}static forImage(e){let r=new t;return r.imageName=e,r}},ni=class t{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,r){let n=new t;for(let i=0;i<e.sections.length;i++){let o=e.sections[i];o.image?n.addImageSection(o):n.addTextSection(o,r)}return n}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=Yp(this.text)}trim(){let e=0;for(let n=0;n<this.text.length&&oa[this.text.charCodeAt(n)];n++)e++;let r=this.text.length;for(let n=this.text.length-1;n>=0&&n>=e&&oa[this.text.charCodeAt(n)];n--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)}substring(e,r){let n=new t;return n.text=this.text.substring(e,r),n.sectionIndex=this.sectionIndex.slice(e,r),n.sections=this.sections,n}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,r)=>Math.max(e,this.sections[r].scale),0)}addTextSection(e,r){this.text+=e.text,this.sections.push(ia.forText(e.scale,e.fontStack||r));let n=this.sections.length-1;for(let i=0;i<e.text.length;++i)this.sectionIndex.push(n)}addImageSection(e){let r=e.image?e.image.name:"";if(r.length===0){fe("Can't add FormattedSection with an empty image.");return}let n=this.getNextImageSectionCharCode();if(!n){fe("Reached maximum number of images ".concat(sf-af+2));return}this.text+=String.fromCharCode(n),this.sections.push(ia.forImage(r)),this.sectionIndex.push(this.sections.length-1)}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=sf?null:++this.imageSectionID:(this.imageSectionID=af,this.imageSectionID)}};function hb(t,e){let r=[],n=t.text,i=0;for(let o of e)r.push(t.substring(i,o)),i=o;return i<n.length&&r.push(t.substring(i,n.length)),r}function ii(t,e,r,n,i,o,a,s,l,u,c,p,f,y,m,h){let d=ni.fromFeature(t,i);p===2&&d.verticalizePunctuation();let g,{processBidirectionalText:b,processStyledBidirectionalText:x}=ye;if(b&&d.sections.length===1){g=[];let w=b(d.toString(),Ys(d,u,o,e,n,y,m));for(let T of w){let F=new ni;F.text=T,F.sections=d.sections;for(let E=0;E<T.length;E++)F.sectionIndex.push(0);g.push(F)}}else if(x){g=[];let w=x(d.text,d.sectionIndex,Ys(d,u,o,e,n,y,m));for(let T of w){let F=new ni;F.text=T[0],F.sectionIndex=T[1],F.sections=d.sections,g.push(F)}}else g=hb(d,Ys(d,u,o,e,n,y,m));let v=[],P={positionedLines:v,text:d.toString(),top:c[1],bottom:c[1],left:c[0],right:c[0],writingMode:p,iconsInText:!1,verticalizable:!1};return bb(P,e,r,n,g,a,s,l,p,u,f,h),mb(v)?!1:P}var oa={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},db={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function cf(t,e,r,n,i,o){if(e.imageName){let a=n[e.imageName];return a?a.displaySize[0]*e.scale*ne/o+i:0}else{let a=r[e.fontStack],s=a&&a[t];return s?s.metrics.advance*e.scale+i:0}}function gb(t,e,r,n,i,o){let a=0;for(let l=0;l<t.length();l++){let u=t.getSection(l);a+=cf(t.getCharCode(l),u,n,i,e,o)}let s=Math.max(1,Math.ceil(a/r));return a/s}function lf(t,e,r,n){let i=Math.pow(t-e,2);return n?t<e?i/2:i*2:i+Math.abs(r)*r}function xb(t,e,r){let n=0;return t===10&&(n-=1e4),r&&(n+=150),(t===40||t===65288)&&(n+=50),(e===41||e===65289)&&(n+=50),n}function uf(t,e,r,n,i,o){let a=null,s=lf(e,r,i,o);for(let l of n){let u=e-l.x,c=lf(u,r,i,o)+l.badness;c<=s&&(a=l,s=c)}return{index:t,x:e,priorBreak:a,badness:s}}function pf(t){return t?pf(t.priorBreak).concat(t.index):[]}function Ys(t,e,r,n,i,o,a){if(o!=="point")return[];if(!t)return[];let s=[],l=gb(t,e,r,n,i,a),u=t.text.indexOf("\\u200B")>=0,c=0;for(let p=0;p<t.length();p++){let f=t.getSection(p),y=t.getCharCode(p);if(oa[y]||(c+=cf(y,f,n,i,e,a)),p<t.length()-1){let m=Sc(y);(db[y]||m||f.imageName)&&s.push(uf(p+1,c,l,s,xb(y,t.getCharCode(p+1),m&&u),!1))}}return pf(uf(t.length(),c,l,s,0,!0))}function ff(t){let e=.5,r=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0;break}switch(t){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0;break}return{horizontalAlign:e,verticalAlign:r}}function bb(t,e,r,n,i,o,a,s,l,u,c,p){let f=0,y=Dr,m=0,h=0,d=s==="right"?1:s==="left"?0:.5,g=0;for(let P of i){P.trim();let w=P.getMaxScale(),T=(w-1)*ne,F={positionedGlyphs:[],lineOffset:0};t.positionedLines[g]=F;let E=F.positionedGlyphs,_=0;if(!P.length()){y+=o,++g;continue}for(let k=0;k<P.length();k++){let V=P.getSection(k),A=P.getSectionIndex(k),z=P.getCharCode(k),O=0,N=null,K=null,xe=null,X=ne,le=!(l===1||!c&&!lo(z)||c&&(oa[z]||wc(z)));if(V.imageName){let ce=n[V.imageName];if(!ce)continue;xe=V.imageName,t.iconsInText=t.iconsInText||!0,K=ce.paddedRect;let pe=ce.displaySize;V.scale=V.scale*ne/p,N={width:pe[0],height:pe[1],left:ge,top:-ra,advance:le?pe[1]:pe[0]};let _e=ne-pe[1]*V.scale;O=T+_e,X=N.advance;let be=le?pe[0]*V.scale-ne*w:pe[1]*V.scale-ne*w;be>0&&be>_&&(_=be)}else{let ce=r[V.fontStack],pe=ce&&ce[z];if(pe&&pe.rect)K=pe.rect,N=pe.metrics;else{let _e=e[V.fontStack],be=_e&&_e[z];if(!be)continue;N=be.metrics}O=(w-V.scale)*ne}le?(t.verticalizable=!0,E.push({glyph:z,imageName:xe,x:f,y:y+O,vertical:le,scale:V.scale,fontStack:V.fontStack,sectionIndex:A,metrics:N,rect:K}),f+=X*V.scale+u):(E.push({glyph:z,imageName:xe,x:f,y:y+O,vertical:le,scale:V.scale,fontStack:V.fontStack,sectionIndex:A,metrics:N,rect:K}),f+=N.advance*V.scale+u)}if(E.length!==0){let k=f-u;m=Math.max(k,m),vb(E,0,E.length-1,d,_)}f=0;let I=o*w+_;F.lineOffset=Math.max(_,T),y+=I,h=Math.max(I,h),++g}let b=y-Dr,{horizontalAlign:x,verticalAlign:v}=ff(a);Pb(t.positionedLines,d,x,v,m,h,o,b,i.length),t.top+=-v*b,t.bottom=t.top+b,t.left+=-x*m,t.right=t.left+m}function vb(t,e,r,n,i){if(!n&&!i)return;let o=t[r],a=o.metrics.advance*o.scale,s=(t[r].x+a)*n;for(let l=e;l<=r;l++)t[l].x-=s,t[l].y+=i}function Pb(t,e,r,n,i,o,a,s,l){let u=(e-r)*i,c=0;o!==a?c=-s*n-Dr:c=(-n*l+.5)*a;for(let p of t)for(let f of p.positionedGlyphs)f.x+=u,f.y+=c}function yf(t,e,r){let{horizontalAlign:n,verticalAlign:i}=ff(r),o=e[0],a=e[1],s=o-t.displaySize[0]*n,l=s+t.displaySize[0],u=a-t.displaySize[1]*i,c=u+t.displaySize[1];return{image:t,top:u,bottom:c,left:s,right:l}}function Qs(t,e,r,n,i,o){let a=t.image,s;if(a.content){let d=a.content,g=a.pixelRatio||1;s=[d[0]/g,d[1]/g,a.displaySize[0]-d[2]/g,a.displaySize[1]-d[3]/g]}let l=e.left*o,u=e.right*o,c,p,f,y;r==="width"||r==="both"?(y=i[0]+l-n[3],p=i[0]+u+n[1]):(y=i[0]+(l+u-a.displaySize[0])/2,p=y+a.displaySize[0]);let m=e.top*o,h=e.bottom*o;return r==="height"||r==="both"?(c=i[1]+m-n[0],f=i[1]+h+n[2]):(c=i[1]+(m+h-a.displaySize[1])/2,f=c+a.displaySize[1]),{image:a,top:c,right:p,bottom:f,left:y,collisionPadding:s}}var mf=Z(Tt(),1);var Vr=255,Ct=128,tt=Vr*Ct;function el(t,e){let{expression:r}=e;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new q(t+1))};if(r.kind==="source")return{kind:"source"};{let{zoomStops:n,interpolationType:i}=r,o=0;for(;o<n.length&&n[o]<=t;)o++;o=Math.max(0,o-1);let a=o;for(;a<n.length&&n[a]<t+1;)a++;a=Math.min(n.length-1,a);let s=n[o],l=n[a];if(r.kind==="composite")return{kind:"composite",minZoom:s,maxZoom:l,interpolationType:i};let u=r.evaluate(new q(s)),c=r.evaluate(new q(l));return{kind:"camera",minZoom:s,maxZoom:l,minSize:u,maxSize:c,interpolationType:i}}}function tl(t,e,r){let n="never",i=t.get(e);return i?n=i:t.get(r)&&(n="always"),n}var Sb=mf.default.VectorTileFeature.types,wb=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function sa(t,e,r,n,i,o,a,s,l,u,c,p,f){let y=s?Math.min(tt,Math.round(s[0])):0,m=s?Math.min(tt,Math.round(s[1])):0;t.emplaceBack(e,r,Math.round(n*32),Math.round(i*32),o,a,(y<<1)+(l?1:0),m,u*16,c*16,p*256,f*256)}function hf(t,e,r){t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r)}function Ab(t){for(let e of t.sections)if(_c(e.text))return!0;return!1}var ai=class{constructor(e){this.layoutVertexArray=new ko,this.indexArray=new Le,this.programConfigurations=e,this.segments=new me,this.dynamicLayoutVertexArray=new Mo,this.opacityVertexArray=new Eo,this.hasVisibleVertices=!1,this.placedSymbolArray=new Dn}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,r,n,i){this.isEmpty()||(n&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Zp.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Wp.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,wb,!0),this.opacityVertexBuffer.itemSize=1),(n||i)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}};C("SymbolBuffers",ai);var si=class{constructor(e,r,n){this.layoutVertexArray=new e,this.layoutAttributes=r,this.indexArray=new n,this.segments=new me,this.collisionVertexArray=new Fo}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Hp.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}};C("CollisionBuffers",si);var He=class{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(l=>l.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Jn.identity([]),this.placementViewportMatrix=Jn.identity([]);let n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=el(this.zoom,n["text-size"]),this.iconSizeData=el(this.zoom,n["icon-size"]);let i=this.layers[0].layout,o=i.get("symbol-sort-key"),a=i.get("symbol-z-order");this.canOverlap=tl(i,"text-overlap","text-allow-overlap")!=="never"||tl(i,"icon-overlap","icon-allow-overlap")!=="never"||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=a!=="viewport-y"&&!o.isConstant();let s=a==="viewport-y"||a==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=s&&this.canOverlap,i.get("symbol-placement")==="point"&&(this.writingModes=i.get("text-writing-mode").map(l=>aa[l])),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.sourceID=e.sourceID}createArrays(){this.text=new ai(new Ce(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new ai(new Ce(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Bn,this.lineVertexArray=new zn,this.symbolInstances=new Vn,this.textAnchorOffsets=new Rn}calculateGlyphDependencies(e,r,n,i,o){for(let a=0;a<e.length;a++)if(r[e.charCodeAt(a)]=!0,(n||i)&&o){let s=Er[e.charAt(a)];s&&(r[s.charCodeAt(0)]=!0)}}populate(e,r,n){let i=this.layers[0],o=i.layout,a=o.get("text-font"),s=o.get("text-field"),l=o.get("icon-image"),u=(s.value.kind!=="constant"||s.value.value instanceof Fe&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&(a.value.kind!=="constant"||a.value.value.length>0),c=l.value.kind!=="constant"||!!l.value.value||Object.keys(l.parameters).length>0,p=o.get("symbol-sort-key");if(this.features=[],!u&&!c)return;let f=r.iconDependencies,y=r.glyphDependencies,m=r.availableImages,h=new q(this.zoom);for(let{feature:d,id:g,index:b,sourceLayerIndex:x}of e){let v=i._featureFilter.needGeometry,P=$e(d,v);if(!i._featureFilter.filter(h,P,n))continue;v||(P.geometry=ke(d));let w;if(u){let _=i.getValueAndResolveTokens("text-field",P,n,m),I=Fe.factory(_),k=this.hasRTLText=this.hasRTLText||Ab(I);(!k||ye.getRTLTextPluginStatus()==="unavailable"||k&&ye.isParsed())&&(w=Xp(I,i,P))}let T;if(c){let _=i.getValueAndResolveTokens("icon-image",P,n,m);_ instanceof Te?T=_:T=Te.fromString(_)}if(!w&&!T)continue;let F=this.sortFeaturesByKey?p.evaluate(P,{},n):void 0,E={id:g,text:w,icon:T,index:b,sourceLayerIndex:x,geometry:P.geometry,properties:d.properties,type:Sb[d.type],sortKey:F};if(this.features.push(E),T&&(f[T.name]=!0),w){let _=a.evaluate(P,{},n).join(","),I=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(2)>=0;for(let k of w.sections)if(k.image)f[k.image.name]=!0;else{let V=hn(w.toString()),A=k.fontStack||_,z=y[A]=y[A]||{};this.calculateGlyphDependencies(k.text,z,I,this.allowVerticalPlacement,V)}}}o.get("symbol-placement")==="line"&&(this.features=Kp(this.features)),this.sortFeaturesByKey&&this.features.sort((d,g)=>d.sortKey-g.sortKey)}update(e,r,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,r,this.layers,n),this.icon.programConfigurations.updatePaintArrays(e,r,this.layers,n))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,r){let n=this.lineVertexArray.length;if(e.segment!==void 0){let i=e.dist(r[e.segment+1]),o=e.dist(r[e.segment]),a={};for(let s=e.segment+1;s<r.length;s++)a[s]={x:r[s].x,y:r[s].y,tileUnitDistanceFromAnchor:i},s<r.length-1&&(i+=r[s+1].dist(r[s]));for(let s=e.segment||0;s>=0;s--)a[s]={x:r[s].x,y:r[s].y,tileUnitDistanceFromAnchor:o},s>0&&(o+=r[s-1].dist(r[s]));for(let s=0;s<r.length;s++){let l=a[s];this.lineVertexArray.emplaceBack(l.x,l.y,l.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}addSymbols(e,r,n,i,o,a,s,l,u,c,p,f){let y=e.indexArray,m=e.layoutVertexArray,h=e.segments.prepareSegment(4*r.length,m,y,this.canOverlap?a.sortKey:void 0),d=this.glyphOffsetArray.length,g=h.vertexLength,b=this.allowVerticalPlacement&&s===2?Math.PI/2:0,x=a.text&&a.text.sections;for(let v=0;v<r.length;v++){let{tl:P,tr:w,bl:T,br:F,tex:E,pixelOffsetTL:_,pixelOffsetBR:I,minFontScaleX:k,minFontScaleY:V,glyphOffset:A,isSDF:z,sectionIndex:O}=r[v],N=h.vertexLength,K=A[1];sa(m,l.x,l.y,P.x,K+P.y,E.x,E.y,n,z,_.x,_.y,k,V),sa(m,l.x,l.y,w.x,K+w.y,E.x+E.w,E.y,n,z,I.x,_.y,k,V),sa(m,l.x,l.y,T.x,K+T.y,E.x,E.y+E.h,n,z,_.x,I.y,k,V),sa(m,l.x,l.y,F.x,K+F.y,E.x+E.w,E.y+E.h,n,z,I.x,I.y,k,V),hf(e.dynamicLayoutVertexArray,l,b),y.emplaceBack(N,N+1,N+2),y.emplaceBack(N+1,N+2,N+3),h.vertexLength+=4,h.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(A[0]),(v===r.length-1||O!==r[v+1].sectionIndex)&&e.programConfigurations.populatePaintArrays(m.length,a,a.index,{},f,x&&x[O])}e.placedSymbolArray.emplaceBack(l.x,l.y,d,this.glyphOffsetArray.length-d,g,u,c,l.segment,n?n[0]:0,n?n[1]:0,i[0],i[1],s,0,!1,0,p)}_addCollisionDebugVertex(e,r,n,i,o,a){return r.emplaceBack(0,0),e.emplaceBack(n.x,n.y,i,o,Math.round(a.x),Math.round(a.y))}addCollisionDebugVertices(e,r,n,i,o,a,s){let l=o.segments.prepareSegment(4,o.layoutVertexArray,o.indexArray),u=l.vertexLength,c=o.layoutVertexArray,p=o.collisionVertexArray,f=s.anchorX,y=s.anchorY;this._addCollisionDebugVertex(c,p,a,f,y,new oi.default(e,r)),this._addCollisionDebugVertex(c,p,a,f,y,new oi.default(n,r)),this._addCollisionDebugVertex(c,p,a,f,y,new oi.default(n,i)),this._addCollisionDebugVertex(c,p,a,f,y,new oi.default(e,i)),l.vertexLength+=4;let m=o.indexArray;m.emplaceBack(u,u+1),m.emplaceBack(u+1,u+2),m.emplaceBack(u+2,u+3),m.emplaceBack(u+3,u),l.primitiveLength+=4}addDebugCollisionBoxes(e,r,n,i){for(let o=e;o<r;o++){let a=this.collisionBoxArray.get(o),s=a.x1,l=a.y1,u=a.x2,c=a.y2;this.addCollisionDebugVertices(s,l,u,c,i?this.textCollisionBox:this.iconCollisionBox,a.anchorPoint,n)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new si(Nn,Hs.members,wt),this.iconCollisionBox=new si(Nn,Hs.members,wt);for(let e=0;e<this.symbolInstances.length;e++){let r=this.symbolInstances.get(e);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(e,r,n,i,o,a,s,l,u){let c={};for(let p=r;p<n;p++){let f=e.get(p);c.textBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.textFeatureIndex=f.featureIndex;break}for(let p=i;p<o;p++){let f=e.get(p);c.verticalTextBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.verticalTextFeatureIndex=f.featureIndex;break}for(let p=a;p<s;p++){let f=e.get(p);c.iconBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.iconFeatureIndex=f.featureIndex;break}for(let p=l;p<u;p++){let f=e.get(p);c.verticalIconBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.verticalIconFeatureIndex=f.featureIndex;break}return c}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){let n=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,r){let n=e.placedSymbolArray.get(r),i=n.vertexStartIndex+n.numGlyphs*4;for(let o=n.vertexStartIndex;o<i;o+=4)e.indexArray.emplaceBack(o,o+1,o+2),e.indexArray.emplaceBack(o+1,o+2,o+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let r=Math.sin(e),n=Math.cos(e),i=[],o=[],a=[];for(let s=0;s<this.symbolInstances.length;++s){a.push(s);let l=this.symbolInstances.get(s);i.push(Math.round(r*l.anchorX+n*l.anchorY)|0),o.push(l.featureIndex)}return a.sort((s,l)=>i[s]-i[l]||o[l]-o[s]),a}addToSortKeyRanges(e,r){let n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===r?n.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let r of this.symbolInstanceIndexes){let n=this.symbolInstances.get(r);this.featureSortOrder.push(n.featureIndex),[n.rightJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.leftJustifiedTextSymbolIndex].forEach((i,o,a)=>{i>=0&&a.indexOf(i)===o&&this.addIndicesForPlacedSymbol(this.text,i)}),n.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,n.verticalPlacedTextSymbolIndex),n.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,n.placedIconSymbolIndex),n.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,n.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}};C("SymbolBucket",He,{omit:["layers","collisionBoxArray","features","compareText"]});He.MAX_GLYPHS=65535;He.addDynamicAttributes=hf;function df(t,e){return e.replace(/{([^{}]+)}/g,(r,n)=>t&&n in t?String(t[n]):"")}var gf,_b=()=>gf=gf||new re({"symbol-placement":new B(S.layout_symbol["symbol-placement"]),"symbol-spacing":new B(S.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new B(S.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new R(S.layout_symbol["symbol-sort-key"]),"symbol-z-order":new B(S.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new B(S.layout_symbol["icon-allow-overlap"]),"icon-overlap":new B(S.layout_symbol["icon-overlap"]),"icon-ignore-placement":new B(S.layout_symbol["icon-ignore-placement"]),"icon-optional":new B(S.layout_symbol["icon-optional"]),"icon-rotation-alignment":new B(S.layout_symbol["icon-rotation-alignment"]),"icon-size":new R(S.layout_symbol["icon-size"]),"icon-text-fit":new B(S.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new B(S.layout_symbol["icon-text-fit-padding"]),"icon-image":new R(S.layout_symbol["icon-image"]),"icon-rotate":new R(S.layout_symbol["icon-rotate"]),"icon-padding":new R(S.layout_symbol["icon-padding"]),"icon-keep-upright":new B(S.layout_symbol["icon-keep-upright"]),"icon-offset":new R(S.layout_symbol["icon-offset"]),"icon-anchor":new R(S.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new B(S.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new B(S.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new B(S.layout_symbol["text-rotation-alignment"]),"text-field":new R(S.layout_symbol["text-field"]),"text-font":new R(S.layout_symbol["text-font"]),"text-size":new R(S.layout_symbol["text-size"]),"text-max-width":new R(S.layout_symbol["text-max-width"]),"text-line-height":new B(S.layout_symbol["text-line-height"]),"text-letter-spacing":new R(S.layout_symbol["text-letter-spacing"]),"text-justify":new R(S.layout_symbol["text-justify"]),"text-radial-offset":new R(S.layout_symbol["text-radial-offset"]),"text-variable-anchor":new B(S.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new R(S.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new R(S.layout_symbol["text-anchor"]),"text-max-angle":new B(S.layout_symbol["text-max-angle"]),"text-writing-mode":new B(S.layout_symbol["text-writing-mode"]),"text-rotate":new R(S.layout_symbol["text-rotate"]),"text-padding":new B(S.layout_symbol["text-padding"]),"text-keep-upright":new B(S.layout_symbol["text-keep-upright"]),"text-transform":new R(S.layout_symbol["text-transform"]),"text-offset":new R(S.layout_symbol["text-offset"]),"text-allow-overlap":new B(S.layout_symbol["text-allow-overlap"]),"text-overlap":new B(S.layout_symbol["text-overlap"]),"text-ignore-placement":new B(S.layout_symbol["text-ignore-placement"]),"text-optional":new B(S.layout_symbol["text-optional"])}),xf,Ib=()=>xf=xf||new re({"icon-opacity":new R(S.paint_symbol["icon-opacity"]),"icon-color":new R(S.paint_symbol["icon-color"]),"icon-halo-color":new R(S.paint_symbol["icon-halo-color"]),"icon-halo-width":new R(S.paint_symbol["icon-halo-width"]),"icon-halo-blur":new R(S.paint_symbol["icon-halo-blur"]),"icon-translate":new B(S.paint_symbol["icon-translate"]),"icon-translate-anchor":new B(S.paint_symbol["icon-translate-anchor"]),"text-opacity":new R(S.paint_symbol["text-opacity"]),"text-color":new R(S.paint_symbol["text-color"],{runtimeType:Re,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new R(S.paint_symbol["text-halo-color"]),"text-halo-width":new R(S.paint_symbol["text-halo-width"]),"text-halo-blur":new R(S.paint_symbol["text-halo-blur"]),"text-translate":new B(S.paint_symbol["text-translate"]),"text-translate-anchor":new B(S.paint_symbol["text-translate-anchor"])}),la={get paint(){return Ib()},get layout(){return _b()}};var li=class{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:hr,this.defaultValue=e}evaluate(e){if(e.formattedSection){let r=this.defaultValue.property.overrides;if(r&&r.hasOverride(e.formattedSection))return r.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){if(!this.defaultValue.isConstant()){let r=this.defaultValue.value;e(r._styleExpression.expression)}}outputDefined(){return!1}serialize(){return null}};C("FormatSectionOverride",li,{omit:["defaultValue"]});var ua=class t extends se{constructor(e){super(e,la)}recalculate(e,r){if(super.recalculate(e,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){let n=this.layout.get("text-writing-mode");if(n){let i=[];for(let o of n)i.indexOf(o)<0&&i.push(o);this.layout._values["text-writing-mode"]=i}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,r,n,i){let o=this.layout.get(e).evaluate(r,{},n,i),a=this._unevaluatedLayout._values[e];return!a.isDataDriven()&&!qt(a.value)&&o?df(r.properties,o):o}createBucket(e){return new He(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let e of la.paint.overridableProperties){if(!t.hasPaintOverride(this.layout,e))continue;let r=this.paint.get(e),n=new li(r),i=new Nt(n,r.property.specification),o=null;r.value.kind==="constant"||r.value.kind==="source"?o=new dt("source",i):o=new gt("composite",i,r.value.zoomStops),this.paint._values[e]=new Se(r.property,o,r.parameters)}}_handleOverridablePaintPropertyUpdate(e,r,n){return!this.layout||r.isDataDriven()||n.isDataDriven()?!1:t.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,r){let n=e.get("text-field"),i=la.paint.properties[r],o=!1,a=s=>{for(let l of s)if(i.overrides&&i.overrides.hasOverride(l)){o=!0;return}};if(n.value.kind==="constant"&&n.value.value instanceof Fe)a(n.value.value.sections);else if(n.value.kind==="source"){let s=u=>{if(!o)if(u instanceof mt&&ue(u.value)===dr){let c=u.value;a(c.sections)}else u instanceof tn?a(u.sections):u.eachChild(s)},l=n.value;l._styleExpression&&s(l._styleExpression.expression)}return o}};function bf(t,e,r,n=1){let i=t.get("icon-padding").evaluate(e,{},r),o=i&&i.values;return[o[0]*n,o[1]*n,o[2]*n,o[3]*n]}var vf,Tb=()=>vf=vf||new re({"background-color":new B(S.paint_background["background-color"]),"background-pattern":new Jt(S.paint_background["background-pattern"]),"background-opacity":new B(S.paint_background["background-opacity"])}),Pf={get paint(){return Tb()}};var ca=class extends se{constructor(e){super(e,Pf)}};var Sf,Cb=()=>Sf=Sf||new re({"raster-opacity":new B(S.paint_raster["raster-opacity"]),"raster-hue-rotate":new B(S.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new B(S.paint_raster["raster-brightness-min"]),"raster-brightness-max":new B(S.paint_raster["raster-brightness-max"]),"raster-saturation":new B(S.paint_raster["raster-saturation"]),"raster-contrast":new B(S.paint_raster["raster-contrast"]),"raster-resampling":new B(S.paint_raster["raster-resampling"]),"raster-fade-duration":new B(S.paint_raster["raster-fade-duration"])}),wf={get paint(){return Cb()}};var pa=class extends se{constructor(e){super(e,wf)}};var fa=class extends se{constructor(r){super(r,{});this.onAdd=r=>{this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)};this.onRemove=r=>{this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)};this.implementation=r}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}};function Af(t){if(t.type==="custom")return new fa(t);switch(t.type){case"background":return new ca(t);case"circle":return new Uo(t);case"fill":return new Wo(t);case"fill-extrusion":return new Ko(t);case"heatmap":return new $o(t);case"hillshade":return new Go(t);case"line":return new Qo(t);case"raster":return new pa(t);case"symbol":return new ua(t)}}var ya=class{constructor(e){this.keyCache={},e&&this.replace(e)}replace(e){this._layerConfigs={},this._layers={},this.update(e,[])}update(e,r){for(let i of e){this._layerConfigs[i.id]=i;let o=this._layers[i.id]=Af(i);o._featureFilter=yn(o.filter),this.keyCache[i.id]&&delete this.keyCache[i.id]}for(let i of r)delete this.keyCache[i],delete this._layerConfigs[i],delete this._layers[i];this.familiesBySource={};let n=qu(Object.values(this._layerConfigs),this.keyCache);for(let i of n){let o=i.map(p=>this._layers[p.id]),a=o[0];if(a.visibility==="none")continue;let s=a.source||"",l=this.familiesBySource[s];l||(l=this.familiesBySource[s]={});let u=a.sourceLayer||"_geojsonTileLayer",c=l[u];c||(c=l[u]=[]),c.push(o)}}};var Hf=Z(Tt(),1),Xf=Z(ei(),1);var Br=class{constructor(e){this._stringToNumber={},this._numberToString=[];for(let r=0;r<e.length;r++){let n=e[r];this._stringToNumber[n]=r,this._numberToString[r]=n}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error("Out of bounds. Index requested n=".concat(e," can't be >= this._numberToString.length ").concat(this._numberToString.length));return this._numberToString[e]}};var Tf=Z(Tt(),1),Cf=Z(ei(),1);var ma=class{constructor(e,r,n,i,o){this.type="Feature",this._vectorTileFeature=e,e._z=r,e._x=n,e._y=i,this.properties=e.properties,this.id=o}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){let e={geometry:this.geometry};for(let r in this)r==="_geometry"||r==="_vectorTileFeature"||(e[r]=this[r]);return e}};var ui=class{constructor(e,r){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Vt(8192,16,0),this.grid3D=new Vt(8192,16,0),this.featureIndexArray=new On,this.promoteId=r}insert(e,r,n,i,o,a){let s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,i,o);let l=a?this.grid3D:this.grid;for(let u=0;u<r.length;u++){let c=r[u],p=[1/0,1/0,-1/0,-1/0];for(let f=0;f<c.length;f++){let y=c[f];p[0]=Math.min(p[0],y.x),p[1]=Math.min(p[1],y.y),p[2]=Math.max(p[2],y.x),p[3]=Math.max(p[3],y.y)}p[0]<8192&&p[1]<8192&&p[2]>=0&&p[3]>=0&&l.insert(s,p[0],p[1],p[2],p[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Tf.default.VectorTile(new Cf.default(this.rawTileData)).layers,this.sourceLayerCoder=new Br(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,r,n,i){this.loadVTLayers();let o=e.params||{},a=8192/e.tileSize/e.scale,s=yn(o.filter),l=e.queryGeometry,u=e.queryPadding*a,c=If(l),p=this.grid.query(c.minX-u,c.minY-u,c.maxX+u,c.maxY+u),f=If(e.cameraQueryGeometry),y=this.grid3D.query(f.minX-u,f.minY-u,f.maxX+u,f.maxY+u,(d,g,b,x)=>Uc(e.cameraQueryGeometry,d-u,g-u,b+u,x+u));for(let d of y)p.push(d);p.sort(kb);let m={},h;for(let d=0;d<p.length;d++){let g=p[d];if(g===h)continue;h=g;let b=this.featureIndexArray.get(g),x=null;this.loadMatchingFeature(m,b.bucketIndex,b.sourceLayerIndex,b.featureIndex,s,o.layers,o.availableImages,r,n,i,(v,P,w)=>(x||(x=ke(v)),P.queryIntersectsFeature(l,v,w,x,this.z,e.transform,a,e.pixelPosMatrix)))}return m}loadMatchingFeature(e,r,n,i,o,a,s,l,u,c,p){let f=this.bucketLayerIDs[r];if(a&&!Yl(a,f))return;let y=this.sourceLayerCoder.decode(n),h=this.vtLayers[y].feature(i);if(o.needGeometry){let g=$e(h,!0);if(!o.filter(new q(this.tileID.overscaledZ),g,this.tileID.canonical))return}else if(!o.filter(new q(this.tileID.overscaledZ),h))return;let d=this.getId(h,y);for(let g=0;g<f.length;g++){let b=f[g];if(a&&a.indexOf(b)<0)continue;let x=l[b];if(!x)continue;let v={};d&&c&&(v=c.getState(x.sourceLayer||"_geojsonTileLayer",d));let P=Pe({},u[b]);P.paint=_f(P.paint,x.paint,h,v,s),P.layout=_f(P.layout,x.layout,h,v,s);let w=!p||p(h,x,v);if(!w)continue;let T=new ma(h,this.z,this.x,this.y,d);T.layer=P;let F=e[b];F===void 0&&(F=e[b]=[]),F.push({featureIndex:i,feature:T,intersectionZ:w})}}lookupSymbolFeatures(e,r,n,i,o,a,s,l){let u={};this.loadVTLayers();let c=yn(o);for(let p of e)this.loadMatchingFeature(u,n,i,p,c,a,s,l,r);return u}hasLayer(e){for(let r of this.bucketLayerIDs)for(let n of r)if(e===n)return!0;return!1}getId(e,r){let n=e.id;if(this.promoteId){let i=typeof this.promoteId=="string"?this.promoteId:this.promoteId[r];n=e.properties[i],typeof n=="boolean"&&(n=Number(n))}return n}};C("FeatureIndex",ui,{omit:["rawTileData","sourceLayerCoder"]});function _f(t,e,r,n,i){return jr(t,(o,a)=>{let s=e instanceof vt?e.get(a):null;return s&&s.evaluate?s.evaluate(r,n,i):s})}function If(t){let e=1/0,r=1/0,n=-1/0,i=-1/0;for(let o of t)e=Math.min(e,o.x),r=Math.min(r,o.y),n=Math.max(n,o.x),i=Math.max(i,o.y);return{minX:e,minY:r,maxX:n,maxY:i}}function kb(t,e){return e-t}var kf=Z(he(),1);var rt=class t extends kf.default{constructor(e,r,n,i){super(e,r),this.angle=n,i!==void 0&&(this.segment=i)}clone(){return new t(this.x,this.y,this.angle,this.segment)}};C("Anchor",rt);function rl(t,e,r,n,i){if(e.segment===void 0||r===0)return!0;let o=e,a=e.segment+1,s=0;for(;s>-r/2;){if(a--,a<0)return!1;s-=t[a].dist(o),o=t[a]}s+=t[a].dist(t[a+1]),a++;let l=[],u=0;for(;s<r/2;){let c=t[a-1],p=t[a],f=t[a+1];if(!f)return!1;let y=c.angleTo(p)-p.angleTo(f);for(y=Math.abs((y+3*Math.PI)%(Math.PI*2)-Math.PI),l.push({distance:s,angleDelta:y}),u+=y;s-l[0].distance>n;)u-=l.shift().angleDelta;if(u>i)return!1;a++,s+=p.dist(f)}return!0}function Mf(t){let e=0;for(let r=0;r<t.length-1;r++)e+=t[r].dist(t[r+1]);return e}function Ef(t,e,r){return t?3/5*e*r:0}function Ff(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function Lf(t,e,r,n,i,o){let a=Ef(r,i,o),s=Ff(r,n)*o,l=0,u=Mf(t)/2;for(let c=0;c<t.length-1;c++){let p=t[c],f=t[c+1],y=p.dist(f);if(l+y>u){let m=(u-l)/y,h=Oe.number(p.x,f.x,m),d=Oe.number(p.y,f.y,m),g=new rt(h,d,f.angleTo(p),c);return g._round(),!a||rl(t,g,s,a,e)?g:void 0}l+=y}}function Df(t,e,r,n,i,o,a,s,l){let u=Ef(n,o,a),c=Ff(n,i),p=c*a,f=t[0].x===0||t[0].x===l||t[0].y===0||t[0].y===l;e-p<e/4&&(e=p+e/4);let y=o*2,m=f?e/2*s%e:(c/2+y)*a*s%e;return Vf(t,m,e,u,r,p,f,!1,l)}function Vf(t,e,r,n,i,o,a,s,l){let u=o/2,c=Mf(t),p=0,f=e-r,y=[];for(let m=0;m<t.length-1;m++){let h=t[m],d=t[m+1],g=h.dist(d),b=d.angleTo(h);for(;f+r<p+g;){f+=r;let x=(f-p)/g,v=Oe.number(h.x,d.x,x),P=Oe.number(h.y,d.y,x);if(v>=0&&v<l&&P>=0&&P<l&&f-u>=0&&f+u<=c){let w=new rt(v,P,b,m);w._round(),(!n||rl(t,w,o,n,i))&&y.push(w)}}p+=g}return!s&&!y.length&&!a&&(y=Vf(t,p/2,r,n,i,o,a,!0,l)),y}var pt=Z(he(),1);function Bf(t,e,r,n,i){let o=[];for(let a=0;a<t.length;a++){let s=t[a],l;for(let u=0;u<s.length-1;u++){let c=s[u],p=s[u+1];c.x<e&&p.x<e||(c.x<e?c=new pt.default(e,c.y+(p.y-c.y)*((e-c.x)/(p.x-c.x)))._round():p.x<e&&(p=new pt.default(e,c.y+(p.y-c.y)*((e-c.x)/(p.x-c.x)))._round()),!(c.y<r&&p.y<r)&&(c.y<r?c=new pt.default(c.x+(p.x-c.x)*((r-c.y)/(p.y-c.y)),r)._round():p.y<r&&(p=new pt.default(c.x+(p.x-c.x)*((r-c.y)/(p.y-c.y)),r)._round()),!(c.x>=n&&p.x>=n)&&(c.x>=n?c=new pt.default(n,c.y+(p.y-c.y)*((n-c.x)/(p.x-c.x)))._round():p.x>=n&&(p=new pt.default(n,c.y+(p.y-c.y)*((n-c.x)/(p.x-c.x)))._round()),!(c.y>=i&&p.y>=i)&&(c.y>=i?c=new pt.default(c.x+(p.x-c.x)*((i-c.y)/(p.y-c.y)),i)._round():p.y>=i&&(p=new pt.default(c.x+(p.x-c.x)*((i-c.y)/(p.y-c.y)),i)._round()),(!l||!c.equals(l[l.length-1]))&&(l=[c],o.push(l)),l.push(p)))))}}return o}var we=Z(he(),1);var zr=ge;function nl(t,e,r,n){let i=[],o=t.image,a=o.pixelRatio,s=o.paddedRect.w-2*zr,l=o.paddedRect.h-2*zr,u=t.right-t.left,c=t.bottom-t.top,p=o.stretchX||[[0,s]],f=o.stretchY||[[0,l]],y=(I,k)=>I+k[1]-k[0],m=p.reduce(y,0),h=f.reduce(y,0),d=s-m,g=l-h,b=0,x=m,v=0,P=h,w=0,T=d,F=0,E=g;if(o.content&&n){let I=o.content;b=ha(p,0,I[0]),v=ha(f,0,I[1]),x=ha(p,I[0],I[2]),P=ha(f,I[1],I[3]),w=I[0]-b,F=I[1]-v,T=I[2]-I[0]-x,E=I[3]-I[1]-P}let _=(I,k,V,A)=>{let z=da(I.stretch-b,x,u,t.left),O=ga(I.fixed-w,T,I.stretch,m),N=da(k.stretch-v,P,c,t.top),K=ga(k.fixed-F,E,k.stretch,h),xe=da(V.stretch-b,x,u,t.left),X=ga(V.fixed-w,T,V.stretch,m),le=da(A.stretch-v,P,c,t.top),ce=ga(A.fixed-F,E,A.stretch,h),pe=new we.default(z,N),_e=new we.default(xe,N),be=new we.default(xe,le),Ai=new we.default(z,le),Da=new we.default(O/a,K/a),Va=new we.default(X/a,ce/a),Ur=e*Math.PI/180;if(Ur){let Ie=Math.sin(Ur),ve=Math.cos(Ur),Ve=[ve,-Ie,Ie,ve];pe._matMult(Ve),_e._matMult(Ve),Ai._matMult(Ve),be._matMult(Ve)}let _i=I.stretch+I.fixed,Me=V.stretch+V.fixed,Ft=k.stretch+k.fixed,Ii=A.stretch+A.fixed,Ba={x:o.paddedRect.x+zr+_i,y:o.paddedRect.y+zr+Ft,w:Me-_i,h:Ii-Ft},za=T/a/u,Ra=E/a/c;return{tl:pe,tr:_e,bl:Ai,br:be,tex:Ba,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Da,pixelOffsetBR:Va,minFontScaleX:za,minFontScaleY:Ra,isSDF:r}};if(!n||!o.stretchX&&!o.stretchY)i.push(_({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:s+1},{fixed:0,stretch:l+1}));else{let I=zf(p,d,m),k=zf(f,g,h);for(let V=0;V<I.length-1;V++){let A=I[V],z=I[V+1];for(let O=0;O<k.length-1;O++){let N=k[O],K=k[O+1];i.push(_(A,N,z,K))}}}return i}function ha(t,e,r){let n=0;for(let i of t)n+=Math.max(e,Math.min(r,i[1]))-Math.max(e,Math.min(r,i[0]));return n}function zf(t,e,r){let n=[{fixed:-zr,stretch:0}];for(let[i,o]of t){let a=n[n.length-1];n.push({fixed:i-a.stretch,stretch:a.stretch}),n.push({fixed:i-a.stretch,stretch:a.stretch+(o-i)})}return n.push({fixed:e+zr,stretch:r}),n}function da(t,e,r,n){return t/e*r+n}function ga(t,e,r,n){return t-e*r/n}function Rf(t,e,r,n,i,o,a,s){let l=n.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,u=[];for(let c of e.positionedLines)for(let p of c.positionedGlyphs){if(!p.rect)continue;let f=p.rect||{},m=ra+1,h=!0,d=1,g=0,b=(i||s)&&p.vertical,x=p.metrics.advance*p.scale/2;if(s&&e.verticalizable){let X=(p.scale-1)*ne,le=(ne-p.metrics.width*p.scale)/2;g=c.lineOffset/2-(p.imageName?-le:X)}if(p.imageName){let X=a[p.imageName];h=X.sdf,d=X.pixelRatio,m=ge/d}let v=i?[p.x+x,p.y]:[0,0],P=i?[0,0]:[p.x+x+r[0],p.y+r[1]-g],w=[0,0];b&&(w=P,P=[0,0]);let T=p.metrics.isDoubleResolution?2:1,F=(p.metrics.left-m)*p.scale-x+P[0],E=(-p.metrics.top-m)*p.scale+P[1],_=F+f.w/T*p.scale/d,I=E+f.h/T*p.scale/d,k=new we.default(F,E),V=new we.default(_,E),A=new we.default(F,I),z=new we.default(_,I);if(b){let X=new we.default(-x,x-Dr),le=-Math.PI/2,ce=ne/2-x,pe=p.imageName?ce:0,_e=new we.default(5-Dr-ce,-pe),be=new we.default(...w);k._rotateAround(le,X)._add(_e)._add(be),V._rotateAround(le,X)._add(_e)._add(be),A._rotateAround(le,X)._add(_e)._add(be),z._rotateAround(le,X)._add(_e)._add(be)}if(l){let X=Math.sin(l),le=Math.cos(l),ce=[le,-X,X,le];k._matMult(ce),V._matMult(ce),A._matMult(ce),z._matMult(ce)}let O=new we.default(0,0),N=new we.default(0,0);u.push({tl:k,tr:V,bl:A,br:z,tex:f,writingMode:e.writingMode,glyphOffset:v,sectionIndex:p.sectionIndex,isSDF:h,pixelOffsetTL:O,pixelOffsetBR:N,minFontScaleX:0,minFontScaleY:0})}return u}var ci=Z(he(),1),or=class{constructor(e,r,n,i,o,a,s,l,u,c){if(this.boxStartIndex=e.length,u){let p=a.top,f=a.bottom,y=a.collisionPadding;y&&(p-=y[1],f+=y[3]);let m=f-p;m>0&&(m=Math.max(10,m),this.circleDiameter=m)}else{let p=a.top*s-l[0],f=a.bottom*s+l[2],y=a.left*s-l[3],m=a.right*s+l[1],h=a.collisionPadding;if(h&&(y-=h[0]*s,p-=h[1]*s,m+=h[2]*s,f+=h[3]*s),c){let d=new ci.default(y,p),g=new ci.default(m,p),b=new ci.default(y,f),x=new ci.default(m,f),v=c*Math.PI/180;d._rotate(v),g._rotate(v),b._rotate(v),x._rotate(v),y=Math.min(d.x,g.x,b.x,x.x),m=Math.max(d.x,g.x,b.x,x.x),p=Math.min(d.y,g.y,b.y,x.y),f=Math.max(d.y,g.y,b.y,x.y)}e.emplaceBack(r.x,r.y,y,p,m,f,n,i,o)}this.boxEndIndex=e.length}};var pi=class{constructor(e=[],r=Mb){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;let e=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:r,compare:n}=this,i=r[e];for(;e>0;){let o=e-1>>1,a=r[o];if(n(i,a)>=0)break;r[e]=a,e=o}r[e]=i}_down(e){let{data:r,compare:n}=this,i=this.length>>1,o=r[e];for(;e<i;){let a=(e<<1)+1,s=r[a],l=a+1;if(l<this.length&&n(r[l],s)<0&&(a=l,s=r[l]),n(s,o)>=0)break;r[e]=s,e=a}r[e]=o}};function Mb(t,e){return t<e?-1:t>e?1:0}var il=Z(he(),1);function Of(t,e=1,r=!1){let n=1/0,i=1/0,o=-1/0,a=-1/0,s=t[0];for(let h=0;h<s.length;h++){let d=s[h];(!h||d.x<n)&&(n=d.x),(!h||d.y<i)&&(i=d.y),(!h||d.x>o)&&(o=d.x),(!h||d.y>a)&&(a=d.y)}let l=o-n,u=a-i,c=Math.min(l,u),p=c/2,f=new pi([],Eb);if(c===0)return new il.default(n,i);for(let h=n;h<o;h+=c)for(let d=i;d<a;d+=c)f.push(new Rr(h+p,d+p,p,t));let y=Lb(t),m=f.length;for(;f.length;){let h=f.pop();(h.d>y.d||!y.d)&&(y=h,r&&console.log("found best %d after %d probes",Math.round(1e4*h.d)/1e4,m)),!(h.max-y.d<=e)&&(p=h.h/2,f.push(new Rr(h.p.x-p,h.p.y-p,p,t)),f.push(new Rr(h.p.x+p,h.p.y-p,p,t)),f.push(new Rr(h.p.x-p,h.p.y+p,p,t)),f.push(new Rr(h.p.x+p,h.p.y+p,p,t)),m+=4)}return r&&(console.log("num probes: ".concat(m)),console.log("best distance: ".concat(y.d))),y.p}function Eb(t,e){return e.max-t.max}function Rr(t,e,r,n){this.p=new il.default(t,e),this.h=r,this.d=Fb(this.p,n),this.max=this.d+this.h*Math.SQRT2}function Fb(t,e){let r=!1,n=1/0;for(let i=0;i<e.length;i++){let o=e[i];for(let a=0,s=o.length,l=s-1;a<s;l=a++){let u=o[a],c=o[l];u.y>t.y!=c.y>t.y&&t.x<(c.x-u.x)*(t.y-u.y)/(c.y-u.y)+u.x&&(r=!r),n=Math.min(n,Vs(t,u,c))}}return(r?1:-1)*Math.sqrt(n)}function Lb(t){let e=0,r=0,n=0,i=t[0];for(let o=0,a=i.length,s=a-1;o<a;s=o++){let l=i[o],u=i[s],c=l.x*u.y-u.x*l.y;r+=(l.x+u.x)*c,n+=(l.y+u.y)*c,e+=c*3}return new Rr(r/e,n/e,0,t)}var ll=Z(ks(),1);var ol=(o=>(o[o.center=1]="center",o[o.left=2]="left",o[o.right=3]="right",o[o.top=4]="top",o[o.bottom=5]="bottom",o[o["top-left"]=6]="top-left",o[o["top-right"]=7]="top-right",o[o["bottom-left"]=8]="bottom-left",o[o["bottom-right"]=9]="bottom-right",o))(ol||{}),kt=7,xa=Number.POSITIVE_INFINITY;function al(t,e){function r(i,o){let a=0,s=0;o<0&&(o=0);let l=o/Math.SQRT2;switch(i){case"top-right":case"top-left":s=l-kt;break;case"bottom-right":case"bottom-left":s=-l+kt;break;case"bottom":s=-o+kt;break;case"top":s=o-kt;break}switch(i){case"top-right":case"bottom-right":a=-l;break;case"top-left":case"bottom-left":a=l;break;case"left":a=o;break;case"right":a=-o;break}return[a,s]}function n(i,o,a){let s=0,l=0;switch(o=Math.abs(o),a=Math.abs(a),i){case"top-right":case"top-left":case"top":l=a-kt;break;case"bottom-right":case"bottom-left":case"bottom":l=-a+kt;break}switch(i){case"top-right":case"bottom-right":case"right":s=-o;break;case"top-left":case"bottom-left":case"left":s=o;break}return[s,l]}return e[1]!==xa?n(t,e[0],e[1]):r(t,e[0])}function sl(t,e,r){var a;let n=t.layout,i=(a=n.get("text-variable-anchor-offset"))==null?void 0:a.evaluate(e,{},r);if(i){let s=i.values,l=[];for(let u=0;u<s.length;u+=2){let c=l[u]=s[u],p=s[u+1].map(f=>f*ne);c.startsWith("top")?p[1]-=kt:c.startsWith("bottom")&&(p[1]+=kt),l[u+1]=p}return new Ne(l)}let o=n.get("text-variable-anchor");if(o){let s;t._unevaluatedLayout.getValue("text-radial-offset")!==void 0?s=[n.get("text-radial-offset").evaluate(e,{},r)*ne,xa]:s=n.get("text-offset").evaluate(e,{},r).map(c=>c*ne);let u=[];for(let c of o)u.push(c,al(c,s));return new Ne(u)}return null}function $f(t){t.bucket.createArrays();let e=512*t.bucket.overscaling;t.bucket.tilePixelRatio=8192/e,t.bucket.compareText={},t.bucket.iconsNeedLinear=!1;let r=t.bucket.layers[0],n=r.layout,i=r._unevaluatedLayout._values,o={layoutIconSize:i["icon-size"].possiblyEvaluate(new q(t.bucket.zoom+1),t.canonical),layoutTextSize:i["text-size"].possiblyEvaluate(new q(t.bucket.zoom+1),t.canonical),textMaxSize:i["text-size"].possiblyEvaluate(new q(18))};if(t.bucket.textSizeData.kind==="composite"){let{minZoom:c,maxZoom:p}=t.bucket.textSizeData;o.compositeTextSizes=[i["text-size"].possiblyEvaluate(new q(c),t.canonical),i["text-size"].possiblyEvaluate(new q(p),t.canonical)]}if(t.bucket.iconSizeData.kind==="composite"){let{minZoom:c,maxZoom:p}=t.bucket.iconSizeData;o.compositeIconSizes=[i["icon-size"].possiblyEvaluate(new q(c),t.canonical),i["icon-size"].possiblyEvaluate(new q(p),t.canonical)]}let a=n.get("text-line-height")*ne,s=n.get("text-rotation-alignment")!=="viewport"&&n.get("symbol-placement")!=="point",l=n.get("text-keep-upright"),u=n.get("text-size");for(let c of t.bucket.features){let p=n.get("text-font").evaluate(c,{},t.canonical).join(","),f=u.evaluate(c,{},t.canonical),y=o.layoutTextSize.evaluate(c,{},t.canonical),m=o.layoutIconSize.evaluate(c,{},t.canonical),h={horizontal:{},vertical:void 0},d=c.text,g=[0,0];if(d){let P=d.toString(),w=n.get("text-letter-spacing").evaluate(c,{},t.canonical)*ne,T=Pc(P)?w:0,F=n.get("text-anchor").evaluate(c,{},t.canonical),E=sl(r,c,t.canonical);if(!E){let A=n.get("text-radial-offset").evaluate(c,{},t.canonical);A?g=al(F,[A*ne,xa]):g=n.get("text-offset").evaluate(c,{},t.canonical).map(z=>z*ne)}let _=s?"center":n.get("text-justify").evaluate(c,{},t.canonical),I=n.get("symbol-placement"),k=I==="point"?n.get("text-max-width").evaluate(c,{},t.canonical)*ne:0,V=()=>{t.bucket.allowVerticalPlacement&&hn(P)&&(h.vertical=ii(d,t.glyphMap,t.glyphPositions,t.imagePositions,p,k,a,F,"left",T,g,2,!0,I,y,f))};if(!s&&E){let A=new Set;if(_==="auto")for(let O=0;O<E.values.length;O+=2)A.add(Nf(E.values[O]));else A.add(_);let z=!1;for(let O of A)if(!h.horizontal[O])if(z)h.horizontal[O]=h.horizontal[0];else{let N=ii(d,t.glyphMap,t.glyphPositions,t.imagePositions,p,k,a,"center",O,T,g,1,!1,I,y,f);N&&(h.horizontal[O]=N,z=N.positionedLines.length===1)}V()}else{_==="auto"&&(_=Nf(F));let A=ii(d,t.glyphMap,t.glyphPositions,t.imagePositions,p,k,a,F,_,T,g,1,!1,I,y,f);A&&(h.horizontal[_]=A),V(),hn(P)&&s&&l&&(h.vertical=ii(d,t.glyphMap,t.glyphPositions,t.imagePositions,p,k,a,F,_,T,g,2,!1,I,y,f))}}let b,x=!1;if(c.icon&&c.icon.name){let P=t.imageMap[c.icon.name];P&&(b=yf(t.imagePositions[c.icon.name],n.get("icon-offset").evaluate(c,{},t.canonical),n.get("icon-anchor").evaluate(c,{},t.canonical)),x=!!P.sdf,t.bucket.sdfIcons===void 0?t.bucket.sdfIcons=x:t.bucket.sdfIcons!==x&&fe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(P.pixelRatio!==t.bucket.pixelRatio||n.get("icon-rotate").constantOr(1)!==0)&&(t.bucket.iconsNeedLinear=!0))}let v=Gf(h.horizontal)||h.vertical;t.bucket.iconsInText=v?v.iconsInText:!1,(v||b)&&Db(t.bucket,c,h,b,t.imageMap,o,y,m,g,x,t.canonical)}t.showCollisionBoxes&&t.bucket.generateCollisionDebugBuffers()}function Nf(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Db(t,e,r,n,i,o,a,s,l,u,c){let p=o.textMaxSize.evaluate(e,{});p===void 0&&(p=a);let f=t.layers[0].layout,y=f.get("icon-offset").evaluate(e,{},c),m=Gf(r.horizontal),h=24,d=a/h,g=t.tilePixelRatio*d,b=t.tilePixelRatio*p/h,x=t.tilePixelRatio*s,v=t.tilePixelRatio*f.get("symbol-spacing"),P=f.get("text-padding")*t.tilePixelRatio,w=bf(f,e,c,t.tilePixelRatio),T=f.get("text-max-angle")/180*Math.PI,F=f.get("text-rotation-alignment")!=="viewport"&&f.get("symbol-placement")!=="point",E=f.get("icon-rotation-alignment")==="map"&&f.get("symbol-placement")!=="point",_=f.get("symbol-placement"),I=v/2,k=f.get("icon-text-fit"),V;n&&k!=="none"&&(t.allowVerticalPlacement&&r.vertical&&(V=Qs(n,r.vertical,k,f.get("icon-text-fit-padding"),y,d)),m&&(n=Qs(n,m,k,f.get("icon-text-fit-padding"),y,d)));let A=(z,O)=>{O.x<0||O.x>=8192||O.y<0||O.y>=8192||Bb(t,O,z,r,n,i,V,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,g,[P,P,P,P],F,l,x,w,E,y,e,o,u,c,a)};if(_==="line")for(let z of Bf(e.geometry,0,0,8192,8192)){let O=Df(z,v,T,r.vertical||m,n,h,b,t.overscaling,8192);for(let N of O){let K=m;(!K||!zb(t,K.text,I,N))&&A(z,N)}}else if(_==="line-center"){for(let z of e.geometry)if(z.length>1){let O=Lf(z,T,r.vertical||m,n,h,b);O&&A(z,O)}}else if(e.type==="Polygon")for(let z of Tr(e.geometry,0)){let O=Of(z,16);A(z[0],new rt(O.x,O.y,0))}else if(e.type==="LineString")for(let z of e.geometry)A(z,new rt(z[0].x,z[0].y,0));else if(e.type==="Point")for(let z of e.geometry)for(let O of z)A([O],new rt(O.x,O.y,0))}function Vb(t,e){let r=t.length,n=e==null?void 0:e.values;if((n==null?void 0:n.length)>0)for(let i=0;i<n.length;i+=2){let o=ol[n[i]],a=n[i+1];t.emplaceBack(o,a[0],a[1])}return[r,t.length]}function Uf(t,e,r,n,i,o,a,s,l,u,c,p,f,y,m){let h=Rf(e,r,s,i,o,a,n,t.allowVerticalPlacement),d=t.textSizeData,g=null;d.kind==="source"?(g=[Ct*i.layout.get("text-size").evaluate(a,{})],g[0]>tt&&fe("".concat(t.layerIds[0],': Value for "text-size" is >= ').concat(Vr,'. Reduce your "text-size".'))):d.kind==="composite"&&(g=[Ct*y.compositeTextSizes[0].evaluate(a,{},m),Ct*y.compositeTextSizes[1].evaluate(a,{},m)],(g[0]>tt||g[1]>tt)&&fe("".concat(t.layerIds[0],': Value for "text-size" is >= ').concat(Vr,'. Reduce your "text-size".'))),t.addSymbols(t.text,h,g,s,o,a,u,e,l.lineStartIndex,l.lineLength,f,m);for(let b of c)p[b]=t.text.placedSymbolArray.length-1;return h.length*4}function Gf(t){for(let e in t)return t[e];return null}function Bb(t,e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g,b,x,v,P,w,T,F){let E=t.addToLineVertexArray(e,r),_,I,k,V,A=0,z=0,O=0,N=0,K=-1,xe=-1,X={},le=(0,ll.default)("");if(t.allowVerticalPlacement&&n.vertical){let ve=s.layout.get("text-rotate").evaluate(v,{},T)+90,Ve=n.vertical;k=new or(l,e,u,c,p,Ve,f,y,m,ve),a&&(V=new or(l,e,u,c,p,a,d,g,m,ve))}if(i){let Ie=s.layout.get("icon-rotate").evaluate(v,{}),ve=s.layout.get("icon-text-fit")!=="none",Ve=nl(i,Ie,w,ve),$r=a?nl(a,Ie,w,ve):void 0;I=new or(l,e,u,c,p,i,d,g,!1,Ie),A=Ve.length*4;let Vl=t.iconSizeData,Lt=null;Vl.kind==="source"?(Lt=[Ct*s.layout.get("icon-size").evaluate(v,{})],Lt[0]>tt&&fe("".concat(t.layerIds[0],': Value for "icon-size" is >= ').concat(Vr,'. Reduce your "icon-size".'))):Vl.kind==="composite"&&(Lt=[Ct*P.compositeIconSizes[0].evaluate(v,{},T),Ct*P.compositeIconSizes[1].evaluate(v,{},T)],(Lt[0]>tt||Lt[1]>tt)&&fe("".concat(t.layerIds[0],': Value for "icon-size" is >= ').concat(Vr,'. Reduce your "icon-size".'))),t.addSymbols(t.icon,Ve,Lt,x,b,v,0,e,E.lineStartIndex,E.lineLength,-1,T),K=t.icon.placedSymbolArray.length-1,$r&&(z=$r.length*4,t.addSymbols(t.icon,$r,Lt,x,b,v,2,e,E.lineStartIndex,E.lineLength,-1,T),xe=t.icon.placedSymbolArray.length-1)}let ce=Object.keys(n.horizontal);for(let Ie of ce){let ve=n.horizontal[Ie];if(!_){le=(0,ll.default)(ve.text);let $r=s.layout.get("text-rotate").evaluate(v,{},T);_=new or(l,e,u,c,p,ve,f,y,m,$r)}let Ve=ve.positionedLines.length===1;if(O+=Uf(t,e,ve,o,s,m,v,h,E,n.vertical?1:3,Ve?ce:[Ie],X,K,P,T),Ve)break}n.vertical&&(N+=Uf(t,e,n.vertical,o,s,m,v,h,E,2,["vertical"],X,xe,P,T));let pe=_?_.boxStartIndex:t.collisionBoxArray.length,_e=_?_.boxEndIndex:t.collisionBoxArray.length,be=k?k.boxStartIndex:t.collisionBoxArray.length,Ai=k?k.boxEndIndex:t.collisionBoxArray.length,Da=I?I.boxStartIndex:t.collisionBoxArray.length,Va=I?I.boxEndIndex:t.collisionBoxArray.length,Ur=V?V.boxStartIndex:t.collisionBoxArray.length,_i=V?V.boxEndIndex:t.collisionBoxArray.length,Me=-1,Ft=(Ie,ve)=>Ie&&Ie.circleDiameter?Math.max(Ie.circleDiameter,ve):ve;Me=Ft(_,Me),Me=Ft(k,Me),Me=Ft(I,Me),Me=Ft(V,Me);let Ii=Me>-1?1:0;Ii&&(Me*=F/ne),t.glyphOffsetArray.length>=He.MAX_GLYPHS&&fe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),v.sortKey!==void 0&&t.addToSortKeyRanges(t.symbolInstances.length,v.sortKey);let Ba=sl(s,v,T),[za,Ra]=Vb(t.textAnchorOffsets,Ba);t.symbolInstances.emplaceBack(e.x,e.y,X.right>=0?X.right:-1,X.center>=0?X.center:-1,X.left>=0?X.left:-1,X.vertical||-1,K,xe,le,pe,_e,be,Ai,Da,Va,Ur,_i,u,O,N,A,z,Ii,0,f,Me,za,Ra)}function zb(t,e,r,n){let i=t.compareText;if(!(e in i))i[e]=[];else{let o=i[e];for(let a=o.length-1;a>=0;a--)if(n.dist(o[a])<r)return!0}return i[e].push(n),!1}var ba=1,fi=class{constructor(e){let r={},n=[];for(let s in e){let l=e[s],u=r[s]={};for(let c in l){let p=l[+c];if(!p||p.bitmap.width===0||p.bitmap.height===0)continue;let f={x:0,y:0,w:p.bitmap.width+2*ba,h:p.bitmap.height+2*ba};n.push(f),u[c]={rect:f,metrics:p.metrics}}}let{w:i,h:o}=ti(n),a=new er({width:i||1,height:o||1});for(let s in e){let l=e[s];for(let u in l){let c=l[+u];if(!c||c.bitmap.width===0||c.bitmap.height===0)continue;let p=r[s][u].rect;er.copy(c.bitmap,a,{x:0,y:0},{x:p.x+ba,y:p.y+ba},c.bitmap)}}this.image=a,this.positions=r}};C("GlyphAtlas",fi);function jf(t,e,r){e=Math.pow(2,r)-e-1;var n=qf(t*256,e*256,r),i=qf((t+1)*256,(e+1)*256,r);return n[0]+","+n[1]+","+i[0]+","+i[1]}function qf(t,e,r){var n=2*Math.PI*6378137/256/Math.pow(2,r),i=t*n-2*Math.PI*6378137/2,o=e*n-2*Math.PI*6378137/2;return[i,o]}var Wf=Z(he(),1);var ul=63710088e-1,yi=class t{constructor(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid LngLat object: (".concat(e,", ").concat(r,")"));if(this.lng=+e,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new t(Hl(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}distanceTo(e){let r=Math.PI/180,n=this.lat*r,i=e.lat*r,o=Math.sin(n)*Math.sin(i)+Math.cos(n)*Math.cos(i)*Math.cos((e.lng-this.lng)*r);return ul*Math.acos(Math.min(o,1))}static convert(e){if(e instanceof t)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new t(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new t(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("\`LngLatLike\` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}};var Jf=2*Math.PI*ul;function Zf(t){return Jf*Math.cos(t*Math.PI/180)}function Rb(t){return(180+t)/360}function Ob(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Nb(t,e){return t/Zf(e)}function Ub(t){return t*360-180}function cl(t){let e=180-t*360;return 360/Math.PI*Math.atan(Math.exp(e*Math.PI/180))-90}function $b(t,e){return t*Zf(cl(e))}function Gb(t){return 1/Math.cos(t*Math.PI/180)}var va=class t{constructor(e,r,n=0){this.x=+e,this.y=+r,this.z=+n}static fromLngLat(e,r=0){let n=yi.convert(e);return new t(Rb(n.lng),Ob(n.lat),Nb(r,n.lat))}toLngLat(){return new yi(Ub(this.x),cl(this.y))}toAltitude(){return $b(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Jf*Gb(cl(this.y))}};var Pa=class{constructor(e,r,n){if(e<0||e>25||n<0||n>=Math.pow(2,e)||r<0||r>=Math.pow(2,e))throw new Error("x=".concat(r,", y=").concat(n,", z=").concat(e," outside of bounds. 0<=x<").concat(Math.pow(2,e),", 0<=y<").concat(Math.pow(2,e)," 0<=z<=25 "));this.z=e,this.x=r,this.y=n,this.key=mi(0,e,e,r,n)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,r,n){let i=jf(this.x,this.y,this.z),o=qb(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(n==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,o).replace(/{bbox-epsg-3857}/g,i)}isChildOf(e){let r=this.z-e.z;return r>0&&e.x===this.x>>r&&e.y===this.y>>r}getTilePoint(e){let r=Math.pow(2,this.z);return new Wf.default((e.x*r-this.x)*8192,(e.y*r-this.y)*8192)}toString(){return"".concat(this.z,"/").concat(this.x,"/").concat(this.y)}},pl=class{constructor(e,r){this.wrap=e,this.canonical=r,this.key=mi(e,r.z,r.z,r.x,r.y)}},hi=class t{constructor(e,r,n,i,o){if(e<n)throw new Error("overscaledZ should be >= z; overscaledZ = ".concat(e,"; z = ").concat(n));this.overscaledZ=e,this.wrap=r,this.canonical=new Pa(n,+i,+o),this.key=mi(r,e,n,i,o)}clone(){return new t(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error("targetZ > this.overscaledZ; targetZ = ".concat(e,"; overscaledZ = ").concat(this.overscaledZ));let r=this.canonical.z-e;return e>this.canonical.z?new t(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new t(e,this.wrap,e,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(e,r){if(e>this.overscaledZ)throw new Error("targetZ > this.overscaledZ; targetZ = ".concat(e,"; overscaledZ = ").concat(this.overscaledZ));let n=this.canonical.z-e;return e>this.canonical.z?mi(this.wrap*+r,e,this.canonical.z,this.canonical.x,this.canonical.y):mi(this.wrap*+r,e,e,this.canonical.x>>n,this.canonical.y>>n)}isChildOf(e){if(e.wrap!==this.wrap)return!1;let r=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>r&&e.canonical.y===this.canonical.y>>r}children(e){if(this.overscaledZ>=e)return[new t(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let r=this.canonical.z+1,n=this.canonical.x*2,i=this.canonical.y*2;return[new t(r,this.wrap,r,n,i),new t(r,this.wrap,r,n+1,i),new t(r,this.wrap,r,n,i+1),new t(r,this.wrap,r,n+1,i+1)]}isLessThan(e){return this.wrap<e.wrap?!0:this.wrap>e.wrap?!1:this.overscaledZ<e.overscaledZ?!0:this.overscaledZ>e.overscaledZ?!1:this.canonical.x<e.canonical.x?!0:this.canonical.x>e.canonical.x?!1:this.canonical.y<e.canonical.y}wrapped(){return new t(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new t(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new pl(this.wrap,this.canonical)}toString(){return"".concat(this.overscaledZ,"/").concat(this.canonical.x,"/").concat(this.canonical.y)}getTilePoint(e){return this.canonical.getTilePoint(new va(e.x-this.wrap,e.y))}};function mi(t,e,r,n,i){t*=2,t<0&&(t=t*-1-1);let o=1<<r;return(o*o*t+o*i+n).toString(36)+r.toString(36)+e.toString(36)}function qb(t,e,r){let n="",i;for(let o=t;o>0;o--)i=1<<o-1,n+=(e&i?1:0)+(r&i?2:0);return n}C("CanonicalTileID",Pa);C("OverscaledTileID",hi,{omit:["posMatrix"]});var Sa=class{constructor(e){this.tileID=new hi(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.inFlightDependencies=[]}async parse(e,r,n,i){this.status="parsing",this.data=e,this.collisionBoxArray=new Ln;let o=new Br(Object.keys(e.layers).sort()),a=new ui(this.tileID,this.promoteId);a.bucketLayerIDs=[];let s={},l={featureIndex:a,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:n},u=r.familiesBySource[this.source];for(let P in u){let w=e.layers[P];if(!w)continue;w.version===1&&fe('Vector tile source "'.concat(this.source,'" layer "').concat(P,'" ')+"does not use vector tile spec v2 and therefore may have some rendering errors.");let T=o.encode(P),F=[];for(let E=0;E<w.length;E++){let _=w.feature(E),I=a.getId(_,P);F.push({feature:_,id:I,index:E,sourceLayerIndex:T})}for(let E of u[P]){let _=E[0];if(_.source!==this.source&&fe("layer.source = ".concat(_.source," does not equal this.source = ").concat(this.source)),_.minzoom&&this.zoom<Math.floor(_.minzoom)||_.maxzoom&&this.zoom>=_.maxzoom||_.visibility==="none")continue;fl(E,this.zoom,n),(s[_.id]=_.createBucket({index:a.bucketLayerIDs.length,layers:E,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:T,sourceID:this.source})).populate(F,l,this.tileID.canonical),a.bucketLayerIDs.push(E.map(k=>k.id))}}let c=jr(l.glyphDependencies,P=>Object.keys(P).map(Number));this.inFlightDependencies.forEach(P=>P==null?void 0:P.abort()),this.inFlightDependencies=[];let p=Promise.resolve({});if(Object.keys(c).length){let P=new AbortController;this.inFlightDependencies.push(P),p=i.sendAsync({type:"GG",data:{stacks:c,source:this.source,tileID:this.tileID,type:"glyphs"}},P)}let f=Object.keys(l.iconDependencies),y=Promise.resolve({});if(f.length){let P=new AbortController;this.inFlightDependencies.push(P),y=i.sendAsync({type:"GI",data:{icons:f,source:this.source,tileID:this.tileID,type:"icons"}},P)}let m=Object.keys(l.patternDependencies),h=Promise.resolve({});if(m.length){let P=new AbortController;this.inFlightDependencies.push(P),h=i.sendAsync({type:"GI",data:{icons:m,source:this.source,tileID:this.tileID,type:"patterns"}},P)}let[d,g,b]=await Promise.all([p,y,h]),x=new fi(d),v=new ri(g,b);for(let P in s){let w=s[P];w instanceof He?(fl(w.layers,this.zoom,n),$f({bucket:w,glyphMap:d,glyphPositions:x.positions,imageMap:g,imagePositions:v.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):w.hasPattern&&(w instanceof ir||w instanceof rr||w instanceof nr)&&(fl(w.layers,this.zoom,n),w.addFeatures(l,this.tileID.canonical,v.patternPositions))}return this.status="done",{buckets:Object.values(s).filter(P=>!P.isEmpty()),featureIndex:a,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:x.image,imageAtlas:v,glyphMap:this.returnDependencies?d:null,iconMap:this.returnDependencies?g:null,glyphPositions:this.returnDependencies?x.positions:null}}};function fl(t,e,r){let n=new q(e);for(let i of t)i.recalculate(n,r)}var jb=60,HI=1e3/jb;var Or=class{constructor(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let e=performance.getEntriesByName(this._marks.measure);return e.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),e=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),e}};var Nr=class{constructor(e,r,n){this.actor=e,this.layerIndex=r,this.availableImages=n,this.fetching={},this.loading={},this.loaded={}}async loadVectorTile(e,r){let n=await hc(e.request,r);try{return{vectorTile:new Hf.default.VectorTile(new Xf.default(n.data)),rawData:n.data,cacheControl:n.cacheControl,expires:n.expires}}catch(i){let o=new Uint8Array(n.data),a=o[0]===31&&o[1]===139,s="Unable to parse the tile at ".concat(e.request.url,", ");throw a?s+="please make sure the data is not gzipped and that you have configured the relevant header in the server":s+="got error: ".concat(i.messge),new Error(s)}}async loadTile(e){let r=e.uid,n=e&&e.request&&e.request.collectResourceTiming?new Or(e.request):!1,i=new Sa(e);this.loading[r]=i;let o=new AbortController;i.abort=o;try{let a=await this.loadVectorTile(e,o);if(delete this.loading[r],!a)return null;let s=a.rawData,l={};a.expires&&(l.expires=a.expires),a.cacheControl&&(l.cacheControl=a.cacheControl);let u={};if(n){let p=n.finish();p&&(u.resourceTiming=JSON.parse(JSON.stringify(p)))}i.vectorTile=a.vectorTile;let c=i.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[r]=i,this.fetching[r]={rawTileData:s,cacheControl:l,resourceTiming:u};try{let p=await c;return Pe({rawTileData:s.slice(0)},p,l,u)}finally{delete this.fetching[r]}}catch(a){throw delete this.loading[r],i.status="done",this.loaded[r]=i,a}}async reloadTile(e){let r=e.uid;if(!this.loaded||!this.loaded[r])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");let n=this.loaded[r];if(n.showCollisionBoxes=e.showCollisionBoxes,n.status==="parsing"){let i=await n.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor),o;if(this.fetching[r]){let{rawTileData:a,cacheControl:s,resourceTiming:l}=this.fetching[r];delete this.fetching[r],o=Pe({rawTileData:a.slice(0)},i,s,l)}else o=i;return o}if(n.status==="done"&&n.vectorTile)return n.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor)}async abortTile(e){let r=this.loading,n=e.uid;r&&r[n]&&r[n].abort&&(r[n].abort.abort(),delete r[n])}async removeTile(e){this.loaded&&this.loaded[e.uid]&&delete this.loaded[e.uid]}};var di=class{constructor(e,r,n,i=1,o=1,a=1,s=0){if(this.uid=e,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(n&&!["mapbox","terrarium","custom"].includes(n)){fe('"'.concat(n,'" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".'));return}this.stride=r.height;let l=this.dim=r.height-2;switch(this.data=new Uint32Array(r.data.buffer),n){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=i,this.greenFactor=o,this.blueFactor=a,this.baseShift=s;break;case"mapbox":default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4;break}for(let u=0;u<l;u++)this.data[this._idx(-1,u)]=this.data[this._idx(0,u)],this.data[this._idx(l,u)]=this.data[this._idx(l-1,u)],this.data[this._idx(u,-1)]=this.data[this._idx(u,0)],this.data[this._idx(u,l)]=this.data[this._idx(u,l-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(l,-1)]=this.data[this._idx(l-1,0)],this.data[this._idx(-1,l)]=this.data[this._idx(0,l-1)],this.data[this._idx(l,l)]=this.data[this._idx(l-1,l-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let u=0;u<l;u++)for(let c=0;c<l;c++){let p=this.get(u,c);p>this.max&&(this.max=p),p<this.min&&(this.min=p)}}get(e,r){let n=new Uint8Array(this.data.buffer),i=this._idx(e,r)*4;return this.unpack(n[i],n[i+1],n[i+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,r){if(e<-1||e>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(e+1)}unpack(e,r,n){return e*this.redFactor+r*this.greenFactor+n*this.blueFactor-this.baseShift}getPixels(){return new de({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,r,n){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let i=r*this.dim,o=r*this.dim+this.dim,a=n*this.dim,s=n*this.dim+this.dim;switch(r){case-1:i=o-1;break;case 1:o=i+1;break}switch(n){case-1:a=s-1;break;case 1:s=a+1;break}let l=-r*this.dim,u=-n*this.dim;for(let c=a;c<s;c++)for(let p=i;p<o;p++)this.data[this._idx(p,c)]=e.data[this._idx(p+l,c+u)]}};C("DEMData",di);var wa=class{constructor(){this.loaded={}}async loadTile(e){let{uid:r,encoding:n,rawImageData:i,redFactor:o,greenFactor:a,blueFactor:s,baseShift:l}=e,u=i.width+2,c=i.height+2,p=Jr(i)?new de({width:u,height:c},await eu(i,-1,-1,u,c)):i,f=new di(r,p,n,o,a,s,l);return this.loaded=this.loaded||{},this.loaded[r]=f,f}removeTile(e){let r=this.loaded,n=e.uid;r&&r[n]&&delete r[n]}};var wy=Z(ey(),1);var yl=Z(he(),1),ty=Z(Tt(),1);var Jb=ty.default.VectorTileFeature.prototype.toGeoJSON,ml=class{constructor(e){this._feature=e,this.extent=8192,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))}loadGeometry(){if(this._feature.type===1){let e=[];for(let r of this._feature.geometry)e.push([new yl.default(r[0],r[1])]);return e}else{let e=[];for(let r of this._feature.geometry){let n=[];for(let i of r)n.push(new yl.default(i[0],i[1]));e.push(n)}return e}}toGeoJSON(e,r,n){return Jb.call(this,e,r,n)}},_a=class{constructor(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=8192,this.length=e.length,this._features=e}feature(e){return new ml(this._features[e])}};var Ay=Z(sy(),1);var ly=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],gl=1,xi=8,vi=class t{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[r,n]=new Uint8Array(e,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");let i=n>>4;if(i!==gl)throw new Error("Got v".concat(i," data when expected v").concat(gl,"."));let o=ly[n&15];if(!o)throw new Error("Unrecognized array type.");let[a]=new Uint16Array(e,2,1),[s]=new Uint32Array(e,4,1);return new t(s,a,o,e)}constructor(e,r=64,n=Float64Array,i){if(isNaN(e)||e<0)throw new Error("Unpexpected numItems value: ".concat(e,"."));this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=n,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;let o=ly.indexOf(this.ArrayType),a=e*2*this.ArrayType.BYTES_PER_ELEMENT,s=e*this.IndexArrayType.BYTES_PER_ELEMENT,l=(8-s%8)%8;if(o<0)throw new Error("Unexpected typed array class: ".concat(n,"."));i&&i instanceof ArrayBuffer?(this.data=i,this.ids=new this.IndexArrayType(this.data,xi,e),this.coords=new this.ArrayType(this.data,xi+s+l,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(xi+a+s+l),this.ids=new this.IndexArrayType(this.data,xi,e),this.coords=new this.ArrayType(this.data,xi+s+l,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(gl<<4)+o]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){let n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=e,this.coords[this._pos++]=r,n}finish(){let e=this._pos>>1;if(e!==this.numItems)throw new Error("Added ".concat(e," items when expected ").concat(this.numItems,"."));return bl(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,n,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:o,coords:a,nodeSize:s}=this,l=[0,o.length-1,0],u=[];for(;l.length;){let c=l.pop()||0,p=l.pop()||0,f=l.pop()||0;if(p-f<=s){for(let d=f;d<=p;d++){let g=a[2*d],b=a[2*d+1];g>=e&&g<=n&&b>=r&&b<=i&&u.push(o[d])}continue}let y=f+p>>1,m=a[2*y],h=a[2*y+1];m>=e&&m<=n&&h>=r&&h<=i&&u.push(o[y]),(c===0?e<=m:r<=h)&&(l.push(f),l.push(y-1),l.push(1-c)),(c===0?n>=m:i>=h)&&(l.push(y+1),l.push(p),l.push(1-c))}return u}within(e,r,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:i,coords:o,nodeSize:a}=this,s=[0,i.length-1,0],l=[],u=n*n;for(;s.length;){let c=s.pop()||0,p=s.pop()||0,f=s.pop()||0;if(p-f<=a){for(let d=f;d<=p;d++)uy(o[2*d],o[2*d+1],e,r)<=u&&l.push(i[d]);continue}let y=f+p>>1,m=o[2*y],h=o[2*y+1];uy(m,h,e,r)<=u&&l.push(i[y]),(c===0?e-n<=m:r-n<=h)&&(s.push(f),s.push(y-1),s.push(1-c)),(c===0?e+n>=m:r+n>=h)&&(s.push(y+1),s.push(p),s.push(1-c))}return l}};function bl(t,e,r,n,i,o){if(i-n<=r)return;let a=n+i>>1;cy(t,e,a,n,i,o),bl(t,e,r,n,a-1,1-o),bl(t,e,r,a+1,i,1-o)}function cy(t,e,r,n,i,o){for(;i>n;){if(i-n>600){let u=i-n+1,c=r-n+1,p=Math.log(u),f=.5*Math.exp(2*p/3),y=.5*Math.sqrt(p*f*(u-f)/u)*(c-u/2<0?-1:1),m=Math.max(n,Math.floor(r-c*f/u+y)),h=Math.min(i,Math.floor(r+(u-c)*f/u+y));cy(t,e,r,m,h,o)}let a=e[2*r+o],s=n,l=i;for(bi(t,e,n,r),e[2*i+o]>a&&bi(t,e,n,i);s<l;){for(bi(t,e,s,l),s++,l--;e[2*s+o]<a;)s++;for(;e[2*l+o]>a;)l--}e[2*n+o]===a?bi(t,e,n,l):(l++,bi(t,e,l,i)),l<=r&&(n=l+1),r<=l&&(i=l-1)}}function bi(t,e,r,n){xl(t,r,n),xl(e,2*r,2*n),xl(e,2*r+1,2*n+1)}function xl(t,e,r){let n=t[e];t[e]=t[r],t[r]=n}function uy(t,e,r,n){let i=t-r,o=e-n;return i*i+o*o}var n0={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},py=Math.fround||(t=>e=>(t[0]=+e,t[0]))(new Float32Array(1)),ar=2,Et=3,vl=4,Mt=5,yy=6,Pi=class{constructor(e){this.options=Object.assign(Object.create(n0),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){let{log:r,minZoom:n,maxZoom:i}=this.options;r&&console.time("total time");let o="prepare ".concat(e.length," points");r&&console.time(o),this.points=e;let a=[];for(let l=0;l<e.length;l++){let u=e[l];if(!u.geometry)continue;let[c,p]=u.geometry.coordinates,f=py(Ta(c)),y=py(Ca(p));a.push(f,y,1/0,l,-1,1),this.options.reduce&&a.push(0)}let s=this.trees[i+1]=this._createTree(a);r&&console.timeEnd(o);for(let l=i;l>=n;l--){let u=+Date.now();s=this.trees[l]=this._createTree(this._cluster(s,l)),r&&console.log("z%d: %d clusters in %dms",l,s.numItems,+Date.now()-u)}return r&&console.timeEnd("total time"),this}getClusters(e,r){let n=((e[0]+180)%360+360)%360-180,i=Math.max(-90,Math.min(90,e[1])),o=e[2]===180?180:((e[2]+180)%360+360)%360-180,a=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)n=-180,o=180;else if(n>o){let p=this.getClusters([n,i,180,a],r),f=this.getClusters([-180,i,o,a],r);return p.concat(f)}let s=this.trees[this._limitZoom(r)],l=s.range(Ta(n),Ca(a),Ta(o),Ca(i)),u=s.data,c=[];for(let p of l){let f=this.stride*p;c.push(u[f+Mt]>1?fy(u,f,this.clusterProps):this.points[u[f+Et]])}return c}getChildren(e){let r=this._getOriginId(e),n=this._getOriginZoom(e),i="No cluster with the specified id.",o=this.trees[n];if(!o)throw new Error(i);let a=o.data;if(r*this.stride>=a.length)throw new Error(i);let s=this.options.radius/(this.options.extent*Math.pow(2,n-1)),l=a[r*this.stride],u=a[r*this.stride+1],c=o.within(l,u,s),p=[];for(let f of c){let y=f*this.stride;a[y+vl]===e&&p.push(a[y+Mt]>1?fy(a,y,this.clusterProps):this.points[a[y+Et]])}if(p.length===0)throw new Error(i);return p}getLeaves(e,r,n){r=r||10,n=n||0;let i=[];return this._appendLeaves(i,e,r,n,0),i}getTile(e,r,n){let i=this.trees[this._limitZoom(e)],o=Math.pow(2,e),{extent:a,radius:s}=this.options,l=s/a,u=(n-l)/o,c=(n+1+l)/o,p={features:[]};return this._addTileFeatures(i.range((r-l)/o,u,(r+1+l)/o,c),i.data,r,n,o,p),r===0&&this._addTileFeatures(i.range(1-l/o,u,1,c),i.data,o,n,o,p),r===o-1&&this._addTileFeatures(i.range(0,u,l/o,c),i.data,-1,n,o,p),p.features.length?p:null}getClusterExpansionZoom(e){let r=this._getOriginZoom(e)-1;for(;r<=this.options.maxZoom;){let n=this.getChildren(e);if(r++,n.length!==1)break;e=n[0].properties.cluster_id}return r}_appendLeaves(e,r,n,i,o){let a=this.getChildren(r);for(let s of a){let l=s.properties;if(l&&l.cluster?o+l.point_count<=i?o+=l.point_count:o=this._appendLeaves(e,l.cluster_id,n,i,o):o<i?o++:e.push(s),e.length===n)break}return o}_createTree(e){let r=new vi(e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let n=0;n<e.length;n+=this.stride)r.add(e[n],e[n+1]);return r.finish(),r.data=e,r}_addTileFeatures(e,r,n,i,o,a){for(let s of e){let l=s*this.stride,u=r[l+Mt]>1,c,p,f;if(u)c=my(r,l,this.clusterProps),p=r[l],f=r[l+1];else{let h=this.points[r[l+Et]];c=h.properties;let[d,g]=h.geometry.coordinates;p=Ta(d),f=Ca(g)}let y={type:1,geometry:[[Math.round(this.options.extent*(p*o-n)),Math.round(this.options.extent*(f*o-i))]],tags:c},m;u||this.options.generateId?m=r[l+Et]:m=this.points[r[l+Et]].id,m!==void 0&&(y.id=m),a.features.push(y)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,r){let{radius:n,extent:i,reduce:o,minPoints:a}=this.options,s=n/(i*Math.pow(2,r)),l=e.data,u=[],c=this.stride;for(let p=0;p<l.length;p+=c){if(l[p+ar]<=r)continue;l[p+ar]=r;let f=l[p],y=l[p+1],m=e.within(l[p],l[p+1],s),h=l[p+Mt],d=h;for(let g of m){let b=g*c;l[b+ar]>r&&(d+=l[b+Mt])}if(d>h&&d>=a){let g=f*h,b=y*h,x,v=-1,P=((p/c|0)<<5)+(r+1)+this.points.length;for(let w of m){let T=w*c;if(l[T+ar]<=r)continue;l[T+ar]=r;let F=l[T+Mt];g+=l[T]*F,b+=l[T+1]*F,l[T+vl]=P,o&&(x||(x=this._map(l,p,!0),v=this.clusterProps.length,this.clusterProps.push(x)),o(x,this._map(l,T)))}l[p+vl]=P,u.push(g/d,b/d,1/0,P,-1,d),o&&u.push(v)}else{for(let g=0;g<c;g++)u.push(l[p+g]);if(d>1)for(let g of m){let b=g*c;if(!(l[b+ar]<=r)){l[b+ar]=r;for(let x=0;x<c;x++)u.push(l[b+x])}}}}return u}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,r,n){if(e[r+Mt]>1){let a=this.clusterProps[e[r+yy]];return n?Object.assign({},a):a}let i=this.points[e[r+Et]].properties,o=this.options.map(i);return n&&o===i?Object.assign({},o):o}};function fy(t,e,r){return{type:"Feature",id:t[e+Et],properties:my(t,e,r),geometry:{type:"Point",coordinates:[i0(t[e]),o0(t[e+1])]}}}function my(t,e,r){let n=t[e+Mt],i=n>=1e4?"".concat(Math.round(n/1e3),"k"):n>=1e3?"".concat(Math.round(n/100)/10,"k"):n,o=t[e+yy],a=o===-1?{}:Object.assign({},r[o]);return Object.assign(a,{cluster:!0,cluster_id:t[e+Et],point_count:n,point_count_abbreviated:i})}function Ta(t){return t/360+.5}function Ca(t){let e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function i0(t){return(t-.5)*360}function o0(t){let e=(180-t*360)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function Si(t,e,r,n){for(var i=n,o=r-e>>1,a=r-e,s,l=t[e],u=t[e+1],c=t[r],p=t[r+1],f=e+3;f<r;f+=3){var y=a0(t[f],t[f+1],l,u,c,p);if(y>i)s=f,i=y;else if(y===i){var m=Math.abs(f-o);m<a&&(s=f,a=m)}}i>n&&(s-e>3&&Si(t,e,s,n),t[s+2]=i,r-s>3&&Si(t,s,r,n))}function a0(t,e,r,n,i,o){var a=i-r,s=o-n;if(a!==0||s!==0){var l=((t-r)*a+(e-n)*s)/(a*a+s*s);l>1?(r=i,n=o):l>0&&(r+=a*l,n+=s*l)}return a=t-r,s=e-n,a*a+s*s}function ft(t,e,r,n){var i={id:typeof t>"u"?null:t,type:e,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return s0(i),i}function s0(t){var e=t.geometry,r=t.type;if(r==="Point"||r==="MultiPoint"||r==="LineString")Pl(t,e);else if(r==="Polygon"||r==="MultiLineString")for(var n=0;n<e.length;n++)Pl(t,e[n]);else if(r==="MultiPolygon")for(n=0;n<e.length;n++)for(var i=0;i<e[n].length;i++)Pl(t,e[n][i])}function Pl(t,e){for(var r=0;r<e.length;r+=3)t.minX=Math.min(t.minX,e[r]),t.minY=Math.min(t.minY,e[r+1]),t.maxX=Math.max(t.maxX,e[r]),t.maxY=Math.max(t.maxY,e[r+1])}function Al(t,e){var r=[];if(t.type==="FeatureCollection")for(var n=0;n<t.features.length;n++)ka(r,t.features[n],e,n);else t.type==="Feature"?ka(r,t,e):ka(r,{geometry:t},e);return r}function ka(t,e,r,n){if(e.geometry){var i=e.geometry.coordinates,o=e.geometry.type,a=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),s=[],l=e.id;if(r.promoteId?l=e.properties[r.promoteId]:r.generateId&&(l=n||0),o==="Point")hy(i,s);else if(o==="MultiPoint")for(var u=0;u<i.length;u++)hy(i[u],s);else if(o==="LineString")wl(i,s,a,!1);else if(o==="MultiLineString")if(r.lineMetrics){for(u=0;u<i.length;u++)s=[],wl(i[u],s,a,!1),t.push(ft(l,"LineString",s,e.properties));return}else Sl(i,s,a,!1);else if(o==="Polygon")Sl(i,s,a,!0);else if(o==="MultiPolygon")for(u=0;u<i.length;u++){var c=[];Sl(i[u],c,a,!0),s.push(c)}else if(o==="GeometryCollection"){for(u=0;u<e.geometry.geometries.length;u++)ka(t,{id:l,geometry:e.geometry.geometries[u],properties:e.properties},r,n);return}else throw new Error("Input data is not a valid GeoJSON object.");t.push(ft(l,o,s,e.properties))}}function hy(t,e){e.push(dy(t[0])),e.push(gy(t[1])),e.push(0)}function wl(t,e,r,n){for(var i,o,a=0,s=0;s<t.length;s++){var l=dy(t[s][0]),u=gy(t[s][1]);e.push(l),e.push(u),e.push(0),s>0&&(n?a+=(i*u-l*o)/2:a+=Math.sqrt(Math.pow(l-i,2)+Math.pow(u-o,2))),i=l,o=u}var c=e.length-3;e[2]=1,Si(e,0,c,r),e[c+2]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function Sl(t,e,r,n){for(var i=0;i<t.length;i++){var o=[];wl(t[i],o,r,n),e.push(o)}}function dy(t){return t/360+.5}function gy(t){var e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function qe(t,e,r,n,i,o,a,s){if(r/=e,n/=e,o>=r&&a<n)return t;if(a<r||o>=n)return null;for(var l=[],u=0;u<t.length;u++){var c=t[u],p=c.geometry,f=c.type,y=i===0?c.minX:c.minY,m=i===0?c.maxX:c.maxY;if(y>=r&&m<n){l.push(c);continue}else if(m<r||y>=n)continue;var h=[];if(f==="Point"||f==="MultiPoint")l0(p,h,r,n,i);else if(f==="LineString")by(p,h,r,n,i,!1,s.lineMetrics);else if(f==="MultiLineString")_l(p,h,r,n,i,!1);else if(f==="Polygon")_l(p,h,r,n,i,!0);else if(f==="MultiPolygon")for(var d=0;d<p.length;d++){var g=[];_l(p[d],g,r,n,i,!0),g.length&&h.push(g)}if(h.length){if(s.lineMetrics&&f==="LineString"){for(d=0;d<h.length;d++)l.push(ft(c.id,f,h[d],c.tags));continue}(f==="LineString"||f==="MultiLineString")&&(h.length===1?(f="LineString",h=h[0]):f="MultiLineString"),(f==="Point"||f==="MultiPoint")&&(f=h.length===3?"Point":"MultiPoint"),l.push(ft(c.id,f,h,c.tags))}}return l.length?l:null}function l0(t,e,r,n,i){for(var o=0;o<t.length;o+=3){var a=t[o+i];a>=r&&a<=n&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}function by(t,e,r,n,i,o,a){for(var s=xy(t),l=i===0?u0:c0,u=t.start,c,p,f=0;f<t.length-3;f+=3){var y=t[f],m=t[f+1],h=t[f+2],d=t[f+3],g=t[f+4],b=i===0?y:m,x=i===0?d:g,v=!1;a&&(c=Math.sqrt(Math.pow(y-d,2)+Math.pow(m-g,2))),b<r?x>r&&(p=l(s,y,m,d,g,r),a&&(s.start=u+c*p)):b>n?x<n&&(p=l(s,y,m,d,g,n),a&&(s.start=u+c*p)):Il(s,y,m,h),x<r&&b>=r&&(p=l(s,y,m,d,g,r),v=!0),x>n&&b<=n&&(p=l(s,y,m,d,g,n),v=!0),!o&&v&&(a&&(s.end=u+c*p),e.push(s),s=xy(t)),a&&(u+=c)}var P=t.length-3;y=t[P],m=t[P+1],h=t[P+2],b=i===0?y:m,b>=r&&b<=n&&Il(s,y,m,h),P=s.length-3,o&&P>=3&&(s[P]!==s[0]||s[P+1]!==s[1])&&Il(s,s[0],s[1],s[2]),s.length&&e.push(s)}function xy(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function _l(t,e,r,n,i,o){for(var a=0;a<t.length;a++)by(t[a],e,r,n,i,o,!1)}function Il(t,e,r,n){t.push(e),t.push(r),t.push(n)}function u0(t,e,r,n,i,o){var a=(o-e)/(n-e);return t.push(o),t.push(r+(i-r)*a),t.push(1),a}function c0(t,e,r,n,i,o){var a=(o-r)/(i-r);return t.push(e+(n-e)*a),t.push(o),t.push(1),a}function Cl(t,e){var r=e.buffer/e.extent,n=t,i=qe(t,1,-1-r,r,0,-1,2,e),o=qe(t,1,1-r,2+r,0,-1,2,e);return(i||o)&&(n=qe(t,1,-r,1+r,0,-1,2,e)||[],i&&(n=vy(i,1).concat(n)),o&&(n=n.concat(vy(o,-1)))),n}function vy(t,e){for(var r=[],n=0;n<t.length;n++){var i=t[n],o=i.type,a;if(o==="Point"||o==="MultiPoint"||o==="LineString")a=Tl(i.geometry,e);else if(o==="MultiLineString"||o==="Polygon"){a=[];for(var s=0;s<i.geometry.length;s++)a.push(Tl(i.geometry[s],e))}else if(o==="MultiPolygon")for(a=[],s=0;s<i.geometry.length;s++){for(var l=[],u=0;u<i.geometry[s].length;u++)l.push(Tl(i.geometry[s][u],e));a.push(l)}r.push(ft(i.id,o,a,i.tags))}return r}function Tl(t,e){var r=[];r.size=t.size,t.start!==void 0&&(r.start=t.start,r.end=t.end);for(var n=0;n<t.length;n+=3)r.push(t[n]+e,t[n+1],t[n+2]);return r}function Ma(t,e){if(t.transformed)return t;var r=1<<t.z,n=t.x,i=t.y,o,a,s;for(o=0;o<t.features.length;o++){var l=t.features[o],u=l.geometry,c=l.type;if(l.geometry=[],c===1)for(a=0;a<u.length;a+=2)l.geometry.push(Py(u[a],u[a+1],e,r,n,i));else for(a=0;a<u.length;a++){var p=[];for(s=0;s<u[a].length;s+=2)p.push(Py(u[a][s],u[a][s+1],e,r,n,i));l.geometry.push(p)}}return t.transformed=!0,t}function Py(t,e,r,n,i,o){return[Math.round(r*(t*n-i)),Math.round(r*(e*n-o))]}function Ml(t,e,r,n,i){for(var o=e===i.maxZoom?0:i.tolerance/((1<<e)*i.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,p0(a,t[s],o,i);var l=t[s].minX,u=t[s].minY,c=t[s].maxX,p=t[s].maxY;l<a.minX&&(a.minX=l),u<a.minY&&(a.minY=u),c>a.maxX&&(a.maxX=c),p>a.maxY&&(a.maxY=p)}return a}function p0(t,e,r,n){var i=e.geometry,o=e.type,a=[];if(o==="Point"||o==="MultiPoint")for(var s=0;s<i.length;s+=3)a.push(i[s]),a.push(i[s+1]),t.numPoints++,t.numSimplified++;else if(o==="LineString")kl(a,i,t,r,!1,!1);else if(o==="MultiLineString"||o==="Polygon")for(s=0;s<i.length;s++)kl(a,i[s],t,r,o==="Polygon",s===0);else if(o==="MultiPolygon")for(var l=0;l<i.length;l++){var u=i[l];for(s=0;s<u.length;s++)kl(a,u[s],t,r,!0,s===0)}if(a.length){var c=e.tags||null;if(o==="LineString"&&n.lineMetrics){c={};for(var p in e.tags)c[p]=e.tags[p];c.mapbox_clip_start=i.start/i.size,c.mapbox_clip_end=i.end/i.size}var f={geometry:a,type:o==="Polygon"||o==="MultiPolygon"?3:o==="LineString"||o==="MultiLineString"?2:1,tags:c};e.id!==null&&(f.id=e.id),t.features.push(f)}}function kl(t,e,r,n,i,o){var a=n*n;if(n>0&&e.size<(i?a:n)){r.numPoints+=e.length/3;return}for(var s=[],l=0;l<e.length;l+=3)(n===0||e[l+2]>a)&&(r.numSimplified++,s.push(e[l]),s.push(e[l+1])),r.numPoints++;i&&f0(s,o),t.push(s)}function f0(t,e){for(var r=0,n=0,i=t.length,o=i-2;n<i;o=n,n+=2)r+=(t[n]-t[o])*(t[n+1]+t[o+1]);if(r>0===e)for(n=0,i=t.length;n<i/2;n+=2){var a=t[n],s=t[n+1];t[n]=t[i-2-n],t[n+1]=t[i-1-n],t[i-2-n]=a,t[i-1-n]=s}}function Fl(t,e){return new Ea(t,e)}function Ea(t,e){e=this.options=y0(Object.create(this.options),e);var r=e.debug;if(r&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=Al(t,e);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),n=Cl(n,e),n.length&&this.splitTile(n,0,0,0),r&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}Ea.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};Ea.prototype.splitTile=function(t,e,r,n,i,o,a){for(var s=[t,e,r,n],l=this.options,u=l.debug;s.length;){n=s.pop(),r=s.pop(),e=s.pop(),t=s.pop();var c=1<<e,p=El(e,r,n),f=this.tiles[p];if(!f&&(u>1&&console.time("creation"),f=this.tiles[p]=Ml(t,e,r,n,l),this.tileCoords.push({z:e,x:r,y:n}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,r,n,f.numFeatures,f.numPoints,f.numSimplified),console.timeEnd("creation"));var y="z"+e;this.stats[y]=(this.stats[y]||0)+1,this.total++}if(f.source=t,i){if(e===l.maxZoom||e===i)continue;var m=1<<i-e;if(r!==Math.floor(o/m)||n!==Math.floor(a/m))continue}else if(e===l.indexMaxZoom||f.numPoints<=l.indexMaxPoints)continue;if(f.source=null,t.length!==0){u>1&&console.time("clipping");var h=.5*l.buffer/l.extent,d=.5-h,g=.5+h,b=1+h,x,v,P,w,T,F;x=v=P=w=null,T=qe(t,c,r-h,r+g,0,f.minX,f.maxX,l),F=qe(t,c,r+d,r+b,0,f.minX,f.maxX,l),t=null,T&&(x=qe(T,c,n-h,n+g,1,f.minY,f.maxY,l),v=qe(T,c,n+d,n+b,1,f.minY,f.maxY,l),T=null),F&&(P=qe(F,c,n-h,n+g,1,f.minY,f.maxY,l),w=qe(F,c,n+d,n+b,1,f.minY,f.maxY,l),F=null),u>1&&console.timeEnd("clipping"),s.push(x||[],e+1,r*2,n*2),s.push(v||[],e+1,r*2,n*2+1),s.push(P||[],e+1,r*2+1,n*2),s.push(w||[],e+1,r*2+1,n*2+1)}}};Ea.prototype.getTile=function(t,e,r){var n=this.options,i=n.extent,o=n.debug;if(t<0||t>24)return null;var a=1<<t;e=(e%a+a)%a;var s=El(t,e,r);if(this.tiles[s])return Ma(this.tiles[s],i);o>1&&console.log("drilling down to z%d-%d-%d",t,e,r);for(var l=t,u=e,c=r,p;!p&&l>0;)l--,u=Math.floor(u/2),c=Math.floor(c/2),p=this.tiles[El(l,u,c)];return!p||!p.source?null:(o>1&&console.log("found parent tile z%d-%d-%d",l,u,c),o>1&&console.time("drilling down"),this.splitTile(p.source,l,u,c,t,e,r),o>1&&console.timeEnd("drilling down"),this.tiles[s]?Ma(this.tiles[s],i):null)};function El(t,e,r){return((1<<t)*r+e)*32+t}function y0(t,e){for(var r in e)t[r]=e[r];return t}function wi(t,e){return e?t.properties[e]:t.id}function Ll(t,e){if(t==null)return!0;if(t.type==="Feature")return wi(t,e)!=null;if(t.type==="FeatureCollection"){let r=new Set;for(let n of t.features){let i=wi(n,e);if(i==null||r.has(i))return!1;r.add(i)}return!0}return!1}function Dl(t,e){let r=new Map;if(t!=null)if(t.type==="Feature")r.set(wi(t,e),t);else for(let n of t.features)r.set(wi(n,e),n);return r}function Sy(t,e,r){var n,i,o,a;if(e.removeAll&&t.clear(),e.remove)for(let s of e.remove)t.delete(s);if(e.add)for(let s of e.add){let l=wi(s,r);l!=null&&t.set(l,s)}if(e.update)for(let s of e.update){let l=t.get(s.id);if(l==null)continue;let u=s.newGeometry||s.removeAllProperties,c=!s.removeAllProperties&&(((n=s.removeProperties)==null?void 0:n.length)>0||((i=s.addOrUpdateProperties)==null?void 0:i.length)>0);if((u||c)&&(l=Dt({},l),t.set(s.id,l),c&&(l.properties=Dt({},l.properties))),s.newGeometry&&(l.geometry=s.newGeometry),s.removeAllProperties)l.properties={};else if(((o=s.removeProperties)==null?void 0:o.length)>0)for(let p of s.removeProperties)Object.prototype.hasOwnProperty.call(l.properties,p)&&delete l.properties[p];if(((a=s.addOrUpdateProperties)==null?void 0:a.length)>0)for(let{key:p,value:f}of s.addOrUpdateProperties)l.properties[p]=f}}var Fa=class extends Nr{constructor(){super(...arguments);this._dataUpdateable=new Map}async loadVectorTile(r,n){let i=r.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");let o=this._geoJSONIndex.getTile(i.z,i.x,i.y);if(!o)return null;let a=new _a(o.features),s=(0,Ay.default)(a);return(s.byteOffset!==0||s.byteLength!==s.buffer.byteLength)&&(s=new Uint8Array(s)),{vectorTile:a,rawData:s.buffer}}async loadData(r){var i;(i=this._pendingRequest)==null||i.abort();let n=r&&r.request&&r.request.collectResourceTiming?new Or(r.request):!1;this._pendingRequest=new AbortController;try{let o=await this.loadGeoJSON(r,this._pendingRequest);if(delete this._pendingRequest,typeof o!="object")throw new Error("Input data given to '".concat(r.source,"' is not a valid GeoJSON object."));if((0,wy.default)(o,!0),r.filter){let s=jt(r.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(s.result==="error")throw new Error(s.value.map(u=>"".concat(u.key,": ").concat(u.message)).join(", "));o={type:"FeatureCollection",features:o.features.filter(u=>s.value.evaluate({zoom:0},u))}}this._geoJSONIndex=r.cluster?new Pi(m0(r)).load(o.features):Fl(o,r.geojsonVtOptions),this.loaded={};let a={};if(n){let s=n.finish();s&&(a.resourceTiming={},a.resourceTiming[r.source]=JSON.parse(JSON.stringify(s)))}return a}catch(o){if(delete this._pendingRequest,ac(o))return{abandoned:!0};throw o}}reloadTile(r){let n=this.loaded,i=r.uid;return n&&n[i]?super.reloadTile(r):this.loadTile(r)}async loadGeoJSON(r,n){let{promoteId:i}=r;if(r.request){let o=await mc(r.request,n);return this._dataUpdateable=Ll(o.data,i)?Dl(o.data,i):void 0,o.data}if(typeof r.data=="string")try{let o=JSON.parse(r.data);return this._dataUpdateable=Ll(o,i)?Dl(o,i):void 0,o}catch(o){throw new Error("Input data given to '".concat(r.source,"' is not a valid GeoJSON object."))}if(!r.dataDiff)throw new Error("Input data given to '".concat(r.source,"' is not a valid GeoJSON object."));if(!this._dataUpdateable)throw new Error("Cannot update existing geojson data in ".concat(r.source));return Sy(this._dataUpdateable,r.dataDiff,i),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}async removeSource(r){this._pendingRequest&&this._pendingRequest.abort()}getClusterExpansionZoom(r){return this._geoJSONIndex.getClusterExpansionZoom(r.clusterId)}getClusterChildren(r){return this._geoJSONIndex.getChildren(r.clusterId)}getClusterLeaves(r){return this._geoJSONIndex.getLeaves(r.clusterId,r.limit,r.offset)}};function m0({superclusterOptions:t,clusterProperties:e}){if(!e||!t)return t;let r={},n={},i={accumulated:null,zoom:0},o={properties:null},a=Object.keys(e);for(let s of a){let[l,u]=e[s],c=jt(u),p=jt(typeof l=="string"?[l,["accumulated"],["get",s]]:l);r[s]=c.value,n[s]=p.value}return t.map=s=>{o.properties=s;let l={};for(let u of a)l[u]=r[u].evaluate(i,o);return l},t.reduce=(s,l)=>{o.properties=l;for(let u of a)i.accumulated=s[u],s[u]=n[u].evaluate(i,o)},t}var La=class{constructor(e){this.self=e,this.actor=new io(e),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(r,n)=>{if(this.externalWorkerSourceTypes[r])throw new Error('Worker source with name "'.concat(r,'" already registered.'));this.externalWorkerSourceTypes[r]=n},this.self.addProtocol=lc,this.self.removeProtocol=uc,this.self.registerRTLTextPlugin=r=>{if(ye.isParsed())throw new Error("RTL text plugin already registered.");ye.setMethods(r)},this.actor.registerMessageHandler("LDT",(r,n)=>this._getDEMWorkerSource(r,n.source).loadTile(n)),this.actor.registerMessageHandler("RDT",async(r,n)=>{this._getDEMWorkerSource(r,n.source).removeTile(n)}),this.actor.registerMessageHandler("GCEZ",async(r,n)=>this._getWorkerSource(r,n.type,n.source).getClusterExpansionZoom(n)),this.actor.registerMessageHandler("GCC",async(r,n)=>this._getWorkerSource(r,n.type,n.source).getClusterChildren(n)),this.actor.registerMessageHandler("GCL",async(r,n)=>this._getWorkerSource(r,n.type,n.source).getClusterLeaves(n)),this.actor.registerMessageHandler("LD",(r,n)=>this._getWorkerSource(r,n.type,n.source).loadData(n)),this.actor.registerMessageHandler("LT",(r,n)=>this._getWorkerSource(r,n.type,n.source).loadTile(n)),this.actor.registerMessageHandler("RT",(r,n)=>this._getWorkerSource(r,n.type,n.source).reloadTile(n)),this.actor.registerMessageHandler("AT",(r,n)=>this._getWorkerSource(r,n.type,n.source).abortTile(n)),this.actor.registerMessageHandler("RMT",(r,n)=>this._getWorkerSource(r,n.type,n.source).removeTile(n)),this.actor.registerMessageHandler("RS",async(r,n)=>{if(!this.workerSources[r]||!this.workerSources[r][n.type]||!this.workerSources[r][n.type][n.source])return;let i=this.workerSources[r][n.type][n.source];delete this.workerSources[r][n.type][n.source],i.removeSource!==void 0&&i.removeSource(n)}),this.actor.registerMessageHandler("RM",async r=>{delete this.layerIndexes[r],delete this.availableImages[r],delete this.workerSources[r],delete this.demWorkerSources[r]}),this.actor.registerMessageHandler("SR",async(r,n)=>{this.referrer=n}),this.actor.registerMessageHandler("SRPS",(r,n)=>this._syncRTLPluginState(r,n)),this.actor.registerMessageHandler("IS",async(r,n)=>{this.self.importScripts(n)}),this.actor.registerMessageHandler("SI",(r,n)=>this._setImages(r,n)),this.actor.registerMessageHandler("UL",async(r,n)=>{this._getLayerIndex(r).update(n.layers,n.removedIds)}),this.actor.registerMessageHandler("SL",async(r,n)=>{this._getLayerIndex(r).replace(n)})}async _setImages(e,r){this.availableImages[e]=r;for(let n in this.workerSources[e]){let i=this.workerSources[e][n];for(let o in i)i[o].availableImages=r}}async _syncRTLPluginState(e,r){if(ye.isParsed())return ye.getState();if(r.pluginStatus!=="loading")return ye.setState(r),r;let n=r.pluginURL;if(this.self.importScripts(n),ye.isParsed()){let o={pluginStatus:"loaded",pluginURL:n};return ye.setState(o),o}throw ye.setState({pluginStatus:"error",pluginURL:""}),new Error("RTL Text Plugin failed to import scripts from ".concat(n))}_getAvailableImages(e){let r=this.availableImages[e];return r||(r=[]),r}_getLayerIndex(e){let r=this.layerIndexes[e];return r||(r=this.layerIndexes[e]=new ya),r}_getWorkerSource(e,r,n){if(this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][r]||(this.workerSources[e][r]={}),!this.workerSources[e][r][n]){let i={sendAsync:(o,a)=>(o.targetMapId=e,this.actor.sendAsync(o,a))};switch(r){case"vector":this.workerSources[e][r][n]=new Nr(i,this._getLayerIndex(e),this._getAvailableImages(e));break;case"geojson":this.workerSources[e][r][n]=new Fa(i,this._getLayerIndex(e),this._getAvailableImages(e));break;default:this.workerSources[e][r][n]=new this.externalWorkerSourceTypes[r](i,this._getLayerIndex(e),this._getAvailableImages(e));break}}return this.workerSources[e][r][n]}_getDEMWorkerSource(e,r){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][r]||(this.demWorkerSources[e][r]=new wa),this.demWorkerSources[e][r]}};at(self)&&(self.worker=new La(self));})();
/*! Bundled license information:

ieee754/index.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)
*/
`,u1e=l(()=>_s.WORKER_URL?_s.WORKER_URL:URL.createObjectURL(new Blob([l1e],{type:"text/javascript"})),"getWorkerURL");function JX(){return new Worker(u1e())}l(JX,"workerFactory");var hL="maplibre_preloaded_worker_pool",KX=class QX{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<QX.workerCount;)this.workers.push(JX());return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(t=>{t.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[hL]}numActive(){return Object.keys(this.active).length}};l(KX,"WorkerPool");var EA=KX,h1e=Math.floor(Mn.hardwareConcurrency/2);EA.workerCount=az(globalThis)?Math.max(Math.min(h1e,3),1):1;var jv;function IA(){return jv||(jv=new EA),jv}l(IA,"getGlobalWorkerPool");function c1e(){IA().acquire(hL)}l(c1e,"prewarm");function p1e(){let i=jv;i&&(i.isPreloaded()&&i.numActive()===1?(i.release(hL),jv=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))}l(p1e,"clearPrewarmedResources");var eZ=class{constructor(e,t){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=t;let n=this.workerPool.acquire(t);for(let r=0;r<n.length;r++){let a=n[r],o=new s1e(a,t);o.name="Worker ".concat(r),this.actors.push(o)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,t){let n=[];for(let r of this.actors)n.push(r.sendAsync({type:e,data:t}));return Promise.all(n)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(t=>{t.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,t){for(let n of this.actors)n.registerMessageHandler(e,t)}};l(eZ,"Dispatcher");var tZ=eZ,g_;function cL(){return g_||(g_=new tZ(IA(),ZC),g_.registerMessageHandler("GR",(i,e,t)=>Kw(e,t))),g_}l(cL,"getGlobalDispatcher");R();function iZ(i,e){let t=Qt.create();return Qt.translate(t,t,[1,1,0]),Qt.scale(t,t,[i.width*.5,i.height*.5,1]),Qt.multiply(t,t,i.calculatePosMatrix(e.toUnwrapped()))}l(iZ,"getPixelPosMatrix");function nZ(i,e,t){if(i)for(let n of i){let r=e[n];if(r&&r.source===t&&r.type==="fill-extrusion")return!0}else for(let n in e){let r=e[n];if(r.source===t&&r.type==="fill-extrusion")return!0}return!1}l(nZ,"queryIncludes3DLayer");function rZ(i,e,t,n,r,a){let o=nZ(r&&r.layers,e,i.id),s=a.maxPitchScaleFactor(),u=i.tilesIn(n,s,o);u.sort(pL);let h=[];for(let f of u)h.push({wrappedTileID:f.tileID.wrapped().key,queryResults:f.tile.queryRenderedFeatures(e,t,i._state,f.queryGeometry,f.cameraQueryGeometry,f.scale,r,a,s,iZ(i.transform,f.tileID))});let d=sZ(h);for(let f in d)d[f].forEach(m=>{let v=m.feature,b=i.getFeatureState(v.layer["source-layer"],v.id);v.source=v.layer.source,v.layer["source-layer"]&&(v.sourceLayer=v.layer["source-layer"]),v.state=b});return d}l(rZ,"queryRenderedFeatures");function aZ(i,e,t,n,r,a,o){let s={},u=a.queryRenderedSymbols(n),h=[];for(let d of Object.keys(u).map(Number))h.push(o[d]);h.sort(pL);for(let d of h){let f=d.featureIndex.lookupSymbolFeatures(u[d.bucketInstanceId],e,d.bucketIndex,d.sourceLayerIndex,r.filter,r.layers,r.availableImages,i);for(let m in f){let v=s[m]=s[m]||[],b=f[m];b.sort((w,A)=>{let E=d.featureSortOrder;if(E){let I=E.indexOf(w.featureIndex);return E.indexOf(A.featureIndex)-I}else return A.featureIndex-w.featureIndex});for(let w of b)v.push(w)}}for(let d in s)s[d].forEach(f=>{let m=f.feature,v=i[d],b=t[v.source].getFeatureState(m.layer["source-layer"],m.id);m.source=m.layer.source,m.layer["source-layer"]&&(m.sourceLayer=m.layer["source-layer"]),m.state=b});return s}l(aZ,"queryRenderedSymbols");function oZ(i,e){let t=i.getRenderableIds().map(a=>i.getTileByID(a)),n=[],r={};for(let a=0;a<t.length;a++){let o=t[a],s=o.tileID.canonical.key;r[s]||(r[s]=!0,o.querySourceFeatures(n,e))}return n}l(oZ,"querySourceFeatures");function pL(i,e){let t=i.tileID,n=e.tileID;return t.overscaledZ-n.overscaledZ||t.canonical.y-n.canonical.y||t.wrap-n.wrap||t.canonical.x-n.canonical.x}l(pL,"sortTilesIn");function sZ(i){let e={},t={};for(let n of i){let r=n.queryResults,a=n.wrappedTileID,o=t[a]=t[a]||{};for(let s in r){let u=r[s],h=o[s]=o[s]||{},d=e[s]=e[s]||[];for(let f of u)h[f.featureIndex]||(h[f.featureIndex]=!0,d.push(f))}}return e}l(sZ,"mergeRenderedFeatureLayers");R();R();R();R();async function dL(i,e,t){let n=i;if(i.url?n=(await Qw(e.transformRequest(i.url,"Source"),t)).data:await Mn.frameAsync(t),!n)return null;let r=J1(ti(n,i),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in n&&n.vector_layers&&(r.vectorLayerIds=n.vector_layers.map(a=>a.id)),r}l(dL,"loadTileJson");R();R();R();var fL=63710088e-1,lZ=class $y{constructor(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: (".concat(e,", ").concat(t,")"));if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new $y(Kp(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}distanceTo(e){let t=Math.PI/180,n=this.lat*t,r=e.lat*t,a=Math.sin(n)*Math.sin(r)+Math.cos(n)*Math.cos(r)*Math.cos((e.lng-this.lng)*t);return fL*Math.acos(Math.min(a,1))}static convert(e){if(e instanceof $y)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new $y(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new $y(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}};l(lZ,"LngLat");var on=lZ,uZ=class bf{constructor(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof on?new on(e.lng,e.lat):on.convert(e),this}setSouthWest(e){return this._sw=e instanceof on?new on(e.lng,e.lat):on.convert(e),this}extend(e){let t=this._sw,n=this._ne,r,a;if(e instanceof on)r=e,a=e;else if(e instanceof bf){if(r=e._sw,a=e._ne,!r||!a)return this}else{if(Array.isArray(e))if(e.length===4||e.every(Array.isArray)){let o=e;return this.extend(bf.convert(o))}else{let o=e;return this.extend(on.convert(o))}else if(e&&("lng"in e||"lon"in e)&&"lat"in e)return this.extend(on.convert(e));return this}return!t&&!n?(this._sw=new on(r.lng,r.lat),this._ne=new on(a.lng,a.lat)):(t.lng=Math.min(r.lng,t.lng),t.lat=Math.min(r.lat,t.lat),n.lng=Math.max(a.lng,n.lng),n.lat=Math.max(a.lat,n.lat)),this}getCenter(){return new on((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new on(this.getWest(),this.getNorth())}getSouthEast(){return new on(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return"LngLatBounds(".concat(this._sw.toString(),", ").concat(this._ne.toString(),")")}isEmpty(){return!(this._sw&&this._ne)}contains(e){let{lng:t,lat:n}=on.convert(e),r=this._sw.lat<=n&&n<=this._ne.lat,a=this._sw.lng<=t&&t<=this._ne.lng;return this._sw.lng>this._ne.lng&&(a=this._sw.lng>=t&&t>=this._ne.lng),r&&a}static convert(e){return e instanceof bf||!e?e:new bf(e)}static fromLngLat(e,t=0){let n=360*t/40075017,r=n/Math.cos(Math.PI/180*e.lat);return new bf(new on(e.lng-r,e.lat-n),new on(e.lng+r,e.lat+n))}};l(uZ,"LngLatBounds");var Uc=uZ;R();var hZ=2*Math.PI*fL;function mL(i){return hZ*Math.cos(i*Math.PI/180)}l(mL,"circumferenceAtLatitude");function ad(i){return(180+i)/360}l(ad,"mercatorXfromLng");function od(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}l(od,"mercatorYfromLat");function sw(i,e){return i/mL(e)}l(sw,"mercatorZfromAltitude");function cZ(i){return i*360-180}l(cZ,"lngFromMercatorX");function lw(i){let e=180-i*360;return 360/Math.PI*Math.atan(Math.exp(e*Math.PI/180))-90}l(lw,"latFromMercatorY");function pZ(i,e){return i*mL(lw(e))}l(pZ,"altitudeFromMercatorZ");function dZ(i){return 1/Math.cos(i*Math.PI/180)}l(dZ,"mercatorScale");var fZ=class mZ{constructor(e,t,n=0){this.x=+e,this.y=+t,this.z=+n}static fromLngLat(e,t=0){let n=on.convert(e);return new mZ(ad(n.lng),od(n.lat),sw(t,n.lat))}toLngLat(){return new on(cZ(this.x),lw(this.y))}toAltitude(){return pZ(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/hZ*dZ(lw(this.y))}};l(fZ,"MercatorCoordinate");var $a=fZ,gZ=class{constructor(e,t,n){this.bounds=Uc.convert(this.validateBounds(e)),this.minzoom=t||0,this.maxzoom=n||24}validateBounds(e){return!Array.isArray(e)||e.length!==4?[-180,-90,180,90]:[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]}contains(e){let t=Math.pow(2,e.z),n={minX:Math.floor(ad(this.bounds.getWest())*t),minY:Math.floor(od(this.bounds.getNorth())*t),maxX:Math.ceil(ad(this.bounds.getEast())*t),maxY:Math.ceil(od(this.bounds.getSouth())*t)};return e.x>=n.minX&&e.x<n.maxX&&e.y>=n.minY&&e.y<n.maxY}};l(gZ,"TileBounds");var yZ=gZ,vZ=class extends uo{constructor(e,t,n,r){if(super(),this.id=e,this.dispatcher=n,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,ti(this,J1(t,["url","scheme","tileSize","promoteId"])),this._options=ti({type:"vector"},t),this._collectResourceTiming=t.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(r)}async load(){this._loaded=!1,this.fire(new Tt("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let e=await dL(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(ti(this,e),e.bounds&&(this.tileBounds=new yZ(e.bounds,this.minzoom,this.maxzoom)),this.fire(new Tt("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Tt("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new ki(e))}}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return ti({},this._options)}async loadTile(e){let t=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),n={request:this.map._requestManager.transformRequest(t,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};n.request.collectResourceTiming=this._collectResourceTiming;let r="RT";if(!e.actor||e.state==="expired")e.actor=this.dispatcher.getActor(),r="LT";else if(e.state==="loading")return new Promise((a,o)=>{e.reloadPromise={resolve:a,reject:o}});e.abortController=new AbortController;try{let a=await e.actor.sendAsync({type:r,data:n},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,a)}catch(a){if(delete e.abortController,e.aborted)return;if(a&&a.status!==404)throw a;this._afterTileLoadWorkerResponse(e,null)}}_afterTileLoadWorkerResponse(e,t){if(t&&t.resourceTiming&&(e.resourceTiming=t.resourceTiming),t&&this.map._refreshExpiredTiles&&e.setExpiryData(t),e.loadVectorData(t,this.map.painter),e.reloadPromise){let n=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(n.resolve).catch(n.reject)}}async abortTile(e){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&await e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}})}async unloadTile(e){e.unloadVectorData(),e.actor&&await e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})}hasTransition(){return!1}};l(vZ,"VectorTileSource");var d1e=vZ;R();var _Z=class extends uo{constructor(e,t,n,r){super(),this.id=e,this.dispatcher=n,this.setEventedParent(r),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=ti({type:"raster"},t),ti(this,J1(t,["url","scheme","tileSize"]))}async load(){this._loaded=!1,this.fire(new Tt("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let e=await dL(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,e&&(ti(this,e),e.bounds&&(this.tileBounds=new yZ(e.bounds,this.minzoom,this.maxzoom)),this.fire(new Tt("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Tt("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new ki(e))}}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return ti({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}async loadTile(e){let t=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{let n=await tu.getImage(this.map._requestManager.transformRequest(t,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted){e.state="unloaded";return}if(n&&n.data){this.map._refreshExpiredTiles&&n.cacheControl&&n.expires&&e.setExpiryData({cacheControl:n.cacheControl,expires:n.expires});let r=this.map.painter.context,a=r.gl,o=n.data;e.texture=this.map.painter.getTileTexture(o.width),e.texture?e.texture.update(o,{useMipmap:!0}):(e.texture=new Aa(r,o,a.RGBA,{useMipmap:!0}),e.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),r.extTextureFilterAnisotropic&&a.texParameterf(a.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax)),e.state="loaded"}}catch(n){if(delete e.abortController,e.aborted)e.state="unloaded";else if(n)throw e.state="errored",n}}async abortTile(e){e.abortController&&(e.abortController.abort(),delete e.abortController)}async unloadTile(e){e.texture&&this.map.painter.saveTileTexture(e.texture)}hasTransition(){return!1}};l(_Z,"RasterTileSource");var xZ=_Z;R();R();R();function bZ(i,e,t){e=Math.pow(2,t)-e-1;var n=H3(i*256,e*256,t),r=H3((i+1)*256,(e+1)*256,t);return n[0]+","+n[1]+","+r[0]+","+r[1]}l(bZ,"getTileBBox");function H3(i,e,t){var n=2*Math.PI*6378137/256/Math.pow(2,t),r=i*n-2*Math.PI*6378137/2,a=e*n-2*Math.PI*6378137/2;return[r,a]}l(H3,"getMercCoords");var f1e=ii(Rn(),1),wZ=class{constructor(e,t,n){if(e<0||e>25||n<0||n>=Math.pow(2,e)||t<0||t>=Math.pow(2,e))throw new Error("x=".concat(t,", y=").concat(n,", z=").concat(e," outside of bounds. 0<=x<").concat(Math.pow(2,e),", 0<=y<").concat(Math.pow(2,e)," 0<=z<=25 "));this.z=e,this.x=t,this.y=n,this.key=qm(0,e,e,t,n)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,t,n){let r=bZ(this.x,this.y,this.z),a=MZ(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(n==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,t>1?"@2x":"").replace(/{quadkey}/g,a).replace(/{bbox-epsg-3857}/g,r)}isChildOf(e){let t=this.z-e.z;return t>0&&e.x===this.x>>t&&e.y===this.y>>t}getTilePoint(e){let t=Math.pow(2,this.z);return new f1e.default((e.x*t-this.x)*8192,(e.y*t-this.y)*8192)}toString(){return"".concat(this.z,"/").concat(this.x,"/").concat(this.y)}};l(wZ,"CanonicalTileID");var gL=wZ,AZ=class{constructor(e,t){this.wrap=e,this.canonical=t,this.key=qm(e,t.z,t.z,t.x,t.y)}};l(AZ,"UnwrappedTileID");var W3=AZ,SZ=class Qs{constructor(e,t,n,r,a){if(e<n)throw new Error("overscaledZ should be >= z; overscaledZ = ".concat(e,"; z = ").concat(n));this.overscaledZ=e,this.wrap=t,this.canonical=new gL(n,+r,+a),this.key=qm(t,e,n,r,a)}clone(){return new Qs(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error("targetZ > this.overscaledZ; targetZ = ".concat(e,"; overscaledZ = ").concat(this.overscaledZ));let t=this.canonical.z-e;return e>this.canonical.z?new Qs(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Qs(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)}calculateScaledKey(e,t){if(e>this.overscaledZ)throw new Error("targetZ > this.overscaledZ; targetZ = ".concat(e,"; overscaledZ = ").concat(this.overscaledZ));let n=this.canonical.z-e;return e>this.canonical.z?qm(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):qm(this.wrap*+t,e,e,this.canonical.x>>n,this.canonical.y>>n)}isChildOf(e){if(e.wrap!==this.wrap)return!1;let t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t}children(e){if(this.overscaledZ>=e)return[new Qs(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let t=this.canonical.z+1,n=this.canonical.x*2,r=this.canonical.y*2;return[new Qs(t,this.wrap,t,n,r),new Qs(t,this.wrap,t,n+1,r),new Qs(t,this.wrap,t,n,r+1),new Qs(t,this.wrap,t,n+1,r+1)]}isLessThan(e){return this.wrap<e.wrap?!0:this.wrap>e.wrap?!1:this.overscaledZ<e.overscaledZ?!0:this.overscaledZ>e.overscaledZ?!1:this.canonical.x<e.canonical.x?!0:this.canonical.x>e.canonical.x?!1:this.canonical.y<e.canonical.y}wrapped(){return new Qs(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Qs(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new W3(this.wrap,this.canonical)}toString(){return"".concat(this.overscaledZ,"/").concat(this.canonical.x,"/").concat(this.canonical.y)}getTilePoint(e){return this.canonical.getTilePoint(new $a(e.x-this.wrap,e.y))}};l(SZ,"OverscaledTileID");var ls=SZ;function qm(i,e,t,n,r){i*=2,i<0&&(i=i*-1-1);let a=1<<t;return(a*a*i+a*r+n).toString(36)+t.toString(36)+e.toString(36)}l(qm,"calculateKey");function MZ(i,e,t){let n="",r;for(let a=i;a>0;a--)r=1<<a-1,n+=(e&r?1:0)+(t&r?2:0);return n}l(MZ,"getQuadkey");Zt("CanonicalTileID",gL);Zt("OverscaledTileID",ls,{omit:["posMatrix"]});R();var CZ=class{constructor(e,t,n,r=1,a=1,o=1,s=0){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(n&&!["mapbox","terrarium","custom"].includes(n)){lo('"'.concat(n,'" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".'));return}this.stride=t.height;let u=this.dim=t.height-2;switch(this.data=new Uint32Array(t.data.buffer),n){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=r,this.greenFactor=a,this.blueFactor=o,this.baseShift=s;break;case"mapbox":default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4;break}for(let h=0;h<u;h++)this.data[this._idx(-1,h)]=this.data[this._idx(0,h)],this.data[this._idx(u,h)]=this.data[this._idx(u-1,h)],this.data[this._idx(h,-1)]=this.data[this._idx(h,0)],this.data[this._idx(h,u)]=this.data[this._idx(h,u-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(u,-1)]=this.data[this._idx(u-1,0)],this.data[this._idx(-1,u)]=this.data[this._idx(0,u-1)],this.data[this._idx(u,u)]=this.data[this._idx(u-1,u-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let h=0;h<u;h++)for(let d=0;d<u;d++){let f=this.get(h,d);f>this.max&&(this.max=f),f<this.min&&(this.min=f)}}get(e,t){let n=new Uint8Array(this.data.buffer),r=this._idx(e,t)*4;return this.unpack(n[r],n[r+1],n[r+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)}unpack(e,t,n){return e*this.redFactor+t*this.greenFactor+n*this.blueFactor-this.baseShift}getPixels(){return new Or({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,t,n){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let r=t*this.dim,a=t*this.dim+this.dim,o=n*this.dim,s=n*this.dim+this.dim;switch(t){case-1:r=a-1;break;case 1:a=r+1;break}switch(n){case-1:o=s-1;break;case 1:s=o+1;break}let u=-t*this.dim,h=-n*this.dim;for(let d=o;d<s;d++)for(let f=r;f<a;f++)this.data[this._idx(f,d)]=e.data[this._idx(f+u,d+h)]}};l(CZ,"DEMData");var m1e=CZ;Zt("DEMData",m1e);var EZ=class extends xZ{constructor(e,t,n,r){super(e,t,n,r),this.type="raster-dem",this.maxzoom=22,this._options=ti({type:"raster-dem"},t),this.encoding=t.encoding||"mapbox",this.redFactor=t.redFactor,this.greenFactor=t.greenFactor,this.blueFactor=t.blueFactor,this.baseShift=t.baseShift}async loadTile(e){let t=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),n=this.map._requestManager.transformRequest(t,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{let r=await tu.getImage(n,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted){e.state="unloaded";return}if(r&&r.data){let a=r.data;this.map._refreshExpiredTiles&&r.cacheControl&&r.expires&&e.setExpiryData({cacheControl:r.cacheControl,expires:r.expires});let o=eu(a)&&e5()?a:await this.readImageNow(a),s={type:this.type,uid:e.uid,source:this.id,rawImageData:o,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();let u=await e.actor.sendAsync({type:"LDT",data:s});e.dem=u,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(r){if(delete e.abortController,e.aborted)e.state="unloaded";else if(r)throw e.state="errored",r}}async readImageNow(e){if(typeof VideoFrame<"u"&&ZB()){let t=e.width+2,n=e.height+2;try{return new Or({width:t,height:n},await sz(e,-1,-1,t,n))}catch{}}return Mn.getImageData(e,1)}_getNeighboringTiles(e){let t=e.canonical,n=Math.pow(2,t.z),r=(t.x-1+n)%n,a=t.x===0?e.wrap-1:e.wrap,o=(t.x+1+n)%n,s=t.x+1===n?e.wrap+1:e.wrap,u={};return u[new ls(e.overscaledZ,a,t.z,r,t.y).key]={backfilled:!1},u[new ls(e.overscaledZ,s,t.z,o,t.y).key]={backfilled:!1},t.y>0&&(u[new ls(e.overscaledZ,a,t.z,r,t.y-1).key]={backfilled:!1},u[new ls(e.overscaledZ,e.wrap,t.z,t.x,t.y-1).key]={backfilled:!1},u[new ls(e.overscaledZ,s,t.z,o,t.y-1).key]={backfilled:!1}),t.y+1<n&&(u[new ls(e.overscaledZ,a,t.z,r,t.y+1).key]={backfilled:!1},u[new ls(e.overscaledZ,e.wrap,t.z,t.x,t.y+1).key]={backfilled:!1},u[new ls(e.overscaledZ,s,t.z,o,t.y+1).key]={backfilled:!1}),u}async unloadTile(e){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&await e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}})}};l(EZ,"RasterDEMTileSource");var g1e=EZ;R();var IZ=class extends uo{constructor(e,t,n,r){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=n.getActor(),this.setEventedParent(r),this._data=t.data,this._options=ti({},t),this._collectResourceTiming=t.collectResourceTiming,t.maxzoom!==void 0&&(this.maxzoom=t.maxzoom),t.type&&(this.type=t.type),t.attribution&&(this.attribution=t.attribution),this.promoteId=t.promoteId;let a=8192/this.tileSize;this.workerOptions=ti({source:this.id,cluster:t.cluster||!1,geojsonVtOptions:{buffer:(t.buffer!==void 0?t.buffer:128)*a,tolerance:(t.tolerance!==void 0?t.tolerance:.375)*a,extent:8192,maxZoom:this.maxzoom,lineMetrics:t.lineMetrics||!1,generateId:t.generateId||!1},superclusterOptions:{maxZoom:t.clusterMaxZoom!==void 0?t.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,t.clusterMinPoints||2),extent:8192,radius:(t.clusterRadius||50)*a,log:!1,generateId:t.generateId||!1},clusterProperties:t.clusterProperties,filter:t.filter},t.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}async load(){await this._updateWorkerData()}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=e.clusterRadius),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,t,n){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:t,offset:n}})}async _updateWorkerData(e){let t=ti({type:this.type},this.workerOptions);e?t.dataDiff=e:typeof this._data=="string"?(t.request=this.map._requestManager.transformRequest(Mn.resolveURL(this._data),"Source"),t.request.collectResourceTiming=this._collectResourceTiming):t.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new Tt("dataloading",{dataType:"source"}));try{let n=await this.actor.sendAsync({type:"LD",data:t});if(this._pendingLoads--,this._removed||n.abandoned){this.fire(new Tt("dataabort",{dataType:"source"}));return}let r=null;n.resourceTiming&&n.resourceTiming[this.id]&&(r=n.resourceTiming[this.id].slice(0));let a={dataType:"source"};this._collectResourceTiming&&r&&r.length>0&&ti(a,{resourceTiming:r}),this.fire(new Tt("data",lt(Me({},a),{sourceDataType:"metadata"}))),this.fire(new Tt("data",lt(Me({},a),{sourceDataType:"content"})))}catch(n){if(this._pendingLoads--,this._removed){this.fire(new Tt("dataabort",{dataType:"source"}));return}this.fire(new ki(n))}}loaded(){return this._pendingLoads===0}async loadTile(e){let t=e.actor?"RT":"LT";e.actor=this.actor;let n={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};e.abortController=new AbortController;let r=await this.actor.sendAsync({type:t,data:n},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(r,this.map.painter,t==="RT")}async abortTile(e){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0}async unloadTile(e){e.unloadVectorData(),await this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return ti({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}};l(IZ,"GeoJSONSource");var y1e=IZ;R();R();R();var TA=Ir([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),TZ=class extends uo{constructor(e,t,n,r){super(),this.id=e,this.dispatcher=n,this.coordinates=t.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(r),this.options=t}async load(e){this._loaded=!1,this.fire(new Tt("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{let t=await tu.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,t&&t.data&&(this.image=t.data,e&&(this.coordinates=e),this._finishLoading())}catch(t){this._request=null,this._loaded=!0,this.fire(new ki(t))}}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Tt("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;let t=e.map($a.fromLngLat);this.tileID=PZ(t),this.minzoom=this.maxzoom=this.tileID.z;let n=t.map(r=>this.tileID.getTilePoint(r)._round());return this._boundsArray=new RG,this._boundsArray.emplaceBack(n[0].x,n[0].y,0,0),this._boundsArray.emplaceBack(n[1].x,n[1].y,8192,0),this._boundsArray.emplaceBack(n[3].x,n[3].y,0,8192),this._boundsArray.emplaceBack(n[2].x,n[2].y,8192,8192),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new Tt("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;let e=this.map.painter.context,t=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,TA.members)),this.boundsSegments||(this.boundsSegments=$r.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Aa(e,this.image,t.RGBA),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE));let n=!1;for(let r in this.tiles){let a=this.tiles[r];a.state!=="loaded"&&(a.state="loaded",a.texture=this.texture,n=!0)}n&&this.fire(new Tt("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}async loadTile(e){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}};l(TZ,"ImageSource");var h1=TZ;function PZ(i){let e=1/0,t=1/0,n=-1/0,r=-1/0;for(let d of i)e=Math.min(e,d.x),t=Math.min(t,d.y),n=Math.max(n,d.x),r=Math.max(r,d.y);let a=n-e,o=r-t,s=Math.max(a,o),u=Math.max(0,Math.floor(-Math.log(s)/Math.LN2)),h=Math.pow(2,u);return new gL(u,Math.floor((e+n)/2*h),Math.floor((t+r)/2*h))}l(PZ,"getCoordinatesCenterTileID");var LZ=class extends h1{constructor(e,t,n,r){super(e,t,n,r),this.roundZoom=!0,this.type="video",this.options=t}async load(){this._loaded=!1;let e=this.options;this.urls=[];for(let t of e.urls)this.urls.push(this.map._requestManager.transformRequest(t,"Source").url);try{let t=await bme(this.urls);if(this._loaded=!0,!t)return;this.video=t,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(t){this.fire(new ki(t))}}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){let t=this.video.seekable;e<t.start(0)||e>t.end(0)?this.fire(new ki(new Rt("sources.".concat(this.id),null,"Playback for this video can be set only between the ".concat(t.start(0)," and ").concat(t.end(0),"-second mark.")))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;let e=this.map.painter.context,t=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,TA.members)),this.boundsSegments||(this.boundsSegments=$r.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,this.video)):(this.texture=new Aa(e,this.video,t.RGBA),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE));let n=!1;for(let r in this.tiles){let a=this.tiles[r];a.state!=="loaded"&&(a.state="loaded",a.texture=this.texture,n=!0)}n&&this.fire(new Tt("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}};l(LZ,"VideoSource");var v1e=LZ;R();var DZ=class extends h1{constructor(e,t,n,r){super(e,t,n,r),t.coordinates?(!Array.isArray(t.coordinates)||t.coordinates.length!==4||t.coordinates.some(a=>!Array.isArray(a)||a.length!==2||a.some(o=>typeof o!="number")))&&this.fire(new ki(new Rt("sources.".concat(e),null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new ki(new Rt("sources.".concat(e),null,'missing required property "coordinates"'))),t.animate&&typeof t.animate!="boolean"&&this.fire(new ki(new Rt("sources.".concat(e),null,'optional "animate" property must be a boolean value'))),t.canvas?typeof t.canvas!="string"&&!(t.canvas instanceof HTMLCanvasElement)&&this.fire(new ki(new Rt("sources.".concat(e),null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new ki(new Rt("sources.".concat(e),null,'missing required property "canvas"'))),this.options=t,this.animate=t.animate!==void 0?t.animate:!0}async load(){if(this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()){this.fire(new ki(new Error("Canvas dimensions cannot be less than or equal to zero.")));return}this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading()}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;let t=this.map.painter.context,n=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,TA.members)),this.boundsSegments||(this.boundsSegments=$r.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Aa(t,this.canvas,n.RGBA,{premultiply:!0});let r=!1;for(let a in this.tiles){let o=this.tiles[a];o.state!=="loaded"&&(o.state="loaded",o.texture=this.texture,r=!0)}r&&this.fire(new Tt("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(let e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}};l(DZ,"CanvasSource");var _1e=DZ,kZ={},x1e=l((i,e,t,n)=>{let r=RZ(e.type),a=new r(i,e,t,n);if(a.id!==i)throw new Error("Expected Source id to be ".concat(i," instead of ").concat(a.id));return a},"create"),RZ=l(i=>{switch(i){case"geojson":return y1e;case"image":return h1;case"raster":return xZ;case"raster-dem":return g1e;case"vector":return d1e;case"video":return v1e;case"canvas":return _1e}return kZ[i]},"getSourceType"),b1e=l((i,e)=>{kZ[i]=e},"setSourceType"),EDe=l(async(i,e)=>{if(RZ(i))throw new Error('A source type called "'.concat(i,'" already exists.'));b1e(i,e)},"addSourceType");R();R();function OZ(i,e){let t={};if(!e)return t;for(let n of i){let r=n.layerIds.map(a=>e.getLayer(a)).filter(Boolean);if(r.length!==0){n.layers=r,n.stateDependentLayerIds&&(n.stateDependentLayers=n.stateDependentLayerIds.map(a=>r.filter(o=>o.id===a)[0]));for(let a of r)t[a.id]=n}}return t}l(OZ,"deserialize");R();R();var NZ=class{constructor(e){this._stringToNumber={},this._numberToString=[];for(let t=0;t<e.length;t++){let n=e[t];this._stringToNumber[n]=t,this._numberToString[t]=n}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error("Out of bounds. Index requested n=".concat(e," can't be >= this._numberToString.length ").concat(this._numberToString.length));return this._numberToString[e]}};l(NZ,"DictionaryCoder");var w1e=NZ,A1e=ii(Zw(),1),S1e=ii(qB(),1);R();var FZ=class{constructor(e,t,n,r,a){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=n,e._y=r,this.properties=e.properties,this.id=a}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){let e={geometry:this.geometry};for(let t in this)t==="_geometry"||t==="_vectorTileFeature"||(e[t]=this[t]);return e}};l(FZ,"GeoJSONFeature");var BZ=FZ,zZ=class{constructor(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new A3(8192,16,0),this.grid3D=new A3(8192,16,0),this.featureIndexArray=new PG,this.promoteId=t}insert(e,t,n,r,a,o){let s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,r,a);let u=o?this.grid3D:this.grid;for(let h=0;h<t.length;h++){let d=t[h],f=[1/0,1/0,-1/0,-1/0];for(let m=0;m<d.length;m++){let v=d[m];f[0]=Math.min(f[0],v.x),f[1]=Math.min(f[1],v.y),f[2]=Math.max(f[2],v.x),f[3]=Math.max(f[3],v.y)}f[0]<8192&&f[1]<8192&&f[2]>=0&&f[3]>=0&&u.insert(s,f[0],f[1],f[2],f[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new A1e.default.VectorTile(new S1e.default(this.rawTileData)).layers,this.sourceLayerCoder=new w1e(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,t,n,r){this.loadVTLayers();let a=e.params||{},o=8192/e.tileSize/e.scale,s=iw(a.filter),u=e.queryGeometry,h=e.queryPadding*o,d=X3(u),f=this.grid.query(d.minX-h,d.minY-h,d.maxX+h,d.maxY+h),m=X3(e.cameraQueryGeometry),v=this.grid3D.query(m.minX-h,m.minY-h,m.maxX+h,m.maxY+h,(A,E,I,C)=>M$(e.cameraQueryGeometry,A-h,E-h,I+h,C+h));for(let A of v)f.push(A);f.sort(UZ);let b={},w;for(let A=0;A<f.length;A++){let E=f[A];if(E===w)continue;w=E;let I=this.featureIndexArray.get(E),C=null;this.loadMatchingFeature(b,I.bucketIndex,I.sourceLayerIndex,I.featureIndex,s,a.layers,a.availableImages,t,n,r,(T,k,F)=>(C||(C=Wc(T)),k.queryIntersectsFeature(u,T,F,C,this.z,e.transform,o,e.pixelPosMatrix)))}return b}loadMatchingFeature(e,t,n,r,a,o,s,u,h,d,f){let m=this.bucketLayerIDs[t];if(o&&!ez(o,m))return;let v=this.sourceLayerCoder.decode(n),b=this.vtLayers[v].feature(r);if(a.needGeometry){let A=qc(b,!0);if(!a.filter(new fa(this.tileID.overscaledZ),A,this.tileID.canonical))return}else if(!a.filter(new fa(this.tileID.overscaledZ),b))return;let w=this.getId(b,v);for(let A=0;A<m.length;A++){let E=m[A];if(o&&o.indexOf(E)<0)continue;let I=u[E];if(!I)continue;let C={};w&&d&&(C=d.getState(I.sourceLayer||"_geojsonTileLayer",w));let T=ti({},h[E]);T.paint=q3(T.paint,I.paint,b,C,s),T.layout=q3(T.layout,I.layout,b,C,s);let k=!f||f(b,I,C);if(!k)continue;let F=new BZ(b,this.z,this.x,this.y,w);F.layer=T;let B=e[E];B===void 0&&(B=e[E]=[]),B.push({featureIndex:r,feature:F,intersectionZ:k})}}lookupSymbolFeatures(e,t,n,r,a,o,s,u){let h={};this.loadVTLayers();let d=iw(a);for(let f of e)this.loadMatchingFeature(h,n,r,f,d,o,s,u,t);return h}hasLayer(e){for(let t of this.bucketLayerIDs)for(let n of t)if(e===n)return!0;return!1}getId(e,t){let n=e.id;if(this.promoteId){let r=typeof this.promoteId=="string"?this.promoteId:this.promoteId[t];n=e.properties[r],typeof n=="boolean"&&(n=Number(n))}return n}};l(zZ,"FeatureIndex");var M1e=zZ;Zt("FeatureIndex",M1e,{omit:["rawTileData","sourceLayerCoder"]});function q3(i,e,t,n,r){return Jw(i,(a,o)=>{let s=e instanceof gA?e.get(o):null;return s&&s.evaluate?s.evaluate(t,n,r):s})}l(q3,"evaluateProperties");function X3(i){let e=1/0,t=1/0,n=-1/0,r=-1/0;for(let a of i)e=Math.min(e,a.x),t=Math.min(t,a.y),n=Math.max(n,a.x),r=Math.max(r,a.y);return{minX:e,minY:t,maxX:n,maxY:r}}l(X3,"getBounds");function UZ(i,e){return e-i}l(UZ,"topDownFeatureComparator");R();R();var Z3="RTLPluginLoaded",VZ=class extends uo{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=cL()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(t=>{throw this.status="error",t})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}async setRTLTextPlugin(e,t=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=Mn.resolveURL(e),!this.url)throw new Error("requested url ".concat(e," is invalid"));if(this.status==="unavailable")if(t)this.status="deferred",this._syncState(this.status);else return this._requestImport();else if(this.status==="requested")return this._requestImport()}async _requestImport(){await this._syncState("loading"),this.status="loaded",this.fire(new Tt(Z3))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}};l(VZ,"RTLMainThreadPlugin");var C1e=VZ,eM=null;function _g(){return eM||(eM=new C1e),eM}l(_g,"rtlMainThreadPluginFactory");var E1e=3e4,jZ=class{constructor(e,t){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=t5(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){let t=e+this.timeAdded;t<this.fadeEndTime||(this.fadeEndTime=t)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,t,n){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",!e){this.collisionBoxArray=new hG;return}e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=OZ(e.buckets,t.style),this.hasSymbolBuckets=!1;for(let r in this.buckets){let a=this.buckets[r];if(a instanceof vg)if(this.hasSymbolBuckets=!0,n)a.justReloaded=!0;else break}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(let r in this.buckets){let a=this.buckets[r];if(a instanceof vg&&a.hasRTLText){this.hasRTLText=!0,_g().lazyLoad();break}}this.queryPadding=0;for(let r in this.buckets){let a=this.buckets[r];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(r).queryRadius(a))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}unloadVectorData(){for(let e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(let n in this.buckets){let r=this.buckets[n];r.uploadPending()&&r.upload(e)}let t=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Aa(e,this.imageAtlas.image,t.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Aa(e,this.glyphAtlasImage,t.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,t,n,r,a,o,s,u,h,d){return!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData?{}:this.latestFeatureIndex.query({queryGeometry:r,cameraQueryGeometry:a,scale:o,tileSize:this.tileSize,pixelPosMatrix:d,transform:u,params:s,queryPadding:this.queryPadding*h},e,t,n)}querySourceFeatures(e,t){let n=this.latestFeatureIndex;if(!n||!n.rawTileData)return;let r=n.loadVTLayers(),a=t&&t.sourceLayer?t.sourceLayer:"",o=r._geojsonTileLayer||r[a];if(!o)return;let s=iw(t&&t.filter),{z:u,x:h,y:d}=this.tileID.canonical,f={z:u,x:h,y:d};for(let m=0;m<o.length;m++){let v=o.feature(m);if(s.needGeometry){let A=qc(v,!0);if(!s.filter(new fa(this.tileID.overscaledZ),A,this.tileID.canonical))continue}else if(!s.filter(new fa(this.tileID.overscaledZ),v))continue;let b=n.getId(v,a),w=new BZ(v,u,h,d,b);w.tile=f,e.push(w)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){let t=this.expirationTime;if(e.cacheControl){let n=rz(e.cacheControl);n["max-age"]&&(this.expirationTime=Date.now()+n["max-age"]*1e3)}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){let n=Date.now(),r=!1;if(this.expirationTime>n)r=!1;else if(!t)r=!0;else if(this.expirationTime<t)r=!0;else{let a=this.expirationTime-t;a?this.expirationTime=n+Math.max(a,E1e):r=!0}r?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,t){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;let n=this.latestFeatureIndex.loadVTLayers();for(let r in this.buckets){if(!t.style.hasLayer(r))continue;let a=this.buckets[r],o=a.layers[0].sourceLayer||"_geojsonTileLayer",s=n[o],u=e[o];if(!s||!u||Object.keys(u).length===0)continue;a.update(u,s,this.imageAtlas&&this.imageAtlas.patternPositions||{});let h=t&&t.style&&t.style.getLayer(r);h&&(this.queryPadding=Math.max(this.queryPadding,h.queryRadius(a)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Mn.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Mn.now()+e}setDependencies(e,t){let n={};for(let r of t)n[r]=!0;this.dependencies[e]=n}hasDependency(e,t){for(let n of e){let r=this.dependencies[n];if(r){for(let a of t)if(r[a])return!0}}return!1}};l(jZ,"Tile");var GZ=jZ;R();var $Z=class{constructor(e,t){this.max=e,this.onRemove=t,this.reset()}reset(){for(let e in this.data)for(let t of this.data[e])t.timeout&&clearTimeout(t.timeout),this.onRemove(t.value);return this.data={},this.order=[],this}add(e,t,n){let r=e.wrapped().key;this.data[r]===void 0&&(this.data[r]=[]);let a={value:t,timeout:void 0};if(n!==void 0&&(a.timeout=setTimeout(()=>{this.remove(e,a)},n)),this.data[r].push(a),this.order.push(r),this.order.length>this.max){let o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){let t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value}getByKey(e){let t=this.data[e];return t?t[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,t){if(!this.has(e))return this;let n=e.wrapped().key,r=t===void 0?0:this.data[n].indexOf(t),a=this.data[n][r];return this.data[n].splice(r,1),a.timeout&&clearTimeout(a.timeout),this.data[n].length===0&&delete this.data[n],this.onRemove(a.value),this.order.splice(this.order.indexOf(n),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){let t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}filter(e){let t=[];for(let n in this.data)for(let r of this.data[n])e(r.value)||t.push(r);for(let n of t)this.remove(n.value.tileID,n)}};l($Z,"TileCache");var I1e=$Z,hR=ii(Rn(),1);R();var HZ=class{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,t,n){let r=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][r]=this.stateChanges[e][r]||{},ti(this.stateChanges[e][r],n),this.deletedStates[e]===null){this.deletedStates[e]={};for(let a in this.state[e])a!==r&&(this.deletedStates[e][a]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][r]===null){this.deletedStates[e][r]={};for(let a in this.state[e][r])n[a]||(this.deletedStates[e][r][a]=null)}else for(let a in n)this.deletedStates[e]&&this.deletedStates[e][r]&&this.deletedStates[e][r][a]===null&&delete this.deletedStates[e][r][a]}removeFeatureState(e,t,n){if(this.deletedStates[e]===null)return;let r=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},n&&t!==void 0)this.deletedStates[e][r]!==null&&(this.deletedStates[e][r]=this.deletedStates[e][r]||{},this.deletedStates[e][r][n]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][r]){this.deletedStates[e][r]={};for(n in this.stateChanges[e][r])this.deletedStates[e][r][n]=null}else this.deletedStates[e][r]=null;else this.deletedStates[e]=null}getState(e,t){let n=String(t),r=this.state[e]||{},a=this.stateChanges[e]||{},o=ti({},r[n],a[n]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){let s=this.deletedStates[e][t];if(s===null)return{};for(let u in s)delete o[u]}return o}initializeTileState(e,t){e.setFeatureState(this.state,t)}coalesceChanges(e,t){let n={};for(let r in this.stateChanges){this.state[r]=this.state[r]||{};let a={};for(let o in this.stateChanges[r])this.state[r][o]||(this.state[r][o]={}),ti(this.state[r][o],this.stateChanges[r][o]),a[o]=this.state[r][o];n[r]=a}for(let r in this.deletedStates){this.state[r]=this.state[r]||{};let a={};if(this.deletedStates[r]===null)for(let o in this.state[r])a[o]={},this.state[r][o]={};else for(let o in this.deletedStates[r]){if(this.deletedStates[r][o]===null)this.state[r][o]={};else for(let s of Object.keys(this.deletedStates[r][o]))delete this.state[r][o][s];a[o]=this.state[r][o]}n[r]=n[r]||{},ti(n[r],a)}if(this.stateChanges={},this.deletedStates={},Object.keys(n).length!==0)for(let r in e)e[r].setFeatureState(n,t)}};l(HZ,"SourceFeatureState");var T1e=HZ,WZ=class Hy extends uo{constructor(e,t,n){super(),this.id=e,this.dispatcher=n,this.on("data",r=>this._dataHandler(r)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=x1e(e,t,n,this),this._tiles={},this._cache=new I1e(0,r=>this._unloadTile(r)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new T1e,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if((this.used!==void 0||this.usedForTerrain!==void 0)&&!this.used&&!this.usedForTerrain)return!0;if(!this._updated)return!1;for(let e in this._tiles){let t=this._tiles[e];if(t.state!=="loaded"&&t.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;let e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}async _loadTile(e,t,n){try{await this._source.loadTile(e),this._tileLoaded(e,t,n)}catch(r){e.state="errored",r.status!==404?this._source.fire(new ki(r,{tile:e})):this.update(this.transform,this.terrain)}}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new Tt("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(let t in this._tiles){let n=this._tiles[t];n.upload(e),n.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(Y3).map(e=>e.key)}getRenderableIds(e){let t=[];for(let n in this._tiles)this._isIdRenderable(n,e)&&t.push(this._tiles[n]);return e?t.sort((n,r)=>{let a=n.tileID,o=r.tileID,s=new hR.default(a.canonical.x,a.canonical.y)._rotate(this.transform.angle),u=new hR.default(o.canonical.x,o.canonical.y)._rotate(this.transform.angle);return a.overscaledZ-o.overscaledZ||u.y-s.y||u.x-s.x}).map(n=>n.tileID.key):t.map(n=>n.tileID).sort(Y3).map(n=>n.key)}hasRenderableParent(e){let t=this.findLoadedParent(e,0);return t?this._isIdRenderable(t.tileID.key):!1}_isIdRenderable(e,t){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(t||!this._tiles[e].holdingForFade())}reload(){if(this._paused){this._shouldReloadOnResume=!0;return}this._cache.reset();for(let e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(e,"reloading")}async _reloadTile(e,t){let n=this._tiles[e];n&&(n.state!=="loading"&&(n.state=t),await this._loadTile(n,e,t))}_tileLoaded(e,t,n){e.timeAdded=Mn.now(),n==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(t,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new Tt("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){let t=this.getRenderableIds();for(let r=0;r<t.length;r++){let a=t[r];if(e.neighboringTiles&&e.neighboringTiles[a]){let o=this.getTileByID(a);n(e,o),n(o,e)}}function n(r,a){r.needsHillshadePrepare=!0,r.needsTerrainPrepare=!0;let o=a.tileID.canonical.x-r.tileID.canonical.x,s=a.tileID.canonical.y-r.tileID.canonical.y,u=Math.pow(2,r.tileID.canonical.z),h=a.tileID.key;o===0&&s===0||Math.abs(s)>1||(Math.abs(o)>1&&(Math.abs(o+u)===1?o+=u:Math.abs(o-u)===1&&(o-=u)),!(!a.dem||!r.dem)&&(r.dem.backfillBorder(a.dem,o,s),r.neighboringTiles&&r.neighboringTiles[h]&&(r.neighboringTiles[h].backfilled=!0)))}l(n,"fillBorder")}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,t,n,r){for(let a in this._tiles){let o=this._tiles[a];if(r[a]||!o.hasData()||o.tileID.overscaledZ<=t||o.tileID.overscaledZ>n)continue;let s=o.tileID;for(;o&&o.tileID.overscaledZ>t+1;){let h=o.tileID.scaledTo(o.tileID.overscaledZ-1);o=this._tiles[h.key],o&&o.hasData()&&(s=h)}let u=s;for(;u.overscaledZ>t;)if(u=u.scaledTo(u.overscaledZ-1),e[u.key]){r[s.key]=s;break}}}findLoadedParent(e,t){if(e.key in this._loadedParentTiles){let n=this._loadedParentTiles[e.key];return n&&n.tileID.overscaledZ>=t?n:null}for(let n=e.overscaledZ-1;n>=t;n--){let r=e.scaledTo(n),a=this._getLoadedTile(r);if(a)return a}}_getLoadedTile(e){let t=this._tiles[e.key];return t&&t.hasData()?t:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){let t=Math.ceil(e.width/this._source.tileSize)+1,n=Math.ceil(e.height/this._source.tileSize)+1,r=t*n,a=this._maxTileCacheZoomLevels===null?_s.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels,o=Math.floor(r*a),s=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,o):o;this._cache.setMaxSize(s)}handleWrapJump(e){let t=this._prevLng===void 0?e:this._prevLng,n=(e-t)/360,r=Math.round(n);if(this._prevLng=e,r){let a={};for(let o in this._tiles){let s=this._tiles[o];s.tileID=s.tileID.unwrapTo(s.tileID.wrap+r),a[s.tileID.key]=s}this._tiles=a;for(let o in this._timers)clearTimeout(this._timers[o]),delete this._timers[o];for(let o in this._tiles){let s=this._tiles[o];this._setTileReloadTimer(o,s)}}}update(e,t){if(!this._sourceLoaded||this._paused)return;this.transform=e,this.terrain=t,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={};let n;!this.used&&!this.usedForTerrain?n=[]:this._source.tileID?n=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(d=>new ls(d.canonical.z,d.wrap,d.canonical.z,d.canonical.x,d.canonical.y)):(n=e.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this.usedForTerrain?!1:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:t}),this._source.hasTile&&(n=n.filter(d=>this._source.hasTile(d))));let r=e.coveringZoomLevel(this._source),a=Math.max(r-Hy.maxOverzooming,this._source.minzoom),o=Math.max(r+Hy.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){let d={};for(let f of n)if(f.canonical.z>this._source.minzoom){let m=f.scaledTo(f.canonical.z-1);d[m.key]=m;let v=f.scaledTo(Math.max(this._source.minzoom,Math.min(f.canonical.z,5)));d[v.key]=v}n=n.concat(Object.values(d))}let s=n.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,s&&this.fire(new Tt("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));let u=this._updateRetainedTiles(n,r);if(J3(this._source.type)){let d={},f={},m=Object.keys(u),v=Mn.now();for(let b of m){let w=u[b],A=this._tiles[b];if(!A||A.fadeEndTime!==0&&A.fadeEndTime<=v)continue;let E=this.findLoadedParent(w,a);E&&(this._addTile(E.tileID),d[E.tileID.key]=E.tileID),f[b]=w}this._retainLoadedChildren(f,r,o,u);for(let b in d)u[b]||(this._coveredTiles[b]=!0,u[b]=d[b]);if(t){let b={},w={};for(let A of n)this._tiles[A.key].hasData()?b[A.key]=A:w[A.key]=A;for(let A in w){let E=w[A].children(this._source.maxzoom);this._tiles[E[0].key]&&this._tiles[E[1].key]&&this._tiles[E[2].key]&&this._tiles[E[3].key]&&(b[E[0].key]=u[E[0].key]=E[0],b[E[1].key]=u[E[1].key]=E[1],b[E[2].key]=u[E[2].key]=E[2],b[E[3].key]=u[E[3].key]=E[3],delete w[A])}for(let A in w){let E=this.findLoadedParent(w[A],this._source.minzoom);if(E){b[E.tileID.key]=u[E.tileID.key]=E.tileID;for(let I in b)b[I].isChildOf(E.tileID)&&delete b[I]}}for(let A in this._tiles)b[A]||(this._coveredTiles[A]=!0)}}for(let d in u)this._tiles[d].clearFadeHold();let h=JB(this._tiles,u);for(let d of h){let f=this._tiles[d];f.hasSymbolBuckets&&!f.holdingForFade()?f.setHoldDuration(this.map._fadeDuration):(!f.hasSymbolBuckets||f.symbolFadeFinished())&&this._removeTile(d)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(let e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,t){let n={},r={},a=Math.max(t-Hy.maxOverzooming,this._source.minzoom),o=Math.max(t+Hy.maxUnderzooming,this._source.minzoom),s={};for(let u of e){let h=this._addTile(u);n[u.key]=u,!h.hasData()&&t<this._source.maxzoom&&(s[u.key]=u)}this._retainLoadedChildren(s,t,o,n);for(let u of e){let h=this._tiles[u.key];if(h.hasData())continue;if(t+1>this._source.maxzoom){let f=u.children(this._source.maxzoom)[0],m=this.getTile(f);if(m&&m.hasData()){n[f.key]=f;continue}}else{let f=u.children(this._source.maxzoom);if(n[f[0].key]&&n[f[1].key]&&n[f[2].key]&&n[f[3].key])continue}let d=h.wasRequested();for(let f=u.overscaledZ-1;f>=a;--f){let m=u.scaledTo(f);if(r[m.key])break;if(r[m.key]=!0,h=this.getTile(m),!h&&d&&(h=this._addTile(m)),h){let v=h.hasData();if((d||v)&&(n[m.key]=m),d=h.wasRequested(),v)break}}}return n}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(let e in this._tiles){let t=[],n,r=this._tiles[e].tileID;for(;r.overscaledZ>0;){if(r.key in this._loadedParentTiles){n=this._loadedParentTiles[r.key];break}t.push(r.key);let a=r.scaledTo(r.overscaledZ-1);if(n=this._getLoadedTile(a),n)break;r=a}for(let a of t)this._loadedParentTiles[a]=n}}_addTile(e){let t=this._tiles[e.key];if(t)return t;t=this._cache.getAndRemove(e),t&&(this._setTileReloadTimer(e.key,t),t.tileID=e,this._state.initializeTileState(t,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,t)));let n=t;return t||(t=new GZ(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(t,e.key,t.state)),t.uses++,this._tiles[e.key]=t,n||this._source.fire(new Tt("dataloading",{tile:t,coord:t.tileID,dataType:"source"})),t}_setTileReloadTimer(e,t){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);let n=t.getExpiryTimeout();n&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},n))}_removeTile(e){let t=this._tiles[e];t&&(t.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),!(t.uses>0)&&(t.hasData()&&t.state!=="reloading"?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))}_dataHandler(e){let t=e.sourceDataType;e.dataType==="source"&&t==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&t==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(let e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,t,n){let r=[],a=this.transform;if(!a)return r;let o=n?a.getCameraQueryGeometry(e):e,s=e.map(b=>a.pointCoordinate(b,this.terrain)),u=o.map(b=>a.pointCoordinate(b,this.terrain)),h=this.getIds(),d=1/0,f=1/0,m=-1/0,v=-1/0;for(let b of u)d=Math.min(d,b.x),f=Math.min(f,b.y),m=Math.max(m,b.x),v=Math.max(v,b.y);for(let b=0;b<h.length;b++){let w=this._tiles[h[b]];if(w.holdingForFade())continue;let A=w.tileID,E=Math.pow(2,a.zoom-w.tileID.overscaledZ),I=t*w.queryPadding*8192/w.tileSize/E,C=[A.getTilePoint(new $a(d,f)),A.getTilePoint(new $a(m,v))];if(C[0].x-I<8192&&C[0].y-I<8192&&C[1].x+I>=0&&C[1].y+I>=0){let T=s.map(F=>A.getTilePoint(F)),k=u.map(F=>A.getTilePoint(F));r.push({tile:w,tileID:A,queryGeometry:T,cameraQueryGeometry:k,scale:E})}}return r}getVisibleCoordinates(e){let t=this.getRenderableIds(e).map(n=>this._tiles[n].tileID);for(let n of t)n.posMatrix=this.transform.calculatePosMatrix(n.toUnwrapped());return t}hasTransition(){if(this._source.hasTransition())return!0;if(J3(this._source.type)){let e=Mn.now();for(let t in this._tiles)if(this._tiles[t].fadeEndTime>=e)return!0}return!1}setFeatureState(e,t,n){e=e||"_geojsonTileLayer",this._state.updateState(e,t,n)}removeFeatureState(e,t,n){e=e||"_geojsonTileLayer",this._state.removeFeatureState(e,t,n)}getFeatureState(e,t){return e=e||"_geojsonTileLayer",this._state.getState(e,t)}setDependencies(e,t,n){let r=this._tiles[e];r&&r.setDependencies(t,n)}reloadTilesForDependencies(e,t){for(let n in this._tiles)this._tiles[n].hasDependency(e,t)&&this._reloadTile(n,"reloading");this._cache.filter(n=>!n.hasDependency(e,t))}};l(WZ,"SourceCache");var c1=WZ;c1.maxOverzooming=10;c1.maxUnderzooming=3;function Y3(i,e){let t=Math.abs(i.wrap*2)-+(i.wrap<0),n=Math.abs(e.wrap*2)-+(e.wrap<0);return i.overscaledZ-e.overscaledZ||n-t||e.canonical.y-i.canonical.y||e.canonical.x-i.canonical.x}l(Y3,"compareTileId");function J3(i){return i==="raster"||i==="image"||i==="video"}l(J3,"isRasterType");R();R();R();var Ru=ii(Rn(),1);R();var zh=ii(Rn(),1);function qZ(i,e,t,n,r){let a=[];for(let o=0;o<i.length;o++){let s=i[o],u;for(let h=0;h<s.length-1;h++){let d=s[h],f=s[h+1];d.x<e&&f.x<e||(d.x<e?d=new zh.default(e,d.y+(f.y-d.y)*((e-d.x)/(f.x-d.x)))._round():f.x<e&&(f=new zh.default(e,d.y+(f.y-d.y)*((e-d.x)/(f.x-d.x)))._round()),!(d.y<t&&f.y<t)&&(d.y<t?d=new zh.default(d.x+(f.x-d.x)*((t-d.y)/(f.y-d.y)),t)._round():f.y<t&&(f=new zh.default(d.x+(f.x-d.x)*((t-d.y)/(f.y-d.y)),t)._round()),!(d.x>=n&&f.x>=n)&&(d.x>=n?d=new zh.default(n,d.y+(f.y-d.y)*((n-d.x)/(f.x-d.x)))._round():f.x>=n&&(f=new zh.default(n,d.y+(f.y-d.y)*((n-d.x)/(f.x-d.x)))._round()),!(d.y>=r&&f.y>=r)&&(d.y>=r?d=new zh.default(d.x+(f.x-d.x)*((r-d.y)/(f.y-d.y)),r)._round():f.y>=r&&(f=new zh.default(d.x+(f.x-d.x)*((r-d.y)/(f.y-d.y)),r)._round()),(!u||!d.equals(u[u.length-1]))&&(u=[d],a.push(u)),u.push(f)))))}}return a}l(qZ,"clipLine");R();var XZ=class{constructor(e,t){this.reset(e,t)}reset(e,t){this.points=e||[],this._distances=[0];for(let n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(t||0,this.length*.5),this.paddedLength=this.length-this.padding*2}lerp(e){if(this.points.length===1)return this.points[0];e=da(e,0,1);let t=1,n=this._distances[t],r=e*this.paddedLength+this.padding;for(;n<r&&t<this._distances.length;)n=this._distances[++t];let a=t-1,o=this._distances[a],s=n-o,u=s>0?(r-o)/s:0;return this.points[a].mult(1-u).add(this.points[t].mult(u))}};l(XZ,"PathInterpolator");var P1e=XZ;R();function Wy(i,e){let t=!0;return i==="always"||(i==="never"||e==="never")&&(t=!1),t}l(Wy,"overlapAllowed");var ZZ=class{constructor(e,t,n){let r=this.boxCells=[],a=this.circleCells=[];this.xCellCount=Math.ceil(e/n),this.yCellCount=Math.ceil(t/n);for(let o=0;o<this.xCellCount*this.yCellCount;o++)r.push([]),a.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,t,n,r,a){this._forEachCell(t,n,r,a,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(a)}insertCircle(e,t,n,r){this._forEachCell(t-r,n-r,t+r,n+r,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(n),this.circles.push(r)}_insertBoxCell(e,t,n,r,a,o){this.boxCells[a].push(o)}_insertCircleCell(e,t,n,r,a,o){this.circleCells[a].push(o)}_query(e,t,n,r,a,o,s){if(n<0||e>this.width||r<0||t>this.height)return[];let u=[];if(e<=0&&t<=0&&this.width<=n&&this.height<=r){if(a)return[{key:null,x1:e,y1:t,x2:n,y2:r}];for(let h=0;h<this.boxKeys.length;h++)u.push({key:this.boxKeys[h],x1:this.bboxes[h*4],y1:this.bboxes[h*4+1],x2:this.bboxes[h*4+2],y2:this.bboxes[h*4+3]});for(let h=0;h<this.circleKeys.length;h++){let d=this.circles[h*3],f=this.circles[h*3+1],m=this.circles[h*3+2];u.push({key:this.circleKeys[h],x1:d-m,y1:f-m,x2:d+m,y2:f+m})}}else{let h={hitTest:a,overlapMode:o,seenUids:{box:{},circle:{}}};this._forEachCell(e,t,n,r,this._queryCell,u,h,s)}return u}query(e,t,n,r){return this._query(e,t,n,r,!1,null)}hitTest(e,t,n,r,a,o){return this._query(e,t,n,r,!0,a,o).length>0}hitTestCircle(e,t,n,r,a){let o=e-n,s=e+n,u=t-n,h=t+n;if(s<0||o>this.width||h<0||u>this.height)return!1;let d=[],f={hitTest:!0,overlapMode:r,circle:{x:e,y:t,radius:n},seenUids:{box:{},circle:{}}};return this._forEachCell(o,u,s,h,this._queryCellCircle,d,f,a),d.length>0}_queryCell(e,t,n,r,a,o,s,u){let{seenUids:h,hitTest:d,overlapMode:f}=s,m=this.boxCells[a];if(m!==null){let b=this.bboxes;for(let w of m)if(!h.box[w]){h.box[w]=!0;let A=w*4,E=this.boxKeys[w];if(e<=b[A+2]&&t<=b[A+3]&&n>=b[A+0]&&r>=b[A+1]&&(!u||u(E))&&(!d||!Wy(f,E.overlapMode))&&(o.push({key:E,x1:b[A],y1:b[A+1],x2:b[A+2],y2:b[A+3]}),d))return!0}}let v=this.circleCells[a];if(v!==null){let b=this.circles;for(let w of v)if(!h.circle[w]){h.circle[w]=!0;let A=w*3,E=this.circleKeys[w];if(this._circleAndRectCollide(b[A],b[A+1],b[A+2],e,t,n,r)&&(!u||u(E))&&(!d||!Wy(f,E.overlapMode))){let I=b[A],C=b[A+1],T=b[A+2];if(o.push({key:E,x1:I-T,y1:C-T,x2:I+T,y2:C+T}),d)return!0}}}return!1}_queryCellCircle(e,t,n,r,a,o,s,u){let{circle:h,seenUids:d,overlapMode:f}=s,m=this.boxCells[a];if(m!==null){let b=this.bboxes;for(let w of m)if(!d.box[w]){d.box[w]=!0;let A=w*4,E=this.boxKeys[w];if(this._circleAndRectCollide(h.x,h.y,h.radius,b[A+0],b[A+1],b[A+2],b[A+3])&&(!u||u(E))&&!Wy(f,E.overlapMode))return o.push(!0),!0}}let v=this.circleCells[a];if(v!==null){let b=this.circles;for(let w of v)if(!d.circle[w]){d.circle[w]=!0;let A=w*3,E=this.circleKeys[w];if(this._circlesCollide(b[A],b[A+1],b[A+2],h.x,h.y,h.radius)&&(!u||u(E))&&!Wy(f,E.overlapMode))return o.push(!0),!0}}}_forEachCell(e,t,n,r,a,o,s,u){let h=this._convertToXCellCoord(e),d=this._convertToYCellCoord(t),f=this._convertToXCellCoord(n),m=this._convertToYCellCoord(r);for(let v=h;v<=f;v++)for(let b=d;b<=m;b++){let w=this.xCellCount*b+v;if(a.call(this,e,t,n,r,w,o,s,u))return}}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,t,n,r,a,o){let s=r-e,u=a-t,h=n+o;return h*h>s*s+u*u}_circleAndRectCollide(e,t,n,r,a,o,s){let u=(o-r)/2,h=Math.abs(e-(r+u));if(h>u+n)return!1;let d=(s-a)/2,f=Math.abs(t-(a+d));if(f>d+n)return!1;if(h<=u||f<=d)return!0;let m=h-u,v=f-d;return m*m+v*v<=n*n}};l(ZZ,"GridIndex");var cR=ZZ;R();var p1=ii(Rn(),1);function PA(i,e,t,n,r){let a=Qt.create();return e?(Qt.scale(a,a,[1/r,1/r,1]),t||Qt.rotateZ(a,a,n.angle)):Qt.multiply(a,n.labelPlaneMatrix,i),a}l(PA,"getLabelPlaneMatrix");function yL(i,e,t,n,r){if(e){let a=Qt.clone(i);return Qt.scale(a,a,[r,r,1]),t||Qt.rotateZ(a,a,-n.angle),a}else return n.glCoordMatrix}l(yL,"getGlCoordMatrix");function ds(i,e,t){let n;t?(n=[i.x,i.y,t(i.x,i.y),1],Mo.transformMat4(n,n,e)):(n=[i.x,i.y,0,1],DA(n,n,e));let r=n[3];return{point:new p1.default(n[0]/r,n[1]/r),signedDistanceFromCamera:r}}l(ds,"project");function LA(i,e){return .5+.5*(i/e)}l(LA,"getPerspectiveRatio");function YZ(i,e){let t=i[0]/i[3],n=i[1]/i[3];return t>=-e[0]&&t<=e[0]&&n>=-e[1]&&n<=e[1]}l(YZ,"isVisible");function JZ(i,e,t,n,r,a,o,s,u,h){let d=n?i.textSizeData:i.iconSizeData,f=c0(d,t.transform.zoom),m=[256/t.width*2+1,256/t.height*2+1],v=n?i.text.dynamicLayoutVertexArray:i.icon.dynamicLayoutVertexArray;v.clear();let b=i.lineVertexArray,w=n?i.text.placedSymbolArray:i.icon.placedSymbolArray,A=t.transform.width/t.transform.height,E=!1;for(let I=0;I<w.length;I++){let C=w.get(I);if(C.hidden||C.writingMode===2&&!E){sd(C.numGlyphs,v);continue}E=!1;let T;if(h?(T=[C.anchorX,C.anchorY,h(C.anchorX,C.anchorY),1],Mo.transformMat4(T,T,e)):(T=[C.anchorX,C.anchorY,0,1],DA(T,T,e)),!YZ(T,m)){sd(C.numGlyphs,v);continue}let k=T[3],F=LA(t.transform.cameraToCenterDistance,k),B=CA(d,f,C),N=o?B/F:B*F,z=new p1.default(C.anchorX,C.anchorY),L=ds(z,r,h).point,j={projections:{},offsets:{}},q=Q3(C,N,!1,s,e,r,a,i.glyphOffsetArray,b,v,L,z,j,A,u,h);E=q.useVertical,(q.notEnoughRoom||E||q.needsFlipping&&Q3(C,N,!0,s,e,r,a,i.glyphOffsetArray,b,v,L,z,j,A,u,h).notEnoughRoom)&&sd(C.numGlyphs,v)}n?i.text.dynamicLayoutVertexBuffer.updateData(v):i.icon.dynamicLayoutVertexBuffer.updateData(v)}l(JZ,"updateLineLabels");function vL(i,e,t,n,r,a,o,s,u,h,d,f,m){let v=s.glyphStartIndex+s.numGlyphs,b=s.lineStartIndex,w=s.lineStartIndex+s.lineLength,A=e.getoffsetX(s.glyphStartIndex),E=e.getoffsetX(v-1),I=d1(i*A,t,n,r,a,o,s.segment,b,w,u,h,d,f,m);if(!I)return null;let C=d1(i*E,t,n,r,a,o,s.segment,b,w,u,h,d,f,m);return C?{first:I,last:C}:null}l(vL,"placeFirstAndLastGlyph");function K3(i,e,t,n){if(i===1){let r=Math.abs(t.y-e.y),a=Math.abs(t.x-e.x)*n;if(r>a)return{useVertical:!0}}return(i===2?e.y<t.y:e.x>t.x)?{needsFlipping:!0}:null}l(K3,"requiresOrientationChange");function Q3(i,e,t,n,r,a,o,s,u,h,d,f,m,v,b,w){let A=e/24,E=i.lineOffsetX*A,I=i.lineOffsetY*A,C;if(i.numGlyphs>1){let T=i.glyphStartIndex+i.numGlyphs,k=i.lineStartIndex,F=i.lineStartIndex+i.lineLength,B=vL(A,s,E,I,t,d,f,i,u,a,m,b,w);if(!B)return{notEnoughRoom:!0};let N=ds(B.first.point,o,w).point,z=ds(B.last.point,o,w).point;if(n&&!t){let L=K3(i.writingMode,N,z,v);if(L)return L}C=[B.first];for(let L=i.glyphStartIndex+1;L<T-1;L++){let j=d1(A*s.getoffsetX(L),E,I,t,d,f,i.segment,k,F,u,a,m,b,w);if(j==null)return{notEnoughRoom:!0};C.push(j)}C.push(B.last)}else{if(n&&!t){let k=ds(f,r,w).point,F=i.lineStartIndex+i.segment+1,B=new p1.default(u.getx(F),u.gety(F)),N=ds(B,r,w),z=N.signedDistanceFromCamera>0?N.point:_L(f,B,k,1,r,w),L=K3(i.writingMode,k,z,v);if(L)return L}let T=d1(A*s.getoffsetX(i.glyphStartIndex),E,I,t,d,f,i.segment,i.lineStartIndex,i.lineStartIndex+i.lineLength,u,a,m,b,w);if(!T)return{notEnoughRoom:!0};C=[T]}for(let T of C)yg(h,T.point,T.angle);return{}}l(Q3,"placeGlyphsAlongLine");function _L(i,e,t,n,r,a){let o=ds(i.add(i.sub(e)._unit()),r,a).point,s=t.sub(o);return t.add(s._mult(n/s.mag()))}l(_L,"projectTruncatedLineSegment");function uw(i,e){let{projectionCache:t,lineVertexArray:n,labelPlaneMatrix:r,tileAnchorPoint:a,distanceFromAnchor:o,getElevation:s,previousVertex:u,direction:h,absOffsetX:d}=e;if(t.projections[i])return t.projections[i];let f=new p1.default(n.getx(i),n.gety(i)),m=ds(f,r,s);if(m.signedDistanceFromCamera>0)return t.projections[i]=m.point,m.point;let v=i-h,b=o===0?a:new p1.default(n.getx(v),n.gety(v));return _L(b,f,u,d-o+1,r,s)}l(uw,"projectVertexToViewport");function hw(i,e,t){return i._unit()._perp()._mult(e*t)}l(hw,"transformToOffsetNormal");function KZ(i,e,t,n,r,a,o,s){let{projectionCache:u,direction:h}=s;if(u.offsets[i])return u.offsets[i];let d=t.add(e);if(i+h<n||i+h>=r)return u.offsets[i]=d,d;let f=uw(i+h,s),m=hw(f.sub(t),o,h),v=t.add(m),b=f.add(m);return u.offsets[i]=tz(a,d,v,b)||d,u.offsets[i]}l(KZ,"findOffsetIntersectionPoint");function d1(i,e,t,n,r,a,o,s,u,h,d,f,m,v){let b=n?i-e:i+e,w=b>0?1:-1,A=0;n&&(w*=-1,A=Math.PI),w<0&&(A+=Math.PI);let E=w>0?s+o:s+o+1,I=r,C=r,T,k,F=0,B=0,N=Math.abs(b),z=[],L;for(;F+B<=N;){if(E+=w,E<s||E>=u)return null;F+=B,C=I,k=T;let O={projectionCache:f,lineVertexArray:h,labelPlaneMatrix:d,tileAnchorPoint:a,distanceFromAnchor:F,getElevation:v,previousVertex:C,direction:w,absOffsetX:N};if(I=uw(E,O),t===0)z.push(C),L=I.sub(C);else{let Y,J=I.sub(C);if(J.mag()===0){let oe=uw(E+w,O);Y=hw(oe.sub(I),t,w)}else Y=hw(J,t,w);k||(k=C.add(Y)),T=KZ(E,Y,I,s,u,k,t,O),z.push(k),L=T.sub(k)}B=L.mag()}let j=(N-F)/B,q=L._mult(j)._add(k||C),Z=A+Math.atan2(I.y-C.y,I.x-C.x);return z.push(q),{point:q,angle:m?Z:0,path:z}}l(d1,"placeGlyphAlongLine");var L1e=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function sd(i,e){for(let t=0;t<i;t++){let n=e.length;e.resize(n+4),e.float32.set(L1e,n*3)}}l(sd,"hideGlyphs");function DA(i,e,t){let n=e[0],r=e[1];return i[0]=t[0]*n+t[4]*r+t[12],i[1]=t[1]*n+t[5]*r+t[13],i[3]=t[3]*n+t[7]*r+t[15],i}l(DA,"xyTransformMat4");var sa=100,QZ=class{constructor(e,t=new cR(e.width+2*sa,e.height+2*sa,25),n=new cR(e.width+2*sa,e.height+2*sa,25)){this.transform=e,this.grid=t,this.ignoredGrid=n,this.pitchfactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+sa,this.screenBottomBoundary=e.height+sa,this.gridRightBoundary=e.width+2*sa,this.gridBottomBoundary=e.height+2*sa,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,t,n,r,a,o){let s=this.projectAndGetPerspectiveRatio(r,e.anchorPointX,e.anchorPointY,o),u=n*s.perspectiveRatio,h=e.x1*u+s.point.x,d=e.y1*u+s.point.y,f=e.x2*u+s.point.x,m=e.y2*u+s.point.y;return!this.isInsideGrid(h,d,f,m)||t!=="always"&&this.grid.hitTest(h,d,f,m,t,a)||s.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[h,d,f,m],offscreen:this.isOffscreen(h,d,f,m)}}placeCollisionCircles(e,t,n,r,a,o,s,u,h,d,f,m,v,b){let w=[],A=new Ru.default(t.anchorX,t.anchorY),E=ds(A,o,b),I=LA(this.transform.cameraToCenterDistance,E.signedDistanceFromCamera),C=(d?a/I:a*I)/_X,T=ds(A,s,b).point,k={projections:{},offsets:{}},F=t.lineOffsetX*C,B=t.lineOffsetY*C,N=vL(C,r,F,B,!1,T,A,t,n,s,k,!1,b),z=!1,L=!1,j=!0;if(N){let q=m*.5*I+v,Z=new Ru.default(-sa,-sa),O=new Ru.default(this.screenRightBoundary,this.screenBottomBoundary),Y=new P1e,J=N.first,oe=N.last,$=[];for(let ve=J.path.length-1;ve>=1;ve--)$.push(J.path[ve]);for(let ve=1;ve<oe.path.length;ve++)$.push(oe.path[ve]);let K=q*2.5;if(u){let ve=$.map(Q=>ds(Q,u,b));ve.some(Q=>Q.signedDistanceFromCamera<=0)?$=[]:$=ve.map(Q=>Q.point)}let te=[];if($.length>0){let ve=$[0].clone(),Q=$[0].clone();for(let he=1;he<$.length;he++)ve.x=Math.min(ve.x,$[he].x),ve.y=Math.min(ve.y,$[he].y),Q.x=Math.max(Q.x,$[he].x),Q.y=Math.max(Q.y,$[he].y);ve.x>=Z.x&&Q.x<=O.x&&ve.y>=Z.y&&Q.y<=O.y?te=[$]:Q.x<Z.x||ve.x>O.x||Q.y<Z.y||ve.y>O.y?te=[]:te=qZ([$],Z.x,Z.y,O.x,O.y)}for(let ve of te){Y.reset(ve,q*.25);let Q=0;Y.length<=.5*q?Q=1:Q=Math.ceil(Y.paddedLength/K)+1;for(let he=0;he<Q;he++){let se=he/Math.max(Q-1,1),Ae=Y.lerp(se),Ie=Ae.x+sa,we=Ae.y+sa;w.push(Ie,we,q,0);let Ne=Ie-q,je=we-q,Ve=Ie+q,Le=we+q;if(j=j&&this.isOffscreen(Ne,je,Ve,Le),L=L||this.isInsideGrid(Ne,je,Ve,Le),e!=="always"&&this.grid.hitTestCircle(Ie,we,q,e,f)&&(z=!0,!h))return{circles:[],offscreen:!1,collisionDetected:z}}}}return{circles:!h&&z||!L||I<this.perspectiveRatioCutoff?[]:w,offscreen:j,collisionDetected:z}}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};let t=[],n=1/0,r=1/0,a=-1/0,o=-1/0;for(let d of e){let f=new Ru.default(d.x+sa,d.y+sa);n=Math.min(n,f.x),r=Math.min(r,f.y),a=Math.max(a,f.x),o=Math.max(o,f.y),t.push(f)}let s=this.grid.query(n,r,a,o).concat(this.ignoredGrid.query(n,r,a,o)),u={},h={};for(let d of s){let f=d.key;if(u[f.bucketInstanceId]===void 0&&(u[f.bucketInstanceId]={}),u[f.bucketInstanceId][f.featureIndex])continue;let m=[new Ru.default(d.x1,d.y1),new Ru.default(d.x2,d.y1),new Ru.default(d.x2,d.y2),new Ru.default(d.x1,d.y2)];g4(t,m)&&(u[f.bucketInstanceId][f.featureIndex]=!0,h[f.bucketInstanceId]===void 0&&(h[f.bucketInstanceId]=[]),h[f.bucketInstanceId].push(f.featureIndex))}return h}insertCollisionBox(e,t,n,r,a,o){let s=n?this.ignoredGrid:this.grid,u={bucketInstanceId:r,featureIndex:a,collisionGroupID:o,overlapMode:t};s.insert(u,e[0],e[1],e[2],e[3])}insertCollisionCircles(e,t,n,r,a,o){let s=n?this.ignoredGrid:this.grid,u={bucketInstanceId:r,featureIndex:a,collisionGroupID:o,overlapMode:t};for(let h=0;h<e.length;h+=4)s.insertCircle(u,e[h],e[h+1],e[h+2])}projectAndGetPerspectiveRatio(e,t,n,r){let a;return r?(a=[t,n,r(t,n),1],Mo.transformMat4(a,a,e)):(a=[t,n,0,1],DA(a,a,e)),{point:new Ru.default((a[0]/a[3]+1)/2*this.transform.width+sa,(-a[1]/a[3]+1)/2*this.transform.height+sa),perspectiveRatio:.5+.5*(this.transform.cameraToCenterDistance/a[3])}}isOffscreen(e,t,n,r){return n<sa||e>=this.screenRightBoundary||r<sa||t>this.screenBottomBoundary}isInsideGrid(e,t,n,r){return n>=0&&e<this.gridRightBoundary&&r>=0&&t<this.gridBottomBoundary}getViewportMatrix(){let e=Qt.identity([]);return Qt.translate(e,e,[-sa,-sa,0]),e}};l(QZ,"CollisionIndex");var D1e=QZ;R();R();var k1e=ii(Rn(),1),eY=class tY extends k1e.default{constructor(e,t,n,r){super(e,t),this.angle=n,r!==void 0&&(this.segment=r)}clone(){return new tY(this.x,this.y,this.angle,this.segment)}};l(eY,"Anchor");var R1e=eY;Zt("Anchor",R1e);R();R();R();ii(Rn(),1);R();ii(Rn(),1);R();ii(GB(),1);ii(Rn(),1);ii($B(),1);R();var eE=(i=>(i[i.center=1]="center",i[i.left=2]="left",i[i.right=3]="right",i[i.top=4]="top",i[i.bottom=5]="bottom",i[i["top-left"]=6]="top-left",i[i["top-right"]=7]="top-right",i[i["bottom-left"]=8]="bottom-left",i[i["bottom-right"]=9]="bottom-right",i))(eE||{});function iY(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}l(iY,"getAnchorJustification");R();function qo(i,e,t){return e*(8192/(i.tileSize*Math.pow(2,t-i.tileID.overscaledZ)))}l(qo,"pixelsToTileUnits");var xL=ii(Rn(),1),nY=class{constructor(e,t,n,r){e?this.opacity=Math.max(0,Math.min(1,e.opacity+(e.placed?t:-t))):this.opacity=r&&n?1:0,this.placed=n}isHidden(){return this.opacity===0&&!this.placed}};l(nY,"OpacityState");var pR=nY,rY=class{constructor(e,t,n,r,a){this.text=new pR(e?e.text:null,t,n,a),this.icon=new pR(e?e.icon:null,t,r,a)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}};l(rY,"JointOpacityState");var fy=rY,aY=class{constructor(e,t,n){this.text=e,this.icon=t,this.skipFade=n}};l(aY,"JointPlacement");var dR=aY,oY=class{constructor(){this.invProjMatrix=Qt.create(),this.viewportMatrix=Qt.create(),this.circles=[]}};l(oY,"CollisionCircleArray");var O1e=oY,sY=class{constructor(e,t,n,r,a){this.bucketInstanceId=e,this.featureIndex=t,this.sourceLayerIndex=n,this.bucketIndex=r,this.tileID=a}};l(sY,"RetainedQueryData");var N1e=sY,lY=class{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){let t=++this.maxGroupID;this.collisionGroups[e]={ID:t,predicate:l(n=>n.collisionGroupID===t,"predicate")}}return this.collisionGroups[e]}};l(lY,"CollisionGroups");var F1e=lY;function tE(i,e,t,n,r){let{horizontalAlign:a,verticalAlign:o}=uL(i),s=-(a-.5)*e,u=-(o-.5)*t;return new xL.default(s+n[0]*r,u+n[1]*r)}l(tE,"calculateVariableLayoutShift");function fx(i,e,t,n,r,a){let{x1:o,x2:s,y1:u,y2:h,anchorPointX:d,anchorPointY:f}=i,m=new xL.default(e,t);return n&&m._rotate(r?a:-a),{x1:o+m.x,y1:u+m.y,x2:s+m.x,y2:h+m.y,anchorPointX:d,anchorPointY:f}}l(fx,"shiftVariableCollisionBox");var uY=class{constructor(e,t,n,r,a){this.transform=e.clone(),this.terrain=t,this.collisionIndex=new D1e(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=n,this.retainedQueryData={},this.collisionGroups=new F1e(r),this.collisionCircleArrays={},this.prevPlacement=a,a&&(a.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(e,t,n,r){let a=n.getBucket(t),o=n.latestFeatureIndex;if(!a||!o||t.id!==a.layerIds[0])return;let s=n.collisionBoxArray,u=a.layers[0].layout,h=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),d=n.tileSize/8192,f=this.transform.calculatePosMatrix(n.tileID.toUnwrapped()),m=u.get("text-pitch-alignment")==="map",v=u.get("text-rotation-alignment")==="map",b=qo(n,1,this.transform.zoom),w=PA(f,m,v,this.transform,b),A=null;if(m){let I=yL(f,m,v,this.transform,b);A=Qt.multiply([],this.transform.labelPlaneMatrix,I)}this.retainedQueryData[a.bucketInstanceId]=new N1e(a.bucketInstanceId,o,a.sourceLayerIndex,a.index,n.tileID);let E={bucket:a,layout:u,posMatrix:f,textLabelPlaneMatrix:w,labelToScreenMatrix:A,scale:h,textPixelRatio:d,holdingForFade:n.holdingForFade(),collisionBoxArray:s,partiallyEvaluatedTextSize:c0(a.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(a.sourceID)};if(r)for(let I of a.sortKeyRanges){let{sortKey:C,symbolInstanceStart:T,symbolInstanceEnd:k}=I;e.push({sortKey:C,symbolInstanceStart:T,symbolInstanceEnd:k,parameters:E})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:a.symbolInstances.length,parameters:E})}attemptAnchorPlacement(e,t,n,r,a,o,s,u,h,d,f,m,v,b,w,A){let E=eE[e.textAnchor],I=[e.textOffset0,e.textOffset1],C=tE(E,n,r,I,a),T=this.collisionIndex.placeCollisionBox(fx(t,C.x,C.y,o,s,this.transform.angle),f,u,h,d.predicate,A);if(!(w&&this.collisionIndex.placeCollisionBox(fx(w,C.x,C.y,o,s,this.transform.angle),f,u,h,d.predicate,A).box.length===0)&&T.box.length>0){let k;if(this.prevPlacement&&this.prevPlacement.variableOffsets[m.crossTileID]&&this.prevPlacement.placements[m.crossTileID]&&this.prevPlacement.placements[m.crossTileID].text&&(k=this.prevPlacement.variableOffsets[m.crossTileID].anchor),m.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[m.crossTileID]={textOffset:I,width:n,height:r,anchor:E,textBoxScale:a,prevAnchor:k},this.markUsedJustification(v,E,m,b),v.allowVerticalPlacement&&(this.markUsedOrientation(v,b,m),this.placedOrientations[m.crossTileID]=b),{shift:C,placedGlyphBoxes:T}}}placeLayerBucketPart(e,t,n){let{bucket:r,layout:a,posMatrix:o,textLabelPlaneMatrix:s,labelToScreenMatrix:u,textPixelRatio:h,holdingForFade:d,collisionBoxArray:f,partiallyEvaluatedTextSize:m,collisionGroup:v}=e.parameters,b=a.get("text-optional"),w=a.get("icon-optional"),A=u1(a,"text-overlap","text-allow-overlap"),E=A==="always",I=u1(a,"icon-overlap","icon-allow-overlap"),C=I==="always",T=a.get("text-rotation-alignment")==="map",k=a.get("text-pitch-alignment")==="map",F=a.get("icon-text-fit")!=="none",B=a.get("symbol-z-order")==="viewport-y",N=E&&(C||!r.hasIconData()||w),z=C&&(E||!r.hasTextData()||b);!r.collisionArrays&&f&&r.deserializeCollisionBoxes(f);let L=this.retainedQueryData[r.bucketInstanceId].tileID,j=this.terrain?(Z,O)=>this.terrain.getElevation(L,Z,O):null,q=l((Z,O)=>{var Y,J;if(t[Z.crossTileID])return;if(d){this.placements[Z.crossTileID]=new dR(!1,!1,!1);return}let oe=!1,$=!1,K=!0,te=null,ve={box:null,offscreen:null},Q={box:null},he=null,se=null,Ae=null,Ie=0,we=0,Ne=0;O.textFeatureIndex?Ie=O.textFeatureIndex:Z.useRuntimeCollisionCircles&&(Ie=Z.featureIndex),O.verticalTextFeatureIndex&&(we=O.verticalTextFeatureIndex);let je=O.textBox;if(je){let xe=l(ot=>{let He=1;if(r.allowVerticalPlacement&&!ot&&this.prevPlacement){let Ke=this.prevPlacement.placedOrientations[Z.crossTileID];Ke&&(this.placedOrientations[Z.crossTileID]=Ke,He=Ke,this.markUsedOrientation(r,He,Z))}return He},"updatePreviousOrientationIfNotPlaced"),Ue=l((ot,He)=>{if(r.allowVerticalPlacement&&Z.numVerticalGlyphVertices>0&&O.verticalTextBox){for(let Ke of r.writingModes)if(Ke===2?(ve=He(),Q=ve):ve=ot(),ve&&ve.box&&ve.box.length)break}else ve=ot()},"placeTextForPlacementModes"),de=Z.textAnchorOffsetStartIndex,ut=Z.textAnchorOffsetEndIndex;if(ut===de){let ot=l((He,Ke)=>{let Lt=this.collisionIndex.placeCollisionBox(He,A,h,o,v.predicate,j);return Lt&&Lt.box&&Lt.box.length&&(this.markUsedOrientation(r,Ke,Z),this.placedOrientations[Z.crossTileID]=Ke),Lt},"placeBox");Ue(l(()=>ot(je,1),"placeHorizontal"),l(()=>{let He=O.verticalTextBox;return r.allowVerticalPlacement&&Z.numVerticalGlyphVertices>0&&He?ot(He,2):{box:null,offscreen:null}},"placeVertical")),xe(ve&&ve.box&&ve.box.length)}else{let ot=eE[(J=(Y=this.prevPlacement)==null?void 0:Y.variableOffsets[Z.crossTileID])==null?void 0:J.anchor],He=l((Lt,_t,pe)=>{let re=Lt.x2-Lt.x1,ke=Lt.y2-Lt.y1,at=Z.textBoxScale,ct=F&&I==="never"?_t:null,rt={box:[],offscreen:!1},Qe=A==="never"?1:2,At="never";ot&&Qe++;for(let Dt=0;Dt<Qe;Dt++){for(let vt=de;vt<ut;vt++){let yt=r.textAnchorOffsets.get(vt);if(ot&&yt.textAnchor!==ot)continue;let jt=this.attemptAnchorPlacement(yt,Lt,re,ke,at,T,k,h,o,v,At,Z,r,pe,ct,j);if(jt&&(rt=jt.placedGlyphBoxes,rt&&rt.box&&rt.box.length))return oe=!0,te=jt.shift,rt}ot?ot=null:At=A}return rt},"placeBoxForVariableAnchors");Ue(l(()=>He(je,O.iconBox,1),"placeHorizontal"),l(()=>{let Lt=O.verticalTextBox,_t=ve&&ve.box&&ve.box.length;return r.allowVerticalPlacement&&!_t&&Z.numVerticalGlyphVertices>0&&Lt?He(Lt,O.verticalIconBox,2):{box:null,offscreen:null}},"placeVertical")),ve&&(oe=ve.box,K=ve.offscreen);let Ke=xe(ve&&ve.box);if(!oe&&this.prevPlacement){let Lt=this.prevPlacement.variableOffsets[Z.crossTileID];Lt&&(this.variableOffsets[Z.crossTileID]=Lt,this.markUsedJustification(r,Lt.anchor,Z,Ke))}}}if(he=ve,oe=he&&he.box&&he.box.length>0,K=he&&he.offscreen,Z.useRuntimeCollisionCircles){let xe=r.text.placedSymbolArray.get(Z.centerJustifiedTextSymbolIndex),Ue=CA(r.textSizeData,m,xe),de=a.get("text-padding"),ut=Z.collisionCircleDiameter;se=this.collisionIndex.placeCollisionCircles(A,xe,r.lineVertexArray,r.glyphOffsetArray,Ue,o,s,u,n,k,v.predicate,ut,de,j),se.circles.length&&se.collisionDetected&&!n&&lo("Collisions detected, but collision boxes are not shown"),oe=E||se.circles.length>0&&!se.collisionDetected,K=K&&se.offscreen}if(O.iconFeatureIndex&&(Ne=O.iconFeatureIndex),O.iconBox){let xe=l(Ue=>{let de=F&&te?fx(Ue,te.x,te.y,T,k,this.transform.angle):Ue;return this.collisionIndex.placeCollisionBox(de,I,h,o,v.predicate,j)},"placeIconFeature");Q&&Q.box&&Q.box.length&&O.verticalIconBox?(Ae=xe(O.verticalIconBox),$=Ae.box.length>0):(Ae=xe(O.iconBox),$=Ae.box.length>0),K=K&&Ae.offscreen}let Ve=b||Z.numHorizontalGlyphVertices===0&&Z.numVerticalGlyphVertices===0,Le=w||Z.numIconVertices===0;if(!Ve&&!Le?$=oe=$&&oe:Le?Ve||($=$&&oe):oe=$&&oe,oe&&he&&he.box&&(Q&&Q.box&&we?this.collisionIndex.insertCollisionBox(he.box,A,a.get("text-ignore-placement"),r.bucketInstanceId,we,v.ID):this.collisionIndex.insertCollisionBox(he.box,A,a.get("text-ignore-placement"),r.bucketInstanceId,Ie,v.ID)),$&&Ae&&this.collisionIndex.insertCollisionBox(Ae.box,I,a.get("icon-ignore-placement"),r.bucketInstanceId,Ne,v.ID),se&&(oe&&this.collisionIndex.insertCollisionCircles(se.circles,A,a.get("text-ignore-placement"),r.bucketInstanceId,Ie,v.ID),n)){let xe=r.bucketInstanceId,Ue=this.collisionCircleArrays[xe];Ue===void 0&&(Ue=this.collisionCircleArrays[xe]=new O1e);for(let de=0;de<se.circles.length;de+=4)Ue.circles.push(se.circles[de+0]),Ue.circles.push(se.circles[de+1]),Ue.circles.push(se.circles[de+2]),Ue.circles.push(se.collisionDetected?1:0)}if(Z.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(r.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Z.crossTileID]=new dR(oe||N,$||z,K||r.justReloaded),t[Z.crossTileID]=!0},"placeSymbol");if(B){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");let Z=r.getSortedSymbolIndexes(this.transform.angle);for(let O=Z.length-1;O>=0;--O){let Y=Z[O];q(r.symbolInstances.get(Y),r.collisionArrays[Y])}}else for(let Z=e.symbolInstanceStart;Z<e.symbolInstanceEnd;Z++)q(r.symbolInstances.get(Z),r.collisionArrays[Z]);if(n&&r.bucketInstanceId in this.collisionCircleArrays){let Z=this.collisionCircleArrays[r.bucketInstanceId];Qt.invert(Z.invProjMatrix,o),Z.viewportMatrix=this.collisionIndex.getViewportMatrix()}r.justReloaded=!1}markUsedJustification(e,t,n,r){let a={left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex},o;r===2?o=n.verticalPlacedTextSymbolIndex:o=a[iY(t)];let s=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];for(let u of s)u>=0&&(o>=0&&u!==o?e.text.placedSymbolArray.get(u).crossTileID=0:e.text.placedSymbolArray.get(u).crossTileID=n.crossTileID)}markUsedOrientation(e,t,n){let r=t===1||t===3?t:0,a=t===2?t:0,o=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];for(let s of o)e.text.placedSymbolArray.get(s).placedOrientation=r;n.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=a)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;let t=this.prevPlacement,n=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;let r=t?t.symbolFadeChange(e):1,a=t?t.opacities:{},o=t?t.variableOffsets:{},s=t?t.placedOrientations:{};for(let u in this.placements){let h=this.placements[u],d=a[u];d?(this.opacities[u]=new fy(d,r,h.text,h.icon),n=n||h.text!==d.text.placed||h.icon!==d.icon.placed):(this.opacities[u]=new fy(null,r,h.text,h.icon,h.skipFade),n=n||h.text||h.icon)}for(let u in a){let h=a[u];if(!this.opacities[u]){let d=new fy(h,r,!1,!1);d.isHidden()||(this.opacities[u]=d,n=n||h.text.placed||h.icon.placed)}}for(let u in o)!this.variableOffsets[u]&&this.opacities[u]&&!this.opacities[u].isHidden()&&(this.variableOffsets[u]=o[u]);for(let u in s)!this.placedOrientations[u]&&this.opacities[u]&&!this.opacities[u].isHidden()&&(this.placedOrientations[u]=s[u]);if(t&&t.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");n?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)}updateLayerOpacities(e,t){let n={};for(let r of t){let a=r.getBucket(e);a&&r.latestFeatureIndex&&e.id===a.layerIds[0]&&this.updateBucketOpacities(a,n,r.collisionBoxArray)}}updateBucketOpacities(e,t,n){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();let r=e.layers[0],a=r.layout,o=new fy(null,0,!1,!1,!0),s=a.get("text-allow-overlap"),u=a.get("icon-allow-overlap"),h=r._unevaluatedLayout.hasValue("text-variable-anchor")||r._unevaluatedLayout.hasValue("text-variable-anchor-offset"),d=a.get("text-rotation-alignment")==="map",f=a.get("text-pitch-alignment")==="map",m=a.get("icon-text-fit")!=="none",v=new fy(null,0,s&&(u||!e.hasIconData()||a.get("icon-optional")),u&&(s||!e.hasTextData()||a.get("text-optional")),!0);!e.collisionArrays&&n&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(n);let b=l((w,A,E)=>{for(let I=0;I<A/4;I++)w.opacityVertexArray.emplaceBack(E);w.hasVisibleVertices=w.hasVisibleVertices||E!==my},"addOpacities");for(let w=0;w<e.symbolInstances.length;w++){let A=e.symbolInstances.get(w),{numHorizontalGlyphVertices:E,numVerticalGlyphVertices:I,crossTileID:C}=A,T=t[C],k=this.opacities[C];T?k=o:k||(k=v,this.opacities[C]=k),t[C]=!0;let F=E>0||I>0,B=A.numIconVertices>0,N=this.placedOrientations[A.crossTileID],z=N===2,L=N===1||N===3;if(F){let j=iE(k.text),q=z?my:j;b(e.text,E,q);let Z=L?my:j;b(e.text,I,Z);let O=k.text.isHidden();[A.rightJustifiedTextSymbolIndex,A.centerJustifiedTextSymbolIndex,A.leftJustifiedTextSymbolIndex].forEach(oe=>{oe>=0&&(e.text.placedSymbolArray.get(oe).hidden=O||z?1:0)}),A.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(A.verticalPlacedTextSymbolIndex).hidden=O||L?1:0);let Y=this.variableOffsets[A.crossTileID];Y&&this.markUsedJustification(e,Y.anchor,A,N);let J=this.placedOrientations[A.crossTileID];J&&(this.markUsedJustification(e,"left",A,J),this.markUsedOrientation(e,J,A))}if(B){let j=iE(k.icon),q=!(m&&A.verticalPlacedIconSymbolIndex&&z);if(A.placedIconSymbolIndex>=0){let Z=q?j:my;b(e.icon,A.numIconVertices,Z),e.icon.placedSymbolArray.get(A.placedIconSymbolIndex).hidden=k.icon.isHidden()}if(A.verticalPlacedIconSymbolIndex>=0){let Z=q?my:j;b(e.icon,A.numVerticalIconVertices,Z),e.icon.placedSymbolArray.get(A.verticalPlacedIconSymbolIndex).hidden=k.icon.isHidden()}}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){let j=e.collisionArrays[w];if(j){let q=new xL.default(0,0);if(j.textBox||j.verticalTextBox){let O=!0;if(h){let Y=this.variableOffsets[C];Y?(q=tE(Y.anchor,Y.width,Y.height,Y.textOffset,Y.textBoxScale),d&&q._rotate(f?this.transform.angle:-this.transform.angle)):O=!1}j.textBox&&qy(e.textCollisionBox.collisionVertexArray,k.text.placed,!O||z,q.x,q.y),j.verticalTextBox&&qy(e.textCollisionBox.collisionVertexArray,k.text.placed,!O||L,q.x,q.y)}let Z=!!(!L&&j.verticalIconBox);j.iconBox&&qy(e.iconCollisionBox.collisionVertexArray,k.icon.placed,Z,m?q.x:0,m?q.y:0),j.verticalIconBox&&qy(e.iconCollisionBox.collisionVertexArray,k.icon.placed,!Z,m?q.x:0,m?q.y:0)}}}if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error("bucket.text.opacityVertexArray.length (= ".concat(e.text.opacityVertexArray.length,") !== bucket.text.layoutVertexArray.length (= ").concat(e.text.layoutVertexArray.length,") / 4"));if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error("bucket.icon.opacityVertexArray.length (= ".concat(e.icon.opacityVertexArray.length,") !== bucket.icon.layoutVertexArray.length (= ").concat(e.icon.layoutVertexArray.length,") / 4"));if(e.bucketInstanceId in this.collisionCircleArrays){let w=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=w.invProjMatrix,e.placementViewportMatrix=w.viewportMatrix,e.collisionCircleArray=w.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,t){let n=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*n>e}setStale(){this.stale=!0}};l(uY,"Placement");var B1e=uY;function qy(i,e,t,n,r){i.emplaceBack(e?1:0,t?1:0,n||0,r||0),i.emplaceBack(e?1:0,t?1:0,n||0,r||0),i.emplaceBack(e?1:0,t?1:0,n||0,r||0),i.emplaceBack(e?1:0,t?1:0,n||0,r||0)}l(qy,"updateCollisionVertices");var z1e=Math.pow(2,25),U1e=Math.pow(2,24),V1e=Math.pow(2,17),j1e=Math.pow(2,16),G1e=Math.pow(2,9),$1e=Math.pow(2,8),H1e=Math.pow(2,1);function iE(i){if(i.opacity===0&&!i.placed)return 0;if(i.opacity===1&&i.placed)return 4294967295;let e=i.placed?1:0,t=Math.floor(i.opacity*127);return t*z1e+e*U1e+t*V1e+e*j1e+t*G1e+e*$1e+t*H1e+e}l(iE,"packOpacity");var my=0,hY=class{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,t,n,r,a){let o=this._bucketParts;for(;this._currentTileIndex<e.length;){let s=e[this._currentTileIndex];if(t.getBucketParts(o,r,s,this._sortAcrossTiles),this._currentTileIndex++,a())return!0}for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,o.sort((s,u)=>s.sortKey-u.sortKey));this._currentPartIndex<o.length;){let s=o[this._currentPartIndex];if(t.placeLayerBucketPart(s,this._seenCrossTileIDs,n),this._currentPartIndex++,a())return!0}return!1}};l(hY,"LayerPlacement");var W1e=hY,cY=class{constructor(e,t,n,r,a,o,s,u){this.placement=new B1e(e,t,o,s,u),this._currentPlacementIndex=n.length-1,this._forceFullPlacement=r,this._showCollisionBoxes=a,this._done=!1}isDone(){return this._done}continuePlacement(e,t,n){let r=Mn.now(),a=l(()=>this._forceFullPlacement?!1:Mn.now()-r>2,"shouldPausePlacement");for(;this._currentPlacementIndex>=0;){let o=e[this._currentPlacementIndex],s=t[o],u=this.placement.collisionIndex.transform.zoom;if(s.type==="symbol"&&(!s.minzoom||s.minzoom<=u)&&(!s.maxzoom||s.maxzoom>u)){if(this._inProgressLayer||(this._inProgressLayer=new W1e(s)),this._inProgressLayer.continuePlacement(n[s.source],this.placement,this._showCollisionBoxes,s,a))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}};l(cY,"PauseablePlacement");var q1e=cY;R();R();var fR=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],tM=1,gy=8,pY=class dY{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[t,n]=new Uint8Array(e,0,2);if(t!==219)throw new Error("Data does not appear to be in a KDBush format.");let r=n>>4;if(r!==tM)throw new Error("Got v".concat(r," data when expected v").concat(tM,"."));let a=fR[n&15];if(!a)throw new Error("Unrecognized array type.");let[o]=new Uint16Array(e,2,1),[s]=new Uint32Array(e,4,1);return new dY(s,o,a,e)}constructor(e,t=64,n=Float64Array,r){if(isNaN(e)||e<0)throw new Error("Unpexpected numItems value: ".concat(e,"."));this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=n,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;let a=fR.indexOf(this.ArrayType),o=e*2*this.ArrayType.BYTES_PER_ELEMENT,s=e*this.IndexArrayType.BYTES_PER_ELEMENT,u=(8-s%8)%8;if(a<0)throw new Error("Unexpected typed array class: ".concat(n,"."));r&&r instanceof ArrayBuffer?(this.data=r,this.ids=new this.IndexArrayType(this.data,gy,e),this.coords=new this.ArrayType(this.data,gy+s+u,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(gy+o+s+u),this.ids=new this.IndexArrayType(this.data,gy,e),this.coords=new this.ArrayType(this.data,gy+s+u,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(tM<<4)+a]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){let n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=e,this.coords[this._pos++]=t,n}finish(){let e=this._pos>>1;if(e!==this.numItems)throw new Error("Added ".concat(e," items when expected ").concat(this.numItems,"."));return cw(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,n,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:a,coords:o,nodeSize:s}=this,u=[0,a.length-1,0],h=[];for(;u.length;){let d=u.pop()||0,f=u.pop()||0,m=u.pop()||0;if(f-m<=s){for(let A=m;A<=f;A++){let E=o[2*A],I=o[2*A+1];E>=e&&E<=n&&I>=t&&I<=r&&h.push(a[A])}continue}let v=m+f>>1,b=o[2*v],w=o[2*v+1];b>=e&&b<=n&&w>=t&&w<=r&&h.push(a[v]),(d===0?e<=b:t<=w)&&(u.push(m),u.push(v-1),u.push(1-d)),(d===0?n>=b:r>=w)&&(u.push(v+1),u.push(f),u.push(1-d))}return h}within(e,t,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:r,coords:a,nodeSize:o}=this,s=[0,r.length-1,0],u=[],h=n*n;for(;s.length;){let d=s.pop()||0,f=s.pop()||0,m=s.pop()||0;if(f-m<=o){for(let A=m;A<=f;A++)nE(a[2*A],a[2*A+1],e,t)<=h&&u.push(r[A]);continue}let v=m+f>>1,b=a[2*v],w=a[2*v+1];nE(b,w,e,t)<=h&&u.push(r[v]),(d===0?e-n<=b:t-n<=w)&&(s.push(m),s.push(v-1),s.push(1-d)),(d===0?e+n>=b:t+n>=w)&&(s.push(v+1),s.push(f),s.push(1-d))}return u}};l(pY,"KDBush");var X1e=pY;function cw(i,e,t,n,r,a){if(r-n<=t)return;let o=n+r>>1;bL(i,e,o,n,r,a),cw(i,e,t,n,o-1,1-a),cw(i,e,t,o+1,r,1-a)}l(cw,"sort");function bL(i,e,t,n,r,a){for(;r>n;){if(r-n>600){let h=r-n+1,d=t-n+1,f=Math.log(h),m=.5*Math.exp(2*f/3),v=.5*Math.sqrt(f*m*(h-m)/h)*(d-h/2<0?-1:1),b=Math.max(n,Math.floor(t-d*m/h+v)),w=Math.min(r,Math.floor(t+(h-d)*m/h+v));bL(i,e,t,b,w,a)}let o=e[2*t+a],s=n,u=r;for(wf(i,e,n,t),e[2*r+a]>o&&wf(i,e,n,r);s<u;){for(wf(i,e,s,u),s++,u--;e[2*s+a]<o;)s++;for(;e[2*u+a]>o;)u--}e[2*n+a]===o?wf(i,e,n,u):(u++,wf(i,e,u,r)),u<=t&&(n=u+1),t<=u&&(r=u-1)}}l(bL,"select");function wf(i,e,t,n){mx(i,t,n),mx(e,2*t,2*n),mx(e,2*t+1,2*n+1)}l(wf,"swapItem");function mx(i,e,t){let n=i[e];i[e]=i[t],i[t]=n}l(mx,"swap");function nE(i,e,t,n){let r=i-t,a=e-n;return r*r+a*a}l(nE,"sqDist");var yy=512/8192/2,Z1e=128,fY=class{constructor(e,t,n){this.tileID=e,this.bucketInstanceId=n,this._symbolsByKey={};let r=new Map;for(let a=0;a<t.length;a++){let o=t.get(a),s=o.key,u=r.get(s);u?u.push(o):r.set(s,[o])}for(let[a,o]of r){let s=o.map(d=>({x:Math.floor(d.anchorX*yy),y:Math.floor(d.anchorY*yy)})),u=o.map(d=>d.crossTileID),h={positions:s,crossTileIDs:u};if(h.positions.length>Z1e){let d=new X1e(h.positions.length,16,Uint16Array);for(let{x:f,y:m}of h.positions)d.add(f,m);d.finish(),delete h.positions,h.index=d}this._symbolsByKey[a]=h}}getScaledCoordinates(e,t){let{x:n,y:r,z:a}=this.tileID.canonical,{x:o,y:s,z:u}=t.canonical,h=u-a,d=yy/Math.pow(2,h),f=(o*8192+e.anchorX)*d,m=(s*8192+e.anchorY)*d,v=n*8192*yy,b=r*8192*yy;return{x:Math.floor(f-v),y:Math.floor(m-b)}}findMatches(e,t,n){let r=this.tileID.canonical.z<t.canonical.z?1:Math.pow(2,this.tileID.canonical.z-t.canonical.z);for(let a=0;a<e.length;a++){let o=e.get(a);if(o.crossTileID)continue;let s=this._symbolsByKey[o.key];if(!s)continue;let u=this.getScaledCoordinates(o,t);if(s.index){let h=s.index.range(u.x-r,u.y-r,u.x+r,u.y+r).sort();for(let d of h){let f=s.crossTileIDs[d];if(!n[f]){n[f]=!0,o.crossTileID=f;break}}}else if(s.positions)for(let h=0;h<s.positions.length;h++){let d=s.positions[h],f=s.crossTileIDs[h];if(Math.abs(d.x-u.x)<=r&&Math.abs(d.y-u.y)<=r&&!n[f]){n[f]=!0,o.crossTileID=f;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}};l(fY,"TileLayerIndex");var Y1e=fY,mY=class{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}};l(mY,"CrossTileIDs");var J1e=mY,gY=class{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){let t=Math.round((e-this.lng)/360);if(t!==0)for(let n in this.indexes){let r=this.indexes[n],a={};for(let o in r){let s=r[o];s.tileID=s.tileID.unwrapTo(s.tileID.wrap+t),a[s.tileID.key]=s}this.indexes[n]=a}this.lng=e}addBucket(e,t,n){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let a=0;a<t.symbolInstances.length;a++){let o=t.symbolInstances.get(a);o.crossTileID=0}this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});let r=this.usedCrossTileIDs[e.overscaledZ];for(let a in this.indexes){let o=this.indexes[a];if(Number(a)>e.overscaledZ)for(let s in o){let u=o[s];u.tileID.isChildOf(e)&&u.findMatches(t.symbolInstances,e,r)}else{let s=e.scaledTo(Number(a)),u=o[s.key];u&&u.findMatches(t.symbolInstances,e,r)}}for(let a=0;a<t.symbolInstances.length;a++){let o=t.symbolInstances.get(a);o.crossTileID||(o.crossTileID=n.generate(),r[o.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Y1e(e,t.symbolInstances,t.bucketInstanceId),!0}removeBucketCrossTileIDs(e,t){for(let n of t.getCrossTileIDsLists())for(let r of n)delete this.usedCrossTileIDs[e][r]}removeStaleBuckets(e){let t=!1;for(let n in this.indexes){let r=this.indexes[n];for(let a in r)e[r[a].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,r[a]),delete r[a],t=!0)}return t}};l(gY,"CrossTileSymbolLayerIndex");var K1e=gY,yY=class{constructor(){this.layerIndexes={},this.crossTileIDs=new J1e,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,t,n){let r=this.layerIndexes[e.id];r===void 0&&(r=this.layerIndexes[e.id]=new K1e);let a=!1,o={};r.handleWrapJump(n);for(let s of t){let u=s.getBucket(e);!u||e.id!==u.layerIds[0]||(u.bucketInstanceId||(u.bucketInstanceId=++this.maxBucketInstanceId),r.addBucket(s.tileID,u,this.crossTileIDs)&&(a=!0),o[u.bucketInstanceId]=!0)}return r.removeStaleBuckets(o)&&(a=!0),a}pruneUnusedLayers(e){let t={};e.forEach(n=>{t[n]=!0});for(let n in this.layerIndexes)t[n]||delete this.layerIndexes[n]}};l(yY,"CrossTileSymbolIndex");var vY=yY,y_=l((i,e)=>fA(i,e&&e.filter(t=>t.identifier!=="source.canvas")),"emitValidationErrors"),Q1e=KV(),_Y=class extends uo{constructor(e,t={}){super(),this._rtlPluginLoaded=l(()=>{for(let n in this.sourceCaches){let r=this.sourceCaches[n].getSource().type;(r==="vector"||r==="geojson")&&this.sourceCaches[n].reload()}},"_rtlPluginLoaded"),this.map=e,this.dispatcher=new tZ(IA(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(n,r)=>this.getGlyphs(n,r)),this.dispatcher.registerMessageHandler("GI",(n,r)=>this.getImages(n,r)),this.imageManager=new e1e,this.imageManager.setEventedParent(this),this.glyphManager=new i1e(e._requestManager,t.localIdeographFontFamily),this.lineAtlas=new a1e(256,512),this.crossTileSymbolIndex=new vY,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new cj,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",a5()),_g().on(Z3,this._rtlPluginLoaded),this.on("data",n=>{if(n.dataType!=="source"||n.sourceDataType!=="metadata")return;let r=this.sourceCaches[n.sourceId];if(!r)return;let a=r.getSource();if(!(!a||!a.vectorLayerIds))for(let o in this._layers){let s=this._layers[o];s.source===a.id&&this._validateLayer(s)}})}loadURL(e,t={},n){this.fire(new Tt("dataloading",{dataType:"style"})),t.validate=typeof t.validate=="boolean"?t.validate:!0;let r=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController,Qw(r,this._loadStyleRequest).then(a=>{this._loadStyleRequest=null,this._load(a.data,t,n)}).catch(a=>{this._loadStyleRequest=null,a&&this.fire(new ki(a))})}loadJSON(e,t={},n){this.fire(new Tt("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,Mn.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,t.validate=t.validate!==!1,this._load(e,t,n)}).catch(()=>{})}loadEmpty(){this.fire(new Tt("dataloading",{dataType:"style"})),this._load(Q1e,{validate:!1})}_load(e,t,n){var r;let a=t.transformStyle?t.transformStyle(n,e):e;if(!(t.validate&&y_(this,wa(a)))){this._loaded=!0,this.stylesheet=a;for(let o in a.sources)this.addSource(o,a.sources[o],{validate:!1});a.sprite?this._loadSprite(a.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(a.glyphs),this._createLayers(),this.light=new r1e(this.stylesheet.light),this.map.setTerrain((r=this.stylesheet.terrain)!=null?r:null),this.fire(new Tt("data",{dataType:"style"})),this.fire(new Tt("style.load"))}}_createLayers(){let e=JC(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(t=>t.id),this._layers={},this._serializedLayers=null;for(let t of e){let n=px(t);n.setEventedParent(this,{layer:{id:t.id}}),this._layers[t.id]=n}}_loadSprite(e,t=!1,n=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController;let r;zX(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(a=>{if(this._spriteRequest=null,a)for(let o in a){this._spritesImagesIds[o]=[];let s=this._spritesImagesIds[o]?this._spritesImagesIds[o].filter(u=>!(u in a)):[];for(let u of s)this.imageManager.removeImage(u),this._changedImages[u]=!0;for(let u in a[o]){let h=o==="default"?u:"".concat(o,":").concat(u);this._spritesImagesIds[o].push(h),h in this.imageManager.images?this.imageManager.updateImage(h,a[o][u],!1):this.imageManager.addImage(h,a[o][u]),t&&(this._changedImages[h]=!0)}}}).catch(a=>{this._spriteRequest=null,r=a,this.fire(new ki(r))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),t&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new Tt("data",{dataType:"style"})),n&&n(r)})}_unloadSprite(){for(let e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new Tt("data",{dataType:"style"}))}_validateLayer(e){let t=this.sourceCaches[e.source];if(!t)return;let n=e.sourceLayer;if(!n)return;let r=t.getSource();(r.type==="geojson"||r.vectorLayerIds&&r.vectorLayerIds.indexOf(n)===-1)&&this.fire(new ki(new Error('Source layer "'.concat(n,'" ')+'does not exist on source "'.concat(r.id,'" ')+'as specified by style layer "'.concat(e.id,'".'))))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(let e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e){let t=this._serializedAllLayers();if(!e||e.length===0)return Object.values(t);let n=[];for(let r of e)t[r]&&n.push(t[r]);return n}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};let t=Object.keys(this._layers);for(let n of t){let r=this._layers[n];r.type!=="custom"&&(e[n]=r.serialize())}return e}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(let e in this.sourceCaches)if(this.sourceCaches[e].hasTransition())return!0;for(let e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;let t=this._changed;if(t){let r=Object.keys(this._updatedLayers),a=Object.keys(this._removedLayers);(r.length||a.length)&&this._updateWorkerLayers(r,a);for(let o in this._updatedSources){let s=this._updatedSources[o];if(s==="reload")this._reloadSource(o);else if(s==="clear")this._clearSource(o);else throw new Error("Invalid action ".concat(s))}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(let o in this._updatedPaintProps)this._layers[o].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates()}let n={};for(let r in this.sourceCaches){let a=this.sourceCaches[r];n[r]=a.used,a.used=!1}for(let r of this._order){let a=this._layers[r];a.recalculate(e,this._availableImages),!a.isHidden(e.zoom)&&a.source&&(this.sourceCaches[a.source].used=!0)}for(let r in n){let a=this.sourceCaches[r];!!n[r]!=!!a.used&&a.fire(new Tt("data",{sourceDataType:"visibility",dataType:"source",sourceId:r}))}this.light.recalculate(e),this.z=e.zoom,t&&this.fire(new Tt("data",{dataType:"style"}))}_updateTilesForChangedImages(){let e=Object.keys(this._changedImages);if(e.length){for(let t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(let e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,t){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e),removedIds:t})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,t={}){var n;this._checkLoaded();let r=this.serialize();if(e=t.transformStyle?t.transformStyle(r,e):e,((n=t.validate)!=null?n:!0)&&y_(this,wa(e)))return!1;e=cs(e),e.layers=JC(e.layers);let a=Mz(r,e),o=this._getOperationsToPerform(a);if(o.unimplemented.length>0)throw new Error("Unimplemented: ".concat(o.unimplemented.join(", "),"."));if(o.operations.length===0)return!1;for(let s of o.operations)s();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){let t=[],n=[];for(let r of e)switch(r.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":t.push(()=>this.addLayer.apply(this,r.args));break;case"removeLayer":t.push(()=>this.removeLayer.apply(this,r.args));break;case"setPaintProperty":t.push(()=>this.setPaintProperty.apply(this,r.args));break;case"setLayoutProperty":t.push(()=>this.setLayoutProperty.apply(this,r.args));break;case"setFilter":t.push(()=>this.setFilter.apply(this,r.args));break;case"addSource":t.push(()=>this.addSource.apply(this,r.args));break;case"removeSource":t.push(()=>this.removeSource.apply(this,r.args));break;case"setLayerZoomRange":t.push(()=>this.setLayerZoomRange.apply(this,r.args));break;case"setLight":t.push(()=>this.setLight.apply(this,r.args));break;case"setGeoJSONSourceData":t.push(()=>this.setGeoJSONSourceData.apply(this,r.args));break;case"setGlyphs":t.push(()=>this.setGlyphs.apply(this,r.args));break;case"setSprite":t.push(()=>this.setSprite.apply(this,r.args));break;case"setTerrain":t.push(()=>this.map.setTerrain.apply(this,r.args));break;case"setTransition":t.push(()=>{});break;default:n.push(r.command);break}return{operations:t,unimplemented:n}}addImage(e,t){if(this.getImage(e))return this.fire(new ki(new Error('An image named "'.concat(e,'" already exists.'))));this.imageManager.addImage(e,t),this._afterImageUpdated(e)}updateImage(e,t){this.imageManager.updateImage(e,t)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new ki(new Error('An image named "'.concat(e,'" does not exist.'))));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new Tt("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,t,n={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error('Source "'.concat(e,'" already exists.'));if(!t.type)throw new Error("The type property must be defined, but only the following properties were given: ".concat(Object.keys(t).join(", "),"."));if(["vector","raster","geojson","video","image"].indexOf(t.type)>=0&&this._validate(wa.source,"sources.".concat(e),t,null,n))return;this.map&&this.map._collectResourceTiming&&(t.collectResourceTiming=!0);let r=this.sourceCaches[e]=new c1(e,t,this.dispatcher);r.style=this,r.setEventedParent(this,()=>({isSourceLoaded:r.loaded(),source:r.serialize(),sourceId:e})),r.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(let n in this._layers)if(this._layers[n].source===e)return this.fire(new ki(new Error('Source "'.concat(e,'" cannot be removed while layer "').concat(n,'" is using it.'))));let t=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],t.fire(new Tt("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),t.setEventedParent(null),t.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,t){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID=".concat(e));let n=this.sourceCaches[e].getSource();if(n.type!=="geojson")throw new Error("geojsonSource.type is ".concat(n.type,", which is !== 'geojson"));n.setData(t),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,t,n={}){this._checkLoaded();let r=e.id;if(this.getLayer(r)){this.fire(new ki(new Error('Layer "'.concat(r,'" already exists on this map.'))));return}let a;if(e.type==="custom"){if(y_(this,FX(e)))return;a=px(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(r,e.source),e=cs(e),e=ti(e,{source:r})),this._validate(wa.layer,"layers.".concat(r),e,{arrayIndex:-1},n))return;a=px(e),this._validateLayer(a),a.setEventedParent(this,{layer:{id:r}})}let o=t?this._order.indexOf(t):this._order.length;if(t&&o===-1){this.fire(new ki(new Error('Cannot add layer "'.concat(r,'" before non-existing layer "').concat(t,'".'))));return}if(this._order.splice(o,0,r),this._layerOrderChanged=!0,this._layers[r]=a,this._removedLayers[r]&&a.source&&a.type!=="custom"){let s=this._removedLayers[r];delete this._removedLayers[r],s.type!==a.type?this._updatedSources[a.source]="clear":(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause())}this._updateLayer(a),a.onAdd&&a.onAdd(this.map)}moveLayer(e,t){if(this._checkLoaded(),this._changed=!0,!this._layers[e]){this.fire(new ki(new Error("The layer '".concat(e,"' does not exist in the map's style and cannot be moved."))));return}if(e===t)return;let n=this._order.indexOf(e);this._order.splice(n,1);let r=t?this._order.indexOf(t):this._order.length;if(t&&r===-1){this.fire(new ki(new Error('Cannot move layer "'.concat(e,'" before non-existing layer "').concat(t,'".'))));return}this._order.splice(r,0,e),this._layerOrderChanged=!0}removeLayer(e){this._checkLoaded();let t=this._layers[e];if(!t){this.fire(new ki(new Error('Cannot remove non-existing layer "'.concat(e,'".'))));return}t.setEventedParent(null);let n=this._order.indexOf(e);this._order.splice(n,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=t,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],t.onRemove&&t.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,t,n){this._checkLoaded();let r=this.getLayer(e);if(!r){this.fire(new ki(new Error('Cannot set the zoom range of non-existing layer "'.concat(e,'".'))));return}r.minzoom===t&&r.maxzoom===n||(t!=null&&(r.minzoom=t),n!=null&&(r.maxzoom=n),this._updateLayer(r))}setFilter(e,t,n={}){this._checkLoaded();let r=this.getLayer(e);if(!r){this.fire(new ki(new Error('Cannot filter non-existing layer "'.concat(e,'".'))));return}if(!Cc(r.filter,t)){if(t==null){r.filter=void 0,this._updateLayer(r);return}this._validate(wa.filter,"layers.".concat(r.id,".filter"),t,null,n)||(r.filter=cs(t),this._updateLayer(r))}}getFilter(e){return cs(this.getLayer(e).filter)}setLayoutProperty(e,t,n,r={}){this._checkLoaded();let a=this.getLayer(e);if(!a){this.fire(new ki(new Error('Cannot style non-existing layer "'.concat(e,'".'))));return}Cc(a.getLayoutProperty(t),n)||(a.setLayoutProperty(t,n,r),this._updateLayer(a))}getLayoutProperty(e,t){let n=this.getLayer(e);if(!n){this.fire(new ki(new Error('Cannot get style of non-existing layer "'.concat(e,'".'))));return}return n.getLayoutProperty(t)}setPaintProperty(e,t,n,r={}){this._checkLoaded();let a=this.getLayer(e);if(!a){this.fire(new ki(new Error('Cannot style non-existing layer "'.concat(e,'".'))));return}Cc(a.getPaintProperty(t),n)||(a.setPaintProperty(t,n,r)&&this._updateLayer(a),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null)}getPaintProperty(e,t){return this.getLayer(e).getPaintProperty(t)}setFeatureState(e,t){this._checkLoaded();let n=e.source,r=e.sourceLayer,a=this.sourceCaches[n];if(a===void 0){this.fire(new ki(new Error("The source '".concat(n,"' does not exist in the map's style."))));return}let o=a.getSource().type;if(o==="geojson"&&r){this.fire(new ki(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));return}if(o==="vector"&&!r){this.fire(new ki(new Error("The sourceLayer parameter must be provided for vector source types.")));return}e.id===void 0&&this.fire(new ki(new Error("The feature id parameter must be provided."))),a.setFeatureState(r,e.id,t)}removeFeatureState(e,t){this._checkLoaded();let n=e.source,r=this.sourceCaches[n];if(r===void 0){this.fire(new ki(new Error("The source '".concat(n,"' does not exist in the map's style."))));return}let a=r.getSource().type,o=a==="vector"?e.sourceLayer:void 0;if(a==="vector"&&!o){this.fire(new ki(new Error("The sourceLayer parameter must be provided for vector source types.")));return}if(t&&typeof e.id!="string"&&typeof e.id!="number"){this.fire(new ki(new Error("A feature id is required to remove its specific state property.")));return}r.removeFeatureState(o,e.id,t)}getFeatureState(e){this._checkLoaded();let t=e.source,n=e.sourceLayer,r=this.sourceCaches[t];if(r===void 0){this.fire(new ki(new Error("The source '".concat(t,"' does not exist in the map's style."))));return}if(r.getSource().type==="vector"&&!n){this.fire(new ki(new Error("The sourceLayer parameter must be provided for vector source types.")));return}return e.id===void 0&&this.fire(new ki(new Error("The feature id parameter must be provided."))),r.getFeatureState(n,e.id)}getTransition(){return ti({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;let e=Jw(this.sourceCaches,a=>a.serialize()),t=this._serializeByIds(this._order),n=this.map.getTerrain()||void 0,r=this.stylesheet;return i5({version:r.version,name:r.name,metadata:r.metadata,light:r.light,center:r.center,zoom:r.zoom,bearing:r.bearing,pitch:r.pitch,sprite:r.sprite,glyphs:r.glyphs,transition:r.transition,sources:e,layers:t,terrain:n},a=>a!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){let t=l(o=>this._layers[o].type==="fill-extrusion","isLayer3D"),n={},r=[];for(let o=this._order.length-1;o>=0;o--){let s=this._order[o];if(t(s)){n[s]=o;for(let u of e){let h=u[s];if(h)for(let d of h)r.push(d)}}}r.sort((o,s)=>s.intersectionZ-o.intersectionZ);let a=[];for(let o=this._order.length-1;o>=0;o--){let s=this._order[o];if(t(s))for(let u=r.length-1;u>=0;u--){let h=r[u].feature;if(n[h.layer.id]<o)break;a.push(h),r.pop()}else for(let u of e){let h=u[s];if(h)for(let d of h)a.push(d.feature)}}return a}queryRenderedFeatures(e,t,n){t&&t.filter&&this._validate(wa.filter,"queryRenderedFeatures.filter",t.filter,null,t);let r={};if(t&&t.layers){if(!Array.isArray(t.layers))return this.fire(new ki(new Error("parameters.layers must be an Array."))),[];for(let s of t.layers){let u=this._layers[s];if(!u)return this.fire(new ki(new Error("The layer '".concat(s,"' does not exist in the map's style and cannot be queried for features.")))),[];r[u.source]=!0}}let a=[];t.availableImages=this._availableImages;let o=this._serializedAllLayers();for(let s in this.sourceCaches)t.layers&&!r[s]||a.push(rZ(this.sourceCaches[s],this._layers,o,e,t,n));return this.placement&&a.push(aZ(this._layers,o,this.sourceCaches,e,t,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(a)}querySourceFeatures(e,t){t&&t.filter&&this._validate(wa.filter,"querySourceFeatures.filter",t.filter,null,t);let n=this.sourceCaches[e];return n?oZ(n,t):[]}getLight(){return this.light.getLight()}setLight(e,t={}){this._checkLoaded();let n=this.light.getLight(),r=!1;for(let o in e)if(!Cc(e[o],n[o])){r=!0;break}if(!r)return;let a={now:Mn.now(),transition:ti({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,t),this.light.updateTransitions(a)}_validate(e,t,n,r,a={}){return a&&a.validate===!1?!1:y_(this,e.call(wa,ti({key:t,style:this.serialize(),value:n,styleSpec:ht},r)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),_g().off(Z3,this._rtlPluginLoaded);for(let t in this._layers)this._layers[t].setEventedParent(null);for(let t in this.sourceCaches){let n=this.sourceCaches[t];n.setEventedParent(null),n.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(let t in this.sourceCaches)this.sourceCaches[t].update(e,this.map.terrain)}_generateCollisionBoxes(){for(let e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,t,n,r,a=!1){let o=!1,s=!1,u={};for(let h of this._order){let d=this._layers[h];if(d.type!=="symbol")continue;if(!u[d.source]){let m=this.sourceCaches[d.source];u[d.source]=m.getRenderableIds(!0).map(v=>m.getTileByID(v)).sort((v,b)=>b.tileID.overscaledZ-v.tileID.overscaledZ||(v.tileID.isLessThan(b.tileID)?-1:1))}let f=this.crossTileSymbolIndex.addLayer(d,u[d.source],e.center.lng);o=o||f}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),a=a||this._layerOrderChanged||n===0,(a||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Mn.now(),e.zoom))&&(this.pauseablePlacement=new q1e(e,this.map.terrain,this._order,a,t,n,r,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,u),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Mn.now()),s=!0),o&&this.pauseablePlacement.placement.setStale()),s||o)for(let h of this._order){let d=this._layers[h];d.type==="symbol"&&this.placement.updateLayerOpacities(d,u[d.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Mn.now())}_releaseSymbolFadeTiles(){for(let e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}async getImages(e,t){let n=await this.imageManager.getImages(t.icons);this._updateTilesForChangedImages();let r=this.sourceCaches[t.source];return r&&r.setDependencies(t.tileID.key,t.type,t.icons),n}async getGlyphs(e,t){let n=await this.glyphManager.getGlyphs(t.stacks),r=this.sourceCaches[t.source];return r&&r.setDependencies(t.tileID.key,t.type,[""]),n}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,t={}){this._checkLoaded(),!(e&&this._validate(wa.glyphs,"glyphs",e,null,t))&&(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,t,n={},r){this._checkLoaded();let a=[{id:e,url:t}],o=[...Vv(this.stylesheet.sprite),...a];this._validate(wa.sprite,"sprite",o,null,n)||(this.stylesheet.sprite=o,this._loadSprite(a,!0,r))}removeSprite(e){this._checkLoaded();let t=Vv(this.stylesheet.sprite);if(!t.find(n=>n.id===e)){this.fire(new ki(new Error('Sprite "'.concat(e,`" doesn't exists on this map.`))));return}if(this._spritesImagesIds[e])for(let n of this._spritesImagesIds[e])this.imageManager.removeImage(n),this._changedImages[n]=!0;t.splice(t.findIndex(n=>n.id===e),1),this.stylesheet.sprite=t.length>0?t:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new Tt("data",{dataType:"style"}))}getSprite(){return Vv(this.stylesheet.sprite)}setSprite(e,t={},n){this._checkLoaded(),!(e&&this._validate(wa.sprite,"sprite",e,null,t))&&(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,n):(this._unloadSprite(),n&&n(null)))}};l(_Y,"Style");var mR=_Y;R();R();var iM=Ir([{name:"a_pos",type:"Int16",components:2}]);R();R();var e0e=`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`;R();var t0e=`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`;R();var i0e=`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var n0e="attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}";R();var r0e=`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var a0e="uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}";R();var o0e=`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var s0e=`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`;R();var l0e="void main() {gl_FragColor=vec4(1.0);}";R();var u0e="attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}";R();var h0e=`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var c0e=`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`;R();var p0e=`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`;R();var d0e="uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}";R();var f0e="varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}";R();var m0e="attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}";R();var g0e="varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}";R();var y0e="attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}";R();var v0e="uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}";R();var _0e="attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}";R();var x0e=`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var b0e=`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`;R();var w0e=`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var A0e=`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`;R();var S0e=`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var M0e=`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`;R();var C0e=`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var E0e=`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`;R();var I0e=`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var T0e=`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`;R();var P0e=`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var L0e=`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`;R();var D0e=`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var k0e="uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}";R();var R0e=`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var O0e="uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}";R();var N0e=`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var F0e=`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`;R();var B0e=`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var z0e=`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`;R();var U0e=`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var V0e=`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`;R();var j0e=`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var G0e=`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`;R();var $0e=`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var H0e="uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}";R();var W0e=`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var q0e=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`;R();var X0e=`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var Z0e=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`;R();var Y0e=`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var J0e=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`;R();var K0e="varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}";R();var Q0e="precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}";R();var e_e="uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}";R();var nM="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}",Xy={prelude:zn(e0e,t0e),background:zn(i0e,n0e),backgroundPattern:zn(r0e,a0e),circle:zn(o0e,s0e),clippingMask:zn(l0e,u0e),heatmap:zn(h0e,c0e),heatmapTexture:zn(p0e,d0e),collisionBox:zn(f0e,m0e),collisionCircle:zn(g0e,y0e),debug:zn(v0e,_0e),fill:zn(x0e,b0e),fillOutline:zn(w0e,A0e),fillOutlinePattern:zn(S0e,M0e),fillPattern:zn(C0e,E0e),fillExtrusion:zn(I0e,T0e),fillExtrusionPattern:zn(P0e,L0e),hillshadePrepare:zn(D0e,k0e),hillshade:zn(R0e,O0e),line:zn(N0e,F0e),lineGradient:zn(B0e,z0e),linePattern:zn(U0e,V0e),lineSDF:zn(j0e,G0e),raster:zn($0e,H0e),symbolIcon:zn(W0e,q0e),symbolSDF:zn(X0e,Z0e),symbolTextAndIcon:zn(Y0e,J0e),terrain:zn(e_e,nM),terrainDepth:zn(K0e,nM),terrainCoords:zn(Q0e,nM)};function zn(i,e){let t=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,n=e.match(/attribute ([\w]+) ([\w]+)/g),r=i.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=a?a.concat(r):r,s={};return i=i.replace(t,(u,h,d,f,m)=>(s[m]=!0,h==="define"?`
#ifndef HAS_UNIFORM_u_`.concat(m,`
varying `).concat(d," ").concat(f," ").concat(m,`;
#else
uniform `).concat(d," ").concat(f," u_").concat(m,`;
#endif
`):`
#ifdef HAS_UNIFORM_u_`.concat(m,`
    `).concat(d," ").concat(f," ").concat(m," = u_").concat(m,`;
#endif
`))),e=e.replace(t,(u,h,d,f,m)=>{let v=f==="float"?"vec2":"vec4",b=m.match(/color/)?"color":v;return s[m]?h==="define"?`
#ifndef HAS_UNIFORM_u_`.concat(m,`
uniform lowp float u_`).concat(m,`_t;
attribute `).concat(d," ").concat(v," a_").concat(m,`;
varying `).concat(d," ").concat(f," ").concat(m,`;
#else
uniform `).concat(d," ").concat(f," u_").concat(m,`;
#endif
`):b==="vec4"?`
#ifndef HAS_UNIFORM_u_`.concat(m,`
    `).concat(m," = a_").concat(m,`;
#else
    `).concat(d," ").concat(f," ").concat(m," = u_").concat(m,`;
#endif
`):`
#ifndef HAS_UNIFORM_u_`.concat(m,`
    `).concat(m," = unpack_mix_").concat(b,"(a_").concat(m,", u_").concat(m,`_t);
#else
    `).concat(d," ").concat(f," ").concat(m," = u_").concat(m,`;
#endif
`):h==="define"?`
#ifndef HAS_UNIFORM_u_`.concat(m,`
uniform lowp float u_`).concat(m,`_t;
attribute `).concat(d," ").concat(v," a_").concat(m,`;
#else
uniform `).concat(d," ").concat(f," u_").concat(m,`;
#endif
`):b==="vec4"?`
#ifndef HAS_UNIFORM_u_`.concat(m,`
    `).concat(d," ").concat(f," ").concat(m," = a_").concat(m,`;
#else
    `).concat(d," ").concat(f," ").concat(m," = u_").concat(m,`;
#endif
`):`
#ifndef HAS_UNIFORM_u_`.concat(m,`
    `).concat(d," ").concat(f," ").concat(m," = unpack_mix_").concat(b,"(a_").concat(m,", u_").concat(m,`_t);
#else
    `).concat(d," ").concat(f," ").concat(m," = u_").concat(m,`;
#endif
`)}),{fragmentSource:i,vertexSource:e,staticAttributes:n,staticUniforms:o}}l(zn,"compile");R();R();var xY=class{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,t,n,r,a,o,s,u,h){this.context=e;let d=this.boundPaintVertexBuffers.length!==r.length;for(let f=0;!d&&f<r.length;f++)this.boundPaintVertexBuffers[f]!==r[f]&&(d=!0);!this.vao||this.boundProgram!==t||this.boundLayoutVertexBuffer!==n||d||this.boundIndexBuffer!==a||this.boundVertexOffset!==o||this.boundDynamicVertexBuffer!==s||this.boundDynamicVertexBuffer2!==u||this.boundDynamicVertexBuffer3!==h?this.freshBind(t,n,r,a,o,s,u,h):(e.bindVertexArray.set(this.vao),s&&s.bind(),a&&a.dynamicDraw&&a.bind(),u&&u.bind(),h&&h.bind())}freshBind(e,t,n,r,a,o,s,u){let h=e.numAttributes,d=this.context,f=d.gl;this.vao&&this.destroy(),this.vao=d.createVertexArray(),d.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=r,this.boundVertexOffset=a,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=s,this.boundDynamicVertexBuffer3=u,t.enableAttributes(f,e);for(let m of n)m.enableAttributes(f,e);o&&o.enableAttributes(f,e),s&&s.enableAttributes(f,e),u&&u.enableAttributes(f,e),t.bind(),t.setVertexAttribPointers(f,e,a);for(let m of n)m.bind(),m.setVertexAttribPointers(f,e,a);o&&(o.bind(),o.setVertexAttribPointers(f,e,a)),r&&r.bind(),s&&(s.bind(),s.setVertexAttribPointers(f,e,a)),u&&(u.bind(),u.setVertexAttribPointers(f,e,a)),d.currentNumAttributes=h}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}};l(xY,"VertexArrayObject");var t_e=xY;R();var i_e=l((i,e)=>({u_depth:new rn(i,e.u_depth),u_terrain:new rn(i,e.u_terrain),u_terrain_dim:new Ht(i,e.u_terrain_dim),u_terrain_matrix:new Cn(i,e.u_terrain_matrix),u_terrain_unpack:new f4(i,e.u_terrain_unpack),u_terrain_exaggeration:new Ht(i,e.u_terrain_exaggeration)}),"terrainPreludeUniforms"),n_e=l((i,e)=>({u_matrix:new Cn(i,e.u_matrix),u_texture:new rn(i,e.u_texture),u_ele_delta:new Ht(i,e.u_ele_delta)}),"terrainUniforms"),r_e=l((i,e)=>({u_matrix:new Cn(i,e.u_matrix),u_ele_delta:new Ht(i,e.u_ele_delta)}),"terrainDepthUniforms"),a_e=l((i,e)=>({u_matrix:new Cn(i,e.u_matrix),u_texture:new rn(i,e.u_texture),u_terrain_coords_id:new Ht(i,e.u_terrain_coords_id),u_ele_delta:new Ht(i,e.u_ele_delta)}),"terrainCoordsUniforms"),o_e=l((i,e)=>({u_matrix:i,u_texture:0,u_ele_delta:e}),"terrainUniformValues"),s_e=l((i,e)=>({u_matrix:i,u_ele_delta:e}),"terrainDepthUniformValues"),l_e=l((i,e,t)=>({u_matrix:i,u_terrain_coords_id:e/255,u_texture:0,u_ele_delta:t}),"terrainCoordsUniformValues");function gx(i){let e=[];for(let t=0;t<i.length;t++){if(i[t]===null)continue;let n=i[t].split(" ");e.push(n.pop())}return e}l(gx,"getTokenizedAttributesAndUniforms");var bY=class{constructor(e,t,n,r,a,o){let s=e.gl;this.program=s.createProgram();let u=gx(t.staticAttributes),h=n?n.getBinderAttributes():[],d=u.concat(h),f=Xy.prelude.staticUniforms?gx(Xy.prelude.staticUniforms):[],m=t.staticUniforms?gx(t.staticUniforms):[],v=n?n.getBinderUniforms():[],b=f.concat(m).concat(v),w=[];for(let F of b)w.indexOf(F)<0&&w.push(F);let A=n?n.defines():[];a&&A.push("#define OVERDRAW_INSPECTOR;"),o&&A.push("#define TERRAIN3D;");let E=A.concat(Xy.prelude.fragmentSource,t.fragmentSource).join(`
`),I=A.concat(Xy.prelude.vertexSource,t.vertexSource).join(`
`),C=s.createShader(s.FRAGMENT_SHADER);if(s.isContextLost()){this.failedToCreate=!0;return}if(s.shaderSource(C,E),s.compileShader(C),!s.getShaderParameter(C,s.COMPILE_STATUS))throw new Error("Could not compile fragment shader: ".concat(s.getShaderInfoLog(C)));s.attachShader(this.program,C);let T=s.createShader(s.VERTEX_SHADER);if(s.isContextLost()){this.failedToCreate=!0;return}if(s.shaderSource(T,I),s.compileShader(T),!s.getShaderParameter(T,s.COMPILE_STATUS))throw new Error("Could not compile vertex shader: ".concat(s.getShaderInfoLog(T)));s.attachShader(this.program,T),this.attributes={};let k={};this.numAttributes=d.length;for(let F=0;F<this.numAttributes;F++)d[F]&&(s.bindAttribLocation(this.program,F,d[F]),this.attributes[d[F]]=F);if(s.linkProgram(this.program),!s.getProgramParameter(this.program,s.LINK_STATUS))throw new Error("Program failed to link: ".concat(s.getProgramInfoLog(this.program)));s.deleteShader(T),s.deleteShader(C);for(let F=0;F<w.length;F++){let B=w[F];if(B&&!k[B]){let N=s.getUniformLocation(this.program,B);N&&(k[B]=N)}}this.fixedUniforms=r(e,k),this.terrainUniforms=i_e(e,k),this.binderUniforms=n?n.getUniforms(e,k):[]}draw(e,t,n,r,a,o,s,u,h,d,f,m,v,b,w,A,E,I){let C=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(n),e.setStencilMode(r),e.setColorMode(a),e.setCullFace(o),u){e.activeTexture.set(C.TEXTURE2),C.bindTexture(C.TEXTURE_2D,u.depthTexture),e.activeTexture.set(C.TEXTURE3),C.bindTexture(C.TEXTURE_2D,u.texture);for(let k in this.terrainUniforms)this.terrainUniforms[k].set(u[k])}for(let k in this.fixedUniforms)this.fixedUniforms[k].set(s[k]);w&&w.setUniforms(e,this.binderUniforms,v,{zoom:b});let T=0;switch(t){case C.LINES:T=2;break;case C.TRIANGLES:T=3;break;case C.LINE_STRIP:T=1;break}for(let k of m.get()){let F=k.vaos||(k.vaos={});(F[h]||(F[h]=new t_e)).bind(e,this,d,w?w.getPaintVertexBuffers():[],f,k.vertexOffset,A,E,I),C.drawElements(t,k.primitiveLength*T,C.UNSIGNED_SHORT,k.primitiveOffset*T*2)}}};l(bY,"Program");var u_e=bY;R();R();R();function wL(i,e,t){let n=1/qo(t,1,e.transform.tileZoom),r=Math.pow(2,t.tileID.overscaledZ),a=t.tileSize*Math.pow(2,e.transform.tileZoom)/r,o=a*(t.tileID.canonical.x+t.tileID.wrap*r),s=a*t.tileID.canonical.y;return{u_image:0,u_texsize:t.imageAtlasTexture.size,u_scale:[n,i.fromScale,i.toScale],u_fade:i.t,u_pixel_coord_upper:[o>>16,s>>16],u_pixel_coord_lower:[o&65535,s&65535]}}l(wL,"patternUniformValues");function wY(i,e,t,n){let r=t.imageManager.getPattern(i.from.toString()),a=t.imageManager.getPattern(i.to.toString()),{width:o,height:s}=t.imageManager.getPixelSize(),u=Math.pow(2,n.tileID.overscaledZ),h=n.tileSize*Math.pow(2,t.transform.tileZoom)/u,d=h*(n.tileID.canonical.x+n.tileID.wrap*u),f=h*n.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:r.tl,u_pattern_br_a:r.br,u_pattern_tl_b:a.tl,u_pattern_br_b:a.br,u_texsize:[o,s],u_mix:e.t,u_pattern_size_a:r.displaySize,u_pattern_size_b:a.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/qo(n,1,t.transform.tileZoom),u_pixel_coord_upper:[d>>16,f>>16],u_pixel_coord_lower:[d&65535,f&65535]}}l(wY,"bgPatternUniformValues");var h_e=l((i,e)=>({u_matrix:new Cn(i,e.u_matrix),u_lightpos:new ch(i,e.u_lightpos),u_lightintensity:new Ht(i,e.u_lightintensity),u_lightcolor:new ch(i,e.u_lightcolor),u_vertical_gradient:new Ht(i,e.u_vertical_gradient),u_opacity:new Ht(i,e.u_opacity)}),"fillExtrusionUniforms"),c_e=l((i,e)=>({u_matrix:new Cn(i,e.u_matrix),u_lightpos:new ch(i,e.u_lightpos),u_lightintensity:new Ht(i,e.u_lightintensity),u_lightcolor:new ch(i,e.u_lightcolor),u_vertical_gradient:new Ht(i,e.u_vertical_gradient),u_height_factor:new Ht(i,e.u_height_factor),u_image:new rn(i,e.u_image),u_texsize:new mn(i,e.u_texsize),u_pixel_coord_upper:new mn(i,e.u_pixel_coord_upper),u_pixel_coord_lower:new mn(i,e.u_pixel_coord_lower),u_scale:new ch(i,e.u_scale),u_fade:new Ht(i,e.u_fade),u_opacity:new Ht(i,e.u_opacity)}),"fillExtrusionPatternUniforms"),AY=l((i,e,t,n)=>{let r=e.style.light,a=r.properties.get("position"),o=[a.x,a.y,a.z],s=R3.create();r.properties.get("anchor")==="viewport"&&R3.fromRotation(s,-e.transform.angle),dl.transformMat3(o,o,s);let u=r.properties.get("color");return{u_matrix:i,u_lightpos:o,u_lightintensity:r.properties.get("intensity"),u_lightcolor:[u.r,u.g,u.b],u_vertical_gradient:+t,u_opacity:n}},"fillExtrusionUniformValues"),p_e=l((i,e,t,n,r,a,o)=>ti(AY(i,e,t,n),wL(a,e,o),{u_height_factor:-Math.pow(2,r.overscaledZ)/o.tileSize/8}),"fillExtrusionPatternUniformValues");R();var d_e=l((i,e)=>({u_matrix:new Cn(i,e.u_matrix)}),"fillUniforms"),f_e=l((i,e)=>({u_matrix:new Cn(i,e.u_matrix),u_image:new rn(i,e.u_image),u_texsize:new mn(i,e.u_texsize),u_pixel_coord_upper:new mn(i,e.u_pixel_coord_upper),u_pixel_coord_lower:new mn(i,e.u_pixel_coord_lower),u_scale:new ch(i,e.u_scale),u_fade:new Ht(i,e.u_fade)}),"fillPatternUniforms"),m_e=l((i,e)=>({u_matrix:new Cn(i,e.u_matrix),u_world:new mn(i,e.u_world)}),"fillOutlineUniforms"),g_e=l((i,e)=>({u_matrix:new Cn(i,e.u_matrix),u_world:new mn(i,e.u_world),u_image:new rn(i,e.u_image),u_texsize:new mn(i,e.u_texsize),u_pixel_coord_upper:new mn(i,e.u_pixel_coord_upper),u_pixel_coord_lower:new mn(i,e.u_pixel_coord_lower),u_scale:new ch(i,e.u_scale),u_fade:new Ht(i,e.u_fade)}),"fillOutlinePatternUniforms"),SY=l(i=>({u_matrix:i}),"fillUniformValues"),MY=l((i,e,t,n)=>ti(SY(i),wL(t,e,n)),"fillPatternUniformValues"),y_e=l((i,e)=>({u_matrix:i,u_world:e}),"fillOutlineUniformValues"),v_e=l((i,e,t,n,r)=>ti(MY(i,e,t,n),{u_world:r}),"fillOutlinePatternUniformValues");R();var __e=l((i,e)=>({u_camera_to_center_distance:new Ht(i,e.u_camera_to_center_distance),u_scale_with_map:new rn(i,e.u_scale_with_map),u_pitch_with_map:new rn(i,e.u_pitch_with_map),u_extrude_scale:new mn(i,e.u_extrude_scale),u_device_pixel_ratio:new Ht(i,e.u_device_pixel_ratio),u_matrix:new Cn(i,e.u_matrix)}),"circleUniforms"),x_e=l((i,e,t,n)=>{let r=i.transform,a,o;if(n.paint.get("circle-pitch-alignment")==="map"){let s=qo(t,1,r.zoom);a=!0,o=[s,s]}else a=!1,o=r.pixelsToGLUnits;return{u_camera_to_center_distance:r.cameraToCenterDistance,u_scale_with_map:+(n.paint.get("circle-pitch-scale")==="map"),u_matrix:i.translatePosMatrix(e.posMatrix,t,n.paint.get("circle-translate"),n.paint.get("circle-translate-anchor")),u_pitch_with_map:+a,u_device_pixel_ratio:i.pixelRatio,u_extrude_scale:o}},"circleUniformValues");R();var b_e=l((i,e)=>({u_matrix:new Cn(i,e.u_matrix),u_camera_to_center_distance:new Ht(i,e.u_camera_to_center_distance),u_pixels_to_tile_units:new Ht(i,e.u_pixels_to_tile_units),u_extrude_scale:new mn(i,e.u_extrude_scale),u_overscale_factor:new Ht(i,e.u_overscale_factor)}),"collisionUniforms"),w_e=l((i,e)=>({u_matrix:new Cn(i,e.u_matrix),u_inv_matrix:new Cn(i,e.u_inv_matrix),u_camera_to_center_distance:new Ht(i,e.u_camera_to_center_distance),u_viewport_size:new mn(i,e.u_viewport_size)}),"collisionCircleUniforms"),A_e=l((i,e,t)=>{let n=qo(t,1,e.zoom),r=Math.pow(2,e.zoom-t.tileID.overscaledZ),a=t.tileID.overscaleFactor();return{u_matrix:i,u_camera_to_center_distance:e.cameraToCenterDistance,u_pixels_to_tile_units:n,u_extrude_scale:[e.pixelsToGLUnits[0]/(n*r),e.pixelsToGLUnits[1]/(n*r)],u_overscale_factor:a}},"collisionUniformValues"),S_e=l((i,e,t)=>({u_matrix:i,u_inv_matrix:e,u_camera_to_center_distance:t.cameraToCenterDistance,u_viewport_size:[t.width,t.height]}),"collisionCircleUniformValues");R();var M_e=l((i,e)=>({u_color:new Hm(i,e.u_color),u_matrix:new Cn(i,e.u_matrix),u_overlay:new rn(i,e.u_overlay),u_overlay_scale:new Ht(i,e.u_overlay_scale)}),"debugUniforms"),gR=l((i,e,t=1)=>({u_matrix:i,u_color:e,u_overlay:0,u_overlay_scale:t}),"debugUniformValues");R();var C_e=l((i,e)=>({u_matrix:new Cn(i,e.u_matrix)}),"clippingMaskUniforms"),yR=l(i=>({u_matrix:i}),"clippingMaskUniformValues");R();var E_e=l((i,e)=>({u_extrude_scale:new Ht(i,e.u_extrude_scale),u_intensity:new Ht(i,e.u_intensity),u_matrix:new Cn(i,e.u_matrix)}),"heatmapUniforms"),I_e=l((i,e)=>({u_matrix:new Cn(i,e.u_matrix),u_world:new mn(i,e.u_world),u_image:new rn(i,e.u_image),u_color_ramp:new rn(i,e.u_color_ramp),u_opacity:new Ht(i,e.u_opacity)}),"heatmapTextureUniforms"),T_e=l((i,e,t,n)=>({u_matrix:i,u_extrude_scale:qo(e,1,t),u_intensity:n}),"heatmapUniformValues"),P_e=l((i,e,t,n)=>{let r=Qt.create();Qt.ortho(r,0,i.width,i.height,0,0,1);let a=i.context.gl;return{u_matrix:r,u_world:[a.drawingBufferWidth,a.drawingBufferHeight],u_image:t,u_color_ramp:n,u_opacity:e.paint.get("heatmap-opacity")}},"heatmapTextureUniformValues");R();var L_e=l((i,e)=>({u_matrix:new Cn(i,e.u_matrix),u_image:new rn(i,e.u_image),u_latrange:new mn(i,e.u_latrange),u_light:new mn(i,e.u_light),u_shadow:new Hm(i,e.u_shadow),u_highlight:new Hm(i,e.u_highlight),u_accent:new Hm(i,e.u_accent)}),"hillshadeUniforms"),D_e=l((i,e)=>({u_matrix:new Cn(i,e.u_matrix),u_image:new rn(i,e.u_image),u_dimension:new mn(i,e.u_dimension),u_zoom:new Ht(i,e.u_zoom),u_unpack:new f4(i,e.u_unpack)}),"hillshadePrepareUniforms"),k_e=l((i,e,t,n)=>{let r=t.paint.get("hillshade-shadow-color"),a=t.paint.get("hillshade-highlight-color"),o=t.paint.get("hillshade-accent-color"),s=t.paint.get("hillshade-illumination-direction")*(Math.PI/180);t.paint.get("hillshade-illumination-anchor")==="viewport"&&(s-=i.transform.angle);let u=!i.options.moving;return{u_matrix:n?n.posMatrix:i.transform.calculatePosMatrix(e.tileID.toUnwrapped(),u),u_image:0,u_latrange:CY(i,e.tileID),u_light:[t.paint.get("hillshade-exaggeration"),s],u_shadow:r,u_highlight:a,u_accent:o}},"hillshadeUniformValues"),R_e=l((i,e)=>{let t=e.stride,n=Qt.create();return Qt.ortho(n,0,8192,-8192,0,0,1),Qt.translate(n,n,[0,-8192,0]),{u_matrix:n,u_image:1,u_dimension:[t,t],u_zoom:i.overscaledZ,u_unpack:e.getUnpackVector()}},"hillshadeUniformPrepareValues");function CY(i,e){let t=Math.pow(2,e.canonical.z),n=e.canonical.y;return[new $a(0,n/t).toLngLat().lat,new $a(0,(n+1)/t).toLngLat().lat]}l(CY,"getTileLatRange");R();var O_e=l((i,e)=>({u_matrix:new Cn(i,e.u_matrix),u_ratio:new Ht(i,e.u_ratio),u_device_pixel_ratio:new Ht(i,e.u_device_pixel_ratio),u_units_to_pixels:new mn(i,e.u_units_to_pixels)}),"lineUniforms"),N_e=l((i,e)=>({u_matrix:new Cn(i,e.u_matrix),u_ratio:new Ht(i,e.u_ratio),u_device_pixel_ratio:new Ht(i,e.u_device_pixel_ratio),u_units_to_pixels:new mn(i,e.u_units_to_pixels),u_image:new rn(i,e.u_image),u_image_height:new Ht(i,e.u_image_height)}),"lineGradientUniforms"),F_e=l((i,e)=>({u_matrix:new Cn(i,e.u_matrix),u_texsize:new mn(i,e.u_texsize),u_ratio:new Ht(i,e.u_ratio),u_device_pixel_ratio:new Ht(i,e.u_device_pixel_ratio),u_image:new rn(i,e.u_image),u_units_to_pixels:new mn(i,e.u_units_to_pixels),u_scale:new ch(i,e.u_scale),u_fade:new Ht(i,e.u_fade)}),"linePatternUniforms"),B_e=l((i,e)=>({u_matrix:new Cn(i,e.u_matrix),u_ratio:new Ht(i,e.u_ratio),u_device_pixel_ratio:new Ht(i,e.u_device_pixel_ratio),u_units_to_pixels:new mn(i,e.u_units_to_pixels),u_patternscale_a:new mn(i,e.u_patternscale_a),u_patternscale_b:new mn(i,e.u_patternscale_b),u_sdfgamma:new Ht(i,e.u_sdfgamma),u_image:new rn(i,e.u_image),u_tex_y_a:new Ht(i,e.u_tex_y_a),u_tex_y_b:new Ht(i,e.u_tex_y_b),u_mix:new Ht(i,e.u_mix)}),"lineSDFUniforms"),AL=l((i,e,t,n)=>{let r=i.transform;return{u_matrix:ML(i,e,t,n),u_ratio:1/qo(e,1,r.zoom),u_device_pixel_ratio:i.pixelRatio,u_units_to_pixels:[1/r.pixelsToGLUnits[0],1/r.pixelsToGLUnits[1]]}},"lineUniformValues"),z_e=l((i,e,t,n,r)=>ti(AL(i,e,t,r),{u_image:0,u_image_height:n}),"lineGradientUniformValues"),U_e=l((i,e,t,n,r)=>{let a=i.transform,o=SL(e,a);return{u_matrix:ML(i,e,t,r),u_texsize:e.imageAtlasTexture.size,u_ratio:1/qo(e,1,a.zoom),u_device_pixel_ratio:i.pixelRatio,u_image:0,u_scale:[o,n.fromScale,n.toScale],u_fade:n.t,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}},"linePatternUniformValues"),V_e=l((i,e,t,n,r,a)=>{let o=i.transform,s=i.lineAtlas,u=SL(e,o),h=t.layout.get("line-cap")==="round",d=s.getDash(n.from,h),f=s.getDash(n.to,h),m=d.width*r.fromScale,v=f.width*r.toScale;return ti(AL(i,e,t,a),{u_patternscale_a:[u/m,-d.height/2],u_patternscale_b:[u/v,-f.height/2],u_sdfgamma:s.width/(Math.min(m,v)*256*i.pixelRatio)/2,u_image:0,u_tex_y_a:d.y,u_tex_y_b:f.y,u_mix:r.t})},"lineSDFUniformValues");function SL(i,e){return 1/qo(i,1,e.tileZoom)}l(SL,"calculateTileRatio");function ML(i,e,t,n){return i.translatePosMatrix(n?n.posMatrix:e.tileID.posMatrix,e,t.paint.get("line-translate"),t.paint.get("line-translate-anchor"))}l(ML,"calculateMatrix");R();var j_e=l((i,e)=>({u_matrix:new Cn(i,e.u_matrix),u_tl_parent:new mn(i,e.u_tl_parent),u_scale_parent:new Ht(i,e.u_scale_parent),u_buffer_scale:new Ht(i,e.u_buffer_scale),u_fade_t:new Ht(i,e.u_fade_t),u_opacity:new Ht(i,e.u_opacity),u_image0:new rn(i,e.u_image0),u_image1:new rn(i,e.u_image1),u_brightness_low:new Ht(i,e.u_brightness_low),u_brightness_high:new Ht(i,e.u_brightness_high),u_saturation_factor:new Ht(i,e.u_saturation_factor),u_contrast_factor:new Ht(i,e.u_contrast_factor),u_spin_weights:new ch(i,e.u_spin_weights)}),"rasterUniforms"),G_e=l((i,e,t,n,r)=>({u_matrix:i,u_tl_parent:e,u_scale_parent:t,u_buffer_scale:1,u_fade_t:n.mix,u_opacity:n.opacity*r.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:r.paint.get("raster-brightness-min"),u_brightness_high:r.paint.get("raster-brightness-max"),u_saturation_factor:TY(r.paint.get("raster-saturation")),u_contrast_factor:IY(r.paint.get("raster-contrast")),u_spin_weights:EY(r.paint.get("raster-hue-rotate"))}),"rasterUniformValues");function EY(i){i*=Math.PI/180;let e=Math.sin(i),t=Math.cos(i);return[(2*t+1)/3,(-Math.sqrt(3)*e-t+1)/3,(Math.sqrt(3)*e-t+1)/3]}l(EY,"spinWeights");function IY(i){return i>0?1/(1-i):1+i}l(IY,"contrastFactor");function TY(i){return i>0?1-1/(1.001-i):-i}l(TY,"saturationFactor");R();var $_e=l((i,e)=>({u_is_size_zoom_constant:new rn(i,e.u_is_size_zoom_constant),u_is_size_feature_constant:new rn(i,e.u_is_size_feature_constant),u_size_t:new Ht(i,e.u_size_t),u_size:new Ht(i,e.u_size),u_camera_to_center_distance:new Ht(i,e.u_camera_to_center_distance),u_pitch:new Ht(i,e.u_pitch),u_rotate_symbol:new rn(i,e.u_rotate_symbol),u_aspect_ratio:new Ht(i,e.u_aspect_ratio),u_fade_change:new Ht(i,e.u_fade_change),u_matrix:new Cn(i,e.u_matrix),u_label_plane_matrix:new Cn(i,e.u_label_plane_matrix),u_coord_matrix:new Cn(i,e.u_coord_matrix),u_is_text:new rn(i,e.u_is_text),u_pitch_with_map:new rn(i,e.u_pitch_with_map),u_texsize:new mn(i,e.u_texsize),u_texture:new rn(i,e.u_texture)}),"symbolIconUniforms"),H_e=l((i,e)=>({u_is_size_zoom_constant:new rn(i,e.u_is_size_zoom_constant),u_is_size_feature_constant:new rn(i,e.u_is_size_feature_constant),u_size_t:new Ht(i,e.u_size_t),u_size:new Ht(i,e.u_size),u_camera_to_center_distance:new Ht(i,e.u_camera_to_center_distance),u_pitch:new Ht(i,e.u_pitch),u_rotate_symbol:new rn(i,e.u_rotate_symbol),u_aspect_ratio:new Ht(i,e.u_aspect_ratio),u_fade_change:new Ht(i,e.u_fade_change),u_matrix:new Cn(i,e.u_matrix),u_label_plane_matrix:new Cn(i,e.u_label_plane_matrix),u_coord_matrix:new Cn(i,e.u_coord_matrix),u_is_text:new rn(i,e.u_is_text),u_pitch_with_map:new rn(i,e.u_pitch_with_map),u_texsize:new mn(i,e.u_texsize),u_texture:new rn(i,e.u_texture),u_gamma_scale:new Ht(i,e.u_gamma_scale),u_device_pixel_ratio:new Ht(i,e.u_device_pixel_ratio),u_is_halo:new rn(i,e.u_is_halo)}),"symbolSDFUniforms"),W_e=l((i,e)=>({u_is_size_zoom_constant:new rn(i,e.u_is_size_zoom_constant),u_is_size_feature_constant:new rn(i,e.u_is_size_feature_constant),u_size_t:new Ht(i,e.u_size_t),u_size:new Ht(i,e.u_size),u_camera_to_center_distance:new Ht(i,e.u_camera_to_center_distance),u_pitch:new Ht(i,e.u_pitch),u_rotate_symbol:new rn(i,e.u_rotate_symbol),u_aspect_ratio:new Ht(i,e.u_aspect_ratio),u_fade_change:new Ht(i,e.u_fade_change),u_matrix:new Cn(i,e.u_matrix),u_label_plane_matrix:new Cn(i,e.u_label_plane_matrix),u_coord_matrix:new Cn(i,e.u_coord_matrix),u_is_text:new rn(i,e.u_is_text),u_pitch_with_map:new rn(i,e.u_pitch_with_map),u_texsize:new mn(i,e.u_texsize),u_texsize_icon:new mn(i,e.u_texsize_icon),u_texture:new rn(i,e.u_texture),u_texture_icon:new rn(i,e.u_texture_icon),u_gamma_scale:new Ht(i,e.u_gamma_scale),u_device_pixel_ratio:new Ht(i,e.u_device_pixel_ratio),u_is_halo:new rn(i,e.u_is_halo)}),"symbolTextAndIconUniforms"),PY=l((i,e,t,n,r,a,o,s,u,h)=>{let d=r.transform;return{u_is_size_zoom_constant:+(i==="constant"||i==="source"),u_is_size_feature_constant:+(i==="constant"||i==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:d.cameraToCenterDistance,u_pitch:d.pitch/360*2*Math.PI,u_rotate_symbol:+t,u_aspect_ratio:d.width/d.height,u_fade_change:r.options.fadeDuration?r.symbolFadeChange:1,u_matrix:a,u_label_plane_matrix:o,u_coord_matrix:s,u_is_text:+u,u_pitch_with_map:+n,u_texsize:h,u_texture:0}},"symbolIconUniformValues"),LY=l((i,e,t,n,r,a,o,s,u,h,d)=>{let f=r.transform;return ti(PY(i,e,t,n,r,a,o,s,u,h),{u_gamma_scale:n?Math.cos(f._pitch)*f.cameraToCenterDistance:1,u_device_pixel_ratio:r.pixelRatio,u_is_halo:+d})},"symbolSDFUniformValues"),q_e=l((i,e,t,n,r,a,o,s,u,h)=>ti(LY(i,e,t,n,r,a,o,s,!0,u,!0),{u_texsize_icon:h,u_texture_icon:1}),"symbolTextAndIconUniformValues");R();var X_e=l((i,e)=>({u_matrix:new Cn(i,e.u_matrix),u_opacity:new Ht(i,e.u_opacity),u_color:new Hm(i,e.u_color)}),"backgroundUniforms"),Z_e=l((i,e)=>({u_matrix:new Cn(i,e.u_matrix),u_opacity:new Ht(i,e.u_opacity),u_image:new rn(i,e.u_image),u_pattern_tl_a:new mn(i,e.u_pattern_tl_a),u_pattern_br_a:new mn(i,e.u_pattern_br_a),u_pattern_tl_b:new mn(i,e.u_pattern_tl_b),u_pattern_br_b:new mn(i,e.u_pattern_br_b),u_texsize:new mn(i,e.u_texsize),u_mix:new Ht(i,e.u_mix),u_pattern_size_a:new mn(i,e.u_pattern_size_a),u_pattern_size_b:new mn(i,e.u_pattern_size_b),u_scale_a:new Ht(i,e.u_scale_a),u_scale_b:new Ht(i,e.u_scale_b),u_pixel_coord_upper:new mn(i,e.u_pixel_coord_upper),u_pixel_coord_lower:new mn(i,e.u_pixel_coord_lower),u_tile_units_to_pixels:new Ht(i,e.u_tile_units_to_pixels)}),"backgroundPatternUniforms"),Y_e=l((i,e,t)=>({u_matrix:i,u_opacity:e,u_color:t}),"backgroundUniformValues"),J_e=l((i,e,t,n,r,a)=>ti(wY(n,a,t,r),{u_matrix:i,u_opacity:e}),"backgroundPatternUniformValues"),K_e={fillExtrusion:h_e,fillExtrusionPattern:c_e,fill:d_e,fillPattern:f_e,fillOutline:m_e,fillOutlinePattern:g_e,circle:__e,collisionBox:b_e,collisionCircle:w_e,debug:M_e,clippingMask:C_e,heatmap:E_e,heatmapTexture:I_e,hillshade:L_e,hillshadePrepare:D_e,line:O_e,lineGradient:N_e,linePattern:F_e,lineSDF:B_e,raster:j_e,symbolIcon:$_e,symbolSDF:H_e,symbolTextAndIcon:W_e,background:X_e,backgroundPattern:Z_e,terrain:n_e,terrainDepth:r_e,terrainCoords:a_e};R();R();var DY=class{constructor(e,t,n){this.context=e;let r=e.gl;this.buffer=r.createBuffer(),this.dynamicDraw=!!n,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){let t=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){let e=this.context.gl;this.buffer&&(e.deleteBuffer(this.buffer),delete this.buffer)}};l(DY,"IndexBuffer");var Q_e=DY;R();var exe={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},kY=class{constructor(e,t,n,r){this.length=t.length,this.attributes=n,this.itemSize=t.bytesPerElement,this.dynamicDraw=r,this.context=e;let a=e.gl;this.buffer=a.createBuffer(),e.bindVertexBuffer.set(this.buffer),a.bufferData(a.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?a.DYNAMIC_DRAW:a.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error("Length of new data is ".concat(e.length,", which doesn't match current length of ").concat(this.length));let t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,t){for(let n=0;n<this.attributes.length;n++){let r=this.attributes[n],a=t.attributes[r.name];a!==void 0&&e.enableVertexAttribArray(a)}}setVertexAttribPointers(e,t,n){for(let r=0;r<this.attributes.length;r++){let a=this.attributes[r],o=t.attributes[a.name];o!==void 0&&e.vertexAttribPointer(o,a.components,e[exe[a.type]],!1,this.itemSize,a.offset+this.itemSize*(n||0))}}destroy(){let e=this.context.gl;this.buffer&&(e.deleteBuffer(this.buffer),delete this.buffer)}};l(kY,"VertexBuffer");var txe=kY;R();R();R();var rM=new WeakMap;function Gv(i){var e;if(rM.has(i))return rM.get(i);{let t=(e=i.getParameter(i.VERSION))==null?void 0:e.startsWith("WebGL 2.0");return rM.set(i,t),t}}l(Gv,"isWebGL2");var RY=class{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}};l(RY,"BaseValue");var On=RY,OY=class extends On{getDefault(){return Wi.transparent}set(e){let t=this.current;e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a&&!this.dirty||(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}};l(OY,"ClearColor");var ixe=OY,NY=class extends On{getDefault(){return 1}set(e){e===this.current&&!this.dirty||(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}};l(NY,"ClearDepth");var nxe=NY,FY=class extends On{getDefault(){return 0}set(e){e===this.current&&!this.dirty||(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}};l(FY,"ClearStencil");var rxe=FY,BY=class extends On{getDefault(){return[!0,!0,!0,!0]}set(e){let t=this.current;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&!this.dirty||(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}};l(BY,"ColorMask");var axe=BY,zY=class extends On{getDefault(){return!0}set(e){e===this.current&&!this.dirty||(this.gl.depthMask(e),this.current=e,this.dirty=!1)}};l(zY,"DepthMask");var oxe=zY,UY=class extends On{getDefault(){return 255}set(e){e===this.current&&!this.dirty||(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}};l(UY,"StencilMask");var sxe=UY,VY=class extends On{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){let t=this.current;e.func===t.func&&e.ref===t.ref&&e.mask===t.mask&&!this.dirty||(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}};l(VY,"StencilFunc");var lxe=VY,jY=class extends On{getDefault(){let e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){let t=this.current;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&!this.dirty||(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}};l(jY,"StencilOp");var uxe=jY,GY=class extends On{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e,this.dirty=!1}};l(GY,"StencilTest");var hxe=GY,$Y=class extends On{getDefault(){return[0,1]}set(e){let t=this.current;e[0]===t[0]&&e[1]===t[1]&&!this.dirty||(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}};l($Y,"DepthRange");var cxe=$Y,HY=class extends On{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e,this.dirty=!1}};l(HY,"DepthTest");var pxe=HY,WY=class extends On{getDefault(){return this.gl.LESS}set(e){e===this.current&&!this.dirty||(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}};l(WY,"DepthFunc");var dxe=WY,qY=class extends On{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e,this.dirty=!1}};l(qY,"Blend");var fxe=qY,XY=class extends On{getDefault(){let e=this.gl;return[e.ONE,e.ZERO]}set(e){let t=this.current;e[0]===t[0]&&e[1]===t[1]&&!this.dirty||(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}};l(XY,"BlendFunc");var mxe=XY,ZY=class extends On{getDefault(){return Wi.transparent}set(e){let t=this.current;e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a&&!this.dirty||(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}};l(ZY,"BlendColor");var gxe=ZY,YY=class extends On{getDefault(){return this.gl.FUNC_ADD}set(e){e===this.current&&!this.dirty||(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}};l(YY,"BlendEquation");var yxe=YY,JY=class extends On{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=e,this.dirty=!1}};l(JY,"CullFace");var vxe=JY,KY=class extends On{getDefault(){return this.gl.BACK}set(e){e===this.current&&!this.dirty||(this.gl.cullFace(e),this.current=e,this.dirty=!1)}};l(KY,"CullFaceSide");var _xe=KY,QY=class extends On{getDefault(){return this.gl.CCW}set(e){e===this.current&&!this.dirty||(this.gl.frontFace(e),this.current=e,this.dirty=!1)}};l(QY,"FrontFace");var xxe=QY,eJ=class extends On{getDefault(){return null}set(e){e===this.current&&!this.dirty||(this.gl.useProgram(e),this.current=e,this.dirty=!1)}};l(eJ,"ProgramValue");var bxe=eJ,tJ=class extends On{getDefault(){return this.gl.TEXTURE0}set(e){e===this.current&&!this.dirty||(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}};l(tJ,"ActiveTextureUnit");var wxe=tJ,iJ=class extends On{getDefault(){let e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){let t=this.current;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&!this.dirty||(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}};l(iJ,"Viewport");var Axe=iJ,nJ=class extends On{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e),this.current=e,this.dirty=!1}};l(nJ,"BindFramebuffer");var Sxe=nJ,rJ=class extends On{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,e),this.current=e,this.dirty=!1}};l(rJ,"BindRenderbuffer");var Mxe=rJ,aJ=class extends On{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.bindTexture(t.TEXTURE_2D,e),this.current=e,this.dirty=!1}};l(aJ,"BindTexture");var Cxe=aJ,oJ=class extends On{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}};l(oJ,"BindVertexBuffer");var Exe=oJ,sJ=class extends On{getDefault(){return null}set(e){let t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}};l(sJ,"BindElementBuffer");var Ixe=sJ,lJ=class extends On{getDefault(){return null}set(e){var t;if(e===this.current&&!this.dirty)return;let n=this.gl;Gv(n)?n.bindVertexArray(e):(t=n.getExtension("OES_vertex_array_object"))==null||t.bindVertexArrayOES(e),this.current=e,this.dirty=!1}};l(lJ,"BindVertexArray");var Txe=lJ,uJ=class extends On{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}};l(uJ,"PixelStoreUnpack");var Pxe=uJ,hJ=class extends On{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}};l(hJ,"PixelStoreUnpackPremultiplyAlpha");var Lxe=hJ,cJ=class extends On{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}};l(cJ,"PixelStoreUnpackFlipY");var Dxe=cJ,pJ=class extends On{constructor(e,t){super(e),this.context=e,this.parent=t}getDefault(){return null}};l(pJ,"FramebufferAttachment");var CL=pJ,dJ=class extends CL{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}};l(dJ,"ColorAttachment");var kxe=dJ,fJ=class extends CL{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1}};l(fJ,"DepthAttachment");var Rxe=fJ,mJ=class extends CL{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1}};l(mJ,"DepthStencilAttachment");var Oxe=mJ,gJ=class{constructor(e,t,n,r,a){this.context=e,this.width=t,this.height=n;let o=e.gl,s=this.framebuffer=o.createFramebuffer();if(this.colorAttachment=new kxe(e,s),r)this.depthAttachment=a?new Oxe(e,s):new Rxe(e,s);else if(a)throw new Error("Stencil cannot be set without depth");if(o.checkFramebufferStatus(o.FRAMEBUFFER)!==o.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){let e=this.context.gl,t=this.colorAttachment.get();if(t&&e.deleteTexture(t),this.depthAttachment){let n=this.depthAttachment.get();n&&e.deleteRenderbuffer(n)}e.deleteFramebuffer(this.framebuffer)}};l(gJ,"Framebuffer");var Nxe=gJ;R();var Fxe=0,yJ=1,Bxe=771,vJ=class{constructor(e,t,n){this.blendFunction=e,this.blendColor=t,this.mask=n}};l(vJ,"ColorMode");var Zr=vJ;Zr.Replace=[yJ,Fxe];Zr.disabled=new Zr(Zr.Replace,Wi.transparent,[!1,!1,!1,!1]);Zr.unblended=new Zr(Zr.Replace,Wi.transparent,[!0,!0,!0,!0]);Zr.alphaBlended=new Zr([yJ,Bxe],Wi.transparent,[!0,!0,!0,!0]);var _J=class{constructor(e){var t,n;if(this.gl=e,this.clearColor=new ixe(this),this.clearDepth=new nxe(this),this.clearStencil=new rxe(this),this.colorMask=new axe(this),this.depthMask=new oxe(this),this.stencilMask=new sxe(this),this.stencilFunc=new lxe(this),this.stencilOp=new uxe(this),this.stencilTest=new hxe(this),this.depthRange=new cxe(this),this.depthTest=new pxe(this),this.depthFunc=new dxe(this),this.blend=new fxe(this),this.blendFunc=new mxe(this),this.blendColor=new gxe(this),this.blendEquation=new yxe(this),this.cullFace=new vxe(this),this.cullFaceSide=new _xe(this),this.frontFace=new xxe(this),this.program=new bxe(this),this.activeTexture=new wxe(this),this.viewport=new Axe(this),this.bindFramebuffer=new Sxe(this),this.bindRenderbuffer=new Mxe(this),this.bindTexture=new Cxe(this),this.bindVertexBuffer=new Exe(this),this.bindElementBuffer=new Ixe(this),this.bindVertexArray=new Txe(this),this.pixelStoreUnpack=new Pxe(this),this.pixelStoreUnpackPremultiplyAlpha=new Lxe(this),this.pixelStoreUnpackFlipY=new Dxe(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),Gv(e)){this.HALF_FLOAT=e.HALF_FLOAT;let r=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(t=e.RGBA16F)!=null?t:r?.RGBA16F_EXT,this.RGB16F=(n=e.RGB16F)!=null?n:r?.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");let r=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=r?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,t){return new Q_e(this,e,t)}createVertexBuffer(e,t,n){return new txe(this,e,t,n)}createRenderbuffer(e,t,n){let r=this.gl,a=r.createRenderbuffer();return this.bindRenderbuffer.set(a),r.renderbufferStorage(r.RENDERBUFFER,e,t,n),this.bindRenderbuffer.set(null),a}createFramebuffer(e,t,n,r){return new Nxe(this,e,t,n,r)}clear({color:e,depth:t,stencil:n}){let r=this.gl,a=0;e&&(a|=r.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),typeof t<"u"&&(a|=r.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(t),this.depthMask.set(!0)),typeof n<"u"&&(a|=r.STENCIL_BUFFER_BIT,this.clearStencil.set(n),this.stencilMask.set(255)),r.clear(a)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func===this.gl.ALWAYS&&!e.mask?this.depthTest.set(!1):(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range))}setStencilMode(e){e.test.func===this.gl.ALWAYS&&!e.mask?this.stencilTest.set(!1):(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask}))}setColorMode(e){Cc(e.blendFunction,Zr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return Gv(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))==null?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var t;return Gv(this.gl)?this.gl.deleteVertexArray(e):(t=this.gl.getExtension("OES_vertex_array_object"))==null?void 0:t.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}};l(_J,"Context");var zxe=_J;R();var xJ=class{constructor(e,t,n){this.func=e,this.mask=t,this.range=n}};l(xJ,"DepthMode");var wn=xJ;wn.ReadOnly=!1;wn.ReadWrite=!0;wn.disabled=new wn(519,wn.ReadOnly,[0,1]);R();var bJ=class{constructor(e,t,n,r,a,o){this.test=e,this.ref=t,this.mask=n,this.fail=r,this.depthFail=a,this.pass=o}};l(bJ,"StencilMode");var Cr=bJ;Cr.disabled=new Cr({func:519,mask:0},0,0,7680,7680,7680);R();var wJ=class{constructor(e,t,n){this.enable=e,this.mode=t,this.frontFace=n}};l(wJ,"CullFaceMode");var _r=wJ;_r.disabled=new _r(!1,1029,2305);_r.backCCW=new _r(!0,1029,2305);R();var AJ=ii(Rn(),1);R();var v_;function rE(i,e,t,n,r,a,o){let s=i.context,u=s.gl,h=i.useProgram("collisionBox"),d=[],f=0,m=0;for(let I=0;I<n.length;I++){let C=n[I],T=e.getTile(C),k=T.getBucket(t);if(!k)continue;let F=C.posMatrix;(r[0]!==0||r[1]!==0)&&(F=i.translatePosMatrix(C.posMatrix,T,r,a));let B=o?k.textCollisionBox:k.iconCollisionBox,N=k.collisionCircleArray;if(N.length>0){let z=Qt.create(),L=F;Qt.mul(z,k.placementInvProjMatrix,i.transform.glCoordMatrix),Qt.mul(z,z,k.placementViewportMatrix),d.push({circleArray:N,circleOffset:m,transform:L,invTransform:z,coord:C}),f+=N.length/4,m=f}B&&h.draw(s,u.LINES,wn.disabled,Cr.disabled,i.colorModeForRenderPass(),_r.disabled,A_e(F,i.transform,T),i.style.map.terrain&&i.style.map.terrain.getTerrainData(C),t.id,B.layoutVertexBuffer,B.indexBuffer,B.segments,null,i.transform.zoom,null,null,B.collisionVertexBuffer)}if(!o||!d.length)return;let v=i.useProgram("collisionCircle"),b=new nye;b.resize(f*4),b._trim();let w=0;for(let I of d)for(let C=0;C<I.circleArray.length/4;C++){let T=C*4,k=I.circleArray[T+0],F=I.circleArray[T+1],B=I.circleArray[T+2],N=I.circleArray[T+3];b.emplace(w++,k,F,B,N,0),b.emplace(w++,k,F,B,N,1),b.emplace(w++,k,F,B,N,2),b.emplace(w++,k,F,B,N,3)}(!v_||v_.length<f*2)&&(v_=SJ(f));let A=s.createIndexBuffer(v_,!0),E=s.createVertexBuffer(b,Nve.members,!0);for(let I of d){let C=S_e(I.transform,I.invTransform,i.transform);v.draw(s,u.TRIANGLES,wn.disabled,Cr.disabled,i.colorModeForRenderPass(),_r.disabled,C,i.style.map.terrain&&i.style.map.terrain.getTerrainData(I.coord),t.id,E,A,$r.simpleSegment(0,I.circleOffset*2,I.circleArray.length,I.circleArray.length/2),null,i.transform.zoom,null,null,null)}E.destroy(),A.destroy()}l(rE,"drawCollisionDebug");function SJ(i){let e=i*2,t=new aye;t.resize(e),t._trim();for(let n=0;n<e;n++){let r=n*6;t.uint16[r+0]=n*4+0,t.uint16[r+1]=n*4+1,t.uint16[r+2]=n*4+2,t.uint16[r+3]=n*4+2,t.uint16[r+4]=n*4+3,t.uint16[r+5]=n*4+0}return t}l(SJ,"createQuadTriangles");var Uxe=Qt.identity(new Float32Array(16));function MJ(i,e,t,n,r){if(i.renderPass!=="translucent")return;let a=Cr.disabled,o=i.colorModeForRenderPass();(t._unevaluatedLayout.hasValue("text-variable-anchor")||t._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&EJ(n,i,t,e,t.layout.get("text-rotation-alignment"),t.layout.get("text-pitch-alignment"),r),t.paint.get("icon-opacity").constantOr(1)!==0&&aE(i,e,t,n,!1,t.paint.get("icon-translate"),t.paint.get("icon-translate-anchor"),t.layout.get("icon-rotation-alignment"),t.layout.get("icon-pitch-alignment"),t.layout.get("icon-keep-upright"),a,o),t.paint.get("text-opacity").constantOr(1)!==0&&aE(i,e,t,n,!0,t.paint.get("text-translate"),t.paint.get("text-translate-anchor"),t.layout.get("text-rotation-alignment"),t.layout.get("text-pitch-alignment"),t.layout.get("text-keep-upright"),a,o),e.map.showCollisionBoxes&&(rE(i,e,t,n,t.paint.get("text-translate"),t.paint.get("text-translate-anchor"),!0),rE(i,e,t,n,t.paint.get("icon-translate"),t.paint.get("icon-translate-anchor"),!1))}l(MJ,"drawSymbols");function CJ(i,e,t,n,r,a){let{horizontalAlign:o,verticalAlign:s}=uL(i),u=-(o-.5)*e,h=-(s-.5)*t;return new AJ.default((u/r+n[0])*a,(h/r+n[1])*a)}l(CJ,"calculateVariableRenderShift");function EJ(i,e,t,n,r,a,o){let s=e.transform,u=r==="map",h=a==="map";for(let d of i){let f=n.getTile(d),m=f.getBucket(t);if(!m||!m.text||!m.text.segments.get().length)continue;let v=m.textSizeData,b=c0(v,s.zoom),w=qo(f,1,e.transform.zoom),A=PA(d.posMatrix,h,u,e.transform,w),E=t.layout.get("icon-text-fit")!=="none"&&m.hasIconData();if(b){let I=Math.pow(2,s.zoom-f.tileID.overscaledZ),C=e.style.map.terrain?(T,k)=>e.style.map.terrain.getElevation(d,T,k):null;IJ(m,u,h,o,s,A,d.posMatrix,I,b,E,C)}}}l(EJ,"updateVariableAnchors");function IJ(i,e,t,n,r,a,o,s,u,h,d){let f=i.text.placedSymbolArray,m=i.text.dynamicLayoutVertexArray,v=i.icon.dynamicLayoutVertexArray,b={};m.clear();for(let w=0;w<f.length;w++){let A=f.get(w),E=i.allowVerticalPlacement&&!A.placedOrientation,I=!A.hidden&&A.crossTileID&&!E?n[A.crossTileID]:null;if(!I)sd(A.numGlyphs,m);else{let C=new AJ.default(A.anchorX,A.anchorY),T=ds(C,t?o:a,d),k=LA(r.cameraToCenterDistance,T.signedDistanceFromCamera),F=CA(i.textSizeData,u,A)*k/_X;t&&(F*=i.tilePixelRatio/s);let{width:B,height:N,anchor:z,textOffset:L,textBoxScale:j}=I,q=CJ(z,B,N,L,j,F),Z=t?ds(C.add(q),a,d).point:T.point.add(e?q.rotate(-r.angle):q),O=i.allowVerticalPlacement&&A.placedOrientation===2?Math.PI/2:0;for(let Y=0;Y<A.numGlyphs;Y++)yg(m,Z,O);h&&A.associatedIconIndex>=0&&(b[A.associatedIconIndex]={shiftedAnchor:Z,angle:O})}}if(h){v.clear();let w=i.icon.placedSymbolArray;for(let A=0;A<w.length;A++){let E=w.get(A);if(E.hidden)sd(E.numGlyphs,v);else{let I=b[A];if(!I)sd(E.numGlyphs,v);else for(let C=0;C<E.numGlyphs;C++)yg(v,I.shiftedAnchor,I.angle)}}i.icon.dynamicLayoutVertexBuffer.updateData(v)}i.text.dynamicLayoutVertexBuffer.updateData(m)}l(IJ,"updateVariableAnchorsForBucket");function TJ(i,e,t){return t.iconsInText&&e?"symbolTextAndIcon":i?"symbolSDF":"symbolIcon"}l(TJ,"getSymbolProgramName");function aE(i,e,t,n,r,a,o,s,u,h,d,f){let m=i.context,v=m.gl,b=i.transform,w=s==="map",A=u==="map",E=s!=="viewport"&&t.layout.get("symbol-placement")!=="point",I=w&&!A&&!E,C=!t.layout.get("symbol-sort-key").isConstant(),T=!1,k=i.depthModeForSublayer(0,wn.ReadOnly),F=t._unevaluatedLayout.hasValue("text-variable-anchor")||t._unevaluatedLayout.hasValue("text-variable-anchor-offset"),B=[];for(let N of n){let z=e.getTile(N),L=z.getBucket(t);if(!L)continue;let j=r?L.text:L.icon;if(!j||!j.segments.get().length||!j.hasVisibleVertices)continue;let q=j.programConfigurations.get(t.id),Z=r||L.sdfIcons,O=r?L.textSizeData:L.iconSizeData,Y=A||b.pitch!==0,J=i.useProgram(TJ(Z,r,L),q),oe=c0(O,b.zoom),$=i.style.map.terrain&&i.style.map.terrain.getTerrainData(N),K,te=[0,0],ve,Q,he=null,se;if(r){if(ve=z.glyphAtlasTexture,Q=v.LINEAR,K=z.glyphAtlasTexture.size,L.iconsInText){te=z.imageAtlasTexture.size,he=z.imageAtlasTexture;let ot=O.kind==="composite"||O.kind==="camera";se=Y||i.options.rotating||i.options.zooming||ot?v.LINEAR:v.NEAREST}}else{let ot=t.layout.get("icon-size").constantOr(0)!==1||L.iconsNeedLinear;ve=z.imageAtlasTexture,Q=Z||i.options.rotating||i.options.zooming||ot||Y?v.LINEAR:v.NEAREST,K=z.imageAtlasTexture.size}let Ae=qo(z,1,i.transform.zoom),Ie=PA(N.posMatrix,A,w,i.transform,Ae),we=yL(N.posMatrix,A,w,i.transform,Ae),Ne=F&&L.hasTextData(),je=t.layout.get("icon-text-fit")!=="none"&&Ne&&L.hasIconData();if(E){let ot=i.style.map.terrain?(Ke,Lt)=>i.style.map.terrain.getElevation(N,Ke,Lt):null,He=t.layout.get("text-rotation-alignment")==="map";JZ(L,N.posMatrix,i,r,Ie,we,A,h,He,ot)}let Ve=i.translatePosMatrix(N.posMatrix,z,a,o),Le=E||r&&F||je?Uxe:Ie,xe=i.translatePosMatrix(we,z,a,o,!0),Ue=Z&&t.paint.get(r?"text-halo-width":"icon-halo-width").constantOr(1)!==0,de;Z?L.iconsInText?de=q_e(O.kind,oe,I,A,i,Ve,Le,xe,K,te):de=LY(O.kind,oe,I,A,i,Ve,Le,xe,r,K,!0):de=PY(O.kind,oe,I,A,i,Ve,Le,xe,r,K);let ut={program:J,buffers:j,uniformValues:de,atlasTexture:ve,atlasTextureIcon:he,atlasInterpolation:Q,atlasInterpolationIcon:se,isSDF:Z,hasHalo:Ue};if(C&&L.canOverlap){T=!0;let ot=j.segments.get();for(let He of ot)B.push({segments:new $r([He]),sortKey:He.sortKey,state:ut,terrainData:$})}else B.push({segments:j.segments,sortKey:0,state:ut,terrainData:$})}T&&B.sort((N,z)=>N.sortKey-z.sortKey);for(let N of B){let z=N.state;if(m.activeTexture.set(v.TEXTURE0),z.atlasTexture.bind(z.atlasInterpolation,v.CLAMP_TO_EDGE),z.atlasTextureIcon&&(m.activeTexture.set(v.TEXTURE1),z.atlasTextureIcon&&z.atlasTextureIcon.bind(z.atlasInterpolationIcon,v.CLAMP_TO_EDGE)),z.isSDF){let L=z.uniformValues;z.hasHalo&&(L.u_is_halo=1,oE(z.buffers,N.segments,t,i,z.program,k,d,f,L,N.terrainData)),L.u_is_halo=0}oE(z.buffers,N.segments,t,i,z.program,k,d,f,z.uniformValues,N.terrainData)}}l(aE,"drawLayerSymbols");function oE(i,e,t,n,r,a,o,s,u,h){let d=n.context,f=d.gl;r.draw(d,f.TRIANGLES,a,o,s,_r.disabled,u,h,t.id,i.layoutVertexBuffer,i.indexBuffer,e,t.paint,n.transform.zoom,i.programConfigurations.get(t.id),i.dynamicLayoutVertexBuffer,i.opacityVertexBuffer)}l(oE,"drawSymbolElements");R();function PJ(i,e,t,n){if(i.renderPass!=="translucent")return;let r=t.paint.get("circle-opacity"),a=t.paint.get("circle-stroke-width"),o=t.paint.get("circle-stroke-opacity"),s=!t.layout.get("circle-sort-key").isConstant();if(r.constantOr(1)===0&&(a.constantOr(1)===0||o.constantOr(1)===0))return;let u=i.context,h=u.gl,d=i.depthModeForSublayer(0,wn.ReadOnly),f=Cr.disabled,m=i.colorModeForRenderPass(),v=[];for(let b=0;b<n.length;b++){let w=n[b],A=e.getTile(w),E=A.getBucket(t);if(!E)continue;let I=E.programConfigurations.get(t.id),C=i.useProgram("circle",I),T=E.layoutVertexBuffer,k=E.indexBuffer,F=i.style.map.terrain&&i.style.map.terrain.getTerrainData(w),B=x_e(i,w,A,t),N={programConfiguration:I,program:C,layoutVertexBuffer:T,indexBuffer:k,uniformValues:B,terrainData:F};if(s){let z=E.segments.get();for(let L of z)v.push({segments:new $r([L]),sortKey:L.sortKey,state:N})}else v.push({segments:E.segments,sortKey:0,state:N})}s&&v.sort((b,w)=>b.sortKey-w.sortKey);for(let b of v){let{programConfiguration:w,program:A,layoutVertexBuffer:E,indexBuffer:I,uniformValues:C,terrainData:T}=b.state,k=b.segments;A.draw(u,h.TRIANGLES,d,f,m,_r.disabled,C,T,t.id,E,I,k,t.paint,i.transform.zoom,w)}}l(PJ,"drawCircles");R();function LJ(i,e,t,n){if(t.paint.get("heatmap-opacity")!==0)if(i.renderPass==="offscreen"){let r=i.context,a=r.gl,o=Cr.disabled,s=new Zr([a.ONE,a.ONE],Wi.transparent,[!0,!0,!0,!0]);DJ(r,i,t),r.clear({color:Wi.transparent});for(let u=0;u<n.length;u++){let h=n[u];if(e.hasRenderableParent(h))continue;let d=e.getTile(h),f=d.getBucket(t);if(!f)continue;let m=f.programConfigurations.get(t.id),v=i.useProgram("heatmap",m),{zoom:b}=i.transform;v.draw(r,a.TRIANGLES,wn.disabled,o,s,_r.disabled,T_e(h.posMatrix,d,b,t.paint.get("heatmap-intensity")),null,t.id,f.layoutVertexBuffer,f.indexBuffer,f.segments,t.paint,i.transform.zoom,m)}r.viewport.set([0,0,i.width,i.height])}else i.renderPass==="translucent"&&(i.context.setColorMode(i.colorModeForRenderPass()),RJ(i,t))}l(LJ,"drawHeatmap");function DJ(i,e,t){let n=i.gl;i.activeTexture.set(n.TEXTURE1),i.viewport.set([0,0,e.width/4,e.height/4]);let r=t.heatmapFbo;if(r)n.bindTexture(n.TEXTURE_2D,r.colorAttachment.get()),i.bindFramebuffer.set(r.framebuffer);else{let a=n.createTexture();n.bindTexture(n.TEXTURE_2D,a),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),r=t.heatmapFbo=i.createFramebuffer(e.width/4,e.height/4,!1,!1),kJ(i,e,a,r)}}l(DJ,"bindFramebuffer");function kJ(i,e,t,n){var r,a;let o=i.gl,s=(r=i.HALF_FLOAT)!=null?r:o.UNSIGNED_BYTE,u=(a=i.RGBA16F)!=null?a:o.RGBA;o.texImage2D(o.TEXTURE_2D,0,u,e.width/4,e.height/4,0,o.RGBA,s,null),n.colorAttachment.set(t)}l(kJ,"bindTextureToFramebuffer");function RJ(i,e){let t=i.context,n=t.gl,r=e.heatmapFbo;if(!r)return;t.activeTexture.set(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,r.colorAttachment.get()),t.activeTexture.set(n.TEXTURE1);let a=e.colorRampTexture;a||(a=e.colorRampTexture=new Aa(t,e.colorRamp,n.RGBA)),a.bind(n.LINEAR,n.CLAMP_TO_EDGE),i.useProgram("heatmapTexture").draw(t,n.TRIANGLES,wn.disabled,Cr.disabled,i.colorModeForRenderPass(),_r.disabled,P_e(i,e,0,1),null,e.id,i.viewportBuffer,i.quadTriangleIndexBuffer,i.viewportSegments,e.paint,i.transform.zoom)}l(RJ,"renderTextureToMap");R();function OJ(i,e,t,n){if(i.renderPass!=="translucent")return;let r=t.paint.get("line-opacity"),a=t.paint.get("line-width");if(r.constantOr(1)===0||a.constantOr(1)===0)return;let o=i.depthModeForSublayer(0,wn.ReadOnly),s=i.colorModeForRenderPass(),u=t.paint.get("line-dasharray"),h=t.paint.get("line-pattern"),d=h.constantOr(1),f=t.paint.get("line-gradient"),m=t.getCrossfadeParameters(),v=d?"linePattern":u?"lineSDF":f?"lineGradient":"line",b=i.context,w=b.gl,A=!0;for(let E of n){let I=e.getTile(E);if(d&&!I.patternsLoaded())continue;let C=I.getBucket(t);if(!C)continue;let T=C.programConfigurations.get(t.id),k=i.context.program.get(),F=i.useProgram(v,T),B=A||F.program!==k,N=i.style.map.terrain&&i.style.map.terrain.getTerrainData(E),z=h.constantOr(null);if(z&&I.imageAtlas){let q=I.imageAtlas,Z=q.patternPositions[z.to.toString()],O=q.patternPositions[z.from.toString()];Z&&O&&T.setConstantPatternPositions(Z,O)}let L=N?E:null,j=d?U_e(i,I,t,m,L):u?V_e(i,I,t,u,m,L):f?z_e(i,I,t,C.lineClipsArray.length,L):AL(i,I,t,L);if(d)b.activeTexture.set(w.TEXTURE0),I.imageAtlasTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),T.updatePaintBuffers(m);else if(u&&(B||i.lineAtlas.dirty))b.activeTexture.set(w.TEXTURE0),i.lineAtlas.bind(b);else if(f){let q=C.gradients[t.id],Z=q.texture;if(t.gradientVersion!==q.version){let O=256;if(t.stepInterpolant){let Y=e.getSource().maxzoom,J=E.canonical.z===Y?Math.ceil(1<<i.transform.maxZoom-E.canonical.z):1,oe=C.maxLineLength/8192*1024*J;O=da(QB(oe),256,b.maxTextureSize)}q.gradient=rL({expression:t.gradientExpression(),evaluationKey:"lineProgress",resolution:O,image:q.gradient||void 0,clips:C.lineClipsArray}),q.texture?q.texture.update(q.gradient):q.texture=new Aa(b,q.gradient,w.RGBA),q.version=t.gradientVersion,Z=q.texture}b.activeTexture.set(w.TEXTURE0),Z.bind(t.stepInterpolant?w.NEAREST:w.LINEAR,w.CLAMP_TO_EDGE)}F.draw(b,w.TRIANGLES,o,i.stencilModeForClipping(E),s,_r.disabled,j,N,t.id,C.layoutVertexBuffer,C.indexBuffer,C.segments,t.paint,i.transform.zoom,T,C.layoutVertexBuffer2),A=!1}}l(OJ,"drawLine");R();R();function EL(i,e,t,n,r){if(!t||!n||!n.imageAtlas)return;let a=n.imageAtlas.patternPositions,o=a[t.to.toString()],s=a[t.from.toString()];if(!o&&s&&(o=s),!s&&o&&(s=o),!o||!s){let u=r.getPaintProperty(e);o=a[u],s=a[u]}o&&s&&i.setConstantPatternPositions(o,s)}l(EL,"updatePatternPositionsInProgram");function NJ(i,e,t,n){let r=t.paint.get("fill-color"),a=t.paint.get("fill-opacity");if(a.constantOr(1)===0)return;let o=i.colorModeForRenderPass(),s=t.paint.get("fill-pattern"),u=i.opaquePassEnabledForLayer()&&!s.constantOr(1)&&r.constantOr(Wi.transparent).a===1&&a.constantOr(0)===1?"opaque":"translucent";if(i.renderPass===u){let h=i.depthModeForSublayer(1,i.renderPass==="opaque"?wn.ReadWrite:wn.ReadOnly);sE(i,e,t,n,h,o,!1)}if(i.renderPass==="translucent"&&t.paint.get("fill-antialias")){let h=i.depthModeForSublayer(t.getPaintProperty("fill-outline-color")?2:0,wn.ReadOnly);sE(i,e,t,n,h,o,!0)}}l(NJ,"drawFill");function sE(i,e,t,n,r,a,o){let s=i.context.gl,u="fill-pattern",h=t.paint.get(u),d=h&&h.constantOr(1),f=t.getCrossfadeParameters(),m,v,b,w,A;o?(v=d&&!t.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",m=s.LINES):(v=d?"fillPattern":"fill",m=s.TRIANGLES);let E=h.constantOr(null);for(let I of n){let C=e.getTile(I);if(d&&!C.patternsLoaded())continue;let T=C.getBucket(t);if(!T)continue;let k=T.programConfigurations.get(t.id),F=i.useProgram(v,k),B=i.style.map.terrain&&i.style.map.terrain.getTerrainData(I);d&&(i.context.activeTexture.set(s.TEXTURE0),C.imageAtlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE),k.updatePaintBuffers(f)),EL(k,u,E,C,t);let N=B?I:null,z=N?N.posMatrix:I.posMatrix,L=i.translatePosMatrix(z,C,t.paint.get("fill-translate"),t.paint.get("fill-translate-anchor"));if(!o)w=T.indexBuffer,A=T.segments,b=d?MY(L,i,f,C):SY(L);else{w=T.indexBuffer2,A=T.segments2;let j=[s.drawingBufferWidth,s.drawingBufferHeight];b=v==="fillOutlinePattern"&&d?v_e(L,i,f,C,j):y_e(L,j)}F.draw(i.context,m,r,i.stencilModeForClipping(I),a,_r.disabled,b,B,t.id,T.layoutVertexBuffer,w,A,t.paint,i.transform.zoom,k)}}l(sE,"drawFillTiles");R();function FJ(i,e,t,n){let r=t.paint.get("fill-extrusion-opacity");if(r!==0&&i.renderPass==="translucent"){let a=new wn(i.context.gl.LEQUAL,wn.ReadWrite,i.depthRangeFor3D);if(r===1&&!t.paint.get("fill-extrusion-pattern").constantOr(1)){let o=i.colorModeForRenderPass();yx(i,e,t,n,a,Cr.disabled,o)}else yx(i,e,t,n,a,Cr.disabled,Zr.disabled),yx(i,e,t,n,a,i.stencilModeFor3D(),i.colorModeForRenderPass())}}l(FJ,"drawFillExtrusion");function yx(i,e,t,n,r,a,o){let s=i.context,u=s.gl,h="fill-extrusion-pattern",d=t.paint.get(h),f=d.constantOr(1),m=t.getCrossfadeParameters(),v=t.paint.get("fill-extrusion-opacity"),b=d.constantOr(null);for(let w of n){let A=e.getTile(w),E=A.getBucket(t);if(!E)continue;let I=i.style.map.terrain&&i.style.map.terrain.getTerrainData(w),C=E.programConfigurations.get(t.id),T=i.useProgram(f?"fillExtrusionPattern":"fillExtrusion",C);f&&(i.context.activeTexture.set(u.TEXTURE0),A.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),C.updatePaintBuffers(m)),EL(C,h,b,A,t);let k=i.translatePosMatrix(w.posMatrix,A,t.paint.get("fill-extrusion-translate"),t.paint.get("fill-extrusion-translate-anchor")),F=t.paint.get("fill-extrusion-vertical-gradient"),B=f?p_e(k,i,F,v,w,m,A):AY(k,i,F,v);T.draw(s,s.gl.TRIANGLES,r,a,o,_r.backCCW,B,I,t.id,E.layoutVertexBuffer,E.indexBuffer,E.segments,t.paint,i.transform.zoom,C,i.style.map.terrain&&E.centroidVertexBuffer)}}l(yx,"drawExtrusionTiles");R();function BJ(i,e,t,n){if(i.renderPass!=="offscreen"&&i.renderPass!=="translucent")return;let r=i.context,a=i.depthModeForSublayer(0,wn.ReadOnly),o=i.colorModeForRenderPass(),[s,u]=i.renderPass==="translucent"?i.stencilConfigForOverlap(n):[{},n];for(let h of u){let d=e.getTile(h);typeof d.needsHillshadePrepare<"u"&&d.needsHillshadePrepare&&i.renderPass==="offscreen"?UJ(i,d,t,a,Cr.disabled,o):i.renderPass==="translucent"&&zJ(i,h,d,t,a,s[h.overscaledZ],o)}r.viewport.set([0,0,i.width,i.height])}l(BJ,"drawHillshade");function zJ(i,e,t,n,r,a,o){let s=i.context,u=s.gl,h=t.fbo;if(!h)return;let d=i.useProgram("hillshade"),f=i.style.map.terrain&&i.style.map.terrain.getTerrainData(e);s.activeTexture.set(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,h.colorAttachment.get());let m=f?e:null;d.draw(s,u.TRIANGLES,r,a,o,_r.disabled,k_e(i,t,n,m),f,n.id,i.rasterBoundsBuffer,i.quadTriangleIndexBuffer,i.rasterBoundsSegments)}l(zJ,"renderHillshade");function UJ(i,e,t,n,r,a){let o=i.context,s=o.gl,u=e.dem;if(u&&u.data){let h=u.dim,d=u.stride,f=u.getPixels();if(o.activeTexture.set(s.TEXTURE1),o.pixelStoreUnpackPremultiplyAlpha.set(!1),e.demTexture=e.demTexture||i.getTileTexture(d),e.demTexture){let v=e.demTexture;v.update(f,{premultiply:!1}),v.bind(s.NEAREST,s.CLAMP_TO_EDGE)}else e.demTexture=new Aa(o,f,s.RGBA,{premultiply:!1}),e.demTexture.bind(s.NEAREST,s.CLAMP_TO_EDGE);o.activeTexture.set(s.TEXTURE0);let m=e.fbo;if(!m){let v=new Aa(o,{width:h,height:h,data:null},s.RGBA);v.bind(s.LINEAR,s.CLAMP_TO_EDGE),m=e.fbo=o.createFramebuffer(h,h,!0,!1),m.colorAttachment.set(v.texture)}o.bindFramebuffer.set(m.framebuffer),o.viewport.set([0,0,h,h]),i.useProgram("hillshadePrepare").draw(o,s.TRIANGLES,n,r,a,_r.disabled,R_e(e.tileID,u),null,t.id,i.rasterBoundsBuffer,i.quadTriangleIndexBuffer,i.rasterBoundsSegments),e.needsHillshadePrepare=!1}}l(UJ,"prepareHillshade");R();function VJ(i,e,t,n){if(i.renderPass!=="translucent"||t.paint.get("raster-opacity")===0||!n.length)return;let r=i.context,a=r.gl,o=e.getSource(),s=i.useProgram("raster"),u=i.colorModeForRenderPass(),[h,d]=o instanceof h1?[{},n]:i.stencilConfigForOverlap(n),f=d[d.length-1].overscaledZ,m=!i.options.moving;for(let v of d){let b=i.depthModeForSublayer(v.overscaledZ-f,t.paint.get("raster-opacity")===1?wn.ReadWrite:wn.ReadOnly,a.LESS),w=e.getTile(v);w.registerFadeDuration(t.paint.get("raster-fade-duration"));let A=e.findLoadedParent(v,0),E=jJ(w,A,e,t,i.transform,i.style.map.terrain),I,C,T=t.paint.get("raster-resampling")==="nearest"?a.NEAREST:a.LINEAR;r.activeTexture.set(a.TEXTURE0),w.texture.bind(T,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),r.activeTexture.set(a.TEXTURE1),A?(A.texture.bind(T,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),I=Math.pow(2,A.tileID.overscaledZ-w.tileID.overscaledZ),C=[w.tileID.canonical.x*I%1,w.tileID.canonical.y*I%1]):w.texture.bind(T,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST);let k=i.style.map.terrain&&i.style.map.terrain.getTerrainData(v),F=k?v:null,B=F?F.posMatrix:i.transform.calculatePosMatrix(v.toUnwrapped(),m),N=G_e(B,C||[0,0],I||1,E,t);o instanceof h1?s.draw(r,a.TRIANGLES,b,Cr.disabled,u,_r.disabled,N,k,t.id,o.boundsBuffer,i.quadTriangleIndexBuffer,o.boundsSegments):s.draw(r,a.TRIANGLES,b,h[v.overscaledZ],u,_r.disabled,N,k,t.id,i.rasterBoundsBuffer,i.quadTriangleIndexBuffer,i.rasterBoundsSegments)}}l(VJ,"drawRaster");function jJ(i,e,t,n,r,a){let o=n.paint.get("raster-fade-duration");if(!a&&o>0){let s=Mn.now(),u=(s-i.timeAdded)/o,h=e?(s-e.timeAdded)/o:-1,d=t.getSource(),f=r.coveringZoomLevel({tileSize:d.tileSize,roundZoom:d.roundZoom}),m=!e||Math.abs(e.tileID.overscaledZ-f)>Math.abs(i.tileID.overscaledZ-f),v=m&&i.refreshedUponExpiration?1:da(m?u:1-h,0,1);return i.refreshedUponExpiration&&u>=1&&(i.refreshedUponExpiration=!1),e?{opacity:1,mix:1-v}:{opacity:v,mix:0}}else return{opacity:1,mix:0}}l(jJ,"getFadeValues");R();function GJ(i,e,t,n){let r=t.paint.get("background-color"),a=t.paint.get("background-opacity");if(a===0)return;let o=i.context,s=o.gl,u=i.transform,h=u.tileSize,d=t.paint.get("background-pattern");if(i.isPatternMissing(d))return;let f=!d&&r.a===1&&a===1&&i.opaquePassEnabledForLayer()?"opaque":"translucent";if(i.renderPass!==f)return;let m=Cr.disabled,v=i.depthModeForSublayer(0,f==="opaque"?wn.ReadWrite:wn.ReadOnly),b=i.colorModeForRenderPass(),w=i.useProgram(d?"backgroundPattern":"background"),A=n||u.coveringTiles({tileSize:h,terrain:i.style.map.terrain});d&&(o.activeTexture.set(s.TEXTURE0),i.imageManager.bind(i.context));let E=t.getCrossfadeParameters();for(let I of A){let C=n?I.posMatrix:i.transform.calculatePosMatrix(I.toUnwrapped()),T=d?J_e(C,a,i,d,{tileID:I,tileSize:h},E):Y_e(C,a,r),k=i.style.map.terrain&&i.style.map.terrain.getTerrainData(I);w.draw(o,s.TRIANGLES,v,m,b,_r.disabled,T,k,t.id,i.tileExtentBuffer,i.quadTriangleIndexBuffer,i.tileExtentSegments)}}l(GJ,"drawBackground");R();var Vxe=new Wi(1,0,0,1),jxe=new Wi(0,1,0,1),Gxe=new Wi(0,0,1,1),$xe=new Wi(1,0,1,1),Hxe=new Wi(0,1,1,1);function $J(i){let e=i.transform.padding,t=3;lE(i,i.transform.height-(e.top||0),t,Vxe),lE(i,e.bottom||0,t,jxe),uE(i,e.left||0,t,Gxe),uE(i,i.transform.width-(e.right||0),t,$xe);let n=i.transform.centerPoint;HJ(i,n.x,i.transform.height-n.y,Hxe)}l($J,"drawDebugPadding");function HJ(i,e,t,n){f1(i,e-2/2,t-20/2,2,20,n),f1(i,e-20/2,t-2/2,20,2,n)}l(HJ,"drawCrosshair");function lE(i,e,t,n){f1(i,0,e+t/2,i.transform.width,t,n)}l(lE,"drawHorizontalLine");function uE(i,e,t,n){f1(i,e-t/2,0,t,i.transform.height,n)}l(uE,"drawVerticalLine");function f1(i,e,t,n,r,a){let o=i.context,s=o.gl;s.enable(s.SCISSOR_TEST),s.scissor(e*i.pixelRatio,t*i.pixelRatio,n*i.pixelRatio,r*i.pixelRatio),o.clear({color:a}),s.disable(s.SCISSOR_TEST)}l(f1,"drawDebugSSRect");function WJ(i,e,t){for(let n=0;n<t.length;n++)qJ(i,e,t[n])}l(WJ,"drawDebug");function qJ(i,e,t){let n=i.context,r=n.gl,a=t.posMatrix,o=i.useProgram("debug"),s=wn.disabled,u=Cr.disabled,h=i.colorModeForRenderPass(),d="$debug",f=i.style.map.terrain&&i.style.map.terrain.getTerrainData(t);n.activeTexture.set(r.TEXTURE0);let m=e.getTileByID(t.key).latestRawTileData,v=m&&m.byteLength||0,b=Math.floor(v/1024),w=e.getTile(t).tileSize,A=512/Math.min(w,512)*(t.overscaledZ/i.transform.zoom)*.5,E=t.canonical.toString();t.overscaledZ!==t.canonical.z&&(E+=" => ".concat(t.overscaledZ));let I="".concat(E," ").concat(b,"kB");XJ(i,I),o.draw(n,r.TRIANGLES,s,u,Zr.alphaBlended,_r.disabled,gR(a,Wi.transparent,A),null,d,i.debugBuffer,i.quadTriangleIndexBuffer,i.debugSegments),o.draw(n,r.LINE_STRIP,s,u,h,_r.disabled,gR(a,Wi.red),f,d,i.debugBuffer,i.tileBorderIndexBuffer,i.debugSegments)}l(qJ,"drawDebugTile");function XJ(i,e){i.initDebugOverlayCanvas();let t=i.debugOverlayCanvas,n=i.context.gl,r=i.debugOverlayCanvas.getContext("2d");r.clearRect(0,0,t.width,t.height),r.shadowColor="white",r.shadowBlur=2,r.lineWidth=1.5,r.strokeStyle="white",r.textBaseline="top",r.font="bold 36px Open Sans, sans-serif",r.fillText(e,5,5),r.strokeText(e,5,5),i.debugOverlayTexture.update(t),i.debugOverlayTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}l(XJ,"drawTextToOverlay");function ZJ(i,e){let t=null,n=Object.values(i._layers).flatMap(s=>s.source&&!s.isHidden(e)?[i.sourceCaches[s.source]]:[]),r=n.filter(s=>s.getSource().type==="vector"),a=n.filter(s=>s.getSource().type!=="vector"),o=l(s=>{(!t||t.getSource().maxzoom<s.getSource().maxzoom)&&(t=s)},"considerSource");return r.forEach(s=>o(s)),t||a.forEach(s=>o(s)),t}l(ZJ,"selectDebugSource");R();function YJ(i,e,t){let n=i.context,r=t.implementation;if(i.renderPass==="offscreen"){let a=r.prerender;a&&(i.setCustomLayerDefaults(),n.setColorMode(i.colorModeForRenderPass()),a.call(r,n.gl,i.transform.customLayerMatrix()),n.setDirty(),i.setBaseState())}else if(i.renderPass==="translucent"){i.setCustomLayerDefaults(),n.setColorMode(i.colorModeForRenderPass()),n.setStencilMode(Cr.disabled);let a=r.renderingMode==="3d"?new wn(i.context.gl.LEQUAL,wn.ReadWrite,i.depthRangeFor3D):i.depthModeForSublayer(0,wn.ReadOnly);n.setDepthMode(a),r.render(n.gl,i.transform.customLayerMatrix()),n.setDirty(),i.setBaseState(),n.bindFramebuffer.set(null)}}l(YJ,"drawCustom");R();function JJ(i,e){let t=i.context,n=t.gl,r=Zr.unblended,a=new wn(n.LEQUAL,wn.ReadWrite,[0,1]),o=e.getTerrainMesh(),s=e.sourceCache.getRenderableTiles(),u=i.useProgram("terrainDepth");t.bindFramebuffer.set(e.getFramebuffer("depth").framebuffer),t.viewport.set([0,0,i.width/devicePixelRatio,i.height/devicePixelRatio]),t.clear({color:Wi.transparent,depth:1});for(let h of s){let d=e.getTerrainData(h.tileID),f=i.transform.calculatePosMatrix(h.tileID.toUnwrapped()),m=s_e(f,e.getMeshFrameDelta(i.transform.zoom));u.draw(t,n.TRIANGLES,a,Cr.disabled,r,_r.backCCW,m,d,"terrain",o.vertexBuffer,o.indexBuffer,o.segments)}t.bindFramebuffer.set(null),t.viewport.set([0,0,i.width,i.height])}l(JJ,"drawDepth");function KJ(i,e){let t=i.context,n=t.gl,r=Zr.unblended,a=new wn(n.LEQUAL,wn.ReadWrite,[0,1]),o=e.getTerrainMesh(),s=e.getCoordsTexture(),u=e.sourceCache.getRenderableTiles(),h=i.useProgram("terrainCoords");t.bindFramebuffer.set(e.getFramebuffer("coords").framebuffer),t.viewport.set([0,0,i.width/devicePixelRatio,i.height/devicePixelRatio]),t.clear({color:Wi.transparent,depth:1}),e.coordsIndex=[];for(let d of u){let f=e.getTerrainData(d.tileID);t.activeTexture.set(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,s.texture);let m=i.transform.calculatePosMatrix(d.tileID.toUnwrapped()),v=l_e(m,255-e.coordsIndex.length,e.getMeshFrameDelta(i.transform.zoom));h.draw(t,n.TRIANGLES,a,Cr.disabled,r,_r.backCCW,v,f,"terrain",o.vertexBuffer,o.indexBuffer,o.segments),e.coordsIndex.push(d.tileID.key)}t.bindFramebuffer.set(null),t.viewport.set([0,0,i.width,i.height])}l(KJ,"drawCoords");function hE(i,e,t){let n=i.context,r=n.gl,a=i.colorModeForRenderPass(),o=new wn(r.LEQUAL,wn.ReadWrite,i.depthRangeFor3D),s=i.useProgram("terrain"),u=e.getTerrainMesh();n.bindFramebuffer.set(null),n.viewport.set([0,0,i.width,i.height]);for(let h of t){let d=i.renderToTexture.getTexture(h),f=e.getTerrainData(h.tileID);n.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,d.texture);let m=i.transform.calculatePosMatrix(h.tileID.toUnwrapped()),v=o_e(m,e.getMeshFrameDelta(i.transform.zoom));s.draw(n,r.TRIANGLES,o,Cr.disabled,a,_r.backCCW,v,f,"terrain",u.vertexBuffer,u.indexBuffer,u.segments)}}l(hE,"drawTerrain");var QJ=class{constructor(e,t){this.context=new zxe(e),this.transform=t,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:Qt.identity(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=c1.maxUnderzooming+c1.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new vY}resize(e,t,n){if(this.width=Math.floor(e*n),this.height=Math.floor(t*n),this.pixelRatio=n,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(let r of this.style._order)this.style._layers[r].resize()}setup(){let e=this.context,t=new hx;t.emplaceBack(0,0),t.emplaceBack(8192,0),t.emplaceBack(0,8192),t.emplaceBack(8192,8192),this.tileExtentBuffer=e.createVertexBuffer(t,iM.members),this.tileExtentSegments=$r.simpleSegment(0,0,4,2);let n=new hx;n.emplaceBack(0,0),n.emplaceBack(8192,0),n.emplaceBack(0,8192),n.emplaceBack(8192,8192),this.debugBuffer=e.createVertexBuffer(n,iM.members),this.debugSegments=$r.simpleSegment(0,0,4,5);let r=new RG;r.emplaceBack(0,0,0,0),r.emplaceBack(8192,0,8192,0),r.emplaceBack(0,8192,0,8192),r.emplaceBack(8192,8192,8192,8192),this.rasterBoundsBuffer=e.createVertexBuffer(r,TA.members),this.rasterBoundsSegments=$r.simpleSegment(0,0,4,2);let a=new hx;a.emplaceBack(0,0),a.emplaceBack(1,0),a.emplaceBack(0,1),a.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(a,iM.members),this.viewportSegments=$r.simpleSegment(0,0,4,2);let o=new oye;o.emplaceBack(0),o.emplaceBack(1),o.emplaceBack(3),o.emplaceBack(2),o.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(o);let s=new kd;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(s);let u=this.context.gl;this.stencilClearMode=new Cr({func:u.ALWAYS,mask:0},0,255,u.ZERO,u.ZERO,u.ZERO)}clearStencil(){let e=this.context,t=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;let n=Qt.create();Qt.ortho(n,0,this.width,this.height,0,0,1),Qt.scale(n,n,[t.drawingBufferWidth,t.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,t.TRIANGLES,wn.disabled,this.stencilClearMode,Zr.disabled,_r.disabled,yR(n),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,t){if(this.currentStencilSource===e.source||!e.isTileClipped()||!t||!t.length)return;this.currentStencilSource=e.source;let n=this.context,r=n.gl;this.nextStencilID+t.length>256&&this.clearStencil(),n.setColorMode(Zr.disabled),n.setDepthMode(wn.disabled);let a=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(let o of t){let s=this._tileClippingMaskIDs[o.key]=this.nextStencilID++,u=this.style.map.terrain&&this.style.map.terrain.getTerrainData(o);a.draw(n,r.TRIANGLES,wn.disabled,new Cr({func:r.ALWAYS,mask:0},s,255,r.KEEP,r.KEEP,r.REPLACE),Zr.disabled,_r.disabled,yR(o.posMatrix),u,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();let e=this.nextStencilID++,t=this.context.gl;return new Cr({func:t.NOTEQUAL,mask:255},e,255,t.KEEP,t.KEEP,t.REPLACE)}stencilModeForClipping(e){let t=this.context.gl;return new Cr({func:t.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,t.KEEP,t.KEEP,t.REPLACE)}stencilConfigForOverlap(e){let t=this.context.gl,n=e.sort((o,s)=>s.overscaledZ-o.overscaledZ),r=n[n.length-1].overscaledZ,a=n[0].overscaledZ-r+1;if(a>1){this.currentStencilSource=void 0,this.nextStencilID+a>256&&this.clearStencil();let o={};for(let s=0;s<a;s++)o[s+r]=new Cr({func:t.GEQUAL,mask:255},s+this.nextStencilID,255,t.KEEP,t.KEEP,t.REPLACE);return this.nextStencilID+=a,[o,n]}return[{[r]:Cr.disabled},n]}colorModeForRenderPass(){let e=this.context.gl;return this._showOverdrawInspector?new Zr([e.CONSTANT_COLOR,e.ONE],new Wi(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Zr.unblended:Zr.alphaBlended}depthModeForSublayer(e,t,n){if(!this.opaquePassEnabledForLayer())return wn.disabled;let r=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new wn(n||this.context.gl.LEQUAL,t,[r,r])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,t){this.style=e,this.options=t,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(Mn.now()),this.imageManager.beginFrame();let n=this.style._order,r=this.style.sourceCaches,a={},o={},s={};for(let u in r){let h=r[u];h.used&&h.prepare(this.context),a[u]=h.getVisibleCoordinates(),o[u]=a[u].slice().reverse(),s[u]=h.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let u=0;u<n.length;u++){let h=n[u];if(this.style._layers[h].is3D()){this.opaquePassCutoff=u;break}}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(let u of n){let h=this.style._layers[u];if(!h.hasOffscreenPass()||h.isHidden(this.transform.zoom))continue;let d=o[h.source];h.type!=="custom"&&!d.length||this.renderLayer(this,r[h.source],h,d)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:t.showOverdrawInspector?Wi.black:Wi.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=t.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=n.length-1;this.currentLayer>=0;this.currentLayer--){let u=this.style._layers[n[this.currentLayer]],h=r[u.source],d=a[u.source];this._renderTileClippingMasks(u,d),this.renderLayer(this,h,u,d)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<n.length;this.currentLayer++){let u=this.style._layers[n[this.currentLayer]],h=r[u.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(u))continue;let d=(u.type==="symbol"?s:o)[u.source];this._renderTileClippingMasks(u,a[u.source]),this.renderLayer(this,h,u,d)}if(this.options.showTileBoundaries){let u=ZJ(this.style,this.transform.zoom);u&&WJ(this,u,u.getVisibleCoordinates())}this.options.showPadding&&$J(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;let t=this.terrainFacilitator.matrix,n=this.transform.projMatrix,r=this.terrainFacilitator.dirty;r||(r=e?!Qt.exactEquals(t,n):!Qt.equals(t,n)),r||(r=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),r&&(Qt.copy(t,n),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,JJ(this,this.style.map.terrain),KJ(this,this.style.map.terrain))}renderLayer(e,t,n,r){if(!n.isHidden(this.transform.zoom)&&!(n.type!=="background"&&n.type!=="custom"&&!(r||[]).length))switch(this.id=n.id,n.type){case"symbol":MJ(e,t,n,r,this.style.placement.variableOffsets);break;case"circle":PJ(e,t,n,r);break;case"heatmap":LJ(e,t,n,r);break;case"line":OJ(e,t,n,r);break;case"fill":NJ(e,t,n,r);break;case"fill-extrusion":FJ(e,t,n,r);break;case"hillshade":BJ(e,t,n,r);break;case"raster":VJ(e,t,n,r);break;case"background":GJ(e,t,n,r);break;case"custom":YJ(e,t,n);break}}translatePosMatrix(e,t,n,r,a){if(!n[0]&&!n[1])return e;let o=a?r==="map"?this.transform.angle:0:r==="viewport"?-this.transform.angle:0;if(o){let h=Math.sin(o),d=Math.cos(o);n=[n[0]*d-n[1]*h,n[0]*h+n[1]*d]}let s=[a?n[0]:qo(t,n[0],this.transform.zoom),a?n[1]:qo(t,n[1],this.transform.zoom),0],u=new Float32Array(16);return Qt.translate(u,e,s),u}saveTileTexture(e){let t=this._tileTextures[e.size[0]];t?t.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){let t=this._tileTextures[e];return t&&t.length>0?t.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;let t=this.imageManager.getPattern(e.from.toString()),n=this.imageManager.getPattern(e.to.toString());return!t||!n}useProgram(e,t){this.cache=this.cache||{};let n=e+(t?t.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[n]||(this.cache[n]=new u_e(this.context,Xy[e],t,K_e[e],this._showOverdrawInspector,this.style.map.terrain)),this.cache[n]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){let e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){if(this.debugOverlayCanvas==null){this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512;let e=this.context.gl;this.debugOverlayTexture=new Aa(this.context,this.debugOverlayCanvas,e.RGBA)}}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){let{drawingBufferWidth:e,drawingBufferHeight:t}=this.context.gl;return this.width!==e||this.height!==t}};l(QJ,"Painter");var Wxe=QJ;R();var la=ii(Rn(),1);R();var eK=class tK{constructor(e,t){this.points=e,this.planes=t}static fromInvProjectionMatrix(e,t,n){let r=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]],a=Math.pow(2,n),o=r.map(u=>{u=Mo.transformMat4([],u,e);let h=1/u[3]/t*a;return Mo.mul(u,u,[h,h,1/u[3],h])}),s=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(u=>{let h=dl.sub([],o[u[0]],o[u[1]]),d=dl.sub([],o[u[2]],o[u[1]]),f=dl.normalize([],dl.cross([],h,d)),m=-dl.dot(f,o[u[1]]);return f.concat(m)});return new tK(o,s)}};l(eK,"Frustum");var qxe=eK,iK=class nK{constructor(e,t){this.min=e,this.max=t,this.center=dl.scale([],dl.add([],this.min,this.max),.5)}quadrant(e){let t=[e%2===0,e<2],n=dl.clone(this.min),r=dl.clone(this.max);for(let a=0;a<t.length;a++)n[a]=t[a]?this.min[a]:this.center[a],r[a]=t[a]?this.center[a]:this.max[a];return r[2]=this.max[2],new nK(n,r)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersects(e){let t=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]],n=!0;for(let r=0;r<e.planes.length;r++){let a=e.planes[r],o=0;for(let s=0;s<t.length;s++)Mo.dot(a,t[s])>=0&&o++;if(o===0)return 0;o!==t.length&&(n=!1)}if(n)return 2;for(let r=0;r<3;r++){let a=Number.MAX_VALUE,o=-Number.MAX_VALUE;for(let s=0;s<e.points.length;s++){let u=e.points[s][r]-this.min[r];a=Math.min(a,u),o=Math.max(o,u)}if(o<0||a>this.max[r]-this.min[r])return 0}return 1}};l(iK,"Aabb");var vR=iK;R();var Xxe=ii(Rn(),1),rK=class aK{constructor(e=0,t=0,n=0,r=0){if(isNaN(e)||e<0||isNaN(t)||t<0||isNaN(n)||n<0||isNaN(r)||r<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=t,this.left=n,this.right=r}interpolate(e,t,n){return t.top!=null&&e.top!=null&&(this.top=Mr.number(e.top,t.top,n)),t.bottom!=null&&e.bottom!=null&&(this.bottom=Mr.number(e.bottom,t.bottom,n)),t.left!=null&&e.left!=null&&(this.left=Mr.number(e.left,t.left,n)),t.right!=null&&e.right!=null&&(this.right=Mr.number(e.right,t.right,n)),this}getCenter(e,t){let n=da((this.left+e-this.right)/2,0,e),r=da((this.top+t-this.bottom)/2,0,t);return new Xxe.default(n,r)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new aK(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}};l(rK,"EdgeInsets");var Zxe=rK,__=85.051129,oK=class sK{constructor(e,t,n,r,a){this.tileSize=512,this._renderWorldCopies=a===void 0?!0:!!a,this._minZoom=e||0,this._maxZoom=t||22,this._minPitch=n??0,this._maxPitch=r??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new on(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Zxe,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){let e=new sK(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e.apply(this),e}apply(e){this.tileSize=e.tileSize,this.latRange=e.latRange,this.width=e.width,this.height=e.height,this._center=e._center,this._elevation=e._elevation,this.minElevationForCurrentTile=e.minElevationForCurrentTile,this.zoom=e.zoom,this.angle=e.angle,this._fov=e._fov,this._pitch=e._pitch,this._unmodified=e._unmodified,this._edgeInsets=e._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new la.default(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(e){let t=-Kp(e,-180,180)*Math.PI/180;this.angle!==t&&(this._unmodified=!1,this.angle=t,this._calcMatrices(),this.rotationMatrix=k3.create(),k3.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){let t=da(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==t&&(this._unmodified=!1,this._pitch=t,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(e){let t=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._zoom=t,this.tileZoom=Math.max(0,Math.floor(t)),this.scale=this.zoomScale(t),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,t,n){this._unmodified=!1,this._edgeInsets.interpolate(e,t,n),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){let t=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,t)}getVisibleUnwrappedCoordinates(e){let t=[new W3(0,e)];if(this._renderWorldCopies){let n=this.pointCoordinate(new la.default(0,0)),r=this.pointCoordinate(new la.default(this.width,0)),a=this.pointCoordinate(new la.default(this.width,this.height)),o=this.pointCoordinate(new la.default(0,this.height)),s=Math.floor(Math.min(n.x,r.x,a.x,o.x)),u=Math.floor(Math.max(n.x,r.x,a.x,o.x)),h=1;for(let d=s-h;d<=u+h;d++)d!==0&&t.push(new W3(d,e))}return t}coveringTiles(e){var t,n;let r=this.coveringZoomLevel(e),a=r;if(e.minzoom!==void 0&&r<e.minzoom)return[];e.maxzoom!==void 0&&r>e.maxzoom&&(r=e.maxzoom);let o=this.pointCoordinate(this.getCameraPoint()),s=$a.fromLngLat(this.center),u=Math.pow(2,r),h=[u*o.x,u*o.y,0],d=[u*s.x,u*s.y,0],f=qxe.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r),m=e.minzoom||0;!e.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(m=r);let v=e.terrain?2/Math.min(this.tileSize,e.tileSize)*this.tileSize:3,b=l(C=>({aabb:new vR([C*u,0,0],[(C+1)*u,u,0]),zoom:0,x:0,y:0,wrap:C,fullyVisible:!1}),"newRootTile"),w=[],A=[],E=r,I=e.reparseOverscaled?a:r;if(this._renderWorldCopies)for(let C=1;C<=3;C++)w.push(b(-C)),w.push(b(C));for(w.push(b(0));w.length>0;){let C=w.pop(),T=C.x,k=C.y,F=C.fullyVisible;if(!F){let q=C.aabb.intersects(f);if(q===0)continue;F=q===2}let B=e.terrain?h:d,N=C.aabb.distanceX(B),z=C.aabb.distanceY(B),L=Math.max(Math.abs(N),Math.abs(z)),j=v+(1<<E-C.zoom)-2;if(C.zoom===E||L>j&&C.zoom>=m){let q=E-C.zoom,Z=h[0]-.5-(T<<q),O=h[1]-.5-(k<<q);A.push({tileID:new ls(C.zoom===E?I:C.zoom,C.wrap,C.zoom,T,k),distanceSq:W4.sqrLen([d[0]-.5-T,d[1]-.5-k]),tileDistanceToCamera:Math.sqrt(Z*Z+O*O)});continue}for(let q=0;q<4;q++){let Z=(T<<1)+q%2,O=(k<<1)+(q>>1),Y=C.zoom+1,J=C.aabb.quadrant(q);if(e.terrain){let oe=new ls(Y,C.wrap,Y,Z,O),$=e.terrain.getMinMaxElevation(oe),K=(t=$.minElevation)!=null?t:this.elevation,te=(n=$.maxElevation)!=null?n:this.elevation;J=new vR([J.min[0],J.min[1],K],[J.max[0],J.max[1],te])}w.push({aabb:J,zoom:Y,x:Z,y:O,wrap:C.wrap,fullyVisible:F})}}return A.sort((C,T)=>C.distanceSq-T.distanceSq).map(C=>C.tileID)}resize(e,t){this.width=e,this.height=t,this.pixelsToGLUnits=[2/e,-2/t],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(e){let t=da(e.lat,-__,__);return new la.default(ad(e.lng)*this.worldSize,od(t)*this.worldSize)}unproject(e){return new $a(e.x/this.worldSize,e.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){let e=this.pointLocation(this.getCameraPoint()),t=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter;return{lngLat:e,altitude:t+this.elevation}}recalculateZoom(e){let t=this.elevation,n=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,r=this.pointLocation(this.centerPoint,e),a=e.getElevationForLngLatZoom(r,this.tileZoom);if(!(this.elevation-a))return;let o=n+t-a,s=Math.cos(this._pitch)*this.cameraToCenterDistance/o/sw(1,r.lat)/this.tileSize,u=this.scaleZoom(s);this._elevation=a,this._center=r,this.zoom=u}setLocationAtPoint(e,t){let n=this.pointCoordinate(t),r=this.pointCoordinate(this.centerPoint),a=this.locationCoordinate(e),o=new $a(a.x-(n.x-r.x),a.y-(n.y-r.y));this.center=this.coordinateLocation(o),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(e,t){return t?this.coordinatePoint(this.locationCoordinate(e),t.getElevationForLngLatZoom(e,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(e))}pointLocation(e,t){return this.coordinateLocation(this.pointCoordinate(e,t))}locationCoordinate(e){return $a.fromLngLat(e)}coordinateLocation(e){return e&&e.toLngLat()}pointCoordinate(e,t){if(t){let w=t.pointCoordinate(e);if(w!=null)return w}let n=0,r=[e.x,e.y,0,1],a=[e.x,e.y,1,1];Mo.transformMat4(r,r,this.pixelMatrixInverse),Mo.transformMat4(a,a,this.pixelMatrixInverse);let o=r[3],s=a[3],u=r[0]/o,h=a[0]/s,d=r[1]/o,f=a[1]/s,m=r[2]/o,v=a[2]/s,b=m===v?0:(n-m)/(v-m);return new $a(Mr.number(u,h,b)/this.worldSize,Mr.number(d,f,b)/this.worldSize)}coordinatePoint(e,t=0,n=this.pixelMatrix){let r=[e.x*this.worldSize,e.y*this.worldSize,t,1];return Mo.transformMat4(r,r,n),new la.default(r[0]/r[3],r[1]/r[3])}getBounds(){let e=Math.max(0,this.height/2-this.getHorizon());return new Uc().extend(this.pointLocation(new la.default(0,e))).extend(this.pointLocation(new la.default(this.width,e))).extend(this.pointLocation(new la.default(this.width,this.height))).extend(this.pointLocation(new la.default(0,this.height)))}getMaxBounds(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new Uc([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-__,__])}calculatePosMatrix(e,t=!1){let n=e.key,r=t?this._alignedPosMatrixCache:this._posMatrixCache;if(r[n])return r[n];let a=e.canonical,o=this.worldSize/this.zoomScale(a.z),s=a.x+Math.pow(2,a.z)*e.wrap,u=Qt.identity(new Float64Array(16));return Qt.translate(u,u,[s*o,a.y*o,0]),Qt.scale(u,u,[o/8192,o/8192,1]),Qt.multiply(u,t?this.alignedProjMatrix:this.projMatrix,u),r[n]=new Float32Array(u),r[n]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(e,t){t=da(+t,this.minZoom,this.maxZoom);let n={center:new on(e.lng,e.lat),zoom:t},r=this.lngRange;if(!this._renderWorldCopies&&r===null){let C=179.9999999999;r=[-C,C]}let a=this.tileSize*this.zoomScale(n.zoom),o=0,s=a,u=0,h=a,d=0,f=0,{x:m,y:v}=this.size;if(this.latRange){let C=this.latRange;o=od(C[1])*a,s=od(C[0])*a,s-o<v&&(d=v/(s-o))}r&&(u=Kp(ad(r[0])*a,0,a),h=Kp(ad(r[1])*a,0,a),h<u&&(h+=a),h-u<m&&(f=m/(h-u)));let{x:b,y:w}=this.project.call({worldSize:a},e),A,E,I=Math.max(f||0,d||0);if(I){let C=new la.default(f?(h+u)/2:b,d?(s+o)/2:w);return n.center=this.unproject.call({worldSize:a},C).wrap(),n.zoom+=this.scaleZoom(I),n}if(this.latRange){let C=v/2;w-C<o&&(E=o+C),w+C>s&&(E=s-C)}if(r){let C=(u+h)/2,T=b;this._renderWorldCopies&&(T=Kp(b,C-a/2,C+a/2));let k=m/2;T-k<u&&(A=u+k),T+k>h&&(A=h-k)}if(A!==void 0||E!==void 0){let C=new la.default(A??b,E??w);n.center=this.unproject.call({worldSize:a},C).wrap()}return n}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let e=this._unmodified,{center:t,zoom:n}=this.getConstrained(this.center,this.zoom);this.center=t,this.zoom=n,this._unmodified=e,this._constraining=!1}_calcMatrices(){if(!this.height)return;let e=this._fov/2,t=this.centerOffset,n=this.point.x,r=this.point.y;this.cameraToCenterDistance=.5/Math.tan(e)*this.height,this._pixelPerMeter=sw(1,this.center.lat)*this.worldSize;let a=Qt.identity(new Float64Array(16));Qt.scale(a,a,[this.width/2,-this.height/2,1]),Qt.translate(a,a,[1,-1,0]),this.labelPlaneMatrix=a,a=Qt.identity(new Float64Array(16)),Qt.scale(a,a,[1,-1,1]),Qt.translate(a,a,[-1,-1,0]),Qt.scale(a,a,[2/this.width,2/this.height,1]),this.glCoordMatrix=a;let o=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),s=Math.min(this.elevation,this.minElevationForCurrentTile),u=o-s*this._pixelPerMeter/Math.cos(this._pitch),h=s<0?u:o,d=Math.PI/2+this._pitch,f=this._fov*(.5+t.y/this.height),m=Math.sin(f)*h/Math.sin(da(Math.PI-d-f,.01,Math.PI-.01)),v=this.getHorizon(),b=2*Math.atan(v/this.cameraToCenterDistance)*(.5+t.y/(v*2)),w=Math.sin(b)*h/Math.sin(da(Math.PI-d-b,.01,Math.PI-.01)),A=Math.min(m,w),E=(Math.cos(Math.PI/2-this._pitch)*A+h)*1.01,I=this.height/50;a=new Float64Array(16),Qt.perspective(a,this._fov,this.width/this.height,I,E),a[8]=-t.x*2/this.width,a[9]=t.y*2/this.height,Qt.scale(a,a,[1,-1,1]),Qt.translate(a,a,[0,0,-this.cameraToCenterDistance]),Qt.rotateX(a,a,this._pitch),Qt.rotateZ(a,a,this.angle),Qt.translate(a,a,[-n,-r,0]),this.mercatorMatrix=Qt.scale([],a,[this.worldSize,this.worldSize,this.worldSize]),Qt.scale(a,a,[1,1,this._pixelPerMeter]),this.pixelMatrix=Qt.multiply(new Float64Array(16),this.labelPlaneMatrix,a),Qt.translate(a,a,[0,0,-this.elevation]),this.projMatrix=a,this.invProjMatrix=Qt.invert([],a),this.pixelMatrix3D=Qt.multiply(new Float64Array(16),this.labelPlaneMatrix,a);let C=this.width%2/2,T=this.height%2/2,k=Math.cos(this.angle),F=Math.sin(this.angle),B=n-Math.round(n)+k*C+F*T,N=r-Math.round(r)+k*T+F*C,z=new Float64Array(a);if(Qt.translate(z,z,[B>.5?B-1:B,N>.5?N-1:N,0]),this.alignedProjMatrix=z,a=Qt.invert(new Float64Array(16),this.pixelMatrix),!a)throw new Error("failed to invert matrix");this.pixelMatrixInverse=a,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;let e=this.pointCoordinate(new la.default(0,0)),t=[e.x*this.worldSize,e.y*this.worldSize,0,1];return Mo.transformMat4(t,t,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){let e=this._pitch,t=Math.tan(e)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new la.default(0,t))}getCameraQueryGeometry(e){let t=this.getCameraPoint();if(e.length===1)return[e[0],t];{let n=t.x,r=t.y,a=t.x,o=t.y;for(let s of e)n=Math.min(n,s.x),r=Math.min(r,s.y),a=Math.max(a,s.x),o=Math.max(o,s.y);return[new la.default(n,r),new la.default(a,r),new la.default(a,o),new la.default(n,o),new la.default(n,r)]}}lngLatToCameraDepth(e,t){let n=this.locationCoordinate(e),r=[n.x*this.worldSize,n.y*this.worldSize,t,1];return Mo.transformMat4(r,r,this.projMatrix),r[2]/r[3]}};l(oK,"Transform");var Yxe=oK;R();R();function kA(i,e){let t=!1,n=null,r=null,a,o=l(()=>{n=null,t&&(i.apply(r,a),n=setTimeout(o,e),t=!1)},"later");return(...s)=>(t=!0,r=this,a=s,n||o(),n)}l(kA,"throttle");var lK=class{constructor(e){this._getCurrentHash=l(()=>{let t=window.location.hash.replace("#","");if(this._hashName){let n;return t.split("&").map(r=>r.split("=")).forEach(r=>{r[0]===this._hashName&&(n=r)}),(n&&n[1]||"").split("/")}return t.split("/")},"_getCurrentHash"),this._onHashChange=l(()=>{let t=this._getCurrentHash();if(t.length>=3&&!t.some(n=>isNaN(n))){let n=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:n,pitch:+(t[4]||0)}),!0}return!1},"_onHashChange"),this._updateHashUnthrottled=l(()=>{let t=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,t)}catch{}},"_updateHashUnthrottled"),this._updateHash=kA(this._updateHashUnthrottled,30*1e3/100),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(e){let t=this._map.getCenter(),n=Math.round(this._map.getZoom()*100)/100,r=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),a=Math.pow(10,r),o=Math.round(t.lng*a)/a,s=Math.round(t.lat*a)/a,u=this._map.getBearing(),h=this._map.getPitch(),d="";if(e?d+="/".concat(o,"/").concat(s,"/").concat(n):d+="".concat(n,"/").concat(s,"/").concat(o),(u||h)&&(d+="/".concat(Math.round(u*10)/10)),h&&(d+="/".concat(Math.round(h))),this._hashName){let f=this._hashName,m=!1,v=window.location.hash.slice(1).split("&").map(b=>{let w=b.split("=")[0];return w===f?(m=!0,"".concat(w,"=").concat(d)):b}).filter(b=>b);return m||v.push("".concat(f,"=").concat(d)),"#".concat(v.join("&"))}return"#".concat(d)}};l(lK,"Hash");var Jxe=lK;R();R();var Kxe=ii(Rn(),1),RA={linearity:.3,easing:Yw(0,0,.3,1)},Qxe=ti({deceleration:2500,maxSpeed:1400},RA),ebe=ti({deceleration:20,maxSpeed:1400},RA),tbe=ti({deceleration:1e3,maxSpeed:360},RA),ibe=ti({deceleration:1e3,maxSpeed:90},RA),uK=class{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Mn.now(),settings:e})}_drainInertiaBuffer(){let e=this._inertiaBuffer,t=Mn.now(),n=160;for(;e.length>0&&t-e[0].time>n;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;let t={zoom:0,bearing:0,pitch:0,pan:new Kxe.default(0,0),pinchAround:void 0,around:void 0};for(let{settings:a}of this._inertiaBuffer)t.zoom+=a.zoomDelta||0,t.bearing+=a.bearingDelta||0,t.pitch+=a.pitchDelta||0,a.panDelta&&t.pan._add(a.panDelta),a.around&&(t.around=a.around),a.pinchAround&&(t.pinchAround=a.pinchAround);let n=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,r={};if(t.pan.mag()){let a=Yy(t.pan.mag(),n,ti({},Qxe,e||{}));r.offset=t.pan.mult(a.amount/t.pan.mag()),r.center=this._map.transform.center,Zy(r,a)}if(t.zoom){let a=Yy(t.zoom,n,ebe);r.zoom=this._map.transform.zoom+a.amount,Zy(r,a)}if(t.bearing){let a=Yy(t.bearing,n,tbe);r.bearing=this._map.transform.bearing+da(a.amount,-179,179),Zy(r,a)}if(t.pitch){let a=Yy(t.pitch,n,ibe);r.pitch=this._map.transform.pitch+a.amount,Zy(r,a)}if(r.zoom||r.bearing){let a=t.pinchAround===void 0?t.around:t.pinchAround;r.around=a?this._map.unproject(a):this._map.getCenter()}return this.clear(),ti(r,{noMoveStart:!0})}};l(uK,"HandlerInertia");var nbe=uK;function Zy(i,e){(!i.duration||i.duration<e.duration)&&(i.duration=e.duration,i.easing=e.easing)}l(Zy,"extendDuration");function Yy(i,e,t){let{maxSpeed:n,linearity:r,deceleration:a}=t,o=da(i*r/(e/1e3),-n,n),s=Math.abs(o)/(a*r);return{easing:t.easing,duration:s*1e3,amount:o*(s/2)}}l(Yy,"calculateEasing");R();R();var rbe=ii(Rn(),1),hK=class extends Tt{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,t,n,r={}){let a=wt.mousePos(t.getCanvas(),n),o=t.unproject(a);super(e,ti({point:a,lngLat:o,originalEvent:n},r)),this._defaultPrevented=!1,this.target=t}};l(hK,"MapMouseEvent");var Os=hK,cK=class extends Tt{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,t,n){let r=e==="touchend"?n.changedTouches:n.touches,a=wt.touchPos(t.getCanvasContainer(),r),o=a.map(h=>t.unproject(h)),s=a.reduce((h,d,f,m)=>h.add(d.div(m.length)),new rbe.default(0,0)),u=t.unproject(s);super(e,{points:a,point:s,lngLats:o,lngLat:u,originalEvent:n}),this._defaultPrevented=!1}};l(cK,"MapTouchEvent");var x_=cK,pK=class extends Tt{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,t,n){super(e,{originalEvent:n}),this._defaultPrevented=!1}};l(pK,"MapWheelEvent");var abe=pK,dK=class{constructor(e,t){this._map=e,this._clickTolerance=t.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new abe(e.type,this._map,e))}mousedown(e,t){return this._mousedownPos=t,this._firePreventable(new Os(e.type,this._map,e))}mouseup(e){this._map.fire(new Os(e.type,this._map,e))}click(e,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||this._map.fire(new Os(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Os(e.type,this._map,e))}mouseover(e){this._map.fire(new Os(e.type,this._map,e))}mouseout(e){this._map.fire(new Os(e.type,this._map,e))}touchstart(e){return this._firePreventable(new x_(e.type,this._map,e))}touchmove(e){this._map.fire(new x_(e.type,this._map,e))}touchend(e){this._map.fire(new x_(e.type,this._map,e))}touchcancel(e){this._map.fire(new x_(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}};l(dK,"MapEventHandler");var obe=dK,fK=class{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Os(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Os("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Os(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}};l(fK,"BlockableMapEventHandler");var sbe=fK;R();R();var lbe=ii(Rn(),1),mK=class{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.pointLocation(lbe.default.convert(e),this._map.terrain)}};l(mK,"TransformProvider");var p0=mK,gK=class{constructor(e,t){this._map=e,this._tr=new p0(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=t.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){console.warn("boxZoom will not work. Use SDK interaction events instead.")}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,t){this.isEnabled()&&e.shiftKey&&e.button===0&&(wt.disableDrag(),this._startPos=this._lastPos=t,this._active=!0)}mousemoveWindow(e,t){if(!this._active)return;let n=t;if(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)return;let r=this._startPos;this._lastPos=n,this._box||(this._box=wt.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));let a=Math.min(r.x,n.x),o=Math.max(r.x,n.x),s=Math.min(r.y,n.y),u=Math.max(r.y,n.y);wt.setTransform(this._box,"translate(".concat(a,"px,").concat(s,"px)")),this._box.style.width="".concat(o-a,"px"),this._box.style.height="".concat(u-s,"px")}mouseupWindow(e,t){if(!this._active||e.button!==0)return;let n=this._startPos,r=t;if(this.reset(),wt.suppressClick(),n.x===r.x&&n.y===r.y)this._fireEvent("boxzoomcancel",e);else return this._map.fire(new Tt("boxzoomend",{originalEvent:e})),{cameraAnimation:l(a=>a.fitScreenCoordinates(n,r,this._tr.bearing,{linear:!0}),"cameraAnimation")}}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(wt.remove(this._box),this._box=null),wt.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,t){return this._map.fire(new Tt(e,{originalEvent:t}))}};l(gK,"BoxZoomHandler");var ube=gK;R();R();var hbe=ii(Rn(),1);R();function pw(i,e){if(i.length!==e.length)throw new Error("The number of touches and points are not equal - touches ".concat(i.length,", points ").concat(e.length));let t={};for(let n=0;n<i.length;n++)t[i[n].identifier]=e[n];return t}l(pw,"indexTouches");function yK(i){let e=new hbe.default(0,0);for(let t of i)e._add(t);return e.div(i.length)}l(yK,"getCentroid");var vK=500,cbe=500,IL=30,_K=class{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,t,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),!this.aborted&&(this.startTime===void 0&&(this.startTime=e.timeStamp),n.length===this.numTouches&&(this.centroid=yK(t),this.touches=pw(n,t)))}touchmove(e,t,n){if(this.aborted||!this.centroid)return;let r=pw(n,t);for(let a in this.touches){let o=this.touches[a],s=r[a];(!s||s.dist(o)>IL)&&(this.aborted=!0)}}touchend(e,t,n){if((!this.centroid||e.timeStamp-this.startTime>cbe)&&(this.aborted=!0),n.length===0){let r=!this.aborted&&this.centroid;if(this.reset(),r)return r}}};l(_K,"SingleTapRecognizer");var pbe=_K,xK=class{constructor(e){this.singleTap=new pbe(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,t,n){this.singleTap.touchstart(e,t,n)}touchmove(e,t,n){this.singleTap.touchmove(e,t,n)}touchend(e,t,n){let r=this.singleTap.touchend(e,t,n);if(r){let a=e.timeStamp-this.lastTime<vK,o=!this.lastTap||this.lastTap.dist(r)<IL;if((!a||!o)&&this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=r,this.count===this.numTaps)return this.reset(),r}}};l(xK,"TapRecognizer");var cE=xK,bK=class{constructor(e){this._tr=new p0(e),this._zoomIn=new cE({numTouches:1,numTaps:2}),this._zoomOut=new cE({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,t,n){this._zoomIn.touchstart(e,t,n),this._zoomOut.touchstart(e,t,n)}touchmove(e,t,n){this._zoomIn.touchmove(e,t,n),this._zoomOut.touchmove(e,t,n)}touchend(e,t,n){let r=this._zoomIn.touchend(e,t,n),a=this._zoomOut.touchend(e,t,n),o=this._tr;if(r)return this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:l(s=>s.easeTo({duration:300,zoom:o.zoom+1,around:o.unproject(r)},{originalEvent:e}),"cameraAnimation")};if(a)return this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:l(s=>s.easeTo({duration:300,zoom:o.zoom-1,around:o.unproject(a)},{originalEvent:e}),"cameraAnimation")}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}};l(bK,"TapZoomHandler");var dbe=bK;R();R();var wK=class{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){let t=this._moveFunction(...e);if(t.bearingDelta||t.pitchDelta||t.around||t.panDelta)return this._active=!0,t}dragStart(e,t){!this.isEnabled()||this._lastPoint||this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=t.length?t[0]:t,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,t){if(!this.isEnabled())return;let n=this._lastPoint;if(!n)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e)){this.reset(e);return}let r=t.length?t[0]:t;if(!(!this._moved&&r.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=r,this._move(n,r)}dragEnd(e){!this.isEnabled()||!this._lastPoint||this._moveStateManager.isValidEndEvent(e)&&(this._moved&&wt.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}};l(wK,"DragHandler");var d0=wK;R();var fbe=0,mbe=2,gbe={[fbe]:1,[mbe]:2};function AK(i,e){let t=gbe[e];return i.buttons===void 0||(i.buttons&t)!==t}l(AK,"buttonNoLongerPressed");var SK=class{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){let t=wt.mouseButton(e);this._eventButton=t}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!AK(e,this._eventButton)}isValidEndEvent(e){return wt.mouseButton(e)===this._eventButton}};l(SK,"MouseMoveStateManager");var TL=SK,MK=class{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){let t=e.targetTouches[0].identifier;this._firstTouch=t}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}};l(MK,"OneFingerTouchMoveStateManager");var CK=MK,PL=0,EK=2,LL=l(i=>{i.mousedown=i.dragStart,i.mousemoveWindow=i.dragMove,i.mouseup=i.dragEnd,i.contextmenu=function(e){e.preventDefault()}},"assignEvents"),ybe=l(({enable:i,clickTolerance:e})=>{let t=new TL({checkCorrectEvent:l(n=>wt.mouseButton(n)===PL&&!n.ctrlKey,"checkCorrectEvent")});return new d0({clickTolerance:e,move:l((n,r)=>({around:r,panDelta:r.sub(n)}),"move"),activateOnStart:!0,moveStateManager:t,enable:i,assignEvents:LL})},"generateMousePanHandler"),IK=l(({enable:i,clickTolerance:e,bearingDegreesPerPixelMoved:t=.8})=>{let n=new TL({checkCorrectEvent:l(r=>wt.mouseButton(r)===PL&&r.ctrlKey||wt.mouseButton(r)===EK,"checkCorrectEvent")});return new d0({clickTolerance:e,move:l((r,a)=>({bearingDelta:(a.x-r.x)*t}),"move"),moveStateManager:n,enable:i,assignEvents:LL})},"generateMouseRotationHandler"),TK=l(({enable:i,clickTolerance:e,pitchDegreesPerPixelMoved:t=-.5})=>{let n=new TL({checkCorrectEvent:l(r=>wt.mouseButton(r)===PL&&r.ctrlKey||wt.mouseButton(r)===EK,"checkCorrectEvent")});return new d0({clickTolerance:e,move:l((r,a)=>({pitchDelta:(a.y-r.y)*t}),"move"),moveStateManager:n,enable:i,assignEvents:LL})},"generateMousePitchHandler");R();var aM=ii(Rn(),1),PK=class{constructor(e,t){this._clickTolerance=e.clickTolerance||1,this._map=t,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new aM.default(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(e,t,n){return this._calculateTransform(e,t,n)}touchmove(e,t,n){if(!(!this._active||n.length<this.minTouchs()))return e.preventDefault(),this._calculateTransform(e,t,n)}touchend(e,t,n){this._calculateTransform(e,t,n),this._active&&n.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,t,n){n.length>0&&(this._active=!0);let r=pw(n,t),a=new aM.default(0,0),o=new aM.default(0,0),s=0;for(let h in r){let d=r[h],f=this._touches[h];f&&(a._add(d),o._add(d.sub(f)),s++,r[h]=d)}if(this._touches=r,s<this.minTouchs()||!o.mag())return;let u=o.div(s);return this._sum._add(u),this._sum.mag()<this._clickTolerance?void 0:{around:a.div(s),panDelta:u}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}};l(PK,"TouchPanHandler");var vbe=PK;R();var LK=class{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,t,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([t[0],t[1]]))}touchmove(e,t,n){if(!this._firstTwoTouches)return;e.preventDefault();let[r,a]=this._firstTwoTouches,o=Jy(n,t,r),s=Jy(n,t,a);if(!o||!s)return;let u=this._aroundCenter?null:o.add(s).div(2);return this._move([o,s],u,e)}touchend(e,t,n){if(!this._firstTwoTouches)return;let[r,a]=this._firstTwoTouches,o=Jy(n,t,r),s=Jy(n,t,a);o&&s||(this._active&&wt.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}};l(LK,"TwoFingersTouchHandler");var DL=LK;function Jy(i,e,t){for(let n=0;n<i.length;n++)if(i[n].identifier===t)return e[n]}l(Jy,"getTouchById");var _be=.1;function pE(i,e){return Math.log(i/e)/Math.LN2}l(pE,"getZoomDelta");var DK=class extends DL{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,t){let n=this._distance;if(this._distance=e[0].dist(e[1]),!(!this._active&&Math.abs(pE(this._distance,this._startDistance))<_be))return this._active=!0,{zoomDelta:pE(this._distance,n),pinchAround:t}}};l(DK,"TwoFingersTouchZoomHandler");var xbe=DK,bbe=25;function dE(i,e){return i.angleWith(e)*180/Math.PI}l(dE,"getBearingDelta");var kK=class extends DL{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,t,n){let r=this._vector;if(this._vector=e[0].sub(e[1]),!(!this._active&&this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:dE(this._vector,r),pinchAround:t}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());let t=Math.PI*this._minDiameter,n=bbe/t*360,r=dE(e,this._startVector);return Math.abs(r)<n}};l(kK,"TwoFingersTouchRotateHandler");var wbe=kK;function vx(i){return Math.abs(i.y)>Math.abs(i.x)}l(vx,"isVertical");var Abe=100,RK=class extends DL{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,t,n){super.touchstart(e,t,n),this._currentTouchCount=n.length}_start(e){this._lastPoints=e,vx(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,t,n){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;let r=e[0].sub(this._lastPoints[0]),a=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(r,a,n.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(r.y+a.y)/2*-.5}):void 0}gestureBeginsVertically(e,t,n){if(this._valid!==void 0)return this._valid;let r=2,a=e.mag()>=r,o=t.mag()>=r;if(!a&&!o)return;if(!a||!o)return this._firstMove===void 0&&(this._firstMove=n),n-this._firstMove<Abe?void 0:!1;let s=e.y>0==t.y>0;return vx(e)&&vx(t)&&s}};l(RK,"TwoFingersTouchPitchHandler");var Sbe=RK;R();var Mbe={panStep:100,bearingStep:15,pitchStep:10},OK=class{constructor(e){this._tr=new p0(e);let t=Mbe;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let t=0,n=0,r=0,a=0,o=0;switch(e.keyCode){case 61:case 107:case 171:case 187:t=1;break;case 189:case 109:case 173:t=-1;break;case 37:e.shiftKey?n=-1:(e.preventDefault(),a=-1);break;case 39:e.shiftKey?n=1:(e.preventDefault(),a=1);break;case 38:e.shiftKey?r=1:(e.preventDefault(),o=-1);break;case 40:e.shiftKey?r=-1:(e.preventDefault(),o=1);break;default:return}return this._rotationDisabled&&(n=0,r=0),{cameraAnimation:l(s=>{let u=this._tr;s.easeTo({duration:300,easeId:"keyboardHandler",easing:NK,zoom:t?Math.round(u.zoom)+t*(e.shiftKey?2:1):u.zoom,bearing:u.bearing+n*this._bearingStep,pitch:u.pitch+r*this._pitchStep,offset:[-a*this._panStep,-o*this._panStep],center:u.center},{originalEvent:e})},"cameraAnimation")}}enable(){console.warn("maplibre keyboard events are not supported, use SDK keyboard events instead.")}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}};l(OK,"KeyboardHandler");var Cbe=OK;function NK(i){return i*(2-i)}l(NK,"easeOut");R();var _R=4.000244140625,Ebe=1/100,Ibe=1/450,Tbe=2,FK=class{constructor(e,t){this._onTimeout=l(n=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)},"_onTimeout"),this._map=e,this._tr=new p0(e),this._triggerRenderFrame=t,this._delta=0,this._defaultZoomRate=Ebe,this._wheelZoomRate=Ibe}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){console.log("Enable maplibre scrollZoom events will not work. Use Mappedin SDK interactions events instead.")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(e){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!e[this._map.cooperativeGestures._bypassKey])return;let t=e.deltaMode===WheelEvent.DOM_DELTA_LINE?e.deltaY*40:e.deltaY,n=Mn.now(),r=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,t!==0&&t%_R===0?this._type="wheel":t!==0&&Math.abs(t)<4?this._type="trackpad":r>400?(this._type=null,this._lastValue=t,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(r*t)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,t+=this._lastValue)),e.shiftKey&&t&&(t=t/4),this._type&&(this._lastWheelEvent=e,this._delta-=t,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let t=wt.mousePos(this._map.getCanvas(),e),n=this._tr;t.y>n.transform.height/2-n.transform.getHorizon()?this._around=on.convert(this._aroundCenter?n.center:n.unproject(t)):this._around=on.convert(n.center),this._aroundPoint=n.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;let e=this._tr.transform;if(this._delta!==0){let s=this._type==="wheel"&&Math.abs(this._delta)>_R?this._wheelZoomRate:this._defaultZoomRate,u=Tbe/(1+Math.exp(-Math.abs(this._delta*s)));this._delta<0&&u!==0&&(u=1/u);let h=typeof this._targetZoom=="number"?e.zoomScale(this._targetZoom):e.scale;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(h*u))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}let t=typeof this._targetZoom=="number"?this._targetZoom:e.zoom,n=this._startZoom,r=this._easing,a=!1,o;if(this._type==="wheel"&&n&&r){let s=Math.min((Mn.now()-this._lastWheelEventTime)/200,1),u=r(s);o=Mr.number(n,t,u),s<1?this._frameId||(this._frameId=!0):a=!0}else o=t,a=!0;return this._active=!0,a&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!a,zoomDelta:o-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let t=qC;if(this._prevEase){let n=this._prevEase,r=(Mn.now()-n.start)/n.duration,a=n.easing(r+.01)-n.easing(r),o=.27/Math.sqrt(a*a+1e-4)*.01,s=Math.sqrt(.27*.27-o*o);t=Yw(o,s,.25,1)}return this._prevEase={start:Mn.now(),duration:e,easing:t},t}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}};l(FK,"ScrollZoomHandler");var Pbe=FK;R();var BK=class{constructor(e,t){this._clickZoom=e,this._tapZoom=t}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}};l(BK,"DoubleClickZoomHandler");var Lbe=BK;R();var zK=class{constructor(e){this._tr=new p0(e),this.reset()}reset(){this._active=!1}dblclick(e,t){return e.preventDefault(),{cameraAnimation:l(n=>{n.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(t)},{originalEvent:e})},"cameraAnimation")}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}};l(zK,"ClickZoomHandler");var Dbe=zK;R();var UK=class{constructor(){this._tap=new cE({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,t,n){if(!this._swipePoint)if(!this._tapTime)this._tap.touchstart(e,t,n);else{let r=t[0],a=e.timeStamp-this._tapTime<vK,o=this._tapPoint.dist(r)<IL;!a||!o?this.reset():n.length>0&&(this._swipePoint=r,this._swipeTouch=n[0].identifier)}}touchmove(e,t,n){if(!this._tapTime)this._tap.touchmove(e,t,n);else if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;let r=t[0],a=r.y-this._swipePoint.y;return this._swipePoint=r,e.preventDefault(),this._active=!0,{zoomDelta:a/128}}}touchend(e,t,n){if(this._tapTime)this._swipePoint&&n.length===0&&this.reset();else{let r=this._tap.touchend(e,t,n);r&&(this._tapTime=e.timeStamp,this._tapPoint=r)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}};l(UK,"TapDragZoomHandler");var kbe=UK;R();var VK=class{constructor(e,t,n){this._el=e,this._mousePan=t,this._touchPan=n}enable(e){console.log("Maplibre interaction is not supported. Use Mappedin SDK interaction instead")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}};l(VK,"DragPanHandler");var Rbe=VK;R();var jK=class{constructor(e,t,n){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=t,this._mousePitch=n}enable(){console.warn("dragRotate does not work. Use SDK interaction events instead.")}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}};l(jK,"DragRotateHandler");var Obe=jK;R();var GK=class{constructor(e,t,n,r){this._el=e,this._touchZoom=t,this._touchRotate=n,this._tapDragZoom=r,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}};l(GK,"TwoFingersTouchZoomRotateHandler");var Nbe=GK;R();var $K=class{constructor(e,t){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=t,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;let e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=wt.create("div","maplibregl-cooperative-gesture-screen",e);let t=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(t=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));let n=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),r=document.createElement("div");r.className="maplibregl-desktop-message",r.textContent=t,this._container.appendChild(r);let a=document.createElement("div");a.className="maplibregl-mobile-message",a.textContent=n,this._container.appendChild(a),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(wt.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(e){this._onCooperativeGesture(e.touches.length===1)}wheel(e){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!e[this._bypassKey])}_onCooperativeGesture(e){!this._enabled||!e||(this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}};l($K,"CooperativeGesturesHandler");var Fbe=$K,Bbe=ii(Rn(),1),b_=l(i=>i.zoom||i.drag||i.pitch||i.rotate,"isMoving"),HK=class extends Tt{};l(HK,"RenderFrameEvent");var zbe=HK;function _x(i){return i.panDelta&&i.panDelta.mag()||i.zoomDelta||i.bearingDelta||i.pitchDelta}l(_x,"hasChange");var WK=class{constructor(e,t){this.handleWindowEvent=l(r=>{this.handleEvent(r,"".concat(r.type,"Window"))},"handleWindowEvent"),this.handleEvent=l((r,a)=>{if(r.type==="blur"){this.stop(!0);return}this._updatingCamera=!0;let o=r.type==="renderFrame"?void 0:r,s={needsRenderFrame:!1},u={},h={},d=r.touches,f=d?this._getMapTouches(d):void 0,m=f?wt.touchPos(this._map.getCanvas(),f):wt.mousePos(this._map.getCanvas(),r);for(let{handlerName:w,handler:A,allowed:E}of this._handlers){if(!A.isEnabled())continue;let I;this._blockedByActive(h,E,w)?A.reset():A[a||r.type]&&(I=A[a||r.type](r,m,f),this.mergeHandlerResult(s,u,I,w,o),I&&I.needsRenderFrame&&this._triggerRenderFrame()),(I||A.isActive())&&(h[w]=A)}let v={};for(let w in this._previousActiveHandlers)h[w]||(v[w]=o);this._previousActiveHandlers=h,(Object.keys(v).length||_x(s))&&(this._changes.push([s,u,v]),this._triggerRenderFrame()),(Object.keys(h).length||_x(s))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:b}=s;b&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],b(this._map))},"handleEvent"),this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new nbe(e),this._bearingSnap=t.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(t);let n=this._el;this._listeners=[[n,"touchstart",{passive:!0}],[n,"touchmove",{passive:!1}],[n,"touchend",void 0],[n,"touchcancel",void 0],[n,"mousedown",void 0],[n,"mousemove",void 0],[n,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[n,"mouseover",void 0],[n,"mouseout",void 0],[n,"dblclick",void 0],[n,"click",void 0],[n,"keydown",{capture:!1}],[n,"keyup",void 0],[n,"wheel",{passive:!1}],[n,"contextmenu",void 0],[window,"blur",void 0]];for(let[r,a,o]of this._listeners);}destroy(){for(let[e,t,n]of this._listeners)wt.removeEventListener(e,t,e===document?this.handleWindowEvent:this.handleEvent,n)}_addDefaultHandlers(e){let t=this._map,n=t.getCanvasContainer();this._add("mapEvent",new obe(t,e));let r=t.boxZoom=new ube(t,e);this._add("boxZoom",r),e.interactive&&e.boxZoom&&r.enable();let a=t.cooperativeGestures=new Fbe(t,e.cooperativeGestures);this._add("cooperativeGestures",a),e.cooperativeGestures&&a.enable();let o=new dbe(t),s=new Dbe(t);t.doubleClickZoom=new Lbe(s,o),this._add("tapZoom",o),this._add("clickZoom",s),e.interactive&&e.doubleClickZoom&&t.doubleClickZoom.enable();let u=new kbe;this._add("tapDragZoom",u);let h=t.touchPitch=new Sbe(t);this._add("touchPitch",h),e.interactive&&e.touchPitch&&t.touchPitch.enable(e.touchPitch);let d=IK(e),f=TK(e);t.dragRotate=new Obe(e,d,f),this._add("mouseRotate",d,["mousePitch"]),this._add("mousePitch",f,["mouseRotate"]),e.interactive&&e.dragRotate&&t.dragRotate.enable();let m=ybe(e),v=new vbe(e,t);t.dragPan=new Rbe(n,m,v),this._add("mousePan",m),this._add("touchPan",v,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&t.dragPan.enable(e.dragPan);let b=new wbe,w=new xbe;t.touchZoomRotate=new Nbe(n,w,b,u),this._add("touchRotate",b,["touchPan","touchZoom"]),this._add("touchZoom",w,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&t.touchZoomRotate.enable(e.touchZoomRotate);let A=t.scrollZoom=new Pbe(t,()=>this._triggerRenderFrame());this._add("scrollZoom",A,["mousePan"]),e.interactive&&e.scrollZoom&&t.scrollZoom.enable(e.scrollZoom);let E=t.keyboard=new Cbe(t);this._add("keyboard",E),e.interactive&&e.keyboard&&t.keyboard.enable(),this._add("blockableMapEvent",new sbe(t))}_add(e,t,n){this._handlers.push({handlerName:e,handler:t,allowed:n}),this._handlersById[e]=t}stop(e){if(!this._updatingCamera){for(let{handler:t}of this._handlers)t.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(let{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!b_(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,t,n){for(let r in e)if(r!==n&&(!t||t.indexOf(r)<0))return!0;return!1}_getMapTouches(e){let t=[];for(let n of e){let r=n.target;this._el.contains(r)&&t.push(n)}return t}mergeHandlerResult(e,t,n,r,a){if(!n)return;ti(e,n);let o={handlerName:r,originalEvent:n.originalEvent||a};n.zoomDelta!==void 0&&(t.zoom=o),n.panDelta!==void 0&&(t.drag=o),n.pitchDelta!==void 0&&(t.pitch=o),n.bearingDelta!==void 0&&(t.rotate=o)}_applyChanges(){let e={},t={},n={};for(let[r,a,o]of this._changes)r.panDelta&&(e.panDelta=(e.panDelta||new Bbe.default(0,0))._add(r.panDelta)),r.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+r.zoomDelta),r.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+r.bearingDelta),r.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+r.pitchDelta),r.around!==void 0&&(e.around=r.around),r.pinchAround!==void 0&&(e.pinchAround=r.pinchAround),r.noInertia&&(e.noInertia=r.noInertia),ti(t,a),ti(n,o);this._updateMapTransform(e,t,n),this._changes=[]}_updateMapTransform(e,t,n){let r=this._map,a=r._getTransformForUpdate(),o=r.terrain;if(!_x(e)&&!(o&&this._terrainMovement))return this._fireEvents(t,n,!0);let{panDelta:s,zoomDelta:u,bearingDelta:h,pitchDelta:d,around:f,pinchAround:m}=e;m!==void 0&&(f=m),r._stop(!0),f=f||r.transform.centerPoint;let v=a.pointLocation(s?f.sub(s):f);h&&(a.bearing+=h),d&&(a.pitch+=d),u&&(a.zoom+=u),o?!this._terrainMovement&&(t.drag||t.zoom)?(this._terrainMovement=!0,this._map._elevationFreeze=!0,a.setLocationAtPoint(v,f),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,a.recalculateZoom(r.terrain)})):t.drag&&this._terrainMovement?a.center=a.pointLocation(a.centerPoint.sub(s)):a.setLocationAtPoint(v,f):a.setLocationAtPoint(v,f),r._applyUpdatedTransform(a),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(t,n,!0)}_fireEvents(e,t,n){let r=b_(this._eventsInProgress),a=b_(e),o={};for(let d in e){let{originalEvent:f}=e[d];this._eventsInProgress[d]||(o["".concat(d,"start")]=f),this._eventsInProgress[d]=e[d]}!r&&a&&this._fireEvent("movestart",a.originalEvent);for(let d in o)this._fireEvent(d,o[d]);a&&this._fireEvent("move",a.originalEvent);for(let d in e){let{originalEvent:f}=e[d];this._fireEvent(d,f)}let s={},u;for(let d in this._eventsInProgress){let{handlerName:f,originalEvent:m}=this._eventsInProgress[d];this._handlersById[f].isActive()||(delete this._eventsInProgress[d],u=t[f]||m,s["".concat(d,"end")]=u)}for(let d in s)this._fireEvent(d,s[d]);let h=b_(this._eventsInProgress);if(n&&(r||a)&&!h){this._updatingCamera=!0;let d=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),f=l(m=>m!==0&&-this._bearingSnap<m&&m<this._bearingSnap,"shouldSnapToNorth");d&&(d.essential||!Mn.prefersReducedMotion)?(f(d.bearing||this._map.getBearing())&&(d.bearing=0),d.freezeElevation=!0,this._map.easeTo(d,{originalEvent:u})):(this._map.fire(new Tt("moveend",{originalEvent:u})),f(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(e,t){this._map.fire(new Tt(e,t?{originalEvent:t}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new zbe("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}};l(WK,"HandlerManager");var Ube=WK;R();var Ou=ii(Rn(),1),qK=class extends uo{constructor(e,t){super(),this._renderFrameCallback=l(()=>{let n=Math.min((Mn.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(n)),n<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},"_renderFrameCallback"),this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=t.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new on(this.transform.center.lng,this.transform.center.lat)}setCenter(e,t){return this.jumpTo({center:e},t)}panBy(e,t,n){return e=Ou.default.convert(e).mult(-1),this.panTo(this.transform.center,ti({offset:e},t),n)}panTo(e,t,n){return this.easeTo(ti({center:e},t),n)}getZoom(){return this.transform.zoom}setZoom(e,t){return this.jumpTo({zoom:e},t),this}zoomTo(e,t,n){return this.easeTo(ti({zoom:e},t),n)}zoomIn(e,t){return this.zoomTo(this.getZoom()+1,e,t),this}zoomOut(e,t){return this.zoomTo(this.getZoom()-1,e,t),this}getBearing(){return this.transform.bearing}setBearing(e,t){return this.jumpTo({bearing:e},t),this}getPadding(){return this.transform.padding}setPadding(e,t){return this.jumpTo({padding:e},t),this}rotateTo(e,t,n){return this.easeTo(ti({bearing:e},t),n)}resetNorth(e,t){return this.rotateTo(0,ti({duration:1e3},e),t),this}resetNorthPitch(e,t){return this.easeTo(ti({bearing:0,pitch:0,duration:1e3},e),t),this}snapToNorth(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this}getPitch(){return this.transform.pitch}setPitch(e,t){return this.jumpTo({pitch:e},t),this}cameraForBounds(e,t){e=Uc.convert(e);let n=t&&t.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),n,t)}_cameraForBoxAndBearing(e,t,n,r){let a={top:0,bottom:0,right:0,left:0};if(r=ti({padding:a,offset:[0,0],maxZoom:this.transform.maxZoom},r),typeof r.padding=="number"){let Z=r.padding;r.padding={top:Z,bottom:Z,right:Z,left:Z}}r.padding=ti(a,r.padding);let o=this.transform,s=o.padding,u=new Uc(e,t),h=o.project(u.getNorthWest()),d=o.project(u.getNorthEast()),f=o.project(u.getSouthEast()),m=o.project(u.getSouthWest()),v=XC(-n),b=h.rotate(v),w=d.rotate(v),A=f.rotate(v),E=m.rotate(v),I=new Ou.default(Math.max(b.x,w.x,E.x,A.x),Math.max(b.y,w.y,E.y,A.y)),C=new Ou.default(Math.min(b.x,w.x,E.x,A.x),Math.min(b.y,w.y,E.y,A.y)),T=I.sub(C),k=(o.width-(s.left+s.right+r.padding.left+r.padding.right))/T.x,F=(o.height-(s.top+s.bottom+r.padding.top+r.padding.bottom))/T.y;if(F<0||k<0){lo("Map cannot fit within canvas with the given bounds, padding, and/or offset.");return}let B=Math.min(o.scaleZoom(o.scale*Math.min(k,F)),r.maxZoom),N=Ou.default.convert(r.offset),z=(r.padding.left-r.padding.right)/2,L=(r.padding.top-r.padding.bottom)/2,j=new Ou.default(z,L).rotate(XC(n)),q=N.add(j).mult(o.scale/o.zoomScale(B));return{center:o.unproject(h.add(f).div(2).sub(q)),zoom:B,bearing:n}}fitBounds(e,t,n){return this._fitInternal(this.cameraForBounds(e,t),t,n)}fitScreenCoordinates(e,t,n,r,a){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(Ou.default.convert(e)),this.transform.pointLocation(Ou.default.convert(t)),n,r),r,a)}_fitInternal(e,t,n){return e?(t=ti(e,t),delete t.padding,t.linear?this.easeTo(t,n):this.flyTo(t,n)):this}jumpTo(e,t){this.stop();let n=this._getTransformForUpdate(),r=!1,a=!1,o=!1;return"zoom"in e&&n.zoom!==+e.zoom&&(r=!0,n.zoom=+e.zoom),e.center!==void 0&&(n.center=on.convert(e.center)),"bearing"in e&&n.bearing!==+e.bearing&&(a=!0,n.bearing=+e.bearing),"pitch"in e&&n.pitch!==+e.pitch&&(o=!0,n.pitch=+e.pitch),e.padding!=null&&!n.isPaddingEqual(e.padding)&&(n.padding=e.padding),this._applyUpdatedTransform(n),this.fire(new Tt("movestart",t)).fire(new Tt("move",t)),r&&this.fire(new Tt("zoomstart",t)).fire(new Tt("zoom",t)).fire(new Tt("zoomend",t)),a&&this.fire(new Tt("rotatestart",t)).fire(new Tt("rotate",t)).fire(new Tt("rotateend",t)),o&&this.fire(new Tt("pitchstart",t)).fire(new Tt("pitch",t)).fire(new Tt("pitchend",t)),this.fire(new Tt("moveend",t))}calculateCameraOptionsFromTo(e,t,n,r=0){let a=$a.fromLngLat(e,t),o=$a.fromLngLat(n,r),s=o.x-a.x,u=o.y-a.y,h=o.z-a.z,d=Math.hypot(s,u,h);if(d===0)throw new Error("Can't calculate camera options with same From and To");let f=Math.hypot(s,u),m=this.transform.scaleZoom(this.transform.cameraToCenterDistance/d/this.transform.tileSize),v=Math.atan2(s,-u)*180/Math.PI,b=Math.acos(f/d)*180/Math.PI;return b=h<0?90-b:90+b,{center:o.toLngLat(),zoom:m,pitch:b,bearing:v}}easeTo(e,t){var n;this._stop(!1,e.easeId),e=ti({offset:[0,0],duration:500,easing:qC},e),(e.animate===!1||!e.essential&&Mn.prefersReducedMotion)&&(e.duration=0);let r=this._getTransformForUpdate(),a=this.getZoom(),o=this.getBearing(),s=this.getPitch(),u=this.getPadding(),h="bearing"in e?this._normalizeBearing(e.bearing,o):o,d="pitch"in e?+e.pitch:s,f="padding"in e?e.padding:r.padding,m=Ou.default.convert(e.offset),v=r.centerPoint.add(m),b=r.pointLocation(v),{center:w,zoom:A}=r.getConstrained(on.convert(e.center||b),(n=e.zoom)!=null?n:a);this._normalizeCenter(w);let E=r.project(b),I=r.project(w).sub(E),C=r.zoomScale(A-a),T,k;e.around&&(T=on.convert(e.around),k=r.locationPoint(T));let F={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||A!==a,this._rotating=this._rotating||o!==h,this._pitching=this._pitching||d!==s,this._padding=!r.isPaddingEqual(f),this._easeId=e.easeId,this._prepareEase(t,e.noMoveStart,F),this.terrain&&this._prepareElevation(w),this._ease(B=>{if(this._zooming&&(r.zoom=Mr.number(a,A,B)),this._rotating&&(r.bearing=Mr.number(o,h,B)),this._pitching&&(r.pitch=Mr.number(s,d,B)),this._padding&&(r.interpolatePadding(u,f,B),v=r.centerPoint.add(m)),this.terrain&&!e.freezeElevation&&this._updateElevation(B),T)r.setLocationAtPoint(T,k);else{let N=r.zoomScale(r.zoom-a),z=A>a?Math.min(2,C):Math.max(.5,C),L=Math.pow(z,1-B),j=r.unproject(E.add(I.mult(B*L)).mult(N));r.setLocationAtPoint(r.renderWorldCopies?j.wrap():j,v)}this._applyUpdatedTransform(r),this._fireMoveEvents(t)},B=>{this.terrain&&this._finalizeElevation(),this._afterEase(t,B)},e),this}_prepareEase(e,t,n={}){this._moving=!0,!t&&!n.moving&&this.fire(new Tt("movestart",e)),this._zooming&&!n.zooming&&this.fire(new Tt("zoomstart",e)),this._rotating&&!n.rotating&&this.fire(new Tt("rotatestart",e)),this._pitching&&!n.pitching&&this.fire(new Tt("pitchstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);let t=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&t!==this._elevationTarget){let n=this._elevationTarget-this._elevationStart,r=(t-(n*e+this._elevationStart))/(1-e);this._elevationStart+=e*(n-r),this._elevationTarget=t}this.transform.elevation=Mr.number(this._elevationStart,this._elevationTarget,e)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(e){if(!this.transformCameraUpdate)return;let t=e.clone(),{center:n,zoom:r,pitch:a,bearing:o,elevation:s}=this.transformCameraUpdate(t);n&&(t.center=n),r!==void 0&&(t.zoom=r),a!==void 0&&(t.pitch=a),o!==void 0&&(t.bearing=o),s!==void 0&&(t.elevation=s),this.transform.apply(t)}_fireMoveEvents(e){this.fire(new Tt("move",e)),this._zooming&&this.fire(new Tt("zoom",e)),this._rotating&&this.fire(new Tt("rotate",e)),this._pitching&&this.fire(new Tt("pitch",e))}_afterEase(e,t){if(this._easeId&&t&&this._easeId===t)return;delete this._easeId;let n=this._zooming,r=this._rotating,a=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,n&&this.fire(new Tt("zoomend",e)),r&&this.fire(new Tt("rotateend",e)),a&&this.fire(new Tt("pitchend",e)),this.fire(new Tt("moveend",e))}flyTo(e,t){var n;if(!e.essential&&Mn.prefersReducedMotion){let oe=J1(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(oe,t)}this.stop(),e=ti({offset:[0,0],speed:1.2,curve:1.42,easing:qC},e);let r=this._getTransformForUpdate(),a=this.getZoom(),o=this.getBearing(),s=this.getPitch(),u=this.getPadding(),h="bearing"in e?this._normalizeBearing(e.bearing,o):o,d="pitch"in e?+e.pitch:s,f="padding"in e?e.padding:r.padding,m=Ou.default.convert(e.offset),v=r.centerPoint.add(m),b=r.pointLocation(v),{center:w,zoom:A}=r.getConstrained(on.convert(e.center||b),(n=e.zoom)!=null?n:a);this._normalizeCenter(w);let E=r.zoomScale(A-a),I=r.project(b),C=r.project(w).sub(I),T=e.curve,k=Math.max(r.width,r.height),F=k/E,B=C.mag();if("minZoom"in e){let oe=da(Math.min(e.minZoom,a,A),r.minZoom,r.maxZoom),$=k/r.zoomScale(oe-a);T=Math.sqrt($/B*2)}let N=T*T;function z(oe){let $=(F*F-k*k+(oe?-1:1)*N*N*B*B)/(2*(oe?F:k)*N*B);return Math.log(Math.sqrt($*$+1)-$)}l(z,"zoomOutFactor");function L(oe){return(Math.exp(oe)-Math.exp(-oe))/2}l(L,"sinh");function j(oe){return(Math.exp(oe)+Math.exp(-oe))/2}l(j,"cosh");function q(oe){return L(oe)/j(oe)}l(q,"tanh");let Z=z(!1),O=l(function(oe){return j(Z)/j(Z+T*oe)},"w"),Y=l(function(oe){return k*((j(Z)*q(Z+T*oe)-L(Z))/N)/B},"u"),J=(z(!0)-Z)/T;if(Math.abs(B)<1e-6||!isFinite(J)){if(Math.abs(k-F)<1e-6)return this.easeTo(e,t);let oe=F<k?-1:1;J=Math.abs(Math.log(F/k))/T,Y=l(function(){return 0},"u"),O=l(function($){return Math.exp(oe*T*$)},"w")}if("duration"in e)e.duration=+e.duration;else{let oe="screenSpeed"in e?+e.screenSpeed/T:+e.speed;e.duration=1e3*J/oe}return e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=o!==h,this._pitching=d!==s,this._padding=!r.isPaddingEqual(f),this._prepareEase(t,!1),this.terrain&&this._prepareElevation(w),this._ease(oe=>{let $=oe*J,K=1/O($);r.zoom=oe===1?A:a+r.scaleZoom(K),this._rotating&&(r.bearing=Mr.number(o,h,oe)),this._pitching&&(r.pitch=Mr.number(s,d,oe)),this._padding&&(r.interpolatePadding(u,f,oe),v=r.centerPoint.add(m)),this.terrain&&!e.freezeElevation&&this._updateElevation(oe);let te=oe===1?w:r.unproject(I.add(C.mult(Y($))).mult(K));r.setLocationAtPoint(r.renderWorldCopies?te.wrap():te,v),this._applyUpdatedTransform(r),this._fireMoveEvents(t)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(t)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,t){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){let n=this._onEaseEnd;delete this._onEaseEnd,n.call(this,t)}if(!e){let n=this.handlers;n&&n.stop(!1)}return this}_ease(e,t,n){n.animate===!1||n.duration===0?(e(1),t()):(this._easeStart=Mn.now(),this._easeOptions=n,this._onEaseFrame=e,this._onEaseEnd=t,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,t){e=Kp(e,-180,180);let n=Math.abs(e-t);return Math.abs(e-360-t)<n&&(e-=360),Math.abs(e+360-t)<n&&(e+=360),e}_normalizeCenter(e){let t=this.transform;if(!t.renderWorldCopies||t.lngRange)return;let n=e.lng-t.center.lng;e.lng+=n>180?-360:n<-180?360:0}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(on.convert(e),this.transform.tileZoom)-this.transform.elevation:null}};l(qK,"Camera");var Vbe=qK,Uh=ii(Rn(),1);R();var XK={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'},ZK=class{constructor(e=XK){this._toggleAttribution=l(()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},"_toggleAttribution"),this._updateData=l(t=>{t&&(t.sourceDataType==="metadata"||t.sourceDataType==="visibility"||t.dataType==="style"||t.type==="terrain")&&this._updateAttributions()},"_updateData"),this._updateCompact=l(()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):!this._container.classList.contains("maplibregl-compact")&&!this._container.classList.contains("maplibregl-attrib-empty")&&(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},"_updateCompact"),this._updateCompactMinimize=l(()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},"_updateCompactMinimize"),this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=wt.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=wt.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=wt.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){wt.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,t){let n=this._map._getUIString("AttributionControl.".concat(t));e.title=n,e.setAttribute("aria-label",n)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(r=>typeof r!="string"?"":r)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){let r=this._map.style.stylesheet;this.styleOwner=r.owner,this.styleId=r.id}let t=this._map.style.sourceCaches;for(let r in t){let a=t[r];if(a.used||a.usedForTerrain){let o=a.getSource();o.attribution&&e.indexOf(o.attribution)<0&&e.push(o.attribution)}}e=e.filter(r=>String(r).trim()),e.sort((r,a)=>r.length-a.length),e=e.filter((r,a)=>{for(let o=a+1;o<e.length;o++)if(e[o].indexOf(r)>=0)return!1;return!0});let n=e.join(" | ");n!==this._attribHTML&&(this._attribHTML=n,e.length?(this._innerContainer.innerHTML=n,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}};l(ZK,"AttributionControl");var jbe=ZK;R();var YK=class{constructor(e={}){this._updateCompact=l(()=>{let t=this._container.children;if(t.length){let n=t[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&n.classList.add("maplibregl-compact"):n.classList.remove("maplibregl-compact")}},"_updateCompact"),this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=wt.create("div","maplibregl-ctrl");let t=wt.create("a","maplibregl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://maplibre.org/",t.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){wt.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}};l(YK,"LogoControl");var Gbe=YK;R();var JK=class{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){let t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t}remove(e){let t=this._currentlyRunning,n=t?this._queue.concat(t):this._queue;for(let r of n)if(r.id===e){r.cancelled=!0;return}}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");let t=this._currentlyRunning=this._queue;this._queue=[];for(let n of t)if(!n.cancelled&&(n.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}};l(JK,"TaskQueue");var $be=JK;R();var fE=(i=>(i.create="create",i.load="load",i.fullLoad="fullLoad",i))(fE||{}),w_=null,vy=[],Hbe=60,oM=1e3/Hbe,sM="loadTime",lM="fullLoadTime",_y={mark(i){performance.mark(i)},frame(i){let e=i;if(w_!=null){let t=e-w_;vy.push(t)}w_=e},clearMetrics(){w_=null,vy=[],performance.clearMeasures(sM),performance.clearMeasures(lM);for(let i in fE)performance.clearMarks(fE[i])},getPerformanceMetrics(){performance.measure(sM,"create","load"),performance.measure(lM,"create","fullLoad");let i=performance.getEntriesByName(sM)[0].duration,e=performance.getEntriesByName(lM)[0].duration,t=vy.length,n=1/(vy.reduce((o,s)=>o+s,0)/t/1e3),r=vy.filter(o=>o>oM).reduce((o,s)=>o+(s-oM)/oM,0),a=r/(t+r)*100;return{loadTime:i,fullLoadTime:e,fps:n,percentDroppedFrames:a,totalFrames:t}}};R();R();var Wbe=Ir([{name:"a_pos3d",type:"Int16",components:3}]);R();var KK=class extends uo{constructor(e){super(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,e.usedForTerrain=!0,e.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,t){this.sourceCache.update(e,t),this._renderableTilesKeys=[];let n={};for(let r of e.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:t}))n[r.key]=!0,this._renderableTilesKeys.push(r.key),this._tiles[r.key]||(r.posMatrix=new Float64Array(16),Qt.ortho(r.posMatrix,0,8192,0,8192,0,1),this._tiles[r.key]=new GZ(r,this.tileSize));for(let r in this._tiles)n[r]||delete this._tiles[r]}freeRtt(e){for(let t in this._tiles){let n=this._tiles[t];(!e||n.tileID.equals(e)||n.tileID.isChildOf(e)||e.isChildOf(n.tileID))&&(n.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){let t={};for(let n of this._renderableTilesKeys){let r=this._tiles[n].tileID;if(r.canonical.equals(e.canonical)){let a=e.clone();a.posMatrix=new Float64Array(16),Qt.ortho(a.posMatrix,0,8192,0,8192,0,1),t[n]=a}else if(r.canonical.isChildOf(e.canonical)){let a=e.clone();a.posMatrix=new Float64Array(16);let o=r.canonical.z-e.canonical.z,s=r.canonical.x-(r.canonical.x>>o<<o),u=r.canonical.y-(r.canonical.y>>o<<o),h=8192>>o;Qt.ortho(a.posMatrix,0,h,0,h,0,1),Qt.translate(a.posMatrix,a.posMatrix,[-s*h,-u*h,0]),t[n]=a}else if(e.canonical.isChildOf(r.canonical)){let a=e.clone();a.posMatrix=new Float64Array(16);let o=e.canonical.z-r.canonical.z,s=e.canonical.x-(e.canonical.x>>o<<o),u=e.canonical.y-(e.canonical.y>>o<<o),h=8192>>o;Qt.ortho(a.posMatrix,0,8192,0,8192,0,1),Qt.translate(a.posMatrix,a.posMatrix,[s*h,u*h,0]),Qt.scale(a.posMatrix,a.posMatrix,[1/2**o,1/2**o,0]),t[n]=a}}return t}getSourceTile(e,t){let n=this.sourceCache._source,r=e.overscaledZ-this.deltaZoom;if(r>n.maxzoom&&(r=n.maxzoom),r<n.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(r).key);let a=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if(!(a&&a.dem)&&t)for(;r>=n.minzoom&&!(a&&a.dem);)a=this.sourceCache.getTileByID(e.scaledTo(r--).key);return a}tilesAfterTime(e=Date.now()){return Object.values(this._tiles).filter(t=>t.timeAdded>=e)}};l(KK,"TerrainSourceCache");var qbe=KK,QK=class{constructor(e,t,n){this.painter=e,this.sourceCache=new qbe(t),this.options=n,this.exaggeration=typeof n.exaggeration=="number"?n.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,t,n,r=8192){var a;if(!(t>=0&&t<r&&n>=0&&n<r))return 0;let o=this.getTerrainData(e),s=(a=o.tile)==null?void 0:a.dem;if(!s)return 0;let u=W4.transformMat4([],[t/r*8192,n/r*8192],o.u_terrain_matrix),h=[u[0]*s.dim,u[1]*s.dim],d=Math.floor(h[0]),f=Math.floor(h[1]),m=h[0]-d,v=h[1]-f;return s.get(d,f)*(1-m)*(1-v)+s.get(d+1,f)*m*(1-v)+s.get(d,f+1)*(1-m)*v+s.get(d+1,f+1)*m*v}getElevationForLngLatZoom(e,t){let{tileID:n,mercatorX:r,mercatorY:a}=this._getOverscaledTileIDFromLngLatZoom(e,t);return this.getElevation(n,r%8192,a%8192,8192)}getElevation(e,t,n,r=8192){return this.getDEMElevation(e,t,n,r)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){let r=this.painter.context,a=new Or({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Aa(r,a,r.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Aa(r,new Or({width:1,height:1}),r.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(r.gl.NEAREST,r.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=Qt.identity([])}let t=this.sourceCache.getSourceTile(e,!0);if(t&&t.dem&&(!t.demTexture||t.needsTerrainPrepare)){let r=this.painter.context;t.demTexture=this.painter.getTileTexture(t.dem.stride),t.demTexture?t.demTexture.update(t.dem.getPixels(),{premultiply:!1}):t.demTexture=new Aa(r,t.dem.getPixels(),r.gl.RGBA,{premultiply:!1}),t.demTexture.bind(r.gl.NEAREST,r.gl.CLAMP_TO_EDGE),t.needsTerrainPrepare=!1}let n=t&&t+t.tileID.key+e.key;if(n&&!this._demMatrixCache[n]){let r=this.sourceCache.sourceCache._source.maxzoom,a=e.canonical.z-t.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=r?a=e.canonical.z-r:lo("cannot calculate elevation if elevation maxzoom > source.maxzoom"));let o=e.canonical.x-(e.canonical.x>>a<<a),s=e.canonical.y-(e.canonical.y>>a<<a),u=Qt.fromScaling(new Float64Array(16),[1/(8192<<a),1/(8192<<a),0]);Qt.translate(u,u,[o*8192,s*8192,0]),this._demMatrixCache[e.key]={matrix:u,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:t&&t.dem&&t.dem.dim||1,u_terrain_matrix:n?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:t&&t.dem&&t.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(t&&t.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:t}}getFramebuffer(e){let t=this.painter,n=t.width/devicePixelRatio,r=t.height/devicePixelRatio;return this._fbo&&(this._fbo.width!==n||this._fbo.height!==r)&&(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Aa(t.context,{width:n,height:r,data:null},t.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(t.context.gl.NEAREST,t.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Aa(t.context,{width:n,height:r,data:null},t.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(t.context.gl.NEAREST,t.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=t.context.createFramebuffer(n,r,!0,!1),this._fbo.depthAttachment.set(t.context.createRenderbuffer(t.context.gl.DEPTH_COMPONENT16,n,r))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){let e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;let t=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let a=0,o=0;a<this._coordsTextureSize;a++)for(let s=0;s<this._coordsTextureSize;s++,o+=4)t[o+0]=s&255,t[o+1]=a&255,t[o+2]=s>>8<<4|a>>8,t[o+3]=0;let n=new Or({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(t.buffer)),r=new Aa(e,n,e.gl.RGBA,{premultiply:!1});return r.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=r,r}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);let t=new Uint8Array(4),n=this.painter.context,r=n.gl,a=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),o=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),s=Math.round(this.painter.height/devicePixelRatio);n.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),r.readPixels(a,s-o-1,1,1,r.RGBA,r.UNSIGNED_BYTE,t),n.bindFramebuffer.set(null);let u=t[0]+(t[2]>>4<<8),h=t[1]+((t[2]&15)<<8),d=this.coordsIndex[255-t[3]],f=d&&this.sourceCache.getTileByID(d);if(!f)return null;let m=this._coordsTextureSize,v=(1<<f.tileID.canonical.z)*m;return new $a((f.tileID.canonical.x*m+u)/v+f.tileID.wrap,(f.tileID.canonical.y*m+h)/v,this.getElevation(f.tileID,u,h,m))}depthAtPoint(e){let t=new Uint8Array(4),n=this.painter.context,r=n.gl;return n.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),r.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,r.RGBA,r.UNSIGNED_BYTE,t),n.bindFramebuffer.set(null),(t[0]/(256*256*256)+t[1]/(256*256)+t[2]/256+t[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;let e=this.painter.context,t=new Xge,n=new kd,r=this.meshSize,a=8192/r,o=r*r;for(let f=0;f<=r;f++)for(let m=0;m<=r;m++)t.emplaceBack(m*a,f*a,0);for(let f=0;f<o;f+=r+1)for(let m=0;m<r;m++)n.emplaceBack(m+f,r+m+f+1,r+m+f+2),n.emplaceBack(m+f,r+m+f+2,m+f+1);let s=t.length,u=s+(r+1)*2;for(let f of[0,1])for(let m=0;m<=r;m++)for(let v of[0,1])t.emplaceBack(m*a,f*8192,v);for(let f=0;f<r*2;f+=2)n.emplaceBack(u+f,u+f+1,u+f+3),n.emplaceBack(u+f,u+f+3,u+f+2),n.emplaceBack(s+f,s+f+3,s+f+1),n.emplaceBack(s+f,s+f+2,s+f+3);let h=t.length,d=h+(r+1)*2;for(let f of[0,1])for(let m=0;m<=r;m++)for(let v of[0,1])t.emplaceBack(f*8192,m*a,v);for(let f=0;f<r*2;f+=2)n.emplaceBack(h+f,h+f+1,h+f+3),n.emplaceBack(h+f,h+f+3,h+f+2),n.emplaceBack(d+f,d+f+3,d+f+1),n.emplaceBack(d+f,d+f+2,d+f+3);return this._mesh={indexBuffer:e.createIndexBuffer(n),vertexBuffer:e.createVertexBuffer(t,Wbe.members),segments:$r.simpleSegment(0,0,t.length,n.length)},this._mesh}getMeshFrameDelta(e){return 2*Math.PI*fL/Math.pow(2,e)/5}getMinTileElevationForLngLatZoom(e,t){var n;let{tileID:r}=this._getOverscaledTileIDFromLngLatZoom(e,t);return(n=this.getMinMaxElevation(r).minElevation)!=null?n:0}getMinMaxElevation(e){let t=this.getTerrainData(e).tile,n={minElevation:null,maxElevation:null};return t&&t.dem&&(n.minElevation=t.dem.min*this.exaggeration,n.maxElevation=t.dem.max*this.exaggeration),n}_getOverscaledTileIDFromLngLatZoom(e,t){let n=$a.fromLngLat(e.wrap()),r=(1<<t)*8192,a=n.x*r,o=n.y*r,s=Math.floor(a/8192),u=Math.floor(o/8192);return{tileID:new ls(t,0,t,s,u),mercatorX:a,mercatorY:o}}};l(QK,"Terrain");var Xbe=QK;R();R();var eQ=class{constructor(e,t,n){this._context=e,this._size=t,this._tileSize=n,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(let e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){let t=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),n=new Aa(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return n.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),t.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),t.colorAttachment.set(n.texture),{id:e,fbo:t,texture:n,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(t=>e.id!==t),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(let t of this._recentlyUsed)if(!this._objects[t].inUse)return this._objects[t];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");let e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(let e of this._objects)this.freeObject(e)}isFull(){return this._objects.length<this._size?!1:this._objects.some(e=>!e.inUse)===!1}};l(eQ,"RenderPool");var Zbe=eQ,sf={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0},tQ=class{constructor(e,t){this.painter=e,this.terrain=t,this.pool=new Zbe(e.context,30,t.sourceCache.tileSize*t.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,t){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(n=>!e._layers[n].isHidden(t)),this._coordsDescendingInv={};for(let n in e.sourceCaches){this._coordsDescendingInv[n]={};let r=e.sourceCaches[n].getVisibleCoordinates();for(let a of r){let o=this.terrain.sourceCache.getTerrainCoords(a);for(let s in o)this._coordsDescendingInv[n][s]||(this._coordsDescendingInv[n][s]=[]),this._coordsDescendingInv[n][s].push(o[s])}}this._coordsDescendingInvStr={};for(let n of e._order){let r=e._layers[n],a=r.source;if(sf[r.type]&&!this._coordsDescendingInvStr[a]){this._coordsDescendingInvStr[a]={};for(let o in this._coordsDescendingInv[a])this._coordsDescendingInvStr[a][o]=this._coordsDescendingInv[a][o].map(s=>s.key).sort().join()}}for(let n of this._renderableTiles)for(let r in this._coordsDescendingInvStr){let a=this._coordsDescendingInvStr[r][n.tileID.key];a&&a!==n.rttCoords[r]&&(n.rtt=[])}}renderLayer(e){if(e.isHidden(this.painter.transform.zoom))return!1;let t=e.type,n=this.painter,r=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(sf[t]&&((!this._prevType||!sf[this._prevType])&&this._stacks.push([]),this._prevType=t,this._stacks[this._stacks.length-1].push(e.id),!r))return!0;if(sf[this._prevType]||sf[t]&&r){this._prevType=t;let a=this._stacks.length-1,o=this._stacks[a]||[];for(let s of this._renderableTiles){if(this.pool.isFull()&&(hE(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(s),s.rtt[a]){let h=this.pool.getObjectForId(s.rtt[a].id);if(h.stamp===s.rtt[a].stamp){this.pool.useObject(h);continue}}let u=this.pool.getOrCreateFreeObject();this.pool.useObject(u),this.pool.stampObject(u),s.rtt[a]={id:u.id,stamp:u.stamp},n.context.bindFramebuffer.set(u.fbo.framebuffer),n.context.clear({color:Wi.transparent,stencil:0}),n.currentStencilSource=void 0;for(let h=0;h<o.length;h++){let d=n.style._layers[o[h]],f=d.source?this._coordsDescendingInv[d.source][s.tileID.key]:[s.tileID];n.context.viewport.set([0,0,u.fbo.width,u.fbo.height]),n._renderTileClippingMasks(d,f),n.renderLayer(n,n.style.sourceCaches[d.source],d,f),d.source&&(s.rttCoords[d.source]=this._coordsDescendingInvStr[d.source][s.tileID.key])}}return hE(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),sf[t]}return!1}};l(tQ,"RenderToTexture");var Ybe=tQ;R();var Jbe={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Kbe=XB.version,xx=-2,iQ=22,Xh=0,nQ=80,A_=85,Qbe={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:xx,maxZoom:iQ,minPitch:Xh,maxPitch:nQ,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:XK,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:_s.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},rQ=class extends Vbe{constructor(e){if(_y.mark("create"),e=ti({},Qbe,e),e.minZoom!=null&&e.maxZoom!=null&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(e.minPitch!=null&&e.maxPitch!=null&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(e.minPitch!=null&&e.minPitch<Xh)throw new Error("minPitch must be greater than or equal to ".concat(Xh));if(e.maxPitch!=null&&e.maxPitch>A_)throw new Error("maxPitch must be less than or equal to ".concat(A_));let t=new Yxe(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies);if(super(t,{bearingSnap:e.bearingSnap}),this._contextLost=l(r=>{r.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new Tt("webglcontextlost",{originalEvent:r}))},"_contextLost"),this._contextRestored=l(r=>{this._setupPainter(),this.resize(),this._update(),this.fire(new Tt("webglcontextrestored",{originalEvent:r}))},"_contextRestored"),this._onMapScroll=l(r=>{if(r.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},"_onMapScroll"),this._onWindowOnline=l(()=>{this._update()},"_onWindowOnline"),this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._maxTileCacheZoomLevels=e.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._renderTaskQueue=new $be,this._controls=[],this._mapId=t5(),this._locale=ti({},Jbe,e.locale),this._clickTolerance=e.clickTolerance,this._overridePixelRatio=e.pixelRatio,this._maxCanvasSize=e.maxCanvasSize,this.transformCameraUpdate=e.transformCameraUpdate,this._imageQueueHandle=tu.addThrottleControl(()=>this.isMoving()),this._requestManager=new wme(e.transformRequest),typeof e.container=="string"){if(this._container=document.getElementById(e.container),!this._container)throw new Error("Container '".concat(e.container,"' not found."))}else if(e.container instanceof HTMLElement)this._container=e.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");if(e.maxBounds&&this.setMaxBounds(e.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let r=!1,a=kA(o=>{this._trackResize&&!this._removed&&this.resize(o)._update()},50);this._resizeObserver=new ResizeObserver(o=>{if(!r){r=!0;return}a(o)}),this._resizeObserver.observe(this._container)}this.handlers=new Ube(this,e);let n=typeof e.hash=="string"&&e.hash||void 0;this._hash=e.hash&&new Jxe(n).addTo(this),(!this._hash||!this._hash._onHashChange())&&(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,ti({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=e.localIdeographFontFamily,this._validateStyle=e.validateStyle,e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new jbe(typeof e.attributionControl=="boolean"?void 0:e.attributionControl)),e.maplibreLogo&&this.addControl(new Gbe,e.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",r=>{this._update(r.dataType==="style"),this.fire(new Tt("".concat(r.dataType,"data"),r))}),this.on("dataloading",r=>{this.fire(new Tt("".concat(r.dataType,"dataloading"),r))}),this.on("dataabort",r=>{this.fire(new Tt("sourcedataabort",r))})}_getMapId(){return this._mapId}addControl(e,t){if(t===void 0&&(e.getDefaultPosition?t=e.getDefaultPosition():t="top-right"),!e||!e.onAdd)return this.fire(new ki(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));let n=e.onAdd(this);this._controls.push(e);let r=this._controlPositions[t];return t.indexOf("bottom")!==-1?r.insertBefore(n,r.firstChild):r.appendChild(n),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new ki(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));let t=this._controls.indexOf(e);return t>-1&&this._controls.splice(t,1),e.onRemove(this),this}hasControl(e){return this._controls.indexOf(e)>-1}calculateCameraOptionsFromTo(e,t,n,r){return r==null&&this.terrain&&(r=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(e,t,n,r)}resize(e){var t;let n=this._containerDimensions(),r=n[0],a=n[1],o=this._getClampedPixelRatio(r,a);if(this._resizeCanvas(r,a,o),this.painter.resize(r,a,o),this.painter.overLimit()){let u=this.painter.context.gl;this._maxCanvasSize=[u.drawingBufferWidth,u.drawingBufferHeight];let h=this._getClampedPixelRatio(r,a);this._resizeCanvas(r,a,h),this.painter.resize(r,a,h)}this.transform.resize(r,a),(t=this._requestedCameraState)==null||t.resize(r,a);let s=!this._moving;return s&&(this.stop(),this.fire(new Tt("movestart",e)).fire(new Tt("move",e))),this.fire(new Tt("resize",e)),s&&this.fire(new Tt("moveend",e)),this}_getClampedPixelRatio(e,t){let{0:n,1:r}=this._maxCanvasSize,a=this.getPixelRatio(),o=e*a,s=t*a,u=o>n?n/o:1,h=s>r?r/s:1;return Math.min(u,h)*a}getPixelRatio(){var e;return(e=this._overridePixelRatio)!=null?e:devicePixelRatio}setPixelRatio(e){this._overridePixelRatio=e,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(e){return this.transform.setMaxBounds(Uc.convert(e)),this._update()}setMinZoom(e){if(e=e??xx,e>=xx&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e&&this.setZoom(e),this;throw new Error("minZoom must be between ".concat(xx," and the current maxZoom, inclusive"))}getMinZoom(){return this.transform.minZoom}setMaxZoom(e){if(e=e??iQ,e>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e&&this.setZoom(e),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(e){if(e=e??Xh,e<Xh)throw new Error("minPitch must be greater than or equal to ".concat(Xh));if(e>=Xh&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this._update(),this.getPitch()<e&&this.setPitch(e),this;throw new Error("minPitch must be between ".concat(Xh," and the current maxPitch, inclusive"))}getMinPitch(){return this.transform.minPitch}setMaxPitch(e){if(e=e??nQ,e>A_)throw new Error("maxPitch must be less than or equal to ".concat(A_));if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this._update(),this.getPitch()>e&&this.setPitch(e),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(e){return this.transform.renderWorldCopies=e,this._update()}project(e){return this.transform.locationPoint(on.convert(e),this.style&&this.terrain)}unproject(e){return this.transform.pointLocation(Uh.default.convert(e),this.terrain)}isMoving(){var e;return this._moving||((e=this.handlers)==null?void 0:e.isMoving())}isZooming(){var e;return this._zooming||((e=this.handlers)==null?void 0:e.isZooming())}isRotating(){var e;return this._rotating||((e=this.handlers)==null?void 0:e.isRotating())}_createDelegatedListener(e,t,n){if(e==="mouseenter"||e==="mouseover"){let r=!1;return{layer:t,listener:n,delegates:{mousemove:l(a=>{let o=this.getLayer(t)?this.queryRenderedFeatures(a.point,{layers:[t]}):[];o.length?r||(r=!0,n.call(this,new Os(e,this,a.originalEvent,{features:o}))):r=!1},"mousemove"),mouseout:l(()=>{r=!1},"mouseout")}}}else if(e==="mouseleave"||e==="mouseout"){let r=!1;return{layer:t,listener:n,delegates:{mousemove:l(a=>{(this.getLayer(t)?this.queryRenderedFeatures(a.point,{layers:[t]}):[]).length?r=!0:r&&(r=!1,n.call(this,new Os(e,this,a.originalEvent)))},"mousemove"),mouseout:l(a=>{r&&(r=!1,n.call(this,new Os(e,this,a.originalEvent)))},"mouseout")}}}else{let r=l(a=>{let o=this.getLayer(t)?this.queryRenderedFeatures(a.point,{layers:[t]}):[];o.length&&(a.features=o,n.call(this,a),delete a.features)},"delegate");return{layer:t,listener:n,delegates:{[e]:r}}}}on(e,t,n){if(n===void 0)return super.on(e,t);let r=this._createDelegatedListener(e,t,n);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(r);for(let a in r.delegates)this.on(a,r.delegates[a]);return this}once(e,t,n){if(n===void 0)return super.once(e,t);let r=this._createDelegatedListener(e,t,n);for(let a in r.delegates)this.once(a,r.delegates[a]);return this}off(e,t,n){if(n===void 0)return super.off(e,t);let r=l(a=>{let o=a[e];for(let s=0;s<o.length;s++){let u=o[s];if(u.layer===t&&u.listener===n){for(let h in u.delegates)this.off(h,u.delegates[h]);return o.splice(s,1),this}}},"removeDelegatedListener");return this._delegatedListeners&&this._delegatedListeners[e]&&r(this._delegatedListeners),this}queryRenderedFeatures(e,t){if(!this.style)return[];let n,r=e instanceof Uh.default||Array.isArray(e),a=r?e:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(r?{}:e)||{},a instanceof Uh.default||typeof a[0]=="number")n=[Uh.default.convert(a)];else{let o=Uh.default.convert(a[0]),s=Uh.default.convert(a[1]);n=[o,new Uh.default(s.x,o.y),s,new Uh.default(o.x,s.y),o]}return this.style.queryRenderedFeatures(n,t,this.transform)}querySourceFeatures(e,t){return this.style.querySourceFeatures(e,t)}setStyle(e,t){return t=ti({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t),t.diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&e?(this._diffStyle(e,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(e,t))}setTransformRequest(e){return this._requestManager.setTransformRequest(e),this}_getUIString(e){let t=this._locale[e];if(t==null)throw new Error("Missing UI string '".concat(e,"'"));return t}_updateStyle(e,t){if(t.transformStyle&&this.style&&!this.style._loaded){this.style.once("style.load",()=>this._updateStyle(e,t));return}let n=this.style&&t.transformStyle?this.style.serialize():void 0;if(this.style&&(this.style.setEventedParent(null),this.style._remove(!e)),e)this.style=new mR(this,t||{});else return delete this.style,this;return this.style.setEventedParent(this,{style:this.style}),typeof e=="string"?this.style.loadURL(e,t,n):this.style.loadJSON(e,t,n),this}_lazyInitEmptyStyle(){this.style||(this.style=new mR(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(e,t){if(typeof e=="string"){let n=e,r=this._requestManager.transformRequest(n,"Style");Qw(r,new AbortController).then(a=>{this._updateDiff(a.data,t)}).catch(a=>{a&&this.fire(new ki(a))})}else typeof e=="object"&&this._updateDiff(e,t)}_updateDiff(e,t){try{this.style.setState(e,t)&&this._update(!0)}catch(n){lo("Unable to perform style diff: ".concat(n.message||n.error||n,".  Rebuilding the style from scratch.")),this._updateStyle(e,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():lo("There is no style added to the map.")}addSource(e,t){return this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)}isSourceLoaded(e){let t=this.style&&this.style.sourceCaches[e];if(t===void 0){this.fire(new ki(new Error("There is no source with ID '".concat(e,"'"))));return}return t.loaded()}setTerrain(e){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),!e)this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;else{let t=this.style.sourceCaches[e.source];if(!t)throw new Error("cannot load terrain, because there exists no source with ID: ".concat(e.source));this.terrain===null&&t.reload();for(let n in this.style._layers){let r=this.style._layers[n];r.type==="hillshade"&&r.source===e.source&&lo("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Xbe(this.painter,t,e),this.painter.renderToTexture=new Ybe(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=n=>{n.dataType==="style"?this.terrain.sourceCache.freeRtt():n.dataType==="source"&&n.tile&&(n.sourceId===e.source&&!this._elevationFreeze&&(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(n.tile.tileID))},this.style.on("data",this._terrainDataCallback)}return this.fire(new Tt("terrain",{terrain:e})),this}getTerrain(){var e,t;return(t=(e=this.terrain)==null?void 0:e.options)!=null?t:null}areTilesLoaded(){let e=this.style&&this.style.sourceCaches;for(let t in e){let n=e[t]._tiles;for(let r in n){let a=n[r];if(!(a.state==="loaded"||a.state==="errored"))return!1}}return!0}removeSource(e){return this.style.removeSource(e),this._update(!0)}getSource(e){return this.style.getSource(e)}addImage(e,t,n={}){let{pixelRatio:r=1,sdf:a=!1,stretchX:o,stretchY:s,content:u}=n;this._lazyInitEmptyStyle();let h=0;if(t instanceof HTMLImageElement||eu(t)){let{width:d,height:f,data:m}=Mn.getImageData(t);this.style.addImage(e,{data:new Or({width:d,height:f},m),pixelRatio:r,stretchX:o,stretchY:s,content:u,sdf:a,version:h})}else{if(t.width===void 0||t.height===void 0)return this.fire(new ki(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{let{width:d,height:f,data:m}=t,v=t;return this.style.addImage(e,{data:new Or({width:d,height:f},new Uint8Array(m)),pixelRatio:r,stretchX:o,stretchY:s,content:u,sdf:a,version:h,userImage:v}),v.onAdd&&v.onAdd(this,e),this}}}updateImage(e,t){let n=this.style.getImage(e);if(!n)return this.fire(new ki(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));let r=t instanceof HTMLImageElement||eu(t)?Mn.getImageData(t):t,{width:a,height:o,data:s}=r;if(a===void 0||o===void 0)return this.fire(new ki(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(a!==n.data.width||o!==n.data.height)return this.fire(new ki(new Error("The width and height of the updated image must be that same as the previous version of the image")));let u=!(t instanceof HTMLImageElement||eu(t));return n.data.replace(s,u),this.style.updateImage(e,n),this}getImage(e){return this.style.getImage(e)}hasImage(e){return e?!!this.style.getImage(e):(this.fire(new ki(new Error("Missing required image id"))),!1)}removeImage(e){this.style.removeImage(e)}loadImage(e){return tu.getImage(this._requestManager.transformRequest(e,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(e,t){return this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)}moveLayer(e,t){return this.style.moveLayer(e,t),this._update(!0)}removeLayer(e){return this.style.removeLayer(e),this._update(!0)}getLayer(e){return this.style.getLayer(e)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(e,t,n){return this.style.setLayerZoomRange(e,t,n),this._update(!0)}setFilter(e,t,n={}){return this.style.setFilter(e,t,n),this._update(!0)}getFilter(e){return this.style.getFilter(e)}setPaintProperty(e,t,n,r={}){return this.style.setPaintProperty(e,t,n,r),this._update(!0)}getPaintProperty(e,t){return this.style.getPaintProperty(e,t)}setLayoutProperty(e,t,n,r={}){return this.style.setLayoutProperty(e,t,n,r),this._update(!0)}getLayoutProperty(e,t){return this.style.getLayoutProperty(e,t)}setGlyphs(e,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(e,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(e,t,n={}){return this._lazyInitEmptyStyle(),this.style.addSprite(e,t,n,r=>{r||this._update(!0)}),this}removeSprite(e){return this._lazyInitEmptyStyle(),this.style.removeSprite(e),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(e,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(e,t,n=>{n||this._update(!0)}),this}setLight(e,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(e,t),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(e,t){return this.style.setFeatureState(e,t),this._update()}removeFeatureState(e,t){return this.style.removeFeatureState(e,t),this._update()}getFeatureState(e){return this.style.getFeatureState(e)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let e=0,t=0;return this._container&&(e=this._container.clientWidth||400,t=this._container.clientHeight||300),[e,t]}_setupContainer(){let e=this._container;e.classList.add("maplibregl-map");let t=this._canvasContainer=wt.create("div","maplibregl-canvas-container",e);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=wt.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");let n=this._containerDimensions(),r=this._getClampedPixelRatio(n[0],n[1]);this._resizeCanvas(n[0],n[1],r);let a=this._controlContainer=wt.create("div","maplibregl-control-container",e),o=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(s=>{o[s]=wt.create("div","maplibregl-ctrl-".concat(s," "),a)})}_resizeCanvas(e,t,n){this._canvas.width=Math.floor(n*e),this._canvas.height=Math.floor(n*t),this._canvas.style.width="".concat(e,"px"),this._canvas.style.height="".concat(t,"px")}_setupPainter(){let e={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1},t=null;this._canvas.addEventListener("webglcontextcreationerror",r=>{t={requestedAttributes:e},r&&(t.statusMessage=r.statusMessage,t.type=r.type)},{once:!0});let n=this._canvas.getContext("webgl2",e)||this._canvas.getContext("webgl",e);if(!n){let r="Failed to initialize WebGL";throw t?(t.message=r,new Error(JSON.stringify(t))):new Error(r)}this.painter=new Wxe(n,this.transform),s5.testSupport(n)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(e){return!this.style||!this.style._loaded?this:(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this)}_requestRenderFrame(e){return this._update(),this._renderTaskQueue.add(e)}_cancelRenderFrame(e){this._renderTaskQueue.remove(e)}_render(e){let t=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),this._removed)return;let n=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;let a=this.transform.zoom,o=Mn.now();this.style.zoomHistory.update(a,o);let s=new fa(a,{now:o,fadeDuration:t,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),u=s.crossFadingFactor();(u!==1||u!==this._crossFadingFactor)&&(n=!0,this._crossFadingFactor=u),this.style.update(s)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain&&(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,t,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:t,showPadding:this.showPadding}),this.fire(new Tt("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,_y.mark("load"),this.fire(new Tt("load"))),this.style&&(this.style.hasTransitions()||n)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();let r=this._sourcesDirty||this._styleDirty||this._placementDirty;return r||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new Tt("idle")),this._loaded&&!this._fullyLoaded&&!r&&(this._fullyLoaded=!0,_y.mark("fullLoad")),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var e;this._hash&&this._hash.remove();for(let n of this._controls)n.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),tu.removeThrottleControl(this._imageQueueHandle),(e=this._resizeObserver)==null||e.disconnect();let t=this.painter.context.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),wt.remove(this._canvasContainer),wt.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),_y.clearMetrics(),this._removed=!0,this.fire(new Tt("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,Mn.frameAsync(this._frameRequest).then(e=>{_y.frame(e),this._frameRequest=null,this._render(e)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())}get showPadding(){return!!this._showPadding}set showPadding(e){this._showPadding!==e&&(this._showPadding=e,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())}get repaint(){return!!this._repaint}set repaint(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(e){this._vertices=e,this._update()}get version(){return Kbe}getCameraTargetElevation(){return this.transform.elevation}};l(rQ,"Map");var Lke=rQ;R();R();var aQ=l(i=>{i.touchstart=i.dragStart,i.touchmoveWindow=i.dragMove,i.touchend=i.dragEnd},"assignEvents"),e2e=l(({enable:i,clickTolerance:e,bearingDegreesPerPixelMoved:t=.8})=>{let n=new CK;return new d0({clickTolerance:e,move:l((r,a)=>({bearingDelta:(a.x-r.x)*t}),"move"),moveStateManager:n,enable:i,assignEvents:aQ})},"generateOneFingerTouchRotationHandler"),t2e=l(({enable:i,clickTolerance:e,pitchDegreesPerPixelMoved:t=-.5})=>{let n=new CK;return new d0({clickTolerance:e,move:l((r,a)=>({pitchDelta:(a.y-r.y)*t}),"move"),moveStateManager:n,enable:i,assignEvents:aQ})},"generateOneFingerTouchPitchHandler"),i2e={showCompass:!0,showZoom:!0,visualizePitch:!1},oQ=class{constructor(e){this._updateZoomButtons=l(()=>{let t=this._map.getZoom(),n=t===this._map.getMaxZoom(),r=t===this._map.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=r,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",r.toString())},"_updateZoomButtons"),this._rotateCompassArrow=l(()=>{let t=this.options.visualizePitch?"scale(".concat(1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5),") rotateX(").concat(this._map.transform.pitch,"deg) rotateZ(").concat(this._map.transform.angle*(180/Math.PI),"deg)"):"rotate(".concat(this._map.transform.angle*(180/Math.PI),"deg)");this._compassIcon.style.transform=t},"_rotateCompassArrow"),this._setButtonTitle=l((t,n)=>{let r=this._map._getUIString("NavigationControl.".concat(n));t.title=r,t.setAttribute("aria-label",r)},"_setButtonTitle"),this.options=ti({},i2e,e),this._container=wt.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),wt.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),wt.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=wt.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new n2e(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){wt.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(e,t){let n=wt.create("button",e,this._container);return n.type="button",n.addEventListener("click",t),n}};l(oQ,"NavigationControl");var kke=oQ,sQ=class{constructor(e,t,n=!1){this.mousedown=l(o=>{this.startMouse(ti({},o,{ctrlKey:!0,preventDefault:l(()=>o.preventDefault(),"preventDefault")}),wt.mousePos(this.element,o)),wt.addEventListener(window,"mousemove",this.mousemove),wt.addEventListener(window,"mouseup",this.mouseup)},"mousedown"),this.mousemove=l(o=>{this.moveMouse(o,wt.mousePos(this.element,o))},"mousemove"),this.mouseup=l(o=>{this.mouseRotate.dragEnd(o),this.mousePitch&&this.mousePitch.dragEnd(o),this.offTemp()},"mouseup"),this.touchstart=l(o=>{o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=wt.touchPos(this.element,o.targetTouches)[0],this.startTouch(o,this._startPos),wt.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),wt.addEventListener(window,"touchend",this.touchend))},"touchstart"),this.touchmove=l(o=>{o.targetTouches.length!==1?this.reset():(this._lastPos=wt.touchPos(this.element,o.targetTouches)[0],this.moveTouch(o,this._lastPos))},"touchmove"),this.touchend=l(o=>{o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},"touchend"),this.reset=l(()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},"reset"),this._clickTolerance=10;let r=e.dragRotate._mouseRotate.getClickTolerance(),a=e.dragRotate._mousePitch.getClickTolerance();this.element=t,this.mouseRotate=IK({clickTolerance:r,enable:!0}),this.touchRotate=e2e({clickTolerance:r,enable:!0}),this.map=e,n&&(this.mousePitch=TK({clickTolerance:a,enable:!0}),this.touchPitch=t2e({clickTolerance:a,enable:!0})),wt.addEventListener(t,"mousedown",this.mousedown),wt.addEventListener(t,"touchstart",this.touchstart,{passive:!1}),wt.addEventListener(t,"touchcancel",this.reset)}startMouse(e,t){this.mouseRotate.dragStart(e,t),this.mousePitch&&this.mousePitch.dragStart(e,t),wt.disableDrag()}startTouch(e,t){this.touchRotate.dragStart(e,t),this.touchPitch&&this.touchPitch.dragStart(e,t),wt.disableDrag()}moveMouse(e,t){let n=this.map,{bearingDelta:r}=this.mouseRotate.dragMove(e,t)||{};if(r&&n.setBearing(n.getBearing()+r),this.mousePitch){let{pitchDelta:a}=this.mousePitch.dragMove(e,t)||{};a&&n.setPitch(n.getPitch()+a)}}moveTouch(e,t){let n=this.map,{bearingDelta:r}=this.touchRotate.dragMove(e,t)||{};if(r&&n.setBearing(n.getBearing()+r),this.touchPitch){let{pitchDelta:a}=this.touchPitch.dragMove(e,t)||{};a&&n.setPitch(n.getPitch()+a)}}off(){let e=this.element;wt.removeEventListener(e,"mousedown",this.mousedown),wt.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),wt.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),wt.removeEventListener(window,"touchend",this.touchend),wt.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){wt.enableDrag(),wt.removeEventListener(window,"mousemove",this.mousemove),wt.removeEventListener(window,"mouseup",this.mouseup),wt.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),wt.removeEventListener(window,"touchend",this.touchend)}};l(sQ,"MouseRotateWrapper");var n2e=sQ;R();R();var pp;async function lQ(i=!1){if(pp!==void 0&&!i)return pp;if(window.navigator.permissions===void 0)return pp=!!window.navigator.geolocation,pp;try{pp=(await window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{pp=!!window.navigator.geolocation}return pp}l(lQ,"checkGeolocationSupport");R();var S_=ii(Rn(),1);R();function kL(i,e,t){let n=new on(i.lng,i.lat);if(i=new on(i.lng,i.lat),e){let r=new on(i.lng-360,i.lat),a=new on(i.lng+360,i.lat),o=t.locationPoint(i).distSqr(e);t.locationPoint(r).distSqr(e)<o?i=r:t.locationPoint(a).distSqr(e)<o&&(i=a)}for(;Math.abs(i.lng-t.center.lng)>180;){let r=t.locationPoint(i);if(r.x>=0&&r.y>=0&&r.x<=t.width&&r.y<=t.height)break;i.lng>t.center.lng?i.lng-=360:i.lng+=360}return i.lng!==n.lng&&t.locationPoint(i).y>t.height/2-t.getHorizon()?i:n}l(kL,"smartWrap");R();var RL={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function OL(i,e,t){let n=i.classList;for(let r in RL)n.remove("maplibregl-".concat(t,"-anchor-").concat(r));n.add("maplibregl-".concat(t,"-anchor-").concat(e))}l(OL,"applyAnchorClass");var uQ=class extends uo{constructor(e){if(super(),this._onKeyPress=l(t=>{let n=t.code,r=t.charCode||t.keyCode;(n==="Space"||n==="Enter"||r===32||r===13)&&this.togglePopup()},"_onKeyPress"),this._onMapClick=l(t=>{let n=t.originalEvent.target,r=this._element;this._popup&&(n===r||r.contains(n))&&this.togglePopup()},"_onMapClick"),this._update=l(t=>{var n;if(!this._map)return;let r=this._map.loaded()&&!this._map.isMoving();(t?.type==="terrain"||t?.type==="render"&&!r)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies?this._lngLat=kL(this._lngLat,this._flatPos,this._map.transform):this._lngLat=(n=this._lngLat)==null?void 0:n.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let a="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?a="rotateZ(".concat(this._rotation,"deg)"):this._rotationAlignment==="map"&&(a="rotateZ(".concat(this._rotation-this._map.getBearing(),"deg)"));let o="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?o="rotateX(0deg)":this._pitchAlignment==="map"&&(o="rotateX(".concat(this._map.getPitch(),"deg)")),(!t||t.type==="moveend")&&(this._pos=this._pos.round()),wt.setTransform(this._element,"".concat(RL[this._anchor]," translate(").concat(this._pos.x,"px, ").concat(this._pos.y,"px) ").concat(o," ").concat(a)),Mn.frameAsync(new AbortController).then(()=>{this._updateOpacity(t&&t.type==="moveend")}).catch(()=>{})},"_update"),this._onMove=l(t=>{if(!this._isDragging){let n=this._clickTolerance||this._map._clickTolerance;this._isDragging=t.point.dist(this._pointerdownPos)>=n}this._isDragging&&(this._pos=t.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new Tt("dragstart"))),this.fire(new Tt("drag")))},"_onMove"),this._onUp=l(()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new Tt("dragend")),this._state="inactive"},"_onUp"),this._addDragHandler=l(t=>{this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._pointerdownPos=t.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},"_addDragHandler"),this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(e?.opacity,e?.opacityWhenCovered),!e||!e.element){this._defaultMarker=!0,this._element=wt.create("div"),this._element.setAttribute("aria-label","Map marker");let t=wt.createNS("http://www.w3.org/2000/svg","svg"),n=41,r=27;t.setAttributeNS(null,"display","block"),t.setAttributeNS(null,"height","".concat(n,"px")),t.setAttributeNS(null,"width","".concat(r,"px")),t.setAttributeNS(null,"viewBox","0 0 ".concat(r," ").concat(n));let a=wt.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"stroke","none"),a.setAttributeNS(null,"stroke-width","1"),a.setAttributeNS(null,"fill","none"),a.setAttributeNS(null,"fill-rule","evenodd");let o=wt.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"fill-rule","nonzero");let s=wt.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"transform","translate(3.0, 29.0)"),s.setAttributeNS(null,"fill","#000000");let u=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(let E of u){let I=wt.createNS("http://www.w3.org/2000/svg","ellipse");I.setAttributeNS(null,"opacity","0.04"),I.setAttributeNS(null,"cx","10.5"),I.setAttributeNS(null,"cy","5.80029008"),I.setAttributeNS(null,"rx",E.rx),I.setAttributeNS(null,"ry",E.ry),s.appendChild(I)}let h=wt.createNS("http://www.w3.org/2000/svg","g");h.setAttributeNS(null,"fill",this._color);let d=wt.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),h.appendChild(d);let f=wt.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"opacity","0.25"),f.setAttributeNS(null,"fill","#000000");let m=wt.createNS("http://www.w3.org/2000/svg","path");m.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),f.appendChild(m);let v=wt.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"transform","translate(6.0, 7.0)"),v.setAttributeNS(null,"fill","#FFFFFF");let b=wt.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"transform","translate(8.0, 8.0)");let w=wt.createNS("http://www.w3.org/2000/svg","circle");w.setAttributeNS(null,"fill","#000000"),w.setAttributeNS(null,"opacity","0.25"),w.setAttributeNS(null,"cx","5.5"),w.setAttributeNS(null,"cy","5.5"),w.setAttributeNS(null,"r","5.4999962");let A=wt.createNS("http://www.w3.org/2000/svg","circle");A.setAttributeNS(null,"fill","#FFFFFF"),A.setAttributeNS(null,"cx","5.5"),A.setAttributeNS(null,"cy","5.5"),A.setAttributeNS(null,"r","5.4999962"),b.appendChild(w),b.appendChild(A),o.appendChild(s),o.appendChild(h),o.appendChild(f),o.appendChild(v),o.appendChild(b),t.appendChild(o),t.setAttributeNS(null,"height","".concat(n*this._scale,"px")),t.setAttributeNS(null,"width","".concat(r*this._scale,"px")),this._element.appendChild(t),this._offset=S_.default.convert(e&&e.offset||[0,-14])}else this._element=e.element,this._offset=S_.default.convert(e&&e.offset||[0,0]);if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",t=>{t.preventDefault()}),this._element.addEventListener("mousedown",t=>{t.preventDefault()}),OL(this._element,this._anchor,"marker"),e&&e.className)for(let t of e.className.split(" "))this._element.classList.add(t);this._popup=null}addTo(e){return this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),wt.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=on.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){let t=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[t,(38.1-13.5+t)*-1],"bottom-right":[-t,(38.1-13.5+t)*-1],left:[13.5,(38.1-13.5)*-1],right:[-13.5,(38.1-13.5)*-1]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){let e=this._popup;if(this._element.style.opacity===this._opacityWhenCovered)return this;if(e)e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map));else return this;return this}_updateOpacity(e=!1){var t,n;if(!((t=this._map)!=null&&t.terrain)){this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity);return}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}let r=this._map,a=r.terrain.depthAtPoint(this._pos),o=r.terrain.getElevationForLngLatZoom(this._lngLat,r.transform.tileZoom),s=r.transform.lngLatToCameraDepth(this._lngLat,o),u=.006;if(s-a<u){this._element.style.opacity=this._opacity;return}let h=-this._offset.y/r.transform._pixelPerMeter,d=Math.sin(r.getPitch()*Math.PI/180)*h,f=r.terrain.depthAtPoint(new S_.default(this._pos.x,this._pos.y-this._offset.y)),m=r.transform.lngLatToCameraDepth(this._lngLat,o+d)-f>u;(n=this._popup)!=null&&n.isOpen()&&m&&this._popup.remove(),this._element.style.opacity=m?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=S_.default.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,t){return e===void 0&&t===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),t!==void 0&&(this._opacityWhenCovered=t),this._map&&this._updateOpacity(!0),this}};l(uQ,"Marker");var xR=uQ,r2e={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},M_=0,xy=!1,hQ=class extends uo{constructor(e){super(),this._onSuccess=l(t=>{if(this._map){if(this._isOutOfMapMaxBounds(t)){this._setErrorState(),this.fire(new Tt("outofmaxbounds",t)),this._updateMarker(),this._finish();return}if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error("Unexpected watchState ".concat(this._watchState))}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),(!this.options.trackUserLocation||this._watchState==="ACTIVE_LOCK")&&this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new Tt("geolocate",t)),this._finish()}},"_onSuccess"),this._updateCamera=l(t=>{let n=new on(t.coords.longitude,t.coords.latitude),r=t.coords.accuracy,a=this._map.getBearing(),o=ti({bearing:a},this.options.fitBoundsOptions),s=Uc.fromLngLat(n,r);this._map.fitBounds(s,o,{geolocateSource:!0})},"_updateCamera"),this._updateMarker=l(t=>{if(t){let n=new on(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},"_updateMarker"),this._onZoom=l(()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},"_onZoom"),this._onError=l(t=>{if(this._map){if(this.options.trackUserLocation)if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;let n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&xy)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new Tt("error",t)),this._finish()}},"_onError"),this._finish=l(()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},"_finish"),this._setupUI=l(t=>{if(this._map){if(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=wt.create("button","maplibregl-ctrl-geolocate",this._container),wt.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",t===!1){lo("Geolocation support is not available so the GeolocateControl will be disabled.");let n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}else{let n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=wt.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new xR({element:this._dotElement}),this._circleElement=wt.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new xR({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{let r=n.originalEvent&&n.originalEvent.type==="resize";!n.geolocateSource&&this._watchState==="ACTIVE_LOCK"&&!r&&(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new Tt("trackuserlocationend")))})}},"_setupUI"),this.options=ti({},r2e,e)}onAdd(e){return this._map=e,this._container=wt.create("div","maplibregl-ctrl maplibregl-ctrl-group"),lQ().then(t=>this._setupUI(t)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),wt.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,M_=0,xy=!1}_isOutOfMapMaxBounds(e){let t=this._map.getMaxBounds(),n=e.coords;return t&&(n.longitude<t.getWest()||n.longitude>t.getEast()||n.latitude<t.getSouth()||n.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error("Unexpected watchState ".concat(this._watchState))}}_updateCircleRadius(){let e=this._map.getBounds(),t=e.getSouthEast(),n=e.getNorthEast(),r=t.distanceTo(n),a=this._map._container.clientHeight,o=Math.ceil(2*(this._accuracy/(r/a)));this._circleElement.style.width="".concat(o,"px"),this._circleElement.style.height="".concat(o,"px")}trigger(){if(!this._setup)return lo("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new Tt("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":M_--,xy=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new Tt("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new Tt("trackuserlocationstart"));break;default:throw new Error("Unexpected watchState ".concat(this._watchState))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error("Unexpected watchState ".concat(this._watchState))}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),M_++;let e;M_>1?(e={maximumAge:6e5,timeout:0},xy=!0):(e=this.options.positionOptions,xy=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}};l(hQ,"GeolocateControl");var Fke=hQ;R();var a2e={maxWidth:100,unit:"metric"},cQ=class{constructor(e){this._onMove=l(()=>{mE(this._map,this._container,this.options)},"_onMove"),this.setUnit=l(t=>{this.options.unit=t,mE(this._map,this._container,this.options)},"setUnit"),this.options=Me(Me({},a2e),e)}getDefaultPosition(){return"bottom-left"}onAdd(e){return this._map=e,this._container=wt.create("div","maplibregl-ctrl maplibregl-ctrl-scale",e.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){wt.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}};l(cQ,"ScaleControl");var zke=cQ;function mE(i,e,t){let n=t&&t.maxWidth||100,r=i._container.clientHeight/2,a=i.unproject([0,r]),o=i.unproject([n,r]),s=a.distanceTo(o);if(t&&t.unit==="imperial"){let u=3.2808*s;if(u>5280){let h=u/5280;Af(e,n,h,i._getUIString("ScaleControl.Miles"))}else Af(e,n,u,i._getUIString("ScaleControl.Feet"))}else if(t&&t.unit==="nautical"){let u=s/1852;Af(e,n,u,i._getUIString("ScaleControl.NauticalMiles"))}else s>=1e3?Af(e,n,s/1e3,i._getUIString("ScaleControl.Kilometers")):Af(e,n,s,i._getUIString("ScaleControl.Meters"))}l(mE,"updateScale");function Af(i,e,t,n){let r=dQ(t),a=r/t;i.style.width="".concat(e*a,"px"),i.innerHTML="".concat(r,"&nbsp;").concat(n)}l(Af,"setScale");function pQ(i){let e=Math.pow(10,Math.ceil(-Math.log(i)/Math.LN10));return Math.round(i*e)/e}l(pQ,"getDecimalRoundNum");function dQ(i){let e=Math.pow(10,"".concat(Math.floor(i)).length-1),t=i/e;return t=t>=10?10:t>=5?5:t>=3?3:t>=2?2:t>=1?1:pQ(t),e*t}l(dQ,"getRoundNum");R();var fQ=class extends uo{constructor(e={}){super(),this._onFullscreenChange=l(()=>{var t;let n=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;(t=n?.shadowRoot)!=null&&t.fullscreenElement;)n=n.shadowRoot.fullscreenElement;n===this._container!==this._fullscreen&&this._handleFullscreenChange()},"_onFullscreenChange"),this._onClickFullscreen=l(()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},"_onClickFullscreen"),this._fullscreen=!1,e&&e.container&&(e.container instanceof HTMLElement?this._container=e.container:lo("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=wt.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){wt.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){let e=this._fullscreenButton=wt.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);wt.create("span","maplibregl-ctrl-icon",e).setAttribute("aria-hidden","true"),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){let e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.title=e}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new Tt("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new Tt("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}};l(fQ,"FullscreenControl");var Vke=fQ;R();var mQ=class{constructor(e){this._toggleTerrain=l(()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},"_toggleTerrain"),this._updateTerrainIcon=l(()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},"_updateTerrainIcon"),this.options=e}onAdd(e){return this._map=e,this._container=wt.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=wt.create("button","maplibregl-ctrl-terrain",this._container),wt.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){wt.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}};l(mQ,"TerrainControl");var Gke=mQ;R();var qr=ii(Rn(),1),o2e={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},s2e=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),gQ=class extends uo{constructor(e){super(),this.remove=l(()=>(this._content&&wt.remove(this._content),this._container&&(wt.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new Tt("close"))),this),"remove"),this._onMouseUp=l(t=>{this._update(t.point)},"_onMouseUp"),this._onMouseMove=l(t=>{this._update(t.point)},"_onMouseMove"),this._onDrag=l(t=>{this._update(t.point)},"_onDrag"),this._update=l(t=>{var n;let r=this._lngLat||this._trackPointer;if(!this._map||!r||!this._content)return;if(!this._container){if(this._container=wt.create("div","maplibregl-popup",this._map.getContainer()),this._tip=wt.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(let h of this.options.className.split(" "))this._container.classList.add(h);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer?this._lngLat=kL(this._lngLat,this._flatPos,this._map.transform):this._lngLat=(n=this._lngLat)==null?void 0:n.wrap(),this._trackPointer&&!t)return;let a=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationPoint(this._lngLat));let o=this.options.anchor,s=NL(this.options.offset);if(!o){let h=this._container.offsetWidth,d=this._container.offsetHeight,f;a.y+s.bottom.y<d?f=["top"]:a.y>this._map.transform.height-d?f=["bottom"]:f=[],a.x<h/2?f.push("left"):a.x>this._map.transform.width-h/2&&f.push("right"),f.length===0?o="bottom":o=f.join("-")}let u=a.add(s[o]);this.options.subpixelPositioning||(u=u.round()),wt.setTransform(this._container,"".concat(RL[o]," translate(").concat(u.x,"px,").concat(u.y,"px)")),OL(this._container,o,"popup")},"_update"),this._onClose=l(()=>{this.remove()},"_onClose"),this.options=ti(Object.create(o2e),e)}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new Tt("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=on.convert(e),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(document.createTextNode(e))}setHTML(e){let t=document.createDocumentFragment(),n=document.createElement("body"),r;for(n.innerHTML=e;r=n.firstChild,!!r;)t.appendChild(r);return this.setDOMContent(t)}getMaxWidth(){var e;return(e=this._container)==null?void 0:e.style.maxWidth}setMaxWidth(e){return this.options.maxWidth=e,this._update(),this}setDOMContent(e){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=wt.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(e),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(e){this._container&&this._container.classList.add(e)}removeClassName(e){this._container&&this._container.classList.remove(e)}setOffset(e){return this.options.offset=e,this._update(),this}toggleClassName(e){if(this._container)return this._container.classList.toggle(e)}setSubpixelPositioning(e){this.options.subpixelPositioning=e}_createCloseButton(){this.options.closeButton&&(this._closeButton=wt.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;let e=this._container.querySelector(s2e);e&&e.focus()}};l(gQ,"Popup");var Hke=gQ;function NL(i){if(i)if(typeof i=="number"){let e=Math.round(Math.abs(i)/Math.SQRT2);return{center:new qr.default(0,0),top:new qr.default(0,i),"top-left":new qr.default(e,e),"top-right":new qr.default(-e,e),bottom:new qr.default(0,-i),"bottom-left":new qr.default(e,-e),"bottom-right":new qr.default(-e,-e),left:new qr.default(i,0),right:new qr.default(-i,0)}}else if(i instanceof qr.default||Array.isArray(i)){let e=qr.default.convert(i);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}else return{center:qr.default.convert(i.center||[0,0]),top:qr.default.convert(i.top||[0,0]),"top-left":qr.default.convert(i["top-left"]||[0,0]),"top-right":qr.default.convert(i["top-right"]||[0,0]),bottom:qr.default.convert(i.bottom||[0,0]),"bottom-left":qr.default.convert(i["bottom-left"]||[0,0]),"bottom-right":qr.default.convert(i["bottom-right"]||[0,0]),left:qr.default.convert(i.left||[0,0]),right:qr.default.convert(i.right||[0,0])};else return NL(new qr.default(0,0))}l(NL,"normalizeOffset");var Wke=ii(Rn(),1),l2e=XB.version;function u2e(i,e){return _g().setRTLTextPlugin(i,e)}l(u2e,"setRTLTextPlugin");function h2e(){return _g().getRTLTextPluginStatus()}l(h2e,"getRTLTextPluginStatus");function c2e(){return l2e}l(c2e,"getVersion");function p2e(){return EA.workerCount}l(p2e,"getWorkerCount");function d2e(i){EA.workerCount=i}l(d2e,"setWorkerCount");function f2e(){return _s.MAX_PARALLEL_IMAGE_REQUESTS}l(f2e,"getMaxParallelImageRequests");function m2e(i){_s.MAX_PARALLEL_IMAGE_REQUESTS=i}l(m2e,"setMaxParallelImageRequests");function g2e(){return _s.WORKER_URL}l(g2e,"getWorkerUrl");function yQ(i){_s.WORKER_URL=i}l(yQ,"setWorkerUrl");function y2e(i){return cL().broadcast("IS",i)}l(y2e,"importScriptInWorkers");R();function vQ(i,e,t=!1){let n=null,r=0;return function(...a){r++,r===1&&t===!0&&i(...a);let o=l(()=>{(!t||r>1)&&i(...a),n=null,r=0},"later");clearTimeout(n),n=setTimeout(o,e)}}l(vQ,"debounce");R();R();var FL="[MappedinJS]",_Q=(i=>(i[i.LOG=0]="LOG",i[i.WARN=1]="WARN",i[i.ERROR=2]="ERROR",i[i.SILENT=3]="SILENT",i))(_Q||{});function xQ(i="",{prefix:e=FL}={}){let t="".concat(e).concat(i?"-".concat(i):""),n=l((r,a)=>{if(typeof window<"u"&&window.rnDebug){let o=a.map(s=>s instanceof Error&&s.stack?"".concat(s.message,`
`).concat(s.stack):s);window.rnDebug("".concat(i," ").concat(r,": ").concat(o.join(" ")))}},"rnDebug");return{logState:mr.env.NODE_ENV==="test"?3:0,log(...r){this.logState<=0&&(console.log(t,...r),n("log",r))},warn(...r){this.logState<=1&&(console.warn(t,...r),n("warn",r))},error(...r){this.logState<=2&&(console.error(t,...r),n("error",r))},assert(...r){console.assert(...r)},time(r){console.time(r)},timeEnd(r){console.timeEnd(r)},setLevel(r){0<=r&&r<=3&&(this.logState=r)}}}l(xQ,"createLogger");var bQ=xQ();function wQ(i){0<=i&&i<=3&&(bQ.logState=i)}l(wQ,"setLoggerLevel");var nt=bQ;R();function AQ(i,e){return"".concat(e," ").concat(i)}l(AQ,"formatMessage");var SQ=class extends Error{constructor(e,t=FL){super(AQ(e,t)),this.name="MappedinError"}};l(SQ,"MappedinError");var So=SQ,MQ=class extends So{constructor(e,t=FL){super(e,t),this.name="MappedinRenderError"}};l(MQ,"MappedinRenderError");var v2e=MQ;R();R();var CQ=class extends Error{};l(CQ,"InvalidTokenError");var Ky=CQ;Ky.prototype.name="InvalidTokenError";function EQ(i){return decodeURIComponent(atob(i).replace(/(.)/g,(e,t)=>{let n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}l(EQ,"b64DecodeUnicode");function IQ(i){let e=i.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return EQ(e)}catch{return atob(e)}}l(IQ,"base64UrlDecode");function TQ(i,e){if(typeof i!="string")throw new Ky("Invalid token specified: must be a string");e||(e={});let t=e.header===!0?0:1,n=i.split(".")[t];if(typeof n!="string")throw new Ky("Invalid token specified: missing part #".concat(t+1));let r;try{r=IQ(n)}catch(a){throw new Ky("Invalid token specified: invalid base64 for part #".concat(t+1," (").concat(a.message,")"))}try{return JSON.parse(r)}catch(a){throw new Ky("Invalid token specified: invalid json for part #".concat(t+1," (").concat(a.message,")"))}}l(TQ,"jwtDecode");R();var xd=63710088e-1;function BL(i){var e,t;let n=TQ(i);if(n.sub==null)throw new Error("Access token is missing sub claim.");return{sub:n.sub,aud:typeof n.aud=="string"?[n.aud]:(e=n.aud)!=null?e:[],capabilities:(t=n.capabilities)!=null?t:{}}}l(BL,"decodeAccessToken");function Jl(i){return i*(Math.PI/180)}l(Jl,"toRadians");function PQ(i){return i*(180/Math.PI)}l(PQ,"toDegrees");function f0(i,e){let t=Math.pow(10,e);return Math.sign(i)*Math.round(Math.abs(i)*t)/t}l(f0,"round");function gE(i,e){return(i%e+e)%e}l(gE,"euclideanModulo");function zL([i,e],[t,n]){let r=Jl(n-e),a=Jl(t-i),o=Jl(e),s=Jl(n),u=Math.sin(r/2)*Math.sin(r/2)+Math.sin(a/2)*Math.sin(a/2)*Math.cos(o)*Math.cos(s),h=2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u));return xd*h}l(zL,"haversineDistance");function LQ([i,e],[t,n]){let r=Jl(e),a=Jl(i),o=Jl(n),s=Jl(t)-a,u=Math.sin(s)*Math.cos(o),h=Math.cos(r)*Math.sin(o)-Math.sin(r)*Math.cos(o)*Math.cos(s);return PQ((Math.atan2(u,h)+Math.PI*2)%(Math.PI*2))}l(LQ,"getForwardBearing");function UL(i,e){let t=gE(i,Math.PI*2),n=gE(e,Math.PI*2),r=n-t,a=n+(r>Math.PI?-Math.PI*2:r<-Math.PI?Math.PI*2:0);return{start:t,end:a}}l(UL,"shortestTweenRotation");function kc(i){return i instanceof JP?Number.isFinite(i.min.x)&&Number.isFinite(i.min.y)&&Number.isFinite(i.max.x)&&Number.isFinite(i.max.y):Number.isFinite(i.min.x)&&Number.isFinite(i.min.y)&&Number.isFinite(i.max.x)&&Number.isFinite(i.max.y)&&Number.isFinite(i.min.z)&&Number.isFinite(i.max.z)}l(kc,"isFiniteBox");function $l(i,e,t,n){return(i<e||i>t)&&nt.warn(n),Math.min(t,Math.max(e,i))}l($l,"clampWithWarning");function VL(i,e){if(i==null||e==null)return i===e;if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(i[t]!==e[t])return!1;return!0}l(VL,"arraysEqual");function dw(){return typeof window<"u"&&window!==null}l(dw,"isBrowser");R();var DQ=class kQ extends Error{constructor(e){super(e),D(this,"name","AssertionError"),Error.captureStackTrace&&Error.captureStackTrace(this,kQ)}};l(DQ,"AssertionError");var _2e=DQ;function jL(i,e){if(i==null){let t;if(e!=null&&e.customMessage)t=e.customMessage;else{let a=e!=null&&e.valueName?"'".concat(e.valueName,"'"):"value";t="Expected ".concat(a," to be defined, but received ").concat(i)}let n=e?.errorClass||_2e,r=new n(t);throw e?.captureStackTrace!==!1&&Error.captureStackTrace&&Error.captureStackTrace(r,jL),r}}l(jL,"assertExists");function bd(i,e,t){if(jL(i),i?.type!==e){let n="Expected type ".concat(e," but got ").concat(i?.type);throw new Error(t??n)}}l(bd,"assertType");R();var uM=[0,4,6,8,10],Hn=l(()=>{let i=new Array(16).fill(0),e=Math.random()*4294967296;for(let n=0;n<i.length;n++)n>0&&(n&3)===0&&(e=Math.random()*4294967296),i[n]=e>>>((n&3)<<3)&255;let t=i.map(n=>n.toString(16).padStart(2,"0"));return t[6]="4"+t[6][1],t[8]=["8","9","a","b"].includes(t[7][0])?t[7]:"a"+t[7][1],uM.map((n,r)=>t.slice(n,r===uM.length-1?void 0:uM[r+1]).join("")).join("-")},"randomId");R();var RQ=class{constructor(){D(this,"_subscribers",{})}publish(e,t){!this._subscribers||!this._subscribers[e]||this._subscribers[e].forEach(function(n){typeof n=="function"&&n(t)})}on(e,t){this._subscribers||(this._subscribers={}),this._subscribers[e]=this._subscribers[e]||[],this._subscribers[e].push(t)}off(e,t){if(!this._subscribers||this._subscribers[e]==null)return;let n=this._subscribers[e].indexOf(t);n!==-1&&this._subscribers[e].splice(n,1)}destroy(){this._subscribers={}}};l(RQ,"PubSub");var xr=RQ;R();var bR="mi-session-data",wR="mi-local-data",C_="id",E_="deviceId",Am,Il,Tl,yE=class OQ{constructor(){ge(this,Il),ge(this,Tl);try{let e=sessionStorage.getItem(bR);e?Ce(this,Il,JSON.parse(e)):Ce(this,Il,{[C_]:Hn()})}catch{Ce(this,Il,{[C_]:Hn()})}try{let e=localStorage.getItem(wR);e?Ce(this,Tl,JSON.parse(e)):Ce(this,Tl,{[E_]:Hn()})}catch{Ce(this,Tl,{[E_]:Hn()})}y(this,Il)[C_]||(y(this,Il)[C_]=Hn()),y(this,Tl)[E_]||(y(this,Tl)[E_]=Hn())}static getInstance(){return y(this,Am)||Ce(this,Am,new OQ),y(this,Am)}static ___clearInstance(){Ce(this,Am,void 0)}saveSessionData(e,t){y(this,Il)[e]=t;try{return sessionStorage.setItem(bR,JSON.stringify(y(this,Il))),!0}catch{return!1}}loadSessionData(e){let t=y(this,Il)[e];if(t!=null)return t}saveLocalData(e,t){y(this,Tl)[e]=t;try{return localStorage.setItem(wR,JSON.stringify(y(this,Tl))),!0}catch{return!1}}loadLocalData(e){let t=y(this,Tl)[e];if(t!=null)return t}};Am=new WeakMap,Il=new WeakMap,Tl=new WeakMap,l(yE,"SafeStorage"),ge(yE,Am);var xg=yE;R();var x2e=new Set(Object.keys(Mi.NAMES)),hM;function GL(){return hM==null&&(hM=new Mi),hM}l(GL,"getColorInstance");var b2e=l(i=>x2e.has(i.toLowerCase()),"isX11Color"),w2e=l(i=>{if(!i.startsWith("#"))return!1;let e=i.slice(1);if(e.length!==3&&e.length!==6)return!1;for(let t=0;t<e.length;t++)if(!(e[t]>="0"&&e[t]<="9"||e[t]>="A"&&e[t]<="F"||e[t]>="a"&&e[t]<="f"))return!1;return!0},"isHexColor"),A2e=l(i=>{if(!i.startsWith("rgb(")&&!i.startsWith("rgba("))return!1;let e=i.indexOf("("),t=i.lastIndexOf(")");if(e===-1||t===-1||t<=e||t!==i.length-1)return!1;let n=i.slice(e+1,t).split(",");if(n.length!==3&&n.length!==4)return!1;for(let r=0;r<n.length;r++){let a=n[r].trim();if(r<3)if(a.endsWith("%")){let o=parseFloat(a.slice(0,-1));if(isNaN(o)||o<0||o>100)return!1}else{let o=parseInt(a,10);if(isNaN(o)||o<0||o>255)return!1}else{let o=parseFloat(a);if(isNaN(o)||o<0||o>1)return!1}}return!0},"isRgbColor"),S2e=l(i=>{if(!i.startsWith("hsl(")&&!i.startsWith("hsla("))return!1;let e=i.indexOf("("),t=i.lastIndexOf(")");if(e===-1||t===-1||t<=e||t!==i.length-1)return!1;let n=i.slice(e+1,t).split(",");if(n.length!==3&&n.length!==4)return!1;for(let r=0;r<n.length;r++){let a=n[r].trim();if(r===0){let o=parseFloat(a);if(isNaN(o))return!1}else if(r<3){if(!a.endsWith("%"))return!1;let o=parseFloat(a.slice(0,-1));if(isNaN(o)||o<0||o>100)return!1}else{let o=parseFloat(a);if(isNaN(o)||o<0||o>1)return!1}}return!0},"isHslColor"),Xm=l(i=>i==null||typeof i!="string"?!1:!!(w2e(i)||A2e(i)||S2e(i)||b2e(i)),"isColor"),AR=l(i=>{let e=GL();return e.set(i),[e.r,e.g,e.b]},"stringToRgbArray"),M2e=l(i=>{let e=GL();return e.set(i[0],i[1],i[2]),"#"+e.getHexString()},"rgbArrayToString");R();var $L=l(i=>i,"linearEase"),C2e=l(i=>i*i,"quadEaseIn"),NQ=l(i=>1-Math.cos(i*Math.PI/2),"easeIn"),E2e=l(i=>1-(1-i)*(1-i),"quadEaseOut"),FQ={linear:$L,"ease-in":C2e,"ease-out":E2e,"ease-in-out":NQ};function bg(i,e,t,n,r,a=$L){if(e===t)return r;i=Math.max(e,Math.min(i,t));let o=(i-Math.min(e,t))/Math.abs(t-e),s=typeof a=="function"?a(o):FQ[a](o);return n+s*(r-n)}l(bg,"interpolate");function BQ(i,e,t,n="ease-in"){if(e.length!==t.length)throw new So("Input and output ranges must have the same number of values.");i=Math.max(e[0],Math.min(i,e[e.length-1]));let r=0;for(;r<e.length-1&&i>e[r+1];)r++;let a=(i-e[r])/(e[r+1]-e[r]),o=typeof n=="function"?n(a):FQ[n](a);return t[r]+o*(t[r+1]-t[r])}l(BQ,"interpolateMulti");R();function vE(i){return(i%(2*Math.PI)+2*Math.PI)%(2*Math.PI)}l(vE,"normalizeAngle");R();R();R();R();R();R();R();R();var Oo=63710088e-1,zQ={centimeters:Oo*100,centimetres:Oo*100,degrees:Oo/111325,feet:Oo*3.28084,inches:Oo*39.37,kilometers:Oo/1e3,kilometres:Oo/1e3,meters:Oo,metres:Oo,miles:Oo/1609.344,millimeters:Oo*1e3,millimetres:Oo*1e3,nauticalmiles:Oo/1852,radians:1,yards:Oo*1.0936};function xl(i,e,t){t===void 0&&(t={});var n={type:"Feature"};return(t.id===0||t.id)&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.properties=e||{},n.geometry=i,n}l(xl,"feature");function ph(i,e,t){if(t===void 0&&(t={}),!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!_E(i[0])||!_E(i[1]))throw new Error("coordinates must contain numbers");var n={type:"Point",coordinates:i};return xl(n,e,t)}l(ph,"point");function Zm(i,e,t){t===void 0&&(t={});for(var n=0,r=i;n<r.length;n++){var a=r[n];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<a[a.length-1].length;o++)if(a[a.length-1][o]!==a[0][o])throw new Error("First and last Position are not equivalent.")}var s={type:"Polygon",coordinates:i};return xl(s,e,t)}l(Zm,"polygon");function Vc(i,e,t){if(t===void 0&&(t={}),i.length<2)throw new Error("coordinates must be an array of two or more positions");var n={type:"LineString",coordinates:i};return xl(n,e,t)}l(Vc,"lineString");function m1(i,e){e===void 0&&(e={});var t={type:"FeatureCollection"};return e.id&&(t.id=e.id),e.bbox&&(t.bbox=e.bbox),t.features=i,t}l(m1,"featureCollection");function UQ(i,e,t){t===void 0&&(t={});var n={type:"MultiLineString",coordinates:i};return xl(n,e,t)}l(UQ,"multiLineString");function VQ(i,e,t){t===void 0&&(t={});var n={type:"MultiPoint",coordinates:i};return xl(n,e,t)}l(VQ,"multiPoint");function jQ(i,e,t){t===void 0&&(t={});var n={type:"MultiPolygon",coordinates:i};return xl(n,e,t)}l(jQ,"multiPolygon");function GQ(i,e){e===void 0&&(e="kilometers");var t=zQ[e];if(!t)throw new Error(e+" units is invalid");return i*t}l(GQ,"radiansToLength");function $Q(i,e){e===void 0&&(e="kilometers");var t=zQ[e];if(!t)throw new Error(e+" units is invalid");return i/t}l($Q,"lengthToRadians");function fw(i){var e=i%(2*Math.PI);return e*180/Math.PI}l(fw,"radiansToDegrees");function Fs(i){var e=i%360;return e*Math.PI/180}l(Fs,"degreesToRadians");function _E(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}l(_E,"isNumber");function Vg(i,e,t){if(i!==null)for(var n,r,a,o,s,u,h,d=0,f=0,m,v=i.type,b=v==="FeatureCollection",w=v==="Feature",A=b?i.features.length:1,E=0;E<A;E++){h=b?i.features[E].geometry:w?i.geometry:i,m=h?h.type==="GeometryCollection":!1,s=m?h.geometries.length:1;for(var I=0;I<s;I++){var C=0,T=0;if(o=m?h.geometries[I]:h,o!==null){u=o.coordinates;var k=o.type;switch(d=t&&(k==="Polygon"||k==="MultiPolygon")?1:0,k){case null:break;case"Point":if(e(u,f,E,C,T)===!1)return!1;f++,C++;break;case"LineString":case"MultiPoint":for(n=0;n<u.length;n++){if(e(u[n],f,E,C,T)===!1)return!1;f++,k==="MultiPoint"&&C++}k==="LineString"&&C++;break;case"Polygon":case"MultiLineString":for(n=0;n<u.length;n++){for(r=0;r<u[n].length-d;r++){if(e(u[n][r],f,E,C,T)===!1)return!1;f++}k==="MultiLineString"&&C++,k==="Polygon"&&T++}k==="Polygon"&&C++;break;case"MultiPolygon":for(n=0;n<u.length;n++){for(T=0,r=0;r<u[n].length;r++){for(a=0;a<u[n][r].length-d;a++){if(e(u[n][r][a],f,E,C,T)===!1)return!1;f++}T++}C++}break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(Vg(o.geometries[n],e,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}l(Vg,"coordEach");function HQ(i,e,t,n){var r=t;return Vg(i,function(a,o,s,u,h){o===0&&t===void 0?r=a:r=e(r,a,o,s,u,h)},n),r}l(HQ,"coordReduce");function xE(i,e){if(i.type==="Feature")e(i,0);else if(i.type==="FeatureCollection")for(var t=0;t<i.features.length&&e(i.features[t],t)!==!1;t++);}l(xE,"featureEach");function WQ(i,e){var t,n,r,a,o,s,u,h,d,f,m=0,v=i.type==="FeatureCollection",b=i.type==="Feature",w=v?i.features.length:1;for(t=0;t<w;t++){for(s=v?i.features[t].geometry:b?i.geometry:i,h=v?i.features[t].properties:b?i.properties:{},d=v?i.features[t].bbox:b?i.bbox:void 0,f=v?i.features[t].id:b?i.id:void 0,u=s?s.type==="GeometryCollection":!1,o=u?s.geometries.length:1,r=0;r<o;r++){if(a=u?s.geometries[r]:s,a===null){if(e(null,m,h,d,f)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(a,m,h,d,f)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<a.geometries.length;n++)if(e(a.geometries[n],m,h,d,f)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}m++}}l(WQ,"geomEach");function mh(i,e){WQ(i,function(t,n,r,a,o){var s=t===null?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return e(xl(t,r,{bbox:a,id:o}),n,0)===!1?!1:void 0}var u;switch(s){case"MultiPoint":u="Point";break;case"MultiLineString":u="LineString";break;case"MultiPolygon":u="Polygon";break}for(var h=0;h<t.coordinates.length;h++){var d=t.coordinates[h],f={type:u,coordinates:d};if(e(xl(f,r),n,h)===!1)return!1}})}l(mh,"flattenEach");function qQ(i,e){mh(i,function(t,n,r){var a=0;if(t.geometry){var o=t.geometry.type;if(!(o==="Point"||o==="MultiPoint")){var s,u=0,h=0,d=0;if(Vg(t,function(f,m,v,b,w){if(s===void 0||n>u||b>h||w>d){s=f,u=n,h=b,d=w,a=0;return}var A=Vc([s,f],t.properties);if(e(A,n,r,w,a)===!1)return!1;a++,s=f})===!1)return!1}}})}l(qQ,"segmentEach");function XQ(i,e,t){var n=t,r=!1;return qQ(i,function(a,o,s,u,h){r===!1&&t===void 0?n=a:n=e(n,a,o,s,u,h),r=!0}),n}l(XQ,"segmentReduce");function mw(i){var e=[1/0,1/0,-1/0,-1/0];return Vg(i,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}l(mw,"bbox");mw.default=mw;var m0=mw;function ZQ(i){return m0(i)}l(ZQ,"getBoundingBoxFromFeature");R();var bE="#ffffff",I2e=.1,wE=.1,bx,wx,Ax,YQ=class{constructor(e={}){D(this,"initialColor",bE),ge(this,bx,bE),D(this,"initialTopColor"),ge(this,wx),D(this,"topTexture"),D(this,"texture"),ge(this,Ax),D(this,"dirty",!0),D(this,"visible",!0),D(this,"opacity",1),D(this,"width",I2e),D(this,"height",wE),D(this,"initialHeight",wE),D(this,"altitude",0),D(this,"join","round"),D(this,"cap","round"),D(this,"showImage",!0),D(this,"flipImageToFaceCamera",!0),D(this,"url"),D(this,"side","double"),D(this,"renderOrder",0),this.color=e?.color!==void 0?e.color:this.color,this.initialColor=this.color,this.width=e?.width!==void 0?e.width:this.width,this.opacity=e?.opacity!==void 0?e.opacity:this.opacity,this.visible=e?.visible!==void 0?e.visible:this.visible,this.height=e?.height!==void 0?e.height:this.height,this.initialHeight=this.height,this.altitude=e?.altitude!==void 0?e.altitude:this.altitude,this.join=e?.join!==void 0?e.join:this.join,this.cap=e?.cap!==void 0?e.cap:this.cap,this.topColor=e?.topColor,this.initialTopColor=this.topColor,this.texture=e?.texture,this.topTexture=e?.topTexture,this.showImage=e?.showImage!==void 0?e.showImage:this.showImage,this.flipImageToFaceCamera=e?.flipImageToFaceCamera!==void 0?e.flipImageToFaceCamera:this.flipImageToFaceCamera,this.url=e?.url,this.side=e?.side!==void 0?e.side:this.side,this.renderOrder=e?.renderOrder!==void 0?e.renderOrder:this.renderOrder}set color(e){Xm(e)?Ce(this,bx,e):nt.warn('Failed to update color. Invalid color "'.concat(e,'".'))}get color(){return y(this,bx)}set topColor(e){e===void 0||Xm(e)?Ce(this,wx,e):nt.warn('Failed to update top color. Invalid color "'.concat(e,'".'))}get topColor(){return y(this,wx)}set hoverColor(e){Xm(e)?Ce(this,Ax,e):nt.warn('Failed to update hover color. Invalid color "'.concat(e,'".'))}get hoverColor(){return y(this,Ax)}};bx=new WeakMap,wx=new WeakMap,Ax=new WeakMap,l(YQ,"StyleComponent");var Ym=YQ,JQ=class extends UP{constructor(){super(...arguments),D(this,"type","entityBatchedMesh"),D(this,"userData",{entities:{}})}};l(JQ,"EntityBatchedMesh");var HL=JQ,Sx,Sf,KQ=class{constructor(e){D(this,"mesh"),D(this,"imageMesh"),D(this,"textMesh"),D(this,"textEntityId"),D(this,"type","geometry"),D(this,"dirty",!0),D(this,"detached",!1),D(this,"instanceIndex",-1),D(this,"geometry"),D(this,"batchedProps"),D(this,"material"),D(this,"feature"),D(this,"currentHeight",wE),D(this,"color",new Mi),D(this,"topColor",new Mi),D(this,"position",new Ee),D(this,"altitude",0),ge(this,Sx,1),ge(this,Sf),D(this,"texturesVisible",!1),this.feature=e}get visible(){return this.mesh&&this.instanceIndex!==-1?this.mesh.getVisibleAt(this.instanceIndex):!1}set visible(e){this.mesh&&this.instanceIndex!==-1&&this.mesh.setVisibleAt(this.instanceIndex,e)}get renderOrder(){return this.mesh?this.mesh.renderOrder:0}set renderOrder(e){this.mesh&&(this.mesh.renderOrder=e)}setColor(e,t){this.color.set(e),this.topColor.set(t),this.material&&this.material.setColor(this.instanceIndex,this.color,this.topColor)}getColor(){var e;return(e=this.material)==null?void 0:e.getColor(this.instanceIndex)}get opacity(){return y(this,Sx)}set opacity(e){if(this.material&&(this.material.opacity=e,this.material.transparent=e<1,this.material.needsUpdate=!0),this.imageMesh){let t=Array.isArray(this.imageMesh.material)?this.imageMesh.material:[this.imageMesh.material];for(let n of t)n.opacity=e,n.needsUpdate=!0}Ce(this,Sx,e)}get texture(){var e,t;return(t=(e=this.material)==null?void 0:e.texture)==null?void 0:t.image.src}set texture(e){this.material&&(this.material.texture=e)}get textureInstance(){var e;return(e=this.material)==null?void 0:e.texture}set topTexture(e){this.material&&(this.material.topTexture=e)}get topTexture(){var e,t;return(t=(e=this.material)==null?void 0:e.topTexture)==null?void 0:t.image.src}get topTextureInstance(){var e;return(e=this.material)==null?void 0:e.topTexture}set blendTexture(e){this.material&&(this.material.blendTexture=e)}get featureBbox(){return y(this,Sf)?y(this,Sf):(Ce(this,Sf,ZQ(this.feature)),y(this,Sf))}showTextures(){this.material&&(this.material.showTextures(this.instanceIndex),this.texturesVisible=!0)}hideTextures(){this.material&&(this.material.hideTextures(this.instanceIndex),this.texturesVisible=!1)}removeSideTexture(){this.material&&this.material.removeSideTexture(this.instanceIndex)}removeTopTexture(){this.material&&this.material.removeTopTexture(this.instanceIndex)}};Sx=new WeakMap,Sf=new WeakMap,l(KQ,"MeshComponent");var vs=KQ;R();var SR="#ffffff",_p,QQ=class{constructor(e={}){D(this,"color",SR),D(this,"initialColor",SR),D(this,"topColor"),D(this,"initialTopColor"),D(this,"opacity",1),D(this,"height"),ge(this,_p),D(this,"outline",!0),D(this,"texture"),D(this,"topTexture"),D(this,"dirty",!0);var t,n;this.color=(t=e?.color)!=null?t:this.color,this.initialColor=this.color,this.topColor=e?.topColor,this.initialTopColor=this.topColor,this.opacity=(n=e?.opacity)!=null?n:this.opacity,this.height=e?.height,this.shading=e?.shading,this.outline=e?.outline!==void 0?!!e.outline:this.outline}get shading(){return y(this,_p)}set shading(e){var t;if(!e){Ce(this,_p,void 0);return}Ce(this,_p,(t=y(this,_p))!=null?t:{start:0,end:0,intensity:0}),Object.assign(y(this,_p),e)}};_p=new WeakMap,l(QQ,"GeometryGroupStyleComponent");var AE=QQ,eee=class extends vr{constructor(e,t=new AE){super(),D(this,"visible",!0),D(this,"type","geometry-group"),D(this,"components"),D(this,"userData",{entityId:"",entities3D:new Set,opacity:1,dirty:!0,shadingDirty:!0}),this.components=[t],this.userData.entityId=e}setVisible(e){this.visible!==e&&(this.visible=e,this.dispatchEvent({type:"childremoved",child:this}))}getOpacity(){return this.userData.opacity}setOpacity(e){this.userData.opacity=e}removeEntity(){this.dispatchEvent({type:"childremoved",child:this})}getfirstChildEntityId(){let e;for(let t of this.children)if(!t.userData.detached){e=t;break}return e instanceof HL?Object.values(e.userData.entities)[0]:void 0}setAltitude(e){this.position.z!==e&&(this.position.z=e,this.dispatchEvent({type:"childremoved",child:this}))}get altitude(){return this.position.z}};l(eee,"GeometryGroupObject3D");var Io=eee;R();var tee=class extends vr{};l(tee,"Geometry2DObject3D");var g1=tee,iee=class{constructor(e,t,n=0){D(this,"id"),D(this,"verticalOffset"),D(this,"occluderId"),D(this,"object3d",new g1),D(this,"components"),D(this,"disposed",!1),D(this,"worldPosition",new Ee),this.id=e.id||Hn(),this.components=[e],this.verticalOffset=n,this.object3d=new g1,this.object3d.position.set(t.x,t.y,t.z+n),this.object3d.userData.entityId=this.id,this.object3d.userData.type=this.type,this.positionDirty=!0}get type(){return this.components[0].type}get parentObject3D(){return this.object3d.parent}get attachedTo(){return this.object3d.userData.attachedEntityId}get position(){return this.positionDirty&&(this.object3d.matrixAutoUpdate=!0,this.object3d.getWorldPosition(this.worldPosition),this.positionDirty=!1,this.object3d.matrixAutoUpdate=!1),this.worldPosition}get positionDirty(){return this.object3d.userData.worldPositionDirty}set positionDirty(e){this.object3d.userData.worldPositionDirty=e}updatePosition(e){this.object3d.position.copy(e),this.positionDirty=!0}setAltitude(e){this.object3d.position.z=e,this.positionDirty=!0}};l(iee,"Geometry2D");var wg=iee;R();var nee=class extends vr{constructor(){super(...arguments),D(this,"type","geometry"),D(this,"userData",{entityId:"",type:"geometry"})}raycast(e,t){this.userData.type==="model"&&this.children[0]&&e.intersectObject(this.children[0],!0).forEach(n=>{t.push(n)})}};l(nee,"Geometry3DObject3D");var jg=nee,ree=class{constructor(e,t){D(this,"id",Hn()),D(this,"components"),D(this,"entities2D",new Map),this.components=[e,t]}get object3d(){return this.components[0].mesh}get parentObject3D(){var e;return(e=this.components[0].mesh)==null?void 0:e.parent}get type(){return this.components[0].type}attach(e){this.parentObject3D instanceof Io?e.object3d.userData.attachedEntityId=this.id:this.entities2D.set(e.id,e)}detach(e){this.parentObject3D instanceof Io&&(e.object3d.userData.parentEntityId=void 0),this.entities2D.delete(e.id)}removeAllEntities(){for(let e of this.entities2D.values())this.detach(e)}};l(ree,"Geometry3D");var lr=ree,aee=class Mx extends vr{constructor(e){super(),D(this,"childrenIds",new Set),D(this,"children",[]),D(this,"type","group-container"),D(this,"userData",{entityId:"",entities2D:new Set,dirty:!0,occluderDirty:!1,opacity:1,computedOpacity:1,preloadGeometry:!1}),D(this,"components",[]),this.userData.entityId=e}addOccluderFeature(e,t){this.userData.occluderFeature=e,this.userData.occluderId=t,this.userData.occluderDirty=!0}addEntity(e){e instanceof Mx?(this.childrenIds.add(e.userData.entityId),this.add(e)):e instanceof wg?(this.childrenIds.add(e.id),this.add(e.object3d),this.userData.entities2D.add(e.id),e.positionDirty=!0):e instanceof Io?(this.childrenIds.add(e.userData.entityId),this.add(e)):e instanceof lr&&e.object3d&&(this.childrenIds.add(e.id),this.add(e.object3d)),this.dispatchEvent({type:"childadded",child:this})}removeEntity(e){e instanceof Mx?(this.childrenIds.delete(e.userData.entityId),this.remove(e)):e instanceof wg?(this.childrenIds.delete(e.id),this.userData.entities2D.delete(e.id),this.remove(e.object3d)):e instanceof Io?(this.childrenIds.delete(e.userData.entityId),this.remove(e)):e instanceof lr&&e.object3d&&(this.childrenIds.delete(e.id),this.add(e.object3d)),this.dispatchEvent({type:"childremoved",child:this})}setVisible(e){this.visible!==e&&(this.visible=e,this.dispatchEvent({type:"childremoved",child:this}))}setAltitude(e){this.position.z!==e&&(this.position.z=e,this.dispatchEvent({type:"childremoved",child:this}),this.set2DGeometryChildrenPositionDirty())}set2DGeometryChildrenPositionDirty(){this.children.forEach(e=>{e instanceof g1?e.userData.worldPositionDirty=!0:e instanceof Mx&&e.set2DGeometryChildrenPositionDirty()})}get altitude(){return this.position.z}setOpacity(e){this.userData.opacity=e}get opacity(){return this.userData.opacity}};l(aee,"GroupContainerObject3D");var Kn=aee;R();var oee={top:0,bottom:0,left:0,right:0,type:"pixel"},see="mappedin",lee={ALWAYS_ON_TOP:10},MR=250,T2e="collision-worker.csp.js",P2e="maplibre-worker.csp.js";R();function uee(i){let e=i.min,t=i.max,n=new Ee(e.x,e.y,e.z),r=new Ee(t.x,e.y,e.z),a=new Ee(e.x,t.y,e.z),o=new Ee(t.x,t.y,e.z);return[n,r,a,o]}l(uee,"getCornersOfBoundingBox");R();function jp(i,e){let t;return typeof e=="string"||typeof e=="number"?(t=i.geometry2DMap.get(e),t==null&&(t=i.geometry3DMap.get(e))):typeof e?.id=="string"||typeof e?.id=="number"?(t=i.geometry2DMap.get(e.id),t==null&&(t=i.geometry3DMap.get(e.id))):t=e,t}l(jp,"getGeometryByGeometryId");function hee(i,e,t=[],n=new ur,r){(i.getSystems().renderSystem.threeDdirty||i.getSystems().renderSystem.twoDdirty)&&i.renderSync();let a=jp(i.getInternalState(),e);return WL(a,t,n,r),t}l(hee,"getVerticesOfEntity");var I_=new Ee;function WL(i,e=[],t=new ur,n){if(i.visible){if(i.isMesh||i.isLine||i.isPoints){let r=i.geometry;if(r.isBufferGeometry){let a=r.attributes.position;for(let o=0;o<a.count;o++)I_.fromBufferAttribute(a,o),n!==void 0&&(I_.z=n),e.push(I_.clone()),t.expandByPoint(I_)}}for(let r of i.children)WL(r,e,t,n)}}l(WL,"traverse");R();function $v(){return typeof window>"u"?1:Math.min(window.devicePixelRatio,2)}l($v,"getPixelRatio");R();function gw(i,e,t=!1){let n=null,r=0;return function(...a){r++,r===1&&t===!0&&i(...a);let o=l(()=>{(!t||r>1)&&i(...a),n=null,r=0},"later");clearTimeout(n),n=setTimeout(o,e)}}l(gw,"debounce");R();var L2e=(()=>{let i;return{getDeviceType(){if(i)return i;let{userAgent:e,platform:t,maxTouchPoints:n}=window.navigator,r=/(iphone|ipod|ipad)/i.test(e),a=t==="iPad"||t.indexOf("Mac")===0&&n>0&&!window.MSStream,o=/android/i.test(e);return i={isIpad:a,isMobile:o||r||a,isSafari12:/Version\/12.+Safari/.test(e),isFirefox:/Firefox/.test(e),isWindows:/windows/i.test(e)},i},_reset(){i=void 0}}})(),CR=L2e.getDeviceType,cee=(()=>{let i,e,t;function n(){if(e!==void 0)return e;i||(i=document.createElement("canvas"));let a=i.getContext("webgl")||i.getContext("experimental-webgl");if(!a)return e;try{let o=CR().isFirefox?null:a.getExtension("WEBGL_debug_renderer_info");return e=o?a.getParameter(o.UNMASKED_RENDERER_WEBGL):a.getParameter(a.RENDERER),e}catch{let s=new Error("Failed getting device info");throw s.name="FailedGettingDeviceInfo",s}}l(n,"getInfo");function r(){var a,o;if(!CR().isWindows)return!1;if(t!==void 0)return t;let s=(o=(a=D2e())==null?void 0:a.toLowerCase())!=null?o:"";return t=s.includes("intel")&&(s.includes("uhd")||s.includes("iris")),t}return l(r,"shouldDisableOffscreenCanvas"),{getInfo:n,shouldDisableOffscreenCanvas:r,_setCanvas(a){i=a,e=void 0,t=void 0}}})(),D2e=cee.getInfo,k2e=cee.shouldDisableOffscreenCanvas;R();function ks(i,e){let t={};for(let n=0;n<e.length;n++){let r=e[n];r in i&&(t[r]=i[r])}return t}l(ks,"pick");function pee(i){return Object.keys(i).length===0}l(pee,"isEmpty");R();var R2e=l(i=>e=>{if(!e.includes("mappedin")){let t={};for(let n in i){let r=i[n];e.includes("mappedin")||(i[n]=r)}return{url:e,headers:t}}return{url:e,headers:i}},"transformRequest");function qL(i,e,t,n){let r=i*(Math.PI/180),a=n/xd,o=i+a*180/Math.PI,s=t/xd/Math.cos(r),u=e+s*180/Math.PI;return{lat:o,lon:u}}l(qL,"cartesianToGeographic");function XL(i,e,t,n){let r=t*(Math.PI/180),a=n*(Math.PI/180),o=i*(Math.PI/180),s=e*(Math.PI/180),u=r-o,h=a-s,d=xd*h*Math.cos(o),f=xd*u;return{x:d,y:f}}l(XL,"geographicToCartesian");var dee=l((i,e,t)=>{var n;if(i.children&&(i.visible||i instanceof Kn&&i.userData.preloadGeometry))for(let r of i.children){if(r.visible&&r.type)if("entities3D"in r.userData&&(n=r.userData)!=null&&n.entities3D&&r instanceof Io){e.add(r.userData.entityId),r.userData.dirty&&t.add(r.userData.entityId);for(let a of r.userData.entities3D.values())e.add(a)}else(r.type==="group-container"||r.type==="custom-geometry"||r instanceof jg)&&e.add(r.userData.entityId);dee(r,e,t)}return e},"populateGeometry3DIdsInScene"),fee=l((i,e)=>{var t;if(i.children&&i.visible&&!((t=i.userData)!=null&&t.hidden))for(let n of i.children)n.visible&&n instanceof g1&&e.add(n.userData.entityId),fee(n,e);return e},"populateGeometry2DIdsInScene");function ZL(i,e){for(let t in e){if(e[t]==null){i[t]=void 0;continue}typeof e[t]=="object"?ZL(i[t],e[t]):i[t]=e[t]}return i}l(ZL,"mergeObjects");function YL(i,e,t,n){let r={translateX:i.x,translateY:i.y,translateZ:i.z,scale:i.meterInMercatorCoordinateUnits()},a=new qi,o=new Ee(r.scale,-r.scale,r.scale),s=new qi().makeTranslation(r.translateX,r.translateY,r.translateZ).scale(o),u=t.elevation;return{id:see,type:"custom",renderingMode:"3d",render:l((h,d)=>{if(a.fromArray(d),u!==t.elevation){let f=$a.fromLngLat(i.toLngLat(),t.elevation);s.makeTranslation(r.translateX,r.translateY,-f.z).scale(o)}e.projectionMatrix=a.multiply(s),u=t.elevation,n()},"render")}}l(YL,"createCustomLayer");function mee(i){return fetch(i,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({grant_type:"client_credentials"})})}l(mee,"fetchToken");async function gee(i){let e=await mee(i),{access_token:t}=await e.json();return{"x-mappedin-tiles-key":t}}l(gee,"getRequestHeaders");function yee(i,e=0){let t=3735928559^e,n=1103547991^e;for(let r=0,a;r<i.length;r++)a=i.charCodeAt(r),t=Math.imul(t^a,2654435761),n=Math.imul(n^a,1597334677);return t=Math.imul(t^t>>>16,2246822507)^Math.imul(n^n>>>13,3266489909),n=Math.imul(n^n>>>16,2246822507)^Math.imul(t^t>>>13,3266489909),4294967296*(2097151&n)+(t>>>0)}l(yee,"cyrb53");function SE(i,e,t){let n=i*(Math.PI/180)/2,r=e/2;return t*Math.tan(n)/r}l(SE,"getProjectionScaleFactor");function vee(i){return new Uc(new on(i[0][0],i[0][1]),new on(i[1][0],i[1][1])).getCenter().toArray()}l(vee,"getBoundingBoxCenter");function _ee(i,e){return i<e||e<=12}l(_ee,"shouldExpandZoomLevel");function y1(i){let e=1;return i.type==="geometry-group"&&i.parent!=null&&i.parent instanceof Kn?e=i.parent.userData.computedOpacity:(i.type==="geometry"||i.type==="custom-geometry"||i.type==="model")&&i.parentObject3D!=null&&i.parentObject3D instanceof Io&&i.parentObject3D.parent!=null&&i.parentObject3D.parent instanceof Kn&&(e=i.parentObject3D.parent.userData.computedOpacity),e}l(y1,"getGroupContainerOpacity");function xee(i,e,t=1e-10){if(i.length!==e.length)return!1;let n=Math.abs(i[0]-e[0])<t,r=Math.abs(i[1]-e[1])<t;if(i.length===3&&e.length===3){let a=Math.abs(i[2]-e[2])<t;return n&&r&&a}return n&&r}l(xee,"coordinatesEqual");var O2e="maplibre-frustum-culling-hack";function bee(){let i=new Nc(.01,.01,.01),e=new _l({opacity:0,depthWrite:!1,transparent:!0}),t=new ln(i,e);return t.position.copy(new Ee(0,50,0)),t.frustumCulled=!1,t.name=O2e,t}l(bee,"maplibreFrustrumCullHack");var Vh=new Ee,ER=new ft;function Cx(i,e,t=new JP){return i.traverse(n=>{if(n instanceof ln){let r=n.geometry.attributes.position;if(e.position.distanceTo(n.position)<e.near)return;for(let a=0;a<r.count;a++)Vh.fromBufferAttribute(r,a),Vh.applyMatrix4(n.matrixWorld),Vh.applyMatrix4(e.matrixWorldInverse),Vh.applyMatrix4(e.projectionMatrix),Vh.z<1&&Vh.z>0&&(ER.set(Vh.x,Vh.y),t.expandByPoint(ER))}}),t}l(Cx,"projectToBox2D");function ME(i,e){let t=e.clientWidth,n=e.clientHeight;return new ft((i.x+1)*t/2,(1-i.y)*n/2)}l(ME,"ndcToScreen");function CE(i,e,t){let n=document.createElement("div");n.style.position="absolute",n.style.border="2px solid ".concat(e),n.style.pointerEvents="none";let r=ME(new ft(i.min.x,i.min.y),t),a=ME(new ft(i.max.x,i.max.y),t);n.style.left="".concat(r.x,"px"),n.style.top="".concat(a.y,"px");let o=Math.abs(a.x-r.x),s=Math.abs(a.y-r.y);return n.style.width="".concat(o,"px"),n.style.height="".concat(s,"px"),t.appendChild(n),n}l(CE,"drawProjectedBox");R();var wee=class{constructor(e){D(this,"visible"),D(this,"altitude"),D(this,"color"),D(this,"dirty",!0),D(this,"maxWidth"),D(this,"maxHeight"),D(this,"hoverByPolygon"),D(this,"flipToFaceCamera",Hv.flipToFaceCamera),D(this,"font"),D(this,"fillOpacity"),D(this,"fontSize"),D(this,"margin"),D(this,"outlineWidth"),D(this,"outlineBlur"),D(this,"outlineOffsetX"),D(this,"strokeColor"),D(this,"strokeOpacity"),D(this,"strokeWidth"),D(this,"hoverColor"),D(this,"outlineOffsetY"),D(this,"outlineColor"),D(this,"outlineOpacity"),e&&Object.assign(this,e)}getState(e=!1){let t={};for(let n in this)!e&&n==="dirty"||this[n]!==void 0&&(t[n]=this[n]);return t}};l(wee,"Text3DStyleComponent");var EE=wee,Hv=Object.freeze({visible:!0,color:"black",flipToFaceCamera:!0,fillOpacity:1,font:void 0,fontSize:2,margin:[.2,1,.2,1.5],outlineColor:"black",outlineOpacity:1,outlineWidth:0,outlineOffsetX:0,outlineOffsetY:0,outlineBlur:0,strokeOpacity:1,strokeWidth:0,maxWidth:void 0,maxHeight:void 0,strokeColor:"black",hoverColor:void 0});R();R();var Aee=class{constructor(e){D(this,"dirty",!0),D(this,"visible",!0),D(this,"opacity",1),D(this,"verticalOffset",0),D(this,"interactive",!1),D(this,"color"),D(this,"material"),D(this,"rotation"),D(this,"scale"),e&&Object.assign(this,e)}};l(Aee,"ModelStyleComponnet");var See=Aee;R();var Ex=[1,1,1],Ix=[0,0,0],JL=Et((i,e)=>{R();var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function a(s){if(s==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(s)}l(a,"toObject");function o(){try{if(!Object.assign)return!1;var s=new String("abc");if(s[5]="de",Object.getOwnPropertyNames(s)[0]==="5")return!1;for(var u={},h=0;h<10;h++)u["_"+String.fromCharCode(h)]=h;var d=Object.getOwnPropertyNames(u).map(function(m){return u[m]});if(d.join("")!=="0123456789")return!1;var f={};return"abcdefghijklmnopqrst".split("").forEach(function(m){f[m]=m}),Object.keys(Object.assign({},f)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}l(o,"shouldUseNative"),e.exports=o()?Object.assign:function(s,u){for(var h,d=a(s),f,m=1;m<arguments.length;m++){h=Object(arguments[m]);for(var v in h)n.call(h,v)&&(d[v]=h[v]);if(t){f=t(h);for(var b=0;b<f.length;b++)r.call(h,f[b])&&(d[f[b]]=h[f[b]])}}return d}}),Mee=Et((i,e)=>{R(),function(t,n){typeof i=="object"&&typeof e<"u"?e.exports=n():typeof define=="function"&&define.amd?define(n):(t=t||self).RBush=n()}(i,function(){function t(I,C,T,k,F){l(function B(N,z,L,j,q){for(;j>L;){if(j-L>600){var Z=j-L+1,O=z-L+1,Y=Math.log(Z),J=.5*Math.exp(2*Y/3),oe=.5*Math.sqrt(Y*J*(Z-J)/Z)*(O-Z/2<0?-1:1),$=Math.max(L,Math.floor(z-O*J/Z+oe)),K=Math.min(j,Math.floor(z+(Z-O)*J/Z+oe));B(N,z,$,K,q)}var te=N[z],ve=L,Q=j;for(n(N,L,z),q(N[j],te)>0&&n(N,L,j);ve<Q;){for(n(N,ve,Q),ve++,Q--;q(N[ve],te)<0;)ve++;for(;q(N[Q],te)>0;)Q--}q(N[L],te)===0?n(N,L,Q):n(N,++Q,j),Q<=z&&(L=Q+1),z<=Q&&(j=Q-1)}},"t")(I,C,T||0,k||I.length-1,F||r)}l(t,"t");function n(I,C,T){var k=I[C];I[C]=I[T],I[T]=k}l(n,"i");function r(I,C){return I<C?-1:I>C?1:0}l(r,"n");var a=l(function(I){I===void 0&&(I=9),this._maxEntries=Math.max(4,I),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()},"r");function o(I,C,T){if(!T)return C.indexOf(I);for(var k=0;k<C.length;k++)if(T(I,C[k]))return k;return-1}l(o,"e");function s(I,C){u(I,0,I.children.length,C,I)}l(s,"a");function u(I,C,T,k,F){F||(F=A(null)),F.minX=1/0,F.minY=1/0,F.maxX=-1/0,F.maxY=-1/0;for(var B=C;B<T;B++){var N=I.children[B];h(F,I.leaf?k(N):N)}return F}l(u,"h");function h(I,C){return I.minX=Math.min(I.minX,C.minX),I.minY=Math.min(I.minY,C.minY),I.maxX=Math.max(I.maxX,C.maxX),I.maxY=Math.max(I.maxY,C.maxY),I}l(h,"o");function d(I,C){return I.minX-C.minX}l(d,"s");function f(I,C){return I.minY-C.minY}l(f,"l");function m(I){return(I.maxX-I.minX)*(I.maxY-I.minY)}l(m,"f");function v(I){return I.maxX-I.minX+(I.maxY-I.minY)}l(v,"u");function b(I,C){return I.minX<=C.minX&&I.minY<=C.minY&&C.maxX<=I.maxX&&C.maxY<=I.maxY}l(b,"m");function w(I,C){return C.minX<=I.maxX&&C.minY<=I.maxY&&C.maxX>=I.minX&&C.maxY>=I.minY}l(w,"c");function A(I){return{children:I,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}l(A,"p");function E(I,C,T,k,F){for(var B=[C,T];B.length;)if(!((T=B.pop())-(C=B.pop())<=k)){var N=C+Math.ceil((T-C)/k/2)*k;t(I,N,C,T,F),B.push(C,N,N,T)}}return l(E,"d"),a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(I){var C=this.data,T=[];if(!w(I,C))return T;for(var k=this.toBBox,F=[];C;){for(var B=0;B<C.children.length;B++){var N=C.children[B],z=C.leaf?k(N):N;w(I,z)&&(C.leaf?T.push(N):b(I,z)?this._all(N,T):F.push(N))}C=F.pop()}return T},a.prototype.collides=function(I){var C=this.data;if(!w(I,C))return!1;for(var T=[];C;){for(var k=0;k<C.children.length;k++){var F=C.children[k],B=C.leaf?this.toBBox(F):F;if(w(I,B)){if(C.leaf||b(I,B))return!0;T.push(F)}}C=T.pop()}return!1},a.prototype.load=function(I){if(!I||!I.length)return this;if(I.length<this._minEntries){for(var C=0;C<I.length;C++)this.insert(I[C]);return this}var T=this._build(I.slice(),0,I.length-1,0);if(this.data.children.length)if(this.data.height===T.height)this._splitRoot(this.data,T);else{if(this.data.height<T.height){var k=this.data;this.data=T,T=k}this._insert(T,this.data.height-T.height-1,!0)}else this.data=T;return this},a.prototype.insert=function(I){return I&&this._insert(I,this.data.height-1),this},a.prototype.clear=function(){return this.data=A([]),this},a.prototype.remove=function(I,C){if(!I)return this;for(var T,k,F,B=this.data,N=this.toBBox(I),z=[],L=[];B||z.length;){if(B||(B=z.pop(),k=z[z.length-1],T=L.pop(),F=!0),B.leaf){var j=o(I,B.children,C);if(j!==-1)return B.children.splice(j,1),z.push(B),this._condense(z),this}F||B.leaf||!b(B,N)?k?(T++,B=k.children[T],F=!1):B=null:(z.push(B),L.push(T),T=0,k=B,B=B.children[0])}return this},a.prototype.toBBox=function(I){return I},a.prototype.compareMinX=function(I,C){return I.minX-C.minX},a.prototype.compareMinY=function(I,C){return I.minY-C.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(I){return this.data=I,this},a.prototype._all=function(I,C){for(var T=[];I;)I.leaf?C.push.apply(C,I.children):T.push.apply(T,I.children),I=T.pop();return C},a.prototype._build=function(I,C,T,k){var F,B=T-C+1,N=this._maxEntries;if(B<=N)return s(F=A(I.slice(C,T+1)),this.toBBox),F;k||(k=Math.ceil(Math.log(B)/Math.log(N)),N=Math.ceil(B/Math.pow(N,k-1))),(F=A([])).leaf=!1,F.height=k;var z=Math.ceil(B/N),L=z*Math.ceil(Math.sqrt(N));E(I,C,T,L,this.compareMinX);for(var j=C;j<=T;j+=L){var q=Math.min(j+L-1,T);E(I,j,q,z,this.compareMinY);for(var Z=j;Z<=q;Z+=z){var O=Math.min(Z+z-1,q);F.children.push(this._build(I,Z,O,k-1))}}return s(F,this.toBBox),F},a.prototype._chooseSubtree=function(I,C,T,k){for(;k.push(C),!C.leaf&&k.length-1!==T;){for(var F=1/0,B=1/0,N=void 0,z=0;z<C.children.length;z++){var L=C.children[z],j=m(L),q=(Z=I,O=L,(Math.max(O.maxX,Z.maxX)-Math.min(O.minX,Z.minX))*(Math.max(O.maxY,Z.maxY)-Math.min(O.minY,Z.minY))-j);q<B?(B=q,F=j<F?j:F,N=L):q===B&&j<F&&(F=j,N=L)}C=N||C.children[0]}var Z,O;return C},a.prototype._insert=function(I,C,T){var k=T?I:this.toBBox(I),F=[],B=this._chooseSubtree(k,this.data,C,F);for(B.children.push(I),h(B,k);C>=0&&F[C].children.length>this._maxEntries;)this._split(F,C),C--;this._adjustParentBBoxes(k,F,C)},a.prototype._split=function(I,C){var T=I[C],k=T.children.length,F=this._minEntries;this._chooseSplitAxis(T,F,k);var B=this._chooseSplitIndex(T,F,k),N=A(T.children.splice(B,T.children.length-B));N.height=T.height,N.leaf=T.leaf,s(T,this.toBBox),s(N,this.toBBox),C?I[C-1].children.push(N):this._splitRoot(T,N)},a.prototype._splitRoot=function(I,C){this.data=A([I,C]),this.data.height=I.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(I,C,T){for(var k,F,B,N,z,L,j,q=1/0,Z=1/0,O=C;O<=T-C;O++){var Y=u(I,0,O,this.toBBox),J=u(I,O,T,this.toBBox),oe=(F=Y,B=J,N=void 0,z=void 0,L=void 0,j=void 0,N=Math.max(F.minX,B.minX),z=Math.max(F.minY,B.minY),L=Math.min(F.maxX,B.maxX),j=Math.min(F.maxY,B.maxY),Math.max(0,L-N)*Math.max(0,j-z)),$=m(Y)+m(J);oe<q?(q=oe,k=O,Z=$<Z?$:Z):oe===q&&$<Z&&(Z=$,k=O)}return k||T-C},a.prototype._chooseSplitAxis=function(I,C,T){var k=I.leaf?this.compareMinX:d,F=I.leaf?this.compareMinY:f;this._allDistMargin(I,C,T,k)<this._allDistMargin(I,C,T,F)&&I.children.sort(k)},a.prototype._allDistMargin=function(I,C,T,k){I.children.sort(k);for(var F=this.toBBox,B=u(I,0,C,F),N=u(I,T-C,T,F),z=v(B)+v(N),L=C;L<T-C;L++){var j=I.children[L];h(B,I.leaf?F(j):j),z+=v(B)}for(var q=T-C-1;q>=C;q--){var Z=I.children[q];h(N,I.leaf?F(Z):Z),z+=v(N)}return z},a.prototype._adjustParentBBoxes=function(I,C,T){for(var k=T;k>=0;k--)h(C[k],I)},a.prototype._condense=function(I){for(var C=I.length-1,T=void 0;C>=0;C--)I[C].children.length===0?C>0?(T=I[C-1].children).splice(T.indexOf(I[C]),1):this.clear():s(I[C],this.toBBox)},a})}),N2e=Et((i,e)=>{R(),e.exports=l(function(t,n,r,a){var o=t[0],s=t[1],u=!1;r===void 0&&(r=0),a===void 0&&(a=n.length);for(var h=(a-r)/2,d=0,f=h-1;d<h;f=d++){var m=n[r+d*2+0],v=n[r+d*2+1],b=n[r+f*2+0],w=n[r+f*2+1],A=v>s!=w>s&&o<(b-m)*(s-v)/(w-v)+m;A&&(u=!u)}return u},"pointInPolygonFlat")}),F2e=Et((i,e)=>{R(),e.exports=l(function(t,n,r,a){var o=t[0],s=t[1],u=!1;r===void 0&&(r=0),a===void 0&&(a=n.length);for(var h=a-r,d=0,f=h-1;d<h;f=d++){var m=n[d+r][0],v=n[d+r][1],b=n[f+r][0],w=n[f+r][1],A=v>s!=w>s&&o<(b-m)*(s-v)/(w-v)+m;A&&(u=!u)}return u},"pointInPolygonNested")}),B2e=Et((i,e)=>{R();var t=N2e(),n=F2e();e.exports=l(function(r,a,o,s){return a.length>0&&Array.isArray(a[0])?n(r,a,o,s):t(r,a,o,s)},"pointInPolygon"),e.exports.nested=n,e.exports.flat=t}),z2e=Et((i,e)=>{R(),function(t,n){typeof i=="object"&&typeof e<"u"?n(i):typeof define=="function"&&define.amd?define(["exports"],n):n((t=t||self).predicates={})}(i,function(t){let n=33306690738754706e-32;function r(b,w,A,E,I){let C,T,k,F,B=w[0],N=E[0],z=0,L=0;N>B==N>-B?(C=B,B=w[++z]):(C=N,N=E[++L]);let j=0;if(z<b&&L<A)for(N>B==N>-B?(k=C-((T=B+C)-B),B=w[++z]):(k=C-((T=N+C)-N),N=E[++L]),C=T,k!==0&&(I[j++]=k);z<b&&L<A;)N>B==N>-B?(k=C-((T=C+B)-(F=T-C))+(B-F),B=w[++z]):(k=C-((T=C+N)-(F=T-C))+(N-F),N=E[++L]),C=T,k!==0&&(I[j++]=k);for(;z<b;)k=C-((T=C+B)-(F=T-C))+(B-F),B=w[++z],C=T,k!==0&&(I[j++]=k);for(;L<A;)k=C-((T=C+N)-(F=T-C))+(N-F),N=E[++L],C=T,k!==0&&(I[j++]=k);return C===0&&j!==0||(I[j++]=C),j}l(r,"r");function a(b){return new Float64Array(b)}l(a,"o");let o=33306690738754716e-32,s=22204460492503146e-32,u=11093356479670487e-47,h=a(4),d=a(8),f=a(12),m=a(16),v=a(4);t.orient2d=function(b,w,A,E,I,C){let T=(w-C)*(A-I),k=(b-I)*(E-C),F=T-k;if(T===0||k===0||T>0!=k>0)return F;let B=Math.abs(T+k);return Math.abs(F)>=o*B?F:-function(N,z,L,j,q,Z,O){let Y,J,oe,$,K,te,ve,Q,he,se,Ae,Ie,we,Ne,je,Ve,Le,xe,Ue=N-q,de=L-q,ut=z-Z,ot=j-Z;K=(je=(Q=Ue-(ve=(te=134217729*Ue)-(te-Ue)))*(se=ot-(he=(te=134217729*ot)-(te-ot)))-((Ne=Ue*ot)-ve*he-Q*he-ve*se))-(Ae=je-(Le=(Q=ut-(ve=(te=134217729*ut)-(te-ut)))*(se=de-(he=(te=134217729*de)-(te-de)))-((Ve=ut*de)-ve*he-Q*he-ve*se))),h[0]=je-(Ae+K)+(K-Le),K=(we=Ne-((Ie=Ne+Ae)-(K=Ie-Ne))+(Ae-K))-(Ae=we-Ve),h[1]=we-(Ae+K)+(K-Ve),K=(xe=Ie+Ae)-Ie,h[2]=Ie-(xe-K)+(Ae-K),h[3]=xe;let He=function(re,ke){let at=ke[0];for(let ct=1;ct<re;ct++)at+=ke[ct];return at}(4,h),Ke=s*O;if(He>=Ke||-He>=Ke||(Y=N-(Ue+(K=N-Ue))+(K-q),oe=L-(de+(K=L-de))+(K-q),J=z-(ut+(K=z-ut))+(K-Z),$=j-(ot+(K=j-ot))+(K-Z),Y===0&&J===0&&oe===0&&$===0)||(Ke=u*O+n*Math.abs(He),(He+=Ue*$+ot*Y-(ut*oe+de*J))>=Ke||-He>=Ke))return He;K=(je=(Q=Y-(ve=(te=134217729*Y)-(te-Y)))*(se=ot-(he=(te=134217729*ot)-(te-ot)))-((Ne=Y*ot)-ve*he-Q*he-ve*se))-(Ae=je-(Le=(Q=J-(ve=(te=134217729*J)-(te-J)))*(se=de-(he=(te=134217729*de)-(te-de)))-((Ve=J*de)-ve*he-Q*he-ve*se))),v[0]=je-(Ae+K)+(K-Le),K=(we=Ne-((Ie=Ne+Ae)-(K=Ie-Ne))+(Ae-K))-(Ae=we-Ve),v[1]=we-(Ae+K)+(K-Ve),K=(xe=Ie+Ae)-Ie,v[2]=Ie-(xe-K)+(Ae-K),v[3]=xe;let Lt=r(4,h,4,v,d);K=(je=(Q=Ue-(ve=(te=134217729*Ue)-(te-Ue)))*(se=$-(he=(te=134217729*$)-(te-$)))-((Ne=Ue*$)-ve*he-Q*he-ve*se))-(Ae=je-(Le=(Q=ut-(ve=(te=134217729*ut)-(te-ut)))*(se=oe-(he=(te=134217729*oe)-(te-oe)))-((Ve=ut*oe)-ve*he-Q*he-ve*se))),v[0]=je-(Ae+K)+(K-Le),K=(we=Ne-((Ie=Ne+Ae)-(K=Ie-Ne))+(Ae-K))-(Ae=we-Ve),v[1]=we-(Ae+K)+(K-Ve),K=(xe=Ie+Ae)-Ie,v[2]=Ie-(xe-K)+(Ae-K),v[3]=xe;let _t=r(Lt,d,4,v,f);K=(je=(Q=Y-(ve=(te=134217729*Y)-(te-Y)))*(se=$-(he=(te=134217729*$)-(te-$)))-((Ne=Y*$)-ve*he-Q*he-ve*se))-(Ae=je-(Le=(Q=J-(ve=(te=134217729*J)-(te-J)))*(se=oe-(he=(te=134217729*oe)-(te-oe)))-((Ve=J*oe)-ve*he-Q*he-ve*se))),v[0]=je-(Ae+K)+(K-Le),K=(we=Ne-((Ie=Ne+Ae)-(K=Ie-Ne))+(Ae-K))-(Ae=we-Ve),v[1]=we-(Ae+K)+(K-Ve),K=(xe=Ie+Ae)-Ie,v[2]=Ie-(xe-K)+(Ae-K),v[3]=xe;let pe=r(_t,f,4,v,m);return m[pe-1]}(b,w,A,E,I,C,B)},t.orient2dfast=function(b,w,A,E,I,C){return(w-C)*(A-I)-(b-I)*(E-C)},Object.defineProperty(t,"__esModule",{value:!0})})}),U2e=Et((i,e)=>{R();var t=Mee(),n=GB(),r=B2e(),a=z2e().orient2d;n.default&&(n=n.default),e.exports=o,e.exports.default=o;function o(F,B,N){B=Math.max(0,B===void 0?2:B),N=N||0;var z=w(F),L=new t(16);L.toBBox=function(se){return{minX:se[0],minY:se[1],maxX:se[0],maxY:se[1]}},L.compareMinX=function(se,Ae){return se[0]-Ae[0]},L.compareMinY=function(se,Ae){return se[1]-Ae[1]},L.load(F);for(var j=[],q=0,Z;q<z.length;q++){var O=z[q];L.remove(O),Z=A(O,Z),j.push(Z)}var Y=new t(16);for(q=0;q<j.length;q++)Y.insert(b(j[q]));for(var J=B*B,oe=N*N;j.length;){var $=j.shift(),K=$.p,te=$.next.p,ve=E(K,te);if(!(ve<oe)){var Q=ve/J;O=s(L,$.prev.p,K,te,$.next.next.p,Q,Y),O&&Math.min(E(O,K),E(O,te))<=Q&&(j.push($),j.push(A(O,$)),L.remove(O),Y.remove($),Y.insert(b($)),Y.insert(b($.next)))}}$=Z;var he=[];do he.push($.p),$=$.next;while($!==Z);return he.push($.p),he}l(o,"concaveman");function s(F,B,N,z,L,j,q){for(var Z=new n([],u),O=F.data;O;){for(var Y=0;Y<O.children.length;Y++){var J=O.children[Y],oe=O.leaf?I(J,N,z):h(N,z,J);oe>j||Z.push({node:J,dist:oe})}for(;Z.length&&!Z.peek().node.children;){var $=Z.pop(),K=$.node,te=I(K,B,N),ve=I(K,z,L);if($.dist<te&&$.dist<ve&&f(N,K,q)&&f(z,K,q))return K}O=Z.pop(),O&&(O=O.node)}return null}l(s,"findCandidate");function u(F,B){return F.dist-B.dist}l(u,"compareDist");function h(F,B,N){if(d(F,N)||d(B,N))return 0;var z=C(F[0],F[1],B[0],B[1],N.minX,N.minY,N.maxX,N.minY);if(z===0)return 0;var L=C(F[0],F[1],B[0],B[1],N.minX,N.minY,N.minX,N.maxY);if(L===0)return 0;var j=C(F[0],F[1],B[0],B[1],N.maxX,N.minY,N.maxX,N.maxY);if(j===0)return 0;var q=C(F[0],F[1],B[0],B[1],N.minX,N.maxY,N.maxX,N.maxY);return q===0?0:Math.min(z,L,j,q)}l(h,"sqSegBoxDist");function d(F,B){return F[0]>=B.minX&&F[0]<=B.maxX&&F[1]>=B.minY&&F[1]<=B.maxY}l(d,"inside");function f(F,B,N){for(var z=Math.min(F[0],B[0]),L=Math.min(F[1],B[1]),j=Math.max(F[0],B[0]),q=Math.max(F[1],B[1]),Z=N.search({minX:z,minY:L,maxX:j,maxY:q}),O=0;O<Z.length;O++)if(v(Z[O].p,Z[O].next.p,F,B))return!1;return!0}l(f,"noIntersections");function m(F,B,N){return a(F[0],F[1],B[0],B[1],N[0],N[1])}l(m,"cross");function v(F,B,N,z){return F!==z&&B!==N&&m(F,B,N)>0!=m(F,B,z)>0&&m(N,z,F)>0!=m(N,z,B)>0}l(v,"intersects");function b(F){var B=F.p,N=F.next.p;return F.minX=Math.min(B[0],N[0]),F.minY=Math.min(B[1],N[1]),F.maxX=Math.max(B[0],N[0]),F.maxY=Math.max(B[1],N[1]),F}l(b,"updateBBox");function w(F){for(var B=F[0],N=F[0],z=F[0],L=F[0],j=0;j<F.length;j++){var q=F[j];q[0]<B[0]&&(B=q),q[0]>z[0]&&(z=q),q[1]<N[1]&&(N=q),q[1]>L[1]&&(L=q)}var Z=[B,N,z,L],O=Z.slice();for(j=0;j<F.length;j++)r(F[j],Z)||O.push(F[j]);return k(O)}l(w,"fastConvexHull");function A(F,B){var N={p:F,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return B?(N.next=B.next,N.prev=B,B.next.prev=N,B.next=N):(N.prev=N,N.next=N),N}l(A,"insertNode");function E(F,B){var N=F[0]-B[0],z=F[1]-B[1];return N*N+z*z}l(E,"getSqDist");function I(F,B,N){var z=B[0],L=B[1],j=N[0]-z,q=N[1]-L;if(j!==0||q!==0){var Z=((F[0]-z)*j+(F[1]-L)*q)/(j*j+q*q);Z>1?(z=N[0],L=N[1]):Z>0&&(z+=j*Z,L+=q*Z)}return j=F[0]-z,q=F[1]-L,j*j+q*q}l(I,"sqSegDist");function C(F,B,N,z,L,j,q,Z){var O=N-F,Y=z-B,J=q-L,oe=Z-j,$=F-L,K=B-j,te=O*O+Y*Y,ve=O*J+Y*oe,Q=J*J+oe*oe,he=O*$+Y*K,se=J*$+oe*K,Ae=te*Q-ve*ve,Ie,we,Ne,je,Ve=Ae,Le=Ae;Ae===0?(we=0,Ve=1,je=se,Le=Q):(we=ve*se-Q*he,je=te*se-ve*he,we<0?(we=0,je=se,Le=Q):we>Ve&&(we=Ve,je=se+ve,Le=Q)),je<0?(je=0,-he<0?we=0:-he>te?we=Ve:(we=-he,Ve=te)):je>Le&&(je=Le,-he+ve<0?we=0:-he+ve>te?we=Ve:(we=-he+ve,Ve=te)),Ie=we===0?0:we/Ve,Ne=je===0?0:je/Le;var xe=(1-Ie)*F+Ie*N,Ue=(1-Ie)*B+Ie*z,de=(1-Ne)*L+Ne*q,ut=(1-Ne)*j+Ne*Z,ot=de-xe,He=ut-Ue;return ot*ot+He*He}l(C,"sqSegSegDist");function T(F,B){return F[0]===B[0]?F[1]-B[1]:F[0]-B[0]}l(T,"compareByX");function k(F){F.sort(T);for(var B=[],N=0;N<F.length;N++){for(;B.length>=2&&m(B[B.length-2],B[B.length-1],F[N])<=0;)B.pop();B.push(F[N])}for(var z=[],L=F.length-1;L>=0;L--){for(;z.length>=2&&m(z[z.length-2],z[z.length-1],F[L])<=0;)z.pop();z.push(F[L])}return z.pop(),B.pop(),B.concat(z)}l(k,"convexHull")}),V2e=Et((i,e)=>{R(),function(t,n){typeof i=="object"&&typeof e<"u"?e.exports=n():typeof define=="function"&&define.amd?define(n):t.quickselect=n()}(i,function(){function t(o,s,u,h,d){n(o,s,u||0,h||o.length-1,d||a)}l(t,"quickselect");function n(o,s,u,h,d){for(;h>u;){if(h-u>600){var f=h-u+1,m=s-u+1,v=Math.log(f),b=.5*Math.exp(2*v/3),w=.5*Math.sqrt(v*b*(f-b)/f)*(m-f/2<0?-1:1),A=Math.max(u,Math.floor(s-m*b/f+w)),E=Math.min(h,Math.floor(s+(f-m)*b/f+w));n(o,s,A,E,d)}var I=o[s],C=u,T=h;for(r(o,u,s),d(o[h],I)>0&&r(o,u,h);C<T;){for(r(o,C,T),C++,T--;d(o[C],I)<0;)C++;for(;d(o[T],I)>0;)T--}d(o[u],I)===0?r(o,u,T):(T++,r(o,T,h)),T<=s&&(u=T+1),s<=T&&(h=T-1)}}l(n,"quickselectStep");function r(o,s,u){var h=o[s];o[s]=o[u],o[u]=h}l(r,"swap");function a(o,s){return o<s?-1:o>s?1:0}return l(a,"defaultCompare"),t})}),Cee=Et((i,e)=>{R(),e.exports=n,e.exports.default=n;var t=V2e();function n(I,C){if(!(this instanceof n))return new n(I,C);this._maxEntries=Math.max(4,I||9),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),C&&this._initFormat(C),this.clear()}l(n,"rbush"),n.prototype={all:l(function(){return this._all(this.data,[])},"all"),search:l(function(I){var C=this.data,T=[],k=this.toBBox;if(!w(I,C))return T;for(var F=[],B,N,z,L;C;){for(B=0,N=C.children.length;B<N;B++)z=C.children[B],L=C.leaf?k(z):z,w(I,L)&&(C.leaf?T.push(z):b(I,L)?this._all(z,T):F.push(z));C=F.pop()}return T},"search"),collides:l(function(I){var C=this.data,T=this.toBBox;if(!w(I,C))return!1;for(var k=[],F,B,N,z;C;){for(F=0,B=C.children.length;F<B;F++)if(N=C.children[F],z=C.leaf?T(N):N,w(I,z)){if(C.leaf||b(I,z))return!0;k.push(N)}C=k.pop()}return!1},"collides"),load:l(function(I){if(!(I&&I.length))return this;if(I.length<this._minEntries){for(var C=0,T=I.length;C<T;C++)this.insert(I[C]);return this}var k=this._build(I.slice(),0,I.length-1,0);if(!this.data.children.length)this.data=k;else if(this.data.height===k.height)this._splitRoot(this.data,k);else{if(this.data.height<k.height){var F=this.data;this.data=k,k=F}this._insert(k,this.data.height-k.height-1,!0)}return this},"load"),insert:l(function(I){return I&&this._insert(I,this.data.height-1),this},"insert"),clear:l(function(){return this.data=A([]),this},"clear"),remove:l(function(I,C){if(!I)return this;for(var T=this.data,k=this.toBBox(I),F=[],B=[],N,z,L,j;T||F.length;){if(T||(T=F.pop(),z=F[F.length-1],N=B.pop(),j=!0),T.leaf&&(L=r(I,T.children,C),L!==-1))return T.children.splice(L,1),F.push(T),this._condense(F),this;!j&&!T.leaf&&b(T,k)?(F.push(T),B.push(N),N=0,z=T,T=T.children[0]):z?(N++,T=z.children[N],j=!1):T=null}return this},"remove"),toBBox:l(function(I){return I},"toBBox"),compareMinX:u,compareMinY:h,toJSON:l(function(){return this.data},"toJSON"),fromJSON:l(function(I){return this.data=I,this},"fromJSON"),_all:l(function(I,C){for(var T=[];I;)I.leaf?C.push.apply(C,I.children):T.push.apply(T,I.children),I=T.pop();return C},"_all"),_build:l(function(I,C,T,k){var F=T-C+1,B=this._maxEntries,N;if(F<=B)return N=A(I.slice(C,T+1)),a(N,this.toBBox),N;k||(k=Math.ceil(Math.log(F)/Math.log(B)),B=Math.ceil(F/Math.pow(B,k-1))),N=A([]),N.leaf=!1,N.height=k;var z=Math.ceil(F/B),L=z*Math.ceil(Math.sqrt(B)),j,q,Z,O;for(E(I,C,T,L,this.compareMinX),j=C;j<=T;j+=L)for(Z=Math.min(j+L-1,T),E(I,j,Z,z,this.compareMinY),q=j;q<=Z;q+=z)O=Math.min(q+z-1,Z),N.children.push(this._build(I,q,O,k-1));return a(N,this.toBBox),N},"_build"),_chooseSubtree:l(function(I,C,T,k){for(var F,B,N,z,L,j,q,Z;k.push(C),!(C.leaf||k.length-1===T);){for(q=Z=1/0,F=0,B=C.children.length;F<B;F++)N=C.children[F],L=d(N),j=m(I,N)-L,j<Z?(Z=j,q=L<q?L:q,z=N):j===Z&&L<q&&(q=L,z=N);C=z||C.children[0]}return C},"_chooseSubtree"),_insert:l(function(I,C,T){var k=this.toBBox,F=T?I:k(I),B=[],N=this._chooseSubtree(F,this.data,C,B);for(N.children.push(I),s(N,F);C>=0&&B[C].children.length>this._maxEntries;)this._split(B,C),C--;this._adjustParentBBoxes(F,B,C)},"_insert"),_split:l(function(I,C){var T=I[C],k=T.children.length,F=this._minEntries;this._chooseSplitAxis(T,F,k);var B=this._chooseSplitIndex(T,F,k),N=A(T.children.splice(B,T.children.length-B));N.height=T.height,N.leaf=T.leaf,a(T,this.toBBox),a(N,this.toBBox),C?I[C-1].children.push(N):this._splitRoot(T,N)},"_split"),_splitRoot:l(function(I,C){this.data=A([I,C]),this.data.height=I.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},"_splitRoot"),_chooseSplitIndex:l(function(I,C,T){var k,F,B,N,z,L,j,q;for(L=j=1/0,k=C;k<=T-C;k++)F=o(I,0,k,this.toBBox),B=o(I,k,T,this.toBBox),N=v(F,B),z=d(F)+d(B),N<L?(L=N,q=k,j=z<j?z:j):N===L&&z<j&&(j=z,q=k);return q},"_chooseSplitIndex"),_chooseSplitAxis:l(function(I,C,T){var k=I.leaf?this.compareMinX:u,F=I.leaf?this.compareMinY:h,B=this._allDistMargin(I,C,T,k),N=this._allDistMargin(I,C,T,F);B<N&&I.children.sort(k)},"_chooseSplitAxis"),_allDistMargin:l(function(I,C,T,k){I.children.sort(k);var F=this.toBBox,B=o(I,0,C,F),N=o(I,T-C,T,F),z=f(B)+f(N),L,j;for(L=C;L<T-C;L++)j=I.children[L],s(B,I.leaf?F(j):j),z+=f(B);for(L=T-C-1;L>=C;L--)j=I.children[L],s(N,I.leaf?F(j):j),z+=f(N);return z},"_allDistMargin"),_adjustParentBBoxes:l(function(I,C,T){for(var k=T;k>=0;k--)s(C[k],I)},"_adjustParentBBoxes"),_condense:l(function(I){for(var C=I.length-1,T;C>=0;C--)I[C].children.length===0?C>0?(T=I[C-1].children,T.splice(T.indexOf(I[C]),1)):this.clear():a(I[C],this.toBBox)},"_condense"),_initFormat:l(function(I){var C=["return a"," - b",";"];this.compareMinX=new Function("a","b",C.join(I[0])),this.compareMinY=new Function("a","b",C.join(I[1])),this.toBBox=new Function("a","return {minX: a"+I[0]+", minY: a"+I[1]+", maxX: a"+I[2]+", maxY: a"+I[3]+"};")},"_initFormat")};function r(I,C,T){if(!T)return C.indexOf(I);for(var k=0;k<C.length;k++)if(T(I,C[k]))return k;return-1}l(r,"findItem");function a(I,C){o(I,0,I.children.length,C,I)}l(a,"calcBBox");function o(I,C,T,k,F){F||(F=A(null)),F.minX=1/0,F.minY=1/0,F.maxX=-1/0,F.maxY=-1/0;for(var B=C,N;B<T;B++)N=I.children[B],s(F,I.leaf?k(N):N);return F}l(o,"distBBox");function s(I,C){return I.minX=Math.min(I.minX,C.minX),I.minY=Math.min(I.minY,C.minY),I.maxX=Math.max(I.maxX,C.maxX),I.maxY=Math.max(I.maxY,C.maxY),I}l(s,"extend");function u(I,C){return I.minX-C.minX}l(u,"compareNodeMinX");function h(I,C){return I.minY-C.minY}l(h,"compareNodeMinY");function d(I){return(I.maxX-I.minX)*(I.maxY-I.minY)}l(d,"bboxArea");function f(I){return I.maxX-I.minX+(I.maxY-I.minY)}l(f,"bboxMargin");function m(I,C){return(Math.max(C.maxX,I.maxX)-Math.min(C.minX,I.minX))*(Math.max(C.maxY,I.maxY)-Math.min(C.minY,I.minY))}l(m,"enlargedArea");function v(I,C){var T=Math.max(I.minX,C.minX),k=Math.max(I.minY,C.minY),F=Math.min(I.maxX,C.maxX),B=Math.min(I.maxY,C.maxY);return Math.max(0,F-T)*Math.max(0,B-k)}l(v,"intersectionArea");function b(I,C){return I.minX<=C.minX&&I.minY<=C.minY&&C.maxX<=I.maxX&&C.maxY<=I.maxY}l(b,"contains");function w(I,C){return C.minX<=I.maxX&&C.minY<=I.maxY&&C.maxX>=I.minX&&C.maxY>=I.minY}l(w,"intersects");function A(I){return{children:I,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}l(A,"createNode");function E(I,C,T,k,F){for(var B=[C,T],N;B.length;)T=B.pop(),C=B.pop(),!(T-C<=k)&&(N=C+Math.ceil((T-C)/k/2)*k,t(I,N,C,T,F),B.push(C,N,N,T))}l(E,"multiSelect")}),Eee=Et(i=>{R(),Object.defineProperty(i,"__esModule",{value:!0}),i.earthRadius=63710088e-1,i.factors={centimeters:i.earthRadius*100,centimetres:i.earthRadius*100,degrees:i.earthRadius/111325,feet:i.earthRadius*3.28084,inches:i.earthRadius*39.37,kilometers:i.earthRadius/1e3,kilometres:i.earthRadius/1e3,meters:i.earthRadius,metres:i.earthRadius,miles:i.earthRadius/1609.344,millimeters:i.earthRadius*1e3,millimetres:i.earthRadius*1e3,nauticalmiles:i.earthRadius/1852,radians:1,yards:i.earthRadius*1.0936},i.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/i.earthRadius,yards:1.0936133},i.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function e(j,q,Z){Z===void 0&&(Z={});var O={type:"Feature"};return(Z.id===0||Z.id)&&(O.id=Z.id),Z.bbox&&(O.bbox=Z.bbox),O.properties=q||{},O.geometry=j,O}l(e,"feature"),i.feature=e;function t(j,q,Z){switch(j){case"Point":return n(q).geometry;case"LineString":return s(q).geometry;case"Polygon":return a(q).geometry;case"MultiPoint":return f(q).geometry;case"MultiLineString":return d(q).geometry;case"MultiPolygon":return m(q).geometry;default:throw new Error(j+" is invalid")}}l(t,"geometry"),i.geometry=t;function n(j,q,Z){if(Z===void 0&&(Z={}),!j)throw new Error("coordinates is required");if(!Array.isArray(j))throw new Error("coordinates must be an Array");if(j.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!B(j[0])||!B(j[1]))throw new Error("coordinates must contain numbers");var O={type:"Point",coordinates:j};return e(O,q,Z)}l(n,"point"),i.point=n;function r(j,q,Z){return Z===void 0&&(Z={}),h(j.map(function(O){return n(O,q)}),Z)}l(r,"points"),i.points=r;function a(j,q,Z){Z===void 0&&(Z={});for(var O=0,Y=j;O<Y.length;O++){var J=Y[O];if(J.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var oe=0;oe<J[J.length-1].length;oe++)if(J[J.length-1][oe]!==J[0][oe])throw new Error("First and last Position are not equivalent.")}var $={type:"Polygon",coordinates:j};return e($,q,Z)}l(a,"polygon"),i.polygon=a;function o(j,q,Z){return Z===void 0&&(Z={}),h(j.map(function(O){return a(O,q)}),Z)}l(o,"polygons"),i.polygons=o;function s(j,q,Z){if(Z===void 0&&(Z={}),j.length<2)throw new Error("coordinates must be an array of two or more positions");var O={type:"LineString",coordinates:j};return e(O,q,Z)}l(s,"lineString"),i.lineString=s;function u(j,q,Z){return Z===void 0&&(Z={}),h(j.map(function(O){return s(O,q)}),Z)}l(u,"lineStrings"),i.lineStrings=u;function h(j,q){q===void 0&&(q={});var Z={type:"FeatureCollection"};return q.id&&(Z.id=q.id),q.bbox&&(Z.bbox=q.bbox),Z.features=j,Z}l(h,"featureCollection"),i.featureCollection=h;function d(j,q,Z){Z===void 0&&(Z={});var O={type:"MultiLineString",coordinates:j};return e(O,q,Z)}l(d,"multiLineString"),i.multiLineString=d;function f(j,q,Z){Z===void 0&&(Z={});var O={type:"MultiPoint",coordinates:j};return e(O,q,Z)}l(f,"multiPoint"),i.multiPoint=f;function m(j,q,Z){Z===void 0&&(Z={});var O={type:"MultiPolygon",coordinates:j};return e(O,q,Z)}l(m,"multiPolygon"),i.multiPolygon=m;function v(j,q,Z){Z===void 0&&(Z={});var O={type:"GeometryCollection",geometries:j};return e(O,q,Z)}l(v,"geometryCollection"),i.geometryCollection=v;function b(j,q){if(q===void 0&&(q=0),q&&!(q>=0))throw new Error("precision must be a positive number");var Z=Math.pow(10,q||0);return Math.round(j*Z)/Z}l(b,"round"),i.round=b;function w(j,q){q===void 0&&(q="kilometers");var Z=i.factors[q];if(!Z)throw new Error(q+" units is invalid");return j*Z}l(w,"radiansToLength"),i.radiansToLength=w;function A(j,q){q===void 0&&(q="kilometers");var Z=i.factors[q];if(!Z)throw new Error(q+" units is invalid");return j/Z}l(A,"lengthToRadians"),i.lengthToRadians=A;function E(j,q){return C(A(j,q))}l(E,"lengthToDegrees"),i.lengthToDegrees=E;function I(j){var q=j%360;return q<0&&(q+=360),q}l(I,"bearingToAzimuth"),i.bearingToAzimuth=I;function C(j){var q=j%(2*Math.PI);return q*180/Math.PI}l(C,"radiansToDegrees"),i.radiansToDegrees=C;function T(j){var q=j%360;return q*Math.PI/180}l(T,"degreesToRadians"),i.degreesToRadians=T;function k(j,q,Z){if(q===void 0&&(q="kilometers"),Z===void 0&&(Z="kilometers"),!(j>=0))throw new Error("length must be a positive number");return w(A(j,q),Z)}l(k,"convertLength"),i.convertLength=k;function F(j,q,Z){if(q===void 0&&(q="meters"),Z===void 0&&(Z="kilometers"),!(j>=0))throw new Error("area must be a positive number");var O=i.areaFactors[q];if(!O)throw new Error("invalid original units");var Y=i.areaFactors[Z];if(!Y)throw new Error("invalid final units");return j/O*Y}l(F,"convertArea"),i.convertArea=F;function B(j){return!isNaN(j)&&j!==null&&!Array.isArray(j)}l(B,"isNumber"),i.isNumber=B;function N(j){return!!j&&j.constructor===Object}l(N,"isObject"),i.isObject=N;function z(j){if(!j)throw new Error("bbox is required");if(!Array.isArray(j))throw new Error("bbox must be an Array");if(j.length!==4&&j.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");j.forEach(function(q){if(!B(q))throw new Error("bbox must only contain numbers")})}l(z,"validateBBox"),i.validateBBox=z;function L(j){if(!j)throw new Error("id is required");if(["string","number"].indexOf(typeof j)===-1)throw new Error("id must be a number or a string")}l(L,"validateId"),i.validateId=L}),Iee=Et(i=>{R(),Object.defineProperty(i,"__esModule",{value:!0});var e=Eee();function t(C,T,k){if(C!==null)for(var F,B,N,z,L,j,q,Z=0,O=0,Y,J=C.type,oe=J==="FeatureCollection",$=J==="Feature",K=oe?C.features.length:1,te=0;te<K;te++){q=oe?C.features[te].geometry:$?C.geometry:C,Y=q?q.type==="GeometryCollection":!1,L=Y?q.geometries.length:1;for(var ve=0;ve<L;ve++){var Q=0,he=0;if(z=Y?q.geometries[ve]:q,z!==null){j=z.coordinates;var se=z.type;switch(Z=k&&(se==="Polygon"||se==="MultiPolygon")?1:0,se){case null:break;case"Point":if(T(j,O,te,Q,he)===!1)return!1;O++,Q++;break;case"LineString":case"MultiPoint":for(F=0;F<j.length;F++){if(T(j[F],O,te,Q,he)===!1)return!1;O++,se==="MultiPoint"&&Q++}se==="LineString"&&Q++;break;case"Polygon":case"MultiLineString":for(F=0;F<j.length;F++){for(B=0;B<j[F].length-Z;B++){if(T(j[F][B],O,te,Q,he)===!1)return!1;O++}se==="MultiLineString"&&Q++,se==="Polygon"&&he++}se==="Polygon"&&Q++;break;case"MultiPolygon":for(F=0;F<j.length;F++){for(he=0,B=0;B<j[F].length;B++){for(N=0;N<j[F][B].length-Z;N++){if(T(j[F][B][N],O,te,Q,he)===!1)return!1;O++}he++}Q++}break;case"GeometryCollection":for(F=0;F<z.geometries.length;F++)if(t(z.geometries[F],T,k)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}l(t,"coordEach");function n(C,T,k,F){var B=k;return t(C,function(N,z,L,j,q){z===0&&k===void 0?B=N:B=T(B,N,z,L,j,q)},F),B}l(n,"coordReduce");function r(C,T){var k;switch(C.type){case"FeatureCollection":for(k=0;k<C.features.length&&T(C.features[k].properties,k)!==!1;k++);break;case"Feature":T(C.properties,0);break}}l(r,"propEach");function a(C,T,k){var F=k;return r(C,function(B,N){N===0&&k===void 0?F=B:F=T(F,B,N)}),F}l(a,"propReduce");function o(C,T){if(C.type==="Feature")T(C,0);else if(C.type==="FeatureCollection")for(var k=0;k<C.features.length&&T(C.features[k],k)!==!1;k++);}l(o,"featureEach");function s(C,T,k){var F=k;return o(C,function(B,N){N===0&&k===void 0?F=B:F=T(F,B,N)}),F}l(s,"featureReduce");function u(C){var T=[];return t(C,function(k){T.push(k)}),T}l(u,"coordAll");function h(C,T){var k,F,B,N,z,L,j,q,Z,O,Y=0,J=C.type==="FeatureCollection",oe=C.type==="Feature",$=J?C.features.length:1;for(k=0;k<$;k++){for(L=J?C.features[k].geometry:oe?C.geometry:C,q=J?C.features[k].properties:oe?C.properties:{},Z=J?C.features[k].bbox:oe?C.bbox:void 0,O=J?C.features[k].id:oe?C.id:void 0,j=L?L.type==="GeometryCollection":!1,z=j?L.geometries.length:1,B=0;B<z;B++){if(N=j?L.geometries[B]:L,N===null){if(T(null,Y,q,Z,O)===!1)return!1;continue}switch(N.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(T(N,Y,q,Z,O)===!1)return!1;break}case"GeometryCollection":{for(F=0;F<N.geometries.length;F++)if(T(N.geometries[F],Y,q,Z,O)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}Y++}}l(h,"geomEach");function d(C,T,k){var F=k;return h(C,function(B,N,z,L,j){N===0&&k===void 0?F=B:F=T(F,B,N,z,L,j)}),F}l(d,"geomReduce");function f(C,T){h(C,function(k,F,B,N,z){var L=k===null?null:k.type;switch(L){case null:case"Point":case"LineString":case"Polygon":return T(e.feature(k,B,{bbox:N,id:z}),F,0)===!1?!1:void 0}var j;switch(L){case"MultiPoint":j="Point";break;case"MultiLineString":j="LineString";break;case"MultiPolygon":j="Polygon";break}for(var q=0;q<k.coordinates.length;q++){var Z=k.coordinates[q],O={type:j,coordinates:Z};if(T(e.feature(O,B),F,q)===!1)return!1}})}l(f,"flattenEach");function m(C,T,k){var F=k;return f(C,function(B,N,z){N===0&&z===0&&k===void 0?F=B:F=T(F,B,N,z)}),F}l(m,"flattenReduce");function v(C,T){f(C,function(k,F,B){var N=0;if(k.geometry){var z=k.geometry.type;if(!(z==="Point"||z==="MultiPoint")){var L,j=0,q=0,Z=0;if(t(k,function(O,Y,J,oe,$){if(L===void 0||F>j||oe>q||$>Z){L=O,j=F,q=oe,Z=$,N=0;return}var K=e.lineString([L,O],k.properties);if(T(K,F,B,$,N)===!1)return!1;N++,L=O})===!1)return!1}}})}l(v,"segmentEach");function b(C,T,k){var F=k,B=!1;return v(C,function(N,z,L,j,q){B===!1&&k===void 0?F=N:F=T(F,N,z,L,j,q),B=!0}),F}l(b,"segmentReduce");function w(C,T){if(!C)throw new Error("geojson is required");f(C,function(k,F,B){if(k.geometry!==null){var N=k.geometry.type,z=k.geometry.coordinates;switch(N){case"LineString":if(T(k,F,B,0,0)===!1)return!1;break;case"Polygon":for(var L=0;L<z.length;L++)if(T(e.lineString(z[L],k.properties),F,B,L)===!1)return!1;break}}})}l(w,"lineEach");function A(C,T,k){var F=k;return w(C,function(B,N,z,L){N===0&&k===void 0?F=B:F=T(F,B,N,z,L)}),F}l(A,"lineReduce");function E(C,T){if(T=T||{},!e.isObject(T))throw new Error("options is invalid");var k=T.featureIndex||0,F=T.multiFeatureIndex||0,B=T.geometryIndex||0,N=T.segmentIndex||0,z=T.properties,L;switch(C.type){case"FeatureCollection":k<0&&(k=C.features.length+k),z=z||C.features[k].properties,L=C.features[k].geometry;break;case"Feature":z=z||C.properties,L=C.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":L=C;break;default:throw new Error("geojson is invalid")}if(L===null)return null;var j=L.coordinates;switch(L.type){case"Point":case"MultiPoint":return null;case"LineString":return N<0&&(N=j.length+N-1),e.lineString([j[N],j[N+1]],z,T);case"Polygon":return B<0&&(B=j.length+B),N<0&&(N=j[B].length+N-1),e.lineString([j[B][N],j[B][N+1]],z,T);case"MultiLineString":return F<0&&(F=j.length+F),N<0&&(N=j[F].length+N-1),e.lineString([j[F][N],j[F][N+1]],z,T);case"MultiPolygon":return F<0&&(F=j.length+F),B<0&&(B=j[F].length+B),N<0&&(N=j[F][B].length-N-1),e.lineString([j[F][B][N],j[F][B][N+1]],z,T)}throw new Error("geojson is invalid")}l(E,"findSegment");function I(C,T){if(T=T||{},!e.isObject(T))throw new Error("options is invalid");var k=T.featureIndex||0,F=T.multiFeatureIndex||0,B=T.geometryIndex||0,N=T.coordIndex||0,z=T.properties,L;switch(C.type){case"FeatureCollection":k<0&&(k=C.features.length+k),z=z||C.features[k].properties,L=C.features[k].geometry;break;case"Feature":z=z||C.properties,L=C.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":L=C;break;default:throw new Error("geojson is invalid")}if(L===null)return null;var j=L.coordinates;switch(L.type){case"Point":return e.point(j,z,T);case"MultiPoint":return F<0&&(F=j.length+F),e.point(j[F],z,T);case"LineString":return N<0&&(N=j.length+N),e.point(j[N],z,T);case"Polygon":return B<0&&(B=j.length+B),N<0&&(N=j[B].length+N),e.point(j[B][N],z,T);case"MultiLineString":return F<0&&(F=j.length+F),N<0&&(N=j[F].length+N),e.point(j[F][N],z,T);case"MultiPolygon":return F<0&&(F=j.length+F),B<0&&(B=j[F].length+B),N<0&&(N=j[F][B].length-N),e.point(j[F][B][N],z,T)}throw new Error("geojson is invalid")}l(I,"findPoint"),i.coordAll=u,i.coordEach=t,i.coordReduce=n,i.featureEach=o,i.featureReduce=s,i.findPoint=I,i.findSegment=E,i.flattenEach=f,i.flattenReduce=m,i.geomEach=h,i.geomReduce=d,i.lineEach=w,i.lineReduce=A,i.propEach=r,i.propReduce=a,i.segmentEach=v,i.segmentReduce=b}),j2e=Et(i=>{R(),Object.defineProperty(i,"__esModule",{value:!0});var e=Iee();function t(n){var r=[1/0,1/0,-1/0,-1/0];return e.coordEach(n,function(a){r[0]>a[0]&&(r[0]=a[0]),r[1]>a[1]&&(r[1]=a[1]),r[2]<a[0]&&(r[2]=a[0]),r[3]<a[1]&&(r[3]=a[1])}),r}l(t,"bbox"),t.default=t,i.default=t}),KL=Et((i,e)=>{R();var t=Mee(),n=Eee(),r=Iee(),a=j2e().default,o=r.featureEach;r.coordEach,n.polygon;var s=n.featureCollection;function u(h){var d=new t(h);return d.insert=function(f){if(f.type!=="Feature")throw new Error("invalid feature");return f.bbox=f.bbox?f.bbox:a(f),t.prototype.insert.call(this,f)},d.load=function(f){var m=[];return Array.isArray(f)?f.forEach(function(v){if(v.type!=="Feature")throw new Error("invalid features");v.bbox=v.bbox?v.bbox:a(v),m.push(v)}):o(f,function(v){if(v.type!=="Feature")throw new Error("invalid features");v.bbox=v.bbox?v.bbox:a(v),m.push(v)}),t.prototype.load.call(this,m)},d.remove=function(f,m){if(f.type!=="Feature")throw new Error("invalid feature");return f.bbox=f.bbox?f.bbox:a(f),t.prototype.remove.call(this,f,m)},d.clear=function(){return t.prototype.clear.call(this)},d.search=function(f){var m=t.prototype.search.call(this,this.toBBox(f));return s(m)},d.collides=function(f){return t.prototype.collides.call(this,this.toBBox(f))},d.all=function(){var f=t.prototype.all.call(this);return s(f)},d.toJSON=function(){return t.prototype.toJSON.call(this)},d.fromJSON=function(f){return t.prototype.fromJSON.call(this,f)},d.toBBox=function(f){var m;if(f.bbox)m=f.bbox;else if(Array.isArray(f)&&f.length===4)m=f;else if(Array.isArray(f)&&f.length===6)m=[f[0],f[1],f[3],f[4]];else if(f.type==="Feature")m=a(f);else if(f.type==="FeatureCollection")m=a(f);else throw new Error("invalid geojson");return{minX:m[0],minY:m[1],maxX:m[2],maxY:m[3]}},d}l(u,"geojsonRbush"),e.exports=u,e.exports.default=u}),Tee=Et((i,e)=>{R();var t=Object.prototype.toString;e.exports=l(function(n){var r=t.call(n),a=r==="[object Arguments]";return a||(a=r!=="[object Array]"&&n!==null&&typeof n=="object"&&typeof n.length=="number"&&n.length>=0&&t.call(n.callee)==="[object Function]"),a},"isArguments")}),G2e=Et((i,e)=>{R();var t;Object.keys||(n=Object.prototype.hasOwnProperty,r=Object.prototype.toString,a=Tee(),o=Object.prototype.propertyIsEnumerable,s=!o.call({toString:null},"toString"),u=o.call(function(){},"prototype"),h=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=l(function(b){var w=b.constructor;return w&&w.prototype===b},"equalsConstructorPrototype"),f={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},m=function(){if(typeof window>"u")return!1;for(var b in window)try{if(!f["$"+b]&&n.call(window,b)&&window[b]!==null&&typeof window[b]=="object")try{d(window[b])}catch{return!0}}catch{return!0}return!1}(),v=l(function(b){if(typeof window>"u"||!m)return d(b);try{return d(b)}catch{return!1}},"equalsConstructorPrototypeIfNotBuggy"),t=l(function(b){var w=b!==null&&typeof b=="object",A=r.call(b)==="[object Function]",E=a(b),I=w&&r.call(b)==="[object String]",C=[];if(!w&&!A&&!E)throw new TypeError("Object.keys called on a non-object");var T=u&&A;if(I&&b.length>0&&!n.call(b,0))for(var k=0;k<b.length;++k)C.push(String(k));if(E&&b.length>0)for(var F=0;F<b.length;++F)C.push(String(F));else for(var B in b)!(T&&B==="prototype")&&n.call(b,B)&&C.push(String(B));if(s)for(var N=v(b),z=0;z<h.length;++z)!(N&&h[z]==="constructor")&&n.call(b,h[z])&&C.push(h[z]);return C},"keys"));var n,r,a,o,s,u,h,d,f,m,v;e.exports=t}),Pee=Et((i,e)=>{R();var t=Array.prototype.slice,n=Tee(),r=Object.keys,a=r?l(function(s){return r(s)},"keys"):G2e(),o=Object.keys;a.shim=l(function(){if(Object.keys){var s=function(){var u=Object.keys(arguments);return u&&u.length===arguments.length}(1,2);s||(Object.keys=l(function(u){return n(u)?o(t.call(u)):o(u)},"keys"))}else Object.keys=a;return Object.keys||a},"shimObjectKeys"),e.exports=a}),Lee=Et((i,e)=>{R(),e.exports=l(function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},n=Symbol("test"),r=Object(n);if(typeof n=="string"||Object.prototype.toString.call(n)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var a=42;t[n]=a;for(var o in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var s=Object.getOwnPropertySymbols(t);if(s.length!==1||s[0]!==n||!Object.prototype.propertyIsEnumerable.call(t,n))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var u=Object.getOwnPropertyDescriptor(t,n);if(u.value!==a||u.enumerable!==!0)return!1}return!0},"hasSymbols")}),QL=Et((i,e)=>{R();var t=Lee();e.exports=l(function(){return t()&&!!Symbol.toStringTag},"hasToStringTagShams")}),Dee=Et((i,e)=>{R(),e.exports=Object}),kee=Et((i,e)=>{R(),e.exports=Error}),$2e=Et((i,e)=>{R(),e.exports=EvalError}),H2e=Et((i,e)=>{R(),e.exports=RangeError}),W2e=Et((i,e)=>{R(),e.exports=ReferenceError}),Ree=Et((i,e)=>{R(),e.exports=SyntaxError}),Gg=Et((i,e)=>{R(),e.exports=TypeError}),q2e=Et((i,e)=>{R(),e.exports=URIError}),X2e=Et((i,e)=>{R(),e.exports=Math.abs}),Z2e=Et((i,e)=>{R(),e.exports=Math.floor}),Y2e=Et((i,e)=>{R(),e.exports=Math.max}),J2e=Et((i,e)=>{R(),e.exports=Math.min}),K2e=Et((i,e)=>{R(),e.exports=Math.pow}),Q2e=Et((i,e)=>{R(),e.exports=Math.round}),ewe=Et((i,e)=>{R(),e.exports=Number.isNaN||l(function(t){return t!==t},"isNaN")}),twe=Et((i,e)=>{R();var t=ewe();e.exports=l(function(n){return t(n)||n===0?n:n<0?-1:1},"sign")}),iwe=Et((i,e)=>{R(),e.exports=Object.getOwnPropertyDescriptor}),$g=Et((i,e)=>{R();var t=iwe();if(t)try{t([],"length")}catch{t=null}e.exports=t}),OA=Et((i,e)=>{R();var t=Object.defineProperty||!1;if(t)try{t({},"a",{value:1})}catch{t=!1}e.exports=t}),nwe=Et((i,e)=>{R();var t=typeof Symbol<"u"&&Symbol,n=Lee();e.exports=l(function(){return typeof t!="function"||typeof Symbol!="function"||typeof t("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:n()},"hasNativeSymbols")}),Oee=Et((i,e)=>{R(),e.exports=typeof Reflect<"u"&&Reflect.getPrototypeOf||null}),Nee=Et((i,e)=>{R();var t=Dee();e.exports=t.getPrototypeOf||null}),rwe=Et((i,e)=>{R();var t="Function.prototype.bind called on incompatible ",n=Object.prototype.toString,r=Math.max,a="[object Function]",o=l(function(h,d){for(var f=[],m=0;m<h.length;m+=1)f[m]=h[m];for(var v=0;v<d.length;v+=1)f[v+h.length]=d[v];return f},"concatty"),s=l(function(h,d){for(var f=[],m=d||0,v=0;m<h.length;m+=1,v+=1)f[v]=h[m];return f},"slicy"),u=l(function(h,d){for(var f="",m=0;m<h.length;m+=1)f+=h[m],m+1<h.length&&(f+=d);return f},"joiny");e.exports=l(function(h){var d=this;if(typeof d!="function"||n.apply(d)!==a)throw new TypeError(t+d);for(var f=s(arguments,1),m,v=l(function(){if(this instanceof m){var I=d.apply(this,o(f,arguments));return Object(I)===I?I:this}return d.apply(h,o(f,arguments))},"binder"),b=r(0,d.length-f.length),w=[],A=0;A<b;A++)w[A]="$"+A;if(m=Function("binder","return function ("+u(w,",")+"){ return binder.apply(this,arguments); }")(v),d.prototype){var E=l(function(){},"Empty");E.prototype=d.prototype,m.prototype=new E,E.prototype=null}return m},"bind")}),g0=Et((i,e)=>{R();var t=rwe();e.exports=Function.prototype.bind||t}),eD=Et((i,e)=>{R(),e.exports=Function.prototype.call}),tD=Et((i,e)=>{R(),e.exports=Function.prototype.apply}),awe=Et((i,e)=>{R(),e.exports=typeof Reflect<"u"&&Reflect&&Reflect.apply}),Fee=Et((i,e)=>{R();var t=g0(),n=tD(),r=eD(),a=awe();e.exports=a||t.call(r,n)}),iD=Et((i,e)=>{R();var t=g0(),n=Gg(),r=eD(),a=Fee();e.exports=l(function(o){if(o.length<1||typeof o[0]!="function")throw new n("a function is required");return a(t,r,o)},"callBindBasic")}),owe=Et((i,e)=>{R();var t=iD(),n=$g(),r;try{r=[].__proto__===Array.prototype}catch(u){if(!u||typeof u!="object"||!("code"in u)||u.code!=="ERR_PROTO_ACCESS")throw u}var a=!!r&&n&&n(Object.prototype,"__proto__"),o=Object,s=o.getPrototypeOf;e.exports=a&&typeof a.get=="function"?t([a.get]):typeof s=="function"?l(function(u){return s(u==null?u:o(u))},"getDunder"):!1}),Bee=Et((i,e)=>{R();var t=Oee(),n=Nee(),r=owe();e.exports=t?l(function(a){return t(a)},"getProto"):n?l(function(a){if(!a||typeof a!="object"&&typeof a!="function")throw new TypeError("getProto: not an object");return n(a)},"getProto"):r?l(function(a){return r(a)},"getProto"):null}),zee=Et((i,e)=>{R();var t=Function.prototype.call,n=Object.prototype.hasOwnProperty,r=g0();e.exports=r.call(t,n)}),Uee=Et((i,e)=>{R();var t,n=Dee(),r=kee(),a=$2e(),o=H2e(),s=W2e(),u=Ree(),h=Gg(),d=q2e(),f=X2e(),m=Z2e(),v=Y2e(),b=J2e(),w=K2e(),A=Q2e(),E=twe(),I=Function,C=l(function(Le){try{return I('"use strict"; return ('+Le+").constructor;")()}catch{}},"getEvalledConstructor"),T=$g(),k=OA(),F=l(function(){throw new h},"throwTypeError"),B=T?function(){try{return arguments.callee,F}catch{try{return T(arguments,"callee").get}catch{return F}}}():F,N=nwe()(),z=Bee(),L=Nee(),j=Oee(),q=tD(),Z=eD(),O={},Y=typeof Uint8Array>"u"||!z?t:z(Uint8Array),J={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?t:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?t:ArrayBuffer,"%ArrayIteratorPrototype%":N&&z?z([][Symbol.iterator]()):t,"%AsyncFromSyncIteratorPrototype%":t,"%AsyncFunction%":O,"%AsyncGenerator%":O,"%AsyncGeneratorFunction%":O,"%AsyncIteratorPrototype%":O,"%Atomics%":typeof Atomics>"u"?t:Atomics,"%BigInt%":typeof BigInt>"u"?t:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?t:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?t:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?t:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":r,"%eval%":eval,"%EvalError%":a,"%Float16Array%":typeof Float16Array>"u"?t:Float16Array,"%Float32Array%":typeof Float32Array>"u"?t:Float32Array,"%Float64Array%":typeof Float64Array>"u"?t:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?t:FinalizationRegistry,"%Function%":I,"%GeneratorFunction%":O,"%Int8Array%":typeof Int8Array>"u"?t:Int8Array,"%Int16Array%":typeof Int16Array>"u"?t:Int16Array,"%Int32Array%":typeof Int32Array>"u"?t:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":N&&z?z(z([][Symbol.iterator]())):t,"%JSON%":typeof JSON=="object"?JSON:t,"%Map%":typeof Map>"u"?t:Map,"%MapIteratorPrototype%":typeof Map>"u"||!N||!z?t:z(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":n,"%Object.getOwnPropertyDescriptor%":T,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?t:Promise,"%Proxy%":typeof Proxy>"u"?t:Proxy,"%RangeError%":o,"%ReferenceError%":s,"%Reflect%":typeof Reflect>"u"?t:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?t:Set,"%SetIteratorPrototype%":typeof Set>"u"||!N||!z?t:z(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?t:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":N&&z?z(""[Symbol.iterator]()):t,"%Symbol%":N?Symbol:t,"%SyntaxError%":u,"%ThrowTypeError%":B,"%TypedArray%":Y,"%TypeError%":h,"%Uint8Array%":typeof Uint8Array>"u"?t:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?t:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?t:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?t:Uint32Array,"%URIError%":d,"%WeakMap%":typeof WeakMap>"u"?t:WeakMap,"%WeakRef%":typeof WeakRef>"u"?t:WeakRef,"%WeakSet%":typeof WeakSet>"u"?t:WeakSet,"%Function.prototype.call%":Z,"%Function.prototype.apply%":q,"%Object.defineProperty%":k,"%Object.getPrototypeOf%":L,"%Math.abs%":f,"%Math.floor%":m,"%Math.max%":v,"%Math.min%":b,"%Math.pow%":w,"%Math.round%":A,"%Math.sign%":E,"%Reflect.getPrototypeOf%":j};if(z)try{null.error}catch(Le){oe=z(z(Le)),J["%Error.prototype%"]=oe}var oe,$=l(function Le(xe){var Ue;if(xe==="%AsyncFunction%")Ue=C("async function () {}");else if(xe==="%GeneratorFunction%")Ue=C("function* () {}");else if(xe==="%AsyncGeneratorFunction%")Ue=C("async function* () {}");else if(xe==="%AsyncGenerator%"){var de=Le("%AsyncGeneratorFunction%");de&&(Ue=de.prototype)}else if(xe==="%AsyncIteratorPrototype%"){var ut=Le("%AsyncGenerator%");ut&&z&&(Ue=z(ut.prototype))}return J[xe]=Ue,Ue},"doEval"),K={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},te=g0(),ve=zee(),Q=te.call(Z,Array.prototype.concat),he=te.call(q,Array.prototype.splice),se=te.call(Z,String.prototype.replace),Ae=te.call(Z,String.prototype.slice),Ie=te.call(Z,RegExp.prototype.exec),we=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Ne=/\\(\\)?/g,je=l(function(Le){var xe=Ae(Le,0,1),Ue=Ae(Le,-1);if(xe==="%"&&Ue!=="%")throw new u("invalid intrinsic syntax, expected closing `%`");if(Ue==="%"&&xe!=="%")throw new u("invalid intrinsic syntax, expected opening `%`");var de=[];return se(Le,we,function(ut,ot,He,Ke){de[de.length]=He?se(Ke,Ne,"$1"):ot||ut}),de},"stringToPath"),Ve=l(function(Le,xe){var Ue=Le,de;if(ve(K,Ue)&&(de=K[Ue],Ue="%"+de[0]+"%"),ve(J,Ue)){var ut=J[Ue];if(ut===O&&(ut=$(Ue)),typeof ut>"u"&&!xe)throw new h("intrinsic "+Le+" exists, but is not available. Please file an issue!");return{alias:de,name:Ue,value:ut}}throw new u("intrinsic "+Le+" does not exist!")},"getBaseIntrinsic");e.exports=l(function(Le,xe){if(typeof Le!="string"||Le.length===0)throw new h("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof xe!="boolean")throw new h('"allowMissing" argument must be a boolean');if(Ie(/^%?[^%]*%?$/,Le)===null)throw new u("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var Ue=je(Le),de=Ue.length>0?Ue[0]:"",ut=Ve("%"+de+"%",xe),ot=ut.name,He=ut.value,Ke=!1,Lt=ut.alias;Lt&&(de=Lt[0],he(Ue,Q([0,1],Lt)));for(var _t=1,pe=!0;_t<Ue.length;_t+=1){var re=Ue[_t],ke=Ae(re,0,1),at=Ae(re,-1);if((ke==='"'||ke==="'"||ke==="`"||at==='"'||at==="'"||at==="`")&&ke!==at)throw new u("property names with quotes must have matching quotes");if((re==="constructor"||!pe)&&(Ke=!0),de+="."+re,ot="%"+de+"%",ve(J,ot))He=J[ot];else if(He!=null){if(!(re in He)){if(!xe)throw new h("base intrinsic for "+Le+" exists, but the property is not available.");return}if(T&&_t+1>=Ue.length){var ct=T(He,re);pe=!!ct,pe&&"get"in ct&&!("originalValue"in ct.get)?He=ct.get:He=He[re]}else pe=ve(He,re),He=He[re];pe&&!Ke&&(J[ot]=He)}}return He},"GetIntrinsic")}),nD=Et((i,e)=>{R();var t=Uee(),n=iD(),r=n([t("%String.prototype.indexOf%")]);e.exports=l(function(a,o){var s=t(a,!!o);return typeof s=="function"&&r(a,".prototype.")>-1?n([s]):s},"callBoundIntrinsic")}),swe=Et((i,e)=>{R();var t=QL()(),n=nD(),r=n("Object.prototype.toString"),a=l(function(u){return t&&u&&typeof u=="object"&&Symbol.toStringTag in u?!1:r(u)==="[object Arguments]"},"isArguments"),o=l(function(u){return a(u)?!0:u!==null&&typeof u=="object"&&"length"in u&&typeof u.length=="number"&&u.length>=0&&r(u)!=="[object Array]"&&"callee"in u&&r(u.callee)==="[object Function]"},"isArguments"),s=function(){return a(arguments)}();a.isLegacyArguments=o,e.exports=s?a:o}),rD=Et((i,e)=>{R();var t=OA(),n=Ree(),r=Gg(),a=$g();e.exports=l(function(o,s,u){if(!o||typeof o!="object"&&typeof o!="function")throw new r("`obj` must be an object or a function`");if(typeof s!="string"&&typeof s!="symbol")throw new r("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new r("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new r("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new r("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new r("`loose`, if provided, must be a boolean");var h=arguments.length>3?arguments[3]:null,d=arguments.length>4?arguments[4]:null,f=arguments.length>5?arguments[5]:null,m=arguments.length>6?arguments[6]:!1,v=!!a&&a(o,s);if(t)t(o,s,{configurable:f===null&&v?v.configurable:!f,enumerable:h===null&&v?v.enumerable:!h,value:u,writable:d===null&&v?v.writable:!d});else if(m||!h&&!d&&!f)o[s]=u;else throw new n("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},"defineDataProperty")}),aD=Et((i,e)=>{R();var t=OA(),n=l(function(){return!!t},"hasPropertyDescriptors");n.hasArrayLengthDefineBug=l(function(){if(!t)return null;try{return t([],"length",{value:1}).length!==1}catch{return!0}},"hasArrayLengthDefineBug"),e.exports=n}),y0=Et((i,e)=>{R();var t=Pee(),n=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",r=Object.prototype.toString,a=Array.prototype.concat,o=rD(),s=l(function(f){return typeof f=="function"&&r.call(f)==="[object Function]"},"isFunction"),u=aD()(),h=l(function(f,m,v,b){if(m in f){if(b===!0){if(f[m]===v)return}else if(!s(b)||!b())return}u?o(f,m,v,!0):o(f,m,v)},"defineProperty"),d=l(function(f,m){var v=arguments.length>2?arguments[2]:{},b=t(m);n&&(b=a.call(b,Object.getOwnPropertySymbols(m)));for(var w=0;w<b.length;w+=1)h(f,b[w],m[b[w]],v[b[w]])},"defineProperties");d.supportsDescriptors=!!u,e.exports=d}),lwe=Et((i,e)=>{R();var t=Uee(),n=rD(),r=aD()(),a=$g(),o=Gg(),s=t("%Math.floor%");e.exports=l(function(u,h){if(typeof u!="function")throw new o("`fn` is not a function");if(typeof h!="number"||h<0||h>4294967295||s(h)!==h)throw new o("`length` must be a positive 32-bit integer");var d=arguments.length>2&&!!arguments[2],f=!0,m=!0;if("length"in u&&a){var v=a(u,"length");v&&!v.configurable&&(f=!1),v&&!v.writable&&(m=!1)}return(f||m||!d)&&(r?n(u,"length",h,!0,!0):n(u,"length",h)),u},"setFunctionLength")}),uwe=Et((i,e)=>{R();var t=g0(),n=tD(),r=Fee();e.exports=l(function(){return r(t,n,arguments)},"applyBind")}),Vee=Et((i,e)=>{R();var t=lwe(),n=OA(),r=iD(),a=uwe();e.exports=l(function(o){var s=r(arguments),u=o.length-(arguments.length-1);return t(s,1+(u>0?u:0),!0)},"callBind"),n?n(e.exports,"apply",{value:a}):e.exports.apply=a}),jee=Et((i,e)=>{R();var t=l(function(n){return n!==n},"numberIsNaN");e.exports=l(function(n,r){return n===0&&r===0?1/n===1/r:!!(n===r||t(n)&&t(r))},"is")}),Gee=Et((i,e)=>{R();var t=jee();e.exports=l(function(){return typeof Object.is=="function"?Object.is:t},"getPolyfill")}),hwe=Et((i,e)=>{R();var t=Gee(),n=y0();e.exports=l(function(){var r=t();return n(Object,{is:r},{is:l(function(){return Object.is!==r},"testObjectIs")}),r},"shimObjectIs")}),cwe=Et((i,e)=>{R();var t=y0(),n=Vee(),r=jee(),a=Gee(),o=hwe(),s=n(a(),Object);t(s,{getPolyfill:a,implementation:r,shim:o}),e.exports=s}),pwe=Et((i,e)=>{R();var t=nD(),n=QL()(),r=zee(),a=$g(),o;n?(s=t("RegExp.prototype.exec"),u={},h=l(function(){throw u},"throwRegexMarker"),d={toString:h,valueOf:h},typeof Symbol.toPrimitive=="symbol"&&(d[Symbol.toPrimitive]=h),o=l(function(v){if(!v||typeof v!="object")return!1;var b=a(v,"lastIndex"),w=b&&r(b,"value");if(!w)return!1;try{s(v,d)}catch(A){return A===u}},"isRegex")):(f=t("Object.prototype.toString"),m="[object RegExp]",o=l(function(v){return!v||typeof v!="object"&&typeof v!="function"?!1:f(v)===m},"isRegex"));var s,u,h,d,f,m;e.exports=o}),dwe=Et((i,e)=>{R();var t=l(function(){return typeof l(function(){},"f").name=="string"},"functionsHaveNames"),n=Object.getOwnPropertyDescriptor;if(n)try{n([],"length")}catch{n=null}t.functionsHaveConfigurableNames=l(function(){if(!t()||!n)return!1;var a=n(function(){},"name");return!!a&&!!a.configurable},"functionsHaveConfigurableNames");var r=Function.prototype.bind;t.boundFunctionsHaveNames=l(function(){return t()&&typeof r=="function"&&l(function(){},"f").bind().name!==""},"boundFunctionsHaveNames"),e.exports=t}),fwe=Et((i,e)=>{R();var t=rD(),n=aD()(),r=dwe().functionsHaveConfigurableNames(),a=Gg();e.exports=l(function(o,s){if(typeof o!="function")throw new a("`fn` is not a function");var u=arguments.length>2&&!!arguments[2];return(!u||r)&&(n?t(o,"name",s,!0,!0):t(o,"name",s)),o},"setFunctionName")}),$ee=Et((i,e)=>{R();var t=fwe(),n=Gg(),r=Object;e.exports=t(l(function(){if(this==null||this!==r(this))throw new n("RegExp.prototype.flags getter called on non-object");var a="";return this.hasIndices&&(a+="d"),this.global&&(a+="g"),this.ignoreCase&&(a+="i"),this.multiline&&(a+="m"),this.dotAll&&(a+="s"),this.unicode&&(a+="u"),this.unicodeSets&&(a+="v"),this.sticky&&(a+="y"),a},"flags"),"get flags",!0)}),Hee=Et((i,e)=>{R();var t=$ee(),n=y0().supportsDescriptors,r=Object.getOwnPropertyDescriptor;e.exports=l(function(){if(n&&/a/mig.flags==="gim"){var a=r(RegExp.prototype,"flags");if(a&&typeof a.get=="function"&&"dotAll"in RegExp.prototype&&"hasIndices"in RegExp.prototype){var o="",s={};if(Object.defineProperty(s,"hasIndices",{get:l(function(){o+="d"},"get")}),Object.defineProperty(s,"sticky",{get:l(function(){o+="y"},"get")}),a.get.call(s),o==="dy")return a.get}}return t},"getPolyfill")}),mwe=Et((i,e)=>{R();var t=y0().supportsDescriptors,n=Hee(),r=$g(),a=Object.defineProperty,o=kee(),s=Bee(),u=/a/;e.exports=l(function(){if(!t||!s)throw new o("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var h=n(),d=s(u),f=r(d,"flags");return(!f||f.get!==h)&&a(d,"flags",{configurable:!0,enumerable:!1,get:h}),h},"shimFlags")}),gwe=Et((i,e)=>{R();var t=y0(),n=Vee(),r=$ee(),a=Hee(),o=mwe(),s=n(a());t(s,{getPolyfill:a,implementation:r,shim:o}),e.exports=s}),ywe=Et((i,e)=>{R();var t=nD(),n=t("Date.prototype.getDay"),r=l(function(u){try{return n(u),!0}catch{return!1}},"tryDateGetDayCall"),a=t("Object.prototype.toString"),o="[object Date]",s=QL()();e.exports=l(function(u){return typeof u!="object"||u===null?!1:s?r(u):a(u)===o},"isDateObject")}),Wee=Et((i,e)=>{R();var t=Pee(),n=swe(),r=cwe(),a=pwe(),o=gwe(),s=ywe(),u=Date.prototype.getTime;function h(v,b,w){var A=w||{};return(A.strict?r(v,b):v===b)?!0:!v||!b||typeof v!="object"&&typeof b!="object"?A.strict?r(v,b):v==b:m(v,b,A)}l(h,"deepEqual");function d(v){return v==null}l(d,"isUndefinedOrNull");function f(v){return!(!v||typeof v!="object"||typeof v.length!="number"||typeof v.copy!="function"||typeof v.slice!="function"||v.length>0&&typeof v[0]!="number")}l(f,"isBuffer");function m(v,b,w){var A,E;if(typeof v!=typeof b||d(v)||d(b)||v.prototype!==b.prototype||n(v)!==n(b))return!1;var I=a(v),C=a(b);if(I!==C)return!1;if(I||C)return v.source===b.source&&o(v)===o(b);if(s(v)&&s(b))return u.call(v)===u.call(b);var T=f(v),k=f(b);if(T!==k)return!1;if(T||k){if(v.length!==b.length)return!1;for(A=0;A<v.length;A++)if(v[A]!==b[A])return!1;return!0}if(typeof v!=typeof b)return!1;try{var F=t(v),B=t(b)}catch{return!1}if(F.length!==B.length)return!1;for(F.sort(),B.sort(),A=F.length-1;A>=0;A--)if(F[A]!=B[A])return!1;for(A=F.length-1;A>=0;A--)if(E=F[A],!h(v[E],b[E],w))return!1;return!0}l(m,"objEquiv"),e.exports=h}),qee=Et((i,e)=>{R();var t=Wee(),n=l(function(s){this.precision=s&&s.precision?s.precision:17,this.direction=s&&s.direction?s.direction:!1,this.pseudoNode=s&&s.pseudoNode?s.pseudoNode:!1,this.objectComparator=s&&s.objectComparator?s.objectComparator:o},"Equality");n.prototype.compare=function(s,u){if(s.type!==u.type||!a(s,u))return!1;switch(s.type){case"Point":return this.compareCoord(s.coordinates,u.coordinates);case"LineString":return this.compareLine(s.coordinates,u.coordinates,0,!1);case"Polygon":return this.comparePolygon(s,u);case"Feature":return this.compareFeature(s,u);default:if(s.type.indexOf("Multi")===0){var h=this,d=r(s),f=r(u);return d.every(function(m){return this.some(function(v){return h.compare(m,v)})},f)}}return!1};function r(s){return s.coordinates.map(function(u){return{type:s.type.replace("Multi",""),coordinates:u}})}l(r,"explode");function a(s,u){return s.hasOwnProperty("coordinates")?s.coordinates.length===u.coordinates.length:s.length===u.length}l(a,"sameLength"),n.prototype.compareCoord=function(s,u){if(s.length!==u.length)return!1;for(var h=0;h<s.length;h++)if(s[h].toFixed(this.precision)!==u[h].toFixed(this.precision))return!1;return!0},n.prototype.compareLine=function(s,u,h,d){if(!a(s,u))return!1;var f=this.pseudoNode?s:this.removePseudo(s),m=this.pseudoNode?u:this.removePseudo(u);if(!(d&&!this.compareCoord(f[0],m[0])&&(m=this.fixStartIndex(m,f),!m))){var v=this.compareCoord(f[h],m[h]);return this.direction||v?this.comparePath(f,m):this.compareCoord(f[h],m[m.length-(1+h)])?this.comparePath(f.slice().reverse(),m):!1}},n.prototype.fixStartIndex=function(s,u){for(var h,d=-1,f=0;f<s.length;f++)if(this.compareCoord(s[f],u[0])){d=f;break}return d>=0&&(h=[].concat(s.slice(d,s.length),s.slice(1,d+1))),h},n.prototype.comparePath=function(s,u){var h=this;return s.every(function(d,f){return h.compareCoord(d,this[f])},u)},n.prototype.comparePolygon=function(s,u){if(this.compareLine(s.coordinates[0],u.coordinates[0],1,!0)){var h=s.coordinates.slice(1,s.coordinates.length),d=u.coordinates.slice(1,u.coordinates.length),f=this;return h.every(function(m){return this.some(function(v){return f.compareLine(m,v,1,!0)})},d)}else return!1},n.prototype.compareFeature=function(s,u){return s.id!==u.id||!this.objectComparator(s.properties,u.properties)||!this.compareBBox(s,u)?!1:this.compare(s.geometry,u.geometry)},n.prototype.compareBBox=function(s,u){return!!(!s.bbox&&!u.bbox||s.bbox&&u.bbox&&this.compareCoord(s.bbox,u.bbox))},n.prototype.removePseudo=function(s){return s};function o(s,u){return t(s,u,{strict:!0})}l(o,"objectComparator"),e.exports=n}),vwe=Et((i,e)=>{R();function t(n,r,a,o){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(n,r,a,o)}l(t,"DBSCAN"),t.prototype.run=function(n,r,a,o){this._init(n,r,a,o);for(var s=0;s<this._datasetLength;s++)if(this._visited[s]!==1){this._visited[s]=1;var u=this._regionQuery(s);if(u.length<this.minPts)this.noise.push(s);else{var h=this.clusters.length;this.clusters.push([]),this._addToCluster(s,h),this._expandCluster(h,u)}}return this.clusters},t.prototype._init=function(n,r,a,o){if(n){if(!(n instanceof Array))throw Error("Dataset must be of type array, "+typeof n+" given");this.dataset=n,this.clusters=[],this.noise=[],this._datasetLength=n.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}r&&(this.epsilon=r),a&&(this.minPts=a),o&&(this.distance=o)},t.prototype._expandCluster=function(n,r){for(var a=0;a<r.length;a++){var o=r[a];if(this._visited[o]!==1){this._visited[o]=1;var s=this._regionQuery(o);s.length>=this.minPts&&(r=this._mergeArrays(r,s))}this._assigned[o]!==1&&this._addToCluster(o,n)}},t.prototype._addToCluster=function(n,r){this.clusters[r].push(n),this._assigned[n]=1},t.prototype._regionQuery=function(n){for(var r=[],a=0;a<this._datasetLength;a++){var o=this.distance(this.dataset[n],this.dataset[a]);o<this.epsilon&&r.push(a)}return r},t.prototype._mergeArrays=function(n,r){for(var a=r.length,o=0;o<a;o++){var s=r[o];n.indexOf(s)<0&&n.push(s)}return n},t.prototype._euclideanDistance=function(n,r){for(var a=0,o=Math.min(n.length,r.length);o--;)a+=(n[o]-r[o])*(n[o]-r[o]);return Math.sqrt(a)},typeof e<"u"&&e.exports&&(e.exports=t)}),_we=Et((i,e)=>{R();function t(n,r,a){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(n,r,a)}l(t,"KMEANS"),t.prototype.init=function(n,r,a){this.assignments=[],this.centroids=[],typeof n<"u"&&(this.dataset=n),typeof r<"u"&&(this.k=r),typeof a<"u"&&(this.distance=a)},t.prototype.run=function(n,r){this.init(n,r);for(var a=this.dataset.length,o=0;o<this.k;o++)this.centroids[o]=this.randomCentroid();for(var s=!0;s;){s=this.assign();for(var u=0;u<this.k;u++){for(var h=new Array(v),d=0,f=0;f<v;f++)h[f]=0;for(var m=0;m<a;m++){var v=this.dataset[m].length;if(u===this.assignments[m]){for(var f=0;f<v;f++)h[f]+=this.dataset[m][f];d++}}if(d>0){for(var f=0;f<v;f++)h[f]/=d;this.centroids[u]=h}else this.centroids[u]=this.randomCentroid(),s=!0}}return this.getClusters()},t.prototype.randomCentroid=function(){var n=this.dataset.length-1,r,a;do a=Math.round(Math.random()*n),r=this.dataset[a];while(this.centroids.indexOf(r)>=0);return r},t.prototype.assign=function(){for(var n=!1,r=this.dataset.length,a,o=0;o<r;o++)a=this.argmin(this.dataset[o],this.centroids,this.distance),a!=this.assignments[o]&&(this.assignments[o]=a,n=!0);return n},t.prototype.getClusters=function(){for(var n=new Array(this.k),r,a=0;a<this.assignments.length;a++)r=this.assignments[a],typeof n[r]>"u"&&(n[r]=[]),n[r].push(a);return n},t.prototype.argmin=function(n,r,a){for(var o=Number.MAX_VALUE,s=0,u=r.length,h,d=0;d<u;d++)h=a(n,r[d]),h<o&&(o=h,s=d);return s},t.prototype.distance=function(n,r){for(var a=0,o=Math.min(n.length,r.length);o--;){var s=n[o]-r[o];a+=s*s}return Math.sqrt(a)},typeof e<"u"&&e.exports&&(e.exports=t)}),Xee=Et((i,e)=>{R();function t(n,r,a){this._queue=[],this._priorities=[],this._sorting="desc",this._init(n,r,a)}l(t,"PriorityQueue"),t.prototype.insert=function(n,r){for(var a=this._queue.length,o=a;o--;){var s=this._priorities[o];this._sorting==="desc"?r>s&&(a=o):r<s&&(a=o)}this._insertAt(n,r,a)},t.prototype.remove=function(n){for(var r=this._queue.length;r--;){var a=this._queue[r];if(n===a){this._queue.splice(r,1),this._priorities.splice(r,1);break}}},t.prototype.forEach=function(n){this._queue.forEach(n)},t.prototype.getElements=function(){return this._queue},t.prototype.getElementPriority=function(n){return this._priorities[n]},t.prototype.getPriorities=function(){return this._priorities},t.prototype.getElementsWithPriorities=function(){for(var n=[],r=0,a=this._queue.length;r<a;r++)n.push([this._queue[r],this._priorities[r]]);return n},t.prototype._init=function(n,r,a){if(n&&r){if(this._queue=[],this._priorities=[],n.length!==r.length)throw new Error("Arrays must have the same length");for(var o=0;o<n.length;o++)this.insert(n[o],r[o])}a&&(this._sorting=a)},t.prototype._insertAt=function(n,r,a){this._queue.length===a?(this._queue.push(n),this._priorities.push(r)):(this._queue.splice(a,0,n),this._priorities.splice(a,0,r))},typeof e<"u"&&e.exports&&(e.exports=t)}),xwe=Et((i,e)=>{R(),typeof e<"u"&&e.exports&&(t=Xee());var t;function n(r,a,o,s){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(r,a,o,s)}l(n,"OPTICS"),n.prototype.run=function(r,a,o,s){this._init(r,a,o,s);for(var u=0,h=this.dataset.length;u<h;u++)if(this._processed[u]!==1){this._processed[u]=1,this.clusters.push([u]);var d=this.clusters.length-1;this._orderedList.push(u);var f=new t(null,null,"asc"),m=this._regionQuery(u);this._distanceToCore(u)!==void 0&&(this._updateQueue(u,m,f),this._expandCluster(d,f))}return this.clusters},n.prototype.getReachabilityPlot=function(){for(var r=[],a=0,o=this._orderedList.length;a<o;a++){var s=this._orderedList[a],u=this._reachability[s];r.push([s,u])}return r},n.prototype._init=function(r,a,o,s){if(r){if(!(r instanceof Array))throw Error("Dataset must be of type array, "+typeof r+" given");this.dataset=r,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}a&&(this.epsilon=a),o&&(this.minPts=o),s&&(this.distance=s)},n.prototype._updateQueue=function(r,a,o){var s=this;this._coreDistance=this._distanceToCore(r),a.forEach(function(u){if(s._processed[u]===void 0){var h=s.distance(s.dataset[r],s.dataset[u]),d=Math.max(s._coreDistance,h);s._reachability[u]===void 0?(s._reachability[u]=d,o.insert(u,d)):d<s._reachability[u]&&(s._reachability[u]=d,o.remove(u),o.insert(u,d))}})},n.prototype._expandCluster=function(r,a){for(var o=a.getElements(),s=0,u=o.length;s<u;s++){var h=o[s];if(this._processed[h]===void 0){var d=this._regionQuery(h);this._processed[h]=1,this.clusters[r].push(h),this._orderedList.push(h),this._distanceToCore(h)!==void 0&&(this._updateQueue(h,d,a),this._expandCluster(r,a))}}},n.prototype._distanceToCore=function(r){for(var a=this.epsilon,o=0;o<a;o++){var s=this._regionQuery(r,o);if(s.length>=this.minPts)return o}},n.prototype._regionQuery=function(r,a){a=a||this.epsilon;for(var o=[],s=0,u=this.dataset.length;s<u;s++)this.distance(this.dataset[r],this.dataset[s])<a&&o.push(s);return o},n.prototype._euclideanDistance=function(r,a){for(var o=0,s=Math.min(r.length,a.length);s--;)o+=(r[s]-a[s])*(r[s]-a[s]);return Math.sqrt(o)},typeof e<"u"&&e.exports&&(e.exports=n)}),bwe=Et((i,e)=>{R(),typeof e<"u"&&e.exports&&(e.exports={DBSCAN:vwe(),KMEANS:_we(),OPTICS:xwe(),PriorityQueue:Xee()})}),Zee=Et((i,e)=>{R(),e.exports={eudist:l(function(t,n,r){for(var a=t.length,o=0,s=0;s<a;s++){var u=(t[s]||0)-(n[s]||0);o+=u*u}return r?Math.sqrt(o):o},"eudist"),mandist:l(function(t,n,r){for(var a=t.length,o=0,s=0;s<a;s++)o+=Math.abs((t[s]||0)-(n[s]||0));return r?Math.sqrt(o):o},"mandist"),dist:l(function(t,n,r){var a=Math.abs(t-n);return r?a:a*a},"dist")}}),wwe=Et((i,e)=>{R();var t=Zee(),n=t.eudist,r=t.dist;e.exports={kmrand:l(function(a,o){for(var s={},u=[],h=o<<2,d=a.length,f=a[0].length>0;u.length<o&&h-- >0;){var m=a[Math.floor(Math.random()*d)],v=f?m.join("_"):""+m;s[v]||(s[v]=!0,u.push(m))}if(u.length<o)throw new Error("Error initializating clusters");return u},"kmrand"),kmpp:l(function(a,o){var s=a[0].length?n:r,u=[],h=a.length,d=a[0].length>0,f=a[Math.floor(Math.random()*h)];for(d?f.join("_"):""+f,u.push(f),!0;u.length<o;){for(var m=[],v=u.length,b=0,w=[],A=0;A<h;A++){for(var E=1/0,I=0;I<v;I++){var C=s(a[A],u[I]);C<=E&&(E=C)}m[A]=E}for(var T=0;T<h;T++)b+=m[T];for(var k=0;k<h;k++)w[k]={i:k,v:a[k],pr:m[k]/b,cs:0};w.sort(function(z,L){return z.pr-L.pr}),w[0].cs=w[0].pr;for(var F=1;F<h;F++)w[F].cs=w[F-1].cs+w[F].pr;for(var B=Math.random(),N=0;N<h-1&&w[N++].cs<B;);u.push(w[N-1].v)}return u},"kmpp")}}),Awe=Et((i,e)=>{R();var t=Zee(),n=wwe(),r=t.eudist;t.mandist,t.dist;var a=n.kmrand,o=n.kmpp,s=1e4;function u(d,f,m){m=m||[];for(var v=0;v<d;v++)m[v]=f;return m}l(u,"init");function h(d,f,m,v){var b=[],w=[],A=[],E=[],I=!1,C=v||s,T=d.length,k=d[0].length,F=k>0,B=[];if(m)m=="kmrand"?b=a(d,f):m=="kmpp"?b=o(d,f):b=m;else for(var N={};b.length<f;){var z=Math.floor(Math.random()*T);N[z]||(N[z]=!0,b.push(d[z]))}do{u(f,0,B);for(var L=0;L<T;L++){for(var j=1/0,q=0,Z=0;Z<f;Z++){var E=F?r(d[L],b[Z]):Math.abs(d[L]-b[Z]);E<=j&&(j=E,q=Z)}A[L]=q,B[q]++}for(var O=[],w=[],Y=0,J=0;J<f;J++)O[J]=F?u(k,0,O[J]):0,w[J]=b[J];if(F){for(var oe=0;oe<f;oe++)b[oe]=[];for(var $=0;$<T;$++)for(var K=A[$],te=O[K],ve=d[$],Q=0;Q<k;Q++)te[Q]+=ve[Q];I=!0;for(var he=0;he<f;he++){for(var se=b[he],Ae=O[he],Ie=w[he],we=B[he],Ne=0;Ne<k;Ne++)se[Ne]=Ae[Ne]/we||0;if(I){for(var je=0;je<k;je++)if(Ie[je]!=se[je]){I=!1;break}}}}else{for(var Ve=0;Ve<T;Ve++){var Le=A[Ve];O[Le]+=d[Ve]}for(var xe=0;xe<f;xe++)b[xe]=O[xe]/B[xe]||0;I=!0;for(var Ue=0;Ue<f;Ue++)if(w[Ue]!=b[Ue]){I=!1;break}}I=I||--C<=0}while(!I);return{it:s-C,k:f,idxs:A,centroids:b}}l(h,"skmeans"),e.exports=h}),v0=Et((i,e)=>{R(),function(t,n){typeof i=="object"&&typeof e<"u"?e.exports=n():typeof define=="function"&&define.amd?define(n):(t=typeof globalThis<"u"?globalThis:t||self,t.polygonClipping=n())}(i,function(){function t(me,W){var X={label:0,sent:l(function(){if(fe[0]&1)throw fe[1];return fe[1]},"sent"),trys:[],ops:[]},ae,_e,fe,We;return We={next:Be(0),throw:Be(1),return:Be(2)},typeof Symbol=="function"&&(We[Symbol.iterator]=function(){return this}),We;function Be(Xe){return function(bt){return st([Xe,bt])}}function st(Xe){if(ae)throw new TypeError("Generator is already executing.");for(;X;)try{if(ae=1,_e&&(fe=Xe[0]&2?_e.return:Xe[0]?_e.throw||((fe=_e.return)&&fe.call(_e),0):_e.next)&&!(fe=fe.call(_e,Xe[1])).done)return fe;switch(_e=0,fe&&(Xe=[Xe[0]&2,fe.value]),Xe[0]){case 0:case 1:fe=Xe;break;case 4:return X.label++,{value:Xe[1],done:!1};case 5:X.label++,_e=Xe[1],Xe=[0];continue;case 7:Xe=X.ops.pop(),X.trys.pop();continue;default:if(fe=X.trys,!(fe=fe.length>0&&fe[fe.length-1])&&(Xe[0]===6||Xe[0]===2)){X=0;continue}if(Xe[0]===3&&(!fe||Xe[1]>fe[0]&&Xe[1]<fe[3])){X.label=Xe[1];break}if(Xe[0]===6&&X.label<fe[1]){X.label=fe[1],fe=Xe;break}if(fe&&X.label<fe[2]){X.label=fe[2],X.ops.push(Xe);break}fe[2]&&X.ops.pop(),X.trys.pop();continue}Xe=W.call(me,X)}catch(bt){Xe=[6,bt],_e=0}finally{ae=fe=0}if(Xe[0]&5)throw Xe[1];return{value:Xe[0]?Xe[1]:void 0,done:!0}}}l(t,"__generator");var n=function(){function me(W,X){this.next=null,this.key=W,this.data=X,this.left=null,this.right=null}return l(me,"Node"),me}();function r(me,W){return me>W?1:me<W?-1:0}l(r,"DEFAULT_COMPARE");function a(me,W,X){for(var ae=new n(null,null),_e=ae,fe=ae;;){var We=X(me,W.key);if(We<0){if(W.left===null)break;if(X(me,W.left.key)<0){var Be=W.left;if(W.left=Be.right,Be.right=W,W=Be,W.left===null)break}fe.left=W,fe=W,W=W.left}else if(We>0){if(W.right===null)break;if(X(me,W.right.key)>0){var Be=W.right;if(W.right=Be.left,Be.left=W,W=Be,W.right===null)break}_e.right=W,_e=W,W=W.right}else break}return _e.right=W.left,fe.left=W.right,W.left=ae.right,W.right=ae.left,W}l(a,"splay");function o(me,W,X,ae){var _e=new n(me,W);if(X===null)return _e.left=_e.right=null,_e;X=a(me,X,ae);var fe=ae(me,X.key);return fe<0?(_e.left=X.left,_e.right=X,X.left=null):fe>=0&&(_e.right=X.right,_e.left=X,X.right=null),_e}l(o,"insert");function s(me,W,X){var ae=null,_e=null;if(W){W=a(me,W,X);var fe=X(W.key,me);fe===0?(ae=W.left,_e=W.right):fe<0?(_e=W.right,W.right=null,ae=W):(ae=W.left,W.left=null,_e=W)}return{left:ae,right:_e}}l(s,"split");function u(me,W,X){return W===null?me:(me===null||(W=a(me.key,W,X),W.left=me),W)}l(u,"merge");function h(me,W,X,ae,_e){if(me){ae(""+W+(X?" ":" ")+_e(me)+`
`);var fe=W+(X?"    ":"   ");me.left&&h(me.left,fe,!1,ae,_e),me.right&&h(me.right,fe,!0,ae,_e)}}l(h,"printRow");var d=function(){function me(W){W===void 0&&(W=r),this._root=null,this._size=0,this._comparator=W}return l(me,"Tree"),me.prototype.insert=function(W,X){return this._size++,this._root=o(W,X,this._root,this._comparator)},me.prototype.add=function(W,X){var ae=new n(W,X);this._root===null&&(ae.left=ae.right=null,this._size++,this._root=ae);var _e=this._comparator,fe=a(W,this._root,_e),We=_e(W,fe.key);return We===0?this._root=fe:(We<0?(ae.left=fe.left,ae.right=fe,fe.left=null):We>0&&(ae.right=fe.right,ae.left=fe,fe.right=null),this._size++,this._root=ae),this._root},me.prototype.remove=function(W){this._root=this._remove(W,this._root,this._comparator)},me.prototype._remove=function(W,X,ae){var _e;if(X===null)return null;X=a(W,X,ae);var fe=ae(W,X.key);return fe===0?(X.left===null?_e=X.right:(_e=a(W,X.left,ae),_e.right=X.right),this._size--,_e):X},me.prototype.pop=function(){var W=this._root;if(W){for(;W.left;)W=W.left;return this._root=a(W.key,this._root,this._comparator),this._root=this._remove(W.key,this._root,this._comparator),{key:W.key,data:W.data}}return null},me.prototype.findStatic=function(W){for(var X=this._root,ae=this._comparator;X;){var _e=ae(W,X.key);if(_e===0)return X;_e<0?X=X.left:X=X.right}return null},me.prototype.find=function(W){return this._root&&(this._root=a(W,this._root,this._comparator),this._comparator(W,this._root.key)!==0)?null:this._root},me.prototype.contains=function(W){for(var X=this._root,ae=this._comparator;X;){var _e=ae(W,X.key);if(_e===0)return!0;_e<0?X=X.left:X=X.right}return!1},me.prototype.forEach=function(W,X){for(var ae=this._root,_e=[],fe=!1;!fe;)ae!==null?(_e.push(ae),ae=ae.left):_e.length!==0?(ae=_e.pop(),W.call(X,ae),ae=ae.right):fe=!0;return this},me.prototype.range=function(W,X,ae,_e){for(var fe=[],We=this._comparator,Be=this._root,st;fe.length!==0||Be;)if(Be)fe.push(Be),Be=Be.left;else{if(Be=fe.pop(),st=We(Be.key,X),st>0)break;if(We(Be.key,W)>=0&&ae.call(_e,Be))return this;Be=Be.right}return this},me.prototype.keys=function(){var W=[];return this.forEach(function(X){var ae=X.key;return W.push(ae)}),W},me.prototype.values=function(){var W=[];return this.forEach(function(X){var ae=X.data;return W.push(ae)}),W},me.prototype.min=function(){return this._root?this.minNode(this._root).key:null},me.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},me.prototype.minNode=function(W){if(W===void 0&&(W=this._root),W)for(;W.left;)W=W.left;return W},me.prototype.maxNode=function(W){if(W===void 0&&(W=this._root),W)for(;W.right;)W=W.right;return W},me.prototype.at=function(W){for(var X=this._root,ae=!1,_e=0,fe=[];!ae;)if(X)fe.push(X),X=X.left;else if(fe.length>0){if(X=fe.pop(),_e===W)return X;_e++,X=X.right}else ae=!0;return null},me.prototype.next=function(W){var X=this._root,ae=null;if(W.right){for(ae=W.right;ae.left;)ae=ae.left;return ae}for(var _e=this._comparator;X;){var fe=_e(W.key,X.key);if(fe===0)break;fe<0?(ae=X,X=X.left):X=X.right}return ae},me.prototype.prev=function(W){var X=this._root,ae=null;if(W.left!==null){for(ae=W.left;ae.right;)ae=ae.right;return ae}for(var _e=this._comparator;X;){var fe=_e(W.key,X.key);if(fe===0)break;fe<0?X=X.left:(ae=X,X=X.right)}return ae},me.prototype.clear=function(){return this._root=null,this._size=0,this},me.prototype.toList=function(){return v(this._root)},me.prototype.load=function(W,X,ae){X===void 0&&(X=[]),ae===void 0&&(ae=!1);var _e=W.length,fe=this._comparator;if(ae&&A(W,X,0,_e-1,fe),this._root===null)this._root=f(W,X,0,_e),this._size=_e;else{var We=w(this.toList(),m(W,X),fe);_e=this._size+_e,this._root=b({head:We},0,_e)}return this},me.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(me.prototype,"size",{get:l(function(){return this._size},"get"),enumerable:!0,configurable:!0}),Object.defineProperty(me.prototype,"root",{get:l(function(){return this._root},"get"),enumerable:!0,configurable:!0}),me.prototype.toString=function(W){W===void 0&&(W=l(function(ae){return String(ae.key)},"printNode"));var X=[];return h(this._root,"",!0,function(ae){return X.push(ae)},W),X.join("")},me.prototype.update=function(W,X,ae){var _e=this._comparator,fe=s(W,this._root,_e),We=fe.left,Be=fe.right;_e(W,X)<0?Be=o(X,ae,Be,_e):We=o(X,ae,We,_e),this._root=u(We,Be,_e)},me.prototype.split=function(W){return s(W,this._root,this._comparator)},me.prototype[Symbol.iterator]=function(){var W,X,ae;return t(this,function(_e){switch(_e.label){case 0:W=this._root,X=[],ae=!1,_e.label=1;case 1:return ae?[3,6]:W===null?[3,2]:(X.push(W),W=W.left,[3,5]);case 2:return X.length===0?[3,4]:(W=X.pop(),[4,W]);case 3:return _e.sent(),W=W.right,[3,5];case 4:ae=!0,_e.label=5;case 5:return[3,1];case 6:return[2]}})},me}();function f(me,W,X,ae){var _e=ae-X;if(_e>0){var fe=X+Math.floor(_e/2),We=me[fe],Be=W[fe],st=new n(We,Be);return st.left=f(me,W,X,fe),st.right=f(me,W,fe+1,ae),st}return null}l(f,"loadRecursive");function m(me,W){for(var X=new n(null,null),ae=X,_e=0;_e<me.length;_e++)ae=ae.next=new n(me[_e],W[_e]);return ae.next=null,X.next}l(m,"createList");function v(me){for(var W=me,X=[],ae=!1,_e=new n(null,null),fe=_e;!ae;)W?(X.push(W),W=W.left):X.length>0?(W=fe=fe.next=X.pop(),W=W.right):ae=!0;return fe.next=null,_e.next}l(v,"toList");function b(me,W,X){var ae=X-W;if(ae>0){var _e=W+Math.floor(ae/2),fe=b(me,W,_e),We=me.head;return We.left=fe,me.head=me.head.next,We.right=b(me,_e+1,X),We}return null}l(b,"sortedListToBST");function w(me,W,X){for(var ae=new n(null,null),_e=ae,fe=me,We=W;fe!==null&&We!==null;)X(fe.key,We.key)<0?(_e.next=fe,fe=fe.next):(_e.next=We,We=We.next),_e=_e.next;return fe!==null?_e.next=fe:We!==null&&(_e.next=We),ae.next}l(w,"mergeLists");function A(me,W,X,ae,_e){if(!(X>=ae)){for(var fe=me[X+ae>>1],We=X-1,Be=ae+1;;){do We++;while(_e(me[We],fe)<0);do Be--;while(_e(me[Be],fe)>0);if(We>=Be)break;var st=me[We];me[We]=me[Be],me[Be]=st,st=W[We],W[We]=W[Be],W[Be]=st}A(me,W,X,Be,_e),A(me,W,Be+1,ae,_e)}}l(A,"sort");let E=l((me,W)=>me.ll.x<=W.x&&W.x<=me.ur.x&&me.ll.y<=W.y&&W.y<=me.ur.y,"isInBbox"),I=l((me,W)=>{if(W.ur.x<me.ll.x||me.ur.x<W.ll.x||W.ur.y<me.ll.y||me.ur.y<W.ll.y)return null;let X=me.ll.x<W.ll.x?W.ll.x:me.ll.x,ae=me.ur.x<W.ur.x?me.ur.x:W.ur.x,_e=me.ll.y<W.ll.y?W.ll.y:me.ll.y,fe=me.ur.y<W.ur.y?me.ur.y:W.ur.y;return{ll:{x:X,y:_e},ur:{x:ae,y:fe}}},"getBboxOverlap"),C=Number.EPSILON;C===void 0&&(C=Math.pow(2,-52));let T=C*C,k=l((me,W)=>{if(-C<me&&me<C&&-C<W&&W<C)return 0;let X=me-W;return X*X<T*me*W?0:me<W?-1:1},"cmp"),F=class{constructor(){this.reset()}reset(){this.xRounder=new z,this.yRounder=new z}round(W,X){return{x:this.xRounder.round(W),y:this.yRounder.round(X)}}};l(F,"PtRounder");let B=F,N=class{constructor(){this.tree=new d,this.round(0)}round(W){let X=this.tree.add(W),ae=this.tree.prev(X);if(ae!==null&&k(X.key,ae.key)===0)return this.tree.remove(W),ae.key;let _e=this.tree.next(X);return _e!==null&&k(X.key,_e.key)===0?(this.tree.remove(W),_e.key):W}};l(N,"CoordRounder");let z=N,L=new B,j=11102230246251565e-32,q=134217729,Z=(3+8*j)*j;function O(me,W,X,ae,_e){let fe,We,Be,st,Xe=W[0],bt=ae[0],Ye=0,dt=0;bt>Xe==bt>-Xe?(fe=Xe,Xe=W[++Ye]):(fe=bt,bt=ae[++dt]);let Mt=0;if(Ye<me&&dt<X)for(bt>Xe==bt>-Xe?(We=Xe+fe,Be=fe-(We-Xe),Xe=W[++Ye]):(We=bt+fe,Be=fe-(We-bt),bt=ae[++dt]),fe=We,Be!==0&&(_e[Mt++]=Be);Ye<me&&dt<X;)bt>Xe==bt>-Xe?(We=fe+Xe,st=We-fe,Be=fe-(We-st)+(Xe-st),Xe=W[++Ye]):(We=fe+bt,st=We-fe,Be=fe-(We-st)+(bt-st),bt=ae[++dt]),fe=We,Be!==0&&(_e[Mt++]=Be);for(;Ye<me;)We=fe+Xe,st=We-fe,Be=fe-(We-st)+(Xe-st),Xe=W[++Ye],fe=We,Be!==0&&(_e[Mt++]=Be);for(;dt<X;)We=fe+bt,st=We-fe,Be=fe-(We-st)+(bt-st),bt=ae[++dt],fe=We,Be!==0&&(_e[Mt++]=Be);return(fe!==0||Mt===0)&&(_e[Mt++]=fe),Mt}l(O,"sum");function Y(me,W){let X=W[0];for(let ae=1;ae<me;ae++)X+=W[ae];return X}l(Y,"estimate");function J(me){return new Float64Array(me)}l(J,"vec");let oe=(3+16*j)*j,$=(2+12*j)*j,K=(9+64*j)*j*j,te=J(4),ve=J(8),Q=J(12),he=J(16),se=J(4);function Ae(me,W,X,ae,_e,fe,We){let Be,st,Xe,bt,Ye,dt,Mt,bi,ni,Ii,Nt,Ri,Ki,Vi,Ti,yn,hn,An,gn=me-_e,nr=X-_e,ue=W-fe,Pe=ae-fe;Vi=gn*Pe,dt=q*gn,Mt=dt-(dt-gn),bi=gn-Mt,dt=q*Pe,ni=dt-(dt-Pe),Ii=Pe-ni,Ti=bi*Ii-(Vi-Mt*ni-bi*ni-Mt*Ii),yn=ue*nr,dt=q*ue,Mt=dt-(dt-ue),bi=ue-Mt,dt=q*nr,ni=dt-(dt-nr),Ii=nr-ni,hn=bi*Ii-(yn-Mt*ni-bi*ni-Mt*Ii),Nt=Ti-hn,Ye=Ti-Nt,te[0]=Ti-(Nt+Ye)+(Ye-hn),Ri=Vi+Nt,Ye=Ri-Vi,Ki=Vi-(Ri-Ye)+(Nt-Ye),Nt=Ki-yn,Ye=Ki-Nt,te[1]=Ki-(Nt+Ye)+(Ye-yn),An=Ri+Nt,Ye=An-Ri,te[2]=Ri-(An-Ye)+(Nt-Ye),te[3]=An;let Ze=Y(4,te),Ge=$*We;if(Ze>=Ge||-Ze>=Ge||(Ye=me-gn,Be=me-(gn+Ye)+(Ye-_e),Ye=X-nr,Xe=X-(nr+Ye)+(Ye-_e),Ye=W-ue,st=W-(ue+Ye)+(Ye-fe),Ye=ae-Pe,bt=ae-(Pe+Ye)+(Ye-fe),Be===0&&st===0&&Xe===0&&bt===0)||(Ge=K*We+Z*Math.abs(Ze),Ze+=gn*bt+Pe*Be-(ue*Xe+nr*st),Ze>=Ge||-Ze>=Ge))return Ze;Vi=Be*Pe,dt=q*Be,Mt=dt-(dt-Be),bi=Be-Mt,dt=q*Pe,ni=dt-(dt-Pe),Ii=Pe-ni,Ti=bi*Ii-(Vi-Mt*ni-bi*ni-Mt*Ii),yn=st*nr,dt=q*st,Mt=dt-(dt-st),bi=st-Mt,dt=q*nr,ni=dt-(dt-nr),Ii=nr-ni,hn=bi*Ii-(yn-Mt*ni-bi*ni-Mt*Ii),Nt=Ti-hn,Ye=Ti-Nt,se[0]=Ti-(Nt+Ye)+(Ye-hn),Ri=Vi+Nt,Ye=Ri-Vi,Ki=Vi-(Ri-Ye)+(Nt-Ye),Nt=Ki-yn,Ye=Ki-Nt,se[1]=Ki-(Nt+Ye)+(Ye-yn),An=Ri+Nt,Ye=An-Ri,se[2]=Ri-(An-Ye)+(Nt-Ye),se[3]=An;let Oe=O(4,te,4,se,ve);Vi=gn*bt,dt=q*gn,Mt=dt-(dt-gn),bi=gn-Mt,dt=q*bt,ni=dt-(dt-bt),Ii=bt-ni,Ti=bi*Ii-(Vi-Mt*ni-bi*ni-Mt*Ii),yn=ue*Xe,dt=q*ue,Mt=dt-(dt-ue),bi=ue-Mt,dt=q*Xe,ni=dt-(dt-Xe),Ii=Xe-ni,hn=bi*Ii-(yn-Mt*ni-bi*ni-Mt*Ii),Nt=Ti-hn,Ye=Ti-Nt,se[0]=Ti-(Nt+Ye)+(Ye-hn),Ri=Vi+Nt,Ye=Ri-Vi,Ki=Vi-(Ri-Ye)+(Nt-Ye),Nt=Ki-yn,Ye=Ki-Nt,se[1]=Ki-(Nt+Ye)+(Ye-yn),An=Ri+Nt,Ye=An-Ri,se[2]=Ri-(An-Ye)+(Nt-Ye),se[3]=An;let pt=O(Oe,ve,4,se,Q);Vi=Be*bt,dt=q*Be,Mt=dt-(dt-Be),bi=Be-Mt,dt=q*bt,ni=dt-(dt-bt),Ii=bt-ni,Ti=bi*Ii-(Vi-Mt*ni-bi*ni-Mt*Ii),yn=st*Xe,dt=q*st,Mt=dt-(dt-st),bi=st-Mt,dt=q*Xe,ni=dt-(dt-Xe),Ii=Xe-ni,hn=bi*Ii-(yn-Mt*ni-bi*ni-Mt*Ii),Nt=Ti-hn,Ye=Ti-Nt,se[0]=Ti-(Nt+Ye)+(Ye-hn),Ri=Vi+Nt,Ye=Ri-Vi,Ki=Vi-(Ri-Ye)+(Nt-Ye),Nt=Ki-yn,Ye=Ki-Nt,se[1]=Ki-(Nt+Ye)+(Ye-yn),An=Ri+Nt,Ye=An-Ri,se[2]=Ri-(An-Ye)+(Nt-Ye),se[3]=An;let Ot=O(pt,Q,4,se,he);return he[Ot-1]}l(Ae,"orient2dadapt");function Ie(me,W,X,ae,_e,fe){let We=(W-fe)*(X-_e),Be=(me-_e)*(ae-fe),st=We-Be,Xe=Math.abs(We+Be);return Math.abs(st)>=oe*Xe?st:-Ae(me,W,X,ae,_e,fe,Xe)}l(Ie,"orient2d");let we=l((me,W)=>me.x*W.y-me.y*W.x,"crossProduct"),Ne=l((me,W)=>me.x*W.x+me.y*W.y,"dotProduct"),je=l((me,W,X)=>{let ae=Ie(me.x,me.y,W.x,W.y,X.x,X.y);return ae>0?-1:ae<0?1:0},"compareVectorAngles"),Ve=l(me=>Math.sqrt(Ne(me,me)),"length"),Le=l((me,W,X)=>{let ae={x:W.x-me.x,y:W.y-me.y},_e={x:X.x-me.x,y:X.y-me.y};return we(_e,ae)/Ve(_e)/Ve(ae)},"sineOfAngle"),xe=l((me,W,X)=>{let ae={x:W.x-me.x,y:W.y-me.y},_e={x:X.x-me.x,y:X.y-me.y};return Ne(_e,ae)/Ve(_e)/Ve(ae)},"cosineOfAngle"),Ue=l((me,W,X)=>W.y===0?null:{x:me.x+W.x/W.y*(X-me.y),y:X},"horizontalIntersection"),de=l((me,W,X)=>W.x===0?null:{x:X,y:me.y+W.y/W.x*(X-me.x)},"verticalIntersection"),ut=l((me,W,X,ae)=>{if(W.x===0)return de(X,ae,me.x);if(ae.x===0)return de(me,W,X.x);if(W.y===0)return Ue(X,ae,me.y);if(ae.y===0)return Ue(me,W,X.y);let _e=we(W,ae);if(_e==0)return null;let fe={x:X.x-me.x,y:X.y-me.y},We=we(fe,W)/_e,Be=we(fe,ae)/_e,st=me.x+Be*W.x,Xe=X.x+We*ae.x,bt=me.y+Be*W.y,Ye=X.y+We*ae.y,dt=(st+Xe)/2,Mt=(bt+Ye)/2;return{x:dt,y:Mt}},"intersection$1"),ot=class Yee{static compare(W,X){let ae=Yee.comparePoints(W.point,X.point);return ae!==0?ae:(W.point!==X.point&&W.link(X),W.isLeft!==X.isLeft?W.isLeft?1:-1:_t.compare(W.segment,X.segment))}static comparePoints(W,X){return W.x<X.x?-1:W.x>X.x?1:W.y<X.y?-1:W.y>X.y?1:0}constructor(W,X){W.events===void 0?W.events=[this]:W.events.push(this),this.point=W,this.isLeft=X}link(W){if(W.point===this.point)throw new Error("Tried to link already linked events");let X=W.point.events;for(let ae=0,_e=X.length;ae<_e;ae++){let fe=X[ae];this.point.events.push(fe),fe.point=this.point}this.checkForConsuming()}checkForConsuming(){let W=this.point.events.length;for(let X=0;X<W;X++){let ae=this.point.events[X];if(ae.segment.consumedBy===void 0)for(let _e=X+1;_e<W;_e++){let fe=this.point.events[_e];fe.consumedBy===void 0&&ae.otherSE.point.events===fe.otherSE.point.events&&ae.segment.consume(fe.segment)}}}getAvailableLinkedEvents(){let W=[];for(let X=0,ae=this.point.events.length;X<ae;X++){let _e=this.point.events[X];_e!==this&&!_e.segment.ringOut&&_e.segment.isInResult()&&W.push(_e)}return W}getLeftmostComparator(W){let X=new Map,ae=l(_e=>{let fe=_e.otherSE;X.set(_e,{sine:Le(this.point,W.point,fe.point),cosine:xe(this.point,W.point,fe.point)})},"fillCache");return(_e,fe)=>{X.has(_e)||ae(_e),X.has(fe)||ae(fe);let{sine:We,cosine:Be}=X.get(_e),{sine:st,cosine:Xe}=X.get(fe);return We>=0&&st>=0?Be<Xe?1:Be>Xe?-1:0:We<0&&st<0?Be<Xe?-1:Be>Xe?1:0:st<We?-1:st>We?1:0}}};l(ot,"SweepEvent");let He=ot,Ke=0,Lt=class Tx{static compare(W,X){let ae=W.leftSE.point.x,_e=X.leftSE.point.x,fe=W.rightSE.point.x,We=X.rightSE.point.x;if(We<ae)return 1;if(fe<_e)return-1;let Be=W.leftSE.point.y,st=X.leftSE.point.y,Xe=W.rightSE.point.y,bt=X.rightSE.point.y;if(ae<_e){if(st<Be&&st<Xe)return 1;if(st>Be&&st>Xe)return-1;let Ye=W.comparePoint(X.leftSE.point);if(Ye<0)return 1;if(Ye>0)return-1;let dt=X.comparePoint(W.rightSE.point);return dt!==0?dt:-1}if(ae>_e){if(Be<st&&Be<bt)return-1;if(Be>st&&Be>bt)return 1;let Ye=X.comparePoint(W.leftSE.point);if(Ye!==0)return Ye;let dt=W.comparePoint(X.rightSE.point);return dt<0?1:dt>0?-1:1}if(Be<st)return-1;if(Be>st)return 1;if(fe<We){let Ye=X.comparePoint(W.rightSE.point);if(Ye!==0)return Ye}if(fe>We){let Ye=W.comparePoint(X.rightSE.point);if(Ye<0)return 1;if(Ye>0)return-1}if(fe!==We){let Ye=Xe-Be,dt=fe-ae,Mt=bt-st,bi=We-_e;if(Ye>dt&&Mt<bi)return 1;if(Ye<dt&&Mt>bi)return-1}return fe>We?1:fe<We||Xe<bt?-1:Xe>bt?1:W.id<X.id?-1:W.id>X.id?1:0}constructor(W,X,ae,_e){this.id=++Ke,this.leftSE=W,W.segment=this,W.otherSE=X,this.rightSE=X,X.segment=this,X.otherSE=W,this.rings=ae,this.windings=_e}static fromRing(W,X,ae){let _e,fe,We,Be=He.comparePoints(W,X);if(Be<0)_e=W,fe=X,We=1;else if(Be>0)_e=X,fe=W,We=-1;else throw new Error("Tried to create degenerate segment at [".concat(W.x,", ").concat(W.y,"]"));let st=new He(_e,!0),Xe=new He(fe,!1);return new Tx(st,Xe,[ae],[We])}replaceRightSE(W){this.rightSE=W,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){let W=this.leftSE.point.y,X=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:W<X?W:X},ur:{x:this.rightSE.point.x,y:W>X?W:X}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(W){return W.x===this.leftSE.point.x&&W.y===this.leftSE.point.y||W.x===this.rightSE.point.x&&W.y===this.rightSE.point.y}comparePoint(W){if(this.isAnEndpoint(W))return 0;let X=this.leftSE.point,ae=this.rightSE.point,_e=this.vector();if(X.x===ae.x)return W.x===X.x?0:W.x<X.x?1:-1;let fe=(W.y-X.y)/_e.y,We=X.x+fe*_e.x;if(W.x===We)return 0;let Be=(W.x-X.x)/_e.x,st=X.y+Be*_e.y;return W.y===st?0:W.y<st?-1:1}getIntersection(W){let X=this.bbox(),ae=W.bbox(),_e=I(X,ae);if(_e===null)return null;let fe=this.leftSE.point,We=this.rightSE.point,Be=W.leftSE.point,st=W.rightSE.point,Xe=E(X,Be)&&this.comparePoint(Be)===0,bt=E(ae,fe)&&W.comparePoint(fe)===0,Ye=E(X,st)&&this.comparePoint(st)===0,dt=E(ae,We)&&W.comparePoint(We)===0;if(bt&&Xe)return dt&&!Ye?We:!dt&&Ye?st:null;if(bt)return Ye&&fe.x===st.x&&fe.y===st.y?null:fe;if(Xe)return dt&&We.x===Be.x&&We.y===Be.y?null:Be;if(dt&&Ye)return null;if(dt)return We;if(Ye)return st;let Mt=ut(fe,this.vector(),Be,W.vector());return Mt===null||!E(_e,Mt)?null:L.round(Mt.x,Mt.y)}split(W){let X=[],ae=W.events!==void 0,_e=new He(W,!0),fe=new He(W,!1),We=this.rightSE;this.replaceRightSE(fe),X.push(fe),X.push(_e);let Be=new Tx(_e,We,this.rings.slice(),this.windings.slice());return He.comparePoints(Be.leftSE.point,Be.rightSE.point)>0&&Be.swapEvents(),He.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),ae&&(_e.checkForConsuming(),fe.checkForConsuming()),X}swapEvents(){let W=this.rightSE;this.rightSE=this.leftSE,this.leftSE=W,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let X=0,ae=this.windings.length;X<ae;X++)this.windings[X]*=-1}consume(W){let X=this,ae=W;for(;X.consumedBy;)X=X.consumedBy;for(;ae.consumedBy;)ae=ae.consumedBy;let _e=Tx.compare(X,ae);if(_e!==0){if(_e>0){let fe=X;X=ae,ae=fe}if(X.prev===ae){let fe=X;X=ae,ae=fe}for(let fe=0,We=ae.rings.length;fe<We;fe++){let Be=ae.rings[fe],st=ae.windings[fe],Xe=X.rings.indexOf(Be);Xe===-1?(X.rings.push(Be),X.windings.push(st)):X.windings[Xe]+=st}ae.rings=null,ae.windings=null,ae.consumedBy=X,ae.leftSE.consumedBy=X.leftSE,ae.rightSE.consumedBy=X.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{let W=this.prev.consumedBy||this.prev;this._beforeState=W.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;let W=this.beforeState();this._afterState={rings:W.rings.slice(0),windings:W.windings.slice(0),multiPolys:[]};let X=this._afterState.rings,ae=this._afterState.windings,_e=this._afterState.multiPolys;for(let Be=0,st=this.rings.length;Be<st;Be++){let Xe=this.rings[Be],bt=this.windings[Be],Ye=X.indexOf(Xe);Ye===-1?(X.push(Xe),ae.push(bt)):ae[Ye]+=bt}let fe=[],We=[];for(let Be=0,st=X.length;Be<st;Be++){if(ae[Be]===0)continue;let Xe=X[Be],bt=Xe.poly;if(We.indexOf(bt)===-1)if(Xe.isExterior)fe.push(bt);else{We.indexOf(bt)===-1&&We.push(bt);let Ye=fe.indexOf(Xe.poly);Ye!==-1&&fe.splice(Ye,1)}}for(let Be=0,st=fe.length;Be<st;Be++){let Xe=fe[Be].multiPoly;_e.indexOf(Xe)===-1&&_e.push(Xe)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;let W=this.beforeState().multiPolys,X=this.afterState().multiPolys;switch(Re.type){case"union":{let ae=W.length===0,_e=X.length===0;this._isInResult=ae!==_e;break}case"intersection":{let ae,_e;W.length<X.length?(ae=W.length,_e=X.length):(ae=X.length,_e=W.length),this._isInResult=_e===Re.numMultiPolys&&ae<_e;break}case"xor":{let ae=Math.abs(W.length-X.length);this._isInResult=ae%2===1;break}case"difference":{let ae=l(_e=>_e.length===1&&_e[0].isSubject,"isJustSubject");this._isInResult=ae(W)!==ae(X);break}default:throw new Error("Unrecognized operation type found ".concat(Re.type))}return this._isInResult}};l(Lt,"Segment");let _t=Lt,pe=class{constructor(W,X,ae){if(!Array.isArray(W)||W.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=X,this.isExterior=ae,this.segments=[],typeof W[0][0]!="number"||typeof W[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let _e=L.round(W[0][0],W[0][1]);this.bbox={ll:{x:_e.x,y:_e.y},ur:{x:_e.x,y:_e.y}};let fe=_e;for(let We=1,Be=W.length;We<Be;We++){if(typeof W[We][0]!="number"||typeof W[We][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let st=L.round(W[We][0],W[We][1]);st.x===fe.x&&st.y===fe.y||(this.segments.push(_t.fromRing(fe,st,this)),st.x<this.bbox.ll.x&&(this.bbox.ll.x=st.x),st.y<this.bbox.ll.y&&(this.bbox.ll.y=st.y),st.x>this.bbox.ur.x&&(this.bbox.ur.x=st.x),st.y>this.bbox.ur.y&&(this.bbox.ur.y=st.y),fe=st)}(_e.x!==fe.x||_e.y!==fe.y)&&this.segments.push(_t.fromRing(fe,_e,this))}getSweepEvents(){let W=[];for(let X=0,ae=this.segments.length;X<ae;X++){let _e=this.segments[X];W.push(_e.leftSE),W.push(_e.rightSE)}return W}};l(pe,"RingIn");let re=pe,ke=class{constructor(W,X){if(!Array.isArray(W))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new re(W[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let ae=1,_e=W.length;ae<_e;ae++){let fe=new re(W[ae],this,!1);fe.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=fe.bbox.ll.x),fe.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=fe.bbox.ll.y),fe.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=fe.bbox.ur.x),fe.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=fe.bbox.ur.y),this.interiorRings.push(fe)}this.multiPoly=X}getSweepEvents(){let W=this.exteriorRing.getSweepEvents();for(let X=0,ae=this.interiorRings.length;X<ae;X++){let _e=this.interiorRings[X].getSweepEvents();for(let fe=0,We=_e.length;fe<We;fe++)W.push(_e[fe])}return W}};l(ke,"PolyIn");let at=ke,ct=class{constructor(W,X){if(!Array.isArray(W))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof W[0][0][0]=="number"&&(W=[W])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let ae=0,_e=W.length;ae<_e;ae++){let fe=new at(W[ae],this);fe.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=fe.bbox.ll.x),fe.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=fe.bbox.ll.y),fe.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=fe.bbox.ur.x),fe.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=fe.bbox.ur.y),this.polys.push(fe)}this.isSubject=X}getSweepEvents(){let W=[];for(let X=0,ae=this.polys.length;X<ae;X++){let _e=this.polys[X].getSweepEvents();for(let fe=0,We=_e.length;fe<We;fe++)W.push(_e[fe])}return W}};l(ct,"MultiPolyIn");let rt=ct,Qe=class IE{static factory(W){let X=[];for(let ae=0,_e=W.length;ae<_e;ae++){let fe=W[ae];if(!fe.isInResult()||fe.ringOut)continue;let We=null,Be=fe.leftSE,st=fe.rightSE,Xe=[Be],bt=Be.point,Ye=[];for(;We=Be,Be=st,Xe.push(Be),Be.point!==bt;)for(;;){let dt=Be.getAvailableLinkedEvents();if(dt.length===0){let ni=Xe[0].point,Ii=Xe[Xe.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(ni.x,",")+" ".concat(ni.y,"]. Last matching segment found ends at")+" [".concat(Ii.x,", ").concat(Ii.y,"]."))}if(dt.length===1){st=dt[0].otherSE;break}let Mt=null;for(let ni=0,Ii=Ye.length;ni<Ii;ni++)if(Ye[ni].point===Be.point){Mt=ni;break}if(Mt!==null){let ni=Ye.splice(Mt)[0],Ii=Xe.splice(ni.index);Ii.unshift(Ii[0].otherSE),X.push(new IE(Ii.reverse()));continue}Ye.push({index:Xe.length,point:Be.point});let bi=Be.getLeftmostComparator(We);st=dt.sort(bi)[0].otherSE;break}X.push(new IE(Xe))}return X}constructor(W){this.events=W;for(let X=0,ae=W.length;X<ae;X++)W[X].segment.ringOut=this;this.poly=null}getGeom(){let W=this.events[0].point,X=[W];for(let Xe=1,bt=this.events.length-1;Xe<bt;Xe++){let Ye=this.events[Xe].point,dt=this.events[Xe+1].point;je(Ye,W,dt)!==0&&(X.push(Ye),W=Ye)}if(X.length===1)return null;let ae=X[0],_e=X[1];je(ae,W,_e)===0&&X.shift(),X.push(X[0]);let fe=this.isExteriorRing()?1:-1,We=this.isExteriorRing()?0:X.length-1,Be=this.isExteriorRing()?X.length:-1,st=[];for(let Xe=We;Xe!=Be;Xe+=fe)st.push([X[Xe].x,X[Xe].y]);return st}isExteriorRing(){if(this._isExteriorRing===void 0){let W=this.enclosingRing();this._isExteriorRing=W?!W.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let W=this.events[0];for(let _e=1,fe=this.events.length;_e<fe;_e++){let We=this.events[_e];He.compare(W,We)>0&&(W=We)}let X=W.segment.prevInResult(),ae=X?X.prevInResult():null;for(;;){if(!X)return null;if(!ae)return X.ringOut;if(ae.ringOut!==X.ringOut)return ae.ringOut.enclosingRing()!==X.ringOut?X.ringOut:X.ringOut.enclosingRing();X=ae.prevInResult(),ae=X?X.prevInResult():null}}};l(Qe,"RingOut");let At=Qe,Dt=class{constructor(W){this.exteriorRing=W,W.poly=this,this.interiorRings=[]}addInterior(W){this.interiorRings.push(W),W.poly=this}getGeom(){let W=[this.exteriorRing.getGeom()];if(W[0]===null)return null;for(let X=0,ae=this.interiorRings.length;X<ae;X++){let _e=this.interiorRings[X].getGeom();_e!==null&&W.push(_e)}return W}};l(Dt,"PolyOut");let vt=Dt,yt=class{constructor(W){this.rings=W,this.polys=this._composePolys(W)}getGeom(){let W=[];for(let X=0,ae=this.polys.length;X<ae;X++){let _e=this.polys[X].getGeom();_e!==null&&W.push(_e)}return W}_composePolys(W){let X=[];for(let ae=0,_e=W.length;ae<_e;ae++){let fe=W[ae];if(!fe.poly)if(fe.isExteriorRing())X.push(new vt(fe));else{let We=fe.enclosingRing();We.poly||X.push(new vt(We)),We.poly.addInterior(fe)}}return X}};l(yt,"MultiPolyOut");let jt=yt,Wt=class{constructor(W){let X=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_t.compare;this.queue=W,this.tree=new d(X),this.segments=[]}process(W){let X=W.segment,ae=[];if(W.consumedBy)return W.isLeft?this.queue.remove(W.otherSE):this.tree.remove(X),ae;let _e=W.isLeft?this.tree.add(X):this.tree.find(X);if(!_e)throw new Error("Unable to find segment #".concat(X.id," ")+"[".concat(X.leftSE.point.x,", ").concat(X.leftSE.point.y,"] -> ")+"[".concat(X.rightSE.point.x,", ").concat(X.rightSE.point.y,"] ")+"in SweepLine tree.");let fe=_e,We=_e,Be,st;for(;Be===void 0;)fe=this.tree.prev(fe),fe===null?Be=null:fe.key.consumedBy===void 0&&(Be=fe.key);for(;st===void 0;)We=this.tree.next(We),We===null?st=null:We.key.consumedBy===void 0&&(st=We.key);if(W.isLeft){let Xe=null;if(Be){let Ye=Be.getIntersection(X);if(Ye!==null&&(X.isAnEndpoint(Ye)||(Xe=Ye),!Be.isAnEndpoint(Ye))){let dt=this._splitSafely(Be,Ye);for(let Mt=0,bi=dt.length;Mt<bi;Mt++)ae.push(dt[Mt])}}let bt=null;if(st){let Ye=st.getIntersection(X);if(Ye!==null&&(X.isAnEndpoint(Ye)||(bt=Ye),!st.isAnEndpoint(Ye))){let dt=this._splitSafely(st,Ye);for(let Mt=0,bi=dt.length;Mt<bi;Mt++)ae.push(dt[Mt])}}if(Xe!==null||bt!==null){let Ye=null;Xe===null?Ye=bt:bt===null?Ye=Xe:Ye=He.comparePoints(Xe,bt)<=0?Xe:bt,this.queue.remove(X.rightSE),ae.push(X.rightSE);let dt=X.split(Ye);for(let Mt=0,bi=dt.length;Mt<bi;Mt++)ae.push(dt[Mt])}ae.length>0?(this.tree.remove(X),ae.push(W)):(this.segments.push(X),X.prev=Be)}else{if(Be&&st){let Xe=Be.getIntersection(st);if(Xe!==null){if(!Be.isAnEndpoint(Xe)){let bt=this._splitSafely(Be,Xe);for(let Ye=0,dt=bt.length;Ye<dt;Ye++)ae.push(bt[Ye])}if(!st.isAnEndpoint(Xe)){let bt=this._splitSafely(st,Xe);for(let Ye=0,dt=bt.length;Ye<dt;Ye++)ae.push(bt[Ye])}}}this.tree.remove(X)}return ae}_splitSafely(W,X){this.tree.remove(W);let ae=W.rightSE;this.queue.remove(ae);let _e=W.split(X);return _e.push(ae),W.consumedBy===void 0&&this.tree.add(W),_e}};l(Wt,"SweepLine");let Kt=Wt,Vt=typeof mr<"u"&&mr.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,hi=typeof mr<"u"&&mr.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,ui=class{run(W,X,ae){Re.type=W,L.reset();let _e=[new rt(X,!0)];for(let bt=0,Ye=ae.length;bt<Ye;bt++)_e.push(new rt(ae[bt],!1));if(Re.numMultiPolys=_e.length,Re.type==="difference"){let bt=_e[0],Ye=1;for(;Ye<_e.length;)I(_e[Ye].bbox,bt.bbox)!==null?Ye++:_e.splice(Ye,1)}if(Re.type==="intersection")for(let bt=0,Ye=_e.length;bt<Ye;bt++){let dt=_e[bt];for(let Mt=bt+1,bi=_e.length;Mt<bi;Mt++)if(I(dt.bbox,_e[Mt].bbox)===null)return[]}let fe=new d(He.compare);for(let bt=0,Ye=_e.length;bt<Ye;bt++){let dt=_e[bt].getSweepEvents();for(let Mt=0,bi=dt.length;Mt<bi;Mt++)if(fe.insert(dt[Mt]),fe.size>Vt)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}let We=new Kt(fe),Be=fe.size,st=fe.pop();for(;st;){let bt=st.key;if(fe.size===Be){let dt=bt.segment;throw new Error("Unable to pop() ".concat(bt.isLeft?"left":"right"," SweepEvent ")+"[".concat(bt.point.x,", ").concat(bt.point.y,"] from segment #").concat(dt.id," ")+"[".concat(dt.leftSE.point.x,", ").concat(dt.leftSE.point.y,"] -> ")+"[".concat(dt.rightSE.point.x,", ").concat(dt.rightSE.point.y,"] from queue."))}if(fe.size>Vt)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(We.segments.length>hi)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");let Ye=We.process(bt);for(let dt=0,Mt=Ye.length;dt<Mt;dt++){let bi=Ye[dt];bi.consumedBy===void 0&&fe.insert(bi)}Be=fe.size,st=fe.pop()}L.reset();let Xe=At.factory(We.segments);return new jt(Xe).getGeom()}};l(ui,"Operation");let Zi=ui,Re=new Zi;var xt={union:l(function(me){for(var W=arguments.length,X=new Array(W>1?W-1:0),ae=1;ae<W;ae++)X[ae-1]=arguments[ae];return Re.run("union",me,X)},"union"),intersection:l(function(me){for(var W=arguments.length,X=new Array(W>1?W-1:0),ae=1;ae<W;ae++)X[ae-1]=arguments[ae];return Re.run("intersection",me,X)},"intersection"),xor:l(function(me){for(var W=arguments.length,X=new Array(W>1?W-1:0),ae=1;ae<W;ae++)X[ae-1]=arguments[ae];return Re.run("xor",me,X)},"xor"),difference:l(function(me){for(var W=arguments.length,X=new Array(W>1?W-1:0),ae=1;ae<W;ae++)X[ae-1]=arguments[ae];return Re.run("difference",me,X)},"difference")};return xt})}),Swe=Et((i,e)=>{R(),function(t,n){typeof i=="object"&&typeof e<"u"?n(i):typeof define=="function"&&define.amd?define(["exports"],n):n(t.jsts={})}(i,function(t){function n(){}l(n,"e");function r(c){this.message=c||""}l(r,"n");function a(c){this.message=c||""}l(a,"i");function o(c){this.message=c||""}l(o,"r");function s(){}l(s,"o");function u(c){return c===null?Mt:c.color}l(u,"s");function h(c){return c===null?null:c.parent}l(h,"a");function d(c,p){c!==null&&(c.color=p)}l(d,"u");function f(c){return c===null?null:c.left}l(f,"l");function m(c){return c===null?null:c.right}l(m,"c");function v(){this.root_=null,this.size_=0}l(v,"p");function b(){}l(b,"h");function w(){this.array_=[],arguments[0]instanceof xt&&this.addAll(arguments[0])}l(w,"f");function A(){}l(A,"g");function E(c){this.message=c||""}l(E,"d");function I(){this.array_=[]}l(I,"y"),"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:l(function(c){if(this===void 0||this===null)throw new TypeError(this+" is not an object");var p=Object(this),g=Math.max(Math.min(p.length,9007199254740991),0)||0,_=1 in arguments&&parseInt(Number(arguments[1]),10)||0;_=_<0?Math.max(g+_,0):Math.min(_,g);var S=2 in arguments&&arguments[2]!==void 0?parseInt(Number(arguments[2]),10)||0:g;for(S=S<0?Math.max(g+arguments[2],0):Math.min(S,g);_<S;)p[_]=c,++_;return p},"value"),writable:!0}),Number.isFinite=Number.isFinite||function(c){return typeof c=="number"&&isFinite(c)},Number.isInteger=Number.isInteger||function(c){return typeof c=="number"&&isFinite(c)&&Math.floor(c)===c},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(c){return c!=c},Math.trunc=Math.trunc||function(c){return c<0?Math.ceil(c):Math.floor(c)};var C=l(function(){},"_");C.prototype.interfaces_=function(){return[]},C.prototype.getClass=function(){return C},C.prototype.equalsWithTolerance=function(c,p,g){return Math.abs(c-p)<=g};var T=function(c){function p(g){c.call(this,g),this.name="IllegalArgumentException",this.message=g,this.stack=new c().stack}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p}(Error),k=l(function(){},"v"),F={MAX_VALUE:{configurable:!0}};k.isNaN=function(c){return Number.isNaN(c)},k.doubleToLongBits=function(c){return c},k.longBitsToDouble=function(c){return c},k.isInfinite=function(c){return!Number.isFinite(c)},F.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(k,F);var B=l(function(){},"E"),N=l(function(){},"x"),z=l(function(){},"N"),L=l(function c(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)this.x=0,this.y=0,this.z=c.NULL_ORDINATE;else if(arguments.length===1){var p=arguments[0];this.x=p.x,this.y=p.y,this.z=p.z}else arguments.length===2?(this.x=arguments[0],this.y=arguments[1],this.z=c.NULL_ORDINATE):arguments.length===3&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},"t"),j={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};L.prototype.setOrdinate=function(c,p){switch(c){case L.X:this.x=p;break;case L.Y:this.y=p;break;case L.Z:this.z=p;break;default:throw new T("Invalid ordinate index: "+c)}},L.prototype.equals2D=function(){if(arguments.length===1){var c=arguments[0];return this.x===c.x&&this.y===c.y}if(arguments.length===2){var p=arguments[0],g=arguments[1];return!!C.equalsWithTolerance(this.x,p.x,g)&&!!C.equalsWithTolerance(this.y,p.y,g)}},L.prototype.getOrdinate=function(c){switch(c){case L.X:return this.x;case L.Y:return this.y;case L.Z:return this.z}throw new T("Invalid ordinate index: "+c)},L.prototype.equals3D=function(c){return this.x===c.x&&this.y===c.y&&(this.z===c.z||k.isNaN(this.z))&&k.isNaN(c.z)},L.prototype.equals=function(c){return c instanceof L&&this.equals2D(c)},L.prototype.equalInZ=function(c,p){return C.equalsWithTolerance(this.z,c.z,p)},L.prototype.compareTo=function(c){var p=c;return this.x<p.x?-1:this.x>p.x?1:this.y<p.y?-1:this.y>p.y?1:0},L.prototype.clone=function(){},L.prototype.copy=function(){return new L(this)},L.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},L.prototype.distance3D=function(c){var p=this.x-c.x,g=this.y-c.y,_=this.z-c.z;return Math.sqrt(p*p+g*g+_*_)},L.prototype.distance=function(c){var p=this.x-c.x,g=this.y-c.y;return Math.sqrt(p*p+g*g)},L.prototype.hashCode=function(){var c=17;return c=37*c+L.hashCode(this.x),c=37*c+L.hashCode(this.y)},L.prototype.setCoordinate=function(c){this.x=c.x,this.y=c.y,this.z=c.z},L.prototype.interfaces_=function(){return[B,N,n]},L.prototype.getClass=function(){return L},L.hashCode=function(){if(arguments.length===1){var c=arguments[0],p=k.doubleToLongBits(c);return Math.trunc((p^p)>>>32)}},j.DimensionalComparator.get=function(){return q},j.serialVersionUID.get=function(){return 6683108902428367e3},j.NULL_ORDINATE.get=function(){return k.NaN},j.X.get=function(){return 0},j.Y.get=function(){return 1},j.Z.get=function(){return 2},Object.defineProperties(L,j);var q=l(function(c){if(this._dimensionsToTest=2,arguments.length!==0&&arguments.length===1){var p=arguments[0];if(p!==2&&p!==3)throw new T("only 2 or 3 dimensions may be specified");this._dimensionsToTest=p}},"L");q.prototype.compare=function(c,p){var g=c,_=p,S=q.compare(g.x,_.x);if(S!==0)return S;var U=q.compare(g.y,_.y);return U!==0?U:this._dimensionsToTest<=2?0:q.compare(g.z,_.z)},q.prototype.interfaces_=function(){return[z]},q.prototype.getClass=function(){return q},q.compare=function(c,p){return c<p?-1:c>p?1:k.isNaN(c)?k.isNaN(p)?0:-1:k.isNaN(p)?1:0};var Z=l(function(){},"b");Z.prototype.create=function(){},Z.prototype.interfaces_=function(){return[]},Z.prototype.getClass=function(){return Z};var O=l(function(){},"w"),Y={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};O.prototype.interfaces_=function(){return[]},O.prototype.getClass=function(){return O},O.toLocationSymbol=function(c){switch(c){case O.EXTERIOR:return"e";case O.BOUNDARY:return"b";case O.INTERIOR:return"i";case O.NONE:return"-"}throw new T("Unknown location value: "+c)},Y.INTERIOR.get=function(){return 0},Y.BOUNDARY.get=function(){return 1},Y.EXTERIOR.get=function(){return 2},Y.NONE.get=function(){return-1},Object.defineProperties(O,Y);var J=l(function(c,p){return c.interfaces_&&c.interfaces_().indexOf(p)>-1},"T"),oe=l(function(){},"R"),$={LOG_10:{configurable:!0}};oe.prototype.interfaces_=function(){return[]},oe.prototype.getClass=function(){return oe},oe.log10=function(c){var p=Math.log(c);return k.isInfinite(p)||k.isNaN(p)?p:p/oe.LOG_10},oe.min=function(c,p,g,_){var S=c;return p<S&&(S=p),g<S&&(S=g),_<S&&(S=_),S},oe.clamp=function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var c=arguments[0],p=arguments[1],g=arguments[2];return c<p?p:c>g?g:c}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var _=arguments[0],S=arguments[1],U=arguments[2];return _<S?S:_>U?U:_}},oe.wrap=function(c,p){return c<0?p- -c%p:c%p},oe.max=function(){if(arguments.length===3){var c=arguments[0],p=arguments[1],g=arguments[2],_=c;return p>_&&(_=p),g>_&&(_=g),_}if(arguments.length===4){var S=arguments[0],U=arguments[1],G=arguments[2],ee=arguments[3],ye=S;return U>ye&&(ye=U),G>ye&&(ye=G),ee>ye&&(ye=ee),ye}},oe.average=function(c,p){return(c+p)/2},$.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(oe,$);var K=l(function(c){this.str=c},"D");K.prototype.append=function(c){this.str+=c},K.prototype.setCharAt=function(c,p){this.str=this.str.substr(0,c)+p+this.str.substr(c+1)},K.prototype.toString=function(c){return this.str};var te=l(function(c){this.value=c},"M");te.prototype.intValue=function(){return this.value},te.prototype.compareTo=function(c){return this.value<c?-1:this.value>c?1:0},te.isNaN=function(c){return Number.isNaN(c)};var ve=l(function(){},"A");ve.isWhitespace=function(c){return c<=32&&c>=0||c===127},ve.toUpperCase=function(c){return c.toUpperCase()};var Q=l(function c(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var p=arguments[0];this.init(p)}else if(arguments[0]instanceof c){var g=arguments[0];this.init(g)}else if(typeof arguments[0]=="string"){var _=arguments[0];c.call(this,c.parse(_))}}else if(arguments.length===2){var S=arguments[0],U=arguments[1];this.init(S,U)}},"t"),he={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};Q.prototype.le=function(c){return(this._hi<c._hi||this._hi===c._hi)&&this._lo<=c._lo},Q.prototype.extractSignificantDigits=function(c,p){var g=this.abs(),_=Q.magnitude(g._hi),S=Q.TEN.pow(_);(g=g.divide(S)).gt(Q.TEN)?(g=g.divide(Q.TEN),_+=1):g.lt(Q.ONE)&&(g=g.multiply(Q.TEN),_-=1);for(var U=_+1,G=new K,ee=Q.MAX_PRINT_DIGITS-1,ye=0;ye<=ee;ye++){c&&ye===U&&G.append(".");var Te=Math.trunc(g._hi);if(Te<0)break;var et=!1,it=0;Te>9?(et=!0,it="9"):it="0"+Te,G.append(it),g=g.subtract(Q.valueOf(Te)).multiply(Q.TEN),et&&g.selfAdd(Q.TEN);var kt=!0,zt=Q.magnitude(g._hi);if(zt<0&&Math.abs(zt)>=ee-ye&&(kt=!1),!kt)break}return p[0]=_,G.toString()},Q.prototype.sqr=function(){return this.multiply(this)},Q.prototype.doubleValue=function(){return this._hi+this._lo},Q.prototype.subtract=function(){if(arguments[0]instanceof Q){var c=arguments[0];return this.add(c.negate())}if(typeof arguments[0]=="number"){var p=arguments[0];return this.add(-p)}},Q.prototype.equals=function(){if(arguments.length===1){var c=arguments[0];return this._hi===c._hi&&this._lo===c._lo}},Q.prototype.isZero=function(){return this._hi===0&&this._lo===0},Q.prototype.selfSubtract=function(){if(arguments[0]instanceof Q){var c=arguments[0];return this.isNaN()?this:this.selfAdd(-c._hi,-c._lo)}if(typeof arguments[0]=="number"){var p=arguments[0];return this.isNaN()?this:this.selfAdd(-p,0)}},Q.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},Q.prototype.min=function(c){return this.le(c)?this:c},Q.prototype.selfDivide=function(){if(arguments.length===1){if(arguments[0]instanceof Q){var c=arguments[0];return this.selfDivide(c._hi,c._lo)}if(typeof arguments[0]=="number"){var p=arguments[0];return this.selfDivide(p,0)}}else if(arguments.length===2){var g=arguments[0],_=arguments[1],S=null,U=null,G=null,ee=null,ye=null,Te=null,et=null,it=null;return ye=this._hi/g,Te=Q.SPLIT*ye,S=Te-ye,it=Q.SPLIT*g,S=Te-S,U=ye-S,G=it-g,et=ye*g,G=it-G,ee=g-G,it=S*G-et+S*ee+U*G+U*ee,Te=(this._hi-et-it+this._lo-ye*_)/g,it=ye+Te,this._hi=it,this._lo=ye-it+Te,this}},Q.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},Q.prototype.divide=function(){if(arguments[0]instanceof Q){var c=arguments[0],p=null,g=null,_=null,S=null,U=null,G=null,ee=null,ye=null;return g=(U=this._hi/c._hi)-(p=(G=Q.SPLIT*U)-(p=G-U)),ye=p*(_=(ye=Q.SPLIT*c._hi)-(_=ye-c._hi))-(ee=U*c._hi)+p*(S=c._hi-_)+g*_+g*S,G=(this._hi-ee-ye+this._lo-U*c._lo)/c._hi,new Q(ye=U+G,U-ye+G)}if(typeof arguments[0]=="number"){var Te=arguments[0];return k.isNaN(Te)?Q.createNaN():Q.copy(this).selfDivide(Te,0)}},Q.prototype.ge=function(c){return(this._hi>c._hi||this._hi===c._hi)&&this._lo>=c._lo},Q.prototype.pow=function(c){if(c===0)return Q.valueOf(1);var p=new Q(this),g=Q.valueOf(1),_=Math.abs(c);if(_>1)for(;_>0;)_%2==1&&g.selfMultiply(p),(_/=2)>0&&(p=p.sqr());else g=p;return c<0?g.reciprocal():g},Q.prototype.ceil=function(){if(this.isNaN())return Q.NaN;var c=Math.ceil(this._hi),p=0;return c===this._hi&&(p=Math.ceil(this._lo)),new Q(c,p)},Q.prototype.compareTo=function(c){var p=c;return this._hi<p._hi?-1:this._hi>p._hi?1:this._lo<p._lo?-1:this._lo>p._lo?1:0},Q.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},Q.prototype.setValue=function(){if(arguments[0]instanceof Q){var c=arguments[0];return this.init(c),this}if(typeof arguments[0]=="number"){var p=arguments[0];return this.init(p),this}},Q.prototype.max=function(c){return this.ge(c)?this:c},Q.prototype.sqrt=function(){if(this.isZero())return Q.valueOf(0);if(this.isNegative())return Q.NaN;var c=1/Math.sqrt(this._hi),p=this._hi*c,g=Q.valueOf(p),_=this.subtract(g.sqr())._hi*(.5*c);return g.add(_)},Q.prototype.selfAdd=function(){if(arguments.length===1){if(arguments[0]instanceof Q){var c=arguments[0];return this.selfAdd(c._hi,c._lo)}if(typeof arguments[0]=="number"){var p=arguments[0],g=null,_=null,S=null,U=null,G=null,ee=null;return S=this._hi+p,G=S-this._hi,U=S-G,U=p-G+(this._hi-U),ee=U+this._lo,g=S+ee,_=ee+(S-g),this._hi=g+_,this._lo=_+(g-this._hi),this}}else if(arguments.length===2){var ye=arguments[0],Te=arguments[1],et=null,it=null,kt=null,zt=null,Yt=null,wi=null,En=null;zt=this._hi+ye,it=this._lo+Te,Yt=zt-(wi=zt-this._hi),kt=it-(En=it-this._lo);var wr=(et=zt+(wi=(Yt=ye-wi+(this._hi-Yt))+it))+(wi=(kt=Te-En+(this._lo-kt))+(wi+(zt-et))),La=wi+(et-wr);return this._hi=wr,this._lo=La,this}},Q.prototype.selfMultiply=function(){if(arguments.length===1){if(arguments[0]instanceof Q){var c=arguments[0];return this.selfMultiply(c._hi,c._lo)}if(typeof arguments[0]=="number"){var p=arguments[0];return this.selfMultiply(p,0)}}else if(arguments.length===2){var g=arguments[0],_=arguments[1],S=null,U=null,G=null,ee=null,ye=null,Te=null;S=(ye=Q.SPLIT*this._hi)-this._hi,Te=Q.SPLIT*g,S=ye-S,U=this._hi-S,G=Te-g;var et=(ye=this._hi*g)+(Te=S*(G=Te-G)-ye+S*(ee=g-G)+U*G+U*ee+(this._hi*_+this._lo*g)),it=Te+(S=ye-et);return this._hi=et,this._lo=it,this}},Q.prototype.selfSqr=function(){return this.selfMultiply(this)},Q.prototype.floor=function(){if(this.isNaN())return Q.NaN;var c=Math.floor(this._hi),p=0;return c===this._hi&&(p=Math.floor(this._lo)),new Q(c,p)},Q.prototype.negate=function(){return this.isNaN()?this:new Q(-this._hi,-this._lo)},Q.prototype.clone=function(){},Q.prototype.multiply=function(){if(arguments[0]instanceof Q){var c=arguments[0];return c.isNaN()?Q.createNaN():Q.copy(this).selfMultiply(c)}if(typeof arguments[0]=="number"){var p=arguments[0];return k.isNaN(p)?Q.createNaN():Q.copy(this).selfMultiply(p,0)}},Q.prototype.isNaN=function(){return k.isNaN(this._hi)},Q.prototype.intValue=function(){return Math.trunc(this._hi)},Q.prototype.toString=function(){var c=Q.magnitude(this._hi);return c>=-3&&c<=20?this.toStandardNotation():this.toSciNotation()},Q.prototype.toStandardNotation=function(){var c=this.getSpecialNumberString();if(c!==null)return c;var p=new Array(1).fill(null),g=this.extractSignificantDigits(!0,p),_=p[0]+1,S=g;if(g.charAt(0)===".")S="0"+g;else if(_<0)S="0."+Q.stringOfChar("0",-_)+g;else if(g.indexOf(".")===-1){var U=_-g.length;S=g+Q.stringOfChar("0",U)+".0"}return this.isNegative()?"-"+S:S},Q.prototype.reciprocal=function(){var c=null,p=null,g=null,_=null,S=null,U=null,G=null,ee=null;p=(S=1/this._hi)-(c=(U=Q.SPLIT*S)-(c=U-S)),g=(ee=Q.SPLIT*this._hi)-this._hi;var ye=S+(U=(1-(G=S*this._hi)-(ee=c*(g=ee-g)-G+c*(_=this._hi-g)+p*g+p*_)-S*this._lo)/this._hi);return new Q(ye,S-ye+U)},Q.prototype.toSciNotation=function(){if(this.isZero())return Q.SCI_NOT_ZERO;var c=this.getSpecialNumberString();if(c!==null)return c;var p=new Array(1).fill(null),g=this.extractSignificantDigits(!1,p),_=Q.SCI_NOT_EXPONENT_CHAR+p[0];if(g.charAt(0)==="0")throw new Error("Found leading zero: "+g);var S="";g.length>1&&(S=g.substring(1));var U=g.charAt(0)+"."+S;return this.isNegative()?"-"+U+_:U+_},Q.prototype.abs=function(){return this.isNaN()?Q.NaN:this.isNegative()?this.negate():new Q(this)},Q.prototype.isPositive=function(){return(this._hi>0||this._hi===0)&&this._lo>0},Q.prototype.lt=function(c){return(this._hi<c._hi||this._hi===c._hi)&&this._lo<c._lo},Q.prototype.add=function(){if(arguments[0]instanceof Q){var c=arguments[0];return Q.copy(this).selfAdd(c)}if(typeof arguments[0]=="number"){var p=arguments[0];return Q.copy(this).selfAdd(p)}},Q.prototype.init=function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var c=arguments[0];this._hi=c,this._lo=0}else if(arguments[0]instanceof Q){var p=arguments[0];this._hi=p._hi,this._lo=p._lo}}else if(arguments.length===2){var g=arguments[0],_=arguments[1];this._hi=g,this._lo=_}},Q.prototype.gt=function(c){return(this._hi>c._hi||this._hi===c._hi)&&this._lo>c._lo},Q.prototype.isNegative=function(){return(this._hi<0||this._hi===0)&&this._lo<0},Q.prototype.trunc=function(){return this.isNaN()?Q.NaN:this.isPositive()?this.floor():this.ceil()},Q.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},Q.prototype.interfaces_=function(){return[n,B,N]},Q.prototype.getClass=function(){return Q},Q.sqr=function(c){return Q.valueOf(c).selfMultiply(c)},Q.valueOf=function(){if(typeof arguments[0]=="string"){var c=arguments[0];return Q.parse(c)}if(typeof arguments[0]=="number"){var p=arguments[0];return new Q(p)}},Q.sqrt=function(c){return Q.valueOf(c).sqrt()},Q.parse=function(c){for(var p=0,g=c.length;ve.isWhitespace(c.charAt(p));)p++;var _=!1;if(p<g){var S=c.charAt(p);S!=="-"&&S!=="+"||(p++,S==="-"&&(_=!0))}for(var U=new Q,G=0,ee=0,ye=0;!(p>=g);){var Te=c.charAt(p);if(p++,ve.isDigit(Te)){var et=Te-"0";U.selfMultiply(Q.TEN),U.selfAdd(et),G++}else{if(Te!=="."){if(Te==="e"||Te==="E"){var it=c.substring(p);try{ye=te.parseInt(it)}catch(En){throw En instanceof Error?new Error("Invalid exponent "+it+" in string "+c):En}break}throw new Error("Unexpected character '"+Te+"' at position "+p+" in string "+c)}ee=G}}var kt=U,zt=G-ee-ye;if(zt===0)kt=U;else if(zt>0){var Yt=Q.TEN.pow(zt);kt=U.divide(Yt)}else if(zt<0){var wi=Q.TEN.pow(-zt);kt=U.multiply(wi)}return _?kt.negate():kt},Q.createNaN=function(){return new Q(k.NaN,k.NaN)},Q.copy=function(c){return new Q(c)},Q.magnitude=function(c){var p=Math.abs(c),g=Math.log(p)/Math.log(10),_=Math.trunc(Math.floor(g));return 10*Math.pow(10,_)<=p&&(_+=1),_},Q.stringOfChar=function(c,p){for(var g=new K,_=0;_<p;_++)g.append(c);return g.toString()},he.PI.get=function(){return new Q(3.141592653589793,12246467991473532e-32)},he.TWO_PI.get=function(){return new Q(6.283185307179586,24492935982947064e-32)},he.PI_2.get=function(){return new Q(1.5707963267948966,6123233995736766e-32)},he.E.get=function(){return new Q(2.718281828459045,14456468917292502e-32)},he.NaN.get=function(){return new Q(k.NaN,k.NaN)},he.EPS.get=function(){return 123259516440783e-46},he.SPLIT.get=function(){return 134217729},he.MAX_PRINT_DIGITS.get=function(){return 32},he.TEN.get=function(){return Q.valueOf(10)},he.ONE.get=function(){return Q.valueOf(1)},he.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},he.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(Q,he);var se=l(function(){},"q"),Ae={DP_SAFE_EPSILON:{configurable:!0}};se.prototype.interfaces_=function(){return[]},se.prototype.getClass=function(){return se},se.orientationIndex=function(c,p,g){var _=se.orientationIndexFilter(c,p,g);if(_<=1)return _;var S=Q.valueOf(p.x).selfAdd(-c.x),U=Q.valueOf(p.y).selfAdd(-c.y),G=Q.valueOf(g.x).selfAdd(-p.x),ee=Q.valueOf(g.y).selfAdd(-p.y);return S.selfMultiply(ee).selfSubtract(U.selfMultiply(G)).signum()},se.signOfDet2x2=function(c,p,g,_){return c.multiply(_).selfSubtract(p.multiply(g)).signum()},se.intersection=function(c,p,g,_){var S=Q.valueOf(_.y).selfSubtract(g.y).selfMultiply(Q.valueOf(p.x).selfSubtract(c.x)),U=Q.valueOf(_.x).selfSubtract(g.x).selfMultiply(Q.valueOf(p.y).selfSubtract(c.y)),G=S.subtract(U),ee=Q.valueOf(_.x).selfSubtract(g.x).selfMultiply(Q.valueOf(c.y).selfSubtract(g.y)),ye=Q.valueOf(_.y).selfSubtract(g.y).selfMultiply(Q.valueOf(c.x).selfSubtract(g.x)),Te=ee.subtract(ye).selfDivide(G).doubleValue(),et=Q.valueOf(c.x).selfAdd(Q.valueOf(p.x).selfSubtract(c.x).selfMultiply(Te)).doubleValue(),it=Q.valueOf(p.x).selfSubtract(c.x).selfMultiply(Q.valueOf(c.y).selfSubtract(g.y)),kt=Q.valueOf(p.y).selfSubtract(c.y).selfMultiply(Q.valueOf(c.x).selfSubtract(g.x)),zt=it.subtract(kt).selfDivide(G).doubleValue(),Yt=Q.valueOf(g.y).selfAdd(Q.valueOf(_.y).selfSubtract(g.y).selfMultiply(zt)).doubleValue();return new L(et,Yt)},se.orientationIndexFilter=function(c,p,g){var _=null,S=(c.x-g.x)*(p.y-g.y),U=(c.y-g.y)*(p.x-g.x),G=S-U;if(S>0){if(U<=0)return se.signum(G);_=S+U}else{if(!(S<0)||U>=0)return se.signum(G);_=-S-U}var ee=se.DP_SAFE_EPSILON*_;return G>=ee||-G>=ee?se.signum(G):2},se.signum=function(c){return c>0?1:c<0?-1:0},Ae.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(se,Ae);var Ie=l(function(){},"V"),we={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};we.X.get=function(){return 0},we.Y.get=function(){return 1},we.Z.get=function(){return 2},we.M.get=function(){return 3},Ie.prototype.setOrdinate=function(c,p,g){},Ie.prototype.size=function(){},Ie.prototype.getOrdinate=function(c,p){},Ie.prototype.getCoordinate=function(){},Ie.prototype.getCoordinateCopy=function(c){},Ie.prototype.getDimension=function(){},Ie.prototype.getX=function(c){},Ie.prototype.clone=function(){},Ie.prototype.expandEnvelope=function(c){},Ie.prototype.copy=function(){},Ie.prototype.getY=function(c){},Ie.prototype.toCoordinateArray=function(){},Ie.prototype.interfaces_=function(){return[N]},Ie.prototype.getClass=function(){return Ie},Object.defineProperties(Ie,we);var Ne=l(function(){},"z"),je=function(c){function p(){c.call(this,"Projective point not representable on the Cartesian plane.")}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.interfaces_=function(){return[]},p.prototype.getClass=function(){return p},p}(Ne),Ve=l(function(){},"Y");Ve.arraycopy=function(c,p,g,_,S){for(var U=0,G=p;G<p+S;G++)g[_+U]=c[G],U++},Ve.getProperty=function(c){return{"line.separator":`
`}[c]};var Le=l(function c(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var p=arguments[0];this.x=p.x,this.y=p.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var g=arguments[0],_=arguments[1];this.x=g,this.y=_,this.w=1}else if(arguments[0]instanceof c&&arguments[1]instanceof c){var S=arguments[0],U=arguments[1];this.x=S.y*U.w-U.y*S.w,this.y=U.x*S.w-S.x*U.w,this.w=S.x*U.y-U.x*S.y}else if(arguments[0]instanceof L&&arguments[1]instanceof L){var G=arguments[0],ee=arguments[1];this.x=G.y-ee.y,this.y=ee.x-G.x,this.w=G.x*ee.y-ee.x*G.y}}else if(arguments.length===3){var ye=arguments[0],Te=arguments[1],et=arguments[2];this.x=ye,this.y=Te,this.w=et}else if(arguments.length===4){var it=arguments[0],kt=arguments[1],zt=arguments[2],Yt=arguments[3],wi=it.y-kt.y,En=kt.x-it.x,wr=it.x*kt.y-kt.x*it.y,La=zt.y-Yt.y,Xs=Yt.x-zt.x,Eu=zt.x*Yt.y-Yt.x*zt.y;this.x=En*Eu-Xs*wr,this.y=La*wr-wi*Eu,this.w=wi*Xs-La*En}},"t");Le.prototype.getY=function(){var c=this.y/this.w;if(k.isNaN(c)||k.isInfinite(c))throw new je;return c},Le.prototype.getX=function(){var c=this.x/this.w;if(k.isNaN(c)||k.isInfinite(c))throw new je;return c},Le.prototype.getCoordinate=function(){var c=new L;return c.x=this.getX(),c.y=this.getY(),c},Le.prototype.interfaces_=function(){return[]},Le.prototype.getClass=function(){return Le},Le.intersection=function(c,p,g,_){var S=c.y-p.y,U=p.x-c.x,G=c.x*p.y-p.x*c.y,ee=g.y-_.y,ye=_.x-g.x,Te=g.x*_.y-_.x*g.y,et=S*ye-ee*U,it=(U*Te-ye*G)/et,kt=(ee*G-S*Te)/et;if(k.isNaN(it)||k.isInfinite(it)||k.isNaN(kt)||k.isInfinite(kt))throw new je;return new L(it,kt)};var xe=l(function c(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof L){var p=arguments[0];this.init(p.x,p.x,p.y,p.y)}else if(arguments[0]instanceof c){var g=arguments[0];this.init(g)}}else if(arguments.length===2){var _=arguments[0],S=arguments[1];this.init(_.x,S.x,_.y,S.y)}else if(arguments.length===4){var U=arguments[0],G=arguments[1],ee=arguments[2],ye=arguments[3];this.init(U,G,ee,ye)}},"t"),Ue={serialVersionUID:{configurable:!0}};xe.prototype.getArea=function(){return this.getWidth()*this.getHeight()},xe.prototype.equals=function(c){if(!(c instanceof xe))return!1;var p=c;return this.isNull()?p.isNull():this._maxx===p.getMaxX()&&this._maxy===p.getMaxY()&&this._minx===p.getMinX()&&this._miny===p.getMinY()},xe.prototype.intersection=function(c){if(this.isNull()||c.isNull()||!this.intersects(c))return new xe;var p=this._minx>c._minx?this._minx:c._minx,g=this._miny>c._miny?this._miny:c._miny,_=this._maxx<c._maxx?this._maxx:c._maxx,S=this._maxy<c._maxy?this._maxy:c._maxy;return new xe(p,_,g,S)},xe.prototype.isNull=function(){return this._maxx<this._minx},xe.prototype.getMaxX=function(){return this._maxx},xe.prototype.covers=function(){if(arguments.length===1){if(arguments[0]instanceof L){var c=arguments[0];return this.covers(c.x,c.y)}if(arguments[0]instanceof xe){var p=arguments[0];return!this.isNull()&&!p.isNull()&&p.getMinX()>=this._minx&&p.getMaxX()<=this._maxx&&p.getMinY()>=this._miny&&p.getMaxY()<=this._maxy}}else if(arguments.length===2){var g=arguments[0],_=arguments[1];return!this.isNull()&&g>=this._minx&&g<=this._maxx&&_>=this._miny&&_<=this._maxy}},xe.prototype.intersects=function(){if(arguments.length===1){if(arguments[0]instanceof xe){var c=arguments[0];return!this.isNull()&&!c.isNull()&&!(c._minx>this._maxx||c._maxx<this._minx||c._miny>this._maxy||c._maxy<this._miny)}if(arguments[0]instanceof L){var p=arguments[0];return this.intersects(p.x,p.y)}}else if(arguments.length===2){var g=arguments[0],_=arguments[1];return!this.isNull()&&!(g>this._maxx||g<this._minx||_>this._maxy||_<this._miny)}},xe.prototype.getMinY=function(){return this._miny},xe.prototype.getMinX=function(){return this._minx},xe.prototype.expandToInclude=function(){if(arguments.length===1){if(arguments[0]instanceof L){var c=arguments[0];this.expandToInclude(c.x,c.y)}else if(arguments[0]instanceof xe){var p=arguments[0];if(p.isNull())return null;this.isNull()?(this._minx=p.getMinX(),this._maxx=p.getMaxX(),this._miny=p.getMinY(),this._maxy=p.getMaxY()):(p._minx<this._minx&&(this._minx=p._minx),p._maxx>this._maxx&&(this._maxx=p._maxx),p._miny<this._miny&&(this._miny=p._miny),p._maxy>this._maxy&&(this._maxy=p._maxy))}}else if(arguments.length===2){var g=arguments[0],_=arguments[1];this.isNull()?(this._minx=g,this._maxx=g,this._miny=_,this._maxy=_):(g<this._minx&&(this._minx=g),g>this._maxx&&(this._maxx=g),_<this._miny&&(this._miny=_),_>this._maxy&&(this._maxy=_))}},xe.prototype.minExtent=function(){if(this.isNull())return 0;var c=this.getWidth(),p=this.getHeight();return c<p?c:p},xe.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},xe.prototype.compareTo=function(c){var p=c;return this.isNull()?p.isNull()?0:-1:p.isNull()?1:this._minx<p._minx?-1:this._minx>p._minx?1:this._miny<p._miny?-1:this._miny>p._miny?1:this._maxx<p._maxx?-1:this._maxx>p._maxx?1:this._maxy<p._maxy?-1:this._maxy>p._maxy?1:0},xe.prototype.translate=function(c,p){if(this.isNull())return null;this.init(this.getMinX()+c,this.getMaxX()+c,this.getMinY()+p,this.getMaxY()+p)},xe.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},xe.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},xe.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},xe.prototype.maxExtent=function(){if(this.isNull())return 0;var c=this.getWidth(),p=this.getHeight();return c>p?c:p},xe.prototype.expandBy=function(){if(arguments.length===1){var c=arguments[0];this.expandBy(c,c)}else if(arguments.length===2){var p=arguments[0],g=arguments[1];if(this.isNull())return null;this._minx-=p,this._maxx+=p,this._miny-=g,this._maxy+=g,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},xe.prototype.contains=function(){if(arguments.length===1){if(arguments[0]instanceof xe){var c=arguments[0];return this.covers(c)}if(arguments[0]instanceof L){var p=arguments[0];return this.covers(p)}}else if(arguments.length===2){var g=arguments[0],_=arguments[1];return this.covers(g,_)}},xe.prototype.centre=function(){return this.isNull()?null:new L((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},xe.prototype.init=function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof L){var c=arguments[0];this.init(c.x,c.x,c.y,c.y)}else if(arguments[0]instanceof xe){var p=arguments[0];this._minx=p._minx,this._maxx=p._maxx,this._miny=p._miny,this._maxy=p._maxy}}else if(arguments.length===2){var g=arguments[0],_=arguments[1];this.init(g.x,_.x,g.y,_.y)}else if(arguments.length===4){var S=arguments[0],U=arguments[1],G=arguments[2],ee=arguments[3];S<U?(this._minx=S,this._maxx=U):(this._minx=U,this._maxx=S),G<ee?(this._miny=G,this._maxy=ee):(this._miny=ee,this._maxy=G)}},xe.prototype.getMaxY=function(){return this._maxy},xe.prototype.distance=function(c){if(this.intersects(c))return 0;var p=0;this._maxx<c._minx?p=c._minx-this._maxx:this._minx>c._maxx&&(p=this._minx-c._maxx);var g=0;return this._maxy<c._miny?g=c._miny-this._maxy:this._miny>c._maxy&&(g=this._miny-c._maxy),p===0?g:g===0?p:Math.sqrt(p*p+g*g)},xe.prototype.hashCode=function(){var c=17;return c=37*c+L.hashCode(this._minx),c=37*c+L.hashCode(this._maxx),c=37*c+L.hashCode(this._miny),c=37*c+L.hashCode(this._maxy)},xe.prototype.interfaces_=function(){return[B,n]},xe.prototype.getClass=function(){return xe},xe.intersects=function(){if(arguments.length===3){var c=arguments[0],p=arguments[1],g=arguments[2];return g.x>=(c.x<p.x?c.x:p.x)&&g.x<=(c.x>p.x?c.x:p.x)&&g.y>=(c.y<p.y?c.y:p.y)&&g.y<=(c.y>p.y?c.y:p.y)}if(arguments.length===4){var _=arguments[0],S=arguments[1],U=arguments[2],G=arguments[3],ee=Math.min(U.x,G.x),ye=Math.max(U.x,G.x),Te=Math.min(_.x,S.x),et=Math.max(_.x,S.x);return!(Te>ye)&&!(et<ee)&&(ee=Math.min(U.y,G.y),ye=Math.max(U.y,G.y),Te=Math.min(_.y,S.y),et=Math.max(_.y,S.y),!(Te>ye)&&!(et<ee))}},Ue.serialVersionUID.get=function(){return 5873921885273102e3},Object.defineProperties(xe,Ue);var de={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},ut=l(function(c){this.geometryFactory=c||new _i},"K");ut.prototype.read=function(c){var p,g,_;c=c.replace(/[\n\r]/g," ");var S=de.typeStr.exec(c);if(c.search("EMPTY")!==-1&&((S=de.emptyTypeStr.exec(c))[2]=void 0),S&&(g=S[1].toLowerCase(),_=S[2],He[g]&&(p=He[g].apply(this,[_]))),p===void 0)throw new Error("Could not parse WKT "+c);return p},ut.prototype.write=function(c){return this.extractGeometry(c)},ut.prototype.extractGeometry=function(c){var p=c.getGeometryType().toLowerCase();if(!ot[p])return null;var g=p.toUpperCase();return c.isEmpty()?g+" EMPTY":g+"("+ot[p].apply(this,[c])+")"};var ot={coordinate:l(function(c){return c.x+" "+c.y},"coordinate"),point:l(function(c){return ot.coordinate.call(this,c._coordinates._coordinates[0])},"point"),multipoint:l(function(c){for(var p=[],g=0,_=c._geometries.length;g<_;++g)p.push("("+ot.point.apply(this,[c._geometries[g]])+")");return p.join(",")},"multipoint"),linestring:l(function(c){for(var p=[],g=0,_=c._points._coordinates.length;g<_;++g)p.push(ot.coordinate.apply(this,[c._points._coordinates[g]]));return p.join(",")},"linestring"),linearring:l(function(c){for(var p=[],g=0,_=c._points._coordinates.length;g<_;++g)p.push(ot.coordinate.apply(this,[c._points._coordinates[g]]));return p.join(",")},"linearring"),multilinestring:l(function(c){for(var p=[],g=0,_=c._geometries.length;g<_;++g)p.push("("+ot.linestring.apply(this,[c._geometries[g]])+")");return p.join(",")},"multilinestring"),polygon:l(function(c){var p=[];p.push("("+ot.linestring.apply(this,[c._shell])+")");for(var g=0,_=c._holes.length;g<_;++g)p.push("("+ot.linestring.apply(this,[c._holes[g]])+")");return p.join(",")},"polygon"),multipolygon:l(function(c){for(var p=[],g=0,_=c._geometries.length;g<_;++g)p.push("("+ot.polygon.apply(this,[c._geometries[g]])+")");return p.join(",")},"multipolygon"),geometrycollection:l(function(c){for(var p=[],g=0,_=c._geometries.length;g<_;++g)p.push(this.extractGeometry(c._geometries[g]));return p.join(",")},"geometrycollection")},He={point:l(function(c){if(c===void 0)return this.geometryFactory.createPoint();var p=c.trim().split(de.spaces);return this.geometryFactory.createPoint(new L(Number.parseFloat(p[0]),Number.parseFloat(p[1])))},"point"),multipoint:l(function(c){if(c===void 0)return this.geometryFactory.createMultiPoint();for(var p,g=c.trim().split(","),_=[],S=0,U=g.length;S<U;++S)p=g[S].replace(de.trimParens,"$1"),_.push(He.point.apply(this,[p]));return this.geometryFactory.createMultiPoint(_)},"multipoint"),linestring:l(function(c){if(c===void 0)return this.geometryFactory.createLineString();for(var p,g=c.trim().split(","),_=[],S=0,U=g.length;S<U;++S)p=g[S].trim().split(de.spaces),_.push(new L(Number.parseFloat(p[0]),Number.parseFloat(p[1])));return this.geometryFactory.createLineString(_)},"linestring"),linearring:l(function(c){if(c===void 0)return this.geometryFactory.createLinearRing();for(var p,g=c.trim().split(","),_=[],S=0,U=g.length;S<U;++S)p=g[S].trim().split(de.spaces),_.push(new L(Number.parseFloat(p[0]),Number.parseFloat(p[1])));return this.geometryFactory.createLinearRing(_)},"linearring"),multilinestring:l(function(c){if(c===void 0)return this.geometryFactory.createMultiLineString();for(var p,g=c.trim().split(de.parenComma),_=[],S=0,U=g.length;S<U;++S)p=g[S].replace(de.trimParens,"$1"),_.push(He.linestring.apply(this,[p]));return this.geometryFactory.createMultiLineString(_)},"multilinestring"),polygon:l(function(c){if(c===void 0)return this.geometryFactory.createPolygon();for(var p,g,_,S,U=c.trim().split(de.parenComma),G=[],ee=0,ye=U.length;ee<ye;++ee)p=U[ee].replace(de.trimParens,"$1"),g=He.linestring.apply(this,[p]),_=this.geometryFactory.createLinearRing(g._points),ee===0?S=_:G.push(_);return this.geometryFactory.createPolygon(S,G)},"polygon"),multipolygon:l(function(c){if(c===void 0)return this.geometryFactory.createMultiPolygon();for(var p,g=c.trim().split(de.doubleParenComma),_=[],S=0,U=g.length;S<U;++S)p=g[S].replace(de.trimParens,"$1"),_.push(He.polygon.apply(this,[p]));return this.geometryFactory.createMultiPolygon(_)},"multipolygon"),geometrycollection:l(function(c){if(c===void 0)return this.geometryFactory.createGeometryCollection();for(var p=(c=c.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),g=[],_=0,S=p.length;_<S;++_)g.push(this.read(p[_]));return this.geometryFactory.createGeometryCollection(g)},"geometrycollection")},Ke=l(function(c){this.parser=new ut(c)},"Z");Ke.prototype.write=function(c){return this.parser.write(c)},Ke.toLineString=function(c,p){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+c.x+" "+c.y+", "+p.x+" "+p.y+" )"};var Lt=function(c){function p(g){c.call(this,g),this.name="RuntimeException",this.message=g,this.stack=new c().stack}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p}(Error),_t=function(c){function p(){if(c.call(this),arguments.length===0)c.call(this);else if(arguments.length===1){var g=arguments[0];c.call(this,g)}}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.interfaces_=function(){return[]},p.prototype.getClass=function(){return p},p}(Lt),pe=l(function(){},"et");pe.prototype.interfaces_=function(){return[]},pe.prototype.getClass=function(){return pe},pe.shouldNeverReachHere=function(){if(arguments.length===0)pe.shouldNeverReachHere(null);else if(arguments.length===1){var c=arguments[0];throw new _t("Should never reach here"+(c!==null?": "+c:""))}},pe.isTrue=function(){var c,p;if(arguments.length===1)c=arguments[0],pe.isTrue(c,null);else if(arguments.length===2&&(c=arguments[0],p=arguments[1],!c))throw p===null?new _t:new _t(p)},pe.equals=function(){var c,p,g;if(arguments.length===2)c=arguments[0],p=arguments[1],pe.equals(c,p,null);else if(arguments.length===3&&(c=arguments[0],p=arguments[1],g=arguments[2],!p.equals(c)))throw new _t("Expected "+c+" but encountered "+p+(g!==null?": "+g:""))};var re=l(function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new L,this._intPt[1]=new L,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},"nt"),ke={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};re.prototype.getIndexAlongSegment=function(c,p){return this.computeIntLineIndex(),this._intLineIndex[c][p]},re.prototype.getTopologySummary=function(){var c=new K;return this.isEndPoint()&&c.append(" endpoint"),this._isProper&&c.append(" proper"),this.isCollinear()&&c.append(" collinear"),c.toString()},re.prototype.computeIntersection=function(c,p,g,_){this._inputLines[0][0]=c,this._inputLines[0][1]=p,this._inputLines[1][0]=g,this._inputLines[1][1]=_,this._result=this.computeIntersect(c,p,g,_)},re.prototype.getIntersectionNum=function(){return this._result},re.prototype.computeIntLineIndex=function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var c=arguments[0];this.getEdgeDistance(c,0)>this.getEdgeDistance(c,1)?(this._intLineIndex[c][0]=0,this._intLineIndex[c][1]=1):(this._intLineIndex[c][0]=1,this._intLineIndex[c][1]=0)}},re.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},re.prototype.setPrecisionModel=function(c){this._precisionModel=c},re.prototype.isInteriorIntersection=function(){if(arguments.length===0)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(arguments.length===1){for(var c=arguments[0],p=0;p<this._result;p++)if(!this._intPt[p].equals2D(this._inputLines[c][0])&&!this._intPt[p].equals2D(this._inputLines[c][1]))return!0;return!1}},re.prototype.getIntersection=function(c){return this._intPt[c]},re.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},re.prototype.hasIntersection=function(){return this._result!==re.NO_INTERSECTION},re.prototype.getEdgeDistance=function(c,p){return re.computeEdgeDistance(this._intPt[p],this._inputLines[c][0],this._inputLines[c][1])},re.prototype.isCollinear=function(){return this._result===re.COLLINEAR_INTERSECTION},re.prototype.toString=function(){return Ke.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Ke.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},re.prototype.getEndpoint=function(c,p){return this._inputLines[c][p]},re.prototype.isIntersection=function(c){for(var p=0;p<this._result;p++)if(this._intPt[p].equals2D(c))return!0;return!1},re.prototype.getIntersectionAlongSegment=function(c,p){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[c][p]]},re.prototype.interfaces_=function(){return[]},re.prototype.getClass=function(){return re},re.computeEdgeDistance=function(c,p,g){var _=Math.abs(g.x-p.x),S=Math.abs(g.y-p.y),U=-1;if(c.equals(p))U=0;else if(c.equals(g))U=_>S?_:S;else{var G=Math.abs(c.x-p.x),ee=Math.abs(c.y-p.y);(U=_>S?G:ee)!==0||c.equals(p)||(U=Math.max(G,ee))}return pe.isTrue(!(U===0&&!c.equals(p)),"Bad distance calculation"),U},re.nonRobustComputeEdgeDistance=function(c,p,g){var _=c.x-p.x,S=c.y-p.y,U=Math.sqrt(_*_+S*S);return pe.isTrue(!(U===0&&!c.equals(p)),"Invalid distance calculation"),U},ke.DONT_INTERSECT.get=function(){return 0},ke.DO_INTERSECT.get=function(){return 1},ke.COLLINEAR.get=function(){return 2},ke.NO_INTERSECTION.get=function(){return 0},ke.POINT_INTERSECTION.get=function(){return 1},ke.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(re,ke);var at=function(c){function p(){c.apply(this,arguments)}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.isInSegmentEnvelopes=function(g){var _=new xe(this._inputLines[0][0],this._inputLines[0][1]),S=new xe(this._inputLines[1][0],this._inputLines[1][1]);return _.contains(g)&&S.contains(g)},p.prototype.computeIntersection=function(){if(arguments.length!==3)return c.prototype.computeIntersection.apply(this,arguments);var g=arguments[0],_=arguments[1],S=arguments[2];if(this._isProper=!1,xe.intersects(_,S,g)&&Qe.orientationIndex(_,S,g)===0&&Qe.orientationIndex(S,_,g)===0)return this._isProper=!0,(g.equals(_)||g.equals(S))&&(this._isProper=!1),this._result=c.POINT_INTERSECTION,null;this._result=c.NO_INTERSECTION},p.prototype.normalizeToMinimum=function(g,_,S,U,G){G.x=this.smallestInAbsValue(g.x,_.x,S.x,U.x),G.y=this.smallestInAbsValue(g.y,_.y,S.y,U.y),g.x-=G.x,g.y-=G.y,_.x-=G.x,_.y-=G.y,S.x-=G.x,S.y-=G.y,U.x-=G.x,U.y-=G.y},p.prototype.safeHCoordinateIntersection=function(g,_,S,U){var G=null;try{G=Le.intersection(g,_,S,U)}catch(ee){if(!(ee instanceof je))throw ee;G=p.nearestEndpoint(g,_,S,U)}return G},p.prototype.intersection=function(g,_,S,U){var G=this.intersectionWithNormalization(g,_,S,U);return this.isInSegmentEnvelopes(G)||(G=new L(p.nearestEndpoint(g,_,S,U))),this._precisionModel!==null&&this._precisionModel.makePrecise(G),G},p.prototype.smallestInAbsValue=function(g,_,S,U){var G=g,ee=Math.abs(G);return Math.abs(_)<ee&&(G=_,ee=Math.abs(_)),Math.abs(S)<ee&&(G=S,ee=Math.abs(S)),Math.abs(U)<ee&&(G=U),G},p.prototype.checkDD=function(g,_,S,U,G){var ee=se.intersection(g,_,S,U),ye=this.isInSegmentEnvelopes(ee);Ve.out.println("DD in env = "+ye+"  --------------------- "+ee),G.distance(ee)>1e-4&&Ve.out.println("Distance = "+G.distance(ee))},p.prototype.intersectionWithNormalization=function(g,_,S,U){var G=new L(g),ee=new L(_),ye=new L(S),Te=new L(U),et=new L;this.normalizeToEnvCentre(G,ee,ye,Te,et);var it=this.safeHCoordinateIntersection(G,ee,ye,Te);return it.x+=et.x,it.y+=et.y,it},p.prototype.computeCollinearIntersection=function(g,_,S,U){var G=xe.intersects(g,_,S),ee=xe.intersects(g,_,U),ye=xe.intersects(S,U,g),Te=xe.intersects(S,U,_);return G&&ee?(this._intPt[0]=S,this._intPt[1]=U,c.COLLINEAR_INTERSECTION):ye&&Te?(this._intPt[0]=g,this._intPt[1]=_,c.COLLINEAR_INTERSECTION):G&&ye?(this._intPt[0]=S,this._intPt[1]=g,!S.equals(g)||ee||Te?c.COLLINEAR_INTERSECTION:c.POINT_INTERSECTION):G&&Te?(this._intPt[0]=S,this._intPt[1]=_,!S.equals(_)||ee||ye?c.COLLINEAR_INTERSECTION:c.POINT_INTERSECTION):ee&&ye?(this._intPt[0]=U,this._intPt[1]=g,!U.equals(g)||G||Te?c.COLLINEAR_INTERSECTION:c.POINT_INTERSECTION):ee&&Te?(this._intPt[0]=U,this._intPt[1]=_,!U.equals(_)||G||ye?c.COLLINEAR_INTERSECTION:c.POINT_INTERSECTION):c.NO_INTERSECTION},p.prototype.normalizeToEnvCentre=function(g,_,S,U,G){var ee=g.x<_.x?g.x:_.x,ye=g.y<_.y?g.y:_.y,Te=g.x>_.x?g.x:_.x,et=g.y>_.y?g.y:_.y,it=S.x<U.x?S.x:U.x,kt=S.y<U.y?S.y:U.y,zt=S.x>U.x?S.x:U.x,Yt=S.y>U.y?S.y:U.y,wi=((ee>it?ee:it)+(Te<zt?Te:zt))/2,En=((ye>kt?ye:kt)+(et<Yt?et:Yt))/2;G.x=wi,G.y=En,g.x-=G.x,g.y-=G.y,_.x-=G.x,_.y-=G.y,S.x-=G.x,S.y-=G.y,U.x-=G.x,U.y-=G.y},p.prototype.computeIntersect=function(g,_,S,U){if(this._isProper=!1,!xe.intersects(g,_,S,U))return c.NO_INTERSECTION;var G=Qe.orientationIndex(g,_,S),ee=Qe.orientationIndex(g,_,U);if(G>0&&ee>0||G<0&&ee<0)return c.NO_INTERSECTION;var ye=Qe.orientationIndex(S,U,g),Te=Qe.orientationIndex(S,U,_);return ye>0&&Te>0||ye<0&&Te<0?c.NO_INTERSECTION:G===0&&ee===0&&ye===0&&Te===0?this.computeCollinearIntersection(g,_,S,U):(G===0||ee===0||ye===0||Te===0?(this._isProper=!1,g.equals2D(S)||g.equals2D(U)?this._intPt[0]=g:_.equals2D(S)||_.equals2D(U)?this._intPt[0]=_:G===0?this._intPt[0]=new L(S):ee===0?this._intPt[0]=new L(U):ye===0?this._intPt[0]=new L(g):Te===0&&(this._intPt[0]=new L(_))):(this._isProper=!0,this._intPt[0]=this.intersection(g,_,S,U)),c.POINT_INTERSECTION)},p.prototype.interfaces_=function(){return[]},p.prototype.getClass=function(){return p},p.nearestEndpoint=function(g,_,S,U){var G=g,ee=Qe.distancePointLine(g,S,U),ye=Qe.distancePointLine(_,S,U);return ye<ee&&(ee=ye,G=_),(ye=Qe.distancePointLine(S,g,_))<ee&&(ee=ye,G=S),(ye=Qe.distancePointLine(U,g,_))<ee&&(ee=ye,G=U),G},p}(re),ct=l(function(){},"ot");ct.prototype.interfaces_=function(){return[]},ct.prototype.getClass=function(){return ct},ct.orientationIndex=function(c,p,g){var _=p.x-c.x,S=p.y-c.y,U=g.x-p.x,G=g.y-p.y;return ct.signOfDet2x2(_,S,U,G)},ct.signOfDet2x2=function(c,p,g,_){var S=null,U=null,G=null;if(S=1,c===0||_===0)return p===0||g===0?0:p>0?g>0?-S:S:g>0?S:-S;if(p===0||g===0)return _>0?c>0?S:-S:c>0?-S:S;if(p>0?_>0?p<=_||(S=-S,U=c,c=g,g=U,U=p,p=_,_=U):p<=-_?(S=-S,g=-g,_=-_):(U=c,c=-g,g=U,U=p,p=-_,_=U):_>0?-p<=_?(S=-S,c=-c,p=-p):(U=-c,c=g,g=U,U=-p,p=_,_=U):p>=_?(c=-c,p=-p,g=-g,_=-_):(S=-S,U=-c,c=-g,g=U,U=-p,p=-_,_=U),c>0){if(!(g>0)||!(c<=g))return S}else{if(g>0||!(c>=g))return-S;S=-S,c=-c,g=-g}for(;;){if(G=Math.floor(g/c),g-=G*c,(_-=G*p)<0)return-S;if(_>p)return S;if(c>g+g){if(p<_+_)return S}else{if(p>_+_)return-S;g=c-g,_=p-_,S=-S}if(_===0)return g===0?0:-S;if(g===0||(G=Math.floor(c/g),c-=G*g,(p-=G*_)<0))return S;if(p>_)return-S;if(g>c+c){if(_<p+p)return-S}else{if(_>p+p)return S;c=g-c,p=_-p,S=-S}if(p===0)return c===0?0:S;if(c===0)return-S}};var rt=l(function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var c=arguments[0];this._p=c},"st");rt.prototype.countSegment=function(c,p){if(c.x<this._p.x&&p.x<this._p.x)return null;if(this._p.x===p.x&&this._p.y===p.y)return this._isPointOnSegment=!0,null;if(c.y===this._p.y&&p.y===this._p.y){var g=c.x,_=p.x;return g>_&&(g=p.x,_=c.x),this._p.x>=g&&this._p.x<=_&&(this._isPointOnSegment=!0),null}if(c.y>this._p.y&&p.y<=this._p.y||p.y>this._p.y&&c.y<=this._p.y){var S=c.x-this._p.x,U=c.y-this._p.y,G=p.x-this._p.x,ee=p.y-this._p.y,ye=ct.signOfDet2x2(S,U,G,ee);if(ye===0)return this._isPointOnSegment=!0,null;ee<U&&(ye=-ye),ye>0&&this._crossingCount++}},rt.prototype.isPointInPolygon=function(){return this.getLocation()!==O.EXTERIOR},rt.prototype.getLocation=function(){return this._isPointOnSegment?O.BOUNDARY:this._crossingCount%2==1?O.INTERIOR:O.EXTERIOR},rt.prototype.isOnSegment=function(){return this._isPointOnSegment},rt.prototype.interfaces_=function(){return[]},rt.prototype.getClass=function(){return rt},rt.locatePointInRing=function(){if(arguments[0]instanceof L&&J(arguments[1],Ie)){for(var c=arguments[0],p=arguments[1],g=new rt(c),_=new L,S=new L,U=1;U<p.size();U++)if(p.getCoordinate(U,_),p.getCoordinate(U-1,S),g.countSegment(_,S),g.isOnSegment())return g.getLocation();return g.getLocation()}if(arguments[0]instanceof L&&arguments[1]instanceof Array){for(var G=arguments[0],ee=arguments[1],ye=new rt(G),Te=1;Te<ee.length;Te++){var et=ee[Te],it=ee[Te-1];if(ye.countSegment(et,it),ye.isOnSegment())return ye.getLocation()}return ye.getLocation()}};var Qe=l(function(){},"at"),At={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};Qe.prototype.interfaces_=function(){return[]},Qe.prototype.getClass=function(){return Qe},Qe.orientationIndex=function(c,p,g){return se.orientationIndex(c,p,g)},Qe.signedArea=function(){if(arguments[0]instanceof Array){var c=arguments[0];if(c.length<3)return 0;for(var p=0,g=c[0].x,_=1;_<c.length-1;_++){var S=c[_].x-g,U=c[_+1].y;p+=S*(c[_-1].y-U)}return p/2}if(J(arguments[0],Ie)){var G=arguments[0],ee=G.size();if(ee<3)return 0;var ye=new L,Te=new L,et=new L;G.getCoordinate(0,Te),G.getCoordinate(1,et);var it=Te.x;et.x-=it;for(var kt=0,zt=1;zt<ee-1;zt++)ye.y=Te.y,Te.x=et.x,Te.y=et.y,G.getCoordinate(zt+1,et),et.x-=it,kt+=Te.x*(ye.y-et.y);return kt/2}},Qe.distanceLineLine=function(c,p,g,_){if(c.equals(p))return Qe.distancePointLine(c,g,_);if(g.equals(_))return Qe.distancePointLine(_,c,p);var S=!1;if(xe.intersects(c,p,g,_)){var U=(p.x-c.x)*(_.y-g.y)-(p.y-c.y)*(_.x-g.x);if(U===0)S=!0;else{var G=(c.y-g.y)*(_.x-g.x)-(c.x-g.x)*(_.y-g.y),ee=((c.y-g.y)*(p.x-c.x)-(c.x-g.x)*(p.y-c.y))/U,ye=G/U;(ye<0||ye>1||ee<0||ee>1)&&(S=!0)}}else S=!0;return S?oe.min(Qe.distancePointLine(c,g,_),Qe.distancePointLine(p,g,_),Qe.distancePointLine(g,c,p),Qe.distancePointLine(_,c,p)):0},Qe.isPointInRing=function(c,p){return Qe.locatePointInRing(c,p)!==O.EXTERIOR},Qe.computeLength=function(c){var p=c.size();if(p<=1)return 0;var g=0,_=new L;c.getCoordinate(0,_);for(var S=_.x,U=_.y,G=1;G<p;G++){c.getCoordinate(G,_);var ee=_.x,ye=_.y,Te=ee-S,et=ye-U;g+=Math.sqrt(Te*Te+et*et),S=ee,U=ye}return g},Qe.isCCW=function(c){var p=c.length-1;if(p<3)throw new T("Ring has fewer than 4 points, so orientation cannot be determined");for(var g=c[0],_=0,S=1;S<=p;S++){var U=c[S];U.y>g.y&&(g=U,_=S)}var G=_;do(G-=1)<0&&(G=p);while(c[G].equals2D(g)&&G!==_);var ee=_;do ee=(ee+1)%p;while(c[ee].equals2D(g)&&ee!==_);var ye=c[G],Te=c[ee];if(ye.equals2D(g)||Te.equals2D(g)||ye.equals2D(Te))return!1;var et=Qe.computeOrientation(ye,g,Te),it=!1;return it=et===0?ye.x>Te.x:et>0,it},Qe.locatePointInRing=function(c,p){return rt.locatePointInRing(c,p)},Qe.distancePointLinePerpendicular=function(c,p,g){var _=(g.x-p.x)*(g.x-p.x)+(g.y-p.y)*(g.y-p.y),S=((p.y-c.y)*(g.x-p.x)-(p.x-c.x)*(g.y-p.y))/_;return Math.abs(S)*Math.sqrt(_)},Qe.computeOrientation=function(c,p,g){return Qe.orientationIndex(c,p,g)},Qe.distancePointLine=function(){if(arguments.length===2){var c=arguments[0],p=arguments[1];if(p.length===0)throw new T("Line array must contain at least one vertex");for(var g=c.distance(p[0]),_=0;_<p.length-1;_++){var S=Qe.distancePointLine(c,p[_],p[_+1]);S<g&&(g=S)}return g}if(arguments.length===3){var U=arguments[0],G=arguments[1],ee=arguments[2];if(G.x===ee.x&&G.y===ee.y)return U.distance(G);var ye=(ee.x-G.x)*(ee.x-G.x)+(ee.y-G.y)*(ee.y-G.y),Te=((U.x-G.x)*(ee.x-G.x)+(U.y-G.y)*(ee.y-G.y))/ye;if(Te<=0)return U.distance(G);if(Te>=1)return U.distance(ee);var et=((G.y-U.y)*(ee.x-G.x)-(G.x-U.x)*(ee.y-G.y))/ye;return Math.abs(et)*Math.sqrt(ye)}},Qe.isOnLine=function(c,p){for(var g=new at,_=1;_<p.length;_++){var S=p[_-1],U=p[_];if(g.computeIntersection(c,S,U),g.hasIntersection())return!0}return!1},At.CLOCKWISE.get=function(){return-1},At.RIGHT.get=function(){return Qe.CLOCKWISE},At.COUNTERCLOCKWISE.get=function(){return 1},At.LEFT.get=function(){return Qe.COUNTERCLOCKWISE},At.COLLINEAR.get=function(){return 0},At.STRAIGHT.get=function(){return Qe.COLLINEAR},Object.defineProperties(Qe,At);var Dt=l(function(){},"lt");Dt.prototype.filter=function(c){},Dt.prototype.interfaces_=function(){return[]},Dt.prototype.getClass=function(){return Dt};var vt=l(function(){var c=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=c,this._SRID=c.getSRID()},"ct"),yt={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};vt.prototype.isGeometryCollection=function(){return this.getSortIndex()===vt.SORTINDEX_GEOMETRYCOLLECTION},vt.prototype.getFactory=function(){return this._factory},vt.prototype.getGeometryN=function(c){return this},vt.prototype.getArea=function(){return 0},vt.prototype.isRectangle=function(){return!1},vt.prototype.equals=function(){if(arguments[0]instanceof vt){var c=arguments[0];return c!==null&&this.equalsTopo(c)}if(arguments[0]instanceof Object){var p=arguments[0];if(!(p instanceof vt))return!1;var g=p;return this.equalsExact(g)}},vt.prototype.equalsExact=function(c){return this===c||this.equalsExact(c,0)},vt.prototype.geometryChanged=function(){this.apply(vt.geometryChangedFilter)},vt.prototype.geometryChangedAction=function(){this._envelope=null},vt.prototype.equalsNorm=function(c){return c!==null&&this.norm().equalsExact(c.norm())},vt.prototype.getLength=function(){return 0},vt.prototype.getNumGeometries=function(){return 1},vt.prototype.compareTo=function(){if(arguments.length===1){var c=arguments[0],p=c;return this.getSortIndex()!==p.getSortIndex()?this.getSortIndex()-p.getSortIndex():this.isEmpty()&&p.isEmpty()?0:this.isEmpty()?-1:p.isEmpty()?1:this.compareToSameClass(c)}if(arguments.length===2){var g=arguments[0],_=arguments[1];return this.getSortIndex()!==g.getSortIndex()?this.getSortIndex()-g.getSortIndex():this.isEmpty()&&g.isEmpty()?0:this.isEmpty()?-1:g.isEmpty()?1:this.compareToSameClass(g,_)}},vt.prototype.getUserData=function(){return this._userData},vt.prototype.getSRID=function(){return this._SRID},vt.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},vt.prototype.checkNotGeometryCollection=function(c){if(c.getSortIndex()===vt.SORTINDEX_GEOMETRYCOLLECTION)throw new T("This method does not support GeometryCollection arguments")},vt.prototype.equal=function(c,p,g){return g===0?c.equals(p):c.distance(p)<=g},vt.prototype.norm=function(){var c=this.copy();return c.normalize(),c},vt.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},vt.prototype.getEnvelopeInternal=function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new xe(this._envelope)},vt.prototype.setSRID=function(c){this._SRID=c},vt.prototype.setUserData=function(c){this._userData=c},vt.prototype.compare=function(c,p){for(var g=c.iterator(),_=p.iterator();g.hasNext()&&_.hasNext();){var S=g.next(),U=_.next(),G=S.compareTo(U);if(G!==0)return G}return g.hasNext()?1:_.hasNext()?-1:0},vt.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},vt.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===vt.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===vt.SORTINDEX_MULTIPOINT||this.getSortIndex()===vt.SORTINDEX_MULTILINESTRING||this.getSortIndex()===vt.SORTINDEX_MULTIPOLYGON},vt.prototype.interfaces_=function(){return[N,B,n]},vt.prototype.getClass=function(){return vt},vt.hasNonEmptyElements=function(c){for(var p=0;p<c.length;p++)if(!c[p].isEmpty())return!0;return!1},vt.hasNullElements=function(c){for(var p=0;p<c.length;p++)if(c[p]===null)return!0;return!1},yt.serialVersionUID.get=function(){return 8763622679187377e3},yt.SORTINDEX_POINT.get=function(){return 0},yt.SORTINDEX_MULTIPOINT.get=function(){return 1},yt.SORTINDEX_LINESTRING.get=function(){return 2},yt.SORTINDEX_LINEARRING.get=function(){return 3},yt.SORTINDEX_MULTILINESTRING.get=function(){return 4},yt.SORTINDEX_POLYGON.get=function(){return 5},yt.SORTINDEX_MULTIPOLYGON.get=function(){return 6},yt.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},yt.geometryChangedFilter.get=function(){return jt},Object.defineProperties(vt,yt);var jt=l(function(){},"ht");jt.interfaces_=function(){return[Dt]},jt.filter=function(c){c.geometryChangedAction()};var Wt=l(function(){},"ft");Wt.prototype.filter=function(c){},Wt.prototype.interfaces_=function(){return[]},Wt.prototype.getClass=function(){return Wt};var Kt=l(function(){},"gt"),Vt={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};Kt.prototype.isInBoundary=function(c){},Kt.prototype.interfaces_=function(){return[]},Kt.prototype.getClass=function(){return Kt},Vt.Mod2BoundaryNodeRule.get=function(){return hi},Vt.EndPointBoundaryNodeRule.get=function(){return ui},Vt.MultiValentEndPointBoundaryNodeRule.get=function(){return Zi},Vt.MonoValentEndPointBoundaryNodeRule.get=function(){return Re},Vt.MOD2_BOUNDARY_RULE.get=function(){return new hi},Vt.ENDPOINT_BOUNDARY_RULE.get=function(){return new ui},Vt.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Zi},Vt.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Re},Vt.OGC_SFS_BOUNDARY_RULE.get=function(){return Kt.MOD2_BOUNDARY_RULE},Object.defineProperties(Kt,Vt);var hi=l(function(){},"yt");hi.prototype.isInBoundary=function(c){return c%2==1},hi.prototype.interfaces_=function(){return[Kt]},hi.prototype.getClass=function(){return hi};var ui=l(function(){},"_t");ui.prototype.isInBoundary=function(c){return c>0},ui.prototype.interfaces_=function(){return[Kt]},ui.prototype.getClass=function(){return ui};var Zi=l(function(){},"mt");Zi.prototype.isInBoundary=function(c){return c>1},Zi.prototype.interfaces_=function(){return[Kt]},Zi.prototype.getClass=function(){return Zi};var Re=l(function(){},"vt");Re.prototype.isInBoundary=function(c){return c===1},Re.prototype.interfaces_=function(){return[Kt]},Re.prototype.getClass=function(){return Re};var xt=l(function(){},"It");xt.prototype.add=function(){},xt.prototype.addAll=function(){},xt.prototype.isEmpty=function(){},xt.prototype.iterator=function(){},xt.prototype.size=function(){},xt.prototype.toArray=function(){},xt.prototype.remove=function(){},(r.prototype=new Error).name="IndexOutOfBoundsException";var me=l(function(){},"Et");me.prototype.hasNext=function(){},me.prototype.next=function(){},me.prototype.remove=function(){};var W=function(c){function p(){c.apply(this,arguments)}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.get=function(){},p.prototype.set=function(){},p.prototype.isEmpty=function(){},p}(xt);(a.prototype=new Error).name="NoSuchElementException";var X=function(c){function p(){c.call(this),this.array_=[],arguments[0]instanceof xt&&this.addAll(arguments[0])}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.ensureCapacity=function(){},p.prototype.interfaces_=function(){return[c,xt]},p.prototype.add=function(g){return arguments.length===1?this.array_.push(g):this.array_.splice(arguments[0],arguments[1]),!0},p.prototype.clear=function(){this.array_=[]},p.prototype.addAll=function(g){for(var _=g.iterator();_.hasNext();)this.add(_.next());return!0},p.prototype.set=function(g,_){var S=this.array_[g];return this.array_[g]=_,S},p.prototype.iterator=function(){return new ae(this)},p.prototype.get=function(g){if(g<0||g>=this.size())throw new r;return this.array_[g]},p.prototype.isEmpty=function(){return this.array_.length===0},p.prototype.size=function(){return this.array_.length},p.prototype.toArray=function(){for(var g=[],_=0,S=this.array_.length;_<S;_++)g.push(this.array_[_]);return g},p.prototype.remove=function(g){for(var _=!1,S=0,U=this.array_.length;S<U;S++)if(this.array_[S]===g){this.array_.splice(S,1),_=!0;break}return _},p}(W),ae=function(c){function p(g){c.call(this),this.arrayList_=g,this.position_=0}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new a;return this.arrayList_.get(this.position_++)},p.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},p.prototype.set=function(g){return this.arrayList_.set(this.position_-1,g)},p.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},p}(me),_e=function(c){function p(){if(c.call(this),arguments.length!==0){if(arguments.length===1){var _=arguments[0];this.ensureCapacity(_.length),this.add(_,!0)}else if(arguments.length===2){var S=arguments[0],U=arguments[1];this.ensureCapacity(S.length),this.add(S,U)}}}l(p,"e"),c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p;var g={coordArrayType:{configurable:!0}};return g.coordArrayType.get=function(){return new Array(0).fill(null)},p.prototype.getCoordinate=function(_){return this.get(_)},p.prototype.addAll=function(){if(arguments.length===2){for(var _=arguments[0],S=arguments[1],U=!1,G=_.iterator();G.hasNext();)this.add(G.next(),S),U=!0;return U}return c.prototype.addAll.apply(this,arguments)},p.prototype.clone=function(){for(var _=c.prototype.clone.call(this),S=0;S<this.size();S++)_.add(S,this.get(S).copy());return _},p.prototype.toCoordinateArray=function(){return this.toArray(p.coordArrayType)},p.prototype.add=function(){if(arguments.length===1){var _=arguments[0];c.prototype.add.call(this,_)}else if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var S=arguments[0],U=arguments[1];return this.add(S,U,!0),!0}if(arguments[0]instanceof L&&typeof arguments[1]=="boolean"){var G=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(G))return null;c.prototype.add.call(this,G)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var ee=arguments[0],ye=arguments[1];return this.add(ee,ye),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var Te=arguments[0],et=arguments[1];if(arguments[2])for(var it=0;it<Te.length;it++)this.add(Te[it],et);else for(var kt=Te.length-1;kt>=0;kt--)this.add(Te[kt],et);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof L){var zt=arguments[0],Yt=arguments[1];if(!arguments[2]){var wi=this.size();if(wi>0&&(zt>0&&this.get(zt-1).equals2D(Yt)||zt<wi&&this.get(zt).equals2D(Yt)))return null}c.prototype.add.call(this,zt,Yt)}}else if(arguments.length===4){var En=arguments[0],wr=arguments[1],La=arguments[2],Xs=arguments[3],Eu=1;La>Xs&&(Eu=-1);for(var oS=La;oS!==Xs;oS+=Eu)this.add(En[oS],wr);return!0}},p.prototype.closeRing=function(){this.size()>0&&this.add(new L(this.get(0)),!1)},p.prototype.interfaces_=function(){return[]},p.prototype.getClass=function(){return p},Object.defineProperties(p,g),p}(X),fe=l(function(){},"Lt"),We={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};We.ForwardComparator.get=function(){return Be},We.BidirectionalComparator.get=function(){return st},We.coordArrayType.get=function(){return new Array(0).fill(null)},fe.prototype.interfaces_=function(){return[]},fe.prototype.getClass=function(){return fe},fe.isRing=function(c){return!(c.length<4)&&!!c[0].equals2D(c[c.length-1])},fe.ptNotInList=function(c,p){for(var g=0;g<c.length;g++){var _=c[g];if(fe.indexOf(_,p)<0)return _}return null},fe.scroll=function(c,p){var g=fe.indexOf(p,c);if(g<0)return null;var _=new Array(c.length).fill(null);Ve.arraycopy(c,g,_,0,c.length-g),Ve.arraycopy(c,0,_,c.length-g,g),Ve.arraycopy(_,0,c,0,c.length)},fe.equals=function(){if(arguments.length===2){var c=arguments[0],p=arguments[1];if(c===p)return!0;if(c===null||p===null||c.length!==p.length)return!1;for(var g=0;g<c.length;g++)if(!c[g].equals(p[g]))return!1;return!0}if(arguments.length===3){var _=arguments[0],S=arguments[1],U=arguments[2];if(_===S)return!0;if(_===null||S===null||_.length!==S.length)return!1;for(var G=0;G<_.length;G++)if(U.compare(_[G],S[G])!==0)return!1;return!0}},fe.intersection=function(c,p){for(var g=new _e,_=0;_<c.length;_++)p.intersects(c[_])&&g.add(c[_],!0);return g.toCoordinateArray()},fe.hasRepeatedPoints=function(c){for(var p=1;p<c.length;p++)if(c[p-1].equals(c[p]))return!0;return!1},fe.removeRepeatedPoints=function(c){return fe.hasRepeatedPoints(c)?new _e(c,!1).toCoordinateArray():c},fe.reverse=function(c){for(var p=c.length-1,g=Math.trunc(p/2),_=0;_<=g;_++){var S=c[_];c[_]=c[p-_],c[p-_]=S}},fe.removeNull=function(c){for(var p=0,g=0;g<c.length;g++)c[g]!==null&&p++;var _=new Array(p).fill(null);if(p===0)return _;for(var S=0,U=0;U<c.length;U++)c[U]!==null&&(_[S++]=c[U]);return _},fe.copyDeep=function(){if(arguments.length===1){for(var c=arguments[0],p=new Array(c.length).fill(null),g=0;g<c.length;g++)p[g]=new L(c[g]);return p}if(arguments.length===5)for(var _=arguments[0],S=arguments[1],U=arguments[2],G=arguments[3],ee=arguments[4],ye=0;ye<ee;ye++)U[G+ye]=new L(_[S+ye])},fe.isEqualReversed=function(c,p){for(var g=0;g<c.length;g++){var _=c[g],S=p[c.length-g-1];if(_.compareTo(S)!==0)return!1}return!0},fe.envelope=function(c){for(var p=new xe,g=0;g<c.length;g++)p.expandToInclude(c[g]);return p},fe.toCoordinateArray=function(c){return c.toArray(fe.coordArrayType)},fe.atLeastNCoordinatesOrNothing=function(c,p){return p.length>=c?p:[]},fe.indexOf=function(c,p){for(var g=0;g<p.length;g++)if(c.equals(p[g]))return g;return-1},fe.increasingDirection=function(c){for(var p=0;p<Math.trunc(c.length/2);p++){var g=c.length-1-p,_=c[p].compareTo(c[g]);if(_!==0)return _}return 1},fe.compare=function(c,p){for(var g=0;g<c.length&&g<p.length;){var _=c[g].compareTo(p[g]);if(_!==0)return _;g++}return g<p.length?-1:g<c.length?1:0},fe.minCoordinate=function(c){for(var p=null,g=0;g<c.length;g++)(p===null||p.compareTo(c[g])>0)&&(p=c[g]);return p},fe.extract=function(c,p,g){p=oe.clamp(p,0,c.length);var _=(g=oe.clamp(g,-1,c.length))-p+1;g<0&&(_=0),p>=c.length&&(_=0),g<p&&(_=0);var S=new Array(_).fill(null);if(_===0)return S;for(var U=0,G=p;G<=g;G++)S[U++]=c[G];return S},Object.defineProperties(fe,We);var Be=l(function(){},"wt");Be.prototype.compare=function(c,p){return fe.compare(c,p)},Be.prototype.interfaces_=function(){return[z]},Be.prototype.getClass=function(){return Be};var st=l(function(){},"Ot");st.prototype.compare=function(c,p){var g=c,_=p;if(g.length<_.length)return-1;if(g.length>_.length)return 1;if(g.length===0)return 0;var S=fe.compare(g,_);return fe.isEqualReversed(g,_)?0:S},st.prototype.OLDcompare=function(c,p){var g=c,_=p;if(g.length<_.length)return-1;if(g.length>_.length)return 1;if(g.length===0)return 0;for(var S=fe.increasingDirection(g),U=fe.increasingDirection(_),G=S>0?0:g.length-1,ee=U>0?0:g.length-1,ye=0;ye<g.length;ye++){var Te=g[G].compareTo(_[ee]);if(Te!==0)return Te;G+=S,ee+=U}return 0},st.prototype.interfaces_=function(){return[z]},st.prototype.getClass=function(){return st};var Xe=l(function(){},"Tt");Xe.prototype.get=function(){},Xe.prototype.put=function(){},Xe.prototype.size=function(){},Xe.prototype.values=function(){},Xe.prototype.entrySet=function(){};var bt=function(c){function p(){c.apply(this,arguments)}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p}(Xe);(o.prototype=new Error).name="OperationNotSupported",(s.prototype=new xt).contains=function(){};var Ye=function(c){function p(){c.call(this),this.array_=[],arguments[0]instanceof xt&&this.addAll(arguments[0])}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.contains=function(g){for(var _=0,S=this.array_.length;_<S;_++)if(this.array_[_]===g)return!0;return!1},p.prototype.add=function(g){return!this.contains(g)&&(this.array_.push(g),!0)},p.prototype.addAll=function(g){for(var _=g.iterator();_.hasNext();)this.add(_.next());return!0},p.prototype.remove=function(g){throw new Error},p.prototype.size=function(){return this.array_.length},p.prototype.isEmpty=function(){return this.array_.length===0},p.prototype.toArray=function(){for(var g=[],_=0,S=this.array_.length;_<S;_++)g.push(this.array_[_]);return g},p.prototype.iterator=function(){return new dt(this)},p}(s),dt=function(c){function p(g){c.call(this),this.hashSet_=g,this.position_=0}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new a;return this.hashSet_.array_[this.position_++]},p.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},p.prototype.remove=function(){throw new o},p}(me),Mt=0;(v.prototype=new bt).get=function(c){for(var p=this.root_;p!==null;){var g=c.compareTo(p.key);if(g<0)p=p.left;else{if(!(g>0))return p.value;p=p.right}}return null},v.prototype.put=function(c,p){if(this.root_===null)return this.root_={key:c,value:p,left:null,right:null,parent:null,color:Mt,getValue:l(function(){return this.value},"getValue"),getKey:l(function(){return this.key},"getKey")},this.size_=1,null;var g,_,S=this.root_;do if(g=S,(_=c.compareTo(S.key))<0)S=S.left;else{if(!(_>0)){var U=S.value;return S.value=p,U}S=S.right}while(S!==null);var G={key:c,left:null,right:null,value:p,parent:g,color:Mt,getValue:l(function(){return this.value},"getValue"),getKey:l(function(){return this.key},"getKey")};return _<0?g.left=G:g.right=G,this.fixAfterInsertion(G),this.size_++,null},v.prototype.fixAfterInsertion=function(c){for(c.color=1;c!=null&&c!==this.root_&&c.parent.color===1;)if(h(c)===f(h(h(c)))){var p=m(h(h(c)));u(p)===1?(d(h(c),Mt),d(p,Mt),d(h(h(c)),1),c=h(h(c))):(c===m(h(c))&&(c=h(c),this.rotateLeft(c)),d(h(c),Mt),d(h(h(c)),1),this.rotateRight(h(h(c))))}else{var g=f(h(h(c)));u(g)===1?(d(h(c),Mt),d(g,Mt),d(h(h(c)),1),c=h(h(c))):(c===f(h(c))&&(c=h(c),this.rotateRight(c)),d(h(c),Mt),d(h(h(c)),1),this.rotateLeft(h(h(c))))}this.root_.color=Mt},v.prototype.values=function(){var c=new X,p=this.getFirstEntry();if(p!==null)for(c.add(p.value);(p=v.successor(p))!==null;)c.add(p.value);return c},v.prototype.entrySet=function(){var c=new Ye,p=this.getFirstEntry();if(p!==null)for(c.add(p);(p=v.successor(p))!==null;)c.add(p);return c},v.prototype.rotateLeft=function(c){if(c!=null){var p=c.right;c.right=p.left,p.left!=null&&(p.left.parent=c),p.parent=c.parent,c.parent===null?this.root_=p:c.parent.left===c?c.parent.left=p:c.parent.right=p,p.left=c,c.parent=p}},v.prototype.rotateRight=function(c){if(c!=null){var p=c.left;c.left=p.right,p.right!=null&&(p.right.parent=c),p.parent=c.parent,c.parent===null?this.root_=p:c.parent.right===c?c.parent.right=p:c.parent.left=p,p.right=c,c.parent=p}},v.prototype.getFirstEntry=function(){var c=this.root_;if(c!=null)for(;c.left!=null;)c=c.left;return c},v.successor=function(c){if(c===null)return null;if(c.right!==null){for(var p=c.right;p.left!==null;)p=p.left;return p}for(var g=c.parent,_=c;g!==null&&_===g.right;)_=g,g=g.parent;return g},v.prototype.size=function(){return this.size_};var bi=l(function(){},"At");bi.prototype.interfaces_=function(){return[]},bi.prototype.getClass=function(){return bi},b.prototype=new s,(w.prototype=new b).contains=function(c){for(var p=0,g=this.array_.length;p<g;p++)if(this.array_[p].compareTo(c)===0)return!0;return!1},w.prototype.add=function(c){if(this.contains(c))return!1;for(var p=0,g=this.array_.length;p<g;p++)if(this.array_[p].compareTo(c)===1)return this.array_.splice(p,0,c),!0;return this.array_.push(c),!0},w.prototype.addAll=function(c){for(var p=c.iterator();p.hasNext();)this.add(p.next());return!0},w.prototype.remove=function(c){throw new o},w.prototype.size=function(){return this.array_.length},w.prototype.isEmpty=function(){return this.array_.length===0},w.prototype.toArray=function(){for(var c=[],p=0,g=this.array_.length;p<g;p++)c.push(this.array_[p]);return c},w.prototype.iterator=function(){return new ni(this)};var ni=l(function(c){this.treeSet_=c,this.position_=0},"Ft");ni.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new a;return this.treeSet_.array_[this.position_++]},ni.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},ni.prototype.remove=function(){throw new o};var Ii=l(function(){},"Gt");Ii.sort=function(){var c,p,g,_,S=arguments[0];if(arguments.length===1)_=l(function(G,ee){return G.compareTo(ee)},"i"),S.sort(_);else if(arguments.length===2)g=arguments[1],_=l(function(G,ee){return g.compare(G,ee)},"i"),S.sort(_);else if(arguments.length===3){(p=S.slice(arguments[1],arguments[2])).sort();var U=S.slice(0,arguments[1]).concat(p,S.slice(arguments[2],S.length));for(S.splice(0,S.length),c=0;c<U.length;c++)S.push(U[c])}else if(arguments.length===4)for(p=S.slice(arguments[1],arguments[2]),g=arguments[3],_=l(function(G,ee){return g.compare(G,ee)},"i"),p.sort(_),U=S.slice(0,arguments[1]).concat(p,S.slice(arguments[2],S.length)),S.splice(0,S.length),c=0;c<U.length;c++)S.push(U[c])},Ii.asList=function(c){for(var p=new X,g=0,_=c.length;g<_;g++)p.add(c[g]);return p};var Nt=l(function(){},"qt"),Ri={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};Ri.P.get=function(){return 0},Ri.L.get=function(){return 1},Ri.A.get=function(){return 2},Ri.FALSE.get=function(){return-1},Ri.TRUE.get=function(){return-2},Ri.DONTCARE.get=function(){return-3},Ri.SYM_FALSE.get=function(){return"F"},Ri.SYM_TRUE.get=function(){return"T"},Ri.SYM_DONTCARE.get=function(){return"*"},Ri.SYM_P.get=function(){return"0"},Ri.SYM_L.get=function(){return"1"},Ri.SYM_A.get=function(){return"2"},Nt.prototype.interfaces_=function(){return[]},Nt.prototype.getClass=function(){return Nt},Nt.toDimensionSymbol=function(c){switch(c){case Nt.FALSE:return Nt.SYM_FALSE;case Nt.TRUE:return Nt.SYM_TRUE;case Nt.DONTCARE:return Nt.SYM_DONTCARE;case Nt.P:return Nt.SYM_P;case Nt.L:return Nt.SYM_L;case Nt.A:return Nt.SYM_A}throw new T("Unknown dimension value: "+c)},Nt.toDimensionValue=function(c){switch(ve.toUpperCase(c)){case Nt.SYM_FALSE:return Nt.FALSE;case Nt.SYM_TRUE:return Nt.TRUE;case Nt.SYM_DONTCARE:return Nt.DONTCARE;case Nt.SYM_P:return Nt.P;case Nt.SYM_L:return Nt.L;case Nt.SYM_A:return Nt.A}throw new T("Unknown dimension symbol: "+c)},Object.defineProperties(Nt,Ri);var Ki=l(function(){},"Vt");Ki.prototype.filter=function(c){},Ki.prototype.interfaces_=function(){return[]},Ki.prototype.getClass=function(){return Ki};var Vi=l(function(){},"Ut");Vi.prototype.filter=function(c,p){},Vi.prototype.isDone=function(){},Vi.prototype.isGeometryChanged=function(){},Vi.prototype.interfaces_=function(){return[]},Vi.prototype.getClass=function(){return Vi};var Ti=function(c){function p(_,S){if(c.call(this,S),this._geometries=_||[],c.hasNullElements(this._geometries))throw new T("geometries must not contain null elements")}l(p,"e"),c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p;var g={serialVersionUID:{configurable:!0}};return p.prototype.computeEnvelopeInternal=function(){for(var _=new xe,S=0;S<this._geometries.length;S++)_.expandToInclude(this._geometries[S].getEnvelopeInternal());return _},p.prototype.getGeometryN=function(_){return this._geometries[_]},p.prototype.getSortIndex=function(){return c.SORTINDEX_GEOMETRYCOLLECTION},p.prototype.getCoordinates=function(){for(var _=new Array(this.getNumPoints()).fill(null),S=-1,U=0;U<this._geometries.length;U++)for(var G=this._geometries[U].getCoordinates(),ee=0;ee<G.length;ee++)_[++S]=G[ee];return _},p.prototype.getArea=function(){for(var _=0,S=0;S<this._geometries.length;S++)_+=this._geometries[S].getArea();return _},p.prototype.equalsExact=function(){if(arguments.length===2){var _=arguments[0],S=arguments[1];if(!this.isEquivalentClass(_))return!1;var U=_;if(this._geometries.length!==U._geometries.length)return!1;for(var G=0;G<this._geometries.length;G++)if(!this._geometries[G].equalsExact(U._geometries[G],S))return!1;return!0}return c.prototype.equalsExact.apply(this,arguments)},p.prototype.normalize=function(){for(var _=0;_<this._geometries.length;_++)this._geometries[_].normalize();Ii.sort(this._geometries)},p.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},p.prototype.getBoundaryDimension=function(){for(var _=Nt.FALSE,S=0;S<this._geometries.length;S++)_=Math.max(_,this._geometries[S].getBoundaryDimension());return _},p.prototype.getDimension=function(){for(var _=Nt.FALSE,S=0;S<this._geometries.length;S++)_=Math.max(_,this._geometries[S].getDimension());return _},p.prototype.getLength=function(){for(var _=0,S=0;S<this._geometries.length;S++)_+=this._geometries[S].getLength();return _},p.prototype.getNumPoints=function(){for(var _=0,S=0;S<this._geometries.length;S++)_+=this._geometries[S].getNumPoints();return _},p.prototype.getNumGeometries=function(){return this._geometries.length},p.prototype.reverse=function(){for(var _=this._geometries.length,S=new Array(_).fill(null),U=0;U<this._geometries.length;U++)S[U]=this._geometries[U].reverse();return this.getFactory().createGeometryCollection(S)},p.prototype.compareToSameClass=function(){if(arguments.length===1){var _=arguments[0],S=new w(Ii.asList(this._geometries)),U=new w(Ii.asList(_._geometries));return this.compare(S,U)}if(arguments.length===2){for(var G=arguments[0],ee=arguments[1],ye=G,Te=this.getNumGeometries(),et=ye.getNumGeometries(),it=0;it<Te&&it<et;){var kt=this.getGeometryN(it),zt=ye.getGeometryN(it),Yt=kt.compareToSameClass(zt,ee);if(Yt!==0)return Yt;it++}return it<Te?1:it<et?-1:0}},p.prototype.apply=function(){if(J(arguments[0],Wt))for(var _=arguments[0],S=0;S<this._geometries.length;S++)this._geometries[S].apply(_);else if(J(arguments[0],Vi)){var U=arguments[0];if(this._geometries.length===0)return null;for(var G=0;G<this._geometries.length&&(this._geometries[G].apply(U),!U.isDone());G++);U.isGeometryChanged()&&this.geometryChanged()}else if(J(arguments[0],Ki)){var ee=arguments[0];ee.filter(this);for(var ye=0;ye<this._geometries.length;ye++)this._geometries[ye].apply(ee)}else if(J(arguments[0],Dt)){var Te=arguments[0];Te.filter(this);for(var et=0;et<this._geometries.length;et++)this._geometries[et].apply(Te)}},p.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),pe.shouldNeverReachHere(),null},p.prototype.clone=function(){var _=c.prototype.clone.call(this);_._geometries=new Array(this._geometries.length).fill(null);for(var S=0;S<this._geometries.length;S++)_._geometries[S]=this._geometries[S].clone();return _},p.prototype.getGeometryType=function(){return"GeometryCollection"},p.prototype.copy=function(){for(var _=new Array(this._geometries.length).fill(null),S=0;S<_.length;S++)_[S]=this._geometries[S].copy();return new p(_,this._factory)},p.prototype.isEmpty=function(){for(var _=0;_<this._geometries.length;_++)if(!this._geometries[_].isEmpty())return!1;return!0},p.prototype.interfaces_=function(){return[]},p.prototype.getClass=function(){return p},g.serialVersionUID.get=function(){return-5694727726395021e3},Object.defineProperties(p,g),p}(vt),yn=function(c){function p(){c.apply(this,arguments)}l(p,"e"),c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p;var g={serialVersionUID:{configurable:!0}};return p.prototype.getSortIndex=function(){return vt.SORTINDEX_MULTILINESTRING},p.prototype.equalsExact=function(){if(arguments.length===2){var _=arguments[0],S=arguments[1];return!!this.isEquivalentClass(_)&&c.prototype.equalsExact.call(this,_,S)}return c.prototype.equalsExact.apply(this,arguments)},p.prototype.getBoundaryDimension=function(){return this.isClosed()?Nt.FALSE:0},p.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var _=0;_<this._geometries.length;_++)if(!this._geometries[_].isClosed())return!1;return!0},p.prototype.getDimension=function(){return 1},p.prototype.reverse=function(){for(var _=this._geometries.length,S=new Array(_).fill(null),U=0;U<this._geometries.length;U++)S[_-1-U]=this._geometries[U].reverse();return this.getFactory().createMultiLineString(S)},p.prototype.getBoundary=function(){return new hn(this).getBoundary()},p.prototype.getGeometryType=function(){return"MultiLineString"},p.prototype.copy=function(){for(var _=new Array(this._geometries.length).fill(null),S=0;S<_.length;S++)_[S]=this._geometries[S].copy();return new p(_,this._factory)},p.prototype.interfaces_=function(){return[bi]},p.prototype.getClass=function(){return p},g.serialVersionUID.get=function(){return 8166665132445434e3},Object.defineProperties(p,g),p}(Ti),hn=l(function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,arguments.length===1){var c=arguments[0],p=Kt.MOD2_BOUNDARY_RULE;this._geom=c,this._geomFact=c.getFactory(),this._bnRule=p}else if(arguments.length===2){var g=arguments[0],_=arguments[1];this._geom=g,this._geomFact=g.getFactory(),this._bnRule=_}},"Yt");hn.prototype.boundaryMultiLineString=function(c){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var p=this.computeBoundaryCoordinates(c);return p.length===1?this._geomFact.createPoint(p[0]):this._geomFact.createMultiPointFromCoords(p)},hn.prototype.getBoundary=function(){return this._geom instanceof Pe?this.boundaryLineString(this._geom):this._geom instanceof yn?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},hn.prototype.boundaryLineString=function(c){return this._geom.isEmpty()?this.getEmptyMultiPoint():c.isClosed()?this._bnRule.isInBoundary(2)?c.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([c.getStartPoint(),c.getEndPoint()])},hn.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},hn.prototype.computeBoundaryCoordinates=function(c){var p=new X;this._endpointMap=new v;for(var g=0;g<c.getNumGeometries();g++){var _=c.getGeometryN(g);_.getNumPoints()!==0&&(this.addEndpoint(_.getCoordinateN(0)),this.addEndpoint(_.getCoordinateN(_.getNumPoints()-1)))}for(var S=this._endpointMap.entrySet().iterator();S.hasNext();){var U=S.next(),G=U.getValue().count;this._bnRule.isInBoundary(G)&&p.add(U.getKey())}return fe.toCoordinateArray(p)},hn.prototype.addEndpoint=function(c){var p=this._endpointMap.get(c);p===null&&(p=new An,this._endpointMap.put(c,p)),p.count++},hn.prototype.interfaces_=function(){return[]},hn.prototype.getClass=function(){return hn},hn.getBoundary=function(){if(arguments.length===1){var c=arguments[0];return new hn(c).getBoundary()}if(arguments.length===2){var p=arguments[0],g=arguments[1];return new hn(p,g).getBoundary()}};var An=l(function(){this.count=null},"kt");An.prototype.interfaces_=function(){return[]},An.prototype.getClass=function(){return An};var gn=l(function(){},"jt"),nr={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};gn.prototype.interfaces_=function(){return[]},gn.prototype.getClass=function(){return gn},gn.chars=function(c,p){for(var g=new Array(p).fill(null),_=0;_<p;_++)g[_]=c;return String(g)},gn.getStackTrace=function(){if(arguments.length===1){var c=arguments[0],p=new function(){},g=new function(){};return c.printStackTrace(g),p.toString()}if(arguments.length===2){for(var _=arguments[0],S=arguments[1],U="",G=new function(){}(new function(){}(gn.getStackTrace(_))),ee=0;ee<S;ee++)try{U+=G.readLine()+gn.NEWLINE}catch(ye){if(!(ye instanceof A))throw ye;pe.shouldNeverReachHere()}return U}},gn.split=function(c,p){for(var g=p.length,_=new X,S=""+c,U=S.indexOf(p);U>=0;){var G=S.substring(0,U);_.add(G),U=(S=S.substring(U+g)).indexOf(p)}S.length>0&&_.add(S);for(var ee=new Array(_.size()).fill(null),ye=0;ye<ee.length;ye++)ee[ye]=_.get(ye);return ee},gn.toString=function(){if(arguments.length===1){var c=arguments[0];return gn.SIMPLE_ORDINATE_FORMAT.format(c)}},gn.spaces=function(c){return gn.chars(" ",c)},nr.NEWLINE.get=function(){return Ve.getProperty("line.separator")},nr.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}},Object.defineProperties(gn,nr);var ue=l(function(){},"Wt");ue.prototype.interfaces_=function(){return[]},ue.prototype.getClass=function(){return ue},ue.copyCoord=function(c,p,g,_){for(var S=Math.min(c.getDimension(),g.getDimension()),U=0;U<S;U++)g.setOrdinate(_,U,c.getOrdinate(p,U))},ue.isRing=function(c){var p=c.size();return p===0||!(p<=3)&&c.getOrdinate(0,Ie.X)===c.getOrdinate(p-1,Ie.X)&&c.getOrdinate(0,Ie.Y)===c.getOrdinate(p-1,Ie.Y)},ue.isEqual=function(c,p){var g=c.size();if(g!==p.size())return!1;for(var _=Math.min(c.getDimension(),p.getDimension()),S=0;S<g;S++)for(var U=0;U<_;U++){var G=c.getOrdinate(S,U),ee=p.getOrdinate(S,U);if(c.getOrdinate(S,U)!==p.getOrdinate(S,U)&&(!k.isNaN(G)||!k.isNaN(ee)))return!1}return!0},ue.extend=function(c,p,g){var _=c.create(g,p.getDimension()),S=p.size();if(ue.copy(p,0,_,0,S),S>0)for(var U=S;U<g;U++)ue.copy(p,S-1,_,U,1);return _},ue.reverse=function(c){for(var p=c.size()-1,g=Math.trunc(p/2),_=0;_<=g;_++)ue.swap(c,_,p-_)},ue.swap=function(c,p,g){if(p===g)return null;for(var _=0;_<c.getDimension();_++){var S=c.getOrdinate(p,_);c.setOrdinate(p,_,c.getOrdinate(g,_)),c.setOrdinate(g,_,S)}},ue.copy=function(c,p,g,_,S){for(var U=0;U<S;U++)ue.copyCoord(c,p+U,g,_+U)},ue.toString=function(){if(arguments.length===1){var c=arguments[0],p=c.size();if(p===0)return"()";var g=c.getDimension(),_=new K;_.append("(");for(var S=0;S<p;S++){S>0&&_.append(" ");for(var U=0;U<g;U++)U>0&&_.append(","),_.append(gn.toString(c.getOrdinate(S,U)))}return _.append(")"),_.toString()}},ue.ensureValidRing=function(c,p){var g=p.size();return g===0?p:g<=3?ue.createClosedRing(c,p,4):p.getOrdinate(0,Ie.X)===p.getOrdinate(g-1,Ie.X)&&p.getOrdinate(0,Ie.Y)===p.getOrdinate(g-1,Ie.Y)?p:ue.createClosedRing(c,p,g+1)},ue.createClosedRing=function(c,p,g){var _=c.create(g,p.getDimension()),S=p.size();ue.copy(p,0,_,0,S);for(var U=S;U<g;U++)ue.copy(p,0,_,U,1);return _};var Pe=function(c){function p(_,S){c.call(this,S),this._points=null,this.init(_)}l(p,"e"),c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p;var g={serialVersionUID:{configurable:!0}};return p.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new xe:this._points.expandEnvelope(new xe)},p.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},p.prototype.getSortIndex=function(){return c.SORTINDEX_LINESTRING},p.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},p.prototype.equalsExact=function(){if(arguments.length===2){var _=arguments[0],S=arguments[1];if(!this.isEquivalentClass(_))return!1;var U=_;if(this._points.size()!==U._points.size())return!1;for(var G=0;G<this._points.size();G++)if(!this.equal(this._points.getCoordinate(G),U._points.getCoordinate(G),S))return!1;return!0}return c.prototype.equalsExact.apply(this,arguments)},p.prototype.normalize=function(){for(var _=0;_<Math.trunc(this._points.size()/2);_++){var S=this._points.size()-1-_;if(!this._points.getCoordinate(_).equals(this._points.getCoordinate(S)))return this._points.getCoordinate(_).compareTo(this._points.getCoordinate(S))>0&&ue.reverse(this._points),null}},p.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},p.prototype.getBoundaryDimension=function(){return this.isClosed()?Nt.FALSE:0},p.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},p.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},p.prototype.getDimension=function(){return 1},p.prototype.getLength=function(){return Qe.computeLength(this._points)},p.prototype.getNumPoints=function(){return this._points.size()},p.prototype.reverse=function(){var _=this._points.copy();return ue.reverse(_),this.getFactory().createLineString(_)},p.prototype.compareToSameClass=function(){if(arguments.length===1){for(var _=arguments[0],S=0,U=0;S<this._points.size()&&U<_._points.size();){var G=this._points.getCoordinate(S).compareTo(_._points.getCoordinate(U));if(G!==0)return G;S++,U++}return S<this._points.size()?1:U<_._points.size()?-1:0}if(arguments.length===2){var ee=arguments[0];return arguments[1].compare(this._points,ee._points)}},p.prototype.apply=function(){if(J(arguments[0],Wt))for(var _=arguments[0],S=0;S<this._points.size();S++)_.filter(this._points.getCoordinate(S));else if(J(arguments[0],Vi)){var U=arguments[0];if(this._points.size()===0)return null;for(var G=0;G<this._points.size()&&(U.filter(this._points,G),!U.isDone());G++);U.isGeometryChanged()&&this.geometryChanged()}else J(arguments[0],Ki)?arguments[0].filter(this):J(arguments[0],Dt)&&arguments[0].filter(this)},p.prototype.getBoundary=function(){return new hn(this).getBoundary()},p.prototype.isEquivalentClass=function(_){return _ instanceof p},p.prototype.clone=function(){var _=c.prototype.clone.call(this);return _._points=this._points.clone(),_},p.prototype.getCoordinateN=function(_){return this._points.getCoordinate(_)},p.prototype.getGeometryType=function(){return"LineString"},p.prototype.copy=function(){return new p(this._points.copy(),this._factory)},p.prototype.getCoordinateSequence=function(){return this._points},p.prototype.isEmpty=function(){return this._points.size()===0},p.prototype.init=function(_){if(_===null&&(_=this.getFactory().getCoordinateSequenceFactory().create([])),_.size()===1)throw new T("Invalid number of points in LineString (found "+_.size()+" - must be 0 or >= 2)");this._points=_},p.prototype.isCoordinate=function(_){for(var S=0;S<this._points.size();S++)if(this._points.getCoordinate(S).equals(_))return!0;return!1},p.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},p.prototype.getPointN=function(_){return this.getFactory().createPoint(this._points.getCoordinate(_))},p.prototype.interfaces_=function(){return[bi]},p.prototype.getClass=function(){return p},g.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(p,g),p}(vt),Ze=l(function(){},"Jt");Ze.prototype.interfaces_=function(){return[]},Ze.prototype.getClass=function(){return Ze};var Ge=function(c){function p(_,S){c.call(this,S),this._coordinates=_||null,this.init(this._coordinates)}l(p,"e"),c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p;var g={serialVersionUID:{configurable:!0}};return p.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new xe;var _=new xe;return _.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),_},p.prototype.getSortIndex=function(){return c.SORTINDEX_POINT},p.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},p.prototype.equalsExact=function(){if(arguments.length===2){var _=arguments[0],S=arguments[1];return!!this.isEquivalentClass(_)&&(!(!this.isEmpty()||!_.isEmpty())||this.isEmpty()===_.isEmpty()&&this.equal(_.getCoordinate(),this.getCoordinate(),S))}return c.prototype.equalsExact.apply(this,arguments)},p.prototype.normalize=function(){},p.prototype.getCoordinate=function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null},p.prototype.getBoundaryDimension=function(){return Nt.FALSE},p.prototype.getDimension=function(){return 0},p.prototype.getNumPoints=function(){return this.isEmpty()?0:1},p.prototype.reverse=function(){return this.copy()},p.prototype.getX=function(){if(this.getCoordinate()===null)throw new Error("getX called on empty Point");return this.getCoordinate().x},p.prototype.compareToSameClass=function(){if(arguments.length===1){var _=arguments[0];return this.getCoordinate().compareTo(_.getCoordinate())}if(arguments.length===2){var S=arguments[0];return arguments[1].compare(this._coordinates,S._coordinates)}},p.prototype.apply=function(){if(J(arguments[0],Wt)){var _=arguments[0];if(this.isEmpty())return null;_.filter(this.getCoordinate())}else if(J(arguments[0],Vi)){var S=arguments[0];if(this.isEmpty())return null;S.filter(this._coordinates,0),S.isGeometryChanged()&&this.geometryChanged()}else J(arguments[0],Ki)?arguments[0].filter(this):J(arguments[0],Dt)&&arguments[0].filter(this)},p.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},p.prototype.clone=function(){var _=c.prototype.clone.call(this);return _._coordinates=this._coordinates.clone(),_},p.prototype.getGeometryType=function(){return"Point"},p.prototype.copy=function(){return new p(this._coordinates.copy(),this._factory)},p.prototype.getCoordinateSequence=function(){return this._coordinates},p.prototype.getY=function(){if(this.getCoordinate()===null)throw new Error("getY called on empty Point");return this.getCoordinate().y},p.prototype.isEmpty=function(){return this._coordinates.size()===0},p.prototype.init=function(_){_===null&&(_=this.getFactory().getCoordinateSequenceFactory().create([])),pe.isTrue(_.size()<=1),this._coordinates=_},p.prototype.isSimple=function(){return!0},p.prototype.interfaces_=function(){return[Ze]},p.prototype.getClass=function(){return p},g.serialVersionUID.get=function(){return 4902022702746615e3},Object.defineProperties(p,g),p}(vt),Oe=l(function(){},"Zt");Oe.prototype.interfaces_=function(){return[]},Oe.prototype.getClass=function(){return Oe};var pt=function(c){function p(_,S,U){if(c.call(this,U),this._shell=null,this._holes=null,_===null&&(_=this.getFactory().createLinearRing()),S===null&&(S=[]),c.hasNullElements(S))throw new T("holes must not contain null elements");if(_.isEmpty()&&c.hasNonEmptyElements(S))throw new T("shell is empty but holes are not");this._shell=_,this._holes=S}l(p,"e"),c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p;var g={serialVersionUID:{configurable:!0}};return p.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},p.prototype.getSortIndex=function(){return c.SORTINDEX_POLYGON},p.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var _=new Array(this.getNumPoints()).fill(null),S=-1,U=this._shell.getCoordinates(),G=0;G<U.length;G++)_[++S]=U[G];for(var ee=0;ee<this._holes.length;ee++)for(var ye=this._holes[ee].getCoordinates(),Te=0;Te<ye.length;Te++)_[++S]=ye[Te];return _},p.prototype.getArea=function(){var _=0;_+=Math.abs(Qe.signedArea(this._shell.getCoordinateSequence()));for(var S=0;S<this._holes.length;S++)_-=Math.abs(Qe.signedArea(this._holes[S].getCoordinateSequence()));return _},p.prototype.isRectangle=function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var _=this._shell.getCoordinateSequence(),S=this.getEnvelopeInternal(),U=0;U<5;U++){var G=_.getX(U);if(G!==S.getMinX()&&G!==S.getMaxX())return!1;var ee=_.getY(U);if(ee!==S.getMinY()&&ee!==S.getMaxY())return!1}for(var ye=_.getX(0),Te=_.getY(0),et=1;et<=4;et++){var it=_.getX(et),kt=_.getY(et);if(it!==ye==(kt!==Te))return!1;ye=it,Te=kt}return!0},p.prototype.equalsExact=function(){if(arguments.length===2){var _=arguments[0],S=arguments[1];if(!this.isEquivalentClass(_))return!1;var U=_,G=this._shell,ee=U._shell;if(!G.equalsExact(ee,S)||this._holes.length!==U._holes.length)return!1;for(var ye=0;ye<this._holes.length;ye++)if(!this._holes[ye].equalsExact(U._holes[ye],S))return!1;return!0}return c.prototype.equalsExact.apply(this,arguments)},p.prototype.normalize=function(){if(arguments.length===0){this.normalize(this._shell,!0);for(var _=0;_<this._holes.length;_++)this.normalize(this._holes[_],!1);Ii.sort(this._holes)}else if(arguments.length===2){var S=arguments[0],U=arguments[1];if(S.isEmpty())return null;var G=new Array(S.getCoordinates().length-1).fill(null);Ve.arraycopy(S.getCoordinates(),0,G,0,G.length);var ee=fe.minCoordinate(S.getCoordinates());fe.scroll(G,ee),Ve.arraycopy(G,0,S.getCoordinates(),0,G.length),S.getCoordinates()[G.length]=G[0],Qe.isCCW(S.getCoordinates())===U&&fe.reverse(S.getCoordinates())}},p.prototype.getCoordinate=function(){return this._shell.getCoordinate()},p.prototype.getNumInteriorRing=function(){return this._holes.length},p.prototype.getBoundaryDimension=function(){return 1},p.prototype.getDimension=function(){return 2},p.prototype.getLength=function(){var _=0;_+=this._shell.getLength();for(var S=0;S<this._holes.length;S++)_+=this._holes[S].getLength();return _},p.prototype.getNumPoints=function(){for(var _=this._shell.getNumPoints(),S=0;S<this._holes.length;S++)_+=this._holes[S].getNumPoints();return _},p.prototype.reverse=function(){var _=this.copy();_._shell=this._shell.copy().reverse(),_._holes=new Array(this._holes.length).fill(null);for(var S=0;S<this._holes.length;S++)_._holes[S]=this._holes[S].copy().reverse();return _},p.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},p.prototype.compareToSameClass=function(){if(arguments.length===1){var _=arguments[0],S=this._shell,U=_._shell;return S.compareToSameClass(U)}if(arguments.length===2){var G=arguments[0],ee=arguments[1],ye=G,Te=this._shell,et=ye._shell,it=Te.compareToSameClass(et,ee);if(it!==0)return it;for(var kt=this.getNumInteriorRing(),zt=ye.getNumInteriorRing(),Yt=0;Yt<kt&&Yt<zt;){var wi=this.getInteriorRingN(Yt),En=ye.getInteriorRingN(Yt),wr=wi.compareToSameClass(En,ee);if(wr!==0)return wr;Yt++}return Yt<kt?1:Yt<zt?-1:0}},p.prototype.apply=function(_){if(J(_,Wt)){this._shell.apply(_);for(var S=0;S<this._holes.length;S++)this._holes[S].apply(_)}else if(J(_,Vi)){if(this._shell.apply(_),!_.isDone())for(var U=0;U<this._holes.length&&(this._holes[U].apply(_),!_.isDone());U++);_.isGeometryChanged()&&this.geometryChanged()}else if(J(_,Ki))_.filter(this);else if(J(_,Dt)){_.filter(this),this._shell.apply(_);for(var G=0;G<this._holes.length;G++)this._holes[G].apply(_)}},p.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var _=new Array(this._holes.length+1).fill(null);_[0]=this._shell;for(var S=0;S<this._holes.length;S++)_[S+1]=this._holes[S];return _.length<=1?this.getFactory().createLinearRing(_[0].getCoordinateSequence()):this.getFactory().createMultiLineString(_)},p.prototype.clone=function(){var _=c.prototype.clone.call(this);_._shell=this._shell.clone(),_._holes=new Array(this._holes.length).fill(null);for(var S=0;S<this._holes.length;S++)_._holes[S]=this._holes[S].clone();return _},p.prototype.getGeometryType=function(){return"Polygon"},p.prototype.copy=function(){for(var _=this._shell.copy(),S=new Array(this._holes.length).fill(null),U=0;U<S.length;U++)S[U]=this._holes[U].copy();return new p(_,S,this._factory)},p.prototype.getExteriorRing=function(){return this._shell},p.prototype.isEmpty=function(){return this._shell.isEmpty()},p.prototype.getInteriorRingN=function(_){return this._holes[_]},p.prototype.interfaces_=function(){return[Oe]},p.prototype.getClass=function(){return p},g.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(p,g),p}(vt),Ot=function(c){function p(){c.apply(this,arguments)}l(p,"e"),c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p;var g={serialVersionUID:{configurable:!0}};return p.prototype.getSortIndex=function(){return vt.SORTINDEX_MULTIPOINT},p.prototype.isValid=function(){return!0},p.prototype.equalsExact=function(){if(arguments.length===2){var _=arguments[0],S=arguments[1];return!!this.isEquivalentClass(_)&&c.prototype.equalsExact.call(this,_,S)}return c.prototype.equalsExact.apply(this,arguments)},p.prototype.getCoordinate=function(){if(arguments.length===1){var _=arguments[0];return this._geometries[_].getCoordinate()}return c.prototype.getCoordinate.apply(this,arguments)},p.prototype.getBoundaryDimension=function(){return Nt.FALSE},p.prototype.getDimension=function(){return 0},p.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},p.prototype.getGeometryType=function(){return"MultiPoint"},p.prototype.copy=function(){for(var _=new Array(this._geometries.length).fill(null),S=0;S<_.length;S++)_[S]=this._geometries[S].copy();return new p(_,this._factory)},p.prototype.interfaces_=function(){return[Ze]},p.prototype.getClass=function(){return p},g.serialVersionUID.get=function(){return-8048474874175356e3},Object.defineProperties(p,g),p}(Ti),Ft=function(c){function p(_,S){_ instanceof L&&S instanceof _i&&(_=S.getCoordinateSequenceFactory().create(_)),c.call(this,_,S),this.validateConstruction()}l(p,"e"),c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p;var g={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return p.prototype.getSortIndex=function(){return vt.SORTINDEX_LINEARRING},p.prototype.getBoundaryDimension=function(){return Nt.FALSE},p.prototype.isClosed=function(){return!!this.isEmpty()||c.prototype.isClosed.call(this)},p.prototype.reverse=function(){var _=this._points.copy();return ue.reverse(_),this.getFactory().createLinearRing(_)},p.prototype.validateConstruction=function(){if(!this.isEmpty()&&!c.prototype.isClosed.call(this))throw new T("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<p.MINIMUM_VALID_SIZE)throw new T("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},p.prototype.getGeometryType=function(){return"LinearRing"},p.prototype.copy=function(){return new p(this._points.copy(),this._factory)},p.prototype.interfaces_=function(){return[]},p.prototype.getClass=function(){return p},g.MINIMUM_VALID_SIZE.get=function(){return 4},g.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(p,g),p}(Pe),$t=function(c){function p(){c.apply(this,arguments)}l(p,"e"),c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p;var g={serialVersionUID:{configurable:!0}};return p.prototype.getSortIndex=function(){return vt.SORTINDEX_MULTIPOLYGON},p.prototype.equalsExact=function(){if(arguments.length===2){var _=arguments[0],S=arguments[1];return!!this.isEquivalentClass(_)&&c.prototype.equalsExact.call(this,_,S)}return c.prototype.equalsExact.apply(this,arguments)},p.prototype.getBoundaryDimension=function(){return 1},p.prototype.getDimension=function(){return 2},p.prototype.reverse=function(){for(var _=this._geometries.length,S=new Array(_).fill(null),U=0;U<this._geometries.length;U++)S[U]=this._geometries[U].reverse();return this.getFactory().createMultiPolygon(S)},p.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var _=new X,S=0;S<this._geometries.length;S++)for(var U=this._geometries[S].getBoundary(),G=0;G<U.getNumGeometries();G++)_.add(U.getGeometryN(G));var ee=new Array(_.size()).fill(null);return this.getFactory().createMultiLineString(_.toArray(ee))},p.prototype.getGeometryType=function(){return"MultiPolygon"},p.prototype.copy=function(){for(var _=new Array(this._geometries.length).fill(null),S=0;S<_.length;S++)_[S]=this._geometries[S].copy();return new p(_,this._factory)},p.prototype.interfaces_=function(){return[Oe]},p.prototype.getClass=function(){return p},g.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(p,g),p}(Ti),si=l(function(c){this._factory=c||null,this._isUserDataCopied=!1},"ie"),Ci={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};si.prototype.setCopyUserData=function(c){this._isUserDataCopied=c},si.prototype.edit=function(c,p){if(c===null)return null;var g=this.editInternal(c,p);return this._isUserDataCopied&&g.setUserData(c.getUserData()),g},si.prototype.editInternal=function(c,p){return this._factory===null&&(this._factory=c.getFactory()),c instanceof Ti?this.editGeometryCollection(c,p):c instanceof pt?this.editPolygon(c,p):c instanceof Ge?p.edit(c,this._factory):c instanceof Pe?p.edit(c,this._factory):(pe.shouldNeverReachHere("Unsupported Geometry class: "+c.getClass().getName()),null)},si.prototype.editGeometryCollection=function(c,p){for(var g=p.edit(c,this._factory),_=new X,S=0;S<g.getNumGeometries();S++){var U=this.edit(g.getGeometryN(S),p);U===null||U.isEmpty()||_.add(U)}return g.getClass()===Ot?this._factory.createMultiPoint(_.toArray([])):g.getClass()===yn?this._factory.createMultiLineString(_.toArray([])):g.getClass()===$t?this._factory.createMultiPolygon(_.toArray([])):this._factory.createGeometryCollection(_.toArray([]))},si.prototype.editPolygon=function(c,p){var g=p.edit(c,this._factory);if(g===null&&(g=this._factory.createPolygon(null)),g.isEmpty())return g;var _=this.edit(g.getExteriorRing(),p);if(_===null||_.isEmpty())return this._factory.createPolygon();for(var S=new X,U=0;U<g.getNumInteriorRing();U++){var G=this.edit(g.getInteriorRingN(U),p);G===null||G.isEmpty()||S.add(G)}return this._factory.createPolygon(_,S.toArray([]))},si.prototype.interfaces_=function(){return[]},si.prototype.getClass=function(){return si},si.GeometryEditorOperation=function(){},Ci.NoOpGeometryOperation.get=function(){return xi},Ci.CoordinateOperation.get=function(){return ji},Ci.CoordinateSequenceOperation.get=function(){return Xi},Object.defineProperties(si,Ci);var xi=l(function(){},"oe");xi.prototype.edit=function(c,p){return c},xi.prototype.interfaces_=function(){return[si.GeometryEditorOperation]},xi.prototype.getClass=function(){return xi};var ji=l(function(){},"se");ji.prototype.edit=function(c,p){var g=this.editCoordinates(c.getCoordinates(),c);return g===null?c:c instanceof Ft?p.createLinearRing(g):c instanceof Pe?p.createLineString(g):c instanceof Ge?g.length>0?p.createPoint(g[0]):p.createPoint():c},ji.prototype.interfaces_=function(){return[si.GeometryEditorOperation]},ji.prototype.getClass=function(){return ji};var Xi=l(function(){},"ae");Xi.prototype.edit=function(c,p){return c instanceof Ft?p.createLinearRing(this.edit(c.getCoordinateSequence(),c)):c instanceof Pe?p.createLineString(this.edit(c.getCoordinateSequence(),c)):c instanceof Ge?p.createPoint(this.edit(c.getCoordinateSequence(),c)):c},Xi.prototype.interfaces_=function(){return[si.GeometryEditorOperation]},Xi.prototype.getClass=function(){return Xi};var ci=l(function(){if(this._dimension=3,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var c=arguments[0];this._coordinates=new Array(c).fill(null);for(var p=0;p<c;p++)this._coordinates[p]=new L}else if(J(arguments[0],Ie)){var g=arguments[0];if(g===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=g.getDimension(),this._coordinates=new Array(g.size()).fill(null);for(var _=0;_<this._coordinates.length;_++)this._coordinates[_]=g.getCoordinateCopy(_)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var S=arguments[0],U=arguments[1];this._coordinates=S,this._dimension=U,S===null&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var G=arguments[0],ee=arguments[1];this._coordinates=new Array(G).fill(null),this._dimension=ee;for(var ye=0;ye<G;ye++)this._coordinates[ye]=new L}}},"ue"),cn={serialVersionUID:{configurable:!0}};ci.prototype.setOrdinate=function(c,p,g){switch(p){case Ie.X:this._coordinates[c].x=g;break;case Ie.Y:this._coordinates[c].y=g;break;case Ie.Z:this._coordinates[c].z=g;break;default:throw new T("invalid ordinateIndex")}},ci.prototype.size=function(){return this._coordinates.length},ci.prototype.getOrdinate=function(c,p){switch(p){case Ie.X:return this._coordinates[c].x;case Ie.Y:return this._coordinates[c].y;case Ie.Z:return this._coordinates[c].z}return k.NaN},ci.prototype.getCoordinate=function(){if(arguments.length===1){var c=arguments[0];return this._coordinates[c]}if(arguments.length===2){var p=arguments[0],g=arguments[1];g.x=this._coordinates[p].x,g.y=this._coordinates[p].y,g.z=this._coordinates[p].z}},ci.prototype.getCoordinateCopy=function(c){return new L(this._coordinates[c])},ci.prototype.getDimension=function(){return this._dimension},ci.prototype.getX=function(c){return this._coordinates[c].x},ci.prototype.clone=function(){for(var c=new Array(this.size()).fill(null),p=0;p<this._coordinates.length;p++)c[p]=this._coordinates[p].clone();return new ci(c,this._dimension)},ci.prototype.expandEnvelope=function(c){for(var p=0;p<this._coordinates.length;p++)c.expandToInclude(this._coordinates[p]);return c},ci.prototype.copy=function(){for(var c=new Array(this.size()).fill(null),p=0;p<this._coordinates.length;p++)c[p]=this._coordinates[p].copy();return new ci(c,this._dimension)},ci.prototype.toString=function(){if(this._coordinates.length>0){var c=new K(17*this._coordinates.length);c.append("("),c.append(this._coordinates[0]);for(var p=1;p<this._coordinates.length;p++)c.append(", "),c.append(this._coordinates[p]);return c.append(")"),c.toString()}return"()"},ci.prototype.getY=function(c){return this._coordinates[c].y},ci.prototype.toCoordinateArray=function(){return this._coordinates},ci.prototype.interfaces_=function(){return[Ie,n]},ci.prototype.getClass=function(){return ci},cn.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(ci,cn);var Gi=l(function(){},"ce"),fi={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};Gi.prototype.readResolve=function(){return Gi.instance()},Gi.prototype.create=function(){if(arguments.length===1){if(arguments[0]instanceof Array){var c=arguments[0];return new ci(c)}if(J(arguments[0],Ie)){var p=arguments[0];return new ci(p)}}else if(arguments.length===2){var g=arguments[0],_=arguments[1];return _>3&&(_=3),_<2?new ci(g):new ci(g,_)}},Gi.prototype.interfaces_=function(){return[Z,n]},Gi.prototype.getClass=function(){return Gi},Gi.instance=function(){return Gi.instanceObject},fi.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},fi.instanceObject.get=function(){return new Gi},Object.defineProperties(Gi,fi);var vi=function(c){function p(){c.call(this),this.map_=new Map}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.get=function(g){return this.map_.get(g)||null},p.prototype.put=function(g,_){return this.map_.set(g,_),_},p.prototype.values=function(){for(var g=new X,_=this.map_.values(),S=_.next();!S.done;)g.add(S.value),S=_.next();return g},p.prototype.entrySet=function(){var g=new Ye;return this.map_.entries().forEach(function(_){return g.add(_)}),g},p.prototype.size=function(){return this.map_.size()},p}(Xe),Li=l(function c(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=c.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Qn){var p=arguments[0];this._modelType=p,p===c.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var g=arguments[0];this._modelType=c.FIXED,this.setScale(g)}else if(arguments[0]instanceof c){var _=arguments[0];this._modelType=_._modelType,this._scale=_._scale}}},"t"),Tr={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};Li.prototype.equals=function(c){if(!(c instanceof Li))return!1;var p=c;return this._modelType===p._modelType&&this._scale===p._scale},Li.prototype.compareTo=function(c){var p=c,g=this.getMaximumSignificantDigits(),_=p.getMaximumSignificantDigits();return new te(g).compareTo(new te(_))},Li.prototype.getScale=function(){return this._scale},Li.prototype.isFloating=function(){return this._modelType===Li.FLOATING||this._modelType===Li.FLOATING_SINGLE},Li.prototype.getType=function(){return this._modelType},Li.prototype.toString=function(){var c="UNKNOWN";return this._modelType===Li.FLOATING?c="Floating":this._modelType===Li.FLOATING_SINGLE?c="Floating-Single":this._modelType===Li.FIXED&&(c="Fixed (Scale="+this.getScale()+")"),c},Li.prototype.makePrecise=function(){if(typeof arguments[0]=="number"){var c=arguments[0];return k.isNaN(c)||this._modelType===Li.FLOATING_SINGLE?c:this._modelType===Li.FIXED?Math.round(c*this._scale)/this._scale:c}if(arguments[0]instanceof L){var p=arguments[0];if(this._modelType===Li.FLOATING)return null;p.x=this.makePrecise(p.x),p.y=this.makePrecise(p.y)}},Li.prototype.getMaximumSignificantDigits=function(){var c=16;return this._modelType===Li.FLOATING?c=16:this._modelType===Li.FLOATING_SINGLE?c=6:this._modelType===Li.FIXED&&(c=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),c},Li.prototype.setScale=function(c){this._scale=Math.abs(c)},Li.prototype.interfaces_=function(){return[n,B]},Li.prototype.getClass=function(){return Li},Li.mostPrecise=function(c,p){return c.compareTo(p)>=0?c:p},Tr.serialVersionUID.get=function(){return 7777263578777804e3},Tr.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(Li,Tr);var Qn=l(function c(p){this._name=p||null,c.nameToTypeMap.put(p,this)},"t"),Gn={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Qn.prototype.readResolve=function(){return Qn.nameToTypeMap.get(this._name)},Qn.prototype.toString=function(){return this._name},Qn.prototype.interfaces_=function(){return[n]},Qn.prototype.getClass=function(){return Qn},Gn.serialVersionUID.get=function(){return-552860263173159e4},Gn.nameToTypeMap.get=function(){return new vi},Object.defineProperties(Qn,Gn),Li.Type=Qn,Li.FIXED=new Qn("FIXED"),Li.FLOATING=new Qn("FLOATING"),Li.FLOATING_SINGLE=new Qn("FLOATING SINGLE");var _i=l(function c(){this._precisionModel=new Li,this._SRID=0,this._coordinateSequenceFactory=c.getDefaultCoordinateSequenceFactory(),arguments.length===0||(arguments.length===1?J(arguments[0],Z)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof Li&&(this._precisionModel=arguments[0]):arguments.length===2?(this._precisionModel=arguments[0],this._SRID=arguments[1]):arguments.length===3&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},"t"),x={serialVersionUID:{configurable:!0}};_i.prototype.toGeometry=function(c){return c.isNull()?this.createPoint(null):c.getMinX()===c.getMaxX()&&c.getMinY()===c.getMaxY()?this.createPoint(new L(c.getMinX(),c.getMinY())):c.getMinX()===c.getMaxX()||c.getMinY()===c.getMaxY()?this.createLineString([new L(c.getMinX(),c.getMinY()),new L(c.getMaxX(),c.getMaxY())]):this.createPolygon(this.createLinearRing([new L(c.getMinX(),c.getMinY()),new L(c.getMinX(),c.getMaxY()),new L(c.getMaxX(),c.getMaxY()),new L(c.getMaxX(),c.getMinY()),new L(c.getMinX(),c.getMinY())]),null)},_i.prototype.createLineString=function(c){return c?c instanceof Array?new Pe(this.getCoordinateSequenceFactory().create(c),this):J(c,Ie)?new Pe(c,this):void 0:new Pe(this.getCoordinateSequenceFactory().create([]),this)},_i.prototype.createMultiLineString=function(){if(arguments.length===0)return new yn(null,this);if(arguments.length===1){var c=arguments[0];return new yn(c,this)}},_i.prototype.buildGeometry=function(c){for(var p=null,g=!1,_=!1,S=c.iterator();S.hasNext();){var U=S.next(),G=U.getClass();p===null&&(p=G),G!==p&&(g=!0),U.isGeometryCollectionOrDerived()&&(_=!0)}if(p===null)return this.createGeometryCollection();if(g||_)return this.createGeometryCollection(_i.toGeometryArray(c));var ee=c.iterator().next();if(c.size()>1){if(ee instanceof pt)return this.createMultiPolygon(_i.toPolygonArray(c));if(ee instanceof Pe)return this.createMultiLineString(_i.toLineStringArray(c));if(ee instanceof Ge)return this.createMultiPoint(_i.toPointArray(c));pe.shouldNeverReachHere("Unhandled class: "+ee.getClass().getName())}return ee},_i.prototype.createMultiPointFromCoords=function(c){return this.createMultiPoint(c!==null?this.getCoordinateSequenceFactory().create(c):null)},_i.prototype.createPoint=function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof L){var c=arguments[0];return this.createPoint(c!==null?this.getCoordinateSequenceFactory().create([c]):null)}if(J(arguments[0],Ie)){var p=arguments[0];return new Ge(p,this)}}},_i.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},_i.prototype.createPolygon=function(){if(arguments.length===0)return new pt(null,null,this);if(arguments.length===1){if(J(arguments[0],Ie)){var c=arguments[0];return this.createPolygon(this.createLinearRing(c))}if(arguments[0]instanceof Array){var p=arguments[0];return this.createPolygon(this.createLinearRing(p))}if(arguments[0]instanceof Ft){var g=arguments[0];return this.createPolygon(g,null)}}else if(arguments.length===2){var _=arguments[0],S=arguments[1];return new pt(_,S,this)}},_i.prototype.getSRID=function(){return this._SRID},_i.prototype.createGeometryCollection=function(){if(arguments.length===0)return new Ti(null,this);if(arguments.length===1){var c=arguments[0];return new Ti(c,this)}},_i.prototype.createGeometry=function(c){return new si(this).edit(c,{edit:l(function(){if(arguments.length===2){var p=arguments[0];return this._coordinateSequenceFactory.create(p)}},"edit")})},_i.prototype.getPrecisionModel=function(){return this._precisionModel},_i.prototype.createLinearRing=function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var c=arguments[0];return this.createLinearRing(c!==null?this.getCoordinateSequenceFactory().create(c):null)}if(J(arguments[0],Ie)){var p=arguments[0];return new Ft(p,this)}}},_i.prototype.createMultiPolygon=function(){if(arguments.length===0)return new $t(null,this);if(arguments.length===1){var c=arguments[0];return new $t(c,this)}},_i.prototype.createMultiPoint=function(){if(arguments.length===0)return new Ot(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){var c=arguments[0];return new Ot(c,this)}if(arguments[0]instanceof Array){var p=arguments[0];return this.createMultiPoint(p!==null?this.getCoordinateSequenceFactory().create(p):null)}if(J(arguments[0],Ie)){var g=arguments[0];if(g===null)return this.createMultiPoint(new Array(0).fill(null));for(var _=new Array(g.size()).fill(null),S=0;S<g.size();S++){var U=this.getCoordinateSequenceFactory().create(1,g.getDimension());ue.copy(g,S,U,0,1),_[S]=this.createPoint(U)}return this.createMultiPoint(_)}}},_i.prototype.interfaces_=function(){return[n]},_i.prototype.getClass=function(){return _i},_i.toMultiPolygonArray=function(c){var p=new Array(c.size()).fill(null);return c.toArray(p)},_i.toGeometryArray=function(c){if(c===null)return null;var p=new Array(c.size()).fill(null);return c.toArray(p)},_i.getDefaultCoordinateSequenceFactory=function(){return Gi.instance()},_i.toMultiLineStringArray=function(c){var p=new Array(c.size()).fill(null);return c.toArray(p)},_i.toLineStringArray=function(c){var p=new Array(c.size()).fill(null);return c.toArray(p)},_i.toMultiPointArray=function(c){var p=new Array(c.size()).fill(null);return c.toArray(p)},_i.toLinearRingArray=function(c){var p=new Array(c.size()).fill(null);return c.toArray(p)},_i.toPointArray=function(c){var p=new Array(c.size()).fill(null);return c.toArray(p)},_i.toPolygonArray=function(c){var p=new Array(c.size()).fill(null);return c.toArray(p)},_i.createPointFromInternalCoord=function(c,p){return p.getPrecisionModel().makePrecise(c),p.getFactory().createPoint(c)},x.serialVersionUID.get=function(){return-6820524753094096e3},Object.defineProperties(_i,x);var M=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],P=l(function(c){this.geometryFactory=c||new _i},"Ie");P.prototype.read=function(c){var p,g=(p=typeof c=="string"?JSON.parse(c):c).type;if(!V[g])throw new Error("Unknown GeoJSON type: "+p.type);return M.indexOf(g)!==-1?V[g].apply(this,[p.coordinates]):g==="GeometryCollection"?V[g].apply(this,[p.geometries]):V[g].apply(this,[p])},P.prototype.write=function(c){var p=c.getGeometryType();if(!H[p])throw new Error("Geometry is not supported");return H[p].apply(this,[c])};var V={Feature:l(function(c){var p={};for(var g in c)p[g]=c[g];if(c.geometry){var _=c.geometry.type;if(!V[_])throw new Error("Unknown GeoJSON type: "+c.type);p.geometry=this.read(c.geometry)}return c.bbox&&(p.bbox=V.bbox.apply(this,[c.bbox])),p},"Feature"),FeatureCollection:l(function(c){var p={};if(c.features){p.features=[];for(var g=0;g<c.features.length;++g)p.features.push(this.read(c.features[g]))}return c.bbox&&(p.bbox=this.parse.bbox.apply(this,[c.bbox])),p},"FeatureCollection"),coordinates:l(function(c){for(var p=[],g=0;g<c.length;++g){var _=c[g];p.push(new L(_[0],_[1]))}return p},"coordinates"),bbox:l(function(c){return this.geometryFactory.createLinearRing([new L(c[0],c[1]),new L(c[2],c[1]),new L(c[2],c[3]),new L(c[0],c[3]),new L(c[0],c[1])])},"bbox"),Point:l(function(c){var p=new L(c[0],c[1]);return this.geometryFactory.createPoint(p)},"Point"),MultiPoint:l(function(c){for(var p=[],g=0;g<c.length;++g)p.push(V.Point.apply(this,[c[g]]));return this.geometryFactory.createMultiPoint(p)},"MultiPoint"),LineString:l(function(c){var p=V.coordinates.apply(this,[c]);return this.geometryFactory.createLineString(p)},"LineString"),MultiLineString:l(function(c){for(var p=[],g=0;g<c.length;++g)p.push(V.LineString.apply(this,[c[g]]));return this.geometryFactory.createMultiLineString(p)},"MultiLineString"),Polygon:l(function(c){for(var p=V.coordinates.apply(this,[c[0]]),g=this.geometryFactory.createLinearRing(p),_=[],S=1;S<c.length;++S){var U=c[S],G=V.coordinates.apply(this,[U]),ee=this.geometryFactory.createLinearRing(G);_.push(ee)}return this.geometryFactory.createPolygon(g,_)},"Polygon"),MultiPolygon:l(function(c){for(var p=[],g=0;g<c.length;++g){var _=c[g];p.push(V.Polygon.apply(this,[_]))}return this.geometryFactory.createMultiPolygon(p)},"MultiPolygon"),GeometryCollection:l(function(c){for(var p=[],g=0;g<c.length;++g){var _=c[g];p.push(this.read(_))}return this.geometryFactory.createGeometryCollection(p)},"GeometryCollection")},H={coordinate:l(function(c){return[c.x,c.y]},"coordinate"),Point:l(function(c){return{type:"Point",coordinates:H.coordinate.apply(this,[c.getCoordinate()])}},"Point"),MultiPoint:l(function(c){for(var p=[],g=0;g<c._geometries.length;++g){var _=c._geometries[g],S=H.Point.apply(this,[_]);p.push(S.coordinates)}return{type:"MultiPoint",coordinates:p}},"MultiPoint"),LineString:l(function(c){for(var p=[],g=c.getCoordinates(),_=0;_<g.length;++_){var S=g[_];p.push(H.coordinate.apply(this,[S]))}return{type:"LineString",coordinates:p}},"LineString"),MultiLineString:l(function(c){for(var p=[],g=0;g<c._geometries.length;++g){var _=c._geometries[g],S=H.LineString.apply(this,[_]);p.push(S.coordinates)}return{type:"MultiLineString",coordinates:p}},"MultiLineString"),Polygon:l(function(c){var p=[],g=H.LineString.apply(this,[c._shell]);p.push(g.coordinates);for(var _=0;_<c._holes.length;++_){var S=c._holes[_],U=H.LineString.apply(this,[S]);p.push(U.coordinates)}return{type:"Polygon",coordinates:p}},"Polygon"),MultiPolygon:l(function(c){for(var p=[],g=0;g<c._geometries.length;++g){var _=c._geometries[g],S=H.Polygon.apply(this,[_]);p.push(S.coordinates)}return{type:"MultiPolygon",coordinates:p}},"MultiPolygon"),GeometryCollection:l(function(c){for(var p=[],g=0;g<c._geometries.length;++g){var _=c._geometries[g],S=_.getGeometryType();p.push(H[S].apply(this,[_]))}return{type:"GeometryCollection",geometries:p}},"GeometryCollection")},ne=l(function(c){this.geometryFactory=c||new _i,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new P(this.geometryFactory)},"Ne");ne.prototype.read=function(c){var p=this.parser.read(c);return this.precisionModel.getType()===Li.FIXED&&this.reducePrecision(p),p},ne.prototype.reducePrecision=function(c){var p,g;if(c.coordinate)this.precisionModel.makePrecise(c.coordinate);else if(c.points)for(p=0,g=c.points.length;p<g;p++)this.precisionModel.makePrecise(c.points[p]);else if(c.geometries)for(p=0,g=c.geometries.length;p<g;p++)this.reducePrecision(c.geometries[p])};var le=l(function(){this.parser=new P(this.geometryFactory)},"Ce");le.prototype.write=function(c){return this.parser.write(c)};var ce=l(function(){},"Se"),ze={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};ce.prototype.interfaces_=function(){return[]},ce.prototype.getClass=function(){return ce},ce.opposite=function(c){return c===ce.LEFT?ce.RIGHT:c===ce.RIGHT?ce.LEFT:c},ze.ON.get=function(){return 0},ze.LEFT.get=function(){return 1},ze.RIGHT.get=function(){return 2},Object.defineProperties(ce,ze),(E.prototype=new Error).name="EmptyStackException",(I.prototype=new W).add=function(c){return this.array_.push(c),!0},I.prototype.get=function(c){if(c<0||c>=this.size())throw new Error;return this.array_[c]},I.prototype.push=function(c){return this.array_.push(c),c},I.prototype.pop=function(c){if(this.array_.length===0)throw new E;return this.array_.pop()},I.prototype.peek=function(){if(this.array_.length===0)throw new E;return this.array_[this.array_.length-1]},I.prototype.empty=function(){return this.array_.length===0},I.prototype.isEmpty=function(){return this.empty()},I.prototype.search=function(c){return this.array_.indexOf(c)},I.prototype.size=function(){return this.array_.length},I.prototype.toArray=function(){for(var c=[],p=0,g=this.array_.length;p<g;p++)c.push(this.array_[p]);return c};var qe=l(function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null},"be");qe.prototype.getCoordinate=function(){return this._minCoord},qe.prototype.getRightmostSide=function(c,p){var g=this.getRightmostSideOfSegment(c,p);return g<0&&(g=this.getRightmostSideOfSegment(c,p-1)),g<0&&(this._minCoord=null,this.checkForRightmostCoordinate(c)),g},qe.prototype.findRightmostEdgeAtVertex=function(){var c=this._minDe.getEdge().getCoordinates();pe.isTrue(this._minIndex>0&&this._minIndex<c.length,"rightmost point expected to be interior vertex of edge");var p=c[this._minIndex-1],g=c[this._minIndex+1],_=Qe.computeOrientation(this._minCoord,g,p),S=!1;(p.y<this._minCoord.y&&g.y<this._minCoord.y&&_===Qe.COUNTERCLOCKWISE||p.y>this._minCoord.y&&g.y>this._minCoord.y&&_===Qe.CLOCKWISE)&&(S=!0),S&&(this._minIndex=this._minIndex-1)},qe.prototype.getRightmostSideOfSegment=function(c,p){var g=c.getEdge().getCoordinates();if(p<0||p+1>=g.length||g[p].y===g[p+1].y)return-1;var _=ce.LEFT;return g[p].y<g[p+1].y&&(_=ce.RIGHT),_},qe.prototype.getEdge=function(){return this._orientedDe},qe.prototype.checkForRightmostCoordinate=function(c){for(var p=c.getEdge().getCoordinates(),g=0;g<p.length-1;g++)(this._minCoord===null||p[g].x>this._minCoord.x)&&(this._minDe=c,this._minIndex=g,this._minCoord=p[g])},qe.prototype.findRightmostEdgeAtNode=function(){var c=this._minDe.getNode().getEdges();this._minDe=c.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},qe.prototype.findEdge=function(c){for(var p=c.iterator();p.hasNext();){var g=p.next();g.isForward()&&this.checkForRightmostCoordinate(g)}pe.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===ce.LEFT&&(this._orientedDe=this._minDe.getSym())},qe.prototype.interfaces_=function(){return[]},qe.prototype.getClass=function(){return qe};var mt=function(c){function p(g,_){c.call(this,p.msgWithCoord(g,_)),this.pt=_?new L(_):null,this.name="TopologyException"}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.getCoordinate=function(){return this.pt},p.prototype.interfaces_=function(){return[]},p.prototype.getClass=function(){return p},p.msgWithCoord=function(g,_){return _?g:g+" [ "+_+" ]"},p}(Lt),Ct=l(function(){this.array_=[]},"Oe");Ct.prototype.addLast=function(c){this.array_.push(c)},Ct.prototype.removeFirst=function(){return this.array_.shift()},Ct.prototype.isEmpty=function(){return this.array_.length===0};var Bt=l(function(){this._finder=null,this._dirEdgeList=new X,this._nodes=new X,this._rightMostCoord=null,this._env=null,this._finder=new qe},"Te");Bt.prototype.clearVisitedEdges=function(){for(var c=this._dirEdgeList.iterator();c.hasNext();)c.next().setVisited(!1)},Bt.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},Bt.prototype.computeNodeDepth=function(c){for(var p=null,g=c.getEdges().iterator();g.hasNext();){var _=g.next();if(_.isVisited()||_.getSym().isVisited()){p=_;break}}if(p===null)throw new mt("unable to find edge to compute depths at "+c.getCoordinate());c.getEdges().computeDepths(p);for(var S=c.getEdges().iterator();S.hasNext();){var U=S.next();U.setVisited(!0),this.copySymDepths(U)}},Bt.prototype.computeDepth=function(c){this.clearVisitedEdges();var p=this._finder.getEdge();p.setEdgeDepths(ce.RIGHT,c),this.copySymDepths(p),this.computeDepths(p)},Bt.prototype.create=function(c){this.addReachable(c),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},Bt.prototype.findResultEdges=function(){for(var c=this._dirEdgeList.iterator();c.hasNext();){var p=c.next();p.getDepth(ce.RIGHT)>=1&&p.getDepth(ce.LEFT)<=0&&!p.isInteriorAreaEdge()&&p.setInResult(!0)}},Bt.prototype.computeDepths=function(c){var p=new Ye,g=new Ct,_=c.getNode();for(g.addLast(_),p.add(_),c.setVisited(!0);!g.isEmpty();){var S=g.removeFirst();p.add(S),this.computeNodeDepth(S);for(var U=S.getEdges().iterator();U.hasNext();){var G=U.next().getSym();if(!G.isVisited()){var ee=G.getNode();p.contains(ee)||(g.addLast(ee),p.add(ee))}}}},Bt.prototype.compareTo=function(c){var p=c;return this._rightMostCoord.x<p._rightMostCoord.x?-1:this._rightMostCoord.x>p._rightMostCoord.x?1:0},Bt.prototype.getEnvelope=function(){if(this._env===null){for(var c=new xe,p=this._dirEdgeList.iterator();p.hasNext();)for(var g=p.next().getEdge().getCoordinates(),_=0;_<g.length-1;_++)c.expandToInclude(g[_]);this._env=c}return this._env},Bt.prototype.addReachable=function(c){var p=new I;for(p.add(c);!p.empty();){var g=p.pop();this.add(g,p)}},Bt.prototype.copySymDepths=function(c){var p=c.getSym();p.setDepth(ce.LEFT,c.getDepth(ce.RIGHT)),p.setDepth(ce.RIGHT,c.getDepth(ce.LEFT))},Bt.prototype.add=function(c,p){c.setVisited(!0),this._nodes.add(c);for(var g=c.getEdges().iterator();g.hasNext();){var _=g.next();this._dirEdgeList.add(_);var S=_.getSym().getNode();S.isVisited()||p.push(S)}},Bt.prototype.getNodes=function(){return this._nodes},Bt.prototype.getDirectedEdges=function(){return this._dirEdgeList},Bt.prototype.interfaces_=function(){return[B]},Bt.prototype.getClass=function(){return Bt};var Ut=l(function c(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var p=arguments[0];this.init(p.length)}else if(Number.isInteger(arguments[0])){var g=arguments[0];this.init(1),this.location[ce.ON]=g}else if(arguments[0]instanceof c){var _=arguments[0];if(this.init(_.location.length),_!==null)for(var S=0;S<this.location.length;S++)this.location[S]=_.location[S]}}else if(arguments.length===3){var U=arguments[0],G=arguments[1],ee=arguments[2];this.init(3),this.location[ce.ON]=U,this.location[ce.LEFT]=G,this.location[ce.RIGHT]=ee}},"t");Ut.prototype.setAllLocations=function(c){for(var p=0;p<this.location.length;p++)this.location[p]=c},Ut.prototype.isNull=function(){for(var c=0;c<this.location.length;c++)if(this.location[c]!==O.NONE)return!1;return!0},Ut.prototype.setAllLocationsIfNull=function(c){for(var p=0;p<this.location.length;p++)this.location[p]===O.NONE&&(this.location[p]=c)},Ut.prototype.isLine=function(){return this.location.length===1},Ut.prototype.merge=function(c){if(c.location.length>this.location.length){var p=new Array(3).fill(null);p[ce.ON]=this.location[ce.ON],p[ce.LEFT]=O.NONE,p[ce.RIGHT]=O.NONE,this.location=p}for(var g=0;g<this.location.length;g++)this.location[g]===O.NONE&&g<c.location.length&&(this.location[g]=c.location[g])},Ut.prototype.getLocations=function(){return this.location},Ut.prototype.flip=function(){if(this.location.length<=1)return null;var c=this.location[ce.LEFT];this.location[ce.LEFT]=this.location[ce.RIGHT],this.location[ce.RIGHT]=c},Ut.prototype.toString=function(){var c=new K;return this.location.length>1&&c.append(O.toLocationSymbol(this.location[ce.LEFT])),c.append(O.toLocationSymbol(this.location[ce.ON])),this.location.length>1&&c.append(O.toLocationSymbol(this.location[ce.RIGHT])),c.toString()},Ut.prototype.setLocations=function(c,p,g){this.location[ce.ON]=c,this.location[ce.LEFT]=p,this.location[ce.RIGHT]=g},Ut.prototype.get=function(c){return c<this.location.length?this.location[c]:O.NONE},Ut.prototype.isArea=function(){return this.location.length>1},Ut.prototype.isAnyNull=function(){for(var c=0;c<this.location.length;c++)if(this.location[c]===O.NONE)return!0;return!1},Ut.prototype.setLocation=function(){if(arguments.length===1){var c=arguments[0];this.setLocation(ce.ON,c)}else if(arguments.length===2){var p=arguments[0],g=arguments[1];this.location[p]=g}},Ut.prototype.init=function(c){this.location=new Array(c).fill(null),this.setAllLocations(O.NONE)},Ut.prototype.isEqualOnSide=function(c,p){return this.location[p]===c.location[p]},Ut.prototype.allPositionsEqual=function(c){for(var p=0;p<this.location.length;p++)if(this.location[p]!==c)return!1;return!0},Ut.prototype.interfaces_=function(){return[]},Ut.prototype.getClass=function(){return Ut};var It=l(function c(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var p=arguments[0];this.elt[0]=new Ut(p),this.elt[1]=new Ut(p)}else if(arguments[0]instanceof c){var g=arguments[0];this.elt[0]=new Ut(g.elt[0]),this.elt[1]=new Ut(g.elt[1])}}else if(arguments.length===2){var _=arguments[0],S=arguments[1];this.elt[0]=new Ut(O.NONE),this.elt[1]=new Ut(O.NONE),this.elt[_].setLocation(S)}else if(arguments.length===3){var U=arguments[0],G=arguments[1],ee=arguments[2];this.elt[0]=new Ut(U,G,ee),this.elt[1]=new Ut(U,G,ee)}else if(arguments.length===4){var ye=arguments[0],Te=arguments[1],et=arguments[2],it=arguments[3];this.elt[0]=new Ut(O.NONE,O.NONE,O.NONE),this.elt[1]=new Ut(O.NONE,O.NONE,O.NONE),this.elt[ye].setLocations(Te,et,it)}},"t");It.prototype.getGeometryCount=function(){var c=0;return this.elt[0].isNull()||c++,this.elt[1].isNull()||c++,c},It.prototype.setAllLocations=function(c,p){this.elt[c].setAllLocations(p)},It.prototype.isNull=function(c){return this.elt[c].isNull()},It.prototype.setAllLocationsIfNull=function(){if(arguments.length===1){var c=arguments[0];this.setAllLocationsIfNull(0,c),this.setAllLocationsIfNull(1,c)}else if(arguments.length===2){var p=arguments[0],g=arguments[1];this.elt[p].setAllLocationsIfNull(g)}},It.prototype.isLine=function(c){return this.elt[c].isLine()},It.prototype.merge=function(c){for(var p=0;p<2;p++)this.elt[p]===null&&c.elt[p]!==null?this.elt[p]=new Ut(c.elt[p]):this.elt[p].merge(c.elt[p])},It.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},It.prototype.getLocation=function(){if(arguments.length===1){var c=arguments[0];return this.elt[c].get(ce.ON)}if(arguments.length===2){var p=arguments[0],g=arguments[1];return this.elt[p].get(g)}},It.prototype.toString=function(){var c=new K;return this.elt[0]!==null&&(c.append("A:"),c.append(this.elt[0].toString())),this.elt[1]!==null&&(c.append(" B:"),c.append(this.elt[1].toString())),c.toString()},It.prototype.isArea=function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var c=arguments[0];return this.elt[c].isArea()}},It.prototype.isAnyNull=function(c){return this.elt[c].isAnyNull()},It.prototype.setLocation=function(){if(arguments.length===2){var c=arguments[0],p=arguments[1];this.elt[c].setLocation(ce.ON,p)}else if(arguments.length===3){var g=arguments[0],_=arguments[1],S=arguments[2];this.elt[g].setLocation(_,S)}},It.prototype.isEqualOnSide=function(c,p){return this.elt[0].isEqualOnSide(c.elt[0],p)&&this.elt[1].isEqualOnSide(c.elt[1],p)},It.prototype.allPositionsEqual=function(c,p){return this.elt[c].allPositionsEqual(p)},It.prototype.toLine=function(c){this.elt[c].isArea()&&(this.elt[c]=new Ut(this.elt[c].location[0]))},It.prototype.interfaces_=function(){return[]},It.prototype.getClass=function(){return It},It.toLineLabel=function(c){for(var p=new It(O.NONE),g=0;g<2;g++)p.setLocation(g,c.getLocation(g));return p};var ei=l(function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new X,this._pts=new X,this._label=new It(O.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new X,this._geometryFactory=null;var c=arguments[0],p=arguments[1];this._geometryFactory=p,this.computePoints(c),this.computeRing()},"De");ei.prototype.computeRing=function(){if(this._ring!==null)return null;for(var c=new Array(this._pts.size()).fill(null),p=0;p<this._pts.size();p++)c[p]=this._pts.get(p);this._ring=this._geometryFactory.createLinearRing(c),this._isHole=Qe.isCCW(this._ring.getCoordinates())},ei.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},ei.prototype.computePoints=function(c){this._startDe=c;var p=c,g=!0;do{if(p===null)throw new mt("Found null DirectedEdge");if(p.getEdgeRing()===this)throw new mt("Directed Edge visited twice during ring-building at "+p.getCoordinate());this._edges.add(p);var _=p.getLabel();pe.isTrue(_.isArea()),this.mergeLabel(_),this.addPoints(p.getEdge(),p.isForward(),g),g=!1,this.setEdgeRing(p,this),p=this.getNext(p)}while(p!==this._startDe)},ei.prototype.getLinearRing=function(){return this._ring},ei.prototype.getCoordinate=function(c){return this._pts.get(c)},ei.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var c=this._startDe;do{var p=c.getNode().getEdges().getOutgoingDegree(this);p>this._maxNodeDegree&&(this._maxNodeDegree=p),c=this.getNext(c)}while(c!==this._startDe);this._maxNodeDegree*=2},ei.prototype.addPoints=function(c,p,g){var _=c.getCoordinates();if(p){var S=1;g&&(S=0);for(var U=S;U<_.length;U++)this._pts.add(_[U])}else{var G=_.length-2;g&&(G=_.length-1);for(var ee=G;ee>=0;ee--)this._pts.add(_[ee])}},ei.prototype.isHole=function(){return this._isHole},ei.prototype.setInResult=function(){var c=this._startDe;do c.getEdge().setInResult(!0),c=c.getNext();while(c!==this._startDe)},ei.prototype.containsPoint=function(c){var p=this.getLinearRing();if(!p.getEnvelopeInternal().contains(c)||!Qe.isPointInRing(c,p.getCoordinates()))return!1;for(var g=this._holes.iterator();g.hasNext();)if(g.next().containsPoint(c))return!1;return!0},ei.prototype.addHole=function(c){this._holes.add(c)},ei.prototype.isShell=function(){return this._shell===null},ei.prototype.getLabel=function(){return this._label},ei.prototype.getEdges=function(){return this._edges},ei.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},ei.prototype.getShell=function(){return this._shell},ei.prototype.mergeLabel=function(){if(arguments.length===1){var c=arguments[0];this.mergeLabel(c,0),this.mergeLabel(c,1)}else if(arguments.length===2){var p=arguments[0],g=arguments[1],_=p.getLocation(g,ce.RIGHT);if(_===O.NONE)return null;if(this._label.getLocation(g)===O.NONE)return this._label.setLocation(g,_),null}},ei.prototype.setShell=function(c){this._shell=c,c!==null&&c.addHole(this)},ei.prototype.toPolygon=function(c){for(var p=new Array(this._holes.size()).fill(null),g=0;g<this._holes.size();g++)p[g]=this._holes.get(g).getLinearRing();return c.createPolygon(this.getLinearRing(),p)},ei.prototype.interfaces_=function(){return[]},ei.prototype.getClass=function(){return ei};var Nn=function(c){function p(){var g=arguments[0],_=arguments[1];c.call(this,g,_)}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.setEdgeRing=function(g,_){g.setMinEdgeRing(_)},p.prototype.getNext=function(g){return g.getNextMin()},p.prototype.interfaces_=function(){return[]},p.prototype.getClass=function(){return p},p}(ei),rr=function(c){function p(){var g=arguments[0],_=arguments[1];c.call(this,g,_)}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.buildMinimalRings=function(){var g=new X,_=this._startDe;do{if(_.getMinEdgeRing()===null){var S=new Nn(_,this._geometryFactory);g.add(S)}_=_.getNext()}while(_!==this._startDe);return g},p.prototype.setEdgeRing=function(g,_){g.setEdgeRing(_)},p.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var g=this._startDe;do g.getNode().getEdges().linkMinimalDirectedEdges(this),g=g.getNext();while(g!==this._startDe)},p.prototype.getNext=function(g){return g.getNext()},p.prototype.interfaces_=function(){return[]},p.prototype.getClass=function(){return p},p}(ei),Pn=l(function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0&&arguments.length===1){var c=arguments[0];this._label=c}},"Fe");Pn.prototype.setVisited=function(c){this._isVisited=c},Pn.prototype.setInResult=function(c){this._isInResult=c},Pn.prototype.isCovered=function(){return this._isCovered},Pn.prototype.isCoveredSet=function(){return this._isCoveredSet},Pn.prototype.setLabel=function(c){this._label=c},Pn.prototype.getLabel=function(){return this._label},Pn.prototype.setCovered=function(c){this._isCovered=c,this._isCoveredSet=!0},Pn.prototype.updateIM=function(c){pe.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(c)},Pn.prototype.isInResult=function(){return this._isInResult},Pn.prototype.isVisited=function(){return this._isVisited},Pn.prototype.interfaces_=function(){return[]},Pn.prototype.getClass=function(){return Pn};var xs=function(c){function p(){c.call(this),this._coord=null,this._edges=null;var g=arguments[0],_=arguments[1];this._coord=g,this._edges=_,this._label=new It(0,O.NONE)}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.isIncidentEdgeInResult=function(){for(var g=this.getEdges().getEdges().iterator();g.hasNext();)if(g.next().getEdge().isInResult())return!0;return!1},p.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},p.prototype.getCoordinate=function(){return this._coord},p.prototype.print=function(g){g.println("node "+this._coord+" lbl: "+this._label)},p.prototype.computeIM=function(g){},p.prototype.computeMergedLocation=function(g,_){var S=O.NONE;if(S=this._label.getLocation(_),!g.isNull(_)){var U=g.getLocation(_);S!==O.BOUNDARY&&(S=U)}return S},p.prototype.setLabel=function(){if(arguments.length!==2)return c.prototype.setLabel.apply(this,arguments);var g=arguments[0],_=arguments[1];this._label===null?this._label=new It(g,_):this._label.setLocation(g,_)},p.prototype.getEdges=function(){return this._edges},p.prototype.mergeLabel=function(){if(arguments[0]instanceof p){var g=arguments[0];this.mergeLabel(g._label)}else if(arguments[0]instanceof It)for(var _=arguments[0],S=0;S<2;S++){var U=this.computeMergedLocation(_,S);this._label.getLocation(S)===O.NONE&&this._label.setLocation(S,U)}},p.prototype.add=function(g){this._edges.insert(g),g.setNode(this)},p.prototype.setLabelBoundary=function(g){if(this._label===null)return null;var _=O.NONE;this._label!==null&&(_=this._label.getLocation(g));var S=null;switch(_){case O.BOUNDARY:S=O.INTERIOR;break;case O.INTERIOR:default:S=O.BOUNDARY}this._label.setLocation(g,S)},p.prototype.interfaces_=function(){return[]},p.prototype.getClass=function(){return p},p}(Pn),zr=l(function(){this.nodeMap=new v,this.nodeFact=null;var c=arguments[0];this.nodeFact=c},"qe");zr.prototype.find=function(c){return this.nodeMap.get(c)},zr.prototype.addNode=function(){if(arguments[0]instanceof L){var c=arguments[0],p=this.nodeMap.get(c);return p===null&&(p=this.nodeFact.createNode(c),this.nodeMap.put(c,p)),p}if(arguments[0]instanceof xs){var g=arguments[0],_=this.nodeMap.get(g.getCoordinate());return _===null?(this.nodeMap.put(g.getCoordinate(),g),g):(_.mergeLabel(g),_)}},zr.prototype.print=function(c){for(var p=this.iterator();p.hasNext();)p.next().print(c)},zr.prototype.iterator=function(){return this.nodeMap.values().iterator()},zr.prototype.values=function(){return this.nodeMap.values()},zr.prototype.getBoundaryNodes=function(c){for(var p=new X,g=this.iterator();g.hasNext();){var _=g.next();_.getLabel().getLocation(c)===O.BOUNDARY&&p.add(_)}return p},zr.prototype.add=function(c){var p=c.getCoordinate();this.addNode(p).add(c)},zr.prototype.interfaces_=function(){return[]},zr.prototype.getClass=function(){return zr};var Bi=l(function(){},"Be"),Ma={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};Bi.prototype.interfaces_=function(){return[]},Bi.prototype.getClass=function(){return Bi},Bi.isNorthern=function(c){return c===Bi.NE||c===Bi.NW},Bi.isOpposite=function(c,p){return c===p?!1:(c-p+4)%4===2},Bi.commonHalfPlane=function(c,p){if(c===p)return c;if((c-p+4)%4===2)return-1;var g=c<p?c:p;return g===0&&(c>p?c:p)===3?3:g},Bi.isInHalfPlane=function(c,p){return p===Bi.SE?c===Bi.SE||c===Bi.SW:c===p||c===p+1},Bi.quadrant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var c=arguments[0],p=arguments[1];if(c===0&&p===0)throw new T("Cannot compute the quadrant for point ( "+c+", "+p+" )");return c>=0?p>=0?Bi.NE:Bi.SE:p>=0?Bi.NW:Bi.SW}if(arguments[0]instanceof L&&arguments[1]instanceof L){var g=arguments[0],_=arguments[1];if(_.x===g.x&&_.y===g.y)throw new T("Cannot compute the quadrant for two identical points "+g);return _.x>=g.x?_.y>=g.y?Bi.NE:Bi.SE:_.y>=g.y?Bi.NW:Bi.SW}},Ma.NE.get=function(){return 0},Ma.NW.get=function(){return 1},Ma.SW.get=function(){return 2},Ma.SE.get=function(){return 3},Object.defineProperties(Bi,Ma);var vn=l(function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var c=arguments[0];this._edge=c}else if(arguments.length===3){var p=arguments[0],g=arguments[1],_=arguments[2];this._edge=p,this.init(g,_),this._label=null}else if(arguments.length===4){var S=arguments[0],U=arguments[1],G=arguments[2],ee=arguments[3];this._edge=S,this.init(U,G),this._label=ee}},"Ue");vn.prototype.compareDirection=function(c){return this._dx===c._dx&&this._dy===c._dy?0:this._quadrant>c._quadrant?1:this._quadrant<c._quadrant?-1:Qe.computeOrientation(c._p0,c._p1,this._p1)},vn.prototype.getDy=function(){return this._dy},vn.prototype.getCoordinate=function(){return this._p0},vn.prototype.setNode=function(c){this._node=c},vn.prototype.print=function(c){var p=Math.atan2(this._dy,this._dx),g=this.getClass().getName(),_=g.lastIndexOf("."),S=g.substring(_+1);c.print("  "+S+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+p+"   "+this._label)},vn.prototype.compareTo=function(c){var p=c;return this.compareDirection(p)},vn.prototype.getDirectedCoordinate=function(){return this._p1},vn.prototype.getDx=function(){return this._dx},vn.prototype.getLabel=function(){return this._label},vn.prototype.getEdge=function(){return this._edge},vn.prototype.getQuadrant=function(){return this._quadrant},vn.prototype.getNode=function(){return this._node},vn.prototype.toString=function(){var c=Math.atan2(this._dy,this._dx),p=this.getClass().getName(),g=p.lastIndexOf(".");return"  "+p.substring(g+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+c+"   "+this._label},vn.prototype.computeLabel=function(c){},vn.prototype.init=function(c,p){this._p0=c,this._p1=p,this._dx=p.x-c.x,this._dy=p.y-c.y,this._quadrant=Bi.quadrant(this._dx,this._dy),pe.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")},vn.prototype.interfaces_=function(){return[B]},vn.prototype.getClass=function(){return vn};var Jo=function(c){function p(){var g=arguments[0],_=arguments[1];if(c.call(this,g),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=_,_)this.init(g.getCoordinate(0),g.getCoordinate(1));else{var S=g.getNumPoints()-1;this.init(g.getCoordinate(S),g.getCoordinate(S-1))}this.computeDirectedLabel()}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.getNextMin=function(){return this._nextMin},p.prototype.getDepth=function(g){return this._depth[g]},p.prototype.setVisited=function(g){this._isVisited=g},p.prototype.computeDirectedLabel=function(){this._label=new It(this._edge.getLabel()),this._isForward||this._label.flip()},p.prototype.getNext=function(){return this._next},p.prototype.setDepth=function(g,_){if(this._depth[g]!==-999&&this._depth[g]!==_)throw new mt("assigned depths do not match",this.getCoordinate());this._depth[g]=_},p.prototype.isInteriorAreaEdge=function(){for(var g=!0,_=0;_<2;_++)this._label.isArea(_)&&this._label.getLocation(_,ce.LEFT)===O.INTERIOR&&this._label.getLocation(_,ce.RIGHT)===O.INTERIOR||(g=!1);return g},p.prototype.setNextMin=function(g){this._nextMin=g},p.prototype.print=function(g){c.prototype.print.call(this,g),g.print(" "+this._depth[ce.LEFT]+"/"+this._depth[ce.RIGHT]),g.print(" ("+this.getDepthDelta()+")"),this._isInResult&&g.print(" inResult")},p.prototype.setMinEdgeRing=function(g){this._minEdgeRing=g},p.prototype.isLineEdge=function(){var g=this._label.isLine(0)||this._label.isLine(1),_=!this._label.isArea(0)||this._label.allPositionsEqual(0,O.EXTERIOR),S=!this._label.isArea(1)||this._label.allPositionsEqual(1,O.EXTERIOR);return g&&_&&S},p.prototype.setEdgeRing=function(g){this._edgeRing=g},p.prototype.getMinEdgeRing=function(){return this._minEdgeRing},p.prototype.getDepthDelta=function(){var g=this._edge.getDepthDelta();return this._isForward||(g=-g),g},p.prototype.setInResult=function(g){this._isInResult=g},p.prototype.getSym=function(){return this._sym},p.prototype.isForward=function(){return this._isForward},p.prototype.getEdge=function(){return this._edge},p.prototype.printEdge=function(g){this.print(g),g.print(" "),this._isForward?this._edge.print(g):this._edge.printReverse(g)},p.prototype.setSym=function(g){this._sym=g},p.prototype.setVisitedEdge=function(g){this.setVisited(g),this._sym.setVisited(g)},p.prototype.setEdgeDepths=function(g,_){var S=this.getEdge().getDepthDelta();this._isForward||(S=-S);var U=1;g===ce.LEFT&&(U=-1);var G=ce.opposite(g),ee=_+S*U;this.setDepth(g,_),this.setDepth(G,ee)},p.prototype.getEdgeRing=function(){return this._edgeRing},p.prototype.isInResult=function(){return this._isInResult},p.prototype.setNext=function(g){this._next=g},p.prototype.isVisited=function(){return this._isVisited},p.prototype.interfaces_=function(){return[]},p.prototype.getClass=function(){return p},p.depthFactor=function(g,_){return g===O.EXTERIOR&&_===O.INTERIOR?1:g===O.INTERIOR&&_===O.EXTERIOR?-1:0},p}(vn),bs=l(function(){},"Xe");bs.prototype.createNode=function(c){return new xs(c,null)},bs.prototype.interfaces_=function(){return[]},bs.prototype.getClass=function(){return bs};var Dn=l(function(){if(this._edges=new X,this._nodes=null,this._edgeEndList=new X,arguments.length===0)this._nodes=new zr(new bs);else if(arguments.length===1){var c=arguments[0];this._nodes=new zr(c)}},"Ye");Dn.prototype.printEdges=function(c){c.println("Edges:");for(var p=0;p<this._edges.size();p++){c.println("edge "+p+":");var g=this._edges.get(p);g.print(c),g.eiList.print(c)}},Dn.prototype.find=function(c){return this._nodes.find(c)},Dn.prototype.addNode=function(){if(arguments[0]instanceof xs){var c=arguments[0];return this._nodes.addNode(c)}if(arguments[0]instanceof L){var p=arguments[0];return this._nodes.addNode(p)}},Dn.prototype.getNodeIterator=function(){return this._nodes.iterator()},Dn.prototype.linkResultDirectedEdges=function(){for(var c=this._nodes.iterator();c.hasNext();)c.next().getEdges().linkResultDirectedEdges()},Dn.prototype.debugPrintln=function(c){Ve.out.println(c)},Dn.prototype.isBoundaryNode=function(c,p){var g=this._nodes.find(p);if(g===null)return!1;var _=g.getLabel();return _!==null&&_.getLocation(c)===O.BOUNDARY},Dn.prototype.linkAllDirectedEdges=function(){for(var c=this._nodes.iterator();c.hasNext();)c.next().getEdges().linkAllDirectedEdges()},Dn.prototype.matchInSameDirection=function(c,p,g,_){return!!c.equals(g)&&Qe.computeOrientation(c,p,_)===Qe.COLLINEAR&&Bi.quadrant(c,p)===Bi.quadrant(g,_)},Dn.prototype.getEdgeEnds=function(){return this._edgeEndList},Dn.prototype.debugPrint=function(c){Ve.out.print(c)},Dn.prototype.getEdgeIterator=function(){return this._edges.iterator()},Dn.prototype.findEdgeInSameDirection=function(c,p){for(var g=0;g<this._edges.size();g++){var _=this._edges.get(g),S=_.getCoordinates();if(this.matchInSameDirection(c,p,S[0],S[1])||this.matchInSameDirection(c,p,S[S.length-1],S[S.length-2]))return _}return null},Dn.prototype.insertEdge=function(c){this._edges.add(c)},Dn.prototype.findEdgeEnd=function(c){for(var p=this.getEdgeEnds().iterator();p.hasNext();){var g=p.next();if(g.getEdge()===c)return g}return null},Dn.prototype.addEdges=function(c){for(var p=c.iterator();p.hasNext();){var g=p.next();this._edges.add(g);var _=new Jo(g,!0),S=new Jo(g,!1);_.setSym(S),S.setSym(_),this.add(_),this.add(S)}},Dn.prototype.add=function(c){this._nodes.add(c),this._edgeEndList.add(c)},Dn.prototype.getNodes=function(){return this._nodes.values()},Dn.prototype.findEdge=function(c,p){for(var g=0;g<this._edges.size();g++){var _=this._edges.get(g),S=_.getCoordinates();if(c.equals(S[0])&&p.equals(S[1]))return _}return null},Dn.prototype.interfaces_=function(){return[]},Dn.prototype.getClass=function(){return Dn},Dn.linkResultDirectedEdges=function(c){for(var p=c.iterator();p.hasNext();)p.next().getEdges().linkResultDirectedEdges()};var Pr=l(function(){this._geometryFactory=null,this._shellList=new X;var c=arguments[0];this._geometryFactory=c},"ke");Pr.prototype.sortShellsAndHoles=function(c,p,g){for(var _=c.iterator();_.hasNext();){var S=_.next();S.isHole()?g.add(S):p.add(S)}},Pr.prototype.computePolygons=function(c){for(var p=new X,g=c.iterator();g.hasNext();){var _=g.next().toPolygon(this._geometryFactory);p.add(_)}return p},Pr.prototype.placeFreeHoles=function(c,p){for(var g=p.iterator();g.hasNext();){var _=g.next();if(_.getShell()===null){var S=this.findEdgeRingContaining(_,c);if(S===null)throw new mt("unable to assign hole to a shell",_.getCoordinate(0));_.setShell(S)}}},Pr.prototype.buildMinimalEdgeRings=function(c,p,g){for(var _=new X,S=c.iterator();S.hasNext();){var U=S.next();if(U.getMaxNodeDegree()>2){U.linkDirectedEdgesForMinimalEdgeRings();var G=U.buildMinimalRings(),ee=this.findShell(G);ee!==null?(this.placePolygonHoles(ee,G),p.add(ee)):g.addAll(G)}else _.add(U)}return _},Pr.prototype.containsPoint=function(c){for(var p=this._shellList.iterator();p.hasNext();)if(p.next().containsPoint(c))return!0;return!1},Pr.prototype.buildMaximalEdgeRings=function(c){for(var p=new X,g=c.iterator();g.hasNext();){var _=g.next();if(_.isInResult()&&_.getLabel().isArea()&&_.getEdgeRing()===null){var S=new rr(_,this._geometryFactory);p.add(S),S.setInResult()}}return p},Pr.prototype.placePolygonHoles=function(c,p){for(var g=p.iterator();g.hasNext();){var _=g.next();_.isHole()&&_.setShell(c)}},Pr.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},Pr.prototype.findEdgeRingContaining=function(c,p){for(var g=c.getLinearRing(),_=g.getEnvelopeInternal(),S=g.getCoordinateN(0),U=null,G=null,ee=p.iterator();ee.hasNext();){var ye=ee.next(),Te=ye.getLinearRing(),et=Te.getEnvelopeInternal();U!==null&&(G=U.getLinearRing().getEnvelopeInternal());var it=!1;et.contains(_)&&Qe.isPointInRing(S,Te.getCoordinates())&&(it=!0),it&&(U===null||G.contains(et))&&(U=ye)}return U},Pr.prototype.findShell=function(c){for(var p=0,g=null,_=c.iterator();_.hasNext();){var S=_.next();S.isHole()||(g=S,p++)}return pe.isTrue(p<=1,"found two shells in MinimalEdgeRing list"),g},Pr.prototype.add=function(){if(arguments.length===1){var c=arguments[0];this.add(c.getEdgeEnds(),c.getNodes())}else if(arguments.length===2){var p=arguments[0],g=arguments[1];Dn.linkResultDirectedEdges(g);var _=this.buildMaximalEdgeRings(p),S=new X,U=this.buildMinimalEdgeRings(_,this._shellList,S);this.sortShellsAndHoles(U,this._shellList,S),this.placeFreeHoles(this._shellList,S)}},Pr.prototype.interfaces_=function(){return[]},Pr.prototype.getClass=function(){return Pr};var Sl=l(function(){},"je");Sl.prototype.getBounds=function(){},Sl.prototype.interfaces_=function(){return[]},Sl.prototype.getClass=function(){return Sl};var Qr=l(function(){this._bounds=null,this._item=null;var c=arguments[0],p=arguments[1];this._bounds=c,this._item=p},"He");Qr.prototype.getItem=function(){return this._item},Qr.prototype.getBounds=function(){return this._bounds},Qr.prototype.interfaces_=function(){return[Sl,n]},Qr.prototype.getClass=function(){return Qr};var Ha=l(function(){this._size=null,this._items=null,this._size=0,this._items=new X,this._items.add(null)},"We");Ha.prototype.poll=function(){if(this.isEmpty())return null;var c=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),c},Ha.prototype.size=function(){return this._size},Ha.prototype.reorder=function(c){for(var p=null,g=this._items.get(c);2*c<=this._size&&((p=2*c)!==this._size&&this._items.get(p+1).compareTo(this._items.get(p))<0&&p++,this._items.get(p).compareTo(g)<0);c=p)this._items.set(c,this._items.get(p));this._items.set(c,g)},Ha.prototype.clear=function(){this._size=0,this._items.clear()},Ha.prototype.isEmpty=function(){return this._size===0},Ha.prototype.add=function(c){this._items.add(null),this._size+=1;var p=this._size;for(this._items.set(0,c);c.compareTo(this._items.get(Math.trunc(p/2)))<0;p/=2)this._items.set(p,this._items.get(Math.trunc(p/2)));this._items.set(p,c)},Ha.prototype.interfaces_=function(){return[]},Ha.prototype.getClass=function(){return Ha};var ho=l(function(){},"Ke");ho.prototype.visitItem=function(c){},ho.prototype.interfaces_=function(){return[]},ho.prototype.getClass=function(){return ho};var be=l(function(){},"Je");be.prototype.insert=function(c,p){},be.prototype.remove=function(c,p){},be.prototype.query=function(){},be.prototype.interfaces_=function(){return[]},be.prototype.getClass=function(){return be};var De=l(function(){if(this._childBoundables=new X,this._bounds=null,this._level=null,arguments.length!==0&&arguments.length===1){var c=arguments[0];this._level=c}},"Qe"),ie={serialVersionUID:{configurable:!0}};De.prototype.getLevel=function(){return this._level},De.prototype.size=function(){return this._childBoundables.size()},De.prototype.getChildBoundables=function(){return this._childBoundables},De.prototype.addChildBoundable=function(c){pe.isTrue(this._bounds===null),this._childBoundables.add(c)},De.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},De.prototype.getBounds=function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds},De.prototype.interfaces_=function(){return[Sl,n]},De.prototype.getClass=function(){return De},ie.serialVersionUID.get=function(){return 6493722185909574e3},Object.defineProperties(De,ie);var Se=l(function(){},"$e");Se.reverseOrder=function(){return{compare:l(function(c,p){return p.compareTo(c)},"compare")}},Se.min=function(c){return Se.sort(c),c.get(0)},Se.sort=function(c,p){var g=c.toArray();p?Ii.sort(g,p):Ii.sort(g);for(var _=c.iterator(),S=0,U=g.length;S<U;S++)_.next(),_.set(g[S])},Se.singletonList=function(c){var p=new X;return p.add(c),p};var Fe=l(function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var c=arguments[0],p=arguments[1],g=arguments[2];this._boundable1=c,this._boundable2=p,this._itemDistance=g,this._distance=this.distance()},"tn");Fe.prototype.expandToQueue=function(c,p){var g=Fe.isComposite(this._boundable1),_=Fe.isComposite(this._boundable2);if(g&&_)return Fe.area(this._boundable1)>Fe.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,c,p),null):(this.expand(this._boundable2,this._boundable1,c,p),null);if(g)return this.expand(this._boundable1,this._boundable2,c,p),null;if(_)return this.expand(this._boundable2,this._boundable1,c,p),null;throw new T("neither boundable is composite")},Fe.prototype.isLeaves=function(){return!(Fe.isComposite(this._boundable1)||Fe.isComposite(this._boundable2))},Fe.prototype.compareTo=function(c){var p=c;return this._distance<p._distance?-1:this._distance>p._distance?1:0},Fe.prototype.expand=function(c,p,g,_){for(var S=c.getChildBoundables().iterator();S.hasNext();){var U=S.next(),G=new Fe(U,p,this._itemDistance);G.getDistance()<_&&g.add(G)}},Fe.prototype.getBoundable=function(c){return c===0?this._boundable1:this._boundable2},Fe.prototype.getDistance=function(){return this._distance},Fe.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},Fe.prototype.interfaces_=function(){return[B]},Fe.prototype.getClass=function(){return Fe},Fe.area=function(c){return c.getBounds().getArea()},Fe.isComposite=function(c){return c instanceof De};var gt=l(function c(){if(this._root=null,this._built=!1,this._itemBoundables=new X,this._nodeCapacity=null,arguments.length===0){var p=c.DEFAULT_NODE_CAPACITY;this._nodeCapacity=p}else if(arguments.length===1){var g=arguments[0];pe.isTrue(g>1,"Node capacity must be greater than 1"),this._nodeCapacity=g}},"t"),pi={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};gt.prototype.getNodeCapacity=function(){return this._nodeCapacity},gt.prototype.lastNode=function(c){return c.get(c.size()-1)},gt.prototype.size=function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var c=0,p=arguments[0].getChildBoundables().iterator();p.hasNext();){var g=p.next();g instanceof De?c+=this.size(g):g instanceof Qr&&(c+=1)}return c}},gt.prototype.removeItem=function(c,p){for(var g=null,_=c.getChildBoundables().iterator();_.hasNext();){var S=_.next();S instanceof Qr&&S.getItem()===p&&(g=S)}return g!==null&&(c.getChildBoundables().remove(g),!0)},gt.prototype.itemsTree=function(){if(arguments.length===0){this.build();var c=this.itemsTree(this._root);return c===null?new X:c}if(arguments.length===1){for(var p=arguments[0],g=new X,_=p.getChildBoundables().iterator();_.hasNext();){var S=_.next();if(S instanceof De){var U=this.itemsTree(S);U!==null&&g.add(U)}else S instanceof Qr?g.add(S.getItem()):pe.shouldNeverReachHere()}return g.size()<=0?null:g}},gt.prototype.insert=function(c,p){pe.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Qr(c,p))},gt.prototype.boundablesAtLevel=function(){if(arguments.length===1){var c=arguments[0],p=new X;return this.boundablesAtLevel(c,this._root,p),p}if(arguments.length===3){var g=arguments[0],_=arguments[1],S=arguments[2];if(pe.isTrue(g>-2),_.getLevel()===g)return S.add(_),null;for(var U=_.getChildBoundables().iterator();U.hasNext();){var G=U.next();G instanceof De?this.boundablesAtLevel(g,G,S):(pe.isTrue(G instanceof Qr),g===-1&&S.add(G))}return null}},gt.prototype.query=function(){if(arguments.length===1){var c=arguments[0];this.build();var p=new X;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),c)&&this.query(c,this._root,p),p}if(arguments.length===2){var g=arguments[0],_=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),g)&&this.query(g,this._root,_)}else if(arguments.length===3){if(J(arguments[2],ho)&&arguments[0]instanceof Object&&arguments[1]instanceof De)for(var S=arguments[0],U=arguments[1],G=arguments[2],ee=U.getChildBoundables(),ye=0;ye<ee.size();ye++){var Te=ee.get(ye);this.getIntersectsOp().intersects(Te.getBounds(),S)&&(Te instanceof De?this.query(S,Te,G):Te instanceof Qr?G.visitItem(Te.getItem()):pe.shouldNeverReachHere())}else if(J(arguments[2],W)&&arguments[0]instanceof Object&&arguments[1]instanceof De)for(var et=arguments[0],it=arguments[1],kt=arguments[2],zt=it.getChildBoundables(),Yt=0;Yt<zt.size();Yt++){var wi=zt.get(Yt);this.getIntersectsOp().intersects(wi.getBounds(),et)&&(wi instanceof De?this.query(et,wi,kt):wi instanceof Qr?kt.add(wi.getItem()):pe.shouldNeverReachHere())}}},gt.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},gt.prototype.getRoot=function(){return this.build(),this._root},gt.prototype.remove=function(){if(arguments.length===2){var c=arguments[0],p=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),c)&&this.remove(c,this._root,p)}if(arguments.length===3){var g=arguments[0],_=arguments[1],S=arguments[2],U=this.removeItem(_,S);if(U)return!0;for(var G=null,ee=_.getChildBoundables().iterator();ee.hasNext();){var ye=ee.next();if(this.getIntersectsOp().intersects(ye.getBounds(),g)&&ye instanceof De&&(U=this.remove(g,ye,S))){G=ye;break}}return G!==null&&G.getChildBoundables().isEmpty()&&_.getChildBoundables().remove(G),U}},gt.prototype.createHigherLevels=function(c,p){pe.isTrue(!c.isEmpty());var g=this.createParentBoundables(c,p+1);return g.size()===1?g.get(0):this.createHigherLevels(g,p+1)},gt.prototype.depth=function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var c=0,p=arguments[0].getChildBoundables().iterator();p.hasNext();){var g=p.next();if(g instanceof De){var _=this.depth(g);_>c&&(c=_)}}return c+1}},gt.prototype.createParentBoundables=function(c,p){pe.isTrue(!c.isEmpty());var g=new X;g.add(this.createNode(p));var _=new X(c);Se.sort(_,this.getComparator());for(var S=_.iterator();S.hasNext();){var U=S.next();this.lastNode(g).getChildBoundables().size()===this.getNodeCapacity()&&g.add(this.createNode(p)),this.lastNode(g).addChildBoundable(U)}return g},gt.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},gt.prototype.interfaces_=function(){return[n]},gt.prototype.getClass=function(){return gt},gt.compareDoubles=function(c,p){return c>p?1:c<p?-1:0},pi.IntersectsOp.get=function(){return ai},pi.serialVersionUID.get=function(){return-3886435814360241e3},pi.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(gt,pi);var ai=l(function(){},"rn"),Di=l(function(){},"on");Di.prototype.distance=function(c,p){},Di.prototype.interfaces_=function(){return[]},Di.prototype.getClass=function(){return Di};var Ni=function(c){function p(_){_=_||p.DEFAULT_NODE_CAPACITY,c.call(this,_)}l(p,"n"),c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p;var g={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return p.prototype.createParentBoundablesFromVerticalSlices=function(_,S){pe.isTrue(_.length>0);for(var U=new X,G=0;G<_.length;G++)U.addAll(this.createParentBoundablesFromVerticalSlice(_[G],S));return U},p.prototype.createNode=function(_){return new tn(_)},p.prototype.size=function(){return arguments.length===0?c.prototype.size.call(this):c.prototype.size.apply(this,arguments)},p.prototype.insert=function(){if(arguments.length!==2)return c.prototype.insert.apply(this,arguments);var _=arguments[0],S=arguments[1];if(_.isNull())return null;c.prototype.insert.call(this,_,S)},p.prototype.getIntersectsOp=function(){return p.intersectsOp},p.prototype.verticalSlices=function(_,S){for(var U=Math.trunc(Math.ceil(_.size()/S)),G=new Array(S).fill(null),ee=_.iterator(),ye=0;ye<S;ye++){G[ye]=new X;for(var Te=0;ee.hasNext()&&Te<U;){var et=ee.next();G[ye].add(et),Te++}}return G},p.prototype.query=function(){if(arguments.length===1){var _=arguments[0];return c.prototype.query.call(this,_)}if(arguments.length===2){var S=arguments[0],U=arguments[1];c.prototype.query.call(this,S,U)}else if(arguments.length===3){if(J(arguments[2],ho)&&arguments[0]instanceof Object&&arguments[1]instanceof De){var G=arguments[0],ee=arguments[1],ye=arguments[2];c.prototype.query.call(this,G,ee,ye)}else if(J(arguments[2],W)&&arguments[0]instanceof Object&&arguments[1]instanceof De){var Te=arguments[0],et=arguments[1],it=arguments[2];c.prototype.query.call(this,Te,et,it)}}},p.prototype.getComparator=function(){return p.yComparator},p.prototype.createParentBoundablesFromVerticalSlice=function(_,S){return c.prototype.createParentBoundables.call(this,_,S)},p.prototype.remove=function(){if(arguments.length===2){var _=arguments[0],S=arguments[1];return c.prototype.remove.call(this,_,S)}return c.prototype.remove.apply(this,arguments)},p.prototype.depth=function(){return arguments.length===0?c.prototype.depth.call(this):c.prototype.depth.apply(this,arguments)},p.prototype.createParentBoundables=function(_,S){pe.isTrue(!_.isEmpty());var U=Math.trunc(Math.ceil(_.size()/this.getNodeCapacity())),G=new X(_);Se.sort(G,p.xComparator);var ee=this.verticalSlices(G,Math.trunc(Math.ceil(Math.sqrt(U))));return this.createParentBoundablesFromVerticalSlices(ee,S)},p.prototype.nearestNeighbour=function(){if(arguments.length===1){if(J(arguments[0],Di)){var _=arguments[0],S=new Fe(this.getRoot(),this.getRoot(),_);return this.nearestNeighbour(S)}if(arguments[0]instanceof Fe){var U=arguments[0];return this.nearestNeighbour(U,k.POSITIVE_INFINITY)}}else if(arguments.length===2){if(arguments[0]instanceof p&&J(arguments[1],Di)){var G=arguments[0],ee=arguments[1],ye=new Fe(this.getRoot(),G.getRoot(),ee);return this.nearestNeighbour(ye)}if(arguments[0]instanceof Fe&&typeof arguments[1]=="number"){var Te=arguments[0],et=arguments[1],it=null,kt=new Ha;for(kt.add(Te);!kt.isEmpty()&&et>0;){var zt=kt.poll(),Yt=zt.getDistance();if(Yt>=et)break;zt.isLeaves()?(et=Yt,it=zt):zt.expandToQueue(kt,et)}return[it.getBoundable(0).getItem(),it.getBoundable(1).getItem()]}}else if(arguments.length===3){var wi=arguments[0],En=arguments[1],wr=arguments[2],La=new Qr(wi,En),Xs=new Fe(this.getRoot(),La,wr);return this.nearestNeighbour(Xs)[0]}},p.prototype.interfaces_=function(){return[be,n]},p.prototype.getClass=function(){return p},p.centreX=function(_){return p.avg(_.getMinX(),_.getMaxX())},p.avg=function(_,S){return(_+S)/2},p.centreY=function(_){return p.avg(_.getMinY(),_.getMaxY())},g.STRtreeNode.get=function(){return tn},g.serialVersionUID.get=function(){return 0x39920f7d5f261e0},g.xComparator.get=function(){return{interfaces_:l(function(){return[z]},"interfaces_"),compare:l(function(_,S){return c.compareDoubles(p.centreX(_.getBounds()),p.centreX(S.getBounds()))},"compare")}},g.yComparator.get=function(){return{interfaces_:l(function(){return[z]},"interfaces_"),compare:l(function(_,S){return c.compareDoubles(p.centreY(_.getBounds()),p.centreY(S.getBounds()))},"compare")}},g.intersectsOp.get=function(){return{interfaces_:l(function(){return[c.IntersectsOp]},"interfaces_"),intersects:l(function(_,S){return _.intersects(S)},"intersects")}},g.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(p,g),p}(gt),tn=function(c){function p(){var g=arguments[0];c.call(this,g)}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.computeBounds=function(){for(var g=null,_=this.getChildBoundables().iterator();_.hasNext();){var S=_.next();g===null?g=new xe(S.getBounds()):g.expandToInclude(S.getBounds())}return g},p.prototype.interfaces_=function(){return[]},p.prototype.getClass=function(){return p},p}(De),Sn=l(function(){},"un");Sn.prototype.interfaces_=function(){return[]},Sn.prototype.getClass=function(){return Sn},Sn.relativeSign=function(c,p){return c<p?-1:c>p?1:0},Sn.compare=function(c,p,g){if(p.equals2D(g))return 0;var _=Sn.relativeSign(p.x,g.x),S=Sn.relativeSign(p.y,g.y);switch(c){case 0:return Sn.compareValue(_,S);case 1:return Sn.compareValue(S,_);case 2:return Sn.compareValue(S,-_);case 3:return Sn.compareValue(-_,S);case 4:return Sn.compareValue(-_,-S);case 5:return Sn.compareValue(-S,-_);case 6:return Sn.compareValue(-S,_);case 7:return Sn.compareValue(_,-S)}return pe.shouldNeverReachHere("invalid octant value"),0},Sn.compareValue=function(c,p){return c<0?-1:c>0?1:p<0?-1:p>0?1:0};var er=l(function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var c=arguments[0],p=arguments[1],g=arguments[2],_=arguments[3];this._segString=c,this.coord=new L(p),this.segmentIndex=g,this._segmentOctant=_,this._isInterior=!p.equals2D(c.getCoordinate(g))},"ln");er.prototype.getCoordinate=function(){return this.coord},er.prototype.print=function(c){c.print(this.coord),c.print(" seg # = "+this.segmentIndex)},er.prototype.compareTo=function(c){var p=c;return this.segmentIndex<p.segmentIndex?-1:this.segmentIndex>p.segmentIndex?1:this.coord.equals2D(p.coord)?0:Sn.compare(this._segmentOctant,this.coord,p.coord)},er.prototype.isEndPoint=function(c){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===c},er.prototype.isInterior=function(){return this._isInterior},er.prototype.interfaces_=function(){return[B]},er.prototype.getClass=function(){return er};var qn=l(function(){this._nodeMap=new v,this._edge=null;var c=arguments[0];this._edge=c},"cn");qn.prototype.getSplitCoordinates=function(){var c=new _e;this.addEndpoints();for(var p=this.iterator(),g=p.next();p.hasNext();){var _=p.next();this.addEdgeCoordinates(g,_,c),g=_}return c.toCoordinateArray()},qn.prototype.addCollapsedNodes=function(){var c=new X;this.findCollapsesFromInsertedNodes(c),this.findCollapsesFromExistingVertices(c);for(var p=c.iterator();p.hasNext();){var g=p.next().intValue();this.add(this._edge.getCoordinate(g),g)}},qn.prototype.print=function(c){c.println("Intersections:");for(var p=this.iterator();p.hasNext();)p.next().print(c)},qn.prototype.findCollapsesFromExistingVertices=function(c){for(var p=0;p<this._edge.size()-2;p++){var g=this._edge.getCoordinate(p),_=this._edge.getCoordinate(p+2);g.equals2D(_)&&c.add(new te(p+1))}},qn.prototype.addEdgeCoordinates=function(c,p,g){var _=this._edge.getCoordinate(p.segmentIndex),S=p.isInterior()||!p.coord.equals2D(_);g.add(new L(c.coord),!1);for(var U=c.segmentIndex+1;U<=p.segmentIndex;U++)g.add(this._edge.getCoordinate(U));S&&g.add(new L(p.coord))},qn.prototype.iterator=function(){return this._nodeMap.values().iterator()},qn.prototype.addSplitEdges=function(c){this.addEndpoints(),this.addCollapsedNodes();for(var p=this.iterator(),g=p.next();p.hasNext();){var _=p.next(),S=this.createSplitEdge(g,_);c.add(S),g=_}},qn.prototype.findCollapseIndex=function(c,p,g){if(!c.coord.equals2D(p.coord))return!1;var _=p.segmentIndex-c.segmentIndex;return p.isInterior()||_--,_===1&&(g[0]=c.segmentIndex+1,!0)},qn.prototype.findCollapsesFromInsertedNodes=function(c){for(var p=new Array(1).fill(null),g=this.iterator(),_=g.next();g.hasNext();){var S=g.next();this.findCollapseIndex(_,S,p)&&c.add(new te(p[0])),_=S}},qn.prototype.getEdge=function(){return this._edge},qn.prototype.addEndpoints=function(){var c=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(c),c)},qn.prototype.createSplitEdge=function(c,p){var g=p.segmentIndex-c.segmentIndex+2,_=this._edge.getCoordinate(p.segmentIndex),S=p.isInterior()||!p.coord.equals2D(_);S||g--;var U=new Array(g).fill(null),G=0;U[G++]=new L(c.coord);for(var ee=c.segmentIndex+1;ee<=p.segmentIndex;ee++)U[G++]=this._edge.getCoordinate(ee);return S&&(U[G]=new L(p.coord)),new cr(U,this._edge.getData())},qn.prototype.add=function(c,p){var g=new er(this._edge,c,p,this._edge.getSegmentOctant(p)),_=this._nodeMap.get(g);return _!==null?(pe.isTrue(_.coord.equals2D(c),"Found equal nodes with different coordinates"),_):(this._nodeMap.put(g,g),g)},qn.prototype.checkSplitEdgesCorrectness=function(c){var p=this._edge.getCoordinates(),g=c.get(0).getCoordinate(0);if(!g.equals2D(p[0]))throw new Lt("bad split edge start point at "+g);var _=c.get(c.size()-1).getCoordinates(),S=_[_.length-1];if(!S.equals2D(p[p.length-1]))throw new Lt("bad split edge end point at "+S)},qn.prototype.interfaces_=function(){return[]},qn.prototype.getClass=function(){return qn};var Lo=l(function(){},"pn");Lo.prototype.interfaces_=function(){return[]},Lo.prototype.getClass=function(){return Lo},Lo.octant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var c=arguments[0],p=arguments[1];if(c===0&&p===0)throw new T("Cannot compute the octant for point ( "+c+", "+p+" )");var g=Math.abs(c),_=Math.abs(p);return c>=0?p>=0?g>=_?0:1:g>=_?7:6:p>=0?g>=_?3:2:g>=_?4:5}if(arguments[0]instanceof L&&arguments[1]instanceof L){var S=arguments[0],U=arguments[1],G=U.x-S.x,ee=U.y-S.y;if(G===0&&ee===0)throw new T("Cannot compute the octant for two identical points "+S);return Lo.octant(G,ee)}};var co=l(function(){},"hn");co.prototype.getCoordinates=function(){},co.prototype.size=function(){},co.prototype.getCoordinate=function(c){},co.prototype.isClosed=function(){},co.prototype.setData=function(c){},co.prototype.getData=function(){},co.prototype.interfaces_=function(){return[]},co.prototype.getClass=function(){return co};var Ah=l(function(){},"fn");Ah.prototype.addIntersection=function(c,p){},Ah.prototype.interfaces_=function(){return[co]},Ah.prototype.getClass=function(){return Ah};var cr=l(function(){this._nodeList=new qn(this),this._pts=null,this._data=null;var c=arguments[0],p=arguments[1];this._pts=c,this._data=p},"gn");cr.prototype.getCoordinates=function(){return this._pts},cr.prototype.size=function(){return this._pts.length},cr.prototype.getCoordinate=function(c){return this._pts[c]},cr.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},cr.prototype.getSegmentOctant=function(c){return c===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(c),this.getCoordinate(c+1))},cr.prototype.setData=function(c){this._data=c},cr.prototype.safeOctant=function(c,p){return c.equals2D(p)?0:Lo.octant(c,p)},cr.prototype.getData=function(){return this._data},cr.prototype.addIntersection=function(){if(arguments.length===2){var c=arguments[0],p=arguments[1];this.addIntersectionNode(c,p)}else if(arguments.length===4){var g=arguments[0],_=arguments[1],S=arguments[3],U=new L(g.getIntersection(S));this.addIntersection(U,_)}},cr.prototype.toString=function(){return Ke.toLineString(new ci(this._pts))},cr.prototype.getNodeList=function(){return this._nodeList},cr.prototype.addIntersectionNode=function(c,p){var g=p,_=g+1;if(_<this._pts.length){var S=this._pts[_];c.equals2D(S)&&(g=_)}return this._nodeList.add(c,g)},cr.prototype.addIntersections=function(c,p,g){for(var _=0;_<c.getIntersectionNum();_++)this.addIntersection(c,p,g,_)},cr.prototype.interfaces_=function(){return[Ah]},cr.prototype.getClass=function(){return cr},cr.getNodedSubstrings=function(){if(arguments.length===1){var c=arguments[0],p=new X;return cr.getNodedSubstrings(c,p),p}if(arguments.length===2)for(var g=arguments[0],_=arguments[1],S=g.iterator();S.hasNext();)S.next().getNodeList().addSplitEdges(_)};var di=l(function(){if(this.p0=null,this.p1=null,arguments.length===0)this.p0=new L,this.p1=new L;else if(arguments.length===1){var c=arguments[0];this.p0=new L(c.p0),this.p1=new L(c.p1)}else if(arguments.length===2)this.p0=arguments[0],this.p1=arguments[1];else if(arguments.length===4){var p=arguments[0],g=arguments[1],_=arguments[2],S=arguments[3];this.p0=new L(p,g),this.p1=new L(_,S)}},"dn"),u6={serialVersionUID:{configurable:!0}};di.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},di.prototype.orientationIndex=function(){if(arguments[0]instanceof di){var c=arguments[0],p=Qe.orientationIndex(this.p0,this.p1,c.p0),g=Qe.orientationIndex(this.p0,this.p1,c.p1);return p>=0&&g>=0||p<=0&&g<=0?Math.max(p,g):0}if(arguments[0]instanceof L){var _=arguments[0];return Qe.orientationIndex(this.p0,this.p1,_)}},di.prototype.toGeometry=function(c){return c.createLineString([this.p0,this.p1])},di.prototype.isVertical=function(){return this.p0.x===this.p1.x},di.prototype.equals=function(c){if(!(c instanceof di))return!1;var p=c;return this.p0.equals(p.p0)&&this.p1.equals(p.p1)},di.prototype.intersection=function(c){var p=new at;return p.computeIntersection(this.p0,this.p1,c.p0,c.p1),p.hasIntersection()?p.getIntersection(0):null},di.prototype.project=function(){if(arguments[0]instanceof L){var c=arguments[0];if(c.equals(this.p0)||c.equals(this.p1))return new L(c);var p=this.projectionFactor(c),g=new L;return g.x=this.p0.x+p*(this.p1.x-this.p0.x),g.y=this.p0.y+p*(this.p1.y-this.p0.y),g}if(arguments[0]instanceof di){var _=arguments[0],S=this.projectionFactor(_.p0),U=this.projectionFactor(_.p1);if(S>=1&&U>=1||S<=0&&U<=0)return null;var G=this.project(_.p0);S<0&&(G=this.p0),S>1&&(G=this.p1);var ee=this.project(_.p1);return U<0&&(ee=this.p0),U>1&&(ee=this.p1),new di(G,ee)}},di.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},di.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},di.prototype.getCoordinate=function(c){return c===0?this.p0:this.p1},di.prototype.distancePerpendicular=function(c){return Qe.distancePointLinePerpendicular(c,this.p0,this.p1)},di.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},di.prototype.midPoint=function(){return di.midPoint(this.p0,this.p1)},di.prototype.projectionFactor=function(c){if(c.equals(this.p0))return 0;if(c.equals(this.p1))return 1;var p=this.p1.x-this.p0.x,g=this.p1.y-this.p0.y,_=p*p+g*g;return _<=0?k.NaN:((c.x-this.p0.x)*p+(c.y-this.p0.y)*g)/_},di.prototype.closestPoints=function(c){var p=this.intersection(c);if(p!==null)return[p,p];var g=new Array(2).fill(null),_=k.MAX_VALUE,S=null,U=this.closestPoint(c.p0);_=U.distance(c.p0),g[0]=U,g[1]=c.p0;var G=this.closestPoint(c.p1);(S=G.distance(c.p1))<_&&(_=S,g[0]=G,g[1]=c.p1);var ee=c.closestPoint(this.p0);(S=ee.distance(this.p0))<_&&(_=S,g[0]=this.p0,g[1]=ee);var ye=c.closestPoint(this.p1);return(S=ye.distance(this.p1))<_&&(_=S,g[0]=this.p1,g[1]=ye),g},di.prototype.closestPoint=function(c){var p=this.projectionFactor(c);return p>0&&p<1?this.project(c):this.p0.distance(c)<this.p1.distance(c)?this.p0:this.p1},di.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},di.prototype.getLength=function(){return this.p0.distance(this.p1)},di.prototype.compareTo=function(c){var p=c,g=this.p0.compareTo(p.p0);return g!==0?g:this.p1.compareTo(p.p1)},di.prototype.reverse=function(){var c=this.p0;this.p0=this.p1,this.p1=c},di.prototype.equalsTopo=function(c){return this.p0.equals(c.p0)&&(this.p1.equals(c.p1)||this.p0.equals(c.p1))&&this.p1.equals(c.p0)},di.prototype.lineIntersection=function(c){try{return Le.intersection(this.p0,this.p1,c.p0,c.p1)}catch(p){if(!(p instanceof je))throw p}return null},di.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},di.prototype.pointAlongOffset=function(c,p){var g=this.p0.x+c*(this.p1.x-this.p0.x),_=this.p0.y+c*(this.p1.y-this.p0.y),S=this.p1.x-this.p0.x,U=this.p1.y-this.p0.y,G=Math.sqrt(S*S+U*U),ee=0,ye=0;if(p!==0){if(G<=0)throw new Error("Cannot compute offset from zero-length line segment");ee=p*S/G,ye=p*U/G}return new L(g-ye,_+ee)},di.prototype.setCoordinates=function(){if(arguments.length===1){var c=arguments[0];this.setCoordinates(c.p0,c.p1)}else if(arguments.length===2){var p=arguments[0],g=arguments[1];this.p0.x=p.x,this.p0.y=p.y,this.p1.x=g.x,this.p1.y=g.y}},di.prototype.segmentFraction=function(c){var p=this.projectionFactor(c);return p<0?p=0:(p>1||k.isNaN(p))&&(p=1),p},di.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},di.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},di.prototype.distance=function(){if(arguments[0]instanceof di){var c=arguments[0];return Qe.distanceLineLine(this.p0,this.p1,c.p0,c.p1)}if(arguments[0]instanceof L){var p=arguments[0];return Qe.distancePointLine(p,this.p0,this.p1)}},di.prototype.pointAlong=function(c){var p=new L;return p.x=this.p0.x+c*(this.p1.x-this.p0.x),p.y=this.p0.y+c*(this.p1.y-this.p0.y),p},di.prototype.hashCode=function(){var c=k.doubleToLongBits(this.p0.x);c^=31*k.doubleToLongBits(this.p0.y);var p=Math.trunc(c)^Math.trunc(c>>32),g=k.doubleToLongBits(this.p1.x);return g^=31*k.doubleToLongBits(this.p1.y),p^(Math.trunc(g)^Math.trunc(g>>32))},di.prototype.interfaces_=function(){return[B,n]},di.prototype.getClass=function(){return di},di.midPoint=function(c,p){return new L((c.x+p.x)/2,(c.y+p.y)/2)},u6.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(di,u6);var Yg=l(function(){this.tempEnv1=new xe,this.tempEnv2=new xe,this._overlapSeg1=new di,this._overlapSeg2=new di},"_n");Yg.prototype.overlap=function(){if(arguments.length!==2&&arguments.length===4){var c=arguments[0],p=arguments[1],g=arguments[2],_=arguments[3];c.getLineSegment(p,this._overlapSeg1),g.getLineSegment(_,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},Yg.prototype.interfaces_=function(){return[]},Yg.prototype.getClass=function(){return Yg};var Wa=l(function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var c=arguments[0],p=arguments[1],g=arguments[2],_=arguments[3];this._pts=c,this._start=p,this._end=g,this._context=_},"mn");Wa.prototype.getLineSegment=function(c,p){p.p0=this._pts[c],p.p1=this._pts[c+1]},Wa.prototype.computeSelect=function(c,p,g,_){var S=this._pts[p],U=this._pts[g];if(_.tempEnv1.init(S,U),g-p==1)return _.select(this,p),null;if(!c.intersects(_.tempEnv1))return null;var G=Math.trunc((p+g)/2);p<G&&this.computeSelect(c,p,G,_),G<g&&this.computeSelect(c,G,g,_)},Wa.prototype.getCoordinates=function(){for(var c=new Array(this._end-this._start+1).fill(null),p=0,g=this._start;g<=this._end;g++)c[p++]=this._pts[g];return c},Wa.prototype.computeOverlaps=function(c,p){this.computeOverlapsInternal(this._start,this._end,c,c._start,c._end,p)},Wa.prototype.setId=function(c){this._id=c},Wa.prototype.select=function(c,p){this.computeSelect(c,this._start,this._end,p)},Wa.prototype.getEnvelope=function(){if(this._env===null){var c=this._pts[this._start],p=this._pts[this._end];this._env=new xe(c,p)}return this._env},Wa.prototype.getEndIndex=function(){return this._end},Wa.prototype.getStartIndex=function(){return this._start},Wa.prototype.getContext=function(){return this._context},Wa.prototype.getId=function(){return this._id},Wa.prototype.computeOverlapsInternal=function(c,p,g,_,S,U){var G=this._pts[c],ee=this._pts[p],ye=g._pts[_],Te=g._pts[S];if(p-c==1&&S-_==1)return U.overlap(this,c,g,_),null;if(U.tempEnv1.init(G,ee),U.tempEnv2.init(ye,Te),!U.tempEnv1.intersects(U.tempEnv2))return null;var et=Math.trunc((c+p)/2),it=Math.trunc((_+S)/2);c<et&&(_<it&&this.computeOverlapsInternal(c,et,g,_,it,U),it<S&&this.computeOverlapsInternal(c,et,g,it,S,U)),et<p&&(_<it&&this.computeOverlapsInternal(et,p,g,_,it,U),it<S&&this.computeOverlapsInternal(et,p,g,it,S,U))},Wa.prototype.interfaces_=function(){return[]},Wa.prototype.getClass=function(){return Wa};var ws=l(function(){},"vn");ws.prototype.interfaces_=function(){return[]},ws.prototype.getClass=function(){return ws},ws.getChainStartIndices=function(c){var p=0,g=new X;g.add(new te(p));do{var _=ws.findChainEnd(c,p);g.add(new te(_)),p=_}while(p<c.length-1);return ws.toIntArray(g)},ws.findChainEnd=function(c,p){for(var g=p;g<c.length-1&&c[g].equals2D(c[g+1]);)g++;if(g>=c.length-1)return c.length-1;for(var _=Bi.quadrant(c[g],c[g+1]),S=p+1;S<c.length&&!(!c[S-1].equals2D(c[S])&&Bi.quadrant(c[S-1],c[S])!==_);)S++;return S-1},ws.getChains=function(){if(arguments.length===1){var c=arguments[0];return ws.getChains(c,null)}if(arguments.length===2){for(var p=arguments[0],g=arguments[1],_=new X,S=ws.getChainStartIndices(p),U=0;U<S.length-1;U++){var G=new Wa(p,S[U],S[U+1],g);_.add(G)}return _}},ws.toIntArray=function(c){for(var p=new Array(c.size()).fill(null),g=0;g<p.length;g++)p[g]=c.get(g).intValue();return p};var Sh=l(function(){},"In");Sh.prototype.computeNodes=function(c){},Sh.prototype.getNodedSubstrings=function(){},Sh.prototype.interfaces_=function(){return[]},Sh.prototype.getClass=function(){return Sh};var Jg=l(function(){if(this._segInt=null,arguments.length!==0&&arguments.length===1){var c=arguments[0];this.setSegmentIntersector(c)}},"En");Jg.prototype.setSegmentIntersector=function(c){this._segInt=c},Jg.prototype.interfaces_=function(){return[Sh]},Jg.prototype.getClass=function(){return Jg};var KA=function(c){function p(_){_?c.call(this,_):c.call(this),this._monoChains=new X,this._index=new Ni,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}l(p,"e"),c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p;var g={SegmentOverlapAction:{configurable:!0}};return p.prototype.getMonotoneChains=function(){return this._monoChains},p.prototype.getNodedSubstrings=function(){return cr.getNodedSubstrings(this._nodedSegStrings)},p.prototype.getIndex=function(){return this._index},p.prototype.add=function(_){for(var S=ws.getChains(_.getCoordinates(),_).iterator();S.hasNext();){var U=S.next();U.setId(this._idCounter++),this._index.insert(U.getEnvelope(),U),this._monoChains.add(U)}},p.prototype.computeNodes=function(_){this._nodedSegStrings=_;for(var S=_.iterator();S.hasNext();)this.add(S.next());this.intersectChains()},p.prototype.intersectChains=function(){for(var _=new h6(this._segInt),S=this._monoChains.iterator();S.hasNext();)for(var U=S.next(),G=this._index.query(U.getEnvelope()).iterator();G.hasNext();){var ee=G.next();if(ee.getId()>U.getId()&&(U.computeOverlaps(ee,_),this._nOverlaps++),this._segInt.isDone())return null}},p.prototype.interfaces_=function(){return[]},p.prototype.getClass=function(){return p},g.SegmentOverlapAction.get=function(){return h6},Object.defineProperties(p,g),p}(Jg),h6=function(c){function p(){c.call(this),this._si=null;var g=arguments[0];this._si=g}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.overlap=function(){if(arguments.length!==4)return c.prototype.overlap.apply(this,arguments);var g=arguments[0],_=arguments[1],S=arguments[2],U=arguments[3],G=g.getContext(),ee=S.getContext();this._si.processIntersections(G,_,ee,U)},p.prototype.interfaces_=function(){return[]},p.prototype.getClass=function(){return p},p}(Yg),_n=l(function c(){if(this._quadrantSegments=c.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=c.CAP_ROUND,this._joinStyle=c.JOIN_ROUND,this._mitreLimit=c.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=c.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var p=arguments[0];this.setQuadrantSegments(p)}else if(arguments.length===2){var g=arguments[0],_=arguments[1];this.setQuadrantSegments(g),this.setEndCapStyle(_)}else if(arguments.length===4){var S=arguments[0],U=arguments[1],G=arguments[2],ee=arguments[3];this.setQuadrantSegments(S),this.setEndCapStyle(U),this.setJoinStyle(G),this.setMitreLimit(ee)}}},"t"),Ml={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};_n.prototype.getEndCapStyle=function(){return this._endCapStyle},_n.prototype.isSingleSided=function(){return this._isSingleSided},_n.prototype.setQuadrantSegments=function(c){this._quadrantSegments=c,this._quadrantSegments===0&&(this._joinStyle=_n.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=_n.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),c<=0&&(this._quadrantSegments=1),this._joinStyle!==_n.JOIN_ROUND&&(this._quadrantSegments=_n.DEFAULT_QUADRANT_SEGMENTS)},_n.prototype.getJoinStyle=function(){return this._joinStyle},_n.prototype.setJoinStyle=function(c){this._joinStyle=c},_n.prototype.setSimplifyFactor=function(c){this._simplifyFactor=c<0?0:c},_n.prototype.getSimplifyFactor=function(){return this._simplifyFactor},_n.prototype.getQuadrantSegments=function(){return this._quadrantSegments},_n.prototype.setEndCapStyle=function(c){this._endCapStyle=c},_n.prototype.getMitreLimit=function(){return this._mitreLimit},_n.prototype.setMitreLimit=function(c){this._mitreLimit=c},_n.prototype.setSingleSided=function(c){this._isSingleSided=c},_n.prototype.interfaces_=function(){return[]},_n.prototype.getClass=function(){return _n},_n.bufferDistanceError=function(c){var p=Math.PI/2/c;return 1-Math.cos(p/2)},Ml.CAP_ROUND.get=function(){return 1},Ml.CAP_FLAT.get=function(){return 2},Ml.CAP_SQUARE.get=function(){return 3},Ml.JOIN_ROUND.get=function(){return 1},Ml.JOIN_MITRE.get=function(){return 2},Ml.JOIN_BEVEL.get=function(){return 3},Ml.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},Ml.DEFAULT_MITRE_LIMIT.get=function(){return 5},Ml.DEFAULT_SIMPLIFY_FACTOR.get=function(){return .01},Object.defineProperties(_n,Ml);var ar=l(function(c){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Qe.COUNTERCLOCKWISE,this._inputLine=c||null},"Ln"),Kg={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};ar.prototype.isDeletable=function(c,p,g,_){var S=this._inputLine[c],U=this._inputLine[p],G=this._inputLine[g];return!!this.isConcave(S,U,G)&&!!this.isShallow(S,U,G,_)&&this.isShallowSampled(S,U,c,g,_)},ar.prototype.deleteShallowConcavities=function(){for(var c=1,p=this.findNextNonDeletedIndex(c),g=this.findNextNonDeletedIndex(p),_=!1;g<this._inputLine.length;){var S=!1;this.isDeletable(c,p,g,this._distanceTol)&&(this._isDeleted[p]=ar.DELETE,S=!0,_=!0),c=S?g:p,p=this.findNextNonDeletedIndex(c),g=this.findNextNonDeletedIndex(p)}return _},ar.prototype.isShallowConcavity=function(c,p,g,_){return Qe.computeOrientation(c,p,g)!==this._angleOrientation?!1:Qe.distancePointLine(p,c,g)<_},ar.prototype.isShallowSampled=function(c,p,g,_,S){var U=Math.trunc((_-g)/ar.NUM_PTS_TO_CHECK);U<=0&&(U=1);for(var G=g;G<_;G+=U)if(!this.isShallow(c,p,this._inputLine[G],S))return!1;return!0},ar.prototype.isConcave=function(c,p,g){var _=Qe.computeOrientation(c,p,g)===this._angleOrientation;return _},ar.prototype.simplify=function(c){this._distanceTol=Math.abs(c),c<0&&(this._angleOrientation=Qe.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var p=!1;do p=this.deleteShallowConcavities();while(p);return this.collapseLine()},ar.prototype.findNextNonDeletedIndex=function(c){for(var p=c+1;p<this._inputLine.length&&this._isDeleted[p]===ar.DELETE;)p++;return p},ar.prototype.isShallow=function(c,p,g,_){return Qe.distancePointLine(p,c,g)<_},ar.prototype.collapseLine=function(){for(var c=new _e,p=0;p<this._inputLine.length;p++)this._isDeleted[p]!==ar.DELETE&&c.add(this._inputLine[p]);return c.toCoordinateArray()},ar.prototype.interfaces_=function(){return[]},ar.prototype.getClass=function(){return ar},ar.simplify=function(c,p){return new ar(c).simplify(p)},Kg.INIT.get=function(){return 0},Kg.DELETE.get=function(){return 1},Kg.KEEP.get=function(){return 1},Kg.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(ar,Kg);var po=l(function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new X},"wn"),c6={COORDINATE_ARRAY_TYPE:{configurable:!0}};po.prototype.getCoordinates=function(){return this._ptList.toArray(po.COORDINATE_ARRAY_TYPE)},po.prototype.setPrecisionModel=function(c){this._precisionModel=c},po.prototype.addPt=function(c){var p=new L(c);if(this._precisionModel.makePrecise(p),this.isRedundant(p))return null;this._ptList.add(p)},po.prototype.revere=function(){},po.prototype.addPts=function(c,p){if(p)for(var g=0;g<c.length;g++)this.addPt(c[g]);else for(var _=c.length-1;_>=0;_--)this.addPt(c[_])},po.prototype.isRedundant=function(c){if(this._ptList.size()<1)return!1;var p=this._ptList.get(this._ptList.size()-1);return c.distance(p)<this._minimimVertexDistance},po.prototype.toString=function(){return new _i().createLineString(this.getCoordinates()).toString()},po.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var c=new L(this._ptList.get(0)),p=this._ptList.get(this._ptList.size()-1);if(c.equals(p))return null;this._ptList.add(c)},po.prototype.setMinimumVertexDistance=function(c){this._minimimVertexDistance=c},po.prototype.interfaces_=function(){return[]},po.prototype.getClass=function(){return po},c6.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(po,c6);var nn=l(function(){},"Tn"),Yc={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};nn.prototype.interfaces_=function(){return[]},nn.prototype.getClass=function(){return nn},nn.toDegrees=function(c){return 180*c/Math.PI},nn.normalize=function(c){for(;c>Math.PI;)c-=nn.PI_TIMES_2;for(;c<=-Math.PI;)c+=nn.PI_TIMES_2;return c},nn.angle=function(){if(arguments.length===1){var c=arguments[0];return Math.atan2(c.y,c.x)}if(arguments.length===2){var p=arguments[0],g=arguments[1],_=g.x-p.x,S=g.y-p.y;return Math.atan2(S,_)}},nn.isAcute=function(c,p,g){var _=c.x-p.x,S=c.y-p.y;return _*(g.x-p.x)+S*(g.y-p.y)>0},nn.isObtuse=function(c,p,g){var _=c.x-p.x,S=c.y-p.y;return _*(g.x-p.x)+S*(g.y-p.y)<0},nn.interiorAngle=function(c,p,g){var _=nn.angle(p,c),S=nn.angle(p,g);return Math.abs(S-_)},nn.normalizePositive=function(c){if(c<0){for(;c<0;)c+=nn.PI_TIMES_2;c>=nn.PI_TIMES_2&&(c=0)}else{for(;c>=nn.PI_TIMES_2;)c-=nn.PI_TIMES_2;c<0&&(c=0)}return c},nn.angleBetween=function(c,p,g){var _=nn.angle(p,c),S=nn.angle(p,g);return nn.diff(_,S)},nn.diff=function(c,p){var g=null;return(g=c<p?p-c:c-p)>Math.PI&&(g=2*Math.PI-g),g},nn.toRadians=function(c){return c*Math.PI/180},nn.getTurn=function(c,p){var g=Math.sin(p-c);return g>0?nn.COUNTERCLOCKWISE:g<0?nn.CLOCKWISE:nn.NONE},nn.angleBetweenOriented=function(c,p,g){var _=nn.angle(p,c),S=nn.angle(p,g)-_;return S<=-Math.PI?S+nn.PI_TIMES_2:S>Math.PI?S-nn.PI_TIMES_2:S},Yc.PI_TIMES_2.get=function(){return 2*Math.PI},Yc.PI_OVER_2.get=function(){return Math.PI/2},Yc.PI_OVER_4.get=function(){return Math.PI/4},Yc.COUNTERCLOCKWISE.get=function(){return Qe.COUNTERCLOCKWISE},Yc.CLOCKWISE.get=function(){return Qe.CLOCKWISE},Yc.NONE.get=function(){return Qe.COLLINEAR},Object.defineProperties(nn,Yc);var $n=l(function c(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new di,this._seg1=new di,this._offset0=new di,this._offset1=new di,this._side=0,this._hasNarrowConcaveAngle=!1;var p=arguments[0],g=arguments[1],_=arguments[2];this._precisionModel=p,this._bufParams=g,this._li=new at,this._filletAngleQuantum=Math.PI/2/g.getQuadrantSegments(),g.getQuadrantSegments()>=8&&g.getJoinStyle()===_n.JOIN_ROUND&&(this._closingSegLengthFactor=c.MAX_CLOSING_SEG_LEN_FACTOR),this.init(_)},"t"),Qg={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};$n.prototype.addNextSegment=function(c,p){if(this._s0=this._s1,this._s1=this._s2,this._s2=c,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var g=Qe.computeOrientation(this._s0,this._s1,this._s2),_=g===Qe.CLOCKWISE&&this._side===ce.LEFT||g===Qe.COUNTERCLOCKWISE&&this._side===ce.RIGHT;g===0?this.addCollinear(p):_?this.addOutsideTurn(g,p):this.addInsideTurn(g,p)},$n.prototype.addLineEndCap=function(c,p){var g=new di(c,p),_=new di;this.computeOffsetSegment(g,ce.LEFT,this._distance,_);var S=new di;this.computeOffsetSegment(g,ce.RIGHT,this._distance,S);var U=p.x-c.x,G=p.y-c.y,ee=Math.atan2(G,U);switch(this._bufParams.getEndCapStyle()){case _n.CAP_ROUND:this._segList.addPt(_.p1),this.addFilletArc(p,ee+Math.PI/2,ee-Math.PI/2,Qe.CLOCKWISE,this._distance),this._segList.addPt(S.p1);break;case _n.CAP_FLAT:this._segList.addPt(_.p1),this._segList.addPt(S.p1);break;case _n.CAP_SQUARE:var ye=new L;ye.x=Math.abs(this._distance)*Math.cos(ee),ye.y=Math.abs(this._distance)*Math.sin(ee);var Te=new L(_.p1.x+ye.x,_.p1.y+ye.y),et=new L(S.p1.x+ye.x,S.p1.y+ye.y);this._segList.addPt(Te),this._segList.addPt(et)}},$n.prototype.getCoordinates=function(){return this._segList.getCoordinates()},$n.prototype.addMitreJoin=function(c,p,g,_){var S=!0,U=null;try{U=Le.intersection(p.p0,p.p1,g.p0,g.p1),(_<=0?1:U.distance(c)/Math.abs(_))>this._bufParams.getMitreLimit()&&(S=!1)}catch(G){if(!(G instanceof je))throw G;U=new L(0,0),S=!1}S?this._segList.addPt(U):this.addLimitedMitreJoin(p,g,_,this._bufParams.getMitreLimit())},$n.prototype.addFilletCorner=function(c,p,g,_,S){var U=p.x-c.x,G=p.y-c.y,ee=Math.atan2(G,U),ye=g.x-c.x,Te=g.y-c.y,et=Math.atan2(Te,ye);_===Qe.CLOCKWISE?ee<=et&&(ee+=2*Math.PI):ee>=et&&(ee-=2*Math.PI),this._segList.addPt(p),this.addFilletArc(c,ee,et,_,S),this._segList.addPt(g)},$n.prototype.addOutsideTurn=function(c,p){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*$n.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===_n.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===_n.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(p&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,c,this._distance),this._segList.addPt(this._offset1.p0))},$n.prototype.createSquare=function(c){this._segList.addPt(new L(c.x+this._distance,c.y+this._distance)),this._segList.addPt(new L(c.x+this._distance,c.y-this._distance)),this._segList.addPt(new L(c.x-this._distance,c.y-this._distance)),this._segList.addPt(new L(c.x-this._distance,c.y+this._distance)),this._segList.closeRing()},$n.prototype.addSegments=function(c,p){this._segList.addPts(c,p)},$n.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},$n.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},$n.prototype.initSideSegments=function(c,p,g){this._s1=c,this._s2=p,this._side=g,this._seg1.setCoordinates(c,p),this.computeOffsetSegment(this._seg1,g,this._distance,this._offset1)},$n.prototype.addLimitedMitreJoin=function(c,p,g,_){var S=this._seg0.p1,U=nn.angle(S,this._seg0.p0),G=nn.angleBetweenOriented(this._seg0.p0,S,this._seg1.p1)/2,ee=nn.normalize(U+G),ye=nn.normalize(ee+Math.PI),Te=_*g,et=g-Te*Math.abs(Math.sin(G)),it=S.x+Te*Math.cos(ye),kt=S.y+Te*Math.sin(ye),zt=new L(it,kt),Yt=new di(S,zt),wi=Yt.pointAlongOffset(1,et),En=Yt.pointAlongOffset(1,-et);this._side===ce.LEFT?(this._segList.addPt(wi),this._segList.addPt(En)):(this._segList.addPt(En),this._segList.addPt(wi))},$n.prototype.computeOffsetSegment=function(c,p,g,_){var S=p===ce.LEFT?1:-1,U=c.p1.x-c.p0.x,G=c.p1.y-c.p0.y,ee=Math.sqrt(U*U+G*G),ye=S*g*U/ee,Te=S*g*G/ee;_.p0.x=c.p0.x-Te,_.p0.y=c.p0.y+ye,_.p1.x=c.p1.x-Te,_.p1.y=c.p1.y+ye},$n.prototype.addFilletArc=function(c,p,g,_,S){var U=_===Qe.CLOCKWISE?-1:1,G=Math.abs(p-g),ee=Math.trunc(G/this._filletAngleQuantum+.5);if(ee<1)return null;for(var ye=G/ee,Te=0,et=new L;Te<G;){var it=p+U*Te;et.x=c.x+S*Math.cos(it),et.y=c.y+S*Math.sin(it),this._segList.addPt(et),Te+=ye}},$n.prototype.addInsideTurn=function(c,p){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*$n.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var g=new L((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(g);var _=new L((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(_)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},$n.prototype.createCircle=function(c){var p=new L(c.x+this._distance,c.y);this._segList.addPt(p),this.addFilletArc(c,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},$n.prototype.addBevelJoin=function(c,p){this._segList.addPt(c.p1),this._segList.addPt(p.p0)},$n.prototype.init=function(c){this._distance=c,this._maxCurveSegmentError=c*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new po,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(c*$n.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},$n.prototype.addCollinear=function(c){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===_n.JOIN_BEVEL||this._bufParams.getJoinStyle()===_n.JOIN_MITRE?(c&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,Qe.CLOCKWISE,this._distance))},$n.prototype.closeRing=function(){this._segList.closeRing()},$n.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},$n.prototype.interfaces_=function(){return[]},$n.prototype.getClass=function(){return $n},Qg.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return .001},Qg.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return .001},Qg.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},Qg.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties($n,Qg);var Na=l(function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var c=arguments[0],p=arguments[1];this._precisionModel=c,this._bufParams=p},"Mn");Na.prototype.getOffsetCurve=function(c,p){if(this._distance=p,p===0)return null;var g=p<0,_=Math.abs(p),S=this.getSegGen(_);c.length<=1?this.computePointCurve(c[0],S):this.computeOffsetCurve(c,g,S);var U=S.getCoordinates();return g&&fe.reverse(U),U},Na.prototype.computeSingleSidedBufferCurve=function(c,p,g){var _=this.simplifyTolerance(this._distance);if(p){g.addSegments(c,!0);var S=ar.simplify(c,-_),U=S.length-1;g.initSideSegments(S[U],S[U-1],ce.LEFT),g.addFirstSegment();for(var G=U-2;G>=0;G--)g.addNextSegment(S[G],!0)}else{g.addSegments(c,!1);var ee=ar.simplify(c,_),ye=ee.length-1;g.initSideSegments(ee[0],ee[1],ce.LEFT),g.addFirstSegment();for(var Te=2;Te<=ye;Te++)g.addNextSegment(ee[Te],!0)}g.addLastSegment(),g.closeRing()},Na.prototype.computeRingBufferCurve=function(c,p,g){var _=this.simplifyTolerance(this._distance);p===ce.RIGHT&&(_=-_);var S=ar.simplify(c,_),U=S.length-1;g.initSideSegments(S[U-1],S[0],p);for(var G=1;G<=U;G++){var ee=G!==1;g.addNextSegment(S[G],ee)}g.closeRing()},Na.prototype.computeLineBufferCurve=function(c,p){var g=this.simplifyTolerance(this._distance),_=ar.simplify(c,g),S=_.length-1;p.initSideSegments(_[0],_[1],ce.LEFT);for(var U=2;U<=S;U++)p.addNextSegment(_[U],!0);p.addLastSegment(),p.addLineEndCap(_[S-1],_[S]);var G=ar.simplify(c,-g),ee=G.length-1;p.initSideSegments(G[ee],G[ee-1],ce.LEFT);for(var ye=ee-2;ye>=0;ye--)p.addNextSegment(G[ye],!0);p.addLastSegment(),p.addLineEndCap(G[1],G[0]),p.closeRing()},Na.prototype.computePointCurve=function(c,p){switch(this._bufParams.getEndCapStyle()){case _n.CAP_ROUND:p.createCircle(c);break;case _n.CAP_SQUARE:p.createSquare(c)}},Na.prototype.getLineCurve=function(c,p){if(this._distance=p,p<0&&!this._bufParams.isSingleSided()||p===0)return null;var g=Math.abs(p),_=this.getSegGen(g);if(c.length<=1)this.computePointCurve(c[0],_);else if(this._bufParams.isSingleSided()){var S=p<0;this.computeSingleSidedBufferCurve(c,S,_)}else this.computeLineBufferCurve(c,_);return _.getCoordinates()},Na.prototype.getBufferParameters=function(){return this._bufParams},Na.prototype.simplifyTolerance=function(c){return c*this._bufParams.getSimplifyFactor()},Na.prototype.getRingCurve=function(c,p,g){if(this._distance=g,c.length<=2)return this.getLineCurve(c,g);if(g===0)return Na.copyCoordinates(c);var _=this.getSegGen(g);return this.computeRingBufferCurve(c,p,_),_.getCoordinates()},Na.prototype.computeOffsetCurve=function(c,p,g){var _=this.simplifyTolerance(this._distance);if(p){var S=ar.simplify(c,-_),U=S.length-1;g.initSideSegments(S[U],S[U-1],ce.LEFT),g.addFirstSegment();for(var G=U-2;G>=0;G--)g.addNextSegment(S[G],!0)}else{var ee=ar.simplify(c,_),ye=ee.length-1;g.initSideSegments(ee[0],ee[1],ce.LEFT),g.addFirstSegment();for(var Te=2;Te<=ye;Te++)g.addNextSegment(ee[Te],!0)}g.addLastSegment()},Na.prototype.getSegGen=function(c){return new $n(this._precisionModel,this._bufParams,c)},Na.prototype.interfaces_=function(){return[]},Na.prototype.getClass=function(){return Na},Na.copyCoordinates=function(c){for(var p=new Array(c.length).fill(null),g=0;g<p.length;g++)p[g]=new L(c[g]);return p};var Jc=l(function(){this._subgraphs=null,this._seg=new di,this._cga=new Qe;var c=arguments[0];this._subgraphs=c},"An"),p6={DepthSegment:{configurable:!0}};Jc.prototype.findStabbedSegments=function(){if(arguments.length===1){for(var c=arguments[0],p=new X,g=this._subgraphs.iterator();g.hasNext();){var _=g.next(),S=_.getEnvelope();c.y<S.getMinY()||c.y>S.getMaxY()||this.findStabbedSegments(c,_.getDirectedEdges(),p)}return p}if(arguments.length===3){if(J(arguments[2],W)&&arguments[0]instanceof L&&arguments[1]instanceof Jo){for(var U=arguments[0],G=arguments[1],ee=arguments[2],ye=G.getEdge().getCoordinates(),Te=0;Te<ye.length-1;Te++)if(this._seg.p0=ye[Te],this._seg.p1=ye[Te+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<U.x)&&!(this._seg.isHorizontal()||U.y<this._seg.p0.y||U.y>this._seg.p1.y||Qe.computeOrientation(this._seg.p0,this._seg.p1,U)===Qe.RIGHT)){var et=G.getDepth(ce.LEFT);this._seg.p0.equals(ye[Te])||(et=G.getDepth(ce.RIGHT));var it=new Mh(this._seg,et);ee.add(it)}}else if(J(arguments[2],W)&&arguments[0]instanceof L&&J(arguments[1],W))for(var kt=arguments[0],zt=arguments[1],Yt=arguments[2],wi=zt.iterator();wi.hasNext();){var En=wi.next();En.isForward()&&this.findStabbedSegments(kt,En,Yt)}}},Jc.prototype.getDepth=function(c){var p=this.findStabbedSegments(c);return p.size()===0?0:Se.min(p)._leftDepth},Jc.prototype.interfaces_=function(){return[]},Jc.prototype.getClass=function(){return Jc},p6.DepthSegment.get=function(){return Mh},Object.defineProperties(Jc,p6);var Mh=l(function(){this._upwardSeg=null,this._leftDepth=null;var c=arguments[0],p=arguments[1];this._upwardSeg=new di(c),this._leftDepth=p},"Gn");Mh.prototype.compareTo=function(c){var p=c;if(this._upwardSeg.minX()>=p._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=p._upwardSeg.minX())return-1;var g=this._upwardSeg.orientationIndex(p._upwardSeg);return g!==0||(g=-1*p._upwardSeg.orientationIndex(this._upwardSeg))!=0?g:this._upwardSeg.compareTo(p._upwardSeg)},Mh.prototype.compareX=function(c,p){var g=c.p0.compareTo(p.p0);return g!==0?g:c.p1.compareTo(p.p1)},Mh.prototype.toString=function(){return this._upwardSeg.toString()},Mh.prototype.interfaces_=function(){return[B]},Mh.prototype.getClass=function(){return Mh};var xn=l(function(c,p,g){this.p0=c||null,this.p1=p||null,this.p2=g||null},"qn");xn.prototype.area=function(){return xn.area(this.p0,this.p1,this.p2)},xn.prototype.signedArea=function(){return xn.signedArea(this.p0,this.p1,this.p2)},xn.prototype.interpolateZ=function(c){if(c===null)throw new T("Supplied point is null.");return xn.interpolateZ(c,this.p0,this.p1,this.p2)},xn.prototype.longestSideLength=function(){return xn.longestSideLength(this.p0,this.p1,this.p2)},xn.prototype.isAcute=function(){return xn.isAcute(this.p0,this.p1,this.p2)},xn.prototype.circumcentre=function(){return xn.circumcentre(this.p0,this.p1,this.p2)},xn.prototype.area3D=function(){return xn.area3D(this.p0,this.p1,this.p2)},xn.prototype.centroid=function(){return xn.centroid(this.p0,this.p1,this.p2)},xn.prototype.inCentre=function(){return xn.inCentre(this.p0,this.p1,this.p2)},xn.prototype.interfaces_=function(){return[]},xn.prototype.getClass=function(){return xn},xn.area=function(c,p,g){return Math.abs(((g.x-c.x)*(p.y-c.y)-(p.x-c.x)*(g.y-c.y))/2)},xn.signedArea=function(c,p,g){return((g.x-c.x)*(p.y-c.y)-(p.x-c.x)*(g.y-c.y))/2},xn.det=function(c,p,g,_){return c*_-p*g},xn.interpolateZ=function(c,p,g,_){var S=p.x,U=p.y,G=g.x-S,ee=_.x-S,ye=g.y-U,Te=_.y-U,et=G*Te-ee*ye,it=c.x-S,kt=c.y-U,zt=(Te*it-ee*kt)/et,Yt=(-ye*it+G*kt)/et;return p.z+zt*(g.z-p.z)+Yt*(_.z-p.z)},xn.longestSideLength=function(c,p,g){var _=c.distance(p),S=p.distance(g),U=g.distance(c),G=_;return S>G&&(G=S),U>G&&(G=U),G},xn.isAcute=function(c,p,g){return!!nn.isAcute(c,p,g)&&!!nn.isAcute(p,g,c)&&!!nn.isAcute(g,c,p)},xn.circumcentre=function(c,p,g){var _=g.x,S=g.y,U=c.x-_,G=c.y-S,ee=p.x-_,ye=p.y-S,Te=2*xn.det(U,G,ee,ye),et=xn.det(G,U*U+G*G,ye,ee*ee+ye*ye),it=xn.det(U,U*U+G*G,ee,ee*ee+ye*ye);return new L(_-et/Te,S+it/Te)},xn.perpendicularBisector=function(c,p){var g=p.x-c.x,_=p.y-c.y,S=new Le(c.x+g/2,c.y+_/2,1),U=new Le(c.x-_+g/2,c.y+g+_/2,1);return new Le(S,U)},xn.angleBisector=function(c,p,g){var _=p.distance(c),S=_/(_+p.distance(g)),U=g.x-c.x,G=g.y-c.y;return new L(c.x+S*U,c.y+S*G)},xn.area3D=function(c,p,g){var _=p.x-c.x,S=p.y-c.y,U=p.z-c.z,G=g.x-c.x,ee=g.y-c.y,ye=g.z-c.z,Te=S*ye-U*ee,et=U*G-_*ye,it=_*ee-S*G,kt=Te*Te+et*et+it*it,zt=Math.sqrt(kt)/2;return zt},xn.centroid=function(c,p,g){var _=(c.x+p.x+g.x)/3,S=(c.y+p.y+g.y)/3;return new L(_,S)},xn.inCentre=function(c,p,g){var _=p.distance(g),S=c.distance(g),U=c.distance(p),G=_+S+U,ee=(_*c.x+S*p.x+U*g.x)/G,ye=(_*c.y+S*p.y+U*g.y)/G;return new L(ee,ye)};var Do=l(function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new X;var c=arguments[0],p=arguments[1],g=arguments[2];this._inputGeom=c,this._distance=p,this._curveBuilder=g},"Bn");Do.prototype.addPoint=function(c){if(this._distance<=0)return null;var p=c.getCoordinates(),g=this._curveBuilder.getLineCurve(p,this._distance);this.addCurve(g,O.EXTERIOR,O.INTERIOR)},Do.prototype.addPolygon=function(c){var p=this._distance,g=ce.LEFT;this._distance<0&&(p=-this._distance,g=ce.RIGHT);var _=c.getExteriorRing(),S=fe.removeRepeatedPoints(_.getCoordinates());if(this._distance<0&&this.isErodedCompletely(_,this._distance)||this._distance<=0&&S.length<3)return null;this.addPolygonRing(S,p,g,O.EXTERIOR,O.INTERIOR);for(var U=0;U<c.getNumInteriorRing();U++){var G=c.getInteriorRingN(U),ee=fe.removeRepeatedPoints(G.getCoordinates());this._distance>0&&this.isErodedCompletely(G,-this._distance)||this.addPolygonRing(ee,p,ce.opposite(g),O.INTERIOR,O.EXTERIOR)}},Do.prototype.isTriangleErodedCompletely=function(c,p){var g=new xn(c[0],c[1],c[2]),_=g.inCentre();return Qe.distancePointLine(_,g.p0,g.p1)<Math.abs(p)},Do.prototype.addLineString=function(c){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var p=fe.removeRepeatedPoints(c.getCoordinates()),g=this._curveBuilder.getLineCurve(p,this._distance);this.addCurve(g,O.EXTERIOR,O.INTERIOR)},Do.prototype.addCurve=function(c,p,g){if(c===null||c.length<2)return null;var _=new cr(c,new It(0,O.BOUNDARY,p,g));this._curveList.add(_)},Do.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},Do.prototype.addPolygonRing=function(c,p,g,_,S){if(p===0&&c.length<Ft.MINIMUM_VALID_SIZE)return null;var U=_,G=S;c.length>=Ft.MINIMUM_VALID_SIZE&&Qe.isCCW(c)&&(U=S,G=_,g=ce.opposite(g));var ee=this._curveBuilder.getRingCurve(c,g,p);this.addCurve(ee,U,G)},Do.prototype.add=function(c){if(c.isEmpty())return null;c instanceof pt?this.addPolygon(c):c instanceof Pe?this.addLineString(c):c instanceof Ge?this.addPoint(c):c instanceof Ot?this.addCollection(c):c instanceof yn?this.addCollection(c):c instanceof $t?this.addCollection(c):c instanceof Ti&&this.addCollection(c)},Do.prototype.isErodedCompletely=function(c,p){var g=c.getCoordinates();if(g.length<4)return p<0;if(g.length===4)return this.isTriangleErodedCompletely(g,p);var _=c.getEnvelopeInternal(),S=Math.min(_.getHeight(),_.getWidth());return p<0&&2*Math.abs(p)>S},Do.prototype.addCollection=function(c){for(var p=0;p<c.getNumGeometries();p++){var g=c.getGeometryN(p);this.add(g)}},Do.prototype.interfaces_=function(){return[]},Do.prototype.getClass=function(){return Do};var Fd=l(function(){},"Vn");Fd.prototype.locate=function(c){},Fd.prototype.interfaces_=function(){return[]},Fd.prototype.getClass=function(){return Fd};var Vs=l(function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var c=arguments[0];this._parent=c,this._atStart=!0,this._index=0,this._max=c.getNumGeometries()},"Un");Vs.prototype.next=function(){if(this._atStart)return this._atStart=!1,Vs.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new a;var c=this._parent.getGeometryN(this._index++);return c instanceof Ti?(this._subcollectionIterator=new Vs(c),this._subcollectionIterator.next()):c},Vs.prototype.remove=function(){throw new Error(this.getClass().getName())},Vs.prototype.hasNext=function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},Vs.prototype.interfaces_=function(){return[me]},Vs.prototype.getClass=function(){return Vs},Vs.isAtomic=function(c){return!(c instanceof Ti)};var fo=l(function(){this._geom=null;var c=arguments[0];this._geom=c},"zn");fo.prototype.locate=function(c){return fo.locate(c,this._geom)},fo.prototype.interfaces_=function(){return[Fd]},fo.prototype.getClass=function(){return fo},fo.isPointInRing=function(c,p){return!!p.getEnvelopeInternal().intersects(c)&&Qe.isPointInRing(c,p.getCoordinates())},fo.containsPointInPolygon=function(c,p){if(p.isEmpty())return!1;var g=p.getExteriorRing();if(!fo.isPointInRing(c,g))return!1;for(var _=0;_<p.getNumInteriorRing();_++){var S=p.getInteriorRingN(_);if(fo.isPointInRing(c,S))return!1}return!0},fo.containsPoint=function(c,p){if(p instanceof pt)return fo.containsPointInPolygon(c,p);if(p instanceof Ti)for(var g=new Vs(p);g.hasNext();){var _=g.next();if(_!==p&&fo.containsPoint(c,_))return!0}return!1},fo.locate=function(c,p){return p.isEmpty()?O.EXTERIOR:fo.containsPoint(c,p)?O.INTERIOR:O.EXTERIOR};var ya=l(function(){this._edgeMap=new v,this._edgeList=null,this._ptInAreaLocation=[O.NONE,O.NONE]},"Xn");ya.prototype.getNextCW=function(c){this.getEdges();var p=this._edgeList.indexOf(c),g=p-1;return p===0&&(g=this._edgeList.size()-1),this._edgeList.get(g)},ya.prototype.propagateSideLabels=function(c){for(var p=O.NONE,g=this.iterator();g.hasNext();){var _=g.next().getLabel();_.isArea(c)&&_.getLocation(c,ce.LEFT)!==O.NONE&&(p=_.getLocation(c,ce.LEFT))}if(p===O.NONE)return null;for(var S=p,U=this.iterator();U.hasNext();){var G=U.next(),ee=G.getLabel();if(ee.getLocation(c,ce.ON)===O.NONE&&ee.setLocation(c,ce.ON,S),ee.isArea(c)){var ye=ee.getLocation(c,ce.LEFT),Te=ee.getLocation(c,ce.RIGHT);if(Te!==O.NONE){if(Te!==S)throw new mt("side location conflict",G.getCoordinate());ye===O.NONE&&pe.shouldNeverReachHere("found single null side (at "+G.getCoordinate()+")"),S=ye}else pe.isTrue(ee.getLocation(c,ce.LEFT)===O.NONE,"found single null side"),ee.setLocation(c,ce.RIGHT,S),ee.setLocation(c,ce.LEFT,S)}}},ya.prototype.getCoordinate=function(){var c=this.iterator();return c.hasNext()?c.next().getCoordinate():null},ya.prototype.print=function(c){Ve.out.println("EdgeEndStar:   "+this.getCoordinate());for(var p=this.iterator();p.hasNext();)p.next().print(c)},ya.prototype.isAreaLabelsConsistent=function(c){return this.computeEdgeEndLabels(c.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},ya.prototype.checkAreaLabelsConsistent=function(c){var p=this.getEdges();if(p.size()<=0)return!0;var g=p.size()-1,_=p.get(g).getLabel().getLocation(c,ce.LEFT);pe.isTrue(_!==O.NONE,"Found unlabelled area edge");for(var S=_,U=this.iterator();U.hasNext();){var G=U.next().getLabel();pe.isTrue(G.isArea(c),"Found non-area edge");var ee=G.getLocation(c,ce.LEFT),ye=G.getLocation(c,ce.RIGHT);if(ee===ye||ye!==S)return!1;S=ee}return!0},ya.prototype.findIndex=function(c){this.iterator();for(var p=0;p<this._edgeList.size();p++)if(this._edgeList.get(p)===c)return p;return-1},ya.prototype.iterator=function(){return this.getEdges().iterator()},ya.prototype.getEdges=function(){return this._edgeList===null&&(this._edgeList=new X(this._edgeMap.values())),this._edgeList},ya.prototype.getLocation=function(c,p,g){return this._ptInAreaLocation[c]===O.NONE&&(this._ptInAreaLocation[c]=fo.locate(p,g[c].getGeometry())),this._ptInAreaLocation[c]},ya.prototype.toString=function(){var c=new K;c.append("EdgeEndStar:   "+this.getCoordinate()),c.append(`
`);for(var p=this.iterator();p.hasNext();){var g=p.next();c.append(g),c.append(`
`)}return c.toString()},ya.prototype.computeEdgeEndLabels=function(c){for(var p=this.iterator();p.hasNext();)p.next().computeLabel(c)},ya.prototype.computeLabelling=function(c){this.computeEdgeEndLabels(c[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var p=[!1,!1],g=this.iterator();g.hasNext();)for(var _=g.next().getLabel(),S=0;S<2;S++)_.isLine(S)&&_.getLocation(S)===O.BOUNDARY&&(p[S]=!0);for(var U=this.iterator();U.hasNext();)for(var G=U.next(),ee=G.getLabel(),ye=0;ye<2;ye++)if(ee.isAnyNull(ye)){var Te=O.NONE;if(p[ye])Te=O.EXTERIOR;else{var et=G.getCoordinate();Te=this.getLocation(ye,et,c)}ee.setAllLocationsIfNull(ye,Te)}},ya.prototype.getDegree=function(){return this._edgeMap.size()},ya.prototype.insertEdgeEnd=function(c,p){this._edgeMap.put(c,p),this._edgeList=null},ya.prototype.interfaces_=function(){return[]},ya.prototype.getClass=function(){return ya};var Fue=function(c){function p(){c.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var g=null,_=null,S=this._SCANNING_FOR_INCOMING,U=0;U<this._resultAreaEdgeList.size();U++){var G=this._resultAreaEdgeList.get(U),ee=G.getSym();if(G.getLabel().isArea())switch(g===null&&G.isInResult()&&(g=G),S){case this._SCANNING_FOR_INCOMING:if(!ee.isInResult())continue;_=ee,S=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!G.isInResult())continue;_.setNext(G),S=this._SCANNING_FOR_INCOMING}}if(S===this._LINKING_TO_OUTGOING){if(g===null)throw new mt("no outgoing dirEdge found",this.getCoordinate());pe.isTrue(g.isInResult(),"unable to link last incoming dirEdge"),_.setNext(g)}},p.prototype.insert=function(g){var _=g;this.insertEdgeEnd(_,_)},p.prototype.getRightmostEdge=function(){var g=this.getEdges(),_=g.size();if(_<1)return null;var S=g.get(0);if(_===1)return S;var U=g.get(_-1),G=S.getQuadrant(),ee=U.getQuadrant();return Bi.isNorthern(G)&&Bi.isNorthern(ee)?S:Bi.isNorthern(G)||Bi.isNorthern(ee)?S.getDy()!==0?S:U.getDy()!==0?U:(pe.shouldNeverReachHere("found two horizontal edges incident on node"),null):U},p.prototype.print=function(g){Ve.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var _=this.iterator();_.hasNext();){var S=_.next();g.print("out "),S.print(g),g.println(),g.print("in "),S.getSym().print(g),g.println()}},p.prototype.getResultAreaEdges=function(){if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new X;for(var g=this.iterator();g.hasNext();){var _=g.next();(_.isInResult()||_.getSym().isInResult())&&this._resultAreaEdgeList.add(_)}return this._resultAreaEdgeList},p.prototype.updateLabelling=function(g){for(var _=this.iterator();_.hasNext();){var S=_.next().getLabel();S.setAllLocationsIfNull(0,g.getLocation(0)),S.setAllLocationsIfNull(1,g.getLocation(1))}},p.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var g=null,_=null,S=this._edgeList.size()-1;S>=0;S--){var U=this._edgeList.get(S),G=U.getSym();_===null&&(_=G),g!==null&&G.setNext(g),g=U}_.setNext(g)},p.prototype.computeDepths=function(){if(arguments.length===1){var g=arguments[0],_=this.findIndex(g),S=g.getDepth(ce.LEFT),U=g.getDepth(ce.RIGHT),G=this.computeDepths(_+1,this._edgeList.size(),S);if(this.computeDepths(0,_,G)!==U)throw new mt("depth mismatch at "+g.getCoordinate())}else if(arguments.length===3){for(var ee=arguments[0],ye=arguments[1],Te=arguments[2],et=ee;et<ye;et++){var it=this._edgeList.get(et);it.setEdgeDepths(ce.RIGHT,Te),Te=it.getDepth(ce.LEFT)}return Te}},p.prototype.mergeSymLabels=function(){for(var g=this.iterator();g.hasNext();){var _=g.next();_.getLabel().merge(_.getSym().getLabel())}},p.prototype.linkMinimalDirectedEdges=function(g){for(var _=null,S=null,U=this._SCANNING_FOR_INCOMING,G=this._resultAreaEdgeList.size()-1;G>=0;G--){var ee=this._resultAreaEdgeList.get(G),ye=ee.getSym();switch(_===null&&ee.getEdgeRing()===g&&(_=ee),U){case this._SCANNING_FOR_INCOMING:if(ye.getEdgeRing()!==g)continue;S=ye,U=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(ee.getEdgeRing()!==g)continue;S.setNextMin(ee),U=this._SCANNING_FOR_INCOMING}}U===this._LINKING_TO_OUTGOING&&(pe.isTrue(_!==null,"found null for first outgoing dirEdge"),pe.isTrue(_.getEdgeRing()===g,"unable to link last incoming dirEdge"),S.setNextMin(_))},p.prototype.getOutgoingDegree=function(){if(arguments.length===0){for(var g=0,_=this.iterator();_.hasNext();)_.next().isInResult()&&g++;return g}if(arguments.length===1){for(var S=arguments[0],U=0,G=this.iterator();G.hasNext();)G.next().getEdgeRing()===S&&U++;return U}},p.prototype.getLabel=function(){return this._label},p.prototype.findCoveredLineEdges=function(){for(var g=O.NONE,_=this.iterator();_.hasNext();){var S=_.next(),U=S.getSym();if(!S.isLineEdge()){if(S.isInResult()){g=O.INTERIOR;break}if(U.isInResult()){g=O.EXTERIOR;break}}}if(g===O.NONE)return null;for(var G=g,ee=this.iterator();ee.hasNext();){var ye=ee.next(),Te=ye.getSym();ye.isLineEdge()?ye.getEdge().setCovered(G===O.INTERIOR):(ye.isInResult()&&(G=O.EXTERIOR),Te.isInResult()&&(G=O.INTERIOR))}},p.prototype.computeLabelling=function(g){c.prototype.computeLabelling.call(this,g),this._label=new It(O.NONE);for(var _=this.iterator();_.hasNext();)for(var S=_.next().getEdge().getLabel(),U=0;U<2;U++){var G=S.getLocation(U);G!==O.INTERIOR&&G!==O.BOUNDARY||this._label.setLocation(U,O.INTERIOR)}},p.prototype.interfaces_=function(){return[]},p.prototype.getClass=function(){return p},p}(ya),d6=function(c){function p(){c.apply(this,arguments)}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.createNode=function(g){return new xs(g,new Fue)},p.prototype.interfaces_=function(){return[]},p.prototype.getClass=function(){return p},p}(bs),_u=l(function c(){this._pts=null,this._orientation=null;var p=arguments[0];this._pts=p,this._orientation=c.orientation(p)},"t");_u.prototype.compareTo=function(c){var p=c;return _u.compareOriented(this._pts,this._orientation,p._pts,p._orientation)},_u.prototype.interfaces_=function(){return[B]},_u.prototype.getClass=function(){return _u},_u.orientation=function(c){return fe.increasingDirection(c)===1},_u.compareOriented=function(c,p,g,_){for(var S=p?1:-1,U=_?1:-1,G=p?c.length:-1,ee=_?g.length:-1,ye=p?0:c.length-1,Te=_?0:g.length-1;;){var et=c[ye].compareTo(g[Te]);if(et!==0)return et;var it=(ye+=S)===G,kt=(Te+=U)===ee;if(it&&!kt)return-1;if(!it&&kt)return 1;if(it&&kt)return 0}};var Ko=l(function(){this._edges=new X,this._ocaMap=new v},"Hn");Ko.prototype.print=function(c){c.print("MULTILINESTRING ( ");for(var p=0;p<this._edges.size();p++){var g=this._edges.get(p);p>0&&c.print(","),c.print("(");for(var _=g.getCoordinates(),S=0;S<_.length;S++)S>0&&c.print(","),c.print(_[S].x+" "+_[S].y);c.println(")")}c.print(")  ")},Ko.prototype.addAll=function(c){for(var p=c.iterator();p.hasNext();)this.add(p.next())},Ko.prototype.findEdgeIndex=function(c){for(var p=0;p<this._edges.size();p++)if(this._edges.get(p).equals(c))return p;return-1},Ko.prototype.iterator=function(){return this._edges.iterator()},Ko.prototype.getEdges=function(){return this._edges},Ko.prototype.get=function(c){return this._edges.get(c)},Ko.prototype.findEqualEdge=function(c){var p=new _u(c.getCoordinates());return this._ocaMap.get(p)},Ko.prototype.add=function(c){this._edges.add(c);var p=new _u(c.getCoordinates());this._ocaMap.put(p,c)},Ko.prototype.interfaces_=function(){return[]},Ko.prototype.getClass=function(){return Ko};var Ch=l(function(){},"Wn");Ch.prototype.processIntersections=function(c,p,g,_){},Ch.prototype.isDone=function(){},Ch.prototype.interfaces_=function(){return[]},Ch.prototype.getClass=function(){return Ch};var mo=l(function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var c=arguments[0];this._li=c},"Kn");mo.prototype.isTrivialIntersection=function(c,p,g,_){if(c===g&&this._li.getIntersectionNum()===1){if(mo.isAdjacentSegments(p,_))return!0;if(c.isClosed()){var S=c.size()-1;if(p===0&&_===S||_===0&&p===S)return!0}}return!1},mo.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},mo.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},mo.prototype.getLineIntersector=function(){return this._li},mo.prototype.hasProperIntersection=function(){return this._hasProper},mo.prototype.processIntersections=function(c,p,g,_){if(c===g&&p===_)return null;this.numTests++;var S=c.getCoordinates()[p],U=c.getCoordinates()[p+1],G=g.getCoordinates()[_],ee=g.getCoordinates()[_+1];this._li.computeIntersection(S,U,G,ee),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(c,p,g,_)||(this._hasIntersection=!0,c.addIntersections(this._li,p,0),g.addIntersections(this._li,_,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},mo.prototype.hasIntersection=function(){return this._hasIntersection},mo.prototype.isDone=function(){return!1},mo.prototype.hasInteriorIntersection=function(){return this._hasInterior},mo.prototype.interfaces_=function(){return[Ch]},mo.prototype.getClass=function(){return mo},mo.isAdjacentSegments=function(c,p){return Math.abs(c-p)===1};var As=l(function(){this.coord=null,this.segmentIndex=null,this.dist=null;var c=arguments[0],p=arguments[1],g=arguments[2];this.coord=new L(c),this.segmentIndex=p,this.dist=g},"Jn");As.prototype.getSegmentIndex=function(){return this.segmentIndex},As.prototype.getCoordinate=function(){return this.coord},As.prototype.print=function(c){c.print(this.coord),c.print(" seg # = "+this.segmentIndex),c.println(" dist = "+this.dist)},As.prototype.compareTo=function(c){var p=c;return this.compare(p.segmentIndex,p.dist)},As.prototype.isEndPoint=function(c){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===c},As.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},As.prototype.getDistance=function(){return this.dist},As.prototype.compare=function(c,p){return this.segmentIndex<c?-1:this.segmentIndex>c?1:this.dist<p?-1:this.dist>p?1:0},As.prototype.interfaces_=function(){return[B]},As.prototype.getClass=function(){return As};var js=l(function(){this._nodeMap=new v,this.edge=null;var c=arguments[0];this.edge=c},"Qn");js.prototype.print=function(c){c.println("Intersections:");for(var p=this.iterator();p.hasNext();)p.next().print(c)},js.prototype.iterator=function(){return this._nodeMap.values().iterator()},js.prototype.addSplitEdges=function(c){this.addEndpoints();for(var p=this.iterator(),g=p.next();p.hasNext();){var _=p.next(),S=this.createSplitEdge(g,_);c.add(S),g=_}},js.prototype.addEndpoints=function(){var c=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[c],c,0)},js.prototype.createSplitEdge=function(c,p){var g=p.segmentIndex-c.segmentIndex+2,_=this.edge.pts[p.segmentIndex],S=p.dist>0||!p.coord.equals2D(_);S||g--;var U=new Array(g).fill(null),G=0;U[G++]=new L(c.coord);for(var ee=c.segmentIndex+1;ee<=p.segmentIndex;ee++)U[G++]=this.edge.pts[ee];return S&&(U[G]=p.coord),new T0(U,new It(this.edge._label))},js.prototype.add=function(c,p,g){var _=new As(c,p,g),S=this._nodeMap.get(_);return S!==null?S:(this._nodeMap.put(_,_),_)},js.prototype.isIntersection=function(c){for(var p=this.iterator();p.hasNext();)if(p.next().coord.equals(c))return!0;return!1},js.prototype.interfaces_=function(){return[]},js.prototype.getClass=function(){return js};var Eh=l(function(){},"Zn");Eh.prototype.getChainStartIndices=function(c){var p=0,g=new X;g.add(new te(p));do{var _=this.findChainEnd(c,p);g.add(new te(_)),p=_}while(p<c.length-1);return Eh.toIntArray(g)},Eh.prototype.findChainEnd=function(c,p){for(var g=Bi.quadrant(c[p],c[p+1]),_=p+1;_<c.length&&Bi.quadrant(c[_-1],c[_])===g;)_++;return _-1},Eh.prototype.interfaces_=function(){return[]},Eh.prototype.getClass=function(){return Eh},Eh.toIntArray=function(c){for(var p=new Array(c.size()).fill(null),g=0;g<p.length;g++)p[g]=c.get(g).intValue();return p};var Cl=l(function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new xe,this.env2=new xe;var c=arguments[0];this.e=c,this.pts=c.getCoordinates();var p=new Eh;this.startIndex=p.getChainStartIndices(this.pts)},"$n");Cl.prototype.getCoordinates=function(){return this.pts},Cl.prototype.getMaxX=function(c){var p=this.pts[this.startIndex[c]].x,g=this.pts[this.startIndex[c+1]].x;return p>g?p:g},Cl.prototype.getMinX=function(c){var p=this.pts[this.startIndex[c]].x,g=this.pts[this.startIndex[c+1]].x;return p<g?p:g},Cl.prototype.computeIntersectsForChain=function(){if(arguments.length===4){var c=arguments[0],p=arguments[1],g=arguments[2],_=arguments[3];this.computeIntersectsForChain(this.startIndex[c],this.startIndex[c+1],p,p.startIndex[g],p.startIndex[g+1],_)}else if(arguments.length===6){var S=arguments[0],U=arguments[1],G=arguments[2],ee=arguments[3],ye=arguments[4],Te=arguments[5],et=this.pts[S],it=this.pts[U],kt=G.pts[ee],zt=G.pts[ye];if(U-S==1&&ye-ee==1)return Te.addIntersections(this.e,S,G.e,ee),null;if(this.env1.init(et,it),this.env2.init(kt,zt),!this.env1.intersects(this.env2))return null;var Yt=Math.trunc((S+U)/2),wi=Math.trunc((ee+ye)/2);S<Yt&&(ee<wi&&this.computeIntersectsForChain(S,Yt,G,ee,wi,Te),wi<ye&&this.computeIntersectsForChain(S,Yt,G,wi,ye,Te)),Yt<U&&(ee<wi&&this.computeIntersectsForChain(Yt,U,G,ee,wi,Te),wi<ye&&this.computeIntersectsForChain(Yt,U,G,wi,ye,Te))}},Cl.prototype.getStartIndexes=function(){return this.startIndex},Cl.prototype.computeIntersects=function(c,p){for(var g=0;g<this.startIndex.length-1;g++)for(var _=0;_<c.startIndex.length-1;_++)this.computeIntersectsForChain(g,c,_,p)},Cl.prototype.interfaces_=function(){return[]},Cl.prototype.getClass=function(){return Cl};var ea=l(function c(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var p=0;p<2;p++)for(var g=0;g<3;g++)this._depth[p][g]=c.NULL_VALUE},"t"),f6={NULL_VALUE:{configurable:!0}};ea.prototype.getDepth=function(c,p){return this._depth[c][p]},ea.prototype.setDepth=function(c,p,g){this._depth[c][p]=g},ea.prototype.isNull=function(){if(arguments.length===0){for(var c=0;c<2;c++)for(var p=0;p<3;p++)if(this._depth[c][p]!==ea.NULL_VALUE)return!1;return!0}if(arguments.length===1){var g=arguments[0];return this._depth[g][1]===ea.NULL_VALUE}if(arguments.length===2){var _=arguments[0],S=arguments[1];return this._depth[_][S]===ea.NULL_VALUE}},ea.prototype.normalize=function(){for(var c=0;c<2;c++)if(!this.isNull(c)){var p=this._depth[c][1];this._depth[c][2]<p&&(p=this._depth[c][2]),p<0&&(p=0);for(var g=1;g<3;g++){var _=0;this._depth[c][g]>p&&(_=1),this._depth[c][g]=_}}},ea.prototype.getDelta=function(c){return this._depth[c][ce.RIGHT]-this._depth[c][ce.LEFT]},ea.prototype.getLocation=function(c,p){return this._depth[c][p]<=0?O.EXTERIOR:O.INTERIOR},ea.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},ea.prototype.add=function(){if(arguments.length===1)for(var c=arguments[0],p=0;p<2;p++)for(var g=1;g<3;g++){var _=c.getLocation(p,g);_!==O.EXTERIOR&&_!==O.INTERIOR||(this.isNull(p,g)?this._depth[p][g]=ea.depthAtLocation(_):this._depth[p][g]+=ea.depthAtLocation(_))}else if(arguments.length===3){var S=arguments[0],U=arguments[1];arguments[2]===O.INTERIOR&&this._depth[S][U]++}},ea.prototype.interfaces_=function(){return[]},ea.prototype.getClass=function(){return ea},ea.depthAtLocation=function(c){return c===O.EXTERIOR?0:c===O.INTERIOR?1:ea.NULL_VALUE},f6.NULL_VALUE.get=function(){return-1},Object.defineProperties(ea,f6);var T0=function(c){function p(){if(c.call(this),this.pts=null,this._env=null,this.eiList=new js(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new ea,this._depthDelta=0,arguments.length===1){var g=arguments[0];p.call(this,g,null)}else if(arguments.length===2){var _=arguments[0],S=arguments[1];this.pts=_,this._label=S}}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.getDepth=function(){return this._depth},p.prototype.getCollapsedEdge=function(){var g=new Array(2).fill(null);return g[0]=this.pts[0],g[1]=this.pts[1],new p(g,It.toLineLabel(this._label))},p.prototype.isIsolated=function(){return this._isIsolated},p.prototype.getCoordinates=function(){return this.pts},p.prototype.setIsolated=function(g){this._isIsolated=g},p.prototype.setName=function(g){this._name=g},p.prototype.equals=function(g){if(!(g instanceof p))return!1;var _=g;if(this.pts.length!==_.pts.length)return!1;for(var S=!0,U=!0,G=this.pts.length,ee=0;ee<this.pts.length;ee++)if(this.pts[ee].equals2D(_.pts[ee])||(S=!1),this.pts[ee].equals2D(_.pts[--G])||(U=!1),!S&&!U)return!1;return!0},p.prototype.getCoordinate=function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var g=arguments[0];return this.pts[g]}},p.prototype.print=function(g){g.print("edge "+this._name+": "),g.print("LINESTRING (");for(var _=0;_<this.pts.length;_++)_>0&&g.print(","),g.print(this.pts[_].x+" "+this.pts[_].y);g.print(")  "+this._label+" "+this._depthDelta)},p.prototype.computeIM=function(g){p.updateIM(this._label,g)},p.prototype.isCollapsed=function(){return!!this._label.isArea()&&this.pts.length===3&&!!this.pts[0].equals(this.pts[2])},p.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},p.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},p.prototype.getDepthDelta=function(){return this._depthDelta},p.prototype.getNumPoints=function(){return this.pts.length},p.prototype.printReverse=function(g){g.print("edge "+this._name+": ");for(var _=this.pts.length-1;_>=0;_--)g.print(this.pts[_]+" ");g.println("")},p.prototype.getMonotoneChainEdge=function(){return this._mce===null&&(this._mce=new Cl(this)),this._mce},p.prototype.getEnvelope=function(){if(this._env===null){this._env=new xe;for(var g=0;g<this.pts.length;g++)this._env.expandToInclude(this.pts[g])}return this._env},p.prototype.addIntersection=function(g,_,S,U){var G=new L(g.getIntersection(U)),ee=_,ye=g.getEdgeDistance(S,U),Te=ee+1;if(Te<this.pts.length){var et=this.pts[Te];G.equals2D(et)&&(ee=Te,ye=0)}this.eiList.add(G,ee,ye)},p.prototype.toString=function(){var g=new K;g.append("edge "+this._name+": "),g.append("LINESTRING (");for(var _=0;_<this.pts.length;_++)_>0&&g.append(","),g.append(this.pts[_].x+" "+this.pts[_].y);return g.append(")  "+this._label+" "+this._depthDelta),g.toString()},p.prototype.isPointwiseEqual=function(g){if(this.pts.length!==g.pts.length)return!1;for(var _=0;_<this.pts.length;_++)if(!this.pts[_].equals2D(g.pts[_]))return!1;return!0},p.prototype.setDepthDelta=function(g){this._depthDelta=g},p.prototype.getEdgeIntersectionList=function(){return this.eiList},p.prototype.addIntersections=function(g,_,S){for(var U=0;U<g.getIntersectionNum();U++)this.addIntersection(g,_,S,U)},p.prototype.interfaces_=function(){return[]},p.prototype.getClass=function(){return p},p.updateIM=function(){if(arguments.length!==2)return c.prototype.updateIM.apply(this,arguments);var g=arguments[0],_=arguments[1];_.setAtLeastIfValid(g.getLocation(0,ce.ON),g.getLocation(1,ce.ON),1),g.isArea()&&(_.setAtLeastIfValid(g.getLocation(0,ce.LEFT),g.getLocation(1,ce.LEFT),2),_.setAtLeastIfValid(g.getLocation(0,ce.RIGHT),g.getLocation(1,ce.RIGHT),2))},p}(Pn),Ca=l(function(c){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Ko,this._bufParams=c||null},"ii");Ca.prototype.setWorkingPrecisionModel=function(c){this._workingPrecisionModel=c},Ca.prototype.insertUniqueEdge=function(c){var p=this._edgeList.findEqualEdge(c);if(p!==null){var g=p.getLabel(),_=c.getLabel();p.isPointwiseEqual(c)||(_=new It(c.getLabel())).flip(),g.merge(_);var S=Ca.depthDelta(_),U=p.getDepthDelta()+S;p.setDepthDelta(U)}else this._edgeList.add(c),c.setDepthDelta(Ca.depthDelta(c.getLabel()))},Ca.prototype.buildSubgraphs=function(c,p){for(var g=new X,_=c.iterator();_.hasNext();){var S=_.next(),U=S.getRightmostCoordinate(),G=new Jc(g).getDepth(U);S.computeDepth(G),S.findResultEdges(),g.add(S),p.add(S.getDirectedEdges(),S.getNodes())}},Ca.prototype.createSubgraphs=function(c){for(var p=new X,g=c.getNodes().iterator();g.hasNext();){var _=g.next();if(!_.isVisited()){var S=new Bt;S.create(_),p.add(S)}}return Se.sort(p,Se.reverseOrder()),p},Ca.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},Ca.prototype.getNoder=function(c){if(this._workingNoder!==null)return this._workingNoder;var p=new KA,g=new at;return g.setPrecisionModel(c),p.setSegmentIntersector(new mo(g)),p},Ca.prototype.buffer=function(c,p){var g=this._workingPrecisionModel;g===null&&(g=c.getPrecisionModel()),this._geomFact=c.getFactory();var _=new Na(g,this._bufParams),S=new Do(c,p,_).getCurves();if(S.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(S,g),this._graph=new Dn(new d6),this._graph.addEdges(this._edgeList.getEdges());var U=this.createSubgraphs(this._graph),G=new Pr(this._geomFact);this.buildSubgraphs(U,G);var ee=G.getPolygons();return ee.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(ee)},Ca.prototype.computeNodedEdges=function(c,p){var g=this.getNoder(p);g.computeNodes(c);for(var _=g.getNodedSubstrings().iterator();_.hasNext();){var S=_.next(),U=S.getCoordinates();if(U.length!==2||!U[0].equals2D(U[1])){var G=S.getData(),ee=new T0(S.getCoordinates(),new It(G));this.insertUniqueEdge(ee)}}},Ca.prototype.setNoder=function(c){this._workingNoder=c},Ca.prototype.interfaces_=function(){return[]},Ca.prototype.getClass=function(){return Ca},Ca.depthDelta=function(c){var p=c.getLocation(0,ce.LEFT),g=c.getLocation(0,ce.RIGHT);return p===O.INTERIOR&&g===O.EXTERIOR?1:p===O.EXTERIOR&&g===O.INTERIOR?-1:0},Ca.convertSegStrings=function(c){for(var p=new _i,g=new X;c.hasNext();){var _=c.next(),S=p.createLineString(_.getCoordinates());g.add(S)}return p.buildGeometry(g)};var xu=l(function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var c=arguments[0],p=arguments[1];this._noder=c,this._scaleFactor=p,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(arguments.length===4){var g=arguments[0],_=arguments[1],S=arguments[2],U=arguments[3];this._noder=g,this._scaleFactor=_,this._offsetX=S,this._offsetY=U,this._isScaled=!this.isIntegerPrecision()}},"ri");xu.prototype.rescale=function(){if(J(arguments[0],xt))for(var c=arguments[0].iterator();c.hasNext();){var p=c.next();this.rescale(p.getCoordinates())}else if(arguments[0]instanceof Array){for(var g=arguments[0],_=0;_<g.length;_++)g[_].x=g[_].x/this._scaleFactor+this._offsetX,g[_].y=g[_].y/this._scaleFactor+this._offsetY;g.length===2&&g[0].equals2D(g[1])&&Ve.out.println(g)}},xu.prototype.scale=function(){if(J(arguments[0],xt)){for(var c=arguments[0],p=new X,g=c.iterator();g.hasNext();){var _=g.next();p.add(new cr(this.scale(_.getCoordinates()),_.getData()))}return p}if(arguments[0]instanceof Array){for(var S=arguments[0],U=new Array(S.length).fill(null),G=0;G<S.length;G++)U[G]=new L(Math.round((S[G].x-this._offsetX)*this._scaleFactor),Math.round((S[G].y-this._offsetY)*this._scaleFactor),S[G].z);return fe.removeRepeatedPoints(U)}},xu.prototype.isIntegerPrecision=function(){return this._scaleFactor===1},xu.prototype.getNodedSubstrings=function(){var c=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(c),c},xu.prototype.computeNodes=function(c){var p=c;this._isScaled&&(p=this.scale(c)),this._noder.computeNodes(p)},xu.prototype.interfaces_=function(){return[Sh]},xu.prototype.getClass=function(){return xu};var Ss=l(function(){this._li=new at,this._segStrings=null;var c=arguments[0];this._segStrings=c},"oi"),m6={fact:{configurable:!0}};Ss.prototype.checkEndPtVertexIntersections=function(){if(arguments.length===0)for(var c=this._segStrings.iterator();c.hasNext();){var p=c.next().getCoordinates();this.checkEndPtVertexIntersections(p[0],this._segStrings),this.checkEndPtVertexIntersections(p[p.length-1],this._segStrings)}else if(arguments.length===2){for(var g=arguments[0],_=arguments[1].iterator();_.hasNext();)for(var S=_.next().getCoordinates(),U=1;U<S.length-1;U++)if(S[U].equals(g))throw new Lt("found endpt/interior pt intersection at index "+U+" :pt "+g)}},Ss.prototype.checkInteriorIntersections=function(){if(arguments.length===0)for(var c=this._segStrings.iterator();c.hasNext();)for(var p=c.next(),g=this._segStrings.iterator();g.hasNext();){var _=g.next();this.checkInteriorIntersections(p,_)}else if(arguments.length===2)for(var S=arguments[0],U=arguments[1],G=S.getCoordinates(),ee=U.getCoordinates(),ye=0;ye<G.length-1;ye++)for(var Te=0;Te<ee.length-1;Te++)this.checkInteriorIntersections(S,ye,U,Te);else if(arguments.length===4){var et=arguments[0],it=arguments[1],kt=arguments[2],zt=arguments[3];if(et===kt&&it===zt)return null;var Yt=et.getCoordinates()[it],wi=et.getCoordinates()[it+1],En=kt.getCoordinates()[zt],wr=kt.getCoordinates()[zt+1];if(this._li.computeIntersection(Yt,wi,En,wr),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,Yt,wi)||this.hasInteriorIntersection(this._li,En,wr)))throw new Lt("found non-noded intersection at "+Yt+"-"+wi+" and "+En+"-"+wr)}},Ss.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},Ss.prototype.checkCollapses=function(){if(arguments.length===0)for(var c=this._segStrings.iterator();c.hasNext();){var p=c.next();this.checkCollapses(p)}else if(arguments.length===1)for(var g=arguments[0].getCoordinates(),_=0;_<g.length-2;_++)this.checkCollapse(g[_],g[_+1],g[_+2])},Ss.prototype.hasInteriorIntersection=function(c,p,g){for(var _=0;_<c.getIntersectionNum();_++){var S=c.getIntersection(_);if(!S.equals(p)&&!S.equals(g))return!0}return!1},Ss.prototype.checkCollapse=function(c,p,g){if(c.equals(g))throw new Lt("found non-noded collapse at "+Ss.fact.createLineString([c,p,g]))},Ss.prototype.interfaces_=function(){return[]},Ss.prototype.getClass=function(){return Ss},m6.fact.get=function(){return new _i},Object.defineProperties(Ss,m6);var Fa=l(function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var c=arguments[0],p=arguments[1],g=arguments[2];if(this._originalPt=c,this._pt=c,this._scaleFactor=p,this._li=g,p<=0)throw new T("Scale factor must be non-zero");p!==1&&(this._pt=new L(this.scale(c.x),this.scale(c.y)),this._p0Scaled=new L,this._p1Scaled=new L),this.initCorners(this._pt)},"ai"),g6={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};Fa.prototype.intersectsScaled=function(c,p){var g=Math.min(c.x,p.x),_=Math.max(c.x,p.x),S=Math.min(c.y,p.y),U=Math.max(c.y,p.y),G=this._maxx<g||this._minx>_||this._maxy<S||this._miny>U;if(G)return!1;var ee=this.intersectsToleranceSquare(c,p);return pe.isTrue(!(G&&ee),"Found bad envelope test"),ee},Fa.prototype.initCorners=function(c){this._minx=c.x-.5,this._maxx=c.x+.5,this._miny=c.y-.5,this._maxy=c.y+.5,this._corner[0]=new L(this._maxx,this._maxy),this._corner[1]=new L(this._minx,this._maxy),this._corner[2]=new L(this._minx,this._miny),this._corner[3]=new L(this._maxx,this._miny)},Fa.prototype.intersects=function(c,p){return this._scaleFactor===1?this.intersectsScaled(c,p):(this.copyScaled(c,this._p0Scaled),this.copyScaled(p,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},Fa.prototype.scale=function(c){return Math.round(c*this._scaleFactor)},Fa.prototype.getCoordinate=function(){return this._originalPt},Fa.prototype.copyScaled=function(c,p){p.x=this.scale(c.x),p.y=this.scale(c.y)},Fa.prototype.getSafeEnvelope=function(){if(this._safeEnv===null){var c=Fa.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new xe(this._originalPt.x-c,this._originalPt.x+c,this._originalPt.y-c,this._originalPt.y+c)}return this._safeEnv},Fa.prototype.intersectsPixelClosure=function(c,p){return this._li.computeIntersection(c,p,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(c,p,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(c,p,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(c,p,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))},Fa.prototype.intersectsToleranceSquare=function(c,p){var g=!1,_=!1;return this._li.computeIntersection(c,p,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(c,p,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(g=!0),this._li.computeIntersection(c,p,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(_=!0),this._li.computeIntersection(c,p,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!g||!_)||!!c.equals(this._pt)||!!p.equals(this._pt))))},Fa.prototype.addSnappedNode=function(c,p){var g=c.getCoordinate(p),_=c.getCoordinate(p+1);return!!this.intersects(g,_)&&(c.addIntersection(this.getCoordinate(),p),!0)},Fa.prototype.interfaces_=function(){return[]},Fa.prototype.getClass=function(){return Fa},g6.SAFE_ENV_EXPANSION_FACTOR.get=function(){return .75},Object.defineProperties(Fa,g6);var ey=l(function(){this.tempEnv1=new xe,this.selectedSegment=new di},"li");ey.prototype.select=function(){if(arguments.length!==1&&arguments.length===2){var c=arguments[0],p=arguments[1];c.getLineSegment(p,this.selectedSegment),this.select(this.selectedSegment)}},ey.prototype.interfaces_=function(){return[]},ey.prototype.getClass=function(){return ey};var Bd=l(function(){this._index=null;var c=arguments[0];this._index=c},"ci"),y6={HotPixelSnapAction:{configurable:!0}};Bd.prototype.snap=function(){if(arguments.length===1){var c=arguments[0];return this.snap(c,null,-1)}if(arguments.length===3){var p=arguments[0],g=arguments[1],_=arguments[2],S=p.getSafeEnvelope(),U=new v6(p,g,_);return this._index.query(S,{interfaces_:l(function(){return[ho]},"interfaces_"),visitItem:l(function(G){G.select(S,U)},"visitItem")}),U.isNodeAdded()}},Bd.prototype.interfaces_=function(){return[]},Bd.prototype.getClass=function(){return Bd},y6.HotPixelSnapAction.get=function(){return v6},Object.defineProperties(Bd,y6);var v6=function(c){function p(){c.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var g=arguments[0],_=arguments[1],S=arguments[2];this._hotPixel=g,this._parentEdge=_,this._hotPixelVertexIndex=S}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.isNodeAdded=function(){return this._isNodeAdded},p.prototype.select=function(){if(arguments.length!==2)return c.prototype.select.apply(this,arguments);var g=arguments[0],_=arguments[1],S=g.getContext();if(this._parentEdge!==null&&S===this._parentEdge&&_===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(S,_)},p.prototype.interfaces_=function(){return[]},p.prototype.getClass=function(){return p},p}(ey),Kc=l(function(){this._li=null,this._interiorIntersections=null;var c=arguments[0];this._li=c,this._interiorIntersections=new X},"fi");Kc.prototype.processIntersections=function(c,p,g,_){if(c===g&&p===_)return null;var S=c.getCoordinates()[p],U=c.getCoordinates()[p+1],G=g.getCoordinates()[_],ee=g.getCoordinates()[_+1];if(this._li.computeIntersection(S,U,G,ee),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var ye=0;ye<this._li.getIntersectionNum();ye++)this._interiorIntersections.add(this._li.getIntersection(ye));c.addIntersections(this._li,p,0),g.addIntersections(this._li,_,1)}},Kc.prototype.isDone=function(){return!1},Kc.prototype.getInteriorIntersections=function(){return this._interiorIntersections},Kc.prototype.interfaces_=function(){return[Ch]},Kc.prototype.getClass=function(){return Kc};var Gs=l(function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var c=arguments[0];this._pm=c,this._li=new at,this._li.setPrecisionModel(c),this._scaleFactor=c.getScale()},"gi");Gs.prototype.checkCorrectness=function(c){var p=cr.getNodedSubstrings(c),g=new Ss(p);try{g.checkValid()}catch(_){if(!(_ instanceof Ne))throw _;_.printStackTrace()}},Gs.prototype.getNodedSubstrings=function(){return cr.getNodedSubstrings(this._nodedSegStrings)},Gs.prototype.snapRound=function(c,p){var g=this.findInteriorIntersections(c,p);this.computeIntersectionSnaps(g),this.computeVertexSnaps(c)},Gs.prototype.findInteriorIntersections=function(c,p){var g=new Kc(p);return this._noder.setSegmentIntersector(g),this._noder.computeNodes(c),g.getInteriorIntersections()},Gs.prototype.computeVertexSnaps=function(){if(J(arguments[0],xt))for(var c=arguments[0].iterator();c.hasNext();){var p=c.next();this.computeVertexSnaps(p)}else if(arguments[0]instanceof cr)for(var g=arguments[0],_=g.getCoordinates(),S=0;S<_.length;S++){var U=new Fa(_[S],this._scaleFactor,this._li);this._pointSnapper.snap(U,g,S)&&g.addIntersection(_[S],S)}},Gs.prototype.computeNodes=function(c){this._nodedSegStrings=c,this._noder=new KA,this._pointSnapper=new Bd(this._noder.getIndex()),this.snapRound(c,this._li)},Gs.prototype.computeIntersectionSnaps=function(c){for(var p=c.iterator();p.hasNext();){var g=p.next(),_=new Fa(g,this._scaleFactor,this._li);this._pointSnapper.snap(_)}},Gs.prototype.interfaces_=function(){return[Sh]},Gs.prototype.getClass=function(){return Gs};var ta=l(function(){if(this._argGeom=null,this._distance=null,this._bufParams=new _n,this._resultGeometry=null,this._saveException=null,arguments.length===1){var c=arguments[0];this._argGeom=c}else if(arguments.length===2){var p=arguments[0],g=arguments[1];this._argGeom=p,this._bufParams=g}},"di"),zd={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};ta.prototype.bufferFixedPrecision=function(c){var p=new xu(new Gs(new Li(1)),c.getScale()),g=new Ca(this._bufParams);g.setWorkingPrecisionModel(c),g.setNoder(p),this._resultGeometry=g.buffer(this._argGeom,this._distance)},ta.prototype.bufferReducedPrecision=function(){var c=this;if(arguments.length===0){for(var p=ta.MAX_PRECISION_DIGITS;p>=0;p--){try{c.bufferReducedPrecision(p)}catch(U){if(!(U instanceof mt))throw U;c._saveException=U}if(c._resultGeometry!==null)return null}throw this._saveException}if(arguments.length===1){var g=arguments[0],_=ta.precisionScaleFactor(this._argGeom,this._distance,g),S=new Li(_);this.bufferFixedPrecision(S)}},ta.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var c=this._argGeom.getFactory().getPrecisionModel();c.getType()===Li.FIXED?this.bufferFixedPrecision(c):this.bufferReducedPrecision()},ta.prototype.setQuadrantSegments=function(c){this._bufParams.setQuadrantSegments(c)},ta.prototype.bufferOriginalPrecision=function(){try{var c=new Ca(this._bufParams);this._resultGeometry=c.buffer(this._argGeom,this._distance)}catch(p){if(!(p instanceof Lt))throw p;this._saveException=p}},ta.prototype.getResultGeometry=function(c){return this._distance=c,this.computeGeometry(),this._resultGeometry},ta.prototype.setEndCapStyle=function(c){this._bufParams.setEndCapStyle(c)},ta.prototype.interfaces_=function(){return[]},ta.prototype.getClass=function(){return ta},ta.bufferOp=function(){if(arguments.length===2){var c=arguments[0],p=arguments[1];return new ta(c).getResultGeometry(p)}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof vt&&typeof arguments[1]=="number"){var g=arguments[0],_=arguments[1],S=arguments[2],U=new ta(g);return U.setQuadrantSegments(S),U.getResultGeometry(_)}if(arguments[2]instanceof _n&&arguments[0]instanceof vt&&typeof arguments[1]=="number"){var G=arguments[0],ee=arguments[1],ye=arguments[2];return new ta(G,ye).getResultGeometry(ee)}}else if(arguments.length===4){var Te=arguments[0],et=arguments[1],it=arguments[2],kt=arguments[3],zt=new ta(Te);return zt.setQuadrantSegments(it),zt.setEndCapStyle(kt),zt.getResultGeometry(et)}},ta.precisionScaleFactor=function(c,p,g){var _=c.getEnvelopeInternal(),S=oe.max(Math.abs(_.getMaxX()),Math.abs(_.getMaxY()),Math.abs(_.getMinX()),Math.abs(_.getMinY()))+2*(p>0?p:0),U=g-Math.trunc(Math.log(S)/Math.log(10)+1);return Math.pow(10,U)},zd.CAP_ROUND.get=function(){return _n.CAP_ROUND},zd.CAP_BUTT.get=function(){return _n.CAP_FLAT},zd.CAP_FLAT.get=function(){return _n.CAP_FLAT},zd.CAP_SQUARE.get=function(){return _n.CAP_SQUARE},zd.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(ta,zd);var Ea=l(function(){this._pt=[new L,new L],this._distance=k.NaN,this._isNull=!0},"_i");Ea.prototype.getCoordinates=function(){return this._pt},Ea.prototype.getCoordinate=function(c){return this._pt[c]},Ea.prototype.setMinimum=function(){if(arguments.length===1){var c=arguments[0];this.setMinimum(c._pt[0],c._pt[1])}else if(arguments.length===2){var p=arguments[0],g=arguments[1];if(this._isNull)return this.initialize(p,g),null;var _=p.distance(g);_<this._distance&&this.initialize(p,g,_)}},Ea.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var c=arguments[0],p=arguments[1];this._pt[0].setCoordinate(c),this._pt[1].setCoordinate(p),this._distance=c.distance(p),this._isNull=!1}else if(arguments.length===3){var g=arguments[0],_=arguments[1],S=arguments[2];this._pt[0].setCoordinate(g),this._pt[1].setCoordinate(_),this._distance=S,this._isNull=!1}},Ea.prototype.getDistance=function(){return this._distance},Ea.prototype.setMaximum=function(){if(arguments.length===1){var c=arguments[0];this.setMaximum(c._pt[0],c._pt[1])}else if(arguments.length===2){var p=arguments[0],g=arguments[1];if(this._isNull)return this.initialize(p,g),null;var _=p.distance(g);_>this._distance&&this.initialize(p,g,_)}},Ea.prototype.interfaces_=function(){return[]},Ea.prototype.getClass=function(){return Ea};var $s=l(function(){},"mi");$s.prototype.interfaces_=function(){return[]},$s.prototype.getClass=function(){return $s},$s.computeDistance=function(){if(arguments[2]instanceof Ea&&arguments[0]instanceof Pe&&arguments[1]instanceof L)for(var c=arguments[0],p=arguments[1],g=arguments[2],_=c.getCoordinates(),S=new di,U=0;U<_.length-1;U++){S.setCoordinates(_[U],_[U+1]);var G=S.closestPoint(p);g.setMinimum(G,p)}else if(arguments[2]instanceof Ea&&arguments[0]instanceof pt&&arguments[1]instanceof L){var ee=arguments[0],ye=arguments[1],Te=arguments[2];$s.computeDistance(ee.getExteriorRing(),ye,Te);for(var et=0;et<ee.getNumInteriorRing();et++)$s.computeDistance(ee.getInteriorRingN(et),ye,Te)}else if(arguments[2]instanceof Ea&&arguments[0]instanceof vt&&arguments[1]instanceof L){var it=arguments[0],kt=arguments[1],zt=arguments[2];if(it instanceof Pe)$s.computeDistance(it,kt,zt);else if(it instanceof pt)$s.computeDistance(it,kt,zt);else if(it instanceof Ti)for(var Yt=it,wi=0;wi<Yt.getNumGeometries();wi++){var En=Yt.getGeometryN(wi);$s.computeDistance(En,kt,zt)}else zt.setMinimum(it.getCoordinate(),kt)}else if(arguments[2]instanceof Ea&&arguments[0]instanceof di&&arguments[1]instanceof L){var wr=arguments[0],La=arguments[1],Xs=arguments[2],Eu=wr.closestPoint(La);Xs.setMinimum(Eu,La)}};var Ih=l(function(c){this._maxPtDist=new Ea,this._inputGeom=c||null},"vi"),QA={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};Ih.prototype.computeMaxMidpointDistance=function(c){var p=new bu(this._inputGeom);c.apply(p),this._maxPtDist.setMaximum(p.getMaxPointDistance())},Ih.prototype.computeMaxVertexDistance=function(c){var p=new Qc(this._inputGeom);c.apply(p),this._maxPtDist.setMaximum(p.getMaxPointDistance())},Ih.prototype.findDistance=function(c){return this.computeMaxVertexDistance(c),this.computeMaxMidpointDistance(c),this._maxPtDist.getDistance()},Ih.prototype.getDistancePoints=function(){return this._maxPtDist},Ih.prototype.interfaces_=function(){return[]},Ih.prototype.getClass=function(){return Ih},QA.MaxPointDistanceFilter.get=function(){return Qc},QA.MaxMidpointDistanceFilter.get=function(){return bu},Object.defineProperties(Ih,QA);var Qc=l(function(c){this._maxPtDist=new Ea,this._minPtDist=new Ea,this._geom=c||null},"Ei");Qc.prototype.filter=function(c){this._minPtDist.initialize(),$s.computeDistance(this._geom,c,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Qc.prototype.getMaxPointDistance=function(){return this._maxPtDist},Qc.prototype.interfaces_=function(){return[Wt]},Qc.prototype.getClass=function(){return Qc};var bu=l(function(c){this._maxPtDist=new Ea,this._minPtDist=new Ea,this._geom=c||null},"xi");bu.prototype.filter=function(c,p){if(p===0)return null;var g=c.getCoordinate(p-1),_=c.getCoordinate(p),S=new L((g.x+_.x)/2,(g.y+_.y)/2);this._minPtDist.initialize(),$s.computeDistance(this._geom,S,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},bu.prototype.isDone=function(){return!1},bu.prototype.isGeometryChanged=function(){return!1},bu.prototype.getMaxPointDistance=function(){return this._maxPtDist},bu.prototype.interfaces_=function(){return[Vi]},bu.prototype.getClass=function(){return bu};var El=l(function(c){this._comps=c||null},"Ni");El.prototype.filter=function(c){c instanceof pt&&this._comps.add(c)},El.prototype.interfaces_=function(){return[Ki]},El.prototype.getClass=function(){return El},El.getPolygons=function(){if(arguments.length===1){var c=arguments[0];return El.getPolygons(c,new X)}if(arguments.length===2){var p=arguments[0],g=arguments[1];return p instanceof pt?g.add(p):p instanceof Ti&&p.apply(new El(g)),g}};var ia=l(function(){if(this._lines=null,this._isForcedToLineString=!1,arguments.length===1){var c=arguments[0];this._lines=c}else if(arguments.length===2){var p=arguments[0],g=arguments[1];this._lines=p,this._isForcedToLineString=g}},"Ci");ia.prototype.filter=function(c){if(this._isForcedToLineString&&c instanceof Ft){var p=c.getFactory().createLineString(c.getCoordinateSequence());return this._lines.add(p),null}c instanceof Pe&&this._lines.add(c)},ia.prototype.setForceToLineString=function(c){this._isForcedToLineString=c},ia.prototype.interfaces_=function(){return[Dt]},ia.prototype.getClass=function(){return ia},ia.getGeometry=function(){if(arguments.length===1){var c=arguments[0];return c.getFactory().buildGeometry(ia.getLines(c))}if(arguments.length===2){var p=arguments[0],g=arguments[1];return p.getFactory().buildGeometry(ia.getLines(p,g))}},ia.getLines=function(){if(arguments.length===1){var c=arguments[0];return ia.getLines(c,!1)}if(arguments.length===2){if(J(arguments[0],xt)&&J(arguments[1],xt)){for(var p=arguments[0],g=arguments[1],_=p.iterator();_.hasNext();){var S=_.next();ia.getLines(S,g)}return g}if(arguments[0]instanceof vt&&typeof arguments[1]=="boolean"){var U=arguments[0],G=arguments[1],ee=new X;return U.apply(new ia(ee,G)),ee}if(arguments[0]instanceof vt&&J(arguments[1],xt)){var ye=arguments[0],Te=arguments[1];return ye instanceof Pe?Te.add(ye):ye.apply(new ia(Te)),Te}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&J(arguments[0],xt)&&J(arguments[1],xt)){for(var et=arguments[0],it=arguments[1],kt=arguments[2],zt=et.iterator();zt.hasNext();){var Yt=zt.next();ia.getLines(Yt,it,kt)}return it}if(typeof arguments[2]=="boolean"&&arguments[0]instanceof vt&&J(arguments[1],xt)){var wi=arguments[0],En=arguments[1],wr=arguments[2];return wi.apply(new ia(En,wr)),En}}};var Qo=l(function(){if(this._boundaryRule=Kt.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,arguments.length!==0&&arguments.length===1){var c=arguments[0];if(c===null)throw new T("Rule must be non-null");this._boundaryRule=c}},"Si");Qo.prototype.locateInternal=function(){if(arguments[0]instanceof L&&arguments[1]instanceof pt){var c=arguments[0],p=arguments[1];if(p.isEmpty())return O.EXTERIOR;var g=p.getExteriorRing(),_=this.locateInPolygonRing(c,g);if(_===O.EXTERIOR)return O.EXTERIOR;if(_===O.BOUNDARY)return O.BOUNDARY;for(var S=0;S<p.getNumInteriorRing();S++){var U=p.getInteriorRingN(S),G=this.locateInPolygonRing(c,U);if(G===O.INTERIOR)return O.EXTERIOR;if(G===O.BOUNDARY)return O.BOUNDARY}return O.INTERIOR}if(arguments[0]instanceof L&&arguments[1]instanceof Pe){var ee=arguments[0],ye=arguments[1];if(!ye.getEnvelopeInternal().intersects(ee))return O.EXTERIOR;var Te=ye.getCoordinates();return ye.isClosed()||!ee.equals(Te[0])&&!ee.equals(Te[Te.length-1])?Qe.isOnLine(ee,Te)?O.INTERIOR:O.EXTERIOR:O.BOUNDARY}if(arguments[0]instanceof L&&arguments[1]instanceof Ge){var et=arguments[0];return arguments[1].getCoordinate().equals2D(et)?O.INTERIOR:O.EXTERIOR}},Qo.prototype.locateInPolygonRing=function(c,p){return p.getEnvelopeInternal().intersects(c)?Qe.locatePointInRing(c,p.getCoordinates()):O.EXTERIOR},Qo.prototype.intersects=function(c,p){return this.locate(c,p)!==O.EXTERIOR},Qo.prototype.updateLocationInfo=function(c){c===O.INTERIOR&&(this._isIn=!0),c===O.BOUNDARY&&this._numBoundaries++},Qo.prototype.computeLocation=function(c,p){if(p instanceof Ge&&this.updateLocationInfo(this.locateInternal(c,p)),p instanceof Pe)this.updateLocationInfo(this.locateInternal(c,p));else if(p instanceof pt)this.updateLocationInfo(this.locateInternal(c,p));else if(p instanceof yn)for(var g=p,_=0;_<g.getNumGeometries();_++){var S=g.getGeometryN(_);this.updateLocationInfo(this.locateInternal(c,S))}else if(p instanceof $t)for(var U=p,G=0;G<U.getNumGeometries();G++){var ee=U.getGeometryN(G);this.updateLocationInfo(this.locateInternal(c,ee))}else if(p instanceof Ti)for(var ye=new Vs(p);ye.hasNext();){var Te=ye.next();Te!==p&&this.computeLocation(c,Te)}},Qo.prototype.locate=function(c,p){return p.isEmpty()?O.EXTERIOR:p instanceof Pe?this.locateInternal(c,p):p instanceof pt?this.locateInternal(c,p):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(c,p),this._boundaryRule.isInBoundary(this._numBoundaries)?O.BOUNDARY:this._numBoundaries>0||this._isIn?O.INTERIOR:O.EXTERIOR)},Qo.prototype.interfaces_=function(){return[]},Qo.prototype.getClass=function(){return Qo};var Ia=l(function c(){if(this._component=null,this._segIndex=null,this._pt=null,arguments.length===2){var p=arguments[0],g=arguments[1];c.call(this,p,c.INSIDE_AREA,g)}else if(arguments.length===3){var _=arguments[0],S=arguments[1],U=arguments[2];this._component=_,this._segIndex=S,this._pt=U}},"t"),_6={INSIDE_AREA:{configurable:!0}};Ia.prototype.isInsideArea=function(){return this._segIndex===Ia.INSIDE_AREA},Ia.prototype.getCoordinate=function(){return this._pt},Ia.prototype.getGeometryComponent=function(){return this._component},Ia.prototype.getSegmentIndex=function(){return this._segIndex},Ia.prototype.interfaces_=function(){return[]},Ia.prototype.getClass=function(){return Ia},_6.INSIDE_AREA.get=function(){return-1},Object.defineProperties(Ia,_6);var wu=l(function(c){this._pts=c||null},"wi");wu.prototype.filter=function(c){c instanceof Ge&&this._pts.add(c)},wu.prototype.interfaces_=function(){return[Ki]},wu.prototype.getClass=function(){return wu},wu.getPoints=function(){if(arguments.length===1){var c=arguments[0];return c instanceof Ge?Se.singletonList(c):wu.getPoints(c,new X)}if(arguments.length===2){var p=arguments[0],g=arguments[1];return p instanceof Ge?g.add(p):p instanceof Ti&&p.apply(new wu(g)),g}};var ep=l(function(){this._locations=null;var c=arguments[0];this._locations=c},"Oi");ep.prototype.filter=function(c){(c instanceof Ge||c instanceof Pe||c instanceof pt)&&this._locations.add(new Ia(c,0,c.getCoordinate()))},ep.prototype.interfaces_=function(){return[Ki]},ep.prototype.getClass=function(){return ep},ep.getLocations=function(c){var p=new X;return c.apply(new ep(p)),p};var na=l(function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Qo,this._minDistanceLocation=null,this._minDistance=k.MAX_VALUE,arguments.length===2){var c=arguments[0],p=arguments[1];this._geom=[c,p],this._terminateDistance=0}else if(arguments.length===3){var g=arguments[0],_=arguments[1],S=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=g,this._geom[1]=_,this._terminateDistance=S}},"Ti");na.prototype.computeContainmentDistance=function(){if(arguments.length===0){var c=new Array(2).fill(null);if(this.computeContainmentDistance(0,c),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,c)}else if(arguments.length===2){var p=arguments[0],g=arguments[1],_=1-p,S=El.getPolygons(this._geom[p]);if(S.size()>0){var U=ep.getLocations(this._geom[_]);if(this.computeContainmentDistance(U,S,g),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[_]=g[0],this._minDistanceLocation[p]=g[1],null}}else if(arguments.length===3){if(arguments[2]instanceof Array&&J(arguments[0],W)&&J(arguments[1],W)){for(var G=arguments[0],ee=arguments[1],ye=arguments[2],Te=0;Te<G.size();Te++)for(var et=G.get(Te),it=0;it<ee.size();it++)if(this.computeContainmentDistance(et,ee.get(it),ye),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Ia&&arguments[1]instanceof pt){var kt=arguments[0],zt=arguments[1],Yt=arguments[2],wi=kt.getCoordinate();if(O.EXTERIOR!==this._ptLocator.locate(wi,zt))return this._minDistance=0,Yt[0]=kt,Yt[1]=new Ia(zt,wi),null}}},na.prototype.computeMinDistanceLinesPoints=function(c,p,g){for(var _=0;_<c.size();_++)for(var S=c.get(_),U=0;U<p.size();U++){var G=p.get(U);if(this.computeMinDistance(S,G,g),this._minDistance<=this._terminateDistance)return null}},na.prototype.computeFacetDistance=function(){var c=new Array(2).fill(null),p=ia.getLines(this._geom[0]),g=ia.getLines(this._geom[1]),_=wu.getPoints(this._geom[0]),S=wu.getPoints(this._geom[1]);return this.computeMinDistanceLines(p,g,c),this.updateMinDistance(c,!1),this._minDistance<=this._terminateDistance?null:(c[0]=null,c[1]=null,this.computeMinDistanceLinesPoints(p,S,c),this.updateMinDistance(c,!1),this._minDistance<=this._terminateDistance?null:(c[0]=null,c[1]=null,this.computeMinDistanceLinesPoints(g,_,c),this.updateMinDistance(c,!0),this._minDistance<=this._terminateDistance?null:(c[0]=null,c[1]=null,this.computeMinDistancePoints(_,S,c),void this.updateMinDistance(c,!1))))},na.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},na.prototype.updateMinDistance=function(c,p){if(c[0]===null)return null;p?(this._minDistanceLocation[0]=c[1],this._minDistanceLocation[1]=c[0]):(this._minDistanceLocation[0]=c[0],this._minDistanceLocation[1]=c[1])},na.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},na.prototype.computeMinDistance=function(){if(arguments.length===0){if(this._minDistanceLocation!==null||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(arguments.length===3){if(arguments[2]instanceof Array&&arguments[0]instanceof Pe&&arguments[1]instanceof Ge){var c=arguments[0],p=arguments[1],g=arguments[2];if(c.getEnvelopeInternal().distance(p.getEnvelopeInternal())>this._minDistance)return null;for(var _=c.getCoordinates(),S=p.getCoordinate(),U=0;U<_.length-1;U++){var G=Qe.distancePointLine(S,_[U],_[U+1]);if(G<this._minDistance){this._minDistance=G;var ee=new di(_[U],_[U+1]).closestPoint(S);g[0]=new Ia(c,U,ee),g[1]=new Ia(p,0,S)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Pe&&arguments[1]instanceof Pe){var ye=arguments[0],Te=arguments[1],et=arguments[2];if(ye.getEnvelopeInternal().distance(Te.getEnvelopeInternal())>this._minDistance)return null;for(var it=ye.getCoordinates(),kt=Te.getCoordinates(),zt=0;zt<it.length-1;zt++)for(var Yt=0;Yt<kt.length-1;Yt++){var wi=Qe.distanceLineLine(it[zt],it[zt+1],kt[Yt],kt[Yt+1]);if(wi<this._minDistance){this._minDistance=wi;var En=new di(it[zt],it[zt+1]),wr=new di(kt[Yt],kt[Yt+1]),La=En.closestPoints(wr);et[0]=new Ia(ye,zt,La[0]),et[1]=new Ia(Te,Yt,La[1])}if(this._minDistance<=this._terminateDistance)return null}}}},na.prototype.computeMinDistancePoints=function(c,p,g){for(var _=0;_<c.size();_++)for(var S=c.get(_),U=0;U<p.size();U++){var G=p.get(U),ee=S.getCoordinate().distance(G.getCoordinate());if(ee<this._minDistance&&(this._minDistance=ee,g[0]=new Ia(S,0,S.getCoordinate()),g[1]=new Ia(G,0,G.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},na.prototype.distance=function(){if(this._geom[0]===null||this._geom[1]===null)throw new T("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},na.prototype.computeMinDistanceLines=function(c,p,g){for(var _=0;_<c.size();_++)for(var S=c.get(_),U=0;U<p.size();U++){var G=p.get(U);if(this.computeMinDistance(S,G,g),this._minDistance<=this._terminateDistance)return null}},na.prototype.interfaces_=function(){return[]},na.prototype.getClass=function(){return na},na.distance=function(c,p){return new na(c,p).distance()},na.isWithinDistance=function(c,p,g){return new na(c,p,g).distance()<=g},na.nearestPoints=function(c,p){return new na(c,p).nearestPoints()};var va=l(function(){this._pt=[new L,new L],this._distance=k.NaN,this._isNull=!0},"Ri");va.prototype.getCoordinates=function(){return this._pt},va.prototype.getCoordinate=function(c){return this._pt[c]},va.prototype.setMinimum=function(){if(arguments.length===1){var c=arguments[0];this.setMinimum(c._pt[0],c._pt[1])}else if(arguments.length===2){var p=arguments[0],g=arguments[1];if(this._isNull)return this.initialize(p,g),null;var _=p.distance(g);_<this._distance&&this.initialize(p,g,_)}},va.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var c=arguments[0],p=arguments[1];this._pt[0].setCoordinate(c),this._pt[1].setCoordinate(p),this._distance=c.distance(p),this._isNull=!1}else if(arguments.length===3){var g=arguments[0],_=arguments[1],S=arguments[2];this._pt[0].setCoordinate(g),this._pt[1].setCoordinate(_),this._distance=S,this._isNull=!1}},va.prototype.toString=function(){return Ke.toLineString(this._pt[0],this._pt[1])},va.prototype.getDistance=function(){return this._distance},va.prototype.setMaximum=function(){if(arguments.length===1){var c=arguments[0];this.setMaximum(c._pt[0],c._pt[1])}else if(arguments.length===2){var p=arguments[0],g=arguments[1];if(this._isNull)return this.initialize(p,g),null;var _=p.distance(g);_>this._distance&&this.initialize(p,g,_)}},va.prototype.interfaces_=function(){return[]},va.prototype.getClass=function(){return va};var Ms=l(function(){},"Pi");Ms.prototype.interfaces_=function(){return[]},Ms.prototype.getClass=function(){return Ms},Ms.computeDistance=function(){if(arguments[2]instanceof va&&arguments[0]instanceof Pe&&arguments[1]instanceof L)for(var c=arguments[0],p=arguments[1],g=arguments[2],_=new di,S=c.getCoordinates(),U=0;U<S.length-1;U++){_.setCoordinates(S[U],S[U+1]);var G=_.closestPoint(p);g.setMinimum(G,p)}else if(arguments[2]instanceof va&&arguments[0]instanceof pt&&arguments[1]instanceof L){var ee=arguments[0],ye=arguments[1],Te=arguments[2];Ms.computeDistance(ee.getExteriorRing(),ye,Te);for(var et=0;et<ee.getNumInteriorRing();et++)Ms.computeDistance(ee.getInteriorRingN(et),ye,Te)}else if(arguments[2]instanceof va&&arguments[0]instanceof vt&&arguments[1]instanceof L){var it=arguments[0],kt=arguments[1],zt=arguments[2];if(it instanceof Pe)Ms.computeDistance(it,kt,zt);else if(it instanceof pt)Ms.computeDistance(it,kt,zt);else if(it instanceof Ti)for(var Yt=it,wi=0;wi<Yt.getNumGeometries();wi++){var En=Yt.getGeometryN(wi);Ms.computeDistance(En,kt,zt)}else zt.setMinimum(it.getCoordinate(),kt)}else if(arguments[2]instanceof va&&arguments[0]instanceof di&&arguments[1]instanceof L){var wr=arguments[0],La=arguments[1],Xs=arguments[2],Eu=wr.closestPoint(La);Xs.setMinimum(Eu,La)}};var ko=l(function(){this._g0=null,this._g1=null,this._ptDist=new va,this._densifyFrac=0;var c=arguments[0],p=arguments[1];this._g0=c,this._g1=p},"Di"),eS={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};ko.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},ko.prototype.setDensifyFraction=function(c){if(c>1||c<=0)throw new T("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=c},ko.prototype.compute=function(c,p){this.computeOrientedDistance(c,p,this._ptDist),this.computeOrientedDistance(p,c,this._ptDist)},ko.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},ko.prototype.computeOrientedDistance=function(c,p,g){var _=new tp(p);if(c.apply(_),g.setMaximum(_.getMaxPointDistance()),this._densifyFrac>0){var S=new Au(p,this._densifyFrac);c.apply(S),g.setMaximum(S.getMaxPointDistance())}},ko.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},ko.prototype.interfaces_=function(){return[]},ko.prototype.getClass=function(){return ko},ko.distance=function(){if(arguments.length===2){var c=arguments[0],p=arguments[1];return new ko(c,p).distance()}if(arguments.length===3){var g=arguments[0],_=arguments[1],S=arguments[2],U=new ko(g,_);return U.setDensifyFraction(S),U.distance()}},eS.MaxPointDistanceFilter.get=function(){return tp},eS.MaxDensifiedByFractionDistanceFilter.get=function(){return Au},Object.defineProperties(ko,eS);var tp=l(function(){this._maxPtDist=new va,this._minPtDist=new va,this._euclideanDist=new Ms,this._geom=null;var c=arguments[0];this._geom=c},"Ai");tp.prototype.filter=function(c){this._minPtDist.initialize(),Ms.computeDistance(this._geom,c,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},tp.prototype.getMaxPointDistance=function(){return this._maxPtDist},tp.prototype.interfaces_=function(){return[Wt]},tp.prototype.getClass=function(){return tp};var Au=l(function(){this._maxPtDist=new va,this._minPtDist=new va,this._geom=null,this._numSubSegs=0;var c=arguments[0],p=arguments[1];this._geom=c,this._numSubSegs=Math.trunc(Math.round(1/p))},"Fi");Au.prototype.filter=function(c,p){if(p===0)return null;for(var g=c.getCoordinate(p-1),_=c.getCoordinate(p),S=(_.x-g.x)/this._numSubSegs,U=(_.y-g.y)/this._numSubSegs,G=0;G<this._numSubSegs;G++){var ee=g.x+G*S,ye=g.y+G*U,Te=new L(ee,ye);this._minPtDist.initialize(),Ms.computeDistance(this._geom,Te,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},Au.prototype.isDone=function(){return!1},Au.prototype.isGeometryChanged=function(){return!1},Au.prototype.getMaxPointDistance=function(){return this._maxPtDist},Au.prototype.interfaces_=function(){return[Vi]},Au.prototype.getClass=function(){return Au};var qa=l(function(c,p,g){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=c||null,this._bufDistance=p||null,this._result=g||null},"Gi"),tS={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};qa.prototype.checkMaximumDistance=function(c,p,g){var _=new ko(p,c);if(_.setDensifyFraction(.25),this._maxDistanceFound=_.orientedDistance(),this._maxDistanceFound>g){this._isValid=!1;var S=_.getCoordinates();this._errorLocation=S[1],this._errorIndicator=c.getFactory().createLineString(S),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+Ke.toLineString(S[0],S[1])+")"}},qa.prototype.isValid=function(){var c=Math.abs(this._bufDistance),p=qa.MAX_DISTANCE_DIFF_FRAC*c;return this._minValidDistance=c-p,this._maxValidDistance=c+p,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),qa.VERBOSE&&Ve.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},qa.prototype.checkNegativeValid=function(){if(!(this._input instanceof pt||this._input instanceof $t||this._input instanceof Ti))return null;var c=this.getPolygonLines(this._input);if(this.checkMinimumDistance(c,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(c,this._result,this._maxValidDistance)},qa.prototype.getErrorIndicator=function(){return this._errorIndicator},qa.prototype.checkMinimumDistance=function(c,p,g){var _=new na(c,p,g);if(this._minDistanceFound=_.distance(),this._minDistanceFound<g){this._isValid=!1;var S=_.nearestPoints();this._errorLocation=_.nearestPoints()[1],this._errorIndicator=c.getFactory().createLineString(S),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+Ke.toLineString(S[0],S[1])+" )"}},qa.prototype.checkPositiveValid=function(){var c=this._result.getBoundary();if(this.checkMinimumDistance(this._input,c,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,c,this._maxValidDistance)},qa.prototype.getErrorLocation=function(){return this._errorLocation},qa.prototype.getPolygonLines=function(c){for(var p=new X,g=new ia(p),_=El.getPolygons(c).iterator();_.hasNext();)_.next().apply(g);return c.getFactory().buildGeometry(p)},qa.prototype.getErrorMessage=function(){return this._errMsg},qa.prototype.interfaces_=function(){return[]},qa.prototype.getClass=function(){return qa},tS.VERBOSE.get=function(){return!1},tS.MAX_DISTANCE_DIFF_FRAC.get=function(){return .012},Object.defineProperties(qa,tS);var ra=l(function(c,p,g){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=c||null,this._distance=p||null,this._result=g||null},"Bi"),iS={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};ra.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},ra.prototype.checkEnvelope=function(){if(this._distance<0)return null;var c=this._distance*ra.MAX_ENV_DIFF_FRAC;c===0&&(c=.001);var p=new xe(this._input.getEnvelopeInternal());p.expandBy(this._distance);var g=new xe(this._result.getEnvelopeInternal());g.expandBy(c),g.contains(p)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(g)),this.report("Envelope")},ra.prototype.checkDistance=function(){var c=new qa(this._input,this._distance,this._result);c.isValid()||(this._isValid=!1,this._errorMsg=c.getErrorMessage(),this._errorLocation=c.getErrorLocation(),this._errorIndicator=c.getErrorIndicator()),this.report("Distance")},ra.prototype.checkArea=function(){var c=this._input.getArea(),p=this._result.getArea();this._distance>0&&c>p&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&c<p&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},ra.prototype.checkPolygonal=function(){this._result instanceof pt||this._result instanceof $t||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},ra.prototype.getErrorIndicator=function(){return this._errorIndicator},ra.prototype.getErrorLocation=function(){return this._errorLocation},ra.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},ra.prototype.report=function(c){if(!ra.VERBOSE)return null;Ve.out.println("Check "+c+": "+(this._isValid?"passed":"FAILED"))},ra.prototype.getErrorMessage=function(){return this._errorMsg},ra.prototype.interfaces_=function(){return[]},ra.prototype.getClass=function(){return ra},ra.isValidMsg=function(c,p,g){var _=new ra(c,p,g);return _.isValid()?null:_.getErrorMessage()},ra.isValid=function(c,p,g){return!!new ra(c,p,g).isValid()},iS.VERBOSE.get=function(){return!1},iS.MAX_ENV_DIFF_FRAC.get=function(){return .012},Object.defineProperties(ra,iS);var Cs=l(function(){this._pts=null,this._data=null;var c=arguments[0],p=arguments[1];this._pts=c,this._data=p},"Ui");Cs.prototype.getCoordinates=function(){return this._pts},Cs.prototype.size=function(){return this._pts.length},Cs.prototype.getCoordinate=function(c){return this._pts[c]},Cs.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},Cs.prototype.getSegmentOctant=function(c){return c===this._pts.length-1?-1:Lo.octant(this.getCoordinate(c),this.getCoordinate(c+1))},Cs.prototype.setData=function(c){this._data=c},Cs.prototype.getData=function(){return this._data},Cs.prototype.toString=function(){return Ke.toLineString(new ci(this._pts))},Cs.prototype.interfaces_=function(){return[co]},Cs.prototype.getClass=function(){return Cs};var Hr=l(function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new X,this._intersectionCount=0,this._keepIntersections=!0;var c=arguments[0];this._li=c,this._interiorIntersection=null},"zi");Hr.prototype.getInteriorIntersection=function(){return this._interiorIntersection},Hr.prototype.setCheckEndSegmentsOnly=function(c){this._isCheckEndSegmentsOnly=c},Hr.prototype.getIntersectionSegments=function(){return this._intSegments},Hr.prototype.count=function(){return this._intersectionCount},Hr.prototype.getIntersections=function(){return this._intersections},Hr.prototype.setFindAllIntersections=function(c){this._findAllIntersections=c},Hr.prototype.setKeepIntersections=function(c){this._keepIntersections=c},Hr.prototype.processIntersections=function(c,p,g,_){if(!this._findAllIntersections&&this.hasIntersection()||c===g&&p===_||this._isCheckEndSegmentsOnly&&!(this.isEndSegment(c,p)||this.isEndSegment(g,_)))return null;var S=c.getCoordinates()[p],U=c.getCoordinates()[p+1],G=g.getCoordinates()[_],ee=g.getCoordinates()[_+1];this._li.computeIntersection(S,U,G,ee),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=S,this._intSegments[1]=U,this._intSegments[2]=G,this._intSegments[3]=ee,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},Hr.prototype.isEndSegment=function(c,p){return p===0||p>=c.size()-2},Hr.prototype.hasIntersection=function(){return this._interiorIntersection!==null},Hr.prototype.isDone=function(){return!this._findAllIntersections&&this._interiorIntersection!==null},Hr.prototype.interfaces_=function(){return[Ch]},Hr.prototype.getClass=function(){return Hr},Hr.createAllIntersectionsFinder=function(c){var p=new Hr(c);return p.setFindAllIntersections(!0),p},Hr.createAnyIntersectionFinder=function(c){return new Hr(c)},Hr.createIntersectionCounter=function(c){var p=new Hr(c);return p.setFindAllIntersections(!0),p.setKeepIntersections(!1),p};var es=l(function(){this._li=new at,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var c=arguments[0];this._segStrings=c},"Xi");es.prototype.execute=function(){if(this._segInt!==null)return null;this.checkInteriorIntersections()},es.prototype.getIntersections=function(){return this._segInt.getIntersections()},es.prototype.isValid=function(){return this.execute(),this._isValid},es.prototype.setFindAllIntersections=function(c){this._findAllIntersections=c},es.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new Hr(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var c=new KA;if(c.setSegmentIntersector(this._segInt),c.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},es.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new mt(this.getErrorMessage(),this._segInt.getInteriorIntersection())},es.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var c=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+Ke.toLineString(c[0],c[1])+" and "+Ke.toLineString(c[2],c[3])},es.prototype.interfaces_=function(){return[]},es.prototype.getClass=function(){return es},es.computeIntersections=function(c){var p=new es(c);return p.setFindAllIntersections(!0),p.isValid(),p.getIntersections()};var Th=l(function c(){this._nv=null;var p=arguments[0];this._nv=new es(c.toSegmentStrings(p))},"t");Th.prototype.checkValid=function(){this._nv.checkValid()},Th.prototype.interfaces_=function(){return[]},Th.prototype.getClass=function(){return Th},Th.toSegmentStrings=function(c){for(var p=new X,g=c.iterator();g.hasNext();){var _=g.next();p.add(new Cs(_.getCoordinates(),_))}return p},Th.checkValid=function(c){new Th(c).checkValid()};var ip=l(function(c){this._mapOp=c},"ki");ip.prototype.map=function(c){for(var p=new X,g=0;g<c.getNumGeometries();g++){var _=this._mapOp.map(c.getGeometryN(g));_.isEmpty()||p.add(_)}return c.getFactory().createGeometryCollection(_i.toGeometryArray(p))},ip.prototype.interfaces_=function(){return[]},ip.prototype.getClass=function(){return ip},ip.map=function(c,p){return new ip(p).map(c)};var Es=l(function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new X,this._resultLineList=new X;var c=arguments[0],p=arguments[1],g=arguments[2];this._op=c,this._geometryFactory=p,this._ptLocator=g},"ji");Es.prototype.collectLines=function(c){for(var p=this._op.getGraph().getEdgeEnds().iterator();p.hasNext();){var g=p.next();this.collectLineEdge(g,c,this._lineEdgesList),this.collectBoundaryTouchEdge(g,c,this._lineEdgesList)}},Es.prototype.labelIsolatedLine=function(c,p){var g=this._ptLocator.locate(c.getCoordinate(),this._op.getArgGeometry(p));c.getLabel().setLocation(p,g)},Es.prototype.build=function(c){return this.findCoveredLineEdges(),this.collectLines(c),this.buildLines(c),this._resultLineList},Es.prototype.collectLineEdge=function(c,p,g){var _=c.getLabel(),S=c.getEdge();c.isLineEdge()&&(c.isVisited()||!Fi.isResultOfOp(_,p)||S.isCovered()||(g.add(S),c.setVisitedEdge(!0)))},Es.prototype.findCoveredLineEdges=function(){for(var c=this._op.getGraph().getNodes().iterator();c.hasNext();)c.next().getEdges().findCoveredLineEdges();for(var p=this._op.getGraph().getEdgeEnds().iterator();p.hasNext();){var g=p.next(),_=g.getEdge();if(g.isLineEdge()&&!_.isCoveredSet()){var S=this._op.isCoveredByA(g.getCoordinate());_.setCovered(S)}}},Es.prototype.labelIsolatedLines=function(c){for(var p=c.iterator();p.hasNext();){var g=p.next(),_=g.getLabel();g.isIsolated()&&(_.isNull(0)?this.labelIsolatedLine(g,0):this.labelIsolatedLine(g,1))}},Es.prototype.buildLines=function(c){for(var p=this._lineEdgesList.iterator();p.hasNext();){var g=p.next(),_=this._geometryFactory.createLineString(g.getCoordinates());this._resultLineList.add(_),g.setInResult(!0)}},Es.prototype.collectBoundaryTouchEdge=function(c,p,g){var _=c.getLabel();return c.isLineEdge()||c.isVisited()||c.isInteriorAreaEdge()||c.getEdge().isInResult()?null:(pe.isTrue(!(c.isInResult()||c.getSym().isInResult())||!c.getEdge().isInResult()),void(Fi.isResultOfOp(_,p)&&p===Fi.INTERSECTION&&(g.add(c.getEdge()),c.setVisitedEdge(!0))))},Es.prototype.interfaces_=function(){return[]},Es.prototype.getClass=function(){return Es};var np=l(function(){this._op=null,this._geometryFactory=null,this._resultPointList=new X;var c=arguments[0],p=arguments[1];this._op=c,this._geometryFactory=p},"Hi");np.prototype.filterCoveredNodeToPoint=function(c){var p=c.getCoordinate();if(!this._op.isCoveredByLA(p)){var g=this._geometryFactory.createPoint(p);this._resultPointList.add(g)}},np.prototype.extractNonCoveredResultNodes=function(c){for(var p=this._op.getGraph().getNodes().iterator();p.hasNext();){var g=p.next();if(!g.isInResult()&&!g.isIncidentEdgeInResult()&&(g.getEdges().getDegree()===0||c===Fi.INTERSECTION)){var _=g.getLabel();Fi.isResultOfOp(_,c)&&this.filterCoveredNodeToPoint(g)}}},np.prototype.build=function(c){return this.extractNonCoveredResultNodes(c),this._resultPointList},np.prototype.interfaces_=function(){return[]},np.prototype.getClass=function(){return np};var Ba=l(function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1},"Wi");Ba.prototype.transformPoint=function(c,p){return this._factory.createPoint(this.transformCoordinates(c.getCoordinateSequence(),c))},Ba.prototype.transformPolygon=function(c,p){var g=!0,_=this.transformLinearRing(c.getExteriorRing(),c);_!==null&&_ instanceof Ft&&!_.isEmpty()||(g=!1);for(var S=new X,U=0;U<c.getNumInteriorRing();U++){var G=this.transformLinearRing(c.getInteriorRingN(U),c);G===null||G.isEmpty()||(G instanceof Ft||(g=!1),S.add(G))}if(g)return this._factory.createPolygon(_,S.toArray([]));var ee=new X;return _!==null&&ee.add(_),ee.addAll(S),this._factory.buildGeometry(ee)},Ba.prototype.createCoordinateSequence=function(c){return this._factory.getCoordinateSequenceFactory().create(c)},Ba.prototype.getInputGeometry=function(){return this._inputGeom},Ba.prototype.transformMultiLineString=function(c,p){for(var g=new X,_=0;_<c.getNumGeometries();_++){var S=this.transformLineString(c.getGeometryN(_),c);S!==null&&(S.isEmpty()||g.add(S))}return this._factory.buildGeometry(g)},Ba.prototype.transformCoordinates=function(c,p){return this.copy(c)},Ba.prototype.transformLineString=function(c,p){return this._factory.createLineString(this.transformCoordinates(c.getCoordinateSequence(),c))},Ba.prototype.transformMultiPoint=function(c,p){for(var g=new X,_=0;_<c.getNumGeometries();_++){var S=this.transformPoint(c.getGeometryN(_),c);S!==null&&(S.isEmpty()||g.add(S))}return this._factory.buildGeometry(g)},Ba.prototype.transformMultiPolygon=function(c,p){for(var g=new X,_=0;_<c.getNumGeometries();_++){var S=this.transformPolygon(c.getGeometryN(_),c);S!==null&&(S.isEmpty()||g.add(S))}return this._factory.buildGeometry(g)},Ba.prototype.copy=function(c){return c.copy()},Ba.prototype.transformGeometryCollection=function(c,p){for(var g=new X,_=0;_<c.getNumGeometries();_++){var S=this.transform(c.getGeometryN(_));S!==null&&(this._pruneEmptyGeometry&&S.isEmpty()||g.add(S))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(_i.toGeometryArray(g)):this._factory.buildGeometry(g)},Ba.prototype.transform=function(c){if(this._inputGeom=c,this._factory=c.getFactory(),c instanceof Ge)return this.transformPoint(c,null);if(c instanceof Ot)return this.transformMultiPoint(c,null);if(c instanceof Ft)return this.transformLinearRing(c,null);if(c instanceof Pe)return this.transformLineString(c,null);if(c instanceof yn)return this.transformMultiLineString(c,null);if(c instanceof pt)return this.transformPolygon(c,null);if(c instanceof $t)return this.transformMultiPolygon(c,null);if(c instanceof Ti)return this.transformGeometryCollection(c,null);throw new T("Unknown Geometry subtype: "+c.getClass().getName())},Ba.prototype.transformLinearRing=function(c,p){var g=this.transformCoordinates(c.getCoordinateSequence(),c);if(g===null)return this._factory.createLinearRing(null);var _=g.size();return _>0&&_<4&&!this._preserveType?this._factory.createLineString(g):this._factory.createLinearRing(g)},Ba.prototype.interfaces_=function(){return[]},Ba.prototype.getClass=function(){return Ba};var Hs=l(function c(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new di,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Pe&&typeof arguments[1]=="number"){var p=arguments[0],g=arguments[1];c.call(this,p.getCoordinates(),g)}else if(arguments[0]instanceof Array&&typeof arguments[1]=="number"){var _=arguments[0],S=arguments[1];this._srcPts=_,this._isClosed=c.isClosed(_),this._snapTolerance=S}},"t");Hs.prototype.snapVertices=function(c,p){for(var g=this._isClosed?c.size()-1:c.size(),_=0;_<g;_++){var S=c.get(_),U=this.findSnapForVertex(S,p);U!==null&&(c.set(_,new L(U)),_===0&&this._isClosed&&c.set(c.size()-1,new L(U)))}},Hs.prototype.findSnapForVertex=function(c,p){for(var g=0;g<p.length;g++){if(c.equals2D(p[g]))return null;if(c.distance(p[g])<this._snapTolerance)return p[g]}return null},Hs.prototype.snapTo=function(c){var p=new _e(this._srcPts);return this.snapVertices(p,c),this.snapSegments(p,c),p.toCoordinateArray()},Hs.prototype.snapSegments=function(c,p){if(p.length===0)return null;var g=p.length;p[0].equals2D(p[p.length-1])&&(g=p.length-1);for(var _=0;_<g;_++){var S=p[_],U=this.findSegmentIndexToSnap(S,c);U>=0&&c.add(U+1,new L(S),!1)}},Hs.prototype.findSegmentIndexToSnap=function(c,p){for(var g=k.MAX_VALUE,_=-1,S=0;S<p.size()-1;S++){if(this._seg.p0=p.get(S),this._seg.p1=p.get(S+1),this._seg.p0.equals2D(c)||this._seg.p1.equals2D(c)){if(this._allowSnappingToSourceVertices)continue;return-1}var U=this._seg.distance(c);U<this._snapTolerance&&U<g&&(g=U,_=S)}return _},Hs.prototype.setAllowSnappingToSourceVertices=function(c){this._allowSnappingToSourceVertices=c},Hs.prototype.interfaces_=function(){return[]},Hs.prototype.getClass=function(){return Hs},Hs.isClosed=function(c){return!(c.length<=1)&&c[0].equals2D(c[c.length-1])};var pr=l(function(c){this._srcGeom=c||null},"Ji"),x6={SNAP_PRECISION_FACTOR:{configurable:!0}};pr.prototype.snapTo=function(c,p){var g=this.extractTargetCoordinates(c);return new b6(p,g).transform(this._srcGeom)},pr.prototype.snapToSelf=function(c,p){var g=this.extractTargetCoordinates(this._srcGeom),_=new b6(c,g,!0).transform(this._srcGeom),S=_;return p&&J(S,Oe)&&(S=_.buffer(0)),S},pr.prototype.computeSnapTolerance=function(c){return this.computeMinimumSegmentLength(c)/10},pr.prototype.extractTargetCoordinates=function(c){for(var p=new w,g=c.getCoordinates(),_=0;_<g.length;_++)p.add(g[_]);return p.toArray(new Array(0).fill(null))},pr.prototype.computeMinimumSegmentLength=function(c){for(var p=k.MAX_VALUE,g=0;g<c.length-1;g++){var _=c[g].distance(c[g+1]);_<p&&(p=_)}return p},pr.prototype.interfaces_=function(){return[]},pr.prototype.getClass=function(){return pr},pr.snap=function(c,p,g){var _=new Array(2).fill(null),S=new pr(c);_[0]=S.snapTo(p,g);var U=new pr(p);return _[1]=U.snapTo(_[0],g),_},pr.computeOverlaySnapTolerance=function(){if(arguments.length===1){var c=arguments[0],p=pr.computeSizeBasedSnapTolerance(c),g=c.getPrecisionModel();if(g.getType()===Li.FIXED){var _=1/g.getScale()*2/1.415;_>p&&(p=_)}return p}if(arguments.length===2){var S=arguments[0],U=arguments[1];return Math.min(pr.computeOverlaySnapTolerance(S),pr.computeOverlaySnapTolerance(U))}},pr.computeSizeBasedSnapTolerance=function(c){var p=c.getEnvelopeInternal();return Math.min(p.getHeight(),p.getWidth())*pr.SNAP_PRECISION_FACTOR},pr.snapToSelf=function(c,p,g){return new pr(c).snapToSelf(p,g)},x6.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(pr,x6);var b6=function(c){function p(g,_,S){c.call(this),this._snapTolerance=g||null,this._snapPts=_||null,this._isSelfSnap=S!==void 0&&S}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.snapLine=function(g,_){var S=new Hs(g,this._snapTolerance);return S.setAllowSnappingToSourceVertices(this._isSelfSnap),S.snapTo(_)},p.prototype.transformCoordinates=function(g,_){var S=g.toCoordinateArray(),U=this.snapLine(S,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(U)},p.prototype.interfaces_=function(){return[]},p.prototype.getClass=function(){return p},p}(Ba),Ta=l(function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null},"$i");Ta.prototype.getCommon=function(){return k.longBitsToDouble(this._commonBits)},Ta.prototype.add=function(c){var p=k.doubleToLongBits(c);if(this._isFirst)return this._commonBits=p,this._commonSignExp=Ta.signExpBits(this._commonBits),this._isFirst=!1,null;if(Ta.signExpBits(p)!==this._commonSignExp)return this._commonBits=0,null;this._commonMantissaBitsCount=Ta.numCommonMostSigMantissaBits(this._commonBits,p),this._commonBits=Ta.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))},Ta.prototype.toString=function(){if(arguments.length===1){var c=arguments[0],p=k.longBitsToDouble(c),g="0000000000000000000000000000000000000000000000000000000000000000"+k.toBinaryString(c),_=g.substring(g.length-64);return _.substring(0,1)+"  "+_.substring(1,12)+"(exp) "+_.substring(12)+" [ "+p+" ]"}},Ta.prototype.interfaces_=function(){return[]},Ta.prototype.getClass=function(){return Ta},Ta.getBit=function(c,p){return(c&1<<p)!=0?1:0},Ta.signExpBits=function(c){return c>>52},Ta.zeroLowerBits=function(c,p){return c&~((1<<p)-1)},Ta.numCommonMostSigMantissaBits=function(c,p){for(var g=0,_=52;_>=0;_--){if(Ta.getBit(c,_)!==Ta.getBit(p,_))return g;g++}return 52};var Su=l(function(){this._commonCoord=null,this._ccFilter=new rp},"tr"),nS={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};Su.prototype.addCommonBits=function(c){var p=new Mu(this._commonCoord);c.apply(p),c.geometryChanged()},Su.prototype.removeCommonBits=function(c){if(this._commonCoord.x===0&&this._commonCoord.y===0)return c;var p=new L(this._commonCoord);p.x=-p.x,p.y=-p.y;var g=new Mu(p);return c.apply(g),c.geometryChanged(),c},Su.prototype.getCommonCoordinate=function(){return this._commonCoord},Su.prototype.add=function(c){c.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},Su.prototype.interfaces_=function(){return[]},Su.prototype.getClass=function(){return Su},nS.CommonCoordinateFilter.get=function(){return rp},nS.Translater.get=function(){return Mu},Object.defineProperties(Su,nS);var rp=l(function(){this._commonBitsX=new Ta,this._commonBitsY=new Ta},"nr");rp.prototype.filter=function(c){this._commonBitsX.add(c.x),this._commonBitsY.add(c.y)},rp.prototype.getCommonCoordinate=function(){return new L(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},rp.prototype.interfaces_=function(){return[Wt]},rp.prototype.getClass=function(){return rp};var Mu=l(function(){this.trans=null;var c=arguments[0];this.trans=c},"ir");Mu.prototype.filter=function(c,p){var g=c.getOrdinate(p,0)+this.trans.x,_=c.getOrdinate(p,1)+this.trans.y;c.setOrdinate(p,0,g),c.setOrdinate(p,1,_)},Mu.prototype.isDone=function(){return!1},Mu.prototype.isGeometryChanged=function(){return!0},Mu.prototype.interfaces_=function(){return[Vi]},Mu.prototype.getClass=function(){return Mu};var Wr=l(function(c,p){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=c,this._geom[1]=p,this.computeSnapTolerance()},"rr");Wr.prototype.selfSnap=function(c){return new pr(c).snapTo(c,this._snapTolerance)},Wr.prototype.removeCommonBits=function(c){this._cbr=new Su,this._cbr.add(c[0]),this._cbr.add(c[1]);var p=new Array(2).fill(null);return p[0]=this._cbr.removeCommonBits(c[0].copy()),p[1]=this._cbr.removeCommonBits(c[1].copy()),p},Wr.prototype.prepareResult=function(c){return this._cbr.addCommonBits(c),c},Wr.prototype.getResultGeometry=function(c){var p=this.snap(this._geom),g=Fi.overlayOp(p[0],p[1],c);return this.prepareResult(g)},Wr.prototype.checkValid=function(c){c.isValid()||Ve.out.println("Snapped geometry is invalid")},Wr.prototype.computeSnapTolerance=function(){this._snapTolerance=pr.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},Wr.prototype.snap=function(c){var p=this.removeCommonBits(c);return pr.snap(p[0],p[1],this._snapTolerance)},Wr.prototype.interfaces_=function(){return[]},Wr.prototype.getClass=function(){return Wr},Wr.overlayOp=function(c,p,g){return new Wr(c,p).getResultGeometry(g)},Wr.union=function(c,p){return Wr.overlayOp(c,p,Fi.UNION)},Wr.intersection=function(c,p){return Wr.overlayOp(c,p,Fi.INTERSECTION)},Wr.symDifference=function(c,p){return Wr.overlayOp(c,p,Fi.SYMDIFFERENCE)},Wr.difference=function(c,p){return Wr.overlayOp(c,p,Fi.DIFFERENCE)};var Pa=l(function(c,p){this._geom=new Array(2).fill(null),this._geom[0]=c,this._geom[1]=p},"or");Pa.prototype.getResultGeometry=function(c){var p=null,g=!1,_=null;try{p=Fi.overlayOp(this._geom[0],this._geom[1],c),g=!0}catch(S){if(!(S instanceof Lt))throw S;_=S}if(!g)try{p=Wr.overlayOp(this._geom[0],this._geom[1],c)}catch(S){throw S instanceof Lt?_:S}return p},Pa.prototype.interfaces_=function(){return[]},Pa.prototype.getClass=function(){return Pa},Pa.overlayOp=function(c,p,g){return new Pa(c,p).getResultGeometry(g)},Pa.union=function(c,p){return Pa.overlayOp(c,p,Fi.UNION)},Pa.intersection=function(c,p){return Pa.overlayOp(c,p,Fi.INTERSECTION)},Pa.symDifference=function(c,p){return Pa.overlayOp(c,p,Fi.SYMDIFFERENCE)},Pa.difference=function(c,p){return Pa.overlayOp(c,p,Fi.DIFFERENCE)};var ty=l(function(){this.mce=null,this.chainIndex=null;var c=arguments[0],p=arguments[1];this.mce=c,this.chainIndex=p},"sr");ty.prototype.computeIntersections=function(c,p){this.mce.computeIntersectsForChain(this.chainIndex,c.mce,c.chainIndex,p)},ty.prototype.interfaces_=function(){return[]},ty.prototype.getClass=function(){return ty};var Xa=l(function c(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,arguments.length===2){var p=arguments[0],g=arguments[1];this._eventType=c.DELETE,this._xValue=p,this._insertEvent=g}else if(arguments.length===3){var _=arguments[0],S=arguments[1],U=arguments[2];this._eventType=c.INSERT,this._label=_,this._xValue=S,this._obj=U}},"t"),rS={INSERT:{configurable:!0},DELETE:{configurable:!0}};Xa.prototype.isDelete=function(){return this._eventType===Xa.DELETE},Xa.prototype.setDeleteEventIndex=function(c){this._deleteEventIndex=c},Xa.prototype.getObject=function(){return this._obj},Xa.prototype.compareTo=function(c){var p=c;return this._xValue<p._xValue?-1:this._xValue>p._xValue?1:this._eventType<p._eventType?-1:this._eventType>p._eventType?1:0},Xa.prototype.getInsertEvent=function(){return this._insertEvent},Xa.prototype.isInsert=function(){return this._eventType===Xa.INSERT},Xa.prototype.isSameLabel=function(c){return this._label!==null&&this._label===c._label},Xa.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},Xa.prototype.interfaces_=function(){return[B]},Xa.prototype.getClass=function(){return Xa},rS.INSERT.get=function(){return 1},rS.DELETE.get=function(){return 2},Object.defineProperties(Xa,rS);var P0=l(function(){},"lr");P0.prototype.interfaces_=function(){return[]},P0.prototype.getClass=function(){return P0};var aa=l(function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var c=arguments[0],p=arguments[1],g=arguments[2];this._li=c,this._includeProper=p,this._recordIsolated=g},"cr");aa.prototype.isTrivialIntersection=function(c,p,g,_){if(c===g&&this._li.getIntersectionNum()===1){if(aa.isAdjacentSegments(p,_))return!0;if(c.isClosed()){var S=c.getNumPoints()-1;if(p===0&&_===S||_===0&&p===S)return!0}}return!1},aa.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},aa.prototype.setIsDoneIfProperInt=function(c){this._isDoneWhenProperInt=c},aa.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},aa.prototype.isBoundaryPointInternal=function(c,p){for(var g=p.iterator();g.hasNext();){var _=g.next().getCoordinate();if(c.isIntersection(_))return!0}return!1},aa.prototype.hasProperIntersection=function(){return this._hasProper},aa.prototype.hasIntersection=function(){return this._hasIntersection},aa.prototype.isDone=function(){return this._isDone},aa.prototype.isBoundaryPoint=function(c,p){return p!==null&&(!!this.isBoundaryPointInternal(c,p[0])||!!this.isBoundaryPointInternal(c,p[1]))},aa.prototype.setBoundaryNodes=function(c,p){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=c,this._bdyNodes[1]=p},aa.prototype.addIntersections=function(c,p,g,_){if(c===g&&p===_)return null;this.numTests++;var S=c.getCoordinates()[p],U=c.getCoordinates()[p+1],G=g.getCoordinates()[_],ee=g.getCoordinates()[_+1];this._li.computeIntersection(S,U,G,ee),this._li.hasIntersection()&&(this._recordIsolated&&(c.setIsolated(!1),g.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(c,p,g,_)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(c.addIntersections(this._li,p,0),g.addIntersections(this._li,_,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},aa.prototype.interfaces_=function(){return[]},aa.prototype.getClass=function(){return aa},aa.isAdjacentSegments=function(c,p){return Math.abs(c-p)===1};var Bue=function(c){function p(){c.call(this),this.events=new X,this.nOverlaps=null}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.prepareEvents=function(){Se.sort(this.events);for(var g=0;g<this.events.size();g++){var _=this.events.get(g);_.isDelete()&&_.getInsertEvent().setDeleteEventIndex(g)}},p.prototype.computeIntersections=function(){if(arguments.length===1){var g=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var _=0;_<this.events.size();_++){var S=this.events.get(_);if(S.isInsert()&&this.processOverlaps(_,S.getDeleteEventIndex(),S,g),g.isDone())break}}else if(arguments.length===3){if(arguments[2]instanceof aa&&J(arguments[0],W)&&J(arguments[1],W)){var U=arguments[0],G=arguments[1],ee=arguments[2];this.addEdges(U,U),this.addEdges(G,G),this.computeIntersections(ee)}else if(typeof arguments[2]=="boolean"&&J(arguments[0],W)&&arguments[1]instanceof aa){var ye=arguments[0],Te=arguments[1];arguments[2]?this.addEdges(ye,null):this.addEdges(ye),this.computeIntersections(Te)}}},p.prototype.addEdge=function(g,_){for(var S=g.getMonotoneChainEdge(),U=S.getStartIndexes(),G=0;G<U.length-1;G++){var ee=new ty(S,G),ye=new Xa(_,S.getMinX(G),ee);this.events.add(ye),this.events.add(new Xa(S.getMaxX(G),ye))}},p.prototype.processOverlaps=function(g,_,S,U){for(var G=S.getObject(),ee=g;ee<_;ee++){var ye=this.events.get(ee);if(ye.isInsert()){var Te=ye.getObject();S.isSameLabel(ye)||(G.computeIntersections(Te,U),this.nOverlaps++)}}},p.prototype.addEdges=function(){if(arguments.length===1)for(var g=arguments[0].iterator();g.hasNext();){var _=g.next();this.addEdge(_,_)}else if(arguments.length===2)for(var S=arguments[0],U=arguments[1],G=S.iterator();G.hasNext();){var ee=G.next();this.addEdge(ee,U)}},p.prototype.interfaces_=function(){return[]},p.prototype.getClass=function(){return p},p}(P0),Ws=l(function(){this._min=k.POSITIVE_INFINITY,this._max=k.NEGATIVE_INFINITY},"hr"),w6={NodeComparator:{configurable:!0}};Ws.prototype.getMin=function(){return this._min},Ws.prototype.intersects=function(c,p){return!(this._min>p||this._max<c)},Ws.prototype.getMax=function(){return this._max},Ws.prototype.toString=function(){return Ke.toLineString(new L(this._min,0),new L(this._max,0))},Ws.prototype.interfaces_=function(){return[]},Ws.prototype.getClass=function(){return Ws},w6.NodeComparator.get=function(){return iy},Object.defineProperties(Ws,w6);var iy=l(function(){},"gr");iy.prototype.compare=function(c,p){var g=c,_=p,S=(g._min+g._max)/2,U=(_._min+_._max)/2;return S<U?-1:S>U?1:0},iy.prototype.interfaces_=function(){return[z]},iy.prototype.getClass=function(){return iy};var zue=function(c){function p(){c.call(this),this._item=null;var g=arguments[0],_=arguments[1],S=arguments[2];this._min=g,this._max=_,this._item=S}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.query=function(g,_,S){if(!this.intersects(g,_))return null;S.visitItem(this._item)},p.prototype.interfaces_=function(){return[]},p.prototype.getClass=function(){return p},p}(Ws),Uue=function(c){function p(){c.call(this),this._node1=null,this._node2=null;var g=arguments[0],_=arguments[1];this._node1=g,this._node2=_,this.buildExtent(this._node1,this._node2)}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.buildExtent=function(g,_){this._min=Math.min(g._min,_._min),this._max=Math.max(g._max,_._max)},p.prototype.query=function(g,_,S){if(!this.intersects(g,_))return null;this._node1!==null&&this._node1.query(g,_,S),this._node2!==null&&this._node2.query(g,_,S)},p.prototype.interfaces_=function(){return[]},p.prototype.getClass=function(){return p},p}(Ws),qs=l(function(){this._leaves=new X,this._root=null,this._level=0},"_r");qs.prototype.buildTree=function(){Se.sort(this._leaves,new Ws.NodeComparator);for(var c=this._leaves,p=null,g=new X;;){if(this.buildLevel(c,g),g.size()===1)return g.get(0);p=c,c=g,g=p}},qs.prototype.insert=function(c,p,g){if(this._root!==null)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new zue(c,p,g))},qs.prototype.query=function(c,p,g){this.init(),this._root.query(c,p,g)},qs.prototype.buildRoot=function(){if(this._root!==null)return null;this._root=this.buildTree()},qs.prototype.printNode=function(c){Ve.out.println(Ke.toLineString(new L(c._min,this._level),new L(c._max,this._level)))},qs.prototype.init=function(){if(this._root!==null)return null;this.buildRoot()},qs.prototype.buildLevel=function(c,p){this._level++,p.clear();for(var g=0;g<c.size();g+=2){var _=c.get(g);if((g+1<c.size()?c.get(g):null)===null)p.add(_);else{var S=new Uue(c.get(g),c.get(g+1));p.add(S)}}},qs.prototype.interfaces_=function(){return[]},qs.prototype.getClass=function(){return qs};var Ud=l(function(){this._items=new X},"mr");Ud.prototype.visitItem=function(c){this._items.add(c)},Ud.prototype.getItems=function(){return this._items},Ud.prototype.interfaces_=function(){return[ho]},Ud.prototype.getClass=function(){return Ud};var Vd=l(function(){this._index=null;var c=arguments[0];if(!J(c,Oe))throw new T("Argument must be Polygonal");this._index=new Ph(c)},"vr"),aS={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};Vd.prototype.locate=function(c){var p=new rt(c),g=new jd(p);return this._index.query(c.y,c.y,g),p.getLocation()},Vd.prototype.interfaces_=function(){return[Fd]},Vd.prototype.getClass=function(){return Vd},aS.SegmentVisitor.get=function(){return jd},aS.IntervalIndexedGeometry.get=function(){return Ph},Object.defineProperties(Vd,aS);var jd=l(function(){this._counter=null;var c=arguments[0];this._counter=c},"Er");jd.prototype.visitItem=function(c){var p=c;this._counter.countSegment(p.getCoordinate(0),p.getCoordinate(1))},jd.prototype.interfaces_=function(){return[ho]},jd.prototype.getClass=function(){return jd};var Ph=l(function(){this._index=new qs;var c=arguments[0];this.init(c)},"xr");Ph.prototype.init=function(c){for(var p=ia.getLines(c).iterator();p.hasNext();){var g=p.next().getCoordinates();this.addLine(g)}},Ph.prototype.addLine=function(c){for(var p=1;p<c.length;p++){var g=new di(c[p-1],c[p]),_=Math.min(g.p0.y,g.p1.y),S=Math.max(g.p0.y,g.p1.y);this._index.insert(_,S,g)}},Ph.prototype.query=function(){if(arguments.length===2){var c=arguments[0],p=arguments[1],g=new Ud;return this._index.query(c,p,g),g.getItems()}if(arguments.length===3){var _=arguments[0],S=arguments[1],U=arguments[2];this._index.query(_,S,U)}},Ph.prototype.interfaces_=function(){return[]},Ph.prototype.getClass=function(){return Ph};var ny=function(c){function p(){if(c.call(this),this._parentGeom=null,this._lineEdgeMap=new vi,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Qo,arguments.length===2){var g=arguments[0],_=arguments[1],S=Kt.OGC_SFS_BOUNDARY_RULE;this._argIndex=g,this._parentGeom=_,this._boundaryNodeRule=S,_!==null&&this.add(_)}else if(arguments.length===3){var U=arguments[0],G=arguments[1],ee=arguments[2];this._argIndex=U,this._parentGeom=G,this._boundaryNodeRule=ee,G!==null&&this.add(G)}}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.insertBoundaryPoint=function(g,_){var S=this._nodes.addNode(_).getLabel(),U=1;O.NONE,S.getLocation(g,ce.ON)===O.BOUNDARY&&U++;var G=p.determineBoundary(this._boundaryNodeRule,U);S.setLocation(g,G)},p.prototype.computeSelfNodes=function(){if(arguments.length===2){var g=arguments[0],_=arguments[1];return this.computeSelfNodes(g,_,!1)}if(arguments.length===3){var S=arguments[0],U=arguments[1],G=arguments[2],ee=new aa(S,!0,!1);ee.setIsDoneIfProperInt(G);var ye=this.createEdgeSetIntersector(),Te=this._parentGeom instanceof Ft||this._parentGeom instanceof pt||this._parentGeom instanceof $t,et=U||!Te;return ye.computeIntersections(this._edges,ee,et),this.addSelfIntersectionNodes(this._argIndex),ee}},p.prototype.computeSplitEdges=function(g){for(var _=this._edges.iterator();_.hasNext();)_.next().eiList.addSplitEdges(g)},p.prototype.computeEdgeIntersections=function(g,_,S){var U=new aa(_,S,!0);return U.setBoundaryNodes(this.getBoundaryNodes(),g.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,g._edges,U),U},p.prototype.getGeometry=function(){return this._parentGeom},p.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},p.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},p.prototype.addPoint=function(){if(arguments[0]instanceof Ge){var g=arguments[0].getCoordinate();this.insertPoint(this._argIndex,g,O.INTERIOR)}else if(arguments[0]instanceof L){var _=arguments[0];this.insertPoint(this._argIndex,_,O.INTERIOR)}},p.prototype.addPolygon=function(g){this.addPolygonRing(g.getExteriorRing(),O.EXTERIOR,O.INTERIOR);for(var _=0;_<g.getNumInteriorRing();_++){var S=g.getInteriorRingN(_);this.addPolygonRing(S,O.INTERIOR,O.EXTERIOR)}},p.prototype.addEdge=function(g){this.insertEdge(g);var _=g.getCoordinates();this.insertPoint(this._argIndex,_[0],O.BOUNDARY),this.insertPoint(this._argIndex,_[_.length-1],O.BOUNDARY)},p.prototype.addLineString=function(g){var _=fe.removeRepeatedPoints(g.getCoordinates());if(_.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=_[0],null;var S=new T0(_,new It(this._argIndex,O.INTERIOR));this._lineEdgeMap.put(g,S),this.insertEdge(S),pe.isTrue(_.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,_[0]),this.insertBoundaryPoint(this._argIndex,_[_.length-1])},p.prototype.getInvalidPoint=function(){return this._invalidPoint},p.prototype.getBoundaryPoints=function(){for(var g=this.getBoundaryNodes(),_=new Array(g.size()).fill(null),S=0,U=g.iterator();U.hasNext();){var G=U.next();_[S++]=G.getCoordinate().copy()}return _},p.prototype.getBoundaryNodes=function(){return this._boundaryNodes===null&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},p.prototype.addSelfIntersectionNode=function(g,_,S){if(this.isBoundaryNode(g,_))return null;S===O.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(g,_):this.insertPoint(g,_,S)},p.prototype.addPolygonRing=function(g,_,S){if(g.isEmpty())return null;var U=fe.removeRepeatedPoints(g.getCoordinates());if(U.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=U[0],null;var G=_,ee=S;Qe.isCCW(U)&&(G=S,ee=_);var ye=new T0(U,new It(this._argIndex,O.BOUNDARY,G,ee));this._lineEdgeMap.put(g,ye),this.insertEdge(ye),this.insertPoint(this._argIndex,U[0],O.BOUNDARY)},p.prototype.insertPoint=function(g,_,S){var U=this._nodes.addNode(_),G=U.getLabel();G===null?U._label=new It(g,S):G.setLocation(g,S)},p.prototype.createEdgeSetIntersector=function(){return new Bue},p.prototype.addSelfIntersectionNodes=function(g){for(var _=this._edges.iterator();_.hasNext();)for(var S=_.next(),U=S.getLabel().getLocation(g),G=S.eiList.iterator();G.hasNext();){var ee=G.next();this.addSelfIntersectionNode(g,ee.coord,U)}},p.prototype.add=function(){if(arguments.length!==1)return c.prototype.add.apply(this,arguments);var g=arguments[0];if(g.isEmpty())return null;if(g instanceof $t&&(this._useBoundaryDeterminationRule=!1),g instanceof pt)this.addPolygon(g);else if(g instanceof Pe)this.addLineString(g);else if(g instanceof Ge)this.addPoint(g);else if(g instanceof Ot)this.addCollection(g);else if(g instanceof yn)this.addCollection(g);else if(g instanceof $t)this.addCollection(g);else{if(!(g instanceof Ti))throw new Error(g.getClass().getName());this.addCollection(g)}},p.prototype.addCollection=function(g){for(var _=0;_<g.getNumGeometries();_++){var S=g.getGeometryN(_);this.add(S)}},p.prototype.locate=function(g){return J(this._parentGeom,Oe)&&this._parentGeom.getNumGeometries()>50?(this._areaPtLocator===null&&(this._areaPtLocator=new Vd(this._parentGeom)),this._areaPtLocator.locate(g)):this._ptLocator.locate(g,this._parentGeom)},p.prototype.findEdge=function(){if(arguments.length===1){var g=arguments[0];return this._lineEdgeMap.get(g)}return c.prototype.findEdge.apply(this,arguments)},p.prototype.interfaces_=function(){return[]},p.prototype.getClass=function(){return p},p.determineBoundary=function(g,_){return g.isInBoundary(_)?O.BOUNDARY:O.INTERIOR},p}(Dn),Gd=l(function(){if(this._li=new at,this._resultPrecisionModel=null,this._arg=null,arguments.length===1){var c=arguments[0];this.setComputationPrecision(c.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new ny(0,c)}else if(arguments.length===2){var p=arguments[0],g=arguments[1],_=Kt.OGC_SFS_BOUNDARY_RULE;p.getPrecisionModel().compareTo(g.getPrecisionModel())>=0?this.setComputationPrecision(p.getPrecisionModel()):this.setComputationPrecision(g.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new ny(0,p,_),this._arg[1]=new ny(1,g,_)}else if(arguments.length===3){var S=arguments[0],U=arguments[1],G=arguments[2];S.getPrecisionModel().compareTo(U.getPrecisionModel())>=0?this.setComputationPrecision(S.getPrecisionModel()):this.setComputationPrecision(U.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new ny(0,S,G),this._arg[1]=new ny(1,U,G)}},"Cr");Gd.prototype.getArgGeometry=function(c){return this._arg[c].getGeometry()},Gd.prototype.setComputationPrecision=function(c){this._resultPrecisionModel=c,this._li.setPrecisionModel(this._resultPrecisionModel)},Gd.prototype.interfaces_=function(){return[]},Gd.prototype.getClass=function(){return Gd};var Lh=l(function(){},"Sr");Lh.prototype.interfaces_=function(){return[]},Lh.prototype.getClass=function(){return Lh},Lh.map=function(){if(arguments[0]instanceof vt&&J(arguments[1],Lh.MapOp)){for(var c=arguments[0],p=arguments[1],g=new X,_=0;_<c.getNumGeometries();_++){var S=p.map(c.getGeometryN(_));S!==null&&g.add(S)}return c.getFactory().buildGeometry(g)}if(J(arguments[0],xt)&&J(arguments[1],Lh.MapOp)){for(var U=arguments[0],G=arguments[1],ee=new X,ye=U.iterator();ye.hasNext();){var Te=ye.next(),et=G.map(Te);et!==null&&ee.add(et)}return ee}},Lh.MapOp=function(){};var Fi=function(c){function p(){var g=arguments[0],_=arguments[1];c.call(this,g,_),this._ptLocator=new Qo,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Ko,this._resultPolyList=new X,this._resultLineList=new X,this._resultPointList=new X,this._graph=new Dn(new d6),this._geomFact=g.getFactory()}return l(p,"e"),c&&(p.__proto__=c),p.prototype=Object.create(c&&c.prototype),p.prototype.constructor=p,p.prototype.insertUniqueEdge=function(g){var _=this._edgeList.findEqualEdge(g);if(_!==null){var S=_.getLabel(),U=g.getLabel();_.isPointwiseEqual(g)||(U=new It(g.getLabel())).flip();var G=_.getDepth();G.isNull()&&G.add(S),G.add(U),S.merge(U)}else this._edgeList.add(g)},p.prototype.getGraph=function(){return this._graph},p.prototype.cancelDuplicateResultEdges=function(){for(var g=this._graph.getEdgeEnds().iterator();g.hasNext();){var _=g.next(),S=_.getSym();_.isInResult()&&S.isInResult()&&(_.setInResult(!1),S.setInResult(!1))}},p.prototype.isCoveredByLA=function(g){return!!this.isCovered(g,this._resultLineList)||!!this.isCovered(g,this._resultPolyList)},p.prototype.computeGeometry=function(g,_,S,U){var G=new X;return G.addAll(g),G.addAll(_),G.addAll(S),G.isEmpty()?p.createEmptyResult(U,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(G)},p.prototype.mergeSymLabels=function(){for(var g=this._graph.getNodes().iterator();g.hasNext();)g.next().getEdges().mergeSymLabels()},p.prototype.isCovered=function(g,_){for(var S=_.iterator();S.hasNext();){var U=S.next();if(this._ptLocator.locate(g,U)!==O.EXTERIOR)return!0}return!1},p.prototype.replaceCollapsedEdges=function(){for(var g=new X,_=this._edgeList.iterator();_.hasNext();){var S=_.next();S.isCollapsed()&&(_.remove(),g.add(S.getCollapsedEdge()))}this._edgeList.addAll(g)},p.prototype.updateNodeLabelling=function(){for(var g=this._graph.getNodes().iterator();g.hasNext();){var _=g.next(),S=_.getEdges().getLabel();_.getLabel().merge(S)}},p.prototype.getResultGeometry=function(g){return this.computeOverlay(g),this._resultGeom},p.prototype.insertUniqueEdges=function(g){for(var _=g.iterator();_.hasNext();){var S=_.next();this.insertUniqueEdge(S)}},p.prototype.computeOverlay=function(g){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var _=new X;this._arg[0].computeSplitEdges(_),this._arg[1].computeSplitEdges(_),this.insertUniqueEdges(_),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Th.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(g),this.cancelDuplicateResultEdges();var S=new Pr(this._geomFact);S.add(this._graph),this._resultPolyList=S.getPolygons();var U=new Es(this,this._geomFact,this._ptLocator);this._resultLineList=U.build(g);var G=new np(this,this._geomFact,this._ptLocator);this._resultPointList=G.build(g),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,g)},p.prototype.labelIncompleteNode=function(g,_){var S=this._ptLocator.locate(g.getCoordinate(),this._arg[_].getGeometry());g.getLabel().setLocation(_,S)},p.prototype.copyPoints=function(g){for(var _=this._arg[g].getNodeIterator();_.hasNext();){var S=_.next();this._graph.addNode(S.getCoordinate()).setLabel(g,S.getLabel().getLocation(g))}},p.prototype.findResultAreaEdges=function(g){for(var _=this._graph.getEdgeEnds().iterator();_.hasNext();){var S=_.next(),U=S.getLabel();U.isArea()&&!S.isInteriorAreaEdge()&&p.isResultOfOp(U.getLocation(0,ce.RIGHT),U.getLocation(1,ce.RIGHT),g)&&S.setInResult(!0)}},p.prototype.computeLabelsFromDepths=function(){for(var g=this._edgeList.iterator();g.hasNext();){var _=g.next(),S=_.getLabel(),U=_.getDepth();if(!U.isNull()){U.normalize();for(var G=0;G<2;G++)S.isNull(G)||!S.isArea()||U.isNull(G)||(U.getDelta(G)===0?S.toLine(G):(pe.isTrue(!U.isNull(G,ce.LEFT),"depth of LEFT side has not been initialized"),S.setLocation(G,ce.LEFT,U.getLocation(G,ce.LEFT)),pe.isTrue(!U.isNull(G,ce.RIGHT),"depth of RIGHT side has not been initialized"),S.setLocation(G,ce.RIGHT,U.getLocation(G,ce.RIGHT))))}}},p.prototype.computeLabelling=function(){for(var g=this._graph.getNodes().iterator();g.hasNext();)g.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},p.prototype.labelIncompleteNodes=function(){for(var g=this._graph.getNodes().iterator();g.hasNext();){var _=g.next(),S=_.getLabel();_.isIsolated()&&(S.isNull(0)?this.labelIncompleteNode(_,0):this.labelIncompleteNode(_,1)),_.getEdges().updateLabelling(S)}},p.prototype.isCoveredByA=function(g){return!!this.isCovered(g,this._resultPolyList)},p.prototype.interfaces_=function(){return[]},p.prototype.getClass=function(){return p},p}(Gd);Fi.overlayOp=function(c,p,g){return new Fi(c,p).getResultGeometry(g)},Fi.intersection=function(c,p){if(c.isEmpty()||p.isEmpty())return Fi.createEmptyResult(Fi.INTERSECTION,c,p,c.getFactory());if(c.isGeometryCollection()){var g=p;return ip.map(c,{interfaces_:l(function(){return[Lh.MapOp]},"interfaces_"),map:l(function(_){return _.intersection(g)},"map")})}return c.checkNotGeometryCollection(c),c.checkNotGeometryCollection(p),Pa.overlayOp(c,p,Fi.INTERSECTION)},Fi.symDifference=function(c,p){if(c.isEmpty()||p.isEmpty()){if(c.isEmpty()&&p.isEmpty())return Fi.createEmptyResult(Fi.SYMDIFFERENCE,c,p,c.getFactory());if(c.isEmpty())return p.copy();if(p.isEmpty())return c.copy()}return c.checkNotGeometryCollection(c),c.checkNotGeometryCollection(p),Pa.overlayOp(c,p,Fi.SYMDIFFERENCE)},Fi.resultDimension=function(c,p,g){var _=p.getDimension(),S=g.getDimension(),U=-1;switch(c){case Fi.INTERSECTION:U=Math.min(_,S);break;case Fi.UNION:U=Math.max(_,S);break;case Fi.DIFFERENCE:U=_;break;case Fi.SYMDIFFERENCE:U=Math.max(_,S)}return U},Fi.createEmptyResult=function(c,p,g,_){var S=null;switch(Fi.resultDimension(c,p,g)){case-1:S=_.createGeometryCollection(new Array(0).fill(null));break;case 0:S=_.createPoint();break;case 1:S=_.createLineString();break;case 2:S=_.createPolygon()}return S},Fi.difference=function(c,p){return c.isEmpty()?Fi.createEmptyResult(Fi.DIFFERENCE,c,p,c.getFactory()):p.isEmpty()?c.copy():(c.checkNotGeometryCollection(c),c.checkNotGeometryCollection(p),Pa.overlayOp(c,p,Fi.DIFFERENCE))},Fi.isResultOfOp=function(){if(arguments.length===2){var c=arguments[0],p=arguments[1],g=c.getLocation(0),_=c.getLocation(1);return Fi.isResultOfOp(g,_,p)}if(arguments.length===3){var S=arguments[0],U=arguments[1],G=arguments[2];switch(S===O.BOUNDARY&&(S=O.INTERIOR),U===O.BOUNDARY&&(U=O.INTERIOR),G){case Fi.INTERSECTION:return S===O.INTERIOR&&U===O.INTERIOR;case Fi.UNION:return S===O.INTERIOR||U===O.INTERIOR;case Fi.DIFFERENCE:return S===O.INTERIOR&&U!==O.INTERIOR;case Fi.SYMDIFFERENCE:return S===O.INTERIOR&&U!==O.INTERIOR||S!==O.INTERIOR&&U===O.INTERIOR}return!1}},Fi.INTERSECTION=1,Fi.UNION=2,Fi.DIFFERENCE=3,Fi.SYMDIFFERENCE=4;var Cu=l(function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Qo,this._seg=new di;var c=arguments[0],p=arguments[1];this._g=c,this._boundaryDistanceTolerance=p,this._linework=this.extractLinework(c)},"br");Cu.prototype.isWithinToleranceOfBoundary=function(c){for(var p=0;p<this._linework.getNumGeometries();p++)for(var g=this._linework.getGeometryN(p).getCoordinateSequence(),_=0;_<g.size()-1;_++)if(g.getCoordinate(_,this._seg.p0),g.getCoordinate(_+1,this._seg.p1),this._seg.distance(c)<=this._boundaryDistanceTolerance)return!0;return!1},Cu.prototype.getLocation=function(c){return this.isWithinToleranceOfBoundary(c)?O.BOUNDARY:this._ptLocator.locate(c,this._g)},Cu.prototype.extractLinework=function(c){var p=new $d;c.apply(p);var g=p.getLinework(),_=_i.toLineStringArray(g);return c.getFactory().createMultiLineString(_)},Cu.prototype.interfaces_=function(){return[]},Cu.prototype.getClass=function(){return Cu};var $d=l(function(){this._linework=null,this._linework=new X},"wr");$d.prototype.getLinework=function(){return this._linework},$d.prototype.filter=function(c){if(c instanceof pt){var p=c;this._linework.add(p.getExteriorRing());for(var g=0;g<p.getNumInteriorRing();g++)this._linework.add(p.getInteriorRingN(g))}},$d.prototype.interfaces_=function(){return[Ki]},$d.prototype.getClass=function(){return $d};var Dh=l(function(){this._g=null,this._doLeft=!0,this._doRight=!0;var c=arguments[0];this._g=c},"Or");Dh.prototype.extractPoints=function(c,p,g){for(var _=c.getCoordinates(),S=0;S<_.length-1;S++)this.computeOffsetPoints(_[S],_[S+1],p,g)},Dh.prototype.setSidesToGenerate=function(c,p){this._doLeft=c,this._doRight=p},Dh.prototype.getPoints=function(c){for(var p=new X,g=ia.getLines(this._g).iterator();g.hasNext();){var _=g.next();this.extractPoints(_,c,p)}return p},Dh.prototype.computeOffsetPoints=function(c,p,g,_){var S=p.x-c.x,U=p.y-c.y,G=Math.sqrt(S*S+U*U),ee=g*S/G,ye=g*U/G,Te=(p.x+c.x)/2,et=(p.y+c.y)/2;if(this._doLeft){var it=new L(Te-ye,et+ee);_.add(it)}if(this._doRight){var kt=new L(Te+ye,et-ee);_.add(kt)}},Dh.prototype.interfaces_=function(){return[]},Dh.prototype.getClass=function(){return Dh};var go=l(function c(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=c.TOLERANCE,this._testCoords=new X;var p=arguments[0],g=arguments[1],_=arguments[2];this._boundaryDistanceTolerance=c.computeBoundaryDistanceTolerance(p,g),this._geom=[p,g,_],this._locFinder=[new Cu(this._geom[0],this._boundaryDistanceTolerance),new Cu(this._geom[1],this._boundaryDistanceTolerance),new Cu(this._geom[2],this._boundaryDistanceTolerance)]},"t"),A6={TOLERANCE:{configurable:!0}};go.prototype.reportResult=function(c,p,g){Ve.out.println("Overlay result invalid - A:"+O.toLocationSymbol(p[0])+" B:"+O.toLocationSymbol(p[1])+" expected:"+(g?"i":"e")+" actual:"+O.toLocationSymbol(p[2]))},go.prototype.isValid=function(c){this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]);var p=this.checkValid(c);return p},go.prototype.checkValid=function(){if(arguments.length===1){for(var c=arguments[0],p=0;p<this._testCoords.size();p++){var g=this._testCoords.get(p);if(!this.checkValid(c,g))return this._invalidLocation=g,!1}return!0}if(arguments.length===2){var _=arguments[0],S=arguments[1];return this._location[0]=this._locFinder[0].getLocation(S),this._location[1]=this._locFinder[1].getLocation(S),this._location[2]=this._locFinder[2].getLocation(S),!!go.hasLocation(this._location,O.BOUNDARY)||this.isValidResult(_,this._location)}},go.prototype.addTestPts=function(c){var p=new Dh(c);this._testCoords.addAll(p.getPoints(5*this._boundaryDistanceTolerance))},go.prototype.isValidResult=function(c,p){var g=Fi.isResultOfOp(p[0],p[1],c),_=!(g^p[2]===O.INTERIOR);return _||this.reportResult(c,p,g),_},go.prototype.getInvalidLocation=function(){return this._invalidLocation},go.prototype.interfaces_=function(){return[]},go.prototype.getClass=function(){return go},go.hasLocation=function(c,p){for(var g=0;g<3;g++)if(c[g]===p)return!0;return!1},go.computeBoundaryDistanceTolerance=function(c,p){return Math.min(pr.computeSizeBasedSnapTolerance(c),pr.computeSizeBasedSnapTolerance(p))},go.isValid=function(c,p,g,_){return new go(c,p,_).isValid(g)},A6.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(go,A6);var yo=l(function c(p){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=c.extractFactory(p),this._inputGeoms=p},"t");yo.prototype.extractElements=function(c,p){if(c===null)return null;for(var g=0;g<c.getNumGeometries();g++){var _=c.getGeometryN(g);this._skipEmpty&&_.isEmpty()||p.add(_)}},yo.prototype.combine=function(){for(var c=new X,p=this._inputGeoms.iterator();p.hasNext();){var g=p.next();this.extractElements(g,c)}return c.size()===0?this._geomFactory!==null?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(c)},yo.prototype.interfaces_=function(){return[]},yo.prototype.getClass=function(){return yo},yo.combine=function(){if(arguments.length===1){var c=arguments[0];return new yo(c).combine()}if(arguments.length===2){var p=arguments[0],g=arguments[1];return new yo(yo.createList(p,g)).combine()}if(arguments.length===3){var _=arguments[0],S=arguments[1],U=arguments[2];return new yo(yo.createList(_,S,U)).combine()}},yo.extractFactory=function(c){return c.isEmpty()?null:c.iterator().next().getFactory()},yo.createList=function(){if(arguments.length===2){var c=arguments[0],p=arguments[1],g=new X;return g.add(c),g.add(p),g}if(arguments.length===3){var _=arguments[0],S=arguments[1],U=arguments[2],G=new X;return G.add(_),G.add(S),G.add(U),G}};var br=l(function(){this._inputPolys=null,this._geomFactory=null;var c=arguments[0];this._inputPolys=c,this._inputPolys===null&&(this._inputPolys=new X)},"Dr"),S6={STRTREE_NODE_CAPACITY:{configurable:!0}};br.prototype.reduceToGeometries=function(c){for(var p=new X,g=c.iterator();g.hasNext();){var _=g.next(),S=null;J(_,W)?S=this.unionTree(_):_ instanceof vt&&(S=_),p.add(S)}return p},br.prototype.extractByEnvelope=function(c,p,g){for(var _=new X,S=0;S<p.getNumGeometries();S++){var U=p.getGeometryN(S);U.getEnvelopeInternal().intersects(c)?_.add(U):g.add(U)}return this._geomFactory.buildGeometry(_)},br.prototype.unionOptimized=function(c,p){var g=c.getEnvelopeInternal(),_=p.getEnvelopeInternal();if(!g.intersects(_))return yo.combine(c,p);if(c.getNumGeometries()<=1&&p.getNumGeometries()<=1)return this.unionActual(c,p);var S=g.intersection(_);return this.unionUsingEnvelopeIntersection(c,p,S)},br.prototype.union=function(){if(this._inputPolys===null)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var c=new Ni(br.STRTREE_NODE_CAPACITY),p=this._inputPolys.iterator();p.hasNext();){var g=p.next();c.insert(g.getEnvelopeInternal(),g)}this._inputPolys=null;var _=c.itemsTree();return this.unionTree(_)},br.prototype.binaryUnion=function(){if(arguments.length===1){var c=arguments[0];return this.binaryUnion(c,0,c.size())}if(arguments.length===3){var p=arguments[0],g=arguments[1],_=arguments[2];if(_-g<=1){var S=br.getGeometry(p,g);return this.unionSafe(S,null)}if(_-g==2)return this.unionSafe(br.getGeometry(p,g),br.getGeometry(p,g+1));var U=Math.trunc((_+g)/2),G=this.binaryUnion(p,g,U),ee=this.binaryUnion(p,U,_);return this.unionSafe(G,ee)}},br.prototype.repeatedUnion=function(c){for(var p=null,g=c.iterator();g.hasNext();){var _=g.next();p=p===null?_.copy():p.union(_)}return p},br.prototype.unionSafe=function(c,p){return c===null&&p===null?null:c===null?p.copy():p===null?c.copy():this.unionOptimized(c,p)},br.prototype.unionActual=function(c,p){return br.restrictToPolygons(c.union(p))},br.prototype.unionTree=function(c){var p=this.reduceToGeometries(c);return this.binaryUnion(p)},br.prototype.unionUsingEnvelopeIntersection=function(c,p,g){var _=new X,S=this.extractByEnvelope(g,c,_),U=this.extractByEnvelope(g,p,_),G=this.unionActual(S,U);return _.add(G),yo.combine(_)},br.prototype.bufferUnion=function(){if(arguments.length===1){var c=arguments[0];return c.get(0).getFactory().buildGeometry(c).buffer(0)}if(arguments.length===2){var p=arguments[0],g=arguments[1];return p.getFactory().createGeometryCollection([p,g]).buffer(0)}},br.prototype.interfaces_=function(){return[]},br.prototype.getClass=function(){return br},br.restrictToPolygons=function(c){if(J(c,Oe))return c;var p=El.getPolygons(c);return p.size()===1?p.get(0):c.getFactory().createMultiPolygon(_i.toPolygonArray(p))},br.getGeometry=function(c,p){return p>=c.size()?null:c.get(p)},br.union=function(c){return new br(c).union()},S6.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(br,S6);var ry=l(function(){},"Ar");ry.prototype.interfaces_=function(){return[]},ry.prototype.getClass=function(){return ry},ry.union=function(c,p){if(c.isEmpty()||p.isEmpty()){if(c.isEmpty()&&p.isEmpty())return Fi.createEmptyResult(Fi.UNION,c,p,c.getFactory());if(c.isEmpty())return p.copy();if(p.isEmpty())return c.copy()}return c.checkNotGeometryCollection(c),c.checkNotGeometryCollection(p),Pa.overlayOp(c,p,Fi.UNION)},t.GeoJSONReader=ne,t.GeoJSONWriter=le,t.OverlayOp=Fi,t.UnionOp=ry,t.BufferOp=ta,Object.defineProperty(t,"__esModule",{value:!0})})}),Jee=Et((i,e)=>{R();var t=200,n="__lodash_hash_undefined__",r=800,a=16,o=9007199254740991,s="[object Arguments]",u="[object Array]",h="[object AsyncFunction]",d="[object Boolean]",f="[object Date]",m="[object Error]",v="[object Function]",b="[object GeneratorFunction]",w="[object Map]",A="[object Number]",E="[object Null]",I="[object Object]",C="[object Proxy]",T="[object RegExp]",k="[object Set]",F="[object String]",B="[object Undefined]",N="[object WeakMap]",z="[object ArrayBuffer]",L="[object DataView]",j="[object Float32Array]",q="[object Float64Array]",Z="[object Int8Array]",O="[object Int16Array]",Y="[object Int32Array]",J="[object Uint8Array]",oe="[object Uint8ClampedArray]",$="[object Uint16Array]",K="[object Uint32Array]",te=/[\\^$.*+?()[\]{}|]/g,ve=/^\[object .+?Constructor\]$/,Q=/^(?:0|[1-9]\d*)$/,he={};he[j]=he[q]=he[Z]=he[O]=he[Y]=he[J]=he[oe]=he[$]=he[K]=!0,he[s]=he[u]=he[z]=he[d]=he[L]=he[f]=he[m]=he[v]=he[w]=he[A]=he[I]=he[T]=he[k]=he[F]=he[N]=!1;var se=typeof global=="object"&&global&&global.Object===Object&&global,Ae=typeof self=="object"&&self&&self.Object===Object&&self,Ie=se||Ae||Function("return this")(),we=typeof i=="object"&&i&&!i.nodeType&&i,Ne=we&&typeof e=="object"&&e&&!e.nodeType&&e,je=Ne&&Ne.exports===we,Ve=je&&se.process,Le=function(){try{var be=Ne&&Ne.require&&Ne.require("util").types;return be||Ve&&Ve.binding&&Ve.binding("util")}catch{}}(),xe=Le&&Le.isTypedArray;function Ue(be,De,ie){switch(ie.length){case 0:return be.call(De);case 1:return be.call(De,ie[0]);case 2:return be.call(De,ie[0],ie[1]);case 3:return be.call(De,ie[0],ie[1],ie[2])}return be.apply(De,ie)}l(Ue,"apply");function de(be,De){for(var ie=-1,Se=Array(be);++ie<be;)Se[ie]=De(ie);return Se}l(de,"baseTimes");function ut(be){return function(De){return be(De)}}l(ut,"baseUnary");function ot(be,De){return be?.[De]}l(ot,"getValue");function He(be,De){return function(ie){return be(De(ie))}}l(He,"overArg");var Ke=Array.prototype,Lt=Function.prototype,_t=Object.prototype,pe=Ie["__core-js_shared__"],re=Lt.toString,ke=_t.hasOwnProperty,at=function(){var be=/[^.]+$/.exec(pe&&pe.keys&&pe.keys.IE_PROTO||"");return be?"Symbol(src)_1."+be:""}(),ct=_t.toString,rt=re.call(Object),Qe=RegExp("^"+re.call(ke).replace(te,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),At=je?Ie.Buffer:void 0,Dt=Ie.Symbol,vt=Ie.Uint8Array,yt=At?At.allocUnsafe:void 0,jt=He(Object.getPrototypeOf,Object),Wt=Object.create,Kt=_t.propertyIsEnumerable,Vt=Ke.splice,hi=Dt?Dt.toStringTag:void 0,ui=function(){try{var be=_i(Object,"defineProperty");return be({},"",{}),be}catch{}}(),Zi=At?At.isBuffer:void 0,Re=Math.max,xt=Date.now,me=_i(Ie,"Map"),W=_i(Object,"create"),X=function(){function be(){}return l(be,"object"),function(De){if(!Ma(De))return{};if(Wt)return Wt(De);be.prototype=De;var ie=new be;return be.prototype=void 0,ie}}();function ae(be){var De=-1,ie=be==null?0:be.length;for(this.clear();++De<ie;){var Se=be[De];this.set(Se[0],Se[1])}}l(ae,"Hash");function _e(){this.__data__=W?W(null):{},this.size=0}l(_e,"hashClear");function fe(be){var De=this.has(be)&&delete this.__data__[be];return this.size-=De?1:0,De}l(fe,"hashDelete");function We(be){var De=this.__data__;if(W){var ie=De[be];return ie===n?void 0:ie}return ke.call(De,be)?De[be]:void 0}l(We,"hashGet");function Be(be){var De=this.__data__;return W?De[be]!==void 0:ke.call(De,be)}l(Be,"hashHas");function st(be,De){var ie=this.__data__;return this.size+=this.has(be)?0:1,ie[be]=W&&De===void 0?n:De,this}l(st,"hashSet"),ae.prototype.clear=_e,ae.prototype.delete=fe,ae.prototype.get=We,ae.prototype.has=Be,ae.prototype.set=st;function Xe(be){var De=-1,ie=be==null?0:be.length;for(this.clear();++De<ie;){var Se=be[De];this.set(Se[0],Se[1])}}l(Xe,"ListCache");function bt(){this.__data__=[],this.size=0}l(bt,"listCacheClear");function Ye(be){var De=this.__data__,ie=Ge(De,be);if(ie<0)return!1;var Se=De.length-1;return ie==Se?De.pop():Vt.call(De,ie,1),--this.size,!0}l(Ye,"listCacheDelete");function dt(be){var De=this.__data__,ie=Ge(De,be);return ie<0?void 0:De[ie][1]}l(dt,"listCacheGet");function Mt(be){return Ge(this.__data__,be)>-1}l(Mt,"listCacheHas");function bi(be,De){var ie=this.__data__,Se=Ge(ie,be);return Se<0?(++this.size,ie.push([be,De])):ie[Se][1]=De,this}l(bi,"listCacheSet"),Xe.prototype.clear=bt,Xe.prototype.delete=Ye,Xe.prototype.get=dt,Xe.prototype.has=Mt,Xe.prototype.set=bi;function ni(be){var De=-1,ie=be==null?0:be.length;for(this.clear();++De<ie;){var Se=be[De];this.set(Se[0],Se[1])}}l(ni,"MapCache");function Ii(){this.size=0,this.__data__={hash:new ae,map:new(me||Xe),string:new ae}}l(Ii,"mapCacheClear");function Nt(be){var De=Gn(this,be).delete(be);return this.size-=De?1:0,De}l(Nt,"mapCacheDelete");function Ri(be){return Gn(this,be).get(be)}l(Ri,"mapCacheGet");function Ki(be){return Gn(this,be).has(be)}l(Ki,"mapCacheHas");function Vi(be,De){var ie=Gn(this,be),Se=ie.size;return ie.set(be,De),this.size+=ie.size==Se?0:1,this}l(Vi,"mapCacheSet"),ni.prototype.clear=Ii,ni.prototype.delete=Nt,ni.prototype.get=Ri,ni.prototype.has=Ki,ni.prototype.set=Vi;function Ti(be){var De=this.__data__=new Xe(be);this.size=De.size}l(Ti,"Stack");function yn(){this.__data__=new Xe,this.size=0}l(yn,"stackClear");function hn(be){var De=this.__data__,ie=De.delete(be);return this.size=De.size,ie}l(hn,"stackDelete");function An(be){return this.__data__.get(be)}l(An,"stackGet");function gn(be){return this.__data__.has(be)}l(gn,"stackHas");function nr(be,De){var ie=this.__data__;if(ie instanceof Xe){var Se=ie.__data__;if(!me||Se.length<t-1)return Se.push([be,De]),this.size=++ie.size,this;ie=this.__data__=new ni(Se)}return ie.set(be,De),this.size=ie.size,this}l(nr,"stackSet"),Ti.prototype.clear=yn,Ti.prototype.delete=hn,Ti.prototype.get=An,Ti.prototype.has=gn,Ti.prototype.set=nr;function ue(be,De){var ie=Nn(be),Se=!ie&&ei(be),Fe=!ie&&!Se&&xs(be),gt=!ie&&!Se&&!Fe&&bs(be),pi=ie||Se||Fe||gt,ai=pi?de(be.length,String):[],Di=ai.length;for(var Ni in be)(De||ke.call(be,Ni))&&!(pi&&(Ni=="length"||Fe&&(Ni=="offset"||Ni=="parent")||gt&&(Ni=="buffer"||Ni=="byteLength"||Ni=="byteOffset")||P(Ni,Di)))&&ai.push(Ni);return ai}l(ue,"arrayLikeKeys");function Pe(be,De,ie){(ie!==void 0&&!It(be[De],ie)||ie===void 0&&!(De in be))&&Oe(be,De,ie)}l(Pe,"assignMergeValue");function Ze(be,De,ie){var Se=be[De];(!(ke.call(be,De)&&It(Se,ie))||ie===void 0&&!(De in be))&&Oe(be,De,ie)}l(Ze,"assignValue");function Ge(be,De){for(var ie=be.length;ie--;)if(It(be[ie][0],De))return ie;return-1}l(Ge,"assocIndexOf");function Oe(be,De,ie){De=="__proto__"&&ui?ui(be,De,{configurable:!0,enumerable:!0,value:ie,writable:!0}):be[De]=ie}l(Oe,"baseAssignValue");var pt=Qn();function Ot(be){return be==null?be===void 0?B:E:hi&&hi in Object(be)?x(be):ze(be)}l(Ot,"baseGetTag");function Ft(be){return vn(be)&&Ot(be)==s}l(Ft,"baseIsArguments");function $t(be){if(!Ma(be)||ne(be))return!1;var De=zr(be)?Qe:ve;return De.test(Ut(be))}l($t,"baseIsNative");function si(be){return vn(be)&&Bi(be.length)&&!!he[Ot(be)]}l(si,"baseIsTypedArray");function Ci(be){if(!Ma(be))return ce(be);var De=le(be),ie=[];for(var Se in be)Se=="constructor"&&(De||!ke.call(be,Se))||ie.push(Se);return ie}l(Ci,"baseKeysIn");function xi(be,De,ie,Se,Fe){be!==De&&pt(De,function(gt,pi){if(Fe||(Fe=new Ti),Ma(gt))ji(be,De,pi,ie,xi,Se,Fe);else{var ai=Se?Se(mt(be,pi),gt,pi+"",be,De,Fe):void 0;ai===void 0&&(ai=gt),Pe(be,pi,ai)}},Pr)}l(xi,"baseMerge");function ji(be,De,ie,Se,Fe,gt,pi){var ai=mt(be,ie),Di=mt(De,ie),Ni=pi.get(Di);if(Ni){Pe(be,ie,Ni);return}var tn=gt?gt(ai,Di,ie+"",be,De,pi):void 0,Sn=tn===void 0;if(Sn){var er=Nn(Di),qn=!er&&xs(Di),Lo=!er&&!qn&&bs(Di);tn=Di,er||qn||Lo?Nn(ai)?tn=ai:Pn(ai)?tn=vi(ai):qn?(Sn=!1,tn=cn(Di,!0)):Lo?(Sn=!1,tn=fi(Di,!0)):tn=[]:Jo(Di)||ei(Di)?(tn=ai,ei(ai)?tn=Dn(ai):(!Ma(ai)||zr(ai))&&(tn=M(Di))):Sn=!1}Sn&&(pi.set(Di,tn),Fe(tn,Di,Se,gt,pi),pi.delete(Di)),Pe(be,ie,tn)}l(ji,"baseMergeDeep");function Xi(be,De){return Ct(qe(be,De,Ha),be+"")}l(Xi,"baseRest");var ci=ui?function(be,De){return ui(be,"toString",{configurable:!0,enumerable:!1,value:Qr(De),writable:!0})}:Ha;function cn(be,De){if(De)return be.slice();var ie=be.length,Se=yt?yt(ie):new be.constructor(ie);return be.copy(Se),Se}l(cn,"cloneBuffer");function Gi(be){var De=new be.constructor(be.byteLength);return new vt(De).set(new vt(be)),De}l(Gi,"cloneArrayBuffer");function fi(be,De){var ie=De?Gi(be.buffer):be.buffer;return new be.constructor(ie,be.byteOffset,be.length)}l(fi,"cloneTypedArray");function vi(be,De){var ie=-1,Se=be.length;for(De||(De=Array(Se));++ie<Se;)De[ie]=be[ie];return De}l(vi,"copyArray");function Li(be,De,ie,Se){var Fe=!ie;ie||(ie={});for(var gt=-1,pi=De.length;++gt<pi;){var ai=De[gt],Di=Se?Se(ie[ai],be[ai],ai,ie,be):void 0;Di===void 0&&(Di=be[ai]),Fe?Oe(ie,ai,Di):Ze(ie,ai,Di)}return ie}l(Li,"copyObject");function Tr(be){return Xi(function(De,ie){var Se=-1,Fe=ie.length,gt=Fe>1?ie[Fe-1]:void 0,pi=Fe>2?ie[2]:void 0;for(gt=be.length>3&&typeof gt=="function"?(Fe--,gt):void 0,pi&&V(ie[0],ie[1],pi)&&(gt=Fe<3?void 0:gt,Fe=1),De=Object(De);++Se<Fe;){var ai=ie[Se];ai&&be(De,ai,Se,gt)}return De})}l(Tr,"createAssigner");function Qn(be){return function(De,ie,Se){for(var Fe=-1,gt=Object(De),pi=Se(De),ai=pi.length;ai--;){var Di=pi[be?ai:++Fe];if(ie(gt[Di],Di,gt)===!1)break}return De}}l(Qn,"createBaseFor");function Gn(be,De){var ie=be.__data__;return H(De)?ie[typeof De=="string"?"string":"hash"]:ie.map}l(Gn,"getMapData");function _i(be,De){var ie=ot(be,De);return $t(ie)?ie:void 0}l(_i,"getNative");function x(be){var De=ke.call(be,hi),ie=be[hi];try{be[hi]=void 0;var Se=!0}catch{}var Fe=ct.call(be);return Se&&(De?be[hi]=ie:delete be[hi]),Fe}l(x,"getRawTag");function M(be){return typeof be.constructor=="function"&&!le(be)?X(jt(be)):{}}l(M,"initCloneObject");function P(be,De){var ie=typeof be;return De=De??o,!!De&&(ie=="number"||ie!="symbol"&&Q.test(be))&&be>-1&&be%1==0&&be<De}l(P,"isIndex");function V(be,De,ie){if(!Ma(ie))return!1;var Se=typeof De;return(Se=="number"?rr(ie)&&P(De,ie.length):Se=="string"&&De in ie)?It(ie[De],be):!1}l(V,"isIterateeCall");function H(be){var De=typeof be;return De=="string"||De=="number"||De=="symbol"||De=="boolean"?be!=="__proto__":be===null}l(H,"isKeyable");function ne(be){return!!at&&at in be}l(ne,"isMasked");function le(be){var De=be&&be.constructor,ie=typeof De=="function"&&De.prototype||_t;return be===ie}l(le,"isPrototype");function ce(be){var De=[];if(be!=null)for(var ie in Object(be))De.push(ie);return De}l(ce,"nativeKeysIn");function ze(be){return ct.call(be)}l(ze,"objectToString");function qe(be,De,ie){return De=Re(De===void 0?be.length-1:De,0),function(){for(var Se=arguments,Fe=-1,gt=Re(Se.length-De,0),pi=Array(gt);++Fe<gt;)pi[Fe]=Se[De+Fe];Fe=-1;for(var ai=Array(De+1);++Fe<De;)ai[Fe]=Se[Fe];return ai[De]=ie(pi),Ue(be,this,ai)}}l(qe,"overRest");function mt(be,De){if(!(De==="constructor"&&typeof be[De]=="function")&&De!="__proto__")return be[De]}l(mt,"safeGet");var Ct=Bt(ci);function Bt(be){var De=0,ie=0;return function(){var Se=xt(),Fe=a-(Se-ie);if(ie=Se,Fe>0){if(++De>=r)return arguments[0]}else De=0;return be.apply(void 0,arguments)}}l(Bt,"shortOut");function Ut(be){if(be!=null){try{return re.call(be)}catch{}try{return be+""}catch{}}return""}l(Ut,"toSource");function It(be,De){return be===De||be!==be&&De!==De}l(It,"eq");var ei=Ft(function(){return arguments}())?Ft:function(be){return vn(be)&&ke.call(be,"callee")&&!Kt.call(be,"callee")},Nn=Array.isArray;function rr(be){return be!=null&&Bi(be.length)&&!zr(be)}l(rr,"isArrayLike");function Pn(be){return vn(be)&&rr(be)}l(Pn,"isArrayLikeObject");var xs=Zi||ho;function zr(be){if(!Ma(be))return!1;var De=Ot(be);return De==v||De==b||De==h||De==C}l(zr,"isFunction");function Bi(be){return typeof be=="number"&&be>-1&&be%1==0&&be<=o}l(Bi,"isLength");function Ma(be){var De=typeof be;return be!=null&&(De=="object"||De=="function")}l(Ma,"isObject");function vn(be){return be!=null&&typeof be=="object"}l(vn,"isObjectLike");function Jo(be){if(!vn(be)||Ot(be)!=I)return!1;var De=jt(be);if(De===null)return!0;var ie=ke.call(De,"constructor")&&De.constructor;return typeof ie=="function"&&ie instanceof ie&&re.call(ie)==rt}l(Jo,"isPlainObject");var bs=xe?ut(xe):si;function Dn(be){return Li(be,Pr(be))}l(Dn,"toPlainObject");function Pr(be){return rr(be)?ue(be,!0):Ci(be)}l(Pr,"keysIn");var Sl=Tr(function(be,De,ie){xi(be,De,ie)});function Qr(be){return function(){return be}}l(Qr,"constant");function Ha(be){return be}l(Ha,"identity");function ho(){return!1}l(ho,"stubFalse"),e.exports=Sl}),Kee=Et((i,e)=>{R();var t=200,n="__lodash_hash_undefined__",r=800,a=16,o=9007199254740991,s="[object Arguments]",u="[object Array]",h="[object AsyncFunction]",d="[object Boolean]",f="[object Date]",m="[object Error]",v="[object Function]",b="[object GeneratorFunction]",w="[object Map]",A="[object Number]",E="[object Null]",I="[object Object]",C="[object Proxy]",T="[object RegExp]",k="[object Set]",F="[object String]",B="[object Undefined]",N="[object WeakMap]",z="[object ArrayBuffer]",L="[object DataView]",j="[object Float32Array]",q="[object Float64Array]",Z="[object Int8Array]",O="[object Int16Array]",Y="[object Int32Array]",J="[object Uint8Array]",oe="[object Uint8ClampedArray]",$="[object Uint16Array]",K="[object Uint32Array]",te=/[\\^$.*+?()[\]{}|]/g,ve=/^\[object .+?Constructor\]$/,Q=/^(?:0|[1-9]\d*)$/,he={};he[j]=he[q]=he[Z]=he[O]=he[Y]=he[J]=he[oe]=he[$]=he[K]=!0,he[s]=he[u]=he[z]=he[d]=he[L]=he[f]=he[m]=he[v]=he[w]=he[A]=he[I]=he[T]=he[k]=he[F]=he[N]=!1;var se=typeof global=="object"&&global&&global.Object===Object&&global,Ae=typeof self=="object"&&self&&self.Object===Object&&self,Ie=se||Ae||Function("return this")(),we=typeof i=="object"&&i&&!i.nodeType&&i,Ne=we&&typeof e=="object"&&e&&!e.nodeType&&e,je=Ne&&Ne.exports===we,Ve=je&&se.process,Le=function(){try{var ie=Ne&&Ne.require&&Ne.require("util").types;return ie||Ve&&Ve.binding&&Ve.binding("util")}catch{}}(),xe=Le&&Le.isTypedArray;function Ue(ie,Se,Fe){switch(Fe.length){case 0:return ie.call(Se);case 1:return ie.call(Se,Fe[0]);case 2:return ie.call(Se,Fe[0],Fe[1]);case 3:return ie.call(Se,Fe[0],Fe[1],Fe[2])}return ie.apply(Se,Fe)}l(Ue,"apply");function de(ie,Se){for(var Fe=-1,gt=Array(ie);++Fe<ie;)gt[Fe]=Se(Fe);return gt}l(de,"baseTimes");function ut(ie){return function(Se){return ie(Se)}}l(ut,"baseUnary");function ot(ie,Se){return ie?.[Se]}l(ot,"getValue");function He(ie,Se){return function(Fe){return ie(Se(Fe))}}l(He,"overArg");var Ke=Array.prototype,Lt=Function.prototype,_t=Object.prototype,pe=Ie["__core-js_shared__"],re=Lt.toString,ke=_t.hasOwnProperty,at=function(){var ie=/[^.]+$/.exec(pe&&pe.keys&&pe.keys.IE_PROTO||"");return ie?"Symbol(src)_1."+ie:""}(),ct=_t.toString,rt=re.call(Object),Qe=RegExp("^"+re.call(ke).replace(te,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),At=je?Ie.Buffer:void 0,Dt=Ie.Symbol,vt=Ie.Uint8Array,yt=At?At.allocUnsafe:void 0,jt=He(Object.getPrototypeOf,Object),Wt=Object.create,Kt=_t.propertyIsEnumerable,Vt=Ke.splice,hi=Dt?Dt.toStringTag:void 0,ui=function(){try{var ie=x(Object,"defineProperty");return ie({},"",{}),ie}catch{}}(),Zi=At?At.isBuffer:void 0,Re=Math.max,xt=Date.now,me=x(Ie,"Map"),W=x(Object,"create"),X=function(){function ie(){}return l(ie,"object"),function(Se){if(!vn(Se))return{};if(Wt)return Wt(Se);ie.prototype=Se;var Fe=new ie;return ie.prototype=void 0,Fe}}();function ae(ie){var Se=-1,Fe=ie==null?0:ie.length;for(this.clear();++Se<Fe;){var gt=ie[Se];this.set(gt[0],gt[1])}}l(ae,"Hash");function _e(){this.__data__=W?W(null):{},this.size=0}l(_e,"hashClear");function fe(ie){var Se=this.has(ie)&&delete this.__data__[ie];return this.size-=Se?1:0,Se}l(fe,"hashDelete");function We(ie){var Se=this.__data__;if(W){var Fe=Se[ie];return Fe===n?void 0:Fe}return ke.call(Se,ie)?Se[ie]:void 0}l(We,"hashGet");function Be(ie){var Se=this.__data__;return W?Se[ie]!==void 0:ke.call(Se,ie)}l(Be,"hashHas");function st(ie,Se){var Fe=this.__data__;return this.size+=this.has(ie)?0:1,Fe[ie]=W&&Se===void 0?n:Se,this}l(st,"hashSet"),ae.prototype.clear=_e,ae.prototype.delete=fe,ae.prototype.get=We,ae.prototype.has=Be,ae.prototype.set=st;function Xe(ie){var Se=-1,Fe=ie==null?0:ie.length;for(this.clear();++Se<Fe;){var gt=ie[Se];this.set(gt[0],gt[1])}}l(Xe,"ListCache");function bt(){this.__data__=[],this.size=0}l(bt,"listCacheClear");function Ye(ie){var Se=this.__data__,Fe=Ge(Se,ie);if(Fe<0)return!1;var gt=Se.length-1;return Fe==gt?Se.pop():Vt.call(Se,Fe,1),--this.size,!0}l(Ye,"listCacheDelete");function dt(ie){var Se=this.__data__,Fe=Ge(Se,ie);return Fe<0?void 0:Se[Fe][1]}l(dt,"listCacheGet");function Mt(ie){return Ge(this.__data__,ie)>-1}l(Mt,"listCacheHas");function bi(ie,Se){var Fe=this.__data__,gt=Ge(Fe,ie);return gt<0?(++this.size,Fe.push([ie,Se])):Fe[gt][1]=Se,this}l(bi,"listCacheSet"),Xe.prototype.clear=bt,Xe.prototype.delete=Ye,Xe.prototype.get=dt,Xe.prototype.has=Mt,Xe.prototype.set=bi;function ni(ie){var Se=-1,Fe=ie==null?0:ie.length;for(this.clear();++Se<Fe;){var gt=ie[Se];this.set(gt[0],gt[1])}}l(ni,"MapCache");function Ii(){this.size=0,this.__data__={hash:new ae,map:new(me||Xe),string:new ae}}l(Ii,"mapCacheClear");function Nt(ie){var Se=_i(this,ie).delete(ie);return this.size-=Se?1:0,Se}l(Nt,"mapCacheDelete");function Ri(ie){return _i(this,ie).get(ie)}l(Ri,"mapCacheGet");function Ki(ie){return _i(this,ie).has(ie)}l(Ki,"mapCacheHas");function Vi(ie,Se){var Fe=_i(this,ie),gt=Fe.size;return Fe.set(ie,Se),this.size+=Fe.size==gt?0:1,this}l(Vi,"mapCacheSet"),ni.prototype.clear=Ii,ni.prototype.delete=Nt,ni.prototype.get=Ri,ni.prototype.has=Ki,ni.prototype.set=Vi;function Ti(ie){var Se=this.__data__=new Xe(ie);this.size=Se.size}l(Ti,"Stack");function yn(){this.__data__=new Xe,this.size=0}l(yn,"stackClear");function hn(ie){var Se=this.__data__,Fe=Se.delete(ie);return this.size=Se.size,Fe}l(hn,"stackDelete");function An(ie){return this.__data__.get(ie)}l(An,"stackGet");function gn(ie){return this.__data__.has(ie)}l(gn,"stackHas");function nr(ie,Se){var Fe=this.__data__;if(Fe instanceof Xe){var gt=Fe.__data__;if(!me||gt.length<t-1)return gt.push([ie,Se]),this.size=++Fe.size,this;Fe=this.__data__=new ni(gt)}return Fe.set(ie,Se),this.size=Fe.size,this}l(nr,"stackSet"),Ti.prototype.clear=yn,Ti.prototype.delete=hn,Ti.prototype.get=An,Ti.prototype.has=gn,Ti.prototype.set=nr;function ue(ie,Se){var Fe=rr(ie),gt=!Fe&&Nn(ie),pi=!Fe&&!gt&&zr(ie),ai=!Fe&&!gt&&!pi&&Dn(ie),Di=Fe||gt||pi||ai,Ni=Di?de(ie.length,String):[],tn=Ni.length;for(var Sn in ie)(Se||ke.call(ie,Sn))&&!(Di&&(Sn=="length"||pi&&(Sn=="offset"||Sn=="parent")||ai&&(Sn=="buffer"||Sn=="byteLength"||Sn=="byteOffset")||V(Sn,tn)))&&Ni.push(Sn);return Ni}l(ue,"arrayLikeKeys");function Pe(ie,Se,Fe){(Fe!==void 0&&!ei(ie[Se],Fe)||Fe===void 0&&!(Se in ie))&&Oe(ie,Se,Fe)}l(Pe,"assignMergeValue");function Ze(ie,Se,Fe){var gt=ie[Se];(!(ke.call(ie,Se)&&ei(gt,Fe))||Fe===void 0&&!(Se in ie))&&Oe(ie,Se,Fe)}l(Ze,"assignValue");function Ge(ie,Se){for(var Fe=ie.length;Fe--;)if(ei(ie[Fe][0],Se))return Fe;return-1}l(Ge,"assocIndexOf");function Oe(ie,Se,Fe){Se=="__proto__"&&ui?ui(ie,Se,{configurable:!0,enumerable:!0,value:Fe,writable:!0}):ie[Se]=Fe}l(Oe,"baseAssignValue");var pt=Qn();function Ot(ie){return ie==null?ie===void 0?B:E:hi&&hi in Object(ie)?M(ie):qe(ie)}l(Ot,"baseGetTag");function Ft(ie){return Jo(ie)&&Ot(ie)==s}l(Ft,"baseIsArguments");function $t(ie){if(!vn(ie)||le(ie))return!1;var Se=Bi(ie)?Qe:ve;return Se.test(It(ie))}l($t,"baseIsNative");function si(ie){return Jo(ie)&&Ma(ie.length)&&!!he[Ot(ie)]}l(si,"baseIsTypedArray");function Ci(ie){if(!vn(ie))return ze(ie);var Se=ce(ie),Fe=[];for(var gt in ie)gt=="constructor"&&(Se||!ke.call(ie,gt))||Fe.push(gt);return Fe}l(Ci,"baseKeysIn");function xi(ie,Se,Fe,gt,pi){ie!==Se&&pt(Se,function(ai,Di){if(pi||(pi=new Ti),vn(ai))ji(ie,Se,Di,Fe,xi,gt,pi);else{var Ni=gt?gt(Ct(ie,Di),ai,Di+"",ie,Se,pi):void 0;Ni===void 0&&(Ni=ai),Pe(ie,Di,Ni)}},Qr)}l(xi,"baseMerge");function ji(ie,Se,Fe,gt,pi,ai,Di){var Ni=Ct(ie,Fe),tn=Ct(Se,Fe),Sn=Di.get(tn);if(Sn){Pe(ie,Fe,Sn);return}var er=ai?ai(Ni,tn,Fe+"",ie,Se,Di):void 0,qn=er===void 0;if(qn){var Lo=rr(tn),co=!Lo&&zr(tn),Ah=!Lo&&!co&&Dn(tn);er=tn,Lo||co||Ah?rr(Ni)?er=Ni:xs(Ni)?er=vi(Ni):co?(qn=!1,er=cn(tn,!0)):Ah?(qn=!1,er=fi(tn,!0)):er=[]:bs(tn)||Nn(tn)?(er=Ni,Nn(Ni)?er=Pr(Ni):(!vn(Ni)||Bi(Ni))&&(er=P(tn))):qn=!1}qn&&(Di.set(tn,er),pi(er,tn,gt,ai,Di),Di.delete(tn)),Pe(ie,Fe,er)}l(ji,"baseMergeDeep");function Xi(ie,Se){return Bt(mt(ie,Se,be),ie+"")}l(Xi,"baseRest");var ci=ui?function(ie,Se){return ui(ie,"toString",{configurable:!0,enumerable:!1,value:ho(Se),writable:!0})}:be;function cn(ie,Se){if(Se)return ie.slice();var Fe=ie.length,gt=yt?yt(Fe):new ie.constructor(Fe);return ie.copy(gt),gt}l(cn,"cloneBuffer");function Gi(ie){var Se=new ie.constructor(ie.byteLength);return new vt(Se).set(new vt(ie)),Se}l(Gi,"cloneArrayBuffer");function fi(ie,Se){var Fe=Se?Gi(ie.buffer):ie.buffer;return new ie.constructor(Fe,ie.byteOffset,ie.length)}l(fi,"cloneTypedArray");function vi(ie,Se){var Fe=-1,gt=ie.length;for(Se||(Se=Array(gt));++Fe<gt;)Se[Fe]=ie[Fe];return Se}l(vi,"copyArray");function Li(ie,Se,Fe,gt){var pi=!Fe;Fe||(Fe={});for(var ai=-1,Di=Se.length;++ai<Di;){var Ni=Se[ai],tn=gt?gt(Fe[Ni],ie[Ni],Ni,Fe,ie):void 0;tn===void 0&&(tn=ie[Ni]),pi?Oe(Fe,Ni,tn):Ze(Fe,Ni,tn)}return Fe}l(Li,"copyObject");function Tr(ie){return Xi(function(Se,Fe){var gt=-1,pi=Fe.length,ai=pi>1?Fe[pi-1]:void 0,Di=pi>2?Fe[2]:void 0;for(ai=ie.length>3&&typeof ai=="function"?(pi--,ai):void 0,Di&&H(Fe[0],Fe[1],Di)&&(ai=pi<3?void 0:ai,pi=1),Se=Object(Se);++gt<pi;){var Ni=Fe[gt];Ni&&ie(Se,Ni,gt,ai)}return Se})}l(Tr,"createAssigner");function Qn(ie){return function(Se,Fe,gt){for(var pi=-1,ai=Object(Se),Di=gt(Se),Ni=Di.length;Ni--;){var tn=Di[ie?Ni:++pi];if(Fe(ai[tn],tn,ai)===!1)break}return Se}}l(Qn,"createBaseFor");function Gn(ie,Se,Fe,gt,pi,ai){return vn(ie)&&vn(Se)&&(ai.set(Se,ie),xi(ie,Se,void 0,Gn,ai),ai.delete(Se)),ie}l(Gn,"customDefaultsMerge");function _i(ie,Se){var Fe=ie.__data__;return ne(Se)?Fe[typeof Se=="string"?"string":"hash"]:Fe.map}l(_i,"getMapData");function x(ie,Se){var Fe=ot(ie,Se);return $t(Fe)?Fe:void 0}l(x,"getNative");function M(ie){var Se=ke.call(ie,hi),Fe=ie[hi];try{ie[hi]=void 0;var gt=!0}catch{}var pi=ct.call(ie);return gt&&(Se?ie[hi]=Fe:delete ie[hi]),pi}l(M,"getRawTag");function P(ie){return typeof ie.constructor=="function"&&!ce(ie)?X(jt(ie)):{}}l(P,"initCloneObject");function V(ie,Se){var Fe=typeof ie;return Se=Se??o,!!Se&&(Fe=="number"||Fe!="symbol"&&Q.test(ie))&&ie>-1&&ie%1==0&&ie<Se}l(V,"isIndex");function H(ie,Se,Fe){if(!vn(Fe))return!1;var gt=typeof Se;return(gt=="number"?Pn(Fe)&&V(Se,Fe.length):gt=="string"&&Se in Fe)?ei(Fe[Se],ie):!1}l(H,"isIterateeCall");function ne(ie){var Se=typeof ie;return Se=="string"||Se=="number"||Se=="symbol"||Se=="boolean"?ie!=="__proto__":ie===null}l(ne,"isKeyable");function le(ie){return!!at&&at in ie}l(le,"isMasked");function ce(ie){var Se=ie&&ie.constructor,Fe=typeof Se=="function"&&Se.prototype||_t;return ie===Fe}l(ce,"isPrototype");function ze(ie){var Se=[];if(ie!=null)for(var Fe in Object(ie))Se.push(Fe);return Se}l(ze,"nativeKeysIn");function qe(ie){return ct.call(ie)}l(qe,"objectToString");function mt(ie,Se,Fe){return Se=Re(Se===void 0?ie.length-1:Se,0),function(){for(var gt=arguments,pi=-1,ai=Re(gt.length-Se,0),Di=Array(ai);++pi<ai;)Di[pi]=gt[Se+pi];pi=-1;for(var Ni=Array(Se+1);++pi<Se;)Ni[pi]=gt[pi];return Ni[Se]=Fe(Di),Ue(ie,this,Ni)}}l(mt,"overRest");function Ct(ie,Se){if(!(Se==="constructor"&&typeof ie[Se]=="function")&&Se!="__proto__")return ie[Se]}l(Ct,"safeGet");var Bt=Ut(ci);function Ut(ie){var Se=0,Fe=0;return function(){var gt=xt(),pi=a-(gt-Fe);if(Fe=gt,pi>0){if(++Se>=r)return arguments[0]}else Se=0;return ie.apply(void 0,arguments)}}l(Ut,"shortOut");function It(ie){if(ie!=null){try{return re.call(ie)}catch{}try{return ie+""}catch{}}return""}l(It,"toSource");function ei(ie,Se){return ie===Se||ie!==ie&&Se!==Se}l(ei,"eq");var Nn=Ft(function(){return arguments}())?Ft:function(ie){return Jo(ie)&&ke.call(ie,"callee")&&!Kt.call(ie,"callee")},rr=Array.isArray;function Pn(ie){return ie!=null&&Ma(ie.length)&&!Bi(ie)}l(Pn,"isArrayLike");function xs(ie){return Jo(ie)&&Pn(ie)}l(xs,"isArrayLikeObject");var zr=Zi||De;function Bi(ie){if(!vn(ie))return!1;var Se=Ot(ie);return Se==v||Se==b||Se==h||Se==C}l(Bi,"isFunction");function Ma(ie){return typeof ie=="number"&&ie>-1&&ie%1==0&&ie<=o}l(Ma,"isLength");function vn(ie){var Se=typeof ie;return ie!=null&&(Se=="object"||Se=="function")}l(vn,"isObject");function Jo(ie){return ie!=null&&typeof ie=="object"}l(Jo,"isObjectLike");function bs(ie){if(!Jo(ie)||Ot(ie)!=I)return!1;var Se=jt(ie);if(Se===null)return!0;var Fe=ke.call(Se,"constructor")&&Se.constructor;return typeof Fe=="function"&&Fe instanceof Fe&&re.call(Fe)==rt}l(bs,"isPlainObject");var Dn=xe?ut(xe):si;function Pr(ie){return Li(ie,Qr(ie))}l(Pr,"toPlainObject");var Sl=Xi(function(ie){return ie.push(void 0,Gn),Ue(Ha,void 0,ie)});function Qr(ie){return Pn(ie)?ue(ie,!0):Ci(ie)}l(Qr,"keysIn");var Ha=Tr(function(ie,Se,Fe,gt){xi(ie,Se,Fe,gt)});function ho(ie){return function(){return ie}}l(ho,"constant");function be(ie){return ie}l(be,"identity");function De(){return!1}l(De,"stubFalse"),e.exports=Sl}),Mwe=Et((i,e)=>{R();var t=!1,n={},r=!1;typeof e<"u"&&e.exports?(e.exports=n,r=!0):typeof document<"u"?window.ClipperLib=n:self.ClipperLib=n;var a;r?(o="chrome",a="Netscape"):(o=navigator.userAgent.toString().toLowerCase(),a=navigator.appName);var o,s={};o.indexOf("chrome")!=-1&&o.indexOf("chromium")==-1?s.chrome=1:s.chrome=0,o.indexOf("chromium")!=-1?s.chromium=1:s.chromium=0,o.indexOf("safari")!=-1&&o.indexOf("chrome")==-1&&o.indexOf("chromium")==-1?s.safari=1:s.safari=0,o.indexOf("firefox")!=-1?s.firefox=1:s.firefox=0,o.indexOf("firefox/17")!=-1?s.firefox17=1:s.firefox17=0,o.indexOf("firefox/15")!=-1?s.firefox15=1:s.firefox15=0,o.indexOf("firefox/3")!=-1?s.firefox3=1:s.firefox3=0,o.indexOf("opera")!=-1?s.opera=1:s.opera=0,o.indexOf("msie 10")!=-1?s.msie10=1:s.msie10=0,o.indexOf("msie 9")!=-1?s.msie9=1:s.msie9=0,o.indexOf("msie 8")!=-1?s.msie8=1:s.msie8=0,o.indexOf("msie 7")!=-1?s.msie7=1:s.msie7=0,o.indexOf("msie ")!=-1?s.msie=1:s.msie=0,n.biginteger_used=null;var u;function h(x,M,P){n.biginteger_used=1,x!=null&&(typeof x=="number"&&typeof M>"u"?this.fromInt(x):typeof x=="number"?this.fromNumber(x,M,P):M==null&&typeof x!="string"?this.fromString(x,256):this.fromString(x,M))}l(h,"BigInteger");function d(){return new h(null)}l(d,"nbi");function f(x,M,P,V,H,ne){for(;--ne>=0;){var le=M*this[x++]+P[V]+H;H=Math.floor(le/67108864),P[V++]=le&67108863}return H}l(f,"am1");function m(x,M,P,V,H,ne){for(var le=M&32767,ce=M>>15;--ne>=0;){var ze=this[x]&32767,qe=this[x++]>>15,mt=ce*ze+qe*le;ze=le*ze+((mt&32767)<<15)+P[V]+(H&1073741823),H=(ze>>>30)+(mt>>>15)+ce*qe+(H>>>30),P[V++]=ze&1073741823}return H}l(m,"am2");function v(x,M,P,V,H,ne){for(var le=M&16383,ce=M>>14;--ne>=0;){var ze=this[x]&16383,qe=this[x++]>>14,mt=ce*ze+qe*le;ze=le*ze+((mt&16383)<<14)+P[V]+H,H=(ze>>28)+(mt>>14)+ce*qe,P[V++]=ze&268435455}return H}l(v,"am3"),a=="Microsoft Internet Explorer"?(h.prototype.am=m,u=30):a!="Netscape"?(h.prototype.am=f,u=26):(h.prototype.am=v,u=28),h.prototype.DB=u,h.prototype.DM=(1<<u)-1,h.prototype.DV=1<<u;var b=52;h.prototype.FV=Math.pow(2,b),h.prototype.F1=b-u,h.prototype.F2=2*u-b;var w="0123456789abcdefghijklmnopqrstuvwxyz",A=new Array,E,I;for(E=48,I=0;I<=9;++I)A[E++]=I;for(E=97,I=10;I<36;++I)A[E++]=I;for(E=65,I=10;I<36;++I)A[E++]=I;function C(x){return w.charAt(x)}l(C,"int2char");function T(x,M){var P=A[x.charCodeAt(M)];return P??-1}l(T,"intAt");function k(x){for(var M=this.t-1;M>=0;--M)x[M]=this[M];x.t=this.t,x.s=this.s}l(k,"bnpCopyTo");function F(x){this.t=1,this.s=x<0?-1:0,x>0?this[0]=x:x<-1?this[0]=x+this.DV:this.t=0}l(F,"bnpFromInt");function B(x){var M=d();return M.fromInt(x),M}l(B,"nbv");function N(x,M){var P;if(M==16)P=4;else if(M==8)P=3;else if(M==256)P=8;else if(M==2)P=1;else if(M==32)P=5;else if(M==4)P=2;else{this.fromRadix(x,M);return}this.t=0,this.s=0;for(var V=x.length,H=!1,ne=0;--V>=0;){var le=P==8?x[V]&255:T(x,V);if(le<0){x.charAt(V)=="-"&&(H=!0);continue}H=!1,ne==0?this[this.t++]=le:ne+P>this.DB?(this[this.t-1]|=(le&(1<<this.DB-ne)-1)<<ne,this[this.t++]=le>>this.DB-ne):this[this.t-1]|=le<<ne,ne+=P,ne>=this.DB&&(ne-=this.DB)}P==8&&(x[0]&128)!=0&&(this.s=-1,ne>0&&(this[this.t-1]|=(1<<this.DB-ne)-1<<ne)),this.clamp(),H&&h.ZERO.subTo(this,this)}l(N,"bnpFromString");function z(){for(var x=this.s&this.DM;this.t>0&&this[this.t-1]==x;)--this.t}l(z,"bnpClamp");function L(x){if(this.s<0)return"-"+this.negate().toString(x);var M;if(x==16)M=4;else if(x==8)M=3;else if(x==2)M=1;else if(x==32)M=5;else if(x==4)M=2;else return this.toRadix(x);var P=(1<<M)-1,V,H=!1,ne="",le=this.t,ce=this.DB-le*this.DB%M;if(le-- >0)for(ce<this.DB&&(V=this[le]>>ce)>0&&(H=!0,ne=C(V));le>=0;)ce<M?(V=(this[le]&(1<<ce)-1)<<M-ce,V|=this[--le]>>(ce+=this.DB-M)):(V=this[le]>>(ce-=M)&P,ce<=0&&(ce+=this.DB,--le)),V>0&&(H=!0),H&&(ne+=C(V));return H?ne:"0"}l(L,"bnToString");function j(){var x=d();return h.ZERO.subTo(this,x),x}l(j,"bnNegate");function q(){return this.s<0?this.negate():this}l(q,"bnAbs");function Z(x){var M=this.s-x.s;if(M!=0)return M;var P=this.t;if(M=P-x.t,M!=0)return this.s<0?-M:M;for(;--P>=0;)if((M=this[P]-x[P])!=0)return M;return 0}l(Z,"bnCompareTo");function O(x){var M=1,P;return(P=x>>>16)!=0&&(x=P,M+=16),(P=x>>8)!=0&&(x=P,M+=8),(P=x>>4)!=0&&(x=P,M+=4),(P=x>>2)!=0&&(x=P,M+=2),(P=x>>1)!=0&&(x=P,M+=1),M}l(O,"nbits");function Y(){return this.t<=0?0:this.DB*(this.t-1)+O(this[this.t-1]^this.s&this.DM)}l(Y,"bnBitLength");function J(x,M){var P;for(P=this.t-1;P>=0;--P)M[P+x]=this[P];for(P=x-1;P>=0;--P)M[P]=0;M.t=this.t+x,M.s=this.s}l(J,"bnpDLShiftTo");function oe(x,M){for(var P=x;P<this.t;++P)M[P-x]=this[P];M.t=Math.max(this.t-x,0),M.s=this.s}l(oe,"bnpDRShiftTo");function $(x,M){var P=x%this.DB,V=this.DB-P,H=(1<<V)-1,ne=Math.floor(x/this.DB),le=this.s<<P&this.DM,ce;for(ce=this.t-1;ce>=0;--ce)M[ce+ne+1]=this[ce]>>V|le,le=(this[ce]&H)<<P;for(ce=ne-1;ce>=0;--ce)M[ce]=0;M[ne]=le,M.t=this.t+ne+1,M.s=this.s,M.clamp()}l($,"bnpLShiftTo");function K(x,M){M.s=this.s;var P=Math.floor(x/this.DB);if(P>=this.t){M.t=0;return}var V=x%this.DB,H=this.DB-V,ne=(1<<V)-1;M[0]=this[P]>>V;for(var le=P+1;le<this.t;++le)M[le-P-1]|=(this[le]&ne)<<H,M[le-P]=this[le]>>V;V>0&&(M[this.t-P-1]|=(this.s&ne)<<H),M.t=this.t-P,M.clamp()}l(K,"bnpRShiftTo");function te(x,M){for(var P=0,V=0,H=Math.min(x.t,this.t);P<H;)V+=this[P]-x[P],M[P++]=V&this.DM,V>>=this.DB;if(x.t<this.t){for(V-=x.s;P<this.t;)V+=this[P],M[P++]=V&this.DM,V>>=this.DB;V+=this.s}else{for(V+=this.s;P<x.t;)V-=x[P],M[P++]=V&this.DM,V>>=this.DB;V-=x.s}M.s=V<0?-1:0,V<-1?M[P++]=this.DV+V:V>0&&(M[P++]=V),M.t=P,M.clamp()}l(te,"bnpSubTo");function ve(x,M){var P=this.abs(),V=x.abs(),H=P.t;for(M.t=H+V.t;--H>=0;)M[H]=0;for(H=0;H<V.t;++H)M[H+P.t]=P.am(0,V[H],M,H,0,P.t);M.s=0,M.clamp(),this.s!=x.s&&h.ZERO.subTo(M,M)}l(ve,"bnpMultiplyTo");function Q(x){for(var M=this.abs(),P=x.t=2*M.t;--P>=0;)x[P]=0;for(P=0;P<M.t-1;++P){var V=M.am(P,M[P],x,2*P,0,1);(x[P+M.t]+=M.am(P+1,2*M[P],x,2*P+1,V,M.t-P-1))>=M.DV&&(x[P+M.t]-=M.DV,x[P+M.t+1]=1)}x.t>0&&(x[x.t-1]+=M.am(P,M[P],x,2*P,0,1)),x.s=0,x.clamp()}l(Q,"bnpSquareTo");function he(x,M,P){var V=x.abs();if(!(V.t<=0)){var H=this.abs();if(H.t<V.t){M?.fromInt(0),P!=null&&this.copyTo(P);return}P==null&&(P=d());var ne=d(),le=this.s,ce=x.s,ze=this.DB-O(V[V.t-1]);ze>0?(V.lShiftTo(ze,ne),H.lShiftTo(ze,P)):(V.copyTo(ne),H.copyTo(P));var qe=ne.t,mt=ne[qe-1];if(mt!=0){var Ct=mt*(1<<this.F1)+(qe>1?ne[qe-2]>>this.F2:0),Bt=this.FV/Ct,Ut=(1<<this.F1)/Ct,It=1<<this.F2,ei=P.t,Nn=ei-qe,rr=M??d();for(ne.dlShiftTo(Nn,rr),P.compareTo(rr)>=0&&(P[P.t++]=1,P.subTo(rr,P)),h.ONE.dlShiftTo(qe,rr),rr.subTo(ne,ne);ne.t<qe;)ne[ne.t++]=0;for(;--Nn>=0;){var Pn=P[--ei]==mt?this.DM:Math.floor(P[ei]*Bt+(P[ei-1]+It)*Ut);if((P[ei]+=ne.am(0,Pn,P,Nn,0,qe))<Pn)for(ne.dlShiftTo(Nn,rr),P.subTo(rr,P);P[ei]<--Pn;)P.subTo(rr,P)}M!=null&&(P.drShiftTo(qe,M),le!=ce&&h.ZERO.subTo(M,M)),P.t=qe,P.clamp(),ze>0&&P.rShiftTo(ze,P),le<0&&h.ZERO.subTo(P,P)}}}l(he,"bnpDivRemTo");function se(x){var M=d();return this.abs().divRemTo(x,null,M),this.s<0&&M.compareTo(h.ZERO)>0&&x.subTo(M,M),M}l(se,"bnMod");function Ae(x){this.m=x}l(Ae,"Classic");function Ie(x){return x.s<0||x.compareTo(this.m)>=0?x.mod(this.m):x}l(Ie,"cConvert");function we(x){return x}l(we,"cRevert");function Ne(x){x.divRemTo(this.m,null,x)}l(Ne,"cReduce");function je(x,M,P){x.multiplyTo(M,P),this.reduce(P)}l(je,"cMulTo");function Ve(x,M){x.squareTo(M),this.reduce(M)}l(Ve,"cSqrTo"),Ae.prototype.convert=Ie,Ae.prototype.revert=we,Ae.prototype.reduce=Ne,Ae.prototype.mulTo=je,Ae.prototype.sqrTo=Ve;function Le(){if(this.t<1)return 0;var x=this[0];if((x&1)==0)return 0;var M=x&3;return M=M*(2-(x&15)*M)&15,M=M*(2-(x&255)*M)&255,M=M*(2-((x&65535)*M&65535))&65535,M=M*(2-x*M%this.DV)%this.DV,M>0?this.DV-M:-M}l(Le,"bnpInvDigit");function xe(x){this.m=x,this.mp=x.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<x.DB-15)-1,this.mt2=2*x.t}l(xe,"Montgomery");function Ue(x){var M=d();return x.abs().dlShiftTo(this.m.t,M),M.divRemTo(this.m,null,M),x.s<0&&M.compareTo(h.ZERO)>0&&this.m.subTo(M,M),M}l(Ue,"montConvert");function de(x){var M=d();return x.copyTo(M),this.reduce(M),M}l(de,"montRevert");function ut(x){for(;x.t<=this.mt2;)x[x.t++]=0;for(var M=0;M<this.m.t;++M){var P=x[M]&32767,V=P*this.mpl+((P*this.mph+(x[M]>>15)*this.mpl&this.um)<<15)&x.DM;for(P=M+this.m.t,x[P]+=this.m.am(0,V,x,M,0,this.m.t);x[P]>=x.DV;)x[P]-=x.DV,x[++P]++}x.clamp(),x.drShiftTo(this.m.t,x),x.compareTo(this.m)>=0&&x.subTo(this.m,x)}l(ut,"montReduce");function ot(x,M){x.squareTo(M),this.reduce(M)}l(ot,"montSqrTo");function He(x,M,P){x.multiplyTo(M,P),this.reduce(P)}l(He,"montMulTo"),xe.prototype.convert=Ue,xe.prototype.revert=de,xe.prototype.reduce=ut,xe.prototype.mulTo=He,xe.prototype.sqrTo=ot;function Ke(){return(this.t>0?this[0]&1:this.s)==0}l(Ke,"bnpIsEven");function Lt(x,M){if(x>4294967295||x<1)return h.ONE;var P=d(),V=d(),H=M.convert(this),ne=O(x)-1;for(H.copyTo(P);--ne>=0;)if(M.sqrTo(P,V),(x&1<<ne)>0)M.mulTo(V,H,P);else{var le=P;P=V,V=le}return M.revert(P)}l(Lt,"bnpExp");function _t(x,M){var P;return x<256||M.isEven()?P=new Ae(M):P=new xe(M),this.exp(x,P)}l(_t,"bnModPowInt"),h.prototype.copyTo=k,h.prototype.fromInt=F,h.prototype.fromString=N,h.prototype.clamp=z,h.prototype.dlShiftTo=J,h.prototype.drShiftTo=oe,h.prototype.lShiftTo=$,h.prototype.rShiftTo=K,h.prototype.subTo=te,h.prototype.multiplyTo=ve,h.prototype.squareTo=Q,h.prototype.divRemTo=he,h.prototype.invDigit=Le,h.prototype.isEven=Ke,h.prototype.exp=Lt,h.prototype.toString=L,h.prototype.negate=j,h.prototype.abs=q,h.prototype.compareTo=Z,h.prototype.bitLength=Y,h.prototype.mod=se,h.prototype.modPowInt=_t,h.ZERO=B(0),h.ONE=B(1);function pe(){var x=d();return this.copyTo(x),x}l(pe,"bnClone");function re(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}l(re,"bnIntValue");function ke(){return this.t==0?this.s:this[0]<<24>>24}l(ke,"bnByteValue");function at(){return this.t==0?this.s:this[0]<<16>>16}l(at,"bnShortValue");function ct(x){return Math.floor(Math.LN2*this.DB/Math.log(x))}l(ct,"bnpChunkSize");function rt(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}l(rt,"bnSigNum");function Qe(x){if(x==null&&(x=10),this.signum()==0||x<2||x>36)return"0";var M=this.chunkSize(x),P=Math.pow(x,M),V=B(P),H=d(),ne=d(),le="";for(this.divRemTo(V,H,ne);H.signum()>0;)le=(P+ne.intValue()).toString(x).substr(1)+le,H.divRemTo(V,H,ne);return ne.intValue().toString(x)+le}l(Qe,"bnpToRadix");function At(x,M){this.fromInt(0),M==null&&(M=10);for(var P=this.chunkSize(M),V=Math.pow(M,P),H=!1,ne=0,le=0,ce=0;ce<x.length;++ce){var ze=T(x,ce);if(ze<0){x.charAt(ce)=="-"&&this.signum()==0&&(H=!0);continue}le=M*le+ze,++ne>=P&&(this.dMultiply(V),this.dAddOffset(le,0),ne=0,le=0)}ne>0&&(this.dMultiply(Math.pow(M,ne)),this.dAddOffset(le,0)),H&&h.ZERO.subTo(this,this)}l(At,"bnpFromRadix");function Dt(x,M,P){if(typeof M=="number")if(x<2)this.fromInt(1);else for(this.fromNumber(x,P),this.testBit(x-1)||this.bitwiseTo(h.ONE.shiftLeft(x-1),ui,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(M);)this.dAddOffset(2,0),this.bitLength()>x&&this.subTo(h.ONE.shiftLeft(x-1),this);else{var V=new Array,H=x&7;V.length=(x>>3)+1,M.nextBytes(V),H>0?V[0]&=(1<<H)-1:V[0]=0,this.fromString(V,256)}}l(Dt,"bnpFromNumber");function vt(){var x=this.t,M=new Array;M[0]=this.s;var P=this.DB-x*this.DB%8,V,H=0;if(x-- >0)for(P<this.DB&&(V=this[x]>>P)!=(this.s&this.DM)>>P&&(M[H++]=V|this.s<<this.DB-P);x>=0;)P<8?(V=(this[x]&(1<<P)-1)<<8-P,V|=this[--x]>>(P+=this.DB-8)):(V=this[x]>>(P-=8)&255,P<=0&&(P+=this.DB,--x)),(V&128)!=0&&(V|=-256),H==0&&(this.s&128)!=(V&128)&&++H,(H>0||V!=this.s)&&(M[H++]=V);return M}l(vt,"bnToByteArray");function yt(x){return this.compareTo(x)==0}l(yt,"bnEquals");function jt(x){return this.compareTo(x)<0?this:x}l(jt,"bnMin");function Wt(x){return this.compareTo(x)>0?this:x}l(Wt,"bnMax");function Kt(x,M,P){var V,H,ne=Math.min(x.t,this.t);for(V=0;V<ne;++V)P[V]=M(this[V],x[V]);if(x.t<this.t){for(H=x.s&this.DM,V=ne;V<this.t;++V)P[V]=M(this[V],H);P.t=this.t}else{for(H=this.s&this.DM,V=ne;V<x.t;++V)P[V]=M(H,x[V]);P.t=x.t}P.s=M(this.s,x.s),P.clamp()}l(Kt,"bnpBitwiseTo");function Vt(x,M){return x&M}l(Vt,"op_and");function hi(x){var M=d();return this.bitwiseTo(x,Vt,M),M}l(hi,"bnAnd");function ui(x,M){return x|M}l(ui,"op_or");function Zi(x){var M=d();return this.bitwiseTo(x,ui,M),M}l(Zi,"bnOr");function Re(x,M){return x^M}l(Re,"op_xor");function xt(x){var M=d();return this.bitwiseTo(x,Re,M),M}l(xt,"bnXor");function me(x,M){return x&~M}l(me,"op_andnot");function W(x){var M=d();return this.bitwiseTo(x,me,M),M}l(W,"bnAndNot");function X(){for(var x=d(),M=0;M<this.t;++M)x[M]=this.DM&~this[M];return x.t=this.t,x.s=~this.s,x}l(X,"bnNot");function ae(x){var M=d();return x<0?this.rShiftTo(-x,M):this.lShiftTo(x,M),M}l(ae,"bnShiftLeft");function _e(x){var M=d();return x<0?this.lShiftTo(-x,M):this.rShiftTo(x,M),M}l(_e,"bnShiftRight");function fe(x){if(x==0)return-1;var M=0;return(x&65535)==0&&(x>>=16,M+=16),(x&255)==0&&(x>>=8,M+=8),(x&15)==0&&(x>>=4,M+=4),(x&3)==0&&(x>>=2,M+=2),(x&1)==0&&++M,M}l(fe,"lbit");function We(){for(var x=0;x<this.t;++x)if(this[x]!=0)return x*this.DB+fe(this[x]);return this.s<0?this.t*this.DB:-1}l(We,"bnGetLowestSetBit");function Be(x){for(var M=0;x!=0;)x&=x-1,++M;return M}l(Be,"cbit");function st(){for(var x=0,M=this.s&this.DM,P=0;P<this.t;++P)x+=Be(this[P]^M);return x}l(st,"bnBitCount");function Xe(x){var M=Math.floor(x/this.DB);return M>=this.t?this.s!=0:(this[M]&1<<x%this.DB)!=0}l(Xe,"bnTestBit");function bt(x,M){var P=h.ONE.shiftLeft(x);return this.bitwiseTo(P,M,P),P}l(bt,"bnpChangeBit");function Ye(x){return this.changeBit(x,ui)}l(Ye,"bnSetBit");function dt(x){return this.changeBit(x,me)}l(dt,"bnClearBit");function Mt(x){return this.changeBit(x,Re)}l(Mt,"bnFlipBit");function bi(x,M){for(var P=0,V=0,H=Math.min(x.t,this.t);P<H;)V+=this[P]+x[P],M[P++]=V&this.DM,V>>=this.DB;if(x.t<this.t){for(V+=x.s;P<this.t;)V+=this[P],M[P++]=V&this.DM,V>>=this.DB;V+=this.s}else{for(V+=this.s;P<x.t;)V+=x[P],M[P++]=V&this.DM,V>>=this.DB;V+=x.s}M.s=V<0?-1:0,V>0?M[P++]=V:V<-1&&(M[P++]=this.DV+V),M.t=P,M.clamp()}l(bi,"bnpAddTo");function ni(x){var M=d();return this.addTo(x,M),M}l(ni,"bnAdd");function Ii(x){var M=d();return this.subTo(x,M),M}l(Ii,"bnSubtract");function Nt(x){var M=d();return this.multiplyTo(x,M),M}l(Nt,"bnMultiply");function Ri(){var x=d();return this.squareTo(x),x}l(Ri,"bnSquare");function Ki(x){var M=d();return this.divRemTo(x,M,null),M}l(Ki,"bnDivide");function Vi(x){var M=d();return this.divRemTo(x,null,M),M}l(Vi,"bnRemainder");function Ti(x){var M=d(),P=d();return this.divRemTo(x,M,P),new Array(M,P)}l(Ti,"bnDivideAndRemainder");function yn(x){this[this.t]=this.am(0,x-1,this,0,0,this.t),++this.t,this.clamp()}l(yn,"bnpDMultiply");function hn(x,M){if(x!=0){for(;this.t<=M;)this[this.t++]=0;for(this[M]+=x;this[M]>=this.DV;)this[M]-=this.DV,++M>=this.t&&(this[this.t++]=0),++this[M]}}l(hn,"bnpDAddOffset");function An(){}l(An,"NullExp");function gn(x){return x}l(gn,"nNop");function nr(x,M,P){x.multiplyTo(M,P)}l(nr,"nMulTo");function ue(x,M){x.squareTo(M)}l(ue,"nSqrTo"),An.prototype.convert=gn,An.prototype.revert=gn,An.prototype.mulTo=nr,An.prototype.sqrTo=ue;function Pe(x){return this.exp(x,new An)}l(Pe,"bnPow");function Ze(x,M,P){var V=Math.min(this.t+x.t,M);for(P.s=0,P.t=V;V>0;)P[--V]=0;var H;for(H=P.t-this.t;V<H;++V)P[V+this.t]=this.am(0,x[V],P,V,0,this.t);for(H=Math.min(x.t,M);V<H;++V)this.am(0,x[V],P,V,0,M-V);P.clamp()}l(Ze,"bnpMultiplyLowerTo");function Ge(x,M,P){--M;var V=P.t=this.t+x.t-M;for(P.s=0;--V>=0;)P[V]=0;for(V=Math.max(M-this.t,0);V<x.t;++V)P[this.t+V-M]=this.am(M-V,x[V],P,0,0,this.t+V-M);P.clamp(),P.drShiftTo(1,P)}l(Ge,"bnpMultiplyUpperTo");function Oe(x){this.r2=d(),this.q3=d(),h.ONE.dlShiftTo(2*x.t,this.r2),this.mu=this.r2.divide(x),this.m=x}l(Oe,"Barrett");function pt(x){if(x.s<0||x.t>2*this.m.t)return x.mod(this.m);if(x.compareTo(this.m)<0)return x;var M=d();return x.copyTo(M),this.reduce(M),M}l(pt,"barrettConvert");function Ot(x){return x}l(Ot,"barrettRevert");function Ft(x){for(x.drShiftTo(this.m.t-1,this.r2),x.t>this.m.t+1&&(x.t=this.m.t+1,x.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);x.compareTo(this.r2)<0;)x.dAddOffset(1,this.m.t+1);for(x.subTo(this.r2,x);x.compareTo(this.m)>=0;)x.subTo(this.m,x)}l(Ft,"barrettReduce");function $t(x,M){x.squareTo(M),this.reduce(M)}l($t,"barrettSqrTo");function si(x,M,P){x.multiplyTo(M,P),this.reduce(P)}l(si,"barrettMulTo"),Oe.prototype.convert=pt,Oe.prototype.revert=Ot,Oe.prototype.reduce=Ft,Oe.prototype.mulTo=si,Oe.prototype.sqrTo=$t;function Ci(x,M){var P=x.bitLength(),V,H=B(1),ne;if(P<=0)return H;P<18?V=1:P<48?V=3:P<144?V=4:P<768?V=5:V=6,P<8?ne=new Ae(M):M.isEven()?ne=new Oe(M):ne=new xe(M);var le=new Array,ce=3,ze=V-1,qe=(1<<V)-1;if(le[1]=ne.convert(this),V>1){var mt=d();for(ne.sqrTo(le[1],mt);ce<=qe;)le[ce]=d(),ne.mulTo(mt,le[ce-2],le[ce]),ce+=2}var Ct=x.t-1,Bt,Ut=!0,It=d(),ei;for(P=O(x[Ct])-1;Ct>=0;){for(P>=ze?Bt=x[Ct]>>P-ze&qe:(Bt=(x[Ct]&(1<<P+1)-1)<<ze-P,Ct>0&&(Bt|=x[Ct-1]>>this.DB+P-ze)),ce=V;(Bt&1)==0;)Bt>>=1,--ce;if((P-=ce)<0&&(P+=this.DB,--Ct),Ut)le[Bt].copyTo(H),Ut=!1;else{for(;ce>1;)ne.sqrTo(H,It),ne.sqrTo(It,H),ce-=2;ce>0?ne.sqrTo(H,It):(ei=H,H=It,It=ei),ne.mulTo(It,le[Bt],H)}for(;Ct>=0&&(x[Ct]&1<<P)==0;)ne.sqrTo(H,It),ei=H,H=It,It=ei,--P<0&&(P=this.DB-1,--Ct)}return ne.revert(H)}l(Ci,"bnModPow");function xi(x){var M=this.s<0?this.negate():this.clone(),P=x.s<0?x.negate():x.clone();if(M.compareTo(P)<0){var V=M;M=P,P=V}var H=M.getLowestSetBit(),ne=P.getLowestSetBit();if(ne<0)return M;for(H<ne&&(ne=H),ne>0&&(M.rShiftTo(ne,M),P.rShiftTo(ne,P));M.signum()>0;)(H=M.getLowestSetBit())>0&&M.rShiftTo(H,M),(H=P.getLowestSetBit())>0&&P.rShiftTo(H,P),M.compareTo(P)>=0?(M.subTo(P,M),M.rShiftTo(1,M)):(P.subTo(M,P),P.rShiftTo(1,P));return ne>0&&P.lShiftTo(ne,P),P}l(xi,"bnGCD");function ji(x){if(x<=0)return 0;var M=this.DV%x,P=this.s<0?x-1:0;if(this.t>0)if(M==0)P=this[0]%x;else for(var V=this.t-1;V>=0;--V)P=(M*P+this[V])%x;return P}l(ji,"bnpModInt");function Xi(x){var M=x.isEven();if(this.isEven()&&M||x.signum()==0)return h.ZERO;for(var P=x.clone(),V=this.clone(),H=B(1),ne=B(0),le=B(0),ce=B(1);P.signum()!=0;){for(;P.isEven();)P.rShiftTo(1,P),M?((!H.isEven()||!ne.isEven())&&(H.addTo(this,H),ne.subTo(x,ne)),H.rShiftTo(1,H)):ne.isEven()||ne.subTo(x,ne),ne.rShiftTo(1,ne);for(;V.isEven();)V.rShiftTo(1,V),M?((!le.isEven()||!ce.isEven())&&(le.addTo(this,le),ce.subTo(x,ce)),le.rShiftTo(1,le)):ce.isEven()||ce.subTo(x,ce),ce.rShiftTo(1,ce);P.compareTo(V)>=0?(P.subTo(V,P),M&&H.subTo(le,H),ne.subTo(ce,ne)):(V.subTo(P,V),M&&le.subTo(H,le),ce.subTo(ne,ce))}if(V.compareTo(h.ONE)!=0)return h.ZERO;if(ce.compareTo(x)>=0)return ce.subtract(x);if(ce.signum()<0)ce.addTo(x,ce);else return ce;return ce.signum()<0?ce.add(x):ce}l(Xi,"bnModInverse");var ci=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],cn=(1<<26)/ci[ci.length-1];function Gi(x){var M,P=this.abs();if(P.t==1&&P[0]<=ci[ci.length-1]){for(M=0;M<ci.length;++M)if(P[0]==ci[M])return!0;return!1}if(P.isEven())return!1;for(M=1;M<ci.length;){for(var V=ci[M],H=M+1;H<ci.length&&V<cn;)V*=ci[H++];for(V=P.modInt(V);M<H;)if(V%ci[M++]==0)return!1}return P.millerRabin(x)}l(Gi,"bnIsProbablePrime");function fi(x){var M=this.subtract(h.ONE),P=M.getLowestSetBit();if(P<=0)return!1;var V=M.shiftRight(P);x=x+1>>1,x>ci.length&&(x=ci.length);for(var H=d(),ne=0;ne<x;++ne){H.fromInt(ci[Math.floor(Math.random()*ci.length)]);var le=H.modPow(V,this);if(le.compareTo(h.ONE)!=0&&le.compareTo(M)!=0){for(var ce=1;ce++<P&&le.compareTo(M)!=0;)if(le=le.modPowInt(2,this),le.compareTo(h.ONE)==0)return!1;if(le.compareTo(M)!=0)return!1}}return!0}l(fi,"bnpMillerRabin"),h.prototype.chunkSize=ct,h.prototype.toRadix=Qe,h.prototype.fromRadix=At,h.prototype.fromNumber=Dt,h.prototype.bitwiseTo=Kt,h.prototype.changeBit=bt,h.prototype.addTo=bi,h.prototype.dMultiply=yn,h.prototype.dAddOffset=hn,h.prototype.multiplyLowerTo=Ze,h.prototype.multiplyUpperTo=Ge,h.prototype.modInt=ji,h.prototype.millerRabin=fi,h.prototype.clone=pe,h.prototype.intValue=re,h.prototype.byteValue=ke,h.prototype.shortValue=at,h.prototype.signum=rt,h.prototype.toByteArray=vt,h.prototype.equals=yt,h.prototype.min=jt,h.prototype.max=Wt,h.prototype.and=hi,h.prototype.or=Zi,h.prototype.xor=xt,h.prototype.andNot=W,h.prototype.not=X,h.prototype.shiftLeft=ae,h.prototype.shiftRight=_e,h.prototype.getLowestSetBit=We,h.prototype.bitCount=st,h.prototype.testBit=Xe,h.prototype.setBit=Ye,h.prototype.clearBit=dt,h.prototype.flipBit=Mt,h.prototype.add=ni,h.prototype.subtract=Ii,h.prototype.multiply=Nt,h.prototype.divide=Ki,h.prototype.remainder=Vi,h.prototype.divideAndRemainder=Ti,h.prototype.modPow=Ci,h.prototype.modInverse=Xi,h.prototype.pow=Pe,h.prototype.gcd=xi,h.prototype.isProbablePrime=Gi,h.prototype.square=Ri;var vi=h;vi.prototype.IsNegative=function(){return this.compareTo(vi.ZERO)==-1},vi.op_Equality=function(x,M){return x.compareTo(M)==0},vi.op_Inequality=function(x,M){return x.compareTo(M)!=0},vi.op_GreaterThan=function(x,M){return x.compareTo(M)>0},vi.op_LessThan=function(x,M){return x.compareTo(M)<0},vi.op_Addition=function(x,M){return new vi(x).add(new vi(M))},vi.op_Subtraction=function(x,M){return new vi(x).subtract(new vi(M))},vi.Int128Mul=function(x,M){return new vi(x).multiply(new vi(M))},vi.op_Division=function(x,M){return x.divide(M)},vi.prototype.ToDouble=function(){return parseFloat(this.toString())},typeof Li>"u"&&(Li=l(function(x,M){var P;if(typeof Object.getOwnPropertyNames>"u"){for(P in M.prototype)(typeof x.prototype[P]>"u"||x.prototype[P]==Object.prototype[P])&&(x.prototype[P]=M.prototype[P]);for(P in M)typeof x[P]>"u"&&(x[P]=M[P]);x.$baseCtor=M}else{for(var V=Object.getOwnPropertyNames(M.prototype),H=0;H<V.length;H++)typeof Object.getOwnPropertyDescriptor(x.prototype,V[H])>"u"&&Object.defineProperty(x.prototype,V[H],Object.getOwnPropertyDescriptor(M.prototype,V[H]));for(P in M)typeof x[P]>"u"&&(x[P]=M[P]);x.$baseCtor=M}},"Inherit"));var Li;n.Path=function(){return[]},n.Paths=function(){return[]},n.DoublePoint=function(){var x=arguments;this.X=0,this.Y=0,x.length==1?(this.X=x[0].X,this.Y=x[0].Y):x.length==2&&(this.X=x[0],this.Y=x[1])},n.DoublePoint0=function(){this.X=0,this.Y=0},n.DoublePoint1=function(x){this.X=x.X,this.Y=x.Y},n.DoublePoint2=function(x,M){this.X=x,this.Y=M},n.PolyNode=function(){this.m_Parent=null,this.m_polygon=new n.Path,this.m_Index=0,this.m_jointype=0,this.m_endtype=0,this.m_Childs=[],this.IsOpen=!1},n.PolyNode.prototype.IsHoleNode=function(){for(var x=!0,M=this.m_Parent;M!==null;)x=!x,M=M.m_Parent;return x},n.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length},n.PolyNode.prototype.Contour=function(){return this.m_polygon},n.PolyNode.prototype.AddChild=function(x){var M=this.m_Childs.length;this.m_Childs.push(x),x.m_Parent=this,x.m_Index=M},n.PolyNode.prototype.GetNext=function(){return this.m_Childs.length>0?this.m_Childs[0]:this.GetNextSiblingUp()},n.PolyNode.prototype.GetNextSiblingUp=function(){return this.m_Parent===null?null:this.m_Index==this.m_Parent.m_Childs.length-1?this.m_Parent.GetNextSiblingUp():this.m_Parent.m_Childs[this.m_Index+1]},n.PolyNode.prototype.Childs=function(){return this.m_Childs},n.PolyNode.prototype.Parent=function(){return this.m_Parent},n.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()},n.PolyTree=function(){this.m_AllPolys=[],n.PolyNode.call(this)},n.PolyTree.prototype.Clear=function(){for(var x=0,M=this.m_AllPolys.length;x<M;x++)this.m_AllPolys[x]=null;this.m_AllPolys.length=0,this.m_Childs.length=0},n.PolyTree.prototype.GetFirst=function(){return this.m_Childs.length>0?this.m_Childs[0]:null},n.PolyTree.prototype.Total=function(){return this.m_AllPolys.length},Li(n.PolyTree,n.PolyNode),n.Math_Abs_Int64=n.Math_Abs_Int32=n.Math_Abs_Double=function(x){return Math.abs(x)},n.Math_Max_Int32_Int32=function(x,M){return Math.max(x,M)},s.msie||s.opera||s.safari?n.Cast_Int32=function(x){return x|0}:n.Cast_Int32=function(x){return~~x},s.chrome?n.Cast_Int64=function(x){return x<-2147483648||x>2147483647?x<0?Math.ceil(x):Math.floor(x):~~x}:s.firefox&&typeof Number.toInteger=="function"?n.Cast_Int64=function(x){return Number.toInteger(x)}:s.msie7||s.msie8?n.Cast_Int64=function(x){return parseInt(x,10)}:s.msie?n.Cast_Int64=function(x){return x<-2147483648||x>2147483647?x<0?Math.ceil(x):Math.floor(x):x|0}:n.Cast_Int64=function(x){return x<0?Math.ceil(x):Math.floor(x)},n.Clear=function(x){x.length=0},n.PI=3.141592653589793,n.PI2=2*3.141592653589793,n.IntPoint=function(){var x=arguments,M=x.length,P,V;if(this.X=0,this.Y=0,!t)if(M==2)this.X=x[0],this.Y=x[1];else if(M==1)if(x[0]instanceof n.DoublePoint){var P=x[0];this.X=n.Clipper.Round(P.X),this.Y=n.Clipper.Round(P.Y)}else{var V=x[0];this.X=V.X,this.Y=V.Y}else this.X=0,this.Y=0},n.IntPoint.op_Equality=function(x,M){return x.X==M.X&&x.Y==M.Y},n.IntPoint.op_Inequality=function(x,M){return x.X!=M.X||x.Y!=M.Y},n.IntPoint0=function(){this.X=0,this.Y=0},n.IntPoint1=function(x){this.X=x.X,this.Y=x.Y},n.IntPoint1dp=function(x){this.X=n.Clipper.Round(x.X),this.Y=n.Clipper.Round(x.Y)},n.IntPoint2=function(x,M){this.X=x,this.Y=M},n.IntRect=function(){var x=arguments,M=x.length;M==4?(this.left=x[0],this.top=x[1],this.right=x[2],this.bottom=x[3]):M==1?(this.left=ir.left,this.top=ir.top,this.right=ir.right,this.bottom=ir.bottom):(this.left=0,this.top=0,this.right=0,this.bottom=0)},n.IntRect0=function(){this.left=0,this.top=0,this.right=0,this.bottom=0},n.IntRect1=function(x){this.left=x.left,this.top=x.top,this.right=x.right,this.bottom=x.bottom},n.IntRect4=function(x,M,P,V){this.left=x,this.top=M,this.right=P,this.bottom=V},n.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3},n.PolyType={ptSubject:0,ptClip:1},n.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3},n.JoinType={jtSquare:0,jtRound:1,jtMiter:2},n.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4},n.EdgeSide={esLeft:0,esRight:1},n.Direction={dRightToLeft:0,dLeftToRight:1},n.TEdge=function(){this.Bot=new n.IntPoint,this.Curr=new n.IntPoint,this.Top=new n.IntPoint,this.Delta=new n.IntPoint,this.Dx=0,this.PolyTyp=n.PolyType.ptSubject,this.Side=n.EdgeSide.esLeft,this.WindDelta=0,this.WindCnt=0,this.WindCnt2=0,this.OutIdx=0,this.Next=null,this.Prev=null,this.NextInLML=null,this.NextInAEL=null,this.PrevInAEL=null,this.NextInSEL=null,this.PrevInSEL=null},n.IntersectNode=function(){this.Edge1=null,this.Edge2=null,this.Pt=new n.IntPoint},n.MyIntersectNodeSort=function(){},n.MyIntersectNodeSort.Compare=function(x,M){return M.Pt.Y-x.Pt.Y},n.LocalMinima=function(){this.Y=0,this.LeftBound=null,this.RightBound=null,this.Next=null},n.Scanbeam=function(){this.Y=0,this.Next=null},n.OutRec=function(){this.Idx=0,this.IsHole=!1,this.IsOpen=!1,this.FirstLeft=null,this.Pts=null,this.BottomPt=null,this.PolyNode=null},n.OutPt=function(){this.Idx=0,this.Pt=new n.IntPoint,this.Next=null,this.Prev=null},n.Join=function(){this.OutPt1=null,this.OutPt2=null,this.OffPt=new n.IntPoint},n.ClipperBase=function(){this.m_MinimaList=null,this.m_CurrentLM=null,this.m_edges=new Array,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1,this.PreserveCollinear=!1,this.m_MinimaList=null,this.m_CurrentLM=null,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},n.ClipperBase.horizontal=-9007199254740992,n.ClipperBase.Skip=-2,n.ClipperBase.Unassigned=-1,n.ClipperBase.tolerance=1e-20,n.ClipperBase.loRange=47453132,n.ClipperBase.hiRange=0xfffffffffffff,n.ClipperBase.near_zero=function(x){return x>-n.ClipperBase.tolerance&&x<n.ClipperBase.tolerance},n.ClipperBase.IsHorizontal=function(x){return x.Delta.Y===0},n.ClipperBase.prototype.PointIsVertex=function(x,M){var P=M;do{if(n.IntPoint.op_Equality(P.Pt,x))return!0;P=P.Next}while(P!=M);return!1},n.ClipperBase.prototype.PointOnLineSegment=function(x,M,P,V){return V?x.X==M.X&&x.Y==M.Y||x.X==P.X&&x.Y==P.Y||x.X>M.X==x.X<P.X&&x.Y>M.Y==x.Y<P.Y&&vi.op_Equality(vi.Int128Mul(x.X-M.X,P.Y-M.Y),vi.Int128Mul(P.X-M.X,x.Y-M.Y)):x.X==M.X&&x.Y==M.Y||x.X==P.X&&x.Y==P.Y||x.X>M.X==x.X<P.X&&x.Y>M.Y==x.Y<P.Y&&(x.X-M.X)*(P.Y-M.Y)==(P.X-M.X)*(x.Y-M.Y)},n.ClipperBase.prototype.PointOnPolygon=function(x,M,P){for(var V=M;;){if(this.PointOnLineSegment(x,V.Pt,V.Next.Pt,P))return!0;if(V=V.Next,V==M)break}return!1},n.ClipperBase.prototype.SlopesEqual=n.ClipperBase.SlopesEqual=function(){var x=arguments,M=x.length,P,V,H,ne,le,ce,ze;return M==3?(P=x[0],V=x[1],ze=x[2],ze?vi.op_Equality(vi.Int128Mul(P.Delta.Y,V.Delta.X),vi.Int128Mul(P.Delta.X,V.Delta.Y)):n.Cast_Int64(P.Delta.Y*V.Delta.X)==n.Cast_Int64(P.Delta.X*V.Delta.Y)):M==4?(H=x[0],ne=x[1],le=x[2],ze=x[3],ze?vi.op_Equality(vi.Int128Mul(H.Y-ne.Y,ne.X-le.X),vi.Int128Mul(H.X-ne.X,ne.Y-le.Y)):n.Cast_Int64((H.Y-ne.Y)*(ne.X-le.X))-n.Cast_Int64((H.X-ne.X)*(ne.Y-le.Y))===0):(H=x[0],ne=x[1],le=x[2],ce=x[3],ze=x[4],ze?vi.op_Equality(vi.Int128Mul(H.Y-ne.Y,le.X-ce.X),vi.Int128Mul(H.X-ne.X,le.Y-ce.Y)):n.Cast_Int64((H.Y-ne.Y)*(le.X-ce.X))-n.Cast_Int64((H.X-ne.X)*(le.Y-ce.Y))===0)},n.ClipperBase.SlopesEqual3=function(x,M,P){return P?vi.op_Equality(vi.Int128Mul(x.Delta.Y,M.Delta.X),vi.Int128Mul(x.Delta.X,M.Delta.Y)):n.Cast_Int64(x.Delta.Y*M.Delta.X)==n.Cast_Int64(x.Delta.X*M.Delta.Y)},n.ClipperBase.SlopesEqual4=function(x,M,P,V){return V?vi.op_Equality(vi.Int128Mul(x.Y-M.Y,M.X-P.X),vi.Int128Mul(x.X-M.X,M.Y-P.Y)):n.Cast_Int64((x.Y-M.Y)*(M.X-P.X))-n.Cast_Int64((x.X-M.X)*(M.Y-P.Y))===0},n.ClipperBase.SlopesEqual5=function(x,M,P,V,H){return H?vi.op_Equality(vi.Int128Mul(x.Y-M.Y,P.X-V.X),vi.Int128Mul(x.X-M.X,P.Y-V.Y)):n.Cast_Int64((x.Y-M.Y)*(P.X-V.X))-n.Cast_Int64((x.X-M.X)*(P.Y-V.Y))===0},n.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var x=0,M=this.m_edges.length;x<M;++x){for(var P=0,V=this.m_edges[x].length;P<V;++P)this.m_edges[x][P]=null;n.Clear(this.m_edges[x])}n.Clear(this.m_edges),this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},n.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;this.m_MinimaList!==null;){var x=this.m_MinimaList.Next;this.m_MinimaList=null,this.m_MinimaList=x}this.m_CurrentLM=null},n.ClipperBase.prototype.RangeTest=function(x,M){M.Value?(x.X>n.ClipperBase.hiRange||x.Y>n.ClipperBase.hiRange||-x.X>n.ClipperBase.hiRange||-x.Y>n.ClipperBase.hiRange)&&n.Error("Coordinate outside allowed range in RangeTest()."):(x.X>n.ClipperBase.loRange||x.Y>n.ClipperBase.loRange||-x.X>n.ClipperBase.loRange||-x.Y>n.ClipperBase.loRange)&&(M.Value=!0,this.RangeTest(x,M))},n.ClipperBase.prototype.InitEdge=function(x,M,P,V){x.Next=M,x.Prev=P,x.Curr.X=V.X,x.Curr.Y=V.Y,x.OutIdx=-1},n.ClipperBase.prototype.InitEdge2=function(x,M){x.Curr.Y>=x.Next.Curr.Y?(x.Bot.X=x.Curr.X,x.Bot.Y=x.Curr.Y,x.Top.X=x.Next.Curr.X,x.Top.Y=x.Next.Curr.Y):(x.Top.X=x.Curr.X,x.Top.Y=x.Curr.Y,x.Bot.X=x.Next.Curr.X,x.Bot.Y=x.Next.Curr.Y),this.SetDx(x),x.PolyTyp=M},n.ClipperBase.prototype.FindNextLocMin=function(x){for(var M;;){for(;n.IntPoint.op_Inequality(x.Bot,x.Prev.Bot)||n.IntPoint.op_Equality(x.Curr,x.Top);)x=x.Next;if(x.Dx!=n.ClipperBase.horizontal&&x.Prev.Dx!=n.ClipperBase.horizontal)break;for(;x.Prev.Dx==n.ClipperBase.horizontal;)x=x.Prev;for(M=x;x.Dx==n.ClipperBase.horizontal;)x=x.Next;if(x.Top.Y!=x.Prev.Bot.Y){M.Prev.Bot.X<x.Bot.X&&(x=M);break}}return x},n.ClipperBase.prototype.ProcessBound=function(x,M){var P=x,V=x,H,ne;if(x.Dx==n.ClipperBase.horizontal&&(M?ne=x.Prev.Bot.X:ne=x.Next.Bot.X,x.Bot.X!=ne&&this.ReverseHorizontal(x)),V.OutIdx!=n.ClipperBase.Skip)if(M){for(;V.Top.Y==V.Next.Bot.Y&&V.Next.OutIdx!=n.ClipperBase.Skip;)V=V.Next;if(V.Dx==n.ClipperBase.horizontal&&V.Next.OutIdx!=n.ClipperBase.Skip){for(H=V;H.Prev.Dx==n.ClipperBase.horizontal;)H=H.Prev;H.Prev.Top.X==V.Next.Top.X?M||(V=H.Prev):H.Prev.Top.X>V.Next.Top.X&&(V=H.Prev)}for(;x!=V;)x.NextInLML=x.Next,x.Dx==n.ClipperBase.horizontal&&x!=P&&x.Bot.X!=x.Prev.Top.X&&this.ReverseHorizontal(x),x=x.Next;x.Dx==n.ClipperBase.horizontal&&x!=P&&x.Bot.X!=x.Prev.Top.X&&this.ReverseHorizontal(x),V=V.Next}else{for(;V.Top.Y==V.Prev.Bot.Y&&V.Prev.OutIdx!=n.ClipperBase.Skip;)V=V.Prev;if(V.Dx==n.ClipperBase.horizontal&&V.Prev.OutIdx!=n.ClipperBase.Skip){for(H=V;H.Next.Dx==n.ClipperBase.horizontal;)H=H.Next;H.Next.Top.X==V.Prev.Top.X?M||(V=H.Next):H.Next.Top.X>V.Prev.Top.X&&(V=H.Next)}for(;x!=V;)x.NextInLML=x.Prev,x.Dx==n.ClipperBase.horizontal&&x!=P&&x.Bot.X!=x.Next.Top.X&&this.ReverseHorizontal(x),x=x.Prev;x.Dx==n.ClipperBase.horizontal&&x!=P&&x.Bot.X!=x.Next.Top.X&&this.ReverseHorizontal(x),V=V.Prev}if(V.OutIdx==n.ClipperBase.Skip){if(x=V,M){for(;x.Top.Y==x.Next.Bot.Y;)x=x.Next;for(;x!=V&&x.Dx==n.ClipperBase.horizontal;)x=x.Prev}else{for(;x.Top.Y==x.Prev.Bot.Y;)x=x.Prev;for(;x!=V&&x.Dx==n.ClipperBase.horizontal;)x=x.Next}if(x==V)M?V=x.Next:V=x.Prev;else{M?x=V.Next:x=V.Prev;var le=new n.LocalMinima;le.Next=null,le.Y=x.Bot.Y,le.LeftBound=null,le.RightBound=x,le.RightBound.WindDelta=0,V=this.ProcessBound(le.RightBound,M),this.InsertLocalMinima(le)}}return V},n.ClipperBase.prototype.AddPath=function(x,M,P){!P&&M==n.PolyType.ptClip&&n.Error("AddPath: Open paths must be subject.");var V=x.length-1;if(P)for(;V>0&&n.IntPoint.op_Equality(x[V],x[0]);)--V;for(;V>0&&n.IntPoint.op_Equality(x[V],x[V-1]);)--V;if(P&&V<2||!P&&V<1)return!1;for(var H=new Array,ne=0;ne<=V;ne++)H.push(new n.TEdge);var le=!0;H[1].Curr.X=x[1].X,H[1].Curr.Y=x[1].Y;var ce={Value:this.m_UseFullRange};this.RangeTest(x[0],ce),this.m_UseFullRange=ce.Value,ce.Value=this.m_UseFullRange,this.RangeTest(x[V],ce),this.m_UseFullRange=ce.Value,this.InitEdge(H[0],H[1],H[V],x[0]),this.InitEdge(H[V],H[0],H[V-1],x[V]);for(var ne=V-1;ne>=1;--ne)ce.Value=this.m_UseFullRange,this.RangeTest(x[ne],ce),this.m_UseFullRange=ce.Value,this.InitEdge(H[ne],H[ne+1],H[ne-1],x[ne]);for(var ze=H[0],qe=ze,mt=ze;;){if(n.IntPoint.op_Equality(qe.Curr,qe.Next.Curr)){if(qe==qe.Next)break;qe==ze&&(ze=qe.Next),qe=this.RemoveEdge(qe),mt=qe;continue}if(qe.Prev==qe.Next)break;if(P&&n.ClipperBase.SlopesEqual(qe.Prev.Curr,qe.Curr,qe.Next.Curr,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(qe.Prev.Curr,qe.Curr,qe.Next.Curr))){qe==ze&&(ze=qe.Next),qe=this.RemoveEdge(qe),qe=qe.Prev,mt=qe;continue}if(qe=qe.Next,qe==mt)break}if(!P&&qe==qe.Next||P&&qe.Prev==qe.Next)return!1;P||(this.m_HasOpenPaths=!0,ze.Prev.OutIdx=n.ClipperBase.Skip),qe=ze;do this.InitEdge2(qe,M),qe=qe.Next,le&&qe.Curr.Y!=ze.Curr.Y&&(le=!1);while(qe!=ze);if(le){if(P)return!1;qe.Prev.OutIdx=n.ClipperBase.Skip,qe.Prev.Bot.X<qe.Prev.Top.X&&this.ReverseHorizontal(qe.Prev);var Ct=new n.LocalMinima;for(Ct.Next=null,Ct.Y=qe.Bot.Y,Ct.LeftBound=null,Ct.RightBound=qe,Ct.RightBound.Side=n.EdgeSide.esRight,Ct.RightBound.WindDelta=0;qe.Next.OutIdx!=n.ClipperBase.Skip;)qe.NextInLML=qe.Next,qe.Bot.X!=qe.Prev.Top.X&&this.ReverseHorizontal(qe),qe=qe.Next;return this.InsertLocalMinima(Ct),this.m_edges.push(H),!0}this.m_edges.push(H);for(var Bt,Ut=null;qe=this.FindNextLocMin(qe),qe!=Ut;){Ut==null&&(Ut=qe);var Ct=new n.LocalMinima;Ct.Next=null,Ct.Y=qe.Bot.Y,qe.Dx<qe.Prev.Dx?(Ct.LeftBound=qe.Prev,Ct.RightBound=qe,Bt=!1):(Ct.LeftBound=qe,Ct.RightBound=qe.Prev,Bt=!0),Ct.LeftBound.Side=n.EdgeSide.esLeft,Ct.RightBound.Side=n.EdgeSide.esRight,P?Ct.LeftBound.Next==Ct.RightBound?Ct.LeftBound.WindDelta=-1:Ct.LeftBound.WindDelta=1:Ct.LeftBound.WindDelta=0,Ct.RightBound.WindDelta=-Ct.LeftBound.WindDelta,qe=this.ProcessBound(Ct.LeftBound,Bt);var It=this.ProcessBound(Ct.RightBound,!Bt);Ct.LeftBound.OutIdx==n.ClipperBase.Skip?Ct.LeftBound=null:Ct.RightBound.OutIdx==n.ClipperBase.Skip&&(Ct.RightBound=null),this.InsertLocalMinima(Ct),Bt||(qe=It)}return!0},n.ClipperBase.prototype.AddPaths=function(x,M,P){for(var V=!1,H=0,ne=x.length;H<ne;++H)this.AddPath(x[H],M,P)&&(V=!0);return V},n.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=function(x,M,P){return n.IntPoint.op_Equality(x,P)||n.IntPoint.op_Equality(x,M)||n.IntPoint.op_Equality(P,M)?!1:x.X!=P.X?M.X>x.X==M.X<P.X:M.Y>x.Y==M.Y<P.Y},n.ClipperBase.prototype.RemoveEdge=function(x){x.Prev.Next=x.Next,x.Next.Prev=x.Prev;var M=x.Next;return x.Prev=null,M},n.ClipperBase.prototype.SetDx=function(x){x.Delta.X=x.Top.X-x.Bot.X,x.Delta.Y=x.Top.Y-x.Bot.Y,x.Delta.Y===0?x.Dx=n.ClipperBase.horizontal:x.Dx=x.Delta.X/x.Delta.Y},n.ClipperBase.prototype.InsertLocalMinima=function(x){if(this.m_MinimaList===null)this.m_MinimaList=x;else if(x.Y>=this.m_MinimaList.Y)x.Next=this.m_MinimaList,this.m_MinimaList=x;else{for(var M=this.m_MinimaList;M.Next!==null&&x.Y<M.Next.Y;)M=M.Next;x.Next=M.Next,M.Next=x}},n.ClipperBase.prototype.PopLocalMinima=function(){this.m_CurrentLM!==null&&(this.m_CurrentLM=this.m_CurrentLM.Next)},n.ClipperBase.prototype.ReverseHorizontal=function(x){var M=x.Top.X;x.Top.X=x.Bot.X,x.Bot.X=M},n.ClipperBase.prototype.Reset=function(){if(this.m_CurrentLM=this.m_MinimaList,this.m_CurrentLM!=null)for(var x=this.m_MinimaList;x!=null;){var M=x.LeftBound;M!=null&&(M.Curr.X=M.Bot.X,M.Curr.Y=M.Bot.Y,M.Side=n.EdgeSide.esLeft,M.OutIdx=n.ClipperBase.Unassigned),M=x.RightBound,M!=null&&(M.Curr.X=M.Bot.X,M.Curr.Y=M.Bot.Y,M.Side=n.EdgeSide.esRight,M.OutIdx=n.ClipperBase.Unassigned),x=x.Next}},n.Clipper=function(x){typeof x>"u"&&(x=0),this.m_PolyOuts=null,this.m_ClipType=n.ClipType.ctIntersection,this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=null,this.m_IntersectNodeComparer=null,this.m_ExecuteLocked=!1,this.m_ClipFillType=n.PolyFillType.pftEvenOdd,this.m_SubjFillType=n.PolyFillType.pftEvenOdd,this.m_Joins=null,this.m_GhostJoins=null,this.m_UsingPolyTree=!1,this.ReverseSolution=!1,this.StrictlySimple=!1,n.ClipperBase.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=new Array,this.m_IntersectNodeComparer=n.MyIntersectNodeSort.Compare,this.m_ExecuteLocked=!1,this.m_UsingPolyTree=!1,this.m_PolyOuts=new Array,this.m_Joins=new Array,this.m_GhostJoins=new Array,this.ReverseSolution=(1&x)!==0,this.StrictlySimple=(2&x)!==0,this.PreserveCollinear=(4&x)!==0},n.Clipper.ioReverseSolution=1,n.Clipper.ioStrictlySimple=2,n.Clipper.ioPreserveCollinear=4,n.Clipper.prototype.Clear=function(){this.m_edges.length!==0&&(this.DisposeAllPolyPts(),n.ClipperBase.prototype.Clear.call(this))},n.Clipper.prototype.DisposeScanbeamList=function(){for(;this.m_Scanbeam!==null;){var x=this.m_Scanbeam.Next;this.m_Scanbeam=null,this.m_Scanbeam=x}},n.Clipper.prototype.Reset=function(){n.ClipperBase.prototype.Reset.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null;for(var x=this.m_MinimaList;x!==null;)this.InsertScanbeam(x.Y),x=x.Next},n.Clipper.prototype.InsertScanbeam=function(x){if(this.m_Scanbeam===null)this.m_Scanbeam=new n.Scanbeam,this.m_Scanbeam.Next=null,this.m_Scanbeam.Y=x;else if(x>this.m_Scanbeam.Y){var M=new n.Scanbeam;M.Y=x,M.Next=this.m_Scanbeam,this.m_Scanbeam=M}else{for(var P=this.m_Scanbeam;P.Next!==null&&x<=P.Next.Y;)P=P.Next;if(x==P.Y)return;var M=new n.Scanbeam;M.Y=x,M.Next=P.Next,P.Next=M}},n.Clipper.prototype.Execute=function(){var x=arguments,M=x.length,P=x[1]instanceof n.PolyTree;if(M==4&&!P){var V=x[0],H=x[1],ne=x[2],le=x[3];if(this.m_ExecuteLocked)return!1;this.m_HasOpenPaths&&n.Error("Error: PolyTree struct is need for open path clipping."),this.m_ExecuteLocked=!0,n.Clear(H),this.m_SubjFillType=ne,this.m_ClipFillType=le,this.m_ClipType=V,this.m_UsingPolyTree=!1;try{var ce=this.ExecuteInternal();ce&&this.BuildResult(H)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return ce}else if(M==4&&P){var V=x[0],ze=x[1],ne=x[2],le=x[3];if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0,this.m_SubjFillType=ne,this.m_ClipFillType=le,this.m_ClipType=V,this.m_UsingPolyTree=!0;try{var ce=this.ExecuteInternal();ce&&this.BuildResult2(ze)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return ce}else if(M==2&&!P){var V=x[0],H=x[1];return this.Execute(V,H,n.PolyFillType.pftEvenOdd,n.PolyFillType.pftEvenOdd)}else if(M==2&&P){var V=x[0],ze=x[1];return this.Execute(V,ze,n.PolyFillType.pftEvenOdd,n.PolyFillType.pftEvenOdd)}},n.Clipper.prototype.FixHoleLinkage=function(x){if(!(x.FirstLeft===null||x.IsHole!=x.FirstLeft.IsHole&&x.FirstLeft.Pts!==null)){for(var M=x.FirstLeft;M!==null&&(M.IsHole==x.IsHole||M.Pts===null);)M=M.FirstLeft;x.FirstLeft=M}},n.Clipper.prototype.ExecuteInternal=function(){try{if(this.Reset(),this.m_CurrentLM===null)return!1;var x=this.PopScanbeam();do{if(this.InsertLocalMinimaIntoAEL(x),n.Clear(this.m_GhostJoins),this.ProcessHorizontals(!1),this.m_Scanbeam===null)break;var M=this.PopScanbeam();if(!this.ProcessIntersections(x,M))return!1;this.ProcessEdgesAtTopOfScanbeam(M),x=M}while(this.m_Scanbeam!==null||this.m_CurrentLM!==null);for(var P=0,V=this.m_PolyOuts.length;P<V;P++){var H=this.m_PolyOuts[P];H.Pts===null||H.IsOpen||(H.IsHole^this.ReverseSolution)==this.Area(H)>0&&this.ReversePolyPtLinks(H.Pts)}this.JoinCommonEdges();for(var P=0,V=this.m_PolyOuts.length;P<V;P++){var H=this.m_PolyOuts[P];H.Pts!==null&&!H.IsOpen&&this.FixupOutPolygon(H)}return this.StrictlySimple&&this.DoSimplePolygons(),!0}finally{n.Clear(this.m_Joins),n.Clear(this.m_GhostJoins)}},n.Clipper.prototype.PopScanbeam=function(){var x=this.m_Scanbeam.Y;return this.m_Scanbeam,this.m_Scanbeam=this.m_Scanbeam.Next,x},n.Clipper.prototype.DisposeAllPolyPts=function(){for(var x=0,M=this.m_PolyOuts.length;x<M;++x)this.DisposeOutRec(x);n.Clear(this.m_PolyOuts)},n.Clipper.prototype.DisposeOutRec=function(x){var M=this.m_PolyOuts[x];M.Pts!==null&&this.DisposeOutPts(M.Pts),M=null,this.m_PolyOuts[x]=null},n.Clipper.prototype.DisposeOutPts=function(x){if(x!==null)for(x.Prev.Next=null;x!==null;)x=x.Next},n.Clipper.prototype.AddJoin=function(x,M,P){var V=new n.Join;V.OutPt1=x,V.OutPt2=M,V.OffPt.X=P.X,V.OffPt.Y=P.Y,this.m_Joins.push(V)},n.Clipper.prototype.AddGhostJoin=function(x,M){var P=new n.Join;P.OutPt1=x,P.OffPt.X=M.X,P.OffPt.Y=M.Y,this.m_GhostJoins.push(P)},n.Clipper.prototype.InsertLocalMinimaIntoAEL=function(x){for(;this.m_CurrentLM!==null&&this.m_CurrentLM.Y==x;){var M=this.m_CurrentLM.LeftBound,P=this.m_CurrentLM.RightBound;this.PopLocalMinima();var V=null;if(M===null?(this.InsertEdgeIntoAEL(P,null),this.SetWindingCount(P),this.IsContributing(P)&&(V=this.AddOutPt(P,P.Bot))):P==null?(this.InsertEdgeIntoAEL(M,null),this.SetWindingCount(M),this.IsContributing(M)&&(V=this.AddOutPt(M,M.Bot)),this.InsertScanbeam(M.Top.Y)):(this.InsertEdgeIntoAEL(M,null),this.InsertEdgeIntoAEL(P,M),this.SetWindingCount(M),P.WindCnt=M.WindCnt,P.WindCnt2=M.WindCnt2,this.IsContributing(M)&&(V=this.AddLocalMinPoly(M,P,M.Bot)),this.InsertScanbeam(M.Top.Y)),P!=null&&(n.ClipperBase.IsHorizontal(P)?this.AddEdgeToSEL(P):this.InsertScanbeam(P.Top.Y)),!(M==null||P==null)){if(V!==null&&n.ClipperBase.IsHorizontal(P)&&this.m_GhostJoins.length>0&&P.WindDelta!==0)for(var H=0,ne=this.m_GhostJoins.length;H<ne;H++){var le=this.m_GhostJoins[H];this.HorzSegmentsOverlap(le.OutPt1.Pt,le.OffPt,P.Bot,P.Top)&&this.AddJoin(le.OutPt1,V,le.OffPt)}if(M.OutIdx>=0&&M.PrevInAEL!==null&&M.PrevInAEL.Curr.X==M.Bot.X&&M.PrevInAEL.OutIdx>=0&&n.ClipperBase.SlopesEqual(M.PrevInAEL,M,this.m_UseFullRange)&&M.WindDelta!==0&&M.PrevInAEL.WindDelta!==0){var ce=this.AddOutPt(M.PrevInAEL,M.Bot);this.AddJoin(V,ce,M.Top)}if(M.NextInAEL!=P){if(P.OutIdx>=0&&P.PrevInAEL.OutIdx>=0&&n.ClipperBase.SlopesEqual(P.PrevInAEL,P,this.m_UseFullRange)&&P.WindDelta!==0&&P.PrevInAEL.WindDelta!==0){var ce=this.AddOutPt(P.PrevInAEL,P.Bot);this.AddJoin(V,ce,P.Top)}var ze=M.NextInAEL;if(ze!==null)for(;ze!=P;)this.IntersectEdges(P,ze,M.Curr,!1),ze=ze.NextInAEL}}}},n.Clipper.prototype.InsertEdgeIntoAEL=function(x,M){if(this.m_ActiveEdges===null)x.PrevInAEL=null,x.NextInAEL=null,this.m_ActiveEdges=x;else if(M===null&&this.E2InsertsBeforeE1(this.m_ActiveEdges,x))x.PrevInAEL=null,x.NextInAEL=this.m_ActiveEdges,this.m_ActiveEdges.PrevInAEL=x,this.m_ActiveEdges=x;else{for(M===null&&(M=this.m_ActiveEdges);M.NextInAEL!==null&&!this.E2InsertsBeforeE1(M.NextInAEL,x);)M=M.NextInAEL;x.NextInAEL=M.NextInAEL,M.NextInAEL!==null&&(M.NextInAEL.PrevInAEL=x),x.PrevInAEL=M,M.NextInAEL=x}},n.Clipper.prototype.E2InsertsBeforeE1=function(x,M){return M.Curr.X==x.Curr.X?M.Top.Y>x.Top.Y?M.Top.X<n.Clipper.TopX(x,M.Top.Y):x.Top.X>n.Clipper.TopX(M,x.Top.Y):M.Curr.X<x.Curr.X},n.Clipper.prototype.IsEvenOddFillType=function(x){return x.PolyTyp==n.PolyType.ptSubject?this.m_SubjFillType==n.PolyFillType.pftEvenOdd:this.m_ClipFillType==n.PolyFillType.pftEvenOdd},n.Clipper.prototype.IsEvenOddAltFillType=function(x){return x.PolyTyp==n.PolyType.ptSubject?this.m_ClipFillType==n.PolyFillType.pftEvenOdd:this.m_SubjFillType==n.PolyFillType.pftEvenOdd},n.Clipper.prototype.IsContributing=function(x){var M,P;switch(x.PolyTyp==n.PolyType.ptSubject?(M=this.m_SubjFillType,P=this.m_ClipFillType):(M=this.m_ClipFillType,P=this.m_SubjFillType),M){case n.PolyFillType.pftEvenOdd:if(x.WindDelta===0&&x.WindCnt!=1)return!1;break;case n.PolyFillType.pftNonZero:if(Math.abs(x.WindCnt)!=1)return!1;break;case n.PolyFillType.pftPositive:if(x.WindCnt!=1)return!1;break;default:if(x.WindCnt!=-1)return!1;break}switch(this.m_ClipType){case n.ClipType.ctIntersection:switch(P){case n.PolyFillType.pftEvenOdd:case n.PolyFillType.pftNonZero:return x.WindCnt2!==0;case n.PolyFillType.pftPositive:return x.WindCnt2>0;default:return x.WindCnt2<0}case n.ClipType.ctUnion:switch(P){case n.PolyFillType.pftEvenOdd:case n.PolyFillType.pftNonZero:return x.WindCnt2===0;case n.PolyFillType.pftPositive:return x.WindCnt2<=0;default:return x.WindCnt2>=0}case n.ClipType.ctDifference:if(x.PolyTyp==n.PolyType.ptSubject)switch(P){case n.PolyFillType.pftEvenOdd:case n.PolyFillType.pftNonZero:return x.WindCnt2===0;case n.PolyFillType.pftPositive:return x.WindCnt2<=0;default:return x.WindCnt2>=0}else switch(P){case n.PolyFillType.pftEvenOdd:case n.PolyFillType.pftNonZero:return x.WindCnt2!==0;case n.PolyFillType.pftPositive:return x.WindCnt2>0;default:return x.WindCnt2<0}case n.ClipType.ctXor:if(x.WindDelta===0)switch(P){case n.PolyFillType.pftEvenOdd:case n.PolyFillType.pftNonZero:return x.WindCnt2===0;case n.PolyFillType.pftPositive:return x.WindCnt2<=0;default:return x.WindCnt2>=0}else return!0}return!0},n.Clipper.prototype.SetWindingCount=function(x){for(var M=x.PrevInAEL;M!==null&&(M.PolyTyp!=x.PolyTyp||M.WindDelta===0);)M=M.PrevInAEL;if(M===null)x.WindCnt=x.WindDelta===0?1:x.WindDelta,x.WindCnt2=0,M=this.m_ActiveEdges;else if(x.WindDelta===0&&this.m_ClipType!=n.ClipType.ctUnion)x.WindCnt=1,x.WindCnt2=M.WindCnt2,M=M.NextInAEL;else if(this.IsEvenOddFillType(x)){if(x.WindDelta===0){for(var P=!0,V=M.PrevInAEL;V!==null;)V.PolyTyp==M.PolyTyp&&V.WindDelta!==0&&(P=!P),V=V.PrevInAEL;x.WindCnt=P?0:1}else x.WindCnt=x.WindDelta;x.WindCnt2=M.WindCnt2,M=M.NextInAEL}else M.WindCnt*M.WindDelta<0?Math.abs(M.WindCnt)>1?M.WindDelta*x.WindDelta<0?x.WindCnt=M.WindCnt:x.WindCnt=M.WindCnt+x.WindDelta:x.WindCnt=x.WindDelta===0?1:x.WindDelta:x.WindDelta===0?x.WindCnt=M.WindCnt<0?M.WindCnt-1:M.WindCnt+1:M.WindDelta*x.WindDelta<0?x.WindCnt=M.WindCnt:x.WindCnt=M.WindCnt+x.WindDelta,x.WindCnt2=M.WindCnt2,M=M.NextInAEL;if(this.IsEvenOddAltFillType(x))for(;M!=x;)M.WindDelta!==0&&(x.WindCnt2=x.WindCnt2===0?1:0),M=M.NextInAEL;else for(;M!=x;)x.WindCnt2+=M.WindDelta,M=M.NextInAEL},n.Clipper.prototype.AddEdgeToSEL=function(x){this.m_SortedEdges===null?(this.m_SortedEdges=x,x.PrevInSEL=null,x.NextInSEL=null):(x.NextInSEL=this.m_SortedEdges,x.PrevInSEL=null,this.m_SortedEdges.PrevInSEL=x,this.m_SortedEdges=x)},n.Clipper.prototype.CopyAELToSEL=function(){var x=this.m_ActiveEdges;for(this.m_SortedEdges=x;x!==null;)x.PrevInSEL=x.PrevInAEL,x.NextInSEL=x.NextInAEL,x=x.NextInAEL},n.Clipper.prototype.SwapPositionsInAEL=function(x,M){if(!(x.NextInAEL==x.PrevInAEL||M.NextInAEL==M.PrevInAEL)){if(x.NextInAEL==M){var P=M.NextInAEL;P!==null&&(P.PrevInAEL=x);var V=x.PrevInAEL;V!==null&&(V.NextInAEL=M),M.PrevInAEL=V,M.NextInAEL=x,x.PrevInAEL=M,x.NextInAEL=P}else if(M.NextInAEL==x){var P=x.NextInAEL;P!==null&&(P.PrevInAEL=M);var V=M.PrevInAEL;V!==null&&(V.NextInAEL=x),x.PrevInAEL=V,x.NextInAEL=M,M.PrevInAEL=x,M.NextInAEL=P}else{var P=x.NextInAEL,V=x.PrevInAEL;x.NextInAEL=M.NextInAEL,x.NextInAEL!==null&&(x.NextInAEL.PrevInAEL=x),x.PrevInAEL=M.PrevInAEL,x.PrevInAEL!==null&&(x.PrevInAEL.NextInAEL=x),M.NextInAEL=P,M.NextInAEL!==null&&(M.NextInAEL.PrevInAEL=M),M.PrevInAEL=V,M.PrevInAEL!==null&&(M.PrevInAEL.NextInAEL=M)}x.PrevInAEL===null?this.m_ActiveEdges=x:M.PrevInAEL===null&&(this.m_ActiveEdges=M)}},n.Clipper.prototype.SwapPositionsInSEL=function(x,M){if(!(x.NextInSEL===null&&x.PrevInSEL===null)&&!(M.NextInSEL===null&&M.PrevInSEL===null)){if(x.NextInSEL==M){var P=M.NextInSEL;P!==null&&(P.PrevInSEL=x);var V=x.PrevInSEL;V!==null&&(V.NextInSEL=M),M.PrevInSEL=V,M.NextInSEL=x,x.PrevInSEL=M,x.NextInSEL=P}else if(M.NextInSEL==x){var P=x.NextInSEL;P!==null&&(P.PrevInSEL=M);var V=M.PrevInSEL;V!==null&&(V.NextInSEL=x),x.PrevInSEL=V,x.NextInSEL=M,M.PrevInSEL=x,M.NextInSEL=P}else{var P=x.NextInSEL,V=x.PrevInSEL;x.NextInSEL=M.NextInSEL,x.NextInSEL!==null&&(x.NextInSEL.PrevInSEL=x),x.PrevInSEL=M.PrevInSEL,x.PrevInSEL!==null&&(x.PrevInSEL.NextInSEL=x),M.NextInSEL=P,M.NextInSEL!==null&&(M.NextInSEL.PrevInSEL=M),M.PrevInSEL=V,M.PrevInSEL!==null&&(M.PrevInSEL.NextInSEL=M)}x.PrevInSEL===null?this.m_SortedEdges=x:M.PrevInSEL===null&&(this.m_SortedEdges=M)}},n.Clipper.prototype.AddLocalMaxPoly=function(x,M,P){this.AddOutPt(x,P),M.WindDelta==0&&this.AddOutPt(M,P),x.OutIdx==M.OutIdx?(x.OutIdx=-1,M.OutIdx=-1):x.OutIdx<M.OutIdx?this.AppendPolygon(x,M):this.AppendPolygon(M,x)},n.Clipper.prototype.AddLocalMinPoly=function(x,M,P){var V,H,ne;if(n.ClipperBase.IsHorizontal(M)||x.Dx>M.Dx?(V=this.AddOutPt(x,P),M.OutIdx=x.OutIdx,x.Side=n.EdgeSide.esLeft,M.Side=n.EdgeSide.esRight,H=x,H.PrevInAEL==M?ne=M.PrevInAEL:ne=H.PrevInAEL):(V=this.AddOutPt(M,P),x.OutIdx=M.OutIdx,x.Side=n.EdgeSide.esRight,M.Side=n.EdgeSide.esLeft,H=M,H.PrevInAEL==x?ne=x.PrevInAEL:ne=H.PrevInAEL),ne!==null&&ne.OutIdx>=0&&n.Clipper.TopX(ne,P.Y)==n.Clipper.TopX(H,P.Y)&&n.ClipperBase.SlopesEqual(H,ne,this.m_UseFullRange)&&H.WindDelta!==0&&ne.WindDelta!==0){var le=this.AddOutPt(ne,P);this.AddJoin(V,le,H.Top)}return V},n.Clipper.prototype.CreateOutRec=function(){var x=new n.OutRec;return x.Idx=-1,x.IsHole=!1,x.IsOpen=!1,x.FirstLeft=null,x.Pts=null,x.BottomPt=null,x.PolyNode=null,this.m_PolyOuts.push(x),x.Idx=this.m_PolyOuts.length-1,x},n.Clipper.prototype.AddOutPt=function(x,M){var P=x.Side==n.EdgeSide.esLeft;if(x.OutIdx<0){var V=this.CreateOutRec();V.IsOpen=x.WindDelta===0;var H=new n.OutPt;return V.Pts=H,H.Idx=V.Idx,H.Pt.X=M.X,H.Pt.Y=M.Y,H.Next=H,H.Prev=H,V.IsOpen||this.SetHoleState(x,V),x.OutIdx=V.Idx,H}else{var V=this.m_PolyOuts[x.OutIdx],ne=V.Pts;if(P&&n.IntPoint.op_Equality(M,ne.Pt))return ne;if(!P&&n.IntPoint.op_Equality(M,ne.Prev.Pt))return ne.Prev;var H=new n.OutPt;return H.Idx=V.Idx,H.Pt.X=M.X,H.Pt.Y=M.Y,H.Next=ne,H.Prev=ne.Prev,H.Prev.Next=H,ne.Prev=H,P&&(V.Pts=H),H}},n.Clipper.prototype.SwapPoints=function(x,M){var P=new n.IntPoint(x.Value);x.Value.X=M.Value.X,x.Value.Y=M.Value.Y,M.Value.X=P.X,M.Value.Y=P.Y},n.Clipper.prototype.HorzSegmentsOverlap=function(x,M,P,V){return x.X>P.X==x.X<V.X||M.X>P.X==M.X<V.X||P.X>x.X==P.X<M.X||V.X>x.X==V.X<M.X||x.X==P.X&&M.X==V.X?!0:x.X==V.X&&M.X==P.X},n.Clipper.prototype.InsertPolyPtBetween=function(x,M,P){var V=new n.OutPt;return V.Pt.X=P.X,V.Pt.Y=P.Y,M==x.Next?(x.Next=V,M.Prev=V,V.Next=M,V.Prev=x):(M.Next=V,x.Prev=V,V.Next=x,V.Prev=M),V},n.Clipper.prototype.SetHoleState=function(x,M){for(var P=!1,V=x.PrevInAEL;V!==null;)V.OutIdx>=0&&V.WindDelta!=0&&(P=!P,M.FirstLeft===null&&(M.FirstLeft=this.m_PolyOuts[V.OutIdx])),V=V.PrevInAEL;P&&(M.IsHole=!0)},n.Clipper.prototype.GetDx=function(x,M){return x.Y==M.Y?n.ClipperBase.horizontal:(M.X-x.X)/(M.Y-x.Y)},n.Clipper.prototype.FirstIsBottomPt=function(x,M){for(var P=x.Prev;n.IntPoint.op_Equality(P.Pt,x.Pt)&&P!=x;)P=P.Prev;var V=Math.abs(this.GetDx(x.Pt,P.Pt));for(P=x.Next;n.IntPoint.op_Equality(P.Pt,x.Pt)&&P!=x;)P=P.Next;var H=Math.abs(this.GetDx(x.Pt,P.Pt));for(P=M.Prev;n.IntPoint.op_Equality(P.Pt,M.Pt)&&P!=M;)P=P.Prev;var ne=Math.abs(this.GetDx(M.Pt,P.Pt));for(P=M.Next;n.IntPoint.op_Equality(P.Pt,M.Pt)&&P!=M;)P=P.Next;var le=Math.abs(this.GetDx(M.Pt,P.Pt));return V>=ne&&V>=le||H>=ne&&H>=le},n.Clipper.prototype.GetBottomPt=function(x){for(var M=null,P=x.Next;P!=x;)P.Pt.Y>x.Pt.Y?(x=P,M=null):P.Pt.Y==x.Pt.Y&&P.Pt.X<=x.Pt.X&&(P.Pt.X<x.Pt.X?(M=null,x=P):P.Next!=x&&P.Prev!=x&&(M=P)),P=P.Next;if(M!==null)for(;M!=P;)for(this.FirstIsBottomPt(P,M)||(x=M),M=M.Next;n.IntPoint.op_Inequality(M.Pt,x.Pt);)M=M.Next;return x},n.Clipper.prototype.GetLowermostRec=function(x,M){x.BottomPt===null&&(x.BottomPt=this.GetBottomPt(x.Pts)),M.BottomPt===null&&(M.BottomPt=this.GetBottomPt(M.Pts));var P=x.BottomPt,V=M.BottomPt;return P.Pt.Y>V.Pt.Y?x:P.Pt.Y<V.Pt.Y?M:P.Pt.X<V.Pt.X?x:P.Pt.X>V.Pt.X||P.Next==P?M:V.Next==V||this.FirstIsBottomPt(P,V)?x:M},n.Clipper.prototype.Param1RightOfParam2=function(x,M){do if(x=x.FirstLeft,x==M)return!0;while(x!==null);return!1},n.Clipper.prototype.GetOutRec=function(x){for(var M=this.m_PolyOuts[x];M!=this.m_PolyOuts[M.Idx];)M=this.m_PolyOuts[M.Idx];return M},n.Clipper.prototype.AppendPolygon=function(x,M){var P=this.m_PolyOuts[x.OutIdx],V=this.m_PolyOuts[M.OutIdx],H;this.Param1RightOfParam2(P,V)?H=V:this.Param1RightOfParam2(V,P)?H=P:H=this.GetLowermostRec(P,V);var ne=P.Pts,le=ne.Prev,ce=V.Pts,ze=ce.Prev,qe;x.Side==n.EdgeSide.esLeft?(M.Side==n.EdgeSide.esLeft?(this.ReversePolyPtLinks(ce),ce.Next=ne,ne.Prev=ce,le.Next=ze,ze.Prev=le,P.Pts=ze):(ze.Next=ne,ne.Prev=ze,ce.Prev=le,le.Next=ce,P.Pts=ce),qe=n.EdgeSide.esLeft):(M.Side==n.EdgeSide.esRight?(this.ReversePolyPtLinks(ce),le.Next=ze,ze.Prev=le,ce.Next=ne,ne.Prev=ce):(le.Next=ce,ce.Prev=le,ne.Prev=ze,ze.Next=ne),qe=n.EdgeSide.esRight),P.BottomPt=null,H==V&&(V.FirstLeft!=P&&(P.FirstLeft=V.FirstLeft),P.IsHole=V.IsHole),V.Pts=null,V.BottomPt=null,V.FirstLeft=P;var mt=x.OutIdx,Ct=M.OutIdx;x.OutIdx=-1,M.OutIdx=-1;for(var Bt=this.m_ActiveEdges;Bt!==null;){if(Bt.OutIdx==Ct){Bt.OutIdx=mt,Bt.Side=qe;break}Bt=Bt.NextInAEL}V.Idx=P.Idx},n.Clipper.prototype.ReversePolyPtLinks=function(x){if(x!==null){var M,P;M=x;do P=M.Next,M.Next=M.Prev,M.Prev=P,M=P;while(M!=x)}},n.Clipper.SwapSides=function(x,M){var P=x.Side;x.Side=M.Side,M.Side=P},n.Clipper.SwapPolyIndexes=function(x,M){var P=x.OutIdx;x.OutIdx=M.OutIdx,M.OutIdx=P},n.Clipper.prototype.IntersectEdges=function(x,M,P,V){var H=!V&&x.NextInLML===null&&x.Top.X==P.X&&x.Top.Y==P.Y,ne=!V&&M.NextInLML===null&&M.Top.X==P.X&&M.Top.Y==P.Y,le=x.OutIdx>=0,ce=M.OutIdx>=0;if(x.WindDelta===0||M.WindDelta===0){x.WindDelta===0&&M.WindDelta===0?(H||ne)&&le&&ce&&this.AddLocalMaxPoly(x,M,P):x.PolyTyp==M.PolyTyp&&x.WindDelta!=M.WindDelta&&this.m_ClipType==n.ClipType.ctUnion?x.WindDelta===0?ce&&(this.AddOutPt(x,P),le&&(x.OutIdx=-1)):le&&(this.AddOutPt(M,P),ce&&(M.OutIdx=-1)):x.PolyTyp!=M.PolyTyp&&(x.WindDelta===0&&Math.abs(M.WindCnt)==1&&(this.m_ClipType!=n.ClipType.ctUnion||M.WindCnt2===0)?(this.AddOutPt(x,P),le&&(x.OutIdx=-1)):M.WindDelta===0&&Math.abs(x.WindCnt)==1&&(this.m_ClipType!=n.ClipType.ctUnion||x.WindCnt2===0)&&(this.AddOutPt(M,P),ce&&(M.OutIdx=-1))),H&&(x.OutIdx<0?this.DeleteFromAEL(x):n.Error("Error intersecting polylines")),ne&&(M.OutIdx<0?this.DeleteFromAEL(M):n.Error("Error intersecting polylines"));return}if(x.PolyTyp==M.PolyTyp)if(this.IsEvenOddFillType(x)){var ze=x.WindCnt;x.WindCnt=M.WindCnt,M.WindCnt=ze}else x.WindCnt+M.WindDelta===0?x.WindCnt=-x.WindCnt:x.WindCnt+=M.WindDelta,M.WindCnt-x.WindDelta===0?M.WindCnt=-M.WindCnt:M.WindCnt-=x.WindDelta;else this.IsEvenOddFillType(M)?x.WindCnt2=x.WindCnt2===0?1:0:x.WindCnt2+=M.WindDelta,this.IsEvenOddFillType(x)?M.WindCnt2=M.WindCnt2===0?1:0:M.WindCnt2-=x.WindDelta;var qe,mt,Ct,Bt;x.PolyTyp==n.PolyType.ptSubject?(qe=this.m_SubjFillType,Ct=this.m_ClipFillType):(qe=this.m_ClipFillType,Ct=this.m_SubjFillType),M.PolyTyp==n.PolyType.ptSubject?(mt=this.m_SubjFillType,Bt=this.m_ClipFillType):(mt=this.m_ClipFillType,Bt=this.m_SubjFillType);var Ut,It;switch(qe){case n.PolyFillType.pftPositive:Ut=x.WindCnt;break;case n.PolyFillType.pftNegative:Ut=-x.WindCnt;break;default:Ut=Math.abs(x.WindCnt);break}switch(mt){case n.PolyFillType.pftPositive:It=M.WindCnt;break;case n.PolyFillType.pftNegative:It=-M.WindCnt;break;default:It=Math.abs(M.WindCnt);break}if(le&&ce)H||ne||Ut!==0&&Ut!=1||It!==0&&It!=1||x.PolyTyp!=M.PolyTyp&&this.m_ClipType!=n.ClipType.ctXor?this.AddLocalMaxPoly(x,M,P):(this.AddOutPt(x,P),this.AddOutPt(M,P),n.Clipper.SwapSides(x,M),n.Clipper.SwapPolyIndexes(x,M));else if(le)(It===0||It==1)&&(this.AddOutPt(x,P),n.Clipper.SwapSides(x,M),n.Clipper.SwapPolyIndexes(x,M));else if(ce)(Ut===0||Ut==1)&&(this.AddOutPt(M,P),n.Clipper.SwapSides(x,M),n.Clipper.SwapPolyIndexes(x,M));else if((Ut===0||Ut==1)&&(It===0||It==1)&&!H&&!ne){var ei,Nn;switch(Ct){case n.PolyFillType.pftPositive:ei=x.WindCnt2;break;case n.PolyFillType.pftNegative:ei=-x.WindCnt2;break;default:ei=Math.abs(x.WindCnt2);break}switch(Bt){case n.PolyFillType.pftPositive:Nn=M.WindCnt2;break;case n.PolyFillType.pftNegative:Nn=-M.WindCnt2;break;default:Nn=Math.abs(M.WindCnt2);break}if(x.PolyTyp!=M.PolyTyp)this.AddLocalMinPoly(x,M,P);else if(Ut==1&&It==1)switch(this.m_ClipType){case n.ClipType.ctIntersection:ei>0&&Nn>0&&this.AddLocalMinPoly(x,M,P);break;case n.ClipType.ctUnion:ei<=0&&Nn<=0&&this.AddLocalMinPoly(x,M,P);break;case n.ClipType.ctDifference:(x.PolyTyp==n.PolyType.ptClip&&ei>0&&Nn>0||x.PolyTyp==n.PolyType.ptSubject&&ei<=0&&Nn<=0)&&this.AddLocalMinPoly(x,M,P);break;case n.ClipType.ctXor:this.AddLocalMinPoly(x,M,P);break}else n.Clipper.SwapSides(x,M)}H!=ne&&(H&&x.OutIdx>=0||ne&&M.OutIdx>=0)&&(n.Clipper.SwapSides(x,M),n.Clipper.SwapPolyIndexes(x,M)),H&&this.DeleteFromAEL(x),ne&&this.DeleteFromAEL(M)},n.Clipper.prototype.DeleteFromAEL=function(x){var M=x.PrevInAEL,P=x.NextInAEL;M===null&&P===null&&x!=this.m_ActiveEdges||(M!==null?M.NextInAEL=P:this.m_ActiveEdges=P,P!==null&&(P.PrevInAEL=M),x.NextInAEL=null,x.PrevInAEL=null)},n.Clipper.prototype.DeleteFromSEL=function(x){var M=x.PrevInSEL,P=x.NextInSEL;M===null&&P===null&&x!=this.m_SortedEdges||(M!==null?M.NextInSEL=P:this.m_SortedEdges=P,P!==null&&(P.PrevInSEL=M),x.NextInSEL=null,x.PrevInSEL=null)},n.Clipper.prototype.UpdateEdgeIntoAEL=function(x){x.NextInLML===null&&n.Error("UpdateEdgeIntoAEL: invalid call");var M=x.PrevInAEL,P=x.NextInAEL;return x.NextInLML.OutIdx=x.OutIdx,M!==null?M.NextInAEL=x.NextInLML:this.m_ActiveEdges=x.NextInLML,P!==null&&(P.PrevInAEL=x.NextInLML),x.NextInLML.Side=x.Side,x.NextInLML.WindDelta=x.WindDelta,x.NextInLML.WindCnt=x.WindCnt,x.NextInLML.WindCnt2=x.WindCnt2,x=x.NextInLML,x.Curr.X=x.Bot.X,x.Curr.Y=x.Bot.Y,x.PrevInAEL=M,x.NextInAEL=P,n.ClipperBase.IsHorizontal(x)||this.InsertScanbeam(x.Top.Y),x},n.Clipper.prototype.ProcessHorizontals=function(x){for(var M=this.m_SortedEdges;M!==null;)this.DeleteFromSEL(M),this.ProcessHorizontal(M,x),M=this.m_SortedEdges},n.Clipper.prototype.GetHorzDirection=function(x,M){x.Bot.X<x.Top.X?(M.Left=x.Bot.X,M.Right=x.Top.X,M.Dir=n.Direction.dLeftToRight):(M.Left=x.Top.X,M.Right=x.Bot.X,M.Dir=n.Direction.dRightToLeft)},n.Clipper.prototype.PrepareHorzJoins=function(x,M){var P=this.m_PolyOuts[x.OutIdx].Pts;x.Side!=n.EdgeSide.esLeft&&(P=P.Prev),M&&(n.IntPoint.op_Equality(P.Pt,x.Top)?this.AddGhostJoin(P,x.Bot):this.AddGhostJoin(P,x.Top))},n.Clipper.prototype.ProcessHorizontal=function(x,M){var P={Dir:null,Left:null,Right:null};this.GetHorzDirection(x,P);for(var V=P.Dir,H=P.Left,ne=P.Right,le=x,ce=null;le.NextInLML!==null&&n.ClipperBase.IsHorizontal(le.NextInLML);)le=le.NextInLML;for(le.NextInLML===null&&(ce=this.GetMaximaPair(le));;){for(var ze=x==le,qe=this.GetNextInAEL(x,V);qe!==null&&!(qe.Curr.X==x.Top.X&&x.NextInLML!==null&&qe.Dx<x.NextInLML.Dx);){var mt=this.GetNextInAEL(qe,V);if(V==n.Direction.dLeftToRight&&qe.Curr.X<=ne||V==n.Direction.dRightToLeft&&qe.Curr.X>=H){if(x.OutIdx>=0&&x.WindDelta!=0&&this.PrepareHorzJoins(x,M),qe==ce&&ze){V==n.Direction.dLeftToRight?this.IntersectEdges(x,qe,qe.Top,!1):this.IntersectEdges(qe,x,qe.Top,!1),ce.OutIdx>=0&&n.Error("ProcessHorizontal error");return}else if(V==n.Direction.dLeftToRight){var Ct=new n.IntPoint(qe.Curr.X,x.Curr.Y);this.IntersectEdges(x,qe,Ct,!0)}else{var Ct=new n.IntPoint(qe.Curr.X,x.Curr.Y);this.IntersectEdges(qe,x,Ct,!0)}this.SwapPositionsInAEL(x,qe)}else if(V==n.Direction.dLeftToRight&&qe.Curr.X>=ne||V==n.Direction.dRightToLeft&&qe.Curr.X<=H)break;qe=mt}if(x.OutIdx>=0&&x.WindDelta!==0&&this.PrepareHorzJoins(x,M),x.NextInLML!==null&&n.ClipperBase.IsHorizontal(x.NextInLML)){x=this.UpdateEdgeIntoAEL(x),x.OutIdx>=0&&this.AddOutPt(x,x.Bot);var P={Dir:V,Left:H,Right:ne};this.GetHorzDirection(x,P),V=P.Dir,H=P.Left,ne=P.Right}else break}if(x.NextInLML!==null)if(x.OutIdx>=0){var Bt=this.AddOutPt(x,x.Top);if(x=this.UpdateEdgeIntoAEL(x),x.WindDelta===0)return;var Ut=x.PrevInAEL,mt=x.NextInAEL;if(Ut!==null&&Ut.Curr.X==x.Bot.X&&Ut.Curr.Y==x.Bot.Y&&Ut.WindDelta!==0&&Ut.OutIdx>=0&&Ut.Curr.Y>Ut.Top.Y&&n.ClipperBase.SlopesEqual(x,Ut,this.m_UseFullRange)){var It=this.AddOutPt(Ut,x.Bot);this.AddJoin(Bt,It,x.Top)}else if(mt!==null&&mt.Curr.X==x.Bot.X&&mt.Curr.Y==x.Bot.Y&&mt.WindDelta!==0&&mt.OutIdx>=0&&mt.Curr.Y>mt.Top.Y&&n.ClipperBase.SlopesEqual(x,mt,this.m_UseFullRange)){var It=this.AddOutPt(mt,x.Bot);this.AddJoin(Bt,It,x.Top)}}else x=this.UpdateEdgeIntoAEL(x);else ce!==null?ce.OutIdx>=0?(V==n.Direction.dLeftToRight?this.IntersectEdges(x,ce,x.Top,!1):this.IntersectEdges(ce,x,x.Top,!1),ce.OutIdx>=0&&n.Error("ProcessHorizontal error")):(this.DeleteFromAEL(x),this.DeleteFromAEL(ce)):(x.OutIdx>=0&&this.AddOutPt(x,x.Top),this.DeleteFromAEL(x))},n.Clipper.prototype.GetNextInAEL=function(x,M){return M==n.Direction.dLeftToRight?x.NextInAEL:x.PrevInAEL},n.Clipper.prototype.IsMinima=function(x){return x!==null&&x.Prev.NextInLML!=x&&x.Next.NextInLML!=x},n.Clipper.prototype.IsMaxima=function(x,M){return x!==null&&x.Top.Y==M&&x.NextInLML===null},n.Clipper.prototype.IsIntermediate=function(x,M){return x.Top.Y==M&&x.NextInLML!==null},n.Clipper.prototype.GetMaximaPair=function(x){var M=null;return n.IntPoint.op_Equality(x.Next.Top,x.Top)&&x.Next.NextInLML===null?M=x.Next:n.IntPoint.op_Equality(x.Prev.Top,x.Top)&&x.Prev.NextInLML===null&&(M=x.Prev),M!==null&&(M.OutIdx==-2||M.NextInAEL==M.PrevInAEL&&!n.ClipperBase.IsHorizontal(M))?null:M},n.Clipper.prototype.ProcessIntersections=function(x,M){if(this.m_ActiveEdges==null)return!0;try{if(this.BuildIntersectList(x,M),this.m_IntersectList.length==0)return!0;if(this.m_IntersectList.length==1||this.FixupIntersectionOrder())this.ProcessIntersectList();else return!1}catch{this.m_SortedEdges=null,this.m_IntersectList.length=0,n.Error("ProcessIntersections error")}return this.m_SortedEdges=null,!0},n.Clipper.prototype.BuildIntersectList=function(x,M){if(this.m_ActiveEdges!==null){var P=this.m_ActiveEdges;for(this.m_SortedEdges=P;P!==null;)P.PrevInSEL=P.PrevInAEL,P.NextInSEL=P.NextInAEL,P.Curr.X=n.Clipper.TopX(P,M),P=P.NextInAEL;for(var V=!0;V&&this.m_SortedEdges!==null;){for(V=!1,P=this.m_SortedEdges;P.NextInSEL!==null;){var H=P.NextInSEL,ne=new n.IntPoint;if(P.Curr.X>H.Curr.X){!this.IntersectPoint(P,H,ne)&&P.Curr.X>H.Curr.X+1&&n.Error("Intersection error"),ne.Y>x&&(ne.Y=x,Math.abs(P.Dx)>Math.abs(H.Dx)?ne.X=n.Clipper.TopX(H,x):ne.X=n.Clipper.TopX(P,x));var le=new n.IntersectNode;le.Edge1=P,le.Edge2=H,le.Pt.X=ne.X,le.Pt.Y=ne.Y,this.m_IntersectList.push(le),this.SwapPositionsInSEL(P,H),V=!0}else P=H}if(P.PrevInSEL!==null)P.PrevInSEL.NextInSEL=null;else break}this.m_SortedEdges=null}},n.Clipper.prototype.EdgesAdjacent=function(x){return x.Edge1.NextInSEL==x.Edge2||x.Edge1.PrevInSEL==x.Edge2},n.Clipper.IntersectNodeSort=function(x,M){return M.Pt.Y-x.Pt.Y},n.Clipper.prototype.FixupIntersectionOrder=function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer),this.CopyAELToSEL();for(var x=this.m_IntersectList.length,M=0;M<x;M++){if(!this.EdgesAdjacent(this.m_IntersectList[M])){for(var P=M+1;P<x&&!this.EdgesAdjacent(this.m_IntersectList[P]);)P++;if(P==x)return!1;var V=this.m_IntersectList[M];this.m_IntersectList[M]=this.m_IntersectList[P],this.m_IntersectList[P]=V}this.SwapPositionsInSEL(this.m_IntersectList[M].Edge1,this.m_IntersectList[M].Edge2)}return!0},n.Clipper.prototype.ProcessIntersectList=function(){for(var x=0,M=this.m_IntersectList.length;x<M;x++){var P=this.m_IntersectList[x];this.IntersectEdges(P.Edge1,P.Edge2,P.Pt,!0),this.SwapPositionsInAEL(P.Edge1,P.Edge2)}this.m_IntersectList.length=0};var Tr=l(function(x){return x<0?Math.ceil(x-.5):Math.round(x)},"R1"),Qn=l(function(x){return x<0?Math.ceil(x-.5):Math.floor(x+.5)},"R2"),Gn=l(function(x){return x<0?-Math.round(Math.abs(x)):Math.round(x)},"R3"),_i=l(function(x){return x<0?(x-=.5,x<-2147483648?Math.ceil(x):x|0):(x+=.5,x>2147483647?Math.floor(x):x|0)},"R4");s.msie?n.Clipper.Round=Tr:s.chromium?n.Clipper.Round=Gn:s.safari?n.Clipper.Round=_i:n.Clipper.Round=Qn,n.Clipper.TopX=function(x,M){return M==x.Top.Y?x.Top.X:x.Bot.X+n.Clipper.Round(x.Dx*(M-x.Bot.Y))},n.Clipper.prototype.IntersectPoint=function(x,M,P){P.X=0,P.Y=0;var V,H;if(n.ClipperBase.SlopesEqual(x,M,this.m_UseFullRange)||x.Dx==M.Dx)return M.Bot.Y>x.Bot.Y?(P.X=M.Bot.X,P.Y=M.Bot.Y):(P.X=x.Bot.X,P.Y=x.Bot.Y),!1;if(x.Delta.X===0)P.X=x.Bot.X,n.ClipperBase.IsHorizontal(M)?P.Y=M.Bot.Y:(H=M.Bot.Y-M.Bot.X/M.Dx,P.Y=n.Clipper.Round(P.X/M.Dx+H));else if(M.Delta.X===0)P.X=M.Bot.X,n.ClipperBase.IsHorizontal(x)?P.Y=x.Bot.Y:(V=x.Bot.Y-x.Bot.X/x.Dx,P.Y=n.Clipper.Round(P.X/x.Dx+V));else{V=x.Bot.X-x.Bot.Y*x.Dx,H=M.Bot.X-M.Bot.Y*M.Dx;var ne=(H-V)/(x.Dx-M.Dx);P.Y=n.Clipper.Round(ne),Math.abs(x.Dx)<Math.abs(M.Dx)?P.X=n.Clipper.Round(x.Dx*ne+V):P.X=n.Clipper.Round(M.Dx*ne+H)}if(P.Y<x.Top.Y||P.Y<M.Top.Y){if(x.Top.Y>M.Top.Y)return P.Y=x.Top.Y,P.X=n.Clipper.TopX(M,x.Top.Y),P.X<x.Top.X;P.Y=M.Top.Y,Math.abs(x.Dx)<Math.abs(M.Dx)?P.X=n.Clipper.TopX(x,P.Y):P.X=n.Clipper.TopX(M,P.Y)}return!0},n.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(x){for(var M=this.m_ActiveEdges;M!==null;){var P=this.IsMaxima(M,x);if(P){var V=this.GetMaximaPair(M);P=V===null||!n.ClipperBase.IsHorizontal(V)}if(P){var H=M.PrevInAEL;this.DoMaxima(M),H===null?M=this.m_ActiveEdges:M=H.NextInAEL}else{if(this.IsIntermediate(M,x)&&n.ClipperBase.IsHorizontal(M.NextInLML)?(M=this.UpdateEdgeIntoAEL(M),M.OutIdx>=0&&this.AddOutPt(M,M.Bot),this.AddEdgeToSEL(M)):(M.Curr.X=n.Clipper.TopX(M,x),M.Curr.Y=x),this.StrictlySimple){var H=M.PrevInAEL;if(M.OutIdx>=0&&M.WindDelta!==0&&H!==null&&H.OutIdx>=0&&H.Curr.X==M.Curr.X&&H.WindDelta!==0){var ne=this.AddOutPt(H,M.Curr),le=this.AddOutPt(M,M.Curr);this.AddJoin(ne,le,M.Curr)}}M=M.NextInAEL}}for(this.ProcessHorizontals(!0),M=this.m_ActiveEdges;M!==null;){if(this.IsIntermediate(M,x)){var ne=null;M.OutIdx>=0&&(ne=this.AddOutPt(M,M.Top)),M=this.UpdateEdgeIntoAEL(M);var H=M.PrevInAEL,ce=M.NextInAEL;if(H!==null&&H.Curr.X==M.Bot.X&&H.Curr.Y==M.Bot.Y&&ne!==null&&H.OutIdx>=0&&H.Curr.Y>H.Top.Y&&n.ClipperBase.SlopesEqual(M,H,this.m_UseFullRange)&&M.WindDelta!==0&&H.WindDelta!==0){var le=this.AddOutPt(H,M.Bot);this.AddJoin(ne,le,M.Top)}else if(ce!==null&&ce.Curr.X==M.Bot.X&&ce.Curr.Y==M.Bot.Y&&ne!==null&&ce.OutIdx>=0&&ce.Curr.Y>ce.Top.Y&&n.ClipperBase.SlopesEqual(M,ce,this.m_UseFullRange)&&M.WindDelta!==0&&ce.WindDelta!==0){var le=this.AddOutPt(ce,M.Bot);this.AddJoin(ne,le,M.Top)}}M=M.NextInAEL}},n.Clipper.prototype.DoMaxima=function(x){var M=this.GetMaximaPair(x);if(M===null){x.OutIdx>=0&&this.AddOutPt(x,x.Top),this.DeleteFromAEL(x);return}for(var P=x.NextInAEL,V=!0;P!==null&&P!=M;)this.IntersectEdges(x,P,x.Top,!0),this.SwapPositionsInAEL(x,P),P=x.NextInAEL;x.OutIdx==-1&&M.OutIdx==-1?(this.DeleteFromAEL(x),this.DeleteFromAEL(M)):x.OutIdx>=0&&M.OutIdx>=0?this.IntersectEdges(x,M,x.Top,!1):V&&x.WindDelta===0?(x.OutIdx>=0&&(this.AddOutPt(x,x.Top),x.OutIdx=-1),this.DeleteFromAEL(x),M.OutIdx>=0&&(this.AddOutPt(M,x.Top),M.OutIdx=-1),this.DeleteFromAEL(M)):n.Error("DoMaxima error")},n.Clipper.ReversePaths=function(x){for(var M=0,P=x.length;M<P;M++)x[M].reverse()},n.Clipper.Orientation=function(x){return n.Clipper.Area(x)>=0},n.Clipper.prototype.PointCount=function(x){if(x===null)return 0;var M=0,P=x;do M++,P=P.Next;while(P!=x);return M},n.Clipper.prototype.BuildResult=function(x){n.Clear(x);for(var M=0,P=this.m_PolyOuts.length;M<P;M++){var V=this.m_PolyOuts[M];if(V.Pts!==null){var H=V.Pts.Prev,ne=this.PointCount(H);if(!(ne<2)){for(var le=new Array(ne),ce=0;ce<ne;ce++)le[ce]=H.Pt,H=H.Prev;x.push(le)}}}},n.Clipper.prototype.BuildResult2=function(x){x.Clear();for(var M=0,P=this.m_PolyOuts.length;M<P;M++){var V=this.m_PolyOuts[M],H=this.PointCount(V.Pts);if(!(V.IsOpen&&H<2||!V.IsOpen&&H<3)){this.FixHoleLinkage(V);var ne=new n.PolyNode;x.m_AllPolys.push(ne),V.PolyNode=ne,ne.m_polygon.length=H;for(var le=V.Pts.Prev,ce=0;ce<H;ce++)ne.m_polygon[ce]=le.Pt,le=le.Prev}}for(var M=0,P=this.m_PolyOuts.length;M<P;M++){var V=this.m_PolyOuts[M];V.PolyNode!==null&&(V.IsOpen?(V.PolyNode.IsOpen=!0,x.AddChild(V.PolyNode)):V.FirstLeft!==null&&V.FirstLeft.PolyNode!=null?V.FirstLeft.PolyNode.AddChild(V.PolyNode):x.AddChild(V.PolyNode))}},n.Clipper.prototype.FixupOutPolygon=function(x){var M=null;x.BottomPt=null;for(var P=x.Pts;;){if(P.Prev==P||P.Prev==P.Next){this.DisposeOutPts(P),x.Pts=null;return}if(n.IntPoint.op_Equality(P.Pt,P.Next.Pt)||n.IntPoint.op_Equality(P.Pt,P.Prev.Pt)||n.ClipperBase.SlopesEqual(P.Prev.Pt,P.Pt,P.Next.Pt,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(P.Prev.Pt,P.Pt,P.Next.Pt)))M=null,P.Prev.Next=P.Next,P.Next.Prev=P.Prev,P=P.Prev;else{if(P==M)break;M===null&&(M=P),P=P.Next}}x.Pts=P},n.Clipper.prototype.DupOutPt=function(x,M){var P=new n.OutPt;return P.Pt.X=x.Pt.X,P.Pt.Y=x.Pt.Y,P.Idx=x.Idx,M?(P.Next=x.Next,P.Prev=x,x.Next.Prev=P,x.Next=P):(P.Prev=x.Prev,P.Next=x,x.Prev.Next=P,x.Prev=P),P},n.Clipper.prototype.GetOverlap=function(x,M,P,V,H){return x<M?P<V?(H.Left=Math.max(x,P),H.Right=Math.min(M,V)):(H.Left=Math.max(x,V),H.Right=Math.min(M,P)):P<V?(H.Left=Math.max(M,P),H.Right=Math.min(x,V)):(H.Left=Math.max(M,V),H.Right=Math.min(x,P)),H.Left<H.Right},n.Clipper.prototype.JoinHorz=function(x,M,P,V,H,ne){var le=x.Pt.X>M.Pt.X?n.Direction.dRightToLeft:n.Direction.dLeftToRight,ce=P.Pt.X>V.Pt.X?n.Direction.dRightToLeft:n.Direction.dLeftToRight;if(le==ce)return!1;if(le==n.Direction.dLeftToRight){for(;x.Next.Pt.X<=H.X&&x.Next.Pt.X>=x.Pt.X&&x.Next.Pt.Y==H.Y;)x=x.Next;ne&&x.Pt.X!=H.X&&(x=x.Next),M=this.DupOutPt(x,!ne),n.IntPoint.op_Inequality(M.Pt,H)&&(x=M,x.Pt.X=H.X,x.Pt.Y=H.Y,M=this.DupOutPt(x,!ne))}else{for(;x.Next.Pt.X>=H.X&&x.Next.Pt.X<=x.Pt.X&&x.Next.Pt.Y==H.Y;)x=x.Next;!ne&&x.Pt.X!=H.X&&(x=x.Next),M=this.DupOutPt(x,ne),n.IntPoint.op_Inequality(M.Pt,H)&&(x=M,x.Pt.X=H.X,x.Pt.Y=H.Y,M=this.DupOutPt(x,ne))}if(ce==n.Direction.dLeftToRight){for(;P.Next.Pt.X<=H.X&&P.Next.Pt.X>=P.Pt.X&&P.Next.Pt.Y==H.Y;)P=P.Next;ne&&P.Pt.X!=H.X&&(P=P.Next),V=this.DupOutPt(P,!ne),n.IntPoint.op_Inequality(V.Pt,H)&&(P=V,P.Pt.X=H.X,P.Pt.Y=H.Y,V=this.DupOutPt(P,!ne))}else{for(;P.Next.Pt.X>=H.X&&P.Next.Pt.X<=P.Pt.X&&P.Next.Pt.Y==H.Y;)P=P.Next;!ne&&P.Pt.X!=H.X&&(P=P.Next),V=this.DupOutPt(P,ne),n.IntPoint.op_Inequality(V.Pt,H)&&(P=V,P.Pt.X=H.X,P.Pt.Y=H.Y,V=this.DupOutPt(P,ne))}return le==n.Direction.dLeftToRight==ne?(x.Prev=P,P.Next=x,M.Next=V,V.Prev=M):(x.Next=P,P.Prev=x,M.Prev=V,V.Next=M),!0},n.Clipper.prototype.JoinPoints=function(x,M,P){var V=x.OutPt1,H=new n.OutPt,ne=x.OutPt2,le=new n.OutPt,ce=x.OutPt1.Pt.Y==x.OffPt.Y;if(ce&&n.IntPoint.op_Equality(x.OffPt,x.OutPt1.Pt)&&n.IntPoint.op_Equality(x.OffPt,x.OutPt2.Pt)){for(H=x.OutPt1.Next;H!=V&&n.IntPoint.op_Equality(H.Pt,x.OffPt);)H=H.Next;var ze=H.Pt.Y>x.OffPt.Y;for(le=x.OutPt2.Next;le!=ne&&n.IntPoint.op_Equality(le.Pt,x.OffPt);)le=le.Next;var qe=le.Pt.Y>x.OffPt.Y;return ze==qe?!1:ze?(H=this.DupOutPt(V,!1),le=this.DupOutPt(ne,!0),V.Prev=ne,ne.Next=V,H.Next=le,le.Prev=H,x.OutPt1=V,x.OutPt2=H,!0):(H=this.DupOutPt(V,!0),le=this.DupOutPt(ne,!1),V.Next=ne,ne.Prev=V,H.Prev=le,le.Next=H,x.OutPt1=V,x.OutPt2=H,!0)}else if(ce){for(H=V;V.Prev.Pt.Y==V.Pt.Y&&V.Prev!=H&&V.Prev!=ne;)V=V.Prev;for(;H.Next.Pt.Y==H.Pt.Y&&H.Next!=V&&H.Next!=ne;)H=H.Next;if(H.Next==V||H.Next==ne)return!1;for(le=ne;ne.Prev.Pt.Y==ne.Pt.Y&&ne.Prev!=le&&ne.Prev!=H;)ne=ne.Prev;for(;le.Next.Pt.Y==le.Pt.Y&&le.Next!=ne&&le.Next!=V;)le=le.Next;if(le.Next==ne||le.Next==V)return!1;var mt={Left:null,Right:null};if(!this.GetOverlap(V.Pt.X,H.Pt.X,ne.Pt.X,le.Pt.X,mt))return!1;var Ct=mt.Left,Bt=mt.Right,Ut=new n.IntPoint,It;return V.Pt.X>=Ct&&V.Pt.X<=Bt?(Ut.X=V.Pt.X,Ut.Y=V.Pt.Y,It=V.Pt.X>H.Pt.X):ne.Pt.X>=Ct&&ne.Pt.X<=Bt?(Ut.X=ne.Pt.X,Ut.Y=ne.Pt.Y,It=ne.Pt.X>le.Pt.X):H.Pt.X>=Ct&&H.Pt.X<=Bt?(Ut.X=H.Pt.X,Ut.Y=H.Pt.Y,It=H.Pt.X>V.Pt.X):(Ut.X=le.Pt.X,Ut.Y=le.Pt.Y,It=le.Pt.X>ne.Pt.X),x.OutPt1=V,x.OutPt2=ne,this.JoinHorz(V,H,ne,le,Ut,It)}else{for(H=V.Next;n.IntPoint.op_Equality(H.Pt,V.Pt)&&H!=V;)H=H.Next;var ei=H.Pt.Y>V.Pt.Y||!n.ClipperBase.SlopesEqual(V.Pt,H.Pt,x.OffPt,this.m_UseFullRange);if(ei){for(H=V.Prev;n.IntPoint.op_Equality(H.Pt,V.Pt)&&H!=V;)H=H.Prev;if(H.Pt.Y>V.Pt.Y||!n.ClipperBase.SlopesEqual(V.Pt,H.Pt,x.OffPt,this.m_UseFullRange))return!1}for(le=ne.Next;n.IntPoint.op_Equality(le.Pt,ne.Pt)&&le!=ne;)le=le.Next;var Nn=le.Pt.Y>ne.Pt.Y||!n.ClipperBase.SlopesEqual(ne.Pt,le.Pt,x.OffPt,this.m_UseFullRange);if(Nn){for(le=ne.Prev;n.IntPoint.op_Equality(le.Pt,ne.Pt)&&le!=ne;)le=le.Prev;if(le.Pt.Y>ne.Pt.Y||!n.ClipperBase.SlopesEqual(ne.Pt,le.Pt,x.OffPt,this.m_UseFullRange))return!1}return H==V||le==ne||H==le||M==P&&ei==Nn?!1:ei?(H=this.DupOutPt(V,!1),le=this.DupOutPt(ne,!0),V.Prev=ne,ne.Next=V,H.Next=le,le.Prev=H,x.OutPt1=V,x.OutPt2=H,!0):(H=this.DupOutPt(V,!0),le=this.DupOutPt(ne,!1),V.Next=ne,ne.Prev=V,H.Prev=le,le.Next=H,x.OutPt1=V,x.OutPt2=H,!0)}},n.Clipper.GetBounds=function(x){for(var M=0,P=x.length;M<P&&x[M].length==0;)M++;if(M==P)return new n.IntRect(0,0,0,0);var V=new n.IntRect;for(V.left=x[M][0].X,V.right=V.left,V.top=x[M][0].Y,V.bottom=V.top;M<P;M++)for(var H=0,ne=x[M].length;H<ne;H++)x[M][H].X<V.left?V.left=x[M][H].X:x[M][H].X>V.right&&(V.right=x[M][H].X),x[M][H].Y<V.top?V.top=x[M][H].Y:x[M][H].Y>V.bottom&&(V.bottom=x[M][H].Y);return V},n.Clipper.prototype.GetBounds2=function(x){var M=x,P=new n.IntRect;for(P.left=x.Pt.X,P.right=x.Pt.X,P.top=x.Pt.Y,P.bottom=x.Pt.Y,x=x.Next;x!=M;)x.Pt.X<P.left&&(P.left=x.Pt.X),x.Pt.X>P.right&&(P.right=x.Pt.X),x.Pt.Y<P.top&&(P.top=x.Pt.Y),x.Pt.Y>P.bottom&&(P.bottom=x.Pt.Y),x=x.Next;return P},n.Clipper.PointInPolygon=function(x,M){var P=0,V=M.length;if(V<3)return 0;for(var H=M[0],ne=1;ne<=V;++ne){var le=ne==V?M[0]:M[ne];if(le.Y==x.Y&&(le.X==x.X||H.Y==x.Y&&le.X>x.X==H.X<x.X))return-1;if(H.Y<x.Y!=le.Y<x.Y){if(H.X>=x.X)if(le.X>x.X)P=1-P;else{var ce=(H.X-x.X)*(le.Y-x.Y)-(le.X-x.X)*(H.Y-x.Y);if(ce==0)return-1;ce>0==le.Y>H.Y&&(P=1-P)}else if(le.X>x.X){var ce=(H.X-x.X)*(le.Y-x.Y)-(le.X-x.X)*(H.Y-x.Y);if(ce==0)return-1;ce>0==le.Y>H.Y&&(P=1-P)}}H=le}return P},n.Clipper.prototype.PointInPolygon=function(x,M){for(var P=0,V=M;;){var H=M.Pt.X,ne=M.Pt.Y,le=M.Next.Pt.X,ce=M.Next.Pt.Y;if(ce==x.Y&&(le==x.X||ne==x.Y&&le>x.X==H<x.X))return-1;if(ne<x.Y!=ce<x.Y){if(H>=x.X)if(le>x.X)P=1-P;else{var ze=(H-x.X)*(ce-x.Y)-(le-x.X)*(ne-x.Y);if(ze==0)return-1;ze>0==ce>ne&&(P=1-P)}else if(le>x.X){var ze=(H-x.X)*(ce-x.Y)-(le-x.X)*(ne-x.Y);if(ze==0)return-1;ze>0==ce>ne&&(P=1-P)}}if(M=M.Next,V==M)break}return P},n.Clipper.prototype.Poly2ContainsPoly1=function(x,M){var P=x;do{var V=this.PointInPolygon(P.Pt,M);if(V>=0)return V!=0;P=P.Next}while(P!=x);return!0},n.Clipper.prototype.FixupFirstLefts1=function(x,M){for(var P=0,V=this.m_PolyOuts.length;P<V;P++){var H=this.m_PolyOuts[P];H.Pts!==null&&H.FirstLeft==x&&this.Poly2ContainsPoly1(H.Pts,M.Pts)&&(H.FirstLeft=M)}},n.Clipper.prototype.FixupFirstLefts2=function(x,M){for(var P=0,V=this.m_PolyOuts,H=V.length,ne=V[P];P<H;P++,ne=V[P])ne.FirstLeft==x&&(ne.FirstLeft=M)},n.Clipper.ParseFirstLeft=function(x){for(;x!=null&&x.Pts==null;)x=x.FirstLeft;return x},n.Clipper.prototype.JoinCommonEdges=function(){for(var x=0,M=this.m_Joins.length;x<M;x++){var P=this.m_Joins[x],V=this.GetOutRec(P.OutPt1.Idx),H=this.GetOutRec(P.OutPt2.Idx);if(!(V.Pts==null||H.Pts==null)){var ne;if(V==H?ne=V:this.Param1RightOfParam2(V,H)?ne=H:this.Param1RightOfParam2(H,V)?ne=V:ne=this.GetLowermostRec(V,H),!!this.JoinPoints(P,V,H))if(V==H){if(V.Pts=P.OutPt1,V.BottomPt=null,H=this.CreateOutRec(),H.Pts=P.OutPt2,this.UpdateOutPtIdxs(H),this.m_UsingPolyTree)for(var le=0,ce=this.m_PolyOuts.length;le<ce-1;le++){var ze=this.m_PolyOuts[le];ze.Pts==null||n.Clipper.ParseFirstLeft(ze.FirstLeft)!=V||ze.IsHole==V.IsHole||this.Poly2ContainsPoly1(ze.Pts,P.OutPt2)&&(ze.FirstLeft=H)}this.Poly2ContainsPoly1(H.Pts,V.Pts)?(H.IsHole=!V.IsHole,H.FirstLeft=V,this.m_UsingPolyTree&&this.FixupFirstLefts2(H,V),(H.IsHole^this.ReverseSolution)==this.Area(H)>0&&this.ReversePolyPtLinks(H.Pts)):this.Poly2ContainsPoly1(V.Pts,H.Pts)?(H.IsHole=V.IsHole,V.IsHole=!H.IsHole,H.FirstLeft=V.FirstLeft,V.FirstLeft=H,this.m_UsingPolyTree&&this.FixupFirstLefts2(V,H),(V.IsHole^this.ReverseSolution)==this.Area(V)>0&&this.ReversePolyPtLinks(V.Pts)):(H.IsHole=V.IsHole,H.FirstLeft=V.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(V,H))}else H.Pts=null,H.BottomPt=null,H.Idx=V.Idx,V.IsHole=ne.IsHole,ne==H&&(V.FirstLeft=H.FirstLeft),H.FirstLeft=V,this.m_UsingPolyTree&&this.FixupFirstLefts2(H,V)}}},n.Clipper.prototype.UpdateOutPtIdxs=function(x){var M=x.Pts;do M.Idx=x.Idx,M=M.Prev;while(M!=x.Pts)},n.Clipper.prototype.DoSimplePolygons=function(){for(var x=0;x<this.m_PolyOuts.length;){var M=this.m_PolyOuts[x++],P=M.Pts;if(P!==null)do{for(var V=P.Next;V!=M.Pts;){if(n.IntPoint.op_Equality(P.Pt,V.Pt)&&V.Next!=P&&V.Prev!=P){var H=P.Prev,ne=V.Prev;P.Prev=ne,ne.Next=P,V.Prev=H,H.Next=V,M.Pts=P;var le=this.CreateOutRec();le.Pts=V,this.UpdateOutPtIdxs(le),this.Poly2ContainsPoly1(le.Pts,M.Pts)?(le.IsHole=!M.IsHole,le.FirstLeft=M):this.Poly2ContainsPoly1(M.Pts,le.Pts)?(le.IsHole=M.IsHole,M.IsHole=!le.IsHole,le.FirstLeft=M.FirstLeft,M.FirstLeft=le):(le.IsHole=M.IsHole,le.FirstLeft=M.FirstLeft),V=P}V=V.Next}P=P.Next}while(P!=M.Pts)}},n.Clipper.Area=function(x){var M=x.length;if(M<3)return 0;for(var P=0,V=0,H=M-1;V<M;++V)P+=(x[H].X+x[V].X)*(x[H].Y-x[V].Y),H=V;return-P*.5},n.Clipper.prototype.Area=function(x){var M=x.Pts;if(M==null)return 0;var P=0;do P=P+(M.Prev.Pt.X+M.Pt.X)*(M.Prev.Pt.Y-M.Pt.Y),M=M.Next;while(M!=x.Pts);return P*.5},n.Clipper.SimplifyPolygon=function(x,M){var P=new Array,V=new n.Clipper(0);return V.StrictlySimple=!0,V.AddPath(x,n.PolyType.ptSubject,!0),V.Execute(n.ClipType.ctUnion,P,M,M),P},n.Clipper.SimplifyPolygons=function(x,M){typeof M>"u"&&(M=n.PolyFillType.pftEvenOdd);var P=new Array,V=new n.Clipper(0);return V.StrictlySimple=!0,V.AddPaths(x,n.PolyType.ptSubject,!0),V.Execute(n.ClipType.ctUnion,P,M,M),P},n.Clipper.DistanceSqrd=function(x,M){var P=x.X-M.X,V=x.Y-M.Y;return P*P+V*V},n.Clipper.DistanceFromLineSqrd=function(x,M,P){var V=M.Y-P.Y,H=P.X-M.X,ne=V*M.X+H*M.Y;return ne=V*x.X+H*x.Y-ne,ne*ne/(V*V+H*H)},n.Clipper.SlopesNearCollinear=function(x,M,P,V){return n.Clipper.DistanceFromLineSqrd(M,x,P)<V},n.Clipper.PointsAreClose=function(x,M,P){var V=x.X-M.X,H=x.Y-M.Y;return V*V+H*H<=P},n.Clipper.ExcludeOp=function(x){var M=x.Prev;return M.Next=x.Next,x.Next.Prev=M,M.Idx=0,M},n.Clipper.CleanPolygon=function(x,M){typeof M>"u"&&(M=1.415);var P=x.length;if(P==0)return new Array;for(var V=new Array(P),H=0;H<P;++H)V[H]=new n.OutPt;for(var H=0;H<P;++H)V[H].Pt=x[H],V[H].Next=V[(H+1)%P],V[H].Next.Prev=V[H],V[H].Idx=0;for(var ne=M*M,le=V[0];le.Idx==0&&le.Next!=le.Prev;)n.Clipper.PointsAreClose(le.Pt,le.Prev.Pt,ne)?(le=n.Clipper.ExcludeOp(le),P--):n.Clipper.PointsAreClose(le.Prev.Pt,le.Next.Pt,ne)?(n.Clipper.ExcludeOp(le.Next),le=n.Clipper.ExcludeOp(le),P-=2):n.Clipper.SlopesNearCollinear(le.Prev.Pt,le.Pt,le.Next.Pt,ne)?(le=n.Clipper.ExcludeOp(le),P--):(le.Idx=1,le=le.Next);P<3&&(P=0);for(var ce=new Array(P),H=0;H<P;++H)ce[H]=new n.IntPoint(le.Pt),le=le.Next;return V=null,ce},n.Clipper.CleanPolygons=function(x,M){for(var P=new Array(x.length),V=0,H=x.length;V<H;V++)P[V]=n.Clipper.CleanPolygon(x[V],M);return P},n.Clipper.Minkowski=function(x,M,P,V){var H=V?1:0,ne=x.length,le=M.length,ce=new Array;if(P)for(var ze=0;ze<le;ze++){for(var qe=new Array(ne),mt=0,Ct=x.length,Bt=x[mt];mt<Ct;mt++,Bt=x[mt])qe[mt]=new n.IntPoint(M[ze].X+Bt.X,M[ze].Y+Bt.Y);ce.push(qe)}else for(var ze=0;ze<le;ze++){for(var qe=new Array(ne),mt=0,Ct=x.length,Bt=x[mt];mt<Ct;mt++,Bt=x[mt])qe[mt]=new n.IntPoint(M[ze].X-Bt.X,M[ze].Y-Bt.Y);ce.push(qe)}for(var Ut=new Array,ze=0;ze<le-1+H;ze++)for(var mt=0;mt<ne;mt++){var It=new Array;It.push(ce[ze%le][mt%ne]),It.push(ce[(ze+1)%le][mt%ne]),It.push(ce[(ze+1)%le][(mt+1)%ne]),It.push(ce[ze%le][(mt+1)%ne]),n.Clipper.Orientation(It)||It.reverse(),Ut.push(It)}var ei=new n.Clipper(0);return ei.AddPaths(Ut,n.PolyType.ptSubject,!0),ei.Execute(n.ClipType.ctUnion,ce,n.PolyFillType.pftNonZero,n.PolyFillType.pftNonZero),ce},n.Clipper.MinkowskiSum=function(){var x=arguments,M=x.length;if(M==3){var P=x[0],V=x[1],H=x[2];return n.Clipper.Minkowski(P,V,!0,H)}else if(M==4){for(var P=x[0],ne=x[1],le=x[2],H=x[3],ce=new n.Clipper,ze,qe=0,mt=ne.length;qe<mt;++qe){var ze=n.Clipper.Minkowski(P,ne[qe],!0,H);ce.AddPaths(ze,n.PolyType.ptSubject,!0)}H&&ce.AddPaths(ne,n.PolyType.ptClip,!0);var Ct=new n.Paths;return ce.Execute(n.ClipType.ctUnion,Ct,le,le),Ct}},n.Clipper.MinkowskiDiff=function(x,M,P){return n.Clipper.Minkowski(x,M,!1,P)},n.Clipper.PolyTreeToPaths=function(x){var M=new Array;return n.Clipper.AddPolyNodeToPaths(x,n.Clipper.NodeType.ntAny,M),M},n.Clipper.AddPolyNodeToPaths=function(x,M,P){var V=!0;switch(M){case n.Clipper.NodeType.ntOpen:return;case n.Clipper.NodeType.ntClosed:V=!x.IsOpen;break}x.m_polygon.length>0&&V&&P.push(x.m_polygon);for(var H=0,ne=x.Childs(),le=ne.length,ce=ne[H];H<le;H++,ce=ne[H])n.Clipper.AddPolyNodeToPaths(ce,M,P)},n.Clipper.OpenPathsFromPolyTree=function(x){for(var M=new n.Paths,P=0,V=x.ChildCount();P<V;P++)x.Childs()[P].IsOpen&&M.push(x.Childs()[P].m_polygon);return M},n.Clipper.ClosedPathsFromPolyTree=function(x){var M=new n.Paths;return n.Clipper.AddPolyNodeToPaths(x,n.Clipper.NodeType.ntClosed,M),M},Li(n.Clipper,n.ClipperBase),n.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2},n.ClipperOffset=function(x,M){typeof x>"u"&&(x=2),typeof M>"u"&&(M=n.ClipperOffset.def_arc_tolerance),this.m_destPolys=new n.Paths,this.m_srcPoly=new n.Path,this.m_destPoly=new n.Path,this.m_normals=new Array,this.m_delta=0,this.m_sinA=0,this.m_sin=0,this.m_cos=0,this.m_miterLim=0,this.m_StepsPerRad=0,this.m_lowest=new n.IntPoint,this.m_polyNodes=new n.PolyNode,this.MiterLimit=x,this.ArcTolerance=M,this.m_lowest.X=-1},n.ClipperOffset.two_pi=6.28318530717959,n.ClipperOffset.def_arc_tolerance=.25,n.ClipperOffset.prototype.Clear=function(){n.Clear(this.m_polyNodes.Childs()),this.m_lowest.X=-1},n.ClipperOffset.Round=n.Clipper.Round,n.ClipperOffset.prototype.AddPath=function(x,M,P){var V=x.length-1;if(!(V<0)){var H=new n.PolyNode;if(H.m_jointype=M,H.m_endtype=P,P==n.EndType.etClosedLine||P==n.EndType.etClosedPolygon)for(;V>0&&n.IntPoint.op_Equality(x[0],x[V]);)V--;H.m_polygon.push(x[0]);for(var ne=0,le=0,ce=1;ce<=V;ce++)n.IntPoint.op_Inequality(H.m_polygon[ne],x[ce])&&(ne++,H.m_polygon.push(x[ce]),(x[ce].Y>H.m_polygon[le].Y||x[ce].Y==H.m_polygon[le].Y&&x[ce].X<H.m_polygon[le].X)&&(le=ne));if(!(P==n.EndType.etClosedPolygon&&ne<2||P!=n.EndType.etClosedPolygon&&ne<0)&&(this.m_polyNodes.AddChild(H),P==n.EndType.etClosedPolygon))if(this.m_lowest.X<0)this.m_lowest=new n.IntPoint(0,le);else{var ze=this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon[this.m_lowest.Y];(H.m_polygon[le].Y>ze.Y||H.m_polygon[le].Y==ze.Y&&H.m_polygon[le].X<ze.X)&&(this.m_lowest=new n.IntPoint(this.m_polyNodes.ChildCount()-1,le))}}},n.ClipperOffset.prototype.AddPaths=function(x,M,P){for(var V=0,H=x.length;V<H;V++)this.AddPath(x[V],M,P)},n.ClipperOffset.prototype.FixOrientations=function(){if(this.m_lowest.X>=0&&!n.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon))for(var x=0;x<this.m_polyNodes.ChildCount();x++){var M=this.m_polyNodes.Childs()[x];(M.m_endtype==n.EndType.etClosedPolygon||M.m_endtype==n.EndType.etClosedLine&&n.Clipper.Orientation(M.m_polygon))&&M.m_polygon.reverse()}else for(var x=0;x<this.m_polyNodes.ChildCount();x++){var M=this.m_polyNodes.Childs()[x];M.m_endtype==n.EndType.etClosedLine&&!n.Clipper.Orientation(M.m_polygon)&&M.m_polygon.reverse()}},n.ClipperOffset.GetUnitNormal=function(x,M){var P=M.X-x.X,V=M.Y-x.Y;if(P==0&&V==0)return new n.DoublePoint(0,0);var H=1/Math.sqrt(P*P+V*V);return P*=H,V*=H,new n.DoublePoint(V,-P)},n.ClipperOffset.prototype.DoOffset=function(x){if(this.m_destPolys=new Array,this.m_delta=x,n.ClipperBase.near_zero(x)){for(var M=0;M<this.m_polyNodes.ChildCount();M++){var P=this.m_polyNodes.Childs()[M];P.m_endtype==n.EndType.etClosedPolygon&&this.m_destPolys.push(P.m_polygon)}return}this.MiterLimit>2?this.m_miterLim=2/(this.MiterLimit*this.MiterLimit):this.m_miterLim=.5;var V;this.ArcTolerance<=0?V=n.ClipperOffset.def_arc_tolerance:this.ArcTolerance>Math.abs(x)*n.ClipperOffset.def_arc_tolerance?V=Math.abs(x)*n.ClipperOffset.def_arc_tolerance:V=this.ArcTolerance;var H=3.14159265358979/Math.acos(1-V/Math.abs(x));this.m_sin=Math.sin(n.ClipperOffset.two_pi/H),this.m_cos=Math.cos(n.ClipperOffset.two_pi/H),this.m_StepsPerRad=H/n.ClipperOffset.two_pi,x<0&&(this.m_sin=-this.m_sin);for(var M=0;M<this.m_polyNodes.ChildCount();M++){var P=this.m_polyNodes.Childs()[M];this.m_srcPoly=P.m_polygon;var ne=this.m_srcPoly.length;if(!(ne==0||x<=0&&(ne<3||P.m_endtype!=n.EndType.etClosedPolygon))){if(this.m_destPoly=new Array,ne==1){if(P.m_jointype==n.JoinType.jtRound)for(var le=1,ce=0,ze=1;ze<=H;ze++){this.m_destPoly.push(new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[0].X+le*x),n.ClipperOffset.Round(this.m_srcPoly[0].Y+ce*x)));var qe=le;le=le*this.m_cos-this.m_sin*ce,ce=qe*this.m_sin+ce*this.m_cos}else for(var le=-1,ce=-1,ze=0;ze<4;++ze)this.m_destPoly.push(new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[0].X+le*x),n.ClipperOffset.Round(this.m_srcPoly[0].Y+ce*x))),le<0?le=1:ce<0?ce=1:le=-1;this.m_destPolys.push(this.m_destPoly);continue}this.m_normals.length=0;for(var ze=0;ze<ne-1;ze++)this.m_normals.push(n.ClipperOffset.GetUnitNormal(this.m_srcPoly[ze],this.m_srcPoly[ze+1]));if(P.m_endtype==n.EndType.etClosedLine||P.m_endtype==n.EndType.etClosedPolygon?this.m_normals.push(n.ClipperOffset.GetUnitNormal(this.m_srcPoly[ne-1],this.m_srcPoly[0])):this.m_normals.push(new n.DoublePoint(this.m_normals[ne-2])),P.m_endtype==n.EndType.etClosedPolygon){for(var mt=ne-1,ze=0;ze<ne;ze++)mt=this.OffsetPoint(ze,mt,P.m_jointype);this.m_destPolys.push(this.m_destPoly)}else if(P.m_endtype==n.EndType.etClosedLine){for(var mt=ne-1,ze=0;ze<ne;ze++)mt=this.OffsetPoint(ze,mt,P.m_jointype);this.m_destPolys.push(this.m_destPoly),this.m_destPoly=new Array;for(var Ct=this.m_normals[ne-1],ze=ne-1;ze>0;ze--)this.m_normals[ze]=new n.DoublePoint(-this.m_normals[ze-1].X,-this.m_normals[ze-1].Y);this.m_normals[0]=new n.DoublePoint(-Ct.X,-Ct.Y),mt=0;for(var ze=ne-1;ze>=0;ze--)mt=this.OffsetPoint(ze,mt,P.m_jointype);this.m_destPolys.push(this.m_destPoly)}else{for(var mt=0,ze=1;ze<ne-1;++ze)mt=this.OffsetPoint(ze,mt,P.m_jointype);var Bt;if(P.m_endtype==n.EndType.etOpenButt){var ze=ne-1;Bt=new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[ze].X+this.m_normals[ze].X*x),n.ClipperOffset.Round(this.m_srcPoly[ze].Y+this.m_normals[ze].Y*x)),this.m_destPoly.push(Bt),Bt=new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[ze].X-this.m_normals[ze].X*x),n.ClipperOffset.Round(this.m_srcPoly[ze].Y-this.m_normals[ze].Y*x)),this.m_destPoly.push(Bt)}else{var ze=ne-1;mt=ne-2,this.m_sinA=0,this.m_normals[ze]=new n.DoublePoint(-this.m_normals[ze].X,-this.m_normals[ze].Y),P.m_endtype==n.EndType.etOpenSquare?this.DoSquare(ze,mt):this.DoRound(ze,mt)}for(var ze=ne-1;ze>0;ze--)this.m_normals[ze]=new n.DoublePoint(-this.m_normals[ze-1].X,-this.m_normals[ze-1].Y);this.m_normals[0]=new n.DoublePoint(-this.m_normals[1].X,-this.m_normals[1].Y),mt=ne-1;for(var ze=mt-1;ze>0;--ze)mt=this.OffsetPoint(ze,mt,P.m_jointype);P.m_endtype==n.EndType.etOpenButt?(Bt=new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[0].X-this.m_normals[0].X*x),n.ClipperOffset.Round(this.m_srcPoly[0].Y-this.m_normals[0].Y*x)),this.m_destPoly.push(Bt),Bt=new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[0].X+this.m_normals[0].X*x),n.ClipperOffset.Round(this.m_srcPoly[0].Y+this.m_normals[0].Y*x)),this.m_destPoly.push(Bt)):(mt=1,this.m_sinA=0,P.m_endtype==n.EndType.etOpenSquare?this.DoSquare(0,1):this.DoRound(0,1)),this.m_destPolys.push(this.m_destPoly)}}}},n.ClipperOffset.prototype.Execute=function(){var x=arguments,M=x[0]instanceof n.PolyTree;if(M){var P=x[0],V=x[1];P.Clear(),this.FixOrientations(),this.DoOffset(V);var H=new n.Clipper(0);if(H.AddPaths(this.m_destPolys,n.PolyType.ptSubject,!0),V>0)H.Execute(n.ClipType.ctUnion,P,n.PolyFillType.pftPositive,n.PolyFillType.pftPositive);else{var ne=n.Clipper.GetBounds(this.m_destPolys),le=new n.Path;if(le.push(new n.IntPoint(ne.left-10,ne.bottom+10)),le.push(new n.IntPoint(ne.right+10,ne.bottom+10)),le.push(new n.IntPoint(ne.right+10,ne.top-10)),le.push(new n.IntPoint(ne.left-10,ne.top-10)),H.AddPath(le,n.PolyType.ptSubject,!0),H.ReverseSolution=!0,H.Execute(n.ClipType.ctUnion,P,n.PolyFillType.pftNegative,n.PolyFillType.pftNegative),P.ChildCount()==1&&P.Childs()[0].ChildCount()>0){var ce=P.Childs()[0];P.Childs()[0]=ce.Childs()[0];for(var ze=1;ze<ce.ChildCount();ze++)P.AddChild(ce.Childs()[ze])}else P.Clear()}}else{var P=x[0],V=x[1];n.Clear(P),this.FixOrientations(),this.DoOffset(V);var H=new n.Clipper(0);if(H.AddPaths(this.m_destPolys,n.PolyType.ptSubject,!0),V>0)H.Execute(n.ClipType.ctUnion,P,n.PolyFillType.pftPositive,n.PolyFillType.pftPositive);else{var ne=n.Clipper.GetBounds(this.m_destPolys),le=new n.Path;le.push(new n.IntPoint(ne.left-10,ne.bottom+10)),le.push(new n.IntPoint(ne.right+10,ne.bottom+10)),le.push(new n.IntPoint(ne.right+10,ne.top-10)),le.push(new n.IntPoint(ne.left-10,ne.top-10)),H.AddPath(le,n.PolyType.ptSubject,!0),H.ReverseSolution=!0,H.Execute(n.ClipType.ctUnion,P,n.PolyFillType.pftNegative,n.PolyFillType.pftNegative),P.length>0&&P.splice(0,1)}}},n.ClipperOffset.prototype.OffsetPoint=function(x,M,P){if(this.m_sinA=this.m_normals[M].X*this.m_normals[x].Y-this.m_normals[x].X*this.m_normals[M].Y,this.m_sinA<5e-5&&this.m_sinA>-5e-5)return M;if(this.m_sinA>1?this.m_sinA=1:this.m_sinA<-1&&(this.m_sinA=-1),this.m_sinA*this.m_delta<0)this.m_destPoly.push(new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[x].X+this.m_normals[M].X*this.m_delta),n.ClipperOffset.Round(this.m_srcPoly[x].Y+this.m_normals[M].Y*this.m_delta))),this.m_destPoly.push(new n.IntPoint(this.m_srcPoly[x])),this.m_destPoly.push(new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[x].X+this.m_normals[x].X*this.m_delta),n.ClipperOffset.Round(this.m_srcPoly[x].Y+this.m_normals[x].Y*this.m_delta)));else switch(P){case n.JoinType.jtMiter:{var V=1+(this.m_normals[x].X*this.m_normals[M].X+this.m_normals[x].Y*this.m_normals[M].Y);V>=this.m_miterLim?this.DoMiter(x,M,V):this.DoSquare(x,M);break}case n.JoinType.jtSquare:this.DoSquare(x,M);break;case n.JoinType.jtRound:this.DoRound(x,M);break}return M=x,M},n.ClipperOffset.prototype.DoSquare=function(x,M){var P=Math.tan(Math.atan2(this.m_sinA,this.m_normals[M].X*this.m_normals[x].X+this.m_normals[M].Y*this.m_normals[x].Y)/4);this.m_destPoly.push(new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[x].X+this.m_delta*(this.m_normals[M].X-this.m_normals[M].Y*P)),n.ClipperOffset.Round(this.m_srcPoly[x].Y+this.m_delta*(this.m_normals[M].Y+this.m_normals[M].X*P)))),this.m_destPoly.push(new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[x].X+this.m_delta*(this.m_normals[x].X+this.m_normals[x].Y*P)),n.ClipperOffset.Round(this.m_srcPoly[x].Y+this.m_delta*(this.m_normals[x].Y-this.m_normals[x].X*P))))},n.ClipperOffset.prototype.DoMiter=function(x,M,P){var V=this.m_delta/P;this.m_destPoly.push(new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[x].X+(this.m_normals[M].X+this.m_normals[x].X)*V),n.ClipperOffset.Round(this.m_srcPoly[x].Y+(this.m_normals[M].Y+this.m_normals[x].Y)*V)))},n.ClipperOffset.prototype.DoRound=function(x,M){for(var P=Math.atan2(this.m_sinA,this.m_normals[M].X*this.m_normals[x].X+this.m_normals[M].Y*this.m_normals[x].Y),V=n.Cast_Int32(n.ClipperOffset.Round(this.m_StepsPerRad*Math.abs(P))),H=this.m_normals[M].X,ne=this.m_normals[M].Y,le,ce=0;ce<V;++ce)this.m_destPoly.push(new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[x].X+H*this.m_delta),n.ClipperOffset.Round(this.m_srcPoly[x].Y+ne*this.m_delta))),le=H,H=H*this.m_cos-this.m_sin*ne,ne=le*this.m_sin+ne*this.m_cos;this.m_destPoly.push(new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[x].X+this.m_normals[x].X*this.m_delta),n.ClipperOffset.Round(this.m_srcPoly[x].Y+this.m_normals[x].Y*this.m_delta)))},n.Error=function(x){try{throw new Error(x)}catch(M){alert(M.message)}},n.JS={},n.JS.AreaOfPolygon=function(x,M){return M||(M=1),n.Clipper.Area(x)/(M*M)},n.JS.AreaOfPolygons=function(x,M){M||(M=1);for(var P=0,V=0;V<x.length;V++)P+=n.Clipper.Area(x[V]);return P/(M*M)},n.JS.BoundsOfPath=function(x,M){return n.JS.BoundsOfPaths([x],M)},n.JS.BoundsOfPaths=function(x,M){M||(M=1);var P=n.Clipper.GetBounds(x);return P.left/=M,P.bottom/=M,P.right/=M,P.top/=M,P},n.JS.Clean=function(V,M){if(!(V instanceof Array))return[];var P=V[0]instanceof Array,V=n.JS.Clone(V);if(typeof M!="number"||M===null)return n.Error("Delta is not a number in Clean()."),V;if(V.length===0||V.length==1&&V[0].length===0||M<0)return V;P||(V=[V]);for(var H=V.length,ne,le,ce,ze,qe,mt,Ct,Bt=[],Ut=0;Ut<H;Ut++)if(le=V[Ut],ne=le.length,ne!==0){if(ne<3){ce=le,Bt.push(ce);continue}for(ce=le,ze=M*M,qe=le[0],mt=1,Ct=1;Ct<ne;Ct++)(le[Ct].X-qe.X)*(le[Ct].X-qe.X)+(le[Ct].Y-qe.Y)*(le[Ct].Y-qe.Y)<=ze||(ce[mt]=le[Ct],qe=le[Ct],mt++);qe=le[mt-1],(le[0].X-qe.X)*(le[0].X-qe.X)+(le[0].Y-qe.Y)*(le[0].Y-qe.Y)<=ze&&mt--,mt<ne&&ce.splice(mt,ne-mt),ce.length&&Bt.push(ce)}return!P&&Bt.length?Bt=Bt[0]:!P&&Bt.length===0?Bt=[]:P&&Bt.length===0&&(Bt=[[]]),Bt},n.JS.Clone=function(x){if(!(x instanceof Array))return[];if(x.length===0)return[];if(x.length==1&&x[0].length===0)return[[]];var M=x[0]instanceof Array;M||(x=[x]);var P=x.length,V,H,ne,le,ce=new Array(P);for(H=0;H<P;H++){for(V=x[H].length,le=new Array(V),ne=0;ne<V;ne++)le[ne]={X:x[H][ne].X,Y:x[H][ne].Y};ce[H]=le}return M||(ce=ce[0]),ce},n.JS.Lighten=function(x,M){if(!(x instanceof Array))return[];if(typeof M!="number"||M===null)return n.Error("Tolerance is not a number in Lighten()."),n.JS.Clone(x);if(x.length===0||x.length==1&&x[0].length===0||M<0)return n.JS.Clone(x);x[0]instanceof Array||(x=[x]);var P,V,H,ne,le,ce,ze,qe,mt,Ct,Bt,Ut,It,ei,Nn,rr,Pn,xs=x.length,zr=M*M,Bi=[];for(P=0;P<xs;P++)if(H=x[P],ce=H.length,ce!=0){for(ne=0;ne<1e6;ne++){for(le=[],ce=H.length,H[ce-1].X!=H[0].X||H[ce-1].Y!=H[0].Y?(Ut=1,H.push({X:H[0].X,Y:H[0].Y}),ce=H.length):Ut=0,Bt=[],V=0;V<ce-2;V++)ze=H[V],mt=H[V+1],qe=H[V+2],rr=ze.X,Pn=ze.Y,It=qe.X-rr,ei=qe.Y-Pn,(It!==0||ei!==0)&&(Nn=((mt.X-rr)*It+(mt.Y-Pn)*ei)/(It*It+ei*ei),Nn>1?(rr=qe.X,Pn=qe.Y):Nn>0&&(rr+=It*Nn,Pn+=ei*Nn)),It=mt.X-rr,ei=mt.Y-Pn,Ct=It*It+ei*ei,Ct<=zr&&(Bt[V+1]=1,V++);for(le.push({X:H[0].X,Y:H[0].Y}),V=1;V<ce-1;V++)Bt[V]||le.push({X:H[V].X,Y:H[V].Y});if(le.push({X:H[ce-1].X,Y:H[ce-1].Y}),Ut&&H.pop(),Bt.length)H=le;else break}ce=le.length,le[ce-1].X==le[0].X&&le[ce-1].Y==le[0].Y&&le.pop(),le.length>2&&Bi.push(le)}return!x[0]instanceof Array&&(Bi=Bi[0]),typeof Bi>"u"&&(Bi=[[]]),Bi},n.JS.PerimeterOfPath=function(x,M,P){if(typeof x>"u")return 0;var V=Math.sqrt,H=0,ne,le,ce=0,ze=0,qe=0,mt=0,Ct=x.length;if(Ct<2)return 0;for(M&&(x[Ct]=x[0],Ct++);--Ct;)ne=x[Ct],ce=ne.X,ze=ne.Y,le=x[Ct-1],qe=le.X,mt=le.Y,H+=V((ce-qe)*(ce-qe)+(ze-mt)*(ze-mt));return M&&x.pop(),H/P},n.JS.PerimeterOfPaths=function(x,M,P){P||(P=1);for(var V=0,H=0;H<x.length;H++)V+=n.JS.PerimeterOfPath(x[H],M,P);return V},n.JS.ScaleDownPath=function(x,M){var P,V;for(M||(M=1),P=x.length;P--;)V=x[P],V.X=V.X/M,V.Y=V.Y/M},n.JS.ScaleDownPaths=function(x,M){var P,V,H;for(M||(M=1),P=x.length;P--;)for(V=x[P].length;V--;)H=x[P][V],H.X=H.X/M,H.Y=H.Y/M},n.JS.ScaleUpPath=function(x,M){var P,V,H=Math.round;for(M||(M=1),P=x.length;P--;)V=x[P],V.X=H(V.X*M),V.Y=H(V.Y*M)},n.JS.ScaleUpPaths=function(x,M){var P,V,H,ne=Math.round;for(M||(M=1),P=x.length;P--;)for(V=x[P].length;V--;)H=x[P][V],H.X=ne(H.X*M),H.Y=ne(H.Y*M)},n.ExPolygons=function(){return[]},n.ExPolygon=function(){this.outer=null,this.holes=null},n.JS.AddOuterPolyNodeToExPolygons=function(x,M){var P=new n.ExPolygon;P.outer=x.Contour();var V=x.Childs(),H=V.length;P.holes=new Array(H);var ne,le,ce,ze,qe,mt;for(ce=0;ce<H;ce++)for(ne=V[ce],P.holes[ce]=ne.Contour(),ze=0,qe=ne.Childs(),mt=qe.length;ze<mt;ze++)le=qe[ze],n.JS.AddOuterPolyNodeToExPolygons(le,M);M.push(P)},n.JS.ExPolygonsToPaths=function(x){var M,P,V,H,ne=new n.Paths;for(M=0,V=x.length;M<V;M++)for(ne.push(x[M].outer),P=0,H=x[M].holes.length;P<H;P++)ne.push(x[M].holes[P]);return ne},n.JS.PolyTreeToExPolygons=function(x){var M=new n.ExPolygons,P,V,H,ne;for(V=0,H=x.Childs(),ne=H.length;V<ne;V++)P=H[V],n.JS.AddOuterPolyNodeToExPolygons(P,M);return M},e.exports=n}),Cwe=Et((i,e)=>{R(),function(){function t(u,h){var d=u.x-h.x,f=u.y-h.y;return d*d+f*f}l(t,"getSqDist");function n(u,h,d){var f=h.x,m=h.y,v=d.x-f,b=d.y-m;if(v!==0||b!==0){var w=((u.x-f)*v+(u.y-m)*b)/(v*v+b*b);w>1?(f=d.x,m=d.y):w>0&&(f+=v*w,m+=b*w)}return v=u.x-f,b=u.y-m,v*v+b*b}l(n,"getSqSegDist");function r(u,h){for(var d=u[0],f=[d],m,v=1,b=u.length;v<b;v++)m=u[v],t(m,d)>h&&(f.push(m),d=m);return d!==m&&f.push(m),f}l(r,"simplifyRadialDist");function a(u,h,d,f,m){for(var v=f,b,w=h+1;w<d;w++){var A=n(u[w],u[h],u[d]);A>v&&(b=w,v=A)}v>f&&(b-h>1&&a(u,h,b,f,m),m.push(u[b]),d-b>1&&a(u,b,d,f,m))}l(a,"simplifyDPStep");function o(u,h){var d=u.length-1,f=[u[0]];return a(u,0,d,h,f),f.push(u[d]),f}l(o,"simplifyDouglasPeucker");function s(u,h,d){if(u.length<=2)return u;var f=h!==void 0?h*h:1;return u=d?u:r(u,f),u=o(u,f),u}l(s,"simplify"),typeof define=="function"&&define.amd?define(function(){return s}):typeof e<"u"?(e.exports=s,e.exports.default=s):typeof self<"u"?self.simplify=s:window.simplify=s}()});R();R();var Qee=class{constructor(e){D(this,"id"),this.id=e}};l(Qee,"BaseMetaData");var Xc=Qee;R();R();var TE=class Px{constructor(e,t,n){D(this,"__type",Px.__type),D(this,"id",Hn()),D(this,"latitude"),D(this,"longitude"),D(this,"floorId"),D(this,"verticalOffset");var r;if(typeof e=="object")this.latitude=e.latitude,this.longitude=e.longitude,this.floorId=e.floorId,this.verticalOffset=(r=e.verticalOffset)!=null?r:0;else{if(t==null)throw new Error("Coordinate longitude is required.");this.latitude=e,this.longitude=t,this.floorId=n,this.verticalOffset=0}}static is(e){return e.__type===Px.__type}get anchorTarget(){return this}get focusTarget(){return this}isEqual(e){return this.latitude===e.latitude&&this.longitude===e.longitude&&this.floorId===e.floorId}toJSON(){return{__type:Px.__type,latitude:this.latitude,longitude:this.longitude,floorId:this.floorId,verticalOffset:this.verticalOffset}}destroy(){}};l(TE,"Coordinate"),D(TE,"__type","coordinate");var Ewe=TE,Wn=Ewe;R();R();R();function jc(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if(i.type==="Feature"&&i.geometry!==null&&i.geometry.type==="Point")return i.geometry.coordinates;if(i.type==="Point")return i.coordinates}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return i;throw new Error("coord must be GeoJSON Point or an Array of numbers")}l(jc,"getCoord");function gh(i){if(Array.isArray(i))return i;if(i.type==="Feature"){if(i.geometry!==null)return i.geometry.coordinates}else if(i.coordinates)return i.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}l(gh,"getCoords");function ete(i,e,t){if(!i)throw new Error("No feature passed");if(!t)throw new Error(".featureOf() requires a name");if(!i||i.type!=="Feature"||!i.geometry)throw new Error("Invalid input to "+t+", Feature with geometry required");if(!i.geometry||i.geometry.type!==e)throw new Error("Invalid input to "+t+": must be a "+e+", given "+i.geometry.type)}l(ete,"featureOf");function _0(i){return i.type==="Feature"?i.geometry:i}l(_0,"getGeom");function tte(i,e){return i.type==="FeatureCollection"?"FeatureCollection":i.type==="GeometryCollection"?"GeometryCollection":i.type==="Feature"&&i.geometry!==null?i.geometry.type:i.type}l(tte,"getType");ii(JL(),1);R();ii(U2e(),1);R();R();function yh(i,e,t){if(t===void 0&&(t={}),!i)throw new Error("point is required");if(!e)throw new Error("polygon is required");var n=jc(i),r=_0(e),a=r.type,o=e.bbox,s=r.coordinates;if(o&&ite(n,o)===!1)return!1;a==="Polygon"&&(s=[s]);for(var u=!1,h=0;h<s.length&&!u;h++)if(PE(n,s[h][0],t.ignoreBoundary)){for(var d=!1,f=1;f<s[h].length&&!d;)PE(n,s[h][f],!t.ignoreBoundary)&&(d=!0),f++;d||(u=!0)}return u}l(yh,"booleanPointInPolygon");function PE(i,e,t){var n=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var r=0,a=e.length-1;r<e.length;a=r++){var o=e[r][0],s=e[r][1],u=e[a][0],h=e[a][1],d=i[1]*(o-u)+s*(u-i[0])+h*(i[0]-o)===0&&(o-i[0])*(u-i[0])<=0&&(s-i[1])*(h-i[1])<=0;if(d)return!t;var f=s>i[1]!=h>i[1]&&i[0]<(u-o)*(i[1]-s)/(h-s)+o;f&&(n=!n)}return n}l(PE,"inRing");function ite(i,e){return e[0]<=i[0]&&e[1]<=i[1]&&e[2]>=i[0]&&e[3]>=i[1]}l(ite,"inBBox");R();R();function nte(i,e,t){t===void 0&&(t={});var n=jc(i),r=jc(e),a=Fs(r[1]-n[1]),o=Fs(r[0]-n[0]),s=Fs(n[1]),u=Fs(r[1]),h=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(o/2),2)*Math.cos(s)*Math.cos(u);return GQ(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)),t.units)}l(nte,"distance");var Mf=nte;R();(function(){function i(e,t,n){this.a=e,this.b=t,this.c=n;var r=t.x-e.x,a=t.y-e.y,o=n.x-e.x,s=n.y-e.y,u=r*(e.x+t.x)+a*(e.y+t.y),h=o*(e.x+n.x)+s*(e.y+n.y),d=2*(r*(n.y-t.y)-a*(n.x-t.x)),f,m;this.x=(s*u-a*h)/d,this.y=(r*h-o*u)/d,f=this.x-e.x,m=this.y-e.y,this.r=f*f+m*m}return l(i,"Triangle"),i})();R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();ii(Cee(),1);R();R();R();R();R();(function(){function i(e){this.points=e.points||[],this.duration=e.duration||1e4,this.sharpness=e.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=e.stepLength||60,this.length=this.points.length,this.delay=0;for(var t=0;t<this.length;t++)this.points[t].z=this.points[t].z||0;for(var t=0;t<this.length-1;t++){var n=this.points[t],r=this.points[t+1];this.centers.push({x:(n.x+r.x)/2,y:(n.y+r.y)/2,z:(n.z+r.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(var t=0;t<this.centers.length-1;t++){var a=this.points[t+1].x-(this.centers[t].x+this.centers[t+1].x)/2,o=this.points[t+1].y-(this.centers[t].y+this.centers[t+1].y)/2,s=this.points[t+1].z-(this.centers[t].y+this.centers[t+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[t+1].x+this.sharpness*(this.centers[t].x+a),y:(1-this.sharpness)*this.points[t+1].y+this.sharpness*(this.centers[t].y+o),z:(1-this.sharpness)*this.points[t+1].z+this.sharpness*(this.centers[t].z+s)},{x:(1-this.sharpness)*this.points[t+1].x+this.sharpness*(this.centers[t+1].x+a),y:(1-this.sharpness)*this.points[t+1].y+this.sharpness*(this.centers[t+1].y+o),z:(1-this.sharpness)*this.points[t+1].z+this.sharpness*(this.centers[t+1].z+s)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}return l(i,"Spline"),i.prototype.cacheSteps=function(e){var t=[],n=this.pos(0);t.push(0);for(var r=0;r<this.duration;r+=10){var a=this.pos(r),o=Math.sqrt((a.x-n.x)*(a.x-n.x)+(a.y-n.y)*(a.y-n.y)+(a.z-n.z)*(a.z-n.z));o>e&&(t.push(r),n=a)}return t},i.prototype.vector=function(e){var t=this.pos(e+10),n=this.pos(e-10);return{angle:180*Math.atan2(t.y-n.y,t.x-n.x)/3.14,speed:Math.sqrt((n.x-t.x)*(n.x-t.x)+(n.y-t.y)*(n.y-t.y)+(n.z-t.z)*(n.z-t.z))}},i.prototype.pos=function(e){var t=e-this.delay;t<0&&(t=0),t>this.duration&&(t=this.duration-1);var n=t/this.duration;if(n>=1)return this.points[this.length-1];var r=Math.floor((this.points.length-1)*n),a=(this.length-1)*n-r;return rte(a,this.points[r],this.controls[r][1],this.controls[r+1][0],this.points[r+1])},i})();function rte(i,e,t,n,r){var a=ate(i),o={x:r.x*a[0]+n.x*a[1]+t.x*a[2]+e.x*a[3],y:r.y*a[0]+n.y*a[1]+t.y*a[2]+e.y*a[3],z:r.z*a[0]+n.z*a[1]+t.z*a[2]+e.z*a[3]};return o}l(rte,"bezier");function ate(i){var e=i*i,t=e*i;return[t,3*e*(1-i),3*i*(1-i)*(1-i),(1-i)*(1-i)*(1-i)]}l(ate,"B");R();R();R();R();function ote(i,e){e===void 0&&(e={});var t=Number(i[0]),n=Number(i[1]),r=Number(i[2]),a=Number(i[3]);if(i.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var o=[t,n],s=[t,a],u=[r,a],h=[r,n];return Zm([[o,h,u,s,o]],e.properties,{bbox:i,id:e.id})}l(ote,"bboxPolygon");function ste(i){return ote(m0(i))}l(ste,"envelope");var Iwe=ste;R();R();R();function v1(i,e,t,n){n===void 0&&(n={});var r=jc(i),a=Fs(r[0]),o=Fs(r[1]),s=Fs(t),u=$Q(e,n.units),h=Math.asin(Math.sin(o)*Math.cos(u)+Math.cos(o)*Math.sin(u)*Math.cos(s)),d=a+Math.atan2(Math.sin(s)*Math.sin(u)*Math.cos(o),Math.cos(u)-Math.sin(o)*Math.sin(h)),f=fw(d),m=fw(h);return ph([f,m],n.properties)}l(v1,"destination");R();R();function oD(i,e,t){if(t===void 0&&(t={}),t.final===!0)return lte(i,e);var n=jc(i),r=jc(e),a=Fs(n[0]),o=Fs(r[0]),s=Fs(n[1]),u=Fs(r[1]),h=Math.sin(o-a)*Math.cos(u),d=Math.cos(s)*Math.sin(u)-Math.sin(s)*Math.cos(u)*Math.cos(o-a);return fw(Math.atan2(h,d))}l(oD,"bearing");function lte(i,e){var t=oD(e,i);return t=(t+180)%360,t}l(lte,"calculateFinalBearing");R();function ute(i,e){e===void 0&&(e={});var t=m0(i),n=(t[0]+t[2])/2,r=(t[1]+t[3])/2;return ph([n,r],e.properties,e)}l(ute,"center");var sD=ute;R();R();R();R();R();ii(QP(),1);R();R();R();R();function hte(i){if(!i)throw new Error("geojson is required");var e=[];return mh(i,function(t){cte(t,e)}),m1(e)}l(hte,"lineSegment");function cte(i,e){var t=[],n=i.geometry;if(n!==null){switch(n.type){case"Polygon":t=gh(n);break;case"LineString":t=[gh(n)]}t.forEach(function(r){var a=pte(r,i.properties);a.forEach(function(o){o.id=e.length,e.push(o)})})}}l(cte,"lineSegmentFeature");function pte(i,e){var t=[];return i.reduce(function(n,r){var a=Vc([n,r],e);return a.bbox=dte(n,r),t.push(a),r}),t}l(pte,"createSegments");function dte(i,e){var t=i[0],n=i[1],r=e[0],a=e[1],o=t<r?t:r,s=n<a?n:a,u=t>r?t:r,h=n>a?n:a;return[o,s,u,h]}l(dte,"bbox");var IR=hte,Twe=ii(KL(),1);function fte(i,e){var t={},n=[];if(i.type==="LineString"&&(i=xl(i)),e.type==="LineString"&&(e=xl(e)),i.type==="Feature"&&e.type==="Feature"&&i.geometry!==null&&e.geometry!==null&&i.geometry.type==="LineString"&&e.geometry.type==="LineString"&&i.geometry.coordinates.length===2&&e.geometry.coordinates.length===2){var r=LE(i,e);return r&&n.push(r),m1(n)}var a=(0,Twe.default)();return a.load(IR(e)),xE(IR(i),function(o){xE(a.search(o),function(s){var u=LE(o,s);if(u){var h=gh(u).join(",");t[h]||(t[h]=!0,n.push(u))}})}),m1(n)}l(fte,"lineIntersect");function LE(i,e){var t=gh(i),n=gh(e);if(t.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(n.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var r=t[0][0],a=t[0][1],o=t[1][0],s=t[1][1],u=n[0][0],h=n[0][1],d=n[1][0],f=n[1][1],m=(f-h)*(o-r)-(d-u)*(s-a),v=(d-u)*(a-h)-(f-h)*(r-u),b=(o-r)*(a-h)-(s-a)*(r-u);if(m===0)return null;var w=v/m,A=b/m;if(w>=0&&w<=1&&A>=0&&A<=1){var E=r+w*(o-r),I=a+w*(s-a);return ph([E,I])}return null}l(LE,"intersects");var NA=fte;function mte(i,e,t){t===void 0&&(t={});var n=ph([1/0,1/0],{dist:1/0}),r=0;return mh(i,function(a){for(var o=gh(a),s=0;s<o.length-1;s++){var u=ph(o[s]);u.properties.dist=Mf(e,u,t);var h=ph(o[s+1]);h.properties.dist=Mf(e,h,t);var d=Mf(u,h,t),f=Math.max(u.properties.dist,h.properties.dist),m=oD(u,h),v=v1(e,f,m+90,t),b=v1(e,f,m-90,t),w=NA(Vc([v.geometry.coordinates,b.geometry.coordinates]),Vc([u.geometry.coordinates,h.geometry.coordinates])),A=null;w.features.length>0&&(A=w.features[0],A.properties.dist=Mf(e,A,t),A.properties.location=r+Mf(u,A,t)),u.properties.dist<n.properties.dist&&(n=u,n.properties.index=s,n.properties.location=r),h.properties.dist<n.properties.dist&&(n=h,n.properties.index=s+1,n.properties.location=r+d),A&&A.properties.dist<n.properties.dist&&(n=A,n.properties.index=s),r+=d}}),n}l(mte,"nearestPointOnLine");var DE=mte;R();R();R();ii(JL(),1);R();R();R();R();R();R();function kE(i,e){return e===void 0&&(e={}),XQ(i,function(t,n){var r=n.geometry.coordinates;return t+Mf(r[0],r[1],e)},0)}l(kE,"length");R();function gte(i,e,t){var n=gh(t);if(tte(t)!=="LineString")throw new Error("line must be a LineString");var r=DE(t,i),a=DE(t,e),o;r.properties.index<=a.properties.index?o=[r,a]:o=[a,r];for(var s=[o[0].geometry.coordinates],u=o[0].properties.index+1;u<o[1].properties.index+1;u++)s.push(n[u]);return s.push(o[1].geometry.coordinates),Vc(s,t.properties)}l(gte,"lineSlice");var TR=gte;R();R();R();R();function yte(i,e,t){t===void 0&&(t={});for(var n=jc(i),r=gh(e),a=0;a<r.length-1;a++){var o=!1;if(t.ignoreEndVertices&&(a===0&&(o="start"),a===r.length-2&&(o="end"),a===0&&a+1===r.length-1&&(o="both")),vte(r[a],r[a+1],n,o,typeof t.epsilon>"u"?null:t.epsilon))return!0}return!1}l(yte,"booleanPointOnLine");function vte(i,e,t,n,r){var a=t[0],o=t[1],s=i[0],u=i[1],h=e[0],d=e[1],f=t[0]-s,m=t[1]-u,v=h-s,b=d-u,w=f*b-m*v;if(r!==null){if(Math.abs(w)>r)return!1}else if(w!==0)return!1;if(n){if(n==="start")return Math.abs(v)>=Math.abs(b)?v>0?s<a&&a<=h:h<=a&&a<s:b>0?u<o&&o<=d:d<=o&&o<u;if(n==="end")return Math.abs(v)>=Math.abs(b)?v>0?s<=a&&a<h:h<a&&a<=s:b>0?u<=o&&o<d:d<o&&o<=u;if(n==="both")return Math.abs(v)>=Math.abs(b)?v>0?s<a&&a<h:h<a&&a<s:b>0?u<o&&o<d:d<o&&o<u}else return Math.abs(v)>=Math.abs(b)?v>0?s<=a&&a<=h:h<=a&&a<=s:b>0?u<=o&&o<=d:d<=o&&o<=u;return!1}l(vte,"isPointOnLineSegment");var Pwe=yte;R();R();R();R();ii(Cee(),1);R();var PR=Math.PI/180,LR=180/Math.PI,_1=l(function(i,e){this.lon=i,this.lat=e,this.x=PR*i,this.y=PR*e},"Coord");_1.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)};_1.prototype.antipode=function(){var i=-1*this.lat,e=this.lon<0?180+this.lon:(180-this.lon)*-1;return new _1(e,i)};var _te=l(function(){this.coords=[],this.length=0},"LineString");_te.prototype.move_to=function(i){this.length++,this.coords.push(i)};var lD=l(function(i){this.properties=i||{},this.geometries=[]},"Arc");lD.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(this.geometries.length===1)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var i=[],e=0;e<this.geometries.length;e++)i.push(this.geometries[e].coords);return{geometry:{type:"MultiLineString",coordinates:i},type:"Feature",properties:this.properties}};lD.prototype.wkt=function(){for(var i="",e="LINESTRING(",t=l(function(a){e+=a[0]+" "+a[1]+","},"collect"),n=0;n<this.geometries.length;n++){if(this.geometries[n].coords.length===0)return"LINESTRING(empty)";var r=this.geometries[n].coords;r.forEach(t),i+=e.substring(0,e.length-1)+")"}return i};var xte=l(function(i,e,t){if(!i||i.x===void 0||i.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!e||e.x===void 0||e.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new _1(i.x,i.y),this.end=new _1(e.x,e.y),this.properties=t||{};var n=this.start.x-this.end.x,r=this.start.y-this.end.y,a=Math.pow(Math.sin(r/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(n/2),2);if(this.g=2*Math.asin(Math.sqrt(a)),this.g===Math.PI)throw new Error("it appears "+i.view()+" and "+e.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+i+" and "+e)},"GreatCircle");xte.prototype.interpolate=function(i){var e=Math.sin((1-i)*this.g)/Math.sin(this.g),t=Math.sin(i*this.g)/Math.sin(this.g),n=e*Math.cos(this.start.y)*Math.cos(this.start.x)+t*Math.cos(this.end.y)*Math.cos(this.end.x),r=e*Math.cos(this.start.y)*Math.sin(this.start.x)+t*Math.cos(this.end.y)*Math.sin(this.end.x),a=e*Math.sin(this.start.y)+t*Math.sin(this.end.y),o=LR*Math.atan2(a,Math.sqrt(Math.pow(n,2)+Math.pow(r,2))),s=LR*Math.atan2(r,n);return[s,o]};xte.prototype.Arc=function(i,e){var t=[];if(!i||i<=2)t.push([this.start.lon,this.start.lat]),t.push([this.end.lon,this.end.lat]);else for(var n=1/(i-1),r=0;r<i;++r){var a=n*r,o=this.interpolate(a);t.push(o)}for(var s=!1,u=0,h=e&&e.offset?e.offset:10,d=180-h,f=-180+h,m=360-h,v=1;v<t.length;++v){var b=t[v-1][0],w=t[v][0],A=Math.abs(w-b);A>m&&(w>d&&b<f||b>d&&w<f)?s=!0:A>u&&(u=A)}var E=[];if(s&&u<h){var I=[];E.push(I);for(var C=0;C<t.length;++C){var T=parseFloat(t[C][0]);if(C>0&&Math.abs(T-t[C-1][0])>m){var k=parseFloat(t[C-1][0]),F=parseFloat(t[C-1][1]),B=parseFloat(t[C][0]),N=parseFloat(t[C][1]);if(k>-180&&k<f&&B===180&&C+1<t.length&&t[C-1][0]>-180&&t[C-1][0]<f){I.push([-180,t[C][1]]),C++,I.push([t[C][0],t[C][1]]);continue}else if(k>d&&k<180&&B===-180&&C+1<t.length&&t[C-1][0]>d&&t[C-1][0]<180){I.push([180,t[C][1]]),C++,I.push([t[C][0],t[C][1]]);continue}if(k<f&&B>d){var z=k;k=B,B=z;var L=F;F=N,N=L}if(k>d&&B<f&&(B+=360),k<=180&&B>=180&&k<B){var j=(180-k)/(B-k),q=j*N+(1-j)*F;I.push([t[C-1][0]>d?180:-180,q]),I=[],I.push([t[C-1][0]>d?-180:180,q]),E.push(I)}else I=[],E.push(I);I.push([T,t[C][1]])}else I.push([t[C][0],t[C][1]])}}else{var Z=[];E.push(Z);for(var O=0;O<t.length;++O)Z.push([t[O][0],t[O][1]])}for(var Y=new lD(this.properties),J=0;J<E.length;++J){var oe=new _te;Y.geometries.push(oe);for(var $=E[J],K=0;K<$.length;++K)oe.move_to($[K])}return Y};R();ii(KL(),1);R();R();function yw(i,e){e===void 0&&(e={});var t=_0(i);switch(!e.properties&&i.type==="Feature"&&(e.properties=i.properties),t.type){case"Polygon":return bte(t,e);case"MultiPolygon":return wte(t,e);default:throw new Error("invalid poly")}}l(yw,"default");function bte(i,e){e===void 0&&(e={});var t=_0(i),n=t.coordinates,r=e.properties?e.properties:i.type==="Feature"?i.properties:{};return uD(n,r)}l(bte,"polygonToLine");function wte(i,e){e===void 0&&(e={});var t=_0(i),n=t.coordinates,r=e.properties?e.properties:i.type==="Feature"?i.properties:{},a=[];return n.forEach(function(o){a.push(uD(o,r))}),m1(a)}l(wte,"multiPolygonToLine");function uD(i,e){return i.length>1?UQ(i,e):Vc(i[0],e)}l(uD,"coordsToLine");R();R();R();R();ii(KL(),1);ii(Wee(),1);R();R();R();R();R();R();R();ii(JL(),1);l(function(i){return[[i.bottomleft,0],[0,0],[0,i.leftbottom]]},"p00");l(function(i){return[[1,i.rightbottom],[1,0],[i.bottomright,0]]},"p01");l(function(i){return[[i.topright,1],[1,1],[1,i.righttop]]},"p02");l(function(i){return[[0,i.lefttop],[0,1],[i.topleft,1]]},"p03");l(function(i){return[[i.bottomright,0],[i.bottomleft,0],[0,i.leftbottom],[0,i.lefttop]]},"p04");l(function(i){return[[i.bottomright,0],[i.bottomleft,0],[1,i.righttop],[1,i.rightbottom]]},"p05");l(function(i){return[[1,i.righttop],[1,i.rightbottom],[i.topleft,1],[i.topright,1]]},"p06");l(function(i){return[[0,i.leftbottom],[0,i.lefttop],[i.topleft,1],[i.topright,1]]},"p07");l(function(i){return[[0,0],[0,i.leftbottom],[1,i.rightbottom],[1,0]]},"p08");l(function(i){return[[1,0],[i.bottomright,0],[i.topright,1],[1,1]]},"p09");l(function(i){return[[1,1],[1,i.righttop],[0,i.lefttop],[0,1]]},"p10");l(function(i){return[[i.bottomleft,0],[0,0],[0,1],[i.topleft,1]]},"p11");l(function(i){return[[1,i.righttop],[1,i.rightbottom],[0,i.leftbottom],[0,i.lefttop]]},"p12");l(function(i){return[[i.topleft,1],[i.topright,1],[i.bottomright,0],[i.bottomleft,0]]},"p13");l(function(){return[[0,0],[0,1],[1,1],[1,0]]},"p14");l(function(i){return[[1,i.rightbottom],[1,0],[0,0],[0,1],[i.topleft,1]]},"p15");l(function(i){return[[i.topright,1],[1,1],[1,0],[0,0],[0,i.leftbottom]]},"p16");l(function(i){return[[1,0],[i.bottomright,0],[0,i.lefttop],[0,1],[1,1]]},"p17");l(function(i){return[[1,1],[1,i.righttop],[i.bottomleft,0],[0,0],[0,1]]},"p18");l(function(i){return[[1,i.righttop],[1,i.rightbottom],[0,i.lefttop],[0,1],[i.topleft,1]]},"p19");l(function(i){return[[1,1],[1,i.righttop],[i.bottomright,0],[i.bottomleft,0],[i.topright,1]]},"p20");l(function(i){return[[1,i.rightbottom],[1,0],[i.bottomright,0],[0,i.leftbottom],[0,i.lefttop]]},"p21");l(function(i){return[[i.topright,1],[i.bottomleft,0],[0,0],[0,i.leftbottom],[i.topleft,1]]},"p22");l(function(i){return[[i.bottomright,0],[i.bottomleft,0],[0,i.lefttop],[0,1],[i.topleft,1]]},"p23");l(function(i){return[[1,1],[1,i.righttop],[0,i.leftbottom],[0,i.lefttop],[i.topright,1]]},"p24");l(function(i){return[[1,i.rightbottom],[1,0],[i.bottomright,0],[i.topleft,1],[i.topright,1]]},"p25");l(function(i){return[[1,i.righttop],[1,i.rightbottom],[i.bottomleft,0],[0,0],[0,i.leftbottom]]},"p26");l(function(i){return[[1,i.rightbottom],[1,0],[0,0],[0,i.leftbottom],[i.topleft,1],[i.topright,1]]},"p27");l(function(i){return[[1,1],[1,0],[i.bottomright,0],[0,i.leftbottom],[0,i.lefttop],[i.topright,1]]},"p28");l(function(i){return[[1,1],[1,i.righttop],[i.bottomright,0],[i.bottomleft,0],[0,i.lefttop],[0,1]]},"p29");l(function(i){return[[1,i.righttop],[1,i.rightbottom],[i.bottomleft,0],[0,0],[0,1],[i.topleft,1]]},"p30");l(function(i){return[[1,1],[1,i.righttop],[i.bottomleft,0],[0,0],[0,i.leftbottom],[i.topright,1]]},"p31");l(function(i){return[[1,i.rightbottom],[1,0],[i.bottomright,0],[0,i.lefttop],[0,1],[i.topleft,1]]},"p32");l(function(i){return[[1,i.righttop],[1,i.rightbottom],[i.bottomright,0],[i.bottomleft,0],[0,i.leftbottom],[0,i.lefttop],[i.topleft,1],[i.topright,1]]},"p33");l(function(i){return[[1,1],[1,i.righttop],[i.bottomleft,0],[0,0],[0,i.leftbottom],[i.topright,1]]},"p34");l(function(i){return[[1,i.rightbottom],[1,0],[i.bottomright,0],[0,i.lefttop],[0,1],[i.topleft,1]]},"p35");l(function(i){return[[1,1],[1,i.righttop],[i.bottomright,0],[i.bottomleft,0],[0,i.leftbottom],[0,i.lefttop],[i.topright,1]]},"p36");l(function(i){return[[1,i.righttop],[1,i.rightbottom],[i.bottomleft,0],[0,0],[0,i.leftbottom],[i.topleft,1],[i.topright,1]]},"p37");l(function(i){return[[1,i.righttop],[1,i.rightbottom],[i.bottomright,0],[i.bottomleft,0],[0,i.lefttop],[0,1],[i.topleft,1]]},"p38");l(function(i){return[[1,i.rightbottom],[1,0],[i.bottomright,0],[0,i.leftbottom],[0,i.lefttop],[i.topleft,1],[i.topright,1]]},"p39");R();R();R();R();R();R();R();R();function Ate(i){return(i>0)-(i<0)||+i}l(Ate,"mathSign");function FA(i,e,t){var n=e[0]-i[0],r=e[1]-i[1],a=t[0]-e[0],o=t[1]-e[1];return Ate(n*o-a*r)}l(FA,"orientationIndex");function Ste(i,e){var t=i.geometry.coordinates[0].map(function(o){return o[0]}),n=i.geometry.coordinates[0].map(function(o){return o[1]}),r=e.geometry.coordinates[0].map(function(o){return o[0]}),a=e.geometry.coordinates[0].map(function(o){return o[1]});return Math.max.apply(null,t)===Math.max.apply(null,r)&&Math.max.apply(null,n)===Math.max.apply(null,a)&&Math.min.apply(null,t)===Math.min.apply(null,r)&&Math.min.apply(null,n)===Math.min.apply(null,a)}l(Ste,"envelopeIsEqual");function RE(i,e){return e.geometry.coordinates[0].every(function(t){return yh(ph(t),i)})}l(RE,"envelopeContains");function Mte(i,e){return i[0]===e[0]&&i[1]===e[1]}l(Mte,"coordinatesEqual");var Lwe=function(){function i(e){this.id=i.buildId(e),this.coordinates=e,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}return l(i,"Node"),i.buildId=function(e){return e.join(",")},i.prototype.removeInnerEdge=function(e){this.innerEdges=this.innerEdges.filter(function(t){return t.from.id!==e.from.id})},i.prototype.removeOuterEdge=function(e){this.outerEdges=this.outerEdges.filter(function(t){return t.to.id!==e.to.id})},i.prototype.addOuterEdge=function(e){this.outerEdges.push(e),this.outerEdgesSorted=!1},i.prototype.sortOuterEdges=function(){var e=this;this.outerEdgesSorted||(this.outerEdges.sort(function(t,n){var r=t.to,a=n.to;if(r.coordinates[0]-e.coordinates[0]>=0&&a.coordinates[0]-e.coordinates[0]<0)return 1;if(r.coordinates[0]-e.coordinates[0]<0&&a.coordinates[0]-e.coordinates[0]>=0)return-1;if(r.coordinates[0]-e.coordinates[0]===0&&a.coordinates[0]-e.coordinates[0]===0)return r.coordinates[1]-e.coordinates[1]>=0||a.coordinates[1]-e.coordinates[1]>=0?r.coordinates[1]-a.coordinates[1]:a.coordinates[1]-r.coordinates[1];var o=FA(e.coordinates,r.coordinates,a.coordinates);if(o<0)return 1;if(o>0)return-1;var s=Math.pow(r.coordinates[0]-e.coordinates[0],2)+Math.pow(r.coordinates[1]-e.coordinates[1],2),u=Math.pow(a.coordinates[0]-e.coordinates[0],2)+Math.pow(a.coordinates[1]-e.coordinates[1],2);return s-u}),this.outerEdgesSorted=!0)},i.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},i.prototype.getOuterEdge=function(e){return this.sortOuterEdges(),this.outerEdges[e]},i.prototype.addInnerEdge=function(e){this.innerEdges.push(e)},i}(),DR=Lwe;R();var Dwe=function(){function i(e,t){this.from=e,this.to=t,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}return l(i,"Edge"),i.prototype.getSymetric=function(){return this.symetric||(this.symetric=new i(this.to,this.from),this.symetric.symetric=this),this.symetric},i.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},i.prototype.isEqual=function(e){return this.from.id===e.from.id&&this.to.id===e.to.id},i.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},i.prototype.toLineString=function(){return Vc([this.from.coordinates,this.to.coordinates])},i.prototype.compareTo=function(e){return FA(e.from.coordinates,e.to.coordinates,this.to.coordinates)},i}(),kwe=Dwe;R();var Rwe=function(){function i(){this.edges=[],this.polygon=void 0,this.envelope=void 0}return l(i,"EdgeRing"),i.prototype.push=function(e){this.edges.push(e),this.polygon=this.envelope=void 0},i.prototype.get=function(e){return this.edges[e]},Object.defineProperty(i.prototype,"length",{get:l(function(){return this.edges.length},"get"),enumerable:!0,configurable:!0}),i.prototype.forEach=function(e){this.edges.forEach(e)},i.prototype.map=function(e){return this.edges.map(e)},i.prototype.some=function(e){return this.edges.some(e)},i.prototype.isValid=function(){return!0},i.prototype.isHole=function(){var e=this,t=this.edges.reduce(function(o,s,u){return s.from.coordinates[1]>e.edges[o].from.coordinates[1]&&(o=u),o},0),n=(t===0?this.length:t)-1,r=(t+1)%this.length,a=FA(this.edges[n].from.coordinates,this.edges[t].from.coordinates,this.edges[r].from.coordinates);return a===0?this.edges[n].from.coordinates[0]>this.edges[r].from.coordinates[0]:a>0},i.prototype.toMultiPoint=function(){return VQ(this.edges.map(function(e){return e.from.coordinates}))},i.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var e=this.edges.map(function(t){return t.from.coordinates});return e.push(this.edges[0].from.coordinates),this.polygon=Zm([e])},i.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=Iwe(this.toPolygon())},i.findEdgeRingContaining=function(e,t){var n=e.getEnvelope(),r,a;return t.forEach(function(o){var s=o.getEnvelope();if(a&&(r=a.getEnvelope()),!Ste(s,n)&&RE(s,n)){for(var u=e.map(function(b){return b.from.coordinates}),h=void 0,d=l(function(b){o.some(function(w){return Mte(b,w.from.coordinates)})||(h=b)},"_loop_1"),f=0,m=u;f<m.length;f++){var v=m[f];d(v)}h&&o.inside(ph(h))&&(!a||RE(r,s))&&(a=o)}}),a},i.prototype.inside=function(e){return yh(e,this.toPolygon())},i}(),Owe=Rwe;function Cte(i){if(!i)throw new Error("No geojson passed");if(i.type!=="FeatureCollection"&&i.type!=="GeometryCollection"&&i.type!=="MultiLineString"&&i.type!=="LineString"&&i.type!=="Feature")throw new Error("Invalid input type '"+i.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}l(Cte,"validateGeoJson");(function(){function i(){this.edges=[],this.nodes={}}return l(i,"Graph"),i.fromGeoJson=function(e){Cte(e);var t=new i;return mh(e,function(n){ete(n,"LineString","Graph::fromGeoJson"),HQ(n,function(r,a){if(r){var o=t.getNode(r),s=t.getNode(a);t.addEdge(o,s)}return a})}),t},i.prototype.getNode=function(e){var t=DR.buildId(e),n=this.nodes[t];return n||(n=this.nodes[t]=new DR(e)),n},i.prototype.addEdge=function(e,t){var n=new kwe(e,t),r=n.getSymetric();this.edges.push(n),this.edges.push(r)},i.prototype.deleteDangles=function(){var e=this;Object.keys(this.nodes).map(function(t){return e.nodes[t]}).forEach(function(t){return e._removeIfDangle(t)})},i.prototype._removeIfDangle=function(e){var t=this;if(e.innerEdges.length<=1){var n=e.getOuterEdges().map(function(r){return r.to});this.removeNode(e),n.forEach(function(r){return t._removeIfDangle(r)})}},i.prototype.deleteCutEdges=function(){var e=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(function(t){t.label===t.symetric.label&&(e.removeEdge(t.symetric),e.removeEdge(t))})},i.prototype._computeNextCWEdges=function(e){var t=this;typeof e>"u"?Object.keys(this.nodes).forEach(function(n){return t._computeNextCWEdges(t.nodes[n])}):e.getOuterEdges().forEach(function(n,r){e.getOuterEdge((r===0?e.getOuterEdges().length:r)-1).symetric.next=n})},i.prototype._computeNextCCWEdges=function(e,t){for(var n=e.getOuterEdges(),r,a,o=n.length-1;o>=0;--o){var s=n[o],u=s.symetric,h=void 0,d=void 0;s.label===t&&(h=s),u.label===t&&(d=u),!(!h||!d)&&(d&&(a=d),h&&(a&&(a.next=h,a=void 0),r||(r=h)))}a&&(a.next=r)},i.prototype._findLabeledEdgeRings=function(){var e=[],t=0;return this.edges.forEach(function(n){if(!(n.label>=0)){e.push(n);var r=n;do r.label=t,r=r.next;while(!n.isEqual(r));t++}}),e},i.prototype.getEdgeRings=function(){var e=this;this._computeNextCWEdges(),this.edges.forEach(function(n){n.label=void 0}),this._findLabeledEdgeRings().forEach(function(n){e._findIntersectionNodes(n).forEach(function(r){e._computeNextCCWEdges(r,n.label)})});var t=[];return this.edges.forEach(function(n){n.ring||t.push(e._findEdgeRing(n))}),t},i.prototype._findIntersectionNodes=function(e){var t=[],n=e,r=l(function(){var a=0;n.from.getOuterEdges().forEach(function(o){o.label===e.label&&++a}),a>1&&t.push(n.from),n=n.next},"_loop_1");do r();while(!e.isEqual(n));return t},i.prototype._findEdgeRing=function(e){var t=e,n=new Owe;do n.push(t),t.ring=n,t=t.next;while(!e.isEqual(t));return n},i.prototype.removeNode=function(e){var t=this;e.getOuterEdges().forEach(function(n){return t.removeEdge(n)}),e.innerEdges.forEach(function(n){return t.removeEdge(n)}),delete this.nodes[e.id]},i.prototype.removeEdge=function(e){this.edges=this.edges.filter(function(t){return!t.isEqual(e)}),e.deleteEdge()},i})();R();function Ete(i,e){var t=!0;return mh(i,function(n){mh(e,function(r){if(t===!1)return!1;t=Ite(n.geometry,r.geometry)})}),t}l(Ete,"booleanDisjoint");function Ite(i,e){switch(i.type){case"Point":switch(e.type){case"Point":return!Dte(i.coordinates,e.coordinates);case"LineString":return!OE(e,i);case"Polygon":return!yh(i,e)}break;case"LineString":switch(e.type){case"Point":return!OE(i,e);case"LineString":return!Tte(i,e);case"Polygon":return!NE(e,i)}break;case"Polygon":switch(e.type){case"Point":return!yh(e,i);case"LineString":return!NE(i,e);case"Polygon":return!Pte(e,i)}}return!1}l(Ite,"disjoint");function OE(i,e){for(var t=0;t<i.coordinates.length-1;t++)if(Lte(i.coordinates[t],i.coordinates[t+1],e.coordinates))return!0;return!1}l(OE,"isPointOnLine");function Tte(i,e){var t=NA(i,e);return t.features.length>0}l(Tte,"isLineOnLine");function NE(i,e){for(var t=0,n=e.coordinates;t<n.length;t++){var r=n[t];if(yh(r,i))return!0}var a=NA(e,yw(i));return a.features.length>0}l(NE,"isLineInPoly");function Pte(i,e){for(var t=0,n=i.coordinates[0];t<n.length;t++){var r=n[t];if(yh(r,e))return!0}for(var a=0,o=e.coordinates[0];a<o.length;a++){var s=o[a];if(yh(s,i))return!0}var u=NA(yw(i),yw(e));return u.features.length>0}l(Pte,"isPolyInPoly");function Lte(i,e,t){var n=t[0]-i[0],r=t[1]-i[1],a=e[0]-i[0],o=e[1]-i[1],s=n*o-r*a;return s!==0?!1:Math.abs(a)>=Math.abs(o)?a>0?i[0]<=t[0]&&t[0]<=e[0]:e[0]<=t[0]&&t[0]<=i[0]:o>0?i[1]<=t[1]&&t[1]<=e[1]:e[1]<=t[1]&&t[1]<=i[1]}l(Lte,"isPointOnLineSegment");function Dte(i,e){return i[0]===e[0]&&i[1]===e[1]}l(Dte,"compareCoords");var Nwe=Ete;R();R();R();ii(qee(),1);R();ii(qee(),1);R();function kte(i,e){var t=!1;return mh(i,function(n){mh(e,function(r){if(t===!0)return!0;t=!Nwe(n.geometry,r.geometry)})}),t}l(kte,"booleanIntersects");R();ii(bwe(),1);R();ii(Awe(),1);R();R();function FE(i){for(var e=i,t=[];e.parent;)t.unshift(e),e=e.parent;return t}l(FE,"pathTo");function Rte(){return new cD(function(i){return i.f})}l(Rte,"getHeap");var hD={search:l(function(i,e,t,n){i.cleanDirty(),n=n||{};var r=n.heuristic||hD.heuristics.manhattan,a=n.closest||!1,o=Rte(),s=e;for(e.h=r(e,t),o.push(e);o.size()>0;){var u=o.pop();if(u===t)return FE(u);u.closed=!0;for(var h=i.neighbors(u),d=0,f=h.length;d<f;++d){var m=h[d];if(!(m.closed||m.isWall())){var v=u.g+m.getCost(u),b=m.visited;(!b||v<m.g)&&(m.visited=!0,m.parent=u,m.h=m.h||r(m,t),m.g=v,m.f=m.g+m.h,i.markDirty(m),a&&(m.h<s.h||m.h===s.h&&m.g<s.g)&&(s=m),b?o.rescoreElement(m):o.push(m))}}}return a?FE(s):[]},"search"),heuristics:{manhattan:l(function(i,e){var t=Math.abs(e.x-i.x),n=Math.abs(e.y-i.y);return t+n},"manhattan"),diagonal:l(function(i,e){var t=1,n=Math.sqrt(2),r=Math.abs(e.x-i.x),a=Math.abs(e.y-i.y);return t*(r+a)+(n-2*t)*Math.min(r,a)},"diagonal")},cleanNode:l(function(i){i.f=0,i.g=0,i.h=0,i.visited=!1,i.closed=!1,i.parent=null},"cleanNode")};function Hg(i,e){e=e||{},this.nodes=[],this.diagonal=!!e.diagonal,this.grid=[];for(var t=0;t<i.length;t++){this.grid[t]=[];for(var n=0,r=i[t];n<r.length;n++){var a=new x0(t,n,r[n]);this.grid[t][n]=a,this.nodes.push(a)}}this.init()}l(Hg,"Graph");Hg.prototype.init=function(){this.dirtyNodes=[];for(var i=0;i<this.nodes.length;i++)hD.cleanNode(this.nodes[i])};Hg.prototype.cleanDirty=function(){for(var i=0;i<this.dirtyNodes.length;i++)hD.cleanNode(this.dirtyNodes[i]);this.dirtyNodes=[]};Hg.prototype.markDirty=function(i){this.dirtyNodes.push(i)};Hg.prototype.neighbors=function(i){var e=[],t=i.x,n=i.y,r=this.grid;return r[t-1]&&r[t-1][n]&&e.push(r[t-1][n]),r[t+1]&&r[t+1][n]&&e.push(r[t+1][n]),r[t]&&r[t][n-1]&&e.push(r[t][n-1]),r[t]&&r[t][n+1]&&e.push(r[t][n+1]),this.diagonal&&(r[t-1]&&r[t-1][n-1]&&e.push(r[t-1][n-1]),r[t+1]&&r[t+1][n-1]&&e.push(r[t+1][n-1]),r[t-1]&&r[t-1][n+1]&&e.push(r[t-1][n+1]),r[t+1]&&r[t+1][n+1]&&e.push(r[t+1][n+1])),e};Hg.prototype.toString=function(){for(var i=[],e=this.grid,t,n,r,a,o=0,s=e.length;o<s;o++){for(t=[],n=e[o],r=0,a=n.length;r<a;r++)t.push(n[r].weight);i.push(t.join(" "))}return i.join(`
`)};function x0(i,e,t){this.x=i,this.y=e,this.weight=t}l(x0,"GridNode");x0.prototype.toString=function(){return"["+this.x+" "+this.y+"]"};x0.prototype.getCost=function(i){return i&&i.x!==this.x&&i.y!==this.y?this.weight*1.41421:this.weight};x0.prototype.isWall=function(){return this.weight===0};function cD(i){this.content=[],this.scoreFunction=i}l(cD,"BinaryHeap");cD.prototype={push:l(function(i){this.content.push(i),this.sinkDown(this.content.length-1)},"push"),pop:l(function(){var i=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.bubbleUp(0)),i},"pop"),remove:l(function(i){var e=this.content.indexOf(i),t=this.content.pop();e!==this.content.length-1&&(this.content[e]=t,this.scoreFunction(t)<this.scoreFunction(i)?this.sinkDown(e):this.bubbleUp(e))},"remove"),size:l(function(){return this.content.length},"size"),rescoreElement:l(function(i){this.sinkDown(this.content.indexOf(i))},"rescoreElement"),sinkDown:l(function(i){for(var e=this.content[i];i>0;){var t=(i+1>>1)-1,n=this.content[t];if(this.scoreFunction(e)<this.scoreFunction(n))this.content[t]=e,this.content[i]=n,i=t;else break}},"sinkDown"),bubbleUp:l(function(i){for(var e=this.content.length,t=this.content[i],n=this.scoreFunction(t);;){var r=i+1<<1,a=r-1,o=null,s;if(a<e){var u=this.content[a];s=this.scoreFunction(u),s<n&&(o=a)}if(r<e){var h=this.content[r],d=this.scoreFunction(h);d<(o===null?n:s)&&(o=r)}if(o!==null)this.content[i]=this.content[o],this.content[o]=t,i=o;else break}},"bubbleUp")};R();R();R();R();R();R();R();R();function vw(){this._=null}l(vw,"RedBlackTree");function b0(i){i.U=i.C=i.L=i.R=i.P=i.N=null}l(b0,"RedBlackNode");vw.prototype={constructor:vw,insert:l(function(i,e){var t,n,r;if(i){if(e.P=i,e.N=i.N,i.N&&(i.N.P=e),i.N=e,i.R){for(i=i.R;i.L;)i=i.L;i.L=e}else i.R=e;t=i}else this._?(i=BE(this._),e.P=null,e.N=i,i.P=i.L=e,t=i):(e.P=e.N=null,this._=e,t=null);for(e.L=e.R=null,e.U=t,e.C=!0,i=e;t&&t.C;)n=t.U,t===n.L?(r=n.R,r&&r.C?(t.C=r.C=!1,n.C=!0,i=n):(i===t.R&&(Cf(this,t),i=t,t=i.U),t.C=!1,n.C=!0,Ef(this,n))):(r=n.L,r&&r.C?(t.C=r.C=!1,n.C=!0,i=n):(i===t.L&&(Ef(this,t),i=t,t=i.U),t.C=!1,n.C=!0,Cf(this,n))),t=i.U;this._.C=!1},"insert"),remove:l(function(i){i.N&&(i.N.P=i.P),i.P&&(i.P.N=i.N),i.N=i.P=null;var e=i.U,t,n=i.L,r=i.R,a,o;if(n?r?a=BE(r):a=n:a=r,e?e.L===i?e.L=a:e.R=a:this._=a,n&&r?(o=a.C,a.C=i.C,a.L=n,n.U=a,a!==r?(e=a.U,a.U=i.U,i=a.R,e.L=i,a.R=r,r.U=a):(a.U=e,e=a,i=a.R)):(o=i.C,i=a),i&&(i.U=e),!o){if(i&&i.C){i.C=!1;return}do{if(i===this._)break;if(i===e.L){if(t=e.R,t.C&&(t.C=!1,e.C=!0,Cf(this,e),t=e.R),t.L&&t.L.C||t.R&&t.R.C){(!t.R||!t.R.C)&&(t.L.C=!1,t.C=!0,Ef(this,t),t=e.R),t.C=e.C,e.C=t.R.C=!1,Cf(this,e),i=this._;break}}else if(t=e.L,t.C&&(t.C=!1,e.C=!0,Ef(this,e),t=e.L),t.L&&t.L.C||t.R&&t.R.C){(!t.L||!t.L.C)&&(t.R.C=!1,t.C=!0,Cf(this,t),t=e.L),t.C=e.C,e.C=t.L.C=!1,Ef(this,e),i=this._;break}t.C=!0,i=e,e=e.U}while(!i.C);i&&(i.C=!1)}},"remove")};function Cf(i,e){var t=e,n=e.R,r=t.U;r?r.L===t?r.L=n:r.R=n:i._=n,n.U=r,t.U=n,t.R=n.L,t.R&&(t.R.U=t),n.L=t}l(Cf,"RedBlackRotateLeft");function Ef(i,e){var t=e,n=e.L,r=t.U;r?r.L===t?r.L=n:r.R=n:i._=n,n.U=r,t.U=n,t.L=n.R,t.L&&(t.L.U=t),n.R=t}l(Ef,"RedBlackRotateRight");function BE(i){for(;i.L;)i=i.L;return i}l(BE,"RedBlackFirst");var kR=vw;R();R();function Sm(i,e,t,n){var r=[null,null],a=to.push(r)-1;return r.left=i,r.right=e,t&&x1(r,i,e,t),n&&x1(r,e,i,n),us[i.index].halfedges.push(a),us[e.index].halfedges.push(a),r}l(Sm,"createEdge");function If(i,e,t){var n=[e,t];return n.left=i,n}l(If,"createBorderEdge");function x1(i,e,t,n){!i[0]&&!i[1]?(i[0]=n,i.left=e,i.right=t):i.left===t?i[1]=n:i[0]=n}l(x1,"setEdgeEnd");function Ote(i,e,t,n,r){var a=i[0],o=i[1],s=a[0],u=a[1],h=o[0],d=o[1],f=0,m=1,v=h-s,b=d-u,w;if(w=e-s,!(!v&&w>0)){if(w/=v,v<0){if(w<f)return;w<m&&(m=w)}else if(v>0){if(w>m)return;w>f&&(f=w)}if(w=n-s,!(!v&&w<0)){if(w/=v,v<0){if(w>m)return;w>f&&(f=w)}else if(v>0){if(w<f)return;w<m&&(m=w)}if(w=t-u,!(!b&&w>0)){if(w/=b,b<0){if(w<f)return;w<m&&(m=w)}else if(b>0){if(w>m)return;w>f&&(f=w)}if(w=r-u,!(!b&&w<0)){if(w/=b,b<0){if(w>m)return;w>f&&(f=w)}else if(b>0){if(w<f)return;w<m&&(m=w)}return!(f>0)&&!(m<1)||(f>0&&(i[0]=[s+f*v,u+f*b]),m<1&&(i[1]=[s+m*v,u+m*b])),!0}}}}}l(Ote,"clipEdge");function Nte(i,e,t,n,r){var a=i[1];if(a)return!0;var o=i[0],s=i.left,u=i.right,h=s[0],d=s[1],f=u[0],m=u[1],v=(h+f)/2,b=(d+m)/2,w,A;if(m===d){if(v<e||v>=n)return;if(h>f){if(!o)o=[v,t];else if(o[1]>=r)return;a=[v,r]}else{if(!o)o=[v,r];else if(o[1]<t)return;a=[v,t]}}else if(w=(h-f)/(m-d),A=b-w*v,w<-1||w>1)if(h>f){if(!o)o=[(t-A)/w,t];else if(o[1]>=r)return;a=[(r-A)/w,r]}else{if(!o)o=[(r-A)/w,r];else if(o[1]<t)return;a=[(t-A)/w,t]}else if(d<m){if(!o)o=[e,w*e+A];else if(o[0]>=n)return;a=[n,w*n+A]}else{if(!o)o=[n,w*n+A];else if(o[0]<e)return;a=[e,w*e+A]}return i[0]=o,i[1]=a,!0}l(Nte,"connectEdge");function Fte(i,e,t,n){for(var r=to.length,a;r--;)(!Nte(a=to[r],i,e,t,n)||!Ote(a,i,e,t,n)||!(Math.abs(a[0][0]-a[1][0])>Ar||Math.abs(a[0][1]-a[1][1])>Ar))&&delete to[r]}l(Fte,"clipEdges");function Bte(i){return us[i.index]={site:i,halfedges:[]}}l(Bte,"createCell");function zte(i,e){var t=i.site,n=e.left,r=e.right;return t===r&&(r=n,n=t),r?Math.atan2(r[1]-n[1],r[0]-n[0]):(t===n?(n=e[1],r=e[0]):(n=e[0],r=e[1]),Math.atan2(n[0]-r[0],r[1]-n[1]))}l(zte,"cellHalfedgeAngle");function pD(i,e){return e[+(e.left!==i.site)]}l(pD,"cellHalfedgeStart");function Ute(i,e){return e[+(e.left===i.site)]}l(Ute,"cellHalfedgeEnd");function Vte(){for(var i=0,e=us.length,t,n,r,a;i<e;++i)if((t=us[i])&&(a=(n=t.halfedges).length)){var o=new Array(a),s=new Array(a);for(r=0;r<a;++r)o[r]=r,s[r]=zte(t,to[n[r]]);for(o.sort(function(u,h){return s[h]-s[u]}),r=0;r<a;++r)s[r]=n[o[r]];for(r=0;r<a;++r)n[r]=s[r]}}l(Vte,"sortCellHalfedges");function jte(i,e,t,n){var r=us.length,a,o,s,u,h,d,f,m,v,b,w,A,E=!0;for(a=0;a<r;++a)if(o=us[a]){for(s=o.site,h=o.halfedges,u=h.length;u--;)to[h[u]]||h.splice(u,1);for(u=0,d=h.length;u<d;)b=Ute(o,to[h[u]]),w=b[0],A=b[1],f=pD(o,to[h[++u%d]]),m=f[0],v=f[1],(Math.abs(w-m)>Ar||Math.abs(A-v)>Ar)&&(h.splice(u,0,to.push(If(s,b,Math.abs(w-i)<Ar&&n-A>Ar?[i,Math.abs(m-i)<Ar?v:n]:Math.abs(A-n)<Ar&&t-w>Ar?[Math.abs(v-n)<Ar?m:t,n]:Math.abs(w-t)<Ar&&A-e>Ar?[t,Math.abs(m-t)<Ar?v:e]:Math.abs(A-e)<Ar&&w-i>Ar?[Math.abs(v-e)<Ar?m:i,e]:null))-1),++d);d&&(E=!1)}if(E){var I,C,T,k=1/0;for(a=0,E=null;a<r;++a)(o=us[a])&&(s=o.site,I=s[0]-i,C=s[1]-e,T=I*I+C*C,T<k&&(k=T,E=o));if(E){var F=[i,e],B=[i,n],N=[t,n],z=[t,e];E.halfedges.push(to.push(If(s=E.site,F,B))-1,to.push(If(s,B,N))-1,to.push(If(s,N,z))-1,to.push(If(s,z,F))-1)}}for(a=0;a<r;++a)(o=us[a])&&(o.halfedges.length||delete us[a])}l(jte,"clipCells");R();var Gte=[],dD;function $te(){b0(this),this.x=this.y=this.arc=this.site=this.cy=null}l($te,"Circle");function ed(i){var e=i.P,t=i.N;if(!(!e||!t)){var n=e.site,r=i.site,a=t.site;if(n!==a){var o=r[0],s=r[1],u=n[0]-o,h=n[1]-s,d=a[0]-o,f=a[1]-s,m=2*(u*f-h*d);if(!(m>=-1e-12)){var v=u*u+h*h,b=d*d+f*f,w=(f*v-h*b)/m,A=(u*b-d*v)/m,E=Gte.pop()||new $te;E.arc=i,E.site=r,E.x=w+o,E.y=(E.cy=A+s)+Math.sqrt(w*w+A*A),i.circle=E;for(var I=null,C=b1._;C;)if(E.y<C.y||E.y===C.y&&E.x<=C.x)if(C.L)C=C.L;else{I=C.P;break}else if(C.R)C=C.R;else{I=C;break}b1.insert(I,E),I||(dD=E)}}}}l(ed,"attachCircle");function ld(i){var e=i.circle;e&&(e.P||(dD=e.N),b1.remove(e),Gte.push(e),b0(e),i.circle=null)}l(ld,"detachCircle");var Hte=[];function Wte(){b0(this),this.edge=this.site=this.circle=null}l(Wte,"Beach");function zE(i){var e=Hte.pop()||new Wte;return e.site=i,e}l(zE,"createBeach");function Lx(i){ld(i),Jm.remove(i),Hte.push(i),b0(i)}l(Lx,"detachBeach");function qte(i){var e=i.circle,t=e.x,n=e.cy,r=[t,n],a=i.P,o=i.N,s=[i];Lx(i);for(var u=a;u.circle&&Math.abs(t-u.circle.x)<Ar&&Math.abs(n-u.circle.cy)<Ar;)a=u.P,s.unshift(u),Lx(u),u=a;s.unshift(u),ld(u);for(var h=o;h.circle&&Math.abs(t-h.circle.x)<Ar&&Math.abs(n-h.circle.cy)<Ar;)o=h.N,s.push(h),Lx(h),h=o;s.push(h),ld(h);var d=s.length,f;for(f=1;f<d;++f)h=s[f],u=s[f-1],x1(h.edge,u.site,h.site,r);u=s[0],h=s[d-1],h.edge=Sm(u.site,h.site,null,r),ed(u),ed(h)}l(qte,"removeBeach");function Xte(i){for(var e=i[0],t=i[1],n,r,a,o,s=Jm._;s;)if(a=fD(s,t)-e,a>Ar)s=s.L;else if(o=e-Zte(s,t),o>Ar){if(!s.R){n=s;break}s=s.R}else{a>-Ar?(n=s.P,r=s):o>-Ar?(n=s,r=s.N):n=r=s;break}Bte(i);var u=zE(i);if(Jm.insert(n,u),!(!n&&!r)){if(n===r){ld(n),r=zE(n.site),Jm.insert(u,r),u.edge=r.edge=Sm(n.site,u.site),ed(n),ed(r);return}if(!r){u.edge=Sm(n.site,u.site);return}ld(n),ld(r);var h=n.site,d=h[0],f=h[1],m=i[0]-d,v=i[1]-f,b=r.site,w=b[0]-d,A=b[1]-f,E=2*(m*A-v*w),I=m*m+v*v,C=w*w+A*A,T=[(A*I-v*C)/E+d,(m*C-w*I)/E+f];x1(r.edge,h,b,T),u.edge=Sm(h,i,null,T),r.edge=Sm(i,b,null,T),ed(n),ed(r)}}l(Xte,"addBeach");function fD(i,e){var t=i.site,n=t[0],r=t[1],a=r-e;if(!a)return n;var o=i.P;if(!o)return-1/0;t=o.site;var s=t[0],u=t[1],h=u-e;if(!h)return s;var d=s-n,f=1/a-1/h,m=d/h;return f?(-m+Math.sqrt(m*m-2*f*(d*d/(-2*h)-u+h/2+r-a/2)))/f+n:(n+s)/2}l(fD,"leftBreakPoint");function Zte(i,e){var t=i.N;if(t)return fD(t,e);var n=i.site;return n[1]===e?n[0]:1/0}l(Zte,"rightBreakPoint");var Ar=1e-6,Jm,us,b1,to;function Yte(i,e,t){return(i[0]-t[0])*(e[1]-i[1])-(i[0]-e[0])*(t[1]-i[1])}l(Yte,"triangleArea");function Jte(i,e){return e[1]-i[1]||e[0]-i[0]}l(Jte,"lexicographic");function UE(i,e){var t=i.sort(Jte).pop(),n,r,a;for(to=[],us=new Array(i.length),Jm=new kR,b1=new kR;;)if(a=dD,t&&(!a||t[1]<a.y||t[1]===a.y&&t[0]<a.x))(t[0]!==n||t[1]!==r)&&(Xte(t),n=t[0],r=t[1]),t=i.pop();else if(a)qte(a.arc);else break;if(Vte(),e){var o=+e[0][0],s=+e[0][1],u=+e[1][0],h=+e[1][1];Fte(o,s,u,h),jte(o,s,u,h)}this.edges=to,this.cells=us,Jm=b1=to=us=null}l(UE,"Diagram");UE.prototype={constructor:UE,polygons:l(function(){var i=this.edges;return this.cells.map(function(e){var t=e.halfedges.map(function(n){return pD(e,i[n])});return t.data=e.site.data,t})},"polygons"),triangles:l(function(){var i=[],e=this.edges;return this.cells.forEach(function(t,n){if(s=(a=t.halfedges).length)for(var r=t.site,a,o=-1,s,u,h=e[a[s-1]],d=h.left===r?h.right:h.left;++o<s;)u=d,h=e[a[o]],d=h.left===r?h.right:h.left,u&&d&&n<u.index&&n<d.index&&Yte(r,u,d)<0&&i.push([r.data,u.data,d.data])}),i},"triangles"),links:l(function(){return this.edges.filter(function(i){return i.right}).map(function(i){return{source:i.left.data,target:i.right.data}})},"links"),find:l(function(i,e,t){for(var n=this,r,a=n._found||0,o=n.cells.length,s;!(s=n.cells[a]);)if(++a>=o)return null;var u=i-s.site[0],h=e-s.site[1],d=u*u+h*h;do s=n.cells[r=a],a=null,s.halfedges.forEach(function(f){var m=n.edges[f],v=m.left;if(!((v===s.site||!v)&&!(v=m.right))){var b=i-v[0],w=e-v[1],A=b*b+w*w;A<d&&(d=A,a=v.index)}});while(a!==null);return n._found=r,t==null||d<=t*t?s.site:null},"find")};R();R();R();R();R();R();R();R();R();R();R();R();ii(v0(),1);R();ii(Swe(),1);R();R();R();function wh(){return new w1}l(wh,"default");function w1(){this.reset()}l(w1,"Adder");w1.prototype={constructor:w1,reset:l(function(){this.s=this.t=0},"reset"),add:l(function(i){VE(T_,i,this.t),VE(this,T_.s,this.s),this.s?this.t+=T_.t:this.s=T_.t},"add"),valueOf:l(function(){return this.s},"valueOf")};var T_=new w1;function VE(i,e,t){var n=i.s=e+t,r=n-e,a=n-r;i.t=e-a+(t-r)}l(VE,"add");R();var Co=1e-6,Xr=Math.PI,fs=Xr/2,RR=Xr/4,_w=Xr*2,OR=Xr/180,hh=Math.abs,w0=Math.atan,Kte=Math.atan2,oo=Math.cos,Qte=Math.exp,eie=Math.log,Yr=Math.sin,mD=Math.sqrt,tie=Math.tan;function iie(i){return i>1?0:i<-1?Xr:Math.acos(i)}l(iie,"acos");function A0(i){return i>1?fs:i<-1?-fs:Math.asin(i)}l(A0,"asin");R();function gD(){}l(gD,"noop");R();wh();wh();R();R();function jE(i){var e=i[0],t=i[1],n=oo(t);return[n*oo(e),n*Yr(e),Yr(t)]}l(jE,"cartesian");function GE(i,e){return[i[1]*e[2]-i[2]*e[1],i[2]*e[0]-i[0]*e[2],i[0]*e[1]-i[1]*e[0]]}l(GE,"cartesianCross");function $E(i){var e=mD(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]);i[0]/=e,i[1]/=e,i[2]/=e}l($E,"cartesianNormalizeInPlace");wh();R();R();R();R();R();function HE(i,e){return[i>Xr?i-_w:i<-Xr?i+_w:i,e]}l(HE,"rotationIdentity");HE.invert=HE;R();R();function nie(){var i=[],e;return{point:l(function(t,n){e.push([t,n])},"point"),lineStart:l(function(){i.push(e=[])},"lineStart"),lineEnd:gD,rejoin:l(function(){i.length>1&&i.push(i.pop().concat(i.shift()))},"rejoin"),result:l(function(){var t=i;return i=[],e=null,t},"result")}}l(nie,"default");R();R();R();function rie(i,e){return hh(i[0]-e[0])<Co&&hh(i[1]-e[1])<Co}l(rie,"default");function Qy(i,e,t,n){this.x=i,this.z=e,this.o=t,this.e=n,this.v=!1,this.n=this.p=null}l(Qy,"Intersection");function aie(i,e,t,n,r){var a=[],o=[],s,u;if(i.forEach(function(b){if(!((w=b.length-1)<=0)){var w,A=b[0],E=b[w],I;if(rie(A,E)){for(r.lineStart(),s=0;s<w;++s)r.point((A=b[s])[0],A[1]);r.lineEnd();return}a.push(I=new Qy(A,b,null,!0)),o.push(I.o=new Qy(A,null,I,!1)),a.push(I=new Qy(E,b,null,!1)),o.push(I.o=new Qy(E,null,I,!0))}}),!!a.length){for(o.sort(e),WE(a),WE(o),s=0,u=o.length;s<u;++s)o[s].e=t=!t;for(var h=a[0],d,f;;){for(var m=h,v=!0;m.v;)if((m=m.n)===h)return;d=m.z,r.lineStart();do{if(m.v=m.o.v=!0,m.e){if(v)for(s=0,u=d.length;s<u;++s)r.point((f=d[s])[0],f[1]);else n(m.x,m.n.x,1,r);m=m.n}else{if(v)for(d=m.p.z,s=d.length-1;s>=0;--s)r.point((f=d[s])[0],f[1]);else n(m.x,m.p.x,-1,r);m=m.p}m=m.o,d=m.z,v=!v}while(!m.v);r.lineEnd()}}}l(aie,"default");function WE(i){if(e=i.length){for(var e,t=0,n=i[0],r;++t<e;)n.n=r=i[t],r.p=n,n=r;n.n=r=i[0],r.p=n}}l(WE,"link");R();R();R();function yD(i,e){return i<e?-1:i>e?1:i>=e?0:NaN}l(yD,"default");R();function oie(i){return i.length===1&&(i=sie(i)),{left:l(function(e,t,n,r){for(n==null&&(n=0),r==null&&(r=e.length);n<r;){var a=n+r>>>1;i(e[a],t)<0?n=a+1:r=a}return n},"left"),right:l(function(e,t,n,r){for(n==null&&(n=0),r==null&&(r=e.length);n<r;){var a=n+r>>>1;i(e[a],t)>0?r=a:n=a+1}return n},"right")}}l(oie,"default");function sie(i){return function(e,t){return yD(i(e),t)}}l(sie,"ascendingComparator");var lie=oie(yD);lie.right;lie.left;R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();R();function uie(i){for(var e=i.length,t,n=-1,r=0,a,o;++n<e;)r+=i[n].length;for(a=new Array(r);--e>=0;)for(o=i[e],t=o.length;--t>=0;)a[--r]=o[t];return a}l(uie,"default");R();R();R();R();R();R();R();R();R();var cM=wh();function hie(i,e){var t=e[0],n=e[1],r=[Yr(t),-oo(t),0],a=0,o=0;cM.reset();for(var s=0,u=i.length;s<u;++s)if(d=(h=i[s]).length)for(var h,d,f=h[d-1],m=f[0],v=f[1]/2+RR,b=Yr(v),w=oo(v),A=0;A<d;++A,m=I,b=T,w=k,f=E){var E=h[A],I=E[0],C=E[1]/2+RR,T=Yr(C),k=oo(C),F=I-m,B=F>=0?1:-1,N=B*F,z=N>Xr,L=b*T;if(cM.add(Kte(L*B*Yr(N),w*k+L*oo(N))),a+=z?F+B*_w:F,z^m>=t^I>=t){var j=GE(jE(f),jE(E));$E(j);var q=GE(r,j);$E(q);var Z=(z^F>=0?-1:1)*A0(q[2]);(n>Z||n===Z&&(j[0]||j[1]))&&(o+=z^F>=0?1:-1)}}return(a<-Co||a<Co&&cM<-Co)^o&1}l(hie,"default");R();R();wh();R();R();R();R();R();wh();wh();R();R();R();function cie(i){this._context=i}l(cie,"PathContext");cie.prototype={_radius:4.5,pointRadius:l(function(i){return this._radius=i,this},"pointRadius"),polygonStart:l(function(){this._line=0},"polygonStart"),polygonEnd:l(function(){this._line=NaN},"polygonEnd"),lineStart:l(function(){this._point=0},"lineStart"),lineEnd:l(function(){this._line===0&&this._context.closePath(),this._point=NaN},"lineEnd"),point:l(function(i,e){switch(this._point){case 0:{this._context.moveTo(i,e),this._point=1;break}case 1:{this._context.lineTo(i,e);break}default:{this._context.moveTo(i+this._radius,e),this._context.arc(i,e,this._radius,0,_w);break}}},"point"),result:gD};R();wh();R();function pie(){this._string=[]}l(pie,"PathString");pie.prototype={_radius:4.5,_circle:qE(4.5),pointRadius:l(function(i){return(i=+i)!==this._radius&&(this._radius=i,this._circle=null),this},"pointRadius"),polygonStart:l(function(){this._line=0},"polygonStart"),polygonEnd:l(function(){this._line=NaN},"polygonEnd"),lineStart:l(function(){this._point=0},"lineStart"),lineEnd:l(function(){this._line===0&&this._string.push("Z"),this._point=NaN},"lineEnd"),point:l(function(i,e){switch(this._point){case 0:{this._string.push("M",i,",",e),this._point=1;break}case 1:{this._string.push("L",i,",",e);break}default:{this._circle==null&&(this._circle=qE(this._radius)),this._string.push("M",i,",",e,this._circle);break}}},"point"),result:l(function(){if(this._string.length){var i=this._string.join("");return this._string=[],i}else return null},"result")};function qE(i){return"m0,"+i+"a"+i+","+i+" 0 1,1 0,"+-2*i+"a"+i+","+i+" 0 1,1 0,"+2*i+"z"}l(qE,"circle");R();R();R();R();R();R();function Fwe(i,e,t,n){return function(r,a){var o=e(a),s=r.invert(n[0],n[1]),u=nie(),h=e(u),d=!1,f,m,v,b={point:w,lineStart:E,lineEnd:I,polygonStart:l(function(){b.point=C,b.lineStart=T,b.lineEnd=k,m=[],f=[]},"polygonStart"),polygonEnd:l(function(){b.point=w,b.lineStart=E,b.lineEnd=I,m=uie(m);var F=hie(f,s);m.length?(d||(a.polygonStart(),d=!0),aie(m,fie,F,t,a)):F&&(d||(a.polygonStart(),d=!0),a.lineStart(),t(null,null,1,a),a.lineEnd()),d&&(a.polygonEnd(),d=!1),m=f=null},"polygonEnd"),sphere:l(function(){a.polygonStart(),a.lineStart(),t(null,null,1,a),a.lineEnd(),a.polygonEnd()},"sphere")};function w(F,B){var N=r(F,B);i(F=N[0],B=N[1])&&a.point(F,B)}l(w,"point");function A(F,B){var N=r(F,B);o.point(N[0],N[1])}l(A,"pointLine");function E(){b.point=A,o.lineStart()}l(E,"lineStart");function I(){b.point=w,o.lineEnd()}l(I,"lineEnd");function C(F,B){v.push([F,B]);var N=r(F,B);h.point(N[0],N[1])}l(C,"pointRing");function T(){h.lineStart(),v=[]}l(T,"ringStart");function k(){C(v[0][0],v[0][1]),h.lineEnd();var F=h.clean(),B=u.result(),N,z=B.length,L,j,q;if(v.pop(),f.push(v),v=null,!!z){if(F&1){if(j=B[0],(L=j.length-1)>0){for(d||(a.polygonStart(),d=!0),a.lineStart(),N=0;N<L;++N)a.point((q=j[N])[0],q[1]);a.lineEnd()}return}z>1&&F&2&&B.push(B.pop().concat(B.shift())),m.push(B.filter(die))}}return l(k,"ringEnd"),b}}l(Fwe,"default");function die(i){return i.length>1}l(die,"validSegment");function fie(i,e){return((i=i.x)[0]<0?i[1]-fs-Co:fs-i[1])-((e=e.x)[0]<0?e[1]-fs-Co:fs-e[1])}l(fie,"compareIntersection");function Bwe(i){var e=NaN,t=NaN,n=NaN,r;return{lineStart:l(function(){i.lineStart(),r=1},"lineStart"),point:l(function(a,o){var s=a>0?Xr:-Xr,u=hh(a-e);hh(u-Xr)<Co?(i.point(e,t=(t+o)/2>0?fs:-fs),i.point(n,t),i.lineEnd(),i.lineStart(),i.point(s,t),i.point(a,t),r=0):n!==s&&u>=Xr&&(hh(e-n)<Co&&(e-=n*Co),hh(a-s)<Co&&(a-=s*Co),t=mie(e,t,a,o),i.point(n,t),i.lineEnd(),i.lineStart(),i.point(s,t),r=0),i.point(e=a,t=o),n=s},"point"),lineEnd:l(function(){i.lineEnd(),e=t=NaN},"lineEnd"),clean:l(function(){return 2-r},"clean")}}l(Bwe,"clipAntimeridianLine");function mie(i,e,t,n){var r,a,o=Yr(i-t);return hh(o)>Co?w0((Yr(e)*(a=oo(n))*Yr(t)-Yr(n)*(r=oo(e))*Yr(i))/(r*a*o)):(e+n)/2}l(mie,"clipAntimeridianIntersect");function zwe(i,e,t,n){var r;if(i==null)r=t*fs,n.point(-Xr,r),n.point(0,r),n.point(Xr,r),n.point(Xr,0),n.point(Xr,-r),n.point(0,-r),n.point(-Xr,-r),n.point(-Xr,0),n.point(-Xr,r);else if(hh(i[0]-e[0])>Co){var a=i[0]<e[0]?Xr:-Xr;r=t*a/2,n.point(-a,r),n.point(0,r),n.point(a,r)}else n.point(e[0],e[1])}l(zwe,"clipAntimeridianInterpolate");R();R();function gie(i){return function(e){var t=new xw;for(var n in i)t[n]=i[n];return t.stream=e,t}}l(gie,"transformer");function xw(){}l(xw,"TransformStream");xw.prototype={constructor:xw,point:l(function(i,e){this.stream.point(i,e)},"point"),sphere:l(function(){this.stream.sphere()},"sphere"),lineStart:l(function(){this.stream.lineStart()},"lineStart"),lineEnd:l(function(){this.stream.lineEnd()},"lineEnd"),polygonStart:l(function(){this.stream.polygonStart()},"polygonStart"),polygonEnd:l(function(){this.stream.polygonEnd()},"polygonEnd")};R();R();gie({point:l(function(i,e){this.stream.point(i*OR,e*OR)},"point")});R();R();R();R();function vD(i){return function(e,t){var n=oo(e),r=oo(t),a=i(n*r);return[a*r*Yr(e),a*Yr(t)]}}l(vD,"azimuthalRaw");function Wg(i){return function(e,t){var n=mD(e*e+t*t),r=i(n),a=Yr(r),o=oo(r);return[Kte(e*a,n*o),A0(n&&t*a/n)]}}l(Wg,"azimuthalInvert");var Uwe=vD(function(i){return mD(2/(1+i))});Uwe.invert=Wg(function(i){return 2*A0(i/2)});R();var Vwe=vD(function(i){return(i=iie(i))&&i/Yr(i)});Vwe.invert=Wg(function(i){return i});R();R();function yie(i,e){return[i,eie(tie((fs+e)/2))]}l(yie,"mercatorRaw");yie.invert=function(i,e){return[i,2*w0(Qte(e))-fs]};R();R();function XE(i,e){return[i,e]}l(XE,"equirectangularRaw");XE.invert=XE;R();function vie(i,e){var t=oo(e),n=oo(i)*t;return[t*Yr(i)/n,Yr(e)/n]}l(vie,"gnomonicRaw");vie.invert=Wg(w0);R();R();function _ie(i,e){var t=e*e,n=t*t;return[i*(.8707-.131979*t+n*(-.013791+n*(.003971*t-.001529*n))),e*(1.007226+t*(.015085+n*(-.044475+.028874*t-.005916*n)))]}l(_ie,"naturalEarth1Raw");_ie.invert=function(i,e){var t=e,n=25,r;do{var a=t*t,o=a*a;t-=r=(t*(1.007226+a*(.015085+o*(-.044475+.028874*a-.005916*o)))-e)/(1.007226+a*(.015085*3+o*(-.044475*7+.028874*9*a-.005916*11*o)))}while(hh(r)>Co&&--n>0);return[i/(.8707+(a=t*t)*(-.131979+a*(-.013791+a*a*a*(.003971-.001529*a)))),t]};R();function xie(i,e){return[oo(e)*Yr(i),Yr(e)]}l(xie,"orthographicRaw");xie.invert=Wg(A0);R();function bie(i,e){var t=oo(e),n=1+oo(i)*t;return[t*Yr(i)/n,Yr(e)/n]}l(bie,"stereographicRaw");bie.invert=Wg(function(i){return 2*w0(i)});R();function wie(i,e){return[eie(tie((fs+e)/2)),-i]}l(wie,"transverseMercatorRaw");wie.invert=function(i,e){return[-e,2*w0(Qte(i))-fs]};R();ii(v0(),1);R();ii(v0(),1);R();ii(v0(),1);R();R();ii(v0(),1);R();R();R();R();function ZE(i){var e,t,n,r,a,o;let s=((t=(e=i.enterprise)==null?void 0:e.locations)==null?void 0:t.reduce((d,f)=>(d[f.id]=f,d),{}))||{};for(let d of((n=i.enterprise)==null?void 0:n.locationInstances)||[])s[d.id]=d;let u={};for(let d of i["floorstack.json"]||[])u[d.id]=d;let h={};for(let d of((r=i["floor.geojson"])==null?void 0:r.features)||[])d.properties&&d.properties.id&&(h[d.properties.id]=d.properties);return{type:"downloaded",data:i,optimized:{"enterprise-location":s,"enterprise-category":((o=(a=i.enterprise)==null?void 0:a.categories)==null?void 0:o.reduce((d,f)=>(d[f.id]=f,d),{}))||{},"floor-stack":u,floor:h}}}l(ZE,"parseLocalePackToLanguagePack");function Aie(i){return/^https?:\/\/cdn\.mappedin\.com/.test(i)}l(Aie,"isMappedinCdnUrl");function Sie(i){let e=i.split("?")[1];return!!(e!=null&&e.includes("sv="))}l(Sie,"hasSasToken");function gu(i,e){var t;let n=((t=i?.properties)==null?void 0:t.id)||"unknown";if(i.geometry==null)return nt.error('Cannot get the center coordinate for "'.concat(n,'" because it has no geometry.')),new Wn({latitude:0,longitude:0,floorId:e});try{if(i.geometry.type==="LineString"){let[[r,a],[o,s]]=i.geometry.coordinates,u=(r+o)/2,h=(a+s)/2;return new Wn({latitude:h,longitude:u,floorId:e})}else if(i.geometry.type==="Point"){let[r,a]=i.geometry.coordinates;return new Wn({latitude:a,longitude:r,floorId:e})}else if(i.geometry.type==="Polygon"){let r=i;if(r.properties.center!=null){let[a,o]=r.properties.center;return new Wn({latitude:o,longitude:a,floorId:e})}}}catch{}try{let[r,a]=sD(i).geometry.coordinates;return new Wn({latitude:a,longitude:r,floorId:e})}catch(r){return nt.error('Failed to get center coordinate for "'.concat(n,'" ').concat(r instanceof Error?r.stack:"")),new Wn({latitude:0,longitude:0,floorId:e})}}l(gu,"getCenterCoordinate");var zu,No,Tf,xp,YE=class Dx extends Xc{constructor(e,t){super(t.mvfData.properties.id),D(this,"__type",Dx.__type),ge(this,zu),ge(this,No,{}),ge(this,Tf),ge(this,xp),Ce(this,zu,e),Ce(this,Tf,t.floorId),Ce(this,xp,t.mvfData)}static is(e){return e.__type===Dx.__type}get locations(){return y(this,No).locations?y(this,No).locations:(y(this,No).locations=(y(this,zu).locationIdsByNodeId[this.id]||[]).map(e=>y(this,zu).getById("enterprise-location",e)).filter(Boolean),y(this,No).locations)}get space(){var e;return y(this,zu).getById("space",(e=y(this,zu).spaceIdsByNodeId[this.id])==null?void 0:e[0])}get floor(){let e=y(this,zu).getById("floor",y(this,Tf));if(e==null)throw new Error("Floor ".concat(y(this,Tf)," not found!"));return e}get coordinate(){return y(this,No).coordinate==null&&(y(this,No).coordinate=gu(y(this,xp),y(this,Tf))),y(this,No).coordinate}get externalId(){var e;return(e=y(this,xp).properties.externalId)!=null?e:""}get neighbors(){if(y(this,No).neighbours==null){let e=y(this,xp).properties.neighbors.map(t=>{let n=y(this,zu).getById("node",t.id);if(n==null)throw new Error("Node ".concat(t.id," not found!"));return n});y(this,No).neighbours=e}return y(this,No).neighbours}get geoJSON(){return lt(Me({},y(this,xp)),{properties:null})}get focusTarget(){return this.coordinate}get anchorTarget(){return this.coordinate}toJSON(){return{__type:Dx.__type,id:this.id,floor:this.floor.id,coordinate:this.coordinate.toJSON(),neighbors:this.neighbors.map(e=>e.id)}}destroy(){for(let e of Object.keys(y(this,No)))delete y(this,No)[e]}};zu=new WeakMap,No=new WeakMap,Tf=new WeakMap,xp=new WeakMap,l(YE,"Node"),D(YE,"__type","node");var jwe=YE,BA=jwe;R();R();var Pf,Mie=class{constructor(e,t){D(this,"id"),ge(this,Pf),this.id=e}get geoJSONBoundingBox(){return y(this,Pf)?y(this,Pf):"bbox"in this.geoJSON.geometry&&this.geoJSON.geometry.bbox?this.geoJSON.geometry.bbox:(Ce(this,Pf,m0(this.geoJSON)),y(this,Pf))}get geoJSON(){return{properties:null,type:"Feature",geometry:{type:"Polygon",coordinates:[[]]}}}};Pf=new WeakMap,l(Mie,"BaseMapData");var zA=Mie,Gp,el,Bl,ev,kx,JE,KE=class Rx extends zA{constructor(e,t){super(t.mvfData.id,e),ge(this,kx),D(this,"__type",Rx.__type),ge(this,Gp),ge(this,el,{}),ge(this,Bl),ge(this,ev),Ce(this,Gp,e),Ce(this,Bl,t.mvfData),Ce(this,ev,t.facadeId)}static is(e){return e.__type===Rx.__type}get type(){return y(this,Bl).type}get name(){var e;return(e=St(this,kx,JE).call(this,"name"))!=null?e:""}get shortName(){var e;return(e=St(this,kx,JE).call(this,"shortName"))!=null?e:""}get externalId(){var e;return(e=y(this,Bl).externalId)!=null?e:""}get floors(){var e,t;if(y(this,el).floors==null){let n=((t=(e=y(this,Bl).floors)!=null?e:y(this,Bl).maps)!=null?t:[]).reduce((r,a)=>{let o=y(this,Gp).floorsById[a];return o&&r.push(o),r},[]);n.length===0&&nt.error("Floor stack ".concat(this.id," has no floors")),y(this,el).floors=n.sort((r,a)=>r.elevation-a.elevation)}return y(this,el).floors}get defaultFloor(){if(y(this,el).defaultFloor!=null)return y(this,el).defaultFloor;let e=y(this,Bl).defaultFloor?y(this,Gp).getById("floor",y(this,Bl).defaultFloor):void 0;return y(this,el).defaultFloor=e||this.floors.reduce((t,n)=>Math.abs(n.elevation)<Math.abs(t.elevation)?n:t),y(this,el).defaultFloor}get facade(){return y(this,ev)?y(this,Gp).facadesById[y(this,ev)]:void 0}toJSON(){return{__type:Rx.__type,id:this.id,name:this.name,shortName:this.shortName,type:this.type,floors:this.floors.map(e=>e.id)}}destroy(){for(let e of globalThis.Object.keys(y(this,el)))delete y(this,el)[e]}};Gp=new WeakMap,el=new WeakMap,Bl=new WeakMap,ev=new WeakMap,kx=new WeakSet,JE=l(function(i){return y(this,Gp).getPropTranslation(this.__type,i,this.id,y(this,Bl)[i])},"#translate"),l(KE,"FloorStack"),D(KE,"__type","floor-stack");var Gwe=KE,Cie=Gwe;R();R();R();R();R();R();var Ox,Zh,QE=class Nx extends Xc{constructor(e){super(String(Hn())),D(this,"__type",Nx.__type),ge(this,Ox,{}),ge(this,Zh),Ce(this,Zh,e.mvfData)}static is(e){return e.__type===Nx.__type}get url(){return y(this,Zh).url}get name(){if("displayName"in y(this,Zh))return y(this,Zh).displayName;if("label"in y(this,Zh))return y(this,Zh).label}toJSON(){return{__type:Nx.__type,id:this.id,url:this.url,name:this.name}}destroy(){for(let e of globalThis.Object.keys(y(this,Ox)))delete y(this,Ox)[e]}};Ox=new WeakMap,Zh=new WeakMap,l(QE,"Hyperlink"),D(QE,"__type","hyperlink");var $we=QE,bw=$we;R();R();function ww(i){return typeof i=="string"?i:i.id}l(ww,"getId");function _D(i){return Array.isArray(i)&&Number.isFinite(i[0])&&Number.isFinite(i[1])}l(_D,"isPosition");var pM=8,qg=l(i=>typeof i=="number"?i.toFixed(pM):_D(i)?i[1].toFixed(pM)+"-"+i[0].toFixed(pM):i.map(e=>qg(e)).join("-"),"serializeCoords"),Hwe=l(i=>{let e=/^https:\/\/cdn\.mappedin\.com\/[^/]+\/[^/]+\.[a-zA-Z0-9]+$/,t=/^https:\/\/cdn-staging\.mappedin\.net\/[^/]+\/[^/]+\.[a-zA-Z0-9]+$/;return e.test(i)||t.test(i)},"isPrivateCdnAsset"),Eie=l(i=>{if(!Hwe(i))return null;let e="";i.startsWith("https://")?(e="https://",i=i.slice(8)):i.startsWith("http://")&&(e="http://",i=i.slice(7));let[t,n,r]=i.split("/");return{origin:e+t,mapId:n,fileName:r}},"parseCdnAssetUrl"),Fx,bp,Lf,eI=class Bx extends Xc{constructor(e){super(String(Hn())),D(this,"__type",Bx.__type),ge(this,Fx,{}),ge(this,bp),ge(this,Lf),Ce(this,bp,e.mvfData),Ce(this,Lf,e.mapData)}static is(e){return e.__type===Bx.__type}get url(){let e=y(this,bp).url;if(y(this,Lf).tokenManager==null)return e;let t=Eie(y(this,bp).url);if(t==null)return e;let n=t.mapId;try{if(y(this,Lf).tokenManager.isEnterpriseMode())return e;let r=y(this,Lf).tokenManager.getSasToken(n).token;if(r==null||r==="")throw new Error("SAS token empty!");return"".concat(e,"?").concat(r)}catch(r){return nt.error("Error getting SAS token for image",{error:r,url:e}),e}}get name(){return y(this,bp).altText}get altText(){return y(this,bp).altText}toJSON(){return{__type:Bx.__type,id:this.id,url:this.url,name:this.name}}destroy(){for(let e of globalThis.Object.keys(y(this,Fx)))delete y(this,Fx)[e]}};Fx=new WeakMap,bp=new WeakMap,Lf=new WeakMap,l(eI,"ImageMetaData"),D(eI,"__type","image");var Wwe=eI,Aw=Wwe,tv,Yh,Jh,Iie=class extends zA{constructor(e,t){super(t.properties.id,e),ge(this,tv),ge(this,Yh),ge(this,Jh,{}),Ce(this,tv,e),Ce(this,Yh,t)}get externalId(){var e;return(e=y(this,Yh).properties.externalId)!=null?e:""}get name(){var e,t,n,r;let a=(t=(e=y(this,Yh).properties.details)==null?void 0:e.name)!=null?t:"";return a===""&&(a=(r=(n=this.locationProfiles.find(o=>o.name&&o.name.length>0))==null?void 0:n.name)!=null?r:""),a}get description(){var e,t,n,r;let a=(t=(e=y(this,Yh).properties.details)==null?void 0:e.description)!=null?t:"";return a===""&&(a=(r=(n=this.locationProfiles.find(o=>o.description&&o.description.length>0))==null?void 0:n.description)!=null?r:""),a}get images(){var e,t,n,r,a;if(y(this,Jh).images!=null)return y(this,Jh).images;let o=(n=(t=(e=y(this,Yh).properties.details)==null?void 0:e.images)==null?void 0:t.map(s=>new Aw({mvfData:s,mapData:y(this,tv)})))!=null?n:[];return(o==null||o.length===0)&&(o=(a=(r=this.locationProfiles.find(s=>s.images.length>0))==null?void 0:r.images)!=null?a:[]),y(this,Jh).images=o,o}get links(){var e,t,n,r,a;if(y(this,Jh).links!=null)return y(this,Jh).links;let o=(n=(t=(e=y(this,Yh).properties.details)==null?void 0:e.links)==null?void 0:t.map(s=>new bw({mvfData:s})))!=null?n:[];return(o==null||o.length===0)&&(o=(a=(r=this.locationProfiles.find(s=>s.links.length>0))==null?void 0:r.links)!=null?a:[]),y(this,Jh).links=o,o}get locationProfiles(){var e;return(e=y(this,tv).locationProfilesByAttachedFeatureId[this.id])!=null?e:[]}};tv=new WeakMap,Yh=new WeakMap,Jh=new WeakMap,l(Iie,"DetailedMapData");var Od=Iie,zx,Df,iv,nv,tI=class Ux extends Od{constructor(e,t){super(e,t.mvfData),D(this,"__type",Ux.__type),ge(this,zx),ge(this,Df),ge(this,iv,{}),ge(this,nv),Ce(this,zx,e),Ce(this,Df,t.floorId),Ce(this,nv,t.mvfData)}static is(e){return e.__type===Ux.__type}get center(){return y(this,iv).center==null&&(y(this,iv).center=gu(y(this,nv),y(this,Df))),y(this,iv).center}get floor(){let e=y(this,zx).getById("floor",y(this,Df));if(e==null)throw new Error("Floor ".concat(y(this,Df)," not found!"));return e}get geoJSON(){return lt(Me({},y(this,nv)),{properties:null})}get focusTarget(){return this}get anchorTarget(){return this.center}toJSON(){return{__type:Ux.__type,id:this.id,name:this.name,floor:this.floor.id}}destroy(){}};zx=new WeakMap,Df=new WeakMap,iv=new WeakMap,nv=new WeakMap,l(tI,"Area"),D(tI,"__type","area");var qwe=tI,UA=qwe;R();var kf,Kh,Rf,rv,iI=class Vx extends Od{constructor(e,t){super(e,t.mvfData),D(this,"__type",Vx.__type),ge(this,kf),ge(this,Kh),ge(this,Rf),ge(this,rv),Ce(this,Kh,{}),Ce(this,rv,t.mvfData),Ce(this,kf,e),Ce(this,Rf,t.floorId)}static is(e){return e.__type===Vx.__type}get floor(){let e=y(this,kf).getById("floor",y(this,Rf));if(e==null)throw new Error("Floor ".concat(y(this,Rf)," not found!"));return e}get center(){return y(this,Kh).center==null&&(y(this,Kh).center=gu(y(this,rv),y(this,Rf))),y(this,Kh).center}get isExterior(){var e;let t=y(this,kf).obstructionIdByEntranceId[this.id],n=y(this,kf).getMVFFeatureById("obstruction",t);return(e=n?.properties.footprintComponent)!=null?e:!1}get geoJSON(){return lt(Me({},y(this,rv)),{properties:null})}get focusTarget(){return this.center}get anchorTarget(){return this.center}toJSON(){return{__type:Vx.__type,id:this.id,name:this.name,floor:this.floor.id,center:this.center.toJSON()}}destroy(){for(let e of Object.keys(y(this,Kh)))delete y(this,Kh)[e]}};kf=new WeakMap,Kh=new WeakMap,Rf=new WeakMap,rv=new WeakMap,l(iI,"Door"),D(iI,"__type","door");var Xwe=iI,S0=Xwe;R();var wp,Of,Ts,Uu,nI=class jx extends Od{constructor(e,t){super(e,t.mvfData),D(this,"__type",jx.__type),ge(this,wp),ge(this,Of),ge(this,Ts,{}),ge(this,Uu),Ce(this,wp,e),Ce(this,Of,t.floorId),Ce(this,Uu,t.mvfData)}getMvfData(){return y(this,Uu)}static is(e){return e.__type===jx.__type}get type(){return Tie(y(this,Uu).properties.kind)}get locations(){if(y(this,Ts).locations)return y(this,Ts).locations;y(this,Ts).locations=[];let e=y(this,wp).mvfLocationsBySpaceId[y(this,Uu).properties.id];if(e?.length>0)for(let t of e){let n=y(this,wp).getById("enterprise-location",t.id);n&&y(this,Ts).locations.push(n)}return y(this,Ts).locations}get floor(){let e=y(this,wp).getById("floor",y(this,Of));if(e==null)throw new Error("Floor ".concat(y(this,Of)," not found!"));return e}get doors(){return y(this,Uu).properties.destinationNodes.reduce((e,t)=>{let n=y(this,wp).doorsByNodeId[t];return n&&e.push(n),e},[])}get center(){return y(this,Ts).center==null&&(y(this,Ts).center=gu(y(this,Uu),y(this,Of))),y(this,Ts).center}get geoJSON(){return lt(Me({},y(this,Uu)),{properties:null})}get focusTarget(){return this.geoJSON.geometry.type==="Polygon"?this:this.center}get anchorTarget(){return this.center}toJSON(){return{__type:jx.__type,id:this.id,name:this.name,type:this.type,floor:this.floor.id,center:this.center.toJSON()}}destroy(){for(let e of Object.keys(y(this,Ts)))delete y(this,Ts)[e]}};wp=new WeakMap,Of=new WeakMap,Ts=new WeakMap,Uu=new WeakMap,l(nI,"Space"),D(nI,"__type","space");var Zwe=nI,Ywe=["room","hallway","exterior","void","gate","connection.stairs","connection.elevator","poi"];function Tie(i){if(i==null||i==="default")return"room";let e=i.toLowerCase();return Ywe.includes(e)?e:"room"}l(Tie,"validateSpaceType");var ru=Zwe;R();var ll,Xn,Ds,av,Gx,rI=class $x extends zA{constructor(e,t){super(t.mvfData.properties.id,e),ge(this,av),D(this,"__type",$x.__type),ge(this,ll),ge(this,Xn,{}),ge(this,Ds),Ce(this,ll,e),Ce(this,Ds,t.mvfData)}static is(e){return e.__type===$x.__type}get focusTarget(){return this}get name(){var e,t;return"name"in y(this,Ds).properties?(t=St(this,av,Gx).call(this,"name"))!=null?t:"":(e=y(this,Ds).properties.externalId)!=null?e:""}get shortName(){var e,t;return"shortName"in y(this,Ds).properties?(t=St(this,av,Gx).call(this,"shortName"))!=null?t:"":(e=y(this,Ds).properties.externalId)!=null?e:""}get subtitle(){var e;return(e=St(this,av,Gx).call(this,"subtitle"))!=null?e:""}get externalId(){var e;return(e=y(this,Ds).properties.externalId)!=null?e:""}get elevation(){return y(this,Ds).properties.elevation}get spaces(){if(y(this,Xn).spaces==null){let e=y(this,ll).spaces.filter(t=>t.floor.id===this.id);y(this,Xn).spaces=e}return y(this,Xn).spaces}get geoJSON(){var e;return{type:"Feature",properties:null,geometry:(e=y(this,Ds).geometry)!=null?e:{type:"Polygon",coordinates:[]}}}get objects(){if(y(this,Xn).objects==null){let e=y(this,ll).objects.filter(t=>t.floor.id===this.id);y(this,Xn).objects=e}return y(this,Xn).objects}get connections(){if(y(this,Xn).connections==null){let e=y(this,ll).connections.filter(t=>t.floors.includes(this));y(this,Xn).connections=e}return y(this,Xn).connections}get doors(){if(y(this,Xn).doors==null){let e=y(this,ll).doors.filter(t=>t.floor.id===this.id);y(this,Xn).doors=e}return y(this,Xn).doors}get annotations(){if(y(this,Xn).annotations==null){let e=y(this,ll).annotations.filter(t=>t.floor.id===this.id);y(this,Xn).annotations=e}return y(this,Xn).annotations}get pois(){if(y(this,Xn).pois==null){let e=y(this,ll).pointsOfInterest.filter(t=>t.floor.id===this.id);y(this,Xn).pois=e}return y(this,Xn).pois}get floorStack(){if(y(this,Xn).floorStack==null){let e=y(this,ll).floorStacks.find(t=>t.floors.includes(this));y(this,Xn).floorStack=e}return y(this,Xn).floorStack}get center(){return y(this,Xn).center==null&&(y(this,Xn).center=gu(y(this,Ds),this.id)),y(this,Xn).center}toJSON(){return{__type:$x.__type,id:this.id,name:this.name,shortName:this.shortName,subtitle:this.subtitle,elevation:this.elevation,spaces:this.spaces.map(e=>e.id),objects:this.objects.map(e=>e.id),connections:this.connections.map(e=>e.id),doors:this.doors.map(e=>e.id),annotations:this.annotations.map(e=>e.id),pois:this.pois.map(e=>e.id)}}destroy(){for(let e of globalThis.Object.keys(y(this,Xn)))delete y(this,Xn)[e]}};ll=new WeakMap,Xn=new WeakMap,Ds=new WeakMap,av=new WeakSet,Gx=l(function(i){let e=y(this,Ds).properties[i];return y(this,ll).getPropTranslation(this.__type,i,this.id,e)},"#translate"),l(rI,"Floor"),D(rI,"__type","floor");var Jwe=rI,Kl=Jwe;R();R();R();var Pie=l(i=>i!=null,"notNull");R();function Sw(i){let e;if(ru.is(i)||S0.is(i)||wd.is(i)||UA.is(i)||Dg.is(i))e=i.center;else if(GA.is(i)||$A.is(i))e=i.coordinate;else if(Wn.is(i))e=i;else if(BA.is(i))e=i.coordinate;else if(A1.is(i))e=i.coordinates[0];else return;return e}l(Sw,"getCoordinateFromStuffs");R();R();var ov={auto:!0,debug:!1,pitch:45,bearing:0,antialiasing:{enabled:!0},shadingAndOutlines:!0,outdoorView:{layersHiddenByGeometry:["building","building-top"]},imagePlacementOptions:{mode:"default"},flipImagesToFaceCamera:!0,multiFloorView:{enabled:!1,floorHeight:10}},Ag="ExteriorWalls",VA="Walls",Kwe=0,xD="InteriorDoors",bD="ExteriorDoors",Ga="GeometryLayer",Sg="LabelsLayer",ud="MarkersLayer",aI="FootprintLayer",Wv="OcclusionLayer",Mg="ImagesLayer",qv="FacadesLayer",Qwe=["https://mappedin.auth0.com","https://mappedin-staging.auth0.com"],eAe={orange:"#F26336",teal:"#057685",lightTeal:"#5DC7D0"},tAe=new Set(["outdoorView","bearing","pitch","zoomLevel","screenOffsets","debug","initialFloor","shadingAndOutlines","wallTopColor","style","multiFloorView","occlusion","imagePlacementOptions","flipImagesToFaceCamera","injectStyles","useStandaloneCamera","preloadFloors","hideImagesNotOnCurrentFloor"]),iAe=new Set(["style","enabled","layersHiddenByGeometry","lowDpi"]);function Lie(i){var e,t;(e=i.outdoorView)!=null&&e.enabled&&!((t=i.outdoorView)!=null&&t.token)&&nt.error("Enable outdoor view requires a token. Provide token in `options.outdoorView.token`")}l(Lie,"validateOptions");function Die(i,e){var t,n,r,a,o,s;let u=((t=i?.outdoorView)==null?void 0:t.token)||e.outdoorViewToken,h=lt(Me(Me({},ov),i),{outdoorView:Me({enabled:((n=i?.outdoorView)==null?void 0:n.enabled)===void 0?!!u:(r=i?.outdoorView)==null?void 0:r.enabled,layersHiddenByGeometry:(a=ov.outdoorView)==null?void 0:a.layersHiddenByGeometry},i?.outdoorView),bearing:(s=(o=i?.bearing)!=null?o:e.naturalBearing)!=null?s:0,imagePlacementOptions:Me(Me({},ov.imagePlacementOptions),i?.imagePlacementOptions),multiFloorView:Me(Me({},ov.multiFloorView),i?.multiFloorView)});return u&&h.outdoorView&&(h.outdoorView.token=u),h}l(Die,"handleShow3DMapOptionDefault");function kie(i){let e={remove_watermark:!1};if(i)try{let t=BL(i);Object.assign(e,t.capabilities)}catch(t){nt.error("Error decoding capabilities from token",t)}return e}l(kie,"handleTokenCapabilities");function Rie(i){let e=Object.fromEntries(Object.entries(i).filter(([t])=>tAe.has(t)));return e.outdoorView&&(e.outdoorView=Object.fromEntries(Object.entries(e.outdoorView).filter(([t])=>iAe.has(t)))),e}l(Rie,"getPublicOptions");var Ap,tl,Qh,oI=class Hx extends Od{constructor(e,t){let n=Object.values(t.mvfDataByFloorId)[0];super(e,n),D(this,"__type",Hx.__type),ge(this,Ap),ge(this,tl),ge(this,Qh),Ce(this,tl,{}),Ce(this,Ap,e),Ce(this,Qh,t.mvfDataByFloorId)}static is(e){return e.__type===Hx.__type}get accessible(){var e;return(e=Object.values(y(this,Qh))[0].properties.accessible)!=null?e:!1}get type(){var e,t;return(t=(e=Object.values(y(this,Qh))[0].properties.kind)==null?void 0:e.split(".")[1])!=null?t:"unknown"}get extra(){return Object.values(y(this,Qh))[0].properties.extra}get coordinates(){return y(this,tl).coordinates==null&&(y(this,tl).coordinates=Object.entries(y(this,Qh)).map(([e,t])=>gu(t,e))),y(this,tl).coordinates}get nodes(){return Object.values(y(this,Qh))[0].properties.nodes.map(e=>y(this,Ap).getById("node",e))}get floors(){return this.coordinates.map(e=>e.floorId?y(this,Ap).getById("floor",e.floorId):void 0).filter(Pie)}get locationProfiles(){var e,t,n,r,a;if(y(this,tl).locationProfiles!=null)return y(this,tl).locationProfiles;let o=super.locationProfiles;if(o==null||o.length===0){let s=[(t=(e=this.coordinates[0])==null?void 0:e.longitude)!=null?t:0,(r=(n=this.coordinates[0])==null?void 0:n.latitude)!=null?r:0],u=qg(s),h=(a=y(this,Ap).mvfConnectionIdsByLatLon[u])!=null?a:[];for(let d of h){let f=y(this,Ap).locationProfilesByAttachedFeatureId[d];if(f!=null){o=f;break}}}return y(this,tl).locationProfiles=o??[],o}get focusTarget(){return this.coordinates}toJSON(){return{__type:Hx.__type,id:this.id,name:this.name,type:this.type,externalId:this.externalId,coordinates:this.coordinates.map(e=>e.toJSON()),floors:this.floors.map(e=>e.id),extra:this.extra}}destroy(){for(let e of Object.keys(y(this,tl)))delete y(this,tl)[e]}};Ap=new WeakMap,tl=new WeakMap,Qh=new WeakMap,l(oI,"Connection"),D(oI,"__type","connection");var nAe=oI,jA=nAe;R();var Wx,Nf,Sp,Ff,sI=class qx extends Od{constructor(e,t){super(e,t.mvfData),D(this,"__type",qx.__type),ge(this,Wx),ge(this,Nf),ge(this,Sp,{}),ge(this,Ff),Ce(this,Wx,e),Ce(this,Nf,t.floorId),Ce(this,Ff,t.mvfData)}static is(e){return e.__type===qx.__type}get type(){let e=y(this,Ff).properties.kind;return e==null&&(e="object"),e==="Desks"&&(e="desk"),e.toLowerCase()}get floor(){let e=y(this,Wx).getById("floor",y(this,Nf));if(e==null)throw new Error("Floor ".concat(y(this,Nf)," not found!"));return e}get center(){return y(this,Sp).center==null&&(y(this,Sp).center=gu(y(this,Ff),y(this,Nf))),y(this,Sp).center}get geoJSON(){return lt(Me({},y(this,Ff)),{properties:null})}get anchorTarget(){return this.center}get focusTarget(){return this.geoJSON.geometry.type==="Polygon"?this:this.center}toJSON(){return{__type:qx.__type,id:this.id,name:this.name,type:this.type,floor:this.floor.id,center:this.center.toJSON()}}destroy(){for(let e of globalThis.Object.keys(y(this,Sp)))y(this,Sp)[e]=null}};Wx=new WeakMap,Nf=new WeakMap,Sp=new WeakMap,Ff=new WeakMap,l(sI,"MapObject"),D(sI,"__type","object");var rAe=sI,wd=rAe;R();var Xx,Bf,Mp,sv,lI=class Zx extends Od{constructor(e,t){super(e,t.mvfData),D(this,"__type",Zx.__type),ge(this,Xx),ge(this,Bf),ge(this,Mp,{}),ge(this,sv),Ce(this,Xx,e),Ce(this,sv,t.mvfData),Ce(this,Bf,t.floorId)}static is(e){return e.__type===Zx.__type}get floor(){let e=y(this,Xx).getById("floor",y(this,Bf));if(e==null)throw new Error("Floor ".concat(y(this,Bf)," not found!"));return e}get coordinate(){return y(this,Mp).coordinate==null&&(y(this,Mp).coordinate=gu(y(this,sv),y(this,Bf))),y(this,Mp).coordinate}get geoJSON(){return lt(Me({},y(this,sv)),{properties:null})}get focusTarget(){return this.coordinate}get anchorTarget(){return this.coordinate}toJSON(){return{__type:Zx.__type,id:this.id,name:this.name,floor:this.floor.id,coordinate:this.coordinate.toJSON()}}destroy(){for(let e in y(this,Mp))y(this,Mp)[e]=null}};Xx=new WeakMap,Bf=new WeakMap,Mp=new WeakMap,sv=new WeakMap,l(lI,"PointOfInterest"),D(lI,"__type","point-of-interest");var aAe=lI,GA=aAe;R();var Yx,zf,Cp,Mm,Jx,uI,hI=class Kx extends Od{constructor(e,t){super(e,t.mvfData),ge(this,Jx),D(this,"__type",Kx.__type),ge(this,Yx),ge(this,zf),ge(this,Cp,{}),ge(this,Mm),Ce(this,Yx,e),Ce(this,zf,t.floorId),Ce(this,Mm,t.mvfData)}static is(e){return e.__type===Kx.__type}get group(){return St(this,Jx,uI).call(this).group}get type(){return St(this,Jx,uI).call(this).type}get coordinate(){return y(this,Cp).coordinate==null&&(y(this,Cp).coordinate=gu(y(this,Mm),y(this,zf))),y(this,Cp).coordinate}get floor(){let e=y(this,Yx).getById("floor",y(this,zf));if(e==null)throw new Error("Floor ".concat(y(this,zf)," not found!"));return e}get geoJSON(){return lt(Me({},y(this,Mm)),{properties:null})}get focusTarget(){return this.coordinate}get anchorTarget(){return this.coordinate}toJSON(){return{__type:Kx.__type,id:this.id,group:this.group,type:this.type,coordinate:this.coordinate.toJSON()}}destroy(){for(let e of Object.keys(y(this,Cp)))delete y(this,Cp)[e]}};Yx=new WeakMap,zf=new WeakMap,Cp=new WeakMap,Mm=new WeakMap,Jx=new WeakSet,uI=l(function(){let[i,e]=y(this,Mm).properties.symbolId.split("--");return{group:i,type:e}},"#getGroupAndTypeFromSymbolId"),l(hI,"Annotation"),D(hI,"__type","annotation");var oAe=hI,$A=oAe;R();var sAe=new Set(["wall","area"]),lAe=new Set(["void","desk-entrance"]),uAe=l((i,e)=>{var t,n,r,a,o,s,u,h,d,f,m;let v={},b={},w={},A={},E={},I={};for(let C of i["location.json"]||[]){let T=new o6(e,{mvfData:C});if(v[C.id]=T,C.externalId&&(A[C.externalId]==null&&(A[C.externalId]=[]),A[C.externalId].push(T)),C.categories)for(let F of C.categories)E[F]==null&&(E[F]=[]),E[F].push(T);let k=[...(n=(t=C.obstructions)==null?void 0:t.map(F=>F.id))!=null?n:[],...(a=(r=C.spaces)==null?void 0:r.map(F=>F.id))!=null?a:[],...(s=(o=C.annotations)==null?void 0:o.map(F=>F.id))!=null?s:[],...(u=C.connections)!=null?u:[],...(d=(h=C.entrances)==null?void 0:h.map(F=>F.id))!=null?d:[],...(m=(f=C.areas)==null?void 0:f.map(F=>F.id))!=null?m:[]];for(let F of k)F&&(I[F]==null&&(I[F]=[]),I[F].push(T))}for(let C of i["category.json"]||[]){let T=new yue(e,{mvfData:C});b[C.id]=T,C.parent&&(w[C.parent]==null&&(w[C.parent]=[]),w[C.parent].push(T))}return{locationCategoriesByParentId:w,locationProfilesById:v,locationCategoriesById:b,locationProfilesByExternalId:A,locationProfilesByCategoryId:E,locationProfilesByAttachedFeatureId:I}},"processMVFLocationProfilesAndCategories"),hAe=l((i,e,t)=>{var n,r;let a={},o={},s={},u={},h={},d={},f={},m={},v={},b={},w={},A=globalThis.Object.keys(i.space);for(let E of A){let I=i.space[E];if(I!=null){for(let C of I.features)if(w[C.properties.id]=E,d[C.properties.id]=C,C.properties.kind==="desk-entrance"&&(h[C.properties.externalId]==null&&(h[C.properties.externalId]=[]),h[C.properties.externalId].push(...C.properties.destinationNodes)),!lAe.has((n=C.properties.kind)!=null?n:"")){if((r=C.properties.kind)!=null&&r.includes("connection")){let T=qg(C.geometry.coordinates);v[T]==null&&(v[T]=[]),v[T].push(C.properties.id);continue}if(C.properties.kind==="poi"){let T=new GA(t,{floorId:E,mvfData:C});s[C.properties.id]=T,m[E]||(m[E]=[]),m[E].push(C),C.properties.externalId&&(u[C.properties.externalId]==null&&(u[C.properties.externalId]=[]),u[C.properties.externalId].push(T))}else{let T=new ru(t,{floorId:E,mvfData:C});a[C.properties.id]=T,C.properties.externalId&&(o[C.properties.externalId]==null&&(o[C.properties.externalId]=[]),o[C.properties.externalId].push(T)),f[E]||(f[E]=[]),f[E].push(C)}}}}for(let E in v){let I=v[E],C={};for(let k of I){let F=w[k],B=d[k],N=e?.["n_"+B.properties.id.split("s_")[1]];C[F]=lt(Me({},B),{properties:lt(Me({},B.properties),{accessible:N?.accessible===!0})})}let T=new jA(t,{mvfDataByFloorId:C});b[T.id]=T}return{spacesById:a,spacesByExternalId:o,poisById:s,poisByExternalId:u,connectionsById:b,objectEntranceNodeIdsByObstructionId:h,mvfSpacesById:d,connectionIdsByLatLon:v,mvfSpacesByFloorId:f,mvfPoisByFloorId:m}},"processMVFSpaces"),cAe=l((i,e)=>{var t,n;let r={},a={},o={},s={};for(let u of i["node.geojson"].features){o[u.properties.id]=u;let h=new BA(e,{mvfData:u,floorId:(t=u.properties.floor)!=null?t:u.properties.map});r[u.properties.id]=h,u.properties.externalId&&(a[u.properties.externalId]==null&&(a[u.properties.externalId]=[]),a[u.properties.externalId].push(h));let d=(n=u.properties.floor)!=null?n:u.properties.map;s[d]||(s[d]=[]),s[d].push(u)}return{nodesById:r,nodesByExternalId:a,mvfNodesById:o,mvfNodesByFloorId:s}},"processMVFNodes"),pAe=l((i,e)=>{var t,n;let r={},a={},o={},s={},u=globalThis.Object.keys(i.obstruction);for(let h of u){let d=i.obstruction[h];if(d!=null)for(let f of d.features){o[f.properties.id]=f;for(let v of f.properties.entrances)s[v]=f.properties.id;if(sAe.has((n=(t=f.properties.kind)==null?void 0:t.toLowerCase())!=null?n:""))continue;let m=new wd(e,{floorId:h,mvfData:f});r[f.properties.id]=m,f.properties.externalId&&(a[f.properties.externalId]==null&&(a[f.properties.externalId]=[]),a[f.properties.externalId].push(m))}}return{objectsById:r,objectsByExternalId:a,mvfObstructionById:o,obstructionIdByEntranceId:s}},"processMVFObstructions"),dAe=l((i,e)=>{let t={},n={},r={};if("floor.geojson"in i&&i["floor.geojson"]!=null)for(let a of i["floor.geojson"].features){r[a.properties.id]=a.properties;let o=new Kl(e,{mvfData:a});t[a.properties.id]=o,a.properties.externalId&&(n[a.properties.externalId]==null&&(n[a.properties.externalId]=[]),n[a.properties.externalId].push(o))}else for(let a of i["map.geojson"]){r[a.id]=a;let o=new Kl(e,{mvfData:{properties:a}});t[a.id]=o}return{floorsById:t,floorsByExternalId:n,mvfFloorsById:r}},"processMVFFloors"),fAe=l((i,e)=>{var t;let n={},r={},a={},o={},s={},u=i["floorstack.json"]||i["mapstack.json"]||i["mapstack.geojson"];if(u!=null)for(let h of u){let d=(t=i.facade)==null?void 0:t[h.id],f=new Cie(e,{mvfData:h,facadeId:d?.id});if(n[h.id]=f,h.externalId&&(r[h.externalId]==null&&(r[h.externalId]=[]),r[h.externalId].push(f)),a[h.id]=h,d){let m=new Dg(e,{mvfData:d,floorStackId:h.id});o[d.id]=m;for(let v of d.spaces)s[v.spaceId]=m}}return{floorStacksById:n,floorStacksByExternalId:r,mvfFloorStacksById:a,facadesById:o,facadesBySpaceId:s}},"processMVFFloorStacks"),mAe=l((i,e)=>{let t={},n={},r=i["connection.json"].reduce((a,o)=>{o.nodes.forEach(u=>a[u]=o),t[o.id]=o;let s=e?.[o.nodes[0]];if(s!=null){let u=qg(s.geometry.coordinates);n[u]==null&&(n[u]=[]),n[u].push(o.id)}return a},{});return{mvfConnectionsById:t,mvfConnectionsByNodeId:r,mvfConnectionIdsByLatLon:n}},"processMVFConnections"),gAe=l((i,e)=>{let t={},n={},r={},a={},o={},s=globalThis.Object.keys(i.entrance);for(let u of s){let h=i.entrance[u];if(h!=null)for(let d of h.features){a[d.properties.id]=d;let f=new S0(e,{floorId:u,mvfData:d});d.properties.node&&(r[d.properties.node]=f),t[d.properties.id]=f,d.properties.externalId&&(n[d.properties.externalId]==null&&(n[d.properties.externalId]=[]),n[d.properties.externalId].push(f)),o[u]||(o[u]=[]),o[u].push(d)}}return{doorsById:t,doorsByExternalId:n,doorsByNodeId:r,mvfEntrancesById:a,mvfEntrancesByFloorId:o}},"processMVFEntrances"),yAe=l((i,e,t)=>{var n;if(i.textAreas!=null)for(let r in i.textAreas){let a=(n=i.textAreas[r])==null?void 0:n.features;if(a!=null){for(let o of a)if("anchorId"in o.properties){let s=o?.properties,u=e[s.anchorId]||t[s.anchorId];if(u!=null&&s!=null){let h=u.properties;h.textArea=s,h.textArea&&(h.textArea.position=o.geometry.coordinates)}}}}},"processMVFTextAreas"),vAe=l((i,e,t)=>{var n;if(i.floorImages!=null)for(let r in i.floorImages){let a=(n=i.floorImages[r])==null?void 0:n.features;if(a!=null){for(let o of a)if("anchorId"in o.properties){let s=o?.properties,u=e[s.anchorId]||t[s.anchorId];if(u!=null&&s!=null){let h=u.properties;h.image=s,h.image&&(h.image.position=o.geometry.coordinates)}}}}},"processMVFPolygonImages"),_Ae=l((i,e)=>{var t,n;if(((t=i.enterprise)==null?void 0:t.enterpriseStyles)==null)return;let r=(n=i.enterprise)==null?void 0:n.enterpriseStyles;for(let a in r){let o=r[a];o.geometryAnchors.forEach(s=>{let u=e[s.geometryId];if(u!=null){let h=u.properties;h.style={styleId:a,edgeOffset:o.edgeOffset}}})}},"processMVFEnterprisePolygonStyles"),xAe=l((i,e,t)=>{if(!(i.enterprise==null||i.enterprise.textures==null))for(let n of i.enterprise.textures)for(let r of n.geometryAnchors){let a=e[r.geometryId]||t[r.geometryId];if(a!=null){let o=a.properties;o.textures==null&&(o.textures=[]),o.textures.push(n)}}},"processMVFEnterpriseTextures"),bAe=l((i,e)=>{let t={},n={},r={};if(i.annotation==null)return{annotationsById:t,mvfAnnotationsById:n,mvfAnnotationsByFloorId:r};let a=globalThis.Object.keys(i.annotation);for(let o of a){let s=i.annotation[o];if(s!=null)for(let u of s.features){n[u.properties.id]=u;let h=new $A(e,{floorId:o,mvfData:u});t[u.properties.id]=h,r[o]||(r[o]=[]),r[o].push(u)}}return{annotationsById:t,mvfAnnotationsById:n,mvfAnnotationsByFloorId:r}},"processMVFAnnotations"),wAe=l((i,e)=>{let t={},n={},r={};if(i.area==null)return{areasById:t,areasByExternalId:n,mvfAreasById:r};let a=globalThis.Object.keys(i.area);for(let o of a){let s=i.area[o];if(s!=null)for(let u of s.features){r[u.properties.id]=u;let h=new UA(e,{floorId:o,mvfData:u});t[u.properties.id]=h,u.properties.externalId&&(n[u.properties.externalId]==null&&(n[u.properties.externalId]=[]),n[u.properties.externalId].push(h))}}return{areasById:t,areasByExternalId:n,mvfAreasById:r}},"processMVFAreas"),AAe=l((i,e)=>{var t,n,r,a,o,s,u,h,d,f,m,v,b;let w={},A={},E={},I={},C=((n=(t=i.enterprise)==null?void 0:t.locations)!=null?n:[]).reduce((Y,J)=>(Y[J.id]=J,Y),{}),T={},k={},F={},B={},N={},z={},L=((r=i.enterprise)==null?void 0:r.venue)||{},j={},q={},Z={};for(let Y of(o=(a=i.enterprise)==null?void 0:a.categories)!=null?o:[]){let J=new qie(e,{mvfData:Y});T[Y.id]=J,Y.externalId&&(k[Y.externalId]==null&&(k[Y.externalId]=[]),k[Y.externalId].push(J)),F[Y.id]=Y,Y.locations.forEach(oe=>{N[oe]==null&&(N[oe]=[]),N[oe].push(Y.id)})}let O={};for(let Y of(u=(s=i.enterprise)==null?void 0:s.locationInstances)!=null?u:[]){let J=C[Y.parent],oe=Object.keys(J),$={};for(let te of oe)$[te]=void 0;let K=Me(lt(Me({},$),{polygons:[],nodes:[]}),Y);O[K.parent]==null&&(O[K.parent]=[]),O[K.parent].push(new A1(e,{mvfData:K,categoryIds:((d=(h=i.enterprise)==null?void 0:h.categoryPriorities)==null?void 0:d[K.id])||N[K.id],parentId:Y.parent})),j[K.id]=Y}for(let Y in i.space){let J=i.space[Y];if(J!=null)for(let oe of J.features){for(let $ of oe.properties.destinationNodes)q[$]==null&&(q[$]=[]),q[$].push(oe.properties.id);Z[oe.properties.id]=oe.properties.destinationNodes}}for(let Y of(m=(f=i.enterprise)==null?void 0:f.locations)!=null?m:[]){let J=new A1(e,{mvfData:Y,categoryIds:((b=(v=i.enterprise)==null?void 0:v.categoryPriorities)==null?void 0:b[Y.id])||N[Y.id],locationInstances:O[Y.id]});E[Y.id]=J,Y.externalId&&(I[Y.externalId]==null&&(I[Y.externalId]=[]),I[Y.externalId].push(J)),Y.nodes.forEach(oe=>{z[oe.id]==null&&(z[oe.id]=[]),z[oe.id].push(Y.id)});for(let oe of Y.polygons)B[oe.id]==null&&(B[oe.id]=[]),B[oe.id].push(Y)}if(e.enterpriseMode===!0){for(let Y in e.mvfConnectionsById){let J={},oe=e.mvfConnectionsById[Y];for(let $ of e.mvfConnectionsById[Y].nodes){let K=e.nodesById[$];K!=null&&(J[K.floor.id]={type:"Feature",geometry:{type:"Point",coordinates:[K.coordinate.longitude,K.coordinate.latitude]},properties:{id:Y,externalId:oe.externalId,kind:"enterprise."+oe.type,destinationNodes:[],flags:"",type:oe.type,nodes:oe.nodes,accessible:oe.accessible,extra:oe.extra,details:oe.details}})}Object.keys(J).length>0&&(w[Y]=new jA(e,{mvfDataByFloorId:J}),oe.externalId&&(A[oe.externalId]==null&&(A[oe.externalId]=[]),A[oe.externalId].push(w[Y])))}e.connectionsById=w}return{spaceIdsByNodeId:q,connectionsByExternalId:A,locationIdsByNodeId:z,mvfLocationsBySpaceId:B,mvfLocationsById:C,mvfCategoriesById:F,locationsById:E,locationsByExternalId:I,locationInstancesById:j,categoriesById:T,categoriesByExternalId:k,destinationNodesIdsBySpaceId:Z,venue:L}},"createEnterpriseDataFromMVF"),SAe=l((i,e)=>{let{nodesById:t,nodesByExternalId:n,mvfNodesById:r,mvfNodesByFloorId:a}=cAe(i,e),{mvfConnectionsById:o,mvfConnectionsByNodeId:s,mvfConnectionIdsByLatLon:u}=mAe(i,r),{spacesById:h,spacesByExternalId:d,poisById:f,poisByExternalId:m,mvfSpacesById:v,objectEntranceNodeIdsByObstructionId:b,connectionsById:w,connectionIdsByLatLon:A,mvfSpacesByFloorId:E,mvfPoisByFloorId:I}=hAe(i,s,e),{objectsById:C,objectsByExternalId:T,mvfObstructionById:k,obstructionIdByEntranceId:F}=pAe(i,e),{floorsById:B,floorsByExternalId:N,mvfFloorsById:z}=dAe(i,e),{floorStacksById:L,floorStacksByExternalId:j,mvfFloorStacksById:q,facadesById:Z,facadesBySpaceId:O}=fAe(i,e),{doorsById:Y,doorsByExternalId:J,doorsByNodeId:oe,mvfEntrancesById:$,mvfEntrancesByFloorId:K}=gAe(i,e),{annotationsById:te,mvfAnnotationsById:ve,mvfAnnotationsByFloorId:Q}=bAe(i,e),{areasById:he,areasByExternalId:se,mvfAreasById:Ae}=wAe(i,e);vAe(i,v,k),yAe(i,v,k),_Ae(i,v),xAe(i,v,k);let{locationCategoriesByParentId:Ie,locationProfilesById:we,locationCategoriesById:Ne,locationProfilesByExternalId:je,locationProfilesByCategoryId:Ve,locationProfilesByAttachedFeatureId:Le}=uAe(i,e);return{spacesById:h,spacesByExternalId:d,nodesById:t,nodesByExternalId:n,objectsById:C,objectsByExternalId:T,floorsById:B,floorsByExternalId:N,floorStacksById:L,floorStacksByExternalId:j,facadesById:Z,facadesBySpaceId:O,connectionsById:w,doorsById:Y,doorsByExternalId:J,doorsByNodeId:oe,poisById:f,poisByExternalId:m,annotationsById:te,areasById:he,areasByExternalId:se,objectEntranceNodeIdsByObstructionId:b,obstructionIdByEntranceId:F,connectionIdsByLatLon:A,locationProfilesById:we,locationCategoriesById:Ne,locationProfilesByExternalId:je,locationProfilesByCategoryId:Ve,locationCategoriesByParentId:Ie,mvfSpacesById:v,mvfNodesById:r,mvfObstructionById:k,mvfFloorsById:z,mvfFloorStacksById:q,mvfConnectionsById:o,mvfConnectionsByNodeId:s,mvfEntrancesById:$,mvfAnnotationsById:ve,mvfNodesByFloorId:a,mvfSpacesByFloorId:E,mvfPoisByFloorId:I,mvfAreasById:Ae,mvfEntrancesByFloorId:K,mvfAnnotationsByFloorId:Q,locationProfilesByAttachedFeatureId:Le,mvfConnectionIdsByLatLon:u}},"createDataFromMVF");R();R();R();var MAe=l(function(){let i=globalThis.fetch;return{fetch(...e){if(!Pie(i))throw new Error("fetch is not available in your environment. Pass your own function into `setFetchFn` (node-fetch, etc)");return i?.(...e)},setFetch(e){i=e}}},"createFetchControl")(),CAe=MAe.fetch,Oie=["websdk","web","webv2","kiosk-v2","mobile","iossdk","androidsdk","reactnativesdk","gen7","bespoke"],Nie=Oie[0],Fie="https://api-gateway.mappedin.com/track-analytics/a/",Bie="deny-watchposition",zie="load-mapview",Uie="load-mapdata",Vie="change-language",jie="query-directions",Vu,il,Ep,cI,Qx,Gie=class{constructor(){ge(this,Ep),ge(this,Vu,Object.freeze({})),ge(this,il),D(this,"oneTimeEventsSent",new Set),D(this,"sendGetDirectionsEvent",vQ((e,t)=>this.sendAnalyticEvent(jie,{start:e,end:t,type:"location_to_location"}),2500)),Ce(this,il,St(this,Ep,Qx).call(this,y(this,Vu)))}init(e){this.reset(),this.updateStateWithOptions(e)}reset(){Ce(this,Vu,{}),Ce(this,il,St(this,Ep,Qx).call(this,{})),this.oneTimeEventsSent.clear()}updateStateWithOptions(e){return Ce(this,Vu,Object.freeze(Object.assign({},y(this,Vu),e))),Ce(this,il,St(this,Ep,Qx).call(this,e)),St(this,Ep,cI).call(this,y(this,il)),y(this,il)}updateState(e){let t=Me({},e);t.mapId&&(t.analyticsBaseUrl=Mw(lt(Me({},y(this,il)),{mapId:t.mapId}))),t.context&&(t.context=SD(t.context)),t.baseUri&&(t.analyticsBaseUrl=Mw({baseUri:t.baseUri,mapId:y(this,il).mapId})),Object.assign(y(this,il),t),this.handleStateUpdate(e),St(this,Ep,cI).call(this,t)}handleStateUpdate(e){var t;(t=e.userPosition)!=null&&t.floorLevel?this.sendBlueDotEvents("found-floor"):e.userPosition&&this.sendBlueDotEvents("found-position")}get authReady(){let{key:e,secret:t,accessToken:n}=this.getState();return!!(e&&t)||!!n}getState(){return y(this,il)}getContext(){return this.getState().context||y(this,Vu).context||Nie}getSessionId(){return this.getState().sessionId||y(this,Vu).sessionId||AD()}getDeviceId(){return this.getState().deviceId||y(this,Vu).deviceId||wD()}sendAnalyticEvent(e,t={}){let n=this.getState(),r=Hie(n.analyticsBaseUrl,e),a={"mi-context":this.getContext(),"mi-session":this.getSessionId(),"mi-device":this.getDeviceId()};if(n.logEvents&&nt.log("Analytics.track",r,a),!n.sendEvents)return Promise.resolve();if(!this.authReady)return nt.warn("Auth needs to be ready to send analytics.");let o=lt(Me({},t),{g:n.geolocationMode,sdk_version:n.version});return n.userPosition&&Object.assign(o,n.userPosition),a["Content-Type"]="application/json",n.accessToken?a.Authorization="Bearer ".concat(n.accessToken):n.noAuth||n.secret&&n.key&&(a["x-mappedin-key"]=btoa(n.key),a["x-mappedin-secret"]=btoa(n.secret)),CAe(r,{method:"POST",mode:"cors",headers:a,body:JSON.stringify(o)})}capture(e,t){if(IAe.includes(e))return nt.warn("".concat(e," event is sent internally.")),Promise.resolve();let n=EAe.includes(e)?e.slice(1):e;return this.sendAnalyticEvent(n,t)}sendGetMapDataEvent(e){return this.sendAnalyticEvent(Uie,e)}sendChangeLanguageEvent(e){return this.sendAnalyticEvent(Vie,e)}sendWatchPositionDenied(){return this.sendAnalyticEvent(Bie)}sendMapViewLoadedEvent({firstRenderDuration:e,dimension:t,collisionWorkerDisabled:n,outdoorsWorkerDisabled:r}){return this.sendAnalyticEvent(zie,{type:"3d",firstRenderDuration:e,width:t.width,height:t.height,devicePixelRatio:globalThis.devicePixelRatio||1,collisionWorkerDisabled:n,outdoorsWorkerDisabled:r})}sendBlueDotEvents(e){if(!((e==="found-floor"||e==="found-position")&&this.oneTimeEventsSent.has(e)))return this.oneTimeEventsSent.add(e),this.sendAnalyticEvent(e)}};Vu=new WeakMap,il=new WeakMap,Ep=new WeakSet,cI=l(function(i){i.sessionId&&xg.getInstance().saveSessionData("id",i.sessionId),i.deviceId&&xg.getInstance().saveLocalData("deviceId",i.deviceId)},"#saveStateToStorage"),Qx=l(function(i){var e,t,n,r;let a=(e=i.baseUri)!=null?e:Fie;return{baseUri:a,analyticsBaseUrl:Mw(lt(Me({},i),{baseUri:a})),version:((t=mr?.env)==null?void 0:t.npm_package_version)||"v6",deviceId:i.deviceId||wD(),accessToken:i.accessToken,mapId:i.mapId,sessionId:i.sessionId||AD(),platformString:i.platformString||"",context:SD(i.context)||Nie,geolocationMode:!1,sendEvents:(n=i.sendEvents)!=null?n:!0,logEvents:(r=i.logEvents)!=null?r:!1,noAuth:i.noAuth||!1,key:i.key,secret:i.secret}},"#getStateWithOption"),l(Gie,"AnalyticsInternal");var $ie=Gie;function Mw({mapId:i,baseUri:e=Fie}){return"".concat(e).concat(i,"/")}l(Mw,"getBaseUrl");function wD(){return xg.getInstance().loadLocalData("deviceId")}l(wD,"getDeviceIDFromStorage");function AD(){return xg.getInstance().loadSessionData("id")}l(AD,"getSessionIDFromStorage");function Hie(i,e){return i+e}l(Hie,"buildUrl");function SD(i){return Oie.find(e=>e===i)}l(SD,"getValidContext");var EAe=["$select-location","$select-category","$query-suggest","$query-search"],IAe=[zie,Uie,jie,Bie,Vie];new $ie;var nl,Wie=class{constructor(e){ge(this,nl),D(this,"capture"),D(this,"updateState"),Ce(this,nl,e),this.capture=y(this,nl).capture.bind(y(this,nl)),this.updateState=y(this,nl).updateState.bind(y(this,nl))}getState(){let e=y(this,nl).getState(),{sessionId:t,deviceId:n}=e;return Sc(e,["sessionId","deviceId"])}getContext(){return y(this,nl).getContext()}getSessionId(){return y(this,nl).getSessionId()}getDeviceId(){return y(this,nl).getDeviceId()}};nl=new WeakMap,l(Wie,"Analytics");var TAe=Wie;R();var PAe=new Set(["polygons"]),Pl,Dr,ns,eb,pI=class tb extends Xc{constructor(e,t){super(t.mvfData.externalId),D(this,"__type",tb.__type),D(this,"description"),D(this,"name",""),D(this,"amenity"),D(this,"externalId",""),D(this,"extra"),D(this,"gallery"),D(this,"instances"),D(this,"logo"),D(this,"operationHours"),D(this,"phone"),D(this,"picture"),D(this,"shortName"),D(this,"showFloatingLabelWhenImagePresent"),D(this,"showLogo"),D(this,"siblingGroups"),D(this,"social"),D(this,"sortOrder",-1),D(this,"states"),D(this,"tags"),D(this,"type",""),D(this,"hidden",!1),ge(this,Pl),ge(this,Dr,{}),ge(this,ns),ge(this,eb),Ce(this,Pl,e),Ce(this,ns,t.mvfData),Ce(this,eb,t.categoryIds||[]),this.instances=t.locationInstances||[];for(let n in t.mvfData)!PAe.has(n)&&!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),n)&&Object.defineProperty(this,n,{enumerable:!0,get(){if(t.parentId){let r=y(this,Pl).locationsById[t.parentId];return y(this,ns)[n]!=null?y(this,Pl).getPropTranslation(this.__type,n,y(this,ns).id,y(this,ns)[n]):y(this,Pl).getPropTranslation(this.__type,n,y(this,ns).id,r[n])}return y(this,Pl).getPropTranslation(this.__type,n,y(this,ns).id,y(this,ns)[n])}})}static is(e){return e.__type===tb.__type}get focusTarget(){return this.spaces}get categories(){return y(this,Dr).categories?y(this,Dr).categories:(y(this,Dr).categories=(y(this,eb).map(e=>y(this,Pl).getById("enterprise-category",e))||[]).filter(Boolean),y(this,Dr).categories)}get coordinates(){if(y(this,Dr).coordinates)return y(this,Dr).coordinates;y(this,Dr).coordinates=[];for(let e=0;e<this.nodes.length;e++)y(this,Dr).coordinates.push(this.nodes[e].coordinate);return y(this,Dr).coordinates}get nodes(){if(y(this,Dr).nodes)return y(this,Dr).nodes;y(this,Dr).nodes=[];for(let e=0;e<y(this,ns).nodes.length;e++){let t=y(this,Pl).getById("node",y(this,ns).nodes[e].id);t&&y(this,Dr).nodes.push(t)}return y(this,Dr).nodes}get spaces(){if(y(this,Dr).spaces)return y(this,Dr).spaces;y(this,Dr).spaces=[];for(let e=0;e<y(this,ns).polygons.length;e++){let t=y(this,Pl).getById("space",y(this,ns).polygons[e].id);t&&y(this,Dr).spaces.push(t)}return y(this,Dr).spaces}toJSON(){return{__type:tb.__type,id:this.id,name:this.name}}destroy(){for(let e of Object.keys(y(this,Dr)))delete y(this,Dr)[e]}};Pl=new WeakMap,Dr=new WeakMap,ns=new WeakMap,eb=new WeakMap,l(pI,"EnterpriseLocation"),D(pI,"__type","enterprise-location");var LAe=pI,A1=LAe;R();var DAe=new Set,Uf,Fo,ju,dI=class ib extends Xc{constructor(e,t){super(t.mvfData.externalId),D(this,"__type",ib.__type),D(this,"name",""),D(this,"color"),D(this,"externalId",""),D(this,"extra"),D(this,"icon"),D(this,"iconFromDefaultList"),D(this,"sortOrder",-1),D(this,"picture"),ge(this,Uf),ge(this,Fo,{}),ge(this,ju),Ce(this,Uf,e),Ce(this,ju,t.mvfData);for(let n in t.mvfData)!DAe.has(n)&&!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),n)&&Object.defineProperty(this,n,{get(){return y(this,Uf).getPropTranslation(this.__type,n,y(this,ju).id,y(this,ju)[n])}})}static is(e){return e.__type===ib.__type}get children(){if(y(this,Fo).children)return y(this,Fo).children;y(this,Fo).children=[];for(let e=0;e<y(this,ju).children.length;e++){let t=y(this,Uf).getById("enterprise-category",y(this,ju).children[e]);t&&y(this,Fo).children.push(t)}return y(this,Fo).children}get locations(){if(y(this,Fo).locations)return y(this,Fo).locations;y(this,Fo).locations=[];for(let e=0;e<y(this,ju).locations.length;e++){let t=y(this,Uf).getById("enterprise-location",y(this,ju).locations[e]);t&&y(this,Fo).locations.push(t)}return y(this,Fo).locations}toJSON(){return{__type:ib.__type,id:this.id,name:this.name}}destroy(){for(let e of Object.keys(y(this,Fo)))delete y(this,Fo)[e]}};Uf=new WeakMap,Fo=new WeakMap,ju=new WeakMap,l(dI,"EnterpriseCategory"),D(dI,"__type","enterprise-category");var kAe=dI,qie=kAe;R();var RAe=new Set,nb,rb,fI=class ab extends Xc{constructor(e,t){super(t.mvfData.externalId),D(this,"__type",ab.__type),D(this,"countrycode"),D(this,"externalId",""),D(this,"defaultLanguage",{code:"en",name:"English"}),D(this,"defaultMap"),D(this,"extra"),D(this,"icon"),D(this,"languages",[]),D(this,"links",[]),D(this,"logo"),D(this,"mappedinWebUrl"),D(this,"slug",""),D(this,"topLocations"),D(this,"tzid"),ge(this,nb,{}),ge(this,rb),Ce(this,rb,t.mvfData);for(let n in t.mvfData)!RAe.has(n)&&!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),n)&&(this[n]=t.mvfData[n])}static is(e){return e.__type===ab.__type}get name(){var e;return(e=y(this,rb).name)!=null?e:""}toJSON(){return{__type:ab.__type,id:this.id,name:this.name}}destroy(){for(let e of Object.keys(y(this,nb)))delete y(this,nb)[e]}};nb=new WeakMap,rb=new WeakMap,l(fI,"EnterpriseVenue"),D(fI,"__type","enterprise-venue");var OAe=fI,Xie=OAe;R();R();function HA(i){return i.endsWith("/")?i:"".concat(i,"/")}l(HA,"normalizeUrl");R();var MD="https://app.mappedin.com/",NAe="https://auth.mappedin.com/";R();R();var FAe=l(i=>{let e=Date.now();return i-e},"fromNow"),Zie=l((i,e)=>FAe(i)<=e*60*1e3,"shouldRefreshToken"),Yie=60,BAe=Yie*60*1e3,NR="accessTokens";async function CD(i,e=!1){let t="".concat(i.key),n=xg.getInstance(),r=n?.loadSessionData(NR)||{},a=Math.floor(Date.now()/1e3);if(r[t]&&!Zie(r[t].expiresTimestamp*1e3,Yie))return r[t];let o=e?await Jie(i,a):await Kie(i,a),s=lt(Me({},r),{[t]:o});return n?.saveSessionData(NR,s),o}l(CD,"getAccessToken");async function Jie(i,e){var t;let n="".concat((t=i.baseAuthUri)!=null?t:NAe,"oauth2/token"),r=await yu()(n,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({grant_type:"client_credentials",client_id:i.key,client_secret:i.secret})});if(!r.ok)throw new Error("".concat(r.status," ").concat(r.statusText,": ").concat(await r.text()));let a=await r.json();return{accessToken:a.access_token,expiresTimestamp:e+a.expires_in}}l(Jie,"fetchAccessTokenEnterprise");async function Kie(i,e){let t="".concat(i.baseAuthUri?HA(i.baseAuthUri):MD,"api/api-key/token"),n=await yu()(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:i.key,secret:i.secret})});if(!n.ok)throw new Error("".concat(n.status," ").concat(n.statusText,": ").concat(await n.text()));let r=await n.json();return{accessToken:r.access_token,expiresTimestamp:e+r.expires_in}}l(Kie,"fetchAccessToken");R();var Qie=60,zAe=Qie*60*1e3,FR="miSasTokens";async function ene(i,e){let t="".concat(e,"__").concat(i.mapId),n=xg.getInstance(),r=n?.loadSessionData(FR)||{};if(r[t]&&!Zie(r[t].expires,Qie))return r[t];let a=await tne(i,e),o=lt(Me({},r),{[t]:{token:a.token,expires:new Date(a.expires).getTime()}});return n?.saveSessionData(FR,o),a}l(ene,"getSasToken");async function tne(i,e){let t="".concat(i.baseUri?HA(i.baseUri):MD,"api/v1/venue/").concat(i.mapId,"/sas-token"),n=await yu()(t,{method:"GET",headers:{Authorization:"Bearer ".concat(e)}});if(!n.ok)throw new Error("".concat(n.status," ").concat(n.statusText,": ").concat(await n.text()));let r=await n.json();return{token:r.token,expires:new Date(r.expires).getTime()}}l(tne,"fetchSasToken");var BR=globalThis.fetch,zR,UAe=(zR=mr?.env)==null?void 0:zR.npm_package_version;function yu(){if(BR==null)throw new Error("fetch is not available in your environment. Pass your own function into `setFetchFn` (node-fetch, etc)");return BR}l(yu,"isomorphicFetch");var mI={supplementaryUrl:"https://api-gateway.mappedin.com/analytics/",headers:{},accessToken:"",clientId:"",noAuth:!1,includeHidden:!0,clientSecret:"",apiGateway:"",authorization:"",perspective:"Website",language:"",venue:""};function ine(i){var e;let t=Me(Me({},mI),i);return t.headers=lt(Me({},t.headers),{"mappedin-sdk-version":UAe}),t.things=[],"platformString"in i&&(t.headers=lt(Me({},t.headers),{"mappedin-platform-version":i.platformString})),t.noAuth||(t.accessToken?t.authorization="Bearer ".concat(t.accessToken):t.clientId&&t.clientSecret&&(t.authorization="Basic ".concat(globalThis.btoa("".concat(t.clientId,":").concat(t.clientSecret))))),t.language=(e=t.language)==null?void 0:e.toLowerCase(),t}l(ine,"parseOptions");function nne(i,e,t=!1){i.language,i.clientId,i.clientSecret;let{headers:n}=i;n["Content-Type"]=n["Content-Type"]||"text/json",i.accessToken?n.Authorization="Bearer ".concat(i.accessToken):i.noAuth||i.clientId&&i.clientSecret&&(n["x-mappedin-key"]=btoa(i.clientId),n["x-mappedin-secret"]=btoa(i.clientSecret));let r={method:"GET",headers:n};return i.secure&&(e+="&withcdntoken"),{req:r,url:e}}l(nne,"constructParamsForRequest");async function rne(i,e,t=!1){let n=nne(i,e,t),r=await yu()(n.url,n.req);if(!r.ok)throw new Error("".concat(r.status," ").concat(r.statusText));return r.json()}l(rne,"generateAPIRequest");var VAe=l(i=>{let e=i!=null&&typeof i=="object"&&"perspectives"in i&&i.perspectives!=null&&typeof i.perspectives=="object"?i.perspectives:null;if(e==null||Object.keys(e).length===0)return nt.warn("No perspectives available in response!"),null;let t={};for(let[n,r]of Object.entries(e)){let a="url"in r&&typeof r.url=="string"?r.url:null,o="locale_packs"in r&&typeof r.locale_packs=="object"?r.locale_packs:null;if(a==null||o==null){nt.warn("Perspective ".concat(n," is missing url or locale_packs!"));continue}t[n]={url:a,locale_packs:o}}return t},"getPerspectivesFromResponse");async function ane(i,e="exports/mvf/1/bundle"){var t,n;let r=ine(Me(Me({baseUri:"https://api-gateway.mappedin.com/"},mI),i)),a="".concat(r.baseUri+e,"?venue=").concat(r.venue,"&version=").concat((t=r.version)!=null?t:"2.0.0");r.headers["Content-Type"]="application/zip";let o=await rne(r,a),s=o.url,u=o.locale_packs,h=(n=r.perspective)!=null?n:mI.perspective,d=VAe(o);if(h!=null&&h!==""&&d!=null){let f=d[h];f==null?nt.warn("Perspective ".concat(h," not found in response! Loading default perspective instead.")):(nt.log('Loading perspective "'.concat(h,'"')),s=f.url,u=f.locale_packs)}return{url:s,localePacks:u,updated_at:o.updated_at}}l(ane,"getVenueMVFURL");var lf=function(){let i;return()=>(i||(i=new TextDecoder),i)}();async function gI(i,{signal:e}){let t=await(await yu()(i,{signal:e})).arrayBuffer();return new Uint8Array(t)}l(gI,"getLanguagePackUnitArray");async function WA(i){let e=(await _h(async()=>{const{unzipSync:n}=await import("./browser-6HMQAV4T-CLXjAgkv.js");return{unzipSync:n}},__vite__mapDeps([0,1,2]))).unzipSync(i),t={};if(e["enterprise/"]!=null){t.enterprise={};let n=e["enterprise/locations.json"];n&&(t.enterprise.locations=JSON.parse(lf().decode(n)));let r=e["enterprise/locationInstances.json"];r&&(t.enterprise.locationInstances=JSON.parse(lf().decode(r)));let a=e["enterprise/categories.json"];a&&(t.enterprise.categories=JSON.parse(lf().decode(a)))}return e["floorstack.json"]&&(t["floorstack.json"]=JSON.parse(lf().decode(e["floorstack.json"]))),e["floor.geojson"]&&(t["floor.geojson"]=JSON.parse(lf().decode(e["floor.geojson"]))),e["manifest.json"]&&(t["manifest.geojson"]=JSON.parse(lf().decode(e["manifest.json"]))),t}l(WA,"parseLanguagePack");async function one(i,{signal:e}){try{let t=await(await yu()(i,{signal:e})).arrayBuffer();if(e.aborted)return;let n=new Uint8Array(t);return await WA(n)}catch(t){let n=new Error("downloadLanguagePack failed");throw n.cause=t,n}}l(one,"downloadLanguagePack");async function sne(i){return new Promise(async(e,t)=>{try{let n=i.useDraftData?"exports/mvf2-draft/1/bundle":"exports/mvf2/1/bundle",{url:r,localePacks:a}=await ane(i,n),o=await yu()(r).then(u=>u.arrayBuffer()),s=new Uint8Array(o);e({compressed:s,localePacks:a})}catch(n){t(n)}})}l(sne,"downloadVenueBundleMVFAPIGateway");async function lne(i,e){return new Promise(async(t,n)=>{try{let{url:r}=await une(i,e),a=await yu()(r).then(s=>s.arrayBuffer()),o=new Uint8Array(a);t(o)}catch(r){n(r)}})}l(lne,"downloadMVF");async function une(i,e){let t=new URL("".concat(i.baseUri?HA(i.baseUri):MD,"api/venue/").concat(i.mapId,"/mvf"));i.viewId&&t.searchParams.set("configId",i.viewId),i.mvfVersion&&t.searchParams.set("version",i.mvfVersion);let n=await yu()(t.toString(),{headers:{Authorization:"Bearer ".concat(e)}});if(!n.ok)throw new Error("".concat(n.status," ").concat(n.statusText));return n.json()}l(une,"getMakerBundleURL");function ED(i){var e,t,n,r,a,o,s,u,h,d,f,m,v,b,w,A,E,I;let C=new TextDecoder,T=C.decode.bind(C);try{let k={"connection.json":JSON.parse(T(i["connection.json"])),"manifest.geojson":JSON.parse(T(i["manifest.geojson"])),"map.geojson":i["map.geojson"]?JSON.parse(T(i["map.geojson"])):void 0,"mapstack.geojson":i["mapstack.geojson"]?JSON.parse(T(i["mapstack.geojson"])):void 0,"node.geojson":JSON.parse(T(i["node.geojson"])),obstruction:{},space:{},entrance:{},facade:{},"tileset.json":i["tileset.json"]?JSON.parse(T(i["tileset.json"])):void 0};if(i.enterprise!=null&&(k.enterprise={},(e=i.enterprise)!=null&&e["locations.json"]&&(k.enterprise.locations=JSON.parse(T((t=i.enterprise)==null?void 0:t["locations.json"]))),(n=i.enterprise)!=null&&n["categories.json"]&&(k.enterprise.categories=JSON.parse(T((r=i.enterprise)==null?void 0:r["categories.json"]))),(a=i.enterprise)!=null&&a["venue.json"]&&(k.enterprise.venue=JSON.parse(T((o=i.enterprise)==null?void 0:o["venue.json"]))),(s=i.enterprise)!=null&&s["layers.json"]&&(k.enterprise.layers=JSON.parse(T((u=i.enterprise)==null?void 0:u["layers.json"]))),(h=i.enterprise)!=null&&h["locationInstances.json"]&&(k.enterprise.locationInstances=JSON.parse(T((d=i.enterprise)==null?void 0:d["locationInstances.json"]))),(f=i.enterprise)!=null&&f["enterpriseStyles.json"]&&(k.enterprise.enterpriseStyles=JSON.parse(T((m=i.enterprise)==null?void 0:m["enterpriseStyles.json"]))),(v=i.enterprise)!=null&&v["textures.json"]&&(k.enterprise.textures=JSON.parse(T((b=i.enterprise)==null?void 0:b["textures.json"]))),(w=i.enterprise)!=null&&w["floorText.json"]&&(k.enterprise.floorText=JSON.parse(T((A=i.enterprise)==null?void 0:A["floorText.json"]))),(E=i.enterprise)!=null&&E["categoryPriorities.json"]&&(k.enterprise.categoryPriorities=JSON.parse(T((I=i.enterprise)==null?void 0:I["categoryPriorities.json"])))),i["floorstack.json"]!=null?k["floorstack.json"]=JSON.parse(T(i["floorstack.json"])):i["mapstack.json"]!=null&&(k["mapstack.json"]=JSON.parse(T(i["mapstack.json"]))),k["floorstack.json"]==null&&k["mapstack.json"]==null&&k["mapstack.geojson"]==null)throw new Error("MVF is missing floorstack.json or mapstack.json/mapstack.geojson");if(i["floor.geojson"]&&(k["floor.geojson"]=JSON.parse(T(i["floor.geojson"]))),k["floor.geojson"]==null&&k["map.geojson"]==null)throw new Error("MVF is missing floor.geojson or map.geojson");if("styles.json"in i&&(k["styles.json"]=JSON.parse(T(i["styles.json"]))),"shapes.json"in i&&(k["shapes.json"]=JSON.parse(T(i["shapes.json"]))),"location.json"in i&&(k["location.json"]=JSON.parse(T(i["location.json"]))),"category.json"in i&&(k["category.json"]=JSON.parse(T(i["category.json"]))),i.annotation!=null){k.annotation={};let B=Object.keys(i.annotation);for(let N of B){let z=N.replace(/\.json|\.geojson/g,"");k.annotation[z]=JSON.parse(T(i.annotation[N]))}}let F=Object.keys(i.space);for(let B of F){let N=B.replace(/\.json|\.geojson/g,"");k.space[N]=JSON.parse(T(i.space[B]))}if(i.obstruction!=null){let B=Object.keys(i.obstruction);for(let N of B){let z=N.replace(/\.json|\.geojson/g,"");k.obstruction[z]=JSON.parse(T(i.obstruction[N]))}}else k.obstruction={};if(i.entrance!=null){let B=Object.keys(i.entrance);for(let N of B){let z=N.replace(/\.json|\.geojson/g,"");k.entrance[z]=JSON.parse(T(i.entrance[N]))}}else k.entrance={};if("floorImages"in i&&i.floorImages!=null){k.floorImages={};for(let B of Object.keys(i.floorImages)){let N=B.replace(/\.json|\.geojson/g,"");k.floorImages[N]=JSON.parse(T(i.floorImages[B]))}}if("textAreas"in i&&i.textAreas!=null){k.textAreas={};for(let B of Object.keys(i.textAreas)){let N=B.replace(/\.json|\.geojson/g,"");k.textAreas[N]=JSON.parse(T(i.textAreas[B]))}}if("facade"in i&&i.facade!=null){k.facade={};for(let B of Object.keys(i.facade)){let N=B.replace(/\.json|\.geojson/g,"");k.facade[N]=JSON.parse(T(i.facade[B]))}}if("area"in i&&i.area!=null){k.area={};for(let B of Object.keys(i.area)){let N=B.replace(/\.json|\.geojson/g,"");k.area[N]=JSON.parse(T(i.area[B]))}}return k}catch(k){throw nt.error(k),new Error("MVF parsing failed! Probably encountered a bad file.")}}l(ED,"parseMVF");function hne(i){if(i==null||typeof i!="object")return!1;let e=["connection.json","manifest.geojson","floor.geojson"in i?"floor.geojson":"map.geojson","node.geojson","floorstack.json"in i?"floorstack.json":"mapstack.json"in i?"mapstack.json":"mapstack.geojson"];"styles.json"in i&&e.push("styles.json"),"shapes.json"in i&&e.push("shapes.json");for(let t of e)if(i[t]==null||i[t][Symbol.toStringTag]!=="Uint8Array")return!1;return!0}l(hne,"validateStaticMVFFiles");async function ID(i){return new Promise(async(e,t)=>{try{if(i==null||typeof i!="object")throw new Error("Error parsing data! Unzipping failed.");if(i[Symbol.toStringTag]!=="Uint8Array")throw new Error("Unexpected file type! Unzipping failed.");let n=(await _h(async()=>{const{unzipSync:o}=await import("./browser-6HMQAV4T-CLXjAgkv.js");return{unzipSync:o}},__vite__mapDeps([0,1,2]))).unzipSync(i);if(!hne(n))throw new Error("MVF is missing some expect static files. Unzipping failed.");let r={},a=Object.keys(n);for(let o of a){if(n[o].length===0)continue;let s=o.split("/");if(s.length<0)throw new Error("Encounted a file with no name! Unzipping failed.");if(s.length>2)throw new Error("Encountered unexpected nesting in MVF! Unzipping failed.");if(s.length===1){r[s[0]]=n[o];continue}if(s[0]==="image"){nt.warn("MVF unzipping encountered an image. Ignoring as this case has not been implemented.");continue}else r[s[0]]==null&&(r[s[0]]={}),r[s[0]][s[1]]=n[o]}e(r)}catch(n){t(n)}})}l(ID,"unzipMVF");function M0(){let i="us",e={};function t(){return pne(dne(i),e)}return l(t,"getState"),{updateByUserOption(n){var r,a;n.environment&&(i=n.environment),n.baseUri&&(e.baseUri=n.baseUri),n.baseAuthUri&&(e.baseAuthUri=n.baseAuthUri),(r=n.analytics)!=null&&r.baseUri&&(e.analyticsBaseUri=(a=n.analytics)==null?void 0:a.baseUri)},updateTileServerBaseUrl(n){e.tileServerUri=n},updateEnvironment(n){i=n},getBaseUri(n){return i==="us"&&n?UR.baseUri:t().baseUri},getBaseAuthUri(n=!1){return i==="us"&&n?UR.baseAuthUri:t().baseAuthUri},getAnalyticsBaseUri(){return t().analyticsBaseUri},getTileServerUri(){return t().tileServerUri},reset(){i="us",e={}},__getState:t}}l(M0,"createEnvControl");var cne=Object.freeze({baseUri:"https://app.mappedin.com/",baseAuthUri:"https://app.mappedin.com/",analyticsBaseUri:"https://api-gateway.mappedin.com/track-analytics/a/",tileServerUri:"https://tiles-cdn.mappedin.com/styles/mappedin/style.json"}),UR=Object.freeze(lt(Me({},cne),{baseUri:"https://api-gateway.mappedin.com/",baseAuthUri:"https://auth.mappedin.com/"})),jAe=Object.freeze({baseUri:"https://api-gateway.eu.mappedin.com/",baseAuthUri:"https://auth.eu.mappedin.com/",analyticsBaseUri:"https://api-gateway.eu.mappedin.com/track-analytics/a/",tileServerUri:"https://tiles-cdn.eu.mappedin.com/styles/mappedin/style.json"}),GAe=Object.freeze({baseUri:"https://api-gateway-staging.mappedin.net/",baseAuthUri:"https://auth-staging.mappedin.net/",analyticsBaseUri:"https://api-gateway-staging.mappedin.net/track-analytics/a/",tileServerUri:"https://tiles-cdn.mappedin.com/styles/mappedin/style.json"}),$Ae=Object.freeze({baseUri:"https://app-staging.mappedin.net/",baseAuthUri:"https://app-staging.mappedin.net/",analyticsBaseUri:"https://api-gateway-staging.mappedin.net/track-analytics/a/",tileServerUri:"https://tiles-cdn.mappedin.com/styles/mappedin/style.json"});function pne(i,e){return Me(Me({},i),e)}l(pne,"getAuthStateByEnvironment");var HAe={eu:jAe,us:cne,"us-staging-enterprise":GAe,"us-staging-self-serve":$Ae};function dne(i){return HAe[i]}l(dne,"getEnvironmentAuthState");var fne=l(i=>{var e,t;let n=Object.values((t=(e=i["floorstack.json"])!=null?e:i["mapstack.json"])!=null?t:{});return n.length===1?[]:n.filter(r=>r.type!=="Outdoor").map(r=>r.id.replace("fs_","").replace("ms_",""))},"getBuildingIds"),dM;async function mne(){return dM||(dM=(await _h(async()=>{const{extractAndConvertMVFv3:i}=await import("./dist-NFOUUHU5-BRD2siaB.js");return{extractAndConvertMVFv3:i}},__vite__mapDeps([3,1,2]))).extractAndConvertMVFv3,dM)}l(mne,"getExtractAndConvertMvfV3");var VR=l(async i=>{let e=performance.now(),t=await(await mne())(i);return nt.log("Parsed MVFv3 in ".concat(performance.now()-e,"ms")),t.inspectErr(n=>{throw nt.error(n),new Error("MVFv3 parsing failed!")}),t.unwrap()},"unzipAndParseMVFv3ToMVFv2");async function qA(i,e="2.0.0"){switch(e){case"2.0.0":try{let t=await ID(i);return ED(t)}catch{return VR(i)}case"3.0.0":return VR(i);default:throw new Error("Unsupported MVF version: ".concat(e))}}l(qA,"unzipAndParseMVFv2");R();R();R();R();var WAe={};xh(WAe,{ACTION_TYPE:()=>Dse,Annotation:()=>$A,Area:()=>UA,BEARING_TYPE:()=>kse,CONNECTION_TYPE:()=>Rse,Connection:()=>jA,Coordinate:()=>Wn,DOORS:()=>Nse,Directions:()=>Yle,Door:()=>S0,E_SDK_LOG_LEVEL:()=>_Q,EnterpriseCategory:()=>qie,EnterpriseLocation:()=>A1,EnterpriseVenue:()=>Xie,Facade:()=>Dg,Floor:()=>Kl,FloorStack:()=>Cie,Hyperlink:()=>bw,ImageMetaData:()=>Aw,LocationCategory:()=>yue,LocationProfile:()=>o6,MAPPEDIN_COLORS:()=>eAe,MapObject:()=>wd,Node:()=>BA,PointOfInterest:()=>GA,Space:()=>ru,WALLS:()=>Ose,__setWatermarkOnClickFn:()=>Rle,checkWorkerUrls:()=>Fle,createMapLibreOverlay:()=>jEe,disableText3DWorker:()=>ble,enableTestMode:()=>wne,findPreferredLanguageInVenue:()=>e6,getMapData:()=>t6,getMapDataEnterprise:()=>VEe,hydrateMapData:()=>LEe,hydrateMapDataFromMVF:()=>UEe,parseMVF:()=>ED,preloadFont:()=>wae,setLoggerLevel:()=>wQ,setUseEnterpriseAPI:()=>Nle,setWorkersUrl:()=>Sle,show3dMap:()=>i6,show3dMapGeojson:()=>GEe,unzipAndParseMVFv2:()=>qA,unzipMVF:()=>ID});R();R();R();R();var ob,sb,lb,gne=class{constructor(e,t,{enabled:n=!1}={}){ge(this,ob),D(this,"searchInstance"),ge(this,sb),ge(this,lb),D(this,"enabled",!1),Ce(this,ob,e),Ce(this,sb,t),Ce(this,lb,()=>{var r;(r=this.searchInstance)==null||r.then(a=>a.populate())}),n&&this.enable()}async query(e,t={}){if(this.enabled||await this.enable(),!this.searchInstance)return nt.error("Search should be enabled by now"),{places:[],enterpriseLocations:[],enterpriseCategories:[]};try{return await(await this.searchInstance).search(e,t)}catch(n){return nt.error("Search.query failed due to",n),{places:[],enterpriseLocations:[],enterpriseCategories:[]}}}async suggest(e,t={}){if(this.enabled||await this.enable(),!this.searchInstance)return nt.error("Search should be enabled by now"),[];try{return await(await this.searchInstance).suggest(e,t)}catch(n){return nt.error("Search.suggest failed due to",n),[]}}async enable(){this.enabled||(this.enabled=!0,this.searchInstance||(this.searchInstance=_h(async()=>{const{InternalSearch:e}=await import("./internal-A2RG32A3-BonDX0_Z.js");return{InternalSearch:e}},__vite__mapDeps([4,1,2])).then(({InternalSearch:e})=>new e(y(this,ob)))),y(this,sb).on("language-change",y(this,lb)),await this.searchInstance)}};ob=new WeakMap,sb=new WeakMap,lb=new WeakMap,l(gne,"Search");var qAe=gne,yne=new WeakMap,Vf,Ur,vne=class{constructor(e,{search:t}={}){ge(this,Vf),ge(this,Ur),D(this,"Analytics"),D(this,"Search"),D(this,"Query"),D(this,"internal"),D(this,"on",l((n,r)=>{y(this,Vf).on(n,r)},"on")),D(this,"off",l((n,r)=>{y(this,Vf).off(n,r)},"off")),D(this,"getDirections",l((n,r,a)=>y(this,Ur).getDirections(n,r,a),"getDirections")),D(this,"getDirectionsMultiDestination",l((n,r,a)=>y(this,Ur).getDirectionsMultiDestination(n,r,a),"getDirectionsMultiDestination")),Ce(this,Vf,new xr),Ce(this,Ur,e),yne.set(this,e),this.Analytics=new TAe(e.Analytics),this.Query=e.Query,this.internal=e,this.Search=new qAe(this,e,{enabled:t?.enabled}),y(this,Ur).on("language-change",n=>{y(this,Vf).publish("language-change",n)})}getEnv(){return y(this,Ur).getEnv()}getAccessToken(){var e;return(e=y(this,Ur).tokenManager)==null?void 0:e.getAccessToken().token}get mapName(){return y(this,Ur).mapName}get mapId(){var e;return(e=y(this,Ur).getMapDataOptions)==null?void 0:e.mapId}get mapCenter(){return y(this,Ur).mapCenter}get organizationId(){return y(this,Ur).organizationId}get outdoorViewToken(){return y(this,Ur).outdoorViewToken}getByType(e){return y(this,Ur).getByType(e)}getById(e,t){return y(this,Ur).getById(e,t)}getByExternalId(e,t){return y(this,Ur).getByExternalId(e,t)}getGeoJSON(e){return e.geoJSON}async changeLanguage(e){return y(this,Ur).changeLanguage(e)}get currentLanguage(){return y(this,Ur).currentLanguage}get naturalBearing(){var e;return(e=y(this,Ur).naturalBearing)!=null?e:0}getDistance(e,t){return y(this,Ur).getDistance(e,t)}toBinaryBundle({downloadLanguagePacks:e=!0}={}){return y(this,Ur).toBinaryBundle({downloadLanguagePacks:e})}toJSONBundle({downloadLanguagePacks:e=!0}={}){return y(this,Ur).toJSONBundle({downloadLanguagePacks:e})}};Vf=new WeakMap,Ur=new WeakMap,l(vne,"MapData");var XAe=vne,TD=XAe;function Cw(i){let e=yne.get(i);if(!e)throw new Error("MapDataInternal not found");return e}l(Cw,"getMapDataInternal");R();R();R();R();var ZAe=1e-7;function ub(i){return{type:"Point",coordinates:i}}l(ub,"point");function _ne(i,e){let{coordinates:t}=e.geometry,{coordinates:n}=i.geometry,r=t.map(a=>DE(i,ub(a)));return n.reduce((a,o)=>{let s=TR(ub(o),r[0],i),u=TR(ub(o),r[1],i),h=kE(s)<kE(u)?s:u;return h.properties=lt(Me({},i.properties),{entrances:[]}),a.concat([h])},[])}l(_ne,"splitObstructionByEntrance");function xne(i,e){return e.reduce((t,n)=>{let r={epsilon:ZAe},a=t.obstructions.findIndex(s=>Pwe(sD(n),s,r)),o=t.obstructions[a];if(o){let[s,u]=_ne(o,n);t.entrances.push(n),t.obstructions.splice(a,1,s,u)}return t},{obstructions:[i],entrances:[]})}l(xne,"findAndSplitObstructionByAllEntrances");R();R();R();R();(function(){typeof globalThis!="object"&&(Object.defineProperty(Object.prototype,"__magic__",{get:l(function(){return this},"get"),configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__)})();var YAe="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAkGBwgHBgkICAgKCgkLDhcPDg0NDhwUFREXIh4jIyEeICAlKjUtJScyKCAgLj8vMjc5PDw8JC1CRkE6RjU7PDn/2wBDAQoKCg4MDhsPDxs5JiAmOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTn/wgARCAIABAADAREAAhEBAxEB/8QAGwABAAMBAQEBAAAAAAAAAAAAAAECAwQFBgf/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAP3EAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAIAAAJAFAAAAAAAAAAAAAAAAAAAAAAAAABAgAAEgCgAAAAAAAAAAAAAAAAAAAABERLSM1zM4zXMzjMoUIqCCSSS8XNC9mpoaVomharWTQAAAAAAAAAAAAAAAAEREtIoZrnGZkucUKFStQQSTFixdNDStF0TWrmiWqbJoAAAAAAAAAAAAAIgiWkZy4HNLzHLXKcxzpzmFYmRkUKFSCCSSxcuampsbR0HSdK9R1R1HTZvWll0mlAAAAAAAAAAAIiKLnLjHNLynLXKcycxzmNYmJmUKFSCAWLFy5qamxvHQvSdJ0nVHUdFm1aparWKAjNWSKAAAAARBEtYzlyXnjmOSuM4U4q4jjOM5a5k5zAyMjOqFCCCCSSS5c0jU1NzoOk6pew7TtjuO1e0646jezWr2WSaUAAAAAECIqtZco55eY464zhTirhOI5Dks5jAwMTIzqhUqQASWLFzSNTY3Og6V646zsO2O47V7DrjqNzWy9nlZ1c0LlrLEk0EQQVipRczIyMU5q5F4U8+vOPOrgThOOuU5jAxMjMzKpUggigJiSSxY0XQ1Njc6TqjtO49CX0D0T0Y7l7E6JdzU1NEvViSalBAWIqVKLSMjIxOauM4U86vPPOrz04TjrkOYwMTIzKJQqQQCKmBJJYutzQ1Njc6TrOyO475fRPRPQjuXsToXWPn6kkkEkhCkEAgggqVMjlrzzzDy7PMPPrhOQ5jBMqoVIIIAAIAJAAJJJLFzWN16TsO49CPTPUl9Q9A6o1LFiSSSSQpCwQQCCCpVMjlrzzyzy7PMPPrhOM5kwM6zKlQQAAQASAASCxY0NI3XpOw7j0I9M9SX0z0DqjU+UqpQqVIBFgEyixJYuWLFDkrzE8o8yvOONOasipBAAAAAAAAAAABJJY2OiO1fQPUj1T0pewuVKlCCqQsBIUSSSSWLlyTM5K808pPLrzziTnrEqQQAAAAAAAAAAASSWNjojtX0D1I9VfSOuND4uzMzqhQqVIALEli5c1jUuQc1vnp5pwJzVmQQAAAAAAAAAAAAAASSaHTHevpHoHTFjMyM6zKlSpABJJcsaGkamhU5q88804E5qzIIAAAAAAAAAAAAAAJJNDpjvX0j0Dqix8dVDMolSpAqCYElixc0XU0IMjlTlrIqAAAAAAAAAAAAAAAAAWNTqjqXYGZkZpUoQQRSFIsSXLroaGhBkcqctZFQAAAAAAAAAAAAAAAACxqdUdS7EngWQCAAQASACSSSwKlSCAAAAAAAAAAAAAAAAAACSSxYFSCCAACCQACSSSwKlSCAAAAAAAAAAAAAAAAAACSSxYGIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAJAJAJBAAIAIABAAAAAAAAAAAAAAAAAAAABIAJAJAJBAAIAIABAAAAJABAAAAAAAAAJBILEli5Y0LlzQ0Lly5csWLAkgFSChUoUMyhmUMyhQqVKkEEAEAAAAAAAAAkEgsSWLljQuXNDQuXLlyxYsCSAVIKFShQzKGZQzKFCpUqQe+ZmZkUKFCpUEEAAkksWLFzQ0NTU2NzY3Og3NzoNzc2NjU1NS5csSAQVKmZmZGRiYmBgYHOYGBgYGBiZGRkUMypUqQCAASSWLFi5oaGpqbG5sbnQbm50G5ubGxqampcuWJAIIKGZmZGRiYmBgYHOYGBgYGR+jmBzmBzmJiZGZQoQQSSWLmhqbGxudB0nSdJ1HSdR1HSdJ0G5qamhcsWJJJBIIIBUqVKFDIyMDA5jmOU5TlOY5TmOc5znMTEyMyhQggFixc0NTY2NzoOk6TpOo6TqOo6TpOg3NTU0LlixJJIJBAIKkFChQyMjAwOY5jlOU5jnP00yMTnOc5zAwMjMoVIJJLmhqbmx0HQdBubmxqXLkkgAAAAAAAAAAAAAEEFTMzMTEwOc5znMDAyMyhUgkkuaGpsbnQdB0G5ubGpcuSSAAAAAAAAAAAAAAQQVKGZ1gAEEEEFSCACSSxJJJIAAAAAAAAAAAAAAAAAAAAAAABBBBBUggAkkksSSSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQCCpBUqQVIKggAkFiSSxYksSSSSAAAAAAAAAAAAAAAAAAQCCpBUqQVIKggAkFiSSxYksSWBIAAKFiQAAAAAAAAACCpUoUMzIyMzMzMyhQoVKkEEAgkEkklixYuXNDQ0NTQ1NC5cuWJAAAAAAAAAAIKlShQzMjIzMzMzKFChUqQQQCCQSSSWLFyxoXNDQ1NDU0LljUkkAAAAAAAAAAggggEEAgAAAAAAAAAAAAAEkgkkkkkAAAAAAAAAAgggggEAgAAAAAEgEAAAAAAEkgkkuAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADyyCCCCCCCCAQASCSQWJJJJLEkkkkkgkkEgkAEgAAEAAgEAggEEEEEEEFSCCCCCCAQASCSQWJJJJLEkkkkkgkkEgEgEgAAEAAgEAggEEEEEH5AQQQQVBBAIAAJBIJJJLEkkkkliSSSSSQSSCQSAAAQAQQCCCCCCCCCpBBBBBUEEEAgAAkEgkkksSSSSSWJJJJJJBJIJBIAABABBAIIIIIIIIKg/LCAQCACAAAACQCQSCQSASSASCQCQAAAAAAQCAQAQCAQAQQCACAAAACQCQSCQSASSASCQCQAAAAAAQCAQAQCAQfPgAAAAAAAAAAAAAAkAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAgAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH/xAApEAAABQUBAQACAwACAwAAAAABAgQFFQMGERQWEhNAUAAgMGCAkKCw/9oACAEBAAECAP8AwTZznOf3mc5/YZE41xVivFyM6i7C8C8C8zMzMzMyDyDyDyDwV4K7ldSuZV5VgVwqZ/SCca4qxXmcjOouwvAvEzMzMzMzMyDyDyDwV4K7ldSuRVwKgrgf88TDWMrO4VHOo61Hao7ndzvB3k7yZ5M8i8i8zMzMzMyDyDyDyV5K8keSPJHmm8U3em70nam603Mi8qotUDfk5GqZUdfUc6jrUdqjvUeDvB3kzyZ5M8i8i8zMzMzMzMg8g8leSvJHkjyR5pvFN4pu9N2pOtNzIvKqLWA39PX+/saplJlh1tRfVcKrlVdKrrVdqrvVdzu53Y7sZ2M6mdRdRdBdJSUk5SUB0B0B1K6kdSOxHam7Unek70nei7UXWi6UXKk40l9NaRWWuB8/75E41zKjraq+q41nOq6VXas7VXeq71Hc7ud2O7GdRdRdZQXSUlJSUlAdCugOpXUjqR2I7U3em70nek70nai60XSk5UnGkvItIrKoCsC0FwLgXAuBbube3ubm7uiuFcZcZaZYdZUWVl1dwruVdzrulZ0qulVzqOR3EzgZeZcZcK0Vm3t7W1tbW1tgrBYC0q0q4q8jgRxpuVJzoulB0oOlBzoOVBworqa0iwi0i0q4FwLQWAr2trZ2trb3RWiuFcZaZadbUW1l1ZwruVd0rulZ0qulVzqOR3E7gZeZeK4VorNzb29ra2tsFe2CwFpVxVxV5HAjjTcqTnRdKDpQdKDnQcqDhRXU1pFhVm/ISUnKSkrLSsrKyspJyUhvitOtrLq69Q4qHGu41nGqvqLjrDKhUDW+nv1nP+Oc+vYVArFUEVEWUl1FfQcU7imckzinX0VxFoLgXyMlJykrLS0tLS0rKSclI74rjraq6uvUuKhxruNdxqr6i46wysVA1vp79Zz/AI5z6A4VArFUEVkWUl1FfQcU7imcUzinX0VxFoLZKTlJWVlpaXl5eWlpWUB0BzBxkDr669SvUr666stqqz1xqes/j5AxahFFJXRWp1yZemX0F5HCQkpOUlZaWlpeXl5aWB2lQdAcwcZE7hWcFLgpXqF1ZbVVnUDU9Z/HyBi1CV6SuitTrky9MvoLyL5AXEXEXIXIXKSkpKSkpIHIHIHIrkVxK4yJnCsvrra6uqpPVE354GJVpKaCtOtoryuEiZxM5C5C5C5SUnJSclJSQOQORXIrkVxBxM4VV9dbXV1VJ6om/PAxKtFTQVp1tFeRwkRWitFYKvb2tra2draBUCsFgLCrSrQWitOsqqT1RN+jAxKtJTTWFWitMtMtFYKzb29ra2tnaBUCsFZVhVpVoLRWnWVFJ6om/RgYlWkpprAW73v36zn++c+gOFQKv1GoJv04GCp9Rq/T36zn++c+gOFT7fUagm/TgYKn1+3/AKEeMefHjx8/n8vl8vn8/Hjx5xj9bjHnx48fP5/L5fL5/Px48ecY/wAvOPxceQIFIKIJgSAiBAVuK2FaitINAM4MwMwMsJCQkJCQkJCwosws4tAtItQtgtot4oRSCm+Hy8ecfi48gQKQUQTAkBECArcVsK1FaQaAZwZgZgZYSEhISEhISFhRZhZxaBaRahbBbRbxQikFN8BpfMWgWozWLaLcKAUWpq62vr/DX19YEoJARAhBvK2laytRGgjORlIyEYiMJLfJbxLdJbhLbJbRLaJbJbZLbAWxzHMcxzHMcxzHMDbBrYNbJraNbRrbPbh7dPbx7fOwHYjsZ2UzMZoM0maxbRbhQCi1NXW19fX19fW1QSAiBCDeVtK1laiNBGYjKRkIxEYSW+S3iW6S3CW2S2iW0S2S2yW2AtgLY5jmOY5jmOY5gbYNbJrZNbRraPbZ7cPbp7ePb52A7EdjOymZjW4e3D26e3j2+ZgMwmYhYxY4SEhISEBjKxlYiMJGAjAS3iW9TtynblO26dtUrap2zTtmnbNO2SW2S3isRWYGkG0EAItTW1/h8Phr6+rp6AtwtQs5mI9vntw9tHtk9s1LZqWzUto9tnts9uHt09vHt8zAZhMxCxixwkJCQkIDGVjKxEYSMBGAlvEt6nblO3Kdt0rap21TtmnbNO2SWyS2yW8ViKzA1A2ggBFqa2v8Ph8NfW1dPRFuFqMzGYjW+e3D20e2T2zUtk9tHto1tCzHYj2+e3T24e3D24a3DW4Nuc5znOc4FuBbhbcLbhLcJblO3CW4S3iMRGcrYVECcKYB+cJBoCjM2maDsZ7fPbp7cPbh7cNbhrcG3Oc5znOcC3C24W3C24S3CW5TtwluEt4jERnK2FRAnCmAfnCQaAoxb/7ePl8NbU09PT1NYKHy8Y/ZePl8NbU09PT1NYKHy8Y/4Z6+g1tjb3d+Rk5SVlZWVlZSTkd8Fu3s/b6es/pvX0Gtsbe7vyMnKSkrKysrKSciC8Fu3s/YKnrP9gqAb8X0NQawqBVCrMrMqMoGuNUTiYf4ICT5/L4/H4fD4fH4hSCmBAAP4AgctUtYqgqoqsqsqoFIVwqAb8X0NQawqBVCrMrMqMoGuNUTiYf4ICT5/L4/H4fD4fH4hSCmBAAP4AgctUtYqgqkqsqsqsFIV/Hn8XHj5/H4a+traurq6mpqampqampqampqampqampqampqamrq62tr/D4/Lx5/Fx4+fx+Gvra2rq6upqampqampqamrq6upqampqampqamrq6utra/w+Py/wCgEzNTc5OTs7PT09PT8/Pz09PT07Ozk3Ng9TMxLy0rKSclJSMhIb+9vbu9u7u7u7u7u729vb2/vyEjJSUnKSstLzEzNTc5OTs7Oz09PT8/Pz09PT07Ozk5NzUzMS8tKyknJSUjISG/v727vbu7u7u7u7u9u729v78hIyUlJykrLS8x0nR9H0fR9H0XRdF0XRdD0PQ9F0XRdF0XRdF0fR9H0nSdJ0vS9L0vTdN03TdP0/T9P0/T9P0/T9P0/T9R0/T9P0/T9P0/TdN03S9L0vS9J0nSdJ0fR9H0XRdF0PRdD0PQ9D0PRdF0XRdF0XR9H0fSdJ0nS9L0vS9N03TdN0/T9P0/T9P0/T9P0/T9P1HT9P0/T9P0/T9N03TdL0vS9L0vSS8tLy0tLS0rKysrKysrKysrKystLS0vLS8vLy8vMTExMTExMzMzMTMzMzM1NTUzMzMzMzMzMzExMTExMS8vLy8vLy8tKy0tKysrKysrKysrKysrLS0tLy0vLy8vLzExMTExMTMzMzEzMzMzNTU1MzMzMzMzMzMxMTExMTEvLy8vnOc5znOc5znOc5znOc5znOc59ZznPr169evXr169evXr169evXr16znOfWc5znOc5znOc5znOc5znOc5znOc59ZznPr169evXr169evXr169evXr16znOfWc5z/9YD//xAArEAEAAgIDAQABBAICAQUAAAAAAVICYgNRYQRBEEBQUzFCIDARYICQoLD/2gAIAQEAAz8A/wDgmhCEI/nYQj+RhjH5ccflxw44YMe0dtmzZs2bNmzZs2bIsjtiwlxy45/Ljn8se0fwuPbjj8uOPy44YQxR2izZs2bNmzZs2bNkWR2xYS45cc/lhP5Y9/wEQwj8sIRD1s2bNmzZs2bNmzZs2bNmzZs2bNmzZs2bNmyLMZYZMZ/KJ/dRDCPywhjCI/LZs2bNmzZs2bNmzZs2bNmzZs2bNmzZs2bNkWYywlhP5RP/ABj9hDGGMIh69bNmzZs2bNmzZsmybJsmybJsmybJsmybJsmybJs2bNmzZs2bNmzZ7+mMsZYyj9hDGGMIj9NmzZs2bNmzZs2bJsmybJsmybJs2TZNk2TZNk2bJs2bNmzZs2bNmzZ6iWMsXr16hiwYMGDBgwYo/T169/T162bNmzZs2TZNk2T2ntPae09pSlKUpSlPae09p7T2mybJsmzZs2bNmz17+nr16hiwYOPtx9uPtx9sO2DBih69evXr1s2bNmzZsmybJsmye09p7T2lKUpSlKU9p7T2ntNk2TZNmzZs2bNmz17+vr1s2bNmzZs2bNmzZs2evXr169bNmye09p7SlKUp/wC6UpSlKe09p7etmzZs9evWzZs2bNmzZs2bNmzZs2bPXr1s9bNmye09p7SlKUp/7pSlKUp7T29bPWz169evWzZs2bNmzZs2bNmzZs2bNmzZs2evU9plM/vJhMJ7T29bNnrZ62bNmzZs2bNmzZs2bNmzZs2bNnr39J7TKZ/eTCYT3+nr162bNnrZs2bJsntNk2TZPabNmzZs2etnr39JlM/wUwmP09etmzZs2bNk2TZNk2TZNk2bNmzZs2bNnv6TKZ/gphMfp69etk9p7T2ntKUpSlKUp7T2nt69e/pMpn+GmH/j9PXr1Pae09pSySlklKU9p7T29evf0mUz/DTCY/T16lP/AHSlKU/xUpSlP/dKUpT/ABUpT/8AQllKWTJl0y6ZdMumXTLpl0y6ZJSn+QlKWTJl0y6ZdMumXTLpl0y6ZJSn/sn9xKWXTLpn0z6Z9M+mXTLplVlVlVlVlVlVlVlVlVlVlRlVlVlRlVlVlVlVlVlVlVl0z6Z9M4/DPpn0z6ZdMkp/byll0y6Z9M+mfTPpn0y6ZVZVZVZVZVZVZVZVZUZVZUZVZVZVZVZVZVZVZVZVZVZdM+mfTOPwz6Z9M+mTJlVlVlVl0yZ9M2fTPpn0z6Z9M+mbPpn0z6Z9M2fTPpl0yqyqyqyqyqyomiaJomiaJomiaJomjRo0aNGjRo0aNGjRNE0TRNE0TRNE0TRNE0ZVZVZVZVZVZVZM+mbPpn0z6Z9M+mfTNn0z6Z9M+mfTPpl0y6ZVZVZVTVlVlRNE0TRlRNE0TRNE0TRo0aNGjRo0aNGjRomiaJomiaJomiaJomqaJqyq0TRNE0TRNE0TVNE1TVNU1TRNE1TVNU0TRNE0TRNGjRo0aNGjRhWHFHTgh88Pmj8Pnj/V89HBRwf1w4f64cNMXFSHFTFxUxcVIcP9cOGkOCkPno+ej55/D55cEuKemHUIo0aNGjRo0TRNE0TRNE0TVNE0TVNE1TVNE1TRNU0TRNE0TRNGjRo0aNGjRhWHFHThh88Pnj8Pnq+ejgo4P64cP9cOKkOKkOKmLipi4aYuH+uHBSHBSHz0fPR88/h88uCXFNWHUIo0aNGjRo4ZcU9MOoRRFGjRo0aNGjRo0aNGjRo0RRhVxR04IcGP4cGP+jij/GEMI/xjCP3+M/5xhxT/AJwhwT/o4Mv9XBk4p6YdQiiKNGjRo0aNGjRo0aNGjRoijGsOKOnBi4Mfw4I/0cUf4whhH+MYR+/xn/OMOKf84Q4J/wBHBP8Ar/zxrDCsOKkOKjhq4auGrhq4auGjipDjpDGsI/k8awwrDipDio4aOGrhq4auGrho4qQ46QxrCP8A0bHcMLQ47w4rw4buCzgs4O3A4HA4XA4HA4HA4O3BZwWcN3Fdx3hhaGNoR/Dx3DC0OO8OK8OG7gs4LODtwOBwOFwOBwOBwODtwWcFnDdxXcd4YWhjaEf88UftoQh4y6ZuRyuVzOZzeudz+uf1z+uf1z+uf1z+uf1zuf1z+uf1z+uf1z+udzR25nM5o7c3rlcrlZsniOkSj9tCEPGXTNyuVy+uZzOb1z+uf1z+uf1z+uf1z+uf1z+udz+uf1z+uf1z+uf1z+ueO3O5nM5vXK5XKzZPEdMUftoYsemHTDpx9OPpxVcVXDVw1cNXDVw0cNHDRw0cNHDRw0cNHDRw0cNHDRw0cNHDRw0cNHDVw1cNXFVxVcVXFVx9OPph0w6Yo/bQxY9MOnH04+nH04quKrhq4auGrhq4aOGjho4aOGjho4aOGkOGkOGkOGjho4aOGjho4aOGjhq4auGriq4quKriq4+nH0w6Ydf+wHgcLhcLicTjYdww7hh3DDuGPcMe4Y9ww7hh3DDuGHcONxuJxOFwuBwOB8753z2fPZ89nz3fNd893zXfPd893z3fP/Y+e757uC75/wCyHz/2Q+f+yHBd893z3fPd893z3fPd893zXfNd893z2fPZ8/b5+3zvncDgcLhcLicTjYdww7hh3DDuGHcMe4Ydww7hh3DDuGHcONxuJxOFwuBwPnfO+d89nz2fPZ893zXfPd813z3fPd893z/2Pnu+e7gu+f8Ash8/9kPn/shwXcF3z3fPd893z3fPd893zXfNd893z2fPZ8/b5+3zvncDdu3bt03bt26bpum6bpum6bt27du3bt26bt26bpum6bpum6bpum6bt03TdN26bpum6bpum7dN03TdN03TdN03TdN03Tdum7dum7dN27dum6bpum6bpum6bpum7du3bt03bpu3bpum6bpum6bpum6bpu3TdN03bpum6bpum6bt03TdN03TdN03TdN03TdN03TduysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysmzKzKzKybMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrJT+2lKUpSlKUpSlKUpSlKUpSlKUpSlKUpSlKUpSn9tKUpSlKUpSlKUpSlKUpSlKUpSlKUpSlKUpT/wDrA//EAB0RAAMBAAMBAQEAAAAAAAAAAAABERIwQFAgkMD/2gAIAQIBAT8A/COlKioqKioqKi+zSoqKioqL59Ro0aKyvpVlZWaNFXiVGkaNFZWV9CsrNGjRpFXepo0V8c69Zo0u1pGilfVnJWaNF+NFXNUaNFfmU0aReamkaNPzNM19VlZWaKysrK/XrKzTNGjRWaKyv+u0/8QAHREBAQACAQUAAAAAAAAAAAAAEQBAUCAQITCQwP/aAAgBAwEBPwD1NkRER07eYiIiNMRERGARERGgIiNAREZRERoCIjiYBERqiIwiI1REcCIiIiIjbkREREREfXZ//9k=";R();R();var bne=!1;function wne(){bne=!0}l(wne,"enableTestMode");function Ane(){return bne}l(Ane,"isTestMode");var Sne=class{constructor(e){D(this,"backgroundAlpha",1),D(this,"backgroundColor",new Mi),D(this,"width",0),D(this,"height",0),D(this,"options",{}),D(this,"renderer"),D(this,"enabledLayers",new Set([0,1])),D(this,"handleWebGLContextCreationError",l(s=>{var u,h;(h=(u=this.options).onWebGLContextCreationError)==null||h.call(u,s)},"handleWebGLContextCreationError")),D(this,"handleWebGLContextLost",l(s=>{var u,h;(h=(u=this.options).onWebGLContextLost)==null||h.call(u,s)},"handleWebGLContextLost")),D(this,"handleWebGLContextRestored",l(s=>{var u,h;(h=(u=this.options).onWebGLContextRestored)==null||h.call(u,s)},"handleWebGLContextRestored"));var t,n,r,a,o;try{this.options=e,Ane()?(this.renderer={setSize:l(()=>{},"setSize"),state:{reset:l(()=>{},"reset")},properties:{get:l(()=>{},"get")},getSize:l(()=>({width:window.innerWidth,height:innerHeight}),"getSize"),getDrawingBufferSize:l(()=>({width:window.innerWidth,height:innerHeight}),"getDrawingBufferSize"),getClearAlpha:l(()=>1,"getClearAlpha"),getClearColor:l(()=>new Mi,"getClearColor"),autoUpdate:!0,shadowMap:{autoUpdate:!0},getContext:l(()=>({getContextAttributes(){return{alpha:!0,antialias:!1,depth:!0,stencil:!1}}}),"getContext"),readRenderTargetPixelsAsync:l(()=>Promise.resolve([]),"readRenderTargetPixelsAsync"),setRenderTarget:l(()=>{},"setRenderTarget"),setClearColor:l(()=>{},"setClearColor"),clear:l(()=>{},"clear"),render:l(()=>{},"render"),clearStencil:l(()=>{},"clearStencil"),clearDepth:l(()=>{},"clearDepth"),domElement:document.createElement("canvas"),capabilities:{isWebGL2:!0}},this.renderer.domElement.style.width="1920px",Object.defineProperty(this.renderer.domElement,"clientWidth",{value:1920}),this.renderer.domElement.style.height="1080px",Object.defineProperty(this.renderer.domElement,"clientHeight",{value:1080})):this.renderer=new ime({canvas:e.canvas,alpha:e.alpha||!1,stencil:!0,antialias:typeof e.antialias=="boolean"?e.antialias:!0,powerPreference:"high-performance",preserveDrawingBuffer:!0}),this.backgroundColor=new Mi((t=e.backgroundColor)!=null?t:"#ffffff"),this.backgroundAlpha=(n=e.backgroundAlpha)!=null?n:1}catch(s){nt.error(s),e.onWebGLRendererError&&e.onWebGLRendererError(s)}(r=this.domElement())==null||r.addEventListener("webglcontextlost",this.handleWebGLContextLost),(a=this.domElement())==null||a.addEventListener("webglcontextrestored",this.handleWebGLContextRestored),(o=this.domElement())==null||o.addEventListener("webglcontextcreationerror",this.handleWebGLContextCreationError)}destroy(){var e,t,n,r,a;this.renderer&&((t=(e=this.renderer).dispose)==null||t.call(e)),(n=this.domElement())==null||n.removeEventListener("webglcontextlost",this.handleWebGLContextLost),(r=this.domElement())==null||r.removeEventListener("webglcontextrestored",this.handleWebGLContextRestored),(a=this.domElement())==null||a.removeEventListener("webglcontextcreationerror",this.handleWebGLContextCreationError)}render(e,t){if(this.renderer){this.renderer.state.reset(),t.layers.disableAll();for(let n of this.enabledLayers.values())t.layers.enable(n);this.renderer.clearStencil(),this.renderer.autoClear=!1,this.renderer.setRenderTarget(null),this.renderer.render(e,t),this.renderer.clearDepth(),t.layers.disableAll(),t.layers.enable(lee.ALWAYS_ON_TOP),this.renderer.render(e,t),this.renderer.state.reset()}}clear(){this.renderer&&(this.renderer.setClearColor(this.backgroundColor,this.backgroundAlpha),this.renderer.clear())}setBufferSize(e,t){mr.env.NODE_ENV==="test"||!this.renderer||(this.width=e,this.height=t,this.renderer.setSize(e,t,!1))}setBackgroundColor(e,t){this.backgroundColor=e,this.backgroundAlpha=t}domElement(){var e;return(e=this.renderer)==null?void 0:e.domElement}};l(Sne,"Renderer");var JAe=Sne;R();R();var KAe=`"use strict";(()=>{var G=Object.defineProperty;var J=(n,e,t)=>e in n?G(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var l=(n,e,t)=>J(n,typeof e!="symbol"?e+"":e,t);function M(n,e){return e.x+e.w<n.x+n.w&&e.x>n.x&&e.y>n.y&&e.y+e.h<n.y+n.h}function j(n,e){let[t,i]=e;return t>=n.x&&t<=n.x+n.w&&i>=n.y&&i<=n.y+n.h}function q(n,e){let t=e.x,i=e.y,o=e.x+e.w,h=e.y+e.h,k=n.x,p=n.y,f=n.x+n.w,g=n.y+n.h;return t<f&&k<o&&i<g&&p<h}function c(n,e){for(let t=0;t<e.length;t++)n.push(e[t])}var s=class{constructor(e,t,i,o,h){l(this,"x");l(this,"y");l(this,"w");l(this,"h");l(this,"userData");this.userData=typeof h>"u"?null:h,this.x=e,this.y=t,this.w=i,this.h=o}contains(e){return e===this?!1:M(this,e)}intersects(e){return q(this,e)}intersectsPoint(e){return j(this,e)}draw(e){e.fillStyle="rgba(123,222,26, 0.8)",e.fillRect(this.x,this.y,this.w,this.h)}};var w=class n{constructor(e,t){l(this,"topLeft");l(this,"topRight");l(this,"bottomLeft");l(this,"bottomRight");l(this,"divided",!1);l(this,"boundary");l(this,"capacity",16);l(this,"objects",[]);l(this,"parent");this.parent=t,this.boundary=e}getSize(){return this.divided?this.objects.length+this.topLeft.getSize()+this.topRight.getSize()+this.bottomLeft.getSize()+this.bottomRight.getSize():this.objects.length}subdivide(){let{x:e,y:t,w:i,h:o}=this.boundary;this.topLeft=new n(new s(e,t,i/2,o/2),this),this.topRight=new n(new s(e+i/2,t,i/2,o/2),this),this.bottomLeft=new n(new s(e,t+o/2,i/2,o/2),this),this.bottomRight=new n(new s(e+i/2,t+o/2,i/2,o/2),this),this.divided=!0}queryRect(e){let t=[];if(this.boundary.intersects(e))t.push(...this.objects);else return[];return this.divided&&(c(t,this.topLeft.queryRect(e)),c(t,this.topRight.queryRect(e)),c(t,this.bottomLeft.queryRect(e)),c(t,this.bottomRight.queryRect(e))),t}queryPoint(e){let t=[];if(this.boundary.intersectsPoint(e))t.push(...this.objects);else return[];return this.divided&&(c(t,this.topLeft.queryPoint(e)),c(t,this.topRight.queryPoint(e)),c(t,this.bottomLeft.queryPoint(e)),c(t,this.bottomRight.queryPoint(e))),t}insert(e){return(this.parent?!this.boundary.contains(e):!this.boundary.intersects(e))?!1:this.objects.length<this.capacity?(this.objects.push(e),!0):(this.divided||this.subdivide(),(this.topLeft.insert(e)||this.topRight.insert(e)||this.bottomLeft.insert(e)||this.bottomRight.insert(e))===!1&&this.objects.push(e),!0)}drawObjects(e){this.objects.forEach(t=>t.draw(e)),this.divided&&(this.topLeft.drawObjects(e),this.topRight.drawObjects(e),this.bottomLeft.drawObjects(e),this.bottomRight.drawObjects(e))}draw(e){e.rect(this.boundary.x,this.boundary.y,this.boundary.w,this.boundary.h),this.divided&&(this.topLeft.draw(e),this.topRight.draw(e),this.bottomLeft.draw(e),this.bottomRight.draw(e)),e.strokeStyle="black",e.lineWidth=4,e.stroke()}};var d=200,S=10;function z(n,e,t,i,o,h,k="-1"){let p=1/0,f=1/0,g=-1/0,P=-1/0,O=new s(-S,0,5,t),K=new s(-S,0,e,5),W=new s(e-5,0,e+S,t),V=new s(0,t-5,e,t+S),Q=Z(e,t,i,o,h),Y=[O,K,W,V],E=new s(-d,-d,e+d*2,t+d*2);for(let r of n){let R,T;for(let u=0;u<r.bboxes.length;u++){if(r.bboxes[u]==null||(R=r.bboxes[u].boundingBox,T=r.bboxes[u].index,r.lockedToStrategyIndex!==-1&&T!==r.lockedToStrategyIndex))continue;let[I,a,b,N]=R,[m,F,D,U]=[r.y-I,r.y+a,r.x-b,r.x+N],B=D,L=m,A=U-D,_=F-m;p=Math.min(p,B)-d,f=Math.min(f,L)-d,g=Math.max(g,B+A)+d,P=Math.max(P,L+_)+d,r.bboxes[u].boundingRect=new s(B,L,A,_)}}let y={msgId:k,colliders:new Array(n.length),debug:[]},C=new w(new s(p,f,g-p,P-f)),x;for(let r=0;r<n.length;r++)if(x=n[r],y.colliders[r]=[-1,0],x.enabledAndVisible){let[R,T,u]=[1/0,-1,void 0];for(let{index:I,boundingRect:a}of x.bboxes){if(a==null)continue;let b=[];if(b=C.queryRect(a).filter(m=>a.intersects(m)),x.shouldCollideWithScreenEdges&&Y.forEach(m=>{a.intersects(m)&&b.push(m)}),a.intersects(Q)){y.colliders[r]=[-1,0,a];break}if(b.length<=R&&(u=a,T=I,R=b.length),b.length===0){C.insert(a),y.colliders[r]=[I,E.contains(a)?0:1,a];break}}x.rank===5&&u!=null&&(C.insert(u),y.colliders[r]=[T,E.contains(u)?0:1,u])}else y.colliders[r]=[-1,0];return y}function Z(n,e,t,i,o){switch(o){case"top-right":return new s(n-t,0,t,i);case"bottom-left":return new s(0,e-i,t,i);case"bottom-right":return new s(n-t,e-i,t,i);case"top-left":return new s(0,0,t,i)}}function X(n){let e=n[0].map(t=>{let i=t[0].map(o=>({index:o[4],boundingBox:[o[0],o[1],o[2],o[3]]}));return{enabledAndVisible:t[1]===1,rank:t[2]===1?5:0,x:t[3],y:t[4],shouldCollideWithScreenEdges:t[5]===1,bboxes:i,lockedToStrategyIndex:t[6]}});return{msgId:"-1",totalWidth:n[3],totalHeight:n[2],watermarkWidth:n[4],watermarkHeight:n[5],watermarkPosition:n[6],colliders:e,devicePixelRatio:n[1]}}self.onmessage=n=>{let e=X(n.data);self.postMessage(z(e.colliders,e.totalWidth,e.totalHeight,e.watermarkWidth,e.watermarkHeight,e.watermarkPosition,e.msgId))};})();
`;R();R();R();R();R();function Mne(i,e){return e.x+e.w<i.x+i.w&&e.x>i.x&&e.y>i.y&&e.y+e.h<i.y+i.h}l(Mne,"contains");R();function Cne(i,e){let[t,n]=e;return t>=i.x&&t<=i.x+i.w&&n>=i.y&&n<=i.y+i.h}l(Cne,"intersectPoint");R();function Ene(i,e){let t=e.x,n=e.y,r=e.x+e.w,a=e.y+e.h,o=i.x,s=i.y,u=i.x+i.w,h=i.y+i.h;return t<u&&o<r&&n<h&&s<a}l(Ene,"intersects");R();function Gu(i,e){for(let t=0;t<e.length;t++)i.push(e[t])}l(Gu,"appendItems");R();var Ine=class{constructor(e,t,n,r,a){D(this,"x"),D(this,"y"),D(this,"w"),D(this,"h"),D(this,"userData"),this.userData=typeof a>"u"?null:a,this.x=e,this.y=t,this.w=n,this.h=r}contains(e){return e===this?!1:Mne(this,e)}intersects(e){return Ene(this,e)}intersectsPoint(e){return Cne(this,e)}draw(e){e.fillStyle="rgba(123,222,26, 0.8)",e.fillRect(this.x,this.y,this.w,this.h)}};l(Ine,"Rectangle");var Nr=Ine,Tne=class lv{constructor(e,t){D(this,"topLeft"),D(this,"topRight"),D(this,"bottomLeft"),D(this,"bottomRight"),D(this,"divided",!1),D(this,"boundary"),D(this,"capacity",16),D(this,"objects",[]),D(this,"parent"),this.parent=t,this.boundary=e}getSize(){return this.divided?this.objects.length+this.topLeft.getSize()+this.topRight.getSize()+this.bottomLeft.getSize()+this.bottomRight.getSize():this.objects.length}subdivide(){let{x:e,y:t,w:n,h:r}=this.boundary;this.topLeft=new lv(new Nr(e,t,n/2,r/2),this),this.topRight=new lv(new Nr(e+n/2,t,n/2,r/2),this),this.bottomLeft=new lv(new Nr(e,t+r/2,n/2,r/2),this),this.bottomRight=new lv(new Nr(e+n/2,t+r/2,n/2,r/2),this),this.divided=!0}queryRect(e){let t=[];if(this.boundary.intersects(e))t.push(...this.objects);else return[];return this.divided&&(Gu(t,this.topLeft.queryRect(e)),Gu(t,this.topRight.queryRect(e)),Gu(t,this.bottomLeft.queryRect(e)),Gu(t,this.bottomRight.queryRect(e))),t}queryPoint(e){let t=[];if(this.boundary.intersectsPoint(e))t.push(...this.objects);else return[];return this.divided&&(Gu(t,this.topLeft.queryPoint(e)),Gu(t,this.topRight.queryPoint(e)),Gu(t,this.bottomLeft.queryPoint(e)),Gu(t,this.bottomRight.queryPoint(e))),t}insert(e){return(this.parent?!this.boundary.contains(e):!this.boundary.intersects(e))?!1:this.objects.length<this.capacity?(this.objects.push(e),!0):(this.divided||this.subdivide(),(this.topLeft.insert(e)||this.topRight.insert(e)||this.bottomLeft.insert(e)||this.bottomRight.insert(e))===!1&&this.objects.push(e),!0)}drawObjects(e){this.objects.forEach(t=>t.draw(e)),this.divided&&(this.topLeft.drawObjects(e),this.topRight.drawObjects(e),this.bottomLeft.drawObjects(e),this.bottomRight.drawObjects(e))}draw(e){e.rect(this.boundary.x,this.boundary.y,this.boundary.w,this.boundary.h),this.divided&&(this.topLeft.draw(e),this.topRight.draw(e),this.bottomLeft.draw(e),this.bottomRight.draw(e)),e.strokeStyle="black",e.lineWidth=4,e.stroke()}};l(Tne,"QuadTree");var Cm=Tne;R();R();var Pne=["","","low","medium","high","always-visible"];function PD(i){return Math.min(5,Math.max(2,i))}l(PD,"clampTierNumber");function XA(i){if(typeof i=="number")return PD(i);let e=Pne.indexOf(i);return e===-1?3:e}l(XA,"convertCollisionRankingTierToNumber");function uv(i){let e=PD(i);return Pne[e]}l(uv,"convertNumberToCollisionRankingTier");function Lne(i,e,t){let n,r,a,o=null,s=0;t||(t={});let u=l(function(){s=t.leading===!1?0:Date.now(),o=null,a=i.apply(n,r),o||(n=r=null)},"later");return function(){let h=Date.now();!s&&t.leading===!1&&(s=h);let d=e-(h-s);return n=globalThis,r=arguments,d<=0||d>e?(o&&(clearTimeout(o),o=null),s=h,a=i.apply(n,r),o||(n=r=null)):!o&&t.trailing!==!1&&(o=setTimeout(u,d)),a}}l(Lne,"throttle");function Dne(i){let e=i[0].map(t=>{let n=t[0].map(r=>({index:r[4],boundingBox:[r[0],r[1],r[2],r[3]]}));return{enabledAndVisible:t[1]===1,rank:t[2]===1?5:0,x:t[3],y:t[4],shouldCollideWithScreenEdges:t[5]===1,bboxes:n,lockedToStrategyIndex:t[6]}});return{msgId:"-1",totalWidth:i[3],totalHeight:i[2],watermarkWidth:i[4],watermarkHeight:i[5],watermarkPosition:i[6],colliders:e,devicePixelRatio:i[1]}}l(Dne,"unpackMessage");R();R();var jh=200,P_=10;function kne(i,e,t,n,r,a,o="-1"){let s=1/0,u=1/0,h=-1/0,d=-1/0,f=new Nr(-P_,0,5,t),m=new Nr(-P_,0,e,5),v=new Nr(e-5,0,e+P_,t),b=new Nr(0,t-5,e,t+P_),w=Rne(e,t,n,r,a),A=[f,m,v,b],E=new Nr(-jh,-jh,e+jh*2,t+jh*2);for(let k of i){let F,B;for(let N=0;N<k.bboxes.length;N++){if(k.bboxes[N]==null||(F=k.bboxes[N].boundingBox,B=k.bboxes[N].index,k.lockedToStrategyIndex!==-1&&B!==k.lockedToStrategyIndex))continue;let[z,L,j,q]=F,[Z,O,Y,J]=[k.y-z,k.y+L,k.x-j,k.x+q],oe=Y,$=Z,K=J-Y,te=O-Z;s=Math.min(s,oe)-jh,u=Math.min(u,$)-jh,h=Math.max(h,oe+K)+jh,d=Math.max(d,$+te)+jh,k.bboxes[N].boundingRect=new Nr(oe,$,K,te)}}let I={msgId:o,colliders:new Array(i.length),debug:[]},C=new Cm(new Nr(s,u,h-s,d-u)),T;for(let k=0;k<i.length;k++)if(T=i[k],I.colliders[k]=[-1,0],T.enabledAndVisible){let[F,B,N]=[1/0,-1,void 0];for(let{index:z,boundingRect:L}of T.bboxes){if(L==null)continue;let j=[];if(j=C.queryRect(L).filter(q=>L.intersects(q)),T.shouldCollideWithScreenEdges&&A.forEach(q=>{L.intersects(q)&&j.push(q)}),L.intersects(w)){I.colliders[k]=[-1,0,L];break}if(j.length<=F&&(N=L,B=z,F=j.length),j.length===0){C.insert(L),I.colliders[k]=[z,E.contains(L)?0:1,L];break}}T.rank===5&&N!=null&&(C.insert(N),I.colliders[k]=[B,E.contains(N)?0:1,N])}else I.colliders[k]=[-1,0];return I}l(kne,"processColliders");function Rne(i,e,t,n,r){switch(r){case"top-right":return new Nr(i-t,0,t,n);case"bottom-left":return new Nr(0,e-n,t,n);case"bottom-right":return new Nr(i-t,e-n,t,n);case"top-left":return new Nr(0,0,t,n)}}l(Rne,"getWatermarkBoundary");var One=class{constructor(){D(this,"onmessage",l(()=>{},"onmessage")),D(this,"postMessage",l(e=>{let t=Dne(e);this.onmessage({data:kne(t.colliders,t.totalWidth,t.totalHeight,t.watermarkWidth,t.watermarkHeight,t.watermarkPosition,t.msgId)})},"postMessage")),D(this,"terminate",l(()=>{},"terminate"))}};l(One,"SyncWorker");var QAe=One,dp=!1,eSe=150,Nne=class extends xr{constructor(e,t,n=!0){super(),D(this,"worker"),D(this,"debugContext"),D(this,"debugCanvas"),D(this,"collidersDirty",!0),D(this,"packedMessage",[[],0,0,0,0,0,"bottom-left"]),D(this,"visibleCollidersQTree",new Cm(new Nr(0,0,0,0))),D(this,"interactiveCollidersQTree",new Cm(new Nr(0,0,0,0))),D(this,"coreState"),D(this,"postMessage"),D(this,"showCollisionBoxes",l(()=>{dp=!0,this.debugCanvas.style.display="block"},"showCollisionBoxes")),D(this,"hideCollisionBoxes",l(()=>{dp=!1,this.debugContext.clearRect(0,0,this.debugCanvas.width,this.debugCanvas.height),this.debugCanvas.style.display="none"},"hideCollisionBoxes")),D(this,"currentMsgId",""),D(this,"working",!1),D(this,"_postMessage",l(()=>{this.worker.postMessage(this.packedMessage)},"_postMessage")),D(this,"componentArray",[]),D(this,"update",l((r,a,o="bottom-left",s=!1)=>{let u=!1;if(this.collidersDirty){this.packedMessage=[[],0,0,0,0,0,"bottom-left"],this.componentArray=[];let h;for(let d of this.coreState.geometry2DIdsInScene){let f=this.coreState.geometry2DMap.get(d);f&&(h=f.components[0],this.componentArray.push(h))}this.resize(r,a,o),this.collidersDirty=!1,u=!0}else u=this.componentArray.some(h=>h.collisionDirty===!0);u&&this.componentArray.sort((h,d)=>d.rank-h.rank);for(let h=0;h<this.componentArray.length;h++)if(this.packedMessage){let d=this.componentArray[h].toPackedMessage(s&&!u);this.packedMessage[0][h]==null&&(this.packedMessage[0][h]=[]),this.packedMessage[0][h][0]==null&&(this.packedMessage[0][h][0]=[]),this.packedMessage[0][h][0]=d.bboxes,this.packedMessage[0][h][1]=d.enabled&&this.componentArray[h].visible&&!this.componentArray[h].isOccluded?1:0,this.packedMessage[0][h][2]=d.rank===5?1:0,this.packedMessage[0][h][3]=d.x,this.packedMessage[0][h][4]=d.y,this.packedMessage[0][h][5]=d.shouldCollideWithScreenEdges?1:0,this.packedMessage[0][h][6]=d.lockedToStrategyIndex}this.working||this.postMessage()},"update")),D(this,"resolve",l(r=>{if(this.working=!1,this.collidersDirty||!r.data)return;let a=r.data.colliders,o=-1,s,u,h;dp&&(this.visibleCollidersQTree=new Cm(new Nr(0,0,this.debugCanvas.width,this.debugCanvas.height))),this.interactiveCollidersQTree=new Cm(new Nr(0,0,this.debugCanvas.width,this.debugCanvas.height));for(let d=0;d<this.componentArray.length;d++){let f=this.componentArray[d];a[d]!=null&&(o=a[d][0],s=a[d][2],f.offscreen=a[d][1]===1,o!==-1&&s!=null?(h=new Nr(s.x,s.y,s.w,s.h,{entityId:f.id}),dp&&this.visibleCollidersQTree.insert(h),u=this.coreState.geometry2DMap.get(f.id),u?.components[1]!=null&&this.interactiveCollidersQTree.insert(new Nr(s.x,s.y,s.w,s.h,{entityId:f.id})),(f.canShow===!1||f.visibilityNeedsUpdate!==!1)&&"visibilityNeedsUpdate"in f&&(f.visibilityNeedsUpdate="show"),o!==-1&&o!==f.currentStrategyIndex&&(f.activeBoundingBox=h,f.onStrategySelected(o))):((f.canShow===!0||f.visibilityNeedsUpdate!==!1)&&"visibilityNeedsUpdate"in f&&(f.visibilityNeedsUpdate="hide"),o!==-1&&o!==f.currentStrategyIndex&&f.onStrategySelected(o)))}dp&&this.drawDebug(),this.publish("visibility-changed")},"resolve")),D(this,"drawDebug",l(()=>{dp&&this.visibleCollidersQTree&&(this.debugContext.clearRect(0,0,this.debugCanvas.width,this.debugCanvas.height),this.debugContext.beginPath(),this.visibleCollidersQTree.drawObjects(this.debugContext))},"drawDebug")),D(this,"destroy",l(()=>{this.worker.terminate()},"destroy")),this.worker=n===!1?new QAe:V1!==""?new Worker(V1):new Worker(URL.createObjectURL(new Blob([KAe],{type:"text/javascript"}))),this.coreState=t,this.debugCanvas=e,this.debugContext=e.getContext("2d"),this.worker.onmessage=r=>this.resolve(r),this.postMessage=Lne(this._postMessage,eSe,!1),dp?this.showCollisionBoxes():this.hideCollisionBoxes()}resize(e,t,n){this.packedMessage[6]=n,this.packedMessage[5]=t,this.packedMessage[4]=e,this.packedMessage[3]=this.debugCanvas.width,this.packedMessage[2]=this.debugCanvas.height}};l(Nne,"CollisionSystem");var tSe=Nne;R();R();R();R();var Fne=class{constructor(e){D(this,"type"),D(this,"event"),this.type=0,this.event=e}get timestamp(){return this.event.timeStamp}};l(Fne,"Tap");var iSe=Fne,Bne=class{constructor(){D(this,"taps",[])}add(e){this.lastPointerDown&&e.timestamp-this.lastPointerDown.timestamp<50?this.lastPointerDown.type=1:this.taps.push(e)}get lastPointerDown(){return this.taps.length>=1?this.taps[this.taps.length-1]:void 0}get isSingleTapWithTwoFingers(){var e;return this.isSingleTap&&((e=this.lastPointerDown)==null?void 0:e.type)===1}get isSingleTapWithOneFinger(){var e;return this.isSingleTap&&((e=this.lastPointerDown)==null?void 0:e.type)===0}get isDoubleTapWithOneFinger(){var e,t;return this.isDoubleTap&&((e=this.taps[0])==null?void 0:e.type)===0&&((t=this.taps[1])==null?void 0:t.type)===0}get isSingleTap(){return this.taps.length===1}get isDoubleTap(){return this.taps.length===2}discardOutsideOfWaitWindow(e){this.taps=this.taps.filter(t=>e-t.timestamp<300)}flush(){this.taps=[]}get _taps(){return this.taps}destroy(){this.flush()}};l(Bne,"TapsController");var nSe=Bne;R();function yI(i){let e=new Set;for(let t of i){let n=t.object;for(;n.visible&&n.parent&&n.parent.visible===!0&&!e.has(n.parent);)n=n.parent,n instanceof Kn&&n.type==="group-container"&&n.visible&&n.components[1]&&e.add(n)}return Array.from(e)}l(yI,"getUniqueIntersectedGroupContainers");var hv,zne=class extends xr{constructor(e,t,n,r,a){super(),D(this,"raycaster",new Z1),D(this,"state",{hovered3DEntity:void 0,hovered2DEntity:void 0,hovered3DContainers:void 0,lastHover:void 0,interaction:{mouseDownStart:void 0,distanceFromMouseDown:void 0,isPanning:!1}}),D(this,"coreState"),D(this,"camera"),D(this,"worldPlane"),D(this,"_quadtree",new Cm(new Nr(0,0,0,0))),D(this,"_container"),D(this,"lastPointerEvent"),D(this,"cursor","grab"),D(this,"touchesCount",0),D(this,"isUserInteracting"),D(this,"hasTouched",!1),ge(this,hv),D(this,"onPointerMoveRaf",l(o=>{this.lastPointerEvent=o,y(this,hv)&&cancelAnimationFrame(y(this,hv)),Ce(this,hv,requestAnimationFrame(()=>{this.onPointerMove(o)}))},"onPointerMoveRaf")),D(this,"onPointerMove",l(o=>{o.preventDefault(),this.updateInteractionStateIfPanning(o),(o.pointerType!=="touch"||o.pointerType===void 0&&this.hasTouched)&&this.handleHover(o),this.handleCursor()},"onPointerMove")),D(this,"tapsControl",new nSe),D(this,"onPointerDown",l(o=>{o.target===this._container&&(this._container.addEventListener("pointerup",this.onPointerUp,!1),this._container.addEventListener("pointercancel",this.onPointerUp,!1),this.state.interaction.mouseDownStart={time:Date.now(),timestamp:o.timeStamp,clientX:o.clientX,clientY:o.clientY},this.lastPointerEvent=o,this.state.interaction.distanceFromMouseDown=0,this.handleCursor(),o.pointerType==="touch"&&(this.tapsControl.add(new iSe(o)),this.touchesCount=Math.max(0,this.touchesCount+1)))},"onPointerDown")),D(this,"clickTimeout"),D(this,"onPointerUp",l(o=>{this.tapsControl.discardOutsideOfWaitWindow(o.timeStamp),this.lastPointerEvent=o,this.touchesCount=Math.max(0,this.touchesCount-1),this.touchesCount===0&&(this._container.removeEventListener("pointerup",this.onPointerUp,!1),this._container.removeEventListener("pointercancel",this.onPointerUp,!1)),this.updateInteractionStateIfPanning(o);let{mouseDownStart:s}=this.state.interaction;!s||this.state.interaction.distanceFromMouseDown==null||(Date.now()<s.time+300&&(this.tapsControl.isSingleTapWithTwoFingers||this.state.interaction.distanceFromMouseDown<=15)&&(o.pointerType==="touch"?this.tapsControl.isSingleTapWithTwoFingers?(this.publish("singletap-with-twofinger",o),this.flush()):this.tapsControl.isSingleTapWithOneFinger&&this.touchesCount===0?(this.clickTimeout&&clearTimeout(this.clickTimeout),this.clickTimeout=window.setTimeout(()=>{this.handleClick(o),this.flush()},300)):this.tapsControl.isDoubleTapWithOneFinger&&(this.publish("doubletap-with-onefinger",o),this.flush()):this.handleClick(o)),this.state.interaction.mouseDownStart=void 0,this.state.interaction.distanceFromMouseDown=void 0,this.state.interaction.isPanning=!1,this.handleCursor())},"onPointerUp")),D(this,"dirty3D",!0),D(this,"cachedHitBoxes",{entities:[]}),D(this,"ndcPoint",new ft),D(this,"debugPanel"),this.isUserInteracting=a,this.raycaster.layers.enableAll(),this.raycaster.layers.disable(1),this.camera=n,this._container=e,this.coreState=t,this.worldPlane=r,this._container.addEventListener("pointerdown",this.onPointerDown,!1),this._container.addEventListener("pointermove",this.onPointerMoveRaf,!1),this._container.classList.add("mappedin-interactive")}updateQuadtree(e){this._quadtree=e}setHovered3DEntityInteractionComponentDirty(){if(this.state.hovered3DEntity){let e=this.state.hovered3DEntity.components[2];e&&(e.dirty=!0)}}getThreeDIntersectsFromXY(e){this.raycaster.setFromCamera(e,this.camera),this.raycaster.layers.enable(0);let t=this.raycaster.intersectObjects(this._hitBoxes.entities,!0).filter(r=>{var a,o;return((a=r.object)==null?void 0:a.name)==="worldPlane"||((o=r.object)==null?void 0:o.visible)}),n=t.findIndex(r=>{var a;return((a=r.object)==null?void 0:a.name)==="worldPlane"});return n!==-1&&t.push(t.splice(n,1)[0]),t}getGroupContainerIntersectsFromXY(e){let t=this.getThreeDIntersectsFromXY(e),n;return t!=null&&t.length>0&&(n=yI(t)),n}flush(){this.tapsControl.flush(),this.clickTimeout!=null&&(clearTimeout(this.clickTimeout),this.clickTimeout=void 0)}handleHover(e){let t=e||this.lastPointerEvent;if(this.state.interaction.mouseDownStart||!t||this.isUserInteracting())return;let{entity3D:n,entity2D:r,position:a,groupContainers:o}=this.intersect(t);(this.detect3DEntityHover(n)||this.detect2DEntityHover(r)||this.detect3DContainerHover(o))&&(this.state.hovered3DEntity=n,this.state.lastHover=n,this.state.hovered2DEntity=r,this.state.hovered3DContainers=o,this.publish("hover",{entity2D:this.state.hovered2DEntity,entity3D:this.state.hovered3DEntity,position:a,groupContainers:o})),this.handleCursor()}handleCursor(){var e;let t=!!(this.state.hovered3DEntity&&(e=this.state.hovered3DEntity)!=null&&e.components[2]||this.state.hovered2DEntity),n=!!this.state.interaction.mouseDownStart,r=this.state.interaction.isPanning,a=Une(t,r,n);this.cursor!==a&&(this.cursor=a,a==="pointer"?this._container.classList.add("mappedin-interaction-hover"):this._container.classList.remove("mappedin-interaction-hover"))}detect2DEntityHover(e){return this.state.hovered2DEntity!==e}handleClick(e){let t=this.intersect(e);this.publish("click",{entity2D:t.entity2D,entity3D:t.entity3D,position:t.position,groupContainers:t.groupContainers,pointerEvent:{button:e.button}})}get _hitBoxes(){if(this.dirty3D){this.cachedHitBoxes.entities=[];let e;for(let t of this.coreState.geometry3DIdsInScene)e=this.coreState.geometry3DMap.get(t),(e?.type==="geometry"||e?.type==="model"||e?.type==="path"||e?.type==="custom-geometry")&&e.components[0].mesh&&!this.cachedHitBoxes.entities.includes(e.components[0].mesh)&&this.cachedHitBoxes.entities.push(e.components[0].mesh);return this.dirty3D=!1,this.cachedHitBoxes.entities.push(this.worldPlane),this.cachedHitBoxes}return this.cachedHitBoxes}intersect(e){var t,n,r,a,o;let s=[e.offsetX,e.offsetY],u=this._quadtree.queryPoint(s),[h]=u.filter(k=>k.intersectsPoint(s)),d=this.coreState.containerOffset[0],f=this.coreState.containerOffset[1];this.ndcPoint.x=(e.clientX-f)/this._container.clientWidth*2-1,this.ndcPoint.y=-((e.clientY-d)/this._container.clientHeight)*2+1;let m=this.getThreeDIntersectsFromXY(this.ndcPoint),v=(t=m[0])==null?void 0:t.point,b=[],w=[],A=m.filter(k=>k.object.name!=="worldPlane");for(let k of A)k.object instanceof ln&&k.object.material.depthTest===!1?b.push(k):w.push(k);let E=(r=(n=b[0])!=null?n:w[0])!=null?r:void 0,I,C;if(E!=null){if(I=jne(E.object,this.coreState.geometry3DMap),!I){let k=(a=E?.instanceId)!=null?a:E?.batchId;I=k!=null&&E!=null&&E.object.userData.entities?this.coreState.geometry3DMap.get(E?.object.userData.entities[k]):this.coreState.geometry3DMap.get(E?.object.userData.entityId)}I!=null&&I.components[2]&&(C=I)}let T=yI(A);return{entity2D:((o=h?.userData)==null?void 0:o.entityId)==="watermark"?{id:"watermark"}:this.coreState.geometry2DMap.get(h?.userData.entityId),entity3D:C,position:v,groupContainers:T.length>0?T:void 0}}detect3DEntityHover(e){return this.state.lastHover!==e&&(this.state.lastHover&&vI(this.state.lastHover,!1,this.coreState),e&&vI(e,!0,this.coreState)),this.state.hovered3DEntity!==e}detect3DContainerHover(e){return!VL(this.state.hovered3DContainers,e)}updateInteractionStateIfPanning(e){this.state.interaction.mouseDownStart&&(this.state.interaction.distanceFromMouseDown=Math.sqrt(Math.pow(e.clientX-this.state.interaction.mouseDownStart.clientX,2)+Math.pow(e.clientY-this.state.interaction.mouseDownStart.clientY,2)),!this.state.interaction.isPanning&&this.state.interaction.distanceFromMouseDown>15&&(this.state.interaction.isPanning=!0))}getMouseRayIntersects(){return this.raycaster.intersectObjects([this.worldPlane],!1)}destroy(){this._container.removeEventListener("pointerdown",this.onPointerDown,!1),this._container.removeEventListener("pointermove",this.onPointerMoveRaf,!1),this._container.removeEventListener("pointerup",this.onPointerUp,!1),this._container.removeEventListener("pointercancel",this.onPointerUp,!1)}enableDebug(){let e=document.createElement("div");e.style.position="absolute",e.style.top="0",e.style.right="0",e.style.backgroundColor="white",e.style.padding="10px",document.body.append(e),e.id="interaction-debug-panel",this.debugPanel=e,this.on("doubletap-with-onefinger",()=>{this.queueDebugMessage("doubletap-with-onefinger","#ffadad")}),this.on("singletap-with-twofinger",()=>{this.queueDebugMessage("singletap-with-twofinger","#ffd6a5")}),this.on("click",t=>{var n,r,a;this.queueDebugMessage(`CLICK 
3D: `.concat((n=t.entity3D)==null?void 0:n.id,` 
2D: `).concat((r=t.entity2D)==null?void 0:r.id,` 
Pos: `).concat((a=t.position)==null?void 0:a.toArray().join(", ")),"#fdffb6")}),this.on("hover",t=>{var n,r,a;this.queueDebugMessage(`HOVER 
3D: `.concat((n=t.entity3D)==null?void 0:n.id,` 
2D: `).concat((r=t.entity2D)==null?void 0:r.id,` 
Pos: `).concat((a=t.position)==null?void 0:a.toArray().join(", ")),"#caffbf")})}get _state(){return this.state}queueDebugMessage(e,t){var n;let r=document.createElement("pre");r.style.maxWidth="300px",r.style.transition="opacity 500ms cubic-bezier(0.4, 0, 0.2, 1)",r.style.backgroundColor=t,r.textContent=e,(n=this.debugPanel)==null||n.prepend(r),setTimeout(()=>{r.style.opacity="0",setTimeout(()=>{r.remove()},500)},2500)}getCursor(){return this.cursor}};hv=new WeakMap,l(zne,"InteractionSystem");var rSe=zne;function vI(i,e,t){var n;let r=i.components[2];r&&r.hover!==!0&&(r.hover=e?"user-interaction":!1,r.dirty=!0);let a=(n=i.components[0].textMesh)==null?void 0:n.userData.entityId;if(!a)return;let o=t.geometry3DMap.get(a);o?.type==="text3d"&&(o.components[1].hoverByPolygon=e,o.components[1].dirty=!0)}l(vI,"updateHover");function Une(i,e,t){return e?"grabbing":i?"pointer":t?"grabbing":"grab"}l(Une,"processCursor");function Vne(i){let e=i;for(;e!=null&&e.parent;){if(e instanceof zP)return;if(e.userData.isSingleModel)return e;e=e.parent}}l(Vne,"findModelParent");function jne(i,e){let t=Vne(i);return t?e.get(t.userData.entityId):void 0}l(jne,"findModelParentEntity");R();R();R();var $e={};xh($e,{BRAND:()=>SSe,DIRTY:()=>Em,EMPTY_PATH:()=>sSe,INVALID:()=>zi,NEVER:()=>sMe,OK:()=>To,ParseStatus:()=>Xo,Schema:()=>un,ZodAny:()=>Ig,ZodArray:()=>Sd,ZodBigInt:()=>E1,ZodBoolean:()=>I1,ZodBranded:()=>RD,ZodCatch:()=>B1,ZodDate:()=>T1,ZodDefault:()=>F1,ZodDiscriminatedUnion:()=>bre,ZodEffects:()=>bl,ZodEnum:()=>C0,ZodError:()=>yl,ZodFirstPartyTypeKind:()=>Ui,ZodFunction:()=>Pre,ZodIntersection:()=>k1,ZodIssueCode:()=>Pt,ZodLazy:()=>R1,ZodLiteral:()=>O1,ZodMap:()=>Lw,ZodNaN:()=>kw,ZodNativeEnum:()=>N1,ZodNever:()=>vh,ZodNull:()=>L1,ZodNullable:()=>$c,ZodNumber:()=>C1,ZodObject:()=>zs,ZodOptional:()=>au,ZodParsedType:()=>oi,ZodPipeline:()=>OD,ZodPromise:()=>Tg,ZodReadonly:()=>z1,ZodRecord:()=>Cre,ZodSchema:()=>un,ZodSet:()=>Dw,ZodString:()=>Eg,ZodSymbol:()=>Iw,ZodTransformer:()=>bl,ZodTuple:()=>Gc,ZodType:()=>un,ZodUndefined:()=>P1,ZodUnion:()=>D1,ZodUnknown:()=>hd,ZodVoid:()=>Tw,addIssueToContext:()=>qt,any:()=>kSe,array:()=>FSe,bigint:()=>ISe,boolean:()=>Xre,coerce:()=>oMe,custom:()=>ND,date:()=>TSe,datetimeRegex:()=>DD,defaultErrorMap:()=>Cg,discriminatedUnion:()=>VSe,effect:()=>GR,enum:()=>YSe,function:()=>qSe,getErrorMap:()=>S1,getParsedType:()=>nh,instanceof:()=>CSe,intersection:()=>jSe,isAborted:()=>xI,isAsync:()=>M1,isDirty:()=>bI,isValid:()=>Ad,late:()=>MSe,lazy:()=>XSe,literal:()=>ZSe,makeIssue:()=>Ew,map:()=>HSe,nan:()=>ESe,nativeEnum:()=>JSe,never:()=>OSe,null:()=>DSe,nullable:()=>eMe,number:()=>qre,object:()=>BSe,objectUtil:()=>_I,oboolean:()=>aMe,onumber:()=>rMe,optional:()=>QSe,ostring:()=>nMe,pipeline:()=>iMe,preprocess:()=>tMe,promise:()=>KSe,quotelessJson:()=>aSe,record:()=>$Se,set:()=>WSe,setErrorMap:()=>Wne,strictObject:()=>zSe,string:()=>Wre,symbol:()=>PSe,transformer:()=>GR,tuple:()=>GSe,undefined:()=>LSe,union:()=>USe,unknown:()=>RSe,util:()=>Ln,void:()=>NSe});R();R();R();R();R();var Ln;(function(i){i.assertEqual=r=>{};function e(r){}l(e,"assertIs"),i.assertIs=e;function t(r){throw new Error}l(t,"assertNever"),i.assertNever=t,i.arrayToEnum=r=>{let a={};for(let o of r)a[o]=o;return a},i.getValidEnumValues=r=>{let a=i.objectKeys(r).filter(s=>typeof r[r[s]]!="number"),o={};for(let s of a)o[s]=r[s];return i.objectValues(o)},i.objectValues=r=>i.objectKeys(r).map(function(a){return r[a]}),i.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{let a=[];for(let o in r)Object.prototype.hasOwnProperty.call(r,o)&&a.push(o);return a},i.find=(r,a)=>{for(let o of r)if(a(o))return o},i.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&Number.isFinite(r)&&Math.floor(r)===r;function n(r,a=" | "){return r.map(o=>typeof o=="string"?"'".concat(o,"'"):o).join(a)}l(n,"joinValues"),i.joinValues=n,i.jsonStringifyReplacer=(r,a)=>typeof a=="bigint"?a.toString():a})(Ln||(Ln={}));var _I;(function(i){i.mergeShapes=(e,t)=>Me(Me({},e),t)})(_I||(_I={}));var oi=Ln.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),nh=l(i=>{switch(typeof i){case"undefined":return oi.undefined;case"string":return oi.string;case"number":return Number.isNaN(i)?oi.nan:oi.number;case"boolean":return oi.boolean;case"function":return oi.function;case"bigint":return oi.bigint;case"symbol":return oi.symbol;case"object":return Array.isArray(i)?oi.array:i===null?oi.null:i.then&&typeof i.then=="function"&&i.catch&&typeof i.catch=="function"?oi.promise:typeof Map<"u"&&i instanceof Map?oi.map:typeof Set<"u"&&i instanceof Set?oi.set:typeof Date<"u"&&i instanceof Date?oi.date:oi.object;default:return oi.unknown}},"getParsedType"),Pt=Ln.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),aSe=l(i=>JSON.stringify(i,null,2).replace(/"([^"]+)":/g,"$1:"),"quotelessJson"),Gne=class $ne extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(a){return a.message},n={_errors:[]},r=l(a=>{for(let o of a.issues)if(o.code==="invalid_union")o.unionErrors.map(r);else if(o.code==="invalid_return_type")r(o.returnTypeError);else if(o.code==="invalid_arguments")r(o.argumentsError);else if(o.path.length===0)n._errors.push(t(o));else{let s=n,u=0;for(;u<o.path.length;){let h=o.path[u];u===o.path.length-1?(s[h]=s[h]||{_errors:[]},s[h]._errors.push(t(o))):s[h]=s[h]||{_errors:[]},s=s[h],u++}}},"processError");return r(this),n}static assert(e){if(!(e instanceof $ne))throw new Error("Not a ZodError: ".concat(e))}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ln.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){let t={},n=[];for(let r of this.issues)r.path.length>0?(t[r.path[0]]=t[r.path[0]]||[],t[r.path[0]].push(e(r))):n.push(e(r));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}};l(Gne,"ZodError");var yl=Gne;yl.create=i=>new yl(i);var oSe=l((i,e)=>{let t;switch(i.code){case Pt.invalid_type:i.received===oi.undefined?t="Required":t="Expected ".concat(i.expected,", received ").concat(i.received);break;case Pt.invalid_literal:t="Invalid literal value, expected ".concat(JSON.stringify(i.expected,Ln.jsonStringifyReplacer));break;case Pt.unrecognized_keys:t="Unrecognized key(s) in object: ".concat(Ln.joinValues(i.keys,", "));break;case Pt.invalid_union:t="Invalid input";break;case Pt.invalid_union_discriminator:t="Invalid discriminator value. Expected ".concat(Ln.joinValues(i.options));break;case Pt.invalid_enum_value:t="Invalid enum value. Expected ".concat(Ln.joinValues(i.options),", received '").concat(i.received,"'");break;case Pt.invalid_arguments:t="Invalid function arguments";break;case Pt.invalid_return_type:t="Invalid function return type";break;case Pt.invalid_date:t="Invalid date";break;case Pt.invalid_string:typeof i.validation=="object"?"includes"in i.validation?(t='Invalid input: must include "'.concat(i.validation.includes,'"'),typeof i.validation.position=="number"&&(t="".concat(t," at one or more positions greater than or equal to ").concat(i.validation.position))):"startsWith"in i.validation?t='Invalid input: must start with "'.concat(i.validation.startsWith,'"'):"endsWith"in i.validation?t='Invalid input: must end with "'.concat(i.validation.endsWith,'"'):Ln.assertNever(i.validation):i.validation!=="regex"?t="Invalid ".concat(i.validation):t="Invalid";break;case Pt.too_small:i.type==="array"?t="Array must contain ".concat(i.exact?"exactly":i.inclusive?"at least":"more than"," ").concat(i.minimum," element(s)"):i.type==="string"?t="String must contain ".concat(i.exact?"exactly":i.inclusive?"at least":"over"," ").concat(i.minimum," character(s)"):i.type==="number"?t="Number must be ".concat(i.exact?"exactly equal to ":i.inclusive?"greater than or equal to ":"greater than ").concat(i.minimum):i.type==="date"?t="Date must be ".concat(i.exact?"exactly equal to ":i.inclusive?"greater than or equal to ":"greater than ").concat(new Date(Number(i.minimum))):t="Invalid input";break;case Pt.too_big:i.type==="array"?t="Array must contain ".concat(i.exact?"exactly":i.inclusive?"at most":"less than"," ").concat(i.maximum," element(s)"):i.type==="string"?t="String must contain ".concat(i.exact?"exactly":i.inclusive?"at most":"under"," ").concat(i.maximum," character(s)"):i.type==="number"?t="Number must be ".concat(i.exact?"exactly":i.inclusive?"less than or equal to":"less than"," ").concat(i.maximum):i.type==="bigint"?t="BigInt must be ".concat(i.exact?"exactly":i.inclusive?"less than or equal to":"less than"," ").concat(i.maximum):i.type==="date"?t="Date must be ".concat(i.exact?"exactly":i.inclusive?"smaller than or equal to":"smaller than"," ").concat(new Date(Number(i.maximum))):t="Invalid input";break;case Pt.custom:t="Invalid input";break;case Pt.invalid_intersection_types:t="Intersection results could not be merged";break;case Pt.not_multiple_of:t="Number must be a multiple of ".concat(i.multipleOf);break;case Pt.not_finite:t="Number must be finite";break;default:t=e.defaultError,Ln.assertNever(i)}return{message:t}},"errorMap"),Cg=oSe,Hne=Cg;function Wne(i){Hne=i}l(Wne,"setErrorMap");function S1(){return Hne}l(S1,"getErrorMap");R();var Ew=l(i=>{let{data:e,path:t,errorMaps:n,issueData:r}=i,a=[...t,...r.path||[]],o=lt(Me({},r),{path:a});if(r.message!==void 0)return lt(Me({},r),{path:a,message:r.message});let s="",u=n.filter(h=>!!h).slice().reverse();for(let h of u)s=h(o,{data:e,defaultError:s}).message;return lt(Me({},r),{path:a,message:s})},"makeIssue"),sSe=[];function qt(i,e){let t=S1(),n=Ew({issueData:e,data:i.data,path:i.path,errorMaps:[i.common.contextualErrorMap,i.schemaErrorMap,t,t===Cg?void 0:Cg].filter(r=>!!r)});i.common.issues.push(n)}l(qt,"addIssueToContext");var qne=class Xne{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){let n=[];for(let r of t){if(r.status==="aborted")return zi;r.status==="dirty"&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){let n=[];for(let r of t){let a=await r.key,o=await r.value;n.push({key:a,value:o})}return Xne.mergeObjectSync(e,n)}static mergeObjectSync(e,t){let n={};for(let r of t){let{key:a,value:o}=r;if(a.status==="aborted"||o.status==="aborted")return zi;a.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof o.value<"u"||r.alwaysSet)&&(n[a.value]=o.value)}return{status:e.value,value:n}}};l(qne,"ParseStatus");var Xo=qne,zi=Object.freeze({status:"aborted"}),Em=l(i=>({status:"dirty",value:i}),"DIRTY"),To=l(i=>({status:"valid",value:i}),"OK"),xI=l(i=>i.status==="aborted","isAborted"),bI=l(i=>i.status==="dirty","isDirty"),Ad=l(i=>i.status==="valid","isValid"),M1=l(i=>typeof Promise<"u"&&i instanceof Promise,"isAsync");R();R();R();var Si;(function(i){i.errToObj=e=>typeof e=="string"?{message:e}:e||{},i.toString=e=>typeof e=="string"?e:e?.message})(Si||(Si={}));var Zne=class{constructor(e,t,n,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=r}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}};l(Zne,"ParseInputLazyPath");var cu=Zne,jR=l((i,e)=>{if(Ad(e))return{success:!0,data:e.value};if(!i.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new yl(i.common.issues);return this._error=t,this._error}}},"handleResult");function Ji(i){if(!i)return{};let{errorMap:e,invalid_type_error:t,required_error:n,description:r}=i;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:l((a,o)=>{var s,u;let{message:h}=i;return a.code==="invalid_enum_value"?{message:h??o.defaultError}:typeof o.data>"u"?{message:(s=h??n)!=null?s:o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:(u=h??t)!=null?u:o.defaultError}},"customMap"),description:r}}l(Ji,"processCreateParams");var Yne=class{get description(){return this._def.description}_getType(e){return nh(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:nh(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Xo,ctx:{common:e.parent.common,data:e.data,parsedType:nh(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(M1(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){let t=this._parse(e);return Promise.resolve(t)}parse(e,t){let n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;let r={common:{issues:[],async:(n=t?.async)!=null?n:!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:nh(e)},a=this._parseSync({data:e,path:r.path,parent:r});return jR(r,a)}"~validate"(e){var t,n;let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:nh(e)};if(!this["~standard"].async)try{let a=this._parseSync({data:e,path:[],parent:r});return Ad(a)?{value:a.value}:{issues:r.common.issues}}catch(a){(n=(t=a?.message)==null?void 0:t.toLowerCase())!=null&&n.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(a=>Ad(a)?{value:a.value}:{issues:r.common.issues})}async parseAsync(e,t){let n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){let n={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:nh(e)},r=this._parse({data:e,path:n.path,parent:n}),a=await(M1(r)?r:Promise.resolve(r));return jR(n,a)}refine(e,t){let n=l(r=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(r):t,"getIssueProperties");return this._refinement((r,a)=>{let o=e(r),s=l(()=>a.addIssue(Me({code:Pt.custom},n(r))),"setError");return typeof Promise<"u"&&o instanceof Promise?o.then(u=>u?!0:(s(),!1)):o?!0:(s(),!1)})}refinement(e,t){return this._refinement((n,r)=>e(n)?!0:(r.addIssue(typeof t=="function"?t(n,r):t),!1))}_refinement(e){return new bl({schema:this,typeName:Ui.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:l(t=>this["~validate"](t),"validate")}}optional(){return au.create(this,this._def)}nullable(){return $c.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Sd.create(this)}promise(){return Tg.create(this,this._def)}or(e){return D1.create([this,e],this._def)}and(e){return k1.create(this,e,this._def)}transform(e){return new bl(lt(Me({},Ji(this._def)),{schema:this,typeName:Ui.ZodEffects,effect:{type:"transform",transform:e}}))}default(e){let t=typeof e=="function"?e:()=>e;return new F1(lt(Me({},Ji(this._def)),{innerType:this,defaultValue:t,typeName:Ui.ZodDefault}))}brand(){return new RD(Me({typeName:Ui.ZodBranded,type:this},Ji(this._def)))}catch(e){let t=typeof e=="function"?e:()=>e;return new B1(lt(Me({},Ji(this._def)),{innerType:this,catchValue:t,typeName:Ui.ZodCatch}))}describe(e){let t=this.constructor;return new t(lt(Me({},this._def),{description:e}))}pipe(e){return OD.create(this,e)}readonly(){return z1.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}};l(Yne,"ZodType");var un=Yne,lSe=/^c[^\s-]{8,}$/i,uSe=/^[0-9a-z]+$/,hSe=/^[0-9A-HJKMNP-TV-Z]{26}$/i,cSe=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,pSe=/^[a-z0-9_-]{21}$/i,dSe=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,fSe=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,mSe=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,gSe="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",fM,ySe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,vSe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,_Se=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,xSe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,bSe=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,wSe=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Jne="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",ASe=new RegExp("^".concat(Jne,"$"));function LD(i){let e="[0-5]\\d";i.precision?e="".concat(e,"\\.\\d{").concat(i.precision,"}"):i.precision==null&&(e="".concat(e,"(\\.\\d+)?"));let t=i.precision?"+":"?";return"([01]\\d|2[0-3]):[0-5]\\d(:".concat(e,")").concat(t)}l(LD,"timeRegexSource");function Kne(i){return new RegExp("^".concat(LD(i),"$"))}l(Kne,"timeRegex");function DD(i){let e="".concat(Jne,"T").concat(LD(i)),t=[];return t.push(i.local?"Z?":"Z"),i.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e="".concat(e,"(").concat(t.join("|"),")"),new RegExp("^".concat(e,"$"))}l(DD,"datetimeRegex");function Qne(i,e){return!!((e==="v4"||!e)&&ySe.test(i)||(e==="v6"||!e)&&_Se.test(i))}l(Qne,"isValidIP");function ere(i,e){if(!dSe.test(i))return!1;try{let[t]=i.split("."),n=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),r=JSON.parse(atob(n));return!(typeof r!="object"||r===null||"typ"in r&&r?.typ!=="JWT"||!r.alg||e&&r.alg!==e)}catch{return!1}}l(ere,"isValidJWT");function tre(i,e){return!!((e==="v4"||!e)&&vSe.test(i)||(e==="v6"||!e)&&xSe.test(i))}l(tre,"isValidCidr");var ire=class cv extends un{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==oi.string){let r=this._getOrReturnCtx(e);return qt(r,{code:Pt.invalid_type,expected:oi.string,received:r.parsedType}),zi}let t=new Xo,n;for(let r of this._def.checks)if(r.kind==="min")e.data.length<r.value&&(n=this._getOrReturnCtx(e,n),qt(n,{code:Pt.too_small,minimum:r.value,type:"string",inclusive:!0,exact:!1,message:r.message}),t.dirty());else if(r.kind==="max")e.data.length>r.value&&(n=this._getOrReturnCtx(e,n),qt(n,{code:Pt.too_big,maximum:r.value,type:"string",inclusive:!0,exact:!1,message:r.message}),t.dirty());else if(r.kind==="length"){let a=e.data.length>r.value,o=e.data.length<r.value;(a||o)&&(n=this._getOrReturnCtx(e,n),a?qt(n,{code:Pt.too_big,maximum:r.value,type:"string",inclusive:!0,exact:!0,message:r.message}):o&&qt(n,{code:Pt.too_small,minimum:r.value,type:"string",inclusive:!0,exact:!0,message:r.message}),t.dirty())}else if(r.kind==="email")mSe.test(e.data)||(n=this._getOrReturnCtx(e,n),qt(n,{validation:"email",code:Pt.invalid_string,message:r.message}),t.dirty());else if(r.kind==="emoji")fM||(fM=new RegExp(gSe,"u")),fM.test(e.data)||(n=this._getOrReturnCtx(e,n),qt(n,{validation:"emoji",code:Pt.invalid_string,message:r.message}),t.dirty());else if(r.kind==="uuid")cSe.test(e.data)||(n=this._getOrReturnCtx(e,n),qt(n,{validation:"uuid",code:Pt.invalid_string,message:r.message}),t.dirty());else if(r.kind==="nanoid")pSe.test(e.data)||(n=this._getOrReturnCtx(e,n),qt(n,{validation:"nanoid",code:Pt.invalid_string,message:r.message}),t.dirty());else if(r.kind==="cuid")lSe.test(e.data)||(n=this._getOrReturnCtx(e,n),qt(n,{validation:"cuid",code:Pt.invalid_string,message:r.message}),t.dirty());else if(r.kind==="cuid2")uSe.test(e.data)||(n=this._getOrReturnCtx(e,n),qt(n,{validation:"cuid2",code:Pt.invalid_string,message:r.message}),t.dirty());else if(r.kind==="ulid")hSe.test(e.data)||(n=this._getOrReturnCtx(e,n),qt(n,{validation:"ulid",code:Pt.invalid_string,message:r.message}),t.dirty());else if(r.kind==="url")try{new URL(e.data)}catch{n=this._getOrReturnCtx(e,n),qt(n,{validation:"url",code:Pt.invalid_string,message:r.message}),t.dirty()}else r.kind==="regex"?(r.regex.lastIndex=0,r.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),qt(n,{validation:"regex",code:Pt.invalid_string,message:r.message}),t.dirty())):r.kind==="trim"?e.data=e.data.trim():r.kind==="includes"?e.data.includes(r.value,r.position)||(n=this._getOrReturnCtx(e,n),qt(n,{code:Pt.invalid_string,validation:{includes:r.value,position:r.position},message:r.message}),t.dirty()):r.kind==="toLowerCase"?e.data=e.data.toLowerCase():r.kind==="toUpperCase"?e.data=e.data.toUpperCase():r.kind==="startsWith"?e.data.startsWith(r.value)||(n=this._getOrReturnCtx(e,n),qt(n,{code:Pt.invalid_string,validation:{startsWith:r.value},message:r.message}),t.dirty()):r.kind==="endsWith"?e.data.endsWith(r.value)||(n=this._getOrReturnCtx(e,n),qt(n,{code:Pt.invalid_string,validation:{endsWith:r.value},message:r.message}),t.dirty()):r.kind==="datetime"?DD(r).test(e.data)||(n=this._getOrReturnCtx(e,n),qt(n,{code:Pt.invalid_string,validation:"datetime",message:r.message}),t.dirty()):r.kind==="date"?ASe.test(e.data)||(n=this._getOrReturnCtx(e,n),qt(n,{code:Pt.invalid_string,validation:"date",message:r.message}),t.dirty()):r.kind==="time"?Kne(r).test(e.data)||(n=this._getOrReturnCtx(e,n),qt(n,{code:Pt.invalid_string,validation:"time",message:r.message}),t.dirty()):r.kind==="duration"?fSe.test(e.data)||(n=this._getOrReturnCtx(e,n),qt(n,{validation:"duration",code:Pt.invalid_string,message:r.message}),t.dirty()):r.kind==="ip"?Qne(e.data,r.version)||(n=this._getOrReturnCtx(e,n),qt(n,{validation:"ip",code:Pt.invalid_string,message:r.message}),t.dirty()):r.kind==="jwt"?ere(e.data,r.alg)||(n=this._getOrReturnCtx(e,n),qt(n,{validation:"jwt",code:Pt.invalid_string,message:r.message}),t.dirty()):r.kind==="cidr"?tre(e.data,r.version)||(n=this._getOrReturnCtx(e,n),qt(n,{validation:"cidr",code:Pt.invalid_string,message:r.message}),t.dirty()):r.kind==="base64"?bSe.test(e.data)||(n=this._getOrReturnCtx(e,n),qt(n,{validation:"base64",code:Pt.invalid_string,message:r.message}),t.dirty()):r.kind==="base64url"?wSe.test(e.data)||(n=this._getOrReturnCtx(e,n),qt(n,{validation:"base64url",code:Pt.invalid_string,message:r.message}),t.dirty()):Ln.assertNever(r);return{status:t.value,value:e.data}}_regex(e,t,n){return this.refinement(r=>e.test(r),Me({validation:t,code:Pt.invalid_string},Si.errToObj(n)))}_addCheck(e){return new cv(lt(Me({},this._def),{checks:[...this._def.checks,e]}))}email(e){return this._addCheck(Me({kind:"email"},Si.errToObj(e)))}url(e){return this._addCheck(Me({kind:"url"},Si.errToObj(e)))}emoji(e){return this._addCheck(Me({kind:"emoji"},Si.errToObj(e)))}uuid(e){return this._addCheck(Me({kind:"uuid"},Si.errToObj(e)))}nanoid(e){return this._addCheck(Me({kind:"nanoid"},Si.errToObj(e)))}cuid(e){return this._addCheck(Me({kind:"cuid"},Si.errToObj(e)))}cuid2(e){return this._addCheck(Me({kind:"cuid2"},Si.errToObj(e)))}ulid(e){return this._addCheck(Me({kind:"ulid"},Si.errToObj(e)))}base64(e){return this._addCheck(Me({kind:"base64"},Si.errToObj(e)))}base64url(e){return this._addCheck(Me({kind:"base64url"},Si.errToObj(e)))}jwt(e){return this._addCheck(Me({kind:"jwt"},Si.errToObj(e)))}ip(e){return this._addCheck(Me({kind:"ip"},Si.errToObj(e)))}cidr(e){return this._addCheck(Me({kind:"cidr"},Si.errToObj(e)))}datetime(e){var t,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck(Me({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(t=e?.offset)!=null?t:!1,local:(n=e?.local)!=null?n:!1},Si.errToObj(e?.message)))}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck(Me({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision},Si.errToObj(e?.message)))}duration(e){return this._addCheck(Me({kind:"duration"},Si.errToObj(e)))}regex(e,t){return this._addCheck(Me({kind:"regex",regex:e},Si.errToObj(t)))}includes(e,t){return this._addCheck(Me({kind:"includes",value:e,position:t?.position},Si.errToObj(t?.message)))}startsWith(e,t){return this._addCheck(Me({kind:"startsWith",value:e},Si.errToObj(t)))}endsWith(e,t){return this._addCheck(Me({kind:"endsWith",value:e},Si.errToObj(t)))}min(e,t){return this._addCheck(Me({kind:"min",value:e},Si.errToObj(t)))}max(e,t){return this._addCheck(Me({kind:"max",value:e},Si.errToObj(t)))}length(e,t){return this._addCheck(Me({kind:"length",value:e},Si.errToObj(t)))}nonempty(e){return this.min(1,Si.errToObj(e))}trim(){return new cv(lt(Me({},this._def),{checks:[...this._def.checks,{kind:"trim"}]}))}toLowerCase(){return new cv(lt(Me({},this._def),{checks:[...this._def.checks,{kind:"toLowerCase"}]}))}toUpperCase(){return new cv(lt(Me({},this._def),{checks:[...this._def.checks,{kind:"toUpperCase"}]}))}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};l(ire,"ZodString");var Eg=ire;Eg.create=i=>{var e;return new Eg(Me({checks:[],typeName:Ui.ZodString,coerce:(e=i?.coerce)!=null?e:!1},Ji(i)))};function nre(i,e){let t=(i.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,r=t>n?t:n,a=Number.parseInt(i.toFixed(r).replace(".","")),o=Number.parseInt(e.toFixed(r).replace(".",""));return a%o/10**r}l(nre,"floatSafeRemainder");var rre=class wI extends un{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==oi.number){let r=this._getOrReturnCtx(e);return qt(r,{code:Pt.invalid_type,expected:oi.number,received:r.parsedType}),zi}let t,n=new Xo;for(let r of this._def.checks)r.kind==="int"?Ln.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),qt(t,{code:Pt.invalid_type,expected:"integer",received:"float",message:r.message}),n.dirty()):r.kind==="min"?(r.inclusive?e.data<r.value:e.data<=r.value)&&(t=this._getOrReturnCtx(e,t),qt(t,{code:Pt.too_small,minimum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),n.dirty()):r.kind==="max"?(r.inclusive?e.data>r.value:e.data>=r.value)&&(t=this._getOrReturnCtx(e,t),qt(t,{code:Pt.too_big,maximum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),n.dirty()):r.kind==="multipleOf"?nre(e.data,r.value)!==0&&(t=this._getOrReturnCtx(e,t),qt(t,{code:Pt.not_multiple_of,multipleOf:r.value,message:r.message}),n.dirty()):r.kind==="finite"?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),qt(t,{code:Pt.not_finite,message:r.message}),n.dirty()):Ln.assertNever(r);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Si.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Si.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Si.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Si.toString(t))}setLimit(e,t,n,r){return new wI(lt(Me({},this._def),{checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:Si.toString(r)}]}))}_addCheck(e){return new wI(lt(Me({},this._def),{checks:[...this._def.checks,e]}))}int(e){return this._addCheck({kind:"int",message:Si.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Si.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Si.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Si.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Si.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Si.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:Si.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Si.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Si.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Ln.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}};l(rre,"ZodNumber");var C1=rre;C1.create=i=>new C1(Me({checks:[],typeName:Ui.ZodNumber,coerce:i?.coerce||!1},Ji(i)));var are=class AI extends un{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==oi.bigint)return this._getInvalidInput(e);let t,n=new Xo;for(let r of this._def.checks)r.kind==="min"?(r.inclusive?e.data<r.value:e.data<=r.value)&&(t=this._getOrReturnCtx(e,t),qt(t,{code:Pt.too_small,type:"bigint",minimum:r.value,inclusive:r.inclusive,message:r.message}),n.dirty()):r.kind==="max"?(r.inclusive?e.data>r.value:e.data>=r.value)&&(t=this._getOrReturnCtx(e,t),qt(t,{code:Pt.too_big,type:"bigint",maximum:r.value,inclusive:r.inclusive,message:r.message}),n.dirty()):r.kind==="multipleOf"?e.data%r.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),qt(t,{code:Pt.not_multiple_of,multipleOf:r.value,message:r.message}),n.dirty()):Ln.assertNever(r);return{status:n.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return qt(t,{code:Pt.invalid_type,expected:oi.bigint,received:t.parsedType}),zi}gte(e,t){return this.setLimit("min",e,!0,Si.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Si.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Si.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Si.toString(t))}setLimit(e,t,n,r){return new AI(lt(Me({},this._def),{checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:Si.toString(r)}]}))}_addCheck(e){return new AI(lt(Me({},this._def),{checks:[...this._def.checks,e]}))}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Si.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Si.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Si.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Si.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Si.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};l(are,"ZodBigInt");var E1=are;E1.create=i=>{var e;return new E1(Me({checks:[],typeName:Ui.ZodBigInt,coerce:(e=i?.coerce)!=null?e:!1},Ji(i)))};var ore=class extends un{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==oi.boolean){let t=this._getOrReturnCtx(e);return qt(t,{code:Pt.invalid_type,expected:oi.boolean,received:t.parsedType}),zi}return To(e.data)}};l(ore,"ZodBoolean");var I1=ore;I1.create=i=>new I1(Me({typeName:Ui.ZodBoolean,coerce:i?.coerce||!1},Ji(i)));var sre=class lre extends un{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==oi.date){let r=this._getOrReturnCtx(e);return qt(r,{code:Pt.invalid_type,expected:oi.date,received:r.parsedType}),zi}if(Number.isNaN(e.data.getTime())){let r=this._getOrReturnCtx(e);return qt(r,{code:Pt.invalid_date}),zi}let t=new Xo,n;for(let r of this._def.checks)r.kind==="min"?e.data.getTime()<r.value&&(n=this._getOrReturnCtx(e,n),qt(n,{code:Pt.too_small,message:r.message,inclusive:!0,exact:!1,minimum:r.value,type:"date"}),t.dirty()):r.kind==="max"?e.data.getTime()>r.value&&(n=this._getOrReturnCtx(e,n),qt(n,{code:Pt.too_big,message:r.message,inclusive:!0,exact:!1,maximum:r.value,type:"date"}),t.dirty()):Ln.assertNever(r);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new lre(lt(Me({},this._def),{checks:[...this._def.checks,e]}))}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:Si.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:Si.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}};l(sre,"ZodDate");var T1=sre;T1.create=i=>new T1(Me({checks:[],coerce:i?.coerce||!1,typeName:Ui.ZodDate},Ji(i)));var ure=class extends un{_parse(e){if(this._getType(e)!==oi.symbol){let t=this._getOrReturnCtx(e);return qt(t,{code:Pt.invalid_type,expected:oi.symbol,received:t.parsedType}),zi}return To(e.data)}};l(ure,"ZodSymbol");var Iw=ure;Iw.create=i=>new Iw(Me({typeName:Ui.ZodSymbol},Ji(i)));var hre=class extends un{_parse(e){if(this._getType(e)!==oi.undefined){let t=this._getOrReturnCtx(e);return qt(t,{code:Pt.invalid_type,expected:oi.undefined,received:t.parsedType}),zi}return To(e.data)}};l(hre,"ZodUndefined");var P1=hre;P1.create=i=>new P1(Me({typeName:Ui.ZodUndefined},Ji(i)));var cre=class extends un{_parse(e){if(this._getType(e)!==oi.null){let t=this._getOrReturnCtx(e);return qt(t,{code:Pt.invalid_type,expected:oi.null,received:t.parsedType}),zi}return To(e.data)}};l(cre,"ZodNull");var L1=cre;L1.create=i=>new L1(Me({typeName:Ui.ZodNull},Ji(i)));var pre=class extends un{constructor(){super(...arguments),this._any=!0}_parse(e){return To(e.data)}};l(pre,"ZodAny");var Ig=pre;Ig.create=i=>new Ig(Me({typeName:Ui.ZodAny},Ji(i)));var dre=class extends un{constructor(){super(...arguments),this._unknown=!0}_parse(e){return To(e.data)}};l(dre,"ZodUnknown");var hd=dre;hd.create=i=>new hd(Me({typeName:Ui.ZodUnknown},Ji(i)));var fre=class extends un{_parse(e){let t=this._getOrReturnCtx(e);return qt(t,{code:Pt.invalid_type,expected:oi.never,received:t.parsedType}),zi}};l(fre,"ZodNever");var vh=fre;vh.create=i=>new vh(Me({typeName:Ui.ZodNever},Ji(i)));var mre=class extends un{_parse(e){if(this._getType(e)!==oi.undefined){let t=this._getOrReturnCtx(e);return qt(t,{code:Pt.invalid_type,expected:oi.void,received:t.parsedType}),zi}return To(e.data)}};l(mre,"ZodVoid");var Tw=mre;Tw.create=i=>new Tw(Me({typeName:Ui.ZodVoid},Ji(i)));var gre=class hb extends un{_parse(e){let{ctx:t,status:n}=this._processInputParams(e),r=this._def;if(t.parsedType!==oi.array)return qt(t,{code:Pt.invalid_type,expected:oi.array,received:t.parsedType}),zi;if(r.exactLength!==null){let o=t.data.length>r.exactLength.value,s=t.data.length<r.exactLength.value;(o||s)&&(qt(t,{code:o?Pt.too_big:Pt.too_small,minimum:s?r.exactLength.value:void 0,maximum:o?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),n.dirty())}if(r.minLength!==null&&t.data.length<r.minLength.value&&(qt(t,{code:Pt.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),n.dirty()),r.maxLength!==null&&t.data.length>r.maxLength.value&&(qt(t,{code:Pt.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((o,s)=>r.type._parseAsync(new cu(t,o,t.path,s)))).then(o=>Xo.mergeArray(n,o));let a=[...t.data].map((o,s)=>r.type._parseSync(new cu(t,o,t.path,s)));return Xo.mergeArray(n,a)}get element(){return this._def.type}min(e,t){return new hb(lt(Me({},this._def),{minLength:{value:e,message:Si.toString(t)}}))}max(e,t){return new hb(lt(Me({},this._def),{maxLength:{value:e,message:Si.toString(t)}}))}length(e,t){return new hb(lt(Me({},this._def),{exactLength:{value:e,message:Si.toString(t)}}))}nonempty(e){return this.min(1,e)}};l(gre,"ZodArray");var Sd=gre;Sd.create=(i,e)=>new Sd(Me({type:i,minLength:null,maxLength:null,exactLength:null,typeName:Ui.ZodArray},Ji(e)));function $p(i){if(i instanceof zs){let e={};for(let t in i.shape){let n=i.shape[t];e[t]=au.create($p(n))}return new zs(lt(Me({},i._def),{shape:l(()=>e,"shape")}))}else return i instanceof Sd?new Sd(lt(Me({},i._def),{type:$p(i.element)})):i instanceof au?au.create($p(i.unwrap())):i instanceof $c?$c.create($p(i.unwrap())):i instanceof Gc?Gc.create(i.items.map(e=>$p(e))):i}l($p,"deepPartialify");var yre=class rl extends un{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),t=Ln.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==oi.object){let u=this._getOrReturnCtx(e);return qt(u,{code:Pt.invalid_type,expected:oi.object,received:u.parsedType}),zi}let{status:t,ctx:n}=this._processInputParams(e),{shape:r,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof vh&&this._def.unknownKeys==="strip"))for(let u in n.data)a.includes(u)||o.push(u);let s=[];for(let u of a){let h=r[u],d=n.data[u];s.push({key:{status:"valid",value:u},value:h._parse(new cu(n,d,n.path,u)),alwaysSet:u in n.data})}if(this._def.catchall instanceof vh){let u=this._def.unknownKeys;if(u==="passthrough")for(let h of o)s.push({key:{status:"valid",value:h},value:{status:"valid",value:n.data[h]}});else if(u==="strict")o.length>0&&(qt(n,{code:Pt.unrecognized_keys,keys:o}),t.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let h of o){let d=n.data[h];s.push({key:{status:"valid",value:h},value:u._parse(new cu(n,d,n.path,h)),alwaysSet:h in n.data})}}return n.common.async?Promise.resolve().then(async()=>{let u=[];for(let h of s){let d=await h.key,f=await h.value;u.push({key:d,value:f,alwaysSet:h.alwaysSet})}return u}).then(u=>Xo.mergeObjectSync(t,u)):Xo.mergeObjectSync(t,s)}get shape(){return this._def.shape()}strict(e){return Si.errToObj,new rl(Me(lt(Me({},this._def),{unknownKeys:"strict"}),e!==void 0?{errorMap:l((t,n)=>{var r,a,o,s;let u=(o=(a=(r=this._def).errorMap)==null?void 0:a.call(r,t,n).message)!=null?o:n.defaultError;return t.code==="unrecognized_keys"?{message:(s=Si.errToObj(e).message)!=null?s:u}:{message:u}},"errorMap")}:{}))}strip(){return new rl(lt(Me({},this._def),{unknownKeys:"strip"}))}passthrough(){return new rl(lt(Me({},this._def),{unknownKeys:"passthrough"}))}extend(e){return new rl(lt(Me({},this._def),{shape:l(()=>Me(Me({},this._def.shape()),e),"shape")}))}merge(e){return new rl({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:l(()=>Me(Me({},this._def.shape()),e._def.shape()),"shape"),typeName:Ui.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new rl(lt(Me({},this._def),{catchall:e}))}pick(e){let t={};for(let n of Ln.objectKeys(e))e[n]&&this.shape[n]&&(t[n]=this.shape[n]);return new rl(lt(Me({},this._def),{shape:l(()=>t,"shape")}))}omit(e){let t={};for(let n of Ln.objectKeys(this.shape))e[n]||(t[n]=this.shape[n]);return new rl(lt(Me({},this._def),{shape:l(()=>t,"shape")}))}deepPartial(){return $p(this)}partial(e){let t={};for(let n of Ln.objectKeys(this.shape)){let r=this.shape[n];e&&!e[n]?t[n]=r:t[n]=r.optional()}return new rl(lt(Me({},this._def),{shape:l(()=>t,"shape")}))}required(e){let t={};for(let n of Ln.objectKeys(this.shape))if(e&&!e[n])t[n]=this.shape[n];else{let r=this.shape[n];for(;r instanceof au;)r=r._def.innerType;t[n]=r}return new rl(lt(Me({},this._def),{shape:l(()=>t,"shape")}))}keyof(){return kD(Ln.objectKeys(this.shape))}};l(yre,"ZodObject");var zs=yre;zs.create=(i,e)=>new zs(Me({shape:l(()=>i,"shape"),unknownKeys:"strip",catchall:vh.create(),typeName:Ui.ZodObject},Ji(e)));zs.strictCreate=(i,e)=>new zs(Me({shape:l(()=>i,"shape"),unknownKeys:"strict",catchall:vh.create(),typeName:Ui.ZodObject},Ji(e)));zs.lazycreate=(i,e)=>new zs(Me({shape:i,unknownKeys:"strip",catchall:vh.create(),typeName:Ui.ZodObject},Ji(e)));var vre=class extends un{_parse(e){let{ctx:t}=this._processInputParams(e),n=this._def.options;function r(a){for(let s of a)if(s.result.status==="valid")return s.result;for(let s of a)if(s.result.status==="dirty")return t.common.issues.push(...s.ctx.common.issues),s.result;let o=a.map(s=>new yl(s.ctx.common.issues));return qt(t,{code:Pt.invalid_union,unionErrors:o}),zi}if(l(r,"handleResults"),t.common.async)return Promise.all(n.map(async a=>{let o=lt(Me({},t),{common:lt(Me({},t.common),{issues:[]}),parent:null});return{result:await a._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(r);{let a,o=[];for(let u of n){let h=lt(Me({},t),{common:lt(Me({},t.common),{issues:[]}),parent:null}),d=u._parseSync({data:t.data,path:t.path,parent:h});if(d.status==="valid")return d;d.status==="dirty"&&!a&&(a={result:d,ctx:h}),h.common.issues.length&&o.push(h.common.issues)}if(a)return t.common.issues.push(...a.ctx.common.issues),a.result;let s=o.map(u=>new yl(u));return qt(t,{code:Pt.invalid_union,unionErrors:s}),zi}}get options(){return this._def.options}};l(vre,"ZodUnion");var D1=vre;D1.create=(i,e)=>new D1(Me({options:i,typeName:Ui.ZodUnion},Ji(e)));var ec=l(i=>i instanceof R1?ec(i.schema):i instanceof bl?ec(i.innerType()):i instanceof O1?[i.value]:i instanceof C0?i.options:i instanceof N1?Ln.objectValues(i.enum):i instanceof F1?ec(i._def.innerType):i instanceof P1?[void 0]:i instanceof L1?[null]:i instanceof au?[void 0,...ec(i.unwrap())]:i instanceof $c?[null,...ec(i.unwrap())]:i instanceof RD||i instanceof z1?ec(i.unwrap()):i instanceof B1?ec(i._def.innerType):[],"getDiscriminator"),_re=class xre extends un{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==oi.object)return qt(t,{code:Pt.invalid_type,expected:oi.object,received:t.parsedType}),zi;let n=this.discriminator,r=t.data[n],a=this.optionsMap.get(r);return a?t.common.async?a._parseAsync({data:t.data,path:t.path,parent:t}):a._parseSync({data:t.data,path:t.path,parent:t}):(qt(t,{code:Pt.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),zi)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){let r=new Map;for(let a of t){let o=ec(a.shape[e]);if(!o.length)throw new Error("A discriminator value for key `".concat(e,"` could not be extracted from all schema options"));for(let s of o){if(r.has(s))throw new Error("Discriminator property ".concat(String(e)," has duplicate value ").concat(String(s)));r.set(s,a)}}return new xre(Me({typeName:Ui.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:r},Ji(n)))}};l(_re,"ZodDiscriminatedUnion");var bre=_re;function Pw(i,e){let t=nh(i),n=nh(e);if(i===e)return{valid:!0,data:i};if(t===oi.object&&n===oi.object){let r=Ln.objectKeys(e),a=Ln.objectKeys(i).filter(s=>r.indexOf(s)!==-1),o=Me(Me({},i),e);for(let s of a){let u=Pw(i[s],e[s]);if(!u.valid)return{valid:!1};o[s]=u.data}return{valid:!0,data:o}}else if(t===oi.array&&n===oi.array){if(i.length!==e.length)return{valid:!1};let r=[];for(let a=0;a<i.length;a++){let o=i[a],s=e[a],u=Pw(o,s);if(!u.valid)return{valid:!1};r.push(u.data)}return{valid:!0,data:r}}else return t===oi.date&&n===oi.date&&+i==+e?{valid:!0,data:i}:{valid:!1}}l(Pw,"mergeValues");var wre=class extends un{_parse(e){let{status:t,ctx:n}=this._processInputParams(e),r=l((a,o)=>{if(xI(a)||xI(o))return zi;let s=Pw(a.value,o.value);return s.valid?((bI(a)||bI(o))&&t.dirty(),{status:t.value,value:s.data}):(qt(n,{code:Pt.invalid_intersection_types}),zi)},"handleParsed");return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([a,o])=>r(a,o)):r(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};l(wre,"ZodIntersection");var k1=wre;k1.create=(i,e,t)=>new k1(Me({left:i,right:e,typeName:Ui.ZodIntersection},Ji(t)));var Are=class Sre extends un{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==oi.array)return qt(n,{code:Pt.invalid_type,expected:oi.array,received:n.parsedType}),zi;if(n.data.length<this._def.items.length)return qt(n,{code:Pt.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),zi;!this._def.rest&&n.data.length>this._def.items.length&&(qt(n,{code:Pt.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let r=[...n.data].map((a,o)=>{let s=this._def.items[o]||this._def.rest;return s?s._parse(new cu(n,a,n.path,o)):null}).filter(a=>!!a);return n.common.async?Promise.all(r).then(a=>Xo.mergeArray(t,a)):Xo.mergeArray(t,r)}get items(){return this._def.items}rest(e){return new Sre(lt(Me({},this._def),{rest:e}))}};l(Are,"ZodTuple");var Gc=Are;Gc.create=(i,e)=>{if(!Array.isArray(i))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Gc(Me({items:i,typeName:Ui.ZodTuple,rest:null},Ji(e)))};var Mre=class SI extends un{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==oi.object)return qt(n,{code:Pt.invalid_type,expected:oi.object,received:n.parsedType}),zi;let r=[],a=this._def.keyType,o=this._def.valueType;for(let s in n.data)r.push({key:a._parse(new cu(n,s,n.path,s)),value:o._parse(new cu(n,n.data[s],n.path,s)),alwaysSet:s in n.data});return n.common.async?Xo.mergeObjectAsync(t,r):Xo.mergeObjectSync(t,r)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof un?new SI(Me({keyType:e,valueType:t,typeName:Ui.ZodRecord},Ji(n))):new SI(Me({keyType:Eg.create(),valueType:e,typeName:Ui.ZodRecord},Ji(t)))}};l(Mre,"ZodRecord");var Cre=Mre,Ere=class extends un{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==oi.map)return qt(n,{code:Pt.invalid_type,expected:oi.map,received:n.parsedType}),zi;let r=this._def.keyType,a=this._def.valueType,o=[...n.data.entries()].map(([s,u],h)=>({key:r._parse(new cu(n,s,n.path,[h,"key"])),value:a._parse(new cu(n,u,n.path,[h,"value"]))}));if(n.common.async){let s=new Map;return Promise.resolve().then(async()=>{for(let u of o){let h=await u.key,d=await u.value;if(h.status==="aborted"||d.status==="aborted")return zi;(h.status==="dirty"||d.status==="dirty")&&t.dirty(),s.set(h.value,d.value)}return{status:t.value,value:s}})}else{let s=new Map;for(let u of o){let h=u.key,d=u.value;if(h.status==="aborted"||d.status==="aborted")return zi;(h.status==="dirty"||d.status==="dirty")&&t.dirty(),s.set(h.value,d.value)}return{status:t.value,value:s}}}};l(Ere,"ZodMap");var Lw=Ere;Lw.create=(i,e,t)=>new Lw(Me({valueType:e,keyType:i,typeName:Ui.ZodMap},Ji(t)));var Ire=class MI extends un{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==oi.set)return qt(n,{code:Pt.invalid_type,expected:oi.set,received:n.parsedType}),zi;let r=this._def;r.minSize!==null&&n.data.size<r.minSize.value&&(qt(n,{code:Pt.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),t.dirty()),r.maxSize!==null&&n.data.size>r.maxSize.value&&(qt(n,{code:Pt.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),t.dirty());let a=this._def.valueType;function o(u){let h=new Set;for(let d of u){if(d.status==="aborted")return zi;d.status==="dirty"&&t.dirty(),h.add(d.value)}return{status:t.value,value:h}}l(o,"finalizeSet");let s=[...n.data.values()].map((u,h)=>a._parse(new cu(n,u,n.path,h)));return n.common.async?Promise.all(s).then(u=>o(u)):o(s)}min(e,t){return new MI(lt(Me({},this._def),{minSize:{value:e,message:Si.toString(t)}}))}max(e,t){return new MI(lt(Me({},this._def),{maxSize:{value:e,message:Si.toString(t)}}))}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}};l(Ire,"ZodSet");var Dw=Ire;Dw.create=(i,e)=>new Dw(Me({valueType:i,minSize:null,maxSize:null,typeName:Ui.ZodSet},Ji(e)));var Tre=class cb extends un{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==oi.function)return qt(t,{code:Pt.invalid_type,expected:oi.function,received:t.parsedType}),zi;function n(s,u){return Ew({data:s,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,S1(),Cg].filter(h=>!!h),issueData:{code:Pt.invalid_arguments,argumentsError:u}})}l(n,"makeArgsIssue");function r(s,u){return Ew({data:s,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,S1(),Cg].filter(h=>!!h),issueData:{code:Pt.invalid_return_type,returnTypeError:u}})}l(r,"makeReturnsIssue");let a={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof Tg){let s=this;return To(async function(...u){let h=new yl([]),d=await s._def.args.parseAsync(u,a).catch(m=>{throw h.addIssue(n(u,m)),h}),f=await Reflect.apply(o,this,d);return await s._def.returns._def.type.parseAsync(f,a).catch(m=>{throw h.addIssue(r(f,m)),h})})}else{let s=this;return To(function(...u){let h=s._def.args.safeParse(u,a);if(!h.success)throw new yl([n(u,h.error)]);let d=Reflect.apply(o,this,h.data),f=s._def.returns.safeParse(d,a);if(!f.success)throw new yl([r(d,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new cb(lt(Me({},this._def),{args:Gc.create(e).rest(hd.create())}))}returns(e){return new cb(lt(Me({},this._def),{returns:e}))}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new cb(Me({args:e||Gc.create([]).rest(hd.create()),returns:t||hd.create(),typeName:Ui.ZodFunction},Ji(n)))}};l(Tre,"ZodFunction");var Pre=Tre,Lre=class extends un{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};l(Lre,"ZodLazy");var R1=Lre;R1.create=(i,e)=>new R1(Me({getter:i,typeName:Ui.ZodLazy},Ji(e)));var Dre=class extends un{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return qt(t,{received:t.data,code:Pt.invalid_literal,expected:this._def.value}),zi}return{status:"valid",value:e.data}}get value(){return this._def.value}};l(Dre,"ZodLiteral");var O1=Dre;O1.create=(i,e)=>new O1(Me({value:i,typeName:Ui.ZodLiteral},Ji(e)));function kD(i,e){return new C0(Me({values:i,typeName:Ui.ZodEnum},Ji(e)))}l(kD,"createZodEnum");var kre=class CI extends un{_parse(e){if(typeof e.data!="string"){let t=this._getOrReturnCtx(e),n=this._def.values;return qt(t,{expected:Ln.joinValues(n),received:t.parsedType,code:Pt.invalid_type}),zi}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let t=this._getOrReturnCtx(e),n=this._def.values;return qt(t,{received:t.data,code:Pt.invalid_enum_value,options:n}),zi}return To(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return CI.create(e,Me(Me({},this._def),t))}exclude(e,t=this._def){return CI.create(this.options.filter(n=>!e.includes(n)),Me(Me({},this._def),t))}};l(kre,"ZodEnum");var C0=kre;C0.create=kD;var Rre=class extends un{_parse(e){let t=Ln.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==oi.string&&n.parsedType!==oi.number){let r=Ln.objectValues(t);return qt(n,{expected:Ln.joinValues(r),received:n.parsedType,code:Pt.invalid_type}),zi}if(this._cache||(this._cache=new Set(Ln.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let r=Ln.objectValues(t);return qt(n,{received:n.data,code:Pt.invalid_enum_value,options:r}),zi}return To(e.data)}get enum(){return this._def.values}};l(Rre,"ZodNativeEnum");var N1=Rre;N1.create=(i,e)=>new N1(Me({values:i,typeName:Ui.ZodNativeEnum},Ji(e)));var Ore=class extends un{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==oi.promise&&t.common.async===!1)return qt(t,{code:Pt.invalid_type,expected:oi.promise,received:t.parsedType}),zi;let n=t.parsedType===oi.promise?t.data:Promise.resolve(t.data);return To(n.then(r=>this._def.type.parseAsync(r,{path:t.path,errorMap:t.common.contextualErrorMap})))}};l(Ore,"ZodPromise");var Tg=Ore;Tg.create=(i,e)=>new Tg(Me({type:i,typeName:Ui.ZodPromise},Ji(e)));var Nre=class extends un{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Ui.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:n}=this._processInputParams(e),r=this._def.effect||null,a={addIssue:l(o=>{qt(n,o),o.fatal?t.abort():t.dirty()},"addIssue"),get path(){return n.path}};if(a.addIssue=a.addIssue.bind(a),r.type==="preprocess"){let o=r.transform(n.data,a);if(n.common.async)return Promise.resolve(o).then(async s=>{if(t.value==="aborted")return zi;let u=await this._def.schema._parseAsync({data:s,path:n.path,parent:n});return u.status==="aborted"?zi:u.status==="dirty"||t.value==="dirty"?Em(u.value):u});{if(t.value==="aborted")return zi;let s=this._def.schema._parseSync({data:o,path:n.path,parent:n});return s.status==="aborted"?zi:s.status==="dirty"||t.value==="dirty"?Em(s.value):s}}if(r.type==="refinement"){let o=l(s=>{let u=r.refinement(s,a);if(n.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return s},"executeRefinement");if(n.common.async===!1){let s=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?zi:(s.status==="dirty"&&t.dirty(),o(s.value),{status:t.value,value:s.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(s=>s.status==="aborted"?zi:(s.status==="dirty"&&t.dirty(),o(s.value).then(()=>({status:t.value,value:s.value}))))}if(r.type==="transform")if(n.common.async===!1){let o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Ad(o))return zi;let s=r.transform(o.value,a);if(s instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:s}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>Ad(o)?Promise.resolve(r.transform(o.value,a)).then(s=>({status:t.value,value:s})):zi);Ln.assertNever(r)}};l(Nre,"ZodEffects");var bl=Nre;bl.create=(i,e,t)=>new bl(Me({schema:i,typeName:Ui.ZodEffects,effect:e},Ji(t)));bl.createWithPreprocess=(i,e,t)=>new bl(Me({schema:e,effect:{type:"preprocess",transform:i},typeName:Ui.ZodEffects},Ji(t)));var Fre=class extends un{_parse(e){return this._getType(e)===oi.undefined?To(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};l(Fre,"ZodOptional");var au=Fre;au.create=(i,e)=>new au(Me({innerType:i,typeName:Ui.ZodOptional},Ji(e)));var Bre=class extends un{_parse(e){return this._getType(e)===oi.null?To(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};l(Bre,"ZodNullable");var $c=Bre;$c.create=(i,e)=>new $c(Me({innerType:i,typeName:Ui.ZodNullable},Ji(e)));var zre=class extends un{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return t.parsedType===oi.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};l(zre,"ZodDefault");var F1=zre;F1.create=(i,e)=>new F1(Me({innerType:i,typeName:Ui.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default},Ji(e)));var Ure=class extends un{_parse(e){let{ctx:t}=this._processInputParams(e),n=lt(Me({},t),{common:lt(Me({},t.common),{issues:[]})}),r=this._def.innerType._parse({data:n.data,path:n.path,parent:Me({},n)});return M1(r)?r.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new yl(n.common.issues)},input:n.data})})):{status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new yl(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};l(Ure,"ZodCatch");var B1=Ure;B1.create=(i,e)=>new B1(Me({innerType:i,typeName:Ui.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch},Ji(e)));var Vre=class extends un{_parse(e){if(this._getType(e)!==oi.nan){let t=this._getOrReturnCtx(e);return qt(t,{code:Pt.invalid_type,expected:oi.nan,received:t.parsedType}),zi}return{status:"valid",value:e.data}}};l(Vre,"ZodNaN");var kw=Vre;kw.create=i=>new kw(Me({typeName:Ui.ZodNaN},Ji(i)));var SSe=Symbol("zod_brand"),jre=class extends un{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}};l(jre,"ZodBranded");var RD=jre,Gre=class $re extends un{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return l(async()=>{let r=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return r.status==="aborted"?zi:r.status==="dirty"?(t.dirty(),Em(r.value)):this._def.out._parseAsync({data:r.value,path:n.path,parent:n})},"handleAsync")();{let r=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return r.status==="aborted"?zi:r.status==="dirty"?(t.dirty(),{status:"dirty",value:r.value}):this._def.out._parseSync({data:r.value,path:n.path,parent:n})}}static create(e,t){return new $re({in:e,out:t,typeName:Ui.ZodPipeline})}};l(Gre,"ZodPipeline");var OD=Gre,Hre=class extends un{_parse(e){let t=this._def.innerType._parse(e),n=l(r=>(Ad(r)&&(r.value=Object.freeze(r.value)),r),"freeze");return M1(t)?t.then(r=>n(r)):n(t)}unwrap(){return this._def.innerType}};l(Hre,"ZodReadonly");var z1=Hre;z1.create=(i,e)=>new z1(Me({innerType:i,typeName:Ui.ZodReadonly},Ji(e)));function EI(i,e){let t=typeof i=="function"?i(e):typeof i=="string"?{message:i}:i;return typeof t=="string"?{message:t}:t}l(EI,"cleanParams");function ND(i,e={},t){return i?Ig.create().superRefine((n,r)=>{var a,o;let s=i(n);if(s instanceof Promise)return s.then(u=>{var h,d;if(!u){let f=EI(e,n),m=(d=(h=f.fatal)!=null?h:t)!=null?d:!0;r.addIssue(lt(Me({code:"custom"},f),{fatal:m}))}});if(!s){let u=EI(e,n),h=(o=(a=u.fatal)!=null?a:t)!=null?o:!0;r.addIssue(lt(Me({code:"custom"},u),{fatal:h}))}}):Ig.create()}l(ND,"custom");var MSe={object:zs.lazycreate},Ui;(function(i){i.ZodString="ZodString",i.ZodNumber="ZodNumber",i.ZodNaN="ZodNaN",i.ZodBigInt="ZodBigInt",i.ZodBoolean="ZodBoolean",i.ZodDate="ZodDate",i.ZodSymbol="ZodSymbol",i.ZodUndefined="ZodUndefined",i.ZodNull="ZodNull",i.ZodAny="ZodAny",i.ZodUnknown="ZodUnknown",i.ZodNever="ZodNever",i.ZodVoid="ZodVoid",i.ZodArray="ZodArray",i.ZodObject="ZodObject",i.ZodUnion="ZodUnion",i.ZodDiscriminatedUnion="ZodDiscriminatedUnion",i.ZodIntersection="ZodIntersection",i.ZodTuple="ZodTuple",i.ZodRecord="ZodRecord",i.ZodMap="ZodMap",i.ZodSet="ZodSet",i.ZodFunction="ZodFunction",i.ZodLazy="ZodLazy",i.ZodLiteral="ZodLiteral",i.ZodEnum="ZodEnum",i.ZodEffects="ZodEffects",i.ZodNativeEnum="ZodNativeEnum",i.ZodOptional="ZodOptional",i.ZodNullable="ZodNullable",i.ZodDefault="ZodDefault",i.ZodCatch="ZodCatch",i.ZodPromise="ZodPromise",i.ZodBranded="ZodBranded",i.ZodPipeline="ZodPipeline",i.ZodReadonly="ZodReadonly"})(Ui||(Ui={}));var CSe=l((i,e={message:"Input not instance of ".concat(i.name)})=>ND(t=>t instanceof i,e),"instanceOfType"),Wre=Eg.create,qre=C1.create,ESe=kw.create,ISe=E1.create,Xre=I1.create,TSe=T1.create,PSe=Iw.create,LSe=P1.create,DSe=L1.create,kSe=Ig.create,RSe=hd.create,OSe=vh.create,NSe=Tw.create,FSe=Sd.create,BSe=zs.create,zSe=zs.strictCreate,USe=D1.create,VSe=bre.create,jSe=k1.create,GSe=Gc.create,$Se=Cre.create,HSe=Lw.create,WSe=Dw.create,qSe=Pre.create,XSe=R1.create,ZSe=O1.create,YSe=C0.create,JSe=N1.create,KSe=Tg.create,GR=bl.create,QSe=au.create,eMe=$c.create,tMe=bl.createWithPreprocess,iMe=OD.create,nMe=l(()=>Wre().optional(),"ostring"),rMe=l(()=>qre().optional(),"onumber"),aMe=l(()=>Xre().optional(),"oboolean"),oMe={string:l(i=>Eg.create(lt(Me({},i),{coerce:!0})),"string"),number:l(i=>C1.create(lt(Me({},i),{coerce:!0})),"number"),boolean:l(i=>I1.create(lt(Me({},i),{coerce:!0})),"boolean"),bigint:l(i=>E1.create(lt(Me({},i),{coerce:!0})),"bigint"),date:l(i=>T1.create(lt(Me({},i),{coerce:!0})),"date")},sMe=zi,lMe=$e,eo=lMe,uMe=ii(Jee()),by=4,hMe=8,cMe="0.6",$R="low-priority-pin",Zre=$e.object({rank:$e.union([$e.enum(["low","medium","high","always-visible"]),$e.number()]).optional(),interactive:$e.union([$e.boolean(),$e.literal("pointer-events-auto")]).optional(),id:$e.string().optional(),anchor:$e.union([$e.enum(["top","bottom","left","right","center","top-left","top-right","bottom-left","bottom-right"]),$e.array($e.enum(["top","bottom","left","right","center","top-left","top-right","bottom-left","bottom-right"]))]).optional(),dynamicResize:$e.boolean().optional(),zIndex:$e.number().optional(),lowPriorityPin:$e.object({enabled:$e.boolean().optional(),size:$e.number().positive().optional(),color:$e.string().optional()}).optional()});function Yre(i,e,t){$e.array($e.number()).min(2).max(3).parse(i),$e.string().parse(e),Zre.parse(t)}l(Yre,"validateMarker");var pMe=Object.freeze({enabled:!0,size:hMe,color:"#666"}),II=class pb{constructor(e,t={}){D(this,"id"),D(this,"type","marker"),D(this,"rank",0),D(this,"initialRank",0),D(this,"activeAnchor","center"),D(this,"pointerEvents","none"),D(this,"options",{rank:"low",interactive:!1,id:"",anchor:"center",dynamicResize:!1,occluderId:0,zIndex:void 0,verticalOffset:0,lowPriorityPin:Me({},pMe)}),D(this,"projection",new ft),D(this,"enabled",!0),D(this,"canShow",!1),D(this,"visible",!0),D(this,"isOccluded",!1),D(this,"offscreen",!1),D(this,"strategyIndex",-1),D(this,"activeBoundingBox",{x:0,y:0,w:0,h:0}),D(this,"dimensions",{width:0,height:0}),D(this,"markerContainer"),D(this,"containerEl"),D(this,"contentEl",null),D(this,"contentHtml",""),D(this,"style",{top:"0px",left:"0px"}),D(this,"dirty",!1),D(this,"attachedDirty",!0),D(this,"collisionDirty",!0),D(this,"visibilityNeedsUpdate","show"),D(this,"animation",null),D(this,"currentStrategyIndex",-1),D(this,"onStrategySelected",l((o,s=!1)=>{var u,h;if(!(this.currentStrategyIndex===o&&!s)){if(this.currentStrategyIndex=o,o===this.lowPriorityPinStrategyIndex){this.activeAnchor="center",this.markerContainer.setAttribute("data-anchor",$R);let d=this.options.lowPriorityPin,f=d.size,m=d.color;this.markerContainer.style.setProperty("--mappedin-pin-size","".concat(f,"px")),this.markerContainer.style.setProperty("--pin-color",m),this.markerContainer.style.opacity=cMe,this.style.top=-f/2+"px",this.style.left=-f/2+"px"}else{this.activeAnchor=(h=(u=this.strategies[o])==null?void 0:u.name)!=null?h:"center",this.markerContainer.setAttribute("data-anchor",this.activeAnchor),this.markerContainer.style.removeProperty("--mappedin-pin-size"),this.markerContainer.style.removeProperty("--pin-color"),this.markerContainer.style.opacity="1";let{width:d,height:f}=this.dimensions,m=-f/2+"px",v=-d/2+"px";switch(this.style.top=m,this.style.left=v,this.activeAnchor){case"top":{this.style.top=-f+"px";break}case"bottom":{this.style.top="0px";break}case"left":{this.style.left=-d+"px";break}case"right":{this.style.left="0px";break}case"top-left":{this.style.top=-f+"px",this.style.left=-d+"px";break}case"top-right":{this.style.top=-f+"px",this.style.left="0px";break}case"bottom-left":{this.style.top="0px",this.style.left=-d+"px";break}case"bottom-right":{this.style.top="0px",this.style.left="0px";break}default:this.style.top=m,this.style.left=v}}this.markerContainer.style.top=this.style.top,this.markerContainer.style.left=this.style.left}},"onStrategySelected")),D(this,"packedMessage",{x:0,y:0,enabled:!1,rank:0,bboxes:[],lockedToStrategyIndex:-1,shouldCollideWithScreenEdges:!1});var n,r,a;if(this.id=t?.id||Hn(),this.options=(0,uMe.default)(this.options,t),typeof t.rank=="string")this.rank=XA(t.rank);else if(t.rank!=null&&t.rank>0)this.rank=t.rank;else{let o=Math.trunc(mr.env.NODE_ENV==="test"?pb.testId:pb.testId*10)/10;pb.testId+=.001,this.rank=o}typeof t.interactive=="string"&&(this.pointerEvents=t.interactive==="pointer-events-auto"?"auto":"none"),this.contentHtml=e,this.initialRank=this.rank,this.markerContainer=document.createElement("div"),this.markerContainer.className="mappedin-marker",this.markerContainer.style.opacity="0",this.markerContainer.innerHTML='<div class="mappedin-marker-content">'.concat(this.contentHtml,"</div>"),this.markerContainer.setAttribute("data-marker-id",this.id.toString()),this.containerEl=(n=this.markerContainer.firstElementChild)!=null?n:null,this.contentEl=(a=(r=this.markerContainer.firstElementChild)==null?void 0:r.firstElementChild)!=null?a:null}updateDimensions(e,t){if(e!=null&&t!=null)this.dimensions={width:e,height:t};else{let{width:n,height:r}=this.markerContainer.getBoundingClientRect();this.dimensions={width:n,height:r}}Object.assign(this.markerContainer,{width:this.dimensions.width+"px",height:this.dimensions.height+"px"}),this.currentStrategyIndex=-1}get strategies(){var e;let{width:t,height:n}=this.dimensions;if(t===0||n===0)return[];let r=(Array.isArray(this.options.anchor)?this.options.anchor:[this.options.anchor]).map(a=>({name:a,getBoundingBox:l(()=>{let o=n/2,s=n/2,u=t/2,h=t/2;switch(a){case"top":{o=n,s=0;break}case"bottom":{o=0,s=n;break}case"left":{u=t,h=0;break}case"right":{u=0,h=t;break}case"top-left":{o=n,u=t,s=0,h=0;break}case"top-right":{o=n,h=t,s=0,u=0;break}case"bottom-left":{s=n,u=t,o=0,h=0;break}case"bottom-right":{s=n,h=t,o=0,u=0;break}}return[o+by,s+by,u+by,h+by]},"getBoundingBox")}));if((e=this.options.lowPriorityPin)!=null&&e.enabled&&this.options.rank!=="always-visible"){let a={name:$R,getBoundingBox:l(()=>{let o=Math.max(2,by/2);return[this.options.lowPriorityPin.size/2+o,this.options.lowPriorityPin.size/2+o,this.options.lowPriorityPin.size/2+o,this.options.lowPriorityPin.size/2+o]},"getBoundingBox")};r.push(a)}return r}toPackedMessage(e=!1){var t;this.packedMessage.x=this.projection.x,this.packedMessage.y=this.projection.y,this.packedMessage.enabled=this.enabled,this.packedMessage.rank=this.rank,this.packedMessage.shouldCollideWithScreenEdges=!0;let n=this.currentStrategyIndex!==-1&&this.currentStrategyIndex!==this.lowPriorityPinStrategyIndex;if(this.visible&&e&&n&&this.collisionDirty===!1?this.packedMessage.lockedToStrategyIndex=this.currentStrategyIndex:this.packedMessage.lockedToStrategyIndex=-1,n&&this.currentStrategyIndex!==((t=this.packedMessage.bboxes[0])==null?void 0:t[4])){let r=this.packedMessage.bboxes.findIndex(a=>a[4]===this.currentStrategyIndex);if(r!==-1){let a=this.packedMessage.bboxes.splice(r,1)[0];this.packedMessage.bboxes.unshift(a)}}if(!this.collisionDirty)return this.packedMessage;this.packedMessage.bboxes=[];for(let r=0;r<this.strategies.length;r++){let a=this.strategies[r];r===this.currentStrategyIndex&&n?this.packedMessage.bboxes.unshift([...a.getBoundingBox(),r]):this.packedMessage.bboxes.push([...a.getBoundingBox(),r])}return this.collisionDirty=!1,this.packedMessage}get lowPriorityPinStrategyIndex(){var e;return!((e=this.options.lowPriorityPin)!=null&&e.enabled)||this.options.rank==="always-visible"?-1:Array.isArray(this.options.anchor)?this.options.anchor.length:1}destroy(){}};l(II,"MarkerComponent"),D(II,"testId",0);var Xv=II;R();R();R();R();R();var Jre=class{constructor(){D(this,"hover",!1),D(this,"dirty",!1)}};l(Jre,"InteractionComponent");var mM=Jre;R();R();function U1(i){"@babel/helpers - typeof";return U1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U1(i)}l(U1,"_typeof");var dMe=/^\s+/,fMe=/\s+$/;function Ai(i,e){if(i=i||"",e=e||{},i instanceof Ai)return i;if(!(this instanceof Ai))return new Ai(i,e);var t=Kre(i);this._originalInput=i,this._r=t.r,this._g=t.g,this._b=t.b,this._a=t.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||t.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=t.ok}l(Ai,"tinycolor");Ai.prototype={isDark:l(function(){return this.getBrightness()<128},"isDark"),isLight:l(function(){return!this.isDark()},"isLight"),isValid:l(function(){return this._ok},"isValid"),getOriginalInput:l(function(){return this._originalInput},"getOriginalInput"),getFormat:l(function(){return this._format},"getFormat"),getAlpha:l(function(){return this._a},"getAlpha"),getBrightness:l(function(){var i=this.toRgb();return(i.r*299+i.g*587+i.b*114)/1e3},"getBrightness"),getLuminance:l(function(){var i=this.toRgb(),e,t,n,r,a,o;return e=i.r/255,t=i.g/255,n=i.b/255,e<=.03928?r=e/12.92:r=Math.pow((e+.055)/1.055,2.4),t<=.03928?a=t/12.92:a=Math.pow((t+.055)/1.055,2.4),n<=.03928?o=n/12.92:o=Math.pow((n+.055)/1.055,2.4),.2126*r+.7152*a+.0722*o},"getLuminance"),setAlpha:l(function(i){return this._a=FD(i),this._roundA=Math.round(100*this._a)/100,this},"setAlpha"),toHsv:l(function(){var i=PI(this._r,this._g,this._b);return{h:i.h*360,s:i.s,v:i.v,a:this._a}},"toHsv"),toHsvString:l(function(){var i=PI(this._r,this._g,this._b),e=Math.round(i.h*360),t=Math.round(i.s*100),n=Math.round(i.v*100);return this._a==1?"hsv("+e+", "+t+"%, "+n+"%)":"hsva("+e+", "+t+"%, "+n+"%, "+this._roundA+")"},"toHsvString"),toHsl:l(function(){var i=TI(this._r,this._g,this._b);return{h:i.h*360,s:i.s,l:i.l,a:this._a}},"toHsl"),toHslString:l(function(){var i=TI(this._r,this._g,this._b),e=Math.round(i.h*360),t=Math.round(i.s*100),n=Math.round(i.l*100);return this._a==1?"hsl("+e+", "+t+"%, "+n+"%)":"hsla("+e+", "+t+"%, "+n+"%, "+this._roundA+")"},"toHslString"),toHex:l(function(i){return LI(this._r,this._g,this._b,i)},"toHex"),toHexString:l(function(i){return"#"+this.toHex(i)},"toHexString"),toHex8:l(function(i){return iae(this._r,this._g,this._b,this._a,i)},"toHex8"),toHex8String:l(function(i){return"#"+this.toHex8(i)},"toHex8String"),toRgb:l(function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},"toRgb"),toRgbString:l(function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},"toRgbString"),toPercentageRgb:l(function(){return{r:Math.round(fr(this._r,255)*100)+"%",g:Math.round(fr(this._g,255)*100)+"%",b:Math.round(fr(this._b,255)*100)+"%",a:this._a}},"toPercentageRgb"),toPercentageRgbString:l(function(){return this._a==1?"rgb("+Math.round(fr(this._r,255)*100)+"%, "+Math.round(fr(this._g,255)*100)+"%, "+Math.round(fr(this._b,255)*100)+"%)":"rgba("+Math.round(fr(this._r,255)*100)+"%, "+Math.round(fr(this._g,255)*100)+"%, "+Math.round(fr(this._b,255)*100)+"%, "+this._roundA+")"},"toPercentageRgbString"),toName:l(function(){return this._a===0?"transparent":this._a<1?!1:mMe[LI(this._r,this._g,this._b,!0)]||!1},"toName"),toFilter:l(function(i){var e="#"+DI(this._r,this._g,this._b,this._a),t=e,n=this._gradientType?"GradientType = 1, ":"";if(i){var r=Ai(i);t="#"+DI(r._r,r._g,r._b,r._a)}return"progid:DXImageTransform.Microsoft.gradient("+n+"startColorstr="+e+",endColorstr="+t+")"},"toFilter"),toString:l(function(i){var e=!!i;i=i||this._format;var t=!1,n=this._a<1&&this._a>=0,r=!e&&n&&(i==="hex"||i==="hex6"||i==="hex3"||i==="hex4"||i==="hex8"||i==="name");return r?i==="name"&&this._a===0?this.toName():this.toRgbString():(i==="rgb"&&(t=this.toRgbString()),i==="prgb"&&(t=this.toPercentageRgbString()),(i==="hex"||i==="hex6")&&(t=this.toHexString()),i==="hex3"&&(t=this.toHexString(!0)),i==="hex4"&&(t=this.toHex8String(!0)),i==="hex8"&&(t=this.toHex8String()),i==="name"&&(t=this.toName()),i==="hsl"&&(t=this.toHslString()),i==="hsv"&&(t=this.toHsvString()),t||this.toHexString())},"toString"),clone:l(function(){return Ai(this.toString())},"clone"),_applyModification:l(function(i,e){var t=i.apply(null,[this].concat([].slice.call(e)));return this._r=t._r,this._g=t._g,this._b=t._b,this.setAlpha(t._a),this},"_applyModification"),lighten:l(function(){return this._applyModification(oae,arguments)},"lighten"),brighten:l(function(){return this._applyModification(sae,arguments)},"brighten"),darken:l(function(){return this._applyModification(lae,arguments)},"darken"),desaturate:l(function(){return this._applyModification(nae,arguments)},"desaturate"),saturate:l(function(){return this._applyModification(rae,arguments)},"saturate"),greyscale:l(function(){return this._applyModification(aae,arguments)},"greyscale"),spin:l(function(){return this._applyModification(uae,arguments)},"spin"),_applyCombination:l(function(i,e){return i.apply(null,[this].concat([].slice.call(e)))},"_applyCombination"),analogous:l(function(){return this._applyCombination(pae,arguments)},"analogous"),complement:l(function(){return this._applyCombination(hae,arguments)},"complement"),monochromatic:l(function(){return this._applyCombination(dae,arguments)},"monochromatic"),splitcomplement:l(function(){return this._applyCombination(cae,arguments)},"splitcomplement"),triad:l(function(){return this._applyCombination(kI,[3])},"triad"),tetrad:l(function(){return this._applyCombination(kI,[4])},"tetrad")};Ai.fromRatio=function(i,e){if(U1(i)=="object"){var t={};for(var n in i)i.hasOwnProperty(n)&&(n==="a"?t[n]=i[n]:t[n]=Im(i[n]));i=t}return Ai(i,e)};function Kre(i){var e={r:0,g:0,b:0},t=1,n=null,r=null,a=null,o=!1,s=!1;return typeof i=="string"&&(i=yae(i)),U1(i)=="object"&&(Ll(i.r)&&Ll(i.g)&&Ll(i.b)?(e=Qre(i.r,i.g,i.b),o=!0,s=String(i.r).substr(-1)==="%"?"prgb":"rgb"):Ll(i.h)&&Ll(i.s)&&Ll(i.v)?(n=Im(i.s),r=Im(i.v),e=tae(i.h,n,r),o=!0,s="hsv"):Ll(i.h)&&Ll(i.s)&&Ll(i.l)&&(n=Im(i.s),a=Im(i.l),e=eae(i.h,n,a),o=!0,s="hsl"),i.hasOwnProperty("a")&&(t=i.a)),t=FD(t),{ok:o,format:i.format||s,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:t}}l(Kre,"inputToRGB");function Qre(i,e,t){return{r:fr(i,255)*255,g:fr(e,255)*255,b:fr(t,255)*255}}l(Qre,"rgbToRgb");function TI(i,e,t){i=fr(i,255),e=fr(e,255),t=fr(t,255);var n=Math.max(i,e,t),r=Math.min(i,e,t),a,o,s=(n+r)/2;if(n==r)a=o=0;else{var u=n-r;switch(o=s>.5?u/(2-n-r):u/(n+r),n){case i:a=(e-t)/u+(e<t?6:0);break;case e:a=(t-i)/u+2;break;case t:a=(i-e)/u+4;break}a/=6}return{h:a,s:o,l:s}}l(TI,"rgbToHsl");function eae(i,e,t){var n,r,a;i=fr(i,360),e=fr(e,100),t=fr(t,100);function o(h,d,f){return f<0&&(f+=1),f>1&&(f-=1),f<1/6?h+(d-h)*6*f:f<1/2?d:f<2/3?h+(d-h)*(2/3-f)*6:h}if(l(o,"hue2rgb"),e===0)n=r=a=t;else{var s=t<.5?t*(1+e):t+e-t*e,u=2*t-s;n=o(u,s,i+1/3),r=o(u,s,i),a=o(u,s,i-1/3)}return{r:n*255,g:r*255,b:a*255}}l(eae,"hslToRgb");function PI(i,e,t){i=fr(i,255),e=fr(e,255),t=fr(t,255);var n=Math.max(i,e,t),r=Math.min(i,e,t),a,o,s=n,u=n-r;if(o=n===0?0:u/n,n==r)a=0;else{switch(n){case i:a=(e-t)/u+(e<t?6:0);break;case e:a=(t-i)/u+2;break;case t:a=(i-e)/u+4;break}a/=6}return{h:a,s:o,v:s}}l(PI,"rgbToHsv");function tae(i,e,t){i=fr(i,360)*6,e=fr(e,100),t=fr(t,100);var n=Math.floor(i),r=i-n,a=t*(1-e),o=t*(1-r*e),s=t*(1-(1-r)*e),u=n%6,h=[t,o,a,a,s,t][u],d=[s,t,t,o,a,a][u],f=[a,a,s,t,t,o][u];return{r:h*255,g:d*255,b:f*255}}l(tae,"hsvToRgb");function LI(i,e,t,n){var r=[Bs(Math.round(i).toString(16)),Bs(Math.round(e).toString(16)),Bs(Math.round(t).toString(16))];return n&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}l(LI,"rgbToHex");function iae(i,e,t,n,r){var a=[Bs(Math.round(i).toString(16)),Bs(Math.round(e).toString(16)),Bs(Math.round(t).toString(16)),Bs(BD(n))];return r&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}l(iae,"rgbaToHex");function DI(i,e,t,n){var r=[Bs(BD(n)),Bs(Math.round(i).toString(16)),Bs(Math.round(e).toString(16)),Bs(Math.round(t).toString(16))];return r.join("")}l(DI,"rgbaToArgbHex");Ai.equals=function(i,e){return!i||!e?!1:Ai(i).toRgbString()==Ai(e).toRgbString()};Ai.random=function(){return Ai.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function nae(i,e){e=e===0?0:e||10;var t=Ai(i).toHsl();return t.s-=e/100,t.s=E0(t.s),Ai(t)}l(nae,"_desaturate");function rae(i,e){e=e===0?0:e||10;var t=Ai(i).toHsl();return t.s+=e/100,t.s=E0(t.s),Ai(t)}l(rae,"_saturate");function aae(i){return Ai(i).desaturate(100)}l(aae,"_greyscale");function oae(i,e){e=e===0?0:e||10;var t=Ai(i).toHsl();return t.l+=e/100,t.l=E0(t.l),Ai(t)}l(oae,"_lighten");function sae(i,e){e=e===0?0:e||10;var t=Ai(i).toRgb();return t.r=Math.max(0,Math.min(255,t.r-Math.round(255*-(e/100)))),t.g=Math.max(0,Math.min(255,t.g-Math.round(255*-(e/100)))),t.b=Math.max(0,Math.min(255,t.b-Math.round(255*-(e/100)))),Ai(t)}l(sae,"_brighten");function lae(i,e){e=e===0?0:e||10;var t=Ai(i).toHsl();return t.l-=e/100,t.l=E0(t.l),Ai(t)}l(lae,"_darken");function uae(i,e){var t=Ai(i).toHsl(),n=(t.h+e)%360;return t.h=n<0?360+n:n,Ai(t)}l(uae,"_spin");function hae(i){var e=Ai(i).toHsl();return e.h=(e.h+180)%360,Ai(e)}l(hae,"_complement");function kI(i,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var t=Ai(i).toHsl(),n=[Ai(i)],r=360/e,a=1;a<e;a++)n.push(Ai({h:(t.h+a*r)%360,s:t.s,l:t.l}));return n}l(kI,"polyad");function cae(i){var e=Ai(i).toHsl(),t=e.h;return[Ai(i),Ai({h:(t+72)%360,s:e.s,l:e.l}),Ai({h:(t+216)%360,s:e.s,l:e.l})]}l(cae,"_splitcomplement");function pae(i,e,t){e=e||6,t=t||30;var n=Ai(i).toHsl(),r=360/t,a=[Ai(i)];for(n.h=(n.h-(r*e>>1)+720)%360;--e;)n.h=(n.h+r)%360,a.push(Ai(n));return a}l(pae,"_analogous");function dae(i,e){e=e||6;for(var t=Ai(i).toHsv(),n=t.h,r=t.s,a=t.v,o=[],s=1/e;e--;)o.push(Ai({h:n,s:r,v:a})),a=(a+s)%1;return o}l(dae,"_monochromatic");Ai.mix=function(i,e,t){t=t===0?0:t||50;var n=Ai(i).toRgb(),r=Ai(e).toRgb(),a=t/100,o={r:(r.r-n.r)*a+n.r,g:(r.g-n.g)*a+n.g,b:(r.b-n.b)*a+n.b,a:(r.a-n.a)*a+n.a};return Ai(o)};Ai.readability=function(i,e){var t=Ai(i),n=Ai(e);return(Math.max(t.getLuminance(),n.getLuminance())+.05)/(Math.min(t.getLuminance(),n.getLuminance())+.05)};Ai.isReadable=function(i,e,t){var n=Ai.readability(i,e),r,a;switch(a=!1,r=vae(t),r.level+r.size){case"AAsmall":case"AAAlarge":a=n>=4.5;break;case"AAlarge":a=n>=3;break;case"AAAsmall":a=n>=7;break}return a};Ai.mostReadable=function(i,e,t){var n=null,r=0,a,o,s,u;t=t||{},o=t.includeFallbackColors,s=t.level,u=t.size;for(var h=0;h<e.length;h++)a=Ai.readability(i,e[h]),a>r&&(r=a,n=Ai(e[h]));return Ai.isReadable(i,n,{level:s,size:u})||!o?n:(t.includeFallbackColors=!1,Ai.mostReadable(i,["#fff","#000"],t))};var RI=Ai.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},mMe=Ai.hexNames=fae(RI);function fae(i){var e={};for(var t in i)i.hasOwnProperty(t)&&(e[i[t]]=t);return e}l(fae,"flip");function FD(i){return i=parseFloat(i),(isNaN(i)||i<0||i>1)&&(i=1),i}l(FD,"boundAlpha");function fr(i,e){mae(i)&&(i="100%");var t=gae(i);return i=Math.min(e,Math.max(0,parseFloat(i))),t&&(i=parseInt(i*e,10)/100),Math.abs(i-e)<1e-6?1:i%e/parseFloat(e)}l(fr,"bound01");function E0(i){return Math.min(1,Math.max(0,i))}l(E0,"clamp01");function jo(i){return parseInt(i,16)}l(jo,"parseIntFromHex");function mae(i){return typeof i=="string"&&i.indexOf(".")!=-1&&parseFloat(i)===1}l(mae,"isOnePointZero");function gae(i){return typeof i=="string"&&i.indexOf("%")!=-1}l(gae,"isPercentage");function Bs(i){return i.length==1?"0"+i:""+i}l(Bs,"pad2");function Im(i){return i<=1&&(i=i*100+"%"),i}l(Im,"convertToPercentage");function BD(i){return Math.round(parseFloat(i)*255).toString(16)}l(BD,"convertDecimalToHex");function OI(i){return jo(i)/255}l(OI,"convertHexToDecimal");var al=function(){var i="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",t="(?:"+e+")|(?:"+i+")",n="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?",r="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?";return{CSS_UNIT:new RegExp(t),rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+r),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+r),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+r),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function Ll(i){return!!al.CSS_UNIT.exec(i)}l(Ll,"isValidCSSUnit");function yae(i){i=i.replace(dMe,"").replace(fMe,"").toLowerCase();var e=!1;if(RI[i])i=RI[i],e=!0;else if(i=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var t;return(t=al.rgb.exec(i))?{r:t[1],g:t[2],b:t[3]}:(t=al.rgba.exec(i))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=al.hsl.exec(i))?{h:t[1],s:t[2],l:t[3]}:(t=al.hsla.exec(i))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=al.hsv.exec(i))?{h:t[1],s:t[2],v:t[3]}:(t=al.hsva.exec(i))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=al.hex8.exec(i))?{r:jo(t[1]),g:jo(t[2]),b:jo(t[3]),a:OI(t[4]),format:e?"name":"hex8"}:(t=al.hex6.exec(i))?{r:jo(t[1]),g:jo(t[2]),b:jo(t[3]),format:e?"name":"hex"}:(t=al.hex4.exec(i))?{r:jo(t[1]+""+t[1]),g:jo(t[2]+""+t[2]),b:jo(t[3]+""+t[3]),a:OI(t[4]+""+t[4]),format:e?"name":"hex8"}:(t=al.hex3.exec(i))?{r:jo(t[1]+""+t[1]),g:jo(t[2]+""+t[2]),b:jo(t[3]+""+t[3]),format:e?"name":"hex"}:!1}l(yae,"stringInputToObject");function vae(i){var e,t;return i=i||{level:"AA",size:"small"},e=(i.level||"AA").toUpperCase(),t=(i.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),t!=="small"&&t!=="large"&&(t="small"),{level:e,size:t}}l(vae,"validateWCAG2Parms");var HR=ii(Kee());R();var gMe=$e.object({rank:$e.union([$e.enum(["low","medium","high","always-visible"]),$e.number()]).optional(),interactive:$e.boolean().optional(),appearance:$e.object({margin:$e.number().min(6).optional(),text:$e.object({numLines:$e.number().optional(),lineHeight:$e.number().optional(),size:$e.number().optional(),maxWidth:$e.number().optional(),foregroundColor:$e.string().optional(),backgroundColor:$e.string().optional()}).optional(),marker:$e.object({size:$e.number().optional(),foregroundColor:$e.object({active:$e.string().optional(),inactive:$e.string().optional()}).optional(),backgroundColor:$e.object({active:$e.string().optional(),inactive:$e.string().optional()}).optional(),iconScale:$e.union([$e.number(),$e.object({on:$e.literal("zoom-level").optional(),input:$e.array($e.number()).nonempty(),output:$e.array($e.number()).nonempty(),easing:$e.string().optional()})]).optional()}).optional()}).optional()}),_ae=l(i=>{var e,t;if(gMe.parse(i??{}),typeof((t=(e=i.appearance)==null?void 0:e.marker)==null?void 0:t.iconScale)=="object"){let n=i.appearance.marker.iconScale;if(n.input.length!==n.output.length)throw new Error("iconScale.input and iconScale.output must have the same number of values for interpolation!");if(n.input.some((r,a)=>a>0&&r<n.input[a-1]))throw new Error("iconScale.input must be sorted in increasing order for interpolation!")}},"validateLabelOptions");function xae(i,e,t){$e.array($e.number()).min(2).max(3).parse(i),$e.string().parse(e),_ae(t)}l(xae,"validateLabel");var uf={margin:6,text:{numLines:2,lineHeight:1.2,size:11.5,maxWidth:150,foregroundColor:"white",backgroundColor:"#333"},marker:{size:5,foregroundColor:{active:"white",inactive:void 0},backgroundColor:{active:"#333",inactive:void 0}}},yMe={lightOnDark:lt(Me({},uf),{text:lt(Me({},uf.text),{foregroundColor:"white",backgroundColor:"#333"}),marker:lt(Me({},uf.marker),{foregroundColor:{active:"white",inactive:void 0},backgroundColor:{active:"#333",inactive:void 0}})}),darkOnLight:lt(Me({},uf),{text:lt(Me({},uf.text),{foregroundColor:"#333",backgroundColor:"white"}),marker:lt(Me({},uf.marker),{foregroundColor:{active:"#333",inactive:void 0},backgroundColor:{active:"white",inactive:void 0}})})},vMe="LOW_PRIORITY",WR=4,_Me=6,xMe=20,qR=2,bMe="cover",wMe=-1/0,XR=6.5,ZR={heightAbovePolygon:0,appearance:yMe.darkOnLight},AMe=l((i,e)=>["numLines","lineHeight","size","maxWidth","foregroundColor","backgroundColor"].some(t=>{var n,r,a;return((n=e.text)==null?void 0:n[t])!=null&&((r=i.text)==null?void 0:r[t])!==((a=e.text)==null?void 0:a[t])}),"isOneOfTextDirtyOptions"),SMe=l((i,e)=>["foregroundColor","backgroundColor","icon"].some(t=>{var n,r,a;return((n=e.marker)==null?void 0:n[t])!=null&&((r=i.marker)==null?void 0:r[t])!==((a=e.marker)==null?void 0:a[t])}),"isOneOfMarkerDirtyOptions"),NI=class db{constructor(e,t,n){D(this,"lines",0),D(this,"id"),D(this,"rank"),D(this,"type","label"),D(this,"initialRank"),D(this,"contextConfigured",!1),D(this,"fillText"),D(this,"newStyle",{}),D(this,"opacity",0),D(this,"visibilityNeedsUpdate",!1),D(this,"text"),D(this,"style",{top:0,left:0,textLabelVisible:!0,pinVisibility:1,textAlign:"left"}),D(this,"projection",new ft),D(this,"labelCacheId"),D(this,"_cache",{}),D(this,"appearance"),D(this,"options"),D(this,"visible",!0),D(this,"enabled",!0),D(this,"isOccluded",!1),D(this,"offscreen",!1),D(this,"canShow",!1),D(this,"activeBoundingBox",{x:0,y:0,w:0,h:0}),D(this,"dimensions",{width:0,height:0}),D(this,"currentStrategyIndex",-1),D(this,"totalMarkerSize",0),D(this,"iconScale",1),D(this,"iconPadding"),D(this,"dirty",!0),D(this,"textDirty",!0),D(this,"markerDirty",!0),D(this,"attachedDirty",!0),D(this,"collisionDirty",!0),D(this,"lastTextAlign"),D(this,"imageHash"),D(this,"markerSize",0),D(this,"iconVisible",!1),D(this,"dp"),D(this,"animate",!0),D(this,"onStrategySelected",l(s=>{if(this.currentStrategyIndex===s)return;this.currentStrategyIndex=s;let u=this.strategies[this.currentStrategyIndex];if(u){u.onStrategySelected();let h=this.style;this.style=this.newStyle,this.newStyle=h}},"onStrategySelected")),D(this,"packedMessage",{x:0,y:0,enabled:!1,rank:0,bboxes:[],shouldCollideWithScreenEdges:!1,lockedToStrategyIndex:-1});var r,a;if(this.id=(r=t.id)!=null?r:Hn(),this.options=(0,HR.default)({},t,ZR),this.text=e,this.dp=(s=1)=>s*n.pixelRatio,typeof t.rank=="string")this.rank=XA(t.rank),this.initialRank=this.rank;else if(t.rank!=null&&t.rank>0)this.rank=t.rank,this.initialRank=t.rank;else{let s=Math.trunc(mr.env.NODE_ENV==="test"?db.testId:db.testId*10)/10;db.testId+=.001,this.rank=s,this.initialRank=s}let o=(0,HR.default)({},this.options.appearance,ZR.appearance);this.appearance={margin:o.margin,text:{lineHeight:o.text.lineHeight,numLines:o.text.numLines,size:o.text.size,maxWidth:o.text.maxWidth,foregroundColor:o.text.foregroundColor,backgroundColor:o.text.backgroundColor},marker:{foregroundColor:{active:o.marker.foregroundColor.active,inactive:o.marker.foregroundColor.inactive||Ai(o.marker.foregroundColor.active).setAlpha(.5).toRgbString()},backgroundColor:{active:o.marker.backgroundColor.active,inactive:o.marker.backgroundColor.inactive||Ai(o.marker.backgroundColor.active).setAlpha(.5).toRgbString()},icon:o.marker.icon,iconSize:o.marker.iconSize||xMe,iconPadding:(a=o.marker.iconPadding)!=null?a:qR,iconFit:o.marker.iconFit||bMe,iconOverflow:o.marker.iconOverflow||"hidden",iconVisibleAtZoomLevel:o.marker.iconVisibleAtZoomLevel==null?wMe:o.marker.iconVisibleAtZoomLevel,iconScale:o.marker.iconScale}}}get scaledMarkerSize(){return this.totalMarkerSize*this.iconScale}get scaledIconPadding(){var e,t,n;return((n=(t=(e=this.appearance)==null?void 0:e.marker)==null?void 0:t.iconPadding)!=null?n:qR)*this.iconScale}setEntity(){}calculateMarkerSize(){let e=this.dp();this.iconVisible&&typeof this.appearance.marker.iconSize<"u"&&this.imageHash?this.markerSize=this.dp(this.appearance.marker.iconSize):this.markerSize=this.dp(XR),this.totalMarkerSize=Math.ceil((this.markerSize+2.5)/e)}get lowPriorityStrategyIndex(){return this.text===""?-1:3}get strategies(){let{width:e,height:t}=this.dimensions,{margin:n}=this.appearance,r=Math.max(_Me,n),a=this.iconVisible?r/2:0,o=this.iconVisible?this.scaledMarkerSize:XR/2,s=[{name:"RIGHT",getBoundingBox:l(()=>{let u=Math.max(this.scaledMarkerSize,t);return[u/2+r,u/2+r,this.scaledMarkerSize/2+r,this.scaledMarkerSize/2+e+r]},"getBoundingBox"),onStrategySelected:l(()=>{this.newStyle.textAlign="left",this.newStyle.pinVisibility=1,this.newStyle.top=-t/2,this.newStyle.left=this.scaledMarkerSize/2+WR,this.newStyle.textLabelVisible=!0},"onStrategySelected")},{name:"LEFT",getBoundingBox:l(()=>{let u=Math.max(this.scaledMarkerSize,t);return[u/2+r,u/2+r,this.scaledMarkerSize/2+e+r,this.scaledMarkerSize/2+r]},"getBoundingBox"),onStrategySelected:l(()=>{this.newStyle.textAlign="right",this.newStyle.pinVisibility=1,this.newStyle.top=-t/2,this.newStyle.left=-e-this.scaledMarkerSize/2-WR,this.newStyle.textLabelVisible=!0},"onStrategySelected")},{name:"TOP",getBoundingBox:l(()=>{let u=this.dp();return[t+this.scaledMarkerSize/2/u+r,this.scaledMarkerSize/2+r,e/2+r,e/2+r]},"getBoundingBox"),onStrategySelected:l(()=>{this.newStyle.pinVisibility=1,this.newStyle.textAlign="center",this.newStyle.textLabelVisible=!0,this.newStyle.top=-t-this.scaledMarkerSize/2,this.newStyle.left=-e/2},"onStrategySelected")},{name:vMe,getBoundingBox:l(()=>[o+a,o+a,o+a,o+a],"getBoundingBox"),onStrategySelected:l(()=>{this.newStyle.pinVisibility=.5,this.newStyle.textLabelVisible=!1,this.newStyle.top=0,this.newStyle.left=0},"onStrategySelected")}];return this.text===""?[{name:"ICON_ONLY",getBoundingBox:l(()=>[this.scaledMarkerSize/2+r,this.scaledMarkerSize/2+r,this.scaledMarkerSize/2+r,this.scaledMarkerSize/2+r],"getBoundingBox"),onStrategySelected:l(()=>{this.newStyle.pinVisibility=1,this.newStyle.textLabelVisible=!1,this.newStyle.top=0,this.newStyle.left=0},"onStrategySelected")}]:s}recomputeCurrentStrategy(e=this.iconScale){if(this.iconScale!==e||this.dirty){let t=this.strategies[this.currentStrategyIndex];if(this.iconScale=e,this.collisionDirty=!0,t){t.onStrategySelected(e);let n=this.style;this.style=this.newStyle,this.newStyle=n}this.dirty=!1}}updatePosition(){}disable(){this.visible=!1}toPackedMessage(e=!1){var t;if(this.visible&&e&&this.collisionDirty===!1&&this.currentStrategyIndex!=null&&this.currentStrategyIndex!==-1&&this.currentStrategyIndex!==this.lowPriorityStrategyIndex?this.packedMessage.lockedToStrategyIndex=this.currentStrategyIndex:this.packedMessage.lockedToStrategyIndex=-1,this.packedMessage.x=this.projection.x,this.packedMessage.y=this.projection.y,this.packedMessage.enabled=this.enabled,this.packedMessage.rank=this.rank,this.currentStrategyIndex!==-1&&this.currentStrategyIndex!==this.lowPriorityStrategyIndex&&this.currentStrategyIndex!==((t=this.packedMessage.bboxes[0])==null?void 0:t[4])){let n=this.packedMessage.bboxes.findIndex(r=>r[4]===this.currentStrategyIndex);if(n!==-1){let r=this.packedMessage.bboxes.splice(n,1)[0];this.packedMessage.bboxes.unshift(r)}}if(!this.collisionDirty)return this.packedMessage;this.packedMessage.bboxes=[];for(let n=0;n<this.strategies.length;n++){let r=this.strategies[n];n===this.currentStrategyIndex&&this.currentStrategyIndex!==-1&&this.currentStrategyIndex!==this.lowPriorityStrategyIndex?this.packedMessage.bboxes.unshift([...r.getBoundingBox(),n]):this.packedMessage.bboxes.push([...r.getBoundingBox(),n])}return this.packedMessage.shouldCollideWithScreenEdges=!1,this.collisionDirty=!1,this.packedMessage}destroy(){}};l(NI,"LabelComponent"),D(NI,"testId",0);var MMe=NI,Km=MMe;R();R();var bae=class extends xr{constructor(e,t,n=!0){super(),D(this,"rendererState"),D(this,"convertTo3DMapPosition"),D(this,"textSet",new Set),D(this,"batchedTextMap",new Map),D(this,"useWorker",!0),D(this,"debugTextAreaMesh",new Map),n===!1&&(this.useWorker=!1,zD(!1)),this.rendererState=e,this.convertTo3DMapPosition=t}remove(e){this.textSet.delete(e)}update(e){var t,n,r;let a,o,s,u=[];for(let h of this.rendererState.geometry3DIdsInScene)if(a=this.rendererState.geometry3DMap.get(h),a?.type==="text3d"){o=a.components[0],s=a.components[1];let d=(t=o.mesh)==null?void 0:t.parent;if(!d||!(d instanceof Kn)||!(o instanceof fb))continue;if("textArea"in o.feature.properties&&o.mesh!=null&&o.polygonEntityId!=null&&o.textMesh==null&&o.mesh.parent!=null&&((r=(n=o.feature.properties)==null?void 0:n.textArea)==null?void 0:r.position)!=null){if(this.textSet.has(o.polygonEntityId))continue;this.textSet.add(o.polygonEntityId),this.batchedTextMap.has(d)||this.batchedTextMap.set(d,Md().then(({BatchedText:v})=>{let b=new v;return b.type="batchedtext",d.add(b),b}));let m=this.batchedTextMap.get(d);if(!m)throw new Error("batched text required");u.push(FI({entityId:h,textComponent:o,styleComponent:s,convertTo3DMapPosition:this.convertTo3DMapPosition,batchedMeshPromise:m,rendererState:this.rendererState,type:"text-area"}).then(()=>{this.publish("render")}))}else if(o.mesh!=null&&o.textMesh==null&&o.mesh.parent!=null){if(this.textSet.has(h.toString()))continue;this.textSet.add(h.toString()),this.batchedTextMap.has(d)||this.batchedTextMap.set(d,Md().then(({BatchedText:v})=>{let b=new v;return b.type="batchedtext",d.add(b),b}));let m=this.batchedTextMap.get(d);if(!m)throw new Error("batched text required");u.push(FI({entityId:h,textComponent:o,styleComponent:s,convertTo3DMapPosition:this.convertTo3DMapPosition,batchedMeshPromise:m,rendererState:this.rendererState,type:"point"}).then(()=>{this.publish("render")}))}let f=this.batchedTextMap.get(d);o.textMesh&&f&&o.polygonEntityId!=null&&Promise.all([f,Promise.resolve({meshComponent:o,styleComponent:s})]).then(([m,{meshComponent:v,styleComponent:b}])=>{let{textMesh:w}=v;if(m&&w){let A=UD(m,w);v.visible&&!A?m.add(w):!v.visible&&A&&m.remove(w)}b.flipToFaceCamera&&this.flipIfNeeded(v,e)})}return Promise.all(u)}flipIfNeeded(e,t){let n=e.textMesh;if(!n)return!1;let r=n.rotation.z,a=vE(r+t);a>Math.PI/2&&a<3*Math.PI/2&&(n.rotation.z=vE(r+Math.PI))}showTextAreaMesh(){let e,t;for(let n of this.rendererState.geometry3DIdsInScene)if(e=this.rendererState.geometry3DMap.get(n),e?.type==="text3d"&&(t=e.components[0],"textArea"in t.feature.properties)){let r=t.feature.properties.textArea;if(!r)continue;let a=new Cd(r.maxWidth,r.maxHeight),o=new ln(a,new _l({color:"pink"})),{textMesh:s}=t;if(!s)continue;let u=this.convertTo3DMapPosition(r.position,wy);o.position.copy(u),o.position.z=s.position.z-.1,o.rotation.z=s.rotation.z,gM.identity(),gM.makeRotationAxis(new Ee(0,0,1),s.userData.rotationZ),wy.set(r.maxWidth/2,0,0),wy.applyMatrix4(gM),o.position.x-=wy.x,o.position.y-=wy.y,this.rendererState.entityScene.add(o),this.debugTextAreaMesh.set(n,o)}this.publish("render")}hideTextAreaMesh(){this.debugTextAreaMesh.forEach(e=>{this.rendererState.entityScene.remove(e)}),this.debugTextAreaMesh.clear(),this.publish("render")}};l(bae,"Text3DSystem");var CMe=bae;function zD(i){Md().then(({configureTroikaTextBuilder:e})=>{e({useWorker:i})})}l(zD,"configureWorker");var gM=new qi,wy=new Ee,yM;async function wae(i){let{preloadFont:e}=await Md();return e(i)}l(wae,"preloadFont");function Md(){return yM||(yM=_h(()=>import("./text3d-ZRYODT3I-DACctRDC.js"),__vite__mapDeps([5,1,2])).then(i=>i)),yM}l(Md,"getText3DService");async function FI({entityId:i,textComponent:e,styleComponent:t,convertTo3DMapPosition:n,batchedMeshPromise:r,rendererState:a,type:o="text-area"}){return Promise.all([Md(),Promise.resolve({entityId:i,meshComponent:e,styleComponent:t})]).then(([{createTroikaTextPoint:s,createTroikaTextArea:u},h])=>o==="text-area"?u(h.entityId,h.meshComponent,h.styleComponent,n):s(h.entityId,h.meshComponent,h.styleComponent,n)).catch(s=>{nt.warn("Trouble creating text: ",s)}).then(s=>{if(!(s!=null&&s.text))return;let u=[Promise.resolve(s.text),r,Promise.resolve()];if(e.polygonEntityId){let h=a.geometry3DMap.get(e.polygonEntityId);if(h?.type==="geometry"){let d=h.components[0],f=h.components[1];d.textMesh=s.text,d.mesh!=null&&(s.text.position.z=f.altitude+f.height+EMe)}}else u[2]=Md().then(({syncText:h})=>h(s.text));return Promise.all(u)}).then(s=>{if(!s)return;let[u,h]=s;h.add(u),e.batchedText||(e.batchedText=h)})}l(FI,"createText");function UD(i,e){return i._members.has(e)}l(UD,"doesBatchedTextContainsText");var EMe=.5,IMe=$e.object({visible:$e.boolean(),color:$e.string(),flipToFaceCamera:$e.boolean(),font:$e.string().optional(),fontSize:$e.number(),margin:$e.union([$e.number(),$e.tuple([$e.number(),$e.number(),$e.number(),$e.number()])]),outlineColor:$e.string(),outlineOpacity:$e.number(),outlineBlur:$e.union([$e.number(),$e.string()]),outlineWidth:$e.number(),outlineOffsetX:$e.number(),outlineOffsetY:$e.number(),strokeWidth:$e.number(),maxWidth:$e.number().optional(),maxHeight:$e.number().optional(),strokeOpacity:$e.number(),strokeColor:$e.string(),fillOpacity:$e.number(),hoverColor:$e.string().optional(),id:$e.union([$e.string(),$e.number()]),type:$e.literal("text3d"),position:$e.tuple([$e.number(),$e.number(),$e.number()]),content:$e.string()}),Aae=IMe.partial().omit({id:!0,type:!0}).strict(),TMe=Aae.omit({margin:!0,position:!0,maxWidth:!0,maxHeight:!0,content:!0}).strict(),PMe=$e.object({appearance:Aae.optional(),parentId:$e.string().optional()}).strict(),Sae=class{constructor(e){D(this,"mesh",new jg),D(this,"textMesh"),D(this,"type","text3d"),D(this,"feature"),D(this,"parent"),D(this,"batchedText"),D(this,"polygonEntityId"),this.feature=e}get visible(){return this.batchedText&&this.textMesh?UD(this.batchedText,this.textMesh):this.textMesh?this.textMesh.visible:!1}set visible(e){this.batchedText&&this.textMesh?e?this.batchedText.addText(this.textMesh):this.batchedText.removeText(this.textMesh):this.textMesh&&(this.textMesh.visible=e),this.mesh.visible=e}};l(Sae,"Text3DComponent");var fb=Sae;R();var Mae=class{constructor(e){D(this,"color"),D(this,"dirty",!0),D(this,"visible",!0),D(this,"edgeColors"),D(this,"geometry"),D(this,"ranges"),D(this,"topFaceVerticesIndices"),this.color=e}get currentOpacity(){return this.edgeColors&&this.ranges?this.edgeColors.array[this.ranges.start*4+3]:0}get currentColor(){return this.edgeColors&&this.ranges?[this.edgeColors.array[this.ranges.start*4],this.edgeColors.array[this.ranges.start*4+1],this.edgeColors.array[this.ranges.start*4+2]]:[0,0,0]}};l(Mae,"OutlineComponent");var Cae=Mae;R();R();R();var Eae=class extends Nm{constructor(e){let t=e,n=3,r=n*4;super(new Uint8Array(e*r),n,e,ao,vl),D(this,"_width"),D(this,"_height"),D(this,"_propertiesLength"),this._width=r,this._height=t,this._propertiesLength=n}setColor(e,t,n){let r=this.image.data,a=e*this._width;r[a]=Math.round(t.r*255),r[a+1]=Math.round(t.g*255),r[a+2]=Math.round(t.b*255),r[a+3]=0,r[a+4]=Math.round(n.r*255),r[a+5]=Math.round(n.g*255),r[a+6]=Math.round(n.b*255),r[a+7]=0,this.needsUpdate=!0}getColor(e){let t=this.image.data,n=e*this._width,r=new Mi(t[n]/255,t[n+1]/255,t[n+2]/255),a=new Mi(t[n+4]/255,t[n+5]/255,t[n+6]/255);return{color:r,topColor:a}}setTexture(e,t,n){let r=this.image.data,a=e*this._width;r[a+8]=t?255:0,r[a+9]=n?255:0,r[a+10]=0,r[a+11]=0,this.needsUpdate=!0}getTexture(e){let t=this.image.data,n=e*this._width,r=t[n+8]===255,a=t[n+9]===255;return{texture:r,topTexture:a}}};l(Eae,"BatchedPropertiesTexture");var LMe=Eae;R();var DMe=`#define LAMBERT
varying vec3 vViewPosition;
varying vec4 vPosition;
varying vec2 vUv;
varying vec4 finalPosition;
varying vec3 vWorldPosition;
varying vec3 worldNormal;
varying float vBatchId;

#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
	
  // To mitigate visual defects on machines such as windows and iOS
	vBatchId = getIndirectIndex(gl_DrawID) + 0.5;
	vViewPosition = - mvPosition.xyz;
	worldNormal = normal;
	vUv = uv;
	vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;
}
`;R();var kMe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
uniform float uGradientEnd;
uniform float uGradientIntensity;
uniform float uMinSideAlpha;
uniform float uMaxSideAlpha;
uniform float uGradientStart;
uniform highp sampler2D uPropertiesTexture;
uniform highp sampler2D uTopTexture;
uniform highp sampler2D uTexture;
uniform float uRepeatYFactor;
uniform bool uBlendTexture;
varying float vBatchId;

varying vec2 vUv;
varying vec3 vWorldPosition;
varying vec3 worldNormal;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

vec3 blendTextureColor(vec3 diffuseColor, vec4 texColor) {
	vec3 texturedColor = diffuseColor * texColor.rgb;
	return mix(diffuseColor, texturedColor, texColor.a);
}

void main() {
	#include <clipping_planes_fragment>

	// get the normalized world normal of vertex fragment
	vec3 surfaceNormal = normalize(worldNormal);

	// get angle relative to Z up
	float angle = degrees(acos(abs(dot(surfaceNormal, vec3(0.0, 0.0, 1.0)))));

	int idx = int(vBatchId) * 1;
	vec3 diffuse = vec3(texelFetch(uPropertiesTexture, ivec2(0, idx), 0).rgb);
	bool shouldShowTexture = texelFetch(uPropertiesTexture, ivec2(2, idx), 0).r > 0.99;

	if(shouldShowTexture) {
		vec4 tex2d = texture2D(uTexture, vec2(vUv.x, vUv.y * uRepeatYFactor));
		diffuse = uBlendTexture ? blendTextureColor(diffuse, tex2d) : tex2d.rgb;
	}

	// if this is a fragment facing upwards, use topColor. Avoid any sort of '==' comparison, due to floating point precision issue
	if(angle < 0.02) {
		bool shouldShowTopTexture = texelFetch(uPropertiesTexture, ivec2(2, idx), 0).g > 0.99;

		if(shouldShowTopTexture) {
			vec4 topTex2d = texture2D(uTopTexture, vUv);
			diffuse = uBlendTexture ? blendTextureColor(diffuse, topTex2d) : topTex2d.rgb;
		} else {
			diffuse = vec3(texelFetch(uPropertiesTexture, ivec2(1, idx), 0).rgb);
		}
	}

	vec4 diffuseColor = vec4(diffuse, opacity);

	// only for vertical surfaces
	if(angle > 89.0 && angle < 91.0) {

		// get the percentage of the z position from the ground, up
		float percentFromZeroZ = max((abs(vWorldPosition.z) - uGradientStart) / uGradientEnd, 0.0);

		// gradient based on percentage
		float alpha = smoothstep(uMinSideAlpha, uMaxSideAlpha, percentFromZeroZ);

		// mix the shadow color with the diffuse color based on the alpha and opacity
		diffuseColor = vec4(mix(diffuseColor.rgb, diffuseColor.rgb * (1.0 - uGradientIntensity), 1.0 - alpha), opacity);
	}

	ReflectedLight reflectedLight = ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0), vec3(0.0));
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;

	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,RMe=-.05,OMe=1,Iae=class extends cg{constructor(e,t,n=1){super(e),D(this,"propertiesTexture"),D(this,"uniforms",{uGradientIntensity:{value:0},uGradientEnd:{value:0},uGradientStart:{value:0},uTopTexture:{value:null},uTexture:{value:null},uRepeatYFactor:{value:1},uBlendTexture:{value:!1}}),D(this,"colorSpace",io),D(this,"showTextures",l(r=>{let a=!!this.uniforms.uTexture.value,o=!!this.uniforms.uTopTexture.value;(a||o)&&(this.propertiesTexture.setTexture(r,a,o),this.needsUpdate=!0)},"showTextures")),this.propertiesTexture=new LMe(t),this.uniforms.uRepeatYFactor.value=n,this.onBeforeCompile=r=>{let a=this.uniforms.uGradientIntensity,o=this.uniforms.uGradientEnd,s=this.uniforms.uGradientStart,u=this.uniforms.uTopTexture,h=this.uniforms.uTexture,d=this.uniforms.uRepeatYFactor,f=this.uniforms.uBlendTexture;this.uniforms=r.uniforms,r.vertexShader=DMe,r.fragmentShader=kMe,Object.assign(this.uniforms,{uGradientIntensity:a,uGradientEnd:o,uGradientStart:s,uMinSideAlpha:{value:RMe},uMaxSideAlpha:{value:OMe},uPropertiesTexture:{value:this.propertiesTexture},uTopTexture:u,uTexture:h,uRepeatYFactor:d,uBlendTexture:f})}}get repeatYFactor(){return this.uniforms.uRepeatYFactor.value}set repeatYFactor(e){e!==this.uniforms.uRepeatYFactor.value&&(this.uniforms.uRepeatYFactor.value=e,this.needsUpdate=!0)}get texture(){return this.uniforms.uTexture.value}set texture(e){e.wrapS=fl,e.wrapT=fl,e.colorSpace=this.colorSpace,this.uniforms.uTexture.value=e}get topTexture(){return this.uniforms.uTopTexture.value}set topTexture(e){e.wrapS=fl,e.wrapT=fl,e.colorSpace=this.colorSpace,this.uniforms.uTopTexture.value=e}get blendTexture(){return this.uniforms.uBlendTexture.value}set blendTexture(e){e!==this.uniforms.uBlendTexture.value&&(this.uniforms.uBlendTexture.value=e,this.colorSpace=e?pd:io,this.texture&&(this.texture.colorSpace=this.colorSpace),this.topTexture&&(this.topTexture.colorSpace=this.colorSpace),this.needsUpdate=!0)}setGradientShading(e,t,n){this.uniforms.uGradientStart.value=e,this.uniforms.uGradientEnd.value=t,this.uniforms.uGradientIntensity.value=n}setColor(e,t,n){this.propertiesTexture.setColor(e,t,n)}getColor(e){return this.propertiesTexture.getColor(e)}hideTextures(e){let t=!!this.uniforms.uTexture.value,n=!!this.uniforms.uTopTexture.value;(t||n)&&(this.propertiesTexture.setTexture(e,!1,!1),this.needsUpdate=!0)}removeSideTexture(e){if(this.texture){this.texture.dispose(),this.uniforms.uTexture.value=null;let t=!!this.uniforms.uTopTexture.value;this.propertiesTexture.setTexture(e,!1,t),this.needsUpdate=!0}}removeTopTexture(e){if(this.topTexture){this.topTexture.dispose(),this.uniforms.uTopTexture.value=null;let t=!!this.uniforms.uTexture.value;this.propertiesTexture.setTexture(e,t,!1),this.needsUpdate=!0}}dispose(){super.dispose(),this.propertiesTexture.dispose()}};l(Iae,"BatchedStandardMaterial");var BI=Iae;R();function Tae(i,e){var t,n,r;let a=0;for(let m of i)a+=((n=(t=m.components[0])==null?void 0:t.geometry)==null?void 0:n.attributes.position.count)||0;let o=new Mi(e.color),s;s=new BI({color:o,side:e.side==="back"?Eo:e.side==="front"?su:Go,opacity:(r=e.opacity)!=null?r:1,transparent:e.opacity!==void 0?e.opacity<1:!1,polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1},i.length);let u=new HL(i.length,a,0,s),h,d,f;for(let m of i)h=m.components[0],!(!(h instanceof vs)||!h.geometry)&&(h.mesh=u,h.material=s,h.instanceIndex=u.addGeometry(h.geometry),u.addInstance(h.instanceIndex),u.userData.entities[h.instanceIndex]=m.id,s instanceof BI&&s.setColor(h.instanceIndex,o,e.topColor?new Mi(e.topColor):o),d=u.getGeometryIdAt(h.instanceIndex),h.batchedProps&&(f=u.getGeometryRangeAt(d),f&&(h.batchedProps.range=f),h.batchedProps.geometryId=d));return u.perObjectFrustumCulled=!0,u.matrixAutoUpdate=!1,u}l(Tae,"batchGeometries");function I0(i){return Ai(i).darken(30).toRgbString()}l(I0,"darkenColorForOutline");function Pae(i,e,t,n){if(e.length<1)return;i.boundingBox||i.computeBoundingBox();let r=i.boundingBox,a=i.getAttribute("position"),o=i.getAttribute("normal"),s=i.getAttribute("uv"),u,h;i.index?(u=i.index.count/3,h=l(function(C,T){return i.index.getX(C*3+T)},"meshIndex")):(u=a.count/3,h=l(function(C,T){return C*3+T},"meshIndex"));let d=new qi;d.makeRotationFromQuaternion(new lu().setFromEuler(new Wo(0,0,t/180*Math.PI)));let f=e.find(C=>C.face==="top"),m;f&&(m={min:n(f.bounds[1],f.bounds[0],0),max:n(f.bounds[3],f.bounds[2],r.max.z)});let v=e.find(C=>C.face==="side"),b;if(v&&(b={min:n(v.bounds[1],v.bounds[0],0),max:n(v.bounds[3],v.bounds[2],r.max.z)}),!(!b&&!m))for(let C=0;C<u;++C){let T=o.getX(h(C,0))+o.getX(h(C,1))+o.getX(h(C,2)),k=o.getY(h(C,0))+o.getY(h(C,1))+o.getY(h(C,2)),F=o.getZ(h(C,0))+o.getZ(h(C,1))+o.getZ(h(C,2)),B=Math.abs(T),N=Math.abs(k),z=Math.abs(F);var w,A;B<=N&&B<=z?(w="x",N<=z?A="y":A="z"):N<=B&&N<=z?(w="y",B<=z?A="x":A="z"):(w="z",B<=N?A="x":A="y"),w==="z"&&(w=A,A="z");let L,j,q,Z,O,Y;if(A==="z"||w==="z"){if(!v||!b)continue;L=v.repeat.u,j=v.repeat.v,q=v.offset.u,Z=v.offset.v,O=v.rotation,Y=b}else{if(!f||!m)continue;L=f.repeat.u,j=f.repeat.v,q=f.offset.u,Z=f.offset.v,O=(360-t+f.rotation)%360,Y=m}let{min:J,max:oe}=Y,$=new vr;$.position.set(J.x,J.y,0),$.updateMatrix(),$.updateMatrixWorld();let K=J.clone().applyMatrix4(d),te=oe.clone().applyMatrix4(d),ve=Math.abs(te.x-K.x),Q=Math.abs(te.y-K.y),he=new Ee(ve,Q,oe.z).applyMatrix4($.matrixWorld),se=Math.abs(he[w]-J[w]),Ae=Math.abs(he[A]-J[A]),Ie=O*Math.PI/180||0,we=Math.cos(Ie),Ne=Math.sin(Ie),je=$.matrixWorld.clone().invert(),Ve=new lu().setFromEuler(new Wo(0,0,t/180*Math.PI));for(let Le=0;Le<3;Le++){let xe=new Ee(a.getX(h(C,Le)),a.getY(h(C,Le)),a.getZ(h(C,Le))).applyMatrix4(je);xe.applyQuaternion(Ve);let Ue=xe.applyMatrix4($.matrixWorld),de=Ue.x,ut=Ue.y,ot=Ue.z;var E,I;w==="x"?E=L*(de-J[w])/se+q:w==="y"?E=L*(ut-J[w])/se+q:E=L*(ot-J[w])/se+q,A==="x"?I=j*(de-J[A])/Ae+Z:A==="y"?I=j*(ut-J[A])/Ae+Z:I=j*(ot-J[A])/Ae+Z,E-=.5,I-=.5;let He=E*we-I*Ne+.5,Ke=E*Ne+I*we+.5;s.setX(h(C,Le),He),s.setY(h(C,Le),Ke)}}}l(Pae,"updateUVsLegacy");R();var Lae=class{constructor(){D(this,"focusMesh"),D(this,"dirty",!0)}};l(Lae,"FocusableComponent");var Rw=Lae;function Va(i,e,t){if(e!==void 0){if(i.type==="model"||i.type==="path"||i.type==="marker"||i.type==="label"||i.type==="geometry"||i.type==="group-container"||i.type==="custom-geometry")return e===!0?(i instanceof wg&&i.components[1]===void 0?(i.components[1]=new mM,i.components[1].dirty=!0):i instanceof lr&&i.components[2]===void 0?(i.components[2]=new mM,i.components[2].dirty=!0):i instanceof Kn&&i.components[1]===void 0&&(i.components[1]=new mM,i.components[1].dirty=!0),!0):(i instanceof wg?i.components[1]=void 0:i instanceof lr?i.components[2]=void 0:i instanceof Kn&&(i.components[1]=void 0),!0);if(i.type==="geometry-group"){let n;for(let r of i.userData.entities3D.values())n=t.geometry3DMap.get(r),Va(n,e,t);return!0}}return!1}l(Va,"updateInteractivity");function Dae(i,e,t){if(!(!(t!=null&&t.color)&&!("topColor"in t))){if(t!==void 0&&i.type==="geometry-group"&&i.components[0]!=null){let n,r,a=i.components[0];for(let o of i.userData.entities3D.values())if(n=e.geometry3DMap.get(o),n){r=n.components[1],r.color===a.color&&(r.initialColor=t.color||a.color,r.color=t.color||a.color,r.dirty=!0);let s=n.components[3];s&&(s.color=I0(r.color||a.color),s.dirty=!0),r.topColor===a.topColor&&(r.topColor=t.topColor||a.topColor,r.dirty=!0)}return t.color!==void 0&&(a.color=t.color,a.dirty=!0),"topColor"in t&&(a.topColor=t.topColor,a.dirty=!0),!0}return!1}}l(Dae,"updateGroupColor");function kae(i,e){if(e!==void 0&&i.type==="geometry-group"&&i.components[0]!=null){let t=i.components[0];return t.shading=t.shading||{},t.shading&&(e.start!==t.shading.start||e.end!==t.shading.end||e.intensity!==t.shading.intensity)&&(Object.assign(t.shading,e),i.userData.shadingDirty=!0),!0}return!1}l(kae,"updateGroupShading");function Rae(i,e){e!==void 0&&i.type==="geometry"&&(e.showImage!==void 0&&(i.components[1].showImage=e.showImage),e.flipImageToFaceCamera!==void 0&&(i.components[1].flipImageToFaceCamera=e.flipImageToFaceCamera))}l(Rae,"updateImageProps");function zI(i,e,t){if(t!==void 0){if(i.type==="geometry"){let n=i.components[1];if(n.height!==t)return n.height=t,n.dirty=!0,i.components[3]&&(i.components[3].dirty=!0),!0}else if(i.type==="geometry-group"){let n=i.components[0];for(let r of i.userData.entities3D.values()){let a=e.geometry3DMap.get(r),o;(a?.type==="geometry"||a?.type==="model")&&(o=a.components[1],o.height===n.height&&(a.components[1].height=t,a.components[1].dirty=!0),a.components[3]&&(a.components[3].dirty=!0))}return i.components[0].height=t,!0}}return!1}l(zI,"updateHeight");function VD(i,e){if(e!==void 0){let t=!1;(i.type==="path"||i.type==="geometry")&&(e.initialColor!==void 0&&e.initialColor!==i.components[1].initialColor&&(i.components[1].initialColor=e.initialColor,t=!0),e.color!==void 0&&e.color!==i.components[1].color&&(i.components[1].color=e.color,t=!0,i.components[3]&&(i.components[3].color=I0(e.color),i.components[3].dirty=!0)),"topColor"in e&&(i.components[1].topColor=e.topColor,t=!0),t&&(i.components[1].dirty=!0))}}l(VD,"updateColor");function UI(i,e,t){e!==void 0&&(i.type==="label"||i.type==="marker"?i.updatePosition(t(e[1],e[0],e[2]||0)):i.type==="custom-geometry"&&i.components[0].position.copy(t(e[1],e[0],e[2]||0)))}l(UI,"updatePosition");function VI(i,e){var t;return e!==void 0&&(i.type==="marker"||i.type==="label"||i.type==="custom-geometry")&&i.parentObject3D!==e&&i.parentObject3D instanceof Kn?((t=i.parentObject3D)==null||t.removeEntity(i),e.addEntity(i),!0):!1}l(VI,"updateParent");function Oae(i,e){e!==void 0&&(i.type==="marker"||i.type==="label")&&i.components[0].enabled!==e&&(i.components[0].enabled=e)}l(Oae,"updateEnabled");function Nae(i,e,t){if(e!==void 0&&i.type==="marker"){let n=i.components[0];if(e.contentHTML!==void 0)return n.containerEl.innerHTML=e.contentHTML,n.contentHtml=e.contentHTML,!0;if(e.anchor!==void 0&&(n.options.anchor=e.anchor,n.collisionDirty=!0),e.dynamicResize!==void 0)return n.options.dynamicResize=e.dynamicResize,!0;if(e.options!=null){try{Zre.parse(e.options||{})}catch(r){return nt.error(r),!1}return e.options.interactive!=null&&(e.options.interactive==="pointer-events-auto"?(n.pointerEvents="auto",Va(i,!1,t)):(n.pointerEvents="none",Va(i,e.options.interactive,t))),jD(i,e.options.rank),!0}}return!1}l(Nae,"updateMarker");function jD(i,e){return e!==void 0&&(i.type==="marker"||i.type==="label")?(i.components[0].rank=XA(e),!0):!1}l(jD,"updateRank");function Fae(i,e,t){var n,r,a,o,s,u;if(e!==void 0&&i.type==="label"){let h=i.components[0];e.text!==void 0&&e.text!==h.text&&(h.text=e.text,h.textDirty=!0);try{_ae((n=e.options)!=null?n:{})}catch(d){nt.error(d);return}AMe(h.appearance,((r=e.options)==null?void 0:r.appearance)||{})&&(h.textDirty=!0),SMe(h.appearance,((a=e.options)==null?void 0:a.appearance)||{})&&(h.markerDirty=!0),ZL(h.appearance,((o=e.options)==null?void 0:o.appearance)||{}),Va(i,(s=e.options)==null?void 0:s.interactive,t),jD(i,(u=e.options)==null?void 0:u.rank)}}l(Fae,"updateLabel");function Bae(i,e){e!==void 0&&i.type==="geometry"&&(i.components[1].hoverColor=e,i.components[1].dirty=!0)}l(Bae,"updateHoverColor");function zae(i,e){if(e!==void 0){let t=i.components[2];if(i.type==="geometry"&&t!=null)return t.hover=e,t.dirty=!0,!0}return!1}l(zae,"updateHovered");function jI(i,e){e!==void 0&&i.type==="image"&&(i.components[1].flipImageToFaceCamera=e)}l(jI,"updateFlipImageToFaceCamera");function Ul(i,e,t){if(t!==void 0)if(i.type==="model"||i.type==="path"||i.type==="geometry"||i.type==="custom-geometry"||i.type==="image"||i.type==="text3d"){t!==i.components[1].visible&&(i.components[1].visible=t,i.components[1].dirty=!0);let n=i.components[3];return n&&(n.visible=t,n.dirty=!0),!0}else{if(i.type==="geometry-group")return i.setVisible(t),!0;if(i.type==="group-container"){if(i.visible!==t)return i.setVisible(t),t===!1&&i.traverse(n=>{if(n instanceof g1){let r=e.geometry2DMap.get(n.userData.entityId);if(r){let a=r.components[0];a instanceof Km&&(a.canShow=t)}}}),!0}else if(i.type==="label")return i.components[0].visible=t,!0}return!1}l(Ul,"updateVisibility");function GI(i,e,t){if(t!==void 0){if(i.type==="geometry-group"){let n=i.components[0];if(n.opacity!==t){for(let r of i.userData.entities3D.values()){let a=e.geometry3DMap.get(r),o;(a?.type==="geometry"||a?.type==="model")&&(o=a.components[1],(!o.opacity||o.opacity===n.opacity)&&(o.opacity=t,o.dirty=!0))}return i.setOpacity(t),n.opacity=t,!0}}else if(i.type==="group-container"&&i.opacity!==t){i.setOpacity(t);let n=1;return i.parent instanceof Kn&&(n=i.parent.opacity),GD(i,e,n),!0}}return!1}l(GI,"updateOpacity");function GD(i,e,t=1){if(i.type==="group-container"&&"children"in i&&i.children.length>0){let n=t*i.opacity;i.userData.computedOpacity=n;for(let r of i.children)(r instanceof Io&&r.type==="geometry-group"||r instanceof Kn&&r.type==="group-container")&&GD(r,e,n)}else if(i.type==="geometry-group")for(let n of i.userData.entities3D.values()){let r=e.geometry3DMap.get(n),a;(r?.type==="geometry"||r?.type==="model")&&(a=r.components[1],a.dirty=!0)}}l(GD,"cascadeOpacity");function Uae(i,e){if(e!==void 0&&i.type==="geometry-group"){let t=i.components[0];e?.texture!=null&&t.texture!==e?.texture&&(t.texture=e.texture,t.dirty=!0),e?.topTexture!=null&&t.topTexture!==e?.topTexture&&(t.topTexture=e.topTexture,t.dirty=!0)}}l(Uae,"updateGroupTexture");function Vae(i,e){if(i.type==="geometry"){let t=!1,n=i.components[1];if(e?.texture!=null&&n.texture!==e?.texture&&(n.texture=e.texture,t=!0),e?.topTexture!=null&&n.topTexture!==e?.topTexture&&(n.topTexture=e.topTexture,t=!0),t&&i.components[0]instanceof vs){let r=i.components[0];return r.detached===!1&&(r.detached=!0,r.dirty=!0),i.components[1].dirty=!0,!0}}return!1}l(Vae,"updateIndividualGeometryTexture");function jae(i,e){if(e!==void 0&&i.type==="geometry"){let t=i.components[1];if(t.opacity!==e){t.opacity=e;let n=i.components[0],r=i.components[3];r&&(r.dirty=!0),n.detached===!1&&(n.detached=!0,n.dirty=!0),e===0?t.visible=!1:t.visible=!0,t.dirty=!0;let a=i.parentObject3D;return a?.type==="geometry-group"&&(a.userData.shadingDirty=!0),!0}}return!1}l(jae,"updateIndividualGeometryOpacity");function jf(i,e){if(e!==void 0){if(i.type==="geometry"||i.type==="path"||i.type==="custom-geometry"){let t=i.components[1];if(t.altitude!==e)return t.altitude=e,t.dirty=!0,i.components[3]&&(i.components[3].dirty=!0),!0}else if(i.type==="group-container"&&i.altitude!==e||i.type==="geometry-group"&&i.altitude!==e)return i.setAltitude(e),!0}return!1}l(jf,"updateAltitude");function Ow(i,e,t){if(t!==void 0){if(i.type==="geometry-group"&&i.components[0]!=null)for(let n of i.userData.entities3D.values()){let r=e.geometry3DMap.get(n);r instanceof lr&&Ow(r,e,t)}else if(i.type==="geometry"){let n=i.components[3],r=i.components[1];!n&&t===!0?i.components[3]=new Cae(I0(r.color)):n&&(n.visible=t,n.dirty=!0)}return!0}return!1}l(Ow,"updateOutline");function mb(i,e){if(e!==void 0){let t,n=4;if(i.type==="geometry"?(t=i.components[4],n=4):i.type==="group-container"&&(t=i.components[2],n=2),e===!0&&t==null)return i.components[n]=new Rw,!0;if(e===!1&&t!=null)return i.components[n]=void 0,!0}return!1}l(mb,"updateFocusable");function Gae(i,e){if(e!==void 0&&i.type==="geometry"){let t=i.components[1];if(t.renderOrder!==e){t.renderOrder=e;let n=i.components[0];return n.detached===!1&&(n.detached=!0,n.dirty=!0),n.imageMesh&&(n.imageMesh.renderOrder=e+1),t.dirty=!0,!0}}return!1}l(Gae,"updateIndividualGeometryRenderOrder");function $ae(i,e,t){let{visible:n,color:r}=t;if(i.type!=="path")return;let a=i.components[0];n!=null&&Ul(i,e,n),r!=null&&VD(i,{color:r}),Object.assign(a,$D(t)),pee(t)||(a.materialDirty=!0,(t.nearRadius!=null||t.farRadius!=null)&&(a.dirty=!0),(t.nearZoomLevel!=null||t.farZoomLevel!=null)&&(a.dirty=!0))}l($ae,"handlePathUpdate");function $D(i){return ks(i,NMe)}l($D,"pickPathOptions");var NMe=["animateArrowsOnPath","displayArrowsOnPath","nearRadius","farRadius","accentColor","completeFraction","nearZoomLevel","farZoomLevel","dashed","visibleThroughGeometry"];function Hae(i){if(!(i instanceof lr&&i.type==="text3d"))throw new Error("expect target is TextGeometry3D")}l(Hae,"assetGeometryIsText3D");var Wae=["visible","color","strokeWidth","outlineOffsetX","outlineOffsetY","outlineWidth","outlineBlur","outlineOpacity","outlineColor","strokeWidth","strokeColor","strokeOpacity","maxWidth","maxHeight","font","hoverColor","fillOpacity","fontSize","flipToFaceCamera"];function qae(i,e,t){Ul(i,e,t.visible);let n=i.components[1],r=ks(t,Wae);"margin"in t&&nt.warn("update to margin is not supported atm"),"content"in t&&nt.warn("content update is not supported atm");try{TMe.parse(r)}catch(a){nt.error(a);return}Object.keys(r).length>0&&(Object.assign(n,r),n.dirty=!0)}l(qae,"handleText3DUpdate");var FMe=["color","material","opacity","verticalOffset","rotation","position","scale"];function Xae(i,e){let t=ks(e,FMe),n=i.components[1],r=i.components[0];Object.keys(t).length>0&&(t.material&&(n.material=t.material),t.opacity!=null&&(n.opacity=t.opacity,t.opacity===0?n.visible=!1:n.visible=!0,n.dirty=!0),t.verticalOffset!=null&&(n.verticalOffset=t.verticalOffset),t.color!=null&&(n.color=t.color),t.position!=null&&(r.feature.geometry.coordinates=t.position,r.positionDirty=!0),t.rotation!=null&&(n.rotation=t.rotation),t.scale!=null&&(n.scale=t.scale),n.dirty=!0)}l(Xae,"handleModelStyleUpdate");var Tm,rh,$I,pv,Zae,gb,HI,Yae,Jae,yb,WI,vb,Nw,qI,Kae=class{constructor(e){ge(this,pv),ge(this,Tm,null),ge(this,rh),D(this,"getCurrentSceneGLTF",l(async t=>{let n=Me({onlyVisible:!0,binary:!0,light:!0,scale:1},t),r=await St(this,pv,Zae).call(this),a=y(this,$I).call(this,n),o=await r.parseAsync(a,{trs:!1,maxTextureSize:1/0,onlyVisible:n.onlyVisible,binary:n.binary,scale:n.scale}),s;if(o instanceof ArrayBuffer)s=new Blob([o],{type:"application/octet-stream"});else{let u=JSON.stringify(o,null,2);s=new Blob([u],{type:"text/plain"})}return s},"getCurrentSceneGLTF")),ge(this,$I,l(t=>{let{scale:n,light:r,onlyVisible:a}=t,o=new zP,s=new ur().setFromObject(y(this,rh).entityScene);if(y(this,gb).call(this,y(this,rh).entityScene,o,a),r){let u=new FN(16777215,.3*Math.PI);u.position.set(0,Math.max(s.max.x,s.max.y)*n*.5,s.max.y*n*4),u.lookAt(0,0,-1),u.target.position.set(0,0,-1),u.add(u.target),o.add(u)}return o},"#getExportedScene")),ge(this,gb,l((t,n,r)=>{t.material&&(t instanceof UP?St(this,pv,Yae).call(this,t).forEach(a=>n.add(a)):t instanceof Gw&&n.add(St(this,pv,Jae).call(this,t))),t.children.forEach(a=>{(!r||a.visible)&&y(this,gb).call(this,a,n,r)})},"#processObject3D")),ge(this,HI,l((t,n,r)=>{let a=new K9({color:new Mi(t),metalness:0});return a.opacity=n,a.transparent=r,a},"#createStandardMaterial")),ge(this,yb,l(t=>{let{geometry:n,material:r,position:a,rotation:o,quaternion:s,scale:u}=t;if(!(n!=null&&n.isBufferGeometry))return t;let h=n.attributes.position,d=n.attributes.normal,f=n.attributes.uv;return y(this,WI).call(this,h,d),y(this,Nw).call(this,a,u,o,s),f&&y(this,qI).call(this,f),r!=null&&r.map&&n.type==="PlaneGeometry"&&(t.side=Go),t},"#convertGeometry")),ge(this,WI,l((t,n)=>{let r=new Ee,a=new Ee;for(let o=0;o<t.count;o++)r.fromBufferAttribute(t,o),y(this,vb).call(this,r),t.setXYZ(o,r.x,r.y,r.z),n&&(a.fromBufferAttribute(n,o),y(this,vb).call(this,a),n.setXYZ(o,a.x,a.y,a.z))},"#convertAttributes")),ge(this,vb,l(t=>{let n=t.y;t.y=t.z,t.z=-n},"#convertVector")),ge(this,Nw,l((t,n,r,a)=>{let o=t.y;t.y=t.z,t.z=-o;let s=n.y;if(n.y=n.z,n.z=s,r instanceof Wo)r.order="YXZ",r.set(r.x,r.y,r.z,r.order);else{let u=a.y;a.set(a.x,a.z,-u,a.w)}},"#convertObjectProperties")),ge(this,qI,l(t=>{for(let n=0;n<t.count;n++){let r=t.getX(n),a=t.getY(n);t.setXY(n,r,a)}},"#convertUVs")),Ce(this,rh,e),y(this,rh).entityScene=e.entityScene,y(this,rh).geometry3DMap=e.geometry3DMap}destroy(){Ce(this,Tm,null)}};Tm=new WeakMap,rh=new WeakMap,$I=new WeakMap,pv=new WeakSet,Zae=l(async function(){if(!y(this,Tm)){let{GLTFExporter:i}=await _h(()=>import("./GLTFExporter-W4OR66GG-BecVXK8V.js"),__vite__mapDeps([6,1,2]));Ce(this,Tm,new i)}return y(this,Tm)},"#getGLTFExporter"),gb=new WeakMap,HI=new WeakMap,Yae=l(function(i){var e,t;let n=[],r=((e=i.userData)!=null&&e.entities?Object.values((t=i.userData)==null?void 0:t.entities):[]).map(o=>y(this,rh).geometry3DMap.get(o)),a=new Map;return r.forEach(o=>{var s;if(!o||!(o instanceof lr))return;let u=o.components[1],h=o.components[2];if(!u.visible||u instanceof Ym&&u.opacity===0||u instanceof EE||u instanceof See)return;let d=h!=null&&h.hover?u.hoverColor||y(this,rh).hoverColor:u.color,f="".concat(d,"-").concat(u.opacity,"-").concat(Number(u.visible));a.has(f)||a.set(f,[]),(s=a.get(f))==null||s.push(o)}),a.forEach((o,s)=>{let[u,h,d]=s.split("-"),f=o.reduce((w,A)=>{if(A.type==="custom-geometry")return w;let E=A.components[0];return"geometry"in E&&E.geometry instanceof Sa&&w.push(E.geometry),w},[]),m=y(this,HI).call(this,u,Number(h),i.material.transparent),v=Id(f,!0),b=new ln(v,m);b.position.copy(i.position),b.rotation.copy(i.rotation),b.scale.copy(i.scale),b.visible=!!d,y(this,Nw).call(this,b.position,b.scale,b.rotation,b.quaternion),n.push(y(this,yb).call(this,b))}),n},"#processBatchedMesh"),Jae=l(function(i){let e=i.geometry.clone(),t=i.material,n=new _l({color:t.color,side:Go});n.opacity=t.opacity,n.transparent=t.transparent;let r=new Gw(e,n);return r.position.copy(i.position),r.rotation.copy(i.rotation),r.scale.copy(i.scale),r.visible=i.visible,y(this,yb).call(this,r)},"#processLineSegments"),yb=new WeakMap,WI=new WeakMap,vb=new WeakMap,Nw=new WeakMap,qI=new WeakMap,l(Kae,"ExporterSystem");var BMe=Kae;R();R();R();var Qae=ii(Mwe());function HD(i){this.name="JSClipperError",this.message=i,this.stack=new Error().stack}l(HD,"JSClipperError");HD.prototype=Error.prototype;Qae.default.Error=function(i){throw new HD(i)};var no=Qae.default,zMe="gray",UMe=.1,Ay=100,vM=new no.ClipperOffset;function eoe(i,e){vM.Clear(),e/=2;let t=i.map(r=>({X:r.x*Ay,Y:r.y*Ay}));vM.AddPath(t,no.JoinType.jtMiter,no.EndType.etClosedPolygon);let n=new no.Paths;return vM.Execute(n,e*Ay),n.length?n.map(r=>r.map(a=>({x:a.X/Ay,y:a.Y/Ay}))):[i]}l(eoe,"offset");function WD(i,e,t){var n,r,a,o,s;let{color:u=zMe,opacity:h=1,altitude:d=0,height:f=UMe}=t||{};Array.isArray(h)&&(h=1);let m={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},v=i.geometry.coordinates[0].map(A=>{let E=e(A[1],A[0]);return m.min.x=Math.min(m.min.x,E.x),m.min.y=Math.min(m.min.y,E.y),m.max.x=Math.max(m.max.x,E.x),m.max.y=Math.max(m.max.y,E.y),E});((r=(n=i.properties)==null?void 0:n.style)==null?void 0:r.edgeOffset)!=null&&i.properties.style.edgeOffset!==0||((a=i.properties)==null?void 0:a.image)!=null?v=eoe(v,((s=(o=i.properties)==null?void 0:o.style)==null?void 0:s.edgeOffset)||0):v=[v];let b=[];for(let A of v){let E=new Og;E.moveTo(A[0].x,A[0].y),A.slice(1).forEach(k=>E.lineTo(k.x,k.y)),E.lineTo(A[0].x,A[0].y);let I=i.geometry.coordinates.slice(1);E.holes=I.map(k=>{let F=k.map(N=>e(N[1],N[0])),B=new sg;return B.moveTo(F[0].x,F[0].y),F.slice(1).forEach(N=>B.lineTo(N.x,N.y)),B.lineTo(F[0].x,F[0].y),B});let C={bevelEnabled:!1,depth:f},T=new q1(E,C);T.userData={style:{color:u,opacity:h}},b.push(T)}if(b.length===1)return b[0];let w=Id(b);return w.userData={style:{color:u,opacity:h},_split:!0},w}l(WD,"renderPolygonGeometry");R();var VMe="gray",jMe=.1;function qD(i,e,t){let{color:n=VMe,opacity:r=1,altitude:a=0,height:o=jMe}=t||{};Array.isArray(r)&&(r=1);let s={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},u={bevelEnabled:!1,depth:o},h=[];i.geometry.coordinates.forEach(f=>{let m=new Og,v=f[0].map(A=>{let E=e(A[1],A[0]);return s.min.x=Math.min(s.min.x,E.x),s.min.y=Math.min(s.min.y,E.y),s.max.x=Math.max(s.max.x,E.x),s.max.y=Math.max(s.max.y,E.y),E});m.moveTo(v[0].x,v[0].y),v.slice(1).forEach(A=>m.lineTo(A.x,A.y)),m.lineTo(v[0].x,v[0].y);let b=f.slice(1);m.holes=b.map(A=>{let E=A.map(C=>e(C[1],C[0])),I=new sg;return I.moveTo(E[0].x,E[0].y),E.slice(1).forEach(C=>I.lineTo(C.x,C.y)),I.lineTo(E[0].x,E[0].y),I});let w=new q1(m,u);h.push(w)});let d=Id(h);return d.translate(0,0,a||0),d.userData={style:{color:n,opacity:r}},d}l(qD,"renderMultiPolygonGeometry");R();var GMe="gray",_M=new no.ClipperOffset,_o=100;function toe(i,e,t){let{color:n=GMe,opacity:r=1,width:a=1,join:o="round",cap:s="round",height:u=.01,altitude:h=0}=t||{};Array.isArray(r)&&(r=0);let d=[];for(let w=0;w<i.geometry.coordinates.length-1;w++){let A=e(i.geometry.coordinates[w][1],i.geometry.coordinates[w][0]),E=e(i.geometry.coordinates[w+1][1],i.geometry.coordinates[w+1][0]);d.push([A,E])}_M.AddPaths(d.map(w=>w.map(A=>({X:A.x*_o,Y:A.y*_o}))),o==="round"?no.JoinType.jsRound:o==="miter"?no.JoinType.jsMiter:no.JoinType.jsSquare,s==="round"?no.EndType.etOpenRound:s==="butt"?no.EndType.etOpenButt:no.EndType.etOpenSquare);let f=new no.PolyTree;_M.Execute(f,a/2*_o);let m=[],v={bevelEnabled:!1,depth:u};for(let w of f.m_AllPolys){let A=new Og;if(w.IsHole())continue;let E=w.m_polygon;A.moveTo(E[0].X/_o,E[0].Y/_o),E.slice(1).forEach(I=>A.lineTo(I.X/_o,I.Y/_o)),A.lineTo(E[0].X/_o,E[0].Y/_o),A.holes=w.m_Childs.map(I=>{let C=new sg,T=I.m_polygon;return C.moveTo(T[0].X/_o,T[0].Y/_o),T.slice(1).forEach(k=>C.lineTo(k.X/_o,k.Y/_o)),C.lineTo(T[0].X/_o,T[0].Y/_o),C}),m.push(new q1(A,v))}let b=Id(m);return b.translate(0,0,h||0),b.userData={style:{color:n,opacity:r}},_M.Clear(),b}l(toe,"renderLineStringGeometry");R();var xo=100,$Me=.22,HMe=.01;function ioe(i,e,t={}){let{width:n=$Me,height:r=HMe,color:a="gray",opacity:o=1,altitude:s=0}=t,u={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},h={bevelEnabled:!1,depth:r},d=new no.ClipperOffset,f=i.geometry.coordinates.map(w=>w.map(A=>e(A[1],A[0])));d.AddPaths(f.map(w=>w.map(A=>({X:A.x*xo,Y:A.y*xo}))),no.JoinType.jsMiter,no.EndType.etOpenRound);let m=new no.PolyTree;d.Execute(m,n/2*xo);let v=[];for(let w of m.m_AllPolys){let A=new Og;if(w.IsHole())continue;u.min.x=Math.min(u.min.x,w.m_polygon[0].X),u.min.y=Math.min(u.min.y,w.m_polygon[0].Y),u.max.x=Math.max(u.max.x,w.m_polygon[0].X),u.max.y=Math.max(u.max.y,w.m_polygon[0].Y);let E=w.m_polygon;A.moveTo(E[0].X/xo,E[0].Y/xo),E.slice(1).forEach(I=>A.lineTo(I.X/xo,I.Y/xo)),A.lineTo(E[0].X/xo,E[0].Y/xo),A.holes=w.m_Childs.map(I=>{let C=new sg,T=I.m_polygon;return C.moveTo(T[0].X/xo,T[0].Y/xo),T.slice(1).forEach(k=>C.lineTo(k.X/xo,k.Y/xo)),C.lineTo(T[0].X/xo,T[0].Y/xo),C}),v.push(new q1(A,h))}let b=Id(v);return b.translate(0,0,s||0),b.userData={style:{color:a,opacity:o}},d.Clear(),b}l(ioe,"renderMultiLineStringGeometry");R();R();var XD=$e.object({type:$e.enum(["Point"]),coordinates:$e.array($e.number()).min(2).max(3)}),WMe=$e.object({rotation:$e.array($e.number()).length(3).optional(),altitude:$e.number().optional(),scale:$e.array($e.number()).length(3).optional(),interactive:$e.boolean().optional(),verticalOffset:$e.number().optional(),id:$e.union([$e.number(),$e.string()]).optional()}),qMe=$e.object({type:$e.enum(["Feature"]),geometry:XD,properties:WMe}),XMe=$e.object({type:$e.enum(["FeatureCollection"]),features:$e.array(qMe)}),ZMe=$e.object({color:$e.string()}),YMe=$e.object({url:$e.string(),color:$e.string().optional(),opacity:$e.number().optional(),material:$e.record($e.string(),ZMe).optional()});function noe(i,e,t){$e.union([$e.number(),$e.string()]).parse(i),XMe.parse(e),YMe.parse(t)}l(noe,"validateModelGroup");var _b,xb,roe=class{constructor(e){D(this,"mesh"),D(this,"type","model"),D(this,"positionDirty",!0),D(this,"outline"),D(this,"geometry"),D(this,"material"),D(this,"feature"),D(this,"instanceIndex",-1),D(this,"visible",!0),D(this,"color",new Mi),D(this,"position",new Ee),ge(this,_b,0),ge(this,xb,1),this.feature=e}setOpacity(){}setColor(){}get altitude(){return y(this,_b)}set altitude(e){this.mesh&&(this.mesh.position.z=e,Ce(this,_b,e))}getRotation(){return this.mesh?[this.mesh.rotation.x,this.mesh.rotation.y,this.mesh.rotation.z]:void 0}setRotation(e){this.mesh&&this.mesh.rotation.set(Bn.degToRad(e[0]),Bn.degToRad(e[1]),Bn.degToRad(e[2]))}getScale(){return this.mesh?[this.mesh.scale.x,this.mesh.scale.y,this.mesh.scale.z]:void 0}setScale(e){this.mesh&&this.mesh.scale.set(e[0],e[1],e[2])}get opacity(){return y(this,xb)}set opacity(e){var t,n,r;if(this.mesh){if(this.mesh.children[0]instanceof U2){for(let a of this.mesh.children)if(a instanceof U2){((t=a.userData)==null?void 0:t.originalOpacity)===void 0&&(a.userData.originalOpacity=a.material.opacity);let o=bg(e,0,(n=a.userData)==null?void 0:n.originalOpacity,0,1);a.material.opacity=o,a.material.transparent=o<1,a.material.needsUpdate=!0}}else(r=this.mesh)==null||r.traverse(a=>{a instanceof ln&&a.material&&(Array.isArray(a.material)?a.material.forEach(o=>{XI(o,e)}):XI(a.material,e))});Ce(this,xb,e)}}};_b=new WeakMap,xb=new WeakMap,l(roe,"ModelComponent");var bb=roe;function XI(i,e){i.opacity!==e&&(e===1?(i.opacity=1,i.transparent=!1):(i.opacity=e,i.transparent=!0),i.needsUpdate=!0)}l(XI,"updateMaterialOpacity");R();function ZD(i){var e,t;let n=i.components[0],r=i.components[1];r.opacity!=null&&r.opacity!==n.opacity&&(n.opacity=r.opacity);let a=r.material,o=r.color;if(a||o){let h=aoe(o,a);(e=n.mesh)==null||e.traverse(d=>{d instanceof ln&&d.material&&(Array.isArray(d.material)?d.material.forEach(f=>{h[f.name]?f.color.set(h[f.name].color):f.color.set(o)}):h[d.material.name]?d.material.color.set(h[d.material.name].color):d.material.color.set(o))})}let s=(t=n.feature.geometry.coordinates[2])!=null?t:0,u=r.verticalOffset+s;n.altitude!==u&&(n.altitude=u),r.visible!==n.visible&&(n.visible=r.visible),r.rotation&&n.setRotation(r.rotation),r.scale&&n.setScale(r.scale)}l(ZD,"applyModelGeometryStyle");function aoe(i,e){let t={};if(i&&Object.assign(t,{Default:{color:i},Fabric:{color:i},Mpdn_Logo:{color:i},CouchLogo:{color:i}}),e)for(let n in e)e[n].color&&(t[n]?t[n].color=e[n].color:t[n]={color:e[n].color});return t}l(aoe,"consolidateColorAndMaterial");function ooe(i,e){var t,n;let r=i.components[0],a=(t=i.components[1].verticalOffset)!=null?t:0,o=r.feature.geometry.coordinates.slice();o[2]=((n=o[2])!=null?n:0)+a,r.mesh?r.mesh.position.copy(e(o)):r.position.copy(e(o))}l(ooe,"applyModelPosition");function soe(i){let{color:e,opacity:t,topColor:n,texture:r,topTexture:a}=i;return"".concat(e).concat(t).concat(n||"").concat(r||"").concat(a||"")}l(soe,"generateIndex");var loe=class extends xr{constructor(e,t){super(),D(this,"state"),D(this,"convertTo3DMapPosition"),D(this,"loader"),D(this,"optimizePromise",[]),this.state=e,this.convertTo3DMapPosition=t}async getGLTFLoader(){if(this.loader)return this.loader;let{GLTFLoader:e}=await _h(()=>import("./GLTFLoader-CWW4SC4X-DhEbA_HU.js"),__vite__mapDeps([7,1,2]));return this.loader=new e,this.loader}createEntityFromFeature(e,t,n){var r,a;let o=new vs(t),s=new lr(o,new Ym(lt(Me({},n),{url:(a=(r=t.properties)==null?void 0:r.image)==null?void 0:a.path})));return n!=null&&n.outline&&(s.components[3]=new Cae(I0(n.color))),n!=null&&n.focusable&&(s.components[4]=new Rw),s.id=e,s}createModelFromFeature(e,t,n){let r=new bb(t),a=Me({},n);t.properties.verticalOffset!=null&&(a.verticalOffset=t.properties.verticalOffset),t.properties.rotation!=null&&(a.rotation=t.properties.rotation),t.properties.scale!=null&&(a.scale=t.properties.scale);let o=new See(a),s=new lr(r,o);return s.id=e,s}populateEntityMesh(e,t){let n=e.components[0];n.geometry=t,n.batchedProps={range:{start:0,count:1/0,indexCount:1/0,indexStart:0,vertexCount:1/0,vertexStart:0,reservedVertexCount:1/0,reservedIndexCount:1/0},geometryId:-1,positionCount:t.attributes.position.count},n.currentHeight=e.components[1].height,n.dirty=!1}async populateModelGroup(e,t,n){let r=new qi,a=new Wo,o=new lu,s=new Ee,u=new jg,h=await this.getGLTFLoader(),d=new Promise(f=>{h.load(t,m=>{"entities3D"in n.userData&&(n.userData.entities3D.size>1?m.scene.traverse(v=>{let b=v;if("isMesh"in b&&b.isMesh===!0){let w=new U2(b.geometry,b.material,e.size);w.userData={entities:{}},u.add(w),n.add(u)}}):(m.scene.traverse(v=>{"isMesh"in v&&v.isMesh===!0&&(v.position.set(0,0,0),v.rotation.set(0,0,0),v.scale.set(1,1,1),v.updateMatrix())}),u.add(m.scene),n.add(u),u.userData.isSingleModel=!0,u.userData.entityId=e.values().next().value,u.userData.type="model")),f()})});return this.optimizePromise.push(d.then(()=>{var f,m,v,b,w,A,E,I,C,T,k,F;let B=0,N;for(let z of e.values()){if(N=this.state.geometry3DMap.get(z),!N||N?.type!=="model")continue;let L=N.components[0],j=N.components[1],q=N.components[0].feature;L.mesh=u,L.instanceIndex=B,ZD(N),N.components[1].dirty=!1;let{x:Z,y:O}=this.convertTo3DMapPosition(q.geometry.coordinates[1],q.geometry.coordinates[0],0);L.position.set(Z,O,L.altitude),a.set(Bn.degToRad((m=(f=j.rotation)==null?void 0:f[0])!=null?m:Ix[0]),Bn.degToRad((b=(v=j.rotation)==null?void 0:v[1])!=null?b:Ix[1]),Bn.degToRad((A=(w=j.rotation)==null?void 0:w[2])!=null?A:Ix[2])),s.set((I=(E=j.scale)==null?void 0:E[0])!=null?I:Ex[0],(T=(C=j.scale)==null?void 0:C[1])!=null?T:Ex[1],(F=(k=j.scale)==null?void 0:k[2])!=null?F:Ex[2]),o.setFromEuler(a),r.compose(L.position,o,s),u.children.forEach(Y=>{!N||N?.type!=="model"||!(Y instanceof U2)||(Y.setMatrixAt(B,r),Y.userData.entities[B]=N.id)}),L.mesh.userData.isSingleModel&&(L.mesh.matrix.copy(r),L.mesh.matrix.decompose(L.mesh.position,L.mesh.quaternion,L.mesh.scale)),B++}this.publish("model-loaded")})),u}populateEntityGroup(e){var t;let n,r,a,o;for(let s of e.values())o=this.state.geometry3DMap.get(s),o.components[0]instanceof vs&&(r=o.components[0].feature,a=o.components[1],r.geometry.type==="Polygon"?(n=WD(r,this.convertTo3DMapPosition,a),(t=r.properties)!=null&&t.textures&&r.properties.textures.length>0&&Pae(n,r.properties.textures,this.state.naturalBearing,this.convertTo3DMapPosition),this.populateEntityMesh(o,n)):r.geometry.type==="MultiPolygon"?(n=qD(r,this.convertTo3DMapPosition,a),this.populateEntityMesh(o,n)):r.geometry.type==="LineString"?(n=toe(r,this.convertTo3DMapPosition,a),this.populateEntityMesh(o,n)):r.geometry.type==="MultiLineString"&&(n=ioe(r,this.convertTo3DMapPosition,a),this.populateEntityMesh(o,n)));return e}update(){var e;for(let t of this.state.geometryGroupIdsToLoad.values()){let n=this.state.geometry3DMap.get(t);if(n instanceof Io&&n.userData.dirty){if(n.userData.modelURL)n.userData.modelURL&&(this.populateModelGroup(n.userData.entities3D,n.userData.modelURL,n),n.userData.dirty=!1);else try{this.populateEntityGroup(n.userData.entities3D)}catch(o){nt.warn(o)}let r,a={};for(let o of n.userData.entities3D.values()){r=this.state.geometry3DMap.get(o);let s=r?.components[0];if(r?.type==="geometry"){let u=r.components[1],h=soe(u);a[h]===void 0&&(a[h]={style:u,entities:[]}),a[h].entities.push(r)}else s&&"mesh"in s&&s.mesh&&((e=s.mesh)==null?void 0:e.parent)!==n&&n.add(s.mesh)}for(let o in a){let s=Tae(a[o].entities,a[o].style);n.add(s)}for(let o of n.userData.entities3D.values())if(r=this.state.geometry3DMap.get(o),r!=null&&r.entities2D.size>0)for(let s of r.entities2D.values())s&&(r.attach(s),this.publish("geometry-2d-added"));this.publish("geometry-group-added"),n.userData.dirty=!1}}return Promise.resolve()}};l(loe,"MeshCreationAndOptimizationSystem");var JMe=loe;R();var uoe=class{constructor(e,t){D(this,"state"),D(this,"dirty",!0),D(this,"domTree"),this.state=e,this.domTree=t}update(){if(this.dirty){let e;for(let t of Array.from(this.domTree.children))if(e=this.state.geometry2DMap.get(t.userData.entityId),e){let n=e.components[0];(!n.enabled||!n.visible||!this.state.geometry2DIdsInScene.has(t.userData.entityId))&&this.domTree.removeChild(t)}else this.domTree.removeChild(t);for(let t of this.state.geometry2DIdsInScene)if(e=this.state.geometry2DMap.get(t),e){let n=e.components[0];n instanceof Xv&&n.enabled&&n.markerContainer&&!this.domTree.contains(n.markerContainer)&&(n.markerContainer.userData={entityId:e.id},this.domTree.appendChild(n.markerContainer),n.updateDimensions())}this.dirty=!1}}};l(uoe,"DOMVisibilitySystem");var KMe=uoe;R();var hoe=class{constructor(e,t){D(this,"state"),D(this,"project"),this.state=e,this.project=t}update(){let e,t=0,n,r;for(let a of this.state.geometry2DIdsInScene)if(e=this.state.geometry2DMap.get(a),e){r=e.components[0];let o=e.attachedTo?this.state.geometry3DMap.get(e.attachedTo):void 0;if(o instanceof lr)if(this.state.geometry3DIdsInScene.has(o.id)){n=o.components[1],r=e.components[0],(n.dirty||e.components[0].attachedDirty)&&(t=n.height,e.setAltitude(t));let s=n.visible&&n.opacity>0;r.visible!==s&&(r.visible=s)}else r.visible===!0&&(r.visible=!1);this.project(e.components[0].projection,e.position),e.components[0].attachedDirty=!1}}};l(hoe,"TwoDProjectionSystem");var QMe=hoe;R();R();var eCe=l(function(){let i,e;return t=>{if((!e||!e)&&(i=document.createElement("canvas"),i.width=500*t,i.height=500*t,i.style.width="500px",i.style.height="500px",e=i.getContext("2d")),!e)throw new Error("Could not get 2D context");return{measureCanvas:i,measureCanvasContext:e}}},"createMeasureCanvasContext")(),tCe=l(({text:i,size:e,maxWidth:t,pixelRatio:n,maxLines:r=2,lineHeight:a=1.2,options:o={strokeText:!0}})=>{let s="bold ".concat(e*n,"px 'InterUI-Regular', Helvetica Neue, Arial, sans-serif"),{measureCanvasContext:u}=eCe(n);u.font=s;let h=[],d=i.split(" "),f=0,m=0,v=0;for(;m<d.length;){let A=d[m];if(f===r&&f>0){h[f-1]+="...";break}if(h[f]==null&&(h[f]=A,m++),d.length===1){h[f]=A;break}if(d[m]==null)break;let{width:E}=u.measureText(h[f]+" "+d[m]);E<=t*n?(h[f]+=" "+d[m],m++):f++}h.forEach(A=>{let{width:E}=u.measureText(A);v=Math.max(E,v)});let b=e*n*a,w=h.length*b;return{maxWidth:v,maxHeight:w,lines:h.length,draw:l((A,E,I)=>{h.length===1?(o.strokeText&&A.strokeText(h[0],E,I),A.fillText(h[0],E,I)):(o.strokeText&&(A.strokeText(h[0],E,I-b/2),A.strokeText(h[1],E,I+b/2)),A.fillText(h[0],E,I-b/2),A.fillText(h[1],E,I+b/2))},"draw")}},"shaveText");R();function coe(i){let e=new Image;return i&&(/<svg[\s\S]*>/i.test(i)?e.src="data:image/svg+xml;base64,".concat(btoa(i)):e.src=i),e}l(coe,"createImage");var poe=class extends xr{constructor(e,t,n){super(),D(this,"dirty",!1),D(this,"state"),D(this,"colliderContext"),D(this,"colliderCanvas"),D(this,"transformRequestFunc"),D(this,"transformRequest",l(async r=>this.transformRequestFunc?await this.transformRequestFunc(r):{url:r},"transformRequest")),D(this,"pinCache",{}),D(this,"imageCache",{}),D(this,"imagePromiseCache",{}),D(this,"imageDimensionsCache",{}),D(this,"textCache",{}),D(this,"update",l(r=>{let a=this.state.pixelRatio;this.colliderContext.clearRect(0,0,this.colliderCanvas.width,this.colliderCanvas.height);let o,s,u,h,d,f,m;for(let v of this.state.geometry2DIdsInScene)if(m=this.state.geometry2DMap.get(v),m!=null&&(f=m.components[0],f instanceof Km&&!m.disposed)){if(d=f.appearance.marker.iconVisibleAtZoomLevel,f.appearance.marker.icon!=null&&d&&r>=d!==f.iconVisible&&(f.iconVisible=r>=d,f.dirty=!0),(f.dirty||this.dirty)&&f.calculateMarkerSize(),s=f.appearance.marker.foregroundColor,u=f.appearance.marker.backgroundColor,h=f0(f.markerSize,2),o="".concat(s.active,"-").concat(s.inactive,"-").concat(u.active,"-").concat(u.inactive,"-").concat(h,"-").concat(f.iconVisible),f.labelCacheId=o,(!this.pinCache[o]||this.dirty)&&(this.prepare(f,o,this.colliderContext),f.dirty=!0),(f.appearance.marker.icon&&(!f.imageHash||f.markerDirty)||this.dirty)&&this.cacheImage(f),this.textCache[f.id]==null||f.textDirty||this.dirty){f.dirty=!0,this.textCache[f.id]={};let{textDrawFn:w,width:A,height:E}=this.processText(f.text,f.appearance.text.size,f.appearance.text.maxWidth,f.appearance.text.numLines,f.appearance.text.lineHeight);["left","center","right"].forEach(I=>{this.textCache[f.id][I]=this.textToCanvas(w,f.appearance.text.size,I,A,E,f.appearance.text.foregroundColor,f.appearance.text.backgroundColor)}),f.dimensions={width:Math.ceil(A/a),height:Math.ceil(E/a)}}let b=1;if(f.appearance.marker.iconScale)if(typeof f.appearance.marker.iconScale=="number")b=f.appearance.marker.iconScale;else{let{on:w,input:A,output:E,easing:I}=f.appearance.marker.iconScale;w==="zoom-level"?b=BQ(r,A,E,I??"linear"):nt.warn("Unsupported interpolation property: ".concat(w))}f.recomputeCurrentStrategy(f.iconVisible?b:1),f.canShow&&f.visible&&(f.enabled||f.visibilityNeedsUpdate!==!1)&&this.draw(f,o,this.colliderContext),f.textDirty=!1,f.markerDirty=!1}this.dirty=!1},"update")),D(this,"processText",l((r,a,o,s,u)=>{let h=this.state.pixelRatio,{draw:d,maxWidth:f,maxHeight:m}=tCe({text:r,size:a,pixelRatio:h,maxWidth:o,maxLines:s,lineHeight:u});return{textDrawFn:d,width:f+2.5*h*2,height:m+2.5*h*2}},"processText")),D(this,"textToCanvas",l((r,a,o,s,u,h,d)=>{let f=this.state.pixelRatio,m,v=s,b=u;window.OffscreenCanvas!=null&&!k2e()?m=new OffscreenCanvas(v,b):(m=document.createElement("canvas"),m.width=v,m.height=b,m.style.width=v+"px",m.style.height=b+"px");let w=m.getContext("2d",{willReadFrequently:!0});if(!w)return;w.textAlign=o,w.font="bold ".concat(a*f,"px 'InterUI-Regular', Helvetica Neue, Arial, sans-serif"),w.textBaseline="middle",w.lineJoin="miter",w.miterLimit=2,w.strokeStyle="white",w.lineWidth=2.5*f,w.fillStyle=h,w.strokeStyle=d;let A=o==="left"?0:o==="center"?v/2:v-2.5*f/2;return r(w,A,(b+2.5*f/2)/2),m},"textToCanvas")),D(this,"cacheImage",l(r=>{if(!r.appearance.marker.icon)return;let a=yee(r.appearance.marker.icon);this.imagePromiseCache[a]||(this.imagePromiseCache[a]=new Promise(o=>{this.transformRequest(r.appearance.marker.icon).then(s=>{let u=coe(s.url);u.onload=()=>{this.imageCache[a]=u,this.publish("img:loaded"),o(u)}})})),r.imageHash!==a&&(r.imageHash=a,this.imagePromiseCache[a].then(()=>{r.dirty=!0}))},"cacheImage")),D(this,"createPinCanvas",l((r,a,o,s,u=1)=>{let h,d=this.state.pixelRatio,f=r.totalMarkerSize*2*d*u;window.OffscreenCanvas!=null?h=new OffscreenCanvas(f,f):(h=document.createElement("canvas"),h.width=f,h.height=f,h.style.width=f/d+"px",h.style.height=f/d+"px");let m=h.getContext("2d");return m.shadowColor="rgba(0,0,0,0.3)",m.shadowOffsetY=2*d,m.shadowBlur=5*d,m.beginPath(),m.arc(f/2,f/2,(a/2+2.5*d/2)*u,0,2*Math.PI),m.fillStyle=o,m.fill(),m.beginPath(),m.arc(f/2,f/2,a/2*u,0,2*Math.PI),m.shadowColor="transparent",m.fillStyle=s,m.fill(),h},"createPinCanvas")),D(this,"prepare",l((r,a,o)=>{let s=this.state.pixelRatio;o.lineWidth=4*s;let u=typeof r.appearance.marker.iconScale=="number"?[r.appearance.marker.iconScale]:r.appearance.marker.iconScale==null?[]:r.appearance.marker.iconScale.output,h=u.length>0?Math.max(...u):void 0,d=this.createPinCanvas(r,r.markerSize,r.appearance.marker.backgroundColor.active,r.appearance.marker.foregroundColor.active,h),f=this.createPinCanvas(r,r.iconVisible?r.markerSize:3.5*s,r.appearance.marker.backgroundColor.inactive,r.appearance.marker.foregroundColor.inactive,h);this.pinCache[a]=[d,f]},"prepare")),this.state=e,this.colliderCanvas=t,this.colliderContext=t.getContext("2d"),this.transformRequestFunc=n}draw(e,t,n){var r,a;if(!e.canShow||!e.visible)return;n.save(),n.globalAlpha=e.opacity;let o=this.state.pixelRatio,s=e.projection.x*o,u=e.projection.y*o,h=e.style.pinVisibility===1?this.pinCache[t][0]:this.pinCache[t][1];if(n.drawImage(h,s-e.scaledMarkerSize*o,u-e.scaledMarkerSize*o,e.scaledMarkerSize*2*o,e.scaledMarkerSize*2*o),e.appearance.marker.icon&&e.iconVisible&&e.imageHash&&e.appearance.marker.iconSize&&this.imageCache[e.imageHash]){let d=this.imageCache[e.imageHash],f=(e.scaledMarkerSize-e.scaledIconPadding)*o,m=e.appearance.marker.iconFit,v=f,b=f,w="".concat(e.imageHash,"_").concat(m);if(this.imageDimensionsCache[w])v=this.imageDimensionsCache[w].width,b=this.imageDimensionsCache[w].height;else{let A=d.width*o,E=d.height*o;if(m==="contain"){let I=Math.sqrt(A**2+E**2),C=f/I;v=A*C,b=E*C}if(m==="cover"){let I=f/A,C=f/E,T=Math.max(I,C);v=A*T,b=E*T}}n.save(),n.beginPath(),n.arc(s,u,f/2,0,2*Math.PI),n.closePath(),((a=(r=e?.appearance)==null?void 0:r.marker)==null?void 0:a.iconOverflow)!=="visible"&&n.clip(),n.drawImage(d,s-v/2,u-b/2,v,b),n.restore()}e.style.textLabelVisible&&e.style.textAlign!=null&&e.style.left!=null&&e.style.top!=null&&n.drawImage(this.textCache[e.id][e.style.textAlign],s+e.style.left*o,u+e.style.top*o),n.restore()}};l(poe,"TwoDDrawSystem");var iCe=poe;R();R();var ZI=class dv{constructor(){D(this,"loader"),this.loader=new qP}static getInstance(){return dv.instance||(dv.instance=new dv),dv.instance}getLoader(){return this.loader}load(e){return new Promise((t,n)=>{this.loader.load(e,t,void 0,n)})}};l(ZI,"TextureLoaderSingleton"),D(ZI,"instance");var nCe=ZI,ZA=nCe.getInstance();function doe(i,e){let t=i.components[2],n=i.components[1];return t!=null&&t.hover?[n.hoverColor||e,n.hoverColor||e]:[n.color,n.topColor||n.color]}l(doe,"processColor");var Gf,fv,foe=class extends xr{constructor(e,t){super(),ge(this,Gf),D(this,"state"),D(this,"convertTo3DMapPosition"),D(this,"textureLoadingCache",new Map),this.convertTo3DMapPosition=t,this.state=e}setShading(e,t){e.material&&e.material.setGradientShading(t.start,t.end,t.intensity)}processTextures(e,t,n){var r;if(t.texture!==e.texture&&t.texture!==""&&St(this,Gf,fv).call(this,t.texture,e,"texture"),t.topTexture!==e.topTexture&&t.topTexture!==""&&St(this,Gf,fv).call(this,t.topTexture,e,"topTexture"),(e.texture==null||e.topTexture==null)&&Array.isArray((r=e.feature.properties)==null?void 0:r.textures)&&e.feature.properties.textures.length>0)for(let a of e.feature.properties.textures)a.face==="top"&&e.topTexture!==a.path?St(this,Gf,fv).call(this,a.path,e,"topTexture"):a.face==="side"&&e.texture!==a.path&&St(this,Gf,fv).call(this,a.path,e,"texture"),e.blendTexture=!0;(e.texture!=null||e.topTexture!=null)&&(n!=null&&n.hover&&e.texturesVisible?e.hideTextures():e.texturesVisible||e.showTextures(),t.texture===""&&e.removeSideTexture(),t.topTexture===""&&e.removeTopTexture())}update(){var e,t,n,r,a,o,s,u;let h,d,f;for(let m of this.state.geometry3DIdsInScene)if(f=this.state.geometry3DMap.get(m),f instanceof Io&&f.type==="geometry-group"){let v=f.components[0];if(f.userData.shadingDirty){let b=f.userData.entities3D.values().next().value;if(b==null)continue;let w=this.state.geometry3DMap.get(b);w instanceof lr&&(w.type==="geometry"||w.type==="custom-geometry")&&(h=w.components[0],f.userData.shadingDirty&&v.shading&&this.setShading(h,v.shading));let A,E;for(let I of f.userData.entities3D.values())A=this.state.geometry3DMap.get(I),E=A.components[0],A.type==="geometry"&&E.detached&&f.userData.shadingDirty&&v.shading&&this.setShading(E,v.shading);f.userData.shadingDirty=!1}if(v.dirty){let b=f.getfirstChildEntityId();if(b){let A=this.state.geometry3DMap.get(b),E=A?.components[0];E instanceof vs&&this.processTextures(E,v)}let w=v.opacity*y1(f);f.getOpacity()!==w&&f.setOpacity(w),v.dirty=!1}}else if(f&&(f.type==="geometry"||f.type==="custom-geometry")&&((e=f.components[1])!=null&&e.dirty||(t=f.components[2])!=null&&t.dirty)){let v=f.components[0],b=f.components[1];d=f.components[2];let w=doe(f,this.state.hoverColor);if(v.setColor(w[0],w[1]),b.visible!==v.visible&&(v.visible=b.visible,v instanceof vs&&v.textMesh)){let E=this.state.geometry3DMap.get(v.textMesh.userData.entityId);E?.type==="text3d"&&E.components[0].polygonEntityId!=null&&(E.components[0].visible=b.visible)}b.altitude!==v.altitude&&(v.altitude=b.altitude);let A=b.opacity*y1(f);A!==v.opacity&&(v.opacity=A),b.renderOrder!==v.renderOrder&&(v.renderOrder=b.renderOrder),b.dirty=!1,v instanceof vs&&this.processTextures(v,b,d),f.components[2]&&(f.components[2].dirty=!1)}else if(f?.type==="model")f.components[1].dirty&&(ZD(f),f.components[1].dirty=!1),f.components[0].positionDirty&&(ooe(f,this.convertTo3DMapPosition),f.components[0].positionDirty=!1);else if(f?.type==="image"&&(n=f.components[1])!=null&&n.dirty){h=f.components[0];let v=f.components[1];v.visible!==h.visible&&(h.visible=v.visible),v.dirty=!1}else if(f?.type==="text3d"&&(r=f.components[1])!=null&&r.dirty&&f.components[0].polygonEntityId!=null){h=f.components[0];let v=f.components[1];v.visible!=null&&v.visible!==h.visible&&(h.visible=v.visible);let{textMesh:b}=h;if(b){Object.assign(b,v.getState());let w=(a=v.hoverColor)!=null?a:this.state.text3dHoverColor;b.color=v.hoverByPolygon?w:(o=v.color)!=null?o:Hv.color,b.outlineColor=v.hoverByPolygon?w:(s=v.outlineColor)!=null?s:Hv.outlineColor,b.strokeColor=v.hoverByPolygon?w:(u=v.strokeColor)!=null?u:Hv.strokeColor}v.dirty=!1}}destroy(){this.textureLoadingCache.forEach(async e=>{(await e).dispose()}),this.textureLoadingCache.clear()}};Gf=new WeakSet,fv=l(async function(i,e,t){if(!(!i||!e.showTextures))if(this.textureLoadingCache.has(i)){t==="topTexture"?e.topTexture=await this.textureLoadingCache.get(i):e.texture=await this.textureLoadingCache.get(i),e.showTextures();return}else{let n=new Promise((r,a)=>{ZA.getLoader().load(i,o=>{t==="topTexture"?e.topTexture=o:e.texture=o,e.showTextures(),this.publish("texture-loaded"),r(o)},void 0,()=>{nt.error("Failed to load texture: ".concat(i)),a("Failed to load texture: ".concat(i))})});this.textureLoadingCache.set(i,n)}},"#loadTexture"),l(foe,"DrawSystem");var rCe=foe;R();var moe=class extends xr{constructor(e){super(),D(this,"state"),D(this,"animating",new Map),D(this,"isAnimating",!1),D(this,"startTime",-1),D(this,"showDuration",300),D(this,"hideDuration",250),D(this,"update",l(()=>{this.animating.clear();let t,n;for(let r of this.state.geometry2DIdsInScene)t=this.state.geometry2DMap.get(r),t&&(n=t.components[0],n instanceof Km&&(n.visibilityNeedsUpdate==="show"?(n.canShow=!0,this.animating.set(n,[n.opacity,1])):n.visibilityNeedsUpdate==="hide"&&this.animating.set(n,[n.opacity,0])));this.startTime=performance.now(),this.publish("animate:2d")},"update")),D(this,"playAnimations"),this.state=e,this.playAnimations=this._playAnimations}_playAnimations(){let e=performance.now();for(let[t,[n,r]]of this.animating.entries()){let a=r===1?this.showDuration:this.hideDuration,o=(e-this.startTime)/a;t.opacity=bg(o,0,1,n,r,r===0?$L:NQ),e-this.startTime>=a&&(r===1?t.canShow=!0:r===0&&(t.canShow=!1),t.visibilityNeedsUpdate=!1,this.animating.delete(t))}this.publish("draw:2d"),this.animating.size>0&&this.publish("animate:2d")}};l(moe,"TwoDVisibilitySystem");var aCe=moe;R();var goe=class extends xr{constructor(e,t,n,r,a,o,s){super(),D(this,"state"),D(this,"renderer"),D(this,"mode"),D(this,"scene"),D(this,"cameraObject"),D(this,"viewCamera"),D(this,"systems"),D(this,"needs2DRecompute",!1),D(this,"twoDdirty",!0),D(this,"threeDdirty",!0),D(this,"frameId",null),D(this,"twoDFrameId",null),D(this,"animationFrameId",null),D(this,"nextFrame",null),D(this,"update",l((u=!1)=>{var h;if(((h=this.renderer)==null?void 0:h.renderer)==null)return Promise.resolve();if(u){let d=this.commitRenderState();return this.paint(),d}else return this.frameId?Promise.resolve():new Promise((d,f)=>{this.frameId=requestAnimationFrame(()=>{var m,v;return((m=this.renderer)==null?void 0:m.renderer)==null?d():this.mode==="standalone"?(v=this.commitRenderState())==null?void 0:v.then(()=>{this.paint(),d()}).catch(b=>{f(b)}):d()})})},"update")),D(this,"animate2D",l(()=>{this.animationFrameId=requestAnimationFrame(()=>{this.animationFrameId=null,this.systems.twoDVisiblitySystem.playAnimations()})},"animate2D")),D(this,"drawEntities2D",l(()=>{this.twoDFrameId||(this.twoDFrameId=requestAnimationFrame(()=>{this.twoDFrameId=null,this.systems.twoDDrawSystem.update(this.systems.cameraSystem.getZoomLevel())}))},"drawEntities2D")),D(this,"updateEntities2D",l(()=>{this.twoDFrameId&&(cancelAnimationFrame(this.twoDFrameId),this.twoDFrameId=null),this.twoDFrameId=requestAnimationFrame(()=>{this.twoDFrameId=null,this.systems.watermarkSystem.insertIntoQuadTree(this.systems.collisionSystem.interactiveCollidersQTree),this.systems.interactionSystem.updateQuadtree(this.systems.collisionSystem.interactiveCollidersQTree),this.systems.twoDVisiblitySystem.update(),this.systems.twoDDrawSystem.update(this.systems.cameraSystem.getZoomLevel()),this.systems.domDrawSystem.update(this.systems.cameraSystem.isUserInteracting())})},"updateEntities2D")),D(this,"commitRenderState",l(()=>{try{let u=[];this.frameId=null,this.publish("pre-render"),this.state.internalTweenGroup.update(),this.state.externalTweenGroup.update(),(this.mode==="outdoors-interleaved"||this.mode==="standalone")&&this.systems.cameraSystem.update(),this.state.shouldMeasureCanvas&&(this.state.shouldMeasureCanvas=!1,this.publish("measure-canvas")),this.twoDdirty&&(this.state.geometry2DIdsInScene.clear(),fee(this.state.entityScene,this.state.geometry2DIdsInScene),this.systems.domVisiblitySystem.dirty=!0,this.systems.collisionSystem.collidersDirty=!0,this.systems.domMutationSystem.dirty=!0,this.systems.panBoundsSystem.dirty=!0,this.twoDdirty=!1),this.threeDdirty&&(this.state.geometry3DIdsInScene.clear(),this.state.geometryGroupIdsToLoad.clear(),dee(this.state.entityScene,this.state.geometry3DIdsInScene,this.state.geometryGroupIdsToLoad),this.threeDdirty=!1,this.systems.interactionSystem.dirty3D=!0,this.systems.panBoundsSystem.dirty=!0,this.systems.outlineInterpolationSystem.geometries3DDirty=!0,this.systems.geometryInFocusSystem.focusablesDirty=!0);let h=this.systems.meshOptimizationSystem.update();h&&u.push(h),this.systems.meshModificationSystem.update(),this.systems.meshDetachmentSystem.update(),this.systems.imageSystem.update(this.systems.cameraSystem.getRotation()),u.push(this.systems.text3DSystem.update(this.systems.cameraSystem.getRotation())),this.systems.customGeometrySystem.update(),this.systems.panBoundsSystem.update(),this.systems.geometryInFocusSystem.update(this.systems.cameraSystem.isCameraMoving(),this.systems.cameraSystem.lastCameraStoppedMovingTime()),this.systems.stackSystem.update(),this.systems.outlineInterpolationSystem.update(this.systems.cameraSystem.getZoomLevel(),this.systems.cameraSystem.zoomDirty),this.systems.pathSystem.update(this.systems.cameraSystem.minZoomAltitude,this.systems.cameraSystem.maxZoomAltitude,this.systems.cameraSystem.getZoomAltitude(),this.systems.cameraSystem.getRotation()),this.systems.cameraSystem.postRender(),this.systems.domVisiblitySystem.update(),this.systems.domMutationSystem.update(),this.systems.twoDProjectionSystem.update(),this.systems.occlusion2DSystem.update(),this.systems.twoDDrawSystem.update(this.systems.cameraSystem.getZoomLevel()),this.systems.domDrawSystem.update(this.systems.cameraSystem.isUserInteracting()),this.systems.watermarkSystem.update();let d=this.needs2DRecompute;return this.nextFrame=requestAnimationFrame(()=>{this.systems.collisionSystem.update(this.systems.watermarkSystem.width,this.systems.watermarkSystem.height,this.systems.watermarkSystem.options.position,!d)}),this.systems.drawSystem.update(),this.systems.geometryDisposalSystem.update(),this.systems.cameraSystem.dirty=!1,this.systems.cameraSystem.zoomDirty=!1,this.systems.cameraSystem.rotationDirty=!1,this.systems.cameraSystem.stateDirty&&(this.publish("camera-state-change"),this.systems.cameraSystem.stateDirty=!1),this.publish("post-render"),Promise.all(u)}catch(u){return Promise.reject(u)}},"commitRenderState")),this.renderer=e,this.state=t,this.mode=n,this.scene=r,this.cameraObject=a,this.viewCamera=o,this.systems=s,this.systems.collisionSystem.on("visibility-changed",this.updateEntities2D),this.systems.twoDVisiblitySystem.on("draw:2d",this.drawEntities2D),this.systems.twoDVisiblitySystem.on("animate:2d",this.animate2D),this.systems.cameraSystem.on("pan-start",()=>this.needs2DRecompute=!1),this.systems.cameraSystem.on("zoom-start",()=>this.needs2DRecompute=!1),this.systems.cameraSystem.on("zoom-end",()=>this.needs2DRecompute=!0),this.systems.cameraSystem.on("rotate-start",()=>this.needs2DRecompute=!1),this.systems.cameraSystem.on("rotate-end",()=>this.needs2DRecompute=!0)}paint(){var e;(e=this.renderer)!=null&&e.renderer&&(this.mode==="standalone"&&this.renderer.clear(),this.renderer.render(this.scene,this.state.useStandaloneCamera||this.mode==="standalone"?this.cameraObject:this.viewCamera))}destroy(){this.frameId&&cancelAnimationFrame(this.frameId),this.twoDFrameId&&cancelAnimationFrame(this.twoDFrameId),this.animationFrameId&&cancelAnimationFrame(this.animationFrameId),this.nextFrame&&cancelAnimationFrame(this.nextFrame),this.state.geometry2DIdsInScene.clear(),this.state.geometry3DIdsInScene.clear(),this.systems.domVisiblitySystem.dirty=!0,this.systems.collisionSystem.collidersDirty=!0,this.update(),this.systems.collisionSystem.off("visibility-changed",this.updateEntities2D),this.systems.twoDVisiblitySystem.off("draw:2d",this.drawEntities2D),this.systems.twoDVisiblitySystem.off("animate:2d",this.animate2D)}};l(goe,"RenderSystem");var oCe=goe;R();var sCe=$e.object({interactive:$e.boolean().optional(),id:$e.string().optional(),nearRadius:$e.number().optional(),farRadius:$e.number().optional(),accentColor:$e.string().optional(),displayArrowsOnPath:$e.boolean().optional(),animateArrowsOnPath:$e.boolean().optional(),nearZoomLevel:$e.number().optional(),farZoomLevel:$e.number().optional(),visibleThroughGeometry:$e.boolean().optional(),dashed:$e.boolean().optional()}),lCe=$e.object({type:$e.enum(["Feature"]),geometry:XD,properties:$e.object({parentId:$e.any().optional()})});function yoe(i,e){$e.object({features:$e.array(lCe)}).parse(i),sCe.parse(e)}l(yoe,"validatePath");var wb,voe=class{constructor(e,t){D(this,"type","path"),D(this,"mesh",new jg),D(this,"material"),D(this,"geometry"),D(this,"outline"),D(this,"feature"),D(this,"options"),D(this,"nearRadius",.2),D(this,"farRadius",.4),D(this,"nearZoomLevel"),D(this,"farZoomLevel"),D(this,"nearZoomAltitude"),D(this,"farZoomAltitude"),D(this,"accentColor","blue"),D(this,"completeFraction",1),D(this,"altitudeAdjustment",1),D(this,"displayArrowsOnPath",!1),D(this,"animateArrowsOnPath",!1),D(this,"visibleThroughGeometry",!1),D(this,"dashed",!1),D(this,"isVertical",!1),D(this,"dirty",!0),D(this,"materialDirty",!0),D(this,"position",new Ee),ge(this,wb,0);var n,r,a,o,s,u,h;this.feature=e,this.options=t||{},this.accentColor=(n=t?.accentColor)!=null?n:this.accentColor,this.nearRadius=(r=t?.nearRadius)!=null?r:this.nearRadius,this.farRadius=(a=t?.farRadius)!=null?a:this.farRadius,this.nearZoomLevel=t?.nearZoomLevel,this.farZoomLevel=t?.farZoomLevel,this.displayArrowsOnPath=(o=t?.displayArrowsOnPath)!=null?o:this.displayArrowsOnPath,this.animateArrowsOnPath=(s=t?.animateArrowsOnPath)!=null?s:this.animateArrowsOnPath,this.visibleThroughGeometry=(u=t?.visibleThroughGeometry)!=null?u:this.visibleThroughGeometry,this.dashed=(h=t?.dashed)!=null?h:this.dashed}setColor(){}setOpacity(){}set visible(e){this.mesh&&(this.mesh.visible=e)}get visible(){return this.mesh?this.mesh.visible:!1}get altitude(){return y(this,wb)}set altitude(e){this.mesh&&(this.mesh.position.z=e,Ce(this,wb,e))}set complete(e){this.material&&(this.material.uniforms.complete.value=e,this.material.needsUpdate=!0)}};wb=new WeakMap,l(voe,"PathComponent");var Ab=voe;R();var _oe=class{constructor(e){D(this,"rendererState"),this.rendererState=e}update(){let e;for(let t of this.rendererState.geometry3DIdsInScene)if(e=this.rendererState.geometry3DMap.get(t),e instanceof Kn&&e.components[0]){let n=e.components[0];if(n.dirty){for(let r of e.children)(r instanceof Io||r instanceof Kn)&&(r.userData.entityId!==e.components[0].activeId?r.setVisible(!1):r.setVisible(!0));n.dirty=!1}}}};l(_oe,"StackSystem");var uCe=_oe;R();R();R();var so=Object.freeze({Linear:Object.freeze({None:l(function(i){return i},"None"),In:l(function(i){return i},"In"),Out:l(function(i){return i},"Out"),InOut:l(function(i){return i},"InOut")}),Quadratic:Object.freeze({In:l(function(i){return i*i},"In"),Out:l(function(i){return i*(2-i)},"Out"),InOut:l(function(i){return(i*=2)<1?.5*i*i:-.5*(--i*(i-2)-1)},"InOut")}),Cubic:Object.freeze({In:l(function(i){return i*i*i},"In"),Out:l(function(i){return--i*i*i+1},"Out"),InOut:l(function(i){return(i*=2)<1?.5*i*i*i:.5*((i-=2)*i*i+2)},"InOut")}),Quartic:Object.freeze({In:l(function(i){return i*i*i*i},"In"),Out:l(function(i){return 1- --i*i*i*i},"Out"),InOut:l(function(i){return(i*=2)<1?.5*i*i*i*i:-.5*((i-=2)*i*i*i-2)},"InOut")}),Quintic:Object.freeze({In:l(function(i){return i*i*i*i*i},"In"),Out:l(function(i){return--i*i*i*i*i+1},"Out"),InOut:l(function(i){return(i*=2)<1?.5*i*i*i*i*i:.5*((i-=2)*i*i*i*i+2)},"InOut")}),Sinusoidal:Object.freeze({In:l(function(i){return 1-Math.sin((1-i)*Math.PI/2)},"In"),Out:l(function(i){return Math.sin(i*Math.PI/2)},"Out"),InOut:l(function(i){return .5*(1-Math.sin(Math.PI*(.5-i)))},"InOut")}),Exponential:Object.freeze({In:l(function(i){return i===0?0:Math.pow(1024,i-1)},"In"),Out:l(function(i){return i===1?1:1-Math.pow(2,-10*i)},"Out"),InOut:l(function(i){return i===0?0:i===1?1:(i*=2)<1?.5*Math.pow(1024,i-1):.5*(-Math.pow(2,-10*(i-1))+2)},"InOut")}),Circular:Object.freeze({In:l(function(i){return 1-Math.sqrt(1-i*i)},"In"),Out:l(function(i){return Math.sqrt(1- --i*i)},"Out"),InOut:l(function(i){return(i*=2)<1?-.5*(Math.sqrt(1-i*i)-1):.5*(Math.sqrt(1-(i-=2)*i)+1)},"InOut")}),Elastic:Object.freeze({In:l(function(i){return i===0?0:i===1?1:-Math.pow(2,10*(i-1))*Math.sin((i-1.1)*5*Math.PI)},"In"),Out:l(function(i){return i===0?0:i===1?1:Math.pow(2,-10*i)*Math.sin((i-.1)*5*Math.PI)+1},"Out"),InOut:l(function(i){return i===0?0:i===1?1:(i*=2,i<1?-.5*Math.pow(2,10*(i-1))*Math.sin((i-1.1)*5*Math.PI):.5*Math.pow(2,-10*(i-1))*Math.sin((i-1.1)*5*Math.PI)+1)},"InOut")}),Back:Object.freeze({In:l(function(i){var e=1.70158;return i===1?1:i*i*((e+1)*i-e)},"In"),Out:l(function(i){var e=1.70158;return i===0?0:--i*i*((e+1)*i+e)+1},"Out"),InOut:l(function(i){var e=2.5949095;return(i*=2)<1?.5*(i*i*((e+1)*i-e)):.5*((i-=2)*i*((e+1)*i+e)+2)},"InOut")}),Bounce:Object.freeze({In:l(function(i){return 1-so.Bounce.Out(1-i)},"In"),Out:l(function(i){return i<.36363636363636365?7.5625*i*i:i<.7272727272727273?7.5625*(i-=.5454545454545454)*i+.75:i<.9090909090909091?7.5625*(i-=.8181818181818182)*i+.9375:7.5625*(i-=.9545454545454546)*i+.984375},"Out"),InOut:l(function(i){return i<.5?so.Bounce.In(i*2)*.5:so.Bounce.Out(i*2-1)*.5+.5},"InOut")}),generatePow:l(function(i){return i===void 0&&(i=4),i=i<Number.EPSILON?Number.EPSILON:i,i=i>1e4?1e4:i,{In:l(function(e){return Math.pow(e,i)},"In"),Out:l(function(e){return 1-Math.pow(1-e,i)},"Out"),InOut:l(function(e){return e<.5?Math.pow(e*2,i)/2:(1-Math.pow(2-e*2,i))/2+.5},"InOut")}},"generatePow")}),mv=l(function(){return performance.now()},"now"),YI=function(){function i(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._tweens={},this._tweensAddedDuringUpdate={},this.add.apply(this,e)}return l(i,"Group"),i.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},i.prototype.removeAll=function(){this._tweens={}},i.prototype.add=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=0,a=t;r<a.length;r++){var o=a[r];(e=o._group)===null||e===void 0||e.remove(o),o._group=this,this._tweens[o.getId()]=o,this._tweensAddedDuringUpdate[o.getId()]=o}},i.prototype.remove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0,r=e;n<r.length;n++){var a=r[n];a._group=void 0,delete this._tweens[a.getId()],delete this._tweensAddedDuringUpdate[a.getId()]}},i.prototype.allStopped=function(){return this.getAll().every(function(e){return!e.isPlaying()})},i.prototype.update=function(e,t){e===void 0&&(e=mv()),t===void 0&&(t=!0);var n=Object.keys(this._tweens);if(n.length!==0)for(;n.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<n.length;r++){var a=this._tweens[n[r]],o=!t;a&&a.update(e,o)===!1&&!t&&this.remove(a)}n=Object.keys(this._tweensAddedDuringUpdate)}},i}(),Pm={Linear:l(function(i,e){var t=i.length-1,n=t*e,r=Math.floor(n),a=Pm.Utils.Linear;return e<0?a(i[0],i[1],n):e>1?a(i[t],i[t-1],t-n):a(i[r],i[r+1>t?t:r+1],n-r)},"Linear"),Bezier:l(function(i,e){for(var t=0,n=i.length-1,r=Math.pow,a=Pm.Utils.Bernstein,o=0;o<=n;o++)t+=r(1-e,n-o)*r(e,o)*i[o]*a(n,o);return t},"Bezier"),CatmullRom:l(function(i,e){var t=i.length-1,n=t*e,r=Math.floor(n),a=Pm.Utils.CatmullRom;return i[0]===i[t]?(e<0&&(r=Math.floor(n=t*(1+e))),a(i[(r-1+t)%t],i[r],i[(r+1)%t],i[(r+2)%t],n-r)):e<0?i[0]-(a(i[0],i[0],i[1],i[1],-n)-i[0]):e>1?i[t]-(a(i[t],i[t],i[t-1],i[t-1],n-t)-i[t]):a(i[r?r-1:0],i[r],i[t<r+1?t:r+1],i[t<r+2?t:r+2],n-r)},"CatmullRom"),Utils:{Linear:l(function(i,e,t){return(e-i)*t+i},"Linear"),Bernstein:l(function(i,e){var t=Pm.Utils.Factorial;return t(i)/t(e)/t(i-e)},"Bernstein"),Factorial:function(){var i=[1];return function(e){var t=1;if(i[e])return i[e];for(var n=e;n>1;n--)t*=n;return i[e]=t,t}}(),CatmullRom:l(function(i,e,t,n,r){var a=(t-i)*.5,o=(n-e)*.5,s=r*r,u=r*s;return(2*e-2*t+a+o)*u+(-3*e+3*t-2*a-o)*s+a*r+e},"CatmullRom")}},xoe=function(){function i(){}return l(i,"Sequence"),i.nextId=function(){return i._nextId++},i._nextId=0,i}(),JI=new YI,dh=function(){function i(e,t){this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=so.Linear.None,this._interpolationFunction=Pm.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=xoe.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1,this._object=e,typeof t=="object"?(this._group=t,t.add(this)):t===!0&&(this._group=JI,JI.add(this))}return l(i,"Tween"),i.prototype.getId=function(){return this._id},i.prototype.isPlaying=function(){return this._isPlaying},i.prototype.isPaused=function(){return this._isPaused},i.prototype.getDuration=function(){return this._duration},i.prototype.to=function(e,t){if(t===void 0&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t<0?0:t,this},i.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},i.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},i.prototype.start=function(e,t){if(e===void 0&&(e=mv()),t===void 0&&(t=!1),this._isPlaying)return this;if(this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var n in this._valuesStartRepeat)this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var a in this._valuesEnd)r[a]=this._valuesEnd[a];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},i.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},i.prototype._setupProperties=function(e,t,n,r,a){for(var o in n){var s=e[o],u=Array.isArray(s),h=u?"array":typeof s,d=!u&&Array.isArray(n[o]);if(!(h==="undefined"||h==="function")){if(d){var f=n[o];if(f.length===0)continue;for(var m=[s],v=0,b=f.length;v<b;v+=1){var w=this._handleRelativeValue(s,f[v]);if(isNaN(w)){d=!1,console.warn("Found invalid interpolation list. Skipping.");break}m.push(w)}d&&(n[o]=m)}if((h==="object"||u)&&s&&!d){t[o]=u?[]:{};var A=s;for(var E in A)t[o][E]=A[E];r[o]=u?[]:{};var f=n[o];if(!this._isDynamic){var I={};for(var E in f)I[E]=f[E];n[o]=f=I}this._setupProperties(A,t[o],f,r[o],a)}else(typeof t[o]>"u"||a)&&(t[o]=s),u||(t[o]*=1),d?r[o]=n[o].slice().reverse():r[o]=t[o]||0}}},i.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},i.prototype.end=function(){return this._goToEnd=!0,this.update(this._startTime+this._duration),this},i.prototype.pause=function(e){return e===void 0&&(e=mv()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this)},i.prototype.resume=function(e){return e===void 0&&(e=mv()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this)},i.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},i.prototype.group=function(e){return e?(e.add(this),this):(console.warn("tween.group() without args has been removed, use group.add(tween) instead."),this)},i.prototype.remove=function(){var e;return(e=this._group)===null||e===void 0||e.remove(this),this},i.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},i.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},i.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},i.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},i.prototype.easing=function(e){return e===void 0&&(e=so.Linear.None),this._easingFunction=e,this},i.prototype.interpolation=function(e){return e===void 0&&(e=Pm.Linear),this._interpolationFunction=e,this},i.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},i.prototype.onStart=function(e){return this._onStartCallback=e,this},i.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},i.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},i.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},i.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},i.prototype.onStop=function(e){return this._onStopCallback=e,this},i.prototype.update=function(e,t){var n=this,r;if(e===void 0&&(e=mv()),t===void 0&&(t=i.autoStartOnUpdate),this._isPaused)return!0;var a;if(!this._goToEnd&&!this._isPlaying)if(t)this.start(e,!0);else return!1;if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var o=e-this._startTime,s=this._duration+((r=this._repeatDelayTime)!==null&&r!==void 0?r:this._delayTime),u=this._duration+this._repeat*s,h=l(function(){if(n._duration===0||o>u)return 1;var w=Math.trunc(o/s),A=o-w*s,E=Math.min(A/n._duration,1);return E===0&&o===n._duration?1:E},"calculateElapsedPortion"),d=h(),f=this._easingFunction(d);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,f),this._onUpdateCallback&&this._onUpdateCallback(this._object,d),this._duration===0||o>=this._duration)if(this._repeat>0){var m=Math.min(Math.trunc((o-this._duration)/s)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=m);for(a in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[a]=="string"&&(this._valuesStartRepeat[a]=this._valuesStartRepeat[a]+parseFloat(this._valuesEnd[a])),this._yoyo&&this._swapEndStartRepeatValues(a),this._valuesStart[a]=this._valuesStartRepeat[a];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=s*m,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var v=0,b=this._chainedTweens.length;v<b;v++)this._chainedTweens[v].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},i.prototype._updateProperties=function(e,t,n,r){for(var a in n)if(t[a]!==void 0){var o=t[a]||0,s=n[a],u=Array.isArray(e[a]),h=Array.isArray(s),d=!u&&h;d?e[a]=this._interpolationFunction(s,r):typeof s=="object"&&s?this._updateProperties(e[a],o,s,r):(s=this._handleRelativeValue(o,s),typeof s=="number"&&(e[a]=o+(s-o)*r))}},i.prototype._handleRelativeValue=function(e,t){return typeof t!="string"?t:t.charAt(0)==="+"||t.charAt(0)==="-"?e+parseFloat(t):parseFloat(t)},i.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],n=this._valuesEnd[e];typeof n=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(n):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=t},i.autoStartOnUpdate=!1,i}();xoe.nextId;var pu=JI;pu.getAll.bind(pu);pu.removeAll.bind(pu);pu.add.bind(pu);pu.remove.bind(pu);pu.update.bind(pu);R();R();R();var hCe=l((i,e)=>(e-i+Math.PI)%(Math.PI*2)+Math.PI*2%(Math.PI*2)-Math.PI,"differenceBetweenAngles"),cCe=l((i,e)=>new ft(i.clientX-e.offsetLeft,i.clientY-e.offsetTop),"getTouchPos"),YR=l((i,e)=>Math.atan2(e.y-i.y,e.x-i.x),"angle"),L_=l((i,e)=>Math.sqrt((e.y-i.y)**2+(e.x-i.x)**2),"distance"),JR=l((i,e)=>new ft((i.x+e.x)/2,(i.y+e.y)/2),"average"),KR=l(i=>{let e=0,{wheelDelta:t,detail:n}=i;return t!==void 0?e=t:n!==void 0&&(e=-n),e},"getScrollDelta"),boe=class{constructor(e,t){D(this,"input1"),D(this,"input2"),D(this,"lastAngle"),D(this,"lastDistance"),D(this,"totalDistance"),D(this,"first"),D(this,"second"),this.input1=e,this.input2=t,this.lastAngle=YR(e,t),this.lastDistance=L_(e,t),this.totalDistance=0,this.first=e,this.second=t}update(e,t){let n=L_(e,t);this.input1=e,this.input2=t;let r=YR(e,t);this.lastAngle=r,this.lastDistance=n,this.totalDistance+=(L_(this.first,e)+L_(this.second,t))/2,this.first=JR(this.first,e),this.second=JR(this.second,t)}};l(boe,"InputSet");var pCe=boe;R();var woe=class{constructor(e,t,n){D(this,"touch"),D(this,"camera"),D(this,"cameraPlane"),D(this,"viewCoordinate"),D(this,"snapHolderMatrix"),D(this,"snapCamera"),D(this,"cameraPosition"),D(this,"raycaster"),D(this,"worldCoordinate"),D(this,"snapshotted",!1),this.touch=e,this.camera=t,this.cameraPlane=n,this.viewCoordinate={x:e.x,y:e.y},this.camera.updateMatrixWorld(),this.camera.updateMatrix(),this.snapHolderMatrix=this.camera.matrixWorld.clone(),this.snapCamera=this.camera.clone(),this.snapshotCameraState()}snapshotCameraState(){this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.cameraPosition=this.camera.position.clone();let e=new ft(this.viewCoordinate.x,this.viewCoordinate.y);this.raycaster=this.raycaster||new Z1,this.raycaster.setFromCamera(e,this.snapCamera);let t=this.raycaster.intersectObject(this.cameraPlane,!0);this.worldCoordinate=t&&t.length>0?t[0].point:null,this.snapshotted=!0}updateAnchorState(e,t){this.camera=e,this.snapCamera=e.clone(),this.snapHolderMatrix=e.matrixWorld.clone(),this.updateViewCoordinate(t),this.snapshotCameraState()}updateViewCoordinate(e){this.viewCoordinate={x:e.x,y:e.y}}reUnproject(){var e,t;let n=new ft(this.viewCoordinate.x,this.viewCoordinate.y);(e=this.raycaster)==null||e.setFromCamera(n,this.snapCamera);let r=(t=this.raycaster)==null?void 0:t.intersectObject(this.cameraPlane,!0)[0];return r?r.point:void 0}};l(woe,"TouchAnchor");var QR=woe,Hp={};xh(Hp,{BLOCK_MERCATOR_ZOOM_LEVEL:()=>mCe,CLIPPING_RADIUS:()=>Sb,CONTROL_OPTIONS:()=>fCe,DEFAULT_ANIMATION_DURATION:()=>Eoe,DEFAULT_BEARING:()=>xCe,DEFAULT_MAX_ZOOM_LEVEL:()=>vCe,DEFAULT_MIN_ZOOM_LEVEL:()=>Ioe,DEFAULT_PITCH:()=>_Ce,DEFAULT_ZOOM_LEVEL:()=>yCe,EVENTS:()=>eT,MAPLIBRE_TILE_SIZE:()=>dCe,MAX_LAT:()=>Soe,MAX_MERCATOR_ZOOM_LEVEL:()=>QI,MIN_LAT:()=>Aoe,MIN_MERCATOR_ZOOM_LEVEL:()=>KI,ROOM_MERCATOR_ZOOM_LEVEL:()=>gCe,TWO_PI:()=>Moe,WHEEL_ZOOM_MULTIPLIER:()=>Coe,ZRANGE:()=>gv});R();var dCe=512,Aoe=-85.051129,Soe=85.051129,Sb=1e4,fCe={chain:"chain",cancel:"cancel"},Moe=Math.PI*2,gv=100,Coe=1e4,KI=0,QI=24,mCe=17,gCe=20,Eoe=200,eT=["change","pan-start","pan-end","rotate-start","rotate-end","zoom-start","zoom-end","multi-start","multi-end","multi-cancel","pedestal-start","pedestal-change","pedestal-end","user-pan-start","user-pedestal-start","user-rotate-start","user-dolly-start","user-zoom-start","user-tilt-start","user-pan-end","user-pedestal-end","user-rotate-end","user-dolly-end","user-zoom-end","user-tilt-end","position-updated","zoom-updated","tilt-updated","rotation-updated"],yCe=18,Ioe=12,vCe=22,_Ce=0,xCe=0;R();function tT(i){i&&(i.map&&(i.map.dispose(),i.map=void 0),i.dispose())}l(tT,"scrubMaterial");function Ra(i){for(let e=i.children.length-1;e>=0;e--)Ra(i.children[e]);"geometry"in i&&i.geometry&&i.geometry.dispose(),i.parent&&i.parent.remove(i),"material"in i&&Array.isArray(i.material)?i.material.forEach(function(e){tT(e)}):"material"in i&&typeof i.material<"u"&&tT(i.material)}l(Ra,"destroyObject3D");var e8=!1,iT,nT=class extends xr{constructor(e,t,n,r,a){super(),D(this,"dirty",!1),D(this,"zoomDirty",!1),D(this,"rotationDirty",!1),D(this,"panDirty",!1),D(this,"stateDirty",!1),ge(this,iT,Ioe),D(this,"zoomSpeed",5),D(this,"rotateSpeed",100),D(this,"enabled",!0),D(this,"enableZoom",!0),D(this,"enablePan",!0),D(this,"enablePedestal",!1),D(this,"maxPedestal",1/0),D(this,"minPedestal",0),D(this,"enableRotate",!0),D(this,"minZoomAltitude",0),D(this,"maxZoomAltitude",1/0),D(this,"ignoreZoomLimits",!1),D(this,"zoomFactor",1),D(this,"panBounds",{min:new Ee(1/0,1/0),max:new Ee(-1/0,-1/0),center:new Ee(0,0,0),radius:1/0}),D(this,"minTilt",0),D(this,"maxTilt",1.2),D(this,"MOUSE_BUTTONS",{ORBIT:sS.RIGHT,ZOOM:sS.MIDDLE,PAN:sS.LEFT}),D(this,"camera"),D(this,"scene"),D(this,"renderer"),D(this,"elevation"),D(this,"orbit"),D(this,"cameraPlane"),D(this,"raycaster",new Z1),D(this,"rendererState"),D(this,"options"),D(this,"state",-1),D(this,"intersection"),D(this,"viewState",null),D(this,"tweens",new Map),D(this,"clock",new Hce(!0)),D(this,"coords",{mouse:new ft,rotateStart:new ft,rotateEnd:new ft,rotateDelta:new ft,panStart:new Ee,panCameraStart:new Ee,panEnd:new Ee,panDelta:new Ee,initialShiftPos:new ft,initialPedestal:0,floorAnchor:new Ee}),D(this,"touch",{origin:{offsetLeft:0,offsetTop:0},touches:[],anchor1:null,anchor2:null,inputs:null}),D(this,"scrollTimer",null),D(this,"lastWheelTime",0),D(this,"resetZoom",!1),D(this,"zoomStart"),D(this,"pedestalScaleFactor",1),D(this,"isUserZooming",!1),D(this,"stayInsideBounds",!0),D(this,"userInteracting",!1),D(this,"cameraMoving",!1),D(this,"lastCameraMoveTime",Date.now()),D(this,"raycastToFloor",l(o=>{this.raycaster.setFromCamera(o,this.camera);let s=this.raycaster.intersectObject(this.cameraPlane,!1)[0];return s?s.point:new Ee},"raycastToFloor")),D(this,"isUserInteracting",l(()=>this.userInteracting,"isUserInteracting")),D(this,"getPosition",l(()=>new Ee(this.orbit.position.x,this.orbit.position.y,this.orbit.position.z),"getPosition")),D(this,"getPedestal",l(()=>this.orbit.position.z,"getPedestal")),D(this,"pan",l((o,s)=>{isNaN(o)||isNaN(s)||(this.setPosition(this.orbit.position.x+o,this.orbit.position.y+s),this.publish("position-updated"))},"pan")),D(this,"postRender",l(()=>{(this.state===2||this.state===6)&&(this.raycaster.setFromCamera(this.coords.mouse,this.camera),this.intersection=this.raycaster.intersectObject(this.cameraPlane,!1)[0],this.intersection&&(this.coords.panStart.set(this.intersection.point.x,this.intersection.point.y,0),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0))),this.state===3&&this.resetZoom&&(this.resetZoom=!1,this.zoomStart=this.getZoomAltitude(),this.coords.floorAnchor=this.raycastToFloor(this.coords.mouse),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0)),this.state===7&&this.isAnimating===!1&&(this.state=-1,this.publish("multi-end"))},"postRender")),D(this,"isCameraMoving",l(()=>this.cameraMoving,"isCameraMoving")),D(this,"lastCameraStoppedMovingTime",l(()=>this.lastCameraMoveTime,"lastCameraStoppedMovingTime")),D(this,"setPosition",l((o,s)=>{o===void 0||s===void 0||isNaN(o)||isNaN(s)||(this.state===-1&&this.publish("pan-start"),this.updateCameraPosition(o,s),this.publish("position-updated"),this.publish("change"),this.state===-1&&this.publish("pan-end"),this.dirty=!0,this.stateDirty=!0)},"setPosition")),D(this,"updateCameraPosition",l((o,s)=>{let u=o-this.panBounds.center.x,h=s-this.panBounds.center.y,d=Math.sqrt(u*u+h*h);if(this.stayInsideBounds&&d>this.panBounds.radius){let f=Math.atan2(h,u),m={x:Math.cos(f)*this.panBounds.radius+this.panBounds.center.x,y:Math.sin(f)*this.panBounds.radius+this.panBounds.center.y};this.orbit.position.x=m.x,this.orbit.position.y=m.y}else this.orbit.position.x=o,this.orbit.position.y=s},"updateCameraPosition")),D(this,"tilt",l(o=>{if(isNaN(o))return;this.state===-1&&this.publish("rotate-start");let s=this.stayInsideBounds?Math.max(Math.min(o+this.getTilt(),this.maxTilt),this.minTilt):o+this.getTilt();s!==this.elevation.rotation.x&&(this.elevation.rotation.x=s,this.publish("tilt-updated")),this.publish("change"),this.state===-1&&this.publish("rotate-end"),this.stateDirty=!0},"tilt")),D(this,"zoomIn",l((o,s,u)=>{let h=this.getZoomAltitude();this.animateCamera({zoom:h/1.5},o,s,u)},"zoomIn")),D(this,"zoomOut",l((o,s,u)=>{let h=this.getZoomAltitude();this.animateCamera({zoom:h*1.5},o,s,u)},"zoomOut")),D(this,"getRotation",l(()=>(-this.orbit.rotation.z+Math.PI*2)%(Math.PI*2),"getRotation")),D(this,"cancelAnimation",l(()=>{let o=Array.from(this.tweens.keys()),s=o[o.length-1];s.state===7&&this.publish("multi-cancel",{zooming:!0,rotating:!0,tilting:!0}),this.completeTween(s)},"cancelAnimation")),D(this,"animateCamera",l((o,s,u,h,d,f)=>{let m=Me({interruptible:!0},f),v={},b={},w=this.getPosition();if(o.position!=null&&(o.position.x!==void 0&&(v.x=w.x,b.x=o.position.x),o.position.y!==void 0&&(v.y=w.y,b.y=o.position.y),o.position.z!==void 0&&(v.z=w.z,b.z=o.position.z)),o.zoom!==void 0&&(v.zoom=this.stayInsideBounds?Math.min(Math.max(this.getZoomAltitude(),this.getZoomScaledMin()),this.getZoomScaledMax()):this.getZoomAltitude(),this.viewState==="multi_floor"||!this.stayInsideBounds?b.zoom=o.zoom:b.zoom=Math.min(Math.max(o.zoom,this.getZoomScaledMin()),this.getZoomScaledMax())),o.rotation!==void 0){let{start:B,end:N}=UL(this.getRotation(),o.rotation);v.rotation=B,b.rotation=N}o.tilt!==void 0&&(v.tilt=this.getTilt(),this.viewState==="multi_floor"||!this.stayInsideBounds?b.tilt=o.tilt:b.tilt=Math.max(Math.min(o.tilt,this.maxTilt),this.minTilt));let A=v.zoom!==b.zoom,E=v.rotation!==b.rotation,I=v.tilt!==b.tilt,C=new dh(v).to(b,mr.env.TESTING?0:s).onUpdate(B=>{this.setMulti({x:B.x,y:B.y,z:B.z},B.zoom,B.rotation,B.tilt)}).onComplete(()=>{this.completeTween(C),this.publish("multi-end",{zooming:A,rotating:E,tilting:I}),h&&h()}).onStart(()=>{this.state!==7&&(this.state=7,C.state=7,this.publish("multi-start",{zooming:A,rotating:E,tilting:I})),this.publish("change")});this.rendererState.internalTweenGroup.add(C);let T=Array.from(this.tweens.entries()),k=T[T.length-1],F=!1;return k!=null&&(k[1].interruptible?(typeof k[1].cancelledCallback=="function"&&k[1].cancelledCallback(),this.completeTween(k[0])):(F=!0,k[0].chain(C))),this.tweens.set(C,{cancelledCallback:d,interruptible:m.interruptible}),u?C.easing(u):C.easing(so.Quadratic.In),!o.doNotAutoStart&&!F&&(C.start(),this.publish("change")),C.cameraAnimation=!0,C},"animateCamera")),D(this,"setMulti",l((o,s,u,h,d=!0)=>{this.state===-1&&this.publish("multi-start");let f=!1;o!=null&&(o.x!==void 0&&!isNaN(o.x)&&o.y!==void 0&&!isNaN(o.y)&&(this.updateCameraPosition(o.x,o.y),f=!0),o.z!==void 0&&!isNaN(o.z)&&(this.setPedestal(o.z,!0,!1),f=!0)),f&&this.publish("position-updated");let m={zooming:!1,tilting:!!s,rotating:!1};if(s!==void 0&&!isNaN(s)){let v=this.stayInsideBounds?Math.min(Math.max(s,this.getZoomScaledMin()),this.getZoomScaledMax()):s;v!==this.camera.position.z&&(m.zooming=!0,this.camera.position.z=v,this.publish("zoom-updated"),this.zoomDirty=!0,this.viewState==="multi_floor"?s>Sb&&(this.camera.near=s-Sb,this.camera.far=s+Sb):(this.camera.near=s/gv,this.camera.far=s*gv),this.camera.updateProjectionMatrix())}if(u!==void 0&&!isNaN(u)&&u!==this.getRotation()&&(m.rotating=!0,this.orbit.rotation.z=-u,this.publish("rotation-updated")),h!==void 0&&!isNaN(h)){let v=this.stayInsideBounds?Math.max(Math.min(h,this.maxTilt),this.minTilt):h;v!==this.elevation.rotation.x&&(m.tilting=!0,this.elevation.rotation.x=v,this.publish("tilt-updated"))}d&&this.publish("change"),this.state===-1&&this.publish("multi-end",m),this.stateDirty=!0},"setMulti")),D(this,"getZoomScaledMin",l(()=>this.minZoomAltitude*this.zoomFactor,"getZoomScaledMin")),D(this,"getZoomScaledMax",l(()=>{let o=this.minZoomAltitude*this.zoomFactor;return Math.max(this.maxZoomAltitude,o)},"getZoomScaledMax")),D(this,"setRotation",l((o,s)=>{if(isNaN(o))return;this.state===-1&&!s&&this.publish("rotate-start");let u=-(o%Moe);u!==this.orbit.rotation.z&&(this.orbit.rotation.z=u,s||this.publish("rotation-updated")),s||this.publish("change"),this.state===-1&&!s&&this.publish("rotate-end"),this.dirty=!0,this.rotationDirty=!0,s||(this.stateDirty=!0)},"setRotation")),D(this,"setZoomAltitude",l(o=>{if(isNaN(o))return;this.state===-1&&this.publish("zoom-start");let s=this.stayInsideBounds?Math.min(Math.max(o,this.getZoomScaledMin()),this.getZoomScaledMax()):o;s!==this.camera.position.z&&(this.camera.position.z=s,this.publish("zoom-updated"),this.zoomDirty=!0),this.camera.near=s/gv,this.camera.far=s*gv,this.camera.updateProjectionMatrix(),this.publish("change"),this.state===-1&&this.publish("zoom-end"),this.dirty=!0,this.stateDirty=!0},"setZoomAltitude")),D(this,"setZoomLevel",l(o=>{this.setZoomAltitude(this.convertZoomLevelToAltitude(o))},"setZoomLevel")),D(this,"getZoomAltitude",l(()=>this.camera.position.z,"getZoomAltitude")),D(this,"getZoomLevel",l(()=>this.convertAltitudeToZoomLevel(this.getZoomAltitude()),"getZoomLevel")),D(this,"setTilt",l((o,s)=>{if(isNaN(o))return;this.state===-1&&!s&&this.publish("rotate-start");let u=this.stayInsideBounds?Math.max(Math.min(o,this.maxTilt),this.minTilt):o;u!==this.elevation.rotation.x&&(this.elevation.rotation.x=u,s||this.publish("tilt-updated")),s||this.publish("change"),this.state===-1&&!s&&this.publish("rotate-end"),this.dirty=!0,s||(this.stateDirty=!0)},"setTilt")),D(this,"getTilt",l(()=>this.elevation.rotation.x,"getTilt")),D(this,"setCameraPlaneElevation",l(o=>{this.cameraPlane.position.z=o},"setCameraPlaneElevation")),D(this,"zoom",l(o=>{if(isNaN(o))return;this.state===-1&&this.publish("zoom-start");let s=this.getZoomAltitude()-o;this.camera.position.z=this.stayInsideBounds?Math.min(Math.max(s,this.minZoomAltitude*this.zoomFactor),this.maxZoomAltitude*this.zoomFactor):s,this.publish("zoom-updated"),this.zoomDirty=!0,this.publish("change"),this.state===-1&&this.publish("zoom-end"),this.stateDirty=!0},"zoom")),D(this,"getProjectionScaleFactor",l((o,s,u)=>SE(o,s,u),"getProjectionScaleFactor")),D(this,"update",l(()=>{this.orbit.updateMatrixWorld(),this.lastWheelTime>0&&this.state===3&&this.clock.getElapsedTime()-this.lastWheelTime>.2&&(this.lastWheelTime=0,this.state=-1,this.publish("zoom-end"),this.removeMouseMoveEventListeners())},"update")),D(this,"setPedestal",l((o,s=!1,u=!0)=>{typeof o=="number"&&!isNaN(o)&&(this.orbit.position.z=o,s&&(this.publishPedestalChangeEvent(o),this.publish("pedestal-change",{pedestal:o})),this.publish("change"),this.dirty=!0,u&&(this.stateDirty=!0))},"setPedestal")),D(this,"dispose",l(()=>{for(let o of eT)o.endsWith("start")?(this.off(o,this.setCameraMoving),o.startsWith("user")&&this.off(o,this.setUserInteracting)):(o.endsWith("end")||o.endsWith("cancel"))&&(this.off(o,this.unsetCameraMoving),o.startsWith("user")&&this.off(o,this.unsetUserInteracting));this.removeEventListeners(),this.scene.remove(this.cameraPlane)},"dispose")),D(this,"createCameraPlane",l(()=>{let o=1e10,s=1,u=new Cd(o,o,s,s),h=new _l({color:0,wireframe:e8,visible:e8}),d=new ln(u,h);return this.scene.add(d),d},"createCameraPlane")),D(this,"addEventListeners",l(()=>{let{domElement:o}=this.renderer;for(let s of eT)s.endsWith("start")?(this.on(s,this.setCameraMoving),s.startsWith("user")&&this.on(s,this.setUserInteracting)):(s.endsWith("end")||s.endsWith("cancel"))&&(this.on(s,this.unsetCameraMoving),s.startsWith("user")&&this.on(s,this.unsetUserInteracting));o.addEventListener("contextmenu",this.onContextMenu,!1),o.addEventListener("mousedown",this.onMouseDown,!1),o.addEventListener("wheel",this.onMouseWheel,{passive:!1}),o.addEventListener("touchstart",this.onTouchStart,!1),o.addEventListener("touchend",this.onTouchEnd,!1),o.addEventListener("touchmove",this.onTouchMove,!1)},"addEventListeners")),D(this,"addMouseEventListeners",l(()=>{this.addMouseMoveEventListeners(),window.addEventListener("mouseup",this.onMouseUp,!1),window.addEventListener("mouseout",this.onMouseUp,!1)},"addMouseEventListeners")),D(this,"addMouseMoveEventListeners",l(()=>{this.renderer.domElement.addEventListener("mousemove",this.onMouseMove,!1)},"addMouseMoveEventListeners")),D(this,"removeMouseMoveEventListeners",l(()=>{this.renderer.domElement.removeEventListener("mousemove",this.onMouseMove,!1)},"removeMouseMoveEventListeners")),D(this,"removeEventListeners",l(()=>{let{domElement:o}=this.renderer;o.removeEventListener("contextmenu",this.onContextMenu,!1),o.removeEventListener("mousedown",this.onMouseDown,!1),o.removeEventListener("wheel",this.onMouseWheel,!1),o.removeEventListener("touchstart",this.onTouchStart,!1),o.removeEventListener("touchend",this.onTouchEnd,!1),o.removeEventListener("touchmove",this.onTouchMove,!1),o.removeEventListener("mousemove",this.onMouseMove,!1),window.removeEventListener("mouseup",this.onMouseUp,!1),window.removeEventListener("mouseout",this.onMouseUp,!1)},"removeEventListeners")),D(this,"removeMouseUpEventListeners",l(()=>{this.renderer.domElement.removeEventListener("mousemove",this.onMouseMove,!1),window.removeEventListener("mouseup",this.onMouseUp,!1),window.removeEventListener("mouseout",this.onMouseUp,!1)},"removeMouseUpEventListeners")),D(this,"onContextMenu",l(o=>{o.preventDefault()},"onContextMenu")),D(this,"onMouseUp",l(()=>{if(this.enabled!==!1){switch(this.removeMouseUpEventListeners(),this.state){case 2:this.publish("pan-end"),this.publish("user-pan-end");break;case 1:this.publish("zoom-end"),this.publish("user-dolly-end");break;case 0:this.publish("rotate-end"),this.publish("user-rotate-end");break;case 8:this.publish("pedestal-end"),this.publish("user-pedestal-end");break}this.state=-1,this.panDirty=!1}},"onMouseUp")),D(this,"onMouseMove",l(o=>{if(this.enabled!==!1)if(o.preventDefault(),this.mouseToScene(o),this.state===0){if(this.enableRotate===!1)return;this.handleMouseMoveRotate(o)}else if(this.state===2){if(this.enablePan===!1)return;this.handleMouseMovePan()}else this.state===3?(this.resetZoom=!0,this.state=-1):this.state===8&&this.handleMouseMovePedestal(o)},"onMouseMove")),D(this,"onTouchStart",l(o=>{if(this.enabled!==!1){switch(this.updateTouchOrigin(),this.touchToScene(o),o.touches.length){case 1:this.enablePedestal?(this.handleTouchStartPedestal(o),this.state=9):this.enablePan&&(this.handleTouchStartPan(o),this.state=6);break;case 2:this.touch.inputs=new pCe(this.touch.touches[0],this.touch.touches[1]);break;default:this.state=-1}this.state}},"onTouchStart")),D(this,"onTouchMove",l(o=>{if(this.enabled!==!1)switch(this.touchToScene(o),o.touches.length){case 2:o.preventDefault(),o.stopPropagation();let s=Me({},this.touch.inputs.first),u=Me({},this.touch.inputs.second),h=new ft(this.touch.touches[0].x,this.touch.touches[0].y),d=new ft(this.touch.touches[1].x,this.touch.touches[1].y);if(this.touch.inputs.update(this.touch.touches[0],this.touch.touches[1]),this.enableRotate&&this.state===4)this.handleTouchMoveTilt(o);else if(this.state===5)this.handleTouchMoveDolly();else if(this.state!==5&&this.touch.inputs.totalDistance>.05){let f=s.y<h.y&&u.y<d.y,m=s.y>h.y&&u.y>d.y;this.enableRotate&&this.state!==4&&(m||f)?(this.handleTouchStartTilt(o),this.state=4):(this.handleTouchStartDolly(),this.state=5)}break;case 1:(this.enablePedestal||this.enablePan)&&(o.preventDefault(),o.stopPropagation()),this.enablePedestal&&this.state===9?this.handleTouchMovePedestal(o):this.enablePan&&this.state===6&&this.handleTouchMovePan(o);break;default:this.state=-1}},"onTouchMove")),D(this,"onTouchEnd",l(o=>{if(this.enabled!==!1){switch(this.handleTouchEnd(),this.state){case 2:case 6:this.publish("user-pan-end");break;case 4:this.publish("pan-end"),this.publish("user-tilt-end");break;case 1:case 5:this.publish("zoom-end"),this.publish("user-dolly-end");break;case 0:this.publish("rotate-end"),this.publish("user-rotate-end");break;case 8:case 9:this.publish("pedestal-end"),this.publish("user-pedestal-end");break}o.touches.length?this.onTouchStart(o):this.state=-1}},"onTouchEnd")),D(this,"handleTouchMovePan",l(o=>{let s=Object.hasOwn(o,"x")?new ft(o.x,o.y):this.touch.touches[0],u=this.raycastToFloor(s);this.coords.panEnd.set(u.x,u.y,0),this.coords.panDelta.subVectors(this.coords.panEnd,this.coords.panStart),this.setPosition(this.coords.panCameraStart.x-this.coords.panDelta.x,this.coords.panCameraStart.y-this.coords.panDelta.y),this.publish("change"),this.panDirty=!0},"handleTouchMovePan")),D(this,"handleTouchStartDolly",l(()=>{let o=this.touch.touches[0].x-this.touch.touches[1].x,s=this.touch.touches[0].y-this.touch.touches[1].y;this.zoomStart=this.getZoomAltitude();let u=new ft(this.touch.touches[0].x-o/2,this.touch.touches[0].y-s/2);this.coords.floorAnchor=this.raycastToFloor(u),this.orbit.updateMatrixWorld(),this.touch.anchor1=new QR(this.touch.touches[0],this.camera,this.cameraPlane),this.touch.anchor2=new QR(this.touch.touches[1],this.camera,this.cameraPlane),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0),this.publish("user-dolly-start"),this.publish("zoom-start"),this.publish("multi-start")},"handleTouchStartDolly")),D(this,"handleMouseMovePan",l(()=>{let o=this.raycastToFloor(this.coords.mouse);this.coords.panEnd.set(o.x,o.y,0),this.coords.panDelta.subVectors(this.coords.panEnd,this.coords.panStart),this.setPosition(this.coords.panCameraStart.x-this.coords.panDelta.x,this.coords.panCameraStart.y-this.coords.panDelta.y),this.publish("change"),this.panDirty=!0},"handleMouseMovePan")),D(this,"handleTouchStartTilt",l(o=>{this.coords.rotateStart.set(o.touches[1].clientX,o.touches[1].clientY),this.publish("user-tilt-start"),this.publish("rotate-start")},"handleTouchStartTilt")),D(this,"handleTouchMovePedestal",l(o=>{this.handleMouseMovePedestal(o.touches[0])},"handleTouchMovePedestal")),D(this,"handleTouchMoveTilt",l(o=>{this.coords.rotateEnd.set(o.touches[1].clientX,o.touches[1].clientY),this.coords.rotateDelta.subVectors(this.coords.rotateEnd,this.coords.rotateStart),this.setTilt(this.getTilt()-this.coords.rotateDelta.y/this.rotateSpeed),this.coords.rotateStart.copy(this.coords.rotateEnd)},"handleTouchMoveTilt")),D(this,"handleTouchMoveDolly",l(()=>{let o=this.touch.inputs.first,s=this.touch.inputs.second;this.touch.anchor1.viewCoordinate={x:o.x,y:o.y},this.touch.anchor2.viewCoordinate={x:s.x,y:s.y};let u=this.makeTransformFromTouchAnchors(this.touch.anchor1,this.touch.anchor2);u&&this.setCameraFromTransformMatrix(u),this.orbit.updateMatrixWorld(),this.touch.anchor1.updateAnchorState(this.camera,o),this.touch.anchor2.updateAnchorState(this.camera,s)},"handleTouchMoveDolly")),D(this,"handleTouchEnd",l(()=>{this.state===4||this.state===5?this.publish("multi-end"):this.state===6&&this.publish("pan-end"),this.panDirty=!1},"handleTouchEnd")),D(this,"handleTouchStartPan",l(o=>{let s=Object.hasOwn(o,"x")?new ft(o.x,o.y):this.touch.touches[0],u=this.raycastToFloor(s);this.coords.panStart.set(u.x,u.y,0),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0),this.publish("user-pan-start"),this.publish("pan-start")},"handleTouchStartPan")),D(this,"handleTouchStartPedestal",l(o=>{this.handleMouseDownPedestal(o.touches[0])},"handleTouchStartPedestal")),D(this,"onMouseDown",l(o=>{if(this.enabled!==!1){if(this.mouseToScene(o),o.preventDefault(),this.state===3&&this.publish("zoom-end"),o.button===this.MOUSE_BUTTONS.ORBIT){if(this.enableRotate===!1)return;this.handleMouseDownRotate(o),this.state=0}else o.button===this.MOUSE_BUTTONS.PAN&&(this.enablePan?(this.handleMouseDownPan(),this.state=2):this.enablePedestal&&(this.handleMouseDownPedestal(o),this.state=8));this.state!==-1&&this.addMouseEventListeners()}},"onMouseDown")),D(this,"onMouseWheel",l(o=>{this.enabled===!1||this.enableZoom===!1||this.state!==-1&&this.state!==3||(o.preventDefault(),o.stopPropagation(),this.mouseToScene(o),this.canScrollZoom(o)&&(this.lastWheelTime=this.clock.getElapsedTime(),this.publishUserZoomEvent()),this.state!==3&&this.canScrollZoom(o)&&(this.addMouseMoveEventListeners(),this.state=3,this.zoomStart=this.getZoomAltitude(),this.coords.floorAnchor=this.raycastToFloor(this.coords.mouse),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0),this.publish("zoom-start")),this.scrollTimer!=null&&clearTimeout(this.scrollTimer),this.scrollTimer=setTimeout(()=>{this.publish("zoom-end")},50),this.handleMouseWheel(o))},"onMouseWheel")),D(this,"handleMouseWheel",l(o=>{if(this.publish("zoom-start"),!this.canScrollZoom(o)){this.lastWheelTime>0&&this.publish("zoom-end"),this.lastWheelTime=0,this.state=-1;return}let s=this.getZoomAltitude(),u=s-KR(o)*s/Coe*this.zoomSpeed;if(this.setZoomAltitude(u),this.enablePan){let h=u/this.zoomStart;this.coords.panDelta.subVectors(this.coords.floorAnchor,this.coords.panCameraStart).multiplyScalar(1-h),this.setPosition(this.coords.panCameraStart.x+this.coords.panDelta.x,this.coords.panCameraStart.y+this.coords.panDelta.y)}this.publish("change")},"handleMouseWheel")),D(this,"setCameraFromTransformMatrix",l(o=>{this.orbit.updateMatrixWorld();let s=new Wo;s.setFromRotationMatrix(o,"ZYX");let u=(o.elements[14]-this.cameraPlane.position.z)/Math.cos(s.x),h=s.z,d=new Ee(0,0,1);d.applyEuler(s),d.setLength(u);let f=new Ee;f.setFromMatrixPosition(o),f.sub(d),this.enablePan&&this.setPosition(f.x,f.y),this.enableZoom&&this.setZoomAltitude(u),this.enableRotate&&this.setRotation(-h)},"setCameraFromTransformMatrix")),D(this,"makeTransformFromTouchAnchors",l((o,s)=>{this.orbit.updateMatrixWorld(),this.camera.updateProjectionMatrix();let u=this.camera.projectionMatrix.clone(),h=o.worldCoordinate,d=s.worldCoordinate,f=o.reUnproject(),m=s.reUnproject();if(!f||!m||!h||!d)return null;let v=o.viewCoordinate,b=s.viewCoordinate,w=d.x-h.x,A=d.y-h.y,E=Math.atan2(A,w),I=m.x-f.x,C=m.y-f.y,T=Math.atan2(C,I),k=hCe(E,T),F=new qi;F.makeRotationZ(-k);let B=F.clone();B.multiply(o.snapHolderMatrix);let N=l((Kt,Vt,hi)=>Kt.elements[(Vt-1)*4+hi-1],"m"),z=N(u,1,1)*N(B,1,1)-v.x*N(u,3,4)*N(B,3,1),L=N(u,1,1)*N(B,1,2)-v.x*N(u,3,4)*N(B,3,2),j=N(u,1,1)*N(B,1,3)-v.x*N(u,3,4)*N(B,3,3),q=h.x*z+h.y*L+h.z*j,Z=N(u,2,2)*N(B,2,1)-v.y*N(u,3,4)*N(B,3,1),O=N(u,2,2)*N(B,2,2)-v.y*N(u,3,4)*N(B,3,2),Y=N(u,2,2)*N(B,2,3)-v.y*N(u,3,4)*N(B,3,3),J=h.x*Z+h.y*O+h.z*Y,oe=N(u,1,1)*N(B,1,1)-b.x*N(u,3,4)*N(B,3,1),$=N(u,1,1)*N(B,1,2)-b.x*N(u,3,4)*N(B,3,2),K=N(u,1,1)*N(B,1,3)-b.x*N(u,3,4)*N(B,3,3),te=d.x*oe+d.y*$+d.z*K,ve=N(u,2,2)*N(B,2,1)-b.y*N(u,3,4)*N(B,3,1),Q=N(u,2,2)*N(B,2,2)-b.y*N(u,3,4)*N(B,3,2),he=N(u,2,2)*N(B,2,3)-b.y*N(u,3,4)*N(B,3,3),se=d.x*ve+d.y*Q+d.z*he,Ae=Math.abs(oe-z),Ie=Math.abs($-L),we=Math.abs(K-j),Ne=Math.abs(oe-Z),je=Math.abs($-O),Ve=Math.abs(K-Y),Le=Math.abs(ve-z),xe=Math.abs(Q-L),Ue=Math.abs(he-j),de=Math.abs(ve-Z),ut=Math.abs(Q-O),ot=Math.abs(he-Y),He=Math.min(Ae+Ie+we,Ne+je+Ve),Ke=Math.min(Le+xe+Ue,de+ut+ot);He<Ke&&(oe=ve,$=Q,K=he,te=se);let Lt=Z*j-z*Y,_t=O*j-L*Y,pe=J*j-q*Y,re=oe*Y-Z*K,ke=$*Y-O*K,at=te*Y-J*K,ct=(at*_t-pe*ke)/(re*_t-Lt*ke),rt=(at*Lt-pe*re)/(ke*Lt-_t*re),Qe=O*z-L*Z,At=Y*z-j*Z,Dt=J*z-q*Z,vt=$*Z-O*oe,yt=K*Z-Y*oe,jt=((te*Z-J*oe)*Qe-Dt*vt)/(yt*Qe-At*vt),Wt=B.clone();return Wt.elements[12]=ct,Wt.elements[13]=rt,Wt.elements[14]=jt,jt>0?Wt:null},"makeTransformFromTouchAnchors")),D(this,"updateTouchOrigin",l(()=>{let o=this.renderer.domElement;this.touch.origin.offsetLeft=o.getBoundingClientRect().left,this.touch.origin.offsetTop=o.getBoundingClientRect().top},"updateTouchOrigin")),D(this,"touchToScene",l(o=>{this.touch.touches=[];for(let s=0,u=o.touches.length;s<u;s++){let h=o.touches[s],d=cCe(h,this.touch.origin);this.touch.touches.push(new ft(d.x/this.renderer.domElement.width*this.rendererState.pixelRatio*2-1,-(d.y/this.renderer.domElement.height*this.rendererState.pixelRatio)*2+1))}this.coords.mouse=this.touch.touches[0]},"touchToScene")),D(this,"canScrollZoom",l(o=>{let s=KR(o),u=this.getZoomAltitude();return!(s<0&&u===this.getZoomScaledMax()||s>0&&u===this.getZoomScaledMin())},"canScrollZoom")),D(this,"mouseToScene",l(o=>{let s=this.getMousePos(o);return this.coords.mouse.x=s.x/this.renderer.domElement.width*this.rendererState.pixelRatio*2-1,this.coords.mouse.y=-(s.y/this.renderer.domElement.height*this.rendererState.pixelRatio)*2+1,this.coords.mouse},"mouseToScene")),D(this,"getMousePos",l(o=>({x:o.offsetX,y:o.offsetY}),"getMousePos")),D(this,"handleMouseDownRotate",l(o=>{this.coords.rotateStart.set(o.clientX,o.clientY),this.publish("rotate-start"),this.publish("user-rotate-start")},"handleMouseDownRotate")),D(this,"handleMouseDownPan",l(()=>{let o=this.raycastToFloor(this.coords.mouse);this.coords.panStart.set(o.x,o.y,0),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0),this.publish("pan-start"),this.publish("user-pan-start")},"handleMouseDownPan")),D(this,"handleMouseDownPedestal",l(o=>{let s=new ft(o.clientX,o.clientY);this.coords.initialShiftPos=s,this.coords.initialPedestal=this.getPedestal(),this.pedestalScaleFactor=SE(this.camera.fov,this.renderer.domElement.clientHeight,this.getZoomAltitude()),this.publish("pedestal-start"),this.publish("user-pedestal-start")},"handleMouseDownPedestal")),D(this,"handleMouseMovePedestal",l(o=>{let s={x:o.clientX,y:o.clientY},u=this.coords.initialPedestal+this.pedestalScaleFactor*(s.y-this.coords.initialShiftPos.y);this.stayInsideBounds&&(u<this.minPedestal?u=Math.max(u,this.minPedestal):u>this.maxPedestal&&(u=Math.min(u,this.maxPedestal))),u!==this.getPedestal()&&this.setPedestal(u,!0)},"handleMouseMovePedestal")),D(this,"handleMouseMoveRotate",l(o=>{this.coords.rotateEnd.set(o.clientX,o.clientY),this.coords.rotateDelta.subVectors(this.coords.rotateEnd,this.coords.rotateStart),this.setRotation(this.getRotation()+this.coords.rotateDelta.x/this.rotateSpeed),this.setTilt(this.getTilt()-this.coords.rotateDelta.y/this.rotateSpeed),this.coords.rotateStart.copy(this.coords.rotateEnd),this.publish("change")},"handleMouseMoveRotate")),D(this,"publishUserZoomDebounced",gw(()=>{this.isUserZooming=!1,this.publish("user-zoom-end")},250)),D(this,"publishUserZoomEvent",l(()=>{this.isUserZooming?this.publishUserZoomDebounced():(this.publish("user-zoom-start"),this.isUserZooming=!0,this.publishUserZoomDebounced())},"publishUserZoomEvent")),D(this,"setCameraMoving",l(()=>{this.cameraMoving=!0},"setCameraMoving")),D(this,"unsetCameraMoving",l(()=>{this.cameraMoving=!1,this.lastCameraMoveTime=Date.now()},"unsetCameraMoving")),D(this,"setUserInteracting",l(()=>{this.userInteracting=!0},"setUserInteracting")),D(this,"unsetUserInteracting",l(()=>{this.userInteracting=!1},"unsetUserInteracting")),D(this,"publishPedestalChangeEvent",l(o=>{this.publish("pedestal-change",{pedestal:o,scrolledToTop:this.scrolledToTop,scrolledToBottom:this.scrolledToBottom,scrollPercent:this.scrollPercent})},"publishPedestalChangeEvent")),D(this,"convertAltitudeToZoomLevel",l(o=>{let[,s]=this.center,u=o*2*Math.tan(Bn.degToRad(this.camera.fov)/2)/this.options.canvasHeight,h=Math.cos(Bn.degToRad(s))*2*Math.PI*xd/u;return Bn.clamp(Math.log2(h/512),KI,QI)},"convertAltitudeToZoomLevel")),D(this,"convertZoomLevelToAltitude",l(o=>{let[,s]=this.center,u=Bn.clamp(o,KI,QI),h=Math.pow(2,u),d=Bn.clamp(s,Aoe,Soe),f=h*512;return Math.cos(Bn.degToRad(d))*Math.PI*2*xd/f*this.options.canvasHeight/2/Math.tan(Bn.degToRad(this.camera.fov)/2)},"convertZoomLevelToAltitude")),D(this,"completeTween",l(o=>{o.isPlaying()&&o.stop(),this.rendererState.internalTweenGroup.remove(o),this.tweens.delete(o)},"completeTween")),D(this,"debugContainer",new vr),this.camera=e,this.renderer=n,this.rendererState=r,this.scene=t,this.options=a,this.elevation=e.parent,this.orbit=this.elevation.parent,this.cameraPlane=this.createCameraPlane(),this.zoomStart=e.position.z,a.mode!=="outdoors-overlay"&&this.addEventListeners()}get maxZoomLevel(){return this.convertAltitudeToZoomLevel(this.minZoomAltitude)}setMaxZoomLevel(e){this.minZoomAltitude=this.convertZoomLevelToAltitude(e),this.stateDirty=!0}get defaultMinZoomLevel(){return y(this,iT)}get minZoomLevel(){return this.convertAltitudeToZoomLevel(this.maxZoomAltitude)}setMinZoomLevel(e){this.maxZoomAltitude=this.convertZoomLevelToAltitude(e),this.stateDirty=!0}get scrollPercent(){let e=this.minPedestal,t=this.maxPedestal,n=this.getPedestal();return n=Math.min(n,t),n=Math.max(n,e),(n-e)/(t-e)*100}get fov(){return this.camera.fov}get scrolledToBottom(){return this.minPedestal===0||Math.floor(this.getPedestal())<=this.minPedestal}get scrolledToTop(){return this.maxPedestal===0||Math.ceil(this.getPedestal())>=this.maxPedestal}get center(){var e,t,n,r;let a=this.getPosition(),{lat:o,lon:s}=qL((t=(e=this.rendererState.center)==null?void 0:e[1])!=null?t:0,(r=(n=this.rendererState.center)==null?void 0:n[0])!=null?r:0,a.x,a.y);return[s,o]}setCenter(e,t){var n,r,a,o;let{x:s,y:u}=XL((r=(n=this.rendererState.center)==null?void 0:n[1])!=null?r:0,(o=(a=this.rendererState.center)==null?void 0:a[0])!=null?o:0,t,e);this.setPosition(s,u)}get isAnimating(){return this.rendererState.internalTweenGroup.getAll().some(e=>e.cameraAnimation)}getCameraFrameForCoordinates(e,t){let n=t.minZoom!==void 0?t.minZoom:this.minZoomAltitude,r=t.maxZoom!==void 0?t.maxZoom:this.maxZoomAltitude,a=this.options.canvasWidth,o=this.options.canvasHeight,s=this.getRotation(),u=this.getTilt(),h=this.getPosition();this.setRotation(t.rotation||s,!0),this.setTilt(t.tilt||u,!0);let d=rT(e,{canvasWidth:a,canvasHeight:o,paddingOption:t.padding,verticalPadding:t.verticalPadding,minZoom:n,maxZoom:r,position:h,camera:this.camera,orbit:this.orbit});return this.setRotation(s,!0),this.setTilt(u,!0),{center:d.position,zoomLevel:this.convertAltitudeToZoomLevel(d.zoom)}}focusOn(e,t){let n=t.curve,r=t.callback,a=t.cancelledCallback,o=t.minZoom!==void 0?t.minZoom:this.minZoomAltitude,s=t.maxZoom!==void 0?t.maxZoom:this.maxZoomAltitude,u=this.options.canvasWidth,h=this.options.canvasHeight,d;t.duration!==void 0?d=t.duration:mr.env.TESTING==="true"?d=0:d=Eoe;let f=t.padding,m=this.getRotation(),v=this.getTilt();t.rotation!=null&&this.setRotation(t.rotation),t.tilt!=null&&this.setTilt(t.tilt);let b=rT(e,{canvasHeight:h,paddingOption:f,canvasWidth:u,minZoom:o,maxZoom:s,camera:this.camera,orbit:this.orbit,position:this.getPosition(),verticalPadding:t.verticalPadding});this.setRotation(m),this.setTilt(v),this.animateCamera({position:b.position,tilt:t.tilt,rotation:t.rotation,zoom:b.zoom},d,n,r,a,t)}resize(e,t){this.options.canvasWidth=e,this.options.canvasHeight=t}};iT=new WeakMap,l(nT,"CameraSystem"),D(nT,"CAMERA_FRAME_PADDING_SIDES",["top","bottom","left","right"]);var Toe=nT;function rT(i,{canvasWidth:e,orbit:t,paddingOption:n,verticalPadding:r=0,canvasHeight:a,minZoom:o,maxZoom:s,camera:u,position:h}){let d={zoom:o,position:h};if(i.length===0)return d;for(let de of Toe.CAMERA_FRAME_PADDING_SIDES)typeof n[de]!="number"&&(n[de]=0);let f=n.type==="portion"?{top:n.top*a,bottom:n.bottom*a,left:n.left*e,right:n.right*e}:n;if(f.left+f.right>=e||f.top+f.bottom>=a)return d;t.updateMatrixWorld();let m=u.matrixWorldInverse,v=u.fov*(Math.PI/180)/2,b=v,w=Math.atan(Math.tan(v)*(e/a)),A=new Ee(1/0,1/0,1/0),E=new Ee(-1/0,-1/0,-1/0),I=new ur,C=new Ee;for(let de=0,ut=i.length;de<ut;de++)C.copy(i[de]),I.expandByPoint(C),C.applyMatrix4(m),A.min(C),E.max(C),C.copy(i[de]),C.z-=r,C.applyMatrix4(m),A.min(C),E.max(C),C.copy(i[de]),C.z+=r,C.applyMatrix4(m),A.min(C),E.max(C);let T=E.x-A.x,k=E.y-A.y,F=e-f.left-f.right,B=a-f.top-f.bottom,N=(E.x+A.x)/2,z=(E.y+A.y)/2,L=T/F,j=k/B,q=o,Z=s,O=q*Math.tan(w)*2,Y=Z*Math.tan(w)*2,J=O/e,oe=Y/e,$=Math.max(L,j);$=Bn.clamp($,J,oe);let K=F*$,te=B*$,ve={min:{x:N-K/2-f.left*$,y:z-te/2-f.bottom*$},max:{x:N+K/2+f.right*$,y:z+te/2+f.top*$}},Q=(ve.min.x+ve.max.x)/2,he=(ve.min.y+ve.max.y)/2,se=I.getCenter(new Ee),Ae=Math.abs(Q-ve.min.x),Ie=Math.abs(he-ve.min.y),we=Ae/Math.tan(w),Ne=Ie/Math.tan(b),je=new Ee;je.set(Q,he,E.z+Math.max(we,Ne)),je.applyMatrix4(u.matrixWorld);let Ve=new Ee;Ve.set(Q,he,E.z),Ve.applyMatrix4(u.matrixWorld);let Le=new Ee().subVectors(Ve,je),xe=(se.z-je.z)/Le.z,Ue=new Ee().copy(je).add(Le.clone().multiplyScalar(xe));return Ve.set(Ue.x,Ue.y,Ue.z),je.sub(Ve),{position:Ue,zoom:je.length()}}l(rT,"getCameraFrameForPoints");R();var bCe=300,Mb,Cb,Poe=class{constructor(e){D(this,"state"),ge(this,Mb,new Ee),ge(this,Cb,new Ee),this.state=e}update(e){var t;let n,r;this.state.cameraObject.getWorldPosition(y(this,Cb));for(let a of this.state.geometry2DIdsInScene)if(n=this.state.geometry2DMap.get(a),n&&(r=n.components[0],r&&"containerEl"in r&&r.markerContainer!=null)){if(r.visibilityNeedsUpdate!==!1&&(r.visibilityNeedsUpdate==="show"?r.canShow=!0:r.canShow=!1),(r.canShow&&r.visible===!0||((t=r.animation)==null?void 0:t.pending)===!0)&&!r.offscreen)if(r.options.zIndex!=null)r.markerContainer.style.transform="translate3D(".concat(r.projection.x,"px, ").concat(r.projection.y,"px, ").concat(r.options.zIndex,"px)");else{n.object3d.getWorldPosition(y(this,Mb));let o=y(this,Cb).distanceTo(y(this,Mb));r.markerContainer.style.transform="translate3D(".concat(r.projection.x,"px, ").concat(r.projection.y,"px, ").concat(-o,"px)")}if(r.canShow===!0&&r.visible===!0?r.markerContainer.style.pointerEvents=e?"none":r.pointerEvents:r.markerContainer.style.pointerEvents="none",r.currentStrategyIndex===-1&&r.visible&&r.visibilityNeedsUpdate==="show")continue;r.visibilityNeedsUpdate!==!1&&!r.offscreen&&(r.visibilityNeedsUpdate==="show"&&(r.markerContainer.style.opacity="0"),r.animation&&r.animation.cancel(),r.animation=r.markerContainer.animate([{opacity:r.canShow&&r.visible?"1":"0"}],{duration:bCe,easing:"ease-in-out",fill:"forwards"}),r.visibilityNeedsUpdate=!1)}}};Mb=new WeakMap,Cb=new WeakMap,l(Poe,"DOMDrawSystem");var wCe=Poe;R();var Loe=class{constructor(){D(this,"percentExpanded",0),D(this,"activeId",""),D(this,"gap",20),D(this,"dirty",!0)}};l(Loe,"StackComponent");var ACe=Loe;R();var Doe=class extends xr{constructor(e,t){super(),D(this,"state"),D(this,"dirty",!0),D(this,"domTree"),D(this,"observers",new Map),D(this,"updateDimensions",l(n=>{n.forEach(r=>{var a;let o=(a=r.target.parentElement)==null?void 0:a.getAttribute("data-marker-id");if(o){let s=this.state.geometry2DMap.get(o),u=s?.components[0];s&&u instanceof Xv&&(u.updateDimensions(r.contentRect.width,r.contentRect.height),u.collisionDirty=!0)}}),this.publish("dimensions-update")},"updateDimensions")),this.state=e,this.domTree=t}setupObserver(){var e;if(this.observers){for(let r of this.observers.values())r.disconnect();this.observers.clear()}let t,n;for(let r of this.domTree.children){let a=r.getAttribute("data-marker-id");if(a!=null&&(t=this.state.geometry2DMap.get(a),n=t.components[0],(e=n.options)!=null&&e.dynamicResize)){let o=new ResizeObserver(this.updateDimensions);o.observe(n.containerEl),this.observers.set(r.userData.entityId,o)}}}update(){this.dirty&&(this.setupObserver(),this.dirty=!1)}destroy(){for(let e of this.observers.values())e.disconnect();this.observers.clear()}};l(Doe,"DOMResizeSystem");var SCe=Doe;R();var MCe=0,CCe=90;mr.env.NODE_ENV;var Pg={linear:so.Linear.None,"ease-in":so.Quadratic.In,"ease-out":so.Quadratic.Out,"ease-in-out":so.Quadratic.InOut},ECe=-50,Ei,$i,tc,Eb,Ib,aT,koe=class{constructor(e,t,n){ge(this,Ib),ge(this,Ei),ge(this,$i),ge(this,tc),ge(this,Eb),Ce(this,Ei,e),Ce(this,$i,t),Ce(this,tc,n),y(this,$i).cameraSystem.on("pedestal-change",({pedestal:r})=>{y(this,Ei).map&&(y(this,Ei).map.transform.elevation=r,y(this,Ei).map.transform.minElevationForCurrentTile=ECe,y(this,Ei).map.triggerRepaint()),y(this,$i).cameraSystem.setCameraPlaneElevation(r)})}get center(){var e,t;return y(this,Ei).mode==="outdoors-overlay"&&y(this,Ei).map?(t=(e=y(this,Ei).map).getCenter)==null?void 0:t.call(e).toArray():y(this,$i).cameraSystem.center}setCenter(e){var t;if(y(this,Ei).mode==="outdoors-overlay"&&y(this,Ei).map){(t=y(this,Ei).map)==null||t.setCenter(e),y(this,$i).interactionSystem.handleHover();return}y(this,$i).cameraSystem.setCenter(e[0],e[1]),y(this,$i).interactionSystem.handleHover()}get zoomLevel(){var e;return y(this,Ei).mode==="outdoors-overlay"&&y(this,Ei).map?(e=y(this,Ei).map)==null?void 0:e.getZoom():y(this,$i).cameraSystem.getZoomLevel()}setZoomLevel(e){var t;y(this,Ei).mode==="outdoors-overlay"&&y(this,Ei).map&&((t=y(this,Ei).map)==null||t.setZoom(e)),y(this,$i).cameraSystem.setZoomLevel($l(e,this.minZoomLevel,this.maxZoomLevel,"zoomLevel was clamped to minZoomLevel/maxZoomLevel bounds. Use mapView.Camera.setMinZoomLevel() and mapView.Camera.setMaxZoomLevel() to adjust limits."))}getState(){return{zoomLevel:this.zoomLevel,minZoomLevel:this.minZoomLevel,maxZoomLevel:this.maxZoomLevel,minPitch:this.minPitch,maxPitch:this.maxPitch,autoMinZoomLevel:this.autoMinZoomLevel,panMode:this.panMode,screenOffsets:this.insetsPadding,center:this.center,bearing:this.bearing,pitch:this.pitch,elevation:this.elevation}}get isAnimating(){return y(this,$i).cameraSystem.isAnimating}cancelAnimation(){y(this,$i).cameraSystem.cancelAnimation()}get maxZoomLevel(){return y(this,$i).cameraSystem.maxZoomLevel}get minZoomLevel(){return y(this,$i).cameraSystem.minZoomLevel}setAutoMinZoomLevel(e){y(this,$i).panBoundsSystem.autoMinZoomLevel=e,e&&(y(this,$i).panBoundsSystem.dirty=!0,y(this,$i).panBoundsSystem.update())}get autoMinZoomLevel(){return y(this,$i).panBoundsSystem.autoMinZoomLevel}setMinZoomLevel(e,t=!1){var n;t&&this.setAutoMinZoomLevel(!1);let r=$l(e,Hp.MIN_MERCATOR_ZOOM_LEVEL,this.maxZoomLevel,"setMinZoomLevel was clamped. minZoomLevel must be between ".concat(Hp.MIN_MERCATOR_ZOOM_LEVEL," and maxZoomLevel."));y(this,$i).cameraSystem.setMinZoomLevel(r),this.zoomLevel<r&&this.setZoomLevel(r),(n=y(this,Ei).map)==null||n.setMinZoom(r)}setMaxZoomLevel(e){var t;let n=$l(e,this.minZoomLevel,Hp.MAX_MERCATOR_ZOOM_LEVEL,"setMaxZoomLevel was clamped. maxZoomLevel must be between minZoomLevel and ".concat(Hp.MAX_MERCATOR_ZOOM_LEVEL,"."));y(this,$i).cameraSystem.setMaxZoomLevel(n),this.zoomLevel>n&&this.setZoomLevel(n),(t=y(this,Ei).map)==null||t.setMaxZoom(n)}get maxPitch(){var e,t;return y(this,Ei).mode==="outdoors-overlay"&&y(this,Ei).map?(t=(e=y(this,Ei).map)==null?void 0:e.getMaxPitch)==null?void 0:t.call(e):Bn.radToDeg(y(this,$i).cameraSystem.maxTilt)}get minPitch(){var e,t;return y(this,Ei).mode==="outdoors-overlay"&&y(this,Ei).map?(t=(e=y(this,Ei).map)==null?void 0:e.getMinPitch)==null?void 0:t.call(e):Bn.radToDeg(y(this,$i).cameraSystem.minTilt)}setMinPitch(e){var t;let n=Math.max(MCe,e);(t=y(this,Ei).map)==null||t.setMinPitch(n),y(this,$i).cameraSystem.minTilt=Bn.degToRad(n)}setMaxPitch(e){var t;let n=Math.min(CCe,e);(t=y(this,Ei).map)==null||t.setMaxPitch(n),y(this,$i).cameraSystem.maxTilt=Bn.degToRad(n)}get bearing(){var e;return y(this,Ei).mode==="outdoors-overlay"&&y(this,Ei).map?(e=y(this,Ei).map)==null?void 0:e.getBearing():Bn.radToDeg(y(this,$i).cameraSystem.getRotation())}setBearing(e){var t;if(y(this,Ei).mode==="outdoors-overlay"&&y(this,Ei).map){(t=y(this,Ei).map)==null||t.setBearing(e);return}y(this,$i).cameraSystem.setRotation(Bn.degToRad(e))}get pitch(){var e;return y(this,Ei).mode==="outdoors-overlay"&&y(this,Ei).map?(e=y(this,Ei).map)==null?void 0:e.getPitch():Bn.radToDeg(y(this,$i).cameraSystem.getTilt())}setPitch(e){var t;if(y(this,Ei).mode==="outdoors-overlay"&&y(this,Ei).map){(t=y(this,Ei).map)==null||t.setPitch(e);return}y(this,$i).cameraSystem.setTilt(Bn.degToRad($l(e,this.minPitch,this.maxPitch,"pitch was clamped to minPitch/maxPitch bounds. Use mapView.Camera.setMinPitch() and mapView.Camera.setMaxPitch() to adjust limits.")))}get elevation(){return y(this,$i).cameraSystem.getPedestal()}setElevation(e){y(this,$i).cameraSystem.setPedestal(e,!0)}animateElevation(e,t){return y(this,Eb)&&y(this,Eb).stop(),new Promise(n=>{var r;y(this,$i).cameraSystem.animateCamera({position:{z:e}},t?.duration||300,Pg[t?.easing||"ease-in-out"],n,n,{interruptible:(r=t?.interruptible)!=null?r:!0})})}get insetsPadding(){return y(this,tc).insetsPadding}get panMode(){return y(this,$i).cameraSystem.enablePan===!1&&y(this,$i).cameraSystem.enablePedestal===!0?"elevation":"default"}setPanMode(e){if(e!=="default"&&e!=="elevation")throw new Error("Invalid pan mode");e!==this.panMode&&(e==="default"?(y(this,$i).cameraSystem.enablePan=!0,y(this,$i).cameraSystem.enablePedestal=!1):(y(this,$i).cameraSystem.enablePan=!1,y(this,$i).cameraSystem.enablePedestal=!0))}setInsetPadding(e){y(this,tc).insetsPadding=Object.assign({},y(this,tc).insetsPadding,e)}animateTo(e){var t,n,r,a,o,s;if(y(this,Ei).mode==="outdoors-overlay"&&y(this,Ei).map)return(s=y(this,Ei).map)==null||s.flyTo({center:(t=e.center)!=null?t:this.center,zoom:(n=e.zoomLevel)!=null?n:this.zoomLevel,bearing:(r=e.bearing)!=null?r:this.bearing,pitch:(a=e.pitch)!=null?a:this.pitch,duration:(o=e.duration)!=null?o:600}),Promise.resolve();let u=e.center?y(this,Ei).convertTo3DMapPosition(e.center[1],e.center[0],e.center[2]||this.elevation):void 0,h=e.zoomLevel!==void 0?y(this,$i).cameraSystem.convertZoomLevelToAltitude($l(e.zoomLevel,this.minZoomLevel,this.maxZoomLevel,"zoomLevel was clamped to minZoomLevel/maxZoomLevel bounds. Use mapView.Camera.setMinZoomLevel() and mapView.Camera.setMaxZoomLevel() to adjust limits.")):void 0,d=e.bearing!==void 0?Bn.degToRad(e.bearing):void 0,f=e.pitch!==void 0?Bn.degToRad($l(e.pitch,this.minPitch,this.maxPitch,"pitch was clamped to minPitch/maxPitch bounds. Use mapView.Camera.setMinPitch() and mapView.Camera.setMaxPitch() to adjust limits.")):void 0;return new Promise(m=>{var v;y(this,$i).cameraSystem.animateCamera({position:u,zoom:h,rotation:d,tilt:f},e.duration||0,Pg[e.easing||"ease-in-out"],()=>{y(this,$i).interactionSystem.handleHover(),m()},m,{interruptible:(v=e?.interruptible)!=null?v:!0})})}getCameraFrameForCoordinates(e,t){let n=St(this,Ib,aT).call(this,t||{},()=>Promise.resolve()),{pointCloud:r}=oT(e,y(this,Ei),y(this,tc).geometry3DMap);if(r.length===0)return nt.error("No valid coordinates found in targets:",e),{center:this.center,zoomLevel:this.zoomLevel};let{center:a,zoomLevel:o}=y(this,$i).cameraSystem.getCameraFrameForCoordinates(r,n);return{center:y(this,Ei).convert3DMapPositionToCoordinate(a),zoomLevel:o}}focusOn(e,t){var n,r,a,o;let{pointCloud:s,geoBounds:u,firstPosition:h}=oT(e,y(this,Ei),y(this,tc).geometry3DMap);return s.length===0?(nt.error("No valid coordinates found in targets:",e),Promise.resolve()):y(this,Ei).mode==="outdoors-overlay"&&y(this,Ei).map?(s.length===1&&h?(n=y(this,Ei).map)==null||n.flyTo({center:[h[0],h[1]],duration:t?.duration||y(this,Ei).map.getBearing(),animate:!0,bearing:t?.bearing===void 0?y(this,Ei).map.getBearing():t?.bearing,pitch:t?.pitch===void 0?y(this,Ei).map.getPitch():t?.pitch,zoom:t?.maxZoomLevel||y(this,Ei).map.getMaxZoom()}):(o=y(this,Ei).map)==null||o.fitBounds(u,{duration:(r=t?.duration)!=null?r:Hp.DEFAULT_ANIMATION_DURATION,bearing:t?.bearing===void 0?y(this,Ei).map.getBearing():t?.bearing,pitch:t?.pitch===void 0?y(this,Ei).map.getPitch():t?.pitch,maxZoom:(a=t?.maxZoomLevel)!=null?a:y(this,Ei).map.getMaxZoom()}),y(this,$i).interactionSystem.handleHover(),Promise.resolve()):new Promise(d=>{y(this,$i).cameraSystem.focusOn(s,St(this,Ib,aT).call(this,t||{},d))})}};Ei=new WeakMap,$i=new WeakMap,tc=new WeakMap,Eb=new WeakMap,Ib=new WeakSet,aT=l(function(i,e){var t;return{minZoom:i?.maxZoomLevel===void 0?void 0:y(this,$i).cameraSystem.convertZoomLevelToAltitude($l(i.maxZoomLevel,this.minZoomLevel,this.maxZoomLevel,"maxZoomLevel was clamped to minZoomLevel/maxZoomLevel bounds. Use mapView.Camera.setMaxZoomLevel() to adjust limits.")),maxZoom:i?.minZoomLevel===void 0?void 0:y(this,$i).cameraSystem.convertZoomLevelToAltitude($l(i.minZoomLevel,this.minZoomLevel,this.maxZoomLevel,"minZoomLevel was clamped to minZoomLevel/maxZoomLevel bounds. Use mapView.Camera.setMinZoomLevel() to adjust limits.")),padding:i!=null&&i.padding?Object.assign({},oee,i?.padding):this.insetsPadding,curve:Pg[i?.easing||"ease-in-out"],rotation:i?.bearing===void 0?void 0:Bn.degToRad(i.bearing),tilt:i?.pitch!==void 0?Bn.degToRad($l(i.pitch,this.minPitch,this.maxPitch,"pitch was clamped to minPitch/maxPitch bounds. Use mapView.Camera.setMinPitch() and mapView.Camera.setMaxPitch() to adjust limits.")):void 0,duration:i?.duration,callback:l(()=>{y(this,$i).interactionSystem.handleHover(),e()},"callback"),cancelledCallback:e,interruptible:(t=i?.interruptible)!=null?t:!0,verticalPadding:i?.verticalPadding}},"#convertToLegacy"),l(koe,"Camera");var ICe=koe;function Tb(i,e){i[0]=Math.min(i[0],e[0]),i[1]=Math.min(i[1],e[1]),i[2]=Math.max(i[2],e[0]),i[3]=Math.max(i[3],e[1])}l(Tb,"updateBounds");function oT(i,e,t){var n;let r=[],a=[1/0,1/0,-1/0,-1/0],o=null;if(!i||!Array.isArray(i)||i.length===0)return{pointCloud:r,geoBounds:a,firstPosition:o};let s=e.getSystems().renderSystem;(s.threeDdirty||s.twoDdirty)&&e.renderSync();for(let u of i)if(typeof u=="string"){let h=t.get(u);if(!h){nt.error("Entity not found with id:",u);continue}let d=new ur;hee(e,"userData"in h&&(n=h.userData.entityId)!=null?n:h.id,r,d,h instanceof Kn?h.position.z:void 0);let f=e.convert3DMapPositionToCoordinate(d.min),m=e.convert3DMapPositionToCoordinate(d.max);Tb(a,f),Tb(a,m),o||(o=e.convert3DMapPositionToCoordinate(d.getCenter(new Ee)))}else r.push(e.convertTo3DMapPosition(u[1],u[0],u[2]||0)),Tb(a,u),o||(o=u);return{pointCloud:r,geoBounds:a,firstPosition:o}}l(oT,"processTargets");function TCe(i,e){var t,n,r,a;let o=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]],[e[0],e[1]]];(t=i.map)!=null&&t.getLayer("bounds-outline")&&i.map.removeLayer("bounds-outline"),(n=i.map)!=null&&n.getSource("bounds-source")&&i.map.removeSource("bounds-source"),(r=i.map)==null||r.addSource("bounds-source",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:o}}}),(a=i.map)==null||a.addLayer({id:"bounds-outline",type:"line",source:"bounds-source",layout:{},paint:{"line-color":"#FF0000","line-width":2,"line-opacity":.8}})}l(TCe,"drawBounds");R();R();var PCe=`uniform vec4 uSize;
varying vec2 vUv;
void main() {
  vUv = uv;
  // Scale the position by the size of the quad
  // and shift to top left corner for 0,0
	vec2 transformed = position.xy * uSize.xy - vec2(1.0, -1.0);
  // Apply width .x and height .y of image
  transformed += vec2(uSize.x, -uSize.y);
  // Apply left .w and top .z offset
  transformed += vec2(uSize.w, -uSize.z) * 2.0;
  gl_Position = vec4(transformed, 1.0, 1.0);
}`;R();var LCe=`varying vec2 vUv;
uniform sampler2D uTexture;
uniform float uOpacity;
void main() {
  #ifndef debug
  vec4 texture = texture2D(uTexture, vUv);
  gl_FragColor = vec4(texture.rgb, texture.a * uOpacity);
  #else
  gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);
  #endif
}`;R();var DCe=4.291666666666667,kCe=15,RCe=25,OCe=43/60;R();var t8=["horizontal","icon"],NCe=new Map([[t8[0],`<svg viewBox="0 0 206 48">
      <path d="M27.2678 14.2261H22.3187C21.0695 14.2261 20.4695 14.7801 20.4695 15.9852V31.142L10.3966 15.5591C9.69665 14.4784 9.2475 14.2773 7.8475 14.2261H2.97462C1.67462 14.2261 1.07631 14.7801 1.07631 15.9852V44.7665C1.07631 45.9716 1.67462 46.5256 2.97462 46.5256H7.92377C9.22207 46.5256 9.82207 45.9716 9.82207 44.7665V29.6847L19.9441 45.1926C20.695 46.3244 21.095 46.5256 22.4933 46.5256H27.2933C28.5916 46.5256 29.1916 45.9716 29.1916 44.7665V15.9852C29.1407 14.7801 28.5424 14.2261 27.2678 14.2261Z"/>
      <path d="M5.44915 10.9602C8.45863 10.9602 10.8983 8.50669 10.8983 5.48011C10.8983 2.45353 8.45863 0 5.44915 0C2.43967 0 0 2.45353 0 5.48011C0 8.50669 2.43967 10.9602 5.44915 10.9602Z"/>
      <path d="M61.7899 25.0449C63.2306 23.1903 65.078 22.2051 67.556 22.2051C72.0526 22.2051 74.7611 25.3347 74.7611 29.4511V39.2489C74.8187 39.7125 74.5306 39.9443 74.0695 39.9443H72.5136C72.0526 39.9443 71.7645 39.7125 71.8221 39.2489V29.5091C71.8221 27.1909 69.9187 25.2187 67.4984 25.2187C65.1339 25.2187 63.2323 27.1329 63.2323 29.2773V39.2489C63.2899 39.7125 63.0018 39.9443 62.5407 39.9443H60.9831C60.5221 39.9443 60.2916 39.7125 60.2916 39.2489V29.4511C60.2916 27.1329 58.3899 25.2187 56.0255 25.2187C53.7204 25.2187 51.7594 27.075 51.7594 29.2773V39.3068C51.817 39.7705 51.5289 40.0023 51.0102 40.0023H49.5119C49.0509 40.0023 48.7628 39.7705 48.7628 39.3068V23.25C48.7051 22.7864 48.9933 22.4966 49.5119 22.4966H50.9526C51.356 22.4966 51.5289 22.6704 51.5289 23.0182V24.2352C52.7407 22.9602 54.239 22.2648 56.0255 22.2648C58.4475 22.2068 60.3492 23.192 61.7899 25.0466V25.0449ZM77.1255 31.2477C77.1255 26.3216 81.1018 22.2051 86.1187 22.2051C88.539 22.2051 90.6136 23.1903 92.3441 25.1608V23.1903C92.3441 22.7267 92.5746 22.5528 93.0357 22.5528H94.4187C94.8797 22.5528 95.1102 22.7847 95.1102 23.3062V39.3648C95.1102 39.8284 94.8797 40.0602 94.4187 40.0602H93.0357C92.5746 40.0602 92.3441 39.8284 92.3441 39.4227V37.4523C90.6712 39.3648 88.5967 40.35 86.1746 40.35C81.1018 40.2341 77.1238 36.1773 77.1238 31.2477H77.1255ZM92.1136 31.2477C92.1136 27.8284 89.4611 25.2187 86.0594 25.2187C82.7746 25.2187 80.1221 27.8864 80.1221 31.2477C80.1221 34.6687 82.7746 37.2784 86.1187 37.2784C86.9062 37.2789 87.6861 37.1232 88.4138 36.8202C89.1414 36.5173 89.8026 36.0731 90.3593 35.513C90.9161 34.9528 91.3577 34.2878 91.6587 33.556C91.9597 32.8241 92.1143 32.0397 92.1136 31.2477ZM100.992 37.3943V46.3807C101.049 46.8443 100.761 47.1341 100.298 47.1341H98.7424C98.2814 47.1341 97.9933 46.9023 97.9933 46.3807V23.1903C97.9933 22.7267 98.2238 22.4369 98.7424 22.4369H100.183C100.646 22.379 100.934 22.6687 100.934 23.0744V24.9869C102.605 23.0744 104.68 22.1472 107.044 22.1472C112.002 22.1472 116.037 26.2619 116.037 31.1898C116.037 36.1176 112.059 40.2341 107.044 40.2341C104.622 40.2341 102.603 39.3068 100.992 37.3943ZM106.987 25.2187C103.7 25.2187 101.049 27.8864 101.049 31.2477C101.049 34.6687 103.7 37.2784 107.044 37.2784C110.446 37.2784 113.039 34.6108 113.039 31.2477C113.039 27.8864 110.388 25.2187 106.987 25.2187ZM121.11 37.3943V46.3807C121.168 46.8443 120.88 47.1341 120.419 47.1341H118.861C118.4 47.1341 118.112 46.9023 118.112 46.3807V23.1903C118.112 22.7267 118.342 22.4369 118.861 22.4369H120.302C120.764 22.379 121.053 22.6687 121.053 23.0744V24.9869C122.724 23.0744 124.798 22.1472 127.163 22.1472C132.12 22.1472 136.156 26.2619 136.156 31.1898C136.156 36.1176 132.178 40.2341 127.163 40.2341C124.742 40.2341 122.781 39.3068 121.11 37.3943ZM127.105 25.2187C123.819 25.2187 121.168 27.8864 121.168 31.2477C121.168 34.6687 123.819 37.2784 127.163 37.2784C130.564 37.2784 133.158 34.6108 133.158 31.2477C133.158 27.8864 130.507 25.2187 127.107 25.2187H127.105ZM153.97 32.3506H141.054C141.342 35.2483 143.995 37.4523 147.164 37.4523C148.893 37.4523 150.393 37.0466 151.719 36.0597C152.007 35.8858 152.295 35.7699 152.353 35.7699C152.583 35.7699 152.756 35.8858 152.929 36.1773L153.505 37.1625C153.622 37.3364 153.68 37.4523 153.68 37.5682C153.68 37.8 153.507 38.0318 153.103 38.3216C151.258 39.5966 149.183 40.292 146.992 40.292C141.688 40.292 137.883 36.3511 137.883 31.2477C137.883 26.204 141.803 22.2051 146.703 22.2051C151.546 22.2051 154.717 25.7983 154.717 31.0176C154.717 31.5972 154.717 32.3506 153.968 32.3506H153.97ZM141.056 30.0324H151.72C151.432 26.8432 149.473 24.929 146.648 24.929C145.241 24.8904 143.875 25.3995 142.833 26.3501C141.791 27.3007 141.154 28.6194 141.056 30.0307V30.0324ZM156.332 31.2477C156.332 26.3216 160.31 22.2051 165.326 22.2051C167.748 22.2051 169.707 23.1324 171.32 25.0449V16.2324C171.263 15.7687 171.551 15.479 172.012 15.479H173.57C174.031 15.479 174.319 15.7108 174.319 16.2324V39.3068C174.319 39.7705 174.088 40.0023 173.57 40.0023H172.129C171.666 40.0602 171.378 39.7705 171.378 39.3648V37.3943C169.649 39.3068 167.632 40.292 165.268 40.292C160.31 40.2341 156.332 36.1773 156.332 31.2477ZM171.264 31.2477C171.264 27.8284 168.612 25.2187 165.21 25.2187C161.924 25.2187 159.273 27.8864 159.273 31.2477C159.273 34.6687 161.924 37.2784 165.268 37.2784C166.057 37.2838 166.839 37.1316 167.569 36.8304C168.299 36.5292 168.962 36.0852 169.52 35.5241C170.077 34.963 170.519 34.296 170.818 33.5619C171.117 32.8277 171.268 32.0411 171.263 31.2477H171.264ZM177.72 19.0739C177.715 18.8594 177.754 18.646 177.833 18.4468C177.912 18.2476 178.031 18.0667 178.182 17.915C178.333 17.7633 178.512 17.6439 178.71 17.5642C178.909 17.4845 179.121 17.446 179.334 17.4511C179.546 17.4507 179.756 17.4923 179.952 17.5737C180.148 17.6551 180.326 17.7746 180.476 17.9254C180.626 18.0762 180.745 18.2553 180.826 18.4523C180.907 18.6494 180.948 18.8606 180.948 19.0739C180.953 19.2884 180.914 19.5017 180.835 19.7009C180.756 19.9001 180.637 20.081 180.486 20.2327C180.335 20.3845 180.156 20.5038 179.957 20.5835C179.759 20.6633 179.547 20.7017 179.334 20.6966C178.412 20.7545 177.72 20.0591 177.72 19.0739ZM177.836 39.2489V23.1903C177.836 22.7267 178.066 22.4369 178.527 22.4369H180.083C180.544 22.4369 180.832 22.6687 180.775 23.1903V39.2489C180.832 39.7125 180.544 39.9443 180.083 39.9443H178.527C178.066 39.9443 177.836 39.7125 177.836 39.2489ZM186.944 23.0165V24.1756C188.212 22.8426 189.71 22.2051 191.497 22.2051C195.937 22.2051 198.646 25.2767 198.646 29.3932V39.2489C198.703 39.7125 198.415 39.9443 197.954 39.9443H196.398C195.936 39.9443 195.705 39.7125 195.705 39.2489V29.4511C195.705 27.1329 193.803 25.2187 191.439 25.2187C189.134 25.2187 187.175 27.075 187.175 29.2773V39.3068C187.232 39.7705 186.944 40.0023 186.424 40.0023H184.868C184.407 40.0023 184.119 39.7705 184.119 39.3068V23.1903C184.061 22.7267 184.349 22.4949 184.868 22.4949H186.309C186.712 22.4949 186.944 22.6687 186.944 23.0165Z"/>
      <path d="M204 40C205.115 40 206 39.0857 206 38V37.9886C206 36.9029 205.126 36 204 36C202.885 36 202 36.9143 202 38V38.0114C202 39.0971 202.874 40 204 40ZM204 39.7829C202.989 39.7829 202.23 38.9829 202.23 38.0114V38C202.23 37.0286 203 36.2171 204 36.2171C205.011 36.2171 205.77 37.0171 205.77 37.9886V38C205.77 38.9714 205 39.7829 204 39.7829ZM203.218 38.9714H203.609V38.2743H204.034L204.517 38.9714H204.989L204.448 38.2057C204.724 38.1257 204.92 37.92 204.92 37.5886C204.92 37.1657 204.586 36.9486 204.138 36.9486H203.218V38.9714ZM203.609 37.9543V37.2914H204.103C204.368 37.2914 204.517 37.4057 204.517 37.6229C204.517 37.8171 204.368 37.9543 204.103 37.9543H203.609Z"/>
    </svg>`],[t8[1],`<svg viewBox="0 0 43 60">
      <path d="M14.0291 7.06645C14.0291 10.9691 10.8885 14.1329 7.01453 14.1329C3.14051 14.1329 0 10.9691 0 7.06645C0 3.16376 3.14051 0 7.01453 0C10.8885 0 14.0291 3.16376 14.0291 7.06645Z"/>
      <path d="M28.7335 18.3468H35.1045C36.7455 18.3468 37.5178 19.0599 37.5821 20.6158V57.7309C37.5821 59.2868 36.8099 60 35.1367 60H28.9588C27.1569 60 26.642 59.7406 25.6767 58.282L12.6452 38.282V57.7309C12.6452 59.2868 11.8729 60 10.1997 60H3.82873C2.15554 60 1.3833 59.2868 1.3833 57.7309V20.6158C1.3833 19.0599 2.15554 18.3468 3.82873 18.3468H10.1032C11.9051 18.4116 12.4843 18.671 13.3852 20.0648L26.3524 40.162V20.6158C26.3524 19.0599 27.1247 18.3468 28.7335 18.3468Z"/>
      <path d="M41.5 60C42.3362 60 43 59.3143 43 58.5V58.4914C43 57.6771 42.3448 57 41.5 57C40.6638 57 40 57.6857 40 58.5V58.5086C40 59.3229 40.6552 60 41.5 60ZM41.5 59.8371C40.7414 59.8371 40.1724 59.2371 40.1724 58.5086V58.5C40.1724 57.7714 40.75 57.1629 41.5 57.1629C42.2586 57.1629 42.8276 57.7629 42.8276 58.4914V58.5C42.8276 59.2286 42.25 59.8371 41.5 59.8371ZM40.9138 59.2286H41.2069V58.7057H41.5259L41.8879 59.2286H42.2414L41.8362 58.6543C42.0431 58.5943 42.1897 58.44 42.1897 58.1914C42.1897 57.8743 41.9397 57.7114 41.6034 57.7114H40.9138V59.2286ZM41.2069 58.4657V57.9686H41.5776C41.7759 57.9686 41.8879 58.0543 41.8879 58.2171C41.8879 58.3629 41.7759 58.4657 41.5776 58.4657H41.2069Z"/>
    </svg>`]]),FCe=/<svg([^>]*)>/g;function Roe(i,e,t,n){let r=NCe.get(i);return r?r.replace(FCe,'<svg$1 width="'.concat(t,'" height="').concat(n,'" xmlns="http://www.w3.org/2000/svg" style="fill: ').concat(e,';">')):""}l(Roe,"getLogoIcon");var i8=!1,tr,ic,yv,ka,Bo,$f,Dl,$u,Ooe=class extends xr{constructor(e,t,n){super(),ge(this,tr,{padding:16,scale:1,iconOnly:!1,position:"bottom-left",color:"dark",onClick:l(()=>{window?.open("https://www.mappedin.com")},"onClick"),interactive:!0,visible:!0}),ge(this,ic),ge(this,yv),ge(this,ka),ge(this,Bo),ge(this,$f),ge(this,Dl,0),ge(this,$u,0),D(this,"dirty",!0),D(this,"getPositionAlignedCanvasCoordinates",l((r,a)=>({"top-left":{x:0,y:0},"top-right":{x:r,y:0},"bottom-left":{x:0,y:a},"bottom-right":{x:r,y:a},center:{x:r/2,y:a/2},top:{x:r/2,y:0},bottom:{x:r/2,y:a},left:{x:0,y:a/2},right:{x:r,y:a/2}})[y(this,tr).position],"getPositionAlignedCanvasCoordinates")),D(this,"getPositionAlignedPadding",l(()=>{var r,a,o,s;let u=y(this,tr).padding;if(typeof u=="number")return{"top-left":{x:u,y:u},"top-right":{x:-u,y:u},"bottom-left":{x:u,y:-u},"bottom-right":{x:-u,y:-u},center:{x:0,y:0},top:{x:0,y:u},bottom:{x:0,y:-u},left:{x:u,y:0},right:{x:-u,y:0}}[y(this,tr).position];let h={top:(r=u.top)!=null?r:0,right:(a=u.right)!=null?a:0,bottom:(o=u.bottom)!=null?o:0,left:(s=u.left)!=null?s:0};return{x:h.left-h.right,y:h.top-h.bottom}},"getPositionAlignedPadding")),n&&Object.entries(n).forEach(([r,a])=>{a!==void 0&&(y(this,tr)[r]=a)}),Ce(this,yv,e),Ce(this,ic,t)}get color(){return y(this,tr).color==="light"?"white":"#293136"}get iconName(){return y(this,tr).iconOnly?"icon":"horizontal"}get minWidth(){return y(this,tr).iconOnly?kCe:75}get defaultWidth(){return y(this,tr).iconOnly?RCe:150}get aspectRatio(){return y(this,tr).iconOnly?OCe:DCe}get options(){return Me({},y(this,tr))}set options(e){var t,n;Ce(this,tr,{padding:e.padding||y(this,tr).padding,position:e.position||y(this,tr).position,iconOnly:e.iconOnly||y(this,tr).iconOnly,color:e.color||y(this,tr).color,scale:e.scale||y(this,tr).scale,onClick:y(this,tr).onClick,interactive:(t=e.interactive)!=null?t:y(this,tr).interactive,visible:(n=e.visible)!=null?n:y(this,tr).visible})}get icon(){return Roe(this.iconName,this.color,y(this,Dl)*y(this,ic).pixelRatio,y(this,$u)*y(this,ic).pixelRatio)}setSize(e,t){y(this,Bo)&&(y(this,Bo).uniforms.uSize.value.x=e,y(this,Bo).uniforms.uSize.value.y=t)}setXY(e,t){y(this,Bo)&&(y(this,Bo).uniforms.uSize.value.w=e,y(this,Bo).uniforms.uSize.value.z=t)}get width(){return y(this,Dl)}get height(){return y(this,$u)}getPositionAlignedOffset(e,t){return{"top-left":{x:0,y:0},"top-right":{x:-e,y:0},"bottom-left":{x:0,y:-t},"bottom-right":{x:-e,y:-t},center:{x:-(e/2),y:-(t/2)},top:{x:-(e/2),y:0},bottom:{x:-(e/2),y:-t},left:{x:0,y:-(t/2)},right:{x:-e,y:-(t/2)}}[y(this,tr).position]}insertIntoQuadTree(e){y(this,$f)!=null&&typeof y(this,tr).onClick=="function"&&y(this,tr).interactive&&e.insert(y(this,$f))}resize(e,t){if(y(this,tr).visible!==!0)return;let n=this.getPositionAlignedCanvasCoordinates(e,t),r=this.getPositionAlignedPadding(),a=this.getPositionAlignedOffset(y(this,Dl),y(this,$u)),o=Math.min(e-y(this,Dl),Math.max(0,n.x+r.x+a.x)),s=Math.min(t-y(this,$u),Math.max(0,n.y+r.y+a.y));this.setSize(y(this,Dl)/e,y(this,$u)/t),this.setXY(o/e,s/t),Ce(this,$f,new Nr(o,s,y(this,Dl),y(this,$u),{entityId:"watermark"}))}update(){this.dirty&&(y(this,tr).visible===!0?(Ce(this,Dl,Math.min(y(this,ic).canvasWidth,Math.max(this.minWidth,this.defaultWidth*y(this,tr).scale))),Ce(this,$u,y(this,Dl)/this.aspectRatio),ZA.getLoader().load("data:image/svg+xml;base64,".concat(btoa(this.icon)),e=>{if(Ce(this,Bo,new ys({uniforms:{uTexture:{value:e},uSize:{value:new jn(0,0,0,0)},uOpacity:{value:.7}},vertexShader:PCe,fragmentShader:LCe,depthWrite:!1,depthTest:!1,defines:{debug:i8},wireframe:i8,transparent:!0,visible:!0})),y(this,ka))y(this,ka).visible=!0,y(this,ka).material=y(this,Bo),y(this,ka).material.needsUpdate=!0;else{let t=new Cd(2,2,1,1);Ce(this,ka,new ln(t,y(this,Bo))),y(this,ka).position.set(0,0,-1),y(this,ka).frustumCulled=!1,y(this,ka).renderOrder=999;let n=new Nc(1,1,1),r=new ln(n,new _l({transparent:!0,opacity:0,depthTest:!1,depthWrite:!1}));r.frustumCulled=!1,r.layers.set(1),y(this,ka).add(r),y(this,yv).add(y(this,ka))}this.resize(y(this,ic).canvasWidth,y(this,ic).canvasHeight),this.publish("texture-loaded")})):y(this,ka)&&(y(this,ka).visible=!1),this.dirty=!1)}destroy(){y(this,ka)&&(y(this,yv).remove(y(this,ka)),Ra(y(this,ka))),Ce(this,ka,void 0),y(this,Bo)&&y(this,Bo).dispose(),Ce(this,Bo,void 0),Ce(this,$f,void 0)}};tr=new WeakMap,ic=new WeakMap,yv=new WeakMap,ka=new WeakMap,Bo=new WeakMap,$f=new WeakMap,Dl=new WeakMap,$u=new WeakMap,l(Ooe,"WatermarkSystem");var BCe=Ooe;R();var D_=100,zCe=!1,Noe=class extends xr{constructor(e,t){super(),D(this,"currentTotalBoundingBox"),D(this,"state"),D(this,"cameraSystem"),D(this,"debugMesh",null),D(this,"dirty",!0),D(this,"autoMinZoomLevel",!0),this.state=e,this.cameraSystem=t}update(){if(this.dirty){this.currentTotalBoundingBox==null&&(this.currentTotalBoundingBox=new ur,this.state.entityScene.children.length===0?this.currentTotalBoundingBox.setFromCenterAndSize(new Ee(0,0,0),new Ee(D_*2,D_*2,0)):(this.currentTotalBoundingBox.setFromObject(this.state.entityScene),this.currentTotalBoundingBox.expandByScalar(D_)));let e=new ur().setFromObject(this.state.entityScene);this.currentTotalBoundingBox.union(e);let t=e.getSize(new Ee),n=Math.max(t.x,t.y,t.z);for(let a of this.state.geometry2DMap.values())a.positionDirty===!0&&(this.currentTotalBoundingBox.expandByPoint(a.position),a.positionDirty=!1);let r=xM.copy(this.currentTotalBoundingBox).expandByScalar(Math.max(n,D_)).getBoundingSphere(VCe).radius;this.cameraSystem.panBounds={center:this.currentTotalBoundingBox.getCenter(new Ee),min:xM.min,max:xM.max,radius:r},this.publish("update"),this.cameraSystem.dirty=!0,this.dirty=!1}}};l(Noe,"PanBoundsSystem");var UCe=Noe,xM=new ur,VCe=new Ho;R();var n8=" Mappedin",jCe="https://info.mappedin.com/feedback",r8=["top-left","top-right","bottom-left","bottom-right"],GCe=640,$Ce=l(()=>`<svg xmlns='http://www.w3.org/2000/svg' width='15' height='15' fill-rule='evenodd' viewBox='0 0 20 20'>
						<circle cx='10' cy='10' r='5.9' style='fill:rgba(255,255,255,1);'/>
						<path style='fill:rgba(0,0,0,0.7);' d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/>
					</svg>`,"getAttributionButtonIcon"),bM={custom:[],position:"bottom-right",feedback:!0},Foe=class{constructor(e){D(this,"controlContainerEl"),D(this,"controlPositions"),D(this,"compact"),D(this,"attribContainerEl"),D(this,"attribInnerEl"),D(this,"attribButtonEl"),D(this,"feedbackLinkEl"),D(this,"attribHTML",n8),D(this,"customAttributions",[]),D(this,"toggleAttribution",l(t=>{this.attribContainerEl!=null&&(t.preventDefault(),this.attribContainerEl.classList.contains("mappedin-compact")&&(this.attribContainerEl.classList.contains("mappedin-compact-show")?(this.attribContainerEl.removeAttribute("open"),this.attribContainerEl.classList.remove("mappedin-compact-show")):(this.attribContainerEl.classList.add("mappedin-compact-show"),this.attribContainerEl.setAttribute("open",""))))},"toggleAttribution")),this.controlContainerEl=document.createElement("div"),this.controlContainerEl.classList.add("mappedin-control-container"),e.appendChild(this.controlContainerEl),this.controlPositions=r8.reduce((t,n)=>{let r=document.createElement("div");return r.classList.add("mappedin-ctrl-".concat(n)),this.controlContainerEl.appendChild(r),t[n]=r,t},{})}addAttributionControl(e=bM){var t;let n=e.position&&r8.includes(e.position)?e.position:bM.position;this.attribContainerEl=document.createElement("details"),this.attribContainerEl.classList.add("mappedin-ctrl-attrib","mappedin-ctrl-attrib-".concat(n)),this.attribContainerEl.open=!0,this.attribContainerEl.tabIndex=0,this.attribContainerEl.ariaLabel="Attribution",this.controlPositions[n].appendChild(this.attribContainerEl),this.attribButtonEl=document.createElement("summary"),this.attribButtonEl.addEventListener("click",this.toggleAttribution),this.attribButtonEl.classList.add("mappedin-ctrl-attrib-button"),this.attribButtonEl.title="Toggle attribution",this.attribButtonEl.ariaLabel="Toggle attribution",this.attribButtonEl.tabIndex=0,this.attribButtonEl.innerHTML=$Ce(),this.attribContainerEl.appendChild(this.attribButtonEl),this.attribInnerEl=document.createElement("div"),this.attribInnerEl.classList.add("mappedin-ctrl-attrib-inner"),this.attribInnerEl.innerHTML=this.attribHTML,this.attribContainerEl.appendChild(this.attribInnerEl),((t=e.feedback)!=null?t:bM.feedback)&&(this.feedbackLinkEl=document.createElement("a"),this.feedbackLinkEl.href=jCe,this.feedbackLinkEl.target="_blank",this.feedbackLinkEl.rel="noopener",this.feedbackLinkEl.textContent="Provide Feedback",this.feedbackLinkEl.classList.add("mappedin-ctrl-attrib-inner"),this.feedbackLinkEl.classList.add("mappedin-ctrl-attrib-inner-bold"),this.attribContainerEl.appendChild(this.feedbackLinkEl)),e.custom&&(this.customAttributions=e.custom),this.updateAttributionDisplay()}updateAttribution(e){if(!e.style||!this.attribInnerEl||!this.attribContainerEl)return;let t=[n8],n=e.style.sourceCaches;for(let r in n){let a=n[r];if(a.used||a.usedForTerrain){let o=a.getSource();o.attribution&&t.indexOf(o.attribution)<0&&t.push(o.attribution)}}t=t.filter(r=>String(r).trim()),t=t.filter((r,a)=>{for(let o=a+1;o<t.length;o++)if(t[o].indexOf(r)>=0)return!1;return!0}),this.attribHTML=t.join(" "),this.updateAttributionDisplay()}updateAttributionDisplay(){let e=[...new Set([this.attribHTML,...this.customAttributions])].filter(Boolean).join(" ");this.attribInnerEl&&(this.attribInnerEl.innerHTML=e)}resizeAttribution(e){this.attribContainerEl&&(e<=GCe||this.compact?this.compact===!1?this.attribContainerEl.setAttribute("open",""):!this.attribContainerEl.classList.contains("mappedin-compact")&&!this.attribContainerEl.classList.contains("mappedin-attrib-empty")&&(this.attribContainerEl.setAttribute("open",""),this.attribContainerEl.classList.add("mappedin-compact","mappedin-compact-show")):(this.attribContainerEl.setAttribute("open",""),this.attribContainerEl.classList.contains("mappedin-compact")&&this.attribContainerEl.classList.remove("mappedin-compact","mappedin-compact-show")))}destroyAttributionControl(){this.attribButtonEl&&this.attribButtonEl.removeEventListener("click",this.toggleAttribution),this.attribContainerEl&&(this.attribContainerEl.remove(),this.attribContainerEl=void 0,this.attribInnerEl=void 0,this.attribButtonEl=void 0)}resize(e){this.resizeAttribution(e)}updateData(e){this.updateAttribution(e)}destroy(){this.destroyAttributionControl(),this.controlContainerEl.remove(),this.compact=void 0}};l(Foe,"HTMLControlsSystem");var HCe=Foe;R();var Pb,Lb,Boe=class{constructor(e,t){D(this,"mesh"),D(this,"type","custom-geometry"),D(this,"dirty",!0),D(this,"feature"),D(this,"builder"),D(this,"outline"),ge(this,Pb,1),D(this,"color",new Mi),ge(this,Lb,0),this.mesh=new jg,this.feature=e,this.builder=t}get visible(){return this.mesh.visible}set visible(e){this.mesh.visible=e}set opacity(e){Ce(this,Pb,e)}get opacity(){return y(this,Pb)}setColor(e){this.color.set(e)}get position(){var e;return(e=this.mesh)==null?void 0:e.position}get altitude(){return y(this,Lb)}set altitude(e){this.mesh&&(this.mesh.position.z=e,Ce(this,Lb,e))}get renderOrder(){return this.mesh?this.mesh.renderOrder:0}set renderOrder(e){this.mesh&&(this.mesh.renderOrder=e)}};Pb=new WeakMap,Lb=new WeakMap,l(Boe,"CustomGeometryComponent");var wM=Boe;R();var zoe=class{constructor(e,t){D(this,"state"),D(this,"convertTo3DMapPosition"),this.state=e,this.convertTo3DMapPosition=t}update(){let e,t;for(let n of this.state.geometry3DIdsInScene){let r=this.state.geometry3DMap.get(n);r?.type==="custom-geometry"&&(e=r.components[0],t=r.components[1],e.dirty&&t.visible!==!1&&(e.position.copy(this.convertTo3DMapPosition(e.feature.geometry.coordinates[1],e.feature.geometry.coordinates[0],t.altitude)),e.builder.setup(e.mesh),e.mesh.traverse(a=>{a.userData={entityId:n,type:"custom-geometry"}}),e.dirty=!1),t.visible!==!1&&e.builder.update(e.mesh))}}};l(zoe,"CustomGeometrySystem");var WCe=zoe;R();R();function Uoe(i){return i.children.some(e=>e.userData.isOutline)}l(Uoe,"hasOutline");function YD(i,e,t,n){let r=i.getAttribute("position").array,a=-1/0;for(let o=0;o<e.count;o++){let s=(e.start+o)*3,u=r[s+2];a=Math.max(a,u)}for(let o=0;o<e.count;o++){let s=(e.start+o)*3,u=r[s+2];Math.abs(u-a)<1e-4?r[s+2]=Math.max(t+n,2e-4+n):r[s+2]=n}i.attributes.position.needsUpdate=!0}l(YD,"updateBufferGeometryHeight");R();function JD(i){var e,t;let n=new Sa,r=(e=i.mesh)==null?void 0:e.geometry;if(!r||!((t=i.batchedProps)!=null&&t.range))return;let a=i.batchedProps.range,o=a.start,s=a.count,u=r.getAttribute("position");if(u){let f=new Float32Array(s*3);for(let m=0;m<s;m++){let v=o+m;f[m*3]=u.array[v*3],f[m*3+1]=u.array[v*3+1],f[m*3+2]=u.array[v*3+2]}n.setAttribute("position",new gr(f,3))}let h=r.getAttribute("normal");if(h){let f=new Float32Array(s*3);for(let m=0;m<s;m++){let v=o+m;f[m*3]=h.array[v*3],f[m*3+1]=h.array[v*3+1],f[m*3+2]=h.array[v*3+2]}n.setAttribute("normal",new gr(f,3))}let d=r.getAttribute("uv");if(d){let f=new Float32Array(s*2);for(let m=0;m<s;m++){let v=o+m;f[m*2]=d.array[v*2],f[m*2+1]=d.array[v*2+1]}n.setAttribute("uv",new gr(f,2))}if(r.index){let f=r.index,m=new Uint32Array(s);for(let v=0;v<s;v++)m[v]=f.array[o+v];n.setIndex(new gr(m,1))}return n}l(JD,"extractBufferGeometryFromBatchedGeometry");function Voe(i,e){let t=JD(i);if(!t||!i.mesh)return;i.mesh.deleteInstance(i.instanceIndex),i.mesh.optimize();let n=e.addGeometry(t);e.addInstance(n);let r=e.getGeometryIdAt(n),a=e.getGeometryRangeAt(r);return a&&i.batchedProps&&(i.batchedProps.range=a),t.dispose(),n}l(Voe,"transferGeometryToNewBatchedMesh");var qCe=80,Hf,vv,sT,lT,joe=class{constructor(e){D(this,"rendererState"),D(this,"outlineOpacitiesDirty",!0),ge(this,Hf,!0),ge(this,vv,-1/0),ge(this,sT,new Map),ge(this,lT,new VP({vertexColors:!0,linewidth:1,transparent:!0,opacity:1,side:su})),this.rendererState=e}get geometries3DDirty(){return y(this,Hf)}set geometries3DDirty(e){Ce(this,Hf,e)}update(e,t=!0){let n;if(this.geometries3DDirty){for(let a of this.rendererState.geometry3DIdsInScene){let o=this.rendererState.geometry3DMap.get(a);if(o instanceof Io&&o.components[0].outline&&!Uoe(o)&&o.userData.entities3D.size>0){let s=[];for(let b of o.userData.entities3D.values()){let w=this.rendererState.geometry3DMap.get(b);if(w instanceof lr&&w.type==="geometry"&&w.components[3]&&w.components[3].dirty===!0&&w.components[0].material!=null){let A=w.components[0].geometry,E=!1;A||(A=JD(w.components[0]),E=!0),s.push([w.components[3],new Mce(A,qCe)]),E&&(A?.dispose(),A=void 0)}}if(s.length===0)continue;let u=Id(s.map(b=>b[1]),!1);if(u==null)continue;let h=u.getAttribute("position"),d=new Float32Array(h.count*4),f=new gr(d,4);u.setAttribute("color",f);let m=0;for(let b=0;b<s.length;b++){let[w,A]=s[b],E=A.getAttribute("position").count;w.edgeColors=f,w.geometry=u,w.ranges={count:E,start:m},m+=E,A.dispose()}let v=new Gw(u,y(this,lT));v.userData.isOutline=!0,o.add(v)}}Ce(this,Hf,!1),this.outlineOpacitiesDirty=!0}for(let a of this.rendererState.geometry3DIdsInScene){let o=this.rendererState.geometry3DMap.get(a);if(o instanceof lr&&o.type==="geometry"&&o.components[3]&&o.components[3].dirty===!0&&o.components[0].material!=null&&o.parentObject3D instanceof Io){let s=o.components[3].geometry;if(!s)continue;let u=o.components[3];if(!u)continue;let h=u.edgeColors;if(!h||!u.ranges)continue;let d=new Mi(u.color);for(let v=0;v<u.ranges.count;v++){let b=u.ranges.start+v;h.setXYZ(b,d.r,d.g,d.b)}let f=o.components[1].height,m=o.components[1].altitude;YD(s,u.ranges,f,m),s.attributes.color.needsUpdate=!0,s.computeBoundingSphere(),u.dirty=!1}}let r=t?bg(e,16,19,0,1):y(this,vv);if((r!==y(this,vv)||this.outlineOpacitiesDirty)&&this.rendererState.geometry3DIdsInScene.size>0){for(let a of this.rendererState.geometry3DIdsInScene)if(n=this.rendererState.geometry3DMap.get(a),n?.type==="geometry"&&n.components[0]instanceof vs){let o=n.components[3];if(o&&o.edgeColors&&o.geometry){let s=o.visible,u=Math.min(r,s?n.components[1].opacity*y1(n):0);if(o.currentOpacity!==u){for(let h=0;h<o.ranges.count;h++){let d=o.ranges.start+h;o.edgeColors.setW(d,u)}o.geometry.attributes.color.needsUpdate=!0}}}}Ce(this,vv,r),Ce(this,Hf,!1),this.outlineOpacitiesDirty=!1}destroy(){y(this,sT).clear()}};Hf=new WeakMap,vv=new WeakMap,sT=new WeakMap,lT=new WeakMap,l(joe,"OutlineInterpolationSystem");var XCe=joe;R();R();var Goe=class extends ln{constructor(){super(...arguments),D(this,"userData",{entityId:""})}};l(Goe,"EntityMesh");var ZCe=Goe,YCe=$e.object({flipImageToFaceCamera:$e.boolean().optional(),url:$e.string()}),JCe=$e.object({type:$e.enum(["Feature"]),properties:$e.object({width:$e.number(),height:$e.number(),rotation:$e.number().min(0).max(360).optional(),verticalOffset:$e.number().optional()}),geometry:XD});function $oe(i,e,t){$e.union([$e.number(),$e.string()]).parse(i),JCe.parse(e),YCe.parse(t)}l($oe,"validateImage");var Hoe=class{constructor(e){D(this,"mesh",new jg),D(this,"imageMesh"),D(this,"outline"),D(this,"type","image"),D(this,"instanceIndex",-1),D(this,"geometry"),D(this,"material"),D(this,"feature"),D(this,"position",new Ee),this.feature=e}get visible(){var e,t;return(t=(e=this.mesh)==null?void 0:e.visible)!=null?t:!1}set visible(e){this.mesh&&(this.mesh.visible=e)}};l(Hoe,"ImageComponent");var KCe=Hoe;R();function Fw(i,e){return{x:i.x*Math.cos(e)-i.y*Math.sin(e),y:i.x*Math.sin(e)+i.y*Math.cos(e)}}l(Fw,"rotatePoint");function Woe(i,e){return i.map(t=>Fw(t,e))}l(Woe,"rotatePoints");function qoe(i){let e=1/0,t=1/0,n=-1/0,r=-1/0;for(let a of i)e=Math.min(e,a.x),t=Math.min(t,a.y),n=Math.max(n,a.x),r=Math.max(r,a.y);return{minX:e,minY:t,maxX:n,maxY:r}}l(qoe,"getBounds");function Xoe(i,e){let t=!1;for(let n=0,r=e.length-1;n<e.length;r=n++){let a=e[n].x,o=e[n].y,s=e[r].x,u=e[r].y;o>i.y!=u>i.y&&i.x<(s-a)*(i.y-o)/(u-o)+a&&(t=!t)}return t}l(Xoe,"pointInPolygon");function KD(i,e,t,n,r){for(let a=0;a<r;a++)for(let o=0;o<n;o++)if(i[t+a][e+o]!==1)return!1;return!0}l(KD,"isValidRectangle");function Zoe(i,e,t){let n=i.maxX-i.minX,r=i.maxY-i.minY,a,o,s=Me({},i);return n/r>e?(o=r/t,a=o*e,s.minX+=(n-a*t)/2):(a=n/t,o=a/e,s.minY+=(r-o*t)/2),{dx:a,dy:o,gridBounds:s}}l(Zoe,"calculateGridDimensions");function Yoe(i,e,t,n,r){let a=Array(t).fill(0).map(()=>Array(t).fill(0));for(let o=0;o<t;o++)for(let s=0;s<t;s++){let u={x:e.minX+s*n,y:e.minY+o*r};Xoe(u,i)&&(a[o][s]=1)}return a}l(Yoe,"createAndFillGrid");function Joe(i,e){let t=Array(e).fill(0).map(()=>Array(e).fill(0));for(let n=0;n<e;n++)for(let r=0;r<e;r++)if(i[n][r]===1){let a=0;for(let o=1;o<=Math.min(e-r,e-n)&&KD(i,r,n,o,o);o++)a=o;t[n][r]=a}return t}l(Joe,"calculateRectSizes");function Koe(i,e,t,n,r,a){let o=0,s=0,u=0;for(let h=0;h<n;h++)for(let d=0;d<n;d++)if(i[h][d]===1){let f=Math.pow(e[h][d],2),m=t.minX+d*r,v=t.minY+h*a;o+=f,s+=m*f,u+=v*f}return{x:s/o,y:u/o}}l(Koe,"calculatePolygonCenter");function Qoe(i,e,t,n,r,a,o){let s=-1/0,u=null,h=i.length,d=Math.sqrt(Math.pow(e.maxX-e.minX,2)+Math.pow(e.maxY-e.minY,2));for(let f=0;f<h;f++)for(let m=0;m<h;m++)if(i[f][m]===1)for(let v=1;v<=h-m;v++){let b=v;if(!(b>h-f)&&KD(i,m,f,v,b)){let w=v*b,A=e.minX+(m+v/2)*t,E=e.minY+(f+b/2)*n,I={x:A,y:E},C=Math.sqrt(Math.pow(I.x-r.x,2)+Math.pow(I.y-r.y,2))/d,T=w*(1-a)-C*a*w;T>s&&(s=T,u={center:I,width:v*t*o,height:v*n*o})}}return u}l(Qoe,"findBestRectangle");function uT(i,e,t,n={}){let{scaleFactor:r=.9,centerPriority:a=.5,resolution:o=100,minimumSizeRatio:s=.5}=n,u=Jl(t),h=i.width/i.height,d=Woe(e,u),f=qoe(d),{dx:m,dy:v,gridBounds:b}=Zoe(f,h,o),w=Yoe(d,b,o,m,v),A=Joe(w,o),E=Koe(w,A,b,o,m,v),I=Qoe(w,b,m,v,E,a,r);return!I||I.width<i.width*s||I.height<i.height*s?i:lt(Me({},I),{center:Fw(I.center,-u),rotation:t,polygonCenter:Fw(E,-u)})}l(uT,"findLargestInteriorRectangle");var Sy=Math.PI*2,QCe=Math.PI/2,e3e=Math.PI*1.5,t3e=f0(QCe,2),i3e=f0(e3e,2),n3e=.01,r3e=!1,ese=class extends xr{constructor(e,t,n=0,r=0,a={}){super(),D(this,"rendererState"),D(this,"convertTo3DMapPosition"),D(this,"initialBearing",0),D(this,"naturalBearing",0),D(this,"imagePlacementOptions"),D(this,"imageLoadingCache",new Map),this.rendererState=e,this.convertTo3DMapPosition=t,this.initialBearing=n,this.naturalBearing=r,this.imagePlacementOptions=a}createImageMesh(e,t,n,r=0,a,o){var s,u,h;let d={width:n.width,height:n.height,center:this.convertTo3DMapPosition(a),rotation:(s=n.rotation)!=null?s:0},f=(u=this.imagePlacementOptions.mode)!=null?u:"default",m=(()=>{switch(f){case"fit-nearest-90":let A=(this.initialBearing-this.naturalBearing+360)%180;return A>=45&&A<=135?uT(d,o,d.rotation+90,this.imagePlacementOptions):d;case"fit-initial-bearing":return uT(d,o,this.initialBearing,this.imagePlacementOptions);case"default":case"none":default:return d}})(),v=new cg({transparent:!0,depthWrite:!1,side:Go}),b=new Cd(m.width,m.height),w=new ZCe(b);return w.visible=!1,(h=this.getOrDownloadImage(t))==null||h.then(A=>{v.map=A,v.needsUpdate=!0,v.map.colorSpace=io,w.visible=!0,this.publish("image-loaded")}),w.userData.entityId=e,w.material=v,w.position.set(m.center.x,m.center.y,r+n3e),w.rotation.z=(-Bn.degToRad(m.rotation)+Sy)%Sy,w}getOrDownloadImage(e){var t;if(this.imageLoadingCache.has(e))return(t=this.imageLoadingCache.get(e))==null?void 0:t.promise;{let n=new Promise(r=>{ZA.getLoader().load(e,a=>{let o=this.imageLoadingCache.get(e);o&&!o.loaded&&(o.loaded=!0),r(a)})});return this.imageLoadingCache.set(e,{loaded:!1,promise:n}),n}}flipIfNeeded(e,t){if(e.imageMesh==null)return;let n=-t,r=e.imageMesh.rotation.z,a=f0((r-n+Sy)%Sy,2);a>t3e&&a<i3e&&(e.imageMesh.rotation.z=(r+Math.PI)%Sy)}update(e){var t,n,r,a,o;let s,u,h;for(let d of this.rendererState.geometry3DIdsInScene)if(s=this.rendererState.geometry3DMap.get(d),s?.type==="image"){if(u=s.components[0],h=s.components[1],h.url&&u.imageMesh==null){let f=this.convertTo3DMapPosition(u.feature.geometry.coordinates),m={x:f.x,y:f.y};u.imageMesh=this.createImageMesh(s.id,h.url,u.feature.properties,u.feature.properties.verticalOffset,u.feature.geometry.coordinates,[m]),u.mesh.add(u.imageMesh),u.position.copy(u.imageMesh.position)}u.imageMesh&&h.flipImageToFaceCamera&&this.flipIfNeeded(u,e)}else if(s?.type==="geometry"){if(u=s.components[0],h=s.components[1],h.showImage&&(t=u.feature.properties)!=null&&t.image&&u.imageMesh==null&&u.visible&&u.mesh!=null&&u.mesh.parent!=null&&((n=u.feature.properties)==null?void 0:n.image.position)!=null&&u.feature.geometry.coordinates!=null&&u.feature.geometry.coordinates.length>0){let f=u.feature.geometry.coordinates[0].map(v=>{let b=this.convertTo3DMapPosition(v);return{x:b.x,y:b.y}}),m=this.createImageMesh(d,(r=u.feature.properties)==null?void 0:r.image.path,(a=u.feature.properties)==null?void 0:a.image,h.height,(o=u.feature.properties)==null?void 0:o.image.position,f);u.mesh.parent.add(m),u.imageMesh=m}if(u.imageMesh){if(!u.visible)u.imageMesh.visible=!1;else if(h.showImage&&!u.imageMesh.visible)if(h.url){let f=this.imageLoadingCache.get(h.url);f&&f.loaded&&(u.imageMesh.visible=!0)}else u.imageMesh.visible=!0;else!h.showImage&&u.imageMesh.visible&&(u.imageMesh.visible=!1);h.flipImageToFaceCamera&&this.flipIfNeeded(u,e)}}}};l(ese,"ImageSystem");var a3e=ese;R();var o3e=250,Ip,tse=class extends xr{constructor(e,t){super(),D(this,"cameraDirty",!0),D(this,"focusablesDirty",!0),D(this,"state"),D(this,"camera"),D(this,"debugEl",null),D(this,"raycasters",[]),D(this,"collisions",new Map),D(this,"focusableEntities",new Set),D(this,"debugRaycasters",!1),ge(this,Ip),D(this,"update",l((n=!1,r=Date.now())=>{this.focusablesDirty&&this.updateFocusableEntities(),!n&&(Date.now()-r>o3e||(y(this,Ip)&&cancelAnimationFrame(y(this,Ip)),Ce(this,Ip,requestAnimationFrame(()=>{this.updateRaf()}))))},"update")),this.state=e,this.camera=t,this.buildRaycasters()}resize(){this.buildRaycasters()}buildRaycasters(){this.debugEl&&this.debugEl.remove();let e=new ft(this.state.canvasWidth/2,this.state.canvasHeight/2),t=new ft(e.x/1.2,e.y/1.2),n=new ft(e.x+(e.x-t.x),t.y),r=new ft(t.x,e.y+(e.y-t.y)),a=new ft(n.x,r.y),o=new ft(e.x,e.y/1.5),s=new ft(e.x,e.y+(e.y-o.y));this.debugEl=document.createElement("div"),Object.assign(this.debugEl.style,{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",pointerEvents:"none"}),document.body.append(this.debugEl),this.raycasters=[e,o,s,t,n,r,a].map((u,h)=>{if(this.debugRaycasters){let b=document.createElement("div");b.style.position="absolute",b.style.top=u.y+"px",b.style.left=u.x+"px",b.style.width="10px",b.style.height="10px",b.style.backgroundColor="red",this.debugEl.append(b)}let d=u.x/this.state.canvasWidth*2-1,f=-(u.y/this.state.canvasHeight)*2+1,m=new ft(d,f),v=new Z1;return v.setFromCamera(m,this.camera),[v,m,h===0?10:h<7?2:1]})}updateFocusableEntities(){this.focusableEntities.clear();let e,t,n;for(let r of this.state.geometry3DIdsInScene)if(n=this.state.geometry3DMap.get(r),n!=null){if(n.type==="group-container"&&n.components[2]!==void 0&&n.components[2]instanceof Rw){if(t=n.components[2],t.dirty===!0||t.focusMesh==null){t.focusMesh&&Ra(t.focusMesh);let a=new ur;a.setFromObject(n);let o=a.max.x-a.min.x,s=a.max.y-a.min.y,u=a.max.z-a.min.z;if(!isFinite(o)||!isFinite(s)||!isFinite(u)||isNaN(o)||isNaN(s)||isNaN(u)||o<=0||s<=0||u<=0)continue;let h=new Nc(o,s,u),d={transparent:!0,opacity:this.debugRaycasters?1:0,visible:this.debugRaycasters};if(this.debugRaycasters){let v=["red","green","blue","yellow","purple","orange","pink","brown","gray","black"];d.color=v[Math.floor(Math.random()*v.length)]}let f=new _l(d),m=new ln(h,f);m.position.set((a.min.x+a.max.x)/2,(a.min.y+a.max.y)/2,0),m.userData={entityId:n.userData.entityId},t.focusMesh=m,n.add(m),n.components[2].dirty=!1}this.focusableEntities.add(t.focusMesh)}else if(n.type==="geometry"&&n.components[4]&&n.components[4]instanceof Rw&&(e=n.components[0],t=n.components[4],e instanceof vs&&e.geometry!=null&&(t.dirty===!0||t.focusMesh==null))){if(t.focusMesh==null){let a=new ln(e.geometry);a.userData={entityId:n.id},t.focusMesh=a}this.focusableEntities.add(t.focusMesh)}}this.focusablesDirty=!1}updateRaf(){if(this.focusableEntities.size===0){this.publish("geometry-in-focus",[]);return}this.cameraDirty&&this.raycast()}raycast(){this.collisions.clear();for(let[t,n]of this.raycasters)t.setFromCamera(n,this.camera);for(let[t,n,r]of this.raycasters)t.intersectObjects(Array.from(this.focusableEntities.values())).forEach(a=>{var o;if(a?.object!=null&&"isMesh"in a.object&&a!=null&&a.object.isMesh){let s=a.object.userData.entityId,u=(o=this.collisions.get(s))!=null?o:0;this.collisions.set(s,u+r)}});let e=Array.from(this.collisions,([t,n])=>({entityId:t,weight:n})).sort((t,n)=>n.weight-t.weight).map(({entityId:t})=>t);this.publish("geometry-in-focus",e),this.cameraDirty=!1}showRaycasters(){this.debugRaycasters=!0,this.buildRaycasters()}hideRaycasters(){this.debugRaycasters=!1,this.buildRaycasters()}destroy(){y(this,Ip)&&cancelAnimationFrame(y(this,Ip)),this.debugEl&&this.debugEl.remove(),this.collisions.clear(),this.focusableEntities.clear(),this.raycasters=[]}};Ip=new WeakMap,l(tse,"GeometryInFocusSystem");var s3e=tse;R();var a8=20,l3e=5e3,ol,Db,kb,Tp,Wf,qf,hT,Rb,ise=class{constructor(e){D(this,"dirty",!0),D(this,"map"),D(this,"stylesheetId",""),D(this,"userHiddenLayers",new Set),D(this,"hiddenLayersInStyle",new Set),D(this,"centerPoint"),D(this,"bbox"),D(this,"polygons"),ge(this,ol,null),ge(this,Db,l(()=>{y(this,ol)&&(clearTimeout(y(this,ol)),Ce(this,ol,null),this.dirty=!1)},"#stopTrying")),ge(this,kb,l(()=>{y(this,ol)&&(clearTimeout(y(this,ol)),Ce(this,ol,null)),Ce(this,ol,setTimeout(()=>{y(this,Db).call(this)},l3e))},"#startTrying")),D(this,"handleRender",l(async()=>{if(!(!this.map||!this.dirty)&&!(!this.hiddenLayersInStyle||this.hiddenLayersInStyle.size===0)){if(y(this,Tp)&&(y(this,hT).call(this),Ce(this,Tp,!1)),this.centerPoint){let t=this.map.project(this.centerPoint),n=this.map.queryRenderedFeatures(t,{layers:Array.from(this.hiddenLayersInStyle)});if(n.length>0){for(let r of n)this.expr.push(["!=",["id"],r.id]);this.expr.length>0&&this.hiddenLayersInStyle.forEach(r=>{this.map.setFilter(r,["all",...this.expr])}),this.expr=[],Ce(this,Tp,!1),this.dirty=!1}}else if(this.bbox&&this.polygons){let t=this.map.queryRenderedFeatures([this.map.project([this.bbox[0],this.bbox[1]]),this.map.project([this.bbox[2],this.bbox[3]])],{layers:Array.from(this.hiddenLayersInStyle)});if(t.length>0){Ce(this,Tp,!0);for(let n=0;n<t.length;n+=a8){let r=t.slice(n,n+a8);y(this,Wf).push(()=>{for(let a of r)if(a.geometry!=null&&"coordinates"in a.geometry){if(this.polygons==null)return;let o;if(a.geometry.type==="Polygon"?o=Zm(a.geometry.coordinates):a.geometry.type==="MultiPolygon"&&(o=jQ(a.geometry.coordinates)),!o)continue;for(let s of this.polygons)if(kte(s,o)){this.expr.push(["!=",["id"],a.id]);continue}}})}y(this,Rb).call(this)}}}},"handleRender")),D(this,"expr",[]),ge(this,Tp,!1),ge(this,Wf,[]),ge(this,qf,null),ge(this,hT,l(()=>{y(this,qf)&&(globalThis.cancelAnimationFrame(y(this,qf)),Ce(this,qf,null)),Ce(this,Wf,[])},"#cancelJobs")),ge(this,Rb,l(()=>{let t=y(this,Wf).pop();typeof t=="function"&&(t(),y(this,Wf).length>0&&Ce(this,qf,globalThis.requestAnimationFrame(y(this,Rb)))),this.expr.length>0&&(this.hiddenLayersInStyle.forEach(n=>{this.map.setFilter(n,["all",...this.expr])}),this.dirty=!1),this.expr=[],Ce(this,Tp,!1),y(this,Db).call(this)},"#runJobs")),D(this,"handleStyleChange",l(t=>{var n,r;if(this.map&&t&&t.dataType==="style"&&t.type==="styledata"&&this.userHiddenLayers.size>0){let a=(r=(n=t?.style)==null?void 0:n.stylesheet)==null?void 0:r.id;(!a||a!==this.stylesheetId)&&(this.stylesheetId=a,this.filterStylesInMap(),this.dirty=!0)}},"handleStyleChange")),e&&(this.map=e,this.map.on("styledata",this.handleStyleChange),this.map.on("render",this.handleRender))}hideLayersUnderPoint(e,t){y(this,kb).call(this),this.centerPoint=e;for(let n of t)this.userHiddenLayers.add(n);this.dirty=!0,this.filterStylesInMap(),this.handleRender()}hideLayersIntersectingPolygons(e,t,n){y(this,ol)&&clearTimeout(y(this,ol)),y(this,kb).call(this),this.bbox=e,this.polygons=t.reduce((r,a)=>{if(a.geometry.type==="Polygon"){let o=Zm(a.geometry.coordinates);r.push(o)}else a.geometry.type==="MultiPolygon"&&r.push(...a.geometry.coordinates.map(o=>Zm(o)));return r},[]);for(let r of n)this.userHiddenLayers.add(r);this.dirty=!0,this.filterStylesInMap(),this.handleRender()}filterStylesInMap(){if(this.hiddenLayersInStyle=new Set,this.map)for(let e of this.userHiddenLayers)this.map.getLayer(e)&&this.hiddenLayersInStyle.add(e)}destroy(){this.map&&(this.map.off("styledata",this.handleStyleChange),this.map.off("render",this.handleRender))}};ol=new WeakMap,Db=new WeakMap,kb=new WeakMap,Tp=new WeakMap,Wf=new WeakMap,qf=new WeakMap,hT=new WeakMap,Rb=new WeakMap,l(ise,"OutdoorLayers");var u3e=ise;R();R();R();R();var AM=`attribute float pathDistance;
attribute vec3 pathNormal;
attribute vec3 pathTangent;

uniform vec2 uvScale;
uniform float vertexes;
uniform float complete;
uniform float nearRadius;
uniform float farRadius;
uniform float nearZoom;
uniform float farZoom;
uniform float pulse;
uniform float pulseLength;
uniform bool pathIsVertical;
uniform bool displayArrowsOnPath;
uniform vec2 cameraParameters;
uniform float flattenFactor;

varying float zoomLevel;
varying float radius;
varying vec2 fragTexcoord;
varying float fragTopTextureU;
varying float fragPathDistance;

// Map the x value from the range [xMin, xMax] to the range [yMin, yMax] using
// linear interpolation/extrapolation.
//
// This performs a pure linear mapping y = mx + b where
// 'm = (yMax - yMin) / (xMax - xMin)',
// 'b = -xMin * (yMax - yMin) / (xMax - xMin) + yMin'.
float remap(float x, float xMin, float xMax, float yMin, float yMax) {
	return (x - xMin) / (xMax - xMin) * (yMax - yMin) + yMin;
}

// Map the x value from [xMin, xMax] to the range [yMin, yMax] using linear
// interpolation, clamping result values outside [yMin, yMax].
float clampRemap(float x, float xMin, float xMax, float yMin, float yMax) {
	return clamp(remap(x, xMin, xMax, yMin, yMax), yMin, yMax);
}

void main() {
	fragPathDistance = pathDistance;

	// We can get an origin point for the cross-section of the path by
	// subtracting the surface normal times the radius, since the surface normal
	// points strictly away from the centre.
	vec3 origin = position - nearRadius * normal;

	// Inflate the path along its surface normal to increase its radius from
	// 'nearRadius' to 'farRadius' when the camera is at 'farZoom'.
	vec3 adjustedPosition = position;
	zoomLevel = clampRemap(cameraParameters.x, nearZoom, farZoom, 0.0, 1.0);
	adjustedPosition += normal * (farRadius - nearRadius) * zoomLevel;

	// Determine how far the path extends "up" or "down" in the direction of the
	// path normal.
	float height = dot(adjustedPosition - origin, pathNormal);

	// Flatten the bottom half of the path entirely so that it's flat
	// against the floor. This makes the path look nicer when it's
	// semitransparent behind opaque geometry, so you don't see it
	// peeking through.
	float desiredHeight = max(height, 0.0);

	desiredHeight = desiredHeight * flattenFactor;

	float flattenMagnitude = height - desiredHeight;
	adjustedPosition = adjustedPosition - pathNormal * flattenMagnitude;

	// Transform the vertices into NDC.
	vec4 mvPosition = modelViewMatrix * vec4(adjustedPosition, 1.0);
	gl_Position = projectionMatrix * mvPosition;

	fragTexcoord = uv;

	// Compute a texture coordinate for mapping the arrow texture to the path.
	// We don't want to use the u-value that Three.js provides, because the
	// path may end up twisting arbitrarily -- but we want the arrow texture to
	// always be on the top of the path.
	vec3 bitangent = cross(normal, pathTangent);
	fragTopTextureU = -dot(bitangent, pathNormal) * 0.5 + 0.5;

	radius = mix(nearRadius, farRadius, zoomLevel);
}
`;R();var o8=`#define ARROW_FADING_POINT 0.15

uniform float complete;
uniform float nearRadius;
uniform float farRadius;
uniform vec2 resolution;
uniform vec2 cameraParameters;
uniform vec3 color;
uniform float pathLength;
uniform bool showPulse;
uniform vec3 pulseColor;
uniform float pulse;
uniform float pulseLength;
uniform bool pathIsVertical;
uniform bool displayArrowsOnPath;
uniform float arrowAnimationTimer;
uniform float opacityMultiplier;
uniform bool dashed;
uniform sampler2D arrowTexture;

varying float zoomLevel;
varying float radius;
varying vec2 fragTexcoord;
varying float fragTopTextureU;
varying float fragPathDistance;

// How long the arrow should be, as a factor of pathRadius. Since we've
// mostly flattened the top of the path, values near 2.0 (the diameter)
// will probably look best.
const float arrowLength = 2.0;

// How much of a relative margin the arrow texture should have inside the
// area laid out for it. Useful to pull the arrow away from the edges of the
// path, which slope down.
const float arrowMargin = 0.1;

// How many arrow-lengths of space should be between arrows on a short path.
const float arrowSpacingOnShortPath = 6.0;

// How many arrow-lengths of space should be between arrows on a long path.
const float arrowSpacingOnLongPath = 7.5;

// How long a path must be to be considered "long", as a factor of
// the path radius.
const float longPathLength = 200.;

// How long a path must be to be considered "short", as a factor of the
// path radius.
const float shortPathLength = 75.;

// How much of the path's length the fade-in should comprise when going from
// zero opacity to full opacity.
const float completeLength = 0.1;

// Map the x value from the range [xMin, xMax] to the range [yMin, yMax] using
// linear interpolation/extrapolation.
//
// This performs a pure linear mapping 'y = mx + b' where
// 'm = (yMax - yMin) / (xMax - xMin)',
// 'b = -xMin * (yMax - yMin) / (xMax - xMin) + yMin'.
float remap(float x, float xMin, float xMax, float yMin, float yMax) {
	return (x - xMin) / (xMax - xMin) * (yMax - yMin) + yMin;
}

// Map the x value from [xMin, xMax] to the range [yMin, yMax] using linear
// interpolation, clamping result values outside [yMin, yMax].
float clampRemap(float x, float xMin, float xMax, float yMin, float yMax) {
	return clamp(remap(x, xMin, xMax, yMin, yMax), yMin, yMax);
}

void main(void) {
	// Compute the opacity of the path based on the distance from the current
	// fragment to the 'complete' value as it varies from 0.0 to 1.0.
	// Fragments that are at the 'complete' value or past it will be fully
	// transparent, while fragments that are at 'complete - completeLength'
	// or before it will be fully opaque. However, we adjust the 'complete'
	// value here so that it overshoots by one full 'completeLength', so that
	// the entire path will be opaque when the 'complete' value is at 1.0.
	float completeLocation = complete * (1.0 + completeLength);
	float completeAmount = clampRemap(
		fragPathDistance,
		completeLocation - completeLength,
		completeLocation,
		0.0,
		1.0
	);
	float opacity = 1.0 - smoothstep(0.0, 1.0, completeAmount);

	// 2020/01/09 Terence Dickson
	// When we render the background and overlay for the mapbox outdoor context
	// behind everything else in single-buffer rendering, the fact that the path
	// writes to the depth buffer means that the background and overlay will not
	// be drawn behind the path even when the path is still fading in. The effect
	// is subtle and is only visible in single-buffer rendering so this quick fix
	// prevents writes to the depth buffer for zero opacity fragments, which gets
	// rid of the most visually-offensive ghosting.
	if (opacity <= 0.0) {
		discard;
	}

	// Push in the texture coordinates so that they ramp up
	// at 'arrowMargin' instead of at zero; this remapping looks somewhat
	// like this:
	// 1 ^        ___
	//   |       /
	//   |      /
	//   |     /
	//   |    /
	//   |___/
	// 0 +---------->
	//   0   ^      1
	//       arrowMargin
	// Making the arrows narrower on the path.
	float u = fragTopTextureU;
	u = clamp(
		u * (1. / (1. - arrowMargin * 2.)) - (1. / (1. - arrowMargin * 2.) - 1.) / 2.,
		0.0,
		1.0
	);

	float arrowSpacing = clampRemap(
		pathLength,
		shortPathLength * radius,
		longPathLength * radius,
		arrowSpacingOnShortPath,
		arrowSpacingOnLongPath
	);

	// Reduce the spacing between arrows when the camera zooms out, as increasing
	// the path radius will increase the arrow size and thus be able to fit
	// fewer arrows on in total, and this secondary movement of the arrows
	// "zooming off" the end of the path is unpleasant
	float expandAmount = mix(1.0, farRadius / nearRadius, zoomLevel);
	float effectiveArrowSpacing =
		arrowSpacing * 1.0 / expandAmount +
		arrowMargin * 2.0;

	float effectiveArrowLength = arrowLength * radius * (1. - arrowMargin * 2.0);

	// Adjust the slope of the vertical texture coordinate so that it goes
	// from 0 to 1 along the length of the arrow plus the spacing between
	// arrows, and adjust its x-intercept so that one arrow moves to the
	// exact position of the next arrow as 'arrowAnimationTimer' goes
	// from 0 to 1
	float v = (
		fragTexcoord.x * (pathLength / effectiveArrowLength)
		- arrowAnimationTimer * (1. + effectiveArrowSpacing)
	);

	// Compute a "looping sawtooth" wave for determining the vertical texture
	// coordinates of the arrow texture, roughly as follows:
	// 3 ^              /
	//   |          ___/
	// 2 |         /
	//   |     ___/
	// 1 |    /
	//   |___/
	// 0 +--------------->
	//   0   ^ ^
	//   ^   |_|
	//   |   effectiveArrowLength
	//   |___|
	//   effectiveArrowSpacing
	//
	// This is effectively equivalent to this sort of sawtooth wave:
	//   ^
	// 1 |    /    /    /
	//   |___/ ___/ ___/
	// 0 +--------------->
	//
	// Causing the image of the arrow to repeat, with dead space (the bottom
	// edge of the texture stretched out) between the arrows at the provided
	// spacing. The reason why the "looping" design is preferred is because
	// it takes advantage of WebGL's 'GL_REPEAT' texture wrapping behaviour
	// to avoid the discontinuity that can end up causing visual artifacts.
	if (mod(v, (1. + effectiveArrowSpacing)) < 1.) {
		v = v - effectiveArrowSpacing * floor(v / (1. + effectiveArrowSpacing));
	} else {
		v = ceil(v / (1. + effectiveArrowSpacing));
	}

	// Use the r-component of the texture to determine whether the arrow covers
	// this fragment or not
	vec2 sampleTexcoord = vec2(u, v);
	float arrowAmount = 0.0;
	vec3 secondColor = pulseColor;

	if (displayArrowsOnPath) {
		arrowAmount = texture2D(arrowTexture, sampleTexcoord).r;
		float delta = 1.0 - abs(fragPathDistance * 2.0 - 1.0);
		secondColor = mix(color, pulseColor, 1.0 - smoothstep(ARROW_FADING_POINT, 0.0, delta));
	}

	if (dashed) {
		float dashLength = 0.1; // Adjust this value to change the dash length
		float gapLength = 0.1; // Adjust this value to change the gap length
		float totalLength = dashLength + gapLength;
		float numSegments = ceil(1.0 / totalLength);
		float adjustedTotalLength = 1.0 / numSegments;
		float adjustedDashLength = adjustedTotalLength * (dashLength / (dashLength + gapLength));
		float pattern = mod(fragPathDistance, adjustedTotalLength);
		opacity = pattern < adjustedDashLength ? 1.0 : 0.0;
	}


	if (showPulse) {
		// Add the pulse color to the path by determining how far the current fragment
		// is from 'pulse'
		float pulseLocation = remap(
		pulse,
		0.0,
		1.0,
		-pulseLength,
		1.0 + pulseLength
		);
		float pulseDistance = smoothstep(
		0.0,
		pulseLength,
		abs(fragPathDistance - pulseLocation)
		);

		// Blend the pulse color to the path based on how close this fragment is to
		// the 'pulse' value and whether it's covered by an arrow -- but if it's
		// covered by *both*, then we go back to using the regular path color
		// (making arrows look like "holes" when they're overlapping the pulse.)
		float pulseLevel = abs(1.0 - pulseDistance - arrowAmount);

		gl_FragColor = vec4(mix(color, secondColor, pulseLevel), opacity * opacityMultiplier);
	} else if (displayArrowsOnPath) {
		gl_FragColor = vec4(mix(color, pulseColor, arrowAmount), opacity * opacityMultiplier);
	} else {
		gl_FragColor = vec4(color, opacity * opacityMultiplier);
	}
	#include <colorspace_fragment>
}
`;R();var h3e=`uniform float complete;
uniform float nearRadius;
uniform float farRadius;
varying float fragPathDistance;
const float completeLength = 0.1;

// Map the x value from the range [xMin, xMax] to the range [yMin, yMax] using
// linear interpolation/extrapolation.
//
// This performs a pure linear mapping 'y = mx + b' where
// 'm = (yMax - yMin) / (xMax - xMin)',
// 'b = -xMin * (yMax - yMin) / (xMax - xMin) + yMin'.
float remap(float x, float xMin, float xMax, float yMin, float yMax) {
	return (x - xMin) / (xMax - xMin) * (yMax - yMin) + yMin;
}

// Map the x value from [xMin, xMax] to the range [yMin, yMax] using linear
// interpolation, clamping result values outside [yMin, yMax].
float clampRemap(float x, float xMin, float xMax, float yMin, float yMax) {
	return clamp(remap(x, xMin, xMax, yMin, yMax), yMin, yMax);
}

void main(void) {
	// this ensures that the stencil mask moves along with the path above it, to avoid the progress bar effect
	float completeLocation = complete * (1.0 + completeLength);
	float completeAmount = clampRemap(
		fragPathDistance,
		completeLocation - completeLength,
		completeLocation,
		0.0,
		1.0
	);
	float opacity = 1.0 - smoothstep(0.0, 1.0, completeAmount);

	// 2020/01/09 Terence Dickson
	// When we render the background and overlay for the mapbox outdoor context
	// behind everything else in single-buffer rendering, the fact that the path
	// writes to the depth buffer means that the background and overlay will not
	// be drawn behind the path even when the path is still fading in. The effect
	// is subtle and is only visible in single-buffer rendering so this quick fix
	// prevents writes to the depth buffer for zero opacity fragments, which gets
	// rid of the most visually-offensive ghosting.
	if (opacity <= 0.0) {
		discard;
	}

	gl_FragColor = vec4(0.0, 1.0, 0.0, opacity);
}`,c3e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAAAAAB5Gfe6AAAQkHpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjarZpZciQ7rkT/uYpeAicQ5HI4mr0dvOX3ATOl0li3q3SVJkUqFMEBcHc4IuX2///fcf/hK7cSXRatpZXi+cott9h5U/3j63EMPt+fL1/h+fPdeff6NnJMHNPjD2U/7+qcl183aH6eH+/PO52PN7E+B3qZ+Tlgspkjb57X1edAKT7Oh+fvrj3v6/nNdp7ftd057abHnz78npVgLGG8FF3cKSTPz2oXJFaQWuocCz9D0mhnEu8Tx54k6dexc98F77vY+f48n96HwvnyvKB8iNHzfJCvY3cj9HZF4dfM7/6QZ4j+7deb2J2z6jn7sbueC5Eq7rmpl63cd1w4GCrd2wov5Vt4r/fVeFW2OMnYIpuD13ShhUi0T8hhhR5O2Pc4w2SJOe5IuGOMM6Z7rhL+FudNSrZXOFFJz3KpkqtJ1hKn4+tawp233flmqMy8AlfGwGCBOz693Fcn/+b1OtA5Bt0QfH2NFeuKFnCWYZmzn1xFQsJ5xlRufO/LvcGNf5PYRAblhrmywe7HY4gh4Re20s1z4jrx2fkHNYKu5wCEiLmFxYREBnwJSUIJXmPUEIhjJT+dlceU4yADQSSu4A65SamQnBptbu7RcK+NEh+nkRYSIZBGSQ0EIlk5C/jRXMFQlyTZiUgRlSpNekklFymlaDGN6po0q2hR1apNe001V6mlaq211d5iS0iYtNLUtdpa651JO0N37u5c0fuII408ZJSho442+gQ+M0+ZZeqss82+4koL+q+y1K262uo7bKC085Zdtu662+4HrJ108pFTjp562umvWXtm9X3WwofM/T5r4Zk1y1i+1+mvrHFa9WWIYHIiljMyFnMg42oZANDRcuZryDla5ixnvkVIIZGsBbHkrGAZI4N5hygnvObuV+Z+mzcn+Y/yFr/LnLPU/RuZc5a6Z+Y+5+2LrK1+K0q6CTIWWkx9OggbF+zaY+1Wk/766H46wF8ONFY+O8hBMEc7oc4Vdh+8JsE+PUSrVjr70Zz1+H56PH3o9sRR1ql5Ha8bUMQxpe89Tki8Sb0tE23cw3DcfEo+ugnj2G3WEmononVfoag71pVjR+EmAE53eT5tqYfEHl/7ThMusaI+St0jktFa9gKnreiQqCNpZ2mJdSkbaiK6DrovYR4/JhJfRsx5d5EVZnEIPetHnU5KynJPTSuCPuC0lOuXH7n1DNq7DpUtHbhM5lDA0c2bnDCJoOObMnyj+aPjPwx0yiDUxKKsg35VnRnBEVhonKwK5hOk5NttUrhr2+tMOXkPJb1RZ+iAelYjL2MuO3pGRQ78GdxwOOaTAcJZcewq7ilB1RJCSozUdSEdwVJVb6asiBsHH1Bqgbiv3Cmkkis6ktVnZGRRwMNJjUA3Ao2127YWdhAIblxF51hzMcZsVZc0r0dJo5Liqfn41Q+q193SGhhkMkgaLJRNnEpqBtyVvbcVffIk+LE9QPFBTMTQe0aWkMXMnx3dy5sfHreDE60Ql50E+SqRcmfK16L2p0Ol8JFATu3qASXy7SvmiGW2cdMBxsty44CvtLogfGlv7WkCSV0WId2270EaD5Ym40cs+SAwZuNjPSTywAvEfLmzQhtLDntfCnhl/fNmUNnzyA2g76Zn0SP+c+I6bCC0FONUQ4L50e95dif+DH/m9htQjBEhPPpOjYjmm2ChbfEMIUaYtAIxmWJHlilLU8ZRs9pCsHbDpFaRgZljz2QandjDIBPZDGTuoZW1KdlYh52ALzisKJRNWSQmLAWx8iv9mGttT15bBc2oxd57bZtVF98CYtK3UH22Yd/A7WaKa+ZjNTOXEzNhMJ5kmQOvfzsbxbZALJ2xwGBjX2HFQybhi7kpbA7DVpS3RxMJwFyHwGk5gs6a4lrRHVqhYT0QTJC9UZcC9Yrelkn6yXch68NKNtG7CiU3vf/zMZAYXPWdrR9XZ/ctMV1sJQ2wJEGxzaHs7LmmHIwnUwbwnNAapBY9xhE19DNJW3ua0dDk/AjwITacR0PqZxkbyJ+E5jYbxI84x1TBE+y90hwDCYZIM0tqAKPZfCzFrbH8kYCm3eqQkZ2+2GovcL8Suokyg8yyCJes6dcouSLiNSLb0ETJU+/N/WFsBBSOXBbm9Cwp4CzlOag7ro7R2vC19nSsCPmAjIEMiobFwaoVXhjTU2XMpgEsDH/L3Sx54OCTMUSXI/IIA2V4QcLQpwVz12pInI0bY56pIQ2BSGRLL+yLfZ7JkiimbK+aepsbwRStpokx5gCqe1hjdMAwcINbkk5jmedrNRAG5pUXPe0sZIoXy1h7lSDxApzheg24JeDNtDS1oBDBUC4iWZFilBPhZx0Kqx2lihpbG9q4sYidksCN4yRYhNM4nxfBbTi4E3AT6B3igbvs9Gv8ZkHsIfdlep+2HelEDbkJdNjqZQ90B7k6OIoFfkkPNoY+z0gzACa1f2qcBYxVJpT2QQgS19dKQlbC24S92xiEAFRKB5Uy1qrBgOtwIge55G0kRPfIytGx0tMOrGfrijB2FHOk/TKcMjDTMPeBo4FnXD5cQ8vtdgoAN0yuzZQHQI09wm/5vAB6RHyI9rYKiZ6YWC6rbaiLmDtoaToC1bViXQFNtgWsOfEEKCleC3GWPSfgQWRQWMgw/9FDgvOZrFAT3SmsA3DLbqlsSppQG5QeOjPXavUUkxF/qgLM05vW5o7UakuBqo2ZW8Nj0LB7imVJC9QSA+wd7RPztIUZ80xQZq0ROrc8CSVncWzkTA/RwmunldCPAQKjqVC7bhRuTIv0plbk7gOX4m5OAi2YesYZ0KBQRToG8iv9x8dgGtgECYRBeEU87OxoSc8epu+s7Mq/MN0VbBT19dii7ekO66UZwdAMtoAVQd13J5nwZe98OgGslmVqAGBkeLZNVNVlWpV18qihntXKnBZvrDIVgFpx4q5poLqREOVplMPSpTF2KvjBAzDpprkruXIaaUmUD4Xo2yrGWcYlixKIwRFjl0jPQhKznUXZAoSjlg9c/NwAI4p3Q/w5bCNfhUZS7bGfqesHqKAlyZZxZgNrhGevZXccaqBys4NEqB3Vqfptji9uUrhCL6yXFqxtm0hhLyYU3Tjd8I/HZaWD1oyVjnG5hhpCN5yHSf8BQUZlVNd00OP4M0TK+JSM7iqWi01SinFkCQXWxiZJLqqAHiEt3G3I2WYd46KU9pIJIOkoRQYCcEAAPguHo0Y4k8Hl6SW50MoW0uZU8jJOUghKo38Nl5ZSwsJNAUC2/lFZWkfMjrU8dFrTjHpJnUrLCILQIxINiYdQlDXaE/razQ4jjQluN5jW1Eh/S7yYvI5gigSjdLYU9TiFXAcHjISiLhQd9obb3OQmwY+YqVwiBMCkOGLXaK/ljBShh56c1g0uyIb2lBRKO7ZTAFncw5c5UGjGSy3CsI1Jt2mtruZkfhBZmbR+842Yu1eDiWEl0V6LZcGem6Ct+LW4Wy3oAjyNObazKBHomhJ3HMKEKHgiGksH+Ig1nTidfNMyA+oYHqVFaRGLiQreVLc9GvQgftKjW9cfUSKNYL80rqU7Um2rwqQJR1ai31Wq7vzKJEsFHDj0bAEMUKXgvfD5bWbaLPBTKz1Nk/Fg+GUZvUzFw80CLaKtPAACVAWrismh863FU4IJ0716SXBUNVb/SDMVvZgDt34CXoOq1JKvg0n08gPHTwXBNgD5W8pZZ8E9EVWcv1DZMB2NFysIwkqBSaH5QRmsAHdkHB+UANvLJvFpQKAahSmYTLEd2AFO+5rsqRRU6sVv5IP0wsSPLcWsbC1Y95mte71CUm6RJJWwkg6Q4k+xWMM0ByElJPQ6j2ED5hY42ALpZRytx9RlgQlJLijzhKi5eX5JBSIRGfo9o2xhd/0aWku8OS+4D9ZnovHDQMPaYo4qm2mlZbUnd7pR6oQj29Z2BqJ9n3LRT+MTLu3IR+ZP2TCPh3EDw8H1NHpoT7FibNYU8WHd9ESHcY12aDOQCUBddi4Ucp+4yuzz8ybcCCu1h8zvzXhDN4HYLq1R+U0xzUqg5QSA3iSBgdDouy55Ifx0DaeEhgezxBRGmoEJ6AJitVuzwtKPlUskHgU2F0LS7AFIwW5jPu0RUL7sp+fkNk0ee8P6uXYgl40WM+cdCOW21r13e0ivt0ff/mYcUfrQZWs2BiN6G+MDTGz1BKORmUTNQp9YGSHFxAeTkQrKd6FoVUogyytW25OLy3OpaO5oZCQp46aPzb5LnJiFEIwAKkmbYVYIjzVv3vj7rA6HignEeQAXTAHKDhoD7Uujh0QjtsB6fTP1NzO7T1Nzq4F1GnfHdXCG1Yxjwdtjf+PGRGTzEtEAUCz7KLfTdItLwCXuSOAzVjaZB6LvbUZhYGWmifSZlcMDnGHPd6gPeiK9erhpiw7ZP9ahTrMhFDa1J53m9ri2DloziqGETTcVSppCbTDDjExg6RrZ6cPEzB8XArEjQSB29odrUoLyoS/65RfM9fprGGjlHpbhGgbYD8MtmW1eFcAWX5dbcMHcl8sUI2k+H7GPW9VrArw3G+BefcCrCaAT/N53YLvP26Uy0kMFnDEZz0DJkmQqEOlL7SlKweYhH8gxpYeAYi0f9magqPbMYZuUI6007lSZQoyoGfYQHsNRzHXR3MMINTSMZpq1KD2A5MDJgtMLdRU6R4CEOJcKGiIJ7K6P/vAM6xpECHI8rRHsaEj6smkngAUjXTzrRoSI48ZpHOqgOY5OejKVdpnmiYUChQnVdIPa6ekGqRSRgEO119oDHOiIUQ5ciYVgaF1oG8Udo8WYtD+DEi8D/w8rAJE2k2PoyV0oMtpauxreaFjpujAvxFlwBhjuNqM9P0IfI5iD8Nh8y1kG4igjJkDNkOijnlLhItAd9lhRd670yNRTu95cR/Xuu0c5WO4DEFk5YQAPtLvU4TYPGRh4APPEDNiuuwR6SC21JoFbQBBMr+zJmT32QplNI6p16PbculN/pCX1wAyTWGTeJ774aln0gvQikw7TmkfsNbdQNs0adutYUDqNtGc0RqngUYdhUYuHSL1/eLrgvqDTC5neu++vufRkEgP9D2T64Kg/c4n+s7k3dDr3me8nOr0c72MRNmgF7D4WySPP0YAI/bI4eixwc7K13QiRiL85A8fnSsUj+mvTrsZtVUEQZ6sTpVafW8nYJZyaZS0U+0xIb6et9PhhtoObozQbjKAoDf6eiFgx1UUvpUYj1GweH0MNMrofhynfWn7+KYu7n5r83hN9aqm+6qjcH7dUlgvZVLV3xqq4fbP16qv+eofuTz43eomAqfS7GBAB9zEE31WJ37eVIPtdGN5A8nMYPvvLt8t2/V/6gM19G4g/hIL7UXf9JgbuLRZ+AoW//AzyMxTcWyz8BAruLRZ+AgX3r3y2+mT/PwfiN1DoVI+QT3CZDmvb8022JeYb6HiQPQpPPvboFB+i1MZdcqWZqthHmix6vttw0UAI1z8oEnGwVe++c7JamxslC+8xKJE41XJmug1npz+6CUAKyURd9gSxo+kWxvtZth848GBlws/0SKjYhmbZ9IiV+mcGBSdWHk8sqSr2zz5J7QME/0yD+z4Pe+JuGn1MV/vUyZwOHojWPlmPXgf9CuoeN9UAT+FGwaLg44v3dWe6QpvuL3Ln/p3k/2AgqNDcfwHgqUmIIqn+hwAAAAJiS0dEAACqjSMyAAAACXBIWXMAAAsSAAALEgHS3X78AAAAB3RJTUUH4wYRESAMujenGAAAB9FJREFUeNrtnWlsFVUUx899fS1gUoKioEY+WBRUEohGkUhAKxgEjSgGoRGB4AJCNKAIJBJZJSiyGYMKKkIoLlEUKhUraxFkKUE2kU1aCrRgW2jpg9f29R2/sBTo67v3zL2zvfP73MzM+XU6mf+5504BGIZhGIZhGIZhGIZhGMZGGq3JvSmR62++BXHH7Ylbf9ouRMT99yVq/e0PICIiHumUmPV3PooXOf5EItafXoCXOdUn8ep/pgjrUDY40ervX4JXUTEiocoXL5/FawiNEwlU/6hzeB3hqQljQIwJYT3UzEkQA2JiGOslsiAhDIgZ1RiD6NIEMBD8NIKxyQr6vv7FtdgQa31uILg0ig2zsZmv4//yePUj7rjNv/U3yUEJ/r7Xr/XfvBmlOPKwT+vfhpIUdvdj/Wm7UZpTz/mv/g4HUYGyQb5r/+SjEhXD/VV/j5OoSGisj16LRe9iVCY8xTcGxIulSKBmtk8MiKHlSMIn8ViMqkQivojHgfcuIJ0VAc/XPzmMVljrcQOBmdVojY1NvVx/8mcRtEqeh+NxypJatM6+ezxb/7Io6uBwR4/e/1moicJunvz956A2ip/1Xv3Nt6JGSgd6rf47/0KtlHssHrfZi5rxVDwWDx5C7XgoHotHC9AANbO8YqBXERohMt8bv/8X/kNDRDM9cA+IgWVojhWuNxAYXo4mWePyeBwYHUKz5Lo6HidNvICmybvVxfXPqEbz7Gvr2vrn1KAdHH7IpX//8yNoD8dcGY+TM6NoF26MxzLTL26Mx0majtM4q5ed7yhNulVsd5WAxqset/mGS6/d5CIBLXI62/7I6ZKyzjUC0rIfsP+hE3zkxt9c8vy7tPnJbiKfuyP+Xdn8ZDeuiMei+zF0juWOGyBNv+iMxw4bEBkl6CzOxmPx6ll0mryWDtb/ViU6z17H4rEYG0I3cMiheByYFEZ34Ew8Dn5UjW7BiXisY/rFDfGYmgWCCwcngXto0q08z1YBSUsy3NWgb5Qe2WSjgJRlfdy2RJPcNXm9bQIarexpsP5VdxHjcbMcm2Q3/5P64i71U8k/ELuLNsVjcct2cnST+rGg+Jo4XmhLPBZ376GOfoOkAIB5NWTHxuu/nzj9ElkA8gLgA+pLlvF43IU4/VI9G1QEAHnIPjfVaP1PnqRdVngKqAkActDMa2Hw/u9zijjjNg5UBcBr1FbD3jbG6h9QSruk8ovfyFESABnUWSNT8VgMI06/lF7aBqomAJ4n3m+G4nHgbeJfZfHljcCKAqDHcWo87m2g/gnE53LhlS+lqQqATv9S4/FL2u//qcT2T34XoAuAdvuJBspf11z/LOKbyYG6q4bqAqDVTqKByjFa21/U6ZfdaWBNADTdTDQQnqSv/pRMYjrZevVLCUUAiF+JBqpnaqv/J2I+zb3mxZwkAMTPDq8ep1A3P/1y3ZOEJABgiaPxuOnvxLN/B7oEwELq/sPl1utvSdz8VPsl6BMAn1AbBKut1t96F+3ENXOFTgFiehXRwAZL8Vi0JW5+qppW7+HIAgDGnyca2G4hHouOh2knvTARdAuAkedsj8cinTj9Ujka9AuAV87YHI/F08TNT2eHgQkB0I/aIDhGmuIU/YnnKxkAZgTAU8SGHC0eDyJufiqKfTKrAqBrPtFAiXo8HlFBO1VBA7ebZQHQifhUVo7H4p2QgQeOdQHQbp8t8Tg4idj+2dPgwJIGAdBqhw3xmDz9EuelQ4cASP3DeDwOziW+ecdbldEiACDbcDxOWkBs/8QNHpoEAPXjLNFMmfpv+IZ4+PjRU5cAWGwwHqcQNz/J2NUmAMgjavHjMfEPTGpvvz4BQH1MrzMkoHoW2CsAppEaBFskemQUA+HJYLcAeJfQINgpNVuvbiA0FuwXAG8qNwh2S07WqxqQ/saPXgEwRDGu7W8te2Q1A6XSH0HWLAD6nVa5zoPS9asZKJb/DLZuAdDzhPx1Hu2gkobkDRQq/J8w7QJAfstevuI3+WQN1F39dkAAtP9H7jpPdFVtiMgZOKC0Z9aAAEiT+mrbScLQjIyBXWngtABokRf/kKefonRF4xvYqrjmYEQApG6Md8SyvrS+eDwDG5QbzUYExL3QMxnUlZGGD5wFbhEADQ7YVwyhr401YCD6LbhHACyK3SA4N9TK6mhMA5EvwE0CYF6sBkFopLXl8exYq9/gLgHwYf3x+PxoqwMC9RoIvw9uE1D/gH3VeOsjItnSq9/OCqhvwL5qAoABA5XU28qsAHjj2tW8mukABgzEXP12WgAMvrpBEPkYwICB2KvfjguAvnUH7GvnARgwUGRhEt24gLoD9tGvAAwYKLDyySzzAqDzpQH76CIAAwYOWtqNYoMAaH9xwP57AAMG9ljbj2SHALhjJyLijwAGDGyzuCPNFgGQuhlxpfw1yR94dfAxi5cmojI/lRyx+rtaX9XDhADr2CVABc//JycWwAJYAAtgASyABbAAFsACWAALYAEsgAWwABbAAlgAC2ABLIAFsAAWwAJYAAtgASyABbAAFsACWAALYAEsgAWwABbAAlgAC2ABLIAFsAAWwAJYAAtgASyABbAAFsACWAALYAEsgAWwABbAAlgAC2ABLIAFsAAWwAJYAAtgASyABbAAFsACWIDToH8FyJUWtVWAALedDoFhGIZhGIZhGIZhGIYxyf+YwEMsIhMo/AAAAABJRU5ErkJggg==",p3e=new qP;function nse(i,e,t){let{nearRadius:n,farRadius:r,accentColor:a,completeFraction:o,isVertical:s,visibleThroughGeometry:u,dashed:h}=e,{color:d}=t,f=0,m=1/0,v=e.displayArrowsOnPath,b=!0,w=v,A=n/2+d3e,E=0;i[0].z+=A;for(let we=1;we<i.length;++we){i[we].z+=A;let Ne=i[we].x-i[we-1].x,je=i[we].z-i[we-1].z;if(s)E+=Math.sqrt(Ne*Ne+je*je);else{let Ve=i[we].y-i[we-1].y;E+=Math.sqrt(Ne*Ne+Ve*Ve+je*je)}}if(!s){let we=i[0],Ne=i[i.length-1];i.push(Ne.clone().setZ(Ne.z-.01)),i.unshift(we.clone().setZ(we.z-.01))}let I=new Zo;w&&(I=p3e.load(c3e),I.colorSpace=io);let C=new Mi(d),T=new Mi(a),k={vertexes:{type:"f",value:1},resolution:{type:"v2",value:new ft(1,1)},cameraParameters:{type:"v2",value:new ft(f,0)},complete:{type:"f",value:0},color:{type:"c",value:C},pathLength:{type:"f",value:E},nearRadius:{type:"f",value:n},farRadius:{type:"f",value:r},nearZoom:{type:"f",value:f},farZoom:{type:"f",value:m},pulseColor:{type:"c",value:T},pulse:{type:"f",value:0},pulseLength:{type:"f",value:.075},pathIsVertical:{type:"b",value:s},arrowAnimationTimer:{type:"f",value:0},arrowTexture:{type:"t",value:I},displayArrowsOnPath:{type:"b",value:v},showPulse:{type:"b",value:b},opacityMultiplier:{type:"f",value:1},dashed:{type:"b",value:h}},F=new QO(i);F.curveType="catmullrom",F.tension=0;let B=30,N=8,z=B*i.length,L=new Tce(F,z,n,N,!1),j=new Float32Array(L.attributes.position.count);for(let we=i.length;we<j.length;we++)j[we]=we;L.setAttribute("vertexIndex",new gr(j,1));let q=new Float32Array(L.attributes.position.count),Z=new gr(q,1);for(let we=0;we<=z;we++)for(let Ne=0;Ne<=N;++Ne)Z.setX(we*(N+1)+Ne,we/z);L.setAttribute("pathDistance",Z);let O=new Float32Array(L.attributes.normal.count*3),Y=new gr(O,3);for(let we=0;we<z;we++){let Ne=L.tangents[we];for(let je=0;je<=N;++je)Y.setXYZ(we*(N+1)+je,Ne.x,Ne.y,Ne.z)}L.setAttribute("pathTangent",Y);let J=new Float32Array(L.attributes.normal.count*3),oe=new gr(J,3);for(let we=0;we<z;we++){let Ne=L.tangents[we];var $,K,te;s?($=Ne.x*Ne.y,K=-1+Ne.y*Ne.y,te=Ne.z*Ne.y):($=-Ne.x*Ne.z,K=-Ne.y*Ne.z,te=1-Ne.z*Ne.z);let je=Math.sqrt($*$+K*K+te*te);je===0&&(je=1);let Ve=$/je,Le=K/je,xe=te/je;for(let Ue=0;Ue<=N;++Ue)oe.setXYZ(we*(N+1)+Ue,Ve,Le,xe)}L.setAttribute("pathNormal",oe);let ve=new ys({uniforms:k,vertexShader:AM,fragmentShader:o8});ve.transparent=!0,ve.alphaTest=.5,k.resolution.value.x=1,k.resolution.value.y=1,k.vertexes.value=j.length,k.arrowTexture.value.wrapS=fl,k.arrowTexture.value.wrapT=fl,k.arrowTexture.value.anisotropy=16;let Q=new ln(L,ve),he=Q.clone(),se=lt(Me({},k),{opacityMultiplier:{type:"f",value:.25}});se.complete.value=1,he.material=new ys({uniforms:se,vertexShader:AM,fragmentShader:o8}),he.material.transparent=!0,he.material.alphaTest=.5,he.material.depthWrite=!1,he.material.depthTest=!1,se.resolution.value.x=1,se.resolution.value.y=1,se.vertexes.value=j.length,se.arrowTexture.value.wrapS=fl,se.arrowTexture.value.wrapT=fl,se.arrowTexture.value.anisotropy=16,se.complete.value=o,Q.userData=he.userData=e.mesh.userData;let Ae=e.mesh;if(!u){let we=new ys({uniforms:k,vertexShader:AM,fragmentShader:h3e}),Ne=new ln(L,we);Ne.name="stencil",Ne.material.colorWrite=!1,Ne.material.stencilWrite=!0,Ne.material.stencilRef=1,Ne.material.stencilFunc=vC,Ne.material.stencilZPass=hS,Ne.material.stencilZFail=hS,Ne.material.stencilFail=hS,Ne.material.depthWrite=!1,Ne.material.depthTest=!1,Ne.userData=e.mesh.userData,Ae.add(Ne),Ae.add(he)}if(Ae.add(Q),s){let we=new ur().setFromObject(Q),Ne=new Ee;we.getCenter(Ne),Ae.children.forEach(je=>{je.geometry.center(),je.position.copy(Ne)})}u&&(Q.material.stencilWrite=!0,Q.material.stencilRef=1,Q.material.stencilFunc=Nhe,Q.material.stencilZPass=ih,Q.material.stencilZFail=ih,Q.material.stencilFail=ih,Q.material.needsUpdate=!0,Q.layers.disableAll(),Q.layers.enable(lee.ALWAYS_ON_TOP)),L.computeBoundingBox();let Ie=new Ee;return L.boundingBox.getCenter(Ie),{mesh:Ae,material:ve,center:Ie}}l(nse,"buildPath");var d3e=.15,f3e=.5,rse=class extends xr{constructor(e,t,n,r){super(),D(this,"rendererState"),D(this,"altitudeDirty",!0),D(this,"convertTo3DMapPosition"),D(this,"getParentContainer"),D(this,"convertZoomLevelToAltitude"),this.rendererState=e,this.convertTo3DMapPosition=t,this.getParentContainer=n,this.convertZoomLevelToAltitude=r}update(e,t,n,r=0){let a,o=!1;for(let s of this.rendererState.geometry3DIdsInScene)if(a=this.rendererState.geometry3DMap.get(s),a&&a.type==="path"&&a.components[0].type==="path"){let u=a.components[0],h=a.components[1],d=u.isVertical&&this.altitudeDirty;if(!(u instanceof Ab))continue;let f=[];if(u.dirty||d){if(u.mesh.parent!=null)for(let m=u.mesh.children.length-1;m>=0;m--)Ra(u.mesh.children[0]);if(u.feature.features.length===2&&u.feature.features[0].properties.parentId&&u.feature.features[1].properties.parentId){let m=u.feature.features[0],v=u.feature.features[u.feature.features.length-1],b,w,A=m.geometry.coordinates[2]||0,E=v.geometry.coordinates[2]||0;m.properties.parentId&&(b=this.getParentContainer(m.properties.parentId,!0),b!=null&&b.altitude!=null&&(A+=b.altitude,u.isVertical=!0)),v.properties.parentId&&(w=this.getParentContainer(v.properties.parentId,!0),w!=null&&w.altitude!=null&&(E+=w.altitude,u.isVertical=!0));let I=this.convertTo3DMapPosition(m.geometry.coordinates[1],m.geometry.coordinates[0],A),C=this.convertTo3DMapPosition(v.geometry.coordinates[1],v.geometry.coordinates[0],E);Math.abs(I.z-C.z)>f3e&&b!=null&&b.visible&&w!=null&&w.visible&&(f=[I,C])}else{let m=u.feature.features;for(let v=0;v<m.length;v++)if(v===0||!xee(m[v].geometry.coordinates,m[v-1].geometry.coordinates)){let b=this.convertTo3DMapPosition(m[v].geometry.coordinates[1],m[v].geometry.coordinates[0],m[v].geometry.coordinates[2]||0);f.push(b)}}if(f.length>1){let{mesh:m,material:v,center:b}=nse(f,u,{color:h.color});u.mesh=m,u.material=v,u.position=b}u.dirty&&(u.nearZoomLevel!=null&&(u.nearZoomAltitude=this.convertZoomLevelToAltitude(u.nearZoomLevel)),u.farZoomLevel!=null&&(u.farZoomAltitude=this.convertZoomLevelToAltitude(u.farZoomLevel))),u.dirty=!1}h.dirty&&(u.mesh.children.forEach(m=>{m.name!=="stencil"&&(m.material.uniforms.color.value.set(h.color),m.material.visible=h.visible,m.material.needsUpdate=!0)}),u.mesh.position.z=h.altitude,h.dirty=!1),u.isVertical&&u.mesh.children.forEach(m=>{m.rotation.z=-r}),u.material&&(u.mesh.children.forEach(m=>{var v,b;let w=m.material.uniforms;if(m.name==="stencil"){u.materialDirty&&(w.complete.value=u.completeFraction);return}w.nearZoom.value=(v=u.nearZoomAltitude)!=null?v:e,w.farZoom.value=(b=u.farZoomAltitude)!=null?b:t,w.cameraParameters.value.x=n,u.materialDirty&&(w.nearRadius.value=u.nearRadius,w.displayArrowsOnPath.value=u.displayArrowsOnPath,w.farRadius.value=u.farRadius,w.pulseColor.value.set(u.accentColor),w.complete.value=u.completeFraction)}),u.displayArrowsOnPath&&u.animateArrowsOnPath&&(u.mesh.children.forEach(m=>{m.name!=="stencil"&&(m.material.uniforms.arrowAnimationTimer.value=performance.now()/3e3,m.material.needsUpdate=!0)}),o=!0),u.materialDirty=!1)}this.altitudeDirty=!1,o&&this.publish("animate:path")}};l(rse,"PathSystem");var m3e=rse;R();var xa,_v,nc,ase=class{constructor(e){D(this,"rendererState"),D(this,"dirty",!1),ge(this,xa),ge(this,_v),ge(this,nc),this.rendererState=e}updateOne(e){if(e instanceof lr&&e.components[0]instanceof vs&&e.components[1]instanceof Ym&&e.parentObject3D instanceof Io&&(Ce(this,xa,e.components[0]),Ce(this,nc,e.components[1]),y(this,xa).detached&&y(this,xa).dirty&&y(this,xa).mesh!=null&&y(this,xa).material!=null&&y(this,xa).batchedProps!=null)){Ce(this,_v,e.parentObject3D),y(this,xa).visible=!1;let t=new Mi(y(this,nc).color),n=y(this,nc).opacity*y1(e),r=new BI({color:t,side:Go,opacity:n??1,transparent:n!==void 0?n<1:!1},1,y(this,xa).material.repeatYFactor),a=new HL(1,y(this,xa).batchedProps.positionCount,0,r),o=Voe(y(this,xa),a);if(o==null)return;a.userData={entities:{0:e.id},detached:!0},y(this,xa).instanceIndex=o,y(this,xa).material.setColor(y(this,xa).instanceIndex,t,y(this,nc).topColor?new Mi(y(this,nc).topColor):t),y(this,xa).mesh=a,y(this,xa).material=r,y(this,_v).add(a),y(this,xa).dirty=!1}}update(){if(!this.dirty)return;let e;for(let t of this.rendererState.geometry3DIdsInScene)e=this.rendererState.geometry3DMap.get(t),this.updateOne(e);this.dirty=!1,this.cleanup()}cleanup(){Ce(this,xa,void 0),Ce(this,_v,void 0),Ce(this,nc,void 0)}};xa=new WeakMap,_v=new WeakMap,nc=new WeakMap,l(ase,"MeshDetachmentSystem");var g3e=ase;R();R();function ose(i,e,t){var n;if((n=i.batchedProps)!=null&&n.range&&i.mesh){let r=e||1e-4,a=r/Math.max(t,1e-4);return YD(i.mesh.geometry,i.batchedProps.range,r,0),i.material&&(i.material.repeatYFactor=a),i.currentHeight=r,!0}return!1}l(ose,"updateHeight");function sse(i,e,t,n,r,a){return i.mesh&&i.instanceIndex!==-1?(i.mesh.getMatrixAt(i.instanceIndex,t),t.decompose(n,r,a),n.z=e,t.compose(n,r,a),i.mesh.setMatrixAt(i.instanceIndex,t),i.altitude=e,!0):!1}l(sse,"updateAltitude");var kl,Hu,cT,pT,dT,fT,lse=class{constructor(e){D(this,"rendererState"),D(this,"dirty",!1),ge(this,kl),ge(this,Hu),ge(this,cT,new qi),ge(this,pT,new Ee),ge(this,dT,new lu),ge(this,fT,new Ee),this.rendererState=e}updateOne(e){var t;if(e instanceof lr&&e.type==="geometry"&&(t=e.components[1])!=null&&t.dirty&&(Ce(this,kl,e.components[0]),Ce(this,Hu,e.components[1]),e.type==="geometry")){let n=!1;y(this,Hu).height!==y(this,kl).currentHeight&&(n=ose(y(this,kl),y(this,Hu).height,y(this,Hu).initialHeight)),y(this,Hu).altitude!==y(this,kl).altitude&&(n=sse(y(this,kl),y(this,Hu).altitude,y(this,cT),y(this,pT),y(this,dT),y(this,fT))),n&&y(this,kl).mesh!=null&&y(this,kl).mesh.computeBoundingSphere()}}update(){let e;for(let t of this.rendererState.geometry3DIdsInScene)e=this.rendererState.geometry3DMap.get(t),this.updateOne(e);this.cleanup()}cleanup(){Ce(this,kl,void 0),Ce(this,Hu,void 0)}};kl=new WeakMap,Hu=new WeakMap,cT=new WeakMap,pT=new WeakMap,dT=new WeakMap,fT=new WeakMap,l(lse,"MeshModificationSystem");var y3e=lse;R();var v3e={showPolygonLabelTextAreaMesh:!1,showEnvMap:!1,showCollisionBoxes:!1},use=class{constructor(e){D(this,"state",v3e),D(this,"core"),this.core=e}update(e){let t={};for(let[n,r]of Object.entries(e))n in this.state&&this.state[n]!==e[n]&&(this.state[n]=r,t[n]=r);this.handleUpdate(t)}handleUpdate(e){e.showPolygonLabelTextAreaMesh!=null&&(e.showPolygonLabelTextAreaMesh?this.core.getSystems().text3DSystem.showTextAreaMesh():this.core.getSystems().text3DSystem.hideTextAreaMesh()),e.showEnvMap!=null&&(e.showEnvMap?this.core.setEnvironment("basic"):this.core.setEnvironment(!1)),e.showCollisionBoxes!=null&&(e.showCollisionBoxes?(this.core.getSystems().collisionSystem.showCollisionBoxes(),this.core.render()):this.core.getSystems().collisionSystem.hideCollisionBoxes())}};l(use,"Debug");var _3e=use;R();var k_=9,s8=.1;function hse(i,e,t){for(let n=0;n<e;n++){let r=(t&16711680)>>16,a=(t&65280)>>8,o=t&255;i[n*3]=r/255,i[n*3+1]=a/255,i[n*3+2]=o/255}}l(hse,"fillArrayWithColor");var cse=class{constructor(e,t,n){if(D(this,"state"),D(this,"renderer"),D(this,"renderService"),D(this,"pickingTexture"),D(this,"pickingMaterial"),D(this,"pixelBuffer"),D(this,"width",0),D(this,"height",0),D(this,"scale",1/2),D(this,"color",1),D(this,"convertTo3DMapPosition"),D(this,"destroyed",!1),D(this,"enabled",!1),D(this,"backgroundId",16777215),D(this,"resize",l(()=>{let r=this.state.pixelRatio;this.width=Math.floor(this.renderer.domElement.width/r*this.scale),this.height=Math.floor(this.renderer.domElement.height/r*this.scale),this.pixelBuffer=new Uint8Array(4*this.width*this.height),this.pickingTexture=new Oc(this.width,this.height,{format:ao,type:vl,internalFormat:"RGBA"})},"resize")),D(this,"shouldShowByXY",l((r,a,o)=>{if(this.pixelBuffer==null)return!1;let s=r+(this.height-a-1)*this.width,u=this.pixelBuffer[s*4],h=this.pixelBuffer[s*4+1],d=this.pixelBuffer[s*4+2],f=u<<16|h<<8|d;return f===o||f===this.backgroundId},"shouldShowByXY")),D(this,"activeOccluders",new Set),D(this,"update",l(()=>{if(!this.enabled||(this.activeOccluders.clear(),this.activeOccluders.add(this.backgroundId),!this.pickingTexture||!this.pixelBuffer))return;let r,a;for(let s of this.state.geometry3DIdsInScene){let u=this.state.geometry3DMap.get(s);if(u&&u instanceof Kn&&u.userData.occluderFeature!=null&&u.userData.occluderId!=null&&(this.activeOccluders.add(u.userData.occluderId),u.userData.occluderDirty)){if(r=u.userData.occluderFeature,r.geometry.type==="Polygon"){let h=WD(r,this.convertTo3DMapPosition,{color:"white",height:s8});a=this.createOccluderMesh(h,u.userData.occluderId),u.add(a)}else if(r.geometry.type==="MultiPolygon"){let h=qD(r,this.convertTo3DMapPosition,{color:"white",height:s8});a=this.createOccluderMesh(h,u.userData.occluderId),u?.add(a)}u.userData.occluderDirty=!1}}this.renderer.setRenderTarget(this.pickingTexture);let o=new Mi(this.backgroundId);this.renderer.setClearColor(o),this.renderer.clear(),this.state.cameraObject.layers.disableAll(),this.state.cameraObject.layers.enable(k_),this.renderer.render(this.state.entityScene.parent,this.state.cameraObject),this.renderer.setRenderTarget(null),this.state.cameraObject.layers.disable(k_),this.renderService.enabledLayers.delete(k_),this.renderer.readRenderTargetPixelsAsync(this.pickingTexture,0,0,this.width,this.height,this.pixelBuffer).then(()=>{if(!this.destroyed)for(let s of this.state.geometry2DIdsInScene){let u=this.state.geometry2DMap.get(s);if(u&&u?.occluderId!=null&&this.activeOccluders.has(u?.occluderId)){let h=u.components[0].projection,d=Math.floor(h.x*this.scale),f=Math.floor(h.y*this.scale),m=this.shouldShowByXY(d,f,u.occluderId);u.components[0].isOccluded=!m}}})},"update")),this.state=e,this.convertTo3DMapPosition=t,n?.renderer==null)throw new Error("No Renderer");this.renderService=n,this.renderer=n.renderer,this.resize(),this.pickingMaterial=new ys({glslVersion:xC,vertexShader:`
				attribute vec3 color;
				varying vec3 vColor;
				void main() {
					vColor = color;
					gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
				}
			`,fragmentShader:`
				varying vec3 vColor;
				out vec4 fragColor;

				void main() {
					fragColor = vec4(vColor, 1.0);
				}
			`})}applyId(e,t){let n=e.attributes.position,r=new Float32Array(n.count*3);hse(r,n.count,t),e.setAttribute("color",new gr(r,3))}createOccluderMesh(e,t){let n=new ln(e,this.pickingMaterial);return n.layers.set(k_),this.applyId(n.geometry,t),n.userData.occluderId=t,n}reserveOccluderId(){return this.color++,this.color}enable(){this.enabled=!0}disable(){this.enabled=!1}destroy(){var e;this.destroyed=!0,(e=this.pickingTexture)==null||e.dispose(),this.pickingMaterial.dispose(),this.pickingTexture=void 0,this.pixelBuffer=void 0}};l(cse,"Occlusion2DSystem");var x3e=cse;R();var pse=class{constructor(e){this.state=e,D(this,"dirty",!0)}update(){var e;if(this.dirty){for(let t of this.state.geometry3DIdsInScene){let n=this.state.geometry3DMap.get(t);if(n instanceof lr&&n.type==="geometry"&&((e=n.components[0])==null?void 0:e.geometry)!=null){let r=n.components[0];r.geometry&&(r.geometry.dispose(),r.geometry=void 0)}}this.dirty=!1}}};l(pse,"GeometryDisposalSystem");var b3e=pse,l8=new Z1,{DEFAULT_PITCH:dse,DEFAULT_BEARING:fse,DEFAULT_ZOOM_LEVEL:mse,DEFAULT_MIN_ZOOM_LEVEL:w3e,DEFAULT_MAX_ZOOM_LEVEL:A3e}=Hp,S3e=Bn.radToDeg(.6435011087932844),jr,kr,Xf,Ob,xv,Pp,Zf,bv,sl,mT,tt,Yn,zl,Vr,sh,za,Je,Nb,ba,Zn,gse,yse,vse,xc,gT,Fb,Bb,zb,wv,yT,Ub,Vb,jb,Av,vT,Yf,Gb,$b,zo,Uo,_T,Sv,Hb,_se=class extends xr{constructor(e,t={}){var n,r,a,o,s,u,h,d,f,m,v,b,w,A,E;if(super(),ge(this,sl),D(this,"options"),D(this,"container"),D(this,"Debug"),ge(this,jr),ge(this,kr),ge(this,Xf),ge(this,Ob),ge(this,xv),ge(this,Pp),ge(this,Zf),ge(this,bv),D(this,"rendererDomElement"),ge(this,tt,{geometry3DMap:new Map,geometry2DMap:new Map,geometry2DIdsInScene:new Set,geometry3DIdsInScene:new Set,geometryGroupIdsToLoad:new Set,entityScene:new Kn("__scene"),hoverColor:"#f6efff",text3dHoverColor:"white",insetsPadding:oee,shouldMeasureCanvas:!0,pixelRatio:this.resolutionScale,canvasWidth:0,canvasHeight:0,internalTweenGroup:new YI,externalTweenGroup:new YI,cameraObject:new Ao,naturalBearing:0,containerOffset:[0,0],useStandaloneCamera:!1}),D(this,"camera"),ge(this,Yn),ge(this,zl),ge(this,Vr),ge(this,sh),ge(this,za),ge(this,Je,{}),ge(this,Nb,window.matchMedia("screen and (min-resolution: 2dppx)")),D(this,"map"),ge(this,ba,l(()=>{y(this,Je).renderSystem.twoDdirty=!0},"#invalidate2DEntities")),ge(this,Zn,l(()=>{y(this,Je).renderSystem.threeDdirty=!0},"#invalidate3DEntities")),ge(this,xc,"standalone"),ge(this,gT,l(()=>{y(this,Je).geometryDisposalSystem.dirty=!0,this.render()},"#setGeometryDisposalDirty")),ge(this,Fb,l(L=>Math.trunc(L*10)/10,"#round10")),ge(this,Bb,l(()=>{St(this,sl,mT).call(this,$v()),y(this,Je).twoDDrawSystem.dirty=!0,y(this,wv).call(this,void 0,void 0,!0)},"#handlePixelRatioChange")),ge(this,zb,l(()=>{y(this,wv).call(this)},"#handleWindowResizeWithEvent")),ge(this,wv,l((L,j,q=!1)=>{let Z=L??this.rendererDomElement.clientWidth,O=j??this.rendererDomElement.clientHeight;if((Z===0||O===0)&&!q)return;y(this,tt).canvasWidth=Z,y(this,tt).canvasHeight=O,St(this,sl,mT).call(this,$v()),y(this,Av).call(this),St(this,sl,vse).call(this),y(this,Je).cameraSystem.resize(this.canvasWidth,this.canvasHeight),y(this,Je).cameraSystem.dirty=!0,y(this,Je).watermarkSystem.resize(this.canvasWidth,this.canvasHeight),y(this,Je).htmlControlsSystem.resize(this.canvasWidth),y(this,Je).geometryInFocusSystem.resize(),y(this,Je).occlusion2DSystem.resize();let{top:Y,left:J}=this.container.getBoundingClientRect();y(this,tt).containerOffset=[Y,J],this.publish("resize"),this.render()},"#handleWindowResize")),ge(this,yT,l(()=>{this.renderSync()},"#renderFull")),ge(this,Ub,new Ee),ge(this,Vb,l((L,j)=>{let q=this.mode==="standalone"?y(this,kr):this.viewCamera;if(y(this,kr).position.z+this.camera.elevation>j.z){y(this,Ub).copy(j);let Z=y(this,Ub).project(q),O=(Z.x+1)/2*this.canvasWidth-0/2,Y=(-Z.y+1)/2*this.canvasHeight-0/2,J=y(this,Fb).call(this,O),oe=y(this,Fb).call(this,Y);L.x=J,L.y=oe}else L.x=-1e3,L.y=-1e3},"#project")),ge(this,jb,l((L,j)=>{y(this,za).setBufferSize(L,j),y(this,kr).aspect=L/j,y(this,kr).updateProjectionMatrix(),y(this,kr).updateMatrixWorld(!0),y(this,xv).x=L,y(this,xv).y=j},"#setBufferSize")),ge(this,Av,l(()=>{var L;let j=y(this,tt).canvasWidth=this.rendererDomElement.clientWidth,q=y(this,tt).canvasHeight=this.rendererDomElement.clientHeight,Z=Math.floor(j*this.resolutionScale),O=Math.floor(q*this.resolutionScale);y(this,jb).call(this,Z,O),(L=this.map)==null||L.resize(),y(this,tt).shouldMeasureCanvas=!1},"#measureCanvas")),D(this,"getParentContainer",l((L,j=!0)=>{if(!L)return j?y(this,tt).entityScene:void 0;if(typeof L=="string"||typeof L=="number"){let q=y(this,tt).geometry3DMap.get(L);return q instanceof Kn?q:(nt.warn("Parent (".concat(typeof L=="object"?L.id:L,") is not a valid container, adding to scene")),j?y(this,tt).entityScene:void 0)}else if(L.type==="group-container"){let q=y(this,tt).geometry3DMap.get(L.id);if(q instanceof Kn)return q}return j?y(this,tt).entityScene:void 0},"getParentContainer")),D(this,"showCollisionBoxes",l(()=>{y(this,Je).collisionSystem.showCollisionBoxes(),this.render()},"showCollisionBoxes")),D(this,"hideCollisionBoxes",l(()=>{y(this,Je).collisionSystem.hideCollisionBoxes(),this.render()},"hideCollisionBoxes")),D(this,"projectScreenXYToCoordinate",l((L,j,q=!1)=>{var Z,O;let Y=y(this,tt).containerOffset[0],J=y(this,tt).containerOffset[1],oe=(L-J)/y(this,tt).canvasWidth*2-1,$=-((j-Y)/y(this,tt).canvasHeight)*2+1,K=new ft(oe,$),te,ve;if(q)l8.setFromCamera(K,y(this,kr)),te=(Z=l8.intersectObject(y(this,Pp),!1)[0])==null?void 0:Z.point;else{let Q=y(this,Je).interactionSystem.getThreeDIntersectsFromXY(K);te=(O=Q?.[0])==null?void 0:O.point,ve=y(this,Je).interactionSystem.getGroupContainerIntersectsFromXY(K)}if(te)return{coordinate:this.convert3DMapPositionToCoordinate(te),groupContainers:ve}},"projectScreenXYToCoordinate")),D(this,"projectCoordinateToScreenXY",l(L=>{let j=this.convertTo3DMapPosition(L[1],L[0],L[2]||0),q=new ft;return y(this,Vb).call(this,q,j),{x:q.x,y:q.y}},"projectCoordinateToScreenXY")),D(this,"convert3DMapPositionToCoordinate",l(L=>{var j,q,Z,O;let{lat:Y,lon:J}=qL((q=(j=y(this,tt).center)==null?void 0:j[1])!=null?q:0,(O=(Z=y(this,tt).center)==null?void 0:Z[0])!=null?O:0,L.x,L.y);return[J,Y,L.z]},"convert3DMapPositionToCoordinate")),D(this,"setBackgroundColor",l((L,j)=>{y(this,za).setBackgroundColor(L,j)},"setBackgroundColor")),D(this,"getMetresPerPixel",l(()=>{let L=this.container.clientWidth,j=this.container.clientHeight/2,q=this.projectScreenXYToCoordinate(0,j,!0),Z=this.projectScreenXYToCoordinate(L,j,!0);return q==null||Z==null?void 0:zL(q.coordinate,Z.coordinate)/L},"getMetresPerPixel")),D(this,"hideOutdoorLayersUnderPoint",l((L,j)=>{!this.map||j?.length===0||(y(this,Je).outdoorLayersSystem.hideLayersUnderPoint(L,j),this.render())},"hideOutdoorLayersUnderPoint")),D(this,"hideOutdoorLayersIntersectingPolygons",l((L,j,q)=>{y(this,Je).outdoorLayersSystem.hideLayersIntersectingPolygons(L,j,q),this.render()},"hideOutdoorLayersIntersectingPolygons")),ge(this,Yf,new H1),ge(this,Gb,new qi),ge(this,$b,l(L=>{var j;nt.error("Render failed: ",L,(j=L.stack)!=null?j:"No stack trace available"),this.publish("render-error",{error:L})},"#onRenderError")),D(this,"render",l(()=>{var L;if(((L=y(this,Je))==null?void 0:L.renderSystem)!=null)if(this.map&&(this.mode==="outdoors-interleaved"||this.mode==="outdoors-overlay"))this.map.triggerRepaint();else return y(this,Je).renderSystem.update().catch(y(this,$b))},"render")),D(this,"renderSync",l(()=>y(this,Je).renderSystem.update(!0).catch(y(this,$b)),"renderSync")),ge(this,zo,gw(()=>{this.publish("user-interaction-start",void 0)},0,!0)),ge(this,Uo,gw(()=>{this.publish("user-interaction-end",void 0),this.render()},0,!0)),D(this,"on",l((L,j)=>{super.on(L,j),["outdoor-view-loaded","outdoor-style-loaded"].includes(L)&&this.mode==="standalone"&&mr.env.NODE_ENV!=="test"&&(nt.warn('"'.concat(L,'" was subscribed to but outdoor view is disabled. The event has been triggered immediately. Enable outdoor view or remove the listener.')),this.publish(L))},"on")),D(this,"off",l((L,j)=>{super.off(L,j)},"off")),D(this,"getCursor",l(()=>y(this,Je).interactionSystem.getCursor(),"getCursor")),D(this,"destroy",l(()=>{var L;y(this,Je)&&(y(this,Je).cameraSystem.off("user-dolly-start",y(this,zo)),y(this,Je).cameraSystem.off("user-pan-start",y(this,zo)),y(this,Je).cameraSystem.off("user-rotate-start",y(this,zo)),y(this,Je).cameraSystem.off("user-zoom-start",y(this,zo)),y(this,Je).cameraSystem.off("user-tilt-start",y(this,zo)),y(this,Je).cameraSystem.off("user-pedestal-start",y(this,zo)),y(this,Je).cameraSystem.off("user-dolly-end",y(this,Uo)),y(this,Je).cameraSystem.off("user-pan-end",y(this,Uo)),y(this,Je).cameraSystem.off("user-rotate-end",y(this,Uo)),y(this,Je).cameraSystem.off("user-zoom-end",y(this,Uo)),y(this,Je).cameraSystem.off("user-tilt-end",y(this,Uo)),y(this,Je).cameraSystem.off("user-pedestal-end",y(this,Uo)),y(this,Je).renderSystem.off("measure-canvas",y(this,Av)),y(this,Je).meshOptimizationSystem.off("geometry-2d-added",this.render),y(this,Je).meshOptimizationSystem.off("model-loaded",this.render),this.remove("__scene"),y(this,ba).call(this),y(this,Zn).call(this),this.renderSync(),y(this,Je).renderSystem.destroy(),y(this,Je).cameraSystem.off("change",this.render),y(this,Je).pathSystem.off("animate:path",this.render),y(this,Je).cameraSystem.dispose(),y(this,Je).exporterSystem.destroy(),y(this,Je).outdoorLayersSystem.destroy(),y(this,Je).drawSystem.destroy(),window.removeEventListener("resize",y(this,zb),!1),y(this,Nb).removeEventListener("change",y(this,Bb)),y(this,Zf)&&y(this,Zf).disconnect(),this._subscribers={},y(this,za).destroy(),(L=y(this,jr))==null||L.traverse(j=>{Ra(j),"dispose"in j&&typeof j.dispose=="function"&&j.dispose()}),Ce(this,jr,void 0),y(this,Je).htmlControlsSystem.destroy(),y(this,Je).collisionSystem.destroy(),y(this,Je).interactionSystem.destroy(),y(this,Je).domMutationSystem.destroy(),y(this,Je).geometryInFocusSystem.destroy(),Ce(this,Je,void 0),y(this,xc)!=="outdoors-overlay"&&(this.map&&(this.map.transform.getElevation=void 0,this.map.remove()),this.container.contains(this.rendererDomElement)&&this.container.removeChild(this.rendererDomElement)),this.container.removeChild(y(this,sh)),this.container.removeChild(y(this,Yn)),Ce(this,za,void 0))},"destroy")),ge(this,Sv,new Ee),ge(this,Hb,new Ee),y(this,tt).useStandaloneCamera=(n=t.useStandaloneCamera)!=null?n:!1,y(this,tt).naturalBearing=(r=t.naturalBearing)!=null?r:0,this.convertTo3DMapPosition=this.convertTo3DMapPosition.bind(this),!e.clientWidth||!e.clientHeight)throw new Error("[MappedinJS] Container width and height must be greater than 0");this.convertTo3DMapPosition=this.convertTo3DMapPosition.bind(this),(t.mode==="outdoors-interleaved"||t.mode==="outdoors-overlay")&&t.map&&(Ce(this,xc,t.mode),this.map=t.map),y(this,tt).entityScene.addEventListener("childadded",()=>{y(this,Zn).call(this),y(this,ba).call(this)}),y(this,tt).entityScene.addEventListener("childremoved",()=>{y(this,Zn).call(this),y(this,ba).call(this)}),y(this,tt).geometry3DMap.set(y(this,tt).entityScene.userData.entityId,y(this,tt).entityScene),t.center&&(y(this,tt).center=t.center?[...t.center]:[0,0]),this.options=t,this.container=e,St(this,sl,gse).call(this),St(this,sl,yse).call(this),y(this,Je).htmlControlsSystem=new HCe(this.container),y(this,xc)!=="outdoors-overlay"&&y(this,Je).htmlControlsSystem.addAttributionControl(this.options.attribution),window.MappedinDebug||(window.MappedinDebug={}),mr.env.NODE_ENV==="test"&&(window.MappedinDebug.mapViewCoreInstance=this),Ce(this,za,new JAe({antialias:typeof t.antialias=="boolean"?t.antialias:!0,alpha:!1,canvas:this.mode!=="standalone"?(a=t.gl)==null?void 0:a.canvas:void 0,onWebGLContextCreationError:t.onWebGLContextCreationError,onWebGLContextLost:t.onWebGLContextLost,onWebGLContextRestored:l(L=>{var j;(j=t.onWebGLContextRestored)==null||j.call(t,L),y(this,ba).call(this),y(this,Zn).call(this),this.render()},"onWebGLContextRestored"),onWebGLRendererError:t.onWebGLRendererError,backgroundColor:t.backgroundColor||"#ffffff",backgroundAlpha:(o=t.backgroundAlpha)!=null?o:1})),Ce(this,jr,new zP),y(this,xc)!=="standalone"&&y(this,jr).add(bee()),y(this,jr).add(y(this,tt).entityScene);let I=window.__THREE_DEVTOOLS__;mr.env.NODE_ENV==="dev"&&typeof I<"u"&&(I.dispatchEvent(new CustomEvent("observe",{detail:y(this,jr)})),I.dispatchEvent(new CustomEvent("observe",{detail:y(this,za)}))),Ce(this,kr,new Ao(S3e,this.aspect,50,1e5)),y(this,tt).cameraObject=y(this,kr),Ce(this,Ob,new BP),y(this,kr).renderOrder=999;let C=new vr;C.add(y(this,kr)),Ce(this,bv,new vr),y(this,bv).add(C),y(this,jr).add(y(this,bv)),y(this,kr).updateProjectionMatrix(),y(this,kr).updateMatrixWorld(!0),this.referenceMap={scale:1,latitude:0,longitude:0,getNorth:l(()=>0,"getNorth"),georeference:[{target:{x:0,y:0}},{target:{x:0,y:0}},{target:{x:0,y:0}},{target:{x:0,y:0}}]},this.rendererDomElement=y(this,za).domElement(),Ce(this,xv,new ft);let T=new Cd(1e6,1e6),k=new _l({color:0,visible:!1});Ce(this,Pp,new ln(T,k)),y(this,Pp).name="worldPlane",y(this,jr).add(y(this,Pp)),(s=t.gl)!=null&&s.canvas||e.appendChild(this.rendererDomElement),window.addEventListener("resize",y(this,zb),!1),y(this,Nb).addEventListener("change",y(this,Bb)),typeof ResizeObserver=="function"&&((u=mr.env)==null?void 0:u.NODE_ENV)!=="test"&&(Ce(this,Zf,new ResizeObserver(kA(L=>{y(this,wv).call(this,L[0].contentRect.width,L[0].contentRect.height)},50))),(h=y(this,Zf))==null||h.observe(e)),e.classList.add("mappedin-map"),this.rendererDomElement.style.width=(d=globalThis.MappedinDebug)!=null&&d.TEST_IOS?"1080px":"100%",this.rendererDomElement.style.height=(f=globalThis.MappedinDebug)!=null&&f.TEST_IOS?"1920px":"100%",mr.env.NODE_ENV==="test"&&this.rendererDomElement.setAttribute("data-testid","mappedin-canvas"),y(this,tt).canvasWidth=this.rendererDomElement.clientWidth,y(this,tt).canvasHeight=this.rendererDomElement.clientHeight,this.rendererDomElement.style.touchAction="manipulation";let F=this.canvasWidth,B=this.canvasHeight;y(this,Je).watermarkSystem=new BCe(y(this,kr),y(this,tt),t?.watermark),y(this,Je).watermarkSystem.on("texture-loaded",this.render),y(this,tt).shouldMeasureCanvas=!0,y(this,tt).pixelRatio=this.resolutionScale,y(this,jb).call(this,Math.floor(F*this.resolutionScale),Math.floor(B*this.resolutionScale));let N=new FN(16777215,.3*Math.PI);N.position.set(-150,-150,350),y(this,jr).add(N);let z=new Gce(16777215,.741*Math.PI);y(this,jr).add(z),y(this,Je).cameraSystem=new Toe(y(this,kr),y(this,jr),y(this,za).renderer,y(this,tt),{mode:this.mode,canvasHeight:B,canvasWidth:F}),y(this,Je).cameraSystem.on("user-dolly-start",y(this,zo)),y(this,Je).cameraSystem.on("user-pan-start",y(this,zo)),y(this,Je).cameraSystem.on("user-rotate-start",y(this,zo)),y(this,Je).cameraSystem.on("user-zoom-start",y(this,zo)),y(this,Je).cameraSystem.on("user-tilt-start",y(this,zo)),y(this,Je).cameraSystem.on("user-pedestal-start",y(this,zo)),y(this,Je).cameraSystem.on("user-dolly-end",y(this,Uo)),y(this,Je).cameraSystem.on("user-pan-end",y(this,Uo)),y(this,Je).cameraSystem.on("user-rotate-end",y(this,Uo)),y(this,Je).cameraSystem.on("user-zoom-end",y(this,Uo)),y(this,Je).cameraSystem.on("user-tilt-end",y(this,Uo)),y(this,Je).cameraSystem.on("user-pedestal-end",y(this,Uo)),y(this,Je).cameraSystem.on("change",()=>{this.publish("camera-change",this.camera),y(this,Je).geometryInFocusSystem&&(y(this,Je).geometryInFocusSystem.cameraDirty=!0),this.render()}),y(this,Je).pathSystem=new m3e(y(this,tt),this.convertTo3DMapPosition,this.getParentContainer,y(this,Je).cameraSystem.convertZoomLevelToAltitude),y(this,Je).pathSystem.on("animate:path",this.render),y(this,Je).panBoundsSystem=new UCe(y(this,tt),y(this,Je).cameraSystem),y(this,Je).panBoundsSystem.on("update",()=>{let{panBounds:L,fov:j,convertAltitudeToZoomLevel:q}=y(this,Je).cameraSystem;if(y(this,Je).panBoundsSystem.autoMinZoomLevel){if(L.radius<=0)return;let Z=Math.min(y(this,tt).canvasWidth/y(this,tt).canvasHeight,1),O=j*Math.PI/180*Z,Y=Math.tan(O/2),{radius:J,center:oe}=y(this,Je).cameraSystem.panBounds,$=J/Y,K=this.getThreeCamera().getWorldPosition(new Ee),te=oe.distanceTo(K),ve=Math.abs(K.z-oe.z),Q=$*ve/te,he=q(Q);_ee(he,this.camera.minZoomLevel)&&this.camera.setMinZoomLevel(he)}this.publish("pan-bounds-change",y(this,Je).cameraSystem.panBounds)}),this.camera=new ICe(this,y(this,Je),y(this,tt)),this.camera.setZoomLevel((m=t.zoomLevel)!=null?m:mse),this.camera.setBearing((v=t.bearing)!=null?v:fse),this.camera.setPitch((b=t.pitch)!=null?b:dse),this.camera.setMaxZoomLevel(A3e),this.camera.setMinZoomLevel(w3e),y(this,Je).domVisiblitySystem=new KMe(y(this,tt),y(this,sh)),y(this,Je).domMutationSystem=new SCe(y(this,tt),y(this,sh)),y(this,Je).domMutationSystem.on("dimensions-update",()=>{y(this,Je).collisionSystem.collidersDirty=!0,this.render()}),y(this,Je).domDrawSystem=new wCe(y(this,tt)),y(this,Je).collisionSystem=new tSe(y(this,zl),y(this,tt),((w=t.useCollisionWorker)!=null?w:!0)&&((A=t.useWorkers)!=null?A:!0)),y(this,Je).twoDDrawSystem=new iCe(y(this,tt),y(this,Vr),t.transformImageRequest),y(this,Je).twoDDrawSystem.on("img:loaded",this.render),y(this,Je).interactionSystem=new rSe(this.rendererDomElement,y(this,tt),y(this,kr),y(this,Pp),y(this,Je).cameraSystem.isUserInteracting),y(this,Je).interactionSystem.on("doubletap-with-onefinger",L=>{var j;this.camera.animateTo({center:(j=this.projectScreenXYToCoordinate(L.clientX,L.clientY))==null?void 0:j.coordinate,zoomLevel:this.camera.zoomLevel+1,duration:MR,easing:"ease-out"})}),y(this,Je).interactionSystem.on("singletap-with-twofinger",()=>{this.camera.animateTo({zoomLevel:this.camera.zoomLevel-1,duration:MR,easing:"ease-out"})}),y(this,Je).interactionSystem.on("hover",this.render),y(this,Je).interactionSystem.on("click",L=>{var j,q,Z,O,Y,J,oe,$,K,te,ve,Q;if(((j=L.entity2D)==null?void 0:j.id)==="watermark"&&typeof y(this,Je).watermarkSystem.options.onClick=="function"&&y(this,Je).watermarkSystem.options.interactive){y(this,Je).watermarkSystem.options.onClick();return}let he=L.entity3D?[(q=L.entity3D)==null?void 0:q.id]:[];(Y=(O=(Z=L.entity3D)==null?void 0:Z.parentObject3D)==null?void 0:O.userData)!=null&&Y.entityId&&he.push(($=(oe=(J=L.entity3D)==null?void 0:J.parentObject3D)==null?void 0:oe.userData)==null?void 0:$.entityId),this.publish("click",{coordinate:this.convert3DMapPositionToCoordinate(L.position),geometry:he,paths:((K=L.entity3D)==null?void 0:K.components[0])instanceof Ab?[L.entity3D.id]:[],markers:((te=L.entity2D)==null?void 0:te.components[0])instanceof Xv?[L.entity2D.id]:[],models:((ve=L.entity3D)==null?void 0:ve.components[0])instanceof bb?[L.entity3D.id]:[],labels:((Q=L.entity2D)==null?void 0:Q.components[0])instanceof Km?[L.entity2D.id]:[],containers:Array.isArray(L.groupContainers)?L.groupContainers.map(se=>se.userData.entityId):[],pointerEvent:L.pointerEvent})}),y(this,Je).interactionSystem.on("hover",L=>{var j,q,Z,O,Y,J;L.position&&((j=L.entity2D)==null?void 0:j.id)!=="watermark"&&this.publish("hover",{coordinate:this.convert3DMapPositionToCoordinate(L.position),geometry:L.entity3D?[(q=L.entity3D)==null?void 0:q.id]:[],paths:((Z=L.entity3D)==null?void 0:Z.components[0])instanceof Ab?[L.entity3D.id]:[],markers:((O=L.entity2D)==null?void 0:O.components[0])instanceof Xv?[L.entity2D.id]:[],models:((Y=L.entity3D)==null?void 0:Y.components[0])instanceof bb?[L.entity3D.id]:[],labels:((J=L.entity2D)==null?void 0:J.components[0])instanceof Km?[L.entity2D.id]:[],containers:Array.isArray(L.groupContainers)?L.groupContainers.map(oe=>oe.userData.entityId):[]})}),y(this,Je).geometryInFocusSystem=new s3e(y(this,tt),y(this,kr)),y(this,Je).geometryInFocusSystem.on("geometry-in-focus",L=>{this.publish("geometry-in-focus",L)}),y(this,Je).twoDVisiblitySystem=new aCe(y(this,tt)),y(this,Je).drawSystem=new rCe(y(this,tt),this.convertTo3DMapPosition),y(this,Je).drawSystem.on("texture-loaded",this.render),y(this,Je).stackSystem=new uCe(y(this,tt)),y(this,Je).twoDProjectionSystem=new QMe(y(this,tt),y(this,Vb)),y(this,Je).exporterSystem=new BMe(y(this,tt)),y(this,Je).meshOptimizationSystem=new JMe(y(this,tt),this.convertTo3DMapPosition),y(this,Je).meshOptimizationSystem.on("model-loaded",this.render),y(this,Je).meshOptimizationSystem.on("geometry-2d-added",this.render),y(this,Je).meshOptimizationSystem.on("geometry-group-added",y(this,gT)),y(this,Je).meshDetachmentSystem=new g3e(y(this,tt)),y(this,Je).meshModificationSystem=new y3e(y(this,tt)),y(this,Je).geometryDisposalSystem=new b3e(y(this,tt)),y(this,Je).customGeometrySystem=new WCe(y(this,tt),this.convertTo3DMapPosition),y(this,Je).outlineInterpolationSystem=new XCe(y(this,tt)),y(this,Je).renderSystem=new oCe(y(this,za),y(this,tt),this.mode,y(this,jr),y(this,kr),this.viewCamera,y(this,Je)),y(this,Je).imageSystem=new a3e(y(this,tt),this.convertTo3DMapPosition,t.bearing,t.naturalBearing,t.imagePlacementOptions),y(this,Je).text3DSystem=new CMe(y(this,tt),this.convertTo3DMapPosition,(E=t.useWorkers)!=null?E:!0),y(this,Je).text3DSystem.on("render",this.render),y(this,Je).imageSystem.on("image-loaded",this.render),y(this,Je).renderSystem.on("pre-render",()=>this.publish("pre-render")),y(this,Je).renderSystem.on("post-render",()=>this.publish("post-render")),y(this,Je).renderSystem.on("measure-canvas",y(this,Av)),y(this,Je).outdoorLayersSystem=new u3e(this.map),y(this,Je).occlusion2DSystem=new x3e(y(this,tt),this.convertTo3DMapPosition,y(this,za)),t.occlusionEnabled&&y(this,Je).occlusion2DSystem.enable(),this.Debug=new _3e(this),t.environment!==!1&&Ce(this,Xf,St(this,sl,_T).call(this)),y(this,yT).call(this)}get viewCamera(){return y(this,Ob)}get canvasWidth(){return y(this,tt).canvasWidth}get canvasHeight(){return y(this,tt).canvasHeight}get resolutionScale(){var e,t;return(t=(e=this.map)==null?void 0:e._getClampedPixelRatio(this.canvasWidth,this.canvasHeight))!=null?t:$v()}get aspect(){return this.canvasWidth/this.canvasHeight}get mode(){return y(this,xc)}addGroupContainer(e,t,n){if(!y(this,tt).geometry3DMap.has(e)&&!y(this,tt).geometry2DMap.has(e)){let r=new Kn(e);r.addEventListener("childadded",()=>{y(this,Zn).call(this),y(this,ba).call(this)}),r.addEventListener("childremoved",()=>{y(this,Zn).call(this),y(this,ba).call(this)}),t?.visible!==void 0&&(r.visible=t.visible),t?.altitude!==void 0&&r.setAltitude(t.altitude),t?.interactive!==void 0&&Va(r,t.interactive,y(this,tt)),t?.focusable!==void 0&&mb(r,t.focusable),t?.preloadGeometry!==void 0&&(r.userData.preloadGeometry=t.preloadGeometry),y(this,tt).geometry3DMap.set(e,r);let a=this.getParentContainer(n);a instanceof Kn&&a.addEntity(r),y(this,Zn).call(this),this.render()}else nt.error("Group container with ID '".concat(e,"' already exists. The group container cannot be added."));return{id:e,type:"group-container"}}addStackContainer(e,t,n){if(y(this,tt).geometry3DMap.has(e))nt.error("Stack container with ID '".concat(e,"' already exists. The stack container cannot be added."));else{let r=new Kn(e);r.addEventListener("childadded",()=>{y(this,Zn).call(this),y(this,ba).call(this)}),r.addEventListener("childremoved",()=>{y(this,Zn).call(this),y(this,ba).call(this)}),r.components[0]=new ACe,t?.visible!==void 0&&(r.visible=t.visible),y(this,tt).geometry3DMap.set(e,r);let a=this.getParentContainer(n);a instanceof Kn&&a.addEntity(r)}return{id:e,type:"stack-container"}}addCustomGeometry(e,t,n,r,a){if(y(this,tt).geometry3DMap.has(e))nt.error("Custom geometry with ID '".concat(e,"' already exists. The custom geometry cannot be added."));else{let o=new wM(t,n),s=new lr(o,new Ym(r));r?.interactive!==void 0&&Va(s,r.interactive,y(this,tt)),s.id=e,o.mesh.userData={entityId:e,type:"custom-geometry"},y(this,tt).geometry3DMap.set(s.id,s);let u=this.getParentContainer(a);u instanceof Kn&&u.addEntity(s),y(this,Zn).call(this),this.render()}return{id:e,type:"custom-geometry"}}addGeometryGroup(e,t,n,r){var a,o;if(!y(this,tt).geometry3DMap.has(e)&&!y(this,tt).geometry2DMap.has(e)){let s=new Io(e,new AE(n));s.addEventListener("childadded",()=>{y(this,Zn).call(this),y(this,ba).call(this)}),s.addEventListener("childremoved",()=>{y(this,Zn).call(this),y(this,ba).call(this)}),s.userData.dirty=!0,y(this,tt).geometry3DMap.set(e,s);for(let h of t.features){if(h.geometry==null||!["Polygon","MultiPolygon","LineString","MultiLineString"].includes(h.geometry.type))continue;let d=h?.id||((a=h?.properties)==null?void 0:a.id)||Hn(),f=n||{color:bE},{visible:m,altitude:v}=f,b=Sc(f,["visible","altitude"]),w=y(this,Je).meshOptimizationSystem.createEntityFromFeature(d,h,lt(Me({},b),{outline:!0}));y(this,tt).geometry3DMap.set(d,w),s.userData.entities3D.add(d)}s.setVisible((o=n?.visible)!=null?o:!0),n?.altitude!=null&&s.setAltitude(n.altitude);let u=this.getParentContainer(r);u instanceof Kn&&u.addEntity(s),y(this,Zn).call(this),this.render()}else nt.error("Geometry group with ID '".concat(e,"' already exists. The geometry group cannot be added."));return y(this,Je).outlineInterpolationSystem.geometries3DDirty=!0,{id:e,type:"geometry-group"}}addOccluder(e,t){let n=this.getParentContainer(t),r=y(this,Je).occlusion2DSystem.reserveOccluderId();return n?.addOccluderFeature(e,r),r}addImage(e,t,n,r){try{$oe(e,t,n)}catch(a){nt.error(a);return}if(!y(this,tt).geometry3DMap.has(e)&&!y(this,tt).geometry2DMap.has(e)){let a=new KCe(t),o=new lr(a,new Ym(n));o.id=e||Hn(),a.mesh.userData={entityId:o.id,type:"path"},y(this,tt).geometry3DMap.set(o.id,o);let s=this.getParentContainer(r);s instanceof Kn&&s.addEntity(o),y(this,Zn).call(this),this.render()}else nt.error("Image with ID '".concat(e,"' already exists. The image cannot be added."));return{id:e,type:"image"}}addModelGroup(e,t,n,{parent:r,onComplete:a}={}){var o,s;try{noe(e,t,n)}catch(u){nt.error(u);return}if(!y(this,tt).geometry3DMap.has(e)&&!y(this,tt).geometry2DMap.has(e)){let u=new Io(e,new AE(lt(Me({},n),{outline:!1})));u.addEventListener("childadded",()=>{y(this,Zn).call(this),y(this,ba).call(this)}),u.addEventListener("childremoved",()=>{y(this,Zn).call(this),y(this,ba).call(this)}),y(this,tt).geometry3DMap.set(e,u),u.userData.dirty=!0,u.userData.modelURL=n.url;for(let d of t.features){let f=d.id||d.properties.id||Hn(),m=y(this,Je).meshOptimizationSystem.createModelFromFeature(f,d,n);(d.properties.interactive!==void 0||n.interactive!=null)&&Va(m,(o=d.properties.interactive)!=null?o:n.interactive,y(this,tt)),y(this,tt).geometry3DMap.set(f,m),u.userData.entities3D.add(f)}let h=this.getParentContainer(r);h instanceof Kn&&h.addEntity(u),y(this,Zn).call(this),(s=this.render())==null||s.then(a)}else nt.error("Model group with ID '".concat(e,"' already exists. The model group cannot be added."));return{id:e,type:"geometry-group"}}addMarker2D(e,t,n,r){var a;let o=n?.id;try{Yre(e,t,n||{})}catch(s){nt.error(s);return}if(o===void 0||!y(this,tt).geometry2DMap.has(o)&&!y(this,tt).geometry3DMap.has(o)){let s=St(this,sl,vT).call(this,e,new Xv(t,n),n?.occluderId,n?.verticalOffset);s.id=o||String(s.id),o=s.id,n?.interactive!=null&&n.interactive!=="pointer-events-auto"&&Va(s,n?.interactive,y(this,tt));let u=typeof n?.attachTo=="string"||typeof n?.attachTo=="number"?y(this,tt).geometry3DMap.get(n.attachTo):void 0;u instanceof lr&&u.attach(s),(a=this.getParentContainer(r))==null||a.addEntity(s),this.render()}else nt.error("Marker2D with ID '".concat(o,"' already exists. The marker cannot be added."));return{id:o,type:"marker"}}addText3D(e,t,n,r){if(!y(this,tt).geometry3DMap.has(e)&&!y(this,tt).geometry2DMap.has(e)){let a=new fb(lt(Me({},t),{properties:lt(Me({},t.properties),{id:e,content:t.properties.text})})),o=new lr(a,new EE(n?.appearance));o.id=e,a.mesh.userData.entityId=e.toString(),a.mesh.userData.type="text3d",y(this,tt).geometry3DMap.set(e,o);let s=this.getParentContainer(r);s instanceof Kn&&s.addEntity(o),y(this,Zn).call(this),this.render()}else nt.error("Text3D with ID '".concat(e,"' already exists. The text3d cannot be added."));return{id:e,type:"text3d"}}labelText3D(e,t,n={}){var r,a;try{if(!t||!e)throw new Error("content and meshGeometryId are required");PMe.parse(n)}catch(d){nt.error(d);return}let o=y(this,tt).geometry3DMap.get(e);if(o?.type!=="geometry"){nt.error(".labelText3D failed: target incorrect");return}let s=o?.components[0];if(!s.feature.properties.textArea)return;if(s.textEntityId){let d=y(this,tt).geometry3DMap.get(s.textEntityId);if(d?.type!=="text3d"){nt.error(".labelText3D failed: existing text3d not found");return}return{id:d.id,type:d.type}}let u=new fb({type:"Feature",geometry:{coordinates:(r=s.feature.properties.textArea)==null?void 0:r.position,type:"Point"},properties:{textArea:s.feature.properties.textArea,content:t,id:Hn()}});u.polygonEntityId=e;let h=new lr(u,new EE(n?.appearance));return s.textEntityId=h.id.toString(),u.mesh.userData.entityId=h.id.toString(),u.mesh.userData.type="text3d",y(this,tt).geometry3DMap.set(h.id.toString(),h),n.parentId&&((a=this.getParentContainer(n.parentId))==null||a.addEntity(h)),this.render(),{id:h.id,type:"text3d"}}addLabel2D(e,t,n,r){var a;let o=n?.id;try{xae(e,t,n||{})}catch(s){nt.error(s);return}if(o===void 0||!y(this,tt).geometry2DMap.has(o)&&!y(this,tt).geometry3DMap.has(o)){let s=St(this,sl,vT).call(this,e,new Km(t,n||{},y(this,tt)),n?.occluderId,n?.verticalOffset);s.id=o||String(s.id),o=s.id,n?.interactive!=null&&Va(s,n?.interactive,y(this,tt));let u=typeof n?.attachTo=="string"||typeof n?.attachTo=="number"?y(this,tt).geometry3DMap.get(n.attachTo):void 0;u instanceof lr&&u.attach(s),(a=this.getParentContainer(r))==null||a.addEntity(s),y(this,ba).call(this),this.render()}else nt.error("Label2D with ID '".concat(o,"' already exists. The label cannot be added."));return{id:o,type:"label"}}addPath(e,t={},n){var r;try{yoe(e,t||{})}catch(u){nt.error(u);return}let a=new Ab(e,$D(t)),o=new lr(a,new Ym({color:(r=t?.color)!=null?r:"#ff834c"}));o.id=t?.id||Hn(),a.mesh.userData={entityId:o.id,type:"path"},y(this,tt).geometry3DMap.set(o.id,o),t?.interactive!=null&&Va(o,t?.interactive,y(this,tt));let s=this.getParentContainer(n);return s instanceof Kn&&s.addEntity(o),y(this,Zn).call(this),this.render(),{id:o.id,type:"path"}}updateWatermark(e){y(this,Je).watermarkSystem.options=e,y(this,Je).watermarkSystem.dirty=!0,y(this,Je).collisionSystem.collidersDirty=!0,this.render()}remove(e){var t;let n;if(typeof e=="string"||typeof e=="number"?(n=y(this,tt).geometry2DMap.get(e),n==null&&(n=y(this,tt).geometry3DMap.get(e))):typeof e.id=="string"||typeof e.id=="number"?(n=y(this,tt).geometry2DMap.get(e.id),n==null&&(n=y(this,tt).geometry3DMap.get(e.id))):n=e,n!=null){if(n.type==="custom-geometry")y(this,tt).geometry3DMap.delete(n.id),n.object3d&&Ra(n.object3d);else if(n.type==="group-container"){y(this,tt).geometry3DMap.delete(n.userData.entityId);for(let a of n.childrenIds.values())this.remove(a),n.userData.entities2D.delete(a);let r=n.components[2];r&&r.focusMesh&&Ra(r.focusMesh),Ra(n)}else if(n.type==="geometry-group"){y(this,tt).geometry3DMap.delete(n.userData.entityId);for(let r of n.userData.entities3D.values())this.remove(r),n.userData.entities3D.delete(r);Ra(n)}else if(n.type==="geometry"||n.type==="model"||n.type==="path"){let r=n.components[0],a=n.components[4];if(n.entities2D.size>0){for(let o of n.entities2D.values())this.remove(o);n.removeAllEntities()}if(n.object3d&&(((t=n.parentObject3D)==null?void 0:t.type)==="geometry-group"&&n.parentObject3D.userData.entities3D.delete(n.id),Ra(n.object3d)),n.type==="geometry"){let o=n.components[3];o&&(o.visible=!1,o.dirty=!0)}a&&"focusMesh"in a&&a.focusMesh!=null&&Ra(a.focusMesh),"textMesh"in r&&r.textMesh!=null&&this.remove(r.textMesh.userData.entityId),y(this,tt).geometry3DMap.delete(n.id)}else if(n.type==="marker"||n.type==="label"){let r=n.attachedTo;if(r){let a=y(this,tt).geometry3DMap.get(r);a instanceof lr&&a.detach(n)}n.object3d&&Ra(n.object3d),n.type==="label"&&delete y(this,Je).twoDDrawSystem.textCache[n.id],y(this,tt).geometry2DMap.delete(n.id)}else if(n.type==="image")n.object3d&&Ra(n.object3d),y(this,tt).geometry3DMap.delete(n.id);else if(n.type==="text3d"){Ra(n.object3d);let{batchedText:r,textMesh:a,polygonEntityId:o}=n.components[0];if(a&&(r&&r.removeText(a),Ra(a)),o){y(this,Je).text3DSystem.remove(o);let s=y(this,tt).geometry3DMap.get(o);s?.type==="geometry"&&(s.components[0].textMesh=void 0,s.components[0].textEntityId=void 0)}y(this,tt).geometry3DMap.delete(n.id)}y(this,Zn).call(this),y(this,ba).call(this),this.render()}}getScene(){return this.getState("__scene")}getThreeScene(){return y(this,jr)}getThreeCamera(){return y(this,kr)}async setEnvironment(e){if(y(this,jr))if(e==="basic"){y(this,Xf)||Ce(this,Xf,St(this,sl,_T).call(this));let t=await y(this,Xf);y(this,jr).environment=t}else y(this,jr).environment=null}getEnvironment(){var e;return(e=y(this,jr))!=null&&e.environment?"basic":!1}getCurrentSceneGLTF(e){return y(this,Je).exporterSystem.getCurrentSceneGLTF(e)}getBoundingArea(e){(y(this,Je).renderSystem.threeDdirty||y(this,Je).renderSystem.twoDdirty)&&this.renderSync();let t=new ur;if(e==null)t.setFromObject(y(this,tt).entityScene);else{let n=jp(y(this,tt),e);if(n?.type==="geometry"&&n?.object3d!=null){let r=n.components[0],a=r instanceof vs?r.geometry:void 0;r.mesh instanceof UP&&a?(a.computeBoundingBox(),a.boundingBox&&t.union(a.boundingBox)):t.setFromObject(n.object3d)}else(n?.type==="geometry-group"||n?.type==="group-container")&&n?.userData.entityId!=null&&t.setFromObject(n)}if(kc(t))return uee(t).map(this.convert3DMapPositionToCoordinate)}hasState(e){return jp(y(this,tt),e)!=null}getState(e){var t,n,r,a,o,s,u,h,d,f;if(e==null)return{type:"map-view",hoverColor:y(this,tt).hoverColor,text3dHoverColor:y(this,tt).text3dHoverColor};let m=jp(y(this,tt),e);if(m?.type==="custom-geometry"){let v=m.components[0],b=m.components[1];return{id:m.id,type:"custom-geometry",visible:b.visible,altitude:b.altitude,parent:(t=m.parentObject3D)==null?void 0:t.userData.entityId,position:this.convert3DMapPositionToCoordinate(v.position)}}else if(m?.type==="geometry-group"){let v=[];for(let w of m.userData.entities3D.values()){let A=this.getState(w);(A?.type==="geometry"||A?.type==="model")&&v.push(A)}let b=m.components[0];return{id:m.userData.entityId,type:"geometry-group",visible:m.visible,opacity:b.opacity,color:b.color,initialColor:b.initialColor,height:b.height,altitude:m.altitude,topColor:b.topColor,outline:b.outline,shading:b.shading,texture:b.texture,topTexture:b.topTexture,interactive:Array.from(m.userData.entities3D.values()).map(w=>y(this,tt).geometry3DMap.get(w)).every(w=>w&&w.components[2]!=null),children:Array.from(m.userData.entities3D.values()).map(w=>this.getState(w)).filter(Boolean)}}else{if(m?.type==="group-container")return{id:m.userData.entityId,type:"group-container",visible:m.visible,altitude:m.altitude,opacity:m.opacity,interactive:!!m.components[1],children:Array.from(m.childrenIds.values()).map(v=>this.getState(v)).filter(Boolean)};if(m?.type==="label"){let v=m.components[0],b=m.object3d.parent,w=b?.userData.entityId;return{id:m.id,type:"label",text:v.text||"",parent:{id:w,type:b?.type},position:this.convert3DMapPositionToCoordinate(m.position),enabled:v.enabled,visible:v.visible,initialRank:uv(v.initialRank),options:{rank:uv(v.rank),appearance:v.appearance,interactive:m.components[1]!=null,verticalOffset:m.verticalOffset,attachTo:m.attachedTo}}}else if(m?.type==="marker"){let v=m.components[0],b=m.object3d.parent,w=b?.userData.entityId;return{id:m.id,type:"marker",enabled:v.enabled,visible:v.visible,anchor:v.options.anchor,dynamicResize:v.options.dynamicResize,parent:{id:w,type:b?.type},position:this.convert3DMapPositionToCoordinate(m.position),element:v.containerEl,initialRank:uv(v.initialRank),contentHTML:v.contentHtml,options:{rank:uv(v.rank),interactive:m.components[1]!=null||!1,verticalOffset:m.verticalOffset,attachTo:m.attachedTo,lowPriorityPin:v.options.lowPriorityPin}}}else if(m?.type==="geometry"){let{color:v,hoverColor:b,initialColor:w,initialTopColor:A,topColor:E,altitude:I}=m.components[1],C=m.components[0],T=m.components[2],k=m.components[1],F=m.components[2],B=m.components[3],N=m.parentObject3D;return{id:m.id,type:"geometry",opacity:k.opacity,initialColor:w,color:v,focusable:T!=null&&T.focusMesh!=null,initialTopColor:A,topColor:E,hoverColor:b,hovered:!!(F!=null&&F.hover),height:k.height,visible:k.visible,outline:B?.visible,showImage:k.showImage,texture:k.texture,topTexture:k.topTexture,flipImageToFaceCamera:k.flipImageToFaceCamera,parent:{id:N?.userData.entityId,type:N?.type},altitude:I,position:this.convert3DMapPositionToCoordinate(C.position),interactive:m.components[2]!=null}}else if(m?.type==="model"){let v=m.components[0],b=m.components[1],w=m.components[2];return{id:m.id,type:"model",position:v.mesh?this.convert3DMapPositionToCoordinate((n=v.mesh)==null?void 0:n.getWorldPosition(new Ee)):this.convert3DMapPositionToCoordinate(v.position),interactive:w!=null,material:b.material,parent:(r=m.parentObject3D)!=null&&r.parent?{id:m.parentObject3D.parent.userData.entityId,type:m.parentObject3D.parent.type}:void 0,visible:b.visible,verticalOffset:b.verticalOffset,color:b.color,opacity:b.opacity,rotation:(a=b.rotation)!=null?a:Ix,scale:(o=b.scale)!=null?o:Ex}}else if(m?.type==="path"){let v=m.components[0],b=m.components[2],w=m.components[1];return{id:m.id,type:"path",position:this.convert3DMapPositionToCoordinate(v.position),visible:w.visible,interactive:b!=null,completeFraction:v.completeFraction,color:w.color,accentColor:v.accentColor,nearRadius:v.nearRadius,farRadius:v.farRadius,animateArrowsOnPath:v.animateArrowsOnPath,displayArrowsOnPath:v.displayArrowsOnPath,nearZoomLevel:v.nearZoomLevel,farZoomLevel:v.farZoomLevel,altitude:w.altitude}}else if(m?.type==="image"){let v=m.components[0];return{id:m.id,type:"image",position:this.convert3DMapPositionToCoordinate(v.position),visible:m.components[1].visible,verticalOffset:(s=v.feature.properties.verticalOffset)!=null?s:0,flipImageToFaceCamera:m.components[1].flipImageToFaceCamera}}else if(m?.type==="text3d"&&m.components[0]instanceof fb&&"textArea"in m.components[0].feature.properties){Hae(m);let v=m.components[0],b=m.components[1],{textMesh:w}=v,A=(u=v.mesh)==null?void 0:u.parent;A instanceof Kn&&((h=A.children.find(I=>I.type==="batchedtext"))==null||h.getWorldPosition(y(this,Hb))),y(this,Sv).set(0,0,0);let E=w?w.getWorldPosition(y(this,Sv)):y(this,Sv);return Object.assign({},Hv,b.getState(),{id:m.id,type:"text3d",position:this.convert3DMapPositionToCoordinate(E.add(y(this,Hb))),visible:(d=v.visible)!=null?d:!1,content:(f=v.feature.properties.content)!=null?f:""})}else return}}setState(e,t){var n,r;if(typeof e=="object"&&t==null){"hoverColor"in e&&(Xm(e.hoverColor)?y(this,tt).hoverColor=(n=e.hoverColor)!=null?n:y(this,tt).hoverColor:nt.warn('Failed to update global hover color. Invalid color "'.concat(e.hoverColor,'".'))),"text3dHoverColor"in e&&(y(this,tt).text3dHoverColor=(r=e.text3dHoverColor)!=null?r:y(this,tt).text3dHoverColor);return}let a=jp(y(this,tt),e);if(a!=null){if(a.type==="custom-geometry"){let o=y(this,tt).geometry3DMap.get(a.id);if(o instanceof lr&&o.components[0]instanceof wM){let s=t;Ul(a,y(this,tt),s.visible),jf(a,s.altitude),UI(a,s.position,this.convertTo3DMapPosition),VI(a,this.getParentContainer(s.parent,!1)),Va(a,s.interactive,y(this,tt))&&y(this,Zn).call(this)}}else if(a.type==="path"){let o=t;Va(a,o.interactive,y(this,tt))&&y(this,Zn).call(this),jf(a,o.altitude),$ae(a,y(this,tt),o)}else if(a.type==="model"){let o=t;Va(a,o.interactive,y(this,tt))&&y(this,Zn).call(this),Ul(a,y(this,tt),o.visible),Xae(a,o)}else if(a.type==="group-container"){let o=t;Ul(a,y(this,tt),o.visible)&&(y(this,Je).outlineInterpolationSystem.outlineOpacitiesDirty=!0,y(this,Je).pathSystem.altitudeDirty=!0,y(this,Je).geometryInFocusSystem.focusablesDirty=!0),jf(a,o.altitude)&&(y(this,Je).pathSystem.altitudeDirty=!0),Va(a,o.interactive,y(this,tt))&&y(this,Zn).call(this),GI(a,y(this,tt),o.opacity)&&(y(this,Je).outlineInterpolationSystem.outlineOpacitiesDirty=!0),o.preloadGeometry&&a.userData.preloadGeometry!==!0&&(a.userData.preloadGeometry=!0,y(this,Je).outlineInterpolationSystem.geometries3DDirty=!0),mb(a,o.focusable)&&(y(this,Je).geometryInFocusSystem.focusablesDirty=!0)}else if(a.type==="geometry-group"){let o=t;Ul(a,y(this,tt),o.visible)&&(y(this,Je).outlineInterpolationSystem.outlineOpacitiesDirty=!0),Dae(a,y(this,tt),o),Ow(a,y(this,tt),o.outline),o.height!=null&&zI(a,y(this,tt),o.height),jf(a,o.altitude),Uae(a,o),kae(a,o.shading),GI(a,y(this,tt),o.opacity)&&(y(this,Je).outlineInterpolationSystem.outlineOpacitiesDirty=!0),Va(a,o.interactive,y(this,tt))&&(y(this,Zn).call(this),y(this,ba).call(this))}else if(a.type==="geometry"){if(a.components[0]instanceof vs){let o=t;Ul(a,y(this,tt),o.visible)&&(y(this,Je).outlineInterpolationSystem.outlineOpacitiesDirty=!0),Ow(a,y(this,tt),o.outline),Rae(a,o),mb(a,o.focusable)&&(y(this,Je).geometryInFocusSystem.focusablesDirty=!0),Gae(a,o.renderOrder)&&(y(this,Je).meshDetachmentSystem.dirty=!0),jae(a,o.opacity)&&(y(this,Je).meshDetachmentSystem.dirty=!0,y(this,Je).interactionSystem.dirty3D=!0,y(this,Je).outlineInterpolationSystem.outlineOpacitiesDirty=!0),jI(a,o.flipImageToFaceCamera),jf(a,o.altitude),o.height!=null&&zI(a,y(this,tt),o.height),Vae(a,o)&&(y(this,Je).meshDetachmentSystem.dirty=!0),VD(a,o),Bae(a,o.hoverColor),Va(a,o.interactive,y(this,tt)),zae(a,o.hovered)}y(this,Zn).call(this)}else if(a.type==="label"||a.type==="marker"){let o=t;Fae(a,t,y(this,tt)),Nae(a,t,y(this,tt))&&(y(this,ba).call(this),y(this,Je).domMutationSystem.dirty=!0),UI(a,o.position,this.convertTo3DMapPosition),VI(a,this.getParentContainer(o.parent,!1))&&(y(this,ba).call(this),y(this,Je).panBoundsSystem.dirty=!0),Oae(a,o.enabled),Ul(a,y(this,tt),o.visible)}else if(a.type==="image"){let o=t;Ul(a,y(this,tt),o.visible),jI(a,o.flipImageToFaceCamera)}else if(a.type==="text3d"){let o=t;qae(a,y(this,tt),o)}this.render()}}convertTo3DMapPosition(e,t,n=0,r){var a,o,s,u,h;if(Array.isArray(e))return this.convertTo3DMapPosition(e[1],e[0],(a=e[2])!=null?a:n,typeof t=="function"?t:void 0);if(typeof t!="number")throw new Error("convertTo3DMapPosition failed: longitude must be a number");let{x:d,y:f}=XL((s=(o=y(this,tt).center)==null?void 0:o[1])!=null?s:0,(h=(u=y(this,tt).center)==null?void 0:u[0])!=null?h:0,e,t);return r?(r.set(d,f,n),r):new Ee(d,f,n)}get backgroundColor(){return typeof y(this,za).backgroundColor=="string"?y(this,za).backgroundColor:"#".concat(y(this,za).backgroundColor.getHexString())}get backgroundAlpha(){return y(this,za).backgroundAlpha}getThreeRenderer(){return y(this,za)}getCenter(e){let t=Array.isArray(e)?e:this.getBoundingArea(e);return t?vee(t):void 0}isInView(e){let t=jp(y(this,tt),e);if(y(this,Gb).identity().multiply(y(this,kr).projectionMatrix).multiply(y(this,kr).matrixWorldInverse),y(this,Yf).setFromProjectionMatrix(y(this,Gb)),t instanceof wg)return y(this,Yf).containsPoint(t.position);if(t instanceof lr){let n=t?.components[0];if(n instanceof wM||n instanceof bb)return y(this,Yf).containsPoint(this.convertTo3DMapPosition(n.feature.geometry.coordinates));if(n instanceof vs){let r=new ur(this.convertTo3DMapPosition(n.featureBbox[1],n.featureBbox[0],0),this.convertTo3DMapPosition(n.featureBbox[3],n.featureBbox[2],0));return y(this,Yf).intersectsBox(r)}}return!1}getSystems(){return y(this,Je)}getInternalState(){return y(this,tt)}getInternalTweenGroup(){return y(this,tt).internalTweenGroup}getExternalTweenGroup(){return y(this,tt).externalTweenGroup}computeMinZOffsetBetweenContainers(e,t,n){if(!e||!t)return-1;bd(e,"group-container"),bd(t,"group-container");let r=Cx(e,this.getThreeCamera()),a=t.clone(),o=Cx(a,this.getThreeCamera());if(!kc(r)||!kc(o))return-1;let s=0,u;n&&this.container.querySelectorAll(".debug-box").forEach(h=>h.remove());do{if(s>1e4)return-1;if(s+=20,a.position.z=s,a.updateMatrixWorld(),o.makeEmpty(),Cx(a,y(this,kr),o),u=r.intersectsBox(o),n){let h=CE(r,"blue",this.container),d=CE(o,u?"red":"green",this.container);h.classList.add("debug-box"),d.classList.add("debug-box")}}while(u);return s}};jr=new WeakMap,kr=new WeakMap,Xf=new WeakMap,Ob=new WeakMap,xv=new WeakMap,Pp=new WeakMap,Zf=new WeakMap,bv=new WeakMap,sl=new WeakSet,mT=l(function(i){var e;y(this,xc)!=="outdoors-overlay"&&((e=this.map)==null||e.setPixelRatio(i)),y(this,tt).pixelRatio=this.resolutionScale},"#setResolutionScale"),tt=new WeakMap,Yn=new WeakMap,zl=new WeakMap,Vr=new WeakMap,sh=new WeakMap,za=new WeakMap,Je=new WeakMap,Nb=new WeakMap,ba=new WeakMap,Zn=new WeakMap,gse=l(function(){Ce(this,Yn,document.createElement("div")),y(this,Yn).classList.add("mappedin__smart-collision-engine__container"),Ce(this,zl,document.createElement("canvas")),y(this,zl).classList.add("mappedin__smart-collision-engine-debug__container"),this.container.appendChild(y(this,Yn)),Ce(this,Vr,document.createElement("canvas")),y(this,Vr).classList.add("mappedin__smart-collision-engine__container"),y(this,Vr).width=y(this,Yn).clientWidth*this.resolutionScale,y(this,Vr).height=y(this,Yn).clientHeight*this.resolutionScale,y(this,Vr).style.width=y(this,Yn).clientWidth+"px",y(this,Vr).style.height=y(this,Yn).clientHeight+"px",y(this,Yn).appendChild(y(this,zl)),y(this,Yn).appendChild(y(this,Vr)),y(this,zl).width=y(this,Yn).clientWidth,y(this,zl).height=y(this,Yn).clientHeight,y(this,Vr).width=y(this,Yn).clientWidth*this.resolutionScale,y(this,Vr).height=y(this,Yn).clientHeight*this.resolutionScale,y(this,Vr).style.width=y(this,Yn).clientWidth+"px",y(this,Vr).style.height=y(this,Yn).clientHeight+"px"},"#renderEntity2DContainer"),yse=l(function(){Ce(this,sh,document.createElement("div")),y(this,sh).classList.add("mappedin-2d-entities"),Object.assign(y(this,sh).style,{position:"absolute",top:"0",left:"0",bottom:"0",right:"0",pointerEvents:"none","transform-style":"preserve-3d"}),this.container.appendChild(y(this,sh))},"#renderEntityDOMContainer"),vse=l(function(){y(this,Vr).width=y(this,Yn).clientWidth*this.resolutionScale,y(this,Vr).height=y(this,Yn).clientHeight*this.resolutionScale,y(this,Vr).style.width=y(this,Yn).clientWidth+"px",y(this,Vr).style.height=y(this,Yn).clientHeight+"px",y(this,zl).width=y(this,Yn).clientWidth,y(this,zl).height=y(this,Yn).clientHeight,y(this,Vr).width=y(this,Yn).clientWidth*this.resolutionScale,y(this,Vr).height=y(this,Yn).clientHeight*this.resolutionScale,y(this,Vr).style.width=y(this,Yn).clientWidth+"px",y(this,Vr).style.height=y(this,Yn).clientHeight+"px",y(this,Je).collisionSystem.collidersDirty=!0},"#resizeCollisionCanvas"),xc=new WeakMap,gT=new WeakMap,Fb=new WeakMap,Bb=new WeakMap,zb=new WeakMap,wv=new WeakMap,yT=new WeakMap,Ub=new WeakMap,Vb=new WeakMap,jb=new WeakMap,Av=new WeakMap,vT=l(function(i,e,t,n){let r=new wg(e,this.convertTo3DMapPosition(i[1],i[0],i[2]||0),n);return r.occluderId=t??y(this,Je).occlusion2DSystem.backgroundId,y(this,tt).geometry2DMap.set(r.id,r),r},"#createEntity2D"),Yf=new WeakMap,Gb=new WeakMap,$b=new WeakMap,zo=new WeakMap,Uo=new WeakMap,_T=l(async function(){return ZA.load(YAe).then(i=>{var e;return y(this,jr)&&((e=y(this,jr).environment)==null||e.dispose(),i.mapping=N2,y(this,jr).environment=i,this.render()),i})},"#loadEnvMap"),Sv=new WeakMap,Hb=new WeakMap,l(_se,"Core");var M3e=_se,xT=M3e;R();function C3e(i,e){xse(i,e)(i.getScene(),e),bse(i,e),e.addFolder("Export").add({export:l(async()=>{let r=await i.getCurrentSceneGLTF({binary:!0}),a=new Blob([r],{type:"application/octet-stream"});var o=document.createElement("a");document.body.appendChild(o),o.style.display="none";let s=window.URL.createObjectURL(a);o.href=s,o.download="scene.glb",o.click(),window.URL.revokeObjectURL(s)},"export")},"export");let t=e.addFolder("Camera"),n={get bearing(){return i.camera.bearing},set bearing(r){i.camera.setBearing(r)},get pitch(){return i.camera.pitch},set pitch(r){i.camera.setPitch(r)},get zoomLevel(){return i.camera.zoomLevel},set zoomLevel(r){i.camera.setZoomLevel(r)}};t.add(n,"bearing",-359,359,1),t.add(n,"pitch",i.camera.minPitch,i.camera.maxPitch,1),t.add(n,"zoomLevel",i.camera.minZoomLevel,i.camera.maxZoomLevel,.1)}l(C3e,"mountSceneGraphVisualizer");function xse(i,e){let t=e;return l(function n(r,a){let o=a.addFolder("".concat([r.type]," ").concat(r.id.slice(0,16)));if(a.close(),r.type==="geometry"||r.type==="model"||r.type==="path"||r.type==="image"){let s={get height(){let u=i.getState(r.id);return u?.type==="geometry"?u.height:0},set height(u){let h=i.getState(r.id);h?.type==="geometry"&&i.setState(r,{height:u})},set flipImageToFaceCamera(u){let h=i.getState(r.id);h?.type==="image"&&i.setState(r,{flipImageToFaceCamera:u})},get flipImageToFaceCamera(){let u=i.getState(r.id);return u?.type==="image"?u.flipImageToFaceCamera:!1},set visible(u){let h=i.getState(r.id);(h?.type==="geometry"||h?.type==="path"||h?.type==="image")&&i.setState(r,{visible:u})},get visible(){let u=i.getState(r.id);return u?.type==="geometry"||u?.type==="path"||u?.type==="image"?u.visible:!1},set outline(u){let h=i.getState(r.id);h?.type==="geometry"&&i.setState(r,{outline:u})},get outline(){let u=i.getState(r.id);return u?.type==="geometry"?u.outline:!1},get opacity(){let u=i.getState(r.id);return u?.type==="geometry"?u.opacity:1},set opacity(u){let h=i.getState(r.id);h?.type==="geometry"&&i.setState(h,{opacity:u})},get color(){let u=i.getState(r.id);return u?.type==="geometry"&&u.color?Ai(u.color).toHexString():"#ffffff"},set color(u){let h=i.getState(r.id);h?.type==="geometry"&&i.setState(h,{color:u})},set interactive(u){let h=i.getState(r.id);(h?.type==="geometry"||h?.type==="model"||h?.type==="path")&&(i.setState(r,{interactive:u}),t.controllersRecursive().forEach(d=>d.updateDisplay()))},get interactive(){let u=i.getState(r.id);return u?.type==="geometry"||u?.type==="model"||u?.type==="path"?u.interactive:!1},get completeFraction(){let u=i.getState(r.id);return u?.type==="path"?u.completeFraction:1},set completeFraction(u){let h=i.getState(r.id);h?.type==="path"&&i.setState(h,{completeFraction:u})},focus:l(()=>{},"focus")};o.add(s,"focus").onChange(()=>{let u=i.getState(r.id);u?.type==="model"||u?.type==="path"||u?.type==="image"?i.camera.focusOn([u.position]):u?.type==="geometry"&&i.camera.focusOn(i.getBoundingArea(u))}),o.add(s,"visible"),r.type==="image"?o.add(s,"flipImageToFaceCamera"):(o.add(s,"interactive"),r.type==="path"&&o.add(s,"completeFraction",0,1,.1),r.type!=="model"&&(o.addColor(s,"color"),o.add(s,"outline"))),r.type==="geometry"&&(o.add(s,"height"),o.add(s,"opacity",0,1,.1))}else if(r.type==="marker"){let s={get interactive(){var u;let h=i.getState(r.id);return h?.type==="marker"?(u=h.options)==null?void 0:u.interactive:!1},set interactive(u){let h=i.getState(r.id);h?.type==="marker"&&(i.setState(h,{options:{interactive:u}}),t.controllersRecursive().forEach(d=>d.updateDisplay()))},focus:l(()=>{},"focus")};o.add(s,"focus").onChange(()=>{let u=i.getState(r.id);u?.type==="marker"&&i.camera.focusOn([u.position])}),o.add(s,"interactive")}else if(r.type==="label"){let s={get interactive(){var u;let h=i.getState(r.id);return h?.type==="label"?(u=h.options)==null?void 0:u.interactive:!1},set interactive(u){let h=i.getState(r.id);h?.type==="label"&&(i.setState(h,{options:{interactive:u}}),t.controllersRecursive().forEach(d=>d.updateDisplay()))},get text(){let u=i.getState(r.id);return u?.type==="label"?u.text:""},set text(u){let h=i.getState(r.id);h?.type==="label"&&i.setState(h,{text:u})},get"Text Color"(){var u,h;let d=i.getState(r.id);return d?.type==="label"?(h=(u=d.options.appearance)==null?void 0:u.text)==null?void 0:h.foregroundColor:"#000000"},set"Text Color"(u){let h=i.getState(r.id);h?.type==="label"&&i.setState(r.id,{text:s.text,options:{appearance:{text:{foregroundColor:u}}}})},get"Text Size"(){var u,h;let d=i.getState(r.id);return d?.type==="label"?(h=(u=d.options.appearance)==null?void 0:u.text)==null?void 0:h.size:10},set"Text Size"(u){let h=i.getState(r.id);h?.type==="label"&&i.setState(h,{text:s.text,options:{appearance:{text:{size:u}}}})},get"Icon Size"(){var u,h;let d=i.getState(r.id);return d?.type==="label"?(h=(u=d.options.appearance)==null?void 0:u.marker)==null?void 0:h.iconSize:10},set"Icon Size"(u){let h=i.getState(r.id);h?.type==="label"&&i.setState(h,{text:s.text,options:{appearance:{marker:{iconSize:u}}}})},get"Active Foreground Color"(){var u,h,d;let f=i.getState(r.id);return f?.type==="label"?(d=(h=(u=f.options.appearance)==null?void 0:u.marker)==null?void 0:h.foregroundColor)==null?void 0:d.active:"#000000"},set"Active Foreground Color"(u){var h,d;let f=i.getState(r.id);f?.type==="label"&&i.setState(f,{text:s.text,options:{appearance:{marker:{foregroundColor:lt(Me({},(d=(h=f.options.appearance)==null?void 0:h.marker)==null?void 0:d.foregroundColor),{active:u})}}}})},get"Inactive Foreground Color"(){var u,h,d;let f=i.getState(r.id);return f?.type==="label"?(d=(h=(u=f.options.appearance)==null?void 0:u.marker)==null?void 0:h.foregroundColor)==null?void 0:d.inactive:"#000000"},set"Inactive Foreground Color"(u){var h,d;let f=i.getState(r.id);f?.type==="label"&&i.setState(f,{text:s.text,options:{appearance:{marker:{foregroundColor:lt(Me({},(d=(h=f.options.appearance)==null?void 0:h.marker)==null?void 0:d.foregroundColor),{inactive:u})}}}})},get"Active Background Color"(){var u,h,d;let f=i.getState(r.id);return f?.type==="label"?(d=(h=(u=f.options.appearance)==null?void 0:u.marker)==null?void 0:h.backgroundColor)==null?void 0:d.active:"#000000"},set"Active Background Color"(u){var h,d;let f=i.getState(r.id);f?.type==="label"&&i.setState(f,{text:s.text,options:{appearance:{marker:{backgroundColor:lt(Me({},(d=(h=f.options.appearance)==null?void 0:h.marker)==null?void 0:d.backgroundColor),{active:u})}}}})},get"Inactive Background Color"(){var u,h,d;let f=i.getState(r.id);return f?.type==="label"?(d=(h=(u=f.options.appearance)==null?void 0:u.marker)==null?void 0:h.backgroundColor)==null?void 0:d.inactive:"#000000"},set"Inactive Background Color"(u){var h,d;let f=i.getState(r.id);f?.type==="label"&&i.setState(f,{text:s.text,options:{appearance:{marker:{backgroundColor:lt(Me({},(d=(h=f.options.appearance)==null?void 0:h.marker)==null?void 0:d.backgroundColor),{inactive:u})}}}})},focus:l(()=>{},"focus")};o.add(s,"focus").onChange(()=>{let u=i.getState(r.id);u?.type==="label"&&i.camera.focusOn([u.position])}),o.add(s,"interactive"),o.add(s,"text"),o.add(s,"Text Size",10,50),o.add(s,"Icon Size",10,50),o.addColor(s,"Text Color"),o.addColor(s,"Active Background Color"),o.addColor(s,"Inactive Background Color"),o.addColor(s,"Active Foreground Color"),o.addColor(s,"Inactive Foreground Color")}else if(r.type==="geometry-group"){let s={get opacity(){let u=i.getState(r.id);return u?.type==="geometry-group"?u.opacity:1},set opacity(u){let h=i.getState(r.id);h?.type==="geometry-group"&&i.setState(r,{opacity:u})},set visible(u){let h=i.getState(r.id);h?.type==="geometry-group"&&i.setState(r,{visible:u})},get visible(){let u=i.getState(r.id);return u?.type==="geometry-group"?u.visible:!1},set outline(u){let h=i.getState(r.id);h?.type==="geometry-group"&&i.setState(r,{outline:u})},get outline(){let u=i.getState(r.id);return u?.type==="geometry-group"?u.outline:!1},set altitude(u){let h=i.getState(r.id);h?.type==="geometry-group"&&i.setState(r,{altitude:u})},get altitude(){let u=i.getState(r.id);return u?.type==="geometry-group"?u.altitude:0},set interactive(u){let h=i.getState(r.id);h?.type==="geometry-group"&&(i.setState(r,{interactive:u}),t.controllersRecursive().forEach(d=>d.updateDisplay()))},get interactive(){let u=i.getState(r.id);return u?.type==="geometry-group"?u.interactive:!1},get shadingStart(){var u,h;let d=i.getState(r.id);return d?.type==="geometry-group"&&(h=(u=d.shading)==null?void 0:u.start)!=null?h:0},set shadingStart(u){let h=i.getState(r.id);h?.type==="geometry-group"&&i.setState(h,{shading:{start:u}})},get shadingEnd(){var u,h;let d=i.getState(r.id);return d?.type==="geometry-group"&&(h=(u=d.shading)==null?void 0:u.end)!=null?h:0},set shadingEnd(u){let h=i.getState(r.id);h?.type==="geometry-group"&&i.setState(h,{shading:{end:u}})},get shadingIntensity(){var u,h;let d=i.getState(r.id);return d?.type==="geometry-group"&&(h=(u=d.shading)==null?void 0:u.intensity)!=null?h:0},set shadingIntensity(u){let h=i.getState(r.id);h?.type==="geometry-group"&&i.setState(h,{shading:{intensity:u}})}};o.add(s,"visible"),o.add(s,"opacity",0,1,.1),o.add(s,"interactive"),o.add(s,"outline"),o.add(s,"altitude",0,100,1),o.add(s,"shadingStart",0,1,.1),o.add(s,"shadingEnd",0,1,.1),o.add(s,"shadingIntensity",0,1,.1)}else if(r.type==="group-container"){let s={set visible(u){let h=i.getState(r.id);h?.type==="group-container"&&i.setState(r,{visible:u})},get visible(){let u=i.getState(r.id);return u?.type==="group-container"?u.visible:!1},set interactive(u){let h=i.getState(r.id);h?.type==="group-container"&&(i.setState(h,{interactive:u}),t.controllersRecursive().forEach(d=>d.updateDisplay()))},get interactive(){let u=i.getState(r.id);return u?.type==="group-container"?u.interactive:!1}};o.add(s,"visible"),o.add(s,"interactive")}if(o.close(),r.children)for(let s of r.children.values())n(s,o)},"parseChild")}l(xse,"createParseChild");function bse(i,e){let t=e.addFolder("Watermark"),n={padding:16,iconOnly:!1,position:"bottom-left",color:"dark",scale:1};t.add(n,"padding",0,100,1),t.add(n,"scale",.5,1.5,.1),t.add(n,"color",["dark","light"]),t.add(n,"position",["top-left","top-right","bottom-left","bottom-right","center","top","bottom","left","right"]),t.add(n,"iconOnly"),t.onChange(()=>{i.updateWatermark(n)})}l(bse,"createWatermarkChild");R();R();R();R();R();R();var wse=class{constructor({origin:e,destination:t,distance:n=0,angle:r=0,pathWeight:a=0,multiplicativeDistanceWeightScaling:o=!0}){if(D(this,"origin"),D(this,"destination"),D(this,"distance"),D(this,"angle"),D(this,"weight"),this.origin=e,this.destination=t,this.distance=n,this.angle=r,this.weight=a||0,o?e.properties.floor===t.properties.floor&&(this.weight=(this.weight>=0?this.distance*this.weight:0)+this.distance):e.properties.map===t.properties.map&&(this.weight=this.weight>=0?this.distance+this.weight:0),isNaN(this.angle))throw new Error("Invalid angle: Expected a numeric value, but received NaN.")}};l(wse,"Edge");var bT=wse;R();R();R();R();function cd([i,e],[t,n]){let r=e-n,a=i-t;return(Math.atan2(a,r)+Math.PI*3)%(Math.PI*2)}l(cd,"getAngle");R();var E3e=63710088e-1;function ou(i,e){let[t,n]=i.map(d=>d*Math.PI/180),[r,a]=e.map(d=>d*Math.PI/180),o=a-n,s=r-t,u=Math.sin(o/2)*Math.sin(o/2)+Math.cos(n)*Math.cos(a)*Math.sin(s/2)*Math.sin(s/2),h=2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u));return E3e*h}l(ou,"getDistance");R();R();function Wb(i,e,t,n){let[r,a]=i,[o,s]=e,[u,h]=t,[d,f]=n;if(a===s&&r===o||h===f&&u===d)return null;let m=(d-u)*(s-a)-(f-h)*(o-r);if(m===0)return null;let v=((f-h)*(r-u)-(d-u)*(a-h))/m,b=((s-a)*(r-u)-(o-r)*(a-h))/m;if(v<0||v>1||b<0||b>1)return null;let w=a+v*(s-a);return[r+v*(o-r),w]}l(Wb,"getLineIntersection");R();function wT(i,e,t,n){let r=v1(i,t/1e3,n),a=v1(e,t/1e3,n);return[r.geometry.coordinates,a.geometry.coordinates]}l(wT,"getOffsetLine");R();function AT(i){let e=i*(180/Math.PI);return e=e%360,e>180?e-=360:e<-180&&(e+=360),Object.is(e,-0)?0:e}l(AT,"radToDegNormalized");var u8=111e3;function ST(i,e,t=[],n=0){let r=!0,a=i.geometry.coordinates,o=e.geometry.coordinates,s=AT(cd(a,o)-Math.PI/2),u=AT(cd(a,o)+Math.PI/2),h=n/u8,d=n/(u8*Math.cos(a[1]*Math.PI/180)),f=Math.min(a[1],o[1])-h,m=Math.max(a[1],o[1])+h,v=Math.min(a[0],o[0])-d,b=Math.max(a[0],o[0])+d;for(let w of t)if(!(Math.max(w[0][1],w[1][1])<f||Math.min(w[0][1],w[1][1])>m||Math.max(w[0][0],w[1][0])<v||Math.min(w[0][0],w[1][0])>b)){if(n>0){let A=wT(a,o,n,s),E=wT(a,o,n,u);if(Wb(A[0],A[1],w[0],w[1])||Wb(E[0],E[1],w[0],w[1])){r=!1;return}}else if(Wb(a,o,w[0],w[1])){r=!1;return}}return r}l(ST,"hasLineOfSight");var Jf,Rl,MT,Ase,Sse,Mse,Cse,Ese,Ise,CT,Tse=class{constructor({nodes:e,groupBy:t,multiplicativeDistanceWeightScaling:n}){ge(this,Rl),D(this,"edges",{}),D(this,"nodesById"),D(this,"nodesByGroup",new Map),ge(this,Jf),ge(this,CT,l((a,o)=>{let s=0;for(let u of o)(!u[y(this,Jf)]||u[y(this,Jf)]===a.properties[y(this,Jf)])&&yh(a.geometry.coordinates,u.geometry.geometry)&&(s+=Math.max(0,u.cost));return s},"#getZonalCost")),Ce(this,Jf,t);let{features:r}=e;this.nodesById=St(this,Rl,Ase).call(this,r),St(this,Rl,Sse).call(this),St(this,Rl,Mse).call(this,r,t,{multiplicativeDistanceWeightScaling:n})}getShortestEuclideanDistance(e,t){return t.reduce((n,r)=>{let a=ou(e.geometry.coordinates,r.geometry.coordinates);return Math.min(n,a)},Number.MAX_VALUE)}aStar({originIds:e,destinationNodeIds:t,excludedNodeIds:n,disabledConnectionNodeIds:r,zones:a,overrideEdgeWeights:o}){var s;let u=St(this,Rl,MT).call(this,e),h=St(this,Rl,MT).call(this,t);if(u.length===0||h.length===0)return[];let{frontier:d,cameFrom:f,costSoFar:m}=St(this,Rl,Cse).call(this,u,h);for(;d.length>0;){let v=d.shift();if(!v)break;if(St(this,Rl,Ese).call(this,v.origin,h))return St(this,Rl,Ise).call(this,f,v.origin.properties.id);for(let b of this.edges[v.origin.properties.id]){let w=(s=o?.get(b))!=null?s:b.weight;if(r!=null&&r.has(b.origin.properties.id)&&b.destination.properties.map!==b.origin.properties.map)continue;let A=m[v.origin.properties.id]+w+y(this,CT).call(this,b.destination,a);if(!(A===1/0||n!=null&&n.has(b.destination.properties.id))&&(m[b.destination.properties.id]==null||A<m[b.destination.properties.id])){let E=A+this.getShortestEuclideanDistance(b.destination,h);m[b.destination.properties.id]=A,f[b.destination.properties.id]=b,d.push({origin:b.destination,priority:E})}}d.sort((b,w)=>b.priority-w.priority)}return[]}};Jf=new WeakMap,Rl=new WeakSet,MT=l(function(i){return i.map(e=>this.nodesById[e]).filter(Boolean)},"#filterValidNodes"),Ase=l(function(i){return i.reduce((e,t)=>(e[t.properties.id]=t,e),{})},"#createNodesById"),Sse=l(function(){for(let i in this.nodesById)this.nodesById.hasOwnProperty(i)&&(this.nodesById[i].properties.neighbors=this.nodesById[i].properties.neighbors.filter(({id:e})=>!!this.nodesById[e]))},"#removeInvalidNeighbors"),Mse=l(function(i,e,t){i.forEach(n=>{let r=e==="default"?e:n.properties[e];this.nodesByGroup.has(r)||this.nodesByGroup.set(r,[]),this.nodesByGroup.get(r).push(n),this.edges[n.properties.id]=n.properties.neighbors.map(({id:a,weight:o})=>{let s=this.nodesById[a],u=ou(n.geometry.coordinates,s.geometry.coordinates),h=cd(n.geometry.coordinates,s.geometry.coordinates);return new bT({origin:n,destination:s,pathWeight:o,distance:u,angle:h,multiplicativeDistanceWeightScaling:t?.multiplicativeDistanceWeightScaling})})})},"#initializeEdgesAndGroups"),Cse=l(function(i,e){let t=[],n={},r={};return i.forEach(a=>{let o=this.getShortestEuclideanDistance(a,e);t.push({origin:a,priority:o}),n[a.properties.id]=null,r[a.properties.id]=0}),t.sort((a,o)=>a.priority-o.priority),{frontier:t,cameFrom:n,costSoFar:r}},"#initializeSearch"),Ese=l(function(i,e){return e.some(t=>t.properties.id===i.properties.id)},"#isDestinationNode"),Ise=l(function(i,e){let t=[],n=i[e];for(;n;)t.push(n),n=i[n.origin.properties.id];return t.reverse()},"#reconstructPath"),CT=new WeakMap,l(Tse,"NavigationGraph");var I3e=Tse,h8=.4,Pse=class{constructor({nodes:e,geojsonCollection:t,groupBy:n="default",multiplicativeDistanceWeightScaling:r}){D(this,"groupBy"),D(this,"graph"),D(this,"geometryEdgesByMapId",new Map),D(this,"generatePath",l(a=>{let{destination:o}=a[a.length-1],s={type:"FeatureCollection",features:[]};for(let h=0;h<a.length;h++){let{origin:d,destination:f}=a[h],m={id:d.properties.id,angle:a[h].angle,distance:a[h].distance,destination:f.properties.id,edges:this.graph.edges[d.properties.id]};this.groupBy!=="default"&&(m.groupBy=d.properties[this.groupBy]),s.features.push({type:"Feature",geometry:{type:"Point",coordinates:[d.geometry.coordinates[0],d.geometry.coordinates[1]]},properties:m})}let u={id:o.properties.id,edges:this.graph.edges[o.properties.id]};return this.groupBy!=="default"&&(u.groupBy=o.properties[this.groupBy]),s.features.push({type:"Feature",geometry:{type:"Point",coordinates:[o.geometry.coordinates[0],o.geometry.coordinates[1]]},properties:u}),s},"generatePath")),D(this,"hasLineOfSight",l((a,o,s,u=h8)=>ST({geometry:{type:"Point",coordinates:a}},{geometry:{type:"Point",coordinates:o}},this.geometryEdgesByMapId.get(s),u)===!0,"hasLineOfSight")),D(this,"getDistance",l((a,o)=>ou(a,o),"getDistance")),D(this,"getAngle",l((a,o)=>cd(a,o),"getAngle")),this.groupBy=n,this.graph=new I3e({nodes:e,groupBy:this.groupBy,multiplicativeDistanceWeightScaling:r}),(t?.features||[]).forEach(a=>{let o=null;if(a.geometry.type==="LineString"?o=a.geometry.coordinates:a.geometry.type==="Polygon"&&(o=a.geometry.coordinates.flat()),o){let s=this.groupBy==="default"?this.groupBy:a.properties[this.groupBy];this.geometryEdgesByMapId.has(s)||this.geometryEdgesByMapId.set(s,[]),o.forEach((u,h)=>{this.geometryEdgesByMapId.get(s).push([u,o[h+1]||o[0]])})}})}getDirections({zones:e,originIds:t,destinationNodeIds:n,excludedNodeIds:r,disabledConnectionNodeIds:a,simplify:o,multiplicativeDistanceWeightScaling:s,overrideEdgeWeights:u}){var h,d;let f=(h=o?.enabled)!=null?h:!0,m=e??[],v=this.graph.aStar({originIds:t,destinationNodeIds:n,zones:m,excludedNodeIds:new Set(r),disabledConnectionNodeIds:new Set(a),overrideEdgeWeights:u});return v.length===0?{type:"FeatureCollection",features:[]}:(f&&(v=this.simplifyAllSteps(v,(d=o?.bufferRadius)!=null?d:h8,s)),this.generatePath(v))}simplifyAllSteps(e,t,n){var r,a;let o=[],s=[e[0]];for(let f=1;f<e.length;f++)if(this.groupBy!=="default"&&e[f].origin.properties[this.groupBy]!==e[f-1].origin.properties[this.groupBy]){let m=e[f-1].origin.properties[this.groupBy],v=(r=this.geometryEdgesByMapId.get(m))!=null?r:[];o.push(...this.simplifySteps(s,v,t,n)),s=[e[f]]}else s.push(e[f]);let u=e[e.length-1],h=this.groupBy==="default"?this.groupBy:u.origin.properties[this.groupBy],d=(a=this.geometryEdgesByMapId.get(h))!=null?a:[];return o.push(...this.simplifySteps(s,d,t,n)),o}simplifySteps(e,t,n,r){if(e.length<3)return e;let a=[e[0]],o=1;for(let s=o+2;s<e.length;s++)if(e[o].origin.properties.preventSmoothing||!ST(e[o].origin,e[s].origin,t,n)){let u=s-1;a.push(new bT(lt(Me({},e[o]),{destination:e[u].origin,distance:ou(e[o].origin.geometry.coordinates,e[u].origin.geometry.coordinates),angle:cd(e[o].origin.geometry.coordinates,e[u].origin.geometry.coordinates)}))),o=u}return a.push(new bT(lt(Me({},e[o]),{destination:e[e.length-1].origin,distance:ou(e[o].origin.geometry.coordinates,e[e.length-1].origin.geometry.coordinates),angle:cd(e[o].origin.geometry.coordinates,e[e.length-1].origin.geometry.coordinates),multiplicativeDistanceWeightScaling:r})),e[e.length-1]),a}};l(Pse,"Navigator");var T3e=Pse,c8="https://tiles-cdn.mappedin.com/styles/mappedin/style.json",P3e="https://auth.mappedin.com/oauth2/token",ET="";function IT(i){ET=i,yQ(i)}l(IT,"setMaplibreWorkerUrl");var V1="";function TT(i){V1=i}l(TT,"setCollisionWorkerUrl");async function Lse(i,e){var t,n,r,a,o,s,u,h;let d=(t=e?.useWorkers)!=null?t:!0,f=lt(Me({},e),{watermark:e?.watermark,attribution:e?.attribution,antialias:e?.antialias,occlusionEnabled:e?.occlusionEnabled,transformImageRequest:e?.transformImageRequest,naturalBearing:(n=e?.naturalBearing)!=null?n:0,imagePlacementOptions:e?.imagePlacementOptions,onWebGLContextCreationError:e?.onWebGLContextCreationError,onWebGLContextLost:e?.onWebGLContextLost,onWebGLContextRestored:e?.onWebGLContextRestored,onWebGLRendererError:e?.onWebGLRendererError,useStandaloneCamera:(r=e?.useStandaloneCamera)!=null?r:!1,useCollisionWorker:(a=e?.useCollisionWorker)!=null?a:!0,useWorkers:d});if(d===!0&&(o=e?.outdoorView)!=null&&o.enabled){let{Map:m,MercatorCoordinate:v}=await _h(()=>import("./outdoor-context-v4-FKKIRNTV-BEC-Mt9T.js"),__vite__mapDeps([8,1,2])),b=e.outdoorView.headers;b==null&&(b=await gee(P3e));let w=e.center||[0,0],A=new m({container:i,style:e.outdoorView.style||c8,center:w,attributionControl:!1,zoom:(s=e.zoomLevel)!=null?s:mse,pitch:(u=e.pitch)!=null?u:dse,bearing:(h=e.bearing)!=null?h:fse,transformRequest:R2e(b),trackResize:!1,pixelRatio:e.outdoorView.lowDpi?1:$v(),antialias:typeof e.antialias=="boolean"?e.antialias:!0,boxZoom:!1,doubleClickZoom:!1,scrollZoom:!1,dragPan:!1,dragRotate:!1,keyboard:!1,touchZoomRotate:!1}),E=A.painter.context.gl,I=new xT(i,Me({center:w,zoomLevel:A.getZoom(),pitch:A.getPitch(),bearing:A.getBearing(),gl:E,map:A,mode:"outdoors-interleaved"},f)),C={center:A.getCenter().toArray(),zoom:A.getZoom(),bearing:A.getBearing(),pitch:A.getPitch()};A.setMinZoom(I.camera.minZoomLevel),A.setMaxZoom(I.camera.maxZoomLevel),I.on("camera-change",z=>{C.center=z.center,C.zoom=z.zoomLevel,C.bearing=z.bearing,C.pitch=z.pitch,A.jumpTo(C)});let T=v.fromLngLat(w,0),k=YL(T,I.viewCamera,I.camera,()=>{I.renderSync()});A.on("style.load",async()=>{A&&(A.addLayer(k),I.renderSync())});let F=!1,B=!1;A.on("idle",()=>{A&&(F||(I.publish("outdoor-view-loaded"),F=!0),B||(B=!0,I.publish("outdoor-style-loaded")))});let N=l(z=>{z&&(z.sourceDataType==="metadata"||z.sourceDataType==="visibility"||z.dataType==="style"||z.type==="terrain")&&I.getSystems().htmlControlsSystem.updateData(A)},"updateData");return A.on("styledata",z=>{A&&z&&z.dataType==="style"&&z.type==="styledata"&&(B=!1),N(z)}),A.on("sourcedata",N),A.on("terrain",N),A.on("error",z=>{var L;if(((L=z.error)==null?void 0:L.url)===c8){nt.error('Failed to load outdoor view style, possibly due to invalid token "'.concat(b["x-mappedin-tiles-key"],'"'));return}nt.warn(z)}),I}else return new xT(i,f)}l(Lse,"createRenderer");R();R();R();var Dse=(i=>(i.Departure="Departure",i.TakeConnection="TakeConnection",i.ExitConnection="ExitConnection",i.Turn="Turn",i.Arrival="Arrival",i))(Dse||{}),kse=(i=>(i.Straight="Straight",i.Right="Right",i.SlightRight="SlightRight",i.Left="Left",i.SlightLeft="SlightLeft",i.Back="Back",i))(kse||{}),Rse=(i=>(i.stairs="stairs",i.elevator="elevator",i.escalator="escalator",i.door="door",i.ramp="ramp",i.slide="slide",i.portal="portal",i.security="security",i.shuttle="shuttle",i))(Rse||{}),Ose=(i=>(i.Exterior="exterior-walls",i.Interior="interior-walls",i))(Ose||{}),Nse=(i=>(i.Interior="interior-doors",i.Exterior="exterior-doors",i))(Nse||{});R();R();var PT=class LT{constructor(e,t,n){D(this,"id"),D(this,"text"),D(this,"target"),D(this,"__type",LT.__type),this.id=e,this.text=t,this.target=n}static is(e){return e.__type===LT.__type}get focusTarget(){return this.target.anchorTarget}};l(PT,"Label"),D(PT,"__type","Label");var DT=PT;R();var Kf,kT=class qb{constructor(e,t,n){D(this,"id"),ge(this,Kf),D(this,"__type",qb.__type),D(this,"contentEl"),this.id=e,this.contentEl=t,Ce(this,Kf,n)}get target(){return y(this,Kf)}get coordinate(){return y(this,Kf).anchorTarget}toJSON(){return{id:this.id,__type:qb.__type,target:this.target,coordinate:this.coordinate}}static is(e){return e.__type===qb.__type}get focusTarget(){return this.target.anchorTarget}updateTarget(e){Ce(this,Kf,e)}};Kf=new WeakMap,l(kT,"Marker"),D(kT,"__type","Marker");var QD=kT;R();var Xb,Zb,RT=class OT{constructor(e,t,n){ge(this,Xb),ge(this,Zb),D(this,"target"),D(this,"__type",OT.__type),Ce(this,Xb,e),Ce(this,Zb,t),this.target=n}static is(e){return e.__type===OT.__type}get id(){return y(this,Xb)}get url(){return y(this,Zb)}};Xb=new WeakMap,Zb=new WeakMap,l(RT,"Image"),D(RT,"__type","Image");var L3e=RT;R();var Qf,NT=class Yb{constructor(e,t,n){D(this,"id"),D(this,"groupId"),D(this,"__type",Yb.__type),ge(this,Qf),this.id=e,this.groupId=t,Ce(this,Qf,n)}get target(){return y(this,Qf)}static is(e){return e.__type===Yb.__type}updateTarget(e){Ce(this,Qf,e)}toJSON(){return{id:this.id,__type:Yb.__type,groupId:this.groupId,target:y(this,Qf)}}};Qf=new WeakMap,l(NT,"Model"),D(NT,"__type","Model");var Fse=NT;R();var FT=class BT{constructor(e,t){D(this,"id"),D(this,"coordinates"),D(this,"__type",BT.__type),this.id=e,this.coordinates=t}static is(e){return e.__type===BT.__type}get focusTarget(){return this.coordinates}};l(FT,"PathSegment"),D(FT,"__type","PathSegment");var Bse=FT,zT=class Jb{constructor(e,t,n,r){D(this,"id"),D(this,"animation"),D(this,"coordinates"),D(this,"segments"),D(this,"__type",Jb.__type),this.id=e,this.animation=t,this.coordinates=n,this.segments=r.map(({id:a,coordinates:o})=>new Bse(a.toString(),o))}static is(e){return e.__type===Jb.__type}get focusTarget(){return this.coordinates}toJSON(){return{__type:Jb.__type,id:this.id,coordinates:this.coordinates,segments:this.segments}}};l(zT,"Path"),D(zT,"__type","Path");var j1=zT;R();var Lp,zse=class{constructor(e){ge(this,Lp),Ce(this,Lp,e)}toJSON(){return{center:this.center,bearing:this.bearing,pitch:this.pitch,zoomLevel:this.zoomLevel}}get center(){return y(this,Lp).center}get bearing(){return y(this,Lp).bearing}get pitch(){return y(this,Lp).pitch}get zoomLevel(){return y(this,Lp).zoomLevel}};Lp=new WeakMap,l(zse,"CameraTransform");var D3e=zse;R();var UT=class VT{constructor(e){D(this,"id"),D(this,"__type",VT.__type),this.id=e}static is(e){return e.__type===VT.__type}get focusTarget(){return this}};l(UT,"Shape"),D(UT,"__type","Shape");var Kb=UT;R();var jT=class Use{constructor(e,t){D(this,"id"),D(this,"target"),D(this,"__type","Text3D"),this.id=e,this.target=t}static is(e){return e.__type===Use.__type}};l(jT,"Text3D"),D(jT,"__type","Text3D");var GT=jT;R();R();R();var k3e=new Map([["search-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M1 7C1 3.68629 3.68629 1 7 1C10.3137 1 13 3.68629 13 7C13 8.29583 12.5892 9.49572 11.8907 10.4765L15.4614 14.0472C15.6567 14.2425 15.6567 14.559 15.4614 14.7543L14.7543 15.4614C14.559 15.6567 14.2424 15.6567 14.0472 15.4614L10.4765 11.8907C9.49571 12.5892 8.29583 13 7 13C3.68629 13 1 10.3137 1 7ZM7 11C4.79086 11 3 9.20914 3 7C3 4.79086 4.79086 3 7 3C9.20914 3 11 4.79086 11 7C11 9.20914 9.20914 11 7 11Z"
				stroke="none"
			/>
		</svg>`],["close-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M12.5963 1.98959C12.7916 1.79433 13.1082 1.79433 13.3034 1.98959L14.0105 2.6967C14.2058 2.89196 14.2058 3.20855 14.0105 3.40381L3.40392 14.0104C3.20866 14.2057 2.89208 14.2057 2.69682 14.0104L1.98971 13.3033C1.79445 13.108 1.79445 12.7915 1.98971 12.5962L12.5963 1.98959Z"
				stroke="none"
			/>
			<path
				d="M1.98971 3.40381C1.79445 3.20855 1.79445 2.89196 1.98971 2.6967L2.69682 1.98959C2.89208 1.79433 3.20866 1.79433 3.40392 1.98959L14.0105 12.5962C14.2058 12.7915 14.2058 13.108 14.0105 13.3033L13.3034 14.0104C13.1082 14.2057 12.7916 14.2057 12.5963 14.0104L1.98971 3.40381Z"
				stroke="none"
			/>
		</svg>`],["empty-64x40",`<svg viewBox="0 0 64 40">
			<g>
				<g clipPath="url(#clip0_499_175492)">
					<path
						d="M32 39.7032C49.6731 39.7032 64 36.5925 64 32.7552C64 28.9179 49.6731 25.8071 32 25.8071C14.3269 25.8071 0 28.9179 0 32.7552C0 36.5925 14.3269 39.7032 32 39.7032Z"
						stroke="none"
						fill="#F5F5F5"
					/>
					<path
						d="M55 13.6653L44.854 2.24866C44.367 1.47048 43.656 1 42.907 1H21.093C20.344 1 19.633 1.47048 19.146 2.24767L9 13.6663V22.8367H55V13.6653Z"
						fill="none"
					/>
					<path
						d="M41.613 16.8128C41.613 15.2197 42.607 13.9046 43.84 13.9036H55V31.9059C55 34.0132 53.68 35.7402 52.05 35.7402H11.95C10.32 35.7402 9 34.0122 9 31.9059V13.9036H20.16C21.393 13.9036 22.387 15.2167 22.387 16.8098V16.8317C22.387 18.4248 23.392 19.7111 24.624 19.7111H39.376C40.608 19.7111 41.613 18.4128 41.613 16.8198V16.8128Z"
						fill="#FAFAFA"
					/>
				</g>
				<defs>
					<clipPath id="clip0_499_175492">
						<rect width="64" height="40" fill="white" />
					</clipPath>
				</defs>
			</g>
		</svg>`],["caret-12x12",`<svg viewBox="0 0 12 12">
			<path
				stroke="none"
				d="M8.38828 5.78337L3.92578 1.93493C3.75938 1.79196 3.51562 1.92087 3.51562 2.15173V9.84861C3.51562 10.0795 3.75938 10.2084 3.92578 10.0654L8.38828 6.21696C8.51602 6.10681 8.51602 5.89353 8.38828 5.78337Z"
			/>
		</svg>`],["plus-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M7.5 1C7.22386 1 7 1.22386 7 1.5V7H1.5C1.22386 7 1 7.22386 1 7.5L1 8.5C1 8.77614 1.22386 9 1.5 9H7V14.5C7 14.7761 7.22386 15 7.5 15H8.5C8.77614 15 9 14.7761 9 14.5V9H14.5C14.7761 9 15 8.77614 15 8.5V7.5C15 7.22386 14.7761 7 14.5 7H9V1.5C9 1.22386 8.77614 1 8.5 1H7.5Z"
				stroke="none"
			/>
		</svg>`],["recenter-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M0 2.5C0 2.22386 0.223858 2 0.5 2H1.5C1.77614 2 2 2.22386 2 2.5V13.5C2 13.7761 1.77614 14 1.5 14H0.5C0.223858 14 0 13.7761 0 13.5V2.5Z" />
				<path
					fillRule="evenodd"
					clipRule="evenodd"
					d="M4.5 4C4.22386 4 4 4.22386 4 4.5V11.5C4 11.7761 4.22386 12 4.5 12H11.5C11.7761 12 12 11.7761 12 11.5V4.5C12 4.22386 11.7761 4 11.5 4H4.5ZM6 6V10H10V6H6Z"
				/>
				<path d="M14.5 2C14.2239 2 14 2.22386 14 2.5V13.5C14 13.7761 14.2239 14 14.5 14H15.5C15.7761 14 16 13.7761 16 13.5V2.5C16 2.22386 15.7761 2 15.5 2H14.5Z" />
			</g>
		</svg>`],["minus-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M1.5 9C1.22386 9 1 8.77614 1 8.5L1 7.5C1 7.22386 1.22386 7 1.5 7L14.5 7C14.7761 7 15 7.22386 15 7.5V8.5C15 8.77614 14.7761 9 14.5 9L1.5 9Z"
				stroke="none"
			/>
		</svg>`],["logo-horizontal-206x48",`<svg viewBox="0 0 206 48">
			<path d="M27.2678 14.2261H22.3187C21.0695 14.2261 20.4695 14.7801 20.4695 15.9852V31.142L10.3966 15.5591C9.69665 14.4784 9.2475 14.2773 7.8475 14.2261H2.97462C1.67462 14.2261 1.07631 14.7801 1.07631 15.9852V44.7665C1.07631 45.9716 1.67462 46.5256 2.97462 46.5256H7.92377C9.22207 46.5256 9.82207 45.9716 9.82207 44.7665V29.6847L19.9441 45.1926C20.695 46.3244 21.095 46.5256 22.4933 46.5256H27.2933C28.5916 46.5256 29.1916 45.9716 29.1916 44.7665V15.9852C29.1407 14.7801 28.5424 14.2261 27.2678 14.2261Z" />
			<path d="M5.44915 10.9602C8.45863 10.9602 10.8983 8.50669 10.8983 5.48011C10.8983 2.45353 8.45863 0 5.44915 0C2.43967 0 0 2.45353 0 5.48011C0 8.50669 2.43967 10.9602 5.44915 10.9602Z" />
			<path d="M61.7899 25.0449C63.2306 23.1903 65.078 22.2051 67.556 22.2051C72.0526 22.2051 74.7611 25.3347 74.7611 29.4511V39.2489C74.8187 39.7125 74.5306 39.9443 74.0695 39.9443H72.5136C72.0526 39.9443 71.7645 39.7125 71.8221 39.2489V29.5091C71.8221 27.1909 69.9187 25.2187 67.4984 25.2187C65.1339 25.2187 63.2323 27.1329 63.2323 29.2773V39.2489C63.2899 39.7125 63.0018 39.9443 62.5407 39.9443H60.9831C60.5221 39.9443 60.2916 39.7125 60.2916 39.2489V29.4511C60.2916 27.1329 58.3899 25.2187 56.0255 25.2187C53.7204 25.2187 51.7594 27.075 51.7594 29.2773V39.3068C51.817 39.7705 51.5289 40.0023 51.0102 40.0023H49.5119C49.0509 40.0023 48.7628 39.7705 48.7628 39.3068V23.25C48.7051 22.7864 48.9933 22.4966 49.5119 22.4966H50.9526C51.356 22.4966 51.5289 22.6704 51.5289 23.0182V24.2352C52.7407 22.9602 54.239 22.2648 56.0255 22.2648C58.4475 22.2068 60.3492 23.192 61.7899 25.0466V25.0449ZM77.1255 31.2477C77.1255 26.3216 81.1018 22.2051 86.1187 22.2051C88.539 22.2051 90.6136 23.1903 92.3441 25.1608V23.1903C92.3441 22.7267 92.5746 22.5528 93.0357 22.5528H94.4187C94.8797 22.5528 95.1102 22.7847 95.1102 23.3062V39.3648C95.1102 39.8284 94.8797 40.0602 94.4187 40.0602H93.0357C92.5746 40.0602 92.3441 39.8284 92.3441 39.4227V37.4523C90.6712 39.3648 88.5967 40.35 86.1746 40.35C81.1018 40.2341 77.1238 36.1773 77.1238 31.2477H77.1255ZM92.1136 31.2477C92.1136 27.8284 89.4611 25.2187 86.0594 25.2187C82.7746 25.2187 80.1221 27.8864 80.1221 31.2477C80.1221 34.6687 82.7746 37.2784 86.1187 37.2784C86.9062 37.2789 87.6861 37.1232 88.4138 36.8202C89.1414 36.5173 89.8026 36.0731 90.3593 35.513C90.9161 34.9528 91.3577 34.2878 91.6587 33.556C91.9597 32.8241 92.1143 32.0397 92.1136 31.2477ZM100.992 37.3943V46.3807C101.049 46.8443 100.761 47.1341 100.298 47.1341H98.7424C98.2814 47.1341 97.9933 46.9023 97.9933 46.3807V23.1903C97.9933 22.7267 98.2238 22.4369 98.7424 22.4369H100.183C100.646 22.379 100.934 22.6687 100.934 23.0744V24.9869C102.605 23.0744 104.68 22.1472 107.044 22.1472C112.002 22.1472 116.037 26.2619 116.037 31.1898C116.037 36.1176 112.059 40.2341 107.044 40.2341C104.622 40.2341 102.603 39.3068 100.992 37.3943ZM106.987 25.2187C103.7 25.2187 101.049 27.8864 101.049 31.2477C101.049 34.6687 103.7 37.2784 107.044 37.2784C110.446 37.2784 113.039 34.6108 113.039 31.2477C113.039 27.8864 110.388 25.2187 106.987 25.2187ZM121.11 37.3943V46.3807C121.168 46.8443 120.88 47.1341 120.419 47.1341H118.861C118.4 47.1341 118.112 46.9023 118.112 46.3807V23.1903C118.112 22.7267 118.342 22.4369 118.861 22.4369H120.302C120.764 22.379 121.053 22.6687 121.053 23.0744V24.9869C122.724 23.0744 124.798 22.1472 127.163 22.1472C132.12 22.1472 136.156 26.2619 136.156 31.1898C136.156 36.1176 132.178 40.2341 127.163 40.2341C124.742 40.2341 122.781 39.3068 121.11 37.3943ZM127.105 25.2187C123.819 25.2187 121.168 27.8864 121.168 31.2477C121.168 34.6687 123.819 37.2784 127.163 37.2784C130.564 37.2784 133.158 34.6108 133.158 31.2477C133.158 27.8864 130.507 25.2187 127.107 25.2187H127.105ZM153.97 32.3506H141.054C141.342 35.2483 143.995 37.4523 147.164 37.4523C148.893 37.4523 150.393 37.0466 151.719 36.0597C152.007 35.8858 152.295 35.7699 152.353 35.7699C152.583 35.7699 152.756 35.8858 152.929 36.1773L153.505 37.1625C153.622 37.3364 153.68 37.4523 153.68 37.5682C153.68 37.8 153.507 38.0318 153.103 38.3216C151.258 39.5966 149.183 40.292 146.992 40.292C141.688 40.292 137.883 36.3511 137.883 31.2477C137.883 26.204 141.803 22.2051 146.703 22.2051C151.546 22.2051 154.717 25.7983 154.717 31.0176C154.717 31.5972 154.717 32.3506 153.968 32.3506H153.97ZM141.056 30.0324H151.72C151.432 26.8432 149.473 24.929 146.648 24.929C145.241 24.8904 143.875 25.3995 142.833 26.3501C141.791 27.3007 141.154 28.6194 141.056 30.0307V30.0324ZM156.332 31.2477C156.332 26.3216 160.31 22.2051 165.326 22.2051C167.748 22.2051 169.707 23.1324 171.32 25.0449V16.2324C171.263 15.7687 171.551 15.479 172.012 15.479H173.57C174.031 15.479 174.319 15.7108 174.319 16.2324V39.3068C174.319 39.7705 174.088 40.0023 173.57 40.0023H172.129C171.666 40.0602 171.378 39.7705 171.378 39.3648V37.3943C169.649 39.3068 167.632 40.292 165.268 40.292C160.31 40.2341 156.332 36.1773 156.332 31.2477ZM171.264 31.2477C171.264 27.8284 168.612 25.2187 165.21 25.2187C161.924 25.2187 159.273 27.8864 159.273 31.2477C159.273 34.6687 161.924 37.2784 165.268 37.2784C166.057 37.2838 166.839 37.1316 167.569 36.8304C168.299 36.5292 168.962 36.0852 169.52 35.5241C170.077 34.963 170.519 34.296 170.818 33.5619C171.117 32.8277 171.268 32.0411 171.263 31.2477H171.264ZM177.72 19.0739C177.715 18.8594 177.754 18.646 177.833 18.4468C177.912 18.2476 178.031 18.0667 178.182 17.915C178.333 17.7633 178.512 17.6439 178.71 17.5642C178.909 17.4845 179.121 17.446 179.334 17.4511C179.546 17.4507 179.756 17.4923 179.952 17.5737C180.148 17.6551 180.326 17.7746 180.476 17.9254C180.626 18.0762 180.745 18.2553 180.826 18.4523C180.907 18.6494 180.948 18.8606 180.948 19.0739C180.953 19.2884 180.914 19.5017 180.835 19.7009C180.756 19.9001 180.637 20.081 180.486 20.2327C180.335 20.3845 180.156 20.5038 179.957 20.5835C179.759 20.6633 179.547 20.7017 179.334 20.6966C178.412 20.7545 177.72 20.0591 177.72 19.0739ZM177.836 39.2489V23.1903C177.836 22.7267 178.066 22.4369 178.527 22.4369H180.083C180.544 22.4369 180.832 22.6687 180.775 23.1903V39.2489C180.832 39.7125 180.544 39.9443 180.083 39.9443H178.527C178.066 39.9443 177.836 39.7125 177.836 39.2489ZM186.944 23.0165V24.1756C188.212 22.8426 189.71 22.2051 191.497 22.2051C195.937 22.2051 198.646 25.2767 198.646 29.3932V39.2489C198.703 39.7125 198.415 39.9443 197.954 39.9443H196.398C195.936 39.9443 195.705 39.7125 195.705 39.2489V29.4511C195.705 27.1329 193.803 25.2187 191.439 25.2187C189.134 25.2187 187.175 27.075 187.175 29.2773V39.3068C187.232 39.7705 186.944 40.0023 186.424 40.0023H184.868C184.407 40.0023 184.119 39.7705 184.119 39.3068V23.1903C184.061 22.7267 184.349 22.4949 184.868 22.4949H186.309C186.712 22.4949 186.944 22.6687 186.944 23.0165Z" />
			<path d="M204 40C205.115 40 206 39.0857 206 38V37.9886C206 36.9029 205.126 36 204 36C202.885 36 202 36.9143 202 38V38.0114C202 39.0971 202.874 40 204 40ZM204 39.7829C202.989 39.7829 202.23 38.9829 202.23 38.0114V38C202.23 37.0286 203 36.2171 204 36.2171C205.011 36.2171 205.77 37.0171 205.77 37.9886V38C205.77 38.9714 205 39.7829 204 39.7829ZM203.218 38.9714H203.609V38.2743H204.034L204.517 38.9714H204.989L204.448 38.2057C204.724 38.1257 204.92 37.92 204.92 37.5886C204.92 37.1657 204.586 36.9486 204.138 36.9486H203.218V38.9714ZM203.609 37.9543V37.2914H204.103C204.368 37.2914 204.517 37.4057 204.517 37.6229C204.517 37.8171 204.368 37.9543 204.103 37.9543H203.609Z" />
		</svg>`],["share-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M13 6C14.6569 6 16 4.65685 16 3C16 1.34315 14.6569 0 13 0C11.3431 0 10 1.34315 10 3C10 3.13463 10.0089 3.26719 10.0261 3.39712L6.82972 5.17286C6.10576 4.44825 5.10523 4 4 4C1.79086 4 0 5.79086 0 8C0 10.2091 1.79086 12 4 12C5.10523 12 6.10576 11.5518 6.82972 10.8271L10.0261 12.6029C10.0089 12.7328 10 12.8654 10 13C10 14.6569 11.3431 16 13 16C14.6569 16 16 14.6569 16 13C16 11.3431 14.6569 10 13 10C12.2011 10 11.4752 10.3123 10.9376 10.8214L7.84579 9.1037C7.94622 8.75313 8 8.38284 8 8C8 7.61716 7.94622 7.24687 7.84579 6.8963L10.9376 5.17864C11.4752 5.68775 12.2011 6 13 6ZM13 4C13.5523 4 14 3.55228 14 3C14 2.44772 13.5523 2 13 2C12.4477 2 12 2.44772 12 3C12 3.55228 12.4477 4 13 4ZM4 10C5.10457 10 6 9.10457 6 8C6 6.89543 5.10457 6 4 6C2.89543 6 2 6.89543 2 8C2 9.10457 2.89543 10 4 10ZM14 13C14 13.5523 13.5523 14 13 14C12.4477 14 12 13.5523 12 13C12 12.4477 12.4477 12 13 12C13.5523 12 14 12.4477 14 13Z"
				stroke="none"
			/>
		</svg>`],["checkmark-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M15.387 3.31662C15.6008 3.49148 15.6323 3.80649 15.4574 4.02021L6.77402 14.6332C6.58509 14.8642 6.30292 14.9986 6.00457 15C5.70622 15.0013 5.42285 14.8694 5.23184 14.6402L0.551937 9.02429C0.375155 8.81215 0.403817 8.49687 0.615956 8.32009L1.38418 7.67991C1.59632 7.50312 1.9116 7.53179 2.08838 7.74392L5.99299 12.4295L13.9095 2.75374C14.0844 2.54002 14.3994 2.50852 14.6131 2.68338L15.387 3.31662Z"
				stroke="none"
			/>
		</svg>`],["arrow-right-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M8.35355 1.64645C8.54881 1.45118 8.8654 1.45118 9.06066 1.64645L14.7071 7.29289C15.0976 7.68342 15.0976 8.31658 14.7071 8.70711L9.06066 14.3536C8.8654 14.5488 8.54882 14.5488 8.35355 14.3536L7.64645 13.6464C7.45118 13.4512 7.45118 13.1346 7.64645 12.9393L11.5858 9H0.5C0.223858 9 0 8.77614 0 8.5V7.5C0 7.22386 0.223858 7 0.5 7H11.5858L7.64645 3.06066C7.45118 2.8654 7.45118 2.54882 7.64645 2.35355L8.35355 1.64645Z"
				stroke="none"
			/>
		</svg>`],["arrow-up-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M8.00015 0.5C8.34685 0.5 8.67835 0.642318 8.91714 0.893677L15.6517 7.98267C15.8441 8.18525 15.8359 8.50548 15.6333 8.69793L14.533 9.7433C14.3304 9.93575 14.0101 9.92754 13.8177 9.72496L9.26497 4.93262V15.4249C9.26497 15.7043 9.03846 15.9308 8.75904 15.9308H7.24125C6.96184 15.9308 6.73532 15.7043 6.73532 15.4249V4.93262L2.1826 9.72496C1.99015 9.92754 1.66992 9.93575 1.46734 9.7433L0.366945 8.69793C0.164367 8.50548 0.156156 8.18525 0.348604 7.98267L7.08315 0.893677C7.32194 0.642318 7.65344 0.5 8.00015 0.5Z"
				stroke="none"
			/>
		</svg>`],["connection-stairs-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M1 11.5C1 11.2239 1.22386 11 1.5 11H6V13.5C6 13.7761 5.77614 14 5.5 14H1.5C1.22386 14 1 13.7761 1 13.5V11.5Z" />
				<path d="M4 8.5C4 8.22386 4.22386 8 4.5 8H9V10.5C9 10.7761 8.77614 11 8.5 11H4V8.5Z" />
				<path d="M7 5.5C7 5.22386 7.22386 5 7.5 5H12V7.5C12 7.77614 11.7761 8 11.5 8H7V5.5Z" />
				<path d="M10 2.5C10 2.22386 10.2239 2 10.5 2H14.5C14.7761 2 15 2.22386 15 2.5V4.5C15 4.77614 14.7761 5 14.5 5H10V2.5Z" />
			</g>
		</svg>`],["connection-stairs-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M5.25 12H2.5C2.225 12 2 11.7429 2 11.4286C2 11.1143 2.225 10.8571 2.5 10.8571H4.25V7.91429H6.5V4.94286H8.75V2H11.5C11.775 2 12 2.25714 12 2.57143C12 2.88571 11.775 3.14286 11.5 3.14286H9.75V6.08571H7.5V9.02857H5.25V12Z"
				stroke="none"
			/>
		</svg>`],["connection-stairs-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<path d="M1.625 8.1875C1.625 8.01491 1.76491 7.875 1.9375 7.875H4.75V9.4375C4.75 9.61009 4.61009 9.75 4.4375 9.75H1.9375C1.76491 9.75 1.625 9.61009 1.625 9.4375V8.1875Z" />
			<path d="M3.5 6.3125C3.5 6.13991 3.63991 6 3.8125 6H6.625V7.5625C6.625 7.73509 6.48509 7.875 6.3125 7.875H3.5V6.3125Z" />
			<path d="M5.375 4.4375C5.375 4.26491 5.51491 4.125 5.6875 4.125H8.5V5.6875C8.5 5.86009 8.36009 6 8.1875 6H5.375V4.4375Z" />
			<path d="M7.25 2.5625C7.25 2.38991 7.38991 2.25 7.5625 2.25H10.0625C10.2351 2.25 10.375 2.38991 10.375 2.5625V3.8125C10.375 3.98509 10.2351 4.125 10.0625 4.125H7.25V2.5625Z" />
		</svg>`],["connection-escalator-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M3.63008 12H2C0.895431 12 0 12.8954 0 14C0 15.1046 0.89543 16 2 16H4.63008C4.86879 16 5.09962 15.9146 5.28087 15.7593L11.7191 10.2407C11.9004 10.0854 12.1312 10 12.3699 10H14C15.1046 10 16 9.10457 16 8C16 6.89543 15.1046 6 14 6H11.3699C11.1312 6 10.9004 6.08539 10.7191 6.24074L4.28087 11.7593C4.09962 11.9146 3.86879 12 3.63008 12Z" />
				<path d="M5 6C5 4.89543 5.89543 4 7 4C8.10457 4 9 4.89543 9 6L5 9.5V6Z" />
				<path d="M9 2C9 3.10457 8.10457 4 7 4C5.89543 4 5 3.10457 5 2C5 0.89543 5.89543 0 7 0C8.10457 0 9 0.89543 9 2Z" />
			</g>
		</svg>`],["connection-escalator-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M5.26686 2.98522C5.26686 2.44335 5.71573 2 6.26436 2C6.81299 2 7.26187 2.44335 7.26187 2.98522C7.26187 3.5271 6.81299 3.97045 6.26436 3.97045C5.71573 3.97045 5.26686 3.50246 5.26686 2.98522Z"
				stroke="none"
			/>
			<path
				d="M7.26188 5.48588V5.25125C7.26188 4.85716 6.91275 4.53696 6.48881 4.53696H6.03993C5.61599 4.53696 5.26687 4.88179 5.26687 5.25125V7.66458L4.3192 8.6995H3.67082C2.74813 8.6995 2 9.43842 2 10.3498C2 11.2611 2.74813 12 3.67082 12H4.61845C5.36658 12 6.11471 11.6798 6.61347 11.1133L9.6808 7.76354H10.3292C11.2519 7.76354 12 7.02463 12 6.11329C12 5.20196 11.2519 4.46305 10.3292 4.46305H9.38155C8.60848 4.46305 7.88529 4.78324 7.38653 5.34975L7.26188 5.48588ZM4.61846 11.0148H3.67083C3.29677 11.0148 2.99751 10.7192 2.99751 10.3498C2.99751 9.9803 3.29677 9.68473 3.67083 9.68473H4.61846C4.71821 9.68473 4.81796 9.63547 4.86784 9.56158L8.13467 5.99015C8.45886 5.64532 8.90774 5.44828 9.38155 5.44828H10.3292C10.7032 5.44828 11.0025 5.74384 11.0025 6.1133C11.0025 6.48276 10.7032 6.77833 10.3292 6.77833H9.38155C9.2818 6.77833 9.18205 6.82759 9.13218 6.87685L5.86534 10.4729C5.54115 10.8177 5.09228 11.0148 4.61846 11.0148Z"
				stroke="none"
			/>
		</svg>`],["connection-elevator-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M3 5.5C3 6.32843 2.32843 7 1.5 7C0.671573 7 0 6.32843 0 5.5C0 4.67157 0.671573 4 1.5 4C2.32843 4 3 4.67157 3 5.5Z" />
				<path d="M3 10.5C3 11.3284 2.32843 12 1.5 12C0.671573 12 0 11.3284 0 10.5C0 9.67157 0.671573 9 1.5 9C2.32843 9 3 9.67157 3 10.5Z" />
				<path d="M11 1H14C14.5523 1 15 1.44772 15 2V14C15 14.5523 14.5523 15 14 15H11V1Z" />
				<path d="M9 1H6C5.44772 1 5 1.44772 5 2V14C5 14.5523 5.44772 15 6 15H9V1Z" />
			</g>
		</svg>`],["connection-elevator-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M7.476 2H2.72693C1.77095 2 1 2.72464 1 3.62319V10.3768C1 11.2754 1.77095 12 2.72693 12H7.476C8.43198 12 9.20293 11.2754 9.20293 10.3768V3.62319C9.17209 2.72464 8.40114 2 7.476 2ZM7.476 3.15942C7.75354 3.15942 7.96941 3.36232 7.96941 3.62319V10.3768C7.96941 10.6377 7.75354 10.8406 7.476 10.8406H5.71824V3.15942H7.476ZM4.48472 3.15942V10.8406H2.72693C2.44939 10.8406 2.23352 10.6377 2.23352 10.3768V3.62319C2.23352 3.36232 2.44939 3.15942 2.72693 3.15942H4.48472Z"
				stroke="none"
			/>
			<path
				d="M12.4643 6.19064H10.6638C10.4456 6.19064 10.2546 6.06243 10.1728 5.88294C10.0909 5.70346 10.1455 5.47269 10.2819 5.31884L11.1821 4.47269C11.4004 4.26756 11.755 4.26756 11.946 4.47269L12.8462 5.31884C13.0099 5.47269 13.0371 5.67781 12.9553 5.88294C12.8735 6.08807 12.6825 6.19064 12.4643 6.19064Z"
				stroke="none"
			/>
			<path
				d="M11.564 9.65216C11.4276 9.65216 11.2912 9.60088 11.1821 9.49831L10.2819 8.65216C10.1182 8.49831 10.0909 8.29319 10.1728 8.08806C10.2546 7.90857 10.4456 7.78036 10.6638 7.78036H12.4643C12.6825 7.78036 12.8735 7.90857 12.9553 8.08806C13.0371 8.26754 12.9826 8.49831 12.8462 8.65216L11.9459 9.49831C11.8641 9.60088 11.7004 9.65216 11.564 9.65216Z"
				stroke="none"
			/>
		</svg>`],["connection-elevator-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<circle cx="1.9375" cy="4.4375" r="0.9375" />
			<circle cx="1.9375" cy="7.5625" r="0.9375" />
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M7.6 2H9.4C9.73137 2 10 2.26863 10 2.6V9.41328C10 9.74465 9.73137 10.0133 9.4 10.0133H7.6V2ZM6.4 2H4.6C4.26863 2 4 2.26863 4 2.6V9.41328C4 9.74465 4.26863 10.0133 4.6 10.0133H6.4V2Z"
			/>
		</svg>`],["new-tab-14x14",`<svg viewBox="0 0 14 14">
			<g stroke="none">
				<path d="M2.625 2.625H5.6875C5.92913 2.625 6.125 2.42912 6.125 2.1875V1.3125C6.125 1.07088 5.92913 0.875 5.6875 0.875H1.3125C1.07088 0.875 0.875 1.07088 0.875 1.3125V12.6875C0.875 12.9291 1.07088 13.125 1.3125 13.125H12.6875C12.9291 13.125 13.125 12.9291 13.125 12.6875V8.3125C13.125 8.07088 12.9291 7.875 12.6875 7.875H11.8125C11.5709 7.875 11.375 8.07088 11.375 8.3125V11.375H2.625V2.625Z" />
				<path d="M12.9063 0.875H8.40311C8.20822 0.875 8.11063 1.11062 8.24843 1.24843L9.88124 2.88124L5.8156 6.94688C5.64475 7.11774 5.64475 7.39475 5.8156 7.5656L6.43432 8.18432C6.60517 8.35517 6.88218 8.35517 7.05304 8.18432L11.1187 4.11868L12.7516 5.75157C12.8894 5.88938 13.125 5.79178 13.125 5.59689V1.09375C13.125 0.972938 13.0271 0.875 12.9063 0.875Z" />
			</g>
		</svg>`],["compress-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path
					id="Vector"
					d="M4.67773 10.7154H0.713449C0.556306 10.7154 0.427734 10.844 0.427734 11.0011V11.8583C0.427734 12.0154 0.556306 12.144 0.713449 12.144H3.82059V15.2868C3.82059 15.444 3.94916 15.5725 4.10631 15.5725H4.96345C5.12059 15.5725 5.24916 15.444 5.24916 15.2868V11.2868C5.24916 10.9708 4.99381 10.7154 4.67773 10.7154ZM4.96345 0.429688H4.10631C3.94916 0.429688 3.82059 0.558259 3.82059 0.715402V3.85826H0.713449C0.556306 3.85826 0.427734 3.98683 0.427734 4.14397V5.00112C0.427734 5.15826 0.556306 5.28683 0.713449 5.28683H4.67773C4.99381 5.28683 5.24916 5.03147 5.24916 4.7154V0.715402C5.24916 0.558259 5.12059 0.429688 4.96345 0.429688ZM15.2849 10.7154H11.3206C11.0045 10.7154 10.7492 10.9708 10.7492 11.2868V15.2868C10.7492 15.444 10.8777 15.5725 11.0349 15.5725H11.892C12.0492 15.5725 12.1777 15.444 12.1777 15.2868V12.144H15.2849C15.442 12.144 15.5706 12.0154 15.5706 11.8583V11.0011C15.5706 10.844 15.442 10.7154 15.2849 10.7154ZM15.2849 3.85826H12.1777V0.715402C12.1777 0.558259 12.0492 0.429688 11.892 0.429688H11.0349C10.8777 0.429688 10.7492 0.558259 10.7492 0.715402V4.7154C10.7492 5.03147 11.0045 5.28683 11.3206 5.28683H15.2849C15.442 5.28683 15.5706 5.15826 15.5706 5.00112V4.14397C15.5706 3.98683 15.442 3.85826 15.2849 3.85826Z"
				/>
			</g>
		</svg>`],["washroom-14x14",`<svg viewBox="0 0 14 14" stroke="none">
			<path d="M4.55125 3.09062C4.55125 3.69326 4.07639 4.18176 3.49058 4.18176C2.90525 4.18176 2.43039 3.69326 2.43039 3.09062C2.43039 2.4885 2.90525 2 3.49058 2C4.07639 2 4.55125 2.4885 4.55125 3.09062Z" />
			<path d="M5.1193 5.48047C4.81653 4.83116 4.17252 4.41571 3.47822 4.41571C2.78392 4.41571 2.13986 4.83116 1.83714 5.48047L1.04175 7.22034C0.940664 7.441 1.02893 7.70073 1.24393 7.81791C1.47077 7.90871 1.72324 7.81791 1.82433 7.59725L2.49349 6.15554L2.21587 11.4407C2.20305 11.7263 2.41805 11.9734 2.69567 11.9993C2.97329 12.0124 3.21344 11.7913 3.23859 11.5057L3.4028 8.285H3.567L3.73121 11.5057C3.74403 11.7913 3.97086 11.9993 4.23616 11.9993H4.26131C4.53893 11.9861 4.75343 11.7395 4.74111 11.4407L4.46349 6.15554L5.13265 7.59725C5.20858 7.75298 5.35997 7.85697 5.52418 7.85697C5.5873 7.85697 5.65042 7.84379 5.71354 7.81792C5.92804 7.71393 6.0163 7.44153 5.91572 7.22035L5.1193 5.48047Z" />
			<path d="M12.9582 7.22034L12.1505 5.48047C11.8477 4.83116 11.2037 4.41571 10.5094 4.41571C9.81513 4.41571 9.17107 4.83116 8.86836 5.48047L8.06064 7.22034C7.95955 7.441 8.04782 7.70073 8.26282 7.81791C8.47732 7.9219 8.7298 7.8311 8.84371 7.60993L9.52519 6.12977L9.46207 7.2204L8.57842 8.92184C8.47733 9.11663 8.61638 9.36316 8.83089 9.36316H9.33584L9.22242 11.4668C9.2096 11.7397 9.41177 11.9862 9.68939 11.9994C9.95469 12.0126 10.1943 11.8046 10.2072 11.519L10.3581 9.33723H10.6737L10.7871 11.5058C10.7999 11.7787 11.0144 11.9862 11.2792 11.9862H11.3043C11.5696 11.973 11.7841 11.7396 11.7713 11.4535L11.6579 9.33718H12.1628C12.3773 9.33718 12.5287 9.09066 12.4153 8.89586L11.5317 7.19442L11.4685 6.1038L12.1757 7.5972C12.2516 7.75293 12.403 7.85692 12.5672 7.85692C12.6303 7.85692 12.6934 7.84373 12.7566 7.81786C12.9711 7.70068 13.0593 7.44102 12.9582 7.22034Z" />
			<path d="M11.5696 3.09062C11.5696 3.69326 11.0948 4.18176 10.5094 4.18176C9.92363 4.18176 9.44876 3.69326 9.44876 3.09062C9.44876 2.4885 9.92363 2 10.5094 2C11.0948 2 11.5696 2.4885 11.5696 3.09062Z" />
			<path d="M6.99996 2.00006C6.76031 2.00006 6.57095 2.19485 6.57095 2.44138V11.5575C6.57095 11.804 6.76031 11.9988 6.99996 11.9988C7.2396 11.9988 7.42896 11.804 7.42896 11.5575V2.44138C7.42896 2.19485 7.2396 2.00006 6.99996 2.00006Z" />
		</svg>`],["point-of-interest-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<path
				stroke="none"
				id="Subtract"
				// Do not change these to fillRule or clipRule, since they need to be rendered as actual SVGs in labels, not React SVGs
				fill-rule="evenodd"
				clip-rule="evenodd"
				d="M6.24724 10.7516C7.94597 9.0358 9.85962 6.89195 9.85962 4.85965C9.85962 2.72802 8.13159 1 5.99997 1C3.86834 1 2.14032 2.72802 2.14032 4.85965C2.14032 6.89195 4.05397 9.0358 5.7527 10.7516C5.88904 10.8893 6.1109 10.8893 6.24724 10.7516ZM5.99994 6.26317C6.77508 6.26317 7.40345 5.6348 7.40345 4.85967C7.40345 4.08453 6.77508 3.45616 5.99994 3.45616C5.22481 3.45616 4.59644 4.08453 4.59644 4.85967C4.59644 5.6348 5.22481 6.26317 5.99994 6.26317Z"
			/>
		</svg>`],["flag-20x20",`<svg viewBox="0 0 20 20" stroke="none">
			<path
				d="M16.9987 4.27111C16.936 5.06715 16.3836 5.93162 15.5238 6.57845C14.7549 7.15682 13.0885 8.04927 10.5434 7.55174C8.32167 7.1164 6.82156 8.02129 6.08085 10.2416L8.24615 17.3998C8.31833 17.6471 8.17711 17.9059 7.9292 17.9813C7.88527 17.9938 7.83976 18 7.79426 18C7.58634 18 7.40277 17.8647 7.34236 17.6673L5.1644 10.4686C5.13773 10.4173 5.12125 10.3613 5.11419 10.3038L3.41956 4.70042C3.38112 4.63512 3.35994 4.56127 3.3568 4.48587L3.02101 3.37886C2.98413 3.25992 2.9959 3.13165 3.05553 3.02203C3.11437 2.91242 3.21479 2.83079 3.33482 2.79504C3.45564 2.75928 3.5851 2.7725 3.69494 2.83235C3.80477 2.89144 3.88637 2.99172 3.92167 3.11143L3.9813 3.31355C4.38847 2.85956 4.90472 2.51439 5.48136 2.30915C6.97201 1.75566 8.95216 1.95467 10.6469 2.83156C11.6888 3.36951 14.3374 4.54493 16.3647 3.79553C16.5154 3.74111 16.684 3.76599 16.8127 3.86239C16.9406 3.95879 17.0105 4.11251 16.9987 4.27111Z"
				stroke="none"
			/>
		</svg>`],["link-16x16",`<svg viewBox="0 0 16 16" stroke="none">
			<path
				d="M9.10678 11.2433C9.07993 11.2167 9.04367 11.2018 9.00589 11.2018C8.9681 11.2018 8.93184 11.2167 8.90499 11.2433L6.82999 13.3183C5.86928 14.279 4.24785 14.3808 3.18714 13.3183C2.12464 12.2558 2.22642 10.6362 3.18714 9.67546L5.26214 7.60046C5.31749 7.5451 5.31749 7.45403 5.26214 7.39868L4.55142 6.68796C4.52457 6.66138 4.48832 6.64646 4.45053 6.64646C4.41274 6.64646 4.37649 6.66138 4.34964 6.68796L2.27464 8.76296C0.763923 10.2737 0.763923 12.7183 2.27464 14.2272C3.78535 15.7362 6.22999 15.738 7.73892 14.2272L9.81392 12.1522C9.86928 12.0969 9.86928 12.0058 9.81392 11.9505L9.10678 11.2433ZM13.7246 2.77903C12.2139 1.26832 9.76928 1.26832 8.26035 2.77903L6.18357 4.85403C6.15698 4.88088 6.14207 4.91714 6.14207 4.95493C6.14207 4.99271 6.15698 5.02897 6.18357 5.05582L6.89249 5.76475C6.94785 5.8201 7.03892 5.8201 7.09428 5.76475L9.16928 3.68975C10.13 2.72903 11.7514 2.62725 12.8121 3.68975C13.8746 4.75225 13.7729 6.37189 12.8121 7.3326L10.7371 9.4076C10.7106 9.43445 10.6956 9.47071 10.6956 9.5085C10.6956 9.54628 10.7106 9.58254 10.7371 9.60939L11.4479 10.3201C11.5032 10.3755 11.5943 10.3755 11.6496 10.3201L13.7246 8.2451C15.2336 6.73439 15.2336 4.28975 13.7246 2.77903ZM9.75142 6.00939C9.72457 5.9828 9.68832 5.96789 9.65053 5.96789C9.61275 5.96789 9.57649 5.9828 9.54964 6.00939L5.50499 10.0522C5.47841 10.0791 5.46349 10.1154 5.46349 10.1531C5.46349 10.1909 5.47841 10.2272 5.50499 10.254L6.21214 10.9612C6.26749 11.0165 6.35857 11.0165 6.41392 10.9612L10.4568 6.91832C10.5121 6.86296 10.5121 6.77189 10.4568 6.71653L9.75142 6.00939Z"
				stroke="none"
			/>
		</svg>`]]),R3e=/<svg([^>]*)>/g;function Vse(i,e,t){let n=k3e.get(i);return n?n.replace(R3e,'<svg$1 style="fill:'.concat(e,"; width:").concat(t,"px; height:").concat(t,'px">')):""}l(Vse,"getStyledIcon");var O3e=l(i=>`
		<div class="pin-shadow" style="background: `.concat(i,`"></div>
		<svg width="`).concat(20*.9,'px" height="').concat(48*.9,`px" viewBox="0 0 20 48">
			<path
				d="M1.37965 29.3246C1.5778 31.2167 2.27661 33.0694 3.83078 33.775C4.0998 37.1861 4.7451 40.2227 5.65918 42.4784C6.14556 43.6787 6.72883 44.71 7.41453 45.4578C8.10027 46.2056 8.97065 46.7527 9.99989 46.7527C11.0292 46.7527 11.8995 46.2055 12.585 45.4576C13.2706 44.7098 13.8536 43.6785 14.3398 42.4783C15.2536 40.2226 15.8988 37.186 16.1688 33.7752C17.7232 33.0697 18.422 31.2169 18.6201 29.3247C18.8386 27.2385 18.5165 24.6502 17.6475 22.0285L17.6473 22.0278C16.9657 19.9761 16.0319 18.1622 14.9848 16.7474C17.0884 15.1587 18.4471 12.5964 18.4471 9.7152C18.4471 4.93539 14.6967 1 9.99966 1C5.30272 1 1.54993 4.93527 1.54993 9.7152C1.54993 12.5961 2.90839 15.1583 5.01167 16.747C3.9635 18.1625 3.03185 19.977 2.3522 22.0286C1.48319 24.6503 1.16118 27.2385 1.37965 29.3246Z"
				fill="`).concat(i,`"
				stroke="white"
				strokeWidth="2"
			/>
		</svg>
	`),"getDeparturePin"),N3e=l(i=>`
		<div class="pin-shadow" style="background: `.concat(i,`"></div>
		<svg width="36" height="42" viewBox="-2 -2 40 46">
			<path
				d="M35.8372 5.86776C35.6765 7.92448 34.2625 10.158 32.0612 11.8292C30.0929 13.3235 25.8269 15.6292 19.3114 14.3438C13.6237 13.219 9.78333 15.5569 7.88708 21.2934L13.4303 39.7879C13.6151 40.4267 13.2536 41.0955 12.6189 41.2903C12.5064 41.3225 12.39 41.3385 12.2735 41.3385C11.7412 41.3385 11.2712 40.989 11.1166 40.4789L5.54093 21.88C5.47265 21.7474 5.43047 21.6028 5.41239 21.4542L1.07409 6.97696C0.975678 6.80825 0.921449 6.61744 0.913417 6.42263L0.053779 3.56251C-0.0406172 3.2552 -0.0104927 2.92379 0.142154 2.64058C0.29279 2.35738 0.549874 2.14649 0.857157 2.05411C1.16646 1.96172 1.49786 1.99587 1.77906 2.15052C2.06025 2.30317 2.26912 2.56226 2.35951 2.87155L2.51215 3.39375C3.55453 2.22081 4.87615 1.32902 6.35237 0.798742C10.1685 -0.631292 15.2377 -0.117113 19.5763 2.14846C22.2435 3.53834 29.0241 6.57524 34.2141 4.63904C34.5998 4.49845 35.0316 4.56272 35.361 4.81178C35.6884 5.06083 35.8673 5.45801 35.8372 5.86776Z"
				fill="none"
				stroke="white"
				strokeWidth="4"
			/>
			<path
				d="M35.8372 5.86776C35.6765 7.92448 34.2625 10.158 32.0612 11.8292C30.0929 13.3235 25.8269 15.6292 19.3114 14.3438C13.6237 13.219 9.78333 15.5569 7.88708 21.2934L13.4303 39.7879C13.6151 40.4267 13.2536 41.0955 12.6189 41.2903C12.5064 41.3225 12.39 41.3385 12.2735 41.3385C11.7412 41.3385 11.2712 40.989 11.1166 40.4789L5.54093 21.88C5.47265 21.7474 5.43047 21.6028 5.41239 21.4542L1.07409 6.97696C0.975678 6.80825 0.921449 6.61744 0.913417 6.42263L0.053779 3.56251C-0.0406172 3.2552 -0.0104927 2.92379 0.142154 2.64058C0.29279 2.35738 0.549874 2.14649 0.857157 2.05411C1.16646 1.96172 1.49786 1.99587 1.77906 2.15052C2.06025 2.30317 2.26912 2.56226 2.35951 2.87155L2.51215 3.39375C3.55453 2.22081 4.87615 1.32902 6.35237 0.798742C10.1685 -0.631292 15.2377 -0.117113 19.5763 2.14846C22.2435 3.53834 29.0241 6.57524 34.2141 4.63904C34.5998 4.49845 35.0316 4.56272 35.361 4.81178C35.6884 5.06083 35.8673 5.45801 35.8372 5.86776Z"
				fill="`).concat(i,`"
			/>
		</svg>
    `),"getDestinationPin"),jse="#722ED1",Gse="#1890FF",F3e=l(({type:i="departure",color:e=Gse})=>`<div class="dropped-pin-wrapper">
			`.concat(i==="departure"?O3e(e):N3e(e),`
		</div>`),"DroppedPin"),B3e=l(i=>{switch(i){case"default":return 28;case"selection":return 28;case"navigation":return 32}},"getSize"),z3e=l(({type:i="stairs",color:e=jse,direction:t="up"})=>{let n=B3e("default"),r=n/2+2,a=t&&t!=="none";return`<div class="mappedin-connection-marker">
			<div class="connection-circle"
				role="button"
                style="background:`.concat(e,"; width:").concat(n,"px; height:").concat(n,`px;"
			>
                `).concat(Vse("connection-"+i+"-16x16","white",r)||"",`
			</div>
			`).concat(a?'<div style="margin-left: -'.concat(n*.2,`px;">
					<div class="bouncey">
						<div class="connection-circle"
							role="button"
							style="width: `).concat(n,"px; height: ").concat(n,`px;">
							<div class="`).concat(t==="up"?"":"arrow--down",`">
                                <svg viewBox="0 0 16 16" style="fill: white; width: `).concat(r,"px; height: ").concat(r,`px">
                                    <path
                                        fillRule="evenodd"
                                        clipRule="evenodd"
                                        d="M8.00015 0.5C8.34685 0.5 8.67835 0.642318 8.91714 0.893677L15.6517 7.98267C15.8441 8.18525 15.8359 8.50548 15.6333 8.69793L14.533 9.7433C14.3304 9.93575 14.0101 9.92754 13.8177 9.72496L9.26497 4.93262V15.4249C9.26497 15.7043 9.03846 15.9308 8.75904 15.9308H7.24125C6.96184 15.9308 6.73532 15.7043 6.73532 15.4249V4.93262L2.1826 9.72496C1.99015 9.92754 1.66992 9.93575 1.46734 9.7433L0.366945 8.69793C0.164367 8.50548 0.156156 8.18525 0.348604 7.98267L7.08315 0.893677C7.32194 0.642318 7.65344 0.5 8.00015 0.5Z"
                                        stroke="none"
                                    />
                                </svg>
							</div>
						</div>
					</div>
				</div>`):"",`
		</div>`)},"ConnectionMarker");R();var U3e=l(async i=>new Promise(e=>setTimeout(e,i)),"ms"),V3e={drawDuration:1e3,color:"#40A9FF",interactive:!1,accentColor:"blue",nearRadius:.25,farRadius:.25*4,displayArrowsOnPath:!1,animateArrowsOnPath:!1},j3e={drawDuration:1e3,color:"#B3DDFF",interactive:!1,accentColor:"#40A9FF",nearRadius:.25,farRadius:.25*4,displayArrowsOnPath:!1,animateArrowsOnPath:!1},rc={setMapOnConnectionClick:!0,setMapToDeparture:!0,createMarkers:{departure:!0,destination:!0,connection:!0},pathOptions:V3e,inactivePathOptions:j3e,markerOptions:{departureColor:Gse,destinationColor:jse},animatePathDrawing:!0},wc,Zl,cl,In,Qb,Ac,em,ca,Hl,ss,pl,Wp,pa,p8,$se,$T,Zv,e2,Lm,HT,Yv,Hse=class{constructor(e,t,n){ge(this,pa),ge(this,wc,new Map),ge(this,Zl),ge(this,cl),ge(this,In,rc),ge(this,Qb),ge(this,Ac),ge(this,em),ge(this,ca,[]),ge(this,Hl),ge(this,ss,new Map),ge(this,pl,new Map),ge(this,Wp,new Map),ge(this,Yv,l(r=>{var a;if((a=y(this,In).createMarkers)!=null&&a.connection&&r.markers.length>0){let{instruction:o}=y(this,wc).get(r.markers[0]);o!=null&&o.action.toFloor&&(y(this,In).setMapOnConnectionClick&&this.currentMap.setFloor(o.action.toFloor.id,"navigation-connection-click"),y(this,cl).publish("navigation-connection-click",{instruction:o,fromFloor:o.action.fromFloor,toFloor:o.action.toFloor}))}},"#handleClick")),Ce(this,Zl,e),Ce(this,Qb,n),Ce(this,cl,t)}get currentMap(){return y(this,Qb).call(this)}get isMultiFloor(){if(!y(this,ca).length)return!1;let e=new Set;for(let t of y(this,ca))for(let n of t.coordinates)if(n.floorId&&(e.add(n.floorId),e.size>1))return!0;return!1}getPathById(e){return y(this,ss).get(e)}getMarkerById(e){return y(this,wc).get(e)}get paths(){let e=new Set;return y(this,ss).forEach(({path:t})=>e.add(t)),Array.from(e)}get activeDirections(){return y(this,Wp).get(y(this,Hl))}get activePath(){var e;if(y(this,Hl))return(e=y(this,ss).get(y(this,Hl).id))==null?void 0:e.path}get floorStacks(){let e=y(this,cl).getMapData();if(!y(this,ca).length||!e)return[];let t=new Set;for(let n of y(this,ca))for(let r of n.coordinates)if(r.floorId){let a=e.getById("floor",r.floorId);a&&t.add(a.floorStack)}return Array.from(t)}get floors(){let e=y(this,cl).getMapData();if(!y(this,ca).length||!e)return[];let t=new Set;for(let n of y(this,ca))for(let r of n.coordinates)if(r.floorId){let a=e.getById("floor",r.floorId);a&&t.add(a)}return Array.from(t)}setActivePathByIndex(e){let t=y(this,ca)[e];if(!y(this,ca).length){nt.warn("Cannot set an active path before drawing. Call Navigation.draw() first.");return}if(!y(this,ca)[e]){nt.warn("Direction #".concat(e," does not exist"));return}let n=y(this,pl).get(t);if(!n){nt.warn("The direction is not a part of muli-direcional path");return}St(this,pa,e2).call(this,n)}setActivePath(e){if(!y(this,ca).length){nt.warn("Cannot set an active path before drawing. Call Navigation.draw() first.");return}if(!y(this,Wp).get(e)){nt.warn('Path "'.concat(e.id,'" is not a part of muli-direcional path'));return}St(this,pa,e2).call(this,e)}setActivePathByDirections(e){if(!y(this,ca).length){nt.warn("[setActivePathByDirections] Cannot set an active path before drawing. Call Navigation.draw() first.");return}let t=y(this,pl).get(e);if(!t){let n=y(this,ca).find(r=>r.id===e.id);if(!n){nt.warn("[setActivePathByDirections] Cannot find directions for id");return}t=y(this,pl).get(n)}if(!t){nt.warn("[setActivePathByDirections] Cannot find path for directions");return}St(this,pa,e2).call(this,t)}drawSync(e,t={}){var n,r,a;y(this,em)&&this.clear(),Ce(this,em,!0),St(this,pa,$T).call(this,t);let o=Array.isArray(e)?e:[e],s=o[0],u=o[o.length-1],h=s.coordinates[0];Ce(this,ca,o),h.floorId&&y(this,In).setMapToDeparture&&this.currentMap.setFloor(h.floorId),(n=y(this,In).createMarkers)!=null&&n.departure&&St(this,pa,Lm).call(this,s.coordinates[0],"departure",s.instructions[0]);for(let d=0;d<o.length;d++){let f=o[d],m=d?Me({},y(this,In).inactivePathOptions):Me({},y(this,In).pathOptions);if(f.coordinates.length<2){nt.warn("Directions must have at least 2 coordinates");return}let v=this.currentMap.Paths.add(f.coordinates,lt(Me({},m),{animateDrawing:y(this,In).animatePathDrawing})),b=v.paths.map(A=>A.id.toString()),w=new j1(Hn(),v.animation,f.coordinates,v.paths);for(let A of b){y(this,ss).set(A,{path:w,entityIds:b});let E=d?lt(Me({},y(this,In).inactivePathOptions),{altitude:0}):lt(Me({},y(this,In).pathOptions),{altitude:.05});y(this,Zl).setState(A,E)}y(this,ss).set(w.id,{path:w,entityIds:b}),y(this,pl).set(f,w),y(this,Wp).set(w,f),(r=y(this,In).createMarkers)!=null&&r.connection&&St(this,pa,HT).call(this,f.instructions,"connection"),d===0&&(Ce(this,Hl,y(this,pl).get(y(this,ca)[0])),y(this,Zl).on("click",y(this,Yv)))}(a=y(this,In).createMarkers)!=null&&a.destination&&St(this,pa,Lm).call(this,u.coordinates[u.coordinates.length-1],"destination",u.instructions[u.instructions.length-1]),y(this,cl).mapObjects.forEach(d=>{d.processFloorChange(d.currentFloorId)}),St(this,pa,Zv).call(this)}async draw(e,t={}){y(this,Ac)&&this.clear(),St(this,pa,$T).call(this,t);let n=Array.isArray(e)?e:[e],r=n[0].coordinates[0];return Ce(this,ca,n),r.floorId&&y(this,In).setMapToDeparture&&this.currentMap.setFloor(r.floorId),St(this,pa,$se).call(this,n)}clear(){y(this,wc).forEach((e,t)=>{this.currentMap.Markers.remove(t.toString())}),y(this,wc).clear(),y(this,ss).forEach(({path:e,entityIds:t})=>{y(this,ss).delete(e.id),t.forEach(n=>y(this,ss).delete(n)),this.currentMap.Paths.remove(t)}),y(this,Ac)&&(y(this,Ac).cancel(),Ce(this,Ac,void 0)),y(this,em)&&Ce(this,em,!1),Ce(this,ca,[]),y(this,pl).clear(),y(this,Wp).clear(),Ce(this,Hl,void 0),y(this,Zl).off("click",y(this,Yv)),y(this,cl).mapObjects.forEach(e=>{e.processFloorChange(e.currentFloorId)}),St(this,pa,Zv).call(this)}};wc=new WeakMap,Zl=new WeakMap,cl=new WeakMap,In=new WeakMap,Qb=new WeakMap,Ac=new WeakMap,em=new WeakMap,ca=new WeakMap,Hl=new WeakMap,ss=new WeakMap,pl=new WeakMap,Wp=new WeakMap,pa=new WeakSet,p8=l(function(i){return i!=null&&["TakeConnection","ExitConnection","TakeVortex","ExitVortex"].includes(i.type)},"#isVortexAction"),$se=l(function(i){let e=i[0],t=i[i.length-1],n=!1;return Ce(this,Ac,{promise:new Promise(async r=>{var a,o,s;if(mr.env.NODE_ENV!=="test"&&await U3e(500),n||!i.length){r();return}(a=y(this,In).createMarkers)!=null&&a.departure&&St(this,pa,Lm).call(this,e.coordinates[0],"departure",e.instructions[0]);for(let u=0;u<i.length;u++){let h=i[u],d=u?Me({},y(this,In).inactivePathOptions):Me({},y(this,In).pathOptions);if(h.coordinates.length<2){nt.warn("Directions must have at least 2 coordinates"),r();return}let f=this.currentMap.Paths.add(h.coordinates,lt(Me({},d),{animateDrawing:y(this,In).animatePathDrawing})),m=f.paths.map(b=>b.id.toString()),v=new j1(Hn(),f.animation,h.coordinates,f.paths);for(let b of m){y(this,ss).set(b,{path:v,entityIds:m});let w=u?lt(Me({},y(this,In).inactivePathOptions),{altitude:0}):lt(Me({},y(this,In).pathOptions),{altitude:.05});y(this,Zl).setState(b,w)}if(y(this,ss).set(v.id,{path:v,entityIds:m}),y(this,pl).set(h,v),y(this,Wp).set(v,h),mr.env.NODE_ENV!=="test"&&await f.animation,n){r();return}(o=y(this,In).createMarkers)!=null&&o.connection&&St(this,pa,HT).call(this,h.instructions,"connection"),u===0&&(Ce(this,Hl,y(this,pl).get(y(this,ca)[0])),y(this,Zl).on("click",y(this,Yv)))}if((s=y(this,In).createMarkers)!=null&&s.destination&&St(this,pa,Lm).call(this,t.coordinates[t.coordinates.length-1],"destination",t.instructions[t.instructions.length-1]),n){r();return}y(this,cl).mapObjects.forEach(u=>{u.processFloorChange(u.currentFloorId)}),St(this,pa,Zv).call(this),r()}),cancel:l(()=>{n=!0},"cancel")}),y(this,Ac).promise},"#drawAsync"),$T=l(function(i){var e,t,n;Ce(this,In,{setMapOnConnectionClick:(e=i.setMapOnConnectionClick)!=null?e:rc.setMapOnConnectionClick,setMapToDeparture:(t=i.setMapToDeparture)!=null?t:rc.setMapToDeparture,pathOptions:Me(Me({},rc.pathOptions),i.pathOptions),inactivePathOptions:Me(Me({},rc.inactivePathOptions),i.inactivePathOptions),createMarkers:Me(Me({},rc.createMarkers),i.createMarkers),markerOptions:Me(Me({},rc.markerOptions),i.markerOptions),animatePathDrawing:(n=i.animatePathDrawing)!=null?n:rc.animatePathDrawing})},"#setupOptions"),Zv=l(function(){y(this,cl).publish("navigation-state-change",{isMultiFloor:this.isMultiFloor,floorStacks:this.floorStacks,floors:this.floors,activeDirections:this.activeDirections,activePath:this.activePath,paths:this.paths})},"#emitNavigationStateChanged"),e2=l(function(i){Ce(this,Hl,i),y(this,ca).forEach(e=>{let t=y(this,pl).get(e);if(t){let n=y(this,ss).get(t.id),r=n.path.id===y(this,Hl).id?lt(Me({},y(this,In).pathOptions),{altitude:.05}):lt(Me({},y(this,In).inactivePathOptions),{altitude:0});n.entityIds.forEach(a=>{y(this,Zl).setState(a,r)})}}),y(this,cl).publish("navigation-active-path-change",{directions:this.activeDirections,path:this.activePath}),St(this,pa,Zv).call(this)},"#setActiveDirections"),Lm=l(function(i,e,t){var n,r,a,o,s;if(e==="connection"&&t){let u=t.action.type==="ExitConnection"?y(this,In).markerOptions.departureColor:y(this,In).markerOptions.destinationColor,h;if(typeof((n=y(this,In).createMarkers)==null?void 0:n.connection)=="function"){let f=y(this,In).createMarkers.connection(t);y(this,Zl).setState(f.id.toString(),{options:{interactive:!0}}),h={id:f.id,type:"marker"}}else h=this.currentMap.Markers.add(t.coordinate,z3e({type:(a=(r=t.action.connection)==null?void 0:r.type)!=null?a:t.action.connectionType,color:u,direction:t.action.direction}),{interactive:!0,anchor:"top",rank:"always-visible"});let d=this.currentMap.Markers.getContentEl(h.id.toString());if(!d)throw new Error("marker component should exist");y(this,wc).set(h.id,{instruction:t,marker:new QD(h.id.toString(),d,t.coordinate)})}else{let u=e==="departure"?y(this,In).markerOptions.departureColor:y(this,In).markerOptions.destinationColor,h;typeof((o=y(this,In).createMarkers)==null?void 0:o.departure)=="function"&&e==="departure"?h={id:y(this,In).createMarkers.departure(t).id,type:"marker"}:typeof((s=y(this,In).createMarkers)==null?void 0:s.destination)=="function"&&e==="destination"?h={id:y(this,In).createMarkers.destination(t).id,type:"marker"}:h=this.currentMap.Markers.add(i,F3e({type:e,color:u}),{anchor:"top",rank:"always-visible"}),y(this,wc).set(h.id,void 0)}},"#addMarker"),HT=l(function(i,e){i.filter(t=>St(this,pa,p8).call(this,t.action)).forEach(t=>{St(this,pa,Lm).call(this,t.coordinate,e,t)})},"#addMarkers"),Yv=new WeakMap,l(Hse,"Navigation");var G3e=Hse;R();R();R();var $3e=new Map([["search-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M1 7C1 3.68629 3.68629 1 7 1C10.3137 1 13 3.68629 13 7C13 8.29583 12.5892 9.49572 11.8907 10.4765L15.4614 14.0472C15.6567 14.2425 15.6567 14.559 15.4614 14.7543L14.7543 15.4614C14.559 15.6567 14.2424 15.6567 14.0472 15.4614L10.4765 11.8907C9.49571 12.5892 8.29583 13 7 13C3.68629 13 1 10.3137 1 7ZM7 11C4.79086 11 3 9.20914 3 7C3 4.79086 4.79086 3 7 3C9.20914 3 11 4.79086 11 7C11 9.20914 9.20914 11 7 11Z"
				stroke="none"
			/>
		</svg>`],["close-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M12.5963 1.98959C12.7916 1.79433 13.1082 1.79433 13.3034 1.98959L14.0105 2.6967C14.2058 2.89196 14.2058 3.20855 14.0105 3.40381L3.40392 14.0104C3.20866 14.2057 2.89208 14.2057 2.69682 14.0104L1.98971 13.3033C1.79445 13.108 1.79445 12.7915 1.98971 12.5962L12.5963 1.98959Z"
				stroke="none"
			/>
			<path
				d="M1.98971 3.40381C1.79445 3.20855 1.79445 2.89196 1.98971 2.6967L2.69682 1.98959C2.89208 1.79433 3.20866 1.79433 3.40392 1.98959L14.0105 12.5962C14.2058 12.7915 14.2058 13.108 14.0105 13.3033L13.3034 14.0104C13.1082 14.2057 12.7916 14.2057 12.5963 14.0104L1.98971 3.40381Z"
				stroke="none"
			/>
		</svg>`],["empty-64x40",`<svg viewBox="0 0 64 40">
			<g>
				<g clipPath="url(#clip0_499_175492)">
					<path
						d="M32 39.7032C49.6731 39.7032 64 36.5925 64 32.7552C64 28.9179 49.6731 25.8071 32 25.8071C14.3269 25.8071 0 28.9179 0 32.7552C0 36.5925 14.3269 39.7032 32 39.7032Z"
						stroke="none"
						fill="#F5F5F5"
					/>
					<path
						d="M55 13.6653L44.854 2.24866C44.367 1.47048 43.656 1 42.907 1H21.093C20.344 1 19.633 1.47048 19.146 2.24767L9 13.6663V22.8367H55V13.6653Z"
						fill="none"
					/>
					<path
						d="M41.613 16.8128C41.613 15.2197 42.607 13.9046 43.84 13.9036H55V31.9059C55 34.0132 53.68 35.7402 52.05 35.7402H11.95C10.32 35.7402 9 34.0122 9 31.9059V13.9036H20.16C21.393 13.9036 22.387 15.2167 22.387 16.8098V16.8317C22.387 18.4248 23.392 19.7111 24.624 19.7111H39.376C40.608 19.7111 41.613 18.4128 41.613 16.8198V16.8128Z"
						fill="#FAFAFA"
					/>
				</g>
				<defs>
					<clipPath id="clip0_499_175492">
						<rect width="64" height="40" fill="white" />
					</clipPath>
				</defs>
			</g>
		</svg>`],["caret-12x12",`<svg viewBox="0 0 12 12">
			<path
				stroke="none"
				d="M8.38828 5.78337L3.92578 1.93493C3.75938 1.79196 3.51562 1.92087 3.51562 2.15173V9.84861C3.51562 10.0795 3.75938 10.2084 3.92578 10.0654L8.38828 6.21696C8.51602 6.10681 8.51602 5.89353 8.38828 5.78337Z"
			/>
		</svg>`],["plus-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M7.5 1C7.22386 1 7 1.22386 7 1.5V7H1.5C1.22386 7 1 7.22386 1 7.5L1 8.5C1 8.77614 1.22386 9 1.5 9H7V14.5C7 14.7761 7.22386 15 7.5 15H8.5C8.77614 15 9 14.7761 9 14.5V9H14.5C14.7761 9 15 8.77614 15 8.5V7.5C15 7.22386 14.7761 7 14.5 7H9V1.5C9 1.22386 8.77614 1 8.5 1H7.5Z"
				stroke="none"
			/>
		</svg>`],["recenter-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M0 2.5C0 2.22386 0.223858 2 0.5 2H1.5C1.77614 2 2 2.22386 2 2.5V13.5C2 13.7761 1.77614 14 1.5 14H0.5C0.223858 14 0 13.7761 0 13.5V2.5Z" />
				<path
					fillRule="evenodd"
					clipRule="evenodd"
					d="M4.5 4C4.22386 4 4 4.22386 4 4.5V11.5C4 11.7761 4.22386 12 4.5 12H11.5C11.7761 12 12 11.7761 12 11.5V4.5C12 4.22386 11.7761 4 11.5 4H4.5ZM6 6V10H10V6H6Z"
				/>
				<path d="M14.5 2C14.2239 2 14 2.22386 14 2.5V13.5C14 13.7761 14.2239 14 14.5 14H15.5C15.7761 14 16 13.7761 16 13.5V2.5C16 2.22386 15.7761 2 15.5 2H14.5Z" />
			</g>
		</svg>`],["minus-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M1.5 9C1.22386 9 1 8.77614 1 8.5L1 7.5C1 7.22386 1.22386 7 1.5 7L14.5 7C14.7761 7 15 7.22386 15 7.5V8.5C15 8.77614 14.7761 9 14.5 9L1.5 9Z"
				stroke="none"
			/>
		</svg>`],["logo-horizontal-206x48",`<svg viewBox="0 0 206 48">
			<path d="M27.2678 14.2261H22.3187C21.0695 14.2261 20.4695 14.7801 20.4695 15.9852V31.142L10.3966 15.5591C9.69665 14.4784 9.2475 14.2773 7.8475 14.2261H2.97462C1.67462 14.2261 1.07631 14.7801 1.07631 15.9852V44.7665C1.07631 45.9716 1.67462 46.5256 2.97462 46.5256H7.92377C9.22207 46.5256 9.82207 45.9716 9.82207 44.7665V29.6847L19.9441 45.1926C20.695 46.3244 21.095 46.5256 22.4933 46.5256H27.2933C28.5916 46.5256 29.1916 45.9716 29.1916 44.7665V15.9852C29.1407 14.7801 28.5424 14.2261 27.2678 14.2261Z" />
			<path d="M5.44915 10.9602C8.45863 10.9602 10.8983 8.50669 10.8983 5.48011C10.8983 2.45353 8.45863 0 5.44915 0C2.43967 0 0 2.45353 0 5.48011C0 8.50669 2.43967 10.9602 5.44915 10.9602Z" />
			<path d="M61.7899 25.0449C63.2306 23.1903 65.078 22.2051 67.556 22.2051C72.0526 22.2051 74.7611 25.3347 74.7611 29.4511V39.2489C74.8187 39.7125 74.5306 39.9443 74.0695 39.9443H72.5136C72.0526 39.9443 71.7645 39.7125 71.8221 39.2489V29.5091C71.8221 27.1909 69.9187 25.2187 67.4984 25.2187C65.1339 25.2187 63.2323 27.1329 63.2323 29.2773V39.2489C63.2899 39.7125 63.0018 39.9443 62.5407 39.9443H60.9831C60.5221 39.9443 60.2916 39.7125 60.2916 39.2489V29.4511C60.2916 27.1329 58.3899 25.2187 56.0255 25.2187C53.7204 25.2187 51.7594 27.075 51.7594 29.2773V39.3068C51.817 39.7705 51.5289 40.0023 51.0102 40.0023H49.5119C49.0509 40.0023 48.7628 39.7705 48.7628 39.3068V23.25C48.7051 22.7864 48.9933 22.4966 49.5119 22.4966H50.9526C51.356 22.4966 51.5289 22.6704 51.5289 23.0182V24.2352C52.7407 22.9602 54.239 22.2648 56.0255 22.2648C58.4475 22.2068 60.3492 23.192 61.7899 25.0466V25.0449ZM77.1255 31.2477C77.1255 26.3216 81.1018 22.2051 86.1187 22.2051C88.539 22.2051 90.6136 23.1903 92.3441 25.1608V23.1903C92.3441 22.7267 92.5746 22.5528 93.0357 22.5528H94.4187C94.8797 22.5528 95.1102 22.7847 95.1102 23.3062V39.3648C95.1102 39.8284 94.8797 40.0602 94.4187 40.0602H93.0357C92.5746 40.0602 92.3441 39.8284 92.3441 39.4227V37.4523C90.6712 39.3648 88.5967 40.35 86.1746 40.35C81.1018 40.2341 77.1238 36.1773 77.1238 31.2477H77.1255ZM92.1136 31.2477C92.1136 27.8284 89.4611 25.2187 86.0594 25.2187C82.7746 25.2187 80.1221 27.8864 80.1221 31.2477C80.1221 34.6687 82.7746 37.2784 86.1187 37.2784C86.9062 37.2789 87.6861 37.1232 88.4138 36.8202C89.1414 36.5173 89.8026 36.0731 90.3593 35.513C90.9161 34.9528 91.3577 34.2878 91.6587 33.556C91.9597 32.8241 92.1143 32.0397 92.1136 31.2477ZM100.992 37.3943V46.3807C101.049 46.8443 100.761 47.1341 100.298 47.1341H98.7424C98.2814 47.1341 97.9933 46.9023 97.9933 46.3807V23.1903C97.9933 22.7267 98.2238 22.4369 98.7424 22.4369H100.183C100.646 22.379 100.934 22.6687 100.934 23.0744V24.9869C102.605 23.0744 104.68 22.1472 107.044 22.1472C112.002 22.1472 116.037 26.2619 116.037 31.1898C116.037 36.1176 112.059 40.2341 107.044 40.2341C104.622 40.2341 102.603 39.3068 100.992 37.3943ZM106.987 25.2187C103.7 25.2187 101.049 27.8864 101.049 31.2477C101.049 34.6687 103.7 37.2784 107.044 37.2784C110.446 37.2784 113.039 34.6108 113.039 31.2477C113.039 27.8864 110.388 25.2187 106.987 25.2187ZM121.11 37.3943V46.3807C121.168 46.8443 120.88 47.1341 120.419 47.1341H118.861C118.4 47.1341 118.112 46.9023 118.112 46.3807V23.1903C118.112 22.7267 118.342 22.4369 118.861 22.4369H120.302C120.764 22.379 121.053 22.6687 121.053 23.0744V24.9869C122.724 23.0744 124.798 22.1472 127.163 22.1472C132.12 22.1472 136.156 26.2619 136.156 31.1898C136.156 36.1176 132.178 40.2341 127.163 40.2341C124.742 40.2341 122.781 39.3068 121.11 37.3943ZM127.105 25.2187C123.819 25.2187 121.168 27.8864 121.168 31.2477C121.168 34.6687 123.819 37.2784 127.163 37.2784C130.564 37.2784 133.158 34.6108 133.158 31.2477C133.158 27.8864 130.507 25.2187 127.107 25.2187H127.105ZM153.97 32.3506H141.054C141.342 35.2483 143.995 37.4523 147.164 37.4523C148.893 37.4523 150.393 37.0466 151.719 36.0597C152.007 35.8858 152.295 35.7699 152.353 35.7699C152.583 35.7699 152.756 35.8858 152.929 36.1773L153.505 37.1625C153.622 37.3364 153.68 37.4523 153.68 37.5682C153.68 37.8 153.507 38.0318 153.103 38.3216C151.258 39.5966 149.183 40.292 146.992 40.292C141.688 40.292 137.883 36.3511 137.883 31.2477C137.883 26.204 141.803 22.2051 146.703 22.2051C151.546 22.2051 154.717 25.7983 154.717 31.0176C154.717 31.5972 154.717 32.3506 153.968 32.3506H153.97ZM141.056 30.0324H151.72C151.432 26.8432 149.473 24.929 146.648 24.929C145.241 24.8904 143.875 25.3995 142.833 26.3501C141.791 27.3007 141.154 28.6194 141.056 30.0307V30.0324ZM156.332 31.2477C156.332 26.3216 160.31 22.2051 165.326 22.2051C167.748 22.2051 169.707 23.1324 171.32 25.0449V16.2324C171.263 15.7687 171.551 15.479 172.012 15.479H173.57C174.031 15.479 174.319 15.7108 174.319 16.2324V39.3068C174.319 39.7705 174.088 40.0023 173.57 40.0023H172.129C171.666 40.0602 171.378 39.7705 171.378 39.3648V37.3943C169.649 39.3068 167.632 40.292 165.268 40.292C160.31 40.2341 156.332 36.1773 156.332 31.2477ZM171.264 31.2477C171.264 27.8284 168.612 25.2187 165.21 25.2187C161.924 25.2187 159.273 27.8864 159.273 31.2477C159.273 34.6687 161.924 37.2784 165.268 37.2784C166.057 37.2838 166.839 37.1316 167.569 36.8304C168.299 36.5292 168.962 36.0852 169.52 35.5241C170.077 34.963 170.519 34.296 170.818 33.5619C171.117 32.8277 171.268 32.0411 171.263 31.2477H171.264ZM177.72 19.0739C177.715 18.8594 177.754 18.646 177.833 18.4468C177.912 18.2476 178.031 18.0667 178.182 17.915C178.333 17.7633 178.512 17.6439 178.71 17.5642C178.909 17.4845 179.121 17.446 179.334 17.4511C179.546 17.4507 179.756 17.4923 179.952 17.5737C180.148 17.6551 180.326 17.7746 180.476 17.9254C180.626 18.0762 180.745 18.2553 180.826 18.4523C180.907 18.6494 180.948 18.8606 180.948 19.0739C180.953 19.2884 180.914 19.5017 180.835 19.7009C180.756 19.9001 180.637 20.081 180.486 20.2327C180.335 20.3845 180.156 20.5038 179.957 20.5835C179.759 20.6633 179.547 20.7017 179.334 20.6966C178.412 20.7545 177.72 20.0591 177.72 19.0739ZM177.836 39.2489V23.1903C177.836 22.7267 178.066 22.4369 178.527 22.4369H180.083C180.544 22.4369 180.832 22.6687 180.775 23.1903V39.2489C180.832 39.7125 180.544 39.9443 180.083 39.9443H178.527C178.066 39.9443 177.836 39.7125 177.836 39.2489ZM186.944 23.0165V24.1756C188.212 22.8426 189.71 22.2051 191.497 22.2051C195.937 22.2051 198.646 25.2767 198.646 29.3932V39.2489C198.703 39.7125 198.415 39.9443 197.954 39.9443H196.398C195.936 39.9443 195.705 39.7125 195.705 39.2489V29.4511C195.705 27.1329 193.803 25.2187 191.439 25.2187C189.134 25.2187 187.175 27.075 187.175 29.2773V39.3068C187.232 39.7705 186.944 40.0023 186.424 40.0023H184.868C184.407 40.0023 184.119 39.7705 184.119 39.3068V23.1903C184.061 22.7267 184.349 22.4949 184.868 22.4949H186.309C186.712 22.4949 186.944 22.6687 186.944 23.0165Z" />
			<path d="M204 40C205.115 40 206 39.0857 206 38V37.9886C206 36.9029 205.126 36 204 36C202.885 36 202 36.9143 202 38V38.0114C202 39.0971 202.874 40 204 40ZM204 39.7829C202.989 39.7829 202.23 38.9829 202.23 38.0114V38C202.23 37.0286 203 36.2171 204 36.2171C205.011 36.2171 205.77 37.0171 205.77 37.9886V38C205.77 38.9714 205 39.7829 204 39.7829ZM203.218 38.9714H203.609V38.2743H204.034L204.517 38.9714H204.989L204.448 38.2057C204.724 38.1257 204.92 37.92 204.92 37.5886C204.92 37.1657 204.586 36.9486 204.138 36.9486H203.218V38.9714ZM203.609 37.9543V37.2914H204.103C204.368 37.2914 204.517 37.4057 204.517 37.6229C204.517 37.8171 204.368 37.9543 204.103 37.9543H203.609Z" />
		</svg>`],["share-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M13 6C14.6569 6 16 4.65685 16 3C16 1.34315 14.6569 0 13 0C11.3431 0 10 1.34315 10 3C10 3.13463 10.0089 3.26719 10.0261 3.39712L6.82972 5.17286C6.10576 4.44825 5.10523 4 4 4C1.79086 4 0 5.79086 0 8C0 10.2091 1.79086 12 4 12C5.10523 12 6.10576 11.5518 6.82972 10.8271L10.0261 12.6029C10.0089 12.7328 10 12.8654 10 13C10 14.6569 11.3431 16 13 16C14.6569 16 16 14.6569 16 13C16 11.3431 14.6569 10 13 10C12.2011 10 11.4752 10.3123 10.9376 10.8214L7.84579 9.1037C7.94622 8.75313 8 8.38284 8 8C8 7.61716 7.94622 7.24687 7.84579 6.8963L10.9376 5.17864C11.4752 5.68775 12.2011 6 13 6ZM13 4C13.5523 4 14 3.55228 14 3C14 2.44772 13.5523 2 13 2C12.4477 2 12 2.44772 12 3C12 3.55228 12.4477 4 13 4ZM4 10C5.10457 10 6 9.10457 6 8C6 6.89543 5.10457 6 4 6C2.89543 6 2 6.89543 2 8C2 9.10457 2.89543 10 4 10ZM14 13C14 13.5523 13.5523 14 13 14C12.4477 14 12 13.5523 12 13C12 12.4477 12.4477 12 13 12C13.5523 12 14 12.4477 14 13Z"
				stroke="none"
			/>
		</svg>`],["checkmark-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M15.387 3.31662C15.6008 3.49148 15.6323 3.80649 15.4574 4.02021L6.77402 14.6332C6.58509 14.8642 6.30292 14.9986 6.00457 15C5.70622 15.0013 5.42285 14.8694 5.23184 14.6402L0.551937 9.02429C0.375155 8.81215 0.403817 8.49687 0.615956 8.32009L1.38418 7.67991C1.59632 7.50312 1.9116 7.53179 2.08838 7.74392L5.99299 12.4295L13.9095 2.75374C14.0844 2.54002 14.3994 2.50852 14.6131 2.68338L15.387 3.31662Z"
				stroke="none"
			/>
		</svg>`],["arrow-right-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M8.35355 1.64645C8.54881 1.45118 8.8654 1.45118 9.06066 1.64645L14.7071 7.29289C15.0976 7.68342 15.0976 8.31658 14.7071 8.70711L9.06066 14.3536C8.8654 14.5488 8.54882 14.5488 8.35355 14.3536L7.64645 13.6464C7.45118 13.4512 7.45118 13.1346 7.64645 12.9393L11.5858 9H0.5C0.223858 9 0 8.77614 0 8.5V7.5C0 7.22386 0.223858 7 0.5 7H11.5858L7.64645 3.06066C7.45118 2.8654 7.45118 2.54882 7.64645 2.35355L8.35355 1.64645Z"
				stroke="none"
			/>
		</svg>`],["arrow-up-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M8.00015 0.5C8.34685 0.5 8.67835 0.642318 8.91714 0.893677L15.6517 7.98267C15.8441 8.18525 15.8359 8.50548 15.6333 8.69793L14.533 9.7433C14.3304 9.93575 14.0101 9.92754 13.8177 9.72496L9.26497 4.93262V15.4249C9.26497 15.7043 9.03846 15.9308 8.75904 15.9308H7.24125C6.96184 15.9308 6.73532 15.7043 6.73532 15.4249V4.93262L2.1826 9.72496C1.99015 9.92754 1.66992 9.93575 1.46734 9.7433L0.366945 8.69793C0.164367 8.50548 0.156156 8.18525 0.348604 7.98267L7.08315 0.893677C7.32194 0.642318 7.65344 0.5 8.00015 0.5Z"
				stroke="none"
			/>
		</svg>`],["connection-stairs-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M1 11.5C1 11.2239 1.22386 11 1.5 11H6V13.5C6 13.7761 5.77614 14 5.5 14H1.5C1.22386 14 1 13.7761 1 13.5V11.5Z" />
				<path d="M4 8.5C4 8.22386 4.22386 8 4.5 8H9V10.5C9 10.7761 8.77614 11 8.5 11H4V8.5Z" />
				<path d="M7 5.5C7 5.22386 7.22386 5 7.5 5H12V7.5C12 7.77614 11.7761 8 11.5 8H7V5.5Z" />
				<path d="M10 2.5C10 2.22386 10.2239 2 10.5 2H14.5C14.7761 2 15 2.22386 15 2.5V4.5C15 4.77614 14.7761 5 14.5 5H10V2.5Z" />
			</g>
		</svg>`],["connection-stairs-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M5.25 12H2.5C2.225 12 2 11.7429 2 11.4286C2 11.1143 2.225 10.8571 2.5 10.8571H4.25V7.91429H6.5V4.94286H8.75V2H11.5C11.775 2 12 2.25714 12 2.57143C12 2.88571 11.775 3.14286 11.5 3.14286H9.75V6.08571H7.5V9.02857H5.25V12Z"
				stroke="none"
			/>
		</svg>`],["connection-stairs-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<path d="M1.625 8.1875C1.625 8.01491 1.76491 7.875 1.9375 7.875H4.75V9.4375C4.75 9.61009 4.61009 9.75 4.4375 9.75H1.9375C1.76491 9.75 1.625 9.61009 1.625 9.4375V8.1875Z" />
			<path d="M3.5 6.3125C3.5 6.13991 3.63991 6 3.8125 6H6.625V7.5625C6.625 7.73509 6.48509 7.875 6.3125 7.875H3.5V6.3125Z" />
			<path d="M5.375 4.4375C5.375 4.26491 5.51491 4.125 5.6875 4.125H8.5V5.6875C8.5 5.86009 8.36009 6 8.1875 6H5.375V4.4375Z" />
			<path d="M7.25 2.5625C7.25 2.38991 7.38991 2.25 7.5625 2.25H10.0625C10.2351 2.25 10.375 2.38991 10.375 2.5625V3.8125C10.375 3.98509 10.2351 4.125 10.0625 4.125H7.25V2.5625Z" />
		</svg>`],["connection-escalator-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M3.63008 12H2C0.895431 12 0 12.8954 0 14C0 15.1046 0.89543 16 2 16H4.63008C4.86879 16 5.09962 15.9146 5.28087 15.7593L11.7191 10.2407C11.9004 10.0854 12.1312 10 12.3699 10H14C15.1046 10 16 9.10457 16 8C16 6.89543 15.1046 6 14 6H11.3699C11.1312 6 10.9004 6.08539 10.7191 6.24074L4.28087 11.7593C4.09962 11.9146 3.86879 12 3.63008 12Z" />
				<path d="M5 6C5 4.89543 5.89543 4 7 4C8.10457 4 9 4.89543 9 6L5 9.5V6Z" />
				<path d="M9 2C9 3.10457 8.10457 4 7 4C5.89543 4 5 3.10457 5 2C5 0.89543 5.89543 0 7 0C8.10457 0 9 0.89543 9 2Z" />
			</g>
		</svg>`],["connection-escalator-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M5.26686 2.98522C5.26686 2.44335 5.71573 2 6.26436 2C6.81299 2 7.26187 2.44335 7.26187 2.98522C7.26187 3.5271 6.81299 3.97045 6.26436 3.97045C5.71573 3.97045 5.26686 3.50246 5.26686 2.98522Z"
				stroke="none"
			/>
			<path
				d="M7.26188 5.48588V5.25125C7.26188 4.85716 6.91275 4.53696 6.48881 4.53696H6.03993C5.61599 4.53696 5.26687 4.88179 5.26687 5.25125V7.66458L4.3192 8.6995H3.67082C2.74813 8.6995 2 9.43842 2 10.3498C2 11.2611 2.74813 12 3.67082 12H4.61845C5.36658 12 6.11471 11.6798 6.61347 11.1133L9.6808 7.76354H10.3292C11.2519 7.76354 12 7.02463 12 6.11329C12 5.20196 11.2519 4.46305 10.3292 4.46305H9.38155C8.60848 4.46305 7.88529 4.78324 7.38653 5.34975L7.26188 5.48588ZM4.61846 11.0148H3.67083C3.29677 11.0148 2.99751 10.7192 2.99751 10.3498C2.99751 9.9803 3.29677 9.68473 3.67083 9.68473H4.61846C4.71821 9.68473 4.81796 9.63547 4.86784 9.56158L8.13467 5.99015C8.45886 5.64532 8.90774 5.44828 9.38155 5.44828H10.3292C10.7032 5.44828 11.0025 5.74384 11.0025 6.1133C11.0025 6.48276 10.7032 6.77833 10.3292 6.77833H9.38155C9.2818 6.77833 9.18205 6.82759 9.13218 6.87685L5.86534 10.4729C5.54115 10.8177 5.09228 11.0148 4.61846 11.0148Z"
				stroke="none"
			/>
		</svg>`],["connection-elevator-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M3 5.5C3 6.32843 2.32843 7 1.5 7C0.671573 7 0 6.32843 0 5.5C0 4.67157 0.671573 4 1.5 4C2.32843 4 3 4.67157 3 5.5Z" />
				<path d="M3 10.5C3 11.3284 2.32843 12 1.5 12C0.671573 12 0 11.3284 0 10.5C0 9.67157 0.671573 9 1.5 9C2.32843 9 3 9.67157 3 10.5Z" />
				<path d="M11 1H14C14.5523 1 15 1.44772 15 2V14C15 14.5523 14.5523 15 14 15H11V1Z" />
				<path d="M9 1H6C5.44772 1 5 1.44772 5 2V14C5 14.5523 5.44772 15 6 15H9V1Z" />
			</g>
		</svg>`],["connection-elevator-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M7.476 2H2.72693C1.77095 2 1 2.72464 1 3.62319V10.3768C1 11.2754 1.77095 12 2.72693 12H7.476C8.43198 12 9.20293 11.2754 9.20293 10.3768V3.62319C9.17209 2.72464 8.40114 2 7.476 2ZM7.476 3.15942C7.75354 3.15942 7.96941 3.36232 7.96941 3.62319V10.3768C7.96941 10.6377 7.75354 10.8406 7.476 10.8406H5.71824V3.15942H7.476ZM4.48472 3.15942V10.8406H2.72693C2.44939 10.8406 2.23352 10.6377 2.23352 10.3768V3.62319C2.23352 3.36232 2.44939 3.15942 2.72693 3.15942H4.48472Z"
				stroke="none"
			/>
			<path
				d="M12.4643 6.19064H10.6638C10.4456 6.19064 10.2546 6.06243 10.1728 5.88294C10.0909 5.70346 10.1455 5.47269 10.2819 5.31884L11.1821 4.47269C11.4004 4.26756 11.755 4.26756 11.946 4.47269L12.8462 5.31884C13.0099 5.47269 13.0371 5.67781 12.9553 5.88294C12.8735 6.08807 12.6825 6.19064 12.4643 6.19064Z"
				stroke="none"
			/>
			<path
				d="M11.564 9.65216C11.4276 9.65216 11.2912 9.60088 11.1821 9.49831L10.2819 8.65216C10.1182 8.49831 10.0909 8.29319 10.1728 8.08806C10.2546 7.90857 10.4456 7.78036 10.6638 7.78036H12.4643C12.6825 7.78036 12.8735 7.90857 12.9553 8.08806C13.0371 8.26754 12.9826 8.49831 12.8462 8.65216L11.9459 9.49831C11.8641 9.60088 11.7004 9.65216 11.564 9.65216Z"
				stroke="none"
			/>
		</svg>`],["connection-elevator-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<circle cx="1.9375" cy="4.4375" r="0.9375" />
			<circle cx="1.9375" cy="7.5625" r="0.9375" />
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M7.6 2H9.4C9.73137 2 10 2.26863 10 2.6V9.41328C10 9.74465 9.73137 10.0133 9.4 10.0133H7.6V2ZM6.4 2H4.6C4.26863 2 4 2.26863 4 2.6V9.41328C4 9.74465 4.26863 10.0133 4.6 10.0133H6.4V2Z"
			/>
		</svg>`],["new-tab-14x14",`<svg viewBox="0 0 14 14">
			<g stroke="none">
				<path d="M2.625 2.625H5.6875C5.92913 2.625 6.125 2.42912 6.125 2.1875V1.3125C6.125 1.07088 5.92913 0.875 5.6875 0.875H1.3125C1.07088 0.875 0.875 1.07088 0.875 1.3125V12.6875C0.875 12.9291 1.07088 13.125 1.3125 13.125H12.6875C12.9291 13.125 13.125 12.9291 13.125 12.6875V8.3125C13.125 8.07088 12.9291 7.875 12.6875 7.875H11.8125C11.5709 7.875 11.375 8.07088 11.375 8.3125V11.375H2.625V2.625Z" />
				<path d="M12.9063 0.875H8.40311C8.20822 0.875 8.11063 1.11062 8.24843 1.24843L9.88124 2.88124L5.8156 6.94688C5.64475 7.11774 5.64475 7.39475 5.8156 7.5656L6.43432 8.18432C6.60517 8.35517 6.88218 8.35517 7.05304 8.18432L11.1187 4.11868L12.7516 5.75157C12.8894 5.88938 13.125 5.79178 13.125 5.59689V1.09375C13.125 0.972938 13.0271 0.875 12.9063 0.875Z" />
			</g>
		</svg>`],["compress-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path
					id="Vector"
					d="M4.67773 10.7154H0.713449C0.556306 10.7154 0.427734 10.844 0.427734 11.0011V11.8583C0.427734 12.0154 0.556306 12.144 0.713449 12.144H3.82059V15.2868C3.82059 15.444 3.94916 15.5725 4.10631 15.5725H4.96345C5.12059 15.5725 5.24916 15.444 5.24916 15.2868V11.2868C5.24916 10.9708 4.99381 10.7154 4.67773 10.7154ZM4.96345 0.429688H4.10631C3.94916 0.429688 3.82059 0.558259 3.82059 0.715402V3.85826H0.713449C0.556306 3.85826 0.427734 3.98683 0.427734 4.14397V5.00112C0.427734 5.15826 0.556306 5.28683 0.713449 5.28683H4.67773C4.99381 5.28683 5.24916 5.03147 5.24916 4.7154V0.715402C5.24916 0.558259 5.12059 0.429688 4.96345 0.429688ZM15.2849 10.7154H11.3206C11.0045 10.7154 10.7492 10.9708 10.7492 11.2868V15.2868C10.7492 15.444 10.8777 15.5725 11.0349 15.5725H11.892C12.0492 15.5725 12.1777 15.444 12.1777 15.2868V12.144H15.2849C15.442 12.144 15.5706 12.0154 15.5706 11.8583V11.0011C15.5706 10.844 15.442 10.7154 15.2849 10.7154ZM15.2849 3.85826H12.1777V0.715402C12.1777 0.558259 12.0492 0.429688 11.892 0.429688H11.0349C10.8777 0.429688 10.7492 0.558259 10.7492 0.715402V4.7154C10.7492 5.03147 11.0045 5.28683 11.3206 5.28683H15.2849C15.442 5.28683 15.5706 5.15826 15.5706 5.00112V4.14397C15.5706 3.98683 15.442 3.85826 15.2849 3.85826Z"
				/>
			</g>
		</svg>`],["washroom-14x14",`<svg viewBox="0 0 14 14" stroke="none">
			<path d="M4.55125 3.09062C4.55125 3.69326 4.07639 4.18176 3.49058 4.18176C2.90525 4.18176 2.43039 3.69326 2.43039 3.09062C2.43039 2.4885 2.90525 2 3.49058 2C4.07639 2 4.55125 2.4885 4.55125 3.09062Z" />
			<path d="M5.1193 5.48047C4.81653 4.83116 4.17252 4.41571 3.47822 4.41571C2.78392 4.41571 2.13986 4.83116 1.83714 5.48047L1.04175 7.22034C0.940664 7.441 1.02893 7.70073 1.24393 7.81791C1.47077 7.90871 1.72324 7.81791 1.82433 7.59725L2.49349 6.15554L2.21587 11.4407C2.20305 11.7263 2.41805 11.9734 2.69567 11.9993C2.97329 12.0124 3.21344 11.7913 3.23859 11.5057L3.4028 8.285H3.567L3.73121 11.5057C3.74403 11.7913 3.97086 11.9993 4.23616 11.9993H4.26131C4.53893 11.9861 4.75343 11.7395 4.74111 11.4407L4.46349 6.15554L5.13265 7.59725C5.20858 7.75298 5.35997 7.85697 5.52418 7.85697C5.5873 7.85697 5.65042 7.84379 5.71354 7.81792C5.92804 7.71393 6.0163 7.44153 5.91572 7.22035L5.1193 5.48047Z" />
			<path d="M12.9582 7.22034L12.1505 5.48047C11.8477 4.83116 11.2037 4.41571 10.5094 4.41571C9.81513 4.41571 9.17107 4.83116 8.86836 5.48047L8.06064 7.22034C7.95955 7.441 8.04782 7.70073 8.26282 7.81791C8.47732 7.9219 8.7298 7.8311 8.84371 7.60993L9.52519 6.12977L9.46207 7.2204L8.57842 8.92184C8.47733 9.11663 8.61638 9.36316 8.83089 9.36316H9.33584L9.22242 11.4668C9.2096 11.7397 9.41177 11.9862 9.68939 11.9994C9.95469 12.0126 10.1943 11.8046 10.2072 11.519L10.3581 9.33723H10.6737L10.7871 11.5058C10.7999 11.7787 11.0144 11.9862 11.2792 11.9862H11.3043C11.5696 11.973 11.7841 11.7396 11.7713 11.4535L11.6579 9.33718H12.1628C12.3773 9.33718 12.5287 9.09066 12.4153 8.89586L11.5317 7.19442L11.4685 6.1038L12.1757 7.5972C12.2516 7.75293 12.403 7.85692 12.5672 7.85692C12.6303 7.85692 12.6934 7.84373 12.7566 7.81786C12.9711 7.70068 13.0593 7.44102 12.9582 7.22034Z" />
			<path d="M11.5696 3.09062C11.5696 3.69326 11.0948 4.18176 10.5094 4.18176C9.92363 4.18176 9.44876 3.69326 9.44876 3.09062C9.44876 2.4885 9.92363 2 10.5094 2C11.0948 2 11.5696 2.4885 11.5696 3.09062Z" />
			<path d="M6.99996 2.00006C6.76031 2.00006 6.57095 2.19485 6.57095 2.44138V11.5575C6.57095 11.804 6.76031 11.9988 6.99996 11.9988C7.2396 11.9988 7.42896 11.804 7.42896 11.5575V2.44138C7.42896 2.19485 7.2396 2.00006 6.99996 2.00006Z" />
		</svg>`],["point-of-interest-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<path
				stroke="none"
				id="Subtract"
				fill-rule="evenodd"
				clip-rule="evenodd"
				d="M6.24724 10.7516C7.94597 9.0358 9.85962 6.89195 9.85962 4.85965C9.85962 2.72802 8.13159 1 5.99997 1C3.86834 1 2.14032 2.72802 2.14032 4.85965C2.14032 6.89195 4.05397 9.0358 5.7527 10.7516C5.88904 10.8893 6.1109 10.8893 6.24724 10.7516ZM5.99994 6.26317C6.77508 6.26317 7.40345 5.6348 7.40345 4.85967C7.40345 4.08453 6.77508 3.45616 5.99994 3.45616C5.22481 3.45616 4.59644 4.08453 4.59644 4.85967C4.59644 5.6348 5.22481 6.26317 5.99994 6.26317Z"
			/>
		</svg>`],["flag-20x20",`<svg viewBox="0 0 20 20" stroke="none">
			<path
				d="M16.9987 4.27111C16.936 5.06715 16.3836 5.93162 15.5238 6.57845C14.7549 7.15682 13.0885 8.04927 10.5434 7.55174C8.32167 7.1164 6.82156 8.02129 6.08085 10.2416L8.24615 17.3998C8.31833 17.6471 8.17711 17.9059 7.9292 17.9813C7.88527 17.9938 7.83976 18 7.79426 18C7.58634 18 7.40277 17.8647 7.34236 17.6673L5.1644 10.4686C5.13773 10.4173 5.12125 10.3613 5.11419 10.3038L3.41956 4.70042C3.38112 4.63512 3.35994 4.56127 3.3568 4.48587L3.02101 3.37886C2.98413 3.25992 2.9959 3.13165 3.05553 3.02203C3.11437 2.91242 3.21479 2.83079 3.33482 2.79504C3.45564 2.75928 3.5851 2.7725 3.69494 2.83235C3.80477 2.89144 3.88637 2.99172 3.92167 3.11143L3.9813 3.31355C4.38847 2.85956 4.90472 2.51439 5.48136 2.30915C6.97201 1.75566 8.95216 1.95467 10.6469 2.83156C11.6888 3.36951 14.3374 4.54493 16.3647 3.79553C16.5154 3.74111 16.684 3.76599 16.8127 3.86239C16.9406 3.95879 17.0105 4.11251 16.9987 4.27111Z"
				stroke="none"
			/>
		</svg>`],["link-16x16",`<svg viewBox="0 0 16 16" stroke="none">
			<path
				d="M9.10678 11.2433C9.07993 11.2167 9.04367 11.2018 9.00589 11.2018C8.9681 11.2018 8.93184 11.2167 8.90499 11.2433L6.82999 13.3183C5.86928 14.279 4.24785 14.3808 3.18714 13.3183C2.12464 12.2558 2.22642 10.6362 3.18714 9.67546L5.26214 7.60046C5.31749 7.5451 5.31749 7.45403 5.26214 7.39868L4.55142 6.68796C4.52457 6.66138 4.48832 6.64646 4.45053 6.64646C4.41274 6.64646 4.37649 6.66138 4.34964 6.68796L2.27464 8.76296C0.763923 10.2737 0.763923 12.7183 2.27464 14.2272C3.78535 15.7362 6.22999 15.738 7.73892 14.2272L9.81392 12.1522C9.86928 12.0969 9.86928 12.0058 9.81392 11.9505L9.10678 11.2433ZM13.7246 2.77903C12.2139 1.26832 9.76928 1.26832 8.26035 2.77903L6.18357 4.85403C6.15698 4.88088 6.14207 4.91714 6.14207 4.95493C6.14207 4.99271 6.15698 5.02897 6.18357 5.05582L6.89249 5.76475C6.94785 5.8201 7.03892 5.8201 7.09428 5.76475L9.16928 3.68975C10.13 2.72903 11.7514 2.62725 12.8121 3.68975C13.8746 4.75225 13.7729 6.37189 12.8121 7.3326L10.7371 9.4076C10.7106 9.43445 10.6956 9.47071 10.6956 9.5085C10.6956 9.54628 10.7106 9.58254 10.7371 9.60939L11.4479 10.3201C11.5032 10.3755 11.5943 10.3755 11.6496 10.3201L13.7246 8.2451C15.2336 6.73439 15.2336 4.28975 13.7246 2.77903ZM9.75142 6.00939C9.72457 5.9828 9.68832 5.96789 9.65053 5.96789C9.61275 5.96789 9.57649 5.9828 9.54964 6.00939L5.50499 10.0522C5.47841 10.0791 5.46349 10.1154 5.46349 10.1531C5.46349 10.1909 5.47841 10.2272 5.50499 10.254L6.21214 10.9612C6.26749 11.0165 6.35857 11.0165 6.41392 10.9612L10.4568 6.91832C10.5121 6.86296 10.5121 6.77189 10.4568 6.71653L9.75142 6.00939Z"
				stroke="none"
			/>
		</svg>`]]),H3e=/<svg([^>]*)>/g;function Wse(i,e,t){let n=$3e.get(i);return n?n.replace(H3e,'<svg$1 xmlns="http://www.w3.org/2000/svg" style="fill:'.concat(e,"; width:").concat(t,"px; height:").concat(t,'px">')):""}l(Wse,"getStyledIcon");var tm,Mv,ah,WT,d8,f8,SM,m8,qse=class{constructor(e,t){ge(this,ah),ge(this,tm),ge(this,Mv),D(this,"colors",{default:"#3D5676",connection:"#128387",washroom:"#3161B4",point:"#AD468F"}),Ce(this,tm,e),Ce(this,Mv,t)}auto(){let e=[],t=y(this,Mv)[Object.keys(y(this,Mv))[0]];return[...t.getByType("connection"),...t.getByType("point-of-interest"),...t.getByType("space")].forEach(n=>{if(n.__type==="connection")n.coordinates.forEach(r=>{let a=n.name||n.externalId;if(a){let o=y(this,tm).Labels.add(r,a,St(this,ah,WT).call(this,n));e.push(o)}});else{n.__type==="space"&&n.name!==""&&y(this,tm).updateState(n,{interactive:!0,hoverColor:"#F0F0F0"});let r=n.name;if(r){let a=y(this,tm).Labels.add(n,r,St(this,ah,WT).call(this,n));e.push(a)}}}),{labels:e}}};tm=new WeakMap,Mv=new WeakMap,ah=new WeakSet,WT=l(function(i){let e=Wse(St(this,ah,d8).call(this,i),"white",12);return{appearance:{text:{foregroundColor:St(this,ah,SM).call(this,i)},marker:{foregroundColor:{active:St(this,ah,SM).call(this,i)},icon:e,iconSize:12}},interactive:!0,rank:St(this,ah,m8).call(this,i)}},"#generatLabelAppearance"),d8=l(function(i){return i.__type==="connection"?St(this,ah,f8).call(this,i.type):i.name.includes("Washroom")?"washroom-14x14":i.__type==="point-of-interest"?"point-of-interest-12x12":""},"#getIconName"),f8=l(function(i){let e="";switch(i){case"elevator":e="connection-elevator-12x12";break;case"escalator":e="connection-escalator-12x12";break;case"stairs":e="connection-stairs-12x12";break}return e},"#attemptIconNameForConnection"),SM=l(function(i){return i.__type==="connection"?this.colors.connection:i.__type==="point-of-interest"?this.colors.point:"name"in i&&i.name.includes("Washroom")?this.colors.washroom:this.colors.default},"#getLabelColor"),m8=l(function(i){return i.__type==="connection"?"high":(i.__type,"medium")},"#getDefaultLabelRank"),l(qse,"Labels");var W3e=qse,Xse=class{constructor(e,t){D(this,"Labels"),D(this,"auto",l(()=>this.Labels.auto(),"auto")),this.Labels=new W3e(e,t)}};l(Xse,"DefaultTheme");var q3e=Xse;R();var Hi,Bw,td,R_,qT,Zse=class{constructor(e){ge(this,td),ge(this,Hi),ge(this,Bw),D(this,"interactions",{set:l(t=>{t?.pan!=null&&(y(this,Hi).getSystems().cameraSystem.enablePan=t.pan),t?.zoom!=null&&(y(this,Hi).getSystems().cameraSystem.enableZoom=t.zoom),t?.bearingAndPitch!=null&&(y(this,Hi).getSystems().cameraSystem.enableRotate=t.bearingAndPitch)},"set"),enable:l(()=>{y(this,Hi).getSystems().cameraSystem.enablePan=!0,y(this,Hi).getSystems().cameraSystem.enableZoom=!0,y(this,Hi).getSystems().cameraSystem.enableRotate=!0},"enable"),disable:l(()=>{y(this,Hi).getSystems().cameraSystem.enablePan=!1,y(this,Hi).getSystems().cameraSystem.enableZoom=!1,y(this,Hi).getSystems().cameraSystem.enableRotate=!1},"disable")}),D(this,"setMinPitch",l(t=>{y(this,Hi).camera.setMinPitch(t)},"setMinPitch")),D(this,"setMaxPitch",l(t=>{y(this,Hi).camera.setMaxPitch(t)},"setMaxPitch")),D(this,"setMinZoomLevel",l(t=>{y(this,Hi).camera.setMinZoomLevel(t,!0)},"setMinZoomLevel")),D(this,"setMaxZoomLevel",l(t=>{y(this,Hi).camera.setMaxZoomLevel(t)},"setMaxZoomLevel")),Ce(this,Bw,e),Ce(this,Hi,e.core)}setScreenOffsets(e){y(this,Hi).camera.setInsetPadding(e)}get screenOffsets(){return y(this,Hi).camera.insetsPadding}get panMode(){return y(this,Hi).camera.panMode}setPanMode(e){if(e!=="default"&&e!=="elevation")throw new Error("Invalid pan mode");e!==this.panMode&&y(this,Hi).camera.setPanMode(e)}getFocusOnTransform(e,t){var n,r,a;let o=y(this,Hi).camera.getCameraFrameForCoordinates(St(this,td,qT).call(this,e),{pitch:t?.pitch,bearing:t?.bearing,padding:t?.screenOffsets||this.screenOffsets,maxZoomLevel:t?.maxZoomLevel,verticalPadding:(n=t?.axisAlignedPadding)==null?void 0:n.vertical,minZoomLevel:t?.minZoomLevel,duration:t?.duration,easing:t?.easing});return{center:new Wn(o.center[1],o.center[0]),zoomLevel:o.zoomLevel,bearing:(r=t?.bearing)!=null?r:this.bearing,pitch:(a=t?.pitch)!=null?a:this.pitch}}focusOn(e,t){var n;return y(this,Hi).camera.focusOn(St(this,td,qT).call(this,e),{pitch:t?.pitch,bearing:t?.bearing,padding:t?.screenOffsets||this.screenOffsets,maxZoomLevel:t?.maxZoomLevel,minZoomLevel:t?.minZoomLevel,duration:t?.duration,verticalPadding:(n=t?.axisAlignedPadding)==null?void 0:n.vertical,easing:t?.easing})}animateTo(e,t){var n;let{center:r,zoomLevel:a,bearing:o,pitch:s}=e,u=r??this.center;return y(this,Hi).camera.animateTo({center:r!=null?[u.longitude,u.latitude,y(this,Hi).camera.elevation]:void 0,zoomLevel:a,bearing:o,pitch:s,duration:(n=t?.duration)!=null?n:600,easing:t?.easing})}set(e){let{center:t=this.center,zoomLevel:n=this.zoomLevel,bearing:r=this.bearing,pitch:a=this.pitch}=e,o=[t.longitude,t.latitude];y(this,Hi).camera.setCenter(o),y(this,Hi).camera.setZoomLevel(n),y(this,Hi).camera.setBearing(r),y(this,Hi).camera.setPitch(a)}get center(){let e=y(this,Hi).camera.center;return new Wn(e[1],e[0],void 0)}setAutoMinZoomLevel(e){y(this,Hi).camera.setAutoMinZoomLevel(e)}get autoMinZoomLevel(){return y(this,Hi).camera.autoMinZoomLevel}get zoomLevel(){return y(this,Hi).camera.zoomLevel}get pitch(){return y(this,Hi).camera.pitch}get minPitch(){return y(this,Hi).camera.minPitch}get maxPitch(){return y(this,Hi).camera.maxPitch}get bearing(){let e=y(this,Hi).camera.bearing;return(e<0?e+360:e)%360}get minZoomLevel(){return y(this,Hi).camera.minZoomLevel}get maxZoomLevel(){return y(this,Hi).camera.maxZoomLevel}setElevation(e){y(this,Hi).camera.setElevation(e)}get elevation(){return y(this,Hi).camera.elevation}animateElevation(e,t){return y(this,Hi).camera.animateElevation(e,t)}updateFacadesInView(){y(this,Hi).getSystems().geometryInFocusSystem.raycast()}};Hi=new WeakMap,Bw=new WeakMap,td=new WeakSet,R_=l(function(i){var e,t,n,r,a,o;let s=y(this,Hi).camera.elevation;return Wn.is(i)&&i.floorId!=null?(t=(e=y(this,Hi).getState(i.floorId))==null?void 0:e.altitude)!=null?t:s:Kl.is(i)?(r=(n=y(this,Hi).getState(i.id))==null?void 0:n.altitude)!=null?r:s:"floor"in i&&Kl.is(i.floor)&&(o=(a=y(this,Hi).getState(i.floor.id))==null?void 0:a.altitude)!=null?o:s},"#getFloorAltitude"),qT=l(function(i){var e;let t=[],n=(Array.isArray(i)?i:[i]).flatMap(r=>{var a;return(a=r?.focusTarget)!=null?a:[r]});for(let r of n)if(r!=null)if(Wn.is(r)){let a=St(this,td,R_).call(this,r);t.push([r.longitude,r.latitude,a])}else if(r?.id!=null){let a=St(this,td,R_).call(this,r);if(Kl.is(r)&&(e=y(this,Bw).getMapDataInternal())!=null&&e.enterpriseMode){t.push(r.id);continue}else if("geoJSON"in r&&r.geoJSON.geometry.coordinates.length>0){Vg(r.geoJSON,s=>{t.push([s[0],s[1],a])});continue}let o=y(this,Hi).getBoundingArea(r.id);if(o)t.push(...o.map(s=>[s[0],s[1],a]));else if("geoJSONBoundingBox"in r){let s=St(this,td,R_).call(this,r);if(r.geoJSONBoundingBox!=null){let u=[[r.geoJSONBoundingBox[0],r.geoJSONBoundingBox[1],s],[r.geoJSONBoundingBox[2],r.geoJSONBoundingBox[3],s]];t.push(...u)}}}else _D(r)&&t.push(r);return t},"#computeCoordinateCloud"),l(Zse,"Camera");var X3e=Zse;R();var Cv,Yse=class{constructor({currentMapGetter:e}){ge(this,Cv),Ce(this,Cv,e)}get currentMap(){return y(this,Cv).call(this)}async getCurrentSceneGLTF(e){let t=y(this,Cv).call(this);return t?t?.Exporter.getCurrentSceneGLTF(e):(nt.error("There is no map to export. Please load a map first."),new Blob)}};Cv=new WeakMap,l(Yse,"Exporter");var Z3e=Yse;R();var Wu,t2,Jse=class{constructor({currentMapGetter:e}){ge(this,Wu,new Map),ge(this,t2),Ce(this,t2,e)}get currentMap(){return y(this,t2).call(this)}getById(e){return y(this,Wu).get(e)}add(e,t,n){let r=e.anchorTarget,a=this.currentMap;if(!a)throw new Error("currentMap should exist");let o=a.Labels.add(r,t,lt(Me({},n),{attachTo:YA(e),rank:n?.rank==null||n?.rank==="initial"?"medium":n.rank})),s=new DT(o.id.toString(),t,e);return y(this,Wu).set(s.id,{label:s,entityId:s.id}),s}all(e){var t;let n=[];return(t=this.currentMap)==null||t.Labels.all({onCreate:l((r,a,o)=>{let s=new DT(r.toString(),a,o);y(this,Wu).set(s.id,{label:s,entityId:s.id}),n.push(s)},"onCreate"),labelOptions:e}),n}remove(e){var t;let n=y(this,Wu).get(e.id);n&&((t=this.currentMap)==null||t.Labels.remove(n),y(this,Wu).delete(e.id.toString()))}removeAll(){let e=[];return y(this,Wu).forEach(({label:t})=>{this.remove(t),e.push(t),y(this,Wu).delete(t.id.toString())}),e}};Wu=new WeakMap,t2=new WeakMap,l(Jse,"Labels");var Y3e=Jse;R();R();var MM={altitude:0,height:1,color:"#ffffff",opacity:1,width:.15},g8={opacity:.25,color:"#a7d1ec",height:.8,width:.05,altitude:.1,cap:"square",visible:!1},y8=.5,Kse=class{constructor(e,t,n=new Map){D(this,"containerId"),D(this,"layers"),D(this,"renderer"),this.containerId=t,this.layers=n,this.renderer=e}get visible(){return this.renderer.getState(this.containerId).visible}setVisible(e){this.renderer.setState(this.containerId,{visible:e})}};l(Kse,"Layer");var fp=Kse,im,Qse=class{constructor(e,t,n,r,a,o,s,u){D(this,"id"),D(this,"name"),D(this,"elevation"),D(this,"containerId"),D(this,"externalId"),D(this,"metadata"),D(this,"shortName"),D(this,"subtitle"),D(this,"occluderId"),D(this,"loaded",!1),D(this,"styleMap",{}),D(this,"obstructions"),D(this,"entrances"),D(this,"spaces"),D(this,"floorImages"),D(this,"floorText"),D(this,"renderer"),D(this,"options"),D(this,"layers",new Map),D(this,"footprint"),D(this,"floorStackId"),D(this,"multiFloorView"),D(this,"mapDataInternal"),D(this,"facadesByStyleId",new Map),ge(this,im),D(this,"load",l(()=>{var w,A,E,I,C,T,k,F,B,N,z,L,j,q,Z,O;if(this.loaded||this.obstructions==null&&this.spaces==null)return this;this.loaded=!0;let Y=this.renderer.addGroupContainer("".concat(Sg,"-").concat(this.id),{},this.id);this.layers.set(Sg,new fp(this.renderer,Y.id.toString()));let J=this.renderer.addGroupContainer("".concat(ud,"-").concat(this.id),{},this.id);this.layers.set(ud,new fp(this.renderer,J.id.toString()));let oe=this.renderer.addGroupContainer("".concat(Ga,"-").concat(this.id),{},this.id);if(this.layers.set(Ga,new fp(this.renderer,oe.id.toString())),((w=this.footprint)==null?void 0:w.geometry)!=null&&((A=this.footprint)==null?void 0:A.geometry.coordinates.length)!==0){let $=MM;if(this.obstructions!=null&&this.obstructions.features.length>0){let ve=this.obstructions.features.filter(Q=>{var he;return Q.geometry.type==="LineString"&&((he=Q.properties.kind)==null?void 0:he.toLowerCase())==="wall"&&Q.properties.footprintComponent===!0});ve!=null&&ve.length>0&&($=this.styleMap[(E=ve[0].properties)==null?void 0:E.id])}let K=this.renderer.addGeometryGroup("Footprint-".concat(this.id),{features:[{geometry:this.footprint.geometry,properties:{id:"Footprint-Floor-".concat(this.id)}}]},lt(Me({},$),{height:(C=(I=this.multiFloorView)==null?void 0:I.floorHeight)!=null?C:10,altitude:0,outline:(k=(T=this.options.style)==null?void 0:T.outlines)!=null?k:!0,visible:!1,opacity:this.elevation<0?1:.4,side:this.elevation<0?"back":"front",color:this.elevation<0?"#F0EEE8":$.color,renderOrder:2}),this.id);this.layers.set(aI,new fp(this.renderer,K.id.toString()));let te=this.renderer.addGroupContainer("".concat(Wv,"-").concat(this.id),{},this.id);this.layers.set(Wv,new fp(this.renderer,te.id.toString()))}if(this.spaces!=null&&this.spaces.features.length>0){let $=[],K=new Map;this.spaces.features.filter(he=>{var se;return he.geometry.type==="Polygon"&&((se=he.properties.kind)==null?void 0:se.toLowerCase())!=="void"}).forEach(he=>{var se;let Ae=(se=this.mapDataInternal)==null?void 0:se.facadesBySpaceId[he.properties.id];if(Ae){let Ie=K.get(Ae.id)||[];K.set(Ae.id,[...Ie,he])}else $.push(he)});let te=E2($,this.styleMap),ve=this.renderer.addGroupContainer("spaces-".concat(this.id),{},oe),Q=0;for(let[he,se]of te){let Ae=this.renderer.addGeometryGroup("Spaces-".concat(this.id,"-").concat(Q),{features:se},dm(he,this.options),ve);Q++;let Ie=ve.id.toString();this.layers.get(Ga).layers.set(he.id||Ie,Ae.id.toString())}if(K.size>0){let he=this.renderer.addGroupContainer("".concat(qv,"-").concat(this.id),{},this.id);this.layers.set(qv,new fp(this.renderer,he.id.toString()));for(let[se,Ae]of K){let Ie=this.renderer.addGroupContainer(se,{focusable:!0},he),we=this.renderer.addGroupContainer("".concat(se,"-geometry"),{},Ie),Ne=E2(Ae,this.styleMap),je=0;for(let[Ve,Le]of Ne){let xe=this.renderer.addGeometryGroup("Facades-".concat(this.id,"-").concat(se,"-").concat(je),{features:Le},lt(Me({},dm(Ve,this.options)),{renderOrder:3}),we);je++;let Ue=Ve.id||xe.id.toString();this.layers.get(qv).layers.set("".concat(se,"-").concat(Ue),xe.id.toString()),this.facadesByStyleId.has(Ue)?(F=this.facadesByStyleId.get(Ue))==null||F.push(se):this.facadesByStyleId.set(Ue,[se])}}}}if(this.obstructions!=null&&this.obstructions.features.length>0){let $=this.obstructions.features.filter(we=>we.geometry.type==="Polygon"&&(we.properties.kind==="object"||we.properties.kind==="unknown")),K=E2($,this.styleMap),te=this.renderer.addGroupContainer("objects-".concat(this.id),{},oe),ve=0;for(let[we,Ne]of K){let je=this.renderer.addGeometryGroup("Objects-".concat(this.id,"-").concat(ve),{features:Ne},dm(we,this.options),te);ve++;let Ve=te.id.toString();this.layers.get(Ga).layers.set(we.id||Ve,je.id.toString())}let Q=this.obstructions.features.filter(we=>{var Ne;return we.geometry.type==="LineString"&&((Ne=we.properties.kind)==null?void 0:Ne.toLowerCase())==="wall"&&we.properties.footprintComponent===!1}),he=this.obstructions.features.filter(we=>{var Ne;return we.geometry.type==="LineString"&&((Ne=we.properties.kind)==null?void 0:Ne.toLowerCase())==="wall"&&we.properties.footprintComponent===!0}),se=this.entrances,Ae=MM,Ie=MM;if(Q!=null&&Q.length>0){let we=this.styleMap[(B=Q[0].properties)==null?void 0:B.id];we!=null&&(Ae=Me({},we)),Ie=Ae;let{walls:Ne,entrances:je}=E8(Q,se?.features||[]),Ve=Math.max(Ae.height-.11,y8),Le=lt(Me({},g8),{height:Ve}),xe=this.renderer.addGeometryGroup("InteriorDoors-".concat(this.id),je,Le,oe);this.layers.get(Ga).layers.set(xD,xe.id.toString());let Ue=this.renderer.addGeometryGroup("Walls-".concat(this.id),{features:[Ne]},dm(Ae,this.options),oe);this.layers.get(Ga).layers.set(VA,Ue.id.toString())}if(he!=null&&he.length>0){let we=this.styleMap[(N=he[0].properties)==null?void 0:N.id];we!=null&&(Ie=lt(Me({},we),{id:Ag}));let{walls:Ne,entrances:je}=E8(he,se?.features||[]),Ve=Math.max(Ie.height-.11,y8),Le=lt(Me({},g8),{height:Ve}),xe=this.renderer.addGeometryGroup("ExteriorDoors-".concat(this.id),je,Le,oe);this.layers.get(Ga).layers.set(bD,xe.id.toString());let Ue=this.renderer.addGeometryGroup("ExteriorWalls-".concat(this.id),{features:[Ne]},dm(Ie,this.options),oe);this.layers.get(Ga).layers.set(Ag,Ue.id.toString())}}if(this.floorImages!=null){let $=this.renderer.addGroupContainer("images-".concat(this.id),{},this.id);for(let K of this.floorImages.features||[])"anchorId"in K.properties||"anchorId"in K.properties&&((z=K.properties)==null?void 0:z.anchorId)==null||this.renderer.addImage(Hn(),K,{url:K.properties.path,flipImageToFaceCamera:(L=this.options.flipImagesToFaceCamera)!=null?L:!0},$);this.layers.set(Mg,new fp(this.renderer,$.id.toString()))}if(this.floorText!=null)for(let $ of this.floorText.features||[]){let K=0;"geometryId"in $.properties?K=(q=(j=this.renderer.getState($.properties.geometryId))==null?void 0:j.height)!=null?q:0:K=(Z=$.properties.verticalOffset)!=null?Z:0,this.renderer.addText3D(Hn(),lt(Me({},$),{properties:lt(Me({},$.properties),{verticalOffset:K})}),{},this.id)}return(O=this.multiFloorView)!=null&&O.enabled&&this.renderer.setState(this.id,{altitude:this.elevation*this.multiFloorView.floorHeight}),this.renderer.render(),this},"load"));var h,d,f,m,v;this.id=t.id,this.options=a;let b=n.addGroupContainer(this.id,{visible:!1,interactive:!0,preloadGeometry:(h=a.preloadFloors)==null?void 0:h.map(w=>w.id).includes(t.id)},e);this.containerId=b.id.toString(),this.externalId=t.externalId,this.metadata=t.metadata,this.shortName=t.shortName,this.subtitle=t.subtitle,this.name=t.name,this.elevation=t.elevation,o!=null&&s!=null&&(this.styleMap=s,this.spaces=o.space[this.id],this.entrances=o.entrance[this.id],this.obstructions=o.obstruction[this.id],this.floorImages=(d=o.floorImages)==null?void 0:d[this.id],this.floorText=(m=(f=o.enterprise)==null?void 0:f.floorText)==null?void 0:m[this.id],this.footprint=(v=o["floor.geojson"])==null?void 0:v.features.find(w=>w.properties.id===t.id)),this.renderer=n,this.floorStackId=e,this.multiFloorView=r,this.mapDataInternal=u}get geoJSONBoundingBox(){if(y(this,im))return y(this,im);if(!this.footprint){nt.warn("Attempting to get bounding box with no footprint for floor ".concat(this.id));return}return Ce(this,im,n6(this.footprint)),y(this,im)}addOccluder(){let e=this.layers.get(Wv);if(e==null||e.containerId==null||this.footprint==null){nt.warn("Tried to add occluder to floor ".concat(this.id," but the floor does not have an occlusion layer."));return}this.occluderId=this.renderer.addOccluder(this.footprint,e.containerId)}get hasFacadeGeometry(){return this.facadesByStyleId.size>0}get visible(){return this.renderer.getState(this.containerId).visible}setVisible(e){this.renderer.setState(this.containerId,{visible:e})}};im=new WeakMap,l(Qse,"FloorObject");var v8=Qse;R();var CM=50,_8=!1,J3e=1e3,Sr,Ev,qu,Ol,ja,i2,Dp,Iv,qp,ul,XT,nm,n2,r2,a2,o2,ac,ele,s2,Xp,ZT,YT,x8,tle,rm,ile=class extends xr{constructor({currentMapGetter:e}){super(),ge(this,ul),ge(this,Sr),ge(this,Ev,0),ge(this,qu),ge(this,Ol,!1),ge(this,ja,[]),ge(this,i2,0),ge(this,Dp,CM),ge(this,Iv,!1),ge(this,qp,"collapsed"),D(this,"expandedFactor",0),ge(this,nm,"all-floors"),ge(this,n2,l(()=>{let n=y(this,Sr).call(this);if(y(this,i2)===this.expandedFactor||n==null||!y(this,Ol))return;Ce(this,i2,this.expandedFactor);let r=bg(this.expandedFactor,0,1,0,this.distanceBetweenFloors),a=bg(this.expandedFactor,0,.1,0,1)===0;y(this,ja).forEach((o,s)=>{n.api.updateState(o.containerId,{visible:a?o.id===n.currentFloorId:!0,altitude:r*s})}),this.expandedFactor===0?(Ce(this,Ol,!1),n.renderer.camera.setPanMode("default"),y(this,Xp)&&y(this,Xp).call(this)):this.expandedFactor===1&&(Ce(this,Ol,!1),y(this,Xp)&&y(this,Xp).call(this))},"#handlePreRender")),ge(this,r2,l(()=>{var n,r,a;this.expanded&&Ce(this,Ev,(r=(n=y(this,Sr).call(this))==null?void 0:n.renderer.camera.elevation)!=null?r:0),(a=y(this,Sr).call(this))==null||a.renderer.on("user-interaction-end",y(this,o2))},"#handleUserInteractionStart")),ge(this,a2,l(()=>{var n;let r=y(this,Sr).call(this);if(r!=null&&this.expanded&&y(this,Iv)&&!y(this,Ol)){let a=r.currentFloorId,o=[1/0,r.currentFloorId];for(let s=0;s<y(this,ja).length;s++){let u=y(this,ja)[s],h=Math.abs(((n=r.renderer.camera.elevation)!=null?n:0)-s*this.distanceBetweenFloors);h<this.distanceBetweenFloors/3&&(o[0]=h,o[1]=u.id)}o[1]!==r.currentFloorId&&(r.currentFloorId=o[1],y(this,ja).forEach(s=>{r.api.updateState(s.containerId,{visible:y(this,nm)==="all-floors"?!0:r.currentFloor.id===s.id})}),r.publish("floor-change",{reason:"stacked-maps-elevation-change",floorId:r.currentFloorId,previousFloorId:a}))}},"#determineCurrentMapBasedOnElevation")),ge(this,o2,l(()=>{var n,r;let a=y(this,Sr).call(this);if(this.expanded&&a&&y(this,Ev)!==((n=a.renderer.camera.elevation)!=null?n:0)){let o=[1/0,a.currentFloorId,0];for(let s=0;s<y(this,ja).length;s++){let u=y(this,ja)[s],h=Math.abs(((r=a.renderer.camera.elevation)!=null?r:0)-s*this.distanceBetweenFloors);h<o[0]&&(o[0]=h,o[1]=u.id,o[2]=s*this.distanceBetweenFloors)}y(this,Iv)&&St(this,ul,ele).call(this,o[2]),Ce(this,Ev,0),a.renderer.off("user-interaction-end",y(this,o2))}},"#handleUserInteractionEnd")),ge(this,ac,null),ge(this,s2,null),ge(this,Xp),ge(this,rm),Ce(this,Sr,e);let t=y(this,Sr).call(this);t!=null&&t.id!=="outdoors"&&(t.renderer.on("user-interaction-start",y(this,r2)),t.renderer.on("camera-change",y(this,a2)),t.renderer.on("pre-render",y(this,n2)))}get state(){return y(this,qp)}get expanded(){return y(this,qp)!=="collapsed"}get distanceBetweenFloors(){if(y(this,Dp)==="auto"){if(y(this,rm)!=null)return y(this,rm);let e=St(this,ul,tle).call(this);if(e)return Ce(this,rm,e),e}return typeof y(this,Dp)=="number"?y(this,Dp):CM}clearCachedFloorSeparationDistance(){Ce(this,rm,void 0)}get includedFloors(){var e;return(e=y(this,ul,XT))!=null&&e.api.mapData?y(this,ja).map(t=>{var n,r;return(r=(n=y(this,ul,XT))==null?void 0:n.api.mapData)==null?void 0:r.getById("floor",t.id)}).filter(Boolean):[]}get floorVisibilityMode(){return y(this,nm)}setFloorVisiblityMode(e){Ce(this,nm,e);let t=y(this,Sr).call(this);t!=null&&y(this,ja).forEach(n=>{t.api.updateState(n.containerId,{visible:y(this,nm)==="all-floors"?!0:t.currentFloor.id===n.id})})}changeFloorOnElevationChanges(e){Ce(this,Iv,e)}async expand(e){var t,n,r;let a=y(this,Sr).call(this);if(a!=null)return e?.distanceBetweenFloors==="auto"?Ce(this,Dp,"auto"):Ce(this,Dp,(t=e?.distanceBetweenFloors)!=null?t:CM),Ce(this,ja,e?.includedFloors!=null&&e?.includedFloors.length>0?e?.includedFloors.map(o=>a.floorsById.get(o.id)).filter(Boolean):a.currentFloorStack.floorObjects),y(this,ja).sort((o,s)=>o.elevation-s.elevation),y(this,ja).length<=1||this.expanded===!0?Promise.resolve():(Ce(this,Ol,!0),a.api.Camera.setPanMode((n=e?.cameraPanMode)!=null?n:"elevation"),this.changeFloorOnElevationChanges((r=e?.changeFloorOnElevationChanges)!=null?r:!0),St(this,ul,ZT).call(this,"expand",e).then(()=>{Ce(this,qp,"expanded"),St(this,ul,YT).call(this),this.publish("stacked-maps-state-change",{state:"expanded"})}).finally(()=>{Ce(this,Ol,!1)}))}async collapse(e){let t=y(this,Sr).call(this);if(t!=null)return this.expanded===!0?(Ce(this,Ol,!0),t.api.Camera.setPanMode("default"),this.changeFloorOnElevationChanges(!1),St(this,ul,ZT).call(this,"collapse",e).then(()=>{Ce(this,qp,"collapsed"),St(this,ul,YT).call(this),this.publish("stacked-maps-state-change",{state:"collapsed"})}).finally(()=>{Ce(this,Ol,!1)})):Promise.resolve()}destroy(){let e=y(this,Sr).call(this);e!=null&&(e.renderer.off("user-interaction-start",y(this,r2)),e.renderer.off("camera-change",y(this,a2)),e.renderer.off("pre-render",y(this,n2)))}};Sr=new WeakMap,Ev=new WeakMap,qu=new WeakMap,Ol=new WeakMap,ja=new WeakMap,i2=new WeakMap,Dp=new WeakMap,Iv=new WeakMap,qp=new WeakMap,ul=new WeakSet,XT=l(function(){return y(this,Sr).call(this)},"#currentMap"),nm=new WeakMap,n2=new WeakMap,r2=new WeakMap,a2=new WeakMap,o2=new WeakMap,ac=new WeakMap,ele=l(function(i){var e,t,n;y(this,ac)&&y(this,ac).stop();let r=y(this,Sr).call(this);r!=null&&(Ce(this,ac,new dh({elevation:(e=r.renderer.camera.elevation)!=null?e:0}).to({elevation:i},150).easing(so.Quadratic.Out).onComplete(()=>{var a;y(this,ac)&&((a=y(this,Sr).call(this))==null||a.renderer.getInternalTweenGroup().remove(y(this,ac)))}).onUpdate(({elevation:a})=>{r.renderer.camera.setElevation(a)}).start()),(t=y(this,Sr).call(this))==null||t.renderer.getInternalTweenGroup().add(y(this,ac)),(n=y(this,Sr).call(this))==null||n.renderer.render())},"#animateElevationTo"),s2=new WeakMap,Xp=new WeakMap,ZT=l(function(i,e){var t,n,r,a;y(this,qu)&&y(this,qu).stop();let o=y(this,Sr).call(this);if(o==null)return Promise.reject(new Error("No current map"));let s=y(this,ja).indexOf(o.currentFloor),u=(t=o.renderer.camera.elevation)!=null?t:0;return Ce(this,s2,new Promise(h=>{Ce(this,Xp,h)})),Ce(this,qu,new dh({percentExpanded:this.expandedFactor}).to({percentExpanded:i==="expand"?1:0},(n=e?.duration)!=null?n:J3e).easing(Pg[e?.easing||"ease-in-out"]).onUpdate(({percentExpanded:h})=>{this.expandedFactor=h;let d=s*this.distanceBetweenFloors;o.renderer.camera.setElevation(i==="expand"?d*h:u*h)}).onComplete(()=>{var h;y(this,qu)&&((h=y(this,Sr).call(this))==null||h.renderer.getInternalTweenGroup().remove(y(this,qu)))}).start()),y(this,qu).cameraAnimation=!0,(r=y(this,Sr).call(this))==null||r.renderer.getInternalTweenGroup().add(y(this,qu)),(a=y(this,Sr).call(this))==null||a.renderer.render(),y(this,s2)},"#animate"),YT=l(function(){var i,e;let t=y(this,Sr).call(this);if(t!=null&&t.options.hideImagesNotOnCurrentFloor)for(let n of y(this,ja)){let r=t.floorsById.get(n.id);r&&(y(this,qp)==="expanded"?(i=r.layers.get(Mg))==null||i.setVisible(!0):(e=r.layers.get(Mg))==null||e.setVisible(r.id===t.currentFloor.id))}},"#showOrHideImagesOnAllFloorsInStack"),x8=l(function(i,e,t,n){let r=l2(i,t),a=e.clone(),o=l2(a,t);if(!kc(r)||!kc(o))return-1;let s=0,u;do{if(s>1e4)return-1;s+=20,a.position.z=s,a.updateMatrixWorld(),o.makeEmpty(),l2(a,t,o),u=r.intersectsBox(o)}while(u);return s},"#computeMinZOffsetToSeparateFirstTwoFloors"),tle=l(function(){let i=y(this,Sr).call(this);if(!i)return;let e=i.renderer,t=e.getThreeScene();if(!i.api.mapData||!t)return;let n=y(this,ja).length>0?y(this,ja):i.currentFloorStack.floorObjects;if(n.length<2)return;let r=e.getInternalState().geometry3DMap.get(n[0].id),a=e.getInternalState().geometry3DMap.get(n[1].id);if(!r||!a)return;bd(r,"group-container"),bd(a,"group-container");let o=St(this,ul,x8).call(this,r,a,e.getThreeCamera(),e.container);if(o!==-1)return o},"#computeZOffsetSeparatesFirstTwoFloorsInClipSpace"),rm=new WeakMap,l(ile,"StackedMaps");var K3e=ile,Gh=new Ee,b8=new ft;function l2(i,e,t=new JP){return i.traverse(n=>{if(n instanceof ln){let r=n.geometry.attributes.position;if(e.position.distanceTo(n.position)<e.near)return;for(let a=0;a<r.count;a++)Gh.fromBufferAttribute(r,a),Gh.applyMatrix4(n.matrixWorld),Gh.applyMatrix4(e.matrixWorldInverse),Gh.applyMatrix4(e.projectionMatrix),Gh.z<1&&Gh.z>0&&(b8.set(Gh.x,Gh.y),t.expandByPoint(b8))}}),t}l(l2,"projectToBox2D");function JT(i,e){let t=e.clientWidth,n=e.clientHeight;return new ft((i.x+1)*t/2,(1-i.y)*n/2)}l(JT,"ndcToScreen");function Q3e(i,e,t){let n=document.createElement("div");n.style.position="absolute",n.style.border="2px solid ".concat(e),n.style.pointerEvents="none";let r=JT(new ft(i.min.x,i.min.y),t),a=JT(new ft(i.max.x,i.max.y),t);n.style.left="".concat(r.x,"px"),n.style.top="".concat(a.y,"px");let o=Math.abs(a.x-r.x),s=Math.abs(a.y-r.y);return n.style.width="".concat(o,"px"),n.style.height="".concat(s,"px"),t.appendChild(n),n}l(Q3e,"drawProjectedBox");R();var Tv,nle=class{constructor(e,t,n,r){D(this,"id"),D(this,"externalId"),D(this,"name"),D(this,"type"),D(this,"floorIds"),D(this,"defaultFloorId"),D(this,"floorObjects",[]),D(this,"floorObjectsByElevation",new Map),D(this,"metadata"),D(this,"containerId"),D(this,"facade"),D(this,"renderer"),ge(this,Tv);var a;this.id=e.id,this.externalId=e.externalId,this.name=e.name,this.type=e.type,this.metadata=e.metadata,this.floorIds=(a=e.floors)!=null?a:e.maps,this.defaultFloorId=e.defaultFloor,this.renderer=n;let o=n.addGroupContainer(this.id,{visible:!0,interactive:!0},t);this.containerId=o.id.toString(),this.facade=r}get defaultFloor(){if(y(this,Tv)==null){if(this.floorObjects.length===0)throw new So("No floors in floor stack (".concat(this.id,"). Could not get default floor."));let e;this.defaultFloorId&&(e=this.floorObjects.find(t=>t.id===this.defaultFloorId)),e||(e=this.floorObjects.reduce((t,n)=>Math.abs(n.elevation)<Math.abs(t.elevation)?n:t)),Ce(this,Tv,e)}return y(this,Tv)}get isOutdoors(){var e;return((e=this.type)==null?void 0:e.toLowerCase())==="outdoor"?!0:this.facade!=null?!1:this.floorObjects.some(t=>t.hasFacadeGeometry)}addFloor(e){if(this.floorObjectsByElevation.has(e.elevation)){nt.error("Floor with same elevation ".concat(e.elevation," already exists in Stack (").concat(this.id,"). Floor (").concat(e.id,") will not be added."));return}e.load(),this.floorObjects.push(e),this.floorObjectsByElevation.set(e.elevation,e),this.facade&&this.renderer.setState(e.containerId,{focusable:!0}),!this.isOutdoors&&!e.hasFacadeGeometry&&e.footprint!=null&&e.addOccluder()}};Tv=new WeakMap,l(nle,"FloorStackObject");var w8=nle;R();function rle(i,e,t,n){let r={outdoorOpacity:1,floorStates:[]},a=i.sort((d,f)=>d.elevation-f.elevation),o=Math.min(0,a[0].elevation),s=a[a.length-1].elevation,u,h;for(let d=o;d<=s;d++){let f=a.find(A=>A.elevation===d);if(f==null){d>=0&&(u==null?u=d:h=d);continue}let m=0,v=d<0?Math.abs(f.elevation)*t:t,b=!1;if(u===0&&h!=null){let A=t*h;m=-A,v=A,b=!0}else if(u!=null&&h!=null){let A=u,E=i.find(C=>C.elevation===A-1),I=r.floorStates.find(C=>C.floor===E);if(I){let C=t*(h-u+2);I.state.footprint=lt(Me({},I.state.footprint),{altitude:0,height:C,visible:!0})}}u=void 0,h=void 0;let w={floor:f,state:{type:"floor",visible:!1,geometry:{visible:!1},labels:{enabled:!1},markers:{enabled:!1},footprint:{visible:!1},occlusion:{enabled:!1}}};r.floorStates.push(w),f.id===e.id?(w.state.visible=!0,w.state.geometry.visible=!0,w.state.labels.enabled=!0,w.state.markers.enabled=!0,w.state.occlusion.enabled=!0,(f.elevation<0||b)&&(f.elevation<0&&(r.outdoorOpacity=.2),w.state.footprint.height=v,w.state.footprint.altitude=m,w.state.footprint.visible=!0)):n.includes(f.id)&&f.elevation<e.elevation?(w.state.visible=!0,w.state.geometry.visible=!0,w.state.markers.enabled=!0,w.state.occlusion.enabled=!0,w.state.footprint.visible=!0,f.elevation<0?(w.state.footprint.height=v,w.state.footprint.altitude=m,r.outdoorOpacity=.2):(w.state.footprint.height=v,w.state.footprint.altitude=m)):e.elevation>0&&f.elevation<e.elevation&&f.elevation>=0&&(w.state.visible=!0,w.state.footprint.visible=!0,w.state.footprint.height=t,w.state.footprint.altitude=m)}return r}l(rle,"getMultiFloorState");var eEe={linear:so.Linear.None,easeIn:so.Quadratic.In,easeOut:so.Quadratic.Out,easeInOut:so.Quadratic.InOut},Xu,ale=class extends xr{constructor(e,t,n,r){var a,o,s,u;super(),D(this,"floorStacksById",new Map),D(this,"floorsById",new Map),D(this,"startingFloorId",""),D(this,"currentFloorId",""),D(this,"currentFloorStackId",""),D(this,"outdoorFloorStacks",new Set),D(this,"id"),D(this,"renderer"),D(this,"api"),D(this,"mvf"),D(this,"options",{}),D(this,"styleMap"),D(this,"StackedMaps"),D(this,"animations",new Map),D(this,"Models",{add:l((m,v,b)=>{let w=b,{floorId:A,scale:E}=w,I=Sc(w,["floorId","scale"]),C=A?this.floorsById.get(A):this.currentFloor,T=Me({},I);E!=null&&(T.scale=Array.isArray(b.scale)?b.scale:[b.scale,b.scale,b.scale]);let k=this.renderer.addModelGroup(m,{type:"FeatureCollection",features:v.map(F=>{var B;return{type:"Feature",properties:{id:Hn(),rotation:b.rotation,scale:T.scale,interactive:b.interactive,verticalOffset:F.verticalOffset+((B=b.verticalOffset)!=null?B:0)},geometry:{type:"Point",coordinates:ql(F)}}})},T,{parent:C.id});if(k==null)throw new So("error creating model");return this.renderer.getState(k).children},"add"),remove:l((m,v)=>{this.renderer.remove(m),this.renderer.getState(v).children.length===0&&this.renderer.remove(v)},"remove")}),D(this,"Images",{add:l((m,v,b)=>{let w=b,{floorId:A,flipImageToFaceCamera:E}=w,I=Sc(w,["floorId","flipImageToFaceCamera"]),C=A?this.floorsById.get(A):this.currentFloor,T={type:"Feature",properties:I,geometry:{type:"Point",coordinates:m}};return this.renderer.addImage(Hn(),T,{url:v,flipImageToFaceCamera:E??!1},C.id)},"add"),remove:l(m=>{this.renderer.remove(m)},"remove"),removeAll:l(()=>{},"removeAll")}),D(this,"Markers",{add:l((m,v,b)=>{let w=pP(m,this.floorsById,this.api.mapObjects[0].floorsById.get("default-floor")),A=b,{attachTo:E}=A,I=Sc(A,["attachTo"]),C=I;I.rank==="initial"&&(C.rank="medium");let T=w.layers.get(ud),k=this.renderer.addMarker2D(ql(m),v,lt(Me({},C),{occluderId:w?.occluderId,attachTo:E}),T?.containerId);if(!k)throw new So("Failed to create Marker");return k},"add"),remove:l(m=>{this.renderer.remove(m)},"remove"),getContentEl:l(m=>{let v=this.renderer.getState(m);if(v?.type==="marker")return v.element},"getContentEl"),removeAll:l(()=>{},"removeAll"),setPosition:l((m,v,b)=>{var w;let A=this.renderer.getState(m),E=b?this.floorsById.get(b):this.currentFloor;if(!A){nt.error('Failed to retrieve state for Marker with id "'.concat(m,'".'));return}if(A.type!=="marker"){nt.error('Geometry with id "'.concat(m,'" is not of type "marker".'));return}this.renderer.setState(A,{position:v,parent:(w=E?.layers.get(ud))==null?void 0:w.containerId})},"setPosition"),animateTo:l((m,v,b,w)=>{let A=this.renderer.getState(m),E=b?this.floorsById.get(b):this.currentFloor;if(!A)return nt.error('Failed to retrieve state for Marker with id "'.concat(m,'".')),Promise.resolve();if(A.type!=="marker")return nt.error('Geometry with id "'.concat(m,'" is not of type "marker".')),Promise.resolve();let I=Me({duration:1e3,easing:"ease-in-out"},w);this.cancelAnimation(m);let C=new dh({lon:A.position[0],lat:A.position[1]}).to({lon:v[0],lat:v[1]},I.duration).easing(eEe[I.easing]).onUpdate(({lon:T,lat:k})=>{var F;if(!this.renderer.getState(m))this.cancelAnimation(m);else{let B=(F=E?.layers.get(ud))==null?void 0:F.containerId;B&&this.Markers.setPosition(m,[T,k],B)}}).start();return this.renderer.getInternalTweenGroup().add(C),this.renderer.render(),this.animations.set(m,C),cP(C).then(()=>{this.animations.delete(m)})},"animateTo")}),D(this,"Exporter",{getCurrentSceneGLTF:l(async m=>this.renderer.getCurrentSceneGLTF(m),"getCurrentSceneGLTF")}),D(this,"Shapes",{add:l((m,v,b)=>{let w=b!=null&&b.floorId?this.floorsById.get(b?.floorId):this.currentFloor,A="shape-"+Hn();return this.renderer.addGeometryGroup(A,m,v,w.id),A},"add"),remove:l(m=>(this.renderer.remove(m.id),m.id),"remove")}),D(this,"Text3D",{label:l((m,v,b)=>{var w;if(!((w=this.api.getMapDataInternal())!=null&&w.enterpriseMode)){nt.warn("Enterprise mode is not enabled, skipping label creation");return}let A=KT(this.renderer,m,v,b);if(A)return{textInfo:A,target:m}},"label"),labelAll:l((m={})=>{var v;if(!((v=this.api.getMapDataInternal())!=null&&v.enterpriseMode))return nt.warn("Enterprise mode is not enabled, skipping label creation"),[];let b=this.api.getMapData();if(!b)return[];let w=[];return b.getByType("space").forEach(A=>{var E,I;if(A.locations[0]){let C=KT(this.renderer,A,(I=(E=A.locations[0])==null?void 0:E.name)!=null?I:A.name,m);C&&w.push({textInfo:C,target:A})}}),w},"labelAll"),remove:l(m=>{var v;if(!((v=this.api.getMapDataInternal())!=null&&v.enterpriseMode)){nt.warn("Remove text label only works in enterprise mode");return}return this.renderer.remove(m),m},"remove")}),D(this,"Labels",{all:l(({onCreate:m,labelOptions:v={}})=>{for(let b of Object.entries(this.mvf.space)){let[w,A]=b;A&&A.features.forEach(E=>{var I,C,T,k,F;let B=(I=this.api.getMapData())==null?void 0:I.getById("space",E.properties.id);if(!B)return;let N=(C=this.styleMap[E.properties.id])==null?void 0:C.showImage,z=(T=E.properties.details)==null?void 0:T.images,L=N&&(k=z?.[0])!=null&&k.url?{icon:z[0].url}:{},j=Me({marker:Me(Me({},L),(F=v.appearance)==null?void 0:F.marker)},v.appearance),q=(w?this.floorsById.get(w):this.currentFloor).layers.get(Sg);if(E.properties.center&&B.name!==""){let Z=this.renderer.addLabel2D(E.properties.center,B.name,lt(Me({id:E.properties.id+"-label"},v),{appearance:j,rank:v.rank,attachTo:YA(B)}),ru.is(B)?B.id:q?.containerId);Z&&m(Z.id,B.name,B)}})}},"all"),add:l((m,v,b={})=>{let w=b,{attachTo:A}=w,E=Sc(w,["attachTo"]),I=pP(m,this.floorsById,this.api.mapObjects[0].floorsById.get("default-floor")),C=I.layers.get(Sg),T=this.renderer.addLabel2D(ql(m),v,lt(Me({},E),{occluderId:I.occluderId,attachTo:A}),C?.containerId);if(!T)throw new So("label creating failed");return T},"add"),remove:l(({entityId:m})=>{this.renderer.remove(m)},"remove"),removeAll:l(()=>{},"removeAll")}),D(this,"Paths",{add:l((m,v)=>{var b;let w=(b=v?.animateDrawing)!=null?b:!0,A=[],E=m[0].floorId||"root",I=0;for(let T of m){let{floorId:k="root",latitude:F,longitude:B}=T;k!==E&&(I++,E=k),A[I]==null&&A.push({floorId:k,coordinates:[]});let N=k===T.floorId?T:new Wn({longitude:B,latitude:F,floorId:k});A[I].coordinates.push(N)}let C=A.reduce((T,{floorId:k,coordinates:F},B)=>{if(B!==0){let z=A[B-1],L=z.coordinates[z.coordinates.length-1],j=F[0],q=ql(L),Z=ql(j),O=this.renderer.addPath({type:"FeatureCollection",features:[{type:"Feature",properties:{parentId:z.floorId},geometry:{type:"Point",coordinates:q}},{type:"Feature",properties:{parentId:k},geometry:{type:"Point",coordinates:Z}}]},v,this.id);O&&(v!=null&&v.animateDrawing&&this.renderer.setState(O.id,{completeFraction:0}),T.push(lt(Me({},O),{coordinates:[L,j]})))}let N=this.renderer.addPath({type:"FeatureCollection",features:F.map(z=>({type:"Feature",properties:{},geometry:{type:"Point",coordinates:ql(z)}}))},v,k);return N&&(v!=null&&v.animateDrawing&&this.renderer.setState(N.id,{completeFraction:0}),T.push(lt(Me({},N),{coordinates:F}))),T},[]);if(w){let T=[],k=this.api.getMapData();return C.forEach(F=>{var B;let N=qle(F,k,this.api);T.push(new dh({fraction:0}).to({fraction:1},N===!1?0:(B=v?.drawDuration)!=null?B:1500).onUpdate(z=>{this.renderer.setState(F.id,{completeFraction:z.fraction})}))}),T.forEach((F,B)=>{B<T.length-1&&F.chain(T[B+1]),this.renderer.getInternalTweenGroup().add(F)}),T[0].start(),this.renderer.render(),this.animations.set(C[0].id.toString(),T[0]),{paths:C,animation:cP(T[T.length-1]).then(()=>{this.animations.delete(C[0].id.toString())})}}else return{paths:C,animation:Promise.resolve()}},"add"),remove:l(m=>{m.forEach(v=>{this.cancelAnimation(v),this.renderer.remove(v)})},"remove")}),ge(this,Xu,{enabled:!1,floorHeight:10,updateCameraElevationOnFloorChange:!0}),this.renderer=r.core,this.api=r,this.id=e,this.renderer.addGroupContainer(e,{},"root"),this.options=n??{},this.StackedMaps=new K3e({currentMapGetter:l(()=>this,"currentMapGetter")}),this.mvf=(a=t?.mvf)!=null?a:{};let h=$le(this.mvf["styles.json"]||{});if(this.styleMap=h,Ce(this,Xu,Me({enabled:!1,floorHeight:10,updateCameraElevationOnFloorChange:!0},n?.multiFloorView)),!t){this.id!=="outdoors-container"&&nt.warn("Map (".concat(this.id,") created with no data."));let m=new w8({id:"default-stack",externalId:"default-stack",name:"Default Stack",maps:["default-floor"]},this.id,this.renderer);this.floorStacksById.set(m.id,m),this.currentFloorStackId=m.id;let v=new v8(m.id,{id:"default-floor",externalId:"default-floor",name:"Default Floor",elevation:0},this.renderer,y(this,Xu),n??{});m.addFloor(v),this.floorsById.set(v.id,v),this.setFloor(v.id);return}let d=t.getMVFFeatureByType("floor-stack");if(d==null||d.length===0)throw new So("MVF does not contain any Floor Stacks.");for(let m of d){let v=new w8(m,this.id,this.renderer,(o=this.mvf.facade)==null?void 0:o[m.id]);if(v.floorIds.length!==0){for(let b of v.floorIds){let w=t.getMVFFeatureById("floor",b);if(w!=null){let A=this.mvf.space[w.id],E=this.mvf.obstruction[w.id];if((A==null||A.features.length===0)&&(E==null||E.features.length===0))continue;let I=new v8(v.id,w,this.renderer,y(this,Xu),n??{},this.mvf,h,t);v.addFloor(I),this.floorsById.set(I.id,I)}}this.floorStacksById.set(m.id,v),this.currentFloorStackId||(this.currentFloorStackId=m.id)}}for(let[m]of Object.entries(t.facadesBySpaceId)){let v=t.getById("space",m);v&&(this.outdoorFloorStacks.add(v.floor.floorStack.id),(s=this.floorsById.get(v.floor.id))==null||s.setVisible(!0))}let f=(u=this.mvf.enterprise)==null?void 0:u.venue.defaultMap;if(n!=null&&n.initialFloor){let m=ww(n.initialFloor);m&&this.floorsById.has(m)?f=m:nt.error("Invalid initial floor specified (".concat(n.initialFloor,"), using default behavior instead"))}f||(f=this.currentFloorStack.defaultFloor.id),this.startingFloorId=f}get currentFloorStack(){let e=this.floorStacksById.get(this.currentFloorStackId);if(!e)throw new So('Current floor stack with id "'.concat(this.currentFloorStackId,'" not found'));return e}setFloorStack(e,t){if(this.currentFloorStackId===e)return;let n=this.floorStacksById.get(e);if(n==null){nt.error("Invalid floor stack passed to setFloorStack (".concat(e,"), the floor stack was not changed. Current floor stack is still ").concat(this.currentFloorStack.id,"."));return}if(n.floorObjects.length===0){nt.error("Floor stack (".concat(e,") has no floors. The floor stack was not changed. Current floor stack is still ").concat(this.currentFloorStack.id,"."));return}this.setFloor(n.defaultFloor.id,t)}get currentFloor(){let e=this.floorsById.get(this.currentFloorId);if(!e)throw new So('Floor with id "'.concat(this.currentFloorId,'" not found'));return e}get floors(){return Array.from(this.floorsById.values())}processFloorChange(e){var t,n,r,a,o,s,u;if(this.api.manualFloorVisibility===!0||this.StackedMaps.expandedFactor!==0)return;let h=(t=this.api.getMapDataInternal())==null?void 0:t.getById("floor",e),d=(n=this.api.getMapDataInternal())==null?void 0:n.getById("floor-stack",this.currentFloorStackId);if(h&&d)if(!((r=y(this,Xu))!=null&&r.enabled)||h.floorStack.id!==d?.id)for(let f of this.floorStacksById.values())f.floorObjects.forEach(m=>{m.id!==e&&m.setVisible(!1)});else{let f=rle(d.floors,h,y(this,Xu).floorHeight,((o=(a=this.api.Navigation)==null?void 0:a.floors)==null?void 0:o.map(m=>m.id))||[]);(u=(s=this.api)==null?void 0:s.Outdoor)==null||u.setOpacity(f.outdoorOpacity),f.floorStates.forEach(m=>{var v;if(m.floor){let b=(v=this.api.getMapData())==null?void 0:v.getById("floor",m.floor.id);b&&this.api.updateState(b,m.state)}}),y(this,Xu).updateCameraElevationOnFloorChange&&this.api.Camera.setElevation(h.elevation*y(this,Xu).floorHeight)}}setFloor(e,t){if(this.currentFloorId===e)return;if(!this.floorsById.get(e)){nt.error("Invalid floor passed to setFloor (".concat(e,"), the floor was not changed. Current floor is still ").concat(this.currentFloor.id));return}let n=this.currentFloorId;this.publish("floor-change-start",{previousFloorId:n,floorId:e,reason:t}),!this.StackedMaps.expanded&&this.currentFloorStack&&this.processFloorChange(e),this.currentFloorId=e,this.currentFloorStackId=this.currentFloor.floorStackId,this.currentFloor.setVisible(!0),this.hideImagesOnAllFloorsExceptCurrent(),this.publish("floor-change",{reason:t,floorId:this.currentFloor.id,previousFloorId:n})}hideImagesOnAllFloorsExceptCurrent(){var e,t;if(this.options.hideImagesNotOnCurrentFloor&&!((e=this.options.multiFloorView)!=null&&e.enabled))for(let n of this.floorsById.values())(t=n.layers.get(Mg))==null||t.setVisible(n.id===this.currentFloor.id)}cancelAnimation(e){let t=this.animations.get(e);t&&(t.stop(),this.animations.delete(e),this.renderer.getInternalTweenGroup().remove(t))}};Xu=new WeakMap,l(ale,"GeojsonApiMapObject");var A8=ale;function KT(i,e,t,n){return i.labelText3D(e.id,t??e.name,lt(Me({},n),{parentId:e.floor.id}))}l(KT,"labelSpace");R();var Nl,u2,ole=class{constructor({currentMapGetter:e}){ge(this,Nl,new Map),ge(this,u2),Ce(this,u2,e)}get currentMap(){return y(this,u2).call(this)}getById(e){return y(this,Nl).get(e)}add(e,t,n){let r=e.anchorTarget;if(!r)throw new Error("get coordinate failed");let a=this.currentMap;if(!a)throw new Error("currentMap should exist");let o=a.Markers.add(r,t,lt(Me({},n),{rank:n?.rank||"medium",dynamicResize:n?.dynamicResize||!1,attachTo:YA(e)}));if(o==null)throw new Error("error creating marker");let s=a.Markers.getContentEl(o.id.toString());if(!s)throw new Error("marker component should exist");let u=new QD(o.id.toString(),s,e);return y(this,Nl).set(u.id,{marker:u,entityId:o.id.toString()}),u}remove(e){var t;let n=y(this,Nl).get(e.id);n&&((t=this.currentMap)==null||t.Markers.remove(n.entityId),y(this,Nl).delete(e.id.toString()))}removeAll(){let e=[];return y(this,Nl).forEach(({marker:t})=>{this.remove(t),e.push(t),y(this,Nl).delete(t.id.toString())}),e}setPosition(e,t){var n;let r=t.anchorTarget;if(!r){nt.error("Cannot determine coordinate from target.");return}let a=this.currentMap;if(!a){nt.error("Cannot determine the current map.");return}let o=y(this,Nl).get(e.id);if(!o){nt.error('Cannot find the Marker with id "'.concat(e.id,'".'));return}a.Markers.setPosition(o.entityId,ql(r),(n=r.floorId)!=null?n:a.currentFloorId),o.marker.updateTarget(t)}animateTo(e,t,n){var r;let a=t.anchorTarget;if(!a)return nt.error("Cannot determine coordinate from target."),Promise.resolve();let o=this.currentMap;if(!o)return nt.error("Cannot determine the current map."),Promise.resolve();let s=y(this,Nl).get(e.id);return s?(s.marker.updateTarget(t),o.Markers.animateTo(s.entityId,ql(a),(r=a.floorId)!=null?r:o.currentFloorId,n)):(nt.error('Cannot find the Marker with id "'.concat(e.id,'".')),Promise.resolve())}};Nl=new WeakMap,u2=new WeakMap,l(ole,"Markers");var tEe=ole;R();var oc,h2,sle=class{constructor({currentMapGetter:e}){ge(this,oc,new Map),ge(this,h2),Ce(this,h2,e)}get currentMap(){return y(this,h2).call(this)}getById(e){return y(this,oc).get(e)}add(e,t,n){var r;let a=e.anchorTarget;if(!a)throw new Error("Target does not implement IAnchorable.");let o=this.currentMap;if(!o)throw new Error("currentMap should exist");let s=o.Images.add(ql(a),t,lt(Me({},n),{floorId:a.floorId,verticalOffset:a.verticalOffset+((r=n.verticalOffset)!=null?r:0)}));if(!s)throw new Error("image component should exist");let u=new L3e(s.id.toString(),t,e);return y(this,oc).set(u.id,{image:u,entityId:s.id.toString()}),u}remove(e){var t;let n=y(this,oc).get(e.id);n&&((t=this.currentMap)==null||t.Images.remove(n.entityId),y(this,oc).delete(e.id.toString()))}removeAll(){let e=[];return y(this,oc).forEach(({image:t})=>{this.remove(t),e.push(t),y(this,oc).delete(t.id.toString())}),e}};oc=new WeakMap,h2=new WeakMap,l(sle,"Images");var iEe=sle;R();var Zu,c2,lle=class{constructor({currentMapGetter:e}){ge(this,Zu,new Map),ge(this,c2),Ce(this,c2,e)}get currentMap(){return y(this,c2).call(this)}getById(e){return y(this,Zu).get(e)}add(e,t,n){let r=[e],a=r.reduce((u,h)=>{var d;return h?(u.has(h.floorId)||u.set(h.floorId,[]),(d=u.get(h.floorId))==null||d.push(h),u):(nt.error("Cannot determine coordinate from options."),u)},new Map);if(!r.length)throw new Error("targets should not be empty when adding a model");let o=this.currentMap;if(!o)throw new Error("currentMap should exist");let s=[];return a.forEach((u,h)=>{let d=Hn();o.Models.add(d,u,lt(Me({},n),{url:t,floorId:h})).forEach(({id:f})=>{let m=new Fse(f.toString(),d,u[0]);y(this,Zu).set(m.id,{model:m,entityId:f.toString(),groupId:d}),s.push(m)})}),s[0]}remove(e){var t;let n=y(this,Zu).get(e.id);n&&((t=this.currentMap)==null||t.Models.remove(n.entityId,n.groupId),y(this,Zu).delete(e.id.toString()))}removeAll(){let e=[];return y(this,Zu).forEach(({model:t})=>{var n;let r=y(this,Zu).get(t.id);r&&(e.push(t),(n=this.currentMap)==null||n.Models.remove(r.entityId,r.groupId),y(this,Zu).delete(t.id.toString()))}),e}};Zu=new WeakMap,c2=new WeakMap,l(lle,"Models");var nEe=lle;R();var Yu,p2,ule=class{constructor({currentMapGetter:e}){ge(this,Yu,new Map),ge(this,p2),Ce(this,p2,e)}get currentMap(){return y(this,p2).call(this)}getById(e){return y(this,Yu).get(e)}add(e,t){let n=this.currentMap;if(!n)throw new Error("currentMap should exist");let r=n.Paths.add(e,t),a=r.paths.map(s=>s.id.toString()),o=new j1(Hn(),r.animation,e,r.paths);for(let s of a)y(this,Yu).set(s,{path:o,entityIds:a});return y(this,Yu).set(o.id,{path:o,entityIds:a}),o}remove(e){var t;let n=y(this,Yu).get(e.id);n&&((t=this.currentMap)==null||t.Paths.remove(n.entityIds),y(this,Yu).delete(e.id),n.entityIds.forEach(r=>y(this,Yu).delete(r)))}removeAll(){let e=[];return y(this,Yu).forEach(({path:t})=>{this.remove(t),e.push(t)}),e}};Yu=new WeakMap,p2=new WeakMap,l(ule,"Paths");var rEe=ule;R();R();var aEe=ii(Kee(),1);R();var QT="blue-dot",oEe="blue-dot-accuracy-ring",EM="#2266ff",sEe="#808080",lEe="#f5f5f5",uEe={radius:10,color:EM,inactiveColor:sEe,heading:{color:EM,opacity:.7},accuracyRing:{color:EM,opacity:.3},timeout:3e4,watchDevicePosition:!0,debug:!1};R();var hEe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAkklEQVRoge3awQ3AIAxD0VAMYf+F0yUixbL8JshXuLSwIqJCwDc9QBeZEOy9p2doAQDTM7TQ2cg5Z3qGFjpHS2YjDiGDe+/0DC0cwkYpJKdnaIFMkY1kymzEIVQcwsYhbPDem56hhc5GHELGIWwcwsYhbJS+2R1CxSFsdH5iO4SMr97Y6FxPqxytVVV+HcTEIWx+9mcIqHSOm9QAAAAASUVORK5CYII=";R();var cEe=l((i,e,t=0)=>{if(Math.abs(i)>=Math.PI)throw new Error("Sector angle too wide!");let n=t/Math.tan(i/2),r=t/Math.sin(i/2),a=r+e,o=10,s=new Og;s.moveTo(-r*Math.sin(i/2),r*Math.cos(i/2)-n);for(let u=0;u<o;u++)s.lineTo(-(a*Math.sin(i/2-i/o*u)),a*Math.cos(i/2-i/o*u)-n);for(let u=0;u<o;u++)s.lineTo(-(t*Math.sin(Math.PI/-2+Math.PI/o*u)),t*Math.cos(Math.PI/-2+Math.PI/o*u));return new q1(s,{depth:.1,bevelEnabled:!1,UVGenerator:pEe(e)})},"createSectorGeometry"),IM=l((i,e,t)=>{let n=Math.sqrt(Math.pow(i,2)+Math.pow(e,2))/t;return n>1?n=1:n<0&&(n=0),new ft(0,n)},"generateRadialUV"),pEe=l(i=>({generateTopUV:l((e,t,n,r,a)=>{let o=t[n*3],s=t[n*3+1],u=t[r*3],h=t[r*3+1],d=t[a*3],f=t[a*3+1];return[IM(o,s,i),IM(u,h,i),IM(d,f,i)]},"generateTopUV"),generateSideWallUV:l(()=>[new ft(0,1),new ft(0,1),new ft(0,1),new ft(0,1)],"generateSideWallUV")}),"radialUVGenerator");function hle(i,e){if(e==null)return i;let t={latitude:i?.latitude,longitude:i?.longitude,accuracy:i?.accuracy,floor:i?.floor,heading:i?.heading};return"latitude"in e&&(t.latitude=e?.latitude==null||e.latitude==="device"?i?.latitude:e.latitude),"longitude"in e&&(t.longitude=e.longitude==null||e.longitude==="device"?i?.longitude:e.longitude),"accuracy"in e&&(t.accuracy=e.accuracy==="device"?i?.accuracy:e.accuracy),"floor"in e&&(t.floor=e.floor==="device"?i?.floor:e.floor),"heading"in e&&(t.heading=e.heading==="device"?i?.heading:e.heading),t}l(hle,"getPositionWithOverrides");function cle([i,e],[t,n],[r,a]){let o=t-i,s=n-e,u=o**2+s**2;if(u===0)return;let h=((r-i)*o+(a-e)*s)/u,d;h<=0?d=[i,e]:h>=1?d=[t,n]:d=[i+h*o,e+h*s];let f=zL([r,a],d);return{proportion:Math.max(0,Math.min(1,h)),intersection:d,distance:f}}l(cle,"getPointLineIntersection");function ple(i,e){if(i==null||i.length<2)return;let t=Number.MAX_SAFE_INTEGER,n,r=0,a=0;for(let o=0;o<i.length-1;o++){let s=i[o],u=i[o+1],h=cle(s,u,e);h!=null&&h.distance<t&&(t=h.distance,n=h.intersection,r=o,a=h.proportion)}if(n)return{intersection:n,distance:t,segmentIndex:r,proportion:a}}l(ple,"findBlueDotOnPath");function dle(i,e){let t=new cg({color:i,opacity:e,transparent:!0,depthTest:!1,depthWrite:!1}),n=.35,r=.35*4,a=cEe(Math.PI/6,r,n);new qP().load(hEe,s=>{t.alphaMap=s,t.needsUpdate=!0});let o=new ln(a,t);return o.position.z=-.05,o.renderOrder=0,o}l(dle,"createHeadingCone");function fle(i,e){let t=new MC(1,1,.05,32),n=new cg({transparent:!0,color:i,opacity:e,depthTest:!1,depthWrite:!1}),r=new ln(t,n);return r.scale.set(0,0,.05),r.renderOrder=1,r.rotation.x=Math.PI/2,r}l(fle,"createAccuracyRing");function mle(i){let e=new MC(.35,.35,.07,32),t=new cg({transparent:!0,color:lEe,depthTest:!1,depthWrite:!1}),n=new ln(e,t);n.renderOrder=2;let r=new MC(.35*.8,.35*.8,.01,32),a=new cg({transparent:!0,color:i,depthTest:!1,depthWrite:!1}),o=new ln(r,a);return o.renderOrder=3,n.rotation.x=Math.PI/2,n.position.z=.07/2,o.rotation.x=Math.PI/2,o.position.z=.07,{outerMesh:n,innerMesh:o}}l(mle,"createBlueDot");var dEe=ii(Cwe(),1),Fn,or,am,sc,Ps,Ls,lc,om,sm,lm,ua,rs,d2,uc,f2,m2,g2,eP,tP,y2,iP,v2,nP,Ju,hc,rP,kp,Pv,Ku,_2,gle=class{constructor(e,t){ge(this,Fn),ge(this,or),ge(this,am,null),D(this,"primaryGeometry"),D(this,"secondaryGeometry"),ge(this,sc),ge(this,Ps),ge(this,Ls),ge(this,lc),ge(this,om),ge(this,sm),ge(this,lm),ge(this,ua,uEe),ge(this,rs,1),ge(this,d2),ge(this,uc),D(this,"bounds"),D(this,"state","disabled"),D(this,"following",!1),ge(this,f2,l(n=>{var r;return(r=y(this,or).getMapData())==null?void 0:r.getById("floor",n)},"#getFloorByFloorId")),ge(this,m2,l(n=>{var r;let a;if(n!=null){let o=(r=y(this,or).currentMap)==null?void 0:r.currentFloorStack.floorObjectsByElevation.get(n);a=o?y(this,f2).call(this,o.id):void 0}return a},"#getFloorByFloorLevel")),ge(this,g2,l(()=>this.state!=="hidden"&&this.state!=="disabled","#shouldUpdateGeometry")),ge(this,eP,l((n,r)=>{y(this,nP).call(this),n.scale.set(y(this,rs),y(this,rs),y(this,rs)),n.position.z=.07/2*y(this,rs),r.scale.set(y(this,rs),y(this,rs),y(this,rs)),r.position.z=.07*y(this,rs),this.state==="active"?r.material.color.set(y(this,ua).color):this.state==="inactive"&&r.material.color.set(y(this,ua).inactiveColor)},"#updatePrimaryGeometry")),ge(this,tP,l((n,r)=>{if(this.state==="active"){let a=this.accuracy;a!=null?(n.visible=!0,y(this,sm)&&y(this,sm).stop(),Ce(this,sm,new dh({scale:n.scale.x}).to({scale:a/2},150).onUpdate(({scale:s})=>{n.scale.set(s,1,s)}).start()),y(this,Fn).getInternalTweenGroup().add(y(this,sm))):n.visible=!1;let o=this.heading;if(o!=null){r.visible=!0,y(this,lm)&&y(this,lm).stop();let{start:s,end:u}=UL(r.rotation.z,-Bn.degToRad(o));Ce(this,lm,new dh({rotation:s}).to({rotation:u},150).onUpdate(({rotation:h})=>{r.rotation.z=h}).start()),y(this,Fn).getInternalTweenGroup().add(y(this,lm)),r.scale.set(y(this,rs),y(this,rs),1)}else r.visible=!1}else this.state==="inactive"&&(r.visible=!1,n.visible=!1)},"#updateSecondaryGeometry")),ge(this,y2,l(n=>{if(!y(this,g2).call(this))return;let[r,a]=n.children;y(this,eP).call(this,r,a)},"#updatePrimaryGeometryPerFrame")),ge(this,iP,l(n=>{if(!y(this,g2).call(this))return;let[r,a]=n.children;y(this,tP).call(this,r,a)},"#updateSecondaryGeometryPerFrame")),ge(this,v2,l(n=>{var r,a;let o;try{o=yEe.parse(hle(n,y(this,Ps)))}catch(f){y(this,Ju).call(this,"error"),nt.error("BlueDot: Position parse failed",f instanceof $e.ZodError?f.message:String(f));return}y(this,ua).debug&&nt.log("BlueDot: Parsed position",o);let{min:s,max:u}=this.bounds||{};if(s!=null&&u!=null&&isFinite(s.x)&&isFinite(s.y)&&isFinite(u.x)&&isFinite(u.y)){let f=y(this,Fn).convertTo3DMapPosition(o.latitude,o.longitude,0);if(!(f.x>=s.x&&f.x<=u.x&&f.y>=s.y&&f.y<=u.y)){nt.warn("BlueDot: Position [".concat(o.longitude,", ").concat(o.latitude,"] is outside map bounds. Position update will be discarded."));return}}Ce(this,Ls,o),y(this,Ju).call(this,"position-update"),y(this,lc)&&clearTimeout(y(this,lc)),typeof y(this,ua).timeout=="number"&&y(this,ua).timeout<1/0&&Ce(this,lc,setTimeout(()=>{y(this,ua).debug&&nt.log("BlueDot: Position timed out after ".concat(y(this,ua).timeout,"ms")),y(this,Ju).call(this,"timeout"),y(this,Fn).render()},y(this,ua).timeout)),(a=y(this,or).getMapDataInternal())==null||a.Analytics.updateState({userPosition:{bluedotTimestamp:Date.now(),latitude:o.latitude,longitude:o.longitude,floorLevel:(r=o.floor)==null?void 0:r.elevation,accuracy:o.accuracy}});let h=o.floor!=null?o.floor.id:y(this,or).currentFloor.id||"outdoors-container",d=[o.longitude,o.latitude];if(!this.primaryGeometry)this.primaryGeometry=y(this,Fn).addCustomGeometry(QT,{type:"Feature",properties:{},geometry:{type:"Point",coordinates:d}},{setup:l(f=>{let{outerMesh:m,innerMesh:v}=mle(y(this,ua).color);f.add(m),f.add(v),y(this,y2).call(this,f)},"setup"),update:y(this,y2)},{visible:!0,interactive:!0},h),this.secondaryGeometry=y(this,Fn).addCustomGeometry(oEe,{type:"Feature",properties:{},geometry:{type:"Point",coordinates:d}},{setup:l(f=>{let m=fle(y(this,ua).accuracyRing.color,y(this,ua).accuracyRing.opacity),v=dle(y(this,ua).heading.color,y(this,ua).heading.opacity);f.add(m),m.visible=!1,f.add(v),v.visible=!1},"setup"),update:y(this,iP)},{visible:!0,interactive:!1},h);else{let f=y(this,Fn).getState(this.primaryGeometry);d=[f.position[0],f.position[1]]}y(this,om)&&y(this,om).stop(),Ce(this,om,new dh(d).to([o.longitude,o.latitude],1e3).easing(so.Cubic.Out).onUpdate(f=>{let m={position:[f[0],f[1]]};m.parent=h,this.primaryGeometry&&this.secondaryGeometry&&y(this,Fn).setState(this.primaryGeometry,m),this.secondaryGeometry&&y(this,Fn).setState(this.secondaryGeometry,m)}).start()),y(this,Fn).getInternalTweenGroup().add(y(this,om)),y(this,or).publish("blue-dot-position-update",{floor:this.floor,heading:this.heading,accuracy:this.accuracy,coordinate:this.coordinate}),y(this,Fn).render()},"#setPosition")),D(this,"onPositionUpdate",l(n=>{var r,a,o,s,u;if(this.state!=="disabled"){try{gEe.parse(n)}catch(h){y(this,Ju).call(this,"error"),nt.error("BlueDot: Browser sent invalid position",h instanceof $e.ZodError?h.message:String(h));return}Ce(this,sc,{latitude:(r=n.coords)==null?void 0:r.latitude,longitude:(a=n.coords)==null?void 0:a.longitude,accuracy:(o=n.coords)==null?void 0:o.accuracy,heading:(s=n.coords)==null?void 0:s.heading,floor:y(this,m2).call(this,(u=n.coords)==null?void 0:u.floorLevel)}),y(this,v2).call(this,y(this,sc))}},"onPositionUpdate")),D(this,"onPositionError",l(n=>{var r;switch(y(this,Ju).call(this,"error"),n.code){case n.PERMISSION_DENIED:nt.error("Geolocation permission denied by the user.",n),(r=y(this,or).getMapDataInternal())==null||r.Analytics.sendWatchPositionDenied();break;case n.POSITION_UNAVAILABLE:nt.error("Geolocation position unavailable.",n);break;case n.TIMEOUT:nt.error("Geolocation request timed out.",n);break;default:nt.error("An unknown geolocation error occurred.",n);break}y(this,or).publish("blue-dot-position-error",n)},"onPositionError")),ge(this,nP,l(()=>{var n;let r=Math.round(y(this,Fn).camera.zoomLevel*1e5);if(r!==y(this,d2)){Ce(this,d2,r);let a=(n=y(this,Fn).getMetresPerPixel())!=null?n:1;Ce(this,rs,Math.max(y(this,ua).radius/(.35/a),1))}},"#updateScale")),ge(this,Ju,l(n=>{let r=mEe[this.state].actions[n];if(r){switch(y(this,ua).debug&&nt.log("BlueDot: Transitioning from ".concat(this.state," to ").concat(r," using ").concat(n)),r){case"hidden":case"disabled":this.primaryGeometry&&y(this,Fn).setState(this.primaryGeometry,{visible:!1}),this.secondaryGeometry&&y(this,Fn).setState(this.secondaryGeometry,{visible:!1});break;case"active":this.primaryGeometry&&y(this,Fn).setState(this.primaryGeometry,{visible:!0}),this.secondaryGeometry&&y(this,Fn).setState(this.secondaryGeometry,{visible:!0});break}this.state!==r&&(this.state=r,y(this,or).publish("blue-dot-state-change",{state:r,action:n}))}else nt.warn("BlueDot: Invalid state transition from ".concat(this.state," to ").concat(r," using ").concat(n))},"#transitionAction")),ge(this,hc),ge(this,rP,l(()=>{if(y(this,hc)==null&&y(this,or).Navigation.activeDirections!=null){let n=(Array.isArray(y(this,or).Navigation.activeDirections)?y(this,or).Navigation.activeDirections.flatMap(r=>r.coordinates):y(this,or).Navigation.activeDirections.coordinates).filter(r=>r.floorId===y(this,or).currentFloor.id);Ce(this,hc,(0,dEe.default)(n.map(r=>({x:r.longitude,y:r.latitude})),1e-5).map(r=>[r.x,r.y]))}return y(this,hc)},"#getSimplifiedDirections")),ge(this,kp,l(()=>{y(this,Fn).camera.isAnimating&&y(this,Fn).camera.cancelAnimation(),y(this,Ku)&&(y(this,or).off("blue-dot-position-update",y(this,Ku)),Ce(this,Ku,void 0)),this.following=!1,Ce(this,hc,void 0),y(this,Fn).off("user-interaction-start",y(this,kp)),y(this,or).off("navigation-active-path-change",y(this,Pv)),y(this,or).publish("blue-dot-follow-change",{following:!1})},"#cancelFollow")),ge(this,Pv,l(()=>{Ce(this,hc,void 0)},"#pathChangeHandler")),ge(this,Ku),D(this,"follow",l((n,r)=>{var a,o,s,u;if(n===!1){y(this,kp).call(this);return}n!=="position-only"&&r?.bearing!=null&&nt.warn("BlueDot: Camera bearing option will be ignored in follow mode '".concat(n,"'. To control the bearing manually, use mode 'position-only'."));let h={zoomLevel:(a=r?.zoomLevel)!=null?a:21,bearing:n==="position-only"?r?.bearing:void 0,pitch:(o=r?.pitch)!=null?o:45,duration:(s=r?.duration)!=null?s:1e3,easing:(u=r?.easing)!=null?u:"ease-in-out"};this.following?y(this,Ku)&&y(this,or).off("blue-dot-position-update",y(this,Ku)):(this.following=!0,y(this,Fn).on("user-interaction-start",y(this,kp)),y(this,or).on("navigation-active-path-change",y(this,Pv))),Ce(this,Ku,d=>{let{coordinate:f,heading:m,floor:v}=d;if(h.center=[f.longitude,f.latitude],v!=null&&v.id!==y(this,or).currentFloor.id&&(y(this,or).currentMap.setFloor(v.id),Ce(this,hc,void 0)),n==="position-and-heading")h.bearing=m??void 0;else if(n==="position-and-path-direction"){let b=y(this,rP).call(this);if(b!=null){let w=ple(b,[f.longitude,f.latitude]);if(w!=null){let A=b[w.segmentIndex],E=b[w.segmentIndex+1];h.bearing=LQ(A,E)}}}y(this,Fn).camera.animateTo(h)}),y(this,or).on("blue-dot-position-update",y(this,Ku)),y(this,or).publish("blue-dot-follow-change",{following:!0,mode:n})},"follow")),ge(this,_2,l(n=>{this.bounds=n},"#handlePanBoundsChange")),Ce(this,Fn,e),Ce(this,or,t)}get heading(){var e;return(e=y(this,Ls))==null?void 0:e.heading}get accuracy(){var e;return(e=y(this,Ls))==null?void 0:e.accuracy}get coordinate(){var e,t;if(y(this,Ls)!=null)return(y(this,uc)==null||((e=this.floor)==null?void 0:e.id)!==y(this,uc).floorId||y(this,Ls).latitude!==y(this,uc).latitude||y(this,Ls).longitude!==y(this,uc).longitude)&&Ce(this,uc,new Wn(y(this,Ls).latitude,y(this,Ls).longitude,(t=this.floor)==null?void 0:t.id)),y(this,uc)}get floor(){var e;return(e=y(this,Ls))==null?void 0:e.floor}enable(e){Ce(this,ua,(0,aEe.default)({},e,y(this,ua))),y(this,Ju).call(this,"enable"),this.watchDevicePosition(y(this,ua).watchDevicePosition),this.bounds||(this.bounds=y(this,Fn).getSystems().cameraSystem.panBounds,y(this,Fn).on("pan-bounds-change",y(this,_2)))}disable(){this.primaryGeometry&&(y(this,Fn).remove(this.primaryGeometry.id),this.primaryGeometry=void 0),this.secondaryGeometry&&(y(this,Fn).remove(this.secondaryGeometry.id),this.secondaryGeometry=void 0),y(this,lc)&&(clearTimeout(y(this,lc)),Ce(this,lc,void 0)),this.following&&y(this,kp).call(this),this.watchDevicePosition(!1),Ce(this,Ls,void 0),Ce(this,Ps,void 0),y(this,Ju).call(this,"disable"),y(this,Fn).off("user-interaction-start",y(this,kp)),y(this,or).off("navigation-active-path-change",y(this,Pv)),y(this,Fn).off("pan-bounds-change",y(this,_2))}watchDevicePosition(e){if(y(this,am)&&(navigator.geolocation.clearWatch(y(this,am)),Ce(this,am,null)),y(this,sc)&&Ce(this,sc,void 0),e){if(this.state==="disabled"){nt.warn("BlueDot must be enabled before watching browser position.");return}Ce(this,am,navigator.geolocation.watchPosition(this.onPositionUpdate,this.onPositionError,{enableHighAccuracy:!0}))}}update(e){var t,n;e==null?Ce(this,Ps,void 0):"coords"in e?Ce(this,Ps,Object.assign({},y(this,Ps),{latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:e.coords.accuracy,heading:e.coords.heading,floor:y(this,m2).call(this,e.coords.floorLevel)})):(Ce(this,Ps,Object.assign({},y(this,Ps),e)),"floorOrFloorId"in e&&(y(this,Ps).floor=typeof e.floorOrFloorId=="string"&&e.floorOrFloorId!=="device"?y(this,f2).call(this,e.floorOrFloorId):e.floorOrFloorId)),(((t=y(this,Ps))==null?void 0:t.latitude)!=null&&((n=y(this,Ps))==null?void 0:n.longitude)!=null||y(this,sc)!=null)&&y(this,v2).call(this,y(this,sc))}};Fn=new WeakMap,or=new WeakMap,am=new WeakMap,sc=new WeakMap,Ps=new WeakMap,Ls=new WeakMap,lc=new WeakMap,om=new WeakMap,sm=new WeakMap,lm=new WeakMap,ua=new WeakMap,rs=new WeakMap,d2=new WeakMap,uc=new WeakMap,f2=new WeakMap,m2=new WeakMap,g2=new WeakMap,eP=new WeakMap,tP=new WeakMap,y2=new WeakMap,iP=new WeakMap,v2=new WeakMap,nP=new WeakMap,Ju=new WeakMap,hc=new WeakMap,rP=new WeakMap,kp=new WeakMap,Pv=new WeakMap,Ku=new WeakMap,_2=new WeakMap,l(gle,"BlueDot");var fEe=gle,mEe={hidden:{actions:{enable:"hidden",error:"hidden","position-update":"active",disable:"disabled",timeout:"hidden"}},active:{actions:{enable:"active",disable:"disabled","position-update":"active",error:"inactive",timeout:"inactive"}},inactive:{actions:{enable:"inactive",disable:"disabled","position-update":"active",error:"inactive",timeout:"inactive"}},disabled:{actions:{enable:"hidden",disable:"disabled"}}},gEe=$e.object({coords:$e.object({latitude:$e.number(),longitude:$e.number(),accuracy:$e.number(),altitude:$e.number().optional().nullable(),altitudeAccuracy:$e.number().optional().nullable(),heading:$e.number().optional().nullable(),speed:$e.number().optional().nullable(),floorLevel:$e.number().optional().nullable()}),timestamp:$e.number()}),yEe=$e.object({latitude:$e.number(),longitude:$e.number(),floor:$e.custom().optional(),accuracy:$e.number().optional(),heading:$e.number().optional().nullable()});R();var cc,x2,yle=class{constructor({currentMapGetter:e}){ge(this,cc,new Map),ge(this,x2),Ce(this,x2,e)}get currentMap(){return y(this,x2).call(this)}getById(e){return y(this,cc).get(e)}add(e,t,n){let r=this.currentMap;if(!r)throw new Error("currentMap should exist");let a=r.Shapes.add(e,t||{},{floorId:n?.id}),o=new Kb(a);return y(this,cc).set(o.id,o),o}remove(e){var t;y(this,cc).get(e.id)&&((t=this.currentMap)==null||t.Shapes.remove(e),y(this,cc).delete(e.id.toString()))}removeAll(){let e=[];return y(this,cc).forEach(t=>{this.remove(t),e.push(t.id),y(this,cc).delete(t.id.toString())}),e}};cc=new WeakMap,x2=new WeakMap,l(yle,"Shapes");var vEe=yle;R();var b2,vle=class{constructor({currentMapGetter:e}){ge(this,b2),Ce(this,b2,e)}get currentMap(){return y(this,b2).call(this)}setFromStyleCollection(e){var t,n,r,a;for(let o in e)for(let s of((t=this.currentMap)==null?void 0:t.floors)||[]){if(e[o]==null||!s.layers.has(Ga))continue;let u=s.layers.get(Ga);if(u!=null&&u.layers.has(o)&&"color"in e[o]){let f=u.layers.get(o);f&&((n=this.currentMap)==null||n.renderer.setState(f,{color:e[o].color}))}if(u&&o===VA&&!(Ag in e)){let f=u.layers.get(Ag);f&&"color"in e[o]&&((r=this.currentMap)==null||r.renderer.setState(f,{color:e[o].color}))}if(!s.layers.has(qv))continue;let h=s.layers.get(qv),d=s.facadesByStyleId.get(o);if(d&&d.length>0)for(let f of d){let m=h.layers.get("".concat(f,"-").concat(o));m&&"color"in e[o]&&((a=this.currentMap)==null||a.renderer.setState(m,{color:e[o].color}))}}}};b2=new WeakMap,l(vle,"Style");var _Ee=vle;R();var TM={opacity:1},bo,w2,A2,id,pc,Lv,aP,_le,xle=class{constructor(e,t){ge(this,Lv),ge(this,bo),ge(this,w2,[]),ge(this,A2,{opacity:"initial"}),ge(this,id,{opacity:new Map}),ge(this,pc,new Set),Ce(this,bo,e),Ce(this,w2,t||[]);let n=y(this,bo).map;n&&n.on("idle",()=>{y(this,id).opacity.size||St(this,Lv,aP).call(this,n)})}setStyle(e){var t,n;if(y(this,bo).map){(t=y(this,bo).map)==null||t.setStyle(e),y(this,pc).size&&(y(this,pc).clear(),this.hide()),St(this,Lv,_le).call(this),St(this,Lv,aP).call(this,y(this,bo).map),this.setOpacity(y(this,A2).opacity),(n=y(this,bo).map)==null||n.moveLayer(see);for(let[r,a,o]of y(this,w2)||[])y(this,bo).hideOutdoorLayersIntersectingPolygons(r,a,o)}}get map(){return y(this,bo).map}get enabled(){return!!y(this,bo).map}get visible(){return y(this,pc).size===0}show(){let e=y(this,bo).map;if(!e)return;let t=e.getStyle().layers;t&&(t.forEach(n=>{y(this,pc).has(n.id)&&e.setLayoutProperty(n.id,"visibility","visible")}),y(this,pc).clear())}hide(e=[]){let t=y(this,bo).map;if(!t)return;let n=t.getStyle().layers;n&&n.forEach(r=>{let a=t.getLayoutProperty(r.id,"visibility");!e.includes(r.id)&&a!=="none"&&(t.setLayoutProperty(r.id,"visibility","none"),y(this,pc).add(r.id))})}setOpacity(e,t=[]){var n,r;let a=y(this,bo).map;if(!a)return;let o=(r=(n=y(this,bo).map)==null?void 0:n.getStyle())==null?void 0:r.layers;o&&a.once("idle",()=>{o.forEach(s=>{let u=a.getLayoutProperty(s.id,"visibility");if(!t.includes(s.id)&&u!=="none")try{let h=y(this,id).opacity.get(s.id);h!==void 0&&(s.id==="background"||(s.type==="symbol"?(a.setPaintProperty(s.id,"icon-opacity",e==="initial"?h[0]:e),a.setPaintProperty(s.id,"text-opacity",e==="initial"?h[1]:e)):a.setPaintProperty(s.id,"".concat(s.type,"-opacity"),e==="initial"?h[0]:e)),y(this,A2).opacity=e)}catch(h){nt.warn("Error setting opacity:",h)}})})}};bo=new WeakMap,w2=new WeakMap,A2=new WeakMap,id=new WeakMap,pc=new WeakMap,Lv=new WeakSet,aP=l(function(i){let e=i.getStyle().layers;e&&e.forEach(t=>{var n,r,a;i.getLayoutProperty(t.id,"visibility")!=="none"&&(t.id==="background"||(t.type==="symbol"?y(this,id).opacity.set(t.id,[(n=i.getPaintProperty(t.id,"icon-opacity"))!=null?n:TM.opacity,(r=i.getPaintProperty(t.id,"text-opacity"))!=null?r:TM.opacity]):y(this,id).opacity.set(t.id,[(a=i.getPaintProperty(t.id,"".concat(t.type,"-opacity")))!=null?a:TM.opacity,void 0])))})},"#setInitialStyle"),_le=l(function(){Object.values(y(this,id)).forEach(i=>i.clear())},"#clearInitialStyle"),l(xle,"Outdoor");var xEe=xle;R();function ble(){zD(!1)}l(ble,"disableText3DWorker");var dc,fc,Rp,wle=class{constructor({currentMapGetter:e}){ge(this,dc),ge(this,fc,new Map),ge(this,Rp,new Map),Ce(this,dc,e)}labelAll(e={}){var t,n;let r=[],a=new Set;return(n=(t=y(this,dc).call(this))==null?void 0:t.Text3D.labelAll(e))==null||n.forEach(({textInfo:o,target:s})=>{let u=o.id.toString(),h=y(this,Rp).get(u);if(h){a.has(u)||r.push(h.text3DView),a.add(u);return}a.add(u);let d=new GT(u,s);y(this,fc).set(d.id,{targetId:s.id,text3d:u,text3DView:d}),y(this,Rp).set(u,{text3DView:d}),r.push(d)}),r}label(e,t,n={}){var r;if(y(this,dc).call(this))if(ru.is(e)){let a=(r=y(this,dc).call(this))==null?void 0:r.Text3D.label(e,t,n);if(!a)return;let o=a.textInfo.id.toString(),s=y(this,Rp).get(o);if(s)return s.text3DView;let u=new GT(o,a.target);return y(this,fc).set(u.id,{targetId:a.target.id,text3d:o,text3DView:u}),y(this,Rp).set(o,{text3DView:u}),u}else throw new Error("Non-space target is not supported")}remove(e){var t;let n=typeof e=="string"?e:e.id,r=y(this,fc).get(n);r&&((t=y(this,dc).call(this))==null||t.Text3D.remove(r.text3d),y(this,fc).delete(n),y(this,Rp).delete(r.text3d))}removeAll(){y(this,fc).forEach(e=>{var t;(t=y(this,dc).call(this))==null||t.Text3D.remove(e.text3d)}),y(this,fc).clear()}};dc=new WeakMap,fc=new WeakMap,Rp=new WeakMap,l(wle,"Text3D");var bEe=wle,O_=.05,S2,Ale=class extends xr{constructor(e,t,n){super(),D(this,"core"),D(this,"mapObjects",[]),D(this,"id"),D(this,"mapDataExternal",{}),D(this,"mapsByFloorId",{}),D(this,"mapData"),D(this,"currentMap"),D(this,"hiddenOutdoorGeometries",[]),D(this,"lastFacadeIntersected"),ge(this,S2,!1),D(this,"mapView"),D(this,"externalPubSub"),D(this,"Camera"),D(this,"Labels"),D(this,"Text3D"),D(this,"Markers"),D(this,"Models"),D(this,"Paths"),D(this,"Exporter"),D(this,"Navigation"),D(this,"Outdoor"),D(this,"BlueDot"),D(this,"Shapes"),D(this,"Style"),D(this,"Images"),D(this,"update",l(()=>{this.core.render()},"update")),this.core=e,this.mapView=t,this.externalPubSub=n,this.Camera=new X3e(this),this.id=this.core.addGroupContainer("root").id.toString();let r=new A8("outdoors-container",void 0,void 0,this);this.mapObjects.push(r),this.currentMap=r,this.core.on("pre-render",()=>{n.publish("pre-render")}),this.core.on("post-render",()=>{n.publish("post-render")}),this.core.on("resize",()=>{n.publish("resize")}),this.core.on("render-error",({error:d})=>{n.publish("render-error",{error:new v2e(d instanceof Error?d.message:"Unknown error")})});let a=l(d=>{let f=this.getMapDataObject(d);switch(f?.__type){case"facade":return f;case"floor":return f.floorStack.facade;default:return null}},"getFacadeFromEntityId");this.core.on("geometry-in-focus",d=>{let f=new Set;for(let m of d){let v=a(m);v&&f.add(v)}n.publish("facades-in-view-change",{facades:Array.from(f)})}),this.core.getSystems().renderSystem.on("camera-state-change",()=>{n.publish("state-change-internal",{Camera:this.getCameraState()})});let o=new D3e(this.Camera);this.core.on("camera-change",()=>{n.publish("camera-change",o)});let s=l(d=>f=>{let m=[],v=[],b=[],w=[];f.labels.forEach(N=>{let z=this.Labels.getById(N.toString());z&&m.push(z.label)}),f.markers.forEach(N=>{let z=this.Markers.getById(N.toString())||this.Navigation.getMarkerById(N.toString());z&&v.push(z.marker)}),f.models.forEach(N=>{let z=this.Models.getById(N.toString());z&&b.push(z.model)}),f.paths.forEach(N=>{let z=this.Paths.getById(N.toString())||this.Navigation.getPathById(N.toString());z&&w.push(z.path)});let A=f.geometry.includes(QT),E=f.geometry.filter(N=>N!==QT),I;E.length>0&&(I=E.map(N=>{var z;return(z=this.getMapDataInternal())==null?void 0:z.getById("space",N)}).filter(Boolean)[0],I||(I=E.map(N=>{var z;return(z=this.getMapDataInternal())==null?void 0:z.getById("object",N)}).filter(Boolean)[0]),I||(I=E.map(N=>this.Shapes.getById(N)).filter(Boolean)[0]));let C=f.containers.reduce((N,z)=>{var L;let j=(L=this.getMapDataInternal())==null?void 0:L.getById("floor",z);return j&&Kl.is(j)&&N.push(j),N},[]),T,k=0;if(C.length>0){T=C[0].id;let N=this.core.getState(T);k=f.coordinate[2]?f.coordinate[2]-N.altitude:k}let F;this.lastFacadeIntersected&&this.lastFacadeIntersected.spaces.forEach(N=>{this.core.setState(N.id,{hovered:!1})}),I&&ru.is(I)&&(F=E.map(N=>{var z;return(z=this.getMapDataInternal())==null?void 0:z.facadesBySpaceId[N]}).filter(Boolean)[0],F&&F.spaces.forEach(N=>{this.core.setState(N.id,{hovered:!0})})),this.lastFacadeIntersected=F;let B={coordinate:new Wn({latitude:f.coordinate[1],longitude:f.coordinate[0],floorId:T,verticalOffset:k}),spaces:I&&ru.is(I)?[I]:[],objects:I&&wd.is(I)?[I]:[],shapes:I&&Kb.is(I)?[I]:[],markers:v,labels:m,models:b,paths:w,blueDot:A,floors:C,facades:F?[F]:[]};"pointerEvent"in f&&(B.pointerEvent=f.pointerEvent),n.publish(d,B)},"createHandler");this.core.on("hover",s("hover")),this.core.on("click",s("click")),this.core.on("user-interaction-start",()=>{n.publish("user-interaction-start")}),this.core.on("user-interaction-end",()=>{n.publish("user-interaction-end")});let u={currentMapGetter:l(()=>this.currentMap,"currentMapGetter")};this.Markers=new tEe(u),this.Models=new nEe(u),this.Labels=new Y3e(u),this.Text3D=new bEe(u),this.Exporter=new Z3e(u),this.Paths=new rEe(u),this.Navigation=new G3e(this.core,this,u.currentMapGetter),this.on("navigation-state-change",d=>{this.externalPubSub.publish("state-change-internal",{Navigation:d})}),this.on("navigation-connection-click",d=>{this.externalPubSub.publish("navigation-connection-click",d)}),this.on("navigation-active-path-change",d=>{this.externalPubSub.publish("navigation-active-path-change",d)}),this.BlueDot=new fEe(this.core,this),this.on("blue-dot-position-update",d=>{this._publishBlueDotState({coordinate:this.BlueDot.coordinate,heading:this.BlueDot.heading,accuracy:this.BlueDot.accuracy,floor:this.BlueDot.floor}),n.publish("blue-dot-position-update",d)}),this.on("blue-dot-state-change",d=>{this._publishBlueDotState({state:this.BlueDot.state}),n.publish("blue-dot-state-change",d)}),this.on("blue-dot-position-error",d=>{n.publish("blue-dot-position-error",d)}),this.on("blue-dot-follow-change",d=>{this._publishBlueDotState({following:this.BlueDot.following}),n.publish("blue-dot-follow-change",d)}),this.Outdoor=new xEe(this.core,this.hiddenOutdoorGeometries),this.Outdoor.enabled&&(this.core.on("outdoor-view-loaded",()=>{n.publish("outdoor-view-loaded")}),this.core.on("outdoor-style-loaded",()=>{n.publish("outdoor-style-loaded")})),this.Images=new iEe(u),this.Shapes=new vEe(u),this.Style=new _Ee(u);let h=new q3e(t,this.mapDataExternal);this.auto=h.auto}get manualFloorVisibility(){return y(this,S2)}set manualFloorVisibility(e){Ce(this,S2,e),this.externalPubSub.publish("state-change-internal",{manualFloorVisibility:e})}get StackedMaps(){return this.currentMap.StackedMaps}preloadFloors(e){e.forEach(t=>{t instanceof Kl&&this.core.setState(t.id,{preloadGeometry:!0})})}updateState(e,t){if(e==="interior-walls"){this.currentMap.floors.forEach(r=>{let a=r.layers.get(Ga);if(a){let o=a.layers.get(VA);o&&this.core.hasState(o)&&this.core.setState(o,hP(t,this.core.getState(o)))}});return}else if(e==="exterior-walls"){this.currentMap.floors.forEach(r=>{let a=r.layers.get(Ga);if(a){let o=a.layers.get(Ag);o&&this.core.hasState(o)&&this.core.setState(o,hP(t,this.core.getState(o)))}});return}else if(e==="interior-doors"){this.currentMap.floors.forEach(r=>{let a=r.layers.get(Ga);if(a){let o=a.layers.get(xD);o&&this.core.hasState(o)&&this.core.setState(o,C2(t,this.core.getState(o)))}});return}else if(e==="exterior-doors"){this.currentMap.floors.forEach(r=>{let a=r.layers.get(Ga);if(a){let o=a.layers.get(bD);o&&this.core.hasState(o)&&this.core.setState(o,C2(t,this.core.getState(o)))}});return}let n=typeof e=="string"?this.getMapDataObject(e):e;if(n){if(n.__type!=="Path"&&!this.core.hasState(n.id)){nt.warn('Failed to update state for "'.concat(n.id,'". No ').concat(n.__type," found with that ID."));return}if(DT.is(n))return this.core.setState(n.id,zle(lt(Me({},t),{type:"label"}),this.core.getState(n.id)));if(QD.is(n))return this.core.setState(n.id,Ule(lt(Me({},t),{type:"marker"}),this.core.getState(n.id)));if(ru.is(n)||wd.is(n)){let r=this.core.getState(n.id);if(r!=null){let a=r.parent&&r.parent.type==="geometry-group"?this.core.getState(r.parent):void 0;this.core.setState(n.id,Vle(lt(Me({},t),{type:"geometry"}),r,a))}}if(S0.is(n)&&this.core.setState(n.id,C2(lt(Me({},t),{type:"doors"}),this.core.getState(n.id))),Kb.is(n)&&this.core.setState(n.id,ks(t,["altitude","color","opacity","height","visible","interactive"])),Fse.is(n)){let r=t,{position:a,scale:o}=r,s=Sc(r,["position","scale"]);a&&(s.position=[a.longitude,a.latitude,a.verticalOffset]),o!=null&&(Array.isArray(o)?s.scale=o:s.scale=[o,o,o]),a&&n.updateTarget(a),this.core.setState(n.id,s)}if(Kl.is(n)){let r=this.currentMap.floorsById.get(n.id);if(r==null)return;this.core.setState(n.id,ks(t,["visible","altitude"]));let a=r.layers.get(Ga);a!=null&&"geometry"in t&&this.core.setState(a.containerId,ks(t.geometry,["opacity","visible"]));let o=r.layers.get(Sg);o!=null&&"labels"in t&&"enabled"in t.labels&&typeof t.labels.enabled=="boolean"&&o.setVisible(t.labels.enabled);let s=r.layers.get(ud);s!=null&&"markers"in t&&"enabled"in t.markers&&typeof t.markers.enabled=="boolean"&&s.setVisible(t.markers.enabled);let u=r.layers.get(aI);u!=null&&"footprint"in t&&this.core.setState(u.containerId,ks(t.footprint,["visible","height","opacity","side","color","altitude"]));let h=r.layers.get(Wv);h!=null&&"occlusion"in t&&"enabled"in t.occlusion&&typeof t.occlusion.enabled=="boolean"&&h.setVisible(t.occlusion.enabled);let d=r.layers.get(Mg);d!=null&&"images"in t&&"visible"in t.images&&typeof t.images.visible=="boolean"&&d.setVisible(t.images.visible)}if(Dg.is(n)){let r=this.core.getState(n.id);for(let a of r.children)a.type==="group-container"&&this.core.setState(a.id,ks(t,["opacity","visible"]))}if(GT.is(n)&&this.core.setState(n.id,ks(t,Wae)),j1.is(n))for(let r of n.segments)this.core.setState(r.id,ks(t,AEe));Bse.is(n)&&this.core.setState(n.id,ks(t,SEe))}}getMapDataObject(e){var t;return(t=this.getMapDataInternal())==null?void 0:t.getMapDataById(e)}getMapDataInternal(){if(this.mapData)return Cw(this.mapData)}getMapData(){return this.mapData}addMap(e,t){return new Promise(n=>{var r,a,o,s;let u;try{u=Cw(e)}catch(w){nt.error("Error adding map",w),n(e);return}this.mapDataExternal[e.mapName]=e,this.mapData=e;let{mvf:h}=u,d=h["manifest.geojson"].features[0].geometry.coordinates;this.core.mode!=="outdoors-overlay"&&this.Camera.set({center:new Wn(d[1],d[0])});let f=h["manifest.geojson"].features[0].properties.name,m=new A8("mapObject-".concat(f),u,t,this);this.currentMap=m,this.currentMap.setFloor(this.currentMap.startingFloorId);let v=this.core.getBoundingArea(m.currentFloor.id);v==null&&nt.error("Could not determine bounding box for map:",m.currentFloor.id);let b=(a=(r=t?.outdoorView)==null?void 0:r.layersHiddenByGeometry)!=null?a:[];if(b.length>0){let w,A=[];for(let E of m.floorStacksById.values())if(E.defaultFloor.footprint&&E.defaultFloor.footprint.geometry!=null&&((o=E.defaultFloor.footprint.geometry)==null?void 0:o.coordinates.length)>0){let I=E.defaultFloor.footprint,C=n6(I);w==null?w=C:Hle(w,C),A.push(I)}A.length>0&&w!=null&&(this.core.hideOutdoorLayersIntersectingPolygons(w,A,b),this.hiddenOutdoorGeometries.push([w,A,b]))}if(this.mapObjects.push(m),u.getMVFFeatureByType("floor").forEach(w=>{this.mapsByFloorId[w.id]=m}),m.StackedMaps.on("stacked-maps-state-change",({state:w})=>{this.externalPubSub.publish("stacked-maps-state-change",{state:w})}),m.on("floor-change-start",w=>{var A,E,I,C;this.externalPubSub.publish("floor-change-start",{reason:w.reason,floor:(E=(A=this.getMapDataInternal())==null?void 0:A.getById("floor",w.floorId))!=null?E:this.currentFloor,previousFloor:(C=(I=this.getMapDataInternal())==null?void 0:I.getById("floor",w.previousFloorId))!=null?C:this.currentFloor})}),m.on("floor-change",w=>{var A,E;this.externalPubSub.publish("floor-change",{reason:w.reason,floor:this.currentFloor,previousFloor:(E=(A=this.getMapDataInternal())==null?void 0:A.getById("floor",w.previousFloorId))!=null?E:this.currentFloor}),this.externalPubSub.publish("state-change-internal",{currentFloor:this.currentFloor,currentFloorStack:this.currentFloorStack})}),t?.zoomLevel!=null)this.core.camera.setZoomLevel(t.zoomLevel),n(e);else if(this.core.mode!=="outdoors-overlay"&&v){let w=(s=t?.screenOffsets)!=null?s:{top:O_*this.core.canvasHeight,left:O_*this.core.canvasWidth,right:O_*this.core.canvasWidth,bottom:O_*this.core.canvasHeight};this.core.camera.focusOn(v,{duration:Kwe,padding:w}).then(()=>{this.Camera.setElevation(this.currentFloor.elevation),n(e)})}else n(e)})}setFloor(e,t){return this.currentMap.setFloor(ww(e),t)}setFloorStack(e,t){return this.currentMap.setFloorStack(ww(e),t)}updateWatermark(e){this.core.updateWatermark(e)}get currentFloorStack(){var e;let t=this.currentMap.currentFloorStack.id;if(!t)throw new So("Missing currentFloorStack.");let n=(e=this.mapData)==null?void 0:e.getById("floor-stack",t);if(!n)throw new So("FloorStack was not found in map data.");return n}get currentFloor(){var e;let t=this.currentMap.currentFloor.id;if(!t)throw new So("Missing currentFloor object from GeoJsonApi");let n=(e=this.mapData)==null?void 0:e.getById("floor",t);if(!n)throw new So("Missing currentFloor");return n}getState(e){var t,n,r,a,o,s,u,h,d,f,m,v,b,w,A,E,I,C,T,k,F,B;typeof e=="object"&&j1.is(e)&&nt.warn("Cannot get state of a Path directly. Use getState() on individual segments within Path.segments[] instead.");let N=$Ee(e,this),z=this.core.getState(N);if(z)if(["interior-walls","exterior-walls"].includes(e)){let{color:L,topColor:j,texture:q,topTexture:Z,visible:O,height:Y,opacity:J}=z;return{type:"walls",visible:O,color:L,topColor:j,texture:q?{url:q}:void 0,topTexture:Z?{url:Z}:void 0,height:Y,opacity:J}}else if(["interior-doors","exterior-doors"].includes(e)){let{color:L,topColor:j,texture:q,topTexture:Z,visible:O,opacity:Y}=z;return{type:"doors",visible:O,color:L,topColor:j,opacity:Y,texture:q?{url:q}:void 0,topTexture:Z?{url:Z}:void 0}}else if(z.type==="geometry"){let L;"parent"in z&&z.parent&&z.parent.type==="geometry-group"&&(L=this.core.getState(z.parent));let j=L!=null&&L.altitude?z.altitude+L.altitude:z.altitude;return{type:"geometry",interactive:z.interactive,hoverColor:z.hoverColor,color:z.color,visible:z.visible,opacity:z.opacity,height:z.height,texture:z.texture?{url:z.texture}:void 0,topTexture:z.topTexture?{url:z.topTexture}:void 0,flipImageToFaceCamera:z.flipImageToFaceCamera,topColor:z.topColor,altitude:j}}else{if(z.type==="label"&&z.options.appearance&&z.options.rank!==void 0&&z.options.interactive!==void 0)return{type:"label",text:z.text,appearance:z.options.appearance,rank:z.options.rank,enabled:z.enabled,interactive:z.options.interactive};if(z.type==="marker"&&((t=z.options)==null?void 0:t.rank)!==void 0&&z.options.interactive!==void 0){let L=typeof z.parent=="object"?z.parent.id:z.parent,j=this.Markers.getById(z.id.toString()),q=j!=null&&j.marker.target?j?.marker.target.anchorTarget:void 0;return q==null&&(q=new Wn(z.position[1],z.position[0],L.toString())),{type:"marker",rank:z.options.rank,interactive:z.options.interactive,enabled:z.enabled,element:z.element,anchor:z.anchor,zIndex:z.options.zIndex,dynamicResize:z.dynamicResize,lowPriorityPin:z.options.lowPriorityPin,contentHTML:z.contentHTML}}else if(z.type==="model"){let L=z!=null&&typeof z.parent=="object"?z.parent.id.toString():(n=z.parent)==null?void 0:n.toString();return delete z.parent,lt(Me({},z),{position:new Wn({latitude:z.position[1],longitude:z.position[0],verticalOffset:z.position[2],floorId:L}),type:"model"})}else{if(z.type==="image")return{type:"image"};if(z.type==="text3d")return z;if(z.type==="geometry-group"&&e&&typeof e!="string"&&Kb.is(e)){let[L]=z.children;if(L.type!=="geometry")throw new Error("expect shape first child to be geometry");return{type:"Shape",altitude:(r=z.altitude)!=null?r:0,visible:z.visible,color:z.color,height:L.height,opacity:z.opacity,interactive:z.interactive}}else{if(z.type==="path")return{type:"path",color:z.color,visible:z.visible,nearRadius:z.nearRadius,farRadius:z.farRadius,altitude:z.altitude,completeFraction:z.completeFraction};if(z.type==="group-container"&&typeof e!="string"&&Kl.is(e)){let L=(a=this.currentMap.floorsById.get(e.id))==null?void 0:a.layers.get(Ga),j=L?this.core.getState(L.containerId):void 0,q=(o=this.currentMap.floorsById.get(e.id))==null?void 0:o.layers.get(Sg),Z=(s=this.currentMap.floorsById.get(e.id))==null?void 0:s.layers.get(ud),O=(u=this.currentMap.floorsById.get(e.id))==null?void 0:u.layers.get(aI),Y=O?this.core.getState(O.containerId):void 0,J=(h=this.currentMap.floorsById.get(e.id))==null?void 0:h.layers.get(Wv),oe=J?this.core.getState(J.containerId):void 0,$=(d=this.currentMap.floorsById.get(e.id))==null?void 0:d.layers.get(Mg),K=$?this.core.getState($.containerId):void 0;return{type:"floor",geometry:{opacity:(f=j?.opacity)!=null?f:0,visible:(m=j?.visible)!=null?m:!0},labels:{enabled:(v=q?.visible)!=null?v:!1},markers:{enabled:(b=Z?.visible)!=null?b:!1},footprint:{altitude:(w=Y?.altitude)!=null?w:0,visible:(A=Y?.visible)!=null?A:!1,height:(E=Y?.height)!=null?E:0,opacity:(I=Y?.opacity)!=null?I:0,side:(C=Y?.side)!=null?C:"double",color:(T=Y?.color)!=null?T:"white"},images:{visible:(k=K?.visible)!=null?k:!1},occlusion:{enabled:(F=oe?.visible)!=null?F:!1},visible:z.visible,altitude:(B=z.altitude)!=null?B:0}}else if(z.type==="group-container"&&z.children.length>0&&typeof e!="string"&&Dg.is(e)){let L=this.core.getState(z.children[0].id);return{type:"facade",opacity:L.opacity,visible:L.visible}}}}}}setHoverColor(e){this.core.setState({hoverColor:e})}getHoverColor(){let e=this.core.getState();return e?.type==="map-view"?e.hoverColor:void 0}createCoordinateFromScreenCoordinate(e,t,n){var r;if(n!=null){let h=this.core.projectScreenXYToCoordinate(e,t,!0);return h?new Wn(h.coordinate[1],h.coordinate[0],n.id):void 0}let a=this.core.projectScreenXYToCoordinate(e,t);if(a==null||a.coordinate==null)return;let{coordinate:o,groupContainers:s}=a,u=(r=s?.find(h=>{let d=h.userData.entityId.toString();return d.includes("f_")||d.includes("m_")}))==null?void 0:r.userData.entityId.toString();return new Wn(o[1],o[0],u)}getScreenCoordinateFromCoordinate(e){var t,n,r;let a=0;if(e.floorId!=null){let o=(t=this.mapData)==null?void 0:t.getById("floor",e.floorId);o!=null&&(a=(r=(n=this.getState(o))==null?void 0:n.altitude)!=null?r:0)}return this.core.projectCoordinateToScreenXY([e.longitude,e.latitude,a])}isInView(e){return this.core.isInView(typeof e=="string"?e:e.id)}auto(){return{labels:this.Labels.all()}}tween(e){let t=new dh(e);return this.core.getExternalTweenGroup().add(t),this.core.render(),t}removeTween(e){this.core.getExternalTweenGroup().remove(e)}tweenGroup(){return this.core.getExternalTweenGroup()}get __core(){return this.core}getCameraState(){return this.core.camera.getState()}getNavigationState(){return{isMultiFloor:this.Navigation.isMultiFloor,floorStacks:this.Navigation.floorStacks,floors:this.Navigation.floors,activeDirections:this.Navigation.activeDirections,activePath:this.Navigation.activePath,paths:this.Navigation.paths}}getAllState(){return{currentFloor:this.currentFloor,currentFloorStack:this.currentFloorStack,Camera:this.getCameraState(),Navigation:this.getNavigationState(),manualFloorVisibility:this.manualFloorVisibility}}publishAllState(){this.externalPubSub.publish("state-change-internal",this.getAllState())}clear(){this.Navigation.clear(),this.BlueDot.disable(),this.Shapes.removeAll(),this.Paths.removeAll(),this.Models.removeAll(),this.Markers.removeAll(),this.Images.removeAll(),this.Labels.removeAll()}destroy(){this.clear(),this.core.destroy()}_publishBlueDotState(e){let t;if(e)t=e;else{let{state:n,following:r,heading:a,accuracy:o,coordinate:s,floor:u}=this.BlueDot;t={state:n,following:r,heading:a,accuracy:o,coordinate:s,floor:u}}this.externalPubSub.publish("state-change-internal",{BlueDot:t})}getOptimalVisualDistanceBetweenFloors(e,t=!1){let n=this.currentMap;if(!n){nt.error("Cannot compute optimal visual distance between floors. Missing current map.");return}if(e.length<2){nt.warn("Cannot compute optimal visual distance between floors. Must provide at least 2 floors.");return}let r=n.renderer.getInternalState().geometry3DMap.get(e[0].id),a=n.renderer.getInternalState().geometry3DMap.get(e[1].id);if(!r||!a){nt.warn("Cannot compute optimal visual distance between floors. Floors not found in current map.");return}if(bd(r,"group-container"),bd(a,"group-container"),t){let s=new ur;s.setFromObject(r);let u=new ur;if(u.setFromObject(a),r.children.forEach(w=>{w instanceof ln&&w.userData.debugBox&&Ra(w)}),a.children.forEach(w=>{w instanceof ln&&w.userData.debugBox&&Ra(w)}),!kc(s)||!kc(u))return;let h=new Nc(s.max.x-s.min.x,s.max.y-s.min.y,s.max.z-s.min.z),d=new _l({color:255,transparent:!0,opacity:.5}),f=new ln(h,d);f.position.set((s.min.x+s.max.x)/2,(s.min.y+s.max.y)/2,(s.min.z+s.max.z)/2),f.userData.debugBox=!0;let m=new Nc(u.max.x-u.min.x,u.max.y-u.min.y,u.max.z-u.min.z),v=new _l({color:"cyan",transparent:!0,opacity:.5}),b=new ln(m,v);b.position.set((u.min.x+u.max.x)/2,(u.min.y+u.max.y)/2,(u.min.z+u.max.z)/2),b.userData.debugBox=!0,r.add(f),a.add(b)}let o=n.renderer.computeMinZOffsetBetweenContainers(r,a);if(o!==-1)return o}};S2=new WeakMap,l(Ale,"GeoJsonApi");var wEe=Ale;function Sle(i){if(i===""){TT(""),IT("");return}IT("".concat(i,"/").concat(P2e)),TT("".concat(i,"/").concat(T2e))}l(Sle,"setWorkersUrl");var AEe=["color","nearRadius","farRadius","visible","completeFraction","altitude"],SEe=["color","altitude"];R();var Mle=class{constructor(e){D(this,"state"),D(this,"update"),this.update=e.Debug.update.bind(e.Debug),this.state=e.Debug.state}};l(Mle,"Debug");var MEe=Mle;R();var CEe=eo.object({environment:eo.union([eo.literal("basic"),eo.literal(!1)]).optional(),text3d:eo.object({hoverColor:eo.string().optional()}).optional(),geometry:eo.object({hoverColor:eo.string().optional()}).optional(),backgroundColor:eo.string().optional(),backgroundAlpha:eo.number().optional()}).strict();R();var S8=ii(Jee(),1),EEe=l((i,e)=>{let t={},n=l((r,a,o)=>{for(let s in a){let u=r[s],h=a[s];typeof h=="object"&&!Array.isArray(h)&&h!==null&&typeof u=="object"&&!Array.isArray(u)&&u!==null?(o[s]={},n(u,h,o[s])):o[s]=u}},"processObject");return n(i,e,t),t},"extractProperties"),IEe=l((i,e)=>{let t=EEe(i,e),n=(0,S8.default)({},t,e),r=(0,S8.default)({},t),a=l((o,s,u,h=r)=>{for(let d in s){let f=o[d],m=s[d];if(typeof m=="number"&&typeof f=="number")h[d]=f+(m-f)*u;else if(typeof m=="string"&&typeof f=="string"){if(Xm(f)&&Xm(m)){let v=AR(f),b=AR(m);v&&b?h[d]=M2e([v[0]+(b[0]-v[0])*u,v[1]+(b[1]-v[1])*u,v[2]+(b[2]-v[2])*u]):nt.warn('Color "'.concat(d,'" could not be animated!'))}}else typeof m=="object"&&m!==null&&typeof f=="object"&&f!==null?a(f,m,u,h[d]):nt.warn('Value "'.concat(d,'" could not be animated!'))}},"interpolate");return o=>(o=Math.min(Math.max(o,0),1),o===0?i:o===1?n:(a(t,e,o),r))},"animationFactory"),um,ri,Qu,Cle=class{constructor(e){ge(this,um),ge(this,ri),ge(this,Qu),D(this,"Camera"),D(this,"Labels"),D(this,"Text3D"),D(this,"Markers"),D(this,"Images"),D(this,"Models"),D(this,"Paths"),D(this,"Exporter"),D(this,"Navigation"),D(this,"BlueDot"),D(this,"Style"),D(this,"Shapes"),D(this,"Outdoor"),D(this,"update",l(()=>{y(this,ri).core.render()},"update")),D(this,"getDirections",l((n,r,a)=>{var o;return(o=y(this,ri).getMapData())==null?void 0:o.getDirections(n,r,a)},"getDirections")),D(this,"getDirectionsMultiDestination",l((n,r,a)=>{var o;return(o=y(this,ri).getMapData())==null?void 0:o.getDirectionsMultiDestination(n,r,a)},"getDirectionsMultiDestination")),D(this,"on",l((n,r)=>{y(this,um).on(n,r)},"on")),D(this,"off",l((n,r)=>{y(this,um).off(n,r)},"off")),D(this,"Debug"),Ce(this,um,new xr),Ce(this,Qu,e);let t=new wEe(e,this,y(this,um));Ce(this,ri,t),this.Camera=y(this,ri).Camera,this.Markers=y(this,ri).Markers,this.Models=y(this,ri).Models,this.Labels=y(this,ri).Labels,this.Text3D=y(this,ri).Text3D,this.Exporter=y(this,ri).Exporter,this.Paths=y(this,ri).Paths,this.Navigation=y(this,ri).Navigation,this.BlueDot=y(this,ri).BlueDot,this.Shapes=y(this,ri).Shapes,this.Style=y(this,ri).Style,this.auto=y(this,ri).auto,this.Outdoor=y(this,ri).Outdoor,this.Images=y(this,ri).Images,y(this,Qu).container.dataset.version=mr.env.npm_package_version,this.Debug=new MEe(y(this,ri).core)}get StackedMaps(){return y(this,ri).currentMap.StackedMaps}updateState(e,t){return y(this,ri).updateState(e,t)}animateState(e,t,n){var r;let a=y(this,ri).getState(e);if(a==null)return nt.warn("Cannot animate state of ".concat(e,".")),new Promise(h=>h({result:"completed"}));let o=IEe(a,t),s=y(this,ri).tween({percent:0}).to({percent:1},(r=n?.duration)!=null?r:1e3).onUpdate(({percent:h})=>{y(this,ri).updateState(e,o(h))});n!=null&&n.easing&&n.easing in Pg&&s.easing(Pg[n.easing]);let u=new Promise(h=>{s.onComplete(()=>{y(this,ri).removeTween(s),h({result:"completed"})}).onStop(()=>{y(this,ri).removeTween(s),h({result:"cancelled"})}),s.start()});return u.cancel=()=>{s.stop(),y(this,ri).updateState(e,o(0))},u}updateGlobalState(e){var t,n,r,a;try{CEe.parse(e)}catch(o){nt.error("updateGlobalState",o);return}if(typeof e=="object"){let o={};if((t=e.text3d)!=null&&t.hoverColor&&(o.text3dHoverColor=e.text3d.hoverColor),(n=e.geometry)!=null&&n.hoverColor&&(o.hoverColor=e.geometry.hoverColor),e.backgroundColor||e.backgroundAlpha!==void 0){let s=(r=e.backgroundColor)!=null?r:y(this,ri).core.backgroundColor,u=(a=e.backgroundAlpha)!=null?a:y(this,ri).core.backgroundAlpha;y(this,ri).core.setBackgroundColor(s,u)}e.environment!=null&&y(this,ri).core.setEnvironment(e.environment),y(this,ri).core.setState(o)}}get options(){return Rie(y(this,ri).currentMap.options)}getGlobalState(){let e=y(this,ri).core.getState();return{backgroundColor:y(this,ri).core.backgroundColor,backgroundAlpha:y(this,ri).core.backgroundAlpha,environment:y(this,ri).core.getEnvironment(),geometry:{hoverColor:e.hoverColor},text3d:{hoverColor:e.text3dHoverColor}}}getMapData(){if(y(this,ri).mapData==null)throw new So("MapData not found.");return y(this,ri).mapData}getDimensions(){return{width:y(this,Qu).canvasWidth,height:y(this,Qu).canvasHeight}}expand(e){var t;return(t=y(this,ri).currentMap)==null?void 0:t.StackedMaps.expand(e)}collapse(e){var t;return(t=y(this,ri).currentMap)==null?void 0:t.StackedMaps.collapse(e)}addMap(e,t){return y(this,ri).addMap(e,t)}setFloor(e,t){return y(this,ri).setFloor(e,t?.context)}setFloorStack(e,t){return y(this,ri).setFloorStack(e,t?.context)}preloadFloors(e){y(this,ri).preloadFloors(e)}tween(e){return y(this,ri).tween(e)}removeTween(e){y(this,ri).removeTween(e)}get tweenGroup(){return y(this,ri).tweenGroup()}get currentFloorStack(){return y(this,ri).currentFloorStack}get currentFloor(){return y(this,ri).currentFloor}updateWatermark(e){y(this,ri).updateWatermark(e)}getState(e){return y(this,ri).getState(e)}setHoverColor(e){y(this,ri).setHoverColor(e)}getHoverColor(){return y(this,ri).getHoverColor()}convertAltitudeToMercatorZoomLevel(e){return y(this,ri).core.getSystems().cameraSystem.convertAltitudeToZoomLevel(e)}convertMercatorZoomLevelToAltitude(e){return y(this,ri).core.getSystems().cameraSystem.convertZoomLevelToAltitude(e)}isInView(e){return y(this,ri).isInView(e)}getDistance(e,t){var n;return(n=y(this,ri).getMapData())==null?void 0:n.getDistance(e,t)}createCoordinate(e,t,n){return typeof e=="object"?new Wn(e):new Wn(e,t,n?.id)}createCoordinateFromScreenCoordinate(e,t,n){return y(this,ri).createCoordinateFromScreenCoordinate(e,t,n)}getScreenCoordinateFromCoordinate(e){return y(this,ri).getScreenCoordinateFromCoordinate(e)}auto(){return{labels:this.Labels.all()}}get __core(){if(mr.env.INTERNAL==="true")return y(this,ri).core;throw new Error("__core is not available.")}get container(){return y(this,Qu).container}publishAllState(){y(this,ri).publishAllState()}clear(){y(this,ri).clear()}destroy(){y(this,ri).destroy()}async enableDebug(e={}){let{Inspector:t}=await _h(()=>import("./inspector-DPNZIY36-C9OE4xoN.js"),__vite__mapDeps([9,1,2]));await new t(this,y(this,ri)).enable(e)}async takeScreenshot(){return await y(this,Qu).renderSync(),y(this,Qu).rendererDomElement.toDataURL("image/png")}get manualFloorVisibility(){return y(this,ri).manualFloorVisibility}set manualFloorVisibility(e){y(this,ri).manualFloorVisibility=e}getOptimalVisualDistanceBetweenFloors(e){return y(this,ri).getOptimalVisualDistanceBetweenFloors(e)}};um=new WeakMap,ri=new WeakMap,Qu=new WeakMap,l(Cle,"MapView");var Ele=Cle;R();R();var Ile=class extends xr{constructor(e){super(),D(this,"gl"),D(this,"el",document.createElement("div")),D(this,"core"),D(this,"origin"),D(this,"map"),D(this,"layer"),D(this,"handleStyleChange",l(()=>{!this.map||!this.layer||this.map.getLayer(this.layer.id)||(this.map.addLayer(this.layer),this.core.camera.setMinZoomLevel(this.map.getMinZoom()),this.core.camera.setMaxZoomLevel(this.map.getMaxZoom()),this.core.camera.setMinPitch(this.map.getMinPitch()),this.core.camera.setMaxPitch(this.map.getMaxPitch()))},"handleStyleChange")),D(this,"handleMove",l(()=>{if(!this.map)return;let[t,n]=this.map.getCenter().toArray();this.core.getSystems().cameraSystem.setCenter(t,n),this.core.getSystems().cameraSystem.setZoomLevel(this.map.getZoom()),this.core.getSystems().cameraSystem.setRotation(Bn.degToRad(this.map.getBearing())),this.core.getSystems().cameraSystem.setTilt(Bn.degToRad(this.map.getPitch()))},"handleMove")),D(this,"handleError",l(t=>{nt.warn(t)},"handleError")),this.origin=e}onAdd(e){this.origin=this.origin||e.getCenter().toArray(),this.gl=e.painter.context.gl,this.core=new xT(e._container,{center:this.origin,zoomLevel:e.getZoom(),pitch:e.getPitch(),bearing:e.getBearing(),gl:this.gl,map:e,mode:"outdoors-overlay"}),this.map=e,this.core.camera.setMinZoomLevel(e.getMinZoom()),this.core.camera.setMaxZoomLevel(e.getMaxZoom()),this.core.camera.setMinPitch(e.getMinPitch()),this.core.camera.setMaxPitch(e.getMaxPitch()),this.map.on("error",this.handleError);let t=$a.fromLngLat(this.origin,0);return this.layer=YL(t,this.core.viewCamera,this.core.camera,()=>{this.core.renderSync()}),this.map.on("styledata",this.handleStyleChange),this.map.on("move",this.handleMove),this.handleStyleChange(),this.el}onRemove(){this.map&&(this.map.off("styledata",this.handleStyleChange),this.map.off("move",this.handleMove),this.map.off("error",this.handleError),this.layer&&this.map.removeLayer(this.layer.id)),this.layer=void 0,this.map=void 0,this.core&&this.core.destroy(),this.core=void 0}};l(Ile,"MapLibreOverlay");var TEe=Ile,hm,cm,Dv,Op,pm,oP=class Tle{constructor(e,t,n){ge(this,hm),ge(this,cm),ge(this,Dv),ge(this,Op),ge(this,pm),D(this,"on",l((r,a)=>{y(this,hm).on(r,a)},"on")),D(this,"off",l((r,a)=>{y(this,hm).off(r,a)},"off")),Ce(this,hm,new xr),Ce(this,pm,new TEe(e)),Ce(this,cm,t),Ce(this,Dv,n)}onAdd(e){var t,n;let r=y(this,pm).onAdd(e),a=lt(Me(Me({},ov),(t=y(this,Dv))!=null?t:{}),{outdoorView:Me({token:y(this,cm).outdoorViewToken},(n=y(this,Dv))==null?void 0:n.outdoorView)});return Ce(this,Op,new Ele(y(this,pm).core)),y(this,Op).addMap(y(this,cm),a).then(()=>{y(this,hm).publish("loaded",{mapView:y(this,Op),mapData:y(this,cm)})}),r}onRemove(){y(this,Op)&&y(this,Op).clear(),Tle.instance=null,y(this,pm).onRemove()}};hm=new WeakMap,cm=new WeakMap,Dv=new WeakMap,Op=new WeakMap,pm=new WeakMap,l(oP,"MappedinMapLibreOverlay"),D(oP,"instance");var PM=oP;R();var PEe=1e3*60*60*2,nd,Jv,dr,Vl,jl,hl,Wl,kv,Rv,M2,Oa,M8,C8,Qm,zw,sP,lP,uP,Ple=class{constructor(e,t){ge(this,Oa),ge(this,nd,new xr),ge(this,Jv),ge(this,dr),ge(this,Vl),ge(this,jl),ge(this,hl),ge(this,Wl),ge(this,kv),ge(this,Rv),ge(this,M2,l(()=>{"key"in y(this,dr)&&"secret"in y(this,dr)&&St(this,Oa,Qm).call(this),St(this,Oa,zw).call(this)},"#handleWindowFocus")),D(this,"on",l((n,r)=>y(this,nd).on(n,r),"on")),D(this,"off",l((n,r)=>y(this,nd).off(n,r),"off")),Ce(this,Jv,e),Ce(this,dr,t)}setMapIds(e){Ce(this,Jv,e)}setEnterprise(e){y(this,dr).enterprise=e}async readySync(){var e;if((!("key"in y(this,dr))||!("secret"in y(this,dr)))&&!("accessToken"in y(this,dr))){nt.error("No API keys or access token provided! Cannot preload tokens.");return}let t=[St(this,Oa,Qm).call(this),null];y(this,dr).enterprise||(t[1]=this.getSasTokensAsync());let[n,r]=await Promise.all(t);St(this,Oa,uP).call(this),St(this,Oa,sP).call(this,n),r!=null&&St(this,Oa,lP).call(this,r),dw()&&((e=globalThis.addEventListener)==null||e.call(globalThis,"focus",y(this,M2)))}async refreshing(){let e=[];return y(this,Vl)!=null&&e.push(y(this,Vl)),y(this,jl)!=null&&e.push(y(this,jl)),Promise.all(e)}getAccessTokenAsync(){return St(this,Oa,Qm).call(this)}getSasTokensAsync(){return St(this,Oa,zw).call(this)}getAccessToken(){return y(this,hl)==null?(nt.error("Tokens must be loaded before reading synchronously! Try awaiting readySync() first."),{token:""}):y(this,hl)}getSasToken(e){return this.isEnterpriseMode()?(nt.error("SAS tokens are not available in the enterprise mode!"),{token:""}):y(this,Wl)==null?(nt.error("Tokens must be loaded before reading synchronously! Try awaiting readySync() first."),{token:""}):e in y(this,Wl).tokens?y(this,Wl).tokens[e]:(nt.error("SAS token for map ".concat(e," not found!")),{token:""})}isEnterpriseMode(){var e;return(e=y(this,dr).enterprise)!=null?e:!1}destroy(){St(this,Oa,uP).call(this),y(this,nd).destroy(),dw()&&globalThis.removeEventListener("focus",y(this,M2))}};nd=new WeakMap,Jv=new WeakMap,dr=new WeakMap,Vl=new WeakMap,jl=new WeakMap,hl=new WeakMap,Wl=new WeakMap,kv=new WeakMap,Rv=new WeakMap,M2=new WeakMap,Oa=new WeakSet,M8=l(function(i){var e;let t=i.token!==((e=y(this,hl))==null?void 0:e.token);Ce(this,hl,i),t&&y(this,nd).publish("access-token-refreshed",{accessToken:i})},"#setAccessToken"),C8=l(function(i){var e;let t=JSON.stringify(i.tokens)!==JSON.stringify((e=y(this,Wl))==null?void 0:e.tokens);Ce(this,Wl,i),t&&y(this,nd).publish("sas-tokens-refreshed",{sasTokens:i.tokens})},"#setSasTokens"),Qm=l(async function(i=!1){var e;if("accessToken"in y(this,dr)&&typeof y(this,dr).accessToken=="string"){let t={token:y(this,dr).accessToken,expires:Date.now()+72e5};return Ce(this,hl,t),t}if(!("key"in y(this,dr))||!("secret"in y(this,dr))||typeof y(this,dr).key!="string"||typeof y(this,dr).secret!="string")throw new Error("No API keys or access token provided!");return y(this,Vl)!=null?y(this,Vl):y(this,hl)!=null&&y(this,hl).expires!=null&&y(this,hl).expires>Date.now()&&!i?y(this,hl):(Ce(this,Vl,CD(lt(Me({},y(this,dr)),{key:y(this,dr).key,secret:y(this,dr).secret}),(e=y(this,dr).enterprise)!=null?e:!1).then(t=>{let n={token:t.accessToken,expires:t.expiresTimestamp*1e3};return St(this,Oa,M8).call(this,n),n})),y(this,Vl).finally(()=>{Ce(this,Vl,void 0)}),y(this,Vl))},"#refreshAccessToken"),zw=l(async function(i=!1){return this.isEnterpriseMode()?{tokens:{},expires:1/0}:y(this,jl)!=null?y(this,jl):y(this,Wl)!=null&&y(this,Wl).expires>Date.now()&&!i?y(this,Wl):(Ce(this,jl,new Promise((e,t)=>{St(this,Oa,Qm).call(this).then(n=>{let r={},a=y(this,Jv).map(o=>ene(lt(Me({},y(this,dr)),{mapId:o}),n.token).then(s=>{r[o]={token:s.token,expires:s.expires}}).catch(s=>{nt.error("Error getting SAS token for map ".concat(o,":"),s)}));Promise.all(a).then(()=>{let o={tokens:r,expires:Math.min(...Object.values(r).map(s=>{var u;return(u=s.expires)!=null?u:1/0}))};St(this,Oa,C8).call(this,o),e(o)})}).catch(n=>{t(n)})})),y(this,jl).catch(e=>{throw e}).finally(()=>{Ce(this,jl,void 0)}),y(this,jl))},"#refreshSasTokens"),sP=l(function(i){if(!("key"in y(this,dr))||!("secret"in y(this,dr)))return;let e=i.expires!=null?i.expires-Date.now():PEe;isFinite(e)&&Ce(this,kv,setTimeout(()=>{St(this,Oa,Qm).call(this,!0).then(t=>{St(this,Oa,sP).call(this,t)})},e-BAe))},"#setAccessTokenRefresh"),lP=l(function(i){let e=i.expires-Date.now();isFinite(e)&&Ce(this,Rv,setTimeout(()=>{St(this,Oa,zw).call(this,!0).then(t=>{St(this,Oa,lP).call(this,t)})},e-zAe))},"#setSasTokensRefresh"),uP=l(function(){y(this,kv)!=null&&clearTimeout(y(this,kv)),y(this,Rv)!=null&&clearTimeout(y(this,Rv))},"#stopRefreshing"),l(Ple,"TokenManager");var Lle=Ple;R();var LEe=l(async(i,e)=>{var t,n,r,a,o,s,u;let h=(r="mvfVersion"in(e??{})?e?.mvfVersion:void 0)!=null?r:"options"in i&&"version"in((t=i.options)!=null?t:{})?(n=i.options)==null?void 0:n.version:void 0,d=lt(Me({prefetchTokens:!0},e||{}),{mvfVersion:h}),f,m=M0();m.updateByUserOption(d);let v={};if("type"in i&&typeof i.type=="string"){if(v.enterprise=(a=i.options)==null?void 0:a.enterprise,i.type==="binary"&&i.main instanceof Uint8Array){f=await qA(i.main,d.mvfVersion),v.languagePacks=[];for(let k of(o=i.languagePacks)!=null?o:[])k.localePack instanceof Uint8Array&&v.languagePacks.push({language:k.language,localePack:await WA(k.localePack)})}else if(i.type==="json")f=i.main,v.languagePacks=(s=i.languagePacks)!=null?s:[];else throw new Error("Invalid backup type");i.type==="binary"&&i.main instanceof Uint8Array&&(v.binaryBundle=i.main)}else f=i,v.enterprise=f.enterprise!=null;let b=fne(f),w=b.length>0?b:[d.mapId],A=new Lle(w,lt(Me({},d),{enterprise:v.enterprise})),E;if("accessToken"in d)E=d.accessToken;else if("key"in d&&"secret"in d){d.baseAuthUri=m.getBaseAuthUri(v.enterprise);let k=await A.getAccessTokenAsync();E=k?.token||""}if(v.outdoorViewToken=E,v.env=m,v.getMapDataOptions=d,d.prefetchTokens)try{await A.readySync()}catch(k){nt.error("Failed to ready token manager!",k)}let I=new s6(f,v);E&&I.Analytics.init(lt(Me({accessToken:E,mapId:d.mapId,key:"key"in d?d.key:void 0,secret:"secret"in d?d.secret:void 0},d.analytics),{baseUri:m.getAnalyticsBaseUri(),context:(u=d.analytics)==null?void 0:u.context}));let C=new TD(I),T=I.findPreferredLanguage({languageCode:d.language,fallbackToNavigatorLanguage:!1});if(T)try{await C.changeLanguage(T.code)}catch{}return typeof e?.onMVFParsed=="function"&&e.onMVFParsed(f),C},"hydrateMapData");R();var DEe=l((i,{id:e}={})=>{let t=Array.isArray(i)?i:[i];if(!t.every(a=>typeof a=="string"))return;let n=t.join(""),r=null;if(e){let a=document.getElementById(e);a instanceof HTMLStyleElement&&(r=a)}r==null&&(r=document.createElement("style")),e&&e!==""&&(r.id=e),r.textContent=n,document.head.appendChild(r)},"injectCSS"),kEe=`:root {
	--pin-shadow-hover-scale: 0.9;
	--pin-shadow-width: 12px;
	--pin-shadow-height: 5px;
	--pin-shadow-opacity: 0.35;
	--pin-drop-animation-duration-ms: 250ms;
}

@keyframes drop-pin {
	0% {
		transform: translateY(-200%);
	}

	100% {
		transform: translateY(0);
	}
}

@keyframes pin-shadow {
	0% {
		transform: scale(var(--pin-shadow-hover-scale));
	}

	100% {
		transform: scale(1);
	}
}

.mappedin-dropped-pin-wrapper {
	position: relative;

	width: fit-content;
	height: fit-content;
	width: 36px;
	height: 42px;

	& svg {
		position: absolute;
		left: calc(50% - var(--pin-shadow-width));
		animation: drop-pin var(--pin-drop-animation-duration-ms) ease-in;
	}

	& > .pin-shadow {
		position: absolute;
		left: calc(50% - (var(--pin-shadow-width) / 2));
		bottom: 0;

		height: var(--pin-shadow-height);
		width: var(--pin-shadow-width);
		border-radius: 100%;

		opacity: var(--pin-shadow-opacity);

		animation: pin-shadow 250ms ease-in;
	}
}

@keyframes bounce {
	0% {
		transform: translateY(-10px);
		opacity: 0;
	}
	12.5% {
		transform: translateY(0);
		opacity: 1;
	}
	25% {
		transform: translateY(0);
	}
	37.5% {
		transform: translateY(-10px);
	}
	50% {
		transform: translateY(0);
	}
	62.5% {
		transform: translateY(-10px);
	}
	75% {
		transform: translateY(0);
	}
	87.5% {
		transform: translateY(-10px);
	}
	100% {
		transform: translateY(0);
	}
}

.mappedin-connection-marker {
	position: relative;
	display: flex;

	.bouncey {
		animation: bounce 2.5s linear;
	}

	.arrow--down {
		transform: rotate(180deg);
	}

	.connection-circle {
		display: flex;
		box-sizing: border-box;
		justify-content: center;
		align-items: center;
		border-radius: 50%;
		border: 2px solid white;
		box-shadow: 0px 2px 8px 0px rgba(0, 0, 0, 0.15);
		background: #595959;
	}
}
`,REe=`.mappedin-marker {
	font-family: 'InterUI-Regular', Helvetica, Arial, sans-serif;
	font-weight: normal;
	top: 0;
	position: absolute;
	font-weight: bold;
	color: black;
	display: flex;
	flex-direction: row;
	will-change: transform, opacity;
	transition: opacity 150ms ease-in-out;
	justify-content: center;
	opacity: 0;
}

/* Low priority pin strategy styles */

/* Hide child elements as well */
.mappedin-marker[data-anchor="low-priority-pin"]> .mappedin-marker-content {
	visibility: hidden;
}

/* Create the pin using ::before pseudo-element */
.mappedin-marker::before {
	content: '';
	display: none;
	border-radius: 50%;
	position: relative;
	/* Default values - will be overridden by inline styles */
	width: var(--mappedin-pin-size, 2px);
	height: var(--mappedin-pin-size, 2px);
	background-color: var(--pin-color, #666);
}

.mappedin-marker[data-anchor="low-priority-pin"]::before {
	display: block;
}
`,OEe=`.mappedin__smart-collision-engine__container {
	position: absolute;
	left: 0px;
	top: 0px;
	bottom: 0px;
	right: 0px;
	pointer-events: none;
	/* Enables colliders to use translate3D */
	transform-style: preserve-3d;
	font-family: 'InterUI-Regular', Helvetica, Arial, sans-serif;
}

.mappedin__smart-collision-engine-debug__container {
	position: absolute;
	left: 0px;
	top: 0px;
	bottom: 0px;
	right: 0px;
	transition: opacity 300ms ease-in-out;
	pointer-events: none;
	will-change: opacity;
	&.interacting {
		opacity: 0.2;
	}
}
`,NEe=`.mappedin-map {
	.mappedin-interactive {
		cursor: grab;

		&:active {
			cursor: grabbing;
		}

		&.mappedin-interaction-hover {
			cursor: pointer;
		}
	}
}
`,FEe=`.mappedin-map {
	.mappedin-control-container {
		position: absolute;
		left: 0px;
		top: 0px;
		bottom: 0px;
		right: 0px;
		pointer-events: none;
		font-family: 'InterUI-Regular', Helvetica, Arial, sans-serif;

		.mappedin-ctrl-top-left,
		.mappedin-ctrl-top-right,
		.mappedin-ctrl-bottom-left,
		.mappedin-ctrl-bottom-right {
			position: absolute;
			pointer-events: none;
		}

		.mappedin-ctrl-top-left {
			top: 0;
			left: 0;
		}

		.mappedin-ctrl-top-right {
			top: 0;
			right: 0;
		}

		.mappedin-ctrl-bottom-left {
			bottom: 0;
			left: 0;
		}

		.mappedin-ctrl-bottom-right {
			bottom: 0;
			right: 0;
		}

		.mappedin-ctrl-attrib {
			display: block;
			position: relative;
			pointer-events: auto;
			font: 9px/11px 'InterUI-Regular', Helvetica, Arial, sans-serif;
			padding: 3px 5px 1px 5px;
			background-color: rgba(255, 255, 255, 0.5);
			margin: 0;
			min-width: 11px;
			min-height: 11px;
			user-select: none;

			summary.mappedin-ctrl-attrib-button {
				appearance: none;
				list-style: none;
			}

			summary.mappedin-ctrl-attrib-button::-webkit-details-marker {
				display: none;
			}

			&.mappedin-compact .mappedin-ctrl-attrib-button,
			&.mappedin-compact-show .mappedin-ctrl-attrib-inner {
				display: inline-block;
			}

			&.mappedin-compact {
				background-color: transparent;
			}

			&.mappedin-compact-show {
				min-width: 15px;
				min-height: 15px;
				box-sizing: border-box;
				background-color: rgba(255, 255, 255, 0.5);
			}
		}

		.mappedin-ctrl-attrib-top-left {
			float: left;
			border-bottom-right-radius: 4px;
		}

		.mappedin-ctrl-attrib-top-right {
			float: right;
			border-bottom-left-radius: 4px;
		}

		.mappedin-ctrl-attrib-bottom-left {
			float: left;
			border-top-right-radius: 4px;
		}

		.mappedin-ctrl-attrib-bottom-right {
			float: right;
			border-top-left-radius: 4px;
		}
		.mappedin-ctrl-attrib-top-left,
		.mappedin-ctrl-attrib-bottom-left {
			padding: 3px 5px 1px 20px;
		}

		.mappedin-ctrl-attrib-inner {
			display: inline-block;
			margin-right: 12px;
		}

		.mappedin-ctrl-attrib-inner,
		.mappedin-ctrl-attrib-inner a {
			color: rgba(0, 0, 0, 0.75);
			text-decoration: none;
		}

		.mappedin-ctrl-attrib-inner-bold,
		.mappedin-ctrl-attrib-inner-bold a {
			font-weight: bold;
		}

		.mappedin-ctrl-attrib-inner a:hover {
			color: #017ef1;
			text-decoration: underline;
			cursor: pointer;
		}

		.mappedin-ctrl-attrib-button {
			display: none;
			cursor: pointer;
			position: absolute;
			width: 15px;
			height: 15px;
			box-sizing: border-box;
			border-radius: 50%;
			top: 0;
			right: 2px;
			border: 1px;
		}
		.mappedin-ctrl-attrib-top-left .mappedin-ctrl-attrib-button,
		.mappedin-ctrl-attrib-bottom-left .mappedin-ctrl-attrib-button {
			left: 2px;
		}
	}
}
`,BEe=`.maplibregl-map {
    font: 12px/20px "Helvetica Neue", Arial, Helvetica, sans-serif;
    overflow: hidden;
    position: relative;
    -webkit-tap-highlight-color: rgb(0 0 0 / 0%);
}

.maplibregl-canvas {
    position: absolute;
    left: 0;
    top: 0;
}

.maplibregl-map:fullscreen {
    width: 100%;
    height: 100%;
}

.maplibregl-ctrl-group button.maplibregl-ctrl-compass {
    touch-action: none;
}

.maplibregl-canvas-container.maplibregl-interactive,
.maplibregl-ctrl-group button.maplibregl-ctrl-compass {
    cursor: grab;
    -moz-user-select: none;
    -webkit-user-select: none;
    -ms-user-select: none;
    user-select: none;
}

.maplibregl-canvas-container.maplibregl-interactive.maplibregl-track-pointer {
    cursor: pointer;
}

.maplibregl-canvas-container.maplibregl-interactive:active,
.maplibregl-ctrl-group button.maplibregl-ctrl-compass:active {
    cursor: grabbing;
}

.maplibregl-canvas-container.maplibregl-touch-zoom-rotate,
.maplibregl-canvas-container.maplibregl-touch-zoom-rotate .maplibregl-canvas {
    touch-action: pan-x pan-y;
}

.maplibregl-canvas-container.maplibregl-touch-drag-pan,
.maplibregl-canvas-container.maplibregl-touch-drag-pan .maplibregl-canvas {
    touch-action: pinch-zoom;
}

.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan,
.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan .maplibregl-canvas {
    touch-action: none;
}

.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures,
.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures .maplibregl-canvas {
    touch-action: pan-x pan-y;
}

.maplibregl-ctrl-top-left,
.maplibregl-ctrl-top-right,
.maplibregl-ctrl-bottom-left,
.maplibregl-ctrl-bottom-right { position: absolute; pointer-events: none; z-index: 2; }

.maplibregl-ctrl-top-left { top: 0; left: 0; }

.maplibregl-ctrl-top-right { top: 0; right: 0; }

.maplibregl-ctrl-bottom-left { bottom: 0; left: 0; }

.maplibregl-ctrl-bottom-right { right: 0; bottom: 0; }

.maplibregl-ctrl {
    clear: both;
    pointer-events: auto;

    /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
    transform: translate(0, 0);
}

.maplibregl-ctrl-top-left .maplibregl-ctrl { margin: 10px 0 0 10px; float: left; }

.maplibregl-ctrl-top-right .maplibregl-ctrl { margin: 10px 10px 0 0; float: right; }

.maplibregl-ctrl-bottom-left .maplibregl-ctrl { margin: 0 0 10px 10px; float: left; }

.maplibregl-ctrl-bottom-right .maplibregl-ctrl { margin: 0 10px 10px 0; float: right; }

.maplibregl-ctrl-group {
    border-radius: 4px;
    background: #fff;
}

.maplibregl-ctrl-group:not(:empty) {
    box-shadow: 0 0 0 2px rgb(0 0 0 / 10%);
}

@media (-ms-high-contrast: active) {
    .maplibregl-ctrl-group:not(:empty) {
        box-shadow: 0 0 0 2px ButtonText;
    }
}

.maplibregl-ctrl-group button {
    width: 29px;
    height: 29px;
    display: block;
    padding: 0;
    outline: none;
    border: 0;
    box-sizing: border-box;
    background-color: transparent;
    cursor: pointer;
}

.maplibregl-ctrl-group button + button {
    border-top: 1px solid #ddd;
}

.maplibregl-ctrl button .maplibregl-ctrl-icon {
    display: block;
    width: 100%;
    height: 100%;
    background-repeat: no-repeat;
    background-position: center center;
}

@media (-ms-high-contrast: active) {
    .maplibregl-ctrl-icon {
        background-color: transparent;
    }

    .maplibregl-ctrl-group button + button {
        border-top: 1px solid ButtonText;
    }
}

/* https://bugzilla.mozilla.org/show_bug.cgi?id=140562 */
.maplibregl-ctrl button::-moz-focus-inner {
    border: 0;
    padding: 0;
}

.maplibregl-ctrl-attrib-button:focus,
.maplibregl-ctrl-group button:focus {
    box-shadow: 0 0 2px 2px rgb(0 150 255 / 100%);
}

.maplibregl-ctrl button:disabled {
    cursor: not-allowed;
}

.maplibregl-ctrl button:disabled .maplibregl-ctrl-icon {
    opacity: 0.25;
}

.maplibregl-ctrl button:not(:disabled):hover {
    background-color: rgb(0 0 0 / 5%);
}

.maplibregl-ctrl-group button:focus:focus-visible {
    box-shadow: 0 0 2px 2px rgb(0 150 255 / 100%);
}

.maplibregl-ctrl-group button:focus:not(:focus-visible) {
    box-shadow: none;
}

.maplibregl-ctrl-group button:focus:first-child {
    border-radius: 4px 4px 0 0;
}

.maplibregl-ctrl-group button:focus:last-child {
    border-radius: 0 0 4px 4px;
}

.maplibregl-ctrl-group button:focus:only-child {
    border-radius: inherit;
}

.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon {
    background-image: svg-load("svg/maplibregl-ctrl-zoom-out.svg", fill: #333);
}

.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon {
    background-image: svg-load("svg/maplibregl-ctrl-zoom-in.svg", fill: #333);
}

@media (-ms-high-contrast: active) {
    .maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-zoom-out.svg", fill: #fff);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-zoom-in.svg", fill: #fff);
    }
}

@media (-ms-high-contrast: black-on-white) {
    .maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-zoom-out.svg", fill: #000);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-zoom-in.svg", fill: #000);
    }
}

.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon {
    background-image: svg-load("svg/maplibregl-ctrl-fullscreen.svg", fill: #333);
}

.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon {
    background-image: svg-load("svg/maplibregl-ctrl-shrink.svg");
}

@media (-ms-high-contrast: active) {
    .maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-fullscreen.svg", fill: #fff);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-shrink.svg", fill: #fff);
    }
}

@media (-ms-high-contrast: black-on-white) {
    .maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-fullscreen.svg", fill: #000);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-shrink.svg", fill: #000);
    }
}

.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon {
    background-image: svg-load("svg/maplibregl-ctrl-compass.svg", fill: #333);
}

@media (-ms-high-contrast: active) {
    .maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon {
        @svg-load ctrl-compass-white url("svg/maplibregl-ctrl-compass.svg") {
            fill: #fff;
            #south { fill: #999; }
        }

        background-image: svg-inline(ctrl-compass-white);
    }
}

@media (-ms-high-contrast: black-on-white) {
    .maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-compass.svg", fill: #000);
    }
}

@svg-load ctrl-terrain url("svg/maplibregl-ctrl-terrain.svg") {
    fill: #333;
    #stroke { display: none; }
}

@svg-load ctrl-terrain-enabled url("svg/maplibregl-ctrl-terrain.svg") {
    fill: #33b5e5;
    #stroke { display: none; }
}

.maplibregl-ctrl button.maplibregl-ctrl-terrain .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-terrain);
}

.maplibregl-ctrl button.maplibregl-ctrl-terrain-enabled .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-terrain-enabled);
}

@svg-load ctrl-geolocate url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #333;
    #stroke { display: none; }
}

@svg-load ctrl-geolocate-white url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #fff;
    #stroke { display: none; }
}

@svg-load ctrl-geolocate-black url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #000;
    #stroke { display: none; }
}

@svg-load ctrl-geolocate-disabled url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #aaa;
    #stroke { fill: #f00; }
}

@svg-load ctrl-geolocate-disabled-white url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #999;
    #stroke { fill: #f00; }
}

@svg-load ctrl-geolocate-disabled-black url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #666;
    #stroke { fill: #f00; }
}

@svg-load ctrl-geolocate-active url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #33b5e5;
    #stroke { display: none; }
}

@svg-load ctrl-geolocate-active-error url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #e58978;
    #stroke { display: none; }
}

@svg-load ctrl-geolocate-background url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #33b5e5;
    #stroke { display: none; }
    #dot { display: none; }
}

@svg-load ctrl-geolocate-background-error url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #e54e33;
    #stroke { display: none; }
    #dot { display: none; }
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-geolocate);
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-geolocate-disabled);
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-geolocate-active);
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-geolocate-active-error);
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-geolocate-background);
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-geolocate-background-error);
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-waiting .maplibregl-ctrl-icon {
    animation: maplibregl-spin 2s infinite linear;
}

@media (-ms-high-contrast: active) {
    .maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-white);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-disabled-white);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-active);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-active-error);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-background);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-background-error);
    }
}

@media (-ms-high-contrast: black-on-white) {
    .maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-black);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-disabled-black);
    }
}

@keyframes maplibregl-spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

a.maplibregl-ctrl-logo {
    width: 88px;
    height: 23px;
    margin: 0 0 -4px -4px;
    display: block;
    background-repeat: no-repeat;
    cursor: pointer;
    overflow: hidden;
    background-image: svg-load("svg/maplibregl-ctrl-logo.svg");
}

a.maplibregl-ctrl-logo.maplibregl-compact {
    width: 14px;
}

@media (-ms-high-contrast: active) {
    a.maplibregl-ctrl-logo {
        @svg-load ctrl-logo-white url("svg/maplibregl-ctrl-logo.svg") {
            #outline { opacity: 1; }
            #fill { opacity: 1; }
        }

        background-color: transparent;
        background-image: svg-inline(ctrl-logo-white);
    }
}

@media (-ms-high-contrast: black-on-white) {
    a.maplibregl-ctrl-logo {
        @svg-load ctrl-logo-black url("svg/maplibregl-ctrl-logo.svg") {
            #outline { opacity: 1; fill: #fff; stroke: #fff; }
            #fill { opacity: 1; fill: #000; }
        }

        background-image: svg-inline(ctrl-logo-black);
    }
}

.maplibregl-ctrl.maplibregl-ctrl-attrib {
    padding: 0 5px;
    background-color: rgb(255 255 255 / 50%);
    margin: 0;
}

@media screen {
    .maplibregl-ctrl-attrib.maplibregl-compact {
        min-height: 20px;
        padding: 2px 24px 2px 0;
        margin: 10px;
        position: relative;
        background-color: #fff;
        color: #000;
        border-radius: 12px;
        box-sizing: content-box;
    }

    .maplibregl-ctrl-attrib.maplibregl-compact-show {
        padding: 2px 28px 2px 8px;
        visibility: visible;
    }

    .maplibregl-ctrl-top-left > .maplibregl-ctrl-attrib.maplibregl-compact-show,
    .maplibregl-ctrl-bottom-left > .maplibregl-ctrl-attrib.maplibregl-compact-show {
        padding: 2px 8px 2px 28px;
        border-radius: 12px;
    }

    .maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-inner {
        display: none;
    }

    .maplibregl-ctrl-attrib-button {
        display: none;
        cursor: pointer;
        position: absolute;
        background-image: svg-load("svg/maplibregl-ctrl-attrib.svg");
        background-color: rgb(255 255 255 / 50%);
        width: 24px;
        height: 24px;
        box-sizing: border-box;
        border-radius: 12px;
        outline: none;
        top: 0;
        right: 0;
        border: 0;
    }

    .maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button {
        appearance: none;
        list-style: none;
    }

    .maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button::-webkit-details-marker {
        display: none;
    }

    .maplibregl-ctrl-top-left .maplibregl-ctrl-attrib-button,
    .maplibregl-ctrl-bottom-left .maplibregl-ctrl-attrib-button {
        left: 0;
    }

    .maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-button,
    .maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-inner {
        display: block;
    }

    .maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-button {
        background-color: rgb(0 0 0 / 5%);
    }

    .maplibregl-ctrl-bottom-right > .maplibregl-ctrl-attrib.maplibregl-compact::after {
        bottom: 0;
        right: 0;
    }

    .maplibregl-ctrl-top-right > .maplibregl-ctrl-attrib.maplibregl-compact::after {
        top: 0;
        right: 0;
    }

    .maplibregl-ctrl-top-left > .maplibregl-ctrl-attrib.maplibregl-compact::after {
        top: 0;
        left: 0;
    }

    .maplibregl-ctrl-bottom-left > .maplibregl-ctrl-attrib.maplibregl-compact::after {
        bottom: 0;
        left: 0;
    }
}

@media screen and (-ms-high-contrast: active) {
    .maplibregl-ctrl-attrib.maplibregl-compact::after {
        background-image: svg-load("svg/maplibregl-ctrl-attrib.svg", fill=#fff);
    }
}

@media screen and (-ms-high-contrast: black-on-white) {
    .maplibregl-ctrl-attrib.maplibregl-compact::after {
        background-image: svg-load("svg/maplibregl-ctrl-attrib.svg");
    }
}

.maplibregl-ctrl-attrib a {
    color: rgb(0 0 0 / 75%);
    text-decoration: none;
}

.maplibregl-ctrl-attrib a:hover {
    color: inherit;
    text-decoration: underline;
}

.maplibregl-attrib-empty {
    display: none;
}

.maplibregl-ctrl-scale {
    background-color: rgb(255 255 255 / 75%);
    font-size: 10px;
    border-width: medium 2px 2px;
    border-style: none solid solid;
    border-color: #333;
    padding: 0 5px;
    color: #333;
    box-sizing: border-box;
}

.maplibregl-popup {
    position: absolute;
    top: 0;
    left: 0;
    display: flex;
    will-change: transform;
    pointer-events: none;
}

.maplibregl-popup-anchor-top,
.maplibregl-popup-anchor-top-left,
.maplibregl-popup-anchor-top-right {
    flex-direction: column;
}

.maplibregl-popup-anchor-bottom,
.maplibregl-popup-anchor-bottom-left,
.maplibregl-popup-anchor-bottom-right {
    flex-direction: column-reverse;
}

.maplibregl-popup-anchor-left {
    flex-direction: row;
}

.maplibregl-popup-anchor-right {
    flex-direction: row-reverse;
}

.maplibregl-popup-tip {
    width: 0;
    height: 0;
    border: 10px solid transparent;
    z-index: 1;
}

.maplibregl-popup-anchor-top .maplibregl-popup-tip {
    align-self: center;
    border-top: none;
    border-bottom-color: #fff;
}

.maplibregl-popup-anchor-top-left .maplibregl-popup-tip {
    align-self: flex-start;
    border-top: none;
    border-left: none;
    border-bottom-color: #fff;
}

.maplibregl-popup-anchor-top-right .maplibregl-popup-tip {
    align-self: flex-end;
    border-top: none;
    border-right: none;
    border-bottom-color: #fff;
}

.maplibregl-popup-anchor-bottom .maplibregl-popup-tip {
    align-self: center;
    border-bottom: none;
    border-top-color: #fff;
}

.maplibregl-popup-anchor-bottom-left .maplibregl-popup-tip {
    align-self: flex-start;
    border-bottom: none;
    border-left: none;
    border-top-color: #fff;
}

.maplibregl-popup-anchor-bottom-right .maplibregl-popup-tip {
    align-self: flex-end;
    border-bottom: none;
    border-right: none;
    border-top-color: #fff;
}

.maplibregl-popup-anchor-left .maplibregl-popup-tip {
    align-self: center;
    border-left: none;
    border-right-color: #fff;
}

.maplibregl-popup-anchor-right .maplibregl-popup-tip {
    align-self: center;
    border-right: none;
    border-left-color: #fff;
}

.maplibregl-popup-close-button {
    position: absolute;
    right: 0;
    top: 0;
    border: 0;
    border-radius: 0 3px 0 0;
    cursor: pointer;
    background-color: transparent;
}

.maplibregl-popup-close-button:hover {
    background-color: rgb(0 0 0 / 5%);
}

.maplibregl-popup-content {
    position: relative;
    background: #fff;
    border-radius: 3px;
    box-shadow: 0 1px 2px rgb(0 0 0 / 10%);
    padding: 15px 10px;
    pointer-events: auto;
}

.maplibregl-popup-anchor-top-left .maplibregl-popup-content {
    border-top-left-radius: 0;
}

.maplibregl-popup-anchor-top-right .maplibregl-popup-content {
    border-top-right-radius: 0;
}

.maplibregl-popup-anchor-bottom-left .maplibregl-popup-content {
    border-bottom-left-radius: 0;
}

.maplibregl-popup-anchor-bottom-right .maplibregl-popup-content {
    border-bottom-right-radius: 0;
}

.maplibregl-popup-track-pointer {
    display: none;
}

.maplibregl-popup-track-pointer * {
    pointer-events: none;
    user-select: none;
}

.maplibregl-map:hover .maplibregl-popup-track-pointer {
    display: flex;
}

.maplibregl-map:active .maplibregl-popup-track-pointer {
    display: none;
}

.maplibregl-marker {
    position: absolute;
    top: 0;
    left: 0;
    will-change: transform;
    transition: opacity 0.2s;
}

.maplibregl-user-location-dot {
    background-color: #1da1f2;
    width: 15px;
    height: 15px;
    border-radius: 50%;
}

.maplibregl-user-location-dot::before {
    background-color: #1da1f2;
    content: "";
    width: 15px;
    height: 15px;
    border-radius: 50%;
    position: absolute;
    animation: maplibregl-user-location-dot-pulse 2s infinite;
}

.maplibregl-user-location-dot::after {
    border-radius: 50%;
    border: 2px solid #fff;
    content: "";
    height: 19px;
    left: -2px;
    position: absolute;
    top: -2px;
    width: 19px;
    box-sizing: border-box;
    box-shadow: 0 0 3px rgb(0 0 0 / 35%);
}

@keyframes maplibregl-user-location-dot-pulse {
    0%   { transform: scale(1); opacity: 1; }
    70%  { transform: scale(3); opacity: 0; }
    100% { transform: scale(1); opacity: 0; }
}

.maplibregl-user-location-dot-stale {
    background-color: #aaa;
}

.maplibregl-user-location-dot-stale::after {
    display: none;
}

.maplibregl-user-location-accuracy-circle {
    background-color: #1da1f233;
    width: 1px;
    height: 1px;
    border-radius: 100%;
}

.maplibregl-crosshair,
.maplibregl-crosshair .maplibregl-interactive,
.maplibregl-crosshair .maplibregl-interactive:active {
    cursor: crosshair;
}

.maplibregl-boxzoom {
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    background: #fff;
    border: 2px dotted #202020;
    opacity: 0.5;
}

.maplibregl-cooperative-gesture-screen {
    background: rgba(0 0 0 / 40%);
    position: absolute;
    inset: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    color: white;
    padding: 1rem;
    font-size: 1.4em;
    line-height: 1.2;
    opacity: 0;
    pointer-events: none;
    transition: opacity 1s ease 1s;
    z-index: 99999;
}

.maplibregl-cooperative-gesture-screen.maplibregl-show {
    opacity: 1;
    transition: opacity 0.05s;
}

.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message {
    display: none;
}

@media (hover: none), (width <= 480px) {
    .maplibregl-cooperative-gesture-screen .maplibregl-desktop-message {
        display: none;
    }

    .maplibregl-cooperative-gesture-screen .maplibregl-mobile-message {
        display: block;
    }
}

.maplibregl-pseudo-fullscreen {
    position: fixed !important;
    width: 100% !important;
    height: 100% !important;
    top: 0 !important;
    left: 0 !important;
    z-index: 99999;
}
`;R();function Dle(i){var e,t;if(!(!i.languages||!dw()||!((t=(e=globalThis.navigator)==null?void 0:e.languages)!=null&&t.length)))for(let n=0;n<globalThis.navigator.languages.length;n++){let r=i.languages.find(a=>a.code.toLowerCase()===globalThis.navigator.languages[n].toLowerCase());if(r)return{code:r.code,name:r.name}}}l(Dle,"findNavigatorPreferredLanguageInVenue");function e6(i,e){var t,n,r;let a=(t=e?.languageCode)!=null?t:"",o=(n=e?.fallbackToNavigatorLanguage)!=null?n:!0,s=(r=i?.languages)==null?void 0:r.find(h=>h.code.toLowerCase()===a.toLowerCase()),u;if(s)u=s;else if(o==null||o)try{let h=Dle(i);h&&(u=h)}catch(h){nt.error("fallbackToNavigatorLanguage is set, however, there was an error getting the navigator language",h)}return u??i.defaultLanguage}l(e6,"findPreferredLanguageInVenue");var zEe=[kEe,REe,OEe,NEe,FEe,BEe],kle;function Rle(i){kle=i}l(Rle,"__setWatermarkOnClickFn");var UEe=l(async(i,e)=>{let t,n=M0();e&&n.updateByUserOption(e);try{e&&(t=(await CD(lt(Me({},e),{baseAuthUri:n.getBaseAuthUri()}))).accessToken)}catch(a){nt.warn("Getting access token failed. Outdoor map disabled.",a)}let r=new s6(i,{outdoorViewToken:t,languagePacks:e?.languagePacks,env:n});return new TD(r)},"hydrateMapDataFromMVF"),Ole=!1;function Nle(i){Ole=i}l(Nle,"setUseEnterpriseAPI");var t6=l(async i=>{var e,t;let n=Ole,r,a=M0();a.updateByUserOption(i);let o=lt(Me({prefetchTokens:!0},i),{fallbackToNavigatorLanguage:(e=i.fallbackToNavigatorLanguage)!=null?e:!0}),s=new Lle([o.mapId],o);if("accessToken"in o){r=o.accessToken;let{aud:I,sub:C}=BL(r);(Qwe.some(T=>I.includes(T))||C&&C.startsWith("client"))&&(n=!0,s.setEnterprise(n))}else if("key"in o&&"secret"in o){if(o.key.startsWith("mipk_"))throw new Error(`Partner API keys detected! 

Partner API keys should not be passed directly to the SDK. See https://developer.mappedin.com/docs/rest-apis/partner for more details.`);o.key.startsWith("mik_")||(n=!0,s.setEnterprise(n)),o.baseAuthUri=a.getBaseAuthUri(n),r=(await s.getAccessTokenAsync()).token}else throw new Error("Missing key or secret.");o.layoutId!=null&&(n?o.layoutId!=="draft"&&nt.warn('Invalid layoutId! Use "draft" to load draft data or leave unspecified to load live data.'):nt.warn("layoutId is currently unsupported!")),o.baseUri=a.getBaseUri(n);let u=performance.now(),h,d;if(n){let I=lt(Me({},o),{venue:o.mapId,clientId:o.key,clientSecret:o.secret,version:"1.0.0",perspective:o.viewId,useDraftData:o.layoutId==="draft"}),C=await sne(I);h=C.compressed,d=C.localePacks}else h=await lne(o,r);let f=performance.now(),m=await qA(h,o.mvfVersion),v=performance.now();typeof i.onMVFParsed=="function"&&i.onMVFParsed(m);let b=fne(m);if(b.length>0?s.setMapIds(b):s.setMapIds([o.mapId]),o.prefetchTokens)try{await s.readySync()}catch(I){nt.error("Failed to ready token manager!",I)}let w=new s6(m,{env:a,outdoorViewToken:r,tokenManager:s,enterprise:n,localePacksUrls:d,binaryBundle:h,getMapDataOptions:o}),A=new TD(w,{search:i.search});w.Analytics.init(lt(Me({accessToken:r,mapId:o.mapId,key:"key"in o?o.key:void 0,secret:"secret"in o?o.secret:void 0},o.analytics),{baseUri:a.getAnalyticsBaseUri(),context:(t=o.analytics)==null?void 0:t.context})),w.Analytics.sendGetMapDataEvent({parseDuration:v-f,downloadDuration:f-u,viewId:o.viewId});let E=w.findPreferredLanguage({languageCode:o.language,fallbackToNavigatorLanguage:o.fallbackToNavigatorLanguage});if(E)try{await A.changeLanguage(E.code)}catch{}return A},"getMapData"),VEe=t6,jEe=l((i,e)=>{PM.instance!=null&&nt.warn("Only a single map venue is supported at this time.");let t=new PM([i.mapCenter.longitude,i.mapCenter.latitude],i,e);return PM.instance=t,t},"createMapLibreOverlay"),Fle=l(async()=>{if(V1===""||ET==="")return!1;let i=[fetch(V1,{mode:"same-origin"}),fetch(ET,{mode:"same-origin"})],[e,t]=[{ok:!1},{ok:!1}];try{[e,t]=await Promise.all(i)}catch{}return{collision:e.ok,maplibre:t.ok}},"checkWorkerUrls"),i6=l(async(i,e,t)=>{var n,r,a,o,s,u,h,d,f,m,v,b,w,A,E,I;let C=performance.now(),T=Die(t,e);T&&Lie(T),((n=T.injectStyles)==null||n)&&DEe(zEe,{id:"mappedin__styles"});let k=kie((r=e.outdoorViewToken)!=null?r:""),F=Cw(e);(a=T.outdoorView)!=null&&a.style&&F.envControl.updateTileServerBaseUrl((o=T.outdoorView)==null?void 0:o.style);let B=!1,N=!1,z=await Fle();z&&(z.collision||(B=!0),z.maplibre||(N=!0));let L=await Lse(i,{center:[e.mapCenter.longitude,e.mapCenter.latitude],bearing:T.bearing,pitch:T.pitch,zoomLevel:T.zoomLevel,backgroundAlpha:(s=T.style)==null?void 0:s.backgroundAlpha,backgroundColor:(u=T.style)==null?void 0:u.backgroundColor,outdoorView:!N&&(h=T.outdoorView)!=null&&h.token?{headers:{"x-mappedin-tiles-key":(d=T.outdoorView)==null?void 0:d.token},style:e.getEnv().tileServerUri,enabled:!!((f=T.outdoorView)!=null&&f.enabled),lowDpi:(m=T.outdoorView)==null?void 0:m.lowDpi}:void 0,watermark:lt(Me({},T.watermark),{visible:(b=(v=T.watermark)==null?void 0:v.visible)!=null?b:!F.enterpriseMode&&!k.remove_watermark,onClick:kle||void 0}),attribution:T.attribution,antialias:typeof T.antialiasing=="boolean"?T.antialiasing:!!((w=T.antialiasing)!=null&&w.enabled),accessToken:e.outdoorViewToken,occlusionEnabled:(A=T.occlusion)==null?void 0:A.enabled,transformImageRequest:F.enterpriseMode?void 0:F.transformImageRequest,naturalBearing:e.naturalBearing,imagePlacementOptions:T.imagePlacementOptions,onWebGLContextCreationError:T.onWebGLContextCreationError,onWebGLContextLost:T.onWebGLContextLost,onWebGLContextRestored:T.onWebGLContextRestored,onWebGLRendererError:T.onWebGLRendererError,useStandaloneCamera:(E=T.useStandaloneCamera)!=null?E:!1,useWorkers:!((I=T.disableWorkers)!=null&&I),useCollisionWorker:!B}),j=new Ele(L);return await j.addMap(e,T),F.Analytics.sendMapViewLoadedEvent({firstRenderDuration:performance.now()-C,dimension:j.getDimensions(),collisionWorkerDisabled:B,outdoorsWorkerDisabled:N}),j},"show3dMap"),GEe=i6;function ql(i){return i.verticalOffset===0?[i.longitude,i.latitude]:[i.longitude,i.latitude,i.verticalOffset]}l(ql,"convertCoordinateToPosition");function Ble(i){return new Map(i.map(e=>{let{properties:t}=e,{id:n}=t;return[n,e]}))}l(Ble,"getEntranceMap");var E8=l((i,e)=>{let t=Ble(e),n={entrances:{type:"FeatureCollection",features:[]},walls:{type:"Feature",properties:{id:i[0].properties.id},geometry:{type:"MultiLineString",coordinates:[]}}};for(let r of i){let a=[r.geometry.coordinates],o=(r.properties.entrances||[]).reduce((s,u)=>(t.has(u)&&s.push(t.get(u)),s),[]);if(o.length){let{entrances:s,obstructions:u}=xne(r,o);a=u.map(h=>h.geometry.coordinates),n.entrances.features.push(...s)}n.walls.geometry.coordinates.push(...a)}return n},"cutEntrancesFromLineStrings");function zle(i,e){let t={options:{}};if(!t.options)throw new Error("options should exist");return i.text&&(t.text=i.text),i.appearance&&(t.options.appearance=i.appearance),i.rank!=null&&(i.rank==="initial"?t.options.rank=e.initialRank||2:t.options.rank=i.rank),i.enabled!==void 0&&(t.enabled=i.enabled),i.interactive!==void 0&&(t.options.interactive=i.interactive),i.enabled!==void 0&&(t.enabled=i.enabled),t}l(zle,"translateLabelStateToGeojsonCore");function Ule(i,e){let t={options:{}};if(!t.options)throw new Error("options should exist");return i.rank!=null&&(i.rank==="initial"?t.options.rank=e.initialRank||2:t.options.rank=i.rank),i.enabled!=null&&(t.enabled=i.enabled),i.interactive!=null&&(t.options.interactive=i.interactive),i.enabled!==null&&(t.enabled=i.enabled),i.contentHTML!==void 0&&(t.contentHTML=i.contentHTML),t}l(Ule,"translateMarkerStateToGeojsonCore");function C2(i,e){var t,n;let r={};return e==null||(i.color&&(i.color==="initial"?r.color=e.initialColor:r.color=i.color),i.topColor&&(i.topColor==="initial"?r.topColor=e.initialTopColor:r.topColor=i.topColor),i.visible!==void 0&&(r.visible=i.visible),((t=i.texture)==null?void 0:t.url)!==void 0&&(r.texture=i.texture.url),((n=i.topTexture)==null?void 0:n.url)!==void 0&&(r.topTexture=i.topTexture.url),i.opacity!==void 0&&(r.opacity=i.opacity)),r}l(C2,"translateDoorsStateToGeojsonCore");function hP(i,e){var t,n;let r={};return e==null||(i.color&&(i.color==="initial"?r.color=e.initialColor:r.color=i.color),i.topColor&&(i.topColor==="initial"?r.topColor=e.initialTopColor:r.topColor=i.topColor),i.visible!==void 0&&(r.visible=i.visible),((t=i.texture)==null?void 0:t.url)!==void 0&&(r.texture=i.texture.url),((n=i.topTexture)==null?void 0:n.url)!==void 0&&(r.topTexture=i.topTexture.url),i.height!==void 0&&(r.height=i.height),i.opacity!==void 0&&(r.opacity=i.opacity)),r}l(hP,"translateWallsStateToGeojsonCore");function Vle(i,e,t){var n,r,a;let o={};return e==null||(i.color&&(i.color==="initial"?o.color=e.initialColor:o.color=i.color),i.topColor&&(i.topColor==="initial"?o.topColor=e.initialTopColor:o.topColor=i.topColor),i.visible!==void 0&&(o.visible=i.visible),((n=i.texture)==null?void 0:n.url)!==void 0&&(o.texture=i.texture.url),((r=i.topTexture)==null?void 0:r.url)!==void 0&&(o.topTexture=i.topTexture.url),i.hoverColor!==void 0&&(o.hoverColor=i.hoverColor),i.interactive!==void 0&&(o.interactive=i.interactive),i.height!==void 0&&(o.height=i.height),i.opacity!==void 0&&(o.opacity=i.opacity),i.flipImageToFaceCamera!==void 0&&(o.flipImageToFaceCamera=i.flipImageToFaceCamera),i.altitude!==void 0&&(o.altitude=i.altitude-((a=t?.altitude)!=null?a:0))),o}l(Vle,"translateSpaceStateToGeojsonCore");function jle(i,e){return((e-i+Math.PI)%(Math.PI*2)+Math.PI*2)%(Math.PI*2)-Math.PI}l(jle,"differenceBetweenAngles");function Gle(i,e){let t="Left";return i<=-Math.PI/4?t="Right":i<=-e?t="SlightRight":i<=e?t="Straight":i<=Math.PI/4?t="SlightLeft":t="Left",t}l(Gle,"getRelativeBearing");function $le(i){let e={};for(let t in i){let n=i[t];if(n!=null){if(n.id=t,"polygons"in n)for(let r of n.polygons)e[r]=n;else if("lineStrings"in n)for(let r of n.lineStrings)e[r]=n;else if("points"in n)for(let r of n.points)e[r]=n}}return e}l($le,"extractStyleMap");function E2(i,e){return i.reduce((t,n)=>{let r=e[n.properties.id];if(r==null)return t;if("textures"in n.properties&&Array.isArray(n.properties.textures)&&n.properties.textures.length>0){let a=lt(Me({},r),{id:r.id+"-textures"});t.set(a,[n])}else t.has(r)||t.set(r,[]),t.get(r).push(n);return t},new Map)}l(E2,"groupGeometryByStyle");function dm(i,e={}){var t,n,r,a,o,s,u;let h=lt(Me({},i),{flipImageToFaceCamera:(t=e?.flipImagesToFaceCamera)!=null?t:!0}),d=(r=(n=e?.style)==null?void 0:n.shading)!=null?r:e?.shadingAndOutlines;if(d===!0?h.shading={start:.1,end:.15,intensity:.4}:typeof d=="object"&&(h.shading={start:d.start,end:d.end,intensity:d.intensity}),h.outline=(o=(a=e?.style)==null?void 0:a.outlines)!=null?o:e?.shadingAndOutlines,"lineStrings"in i){let f=(u=(s=e?.style)==null?void 0:s.wallTopColor)!=null?u:e?.wallTopColor;f!=null&&(h.topColor=f)}return h}l(dm,"translateToCoreStyle");var $Ee=l((i,e)=>{var t;let n=((t=e.currentMap)==null?void 0:t.currentFloor).layers.get(Ga);switch(i){case"interior-walls":return n?.layers.get(VA);case"exterior-walls":return n?.layers.get(Ag);case"interior-doors":return n?.layers.get(xD);case"exterior-doors":return n?.layers.get(bD);default:return typeof i=="string"?i:i.id}},"getTargetID");function cP(i){return new Promise(e=>{i.onComplete(e),i.onStop(e)})}l(cP,"tweenToPromise");function n6(i){return i.bbox?i.bbox:m0(i)}l(n6,"getBoundingBox");function Hle(i,e){return[Math.min(i[0],e[0]),Math.min(i[1],e[1]),Math.max(i[2],e[2]),Math.max(i[3],e[3])]}l(Hle,"expandBbox");function Wle(i){return[...new Set(i)]}l(Wle,"unique");function pP(i,e,t){return i.floorId&&e.has(i.floorId)?e.get(i.floorId):t}l(pP,"getTargetFloorObject");function YA(i){if(ru.is(i)||wd.is(i))return i.id}l(YA,"getAttachableGeometryId");function qle(i,e,t){var n,r,a,o,s,u;let h=i.coordinates.length===2,d=!0;if(h&&i.coordinates[0].floorId!=null&&i.coordinates[1].floorId!=null){let f=e?.getById("floor",i.coordinates[0].floorId),m=e?.getById("floor",i.coordinates[1].floorId);f&&m&&(d=((r=(n=t.getState(f))==null?void 0:n.visible)!=null?r:!0)&&((o=(a=t.getState(m))==null?void 0:a.visible)!=null?o:!0))}else{let f=i.coordinates[0].floorId!=null?e?.getById("floor",i.coordinates[0].floorId):void 0;d=f&&(u=(s=t.getState(f))==null?void 0:s.visible)!=null?u:!0}return d}l(qle,"determineFloorVisibleBasedOnPath");R();function Lg(i,e){var t,n,r,a;if(o6.is(i))return i.navigationTarget.flatMap(o=>Lg(o,e));if($A.is(i)){let o=e.Query.nearest(i,{types:["node"],lineOfSight:!0});return(t=o?.[0])!=null&&t.feature.id?[o[0].feature.id]:[]}else if(Wn.is(i)){let o=e.Query.nearest(i,{types:["node"],lineOfSight:!0});return(n=o?.[0])!=null&&n.feature.id?[o[0].feature.id]:[]}else if(GA.is(i)){let o=e.Query.nearest(i,{types:["node"],lineOfSight:!0});return(r=o?.[0])!=null&&r.feature.id?[o[0].feature.id]:[]}else if(S0.is(i)){let o=e?.getMVFFeatureById("entrance",i.id);return o!=null&&o.properties.node?[o?.properties.node]:[]}else if(UA.is(i)){let o=e?.getMVFFeatureById("area",i.id);return(a=o?.properties.destinationNodes)!=null?a:[]}else if(ru.is(i)){let o=e?.getMVFFeatureById("space",i.id);return o==null?[]:o.properties.destinationNodes}else{if(jA.is(i))return i.coordinates.reduce((o,s)=>{var u;let h=e.Query.nearest(s,{types:["node"],lineOfSight:!0});return(u=h?.[0])!=null&&u.feature.id&&o.push(h[0].feature.id),o},[]);if(wd.is(i)){let o=e?.objectEntranceNodeIdsByObstructionId[i.id];return o??[]}else return Dg.is(i)?i.spaces.flatMap(o=>{var s,u;return(u=(s=e?.getMVFFeatureById("space",o.id))==null?void 0:s.properties.destinationNodes)!=null?u:[]}).filter(o=>typeof o=="string"):A1.is(i)?i.nodes.map(o=>o.id):BA.is(i)?[i.id]:[]}}l(Lg,"getNodesFromTarget");var I8=Math.PI*.1,ha,wo,Ua,mc,gc,yc,fm,Ov,th,Xle,hf,T8,Zle=class{constructor(e,t,n,r,a){ge(this,th),D(this,"id"),ge(this,ha,{}),ge(this,wo),ge(this,Ua),ge(this,mc),ge(this,gc),ge(this,yc),ge(this,fm),ge(this,Ov);var o;this.id=(o=a?.id)!=null?o:Hn(),Ce(this,wo,t),Ce(this,Ua,e.features),Ce(this,mc,n),Ce(this,gc,r)}get path(){return y(this,Ua).map(e=>y(this,wo).getById("node",e.properties.id)).filter(Boolean)}get departure(){if(y(this,ha).departure)return y(this,ha).departure;if(y(this,Ua).length===0||y(this,mc).length===0)return;let e=y(this,Ua)[0].properties.id,t=y(this,mc)[0];if(y(this,mc).length>1){for(let n of y(this,mc))if(Lg(n,y(this,wo)).includes(e)){t=n;break}}return y(this,ha).departure=t,t}get destination(){if(y(this,ha).destination)return y(this,ha).destination;if(y(this,Ua).length===0||y(this,gc).length===0)return;let e=y(this,Ua)[y(this,Ua).length-1].properties.id,t=y(this,gc)[0];if(y(this,gc).length>1){for(let n of y(this,gc))if(Lg(n,y(this,wo)).includes(e)){t=n;break}}return y(this,ha).destination=t,t}get coordinates(){return y(this,ha).coordinates?y(this,ha).coordinates:(y(this,ha).coordinates=y(this,Ua).map(e=>new Wn(e.geometry.coordinates[1],e.geometry.coordinates[0],e.properties.groupBy)),y(this,ha).coordinates)}get distance(){return y(this,ha).distance?y(this,ha).distance:(y(this,ha).distance=y(this,Ua).reduce((e,t)=>e+(t.properties.distance||0),0),y(this,ha).distance)}get instructions(){if(y(this,Ua).length<2)return[];if(y(this,ha).instructions)return y(this,ha).instructions;let e=[],t=0;for(let n=0;n<y(this,Ua).length;n++){let r=y(this,Ua)[n],a=y(this,Ua)[n-1],o=y(this,Ua)[n+1],s=new Wn(r.geometry.coordinates[1],r.geometry.coordinates[0],r.properties.groupBy),u=St(this,th,Xle).call(this,{prevDirection:a,direction:r,nextDirection:o});t+=a?.properties.distance||0;for(let h of u)h&&(e.push({action:h,distance:t,coordinate:s,node:y(this,wo).getById("node",r.properties.id)}),t=0)}return y(this,ha).instructions=e,y(this,ha).instructions}toJSON(){return{id:this.id,directions:y(this,Ua),__type:"directions",from:y(this,mc),to:y(this,gc)}}};ha=new WeakMap,wo=new WeakMap,Ua=new WeakMap,mc=new WeakMap,gc=new WeakMap,yc=new WeakMap,fm=new WeakMap,Ov=new WeakMap,th=new WeakSet,Xle=l(function(i){var e,t;let{prevDirection:n,direction:r,nextDirection:a}=i,o=n&&y(this,wo).getById("floor",n.properties.groupBy),s=y(this,wo).getById("floor",r.properties.groupBy),u=a&&y(this,wo).getById("floor",a.properties.groupBy),h=[];n||h.push({type:"Departure"});let d=y(this,wo).getMVFFeatureByNodeId("connection",r.properties.id),f=d?y(this,wo).getById("connection",d.id):void 0,m=d&&d.nodes.length>1,v=y(this,wo).enterpriseMode&&(!r.properties.destination||!(d!=null&&d.nodes.includes(r.properties.destination))||!(d!=null&&d.nodes.includes(r.properties.id)));if(d&&!(!m||v))if(!y(this,yc)||y(this,yc)==="exit")h.push(St(this,th,hf).call(this,"TakeConnection",s,u,f,d)),Ce(this,yc,"take"),Ce(this,fm,f),Ce(this,Ov,d);else{let b=y(this,wo).getMVFFeatureByNodeId("connection",(e=n?.properties.id)!=null?e:""),w=y(this,wo).getById("connection",(t=b?.id)!=null?t:"");h.push(St(this,th,hf).call(this,"ExitConnection",s,o,w,b)),Ce(this,yc,"exit"),Ce(this,fm,f),Ce(this,Ov,d)}else y(this,yc)==="take"?(h.push(St(this,th,hf).call(this,"ExitConnection",s,o,y(this,fm),y(this,Ov))),Ce(this,yc,"exit"),Ce(this,fm,f)):u&&s.id!==u.id?h.push(St(this,th,hf).call(this,"TakeConnection",s,u,f)):o&&o.id!==s.id?h.push(St(this,th,hf).call(this,"ExitConnection",s,o,f)):h.push(St(this,th,T8).call(this,n,r));return a||h.push({type:"Arrival"}),h},"#getActions"),hf=l(function(i,e,t,n,r){var a,o;let s="none";if(e.elevation!=null&&t?.elevation!=null){let h=e.elevation-t.elevation;h>0?s="down":h<0&&(s="up")}let u=(o=(a=n?.type)!=null?a:r?.type)!=null?o:"stairs";return{type:i,fromFloor:e,toFloor:t,direction:s,connection:n,connectionType:u}},"#createConnectionAction"),T8=l(function(i,e){let t=e.properties.edges;if(!t||t.filter(r=>r.destination.properties.id!==i?.properties.id&&r.destination.properties.id!==e.properties.destination).length===0)return null;let n=i?-jle(i.properties.angle,e.properties.angle):0;return Math.abs(n)>=I8?{type:"Turn",bearing:Gle(n,I8),referencePosition:"At"}:null},"#createTurnAction"),l(Zle,"Directions");var Yle=Zle;R();var Jle=class{constructor({nodes:e,geojsonCollection:t,connections:n,groupBy:r,multiplicativeDistanceWeightScaling:a}){D(this,"navigator"),D(this,"connections"),D(this,"getDirections",l((o,s,u,h)=>{let{accessible:d,smoothing:{enabled:f,radius:m},connectionIdWeightMap:v}=u,b=o.flatMap(k=>Lg(k,h)),w=s.flatMap(k=>Lg(k,h)),A=this.getExcludedNodeIds(u.excludedConnections).filter(k=>!b.includes(k)&&!w.includes(k)),E=this.getDisabledConnectionNodeIds(d).filter(k=>!b.includes(k)&&!w.includes(k)),I=new Map;for(let k in v){let F=h.getMVFFeatureById("connection",k);if(!F)continue;let B=this.navigator.graph.edges[F.nodes[0]];if(B){let N=B.find(z=>z.destination.properties.id===F.nodes[1]);N&&I.set(N,v[k])}}let C=this.navigator.getDirections({zones:u.zones.map(k=>{var F;return{geometry:k.geometry,cost:k.cost,map:(F=k.floor)==null?void 0:F.id}}),originIds:b,destinationNodeIds:w,excludedNodeIds:A,disabledConnectionNodeIds:E,simplify:{enabled:f,bufferRadius:m},overrideEdgeWeights:I,multiplicativeDistanceWeightScaling:!h.enterpriseMode});this.addCoordinateDirections(C,o,s);let T=new Yle(C,h,o,s);if(!(T.distance===0&&new Set([...b,...w]).size===b.length+w.length))return T},"getDirections")),D(this,"getExcludedNodeIds",l(o=>{if(o.length===0)return[];let s=new Set(o.map(u=>u.id));return this.connections.reduce((u,h)=>s.has(h.id)?u.concat(h.nodes):u,[])},"getExcludedNodeIds")),D(this,"getDisabledConnectionNodeIds",l(o=>o===!1?[]:this.connections.reduce((s,u)=>u.accessible?s:s.concat(u.nodes),[]),"getDisabledConnectionNodeIds")),D(this,"addCoordinateDirections",l((o,[s],[u])=>{if(o.features.length){if(Wn.is(s)){let h=this.createDirectionFeature(s,this.navigator.getAngle([s.longitude,s.latitude],o.features[0].geometry.coordinates),this.navigator.getDistance([s.longitude,s.latitude],o.features[0].geometry.coordinates));o.features.splice(0,0,h)}if(Wn.is(u)){let h=this.createDirectionFeature(u,0,0),d=o.features[o.features.length-1];d.properties.distance=this.navigator.getDistance(d.geometry.coordinates,[u.longitude,u.latitude]),d.properties.angle=this.navigator.getAngle(d.geometry.coordinates,[u.longitude,u.latitude]),o.features.push(h)}}},"addCoordinateDirections")),D(this,"createDirectionFeature",l((o,s,u)=>({type:"Feature",geometry:{type:"Point",coordinates:[o.longitude,o.latitude]},properties:{groupBy:o.floorId,id:o.id,angle:s,distance:u,edges:[]}}),"createDirectionFeature")),this.navigator=new T3e({nodes:e,geojsonCollection:this.createCollection(t),groupBy:r,multiplicativeDistanceWeightScaling:a}),this.connections=n}createCollection(e){return{type:"FeatureCollection",features:Object.entries(e).reduce((t,[n,r])=>t.concat(r.features.map(a=>(a.properties.map=n,a))),[])}}};l(Jle,"DirectionsInternal");var HEe=Jle;R();R();R();R();R();R();function Kle(i){let e=+this._x.call(null,i),t=+this._y.call(null,i);return r6(this.cover(e,t),e,t,i)}l(Kle,"default");function r6(i,e,t,n){if(isNaN(e)||isNaN(t))return i;var r,a=i._root,o={data:n},s=i._x0,u=i._y0,h=i._x1,d=i._y1,f,m,v,b,w,A,E,I;if(!a)return i._root=o,i;for(;a.length;)if((w=e>=(f=(s+h)/2))?s=f:h=f,(A=t>=(m=(u+d)/2))?u=m:d=m,r=a,!(a=a[E=A<<1|w]))return r[E]=o,i;if(v=+i._x.call(null,a.data),b=+i._y.call(null,a.data),e===v&&t===b)return o.next=a,r?r[E]=o:i._root=o,i;do r=r?r[E]=new Array(4):i._root=new Array(4),(w=e>=(f=(s+h)/2))?s=f:h=f,(A=t>=(m=(u+d)/2))?u=m:d=m;while((E=A<<1|w)===(I=(b>=m)<<1|v>=f));return r[I]=a,r[E]=o,i}l(r6,"add");function Qle(i){var e,t,n=i.length,r,a,o=new Array(n),s=new Array(n),u=1/0,h=1/0,d=-1/0,f=-1/0;for(t=0;t<n;++t)isNaN(r=+this._x.call(null,e=i[t]))||isNaN(a=+this._y.call(null,e))||(o[t]=r,s[t]=a,r<u&&(u=r),r>d&&(d=r),a<h&&(h=a),a>f&&(f=a));if(u>d||h>f)return this;for(this.cover(u,h).cover(d,f),t=0;t<n;++t)r6(this,o[t],s[t],i[t]);return this}l(Qle,"addAll");R();function eue(i,e){if(isNaN(i=+i)||isNaN(e=+e))return this;var t=this._x0,n=this._y0,r=this._x1,a=this._y1;if(isNaN(t))r=(t=Math.floor(i))+1,a=(n=Math.floor(e))+1;else{for(var o=r-t||1,s=this._root,u,h;t>i||i>=r||n>e||e>=a;)switch(h=(e<n)<<1|i<t,u=new Array(4),u[h]=s,s=u,o*=2,h){case 0:r=t+o,a=n+o;break;case 1:t=r-o,a=n+o;break;case 2:r=t+o,n=a-o;break;case 3:t=r-o,n=a-o;break}this._root&&this._root.length&&(this._root=s)}return this._x0=t,this._y0=n,this._x1=r,this._y1=a,this}l(eue,"default");R();function tue(){var i=[];return this.visit(function(e){if(!e.length)do i.push(e.data);while(e=e.next)}),i}l(tue,"default");R();function iue(i){return arguments.length?this.cover(+i[0][0],+i[0][1]).cover(+i[1][0],+i[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}l(iue,"default");R();R();function ro(i,e,t,n,r){this.node=i,this.x0=e,this.y0=t,this.x1=n,this.y1=r}l(ro,"default");function nue(i,e,t){var n,r=this._x0,a=this._y0,o,s,u,h,d=this._x1,f=this._y1,m=[],v=this._root,b,w;for(v&&m.push(new ro(v,r,a,d,f)),t==null?t=1/0:(r=i-t,a=e-t,d=i+t,f=e+t,t*=t);b=m.pop();)if(!(!(v=b.node)||(o=b.x0)>d||(s=b.y0)>f||(u=b.x1)<r||(h=b.y1)<a))if(v.length){var A=(o+u)/2,E=(s+h)/2;m.push(new ro(v[3],A,E,u,h),new ro(v[2],o,E,A,h),new ro(v[1],A,s,u,E),new ro(v[0],o,s,A,E)),(w=(e>=E)<<1|i>=A)&&(b=m[m.length-1],m[m.length-1]=m[m.length-1-w],m[m.length-1-w]=b)}else{var I=i-+this._x.call(null,v.data),C=e-+this._y.call(null,v.data),T=I*I+C*C;if(T<t){var k=Math.sqrt(t=T);r=i-k,a=e-k,d=i+k,f=e+k,n=v.data}}return n}l(nue,"default");R();function rue(i){if(isNaN(d=+this._x.call(null,i))||isNaN(f=+this._y.call(null,i)))return this;var e,t=this._root,n,r,a,o=this._x0,s=this._y0,u=this._x1,h=this._y1,d,f,m,v,b,w,A,E;if(!t)return this;if(t.length)for(;;){if((b=d>=(m=(o+u)/2))?o=m:u=m,(w=f>=(v=(s+h)/2))?s=v:h=v,e=t,!(t=t[A=w<<1|b]))return this;if(!t.length)break;(e[A+1&3]||e[A+2&3]||e[A+3&3])&&(n=e,E=A)}for(;t.data!==i;)if(r=t,!(t=t.next))return this;return(a=t.next)&&delete t.next,r?(a?r.next=a:delete r.next,this):e?(a?e[A]=a:delete e[A],(t=e[0]||e[1]||e[2]||e[3])&&t===(e[3]||e[2]||e[1]||e[0])&&!t.length&&(n?n[E]=t:this._root=t),this):(this._root=a,this)}l(rue,"default");function aue(i){for(var e=0,t=i.length;e<t;++e)this.remove(i[e]);return this}l(aue,"removeAll");R();function oue(){return this._root}l(oue,"default");R();function sue(){var i=0;return this.visit(function(e){if(!e.length)do++i;while(e=e.next)}),i}l(sue,"default");R();function lue(i){var e=[],t,n=this._root,r,a,o,s,u;for(n&&e.push(new ro(n,this._x0,this._y0,this._x1,this._y1));t=e.pop();)if(!i(n=t.node,a=t.x0,o=t.y0,s=t.x1,u=t.y1)&&n.length){var h=(a+s)/2,d=(o+u)/2;(r=n[3])&&e.push(new ro(r,h,d,s,u)),(r=n[2])&&e.push(new ro(r,a,d,h,u)),(r=n[1])&&e.push(new ro(r,h,o,s,d)),(r=n[0])&&e.push(new ro(r,a,o,h,d))}return this}l(lue,"default");R();function uue(i){var e=[],t=[],n;for(this._root&&e.push(new ro(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var r=n.node;if(r.length){var a,o=n.x0,s=n.y0,u=n.x1,h=n.y1,d=(o+u)/2,f=(s+h)/2;(a=r[0])&&e.push(new ro(a,o,s,d,f)),(a=r[1])&&e.push(new ro(a,d,s,u,f)),(a=r[2])&&e.push(new ro(a,o,f,d,h)),(a=r[3])&&e.push(new ro(a,d,f,u,h))}t.push(n)}for(;n=t.pop();)i(n.node,n.x0,n.y0,n.x1,n.y1);return this}l(uue,"default");R();function hue(i){return i[0]}l(hue,"defaultX");function cue(i){return arguments.length?(this._x=i,this):this._x}l(cue,"default");R();function pue(i){return i[1]}l(pue,"defaultY");function due(i){return arguments.length?(this._y=i,this):this._y}l(due,"default");function a6(i,e,t){var n=new JA(e??hue,t??pue,NaN,NaN,NaN,NaN);return i==null?n:n.addAll(i)}l(a6,"quadtree");function JA(i,e,t,n,r,a){this._x=i,this._y=e,this._x0=t,this._y0=n,this._x1=r,this._y1=a,this._root=void 0}l(JA,"Quadtree");function dP(i){for(var e={data:i.data},t=e;i=i.next;)t=t.next={data:i.data};return e}l(dP,"leaf_copy");var Po=a6.prototype=JA.prototype;Po.copy=function(){var i=new JA(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,t,n;if(!e)return i;if(!e.length)return i._root=dP(e),i;for(t=[{source:e,target:i._root=new Array(4)}];e=t.pop();)for(var r=0;r<4;++r)(n=e.source[r])&&(n.length?t.push({source:n,target:e.target[r]=new Array(4)}):e.target[r]=dP(n));return i};Po.add=Kle;Po.addAll=Qle;Po.cover=eue;Po.data=tue;Po.extent=iue;Po.find=nue;Po.remove=rue;Po.removeAll=aue;Po.root=oue;Po.size=sue;Po.visit=lue;Po.visitAfter=uue;Po.x=cue;Po.y=due;var Fl,vc,_c,Nv,fue=class{constructor(e,t){ge(this,Fl,{}),ge(this,vc,{}),ge(this,_c),ge(this,Nv),Ce(this,_c,e),Ce(this,Nv,t)}getTreeByType(e,t,n,r=[]){var a,o;y(this,Fl)[e]||(y(this,Fl)[e]={}),y(this,vc)[e]||(y(this,vc)[e]={}),y(this,vc)[e][t]||(y(this,vc)[e][t]={});let s=y(this,vc)[e][t][n],u=!VL(s,r);if((a=y(this,Fl)[e][t])!=null&&a[n]&&!u)return y(this,Fl)[e][t][n];y(this,Fl)[e][t]||(y(this,Fl)[e][t]={}),y(this,Fl)[e][t][n]=a6();let h=y(this,Fl)[e][t][n];h.x(f=>y(this,Nv).call(this,f.geometry.coordinates).x),h.y(f=>y(this,Nv).call(this,f.geometry.coordinates).y);let d=[];switch(e){case"node":d=((o=y(this,_c).directions.navigator.graph.nodesByGroup.get(n))==null?void 0:o.filter(f=>f.properties.neighbors.length>0))||[];break;case"point-of-interest":d=y(this,_c).mvfPoisByFloorId[n]||[];break;case"door":d=y(this,_c).mvfEntrancesByFloorId[n]||[];break;case"annotation":d=y(this,_c).mvfAnnotationsByFloorId[n]||[];break}if(r?.length>0&&d?.length>0){let f=new Set(r);d=d.filter(m=>{let v=y(this,_c).getById(e,m.properties.id);return v&&!f.has(v)})}return d?.length>0&&h.addAll(d),y(this,vc)[e][t][n]=r?[...r]:void 0,h}};Fl=new WeakMap,vc=new WeakMap,_c=new WeakMap,Nv=new WeakMap,l(fue,"QueryCache");var WEe=fue,qEe=.1,XEe=5,ZEe=100,YEe=2,P8=1e3,L8=111319.9,JEe=eo.object({limit:eo.enum(["same-floor","same-elevation"]).optional(),radius:eo.number().optional(),useLineOfSight:eo.boolean().optional(),types:eo.array(eo.enum(["node","point-of-interest","door","annotation"])).min(1)}),Vo,mm,gm,I2,fP,T2,mP,mue=class{constructor(e){ge(this,Vo),ge(this,mm),ge(this,gm,l(([t,n])=>{let[r,a]=[y(this,Vo).mapCenter.longitude,y(this,Vo).mapCenter.latitude],o=L8,s=L8*Math.cos(n*Math.PI/180),u=(t-r)*s,h=(n-a)*o;return{x:u,y:h}},"#projectOntoCartesianPlane")),ge(this,I2,new Map),ge(this,fP,l((t,n)=>{var r;let a=(r=y(this,I2).get(t))==null?void 0:r.get(n);if(a)return a;let o=y(this,mm).getTreeByType(t,y(this,Vo).mapName,n);if(typeof o.extent=="function")if(o.extent()){let[[s,u],[h,d]]=o.extent(),f=h-s,m=d-u;a=Math.max(f,m)}else a=P8;else a=P8;return y(this,I2).set(t,new Map([[n,a]])),a},"#getMaxRadiusForFloorId")),ge(this,T2,l((t,n,r,a,o,s=[])=>{let u=[],h=0,d=y(this,fP).call(this,n,r);for(;u.length===0&&h<ZEe;){if(o>d)return;u=y(this,mP).call(this,n,r,a,[t.longitude,t.latitude],o,s),u.length===0&&(o*=YEe,h++)}let f=u.sort((m,v)=>{let b=ou([t.longitude,t.latitude],m.geometry.coordinates),w=ou([t.longitude,t.latitude],v.geometry.coordinates);return b-w});for(let m of f)if(s.push(m.properties.id),y(this,Vo).directions.navigator.hasLineOfSight([t.longitude,t.latitude],m.geometry.coordinates,r,qEe))return m;return y(this,T2).call(this,t,n,r,a,o,s)},"#searchWithLineOfSight")),ge(this,mP,l((t,n,r,a,o,s=[])=>{let{x:u,y:h}=y(this,gm).call(this,a),d=u-o,f=u+o,m=h-o,v=h+o,b=[];return y(this,mm).getTreeByType(t,y(this,Vo).mapName,n,r).visit((w,A,E,I,C)=>{if(!w.length)do{if(!("data"in w))continue;let T=w.data;if(s.includes(T.properties.id))continue;let k=y(this,gm).call(this,T.geometry.coordinates);k.x>=d&&k.x<f&&k.y>=m&&k.y<v&&b.push(T)}while("next"in w&&w.next&&(w=w.next));return A>=f||E>=v||I<d||C<m}),b},"#searchWithinBounds")),Ce(this,Vo,e),Ce(this,mm,new WEe(y(this,Vo),y(this,gm)))}nearest(e,t){var n,r,a;try{JEe.parse(t)}catch(h){nt.error(h);return}let o=Sw(e);if(!o)return;let s=o.floorId?[o.floorId]:[];if(o.floorId==null)for(let h of y(this,Vo).getByType("floor-stack")){let d=h.defaultFloor;d&&s.push(d.id)}else if(t.limit==="same-elevation"){let h=y(this,Vo).floorsById[o.floorId];if(h){let d=h?.elevation;d&&(s=y(this,Vo).getByType("floor-stack").map(f=>{var m;return(m=f.floors.find(v=>v.elevation===d))==null?void 0:m.id}).filter(Boolean))}}let u=[];for(let h of Wle(t.types))for(let d of s){let f;if(((n=t.lineOfSight)==null||n)&&(f=y(this,T2).call(this,o,h,d,(r=t.exclude)!=null?r:[],(a=t.radius)!=null?a:XEe)),!f){let m=y(this,gm).call(this,[o.longitude,o.latitude]);f=y(this,mm).getTreeByType(h,y(this,Vo).mapName,d,t.exclude).find(m.x,m.y)}if(f){let m=y(this,Vo).getById(h,f.properties.id);m&&u.push({distance:ou([o.longitude,o.latitude],f.geometry.coordinates),feature:m})}}return u.sort((h,d)=>h.distance-d.distance)}};Vo=new WeakMap,mm=new WeakMap,gm=new WeakMap,I2=new WeakMap,fP=new WeakMap,T2=new WeakMap,mP=new WeakMap,l(mue,"Query");var KEe=mue;R();R();var P2,gue=class{constructor(e){ge(this,P2),Ce(this,P2,e||[])}get raw(){return y(this,P2)}};P2=new WeakMap,l(gue,"OpeningHours");var QEe=gue,Ka,mi,sr,gP=class L2 extends Xc{constructor(e,t){super(t.mvfData.id),D(this,"__type",L2.__type),D(this,"id","loc_"),D(this,"name",""),D(this,"externalId"),D(this,"description"),D(this,"logo"),D(this,"phone"),D(this,"social",[]),D(this,"images",[]),D(this,"links",[]),D(this,"website"),D(this,"icon"),ge(this,Ka),ge(this,mi,{}),ge(this,sr),Ce(this,Ka,e),Ce(this,sr,t.mvfData);for(let n in t.mvfData)n==="links"?this.links=t.mvfData.links.map(r=>new bw({mvfData:r})):n==="pictures"?this.images=t.mvfData.pictures.map(r=>{var a;return r.url?new Aw({mvfData:lt(Me({},r),{url:(a=r.url)!=null?a:""}),mapData:y(this,Ka)}):void 0}).filter(r=>r!=null):n==="website"?t.mvfData.website&&(this.website=new bw({mvfData:t.mvfData.website})):n==="icon"?t.mvfData.icon&&(this.icon=new Aw({mvfData:{url:t.mvfData.icon},mapData:y(this,Ka)})):Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),n)||Object.defineProperty(this,n,{enumerable:!0,get(){return y(this,sr)[n]}})}static is(e){return e.__type===L2.__type}get spaces(){if(y(this,mi).spaces)return y(this,mi).spaces;if(y(this,sr).spaces==null)return y(this,mi).spaces=[],y(this,mi).spaces;y(this,mi).spaces=[];for(let e=0;e<y(this,sr).spaces.length;e++){let t=y(this,Ka).getById("space",y(this,sr).spaces[e].id);t&&y(this,mi).spaces.push(t)}return y(this,mi).spaces}get points(){if(y(this,mi).points)return y(this,mi).points;if(y(this,sr).spaces==null)return y(this,mi).points=[],y(this,mi).points;y(this,mi).points=[];for(let e=0;e<y(this,sr).spaces.length;e++){let t=y(this,Ka).getById("point-of-interest",y(this,sr).spaces[e].id);t&&y(this,mi).points.push(t)}return y(this,mi).points}get doors(){if(y(this,mi).doors)return y(this,mi).doors;if(y(this,sr).entrances==null)return y(this,mi).doors=[],y(this,mi).doors;y(this,mi).doors=[];for(let e=0;e<y(this,sr).entrances.length;e++){let t=y(this,Ka).getById("door",y(this,sr).entrances[e].id);t&&y(this,mi).doors.push(t)}return y(this,mi).doors}get connections(){var e;if(y(this,mi).connections)return y(this,mi).connections;if(y(this,sr).connections==null)return y(this,mi).connections=[],y(this,mi).connections;let t=new Set;for(let n=0;n<y(this,sr).connections.length;n++){let r=y(this,sr).connections[n],a=y(this,Ka).mvfConnectionsById[r],o=(a==null?[]:a.nodes).map(s=>y(this,Ka).getById("node",s)).filter(Boolean);for(let s of o){if(s==null)continue;let u=qg([s.coordinate.longitude,s.coordinate.latitude]),h=((e=y(this,Ka).connectionSpaceIdsByLatLon[u])!=null?e:[]).map(d=>y(this,Ka).connectionsById[d]).filter(d=>d!=null);for(let d of h)t.add(d)}}return y(this,mi).connections=Array.from(t),y(this,mi).connections}get annotations(){if(y(this,mi).annotations)return y(this,mi).annotations;if(y(this,sr).annotations==null)return y(this,mi).annotations=[],y(this,mi).annotations;y(this,mi).annotations=[];for(let e=0;e<y(this,sr).annotations.length;e++){let t=y(this,Ka).getById("annotation",y(this,sr).annotations[e].id);t&&y(this,mi).annotations.push(t)}return y(this,mi).annotations}get categories(){return y(this,mi).categories?y(this,mi).categories:y(this,sr).categories==null?(y(this,mi).categories=[],y(this,mi).categories):(y(this,mi).categories=y(this,sr).categories.map(e=>y(this,Ka).getById("location-category",e)).filter(e=>e!=null),y(this,mi).categories)}get mapObjects(){return y(this,mi).mapObjects?y(this,mi).mapObjects:y(this,sr).obstructions==null?(y(this,mi).mapObjects=[],y(this,mi).mapObjects):(y(this,mi).mapObjects=y(this,sr).obstructions.map(e=>y(this,Ka).getById("object",e.id)).filter(e=>e!=null),y(this,mi).mapObjects)}get areas(){return y(this,mi).areas?y(this,mi).areas:y(this,sr).areas==null?(y(this,mi).areas=[],y(this,mi).areas):(y(this,mi).areas=y(this,sr).areas.map(e=>y(this,Ka).getById("area",e.id)).filter(e=>e!=null),y(this,mi).areas)}get focusTarget(){if(y(this,mi).focusTarget)return y(this,mi).focusTarget;let e=[];for(let t of this.spaces)e.push(t);for(let t of this.connections)e.push(...t.coordinates);for(let t of this.doors)e.push(t.focusTarget);for(let t of this.mapObjects)e.push(t.focusTarget);for(let t of this.annotations)e.push(t.focusTarget);for(let t of this.points)e.push(t.focusTarget);for(let t of this.areas)e.push(t.focusTarget);return y(this,mi).focusTarget=e,e}get openingHours(){var e;return y(this,mi).openingHours?y(this,mi).openingHours:(y(this,mi).openingHours=new QEe((e=y(this,sr).openingHoursSpecification)!=null?e:[]),y(this,mi).openingHours)}get navigationTarget(){if(y(this,mi).navigationTarget)return y(this,mi).navigationTarget;let e=[];for(let t of this.spaces)e.push(t);for(let t of this.connections)e.push(...t.coordinates);for(let t of this.doors)e.push(t.focusTarget);for(let t of this.mapObjects)e.push(t.focusTarget);for(let t of this.annotations)e.push(t.focusTarget);for(let t of this.points)e.push(t.focusTarget);return y(this,mi).navigationTarget=e,e}toJSON(){return{__type:L2.__type,id:this.id,name:this.name}}};Ka=new WeakMap,mi=new WeakMap,sr=new WeakMap,l(gP,"LocationProfile"),D(gP,"__type","location-profile");var eIe=gP,o6=eIe;R();var Np,as,ym,yP=class D2 extends Xc{constructor(e,t){super(t.mvfData.id),D(this,"__type",D2.__type),D(this,"id","cat_"),D(this,"name",""),D(this,"icon",""),ge(this,Np),ge(this,as,{}),ge(this,ym),Ce(this,Np,e),Ce(this,ym,t.mvfData);for(let n in t.mvfData)Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),n)||Object.defineProperty(this,n,{enumerable:!0,get(){return y(this,ym)[n]}})}static is(e){return e.__type===D2.__type}get parent(){return y(this,as).parent?y(this,as).parent:(y(this,as).parent=y(this,ym).parent?y(this,Np).getById("location-category",y(this,ym).parent):void 0,y(this,as).parent)}get children(){return y(this,as).children?y(this,as).children:(y(this,as).children=y(this,Np).locationCategoriesByParentId[this.id]||[],y(this,as).children)}get locationProfiles(){if(y(this,as).locationProfiles)return y(this,as).locationProfiles;let e=[];for(let t of y(this,Np).locationProfilesByCategoryId[this.id]||[]){let n=y(this,Np).getById("location-profile",t.id);n&&e.push(n)}return y(this,as).locationProfiles=e,e}toJSON(){return{__type:D2.__type,id:this.id,name:this.name}}};Np=new WeakMap,as=new WeakMap,ym=new WeakMap,l(yP,"LocationCategory"),D(yP,"__type","location-category");var tIe=yP,yue=tIe,Oi,vP,vue,Fv,_ue=class extends xr{constructor(e,t){var n,r,a,o,s;super(),ge(this,vP),D(this,"Analytics"),ge(this,Oi,{}),D(this,"Query"),D(this,"mvf"),D(this,"outdoorViewToken"),D(this,"objectEntranceNodeIdsByObstructionId"),D(this,"obstructionIdByEntranceId"),D(this,"venue"),D(this,"tokenManager"),D(this,"directions"),D(this,"enterpriseMode",!1),D(this,"nodesById"),D(this,"spacesById"),D(this,"floorsById"),D(this,"floorStacksById"),D(this,"facadesById"),D(this,"facadesBySpaceId"),D(this,"connectionsById"),D(this,"objectsById"),D(this,"doorsById"),D(this,"pointsOfInterestById"),D(this,"annotationsById"),D(this,"areasById"),D(this,"locationProfilesById"),D(this,"locationCategoriesById"),D(this,"locationProfilesByExternalId"),D(this,"locationProfilesByCategoryId"),D(this,"locationCategoriesByParentId"),D(this,"doorsByNodeId"),D(this,"mvfAnnotationsById"),D(this,"mvfConnectionsById"),D(this,"mvfConnectionsByNodeId"),D(this,"mvfConnectionIdsByLatLon"),D(this,"mvfEntrancesById"),D(this,"mvfNodesById"),D(this,"mvfObstructionById"),D(this,"mvfSpacesById"),D(this,"mvfFloorsById"),D(this,"mvfFloorStacksById"),D(this,"mvfAreasById"),D(this,"spacesByExternalId"),D(this,"nodesByExternalId"),D(this,"objectsByExternalId"),D(this,"poisByExternalId"),D(this,"floorsByExternalId"),D(this,"floorStacksByExternalId"),D(this,"doorsByExternalId"),D(this,"areasByExternalId"),D(this,"connectionSpaceIdsByLatLon",{}),D(this,"locationProfilesByAttachedFeatureId",{}),D(this,"locationsById",{}),D(this,"categoriesById",{}),D(this,"mvfLocationsBySpaceId",{}),D(this,"locationIdsByNodeId",{}),D(this,"spaceIdsByNodeId",{}),D(this,"connectionsByExternalId",{}),D(this,"locationsByExternalId",{}),D(this,"categoriesByExternalId",{}),D(this,"destinationNodesIdsBySpaceId",{}),D(this,"mvfNodesByFloorId"),D(this,"mvfSpacesByFloorId"),D(this,"mvfPoisByFloorId"),D(this,"mvfEntrancesByFloorId"),D(this,"mvfAnnotationsByFloorId"),D(this,"localePacksUrls"),D(this,"currentLanguage"),D(this,"languagePacks",{}),D(this,"tilesets",{}),D(this,"binaryBundle"),D(this,"envControl"),D(this,"getMapDataOptions"),ge(this,Fv),D(this,"getDirectionsMultiDestination",l((d,f,m)=>this.getDirections(d,f,lt(Me({},m),{multiDestination:!0})),"getDirectionsMultiDestination")),D(this,"getDirections",l((d,f,m)=>{let{accessible:v=!1,smoothing:b=!0,multiDestination:w=!1}=m||{},A=typeof b=="object"?b.enabled:b,E=typeof b=="object"?b.radius:void 0,I=m?.zones||[],C={accessible:v,zones:I,smoothing:{enabled:A??!0,radius:E??.75},excludedConnections:m?.excludedConnections||[],connectionIdWeightMap:m?.connectionIdWeightMap||{}};if(w&&Array.isArray(f)){let T=Array.isArray(d)?d:[d],k=[];for(let F of f){let B=Array.isArray(F)?F:[F],N=this.directions.getDirections(T,B,C,this);if(!N){nt.error("getDirections failed due to missing directions for one of the segments");return}T=B,k.push(N)}return k}else{let T=Array.isArray(d)?d:[d],k=Array.isArray(f)?f:[f];if(Array.isArray(k[0])){nt.error("getDirections does not support multi-destination without multisegment option");return}T[0].id&&k[0].id&&this.Analytics.sendGetDirectionsEvent(T[0].id,k[0].id);try{return this.directions.getDirections(T,k,C,this)}catch(F){nt.error("Unable to get directions",F);return}}},"getDirections")),D(this,"transformImageRequest",l(async d=>{var f;if(this.enterpriseMode||!this.getMapDataOptions)return{url:d};if(!Aie(d))return{url:d};if(Sie(d))return{url:d};let m=Eie(d);if(!m)return{url:d};try{let v=await((f=this.tokenManager)==null?void 0:f.getSasTokensAsync()),b=v?.[m.mapId];if(b==null)throw new Error("SAS token not found");let[w]=d.split("?");return{url:"".concat(w,"?").concat(b.token)}}catch(v){return nt.error("Failed to append SAS token to image request. Requests for private images may fail.",v),{url:d}}},"transformImageRequest"));let u=(n=t?.env)!=null?n:M0();if(this.envControl=u,this.binaryBundle=t?.binaryBundle,this.Analytics=new $ie,this.localePacksUrls=(r=t?.localePacksUrls)!=null?r:{},this.mvf=e,this.outdoorViewToken=t?.outdoorViewToken,this.getMapDataOptions=t?.getMapDataOptions,((a=e["tileset.json"])==null?void 0:a.default)!=null&&(this.tilesets[e["tileset.json"].default.key]=e["tileset.json"].default,u.updateTileServerBaseUrl(e["tileset.json"].default.url),e["tileset.json"].others!=null))for(let d of e["tileset.json"].others)this.tilesets[d.key]=d;this.enterpriseMode=(o=t?.enterprise)!=null?o:!1,this.tokenManager=t?.tokenManager;let h=SAe(e,this);if(this.nodesById=h.nodesById,this.spacesById=h.spacesById,this.floorsById=h.floorsById,this.floorStacksById=h.floorStacksById,this.facadesById=h.facadesById,this.facadesBySpaceId=h.facadesBySpaceId,this.connectionsById=h.connectionsById,this.objectsById=h.objectsById,this.doorsById=h.doorsById,this.pointsOfInterestById=h.poisById,this.annotationsById=h.annotationsById,this.areasById=h.areasById,this.locationProfilesById=h.locationProfilesById,this.locationCategoriesById=h.locationCategoriesById,this.locationProfilesByCategoryId=h.locationProfilesByCategoryId,this.locationCategoriesByParentId=h.locationCategoriesByParentId,this.spacesByExternalId=h.spacesByExternalId,this.nodesByExternalId=h.nodesByExternalId,this.objectsByExternalId=h.objectsByExternalId,this.floorsByExternalId=h.floorsByExternalId,this.locationProfilesByExternalId=h.locationProfilesByExternalId,this.floorStacksByExternalId=h.floorStacksByExternalId,this.poisByExternalId=h.poisByExternalId,this.doorsByExternalId=h.doorsByExternalId,this.areasByExternalId=h.areasByExternalId,this.mvfAnnotationsById=h.mvfAnnotationsById,this.mvfConnectionsById=h.mvfConnectionsById,this.mvfConnectionsByNodeId=h.mvfConnectionsByNodeId,this.mvfConnectionIdsByLatLon=h.mvfConnectionIdsByLatLon,this.mvfEntrancesById=h.mvfEntrancesById,this.mvfNodesById=h.mvfNodesById,this.mvfObstructionById=h.mvfObstructionById,this.mvfSpacesById=h.mvfSpacesById,this.mvfFloorsById=h.mvfFloorsById,this.mvfFloorStacksById=h.mvfFloorStacksById,this.mvfNodesByFloorId=h.mvfNodesByFloorId,this.mvfSpacesByFloorId=h.mvfSpacesByFloorId,this.mvfPoisByFloorId=h.mvfPoisByFloorId,this.mvfEntrancesByFloorId=h.mvfEntrancesByFloorId,this.mvfAnnotationsByFloorId=h.mvfAnnotationsByFloorId,this.mvfAreasById=h.mvfAreasById,this.doorsByNodeId=h.doorsByNodeId,this.objectEntranceNodeIdsByObstructionId=h.objectEntranceNodeIdsByObstructionId,this.obstructionIdByEntranceId=h.obstructionIdByEntranceId,this.connectionSpaceIdsByLatLon=h.connectionIdsByLatLon,this.locationProfilesByAttachedFeatureId=h.locationProfilesByAttachedFeatureId,this.enterpriseMode){let d=AAe(e,this);if(this.locationsById=d.locationsById,this.categoriesById=d.categoriesById,this.mvfLocationsBySpaceId=d.mvfLocationsBySpaceId,this.locationIdsByNodeId=d.locationIdsByNodeId,this.spaceIdsByNodeId=d.spaceIdsByNodeId,this.connectionsByExternalId=d.connectionsByExternalId,this.locationsByExternalId=d.locationsByExternalId,this.categoriesByExternalId=d.categoriesByExternalId,this.destinationNodesIdsBySpaceId=d.destinationNodesIdsBySpaceId,d.venue.name!=null){this.venue=new Xie(this,{mvfData:d.venue});let f={};for(let m in d.mvfLocationsById)f[m]=d.mvfLocationsById[m];for(let m in d.locationInstancesById)f[m]=d.locationInstancesById[m];this.languagePacks[this.venue.defaultLanguage.code]={type:"initial",optimized:{"enterprise-location":f,"enterprise-category":d.mvfCategoriesById,"floor-stack":h.mvfFloorStacksById,floor:h.mvfFloorsById}},(s=t?.languagePacks)==null||s.forEach(({language:m,localePack:v})=>{this.languagePacks[m.code]=ZE(v)}),this.currentLanguage=this.venue.defaultLanguage}}this.directions=new HEe({nodes:e["node.geojson"],geojsonCollection:e.enterprise?e.space:e.obstruction,connections:e["connection.json"],groupBy:"map",multiplicativeDistanceWeightScaling:!this.enterpriseMode}),this.Query=new KEe(this)}getEnv(){let e=this;return{get baseUri(){var t;return e.envControl.getBaseUri((t=e.enterpriseMode)!=null?t:!1)},get baseAuthUri(){return e.envControl.getBaseAuthUri()},get analyticsBaseUri(){return e.envControl.getAnalyticsBaseUri()},get tileServerUri(){return e.envControl.getTileServerUri()}}}get mapName(){return this.mvf["manifest.geojson"].features[0].properties.name}get organizationId(){var e;return(e=this.mvf["manifest.geojson"].features[0].properties.org_id)!=null?e:""}get mapCenter(){return new Wn(this.mvf["manifest.geojson"].features[0].geometry.coordinates[1],this.mvf["manifest.geojson"].features[0].geometry.coordinates[0])}get naturalBearing(){var e;return(e=this.mvf["manifest.geojson"].features[0].properties.naturalBearing)!=null?e:0}get spaces(){return y(this,Oi).spaces==null&&(y(this,Oi).spaces=globalThis.Object.values(this.spacesById)),y(this,Oi).spaces}get objects(){return y(this,Oi).objects==null&&(y(this,Oi).objects=globalThis.Object.values(this.objectsById)),y(this,Oi).objects}get connections(){return y(this,Oi).connections==null&&(y(this,Oi).connections=globalThis.Object.values(this.connectionsById)),y(this,Oi).connections}get floors(){return y(this,Oi).floors==null&&(y(this,Oi).floors=globalThis.Object.values(this.floorsById)),y(this,Oi).floors}get floorStacks(){return y(this,Oi).floorStacks==null&&(y(this,Oi).floorStacks=globalThis.Object.values(this.floorStacksById)),y(this,Oi).floorStacks}get facades(){return y(this,Oi).facades==null&&(y(this,Oi).facades=globalThis.Object.values(this.facadesById)),y(this,Oi).facades}get doors(){return y(this,Oi).doors==null&&(y(this,Oi).doors=globalThis.Object.values(this.doorsById)),y(this,Oi).doors}get pointsOfInterest(){return y(this,Oi).pointsOfInterest==null&&(y(this,Oi).pointsOfInterest=globalThis.Object.values(this.pointsOfInterestById)),y(this,Oi).pointsOfInterest}get annotations(){return y(this,Oi).annotations==null&&(y(this,Oi).annotations=globalThis.Object.values(this.annotationsById)),y(this,Oi).annotations}get areas(){return y(this,Oi).areas==null&&(y(this,Oi).areas=globalThis.Object.values(this.areasById)),y(this,Oi).areas}get nodes(){return y(this,Oi).nodes==null&&(y(this,Oi).nodes=globalThis.Object.values(this.nodesById)),y(this,Oi).nodes}get locations(){return y(this,Oi).locations==null&&(y(this,Oi).locations=globalThis.Object.values(this.locationsById)),globalThis.Object.values(this.locationsById)}get categories(){return y(this,Oi).categories==null&&(y(this,Oi).categories=globalThis.Object.values(this.categoriesById)),globalThis.Object.values(this.categoriesById)}get locationProfiles(){return y(this,Oi).locationProfiles==null&&(y(this,Oi).locationProfiles=globalThis.Object.values(this.locationProfilesById)),y(this,Oi).locationProfiles}get locationCategories(){return y(this,Oi).locationCategories==null&&(y(this,Oi).locationCategories=globalThis.Object.values(this.locationCategoriesById)),y(this,Oi).locationCategories}get mvfFloors(){return y(this,Oi).mvfFloors==null&&(y(this,Oi).mvfFloors=globalThis.Object.values(this.mvfFloorsById)),y(this,Oi).mvfFloors}get mvfFloorStacks(){return y(this,Oi).mvfFloorStacks==null&&(y(this,Oi).mvfFloorStacks=globalThis.Object.values(this.mvfFloorStacksById)),y(this,Oi).mvfFloorStacks}getByType(e){switch(e){case"location-profile":return this.locationProfiles;case"location-category":return this.locationCategories;case"area":return this.areas;case"node":return this.nodes;case"space":return this.spaces;case"door":return this.doors;case"floor":return this.floors;case"floor-stack":return this.floorStacks;case"connection":return this.connections;case"object":return this.objects;case"point-of-interest":return this.pointsOfInterest;case"annotation":return this.annotations;case"enterprise-location":return this.locations;case"enterprise-category":return this.categories;case"enterprise-venue":return this.venue;case"facade":return this.facades;default:return[]}}getById(e,t){let n={"location-profile":this.locationProfilesById,"location-category":this.locationCategoriesById,space:this.spacesById,floor:this.floorsById,"floor-stack":this.floorStacksById,facade:this.facadesById,node:this.nodesById,door:this.doorsById,connection:this.connectionsById,"mvf-connection":l(o=>St(this,vP,vue).call(this,this.mvfConnectionsById[o]),"mvf-connection"),object:this.objectsById,"point-of-interest":this.pointsOfInterestById,annotation:this.annotationsById,area:this.areasById,"enterprise-location":this.locationsById,"enterprise-category":this.categoriesById},r=l(o=>{let s=n[o];if(s!=null)return typeof s=="function"?s(t):s[t]},"getItemFromCollection"),a=l(()=>{for(let o of Object.keys(n)){let s=r(o);if(s!=null)return s}},"getItemFromAllCollections");return e==="unknown"?a():r(e)}getByExternalId(e,t){var n,r,a,o,s,u,h,d,f,m,v,b;switch(e){case"location-profile":return(n=this.locationProfilesByExternalId[t])!=null?n:[];case"location-category":return[];case"space":return(r=this.spacesByExternalId[t])!=null?r:[];case"floor":return(a=this.floorsByExternalId[t])!=null?a:[];case"floor-stack":return(o=this.floorStacksByExternalId[t])!=null?o:[];case"node":return(s=this.nodesByExternalId[t])!=null?s:[];case"door":return(u=this.doorsByExternalId[t])!=null?u:[];case"connection":return(h=this.connectionsByExternalId[t])!=null?h:[];case"object":return(d=this.objectsByExternalId[t])!=null?d:[];case"point-of-interest":return(f=this.poisByExternalId[t])!=null?f:[];case"area":return(m=this.areasByExternalId[t])!=null?m:[];case"enterprise-location":return(v=this.locationsByExternalId[t])!=null?v:[];case"enterprise-category":return(b=this.categoriesByExternalId[t])!=null?b:[];default:return[]}}getMapDataById(e){var t,n,r,a,o,s,u,h,d,f;return(f=(d=(h=(u=(s=(o=(a=(r=(n=(t=this.spacesById[e])!=null?t:this.floorsById[e])!=null?n:this.floorStacksById[e])!=null?r:this.facadesById[e])!=null?a:this.nodesById[e])!=null?o:this.doorsById[e])!=null?s:this.connectionsById[e])!=null?u:this.objectsById[e])!=null?h:this.pointsOfInterestById[e])!=null?d:this.annotationsById[e])!=null?f:this.areasById[e]}getMVFFeatureById(e,t){switch(e){case"space":return this.mvfSpacesById[t];case"node":return this.mvfNodesById[t];case"obstruction":return this.mvfObstructionById[t];case"floor":return this.mvfFloorsById[t];case"floor-stack":return this.mvfFloorStacksById[t];case"connection":return this.mvfConnectionsById[t];case"entrance":return this.mvfEntrancesById[t];case"annotation":return this.mvfAnnotationsById[t];case"area":return this.mvfAreasById[t];default:throw new Error("Unknown MVF feature type: ".concat(e))}}getMVFFeatureByNodeId(e,t){switch(e){case"connection":return this.mvfConnectionsByNodeId[t];default:throw new Error("Unsupported MVF feature type: ".concat(e))}}getMVFFeatureByType(e){switch(e){case"floor-stack":return this.mvfFloorStacks;case"floor":return this.mvfFloors;default:throw new Error("Unsupported MVF feature type: ".concat(e))}}getPropTranslation(e,t,n,r){var a,o;if(!this.currentLanguage)return r;let{code:s}=this.currentLanguage,u=(o=(a=this.languagePacks[s])==null?void 0:a.optimized)==null?void 0:o[e];if(u){let h=u[n];if(h!=null&&h[t]!==void 0)return h[t]}return r}findPreferredLanguage(e){if(!this.venue)return;let t=e6(this.venue,e);return e?.languageCode!=null&&e.languageCode.toLowerCase()!==t.code.toLowerCase()&&nt.warn('Language code "'.concat(e.languageCode,'" could not be found in the venue. Using "').concat(t.code,'" instead.')),t}async changeLanguage(e){var t;let n=e.toLowerCase();if(!n){nt.error("Language code must be defined.");return}if(!this.currentLanguage||!this.venue){nt.error("Changing the language is not supported for this map.");return}let r=this.currentLanguage.code,a=(t=this.venue)==null?void 0:t.languages.find(({code:s})=>s.toLowerCase()===n.toLowerCase());if(!a){nt.warn('Language code "'.concat(n,'" could not be found in the venue.'));return}if(r===a.code)return;let o=this.languagePacks[a.code];if(!o){let s=this.localePacksUrls[a.code];if(!s){nt.error('Locale pack URL not found for language code "'.concat(a.code,'".'));return}y(this,Fv)&&y(this,Fv).abort();let u=new AbortController;Ce(this,Fv,u);let h;try{h=await one(s,{signal:u.signal})}catch(d){nt.error('Failed to download language pack for language code "'.concat(a.code,'".'),d);return}if(!h||u.signal.aborted)return;o=ZE(h),this.languagePacks[a.code]=o}this.Analytics.sendChangeLanguageEvent({fromLanguage:this.currentLanguage.code}),this.currentLanguage=a,this.publish("language-change",this.currentLanguage)}getDistance(e,t){let n=Sw(e),r=Sw(t);return ou([n.longitude,n.latitude],[r.longitude,r.latitude])}async toJSONBundle({downloadLanguagePacks:e=!0}={}){var t;let n=[];if(e&&this.enterpriseMode){let r=new AbortController;for(let a of((t=this.venue)==null?void 0:t.languages)||[])try{if(this.localePacksUrls[a.code]){let o=await gI(this.localePacksUrls[a.code],{signal:r.signal}),s=await WA(o);s&&n.push({language:{code:a.code,name:a.name},localePack:s})}}catch(o){nt.warn("failed downloading language pack",o)}}return{type:"json",options:{enterprise:this.enterpriseMode},languagePacks:n,main:this.mvf}}async toBinaryBundle({downloadLanguagePacks:e=!0}={}){var t;if(!this.binaryBundle){nt.error("binary bundle not found");return}let n=[];if(e&&this.enterpriseMode){let r=new AbortController;for(let a of((t=this.venue)==null?void 0:t.languages)||[])try{if(this.localePacksUrls[a.code]){let o=await gI(this.localePacksUrls[a.code],{signal:r.signal});o&&n.push({language:{code:a.code,name:a.name},localePack:o})}}catch(o){nt.warn("failed downloading language pack",o)}}return{type:"binary",options:{enterprise:this.enterpriseMode},languagePacks:n,main:this.binaryBundle}}destroy(){for(let e of globalThis.Object.keys(y(this,Oi)))y(this,Oi)[e]=null}};Oi=new WeakMap,vP=new WeakSet,vue=l(function(i){var e;let t=(e=i?.nodes)==null?void 0:e[0],n=this.getById("node",t);if(n==null)return;let r=qg([n.coordinate.longitude,n.coordinate.latitude]),a=this.connectionSpaceIdsByLatLon[r];return a?.map(o=>this.connectionsById[o]).find(o=>o!=null)},"#getConnectionFromMVFConnection"),Fv=new WeakMap,l(_ue,"MapDataInternal");var s6=_ue,Bv,vm,zv,eh,_P=class k2 extends zA{constructor(e,t){super(t.mvfData.id,e),D(this,"__type",k2.__type),ge(this,Bv),ge(this,vm),ge(this,zv),ge(this,eh,{}),Ce(this,Bv,t.mvfData),Ce(this,vm,e),Ce(this,zv,t.floorStackId)}static is(e){return e.__type===k2.__type}get floorStack(){return y(this,vm).getById("floor-stack",y(this,zv))}get spaces(){if(!y(this,eh).spaces){y(this,eh).spaces=[];for(let e of y(this,Bv).spaces){let t=y(this,vm).getById("space",e.spaceId);t&&y(this,eh).spaces.push(t)}}return y(this,eh).spaces}get center(){if(!y(this,eh).center){let e={type:"FeatureCollection",features:[]};for(let n of this.spaces){let r=y(this,vm).mvfSpacesById[n.id];r&&e.features.push(r)}if(e.features.length===0)throw new So("No geometry found for facade!");let t=sD(e);y(this,eh).center=new Wn({latitude:t.geometry.coordinates[1],longitude:t.geometry.coordinates[0],floorId:y(this,Bv).spaces[0].floorId})}return y(this,eh).center}get focusTarget(){return this.spaces}get anchorTarget(){return this.center}toJSON(){return{id:this.id,__type:k2.__type,floorStackId:y(this,zv),floorStack:this.floorStack,spaces:this.spaces}}};Bv=new WeakMap,vm=new WeakMap,zv=new WeakMap,eh=new WeakMap,l(_P,"Facade"),D(_P,"__type","facade");var iIe=_P,Dg=iIe;R();R();R();R();var xue=class extends Error{constructor(e){super("".concat(e," must be used within a MapView component."))}};l(xue,"MapViewNullError");var Zc=xue,vu=Jt.createContext({mapData:void 0,mapView:void 0});function nIe(){let{mapData:i,mapView:e}=Jt.useContext(vu);if(!i||!e)throw new Zc("useMap");return{mapData:i,mapView:e}}l(nIe,"useMap");R();function Nd(i,e){Jt.useEffect(()=>{e!=null&&typeof i=="function"&&i(e)},[i,e])}l(Nd,"useOnLoad");function bue(i){let{mapView:e}=Jt.useContext(vu),t=Jt.useRef(),[n,r]=Jt.useState(null);return Jt.useEffect(()=>{if(e==null)throw new Zc("Marker");return t.current=e.Markers.add(i.target,"",lt(Me({},i.options),{dynamicResize:!0})),r(t.current),()=>{e==null||t.current==null||e.Markers.remove(t.current)}},[e,i.target]),Jt.useEffect(()=>{n&&e?.updateState(n,Me({},i.options))},[i.options]),Nd(i.onLoad,n),e==null||n==null?null:Vue.createPortal(i.children,n.contentEl,n.id)}l(bue,"Marker");function rIe(i){let{mapView:e}=Jt.useContext(vu),[t,n]=Jt.useState(null),r=Jt.useRef(Hn()),a=Jt.useRef(i.target),o=Jt.useCallback(u=>{var h;n(u),(h=i.onLoad)==null||h.call(i,u)},[i.onLoad]);Jt.useEffect(()=>{if(e==null)throw new Zc("Marker");if(t&&t.target!==i.target){let{duration:u=300,easing:h="linear"}=i;e.Markers.animateTo(t,i.target,{duration:u,easing:h})}},[e,i.target,t]);let s=Jt.useMemo(()=>lt(Me({},i),{duration:void 0,easing:void 0}),[i.duration,i.easing]);return Cy.createElement(bue,lt(Me({},s),{key:r.current,target:a.current,onLoad:o}))}l(rIe,"AnimatedMarker");R();function aIe(i){let{mapView:e}=Jt.useContext(vu),t=Jt.useRef(),[n,r]=Jt.useState(void 0);return Jt.useEffect(()=>{if(e==null)throw new Zc("Label");return t.current=e.Labels.add(i.target,i.text,i.options),r(t.current),()=>{e==null||t.current==null||e.Labels.remove(t.current)}},[e,i.target]),Jt.useEffect(()=>{t.current&&e?.updateState(t.current,Me({text:i.text},i.options))},[i.text,i.options]),Nd(i.onLoad,n),null}l(aIe,"Label");R();function oIe(i,e){let{mapView:t}=Jt.useContext(vu),n=Jt.useCallback(r=>e(r),[e]);Jt.useEffect(()=>{if(t==null)throw new Zc("useEvent");return t.on(i,n),()=>{t?.off(i,n)}},[t,i,e])}l(oIe,"useEvent");R();function sIe(i){let{mapView:e}=Jt.useContext(vu),t=Jt.useRef(),[n,r]=Jt.useState(void 0);return Jt.useEffect(()=>{if(e==null)throw new Zc("Path");let a=e.Paths.add(i.coordinate,i.options);return a.animation.then(()=>{var o;(o=i.onDrawComplete)==null||o.call(i)}),r(a),t.current=a,()=>{t.current&&e.Paths.remove(t.current)}},[e,i.coordinate,i.options]),Nd(i.onLoad,n),null}l(sIe,"Path");R();var lIe={width:"100%",height:"100%",position:"relative"};function uIe(i){let e=i,{mapData:t,options:n,style:r,fallback:a,children:o}=e,s=Sc(e,["mapData","options","style","fallback","children"]),u=Jt.useRef(!1),[h,d]=Jt.useState(void 0),[f,m]=Jt.useState(!0),v=Jt.useRef(null),b=Jt.useMemo(()=>n,[]),w=Jt.useCallback(()=>{if(t&&v!=null&&v.current){if(h)return;i6(v.current,t,b).then(A=>{d(A)}).catch(A=>{nt.error("Failed to render MapView",A)}).finally(()=>{m(!1)})}},[t,v.current,b]);return Jt.useEffect(()=>{u.current||(u.current=!0,w())},[w]),Nd(i.onLoad,h),Cy.createElement(vu.Provider,{value:{mapData:t,mapView:h}},Cy.createElement("div",Me({"data-testid":"mappedin-map",ref:v,style:Me(Me({},lIe),r)},s)),f?Cy.createElement(Cy.Fragment,null,a):o)}l(uIe,"MapView");R();function hIe(i){let{mapView:e}=Jt.useContext(vu),[t,n]=Jt.useState(!1);return Jt.useEffect(()=>{if(e==null)throw new Zc("Navigation");return e.Navigation.draw(i.directions,i.options).then(()=>{var r;n(!0),(r=i.onDrawComplete)==null||r.call(i)}),()=>{e.Navigation.clear()}},[e,i.directions,i.options]),Jt.useEffect(()=>{t!==!1&&typeof i.onLoad=="function"&&i.onLoad()},[i.onLoad,t]),null}l(hIe,"Navigation");R();function cIe(i){let{mapView:e}=Jt.useContext(vu),t=Jt.useRef(),[n,r]=Jt.useState(void 0);return Jt.useEffect(()=>{if(e==null)throw new Error("MapView not initialized");return t.current=e.Shapes.add(i.geometry,i.style,i.floor),r(t.current),()=>{e==null||t.current==null||e.Shapes.remove(t.current)}},[e,i.geometry,i.style,i.floor]),Nd(i.onLoad,n),null}l(cIe,"Shape");R();function pIe(i){let{mapView:e}=Jt.useContext(vu),t=Jt.useRef(),[n,r]=Jt.useState(void 0);return Jt.useEffect(()=>{if(e==null)throw new Zc("Model");return t.current=e.Models.add(i.target,i.url,i.options),r(t.current),()=>{e==null||t.current==null||e.Models.remove(t.current)}},[e,i.url]),Jt.useEffect(()=>{t.current&&e?.updateState(t.current,Me({position:i.target},i.options))},[i.options,i.target]),Nd(i.onLoad,n),null}l(pIe,"Model");R();function dIe(i){let[e,t]=Jt.useState(void 0),[n,r]=Jt.useState(!0),[a,o]=Jt.useState(void 0),s=Jt.useRef(0),u=Jt.useMemo(()=>i,[]),h=Jt.useCallback(()=>{let d=++s.current;r(!0),o(void 0),t6(u).then(f=>{s.current===d&&t(f)}).catch(f=>{s.current===d&&(nt.error("Failed to fetch MapData",f),o(f))}).finally(()=>{s.current===d&&r(!1)})},[u]);return Jt.useEffect(()=>{h()},[h]),{mapData:e,isLoading:n,error:a}}l(dIe,"useMapData");/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fIe=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),mIe=i=>i.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),D8=i=>{const e=mIe(i);return e.charAt(0).toUpperCase()+e.slice(1)},wue=(...i)=>i.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim(),gIe=i=>{for(const e in i)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var yIe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vIe=Jt.forwardRef(({color:i="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:r="",children:a,iconNode:o,...s},u)=>Jt.createElement("svg",{ref:u,...yIe,width:e,height:e,stroke:i,strokeWidth:n?Number(t)*24/Number(e):t,className:wue("lucide",r),...!a&&!gIe(s)&&{"aria-hidden":"true"},...s},[...o.map(([h,d])=>Jt.createElement(h,d)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E7e=(i,e)=>{const t=Jt.forwardRef(({className:n,...r},a)=>Jt.createElement(vIe,{ref:a,iconNode:e,className:wue(`lucide-${fIe(D8(i))}`,`lucide-${i}`,n),...r}));return t.displayName=D8(i),t};function k8(i,e){if(typeof i=="function")return i(e);i!=null&&(i.current=e)}function Aue(...i){return e=>{let t=!1;const n=i.map(r=>{const a=k8(r,e);return!t&&typeof a=="function"&&(t=!0),a});if(t)return()=>{for(let r=0;r<n.length;r++){const a=n[r];typeof a=="function"?a():k8(i[r],null)}}}}function I7e(...i){return Jt.useCallback(Aue(...i),i)}function _Ie(i){const e=xIe(i),t=Jt.forwardRef((n,r)=>{const{children:a,...o}=n,s=Jt.Children.toArray(a),u=s.find(bIe);if(u){const h=u.props.children,d=s.map(f=>f===u?Jt.Children.count(h)>1?Jt.Children.only(null):Jt.isValidElement(h)?h.props.children:null:f);return R2.jsx(e,{...o,ref:r,children:Jt.isValidElement(h)?Jt.cloneElement(h,void 0,d):null})}return R2.jsx(e,{...o,ref:r,children:a})});return t.displayName=`${i}.Slot`,t}var T7e=_Ie("Slot");function xIe(i){const e=Jt.forwardRef((t,n)=>{const{children:r,...a}=t;if(Jt.isValidElement(r)){const o=AIe(r),s=wIe(a,r.props);return r.type!==Jt.Fragment&&(s.ref=n?Aue(n,o):o),Jt.cloneElement(r,s)}return Jt.Children.count(r)>1?Jt.Children.only(null):null});return e.displayName=`${i}.SlotClone`,e}var Sue=Symbol("radix.slottable");function P7e(i){const e=({children:t})=>R2.jsx(R2.Fragment,{children:t});return e.displayName=`${i}.Slottable`,e.__radixId=Sue,e}function bIe(i){return Jt.isValidElement(i)&&typeof i.type=="function"&&"__radixId"in i.type&&i.type.__radixId===Sue}function wIe(i,e){const t={...e};for(const n in e){const r=i[n],a=e[n];/^on[A-Z]/.test(n)?r&&a?t[n]=(...s)=>{const u=a(...s);return r(...s),u}:r&&(t[n]=r):n==="style"?t[n]={...r,...a}:n==="className"&&(t[n]=[r,a].filter(Boolean).join(" "))}return{...i,...t}}function AIe(i){let e=Object.getOwnPropertyDescriptor(i.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?i.ref:(e=Object.getOwnPropertyDescriptor(i,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?i.props.ref:i.props.ref||i.ref)}function Mue(i){var e,t,n="";if(typeof i=="string"||typeof i=="number")n+=i;else if(typeof i=="object")if(Array.isArray(i)){var r=i.length;for(e=0;e<r;e++)i[e]&&(t=Mue(i[e]))&&(n&&(n+=" "),n+=t)}else for(t in i)i[t]&&(n&&(n+=" "),n+=t);return n}function Cue(){for(var i,e,t=0,n="",r=arguments.length;t<r;t++)(i=arguments[t])&&(e=Mue(i))&&(n&&(n+=" "),n+=e);return n}const l6="-",SIe=i=>{const e=CIe(i),{conflictingClassGroups:t,conflictingClassGroupModifiers:n}=i;return{getClassGroupId:o=>{const s=o.split(l6);return s[0]===""&&s.length!==1&&s.shift(),Eue(s,e)||MIe(o)},getConflictingClassGroupIds:(o,s)=>{const u=t[o]||[];return s&&n[o]?[...u,...n[o]]:u}}},Eue=(i,e)=>{if(i.length===0)return e.classGroupId;const t=i[0],n=e.nextPart.get(t),r=n?Eue(i.slice(1),n):void 0;if(r)return r;if(e.validators.length===0)return;const a=i.join(l6);return e.validators.find(({validator:o})=>o(a))?.classGroupId},R8=/^\[(.+)\]$/,MIe=i=>{if(R8.test(i)){const e=R8.exec(i)[1],t=e?.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},CIe=i=>{const{theme:e,classGroups:t}=i,n={nextPart:new Map,validators:[]};for(const r in t)xP(t[r],n,r,e);return n},xP=(i,e,t,n)=>{i.forEach(r=>{if(typeof r=="string"){const a=r===""?e:O8(e,r);a.classGroupId=t;return}if(typeof r=="function"){if(EIe(r)){xP(r(n),e,t,n);return}e.validators.push({validator:r,classGroupId:t});return}Object.entries(r).forEach(([a,o])=>{xP(o,O8(e,a),t,n)})})},O8=(i,e)=>{let t=i;return e.split(l6).forEach(n=>{t.nextPart.has(n)||t.nextPart.set(n,{nextPart:new Map,validators:[]}),t=t.nextPart.get(n)}),t},EIe=i=>i.isThemeGetter,IIe=i=>{if(i<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,n=new Map;const r=(a,o)=>{t.set(a,o),e++,e>i&&(e=0,n=t,t=new Map)};return{get(a){let o=t.get(a);if(o!==void 0)return o;if((o=n.get(a))!==void 0)return r(a,o),o},set(a,o){t.has(a)?t.set(a,o):r(a,o)}}},bP="!",wP=":",TIe=wP.length,PIe=i=>{const{prefix:e,experimentalParseClassName:t}=i;let n=r=>{const a=[];let o=0,s=0,u=0,h;for(let b=0;b<r.length;b++){let w=r[b];if(o===0&&s===0){if(w===wP){a.push(r.slice(u,b)),u=b+TIe;continue}if(w==="/"){h=b;continue}}w==="["?o++:w==="]"?o--:w==="("?s++:w===")"&&s--}const d=a.length===0?r:r.substring(u),f=LIe(d),m=f!==d,v=h&&h>u?h-u:void 0;return{modifiers:a,hasImportantModifier:m,baseClassName:f,maybePostfixModifierPosition:v}};if(e){const r=e+wP,a=n;n=o=>o.startsWith(r)?a(o.substring(r.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:o,maybePostfixModifierPosition:void 0}}if(t){const r=n;n=a=>t({className:a,parseClassName:r})}return n},LIe=i=>i.endsWith(bP)?i.substring(0,i.length-1):i.startsWith(bP)?i.substring(1):i,DIe=i=>{const e=Object.fromEntries(i.orderSensitiveModifiers.map(n=>[n,!0]));return n=>{if(n.length<=1)return n;const r=[];let a=[];return n.forEach(o=>{o[0]==="["||e[o]?(r.push(...a.sort(),o),a=[]):a.push(o)}),r.push(...a.sort()),r}},kIe=i=>({cache:IIe(i.cacheSize),parseClassName:PIe(i),sortModifiers:DIe(i),...SIe(i)}),RIe=/\s+/,OIe=(i,e)=>{const{parseClassName:t,getClassGroupId:n,getConflictingClassGroupIds:r,sortModifiers:a}=e,o=[],s=i.trim().split(RIe);let u="";for(let h=s.length-1;h>=0;h-=1){const d=s[h],{isExternal:f,modifiers:m,hasImportantModifier:v,baseClassName:b,maybePostfixModifierPosition:w}=t(d);if(f){u=d+(u.length>0?" "+u:u);continue}let A=!!w,E=n(A?b.substring(0,w):b);if(!E){if(!A){u=d+(u.length>0?" "+u:u);continue}if(E=n(b),!E){u=d+(u.length>0?" "+u:u);continue}A=!1}const I=a(m).join(":"),C=v?I+bP:I,T=C+E;if(o.includes(T))continue;o.push(T);const k=r(E,A);for(let F=0;F<k.length;++F){const B=k[F];o.push(C+B)}u=d+(u.length>0?" "+u:u)}return u};function NIe(){let i=0,e,t,n="";for(;i<arguments.length;)(e=arguments[i++])&&(t=Iue(e))&&(n&&(n+=" "),n+=t);return n}const Iue=i=>{if(typeof i=="string")return i;let e,t="";for(let n=0;n<i.length;n++)i[n]&&(e=Iue(i[n]))&&(t&&(t+=" "),t+=e);return t};function FIe(i,...e){let t,n,r,a=o;function o(u){const h=e.reduce((d,f)=>f(d),i());return t=kIe(h),n=t.cache.get,r=t.cache.set,a=s,s(u)}function s(u){const h=n(u);if(h)return h;const d=OIe(u,t);return r(u,d),d}return function(){return a(NIe.apply(null,arguments))}}const _a=i=>{const e=t=>t[i]||[];return e.isThemeGetter=!0,e},Tue=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,Pue=/^\((?:(\w[\w-]*):)?(.+)\)$/i,BIe=/^\d+\/\d+$/,zIe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,UIe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,VIe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,jIe=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,GIe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,cf=i=>BIe.test(i),pn=i=>!!i&&!Number.isNaN(Number(i)),$h=i=>!!i&&Number.isInteger(Number(i)),LM=i=>i.endsWith("%")&&pn(i.slice(0,-1)),Nu=i=>zIe.test(i),$Ie=()=>!0,HIe=i=>UIe.test(i)&&!VIe.test(i),Lue=()=>!1,WIe=i=>jIe.test(i),qIe=i=>GIe.test(i),XIe=i=>!gi(i)&&!yi(i),ZIe=i=>Xg(i,Rue,Lue),gi=i=>Tue.test(i),mp=i=>Xg(i,Oue,HIe),DM=i=>Xg(i,eTe,pn),N8=i=>Xg(i,Due,Lue),YIe=i=>Xg(i,kue,qIe),N_=i=>Xg(i,Nue,WIe),yi=i=>Pue.test(i),My=i=>Zg(i,Oue),JIe=i=>Zg(i,tTe),F8=i=>Zg(i,Due),KIe=i=>Zg(i,Rue),QIe=i=>Zg(i,kue),F_=i=>Zg(i,Nue,!0),Xg=(i,e,t)=>{const n=Tue.exec(i);return n?n[1]?e(n[1]):t(n[2]):!1},Zg=(i,e,t=!1)=>{const n=Pue.exec(i);return n?n[1]?e(n[1]):t:!1},Due=i=>i==="position"||i==="percentage",kue=i=>i==="image"||i==="url",Rue=i=>i==="length"||i==="size"||i==="bg-size",Oue=i=>i==="length",eTe=i=>i==="number",tTe=i=>i==="family-name",Nue=i=>i==="shadow",iTe=()=>{const i=_a("color"),e=_a("font"),t=_a("text"),n=_a("font-weight"),r=_a("tracking"),a=_a("leading"),o=_a("breakpoint"),s=_a("container"),u=_a("spacing"),h=_a("radius"),d=_a("shadow"),f=_a("inset-shadow"),m=_a("text-shadow"),v=_a("drop-shadow"),b=_a("blur"),w=_a("perspective"),A=_a("aspect"),E=_a("ease"),I=_a("animate"),C=()=>["auto","avoid","all","avoid-page","page","left","right","column"],T=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],k=()=>[...T(),yi,gi],F=()=>["auto","hidden","clip","visible","scroll"],B=()=>["auto","contain","none"],N=()=>[yi,gi,u],z=()=>[cf,"full","auto",...N()],L=()=>[$h,"none","subgrid",yi,gi],j=()=>["auto",{span:["full",$h,yi,gi]},$h,yi,gi],q=()=>[$h,"auto",yi,gi],Z=()=>["auto","min","max","fr",yi,gi],O=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],Y=()=>["start","end","center","stretch","center-safe","end-safe"],J=()=>["auto",...N()],oe=()=>[cf,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...N()],$=()=>[i,yi,gi],K=()=>[...T(),F8,N8,{position:[yi,gi]}],te=()=>["no-repeat",{repeat:["","x","y","space","round"]}],ve=()=>["auto","cover","contain",KIe,ZIe,{size:[yi,gi]}],Q=()=>[LM,My,mp],he=()=>["","none","full",h,yi,gi],se=()=>["",pn,My,mp],Ae=()=>["solid","dashed","dotted","double"],Ie=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],we=()=>[pn,LM,F8,N8],Ne=()=>["","none",b,yi,gi],je=()=>["none",pn,yi,gi],Ve=()=>["none",pn,yi,gi],Le=()=>[pn,yi,gi],xe=()=>[cf,"full",...N()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Nu],breakpoint:[Nu],color:[$Ie],container:[Nu],"drop-shadow":[Nu],ease:["in","out","in-out"],font:[XIe],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Nu],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Nu],shadow:[Nu],spacing:["px",pn],text:[Nu],"text-shadow":[Nu],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",cf,gi,yi,A]}],container:["container"],columns:[{columns:[pn,gi,yi,s]}],"break-after":[{"break-after":C()}],"break-before":[{"break-before":C()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:k()}],overflow:[{overflow:F()}],"overflow-x":[{"overflow-x":F()}],"overflow-y":[{"overflow-y":F()}],overscroll:[{overscroll:B()}],"overscroll-x":[{"overscroll-x":B()}],"overscroll-y":[{"overscroll-y":B()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:z()}],"inset-x":[{"inset-x":z()}],"inset-y":[{"inset-y":z()}],start:[{start:z()}],end:[{end:z()}],top:[{top:z()}],right:[{right:z()}],bottom:[{bottom:z()}],left:[{left:z()}],visibility:["visible","invisible","collapse"],z:[{z:[$h,"auto",yi,gi]}],basis:[{basis:[cf,"full","auto",s,...N()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[pn,cf,"auto","initial","none",gi]}],grow:[{grow:["",pn,yi,gi]}],shrink:[{shrink:["",pn,yi,gi]}],order:[{order:[$h,"first","last","none",yi,gi]}],"grid-cols":[{"grid-cols":L()}],"col-start-end":[{col:j()}],"col-start":[{"col-start":q()}],"col-end":[{"col-end":q()}],"grid-rows":[{"grid-rows":L()}],"row-start-end":[{row:j()}],"row-start":[{"row-start":q()}],"row-end":[{"row-end":q()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":Z()}],"auto-rows":[{"auto-rows":Z()}],gap:[{gap:N()}],"gap-x":[{"gap-x":N()}],"gap-y":[{"gap-y":N()}],"justify-content":[{justify:[...O(),"normal"]}],"justify-items":[{"justify-items":[...Y(),"normal"]}],"justify-self":[{"justify-self":["auto",...Y()]}],"align-content":[{content:["normal",...O()]}],"align-items":[{items:[...Y(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...Y(),{baseline:["","last"]}]}],"place-content":[{"place-content":O()}],"place-items":[{"place-items":[...Y(),"baseline"]}],"place-self":[{"place-self":["auto",...Y()]}],p:[{p:N()}],px:[{px:N()}],py:[{py:N()}],ps:[{ps:N()}],pe:[{pe:N()}],pt:[{pt:N()}],pr:[{pr:N()}],pb:[{pb:N()}],pl:[{pl:N()}],m:[{m:J()}],mx:[{mx:J()}],my:[{my:J()}],ms:[{ms:J()}],me:[{me:J()}],mt:[{mt:J()}],mr:[{mr:J()}],mb:[{mb:J()}],ml:[{ml:J()}],"space-x":[{"space-x":N()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":N()}],"space-y-reverse":["space-y-reverse"],size:[{size:oe()}],w:[{w:[s,"screen",...oe()]}],"min-w":[{"min-w":[s,"screen","none",...oe()]}],"max-w":[{"max-w":[s,"screen","none","prose",{screen:[o]},...oe()]}],h:[{h:["screen","lh",...oe()]}],"min-h":[{"min-h":["screen","lh","none",...oe()]}],"max-h":[{"max-h":["screen","lh",...oe()]}],"font-size":[{text:["base",t,My,mp]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,yi,DM]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",LM,gi]}],"font-family":[{font:[JIe,gi,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[r,yi,gi]}],"line-clamp":[{"line-clamp":[pn,"none",yi,DM]}],leading:[{leading:[a,...N()]}],"list-image":[{"list-image":["none",yi,gi]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",yi,gi]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:$()}],"text-color":[{text:$()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Ae(),"wavy"]}],"text-decoration-thickness":[{decoration:[pn,"from-font","auto",yi,mp]}],"text-decoration-color":[{decoration:$()}],"underline-offset":[{"underline-offset":[pn,"auto",yi,gi]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:N()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",yi,gi]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",yi,gi]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:K()}],"bg-repeat":[{bg:te()}],"bg-size":[{bg:ve()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},$h,yi,gi],radial:["",yi,gi],conic:[$h,yi,gi]},QIe,YIe]}],"bg-color":[{bg:$()}],"gradient-from-pos":[{from:Q()}],"gradient-via-pos":[{via:Q()}],"gradient-to-pos":[{to:Q()}],"gradient-from":[{from:$()}],"gradient-via":[{via:$()}],"gradient-to":[{to:$()}],rounded:[{rounded:he()}],"rounded-s":[{"rounded-s":he()}],"rounded-e":[{"rounded-e":he()}],"rounded-t":[{"rounded-t":he()}],"rounded-r":[{"rounded-r":he()}],"rounded-b":[{"rounded-b":he()}],"rounded-l":[{"rounded-l":he()}],"rounded-ss":[{"rounded-ss":he()}],"rounded-se":[{"rounded-se":he()}],"rounded-ee":[{"rounded-ee":he()}],"rounded-es":[{"rounded-es":he()}],"rounded-tl":[{"rounded-tl":he()}],"rounded-tr":[{"rounded-tr":he()}],"rounded-br":[{"rounded-br":he()}],"rounded-bl":[{"rounded-bl":he()}],"border-w":[{border:se()}],"border-w-x":[{"border-x":se()}],"border-w-y":[{"border-y":se()}],"border-w-s":[{"border-s":se()}],"border-w-e":[{"border-e":se()}],"border-w-t":[{"border-t":se()}],"border-w-r":[{"border-r":se()}],"border-w-b":[{"border-b":se()}],"border-w-l":[{"border-l":se()}],"divide-x":[{"divide-x":se()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":se()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...Ae(),"hidden","none"]}],"divide-style":[{divide:[...Ae(),"hidden","none"]}],"border-color":[{border:$()}],"border-color-x":[{"border-x":$()}],"border-color-y":[{"border-y":$()}],"border-color-s":[{"border-s":$()}],"border-color-e":[{"border-e":$()}],"border-color-t":[{"border-t":$()}],"border-color-r":[{"border-r":$()}],"border-color-b":[{"border-b":$()}],"border-color-l":[{"border-l":$()}],"divide-color":[{divide:$()}],"outline-style":[{outline:[...Ae(),"none","hidden"]}],"outline-offset":[{"outline-offset":[pn,yi,gi]}],"outline-w":[{outline:["",pn,My,mp]}],"outline-color":[{outline:$()}],shadow:[{shadow:["","none",d,F_,N_]}],"shadow-color":[{shadow:$()}],"inset-shadow":[{"inset-shadow":["none",f,F_,N_]}],"inset-shadow-color":[{"inset-shadow":$()}],"ring-w":[{ring:se()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:$()}],"ring-offset-w":[{"ring-offset":[pn,mp]}],"ring-offset-color":[{"ring-offset":$()}],"inset-ring-w":[{"inset-ring":se()}],"inset-ring-color":[{"inset-ring":$()}],"text-shadow":[{"text-shadow":["none",m,F_,N_]}],"text-shadow-color":[{"text-shadow":$()}],opacity:[{opacity:[pn,yi,gi]}],"mix-blend":[{"mix-blend":[...Ie(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Ie()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[pn]}],"mask-image-linear-from-pos":[{"mask-linear-from":we()}],"mask-image-linear-to-pos":[{"mask-linear-to":we()}],"mask-image-linear-from-color":[{"mask-linear-from":$()}],"mask-image-linear-to-color":[{"mask-linear-to":$()}],"mask-image-t-from-pos":[{"mask-t-from":we()}],"mask-image-t-to-pos":[{"mask-t-to":we()}],"mask-image-t-from-color":[{"mask-t-from":$()}],"mask-image-t-to-color":[{"mask-t-to":$()}],"mask-image-r-from-pos":[{"mask-r-from":we()}],"mask-image-r-to-pos":[{"mask-r-to":we()}],"mask-image-r-from-color":[{"mask-r-from":$()}],"mask-image-r-to-color":[{"mask-r-to":$()}],"mask-image-b-from-pos":[{"mask-b-from":we()}],"mask-image-b-to-pos":[{"mask-b-to":we()}],"mask-image-b-from-color":[{"mask-b-from":$()}],"mask-image-b-to-color":[{"mask-b-to":$()}],"mask-image-l-from-pos":[{"mask-l-from":we()}],"mask-image-l-to-pos":[{"mask-l-to":we()}],"mask-image-l-from-color":[{"mask-l-from":$()}],"mask-image-l-to-color":[{"mask-l-to":$()}],"mask-image-x-from-pos":[{"mask-x-from":we()}],"mask-image-x-to-pos":[{"mask-x-to":we()}],"mask-image-x-from-color":[{"mask-x-from":$()}],"mask-image-x-to-color":[{"mask-x-to":$()}],"mask-image-y-from-pos":[{"mask-y-from":we()}],"mask-image-y-to-pos":[{"mask-y-to":we()}],"mask-image-y-from-color":[{"mask-y-from":$()}],"mask-image-y-to-color":[{"mask-y-to":$()}],"mask-image-radial":[{"mask-radial":[yi,gi]}],"mask-image-radial-from-pos":[{"mask-radial-from":we()}],"mask-image-radial-to-pos":[{"mask-radial-to":we()}],"mask-image-radial-from-color":[{"mask-radial-from":$()}],"mask-image-radial-to-color":[{"mask-radial-to":$()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":T()}],"mask-image-conic-pos":[{"mask-conic":[pn]}],"mask-image-conic-from-pos":[{"mask-conic-from":we()}],"mask-image-conic-to-pos":[{"mask-conic-to":we()}],"mask-image-conic-from-color":[{"mask-conic-from":$()}],"mask-image-conic-to-color":[{"mask-conic-to":$()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:K()}],"mask-repeat":[{mask:te()}],"mask-size":[{mask:ve()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",yi,gi]}],filter:[{filter:["","none",yi,gi]}],blur:[{blur:Ne()}],brightness:[{brightness:[pn,yi,gi]}],contrast:[{contrast:[pn,yi,gi]}],"drop-shadow":[{"drop-shadow":["","none",v,F_,N_]}],"drop-shadow-color":[{"drop-shadow":$()}],grayscale:[{grayscale:["",pn,yi,gi]}],"hue-rotate":[{"hue-rotate":[pn,yi,gi]}],invert:[{invert:["",pn,yi,gi]}],saturate:[{saturate:[pn,yi,gi]}],sepia:[{sepia:["",pn,yi,gi]}],"backdrop-filter":[{"backdrop-filter":["","none",yi,gi]}],"backdrop-blur":[{"backdrop-blur":Ne()}],"backdrop-brightness":[{"backdrop-brightness":[pn,yi,gi]}],"backdrop-contrast":[{"backdrop-contrast":[pn,yi,gi]}],"backdrop-grayscale":[{"backdrop-grayscale":["",pn,yi,gi]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[pn,yi,gi]}],"backdrop-invert":[{"backdrop-invert":["",pn,yi,gi]}],"backdrop-opacity":[{"backdrop-opacity":[pn,yi,gi]}],"backdrop-saturate":[{"backdrop-saturate":[pn,yi,gi]}],"backdrop-sepia":[{"backdrop-sepia":["",pn,yi,gi]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":N()}],"border-spacing-x":[{"border-spacing-x":N()}],"border-spacing-y":[{"border-spacing-y":N()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",yi,gi]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[pn,"initial",yi,gi]}],ease:[{ease:["linear","initial",E,yi,gi]}],delay:[{delay:[pn,yi,gi]}],animate:[{animate:["none",I,yi,gi]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[w,yi,gi]}],"perspective-origin":[{"perspective-origin":k()}],rotate:[{rotate:je()}],"rotate-x":[{"rotate-x":je()}],"rotate-y":[{"rotate-y":je()}],"rotate-z":[{"rotate-z":je()}],scale:[{scale:Ve()}],"scale-x":[{"scale-x":Ve()}],"scale-y":[{"scale-y":Ve()}],"scale-z":[{"scale-z":Ve()}],"scale-3d":["scale-3d"],skew:[{skew:Le()}],"skew-x":[{"skew-x":Le()}],"skew-y":[{"skew-y":Le()}],transform:[{transform:[yi,gi,"","none","gpu","cpu"]}],"transform-origin":[{origin:k()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:xe()}],"translate-x":[{"translate-x":xe()}],"translate-y":[{"translate-y":xe()}],"translate-z":[{"translate-z":xe()}],"translate-none":["translate-none"],accent:[{accent:$()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:$()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",yi,gi]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":N()}],"scroll-mx":[{"scroll-mx":N()}],"scroll-my":[{"scroll-my":N()}],"scroll-ms":[{"scroll-ms":N()}],"scroll-me":[{"scroll-me":N()}],"scroll-mt":[{"scroll-mt":N()}],"scroll-mr":[{"scroll-mr":N()}],"scroll-mb":[{"scroll-mb":N()}],"scroll-ml":[{"scroll-ml":N()}],"scroll-p":[{"scroll-p":N()}],"scroll-px":[{"scroll-px":N()}],"scroll-py":[{"scroll-py":N()}],"scroll-ps":[{"scroll-ps":N()}],"scroll-pe":[{"scroll-pe":N()}],"scroll-pt":[{"scroll-pt":N()}],"scroll-pr":[{"scroll-pr":N()}],"scroll-pb":[{"scroll-pb":N()}],"scroll-pl":[{"scroll-pl":N()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",yi,gi]}],fill:[{fill:["none",...$()]}],"stroke-w":[{stroke:[pn,My,mp,DM]}],stroke:[{stroke:["none",...$()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},nTe=FIe(iTe);function L7e(...i){return nTe(Cue(i))}const B8=i=>typeof i=="boolean"?`${i}`:i===0?"0":i,z8=Cue,D7e=(i,e)=>t=>{var n;if(e?.variants==null)return z8(i,t?.class,t?.className);const{variants:r,defaultVariants:a}=e,o=Object.keys(r).map(h=>{const d=t?.[h],f=a?.[h];if(d===null)return null;const m=B8(d)||B8(f);return r[h][m]}),s=t&&Object.entries(t).reduce((h,d)=>{let[f,m]=d;return m===void 0||(h[f]=m),h},{}),u=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((h,d)=>{let{class:f,className:m,...v}=d;return Object.entries(v).every(b=>{let[w,A]=b;return Array.isArray(A)?A.includes({...a,...s}[w]):{...a,...s}[w]===A})?[...h,f,m]:h},[]);return z8(i,o,u,t?.class,t?.className)};export{BA as $,hTe as A,ln as B,_l as C,dIe as D,Ee as E,Me as F,lt as G,bue as H,vIe as I,Sc as J,qie as K,Et as L,xh as M,ii as N,D as O,uIe as P,ge as Q,Ce as R,T7e as S,sTe as T,lTe as U,uTe as V,qi as W,ft as X,Hv as Y,Bn as Z,vE as _,L7e as a,RN as a$,f5e as a0,Ho as a1,ok as a2,Zo as a3,Yl as a4,fn as a5,jn as a6,Go as a7,Cd as a8,_h as a9,p5e as aA,YPe as aB,IPe as aC,pd as aD,n5e as aE,o5e as aF,FN as aG,U2 as aH,vr as aI,qP as aJ,g5e as aK,VTe as aL,xce as aM,Hc as aN,VP as aO,K9 as aP,Sa as aQ,$Te as aR,nme as aS,Dhe as aT,O6 as aU,Gw as aV,VO as aW,rPe as aX,sPe as aY,q0 as aZ,Ao as a_,Lce as aa,Pce as ab,Rhe as ac,ace as ad,an as ae,mr as af,lu as ag,gr as ah,CP as ai,uPe as aj,I7 as ak,bc as al,Gr as am,F2 as an,zP as ao,io as ap,ms as aq,The as ar,L0 as as,lS as at,Yp as au,Zp as av,fl as aw,$M as ax,yC as ay,X1 as az,Cue as b,u2e as b$,qTe as b0,HPe as b1,pce as b2,Ww as b3,jTe as b4,q2 as b5,W2 as b6,kn as b7,su as b8,Hw as b9,kke as bA,Hke as bB,g1e as bC,xZ as bD,zke as bE,Pbe as bF,mR as bG,Gke as bH,Sbe as bI,wbe as bJ,xbe as bK,Nbe as bL,d1e as bM,v1e as bN,yme as bO,EDe as bP,p1e as bQ,_s as bR,f2e as bS,h2e as bT,c2e as bU,p2e as bV,g2e as bW,y2e as bX,c1e as bY,vme as bZ,m2e as b_,Wke as ba,r5 as bb,jbe as bc,ube as bd,_1e as be,Fbe as bf,Lbe as bg,Rbe as bh,Obe as bi,Zxe as bj,uo as bk,Vke as bl,y1e as bm,Fke as bn,Jxe as bo,h1 as bp,Cbe as bq,on as br,Uc as bs,Gbe as bt,Lke as bu,Os as bv,x_ as bw,abe as bx,xR as by,$a as bz,E7e as c,d2e as c0,yQ as c1,C3e as c2,ru as c3,Wn as c4,xr as c5,_Ie as d,D7e as e,P7e as f,l as g,R as h,oIe as i,y as j,oTe as k,St as l,GB as m,$e as n,vQ as o,Cie as p,nIe as q,Dg as r,A1 as s,ur as t,I7e as u,Nm as v,ao as w,hs as x,Mi as y,Kee as z};
