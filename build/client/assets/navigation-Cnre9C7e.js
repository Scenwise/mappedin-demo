import{a as d,p as e,w as S}from"./chunk-UIGDSWPH-CIt85NzU.js";import{S as k,a as N,b as C,c as T,g as w,h as M,d as _}from"./select-fG8JjqQH.js";import{c as v,m as j}from"./index-LQx0N5oG.js";import{B as b}from"./button-BQnWc8Z8.js";import{T as E,l as L,d as B}from"./tooltip-BM-lnvOs.js";import{P as F}from"./PageHeader-DmSe1-NI.js";import{A as P}from"./AppContext-Bo8Z6ja1.js";import"./index-BP1L8zXC.js";import"./Combination-BorzZcYL.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M12 2v3",key:"qbqxhf"}],["path",{d:"M18.89 13.24a7 7 0 0 0-8.13-8.13",key:"1v9jrh"}],["path",{d:"M19 12h3",key:"osuazr"}],["path",{d:"M2 12h3",key:"1wrr53"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M7.05 7.05a7 7 0 0 0 9.9 9.9",key:"rc5l2e"}]],D=v("locate-off",z);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}]],V=v("locate",I),{useEvent:q,useMap:A}=j;function g({location:c,onLocationSelect:r}){const{mapData:o}=A(),i=o.getByType("floor").sort((t,a)=>t.elevation-a.elevation),l=o.getByType("space").filter(({name:t})=>t.length),n=i.map(t=>({floor:t,spaces:l.filter(a=>a.floor.id===t.id).sort((a,s)=>a.name.localeCompare(s.name))})),[m,p]=d.useState(c?.__type==="space"?c.id:" "),[h,f]=d.useState(c?.__type==="coordinate"?c:void 0);function u(t){p(t),f(void 0);const a=l.find(({id:s})=>s===t);a&&r(a)}const[x,y]=d.useState(!1);return q("click",({spaces:t,coordinate:a})=>{x&&(t.length?u(t[0].id):(p(" "),f(a),r(a)),y(!1))}),e.jsxs("div",{className:"flex items-center gap-2 w-full *:min-w-0",children:[e.jsxs(k,{value:m,onValueChange:u,children:[e.jsx(N,{className:"grow",children:e.jsx(C,{placeholder:"Select a space",className:"truncate",children:h?h.latitude+" "+h.longitude:l.find(({id:t})=>t===m)?.name})}),e.jsx(T,{children:n.map(({floor:t,spaces:a})=>e.jsxs(w,{children:[e.jsx(M,{children:t.name}),a.map(s=>e.jsx(_,{value:s.id,children:s.name},s.id))]},t.id))})]}),e.jsxs(E,{children:[e.jsx(L,{asChild:!0,children:e.jsx(b,{size:"icon",variant:"ghost",className:"size-8 shrink-0",onClick:()=>y(!x),children:x?e.jsx(D,{}):e.jsx(V,{})})}),e.jsx(B,{side:"right",children:"Select on map"})]})]})}const{useMap:$}=j,X=S(function(){const{mapData:r,mapView:o}=$(),{navigationFrom:i,setNavigationFrom:l,navigationTo:n,setNavigationTo:m}=d.useContext(P);return d.useEffect(()=>{if(i&&n){const p=r.getDirections(i,n);if(!p)return;o.Navigation.clear(),o.Navigation.draw(p)}},[i,n,r,o.Navigation]),e.jsxs(e.Fragment,{children:[e.jsx(F,{title:"Navigation"}),e.jsxs("div",{className:"space-y-2 py-2",children:[e.jsx(g,{location:i,onLocationSelect:l}),e.jsx(g,{location:n,onLocationSelect:m})]})]})});export{X as default};
