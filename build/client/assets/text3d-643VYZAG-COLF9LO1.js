import{aL as bn,aV as Hn,B as Xn,aW as qn,p as qr,aX as Yn,as as _t,ap as Zn,C as hr,r as xn,a9 as Cr,aY as we,aZ as $n,z as Sn,a_ as Kn,aM as Qn,af as Jn,ak as ea,Z as Kt,a$ as ra,b0 as Qt,D as ta,b1 as Ct,b2 as kn,b3 as na,b4 as aa,b5 as ia,b6 as oa,b7 as sa,$ as rr,F as la,E as ua,b8 as Jt}from"./index-CTgVHcLT.js";import"./chunk-UIGDSWPH-74DChMva.js";import"./index-Boai_r5o.js";rr();rr();rr();function fa(){var l=Object.create(null);function t(r,e){var a=r.id,o=r.name,n=r.dependencies;n===void 0&&(n=[]);var i=r.init;i===void 0&&(i=function(){});var s=r.getTransferables;if(s===void 0&&(s=null),!l[a])try{n=n.map(function(f){return f&&f.isWorkerModule&&(t(f,function(d){if(d instanceof Error)throw d}),f=l[f.id].value),f}),i=c("<"+o+">.init",i),s&&(s=c("<"+o+">.getTransferables",s));var u=null;typeof i=="function"?u=i.apply(void 0,n):console.error("worker module init function failed to rehydrate"),l[a]={id:a,value:u,getTransferables:s},e(u)}catch(f){f&&f.noLog||console.error(f),e(f)}}function h(r,e){var a,o=r.id,n=r.args;(!l[o]||typeof l[o].value!="function")&&e(new Error("Worker module "+o+": not found or its 'init' did not return a function"));try{var i=(a=l[o]).value.apply(a,n);i&&typeof i.then=="function"?i.then(s,function(u){return e(u instanceof Error?u:new Error(""+u))}):s(i)}catch(u){e(u)}function s(u){try{var f=l[o].getTransferables&&l[o].getTransferables(u);(!f||!Array.isArray(f)||!f.length)&&(f=void 0),e(u,f)}catch(d){console.error(d),e(d)}}}function c(r,e){var a=void 0;self.troikaDefine=function(n){return a=n};var o=URL.createObjectURL(new Blob(["/** "+r.replace(/\*/g,"")+` **/

troikaDefine(
`+e+`
)`],{type:"application/javascript"}));try{importScripts(o)}catch(n){console.error(n)}return URL.revokeObjectURL(o),delete self.troikaDefine,a}self.addEventListener("message",function(r){var e=r.data,a=e.messageId,o=e.action,n=e.data;try{o==="registerModule"&&t(n,function(i){i instanceof Error?postMessage({messageId:a,success:!1,error:i.message}):postMessage({messageId:a,success:!0,result:{isCallable:typeof i=="function"}})}),o==="callModule"&&h(n,function(i,s){i instanceof Error?postMessage({messageId:a,success:!1,error:i.message}):postMessage({messageId:a,success:!0,result:i},s||void 0)})}catch(i){postMessage({messageId:a,success:!1,error:i.stack})}})}function ha(l){var t=function(){for(var h=[],c=arguments.length;c--;)h[c]=arguments[c];return t._getInitResult().then(function(r){if(typeof r=="function")return r.apply(void 0,h);throw new Error("Worker module function was called but `init` did not return a callable function")})};return t._getInitResult=function(){var h=l.dependencies,c=l.init;h=Array.isArray(h)?h.map(function(e){return e&&(e=e.onMainThread||e,e._getInitResult&&(e=e._getInitResult())),e}):[];var r=Promise.all(h).then(function(e){return c.apply(null,e)});return t._getInitResult=function(){return r},r},t}var Un=function(){var l=!1;if(typeof window<"u"&&typeof window.document<"u")try{var t=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));t.terminate(),l=!0}catch(h){typeof Jt<"u"&&Jt.env.NODE_ENV==="test"||console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+h.message+"]")}return Un=function(){return l},l},da=0,ca=0,gt=!1,Tr=Object.create(null),wr=Object.create(null),kt=Object.create(null);function dr(l){if((!l||typeof l.init!="function")&&!gt)throw new Error("requires `options.init` function");var t=l.dependencies,h=l.init,c=l.getTransferables,r=l.workerId,e=ha(l);r==null&&(r="#default");var a="workerModule"+ ++da,o=l.name||a,n=null;t=t&&t.map(function(s){return typeof s=="function"&&!s.workerModuleData&&(gt=!0,s=dr({workerId:r,name:"<"+o+"> function dependency: "+s.name,init:`function(){return (
`+jr(s)+`
)}`}),gt=!1),s&&s.workerModuleData&&(s=s.workerModuleData),s});function i(){for(var s=[],u=arguments.length;u--;)s[u]=arguments[u];if(!Un())return e.apply(void 0,s);if(!n){n=en(r,"registerModule",i.workerModuleData);var f=function(){n=null,wr[r].delete(f)};(wr[r]||(wr[r]=new Set)).add(f)}return n.then(function(d){var g=d.isCallable;if(g)return en(r,"callModule",{id:a,args:s});throw new Error("Worker module function was called but `init` did not return a callable function")})}return i.workerModuleData={isWorkerModule:!0,id:a,name:o,dependencies:t,init:jr(h),getTransferables:c&&jr(c)},i.onMainThread=e,i}function va(l){wr[l]&&wr[l].forEach(function(t){t()}),Tr[l]&&(Tr[l].terminate(),delete Tr[l])}function jr(l){var t=l.toString();return!/^function/.test(t)&&/^\w+\s*\(/.test(t)&&(t="function "+t),t}function pa(l){var t=Tr[l];if(!t){var h=jr(fa);t=Tr[l]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+l.replace(/\*/g,"")+` **/

;(`+h+")()"],{type:"application/javascript"}))),t.onmessage=function(c){var r=c.data,e=r.messageId,a=kt[e];if(!a)throw new Error("WorkerModule response with empty or unknown messageId");delete kt[e],a(r)}}return t}function en(l,t,h){return new Promise(function(c,r){var e=++ca;kt[e]=function(a){a.success?c(a.result):r(new Error("Error in worker "+t+" call: "+a.error))},pa(l).postMessage({messageId:e,action:t,data:h})})}rr();function Tn(){var l=(function(t){function h(P,B,v,S,C,D,T,z){var R=1-T;z.x=R*R*P+2*R*T*v+T*T*C,z.y=R*R*B+2*R*T*S+T*T*D}function c(P,B,v,S,C,D,T,z,R,L){var q=1-R;L.x=q*q*q*P+3*q*q*R*v+3*q*R*R*C+R*R*R*T,L.y=q*q*q*B+3*q*q*R*S+3*q*R*R*D+R*R*R*z}function r(P,B){for(var v=/([MLQCZ])([^MLQCZ]*)/g,S,C,D,T,z;S=v.exec(P);){var R=S[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(L){return parseFloat(L)});switch(S[1]){case"M":T=C=R[0],z=D=R[1];break;case"L":(R[0]!==T||R[1]!==z)&&B("L",T,z,T=R[0],z=R[1]);break;case"Q":{B("Q",T,z,T=R[2],z=R[3],R[0],R[1]);break}case"C":{B("C",T,z,T=R[4],z=R[5],R[0],R[1],R[2],R[3]);break}case"Z":(T!==C||z!==D)&&B("L",T,z,C,D);break}}}function e(P,B,v){v===void 0&&(v=16);var S={x:0,y:0};r(P,function(C,D,T,z,R,L,q,$,H){switch(C){case"L":B(D,T,z,R);break;case"Q":{for(var N=D,fe=T,he=1;he<v;he++)h(D,T,L,q,z,R,he/(v-1),S),B(N,fe,S.x,S.y),N=S.x,fe=S.y;break}case"C":{for(var te=D,J=T,le=1;le<v;le++)c(D,T,L,q,$,H,z,R,le/(v-1),S),B(te,J,S.x,S.y),te=S.x,J=S.y;break}}})}var a="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",o="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",n=new WeakMap,i={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function s(P,B){var v=P.getContext?P.getContext("webgl",i):P,S=n.get(v);if(!S){let q=function(te){var J=D[te];if(!J&&(J=D[te]=v.getExtension(te),!J))throw new Error(te+" not supported");return J},$=function(te,J){var le=v.createShader(J);return v.shaderSource(le,te),v.compileShader(le),le},H=function(te,J,le,V){if(!T[te]){var ie={},Y={},G=v.createProgram();v.attachShader(G,$(J,v.VERTEX_SHADER)),v.attachShader(G,$(le,v.FRAGMENT_SHADER)),v.linkProgram(G),T[te]={program:G,transaction:function(pe){v.useProgram(G),pe({setUniform:function(Z,ee){for(var Q=[],re=arguments.length-2;re-- >0;)Q[re]=arguments[re+2];var ge=Y[ee]||(Y[ee]=v.getUniformLocation(G,ee));v["uniform"+Z].apply(v,[ge].concat(Q))},setAttribute:function(Z,ee,Q,re,ge){var K=ie[Z];K||(K=ie[Z]={buf:v.createBuffer(),loc:v.getAttribLocation(G,Z),data:null}),v.bindBuffer(v.ARRAY_BUFFER,K.buf),v.vertexAttribPointer(K.loc,ee,v.FLOAT,!1,0,0),v.enableVertexAttribArray(K.loc),C?v.vertexAttribDivisor(K.loc,re):q("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(K.loc,re),ge!==K.data&&(v.bufferData(v.ARRAY_BUFFER,ge,Q),K.data=ge)}})}}}T[te].transaction(V)},N=function(te,J){R++;try{v.activeTexture(v.TEXTURE0+R);var le=z[te];le||(le=z[te]=v.createTexture(),v.bindTexture(v.TEXTURE_2D,le),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,v.NEAREST),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,v.NEAREST)),v.bindTexture(v.TEXTURE_2D,le),J(le,R)}finally{R--}},fe=function(te,J,le){var V=v.createFramebuffer();L.push(V),v.bindFramebuffer(v.FRAMEBUFFER,V),v.activeTexture(v.TEXTURE0+J),v.bindTexture(v.TEXTURE_2D,te),v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,v.TEXTURE_2D,te,0);try{le(V)}finally{v.deleteFramebuffer(V),v.bindFramebuffer(v.FRAMEBUFFER,L[--L.length-1]||null)}},he=function(){D={},T={},z={},R=-1,L.length=0};var C=typeof WebGL2RenderingContext<"u"&&v instanceof WebGL2RenderingContext,D={},T={},z={},R=-1,L=[];v.canvas.addEventListener("webglcontextlost",function(te){he(),te.preventDefault()},!1),n.set(v,S={gl:v,isWebGL2:C,getExtension:q,withProgram:H,withTexture:N,withTextureFramebuffer:fe,handleContextLoss:he})}B(S)}function u(P,B,v,S,C,D,T,z){T===void 0&&(T=15),z===void 0&&(z=null),s(P,function(R){var L=R.gl,q=R.withProgram,$=R.withTexture;$("copy",function(H,N){L.texImage2D(L.TEXTURE_2D,0,L.RGBA,C,D,0,L.RGBA,L.UNSIGNED_BYTE,B),q("copy",a,o,function(fe){var he=fe.setUniform,te=fe.setAttribute;te("aUV",2,L.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),he("1i","image",N),L.bindFramebuffer(L.FRAMEBUFFER,z||null),L.disable(L.BLEND),L.colorMask(T&8,T&4,T&2,T&1),L.viewport(v,S,C,D),L.scissor(v,S,C,D),L.drawArrays(L.TRIANGLES,0,3)})})})}function f(P,B,v){var S=P.width,C=P.height;s(P,function(D){var T=D.gl,z=new Uint8Array(S*C*4);T.readPixels(0,0,S,C,T.RGBA,T.UNSIGNED_BYTE,z),P.width=B,P.height=v,u(T,z,0,0,S,C)})}var d=Object.freeze({__proto__:null,withWebGLContext:s,renderImageData:u,resizeWebGLCanvasWithoutClearing:f});function g(P,B,v,S,C,D){D===void 0&&(D=1);var T=new Uint8Array(P*B),z=S[2]-S[0],R=S[3]-S[1],L=[];e(v,function(te,J,le,V){L.push({x1:te,y1:J,x2:le,y2:V,minX:Math.min(te,le),minY:Math.min(J,V),maxX:Math.max(te,le),maxY:Math.max(J,V)})}),L.sort(function(te,J){return te.maxX-J.maxX});for(var q=0;q<P;q++)for(var $=0;$<B;$++){var H=fe(S[0]+z*(q+.5)/P,S[1]+R*($+.5)/B),N=Math.pow(1-Math.abs(H)/C,D)/2;H<0&&(N=1-N),N=Math.max(0,Math.min(255,Math.round(N*255))),T[$*P+q]=N}return T;function fe(te,J){for(var le=1/0,V=1/0,ie=L.length;ie--;){var Y=L[ie];if(Y.maxX+V<=te)break;if(te+V>Y.minX&&J-V<Y.maxY&&J+V>Y.minY){var G=U(te,J,Y.x1,Y.y1,Y.x2,Y.y2);G<le&&(le=G,V=Math.sqrt(le))}}return he(te,J)&&(V=-V),V}function he(te,J){for(var le=0,V=L.length;V--;){var ie=L[V];if(ie.maxX<=te)break;var Y=ie.y1>J!=ie.y2>J&&te<(ie.x2-ie.x1)*(J-ie.y1)/(ie.y2-ie.y1)+ie.x1;Y&&(le+=ie.y1<ie.y2?1:-1)}return le!==0}}function m(P,B,v,S,C,D,T,z,R,L){D===void 0&&(D=1),z===void 0&&(z=0),R===void 0&&(R=0),L===void 0&&(L=0),p(P,B,v,S,C,D,T,null,z,R,L)}function p(P,B,v,S,C,D,T,z,R,L,q){D===void 0&&(D=1),R===void 0&&(R=0),L===void 0&&(L=0),q===void 0&&(q=0);for(var $=g(P,B,v,S,C,D),H=new Uint8Array($.length*4),N=0;N<$.length;N++)H[N*4+q]=$[N];u(T,H,R,L,P,B,1<<3-q,z)}function U(P,B,v,S,C,D){var T=C-v,z=D-S,R=T*T+z*z,L=R?Math.max(0,Math.min(1,((P-v)*T+(B-S)*z)/R)):0,q=P-(v+L*T),$=B-(S+L*z);return q*q+$*$}var F=Object.freeze({__proto__:null,generate:g,generateIntoCanvas:m,generateIntoFramebuffer:p}),w="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",y="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",k="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",I=new Float32Array([0,0,2,0,0,2]),x=null,_=!1,O={},M=new WeakMap;function X(P){if(!_&&!j(P))throw new Error("WebGL generation not supported")}function b(P,B,v,S,C,D,T){if(D===void 0&&(D=1),T===void 0&&(T=null),!T&&(T=x,!T)){var z=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!z)throw new Error("OffscreenCanvas or DOM canvas not supported");T=x=z.getContext("webgl",{depth:!1})}X(T);var R=new Uint8Array(P*B*4);s(T,function(H){var N=H.gl,fe=H.withTexture,he=H.withTextureFramebuffer;fe("readable",function(te,J){N.texImage2D(N.TEXTURE_2D,0,N.RGBA,P,B,0,N.RGBA,N.UNSIGNED_BYTE,null),he(te,J,function(le){A(P,B,v,S,C,D,N,le,0,0,0),N.readPixels(0,0,P,B,N.RGBA,N.UNSIGNED_BYTE,R)})})});for(var L=new Uint8Array(P*B),q=0,$=0;q<R.length;q+=4)L[$++]=R[q];return L}function E(P,B,v,S,C,D,T,z,R,L){D===void 0&&(D=1),z===void 0&&(z=0),R===void 0&&(R=0),L===void 0&&(L=0),A(P,B,v,S,C,D,T,null,z,R,L)}function A(P,B,v,S,C,D,T,z,R,L,q){D===void 0&&(D=1),R===void 0&&(R=0),L===void 0&&(L=0),q===void 0&&(q=0),X(T);var $=[];e(v,function(H,N,fe,he){$.push(H,N,fe,he)}),$=new Float32Array($),s(T,function(H){var N=H.gl,fe=H.isWebGL2,he=H.getExtension,te=H.withProgram,J=H.withTexture,le=H.withTextureFramebuffer,V=H.handleContextLoss;if(J("rawDistances",function(ie,Y){(P!==ie._lastWidth||B!==ie._lastHeight)&&N.texImage2D(N.TEXTURE_2D,0,N.RGBA,ie._lastWidth=P,ie._lastHeight=B,0,N.RGBA,N.UNSIGNED_BYTE,null),te("main",w,y,function(G){var pe=G.setAttribute,Z=G.setUniform,ee=!fe&&he("ANGLE_instanced_arrays"),Q=!fe&&he("EXT_blend_minmax");pe("aUV",2,N.STATIC_DRAW,0,I),pe("aLineSegment",4,N.DYNAMIC_DRAW,1,$),Z.apply(void 0,["4f","uGlyphBounds"].concat(S)),Z("1f","uMaxDistance",C),Z("1f","uExponent",D),le(ie,Y,function(re){N.enable(N.BLEND),N.colorMask(!0,!0,!0,!0),N.viewport(0,0,P,B),N.scissor(0,0,P,B),N.blendFunc(N.ONE,N.ONE),N.blendEquationSeparate(N.FUNC_ADD,fe?N.MAX:Q.MAX_EXT),N.clear(N.COLOR_BUFFER_BIT),fe?N.drawArraysInstanced(N.TRIANGLES,0,3,$.length/4):ee.drawArraysInstancedANGLE(N.TRIANGLES,0,3,$.length/4)})}),te("post",a,k,function(G){G.setAttribute("aUV",2,N.STATIC_DRAW,0,I),G.setUniform("1i","tex",Y),N.bindFramebuffer(N.FRAMEBUFFER,z),N.disable(N.BLEND),N.colorMask(q===0,q===1,q===2,q===3),N.viewport(R,L,P,B),N.scissor(R,L,P,B),N.drawArrays(N.TRIANGLES,0,3)})}),N.isContextLost())throw V(),new Error("webgl context lost")})}function j(P){var B=!P||P===x?O:P.canvas||P,v=M.get(B);if(v===void 0){_=!0;var S=null;try{var C=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],D=b(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,P);v=D&&C.length===D.length&&D.every(function(T,z){return T===C[z]}),v||(S="bad trial run results",console.info(C,D))}catch(T){v=!1,S=T.message}S&&console.warn("WebGL SDF generation not supported:",S),_=!1,M.set(B,v)}return v}var W=Object.freeze({__proto__:null,generate:b,generateIntoCanvas:E,generateIntoFramebuffer:A,isSupported:j});function ne(P,B,v,S,C,D){C===void 0&&(C=Math.max(S[2]-S[0],S[3]-S[1])/2),D===void 0&&(D=1);try{return b.apply(W,arguments)}catch(T){return console.info("WebGL SDF generation failed, falling back to JS",T),g.apply(F,arguments)}}function se(P,B,v,S,C,D,T,z,R,L){C===void 0&&(C=Math.max(S[2]-S[0],S[3]-S[1])/2),D===void 0&&(D=1),z===void 0&&(z=0),R===void 0&&(R=0),L===void 0&&(L=0);try{return E.apply(W,arguments)}catch(q){return console.info("WebGL SDF generation failed, falling back to JS",q),m.apply(F,arguments)}}return t.forEachPathCommand=r,t.generate=ne,t.generateIntoCanvas=se,t.javascript=F,t.pathToLineSegments=e,t.webgl=W,t.webglUtils=d,Object.defineProperty(t,"__esModule",{value:!0}),t})({});return l}rr();function ga(){var l=(function(t){var h={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},c={},r={};c.L=1,r[1]="L",Object.keys(h).forEach(function(V,ie){c[V]=1<<ie+1,r[c[V]]=V}),Object.freeze(c);var e=c.LRI|c.RLI|c.FSI,a=c.L|c.R|c.AL,o=c.B|c.S|c.WS|c.ON|c.FSI|c.LRI|c.RLI|c.PDI,n=c.BN|c.RLE|c.LRE|c.RLO|c.LRO|c.PDF,i=c.S|c.WS|c.B|e|c.PDI|n,s=null;function u(){if(!s){s=new Map;var V=function(Y){if(h.hasOwnProperty(Y)){var G=0;h[Y].split(",").forEach(function(pe){var Z=pe.split("+"),ee=Z[0],Q=Z[1];ee=parseInt(ee,36),Q=Q?parseInt(Q,36):0,s.set(G+=ee,c[Y]);for(var re=0;re<Q;re++)s.set(++G,c[Y])})}};for(var ie in h)V(ie)}}function f(V){return u(),s.get(V.codePointAt(0))||c.L}function d(V){return r[f(V)]}var g={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function m(V,ie){var Y=36,G=0,pe=new Map,Z=ie&&new Map,ee;return V.split(",").forEach(function Q(re){if(re.indexOf("+")!==-1)for(var ge=+re;ge--;)Q(ee);else{ee=re;var K=re.split(">"),de=K[0],ke=K[1];de=String.fromCodePoint(G+=parseInt(de,Y)),ke=String.fromCodePoint(G+=parseInt(ke,Y)),pe.set(de,ke),ie&&Z.set(ke,de)}}),{map:pe,reverseMap:Z}}var p,U,F;function w(){if(!p){var V=m(g.pairs,!0),ie=V.map,Y=V.reverseMap;p=ie,U=Y,F=m(g.canonical,!1).map}}function y(V){return w(),p.get(V)||null}function k(V){return w(),U.get(V)||null}function I(V){return w(),F.get(V)||null}var x=c.L,_=c.R,O=c.EN,M=c.ES,X=c.ET,b=c.AN,E=c.CS,A=c.B,j=c.S,W=c.ON,ne=c.BN,se=c.NSM,P=c.AL,B=c.LRO,v=c.RLO,S=c.LRE,C=c.RLE,D=c.PDF,T=c.LRI,z=c.RLI,R=c.FSI,L=c.PDI;function q(V,ie){for(var Y=125,G=new Uint32Array(V.length),pe=0;pe<V.length;pe++)G[pe]=f(V[pe]);var Z=new Map;function ee(Be,ze){var Oe=G[Be];G[Be]=ze,Z.set(Oe,Z.get(Oe)-1),Oe&o&&Z.set(o,Z.get(o)-1),Z.set(ze,(Z.get(ze)||0)+1),ze&o&&Z.set(o,(Z.get(o)||0)+1)}for(var Q=new Uint8Array(V.length),re=new Map,ge=[],K=null,de=0;de<V.length;de++)K||ge.push(K={start:de,end:V.length-1,level:ie==="rtl"?1:ie==="ltr"?0:Zt(de,!1)}),G[de]&A&&(K.end=de,K=null);for(var ke=C|S|v|B|e|L|D|A,Te=function(Be){return Be+(Be&1?1:2)},ye=function(Be){return Be+(Be&1?2:1)},De=0;De<ge.length;De++){K=ge[De];var oe=[{_level:K.level,_override:0,_isolate:0}],me=void 0,_e=0,Ue=0,Re=0;Z.clear();for(var ue=K.start;ue<=K.end;ue++){var ce=G[ue];if(me=oe[oe.length-1],Z.set(ce,(Z.get(ce)||0)+1),ce&o&&Z.set(o,(Z.get(o)||0)+1),ce&ke)if(ce&(C|S)){Q[ue]=me._level;var Xe=(ce===C?ye:Te)(me._level);Xe<=Y&&!_e&&!Ue?oe.push({_level:Xe,_override:0,_isolate:0}):_e||Ue++}else if(ce&(v|B)){Q[ue]=me._level;var xe=(ce===v?ye:Te)(me._level);xe<=Y&&!_e&&!Ue?oe.push({_level:xe,_override:ce&v?_:x,_isolate:0}):_e||Ue++}else if(ce&e){ce&R&&(ce=Zt(ue+1,!0)===1?z:T),Q[ue]=me._level,me._override&&ee(ue,me._override);var be=(ce===z?ye:Te)(me._level);be<=Y&&_e===0&&Ue===0?(Re++,oe.push({_level:be,_override:0,_isolate:1,_isolInitIndex:ue})):_e++}else if(ce&L){if(_e>0)_e--;else if(Re>0){for(Ue=0;!oe[oe.length-1]._isolate;)oe.pop();var Ae=oe[oe.length-1]._isolInitIndex;Ae!=null&&(re.set(Ae,ue),re.set(ue,Ae)),oe.pop(),Re--}me=oe[oe.length-1],Q[ue]=me._level,me._override&&ee(ue,me._override)}else ce&D?(_e===0&&(Ue>0?Ue--:!me._isolate&&oe.length>1&&(oe.pop(),me=oe[oe.length-1])),Q[ue]=me._level):ce&A&&(Q[ue]=K.level);else Q[ue]=me._level,me._override&&ce!==ne&&ee(ue,me._override)}for(var Ce=[],ve=null,Se=K.start;Se<=K.end;Se++){var Ee=G[Se];if(!(Ee&n)){var Ie=Q[Se],Fe=Ee&e,Ne=Ee===L;ve&&Ie===ve._level?(ve._end=Se,ve._endsWithIsolInit=Fe):Ce.push(ve={_start:Se,_end:Se,_level:Ie,_startsWithPDI:Ne,_endsWithIsolInit:Fe})}}for(var Ke=[],je=0;je<Ce.length;je++){var He=Ce[je];if(!He._startsWithPDI||He._startsWithPDI&&!re.has(He._start)){for(var qe=[ve=He],Qe=void 0;ve&&ve._endsWithIsolInit&&(Qe=re.get(ve._end))!=null;)for(var Pe=je+1;Pe<Ce.length;Pe++)if(Ce[Pe]._start===Qe){qe.push(ve=Ce[Pe]);break}for(var We=[],Zr=0;Zr<qe.length;Zr++)for(var Dt=qe[Zr],$r=Dt._start;$r<=Dt._end;$r++)We.push($r);for(var Ln=Q[We[0]],At=K.level,Dr=We[0]-1;Dr>=0;Dr--)if(!(G[Dr]&n)){At=Q[Dr];break}var Kr=We[We.length-1],zn=Q[Kr],Mt=K.level;if(!(G[Kr]&e)){for(var Ar=Kr+1;Ar<=K.end;Ar++)if(!(G[Ar]&n)){Mt=Q[Ar];break}}Ke.push({_seqIndices:We,_sosType:Math.max(At,Ln)%2?_:x,_eosType:Math.max(Mt,zn)%2?_:x})}}for(var Qr=0;Qr<Ke.length;Qr++){var Jr=Ke[Qr],ae=Jr._seqIndices,cr=Jr._sosType,Wn=Jr._eosType,tr=Q[ae[0]]&1?_:x;if(Z.get(se))for(var Mr=0;Mr<ae.length;Mr++){var Et=ae[Mr];if(G[Et]&se){for(var et=cr,Er=Mr-1;Er>=0;Er--)if(!(G[ae[Er]]&n)){et=G[ae[Er]];break}ee(Et,et&(e|L)?W:et)}}if(Z.get(O))for(var Ir=0;Ir<ae.length;Ir++){var It=ae[Ir];if(G[It]&O)for(var Rr=Ir-1;Rr>=-1;Rr--){var Rt=Rr===-1?cr:G[ae[Rr]];if(Rt&a){Rt===P&&ee(It,b);break}}}if(Z.get(P))for(var rt=0;rt<ae.length;rt++){var Bt=ae[rt];G[Bt]&P&&ee(Bt,_)}if(Z.get(M)||Z.get(E))for(var vr=1;vr<ae.length-1;vr++){var tt=ae[vr];if(G[tt]&(M|E)){for(var nr=0,nt=0,at=vr-1;at>=0&&(nr=G[ae[at]],!!(nr&n));at--);for(var it=vr+1;it<ae.length&&(nt=G[ae[it]],!!(nt&n));it++);nr===nt&&(G[tt]===M?nr===O:nr&(O|b))&&ee(tt,nr)}}if(Z.get(O))for(var Ve=0;Ve<ae.length;Ve++){var Vn=ae[Ve];if(G[Vn]&O){for(var Br=Ve-1;Br>=0&&G[ae[Br]]&(X|n);Br--)ee(ae[Br],O);for(Ve++;Ve<ae.length&&G[ae[Ve]]&(X|n|O);Ve++)G[ae[Ve]]!==O&&ee(ae[Ve],O)}}if(Z.get(X)||Z.get(M)||Z.get(E))for(var pr=0;pr<ae.length;pr++){var Ot=ae[pr];if(G[Ot]&(X|M|E)){ee(Ot,W);for(var Or=pr-1;Or>=0&&G[ae[Or]]&n;Or--)ee(ae[Or],W);for(var Pr=pr+1;Pr<ae.length&&G[ae[Pr]]&n;Pr++)ee(ae[Pr],W)}}if(Z.get(O))for(var ot=0,Pt=cr;ot<ae.length;ot++){var Gt=ae[ot],st=G[Gt];st&O?Pt===x&&ee(Gt,x):st&a&&(Pt=st)}if(Z.get(o)){var gr=_|O|b,Lt=gr|x,Gr=[];{for(var ar=[],ir=0;ir<ae.length;ir++)if(G[ae[ir]]&o){var mr=V[ae[ir]],zt=void 0;if(y(mr)!==null)if(ar.length<63)ar.push({char:mr,seqIndex:ir});else break;else if((zt=k(mr))!==null)for(var yr=ar.length-1;yr>=0;yr--){var lt=ar[yr].char;if(lt===zt||lt===k(I(mr))||y(I(lt))===mr){Gr.push([ar[yr].seqIndex,ir]),ar.length=yr;break}}}Gr.sort(function(Be,ze){return Be[0]-ze[0]})}for(var ut=0;ut<Gr.length;ut++){for(var Wt=Gr[ut],Lr=Wt[0],ft=Wt[1],Vt=!1,Le=0,ht=Lr+1;ht<ft;ht++){var Nt=ae[ht];if(G[Nt]&Lt){Vt=!0;var jt=G[Nt]&gr?_:x;if(jt===tr){Le=jt;break}}}if(Vt&&!Le){Le=cr;for(var dt=Lr-1;dt>=0;dt--){var Ht=ae[dt];if(G[Ht]&Lt){var Xt=G[Ht]&gr?_:x;Xt!==tr?Le=Xt:Le=tr;break}}}if(Le){if(G[ae[Lr]]=G[ae[ft]]=Le,Le!==tr){for(var br=Lr+1;br<ae.length;br++)if(!(G[ae[br]]&n)){f(V[ae[br]])&se&&(G[ae[br]]=Le);break}}if(Le!==tr){for(var xr=ft+1;xr<ae.length;xr++)if(!(G[ae[xr]]&n)){f(V[ae[xr]])&se&&(G[ae[xr]]=Le);break}}}}for(var Ye=0;Ye<ae.length;Ye++)if(G[ae[Ye]]&o){for(var qt=Ye,ct=Ye,vt=cr,Sr=Ye-1;Sr>=0;Sr--)if(G[ae[Sr]]&n)qt=Sr;else{vt=G[ae[Sr]]&gr?_:x;break}for(var Yt=Wn,kr=Ye+1;kr<ae.length;kr++)if(G[ae[kr]]&(o|n))ct=kr;else{Yt=G[ae[kr]]&gr?_:x;break}for(var pt=qt;pt<=ct;pt++)G[ae[pt]]=vt===Yt?vt:tr;Ye=ct}}}for(var Ge=K.start;Ge<=K.end;Ge++){var Nn=Q[Ge],zr=G[Ge];if(Nn&1?zr&(x|O|b)&&Q[Ge]++:zr&_?Q[Ge]++:zr&(b|O)&&(Q[Ge]+=2),zr&n&&(Q[Ge]=Ge===0?K.level:Q[Ge-1]),Ge===K.end||f(V[Ge])&(j|A))for(var Wr=Ge;Wr>=0&&f(V[Wr])&i;Wr--)Q[Wr]=K.level}}return{levels:Q,paragraphs:ge};function Zt(Be,ze){for(var Oe=Be;Oe<V.length;Oe++){var Ze=G[Oe];if(Ze&(_|P))return 1;if(Ze&(A|x)||ze&&Ze===L)return 0;if(Ze&e){var $t=jn(Oe);Oe=$t===-1?V.length:$t}}return 0}function jn(Be){for(var ze=1,Oe=Be+1;Oe<V.length;Oe++){var Ze=G[Oe];if(Ze&A)break;if(Ze&L){if(--ze===0)return Oe}else Ze&e&&ze++}return-1}}var $="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",H;function N(){if(!H){var V=m($,!0),ie=V.map,Y=V.reverseMap;Y.forEach(function(G,pe){ie.set(pe,G)}),H=ie}}function fe(V){return N(),H.get(V)||null}function he(V,ie,Y,G){var pe=V.length;Y=Math.max(0,Y==null?0:+Y),G=Math.min(pe-1,G==null?pe-1:+G);for(var Z=new Map,ee=Y;ee<=G;ee++)if(ie[ee]&1){var Q=fe(V[ee]);Q!==null&&Z.set(ee,Q)}return Z}function te(V,ie,Y,G){var pe=V.length;Y=Math.max(0,Y==null?0:+Y),G=Math.min(pe-1,G==null?pe-1:+G);var Z=[];return ie.paragraphs.forEach(function(ee){var Q=Math.max(Y,ee.start),re=Math.min(G,ee.end);if(Q<re){for(var ge=ie.levels.slice(Q,re+1),K=re;K>=Q&&f(V[K])&i;K--)ge[K]=ee.level;for(var de=ee.level,ke=1/0,Te=0;Te<ge.length;Te++){var ye=ge[Te];ye>de&&(de=ye),ye<ke&&(ke=ye|1)}for(var De=de;De>=ke;De--)for(var oe=0;oe<ge.length;oe++)if(ge[oe]>=De){for(var me=oe;oe+1<ge.length&&ge[oe+1]>=De;)oe++;oe>me&&Z.push([me+Q,oe+Q])}}}),Z}function J(V,ie,Y,G){var pe=le(V,ie,Y,G),Z=[].concat(V);return pe.forEach(function(ee,Q){Z[Q]=(ie.levels[ee]&1?fe(V[ee]):null)||V[ee]}),Z.join("")}function le(V,ie,Y,G){for(var pe=te(V,ie,Y,G),Z=[],ee=0;ee<V.length;ee++)Z[ee]=ee;return pe.forEach(function(Q){for(var re=Q[0],ge=Q[1],K=Z.slice(re,ge+1),de=K.length;de--;)Z[ge-de]=K[de]}),Z}return t.closingToOpeningBracket=k,t.getBidiCharType=f,t.getBidiCharTypeName=d,t.getCanonicalBracket=I,t.getEmbeddingLevels=q,t.getMirroredCharacter=fe,t.getMirroredCharactersMap=he,t.getReorderSegments=te,t.getReorderedIndices=le,t.getReorderedString=J,t.openingToClosingBracket=y,Object.defineProperty(t,"__esModule",{value:!0}),t})({});return l}var ma=ga;rr();var wn=/\bvoid\s+main\s*\(\s*\)\s*{/g;function Ut(l){let t=/^[ \t]*#include +<([\w\d./]+)>/gm;function h(c,r){let e=sa[r];return e?Ut(e):c}return l.replace(t,h)}var Me=[];for(let l=0;l<256;l++)Me[l]=(l<16?"0":"")+l.toString(16);function ya(){let l=Math.random()*4294967295|0,t=Math.random()*4294967295|0,h=Math.random()*4294967295|0,c=Math.random()*4294967295|0;return(Me[l&255]+Me[l>>8&255]+Me[l>>16&255]+Me[l>>24&255]+"-"+Me[t&255]+Me[t>>8&255]+"-"+Me[t>>16&15|64]+Me[t>>24&255]+"-"+Me[h&63|128]+Me[h>>8&255]+"-"+Me[h>>16&255]+Me[h>>24&255]+Me[c&255]+Me[c>>8&255]+Me[c>>16&255]+Me[c>>24&255]).toUpperCase()}var Je=Object.assign||function(){let l=arguments[0];for(let t=1,h=arguments.length;t<h;t++){let c=arguments[t];if(c)for(let r in c)Object.prototype.hasOwnProperty.call(c,r)&&(l[r]=c[r])}return l},ba=Date.now(),rn=new WeakMap,tn=new Map,xa=1e10;function Fr(l,t){let h=Ta(t),c=rn.get(l);if(c||rn.set(l,c=Object.create(null)),c[h])return new c[h];let r="_onBeforeCompile".concat(h),e=function(i,s){l.onBeforeCompile.call(this,i,s);let u=this.customProgramCacheKey()+"|"+i.vertexShader+"|"+i.fragmentShader,f=tn[u];if(!f){let d=Sa(this,i,t,h);f=tn[u]=d}i.vertexShader=f.vertexShader,i.fragmentShader=f.fragmentShader,Je(i.uniforms,this.uniforms),t.timeUniform&&(i.uniforms[t.timeUniform]={get value(){return Date.now()-ba}}),this[r]&&this[r](i)},a=function(){return o(t.chained?l:l.clone())},o=function(i){let s=Object.create(i,n);return Object.defineProperty(s,"baseMaterial",{value:l}),Object.defineProperty(s,"id",{value:xa++}),s.uuid=ya(),s.uniforms=Je({},i.uniforms,t.uniforms),s.defines=Je({},i.defines,t.defines),s.defines["TROIKA_DERIVED_MATERIAL_".concat(h)]="",s.extensions=Je({},i.extensions,t.extensions),s._listeners=void 0,s},n={constructor:{value:a},isDerivedMaterial:{value:!0},type:{get:()=>l.type,set:i=>{l.type=i}},isDerivedFrom:{writable:!0,configurable:!0,value:function(i){let s=this.baseMaterial;return i===s||s.isDerivedMaterial&&s.isDerivedFrom(i)||!1}},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return l.customProgramCacheKey()+"|"+h}},onBeforeCompile:{get(){return e},set(i){this[r]=i}},copy:{writable:!0,configurable:!0,value:function(i){return l.copy.call(this,i),!l.isShaderMaterial&&!l.isDerivedMaterial&&(Je(this.extensions,i.extensions),Je(this.defines,i.defines),Je(this.uniforms,oa.clone(i.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){let i=new l.constructor;return o(i).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let i=this._depthMaterial;return i||(i=this._depthMaterial=Fr(l.isDerivedMaterial?l.getDepthMaterial():new aa({depthPacking:ia}),t),i.defines.IS_DEPTH_MATERIAL="",i.uniforms=this.uniforms),i}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let i=this._distanceMaterial;return i||(i=this._distanceMaterial=Fr(l.isDerivedMaterial?l.getDistanceMaterial():new na,t),i.defines.IS_DISTANCE_MATERIAL="",i.uniforms=this.uniforms),i}},dispose:{writable:!0,configurable:!0,value(){let{_depthMaterial:i,_distanceMaterial:s}=this;i&&i.dispose(),s&&s.dispose(),l.dispose.call(this)}}};return c[h]=a,new a}function Sa(l,{vertexShader:t,fragmentShader:h},c,r){let{vertexDefs:e,vertexMainIntro:a,vertexMainOutro:o,vertexTransform:n,fragmentDefs:i,fragmentMainIntro:s,fragmentMainOutro:u,fragmentColorTransform:f,customRewriter:d,timeUniform:g}=c;if(e=e||"",a=a||"",o=o||"",i=i||"",s=s||"",u=u||"",(n||d)&&(t=Ut(t)),(f||d)&&(h=h.replace(/^[ \t]*#include <((?:tonemapping|encodings|colorspace|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),h=Ut(h)),d){let m=d({vertexShader:t,fragmentShader:h});t=m.vertexShader,h=m.fragmentShader}if(f){let m=[];h=h.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,p=>(m.push(p),"")),u="".concat(f,`
`).concat(m.join(`
`),`
`).concat(u)}if(g){let m=`
uniform float `.concat(g,`;
`);e=m+e,i=m+i}return n&&(t="vec3 troika_position_".concat(r,`;
vec3 troika_normal_`).concat(r,`;
vec2 troika_uv_`).concat(r,`;
`).concat(t,`
`),e="".concat(e,`
void troikaVertexTransform`).concat(r,`(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  `).concat(n,`
}
`),a=`
troika_position_`.concat(r,` = vec3(position);
troika_normal_`).concat(r,` = vec3(normal);
troika_uv_`).concat(r,` = vec2(uv);
troikaVertexTransform`).concat(r,"(troika_position_").concat(r,", troika_normal_").concat(r,", troika_uv_").concat(r,`);
`).concat(a,`
`),t=t.replace(/\b(position|normal|uv)\b/g,(m,p,U,F)=>/\battribute\s+vec[23]\s+$/.test(F.substr(0,U))?p:"troika_".concat(p,"_").concat(r)),l.map&&l.map.channel>0||(t=t.replace(/\bMAP_UV\b/g,"troika_uv_".concat(r)))),t=nn(t,r,e,a,o),h=nn(h,r,i,s,u),{vertexShader:t,fragmentShader:h}}function nn(l,t,h,c,r){return(c||r||h)&&(l=l.replace(wn,`
`.concat(h,`
void troikaOrigMain`).concat(t,"() {")),l+=`
void main() {
  `.concat(c,`
  troikaOrigMain`).concat(t,`();
  `).concat(r,`
}`)),l}function ka(l,t){return l==="uniforms"?void 0:typeof t=="function"?t.toString():t}var Ua=0,an=new Map;function Ta(l){let t=JSON.stringify(l,ka),h=an.get(t);return h==null&&an.set(t,h=++Ua),h}function wa(){return typeof window>"u"&&(self.window=self),(function(l){var t={parse:function(r){var e=t._bin,a=new Uint8Array(r);if(e.readASCII(a,0,4)=="ttcf"){var o=4;e.readUshort(a,o),o+=2,e.readUshort(a,o),o+=2;var n=e.readUint(a,o);o+=4;for(var i=[],s=0;s<n;s++){var u=e.readUint(a,o);o+=4,i.push(t._readFont(a,u))}return i}return[t._readFont(a,0)]},_readFont:function(r,e){var a=t._bin,o=e;a.readFixed(r,e),e+=4;var n=a.readUshort(r,e);e+=2,a.readUshort(r,e),e+=2,a.readUshort(r,e),e+=2,a.readUshort(r,e),e+=2;for(var i=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],s={_data:r,_offset:o},u={},f=0;f<n;f++){var d=a.readASCII(r,e,4);e+=4,a.readUint(r,e),e+=4;var g=a.readUint(r,e);e+=4;var m=a.readUint(r,e);e+=4,u[d]={offset:g,length:m}}for(f=0;f<i.length;f++){var p=i[f];u[p]&&(s[p.trim()]=t[p.trim()].parse(r,u[p].offset,u[p].length,s))}return s},_tabOffset:function(r,e,a){for(var o=t._bin,n=o.readUshort(r,a+4),i=a+12,s=0;s<n;s++){var u=o.readASCII(r,i,4);i+=4,o.readUint(r,i),i+=4;var f=o.readUint(r,i);if(i+=4,o.readUint(r,i),i+=4,u==e)return f}return 0}};t._bin={readFixed:function(r,e){return(r[e]<<8|r[e+1])+(r[e+2]<<8|r[e+3])/65540},readF2dot14:function(r,e){return t._bin.readShort(r,e)/16384},readInt:function(r,e){return t._bin._view(r).getInt32(e)},readInt8:function(r,e){return t._bin._view(r).getInt8(e)},readShort:function(r,e){return t._bin._view(r).getInt16(e)},readUshort:function(r,e){return t._bin._view(r).getUint16(e)},readUshorts:function(r,e,a){for(var o=[],n=0;n<a;n++)o.push(t._bin.readUshort(r,e+2*n));return o},readUint:function(r,e){return t._bin._view(r).getUint32(e)},readUint64:function(r,e){return 4294967296*t._bin.readUint(r,e)+t._bin.readUint(r,e+4)},readASCII:function(r,e,a){for(var o="",n=0;n<a;n++)o+=String.fromCharCode(r[e+n]);return o},readUnicode:function(r,e,a){for(var o="",n=0;n<a;n++){var i=r[e++]<<8|r[e++];o+=String.fromCharCode(i)}return o},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(r,e,a){var o=t._bin._tdec;return o&&e==0&&a==r.length?o.decode(r):t._bin.readASCII(r,e,a)},readBytes:function(r,e,a){for(var o=[],n=0;n<a;n++)o.push(r[e+n]);return o},readASCIIArray:function(r,e,a){for(var o=[],n=0;n<a;n++)o.push(String.fromCharCode(r[e+n]));return o},_view:function(r){return r._dataView||(r._dataView=r.buffer?new DataView(r.buffer,r.byteOffset,r.byteLength):new DataView(new Uint8Array(r).buffer))}},t._lctf={},t._lctf.parse=function(r,e,a,o,n){var i=t._bin,s={},u=e;i.readFixed(r,e),e+=4;var f=i.readUshort(r,e);e+=2;var d=i.readUshort(r,e);e+=2;var g=i.readUshort(r,e);return e+=2,s.scriptList=t._lctf.readScriptList(r,u+f),s.featureList=t._lctf.readFeatureList(r,u+d),s.lookupList=t._lctf.readLookupList(r,u+g,n),s},t._lctf.readLookupList=function(r,e,a){var o=t._bin,n=e,i=[],s=o.readUshort(r,e);e+=2;for(var u=0;u<s;u++){var f=o.readUshort(r,e);e+=2;var d=t._lctf.readLookupTable(r,n+f,a);i.push(d)}return i},t._lctf.readLookupTable=function(r,e,a){var o=t._bin,n=e,i={tabs:[]};i.ltype=o.readUshort(r,e),e+=2,i.flag=o.readUshort(r,e),e+=2;var s=o.readUshort(r,e);e+=2;for(var u=i.ltype,f=0;f<s;f++){var d=o.readUshort(r,e);e+=2;var g=a(r,u,n+d,i);i.tabs.push(g)}return i},t._lctf.numOfOnes=function(r){for(var e=0,a=0;a<32;a++)(r>>>a&1)!=0&&e++;return e},t._lctf.readClassDef=function(r,e){var a=t._bin,o=[],n=a.readUshort(r,e);if(e+=2,n==1){var i=a.readUshort(r,e);e+=2;var s=a.readUshort(r,e);e+=2;for(var u=0;u<s;u++)o.push(i+u),o.push(i+u),o.push(a.readUshort(r,e)),e+=2}if(n==2){var f=a.readUshort(r,e);for(e+=2,u=0;u<f;u++)o.push(a.readUshort(r,e)),e+=2,o.push(a.readUshort(r,e)),e+=2,o.push(a.readUshort(r,e)),e+=2}return o},t._lctf.getInterval=function(r,e){for(var a=0;a<r.length;a+=3){var o=r[a],n=r[a+1];if(r[a+2],o<=e&&e<=n)return a}return-1},t._lctf.readCoverage=function(r,e){var a=t._bin,o={};o.fmt=a.readUshort(r,e),e+=2;var n=a.readUshort(r,e);return e+=2,o.fmt==1&&(o.tab=a.readUshorts(r,e,n)),o.fmt==2&&(o.tab=a.readUshorts(r,e,3*n)),o},t._lctf.coverageIndex=function(r,e){var a=r.tab;if(r.fmt==1)return a.indexOf(e);if(r.fmt==2){var o=t._lctf.getInterval(a,e);if(o!=-1)return a[o+2]+(e-a[o])}return-1},t._lctf.readFeatureList=function(r,e){var a=t._bin,o=e,n=[],i=a.readUshort(r,e);e+=2;for(var s=0;s<i;s++){var u=a.readASCII(r,e,4);e+=4;var f=a.readUshort(r,e);e+=2;var d=t._lctf.readFeatureTable(r,o+f);d.tag=u.trim(),n.push(d)}return n},t._lctf.readFeatureTable=function(r,e){var a=t._bin,o=e,n={},i=a.readUshort(r,e);e+=2,i>0&&(n.featureParams=o+i);var s=a.readUshort(r,e);e+=2,n.tab=[];for(var u=0;u<s;u++)n.tab.push(a.readUshort(r,e+2*u));return n},t._lctf.readScriptList=function(r,e){var a=t._bin,o=e,n={},i=a.readUshort(r,e);e+=2;for(var s=0;s<i;s++){var u=a.readASCII(r,e,4);e+=4;var f=a.readUshort(r,e);e+=2,n[u.trim()]=t._lctf.readScriptTable(r,o+f)}return n},t._lctf.readScriptTable=function(r,e){var a=t._bin,o=e,n={},i=a.readUshort(r,e);e+=2,i>0&&(n.default=t._lctf.readLangSysTable(r,o+i));var s=a.readUshort(r,e);e+=2;for(var u=0;u<s;u++){var f=a.readASCII(r,e,4);e+=4;var d=a.readUshort(r,e);e+=2,n[f.trim()]=t._lctf.readLangSysTable(r,o+d)}return n},t._lctf.readLangSysTable=function(r,e){var a=t._bin,o={};a.readUshort(r,e),e+=2,o.reqFeature=a.readUshort(r,e),e+=2;var n=a.readUshort(r,e);return e+=2,o.features=a.readUshorts(r,e,n),o},t.CFF={},t.CFF.parse=function(r,e,a){var o=t._bin;(r=new Uint8Array(r.buffer,e,a))[e=0],r[++e],r[++e],r[++e],e++;var n=[];e=t.CFF.readIndex(r,e,n);for(var i=[],s=0;s<n.length-1;s++)i.push(o.readASCII(r,e+n[s],n[s+1]-n[s]));e+=n[n.length-1];var u=[];e=t.CFF.readIndex(r,e,u);var f=[];for(s=0;s<u.length-1;s++)f.push(t.CFF.readDict(r,e+u[s],e+u[s+1]));e+=u[u.length-1];var d=f[0],g=[];e=t.CFF.readIndex(r,e,g);var m=[];for(s=0;s<g.length-1;s++)m.push(o.readASCII(r,e+g[s],g[s+1]-g[s]));if(e+=g[g.length-1],t.CFF.readSubrs(r,e,d),d.CharStrings){e=d.CharStrings,g=[],e=t.CFF.readIndex(r,e,g);var p=[];for(s=0;s<g.length-1;s++)p.push(o.readBytes(r,e+g[s],g[s+1]-g[s]));d.CharStrings=p}if(d.ROS){e=d.FDArray;var U=[];for(e=t.CFF.readIndex(r,e,U),d.FDArray=[],s=0;s<U.length-1;s++){var F=t.CFF.readDict(r,e+U[s],e+U[s+1]);t.CFF._readFDict(r,F,m),d.FDArray.push(F)}e+=U[U.length-1],e=d.FDSelect,d.FDSelect=[];var w=r[e];if(e++,w!=3)throw w;var y=o.readUshort(r,e);for(e+=2,s=0;s<y+1;s++)d.FDSelect.push(o.readUshort(r,e),r[e+2]),e+=3}return d.Encoding&&(d.Encoding=t.CFF.readEncoding(r,d.Encoding,d.CharStrings.length)),d.charset&&(d.charset=t.CFF.readCharset(r,d.charset,d.CharStrings.length)),t.CFF._readFDict(r,d,m),d},t.CFF._readFDict=function(r,e,a){var o;for(var n in e.Private&&(o=e.Private[1],e.Private=t.CFF.readDict(r,o,o+e.Private[0]),e.Private.Subrs&&t.CFF.readSubrs(r,o+e.Private.Subrs,e.Private)),e)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(n)!=-1&&(e[n]=a[e[n]-426+35])},t.CFF.readSubrs=function(r,e,a){var o=t._bin,n=[];e=t.CFF.readIndex(r,e,n);var i,s=n.length;i=s<1240?107:s<33900?1131:32768,a.Bias=i,a.Subrs=[];for(var u=0;u<n.length-1;u++)a.Subrs.push(o.readBytes(r,e+n[u],n[u+1]-n[u]))},t.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],t.CFF.glyphByUnicode=function(r,e){for(var a=0;a<r.charset.length;a++)if(r.charset[a]==e)return a;return-1},t.CFF.glyphBySE=function(r,e){return e<0||e>255?-1:t.CFF.glyphByUnicode(r,t.CFF.tableSE[e])},t.CFF.readEncoding=function(r,e,a){t._bin;var o=[".notdef"],n=r[e];if(e++,n!=0)throw"error: unknown encoding format: "+n;var i=r[e];e++;for(var s=0;s<i;s++)o.push(r[e+s]);return o},t.CFF.readCharset=function(r,e,a){var o=t._bin,n=[".notdef"],i=r[e];if(e++,i==0)for(var s=0;s<a;s++){var u=o.readUshort(r,e);e+=2,n.push(u)}else{if(i!=1&&i!=2)throw"error: format: "+i;for(;n.length<a;){u=o.readUshort(r,e),e+=2;var f=0;for(i==1?(f=r[e],e++):(f=o.readUshort(r,e),e+=2),s=0;s<=f;s++)n.push(u),u++}}return n},t.CFF.readIndex=function(r,e,a){var o=t._bin,n=o.readUshort(r,e)+1,i=r[e+=2];if(e++,i==1)for(var s=0;s<n;s++)a.push(r[e+s]);else if(i==2)for(s=0;s<n;s++)a.push(o.readUshort(r,e+2*s));else if(i==3)for(s=0;s<n;s++)a.push(16777215&o.readUint(r,e+3*s-1));else if(n!=1)throw"unsupported offset size: "+i+", count: "+n;return(e+=n*i)-1},t.CFF.getCharString=function(r,e,a){var o=t._bin,n=r[e],i=r[e+1];r[e+2],r[e+3],r[e+4];var s=1,u=null,f=null;n<=20&&(u=n,s=1),n==12&&(u=100*n+i,s=2),21<=n&&n<=27&&(u=n,s=1),n==28&&(f=o.readShort(r,e+1),s=3),29<=n&&n<=31&&(u=n,s=1),32<=n&&n<=246&&(f=n-139,s=1),247<=n&&n<=250&&(f=256*(n-247)+i+108,s=2),251<=n&&n<=254&&(f=256*-(n-251)-i-108,s=2),n==255&&(f=o.readInt(r,e+1)/65535,s=5),a.val=f??"o"+u,a.size=s},t.CFF.readCharString=function(r,e,a){for(var o=e+a,n=t._bin,i=[];e<o;){var s=r[e],u=r[e+1];r[e+2],r[e+3],r[e+4];var f=1,d=null,g=null;s<=20&&(d=s,f=1),s==12&&(d=100*s+u,f=2),s!=19&&s!=20||(d=s,f=2),21<=s&&s<=27&&(d=s,f=1),s==28&&(g=n.readShort(r,e+1),f=3),29<=s&&s<=31&&(d=s,f=1),32<=s&&s<=246&&(g=s-139,f=1),247<=s&&s<=250&&(g=256*(s-247)+u+108,f=2),251<=s&&s<=254&&(g=256*-(s-251)-u-108,f=2),s==255&&(g=n.readInt(r,e+1)/65535,f=5),i.push(g??"o"+d),e+=f}return i},t.CFF.readDict=function(r,e,a){for(var o=t._bin,n={},i=[];e<a;){var s=r[e],u=r[e+1];r[e+2],r[e+3],r[e+4];var f=1,d=null,g=null;if(s==28&&(g=o.readShort(r,e+1),f=3),s==29&&(g=o.readInt(r,e+1),f=5),32<=s&&s<=246&&(g=s-139,f=1),247<=s&&s<=250&&(g=256*(s-247)+u+108,f=2),251<=s&&s<=254&&(g=256*-(s-251)-u-108,f=2),s==255)throw g=o.readInt(r,e+1)/65535,f=5,"unknown number";if(s==30){var m=[];for(f=1;;){var p=r[e+f];f++;var U=p>>4,F=15&p;if(U!=15&&m.push(U),F!=15&&m.push(F),F==15)break}for(var w="",y=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],k=0;k<m.length;k++)w+=y[m[k]];g=parseFloat(w)}s<=21&&(d=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][s],f=1,s==12&&(d=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][u],f=2)),d!=null?(n[d]=i.length==1?i[0]:i,i=[]):i.push(g),e+=f}return n},t.cmap={},t.cmap.parse=function(r,e,a){r=new Uint8Array(r.buffer,e,a),e=0;var o=t._bin,n={};o.readUshort(r,e),e+=2;var i=o.readUshort(r,e);e+=2;var s=[];n.tables=[];for(var u=0;u<i;u++){var f=o.readUshort(r,e);e+=2;var d=o.readUshort(r,e);e+=2;var g=o.readUint(r,e);e+=4;var m="p"+f+"e"+d,p=s.indexOf(g);if(p==-1){var U;p=n.tables.length,s.push(g);var F=o.readUshort(r,g);F==0?U=t.cmap.parse0(r,g):F==4?U=t.cmap.parse4(r,g):F==6?U=t.cmap.parse6(r,g):F==12?U=t.cmap.parse12(r,g):console.debug("unknown format: "+F,f,d,g),n.tables.push(U)}if(n[m]!=null)throw"multiple tables for one platform+encoding";n[m]=p}return n},t.cmap.parse0=function(r,e){var a=t._bin,o={};o.format=a.readUshort(r,e),e+=2;var n=a.readUshort(r,e);e+=2,a.readUshort(r,e),e+=2,o.map=[];for(var i=0;i<n-6;i++)o.map.push(r[e+i]);return o},t.cmap.parse4=function(r,e){var a=t._bin,o=e,n={};n.format=a.readUshort(r,e),e+=2;var i=a.readUshort(r,e);e+=2,a.readUshort(r,e),e+=2;var s=a.readUshort(r,e);e+=2;var u=s/2;n.searchRange=a.readUshort(r,e),e+=2,n.entrySelector=a.readUshort(r,e),e+=2,n.rangeShift=a.readUshort(r,e),e+=2,n.endCount=a.readUshorts(r,e,u),e+=2*u,e+=2,n.startCount=a.readUshorts(r,e,u),e+=2*u,n.idDelta=[];for(var f=0;f<u;f++)n.idDelta.push(a.readShort(r,e)),e+=2;for(n.idRangeOffset=a.readUshorts(r,e,u),e+=2*u,n.glyphIdArray=[];e<o+i;)n.glyphIdArray.push(a.readUshort(r,e)),e+=2;return n},t.cmap.parse6=function(r,e){var a=t._bin,o={};o.format=a.readUshort(r,e),e+=2,a.readUshort(r,e),e+=2,a.readUshort(r,e),e+=2,o.firstCode=a.readUshort(r,e),e+=2;var n=a.readUshort(r,e);e+=2,o.glyphIdArray=[];for(var i=0;i<n;i++)o.glyphIdArray.push(a.readUshort(r,e)),e+=2;return o},t.cmap.parse12=function(r,e){var a=t._bin,o={};o.format=a.readUshort(r,e),e+=2,e+=2,a.readUint(r,e),e+=4,a.readUint(r,e),e+=4;var n=a.readUint(r,e);e+=4,o.groups=[];for(var i=0;i<n;i++){var s=e+12*i,u=a.readUint(r,s+0),f=a.readUint(r,s+4),d=a.readUint(r,s+8);o.groups.push([u,f,d])}return o},t.glyf={},t.glyf.parse=function(r,e,a,o){for(var n=[],i=0;i<o.maxp.numGlyphs;i++)n.push(null);return n},t.glyf._parseGlyf=function(r,e){var a=t._bin,o=r._data,n=t._tabOffset(o,"glyf",r._offset)+r.loca[e];if(r.loca[e]==r.loca[e+1])return null;var i={};if(i.noc=a.readShort(o,n),n+=2,i.xMin=a.readShort(o,n),n+=2,i.yMin=a.readShort(o,n),n+=2,i.xMax=a.readShort(o,n),n+=2,i.yMax=a.readShort(o,n),n+=2,i.xMin>=i.xMax||i.yMin>=i.yMax)return null;if(i.noc>0){i.endPts=[];for(var s=0;s<i.noc;s++)i.endPts.push(a.readUshort(o,n)),n+=2;var u=a.readUshort(o,n);if(n+=2,o.length-n<u)return null;i.instructions=a.readBytes(o,n,u),n+=u;var f=i.endPts[i.noc-1]+1;for(i.flags=[],s=0;s<f;s++){var d=o[n];if(n++,i.flags.push(d),(8&d)!=0){var g=o[n];n++;for(var m=0;m<g;m++)i.flags.push(d),s++}}for(i.xs=[],s=0;s<f;s++){var p=(2&i.flags[s])!=0,U=(16&i.flags[s])!=0;p?(i.xs.push(U?o[n]:-o[n]),n++):U?i.xs.push(0):(i.xs.push(a.readShort(o,n)),n+=2)}for(i.ys=[],s=0;s<f;s++)p=(4&i.flags[s])!=0,U=(32&i.flags[s])!=0,p?(i.ys.push(U?o[n]:-o[n]),n++):U?i.ys.push(0):(i.ys.push(a.readShort(o,n)),n+=2);var F=0,w=0;for(s=0;s<f;s++)F+=i.xs[s],w+=i.ys[s],i.xs[s]=F,i.ys[s]=w}else{var y;i.parts=[];do{y=a.readUshort(o,n),n+=2;var k={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(i.parts.push(k),k.glyphIndex=a.readUshort(o,n),n+=2,1&y){var I=a.readShort(o,n);n+=2;var x=a.readShort(o,n);n+=2}else I=a.readInt8(o,n),n++,x=a.readInt8(o,n),n++;2&y?(k.m.tx=I,k.m.ty=x):(k.p1=I,k.p2=x),8&y?(k.m.a=k.m.d=a.readF2dot14(o,n),n+=2):64&y?(k.m.a=a.readF2dot14(o,n),n+=2,k.m.d=a.readF2dot14(o,n),n+=2):128&y&&(k.m.a=a.readF2dot14(o,n),n+=2,k.m.b=a.readF2dot14(o,n),n+=2,k.m.c=a.readF2dot14(o,n),n+=2,k.m.d=a.readF2dot14(o,n),n+=2)}while(32&y);if(256&y){var _=a.readUshort(o,n);for(n+=2,i.instr=[],s=0;s<_;s++)i.instr.push(o[n]),n++}}return i},t.GDEF={},t.GDEF.parse=function(r,e,a,o){var n=e;e+=4;var i=t._bin.readUshort(r,e);return{glyphClassDef:i===0?null:t._lctf.readClassDef(r,n+i)}},t.GPOS={},t.GPOS.parse=function(r,e,a,o){return t._lctf.parse(r,e,a,o,t.GPOS.subt)},t.GPOS.subt=function(r,e,a,o){var n=t._bin,i=a,s={};if(s.fmt=n.readUshort(r,a),a+=2,e==1||e==2||e==3||e==7||e==8&&s.fmt<=2){var u=n.readUshort(r,a);a+=2,s.coverage=t._lctf.readCoverage(r,u+i)}if(e==1&&s.fmt==1){var f=n.readUshort(r,a);a+=2,f!=0&&(s.pos=t.GPOS.readValueRecord(r,a,f))}else if(e==2&&s.fmt>=1&&s.fmt<=2){f=n.readUshort(r,a),a+=2;var d=n.readUshort(r,a);a+=2;var g=t._lctf.numOfOnes(f),m=t._lctf.numOfOnes(d);if(s.fmt==1){s.pairsets=[];var p=n.readUshort(r,a);a+=2;for(var U=0;U<p;U++){var F=i+n.readUshort(r,a);a+=2;var w=n.readUshort(r,F);F+=2;for(var y=[],k=0;k<w;k++){var I=n.readUshort(r,F);F+=2,f!=0&&(b=t.GPOS.readValueRecord(r,F,f),F+=2*g),d!=0&&(E=t.GPOS.readValueRecord(r,F,d),F+=2*m),y.push({gid2:I,val1:b,val2:E})}s.pairsets.push(y)}}if(s.fmt==2){var x=n.readUshort(r,a);a+=2;var _=n.readUshort(r,a);a+=2;var O=n.readUshort(r,a);a+=2;var M=n.readUshort(r,a);for(a+=2,s.classDef1=t._lctf.readClassDef(r,i+x),s.classDef2=t._lctf.readClassDef(r,i+_),s.matrix=[],U=0;U<O;U++){var X=[];for(k=0;k<M;k++){var b=null,E=null;f!=0&&(b=t.GPOS.readValueRecord(r,a,f),a+=2*g),d!=0&&(E=t.GPOS.readValueRecord(r,a,d),a+=2*m),X.push({val1:b,val2:E})}s.matrix.push(X)}}}else if(e==4&&s.fmt==1)s.markCoverage=t._lctf.readCoverage(r,n.readUshort(r,a)+i),s.baseCoverage=t._lctf.readCoverage(r,n.readUshort(r,a+2)+i),s.markClassCount=n.readUshort(r,a+4),s.markArray=t.GPOS.readMarkArray(r,n.readUshort(r,a+6)+i),s.baseArray=t.GPOS.readBaseArray(r,n.readUshort(r,a+8)+i,s.markClassCount);else if(e==6&&s.fmt==1)s.mark1Coverage=t._lctf.readCoverage(r,n.readUshort(r,a)+i),s.mark2Coverage=t._lctf.readCoverage(r,n.readUshort(r,a+2)+i),s.markClassCount=n.readUshort(r,a+4),s.mark1Array=t.GPOS.readMarkArray(r,n.readUshort(r,a+6)+i),s.mark2Array=t.GPOS.readBaseArray(r,n.readUshort(r,a+8)+i,s.markClassCount);else{if(e==9&&s.fmt==1){var A=n.readUshort(r,a);a+=2;var j=n.readUint(r,a);if(a+=4,o.ltype==9)o.ltype=A;else if(o.ltype!=A)throw"invalid extension substitution";return t.GPOS.subt(r,o.ltype,i+j)}console.debug("unsupported GPOS table LookupType",e,"format",s.fmt)}return s},t.GPOS.readValueRecord=function(r,e,a){var o=t._bin,n=[];return n.push(1&a?o.readShort(r,e):0),e+=1&a?2:0,n.push(2&a?o.readShort(r,e):0),e+=2&a?2:0,n.push(4&a?o.readShort(r,e):0),e+=4&a?2:0,n.push(8&a?o.readShort(r,e):0),e+=8&a?2:0,n},t.GPOS.readBaseArray=function(r,e,a){var o=t._bin,n=[],i=e,s=o.readUshort(r,e);e+=2;for(var u=0;u<s;u++){for(var f=[],d=0;d<a;d++)f.push(t.GPOS.readAnchorRecord(r,i+o.readUshort(r,e))),e+=2;n.push(f)}return n},t.GPOS.readMarkArray=function(r,e){var a=t._bin,o=[],n=e,i=a.readUshort(r,e);e+=2;for(var s=0;s<i;s++){var u=t.GPOS.readAnchorRecord(r,a.readUshort(r,e+2)+n);u.markClass=a.readUshort(r,e),o.push(u),e+=4}return o},t.GPOS.readAnchorRecord=function(r,e){var a=t._bin,o={};return o.fmt=a.readUshort(r,e),o.x=a.readShort(r,e+2),o.y=a.readShort(r,e+4),o},t.GSUB={},t.GSUB.parse=function(r,e,a,o){return t._lctf.parse(r,e,a,o,t.GSUB.subt)},t.GSUB.subt=function(r,e,a,o){var n=t._bin,i=a,s={};if(s.fmt=n.readUshort(r,a),a+=2,e!=1&&e!=2&&e!=4&&e!=5&&e!=6)return null;if(e==1||e==2||e==4||e==5&&s.fmt<=2||e==6&&s.fmt<=2){var u=n.readUshort(r,a);a+=2,s.coverage=t._lctf.readCoverage(r,i+u)}if(e==1&&s.fmt>=1&&s.fmt<=2){if(s.fmt==1)s.delta=n.readShort(r,a),a+=2;else if(s.fmt==2){var f=n.readUshort(r,a);a+=2,s.newg=n.readUshorts(r,a,f),a+=2*s.newg.length}}else if(e==2&&s.fmt==1){f=n.readUshort(r,a),a+=2,s.seqs=[];for(var d=0;d<f;d++){var g=n.readUshort(r,a)+i;a+=2;var m=n.readUshort(r,g);s.seqs.push(n.readUshorts(r,g+2,m))}}else if(e==4)for(s.vals=[],f=n.readUshort(r,a),a+=2,d=0;d<f;d++){var p=n.readUshort(r,a);a+=2,s.vals.push(t.GSUB.readLigatureSet(r,i+p))}else if(e==5&&s.fmt==2){if(s.fmt==2){var U=n.readUshort(r,a);a+=2,s.cDef=t._lctf.readClassDef(r,i+U),s.scset=[];var F=n.readUshort(r,a);for(a+=2,d=0;d<F;d++){var w=n.readUshort(r,a);a+=2,s.scset.push(w==0?null:t.GSUB.readSubClassSet(r,i+w))}}}else if(e==6&&s.fmt==3){if(s.fmt==3){for(d=0;d<3;d++){f=n.readUshort(r,a),a+=2;for(var y=[],k=0;k<f;k++)y.push(t._lctf.readCoverage(r,i+n.readUshort(r,a+2*k)));a+=2*f,d==0&&(s.backCvg=y),d==1&&(s.inptCvg=y),d==2&&(s.ahedCvg=y)}f=n.readUshort(r,a),a+=2,s.lookupRec=t.GSUB.readSubstLookupRecords(r,a,f)}}else{if(e==7&&s.fmt==1){var I=n.readUshort(r,a);a+=2;var x=n.readUint(r,a);if(a+=4,o.ltype==9)o.ltype=I;else if(o.ltype!=I)throw"invalid extension substitution";return t.GSUB.subt(r,o.ltype,i+x)}console.debug("unsupported GSUB table LookupType",e,"format",s.fmt)}return s},t.GSUB.readSubClassSet=function(r,e){var a=t._bin.readUshort,o=e,n=[],i=a(r,e);e+=2;for(var s=0;s<i;s++){var u=a(r,e);e+=2,n.push(t.GSUB.readSubClassRule(r,o+u))}return n},t.GSUB.readSubClassRule=function(r,e){var a=t._bin.readUshort,o={},n=a(r,e),i=a(r,e+=2);e+=2,o.input=[];for(var s=0;s<n-1;s++)o.input.push(a(r,e)),e+=2;return o.substLookupRecords=t.GSUB.readSubstLookupRecords(r,e,i),o},t.GSUB.readSubstLookupRecords=function(r,e,a){for(var o=t._bin.readUshort,n=[],i=0;i<a;i++)n.push(o(r,e),o(r,e+2)),e+=4;return n},t.GSUB.readChainSubClassSet=function(r,e){var a=t._bin,o=e,n=[],i=a.readUshort(r,e);e+=2;for(var s=0;s<i;s++){var u=a.readUshort(r,e);e+=2,n.push(t.GSUB.readChainSubClassRule(r,o+u))}return n},t.GSUB.readChainSubClassRule=function(r,e){for(var a=t._bin,o={},n=["backtrack","input","lookahead"],i=0;i<n.length;i++){var s=a.readUshort(r,e);e+=2,i==1&&s--,o[n[i]]=a.readUshorts(r,e,s),e+=2*o[n[i]].length}return s=a.readUshort(r,e),e+=2,o.subst=a.readUshorts(r,e,2*s),e+=2*o.subst.length,o},t.GSUB.readLigatureSet=function(r,e){var a=t._bin,o=e,n=[],i=a.readUshort(r,e);e+=2;for(var s=0;s<i;s++){var u=a.readUshort(r,e);e+=2,n.push(t.GSUB.readLigature(r,o+u))}return n},t.GSUB.readLigature=function(r,e){var a=t._bin,o={chain:[]};o.nglyph=a.readUshort(r,e),e+=2;var n=a.readUshort(r,e);e+=2;for(var i=0;i<n-1;i++)o.chain.push(a.readUshort(r,e)),e+=2;return o},t.head={},t.head.parse=function(r,e,a){var o=t._bin,n={};return o.readFixed(r,e),e+=4,n.fontRevision=o.readFixed(r,e),e+=4,o.readUint(r,e),e+=4,o.readUint(r,e),e+=4,n.flags=o.readUshort(r,e),e+=2,n.unitsPerEm=o.readUshort(r,e),e+=2,n.created=o.readUint64(r,e),e+=8,n.modified=o.readUint64(r,e),e+=8,n.xMin=o.readShort(r,e),e+=2,n.yMin=o.readShort(r,e),e+=2,n.xMax=o.readShort(r,e),e+=2,n.yMax=o.readShort(r,e),e+=2,n.macStyle=o.readUshort(r,e),e+=2,n.lowestRecPPEM=o.readUshort(r,e),e+=2,n.fontDirectionHint=o.readShort(r,e),e+=2,n.indexToLocFormat=o.readShort(r,e),e+=2,n.glyphDataFormat=o.readShort(r,e),e+=2,n},t.hhea={},t.hhea.parse=function(r,e,a){var o=t._bin,n={};return o.readFixed(r,e),e+=4,n.ascender=o.readShort(r,e),e+=2,n.descender=o.readShort(r,e),e+=2,n.lineGap=o.readShort(r,e),e+=2,n.advanceWidthMax=o.readUshort(r,e),e+=2,n.minLeftSideBearing=o.readShort(r,e),e+=2,n.minRightSideBearing=o.readShort(r,e),e+=2,n.xMaxExtent=o.readShort(r,e),e+=2,n.caretSlopeRise=o.readShort(r,e),e+=2,n.caretSlopeRun=o.readShort(r,e),e+=2,n.caretOffset=o.readShort(r,e),e+=2,e+=8,n.metricDataFormat=o.readShort(r,e),e+=2,n.numberOfHMetrics=o.readUshort(r,e),e+=2,n},t.hmtx={},t.hmtx.parse=function(r,e,a,o){for(var n=t._bin,i={aWidth:[],lsBearing:[]},s=0,u=0,f=0;f<o.maxp.numGlyphs;f++)f<o.hhea.numberOfHMetrics&&(s=n.readUshort(r,e),e+=2,u=n.readShort(r,e),e+=2),i.aWidth.push(s),i.lsBearing.push(u);return i},t.kern={},t.kern.parse=function(r,e,a,o){var n=t._bin,i=n.readUshort(r,e);if(e+=2,i==1)return t.kern.parseV1(r,e-2,a,o);var s=n.readUshort(r,e);e+=2;for(var u={glyph1:[],rval:[]},f=0;f<s;f++){e+=2,a=n.readUshort(r,e),e+=2;var d=n.readUshort(r,e);e+=2;var g=d>>>8;if((g&=15)!=0)throw"unknown kern table format: "+g;e=t.kern.readFormat0(r,e,u)}return u},t.kern.parseV1=function(r,e,a,o){var n=t._bin;n.readFixed(r,e),e+=4;var i=n.readUint(r,e);e+=4;for(var s={glyph1:[],rval:[]},u=0;u<i;u++){n.readUint(r,e),e+=4;var f=n.readUshort(r,e);e+=2,n.readUshort(r,e),e+=2;var d=f>>>8;if((d&=15)!=0)throw"unknown kern table format: "+d;e=t.kern.readFormat0(r,e,s)}return s},t.kern.readFormat0=function(r,e,a){var o=t._bin,n=-1,i=o.readUshort(r,e);e+=2,o.readUshort(r,e),e+=2,o.readUshort(r,e),e+=2,o.readUshort(r,e),e+=2;for(var s=0;s<i;s++){var u=o.readUshort(r,e);e+=2;var f=o.readUshort(r,e);e+=2;var d=o.readShort(r,e);e+=2,u!=n&&(a.glyph1.push(u),a.rval.push({glyph2:[],vals:[]}));var g=a.rval[a.rval.length-1];g.glyph2.push(f),g.vals.push(d),n=u}return e},t.loca={},t.loca.parse=function(r,e,a,o){var n=t._bin,i=[],s=o.head.indexToLocFormat,u=o.maxp.numGlyphs+1;if(s==0)for(var f=0;f<u;f++)i.push(n.readUshort(r,e+(f<<1))<<1);if(s==1)for(f=0;f<u;f++)i.push(n.readUint(r,e+(f<<2)));return i},t.maxp={},t.maxp.parse=function(r,e,a){var o=t._bin,n={},i=o.readUint(r,e);return e+=4,n.numGlyphs=o.readUshort(r,e),e+=2,i==65536&&(n.maxPoints=o.readUshort(r,e),e+=2,n.maxContours=o.readUshort(r,e),e+=2,n.maxCompositePoints=o.readUshort(r,e),e+=2,n.maxCompositeContours=o.readUshort(r,e),e+=2,n.maxZones=o.readUshort(r,e),e+=2,n.maxTwilightPoints=o.readUshort(r,e),e+=2,n.maxStorage=o.readUshort(r,e),e+=2,n.maxFunctionDefs=o.readUshort(r,e),e+=2,n.maxInstructionDefs=o.readUshort(r,e),e+=2,n.maxStackElements=o.readUshort(r,e),e+=2,n.maxSizeOfInstructions=o.readUshort(r,e),e+=2,n.maxComponentElements=o.readUshort(r,e),e+=2,n.maxComponentDepth=o.readUshort(r,e),e+=2),n},t.name={},t.name.parse=function(r,e,a){var o=t._bin,n={};o.readUshort(r,e),e+=2;var i=o.readUshort(r,e);e+=2,o.readUshort(r,e);for(var s,u=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],f=e+=2,d=0;d<i;d++){var g=o.readUshort(r,e);e+=2;var m=o.readUshort(r,e);e+=2;var p=o.readUshort(r,e);e+=2;var U=o.readUshort(r,e);e+=2;var F=o.readUshort(r,e);e+=2;var w=o.readUshort(r,e);e+=2;var y,k=u[U],I=f+12*i+w;if(g==0)y=o.readUnicode(r,I,F/2);else if(g==3&&m==0)y=o.readUnicode(r,I,F/2);else if(m==0)y=o.readASCII(r,I,F);else if(m==1)y=o.readUnicode(r,I,F/2);else if(m==3)y=o.readUnicode(r,I,F/2);else{if(g!=1)throw"unknown encoding "+m+", platformID: "+g;y=o.readASCII(r,I,F),console.debug("reading unknown MAC encoding "+m+" as ASCII")}var x="p"+g+","+p.toString(16);n[x]==null&&(n[x]={}),n[x][k!==void 0?k:U]=y,n[x]._lang=p}for(var _ in n)if(n[_].postScriptName!=null&&n[_]._lang==1033)return n[_];for(var _ in n)if(n[_].postScriptName!=null&&n[_]._lang==0)return n[_];for(var _ in n)if(n[_].postScriptName!=null&&n[_]._lang==3084)return n[_];for(var _ in n)if(n[_].postScriptName!=null)return n[_];for(var _ in n){s=_;break}return console.debug("returning name table with languageID "+n[s]._lang),n[s]},t["OS/2"]={},t["OS/2"].parse=function(r,e,a){var o=t._bin.readUshort(r,e);e+=2;var n={};if(o==0)t["OS/2"].version0(r,e,n);else if(o==1)t["OS/2"].version1(r,e,n);else if(o==2||o==3||o==4)t["OS/2"].version2(r,e,n);else{if(o!=5)throw"unknown OS/2 table version: "+o;t["OS/2"].version5(r,e,n)}return n},t["OS/2"].version0=function(r,e,a){var o=t._bin;return a.xAvgCharWidth=o.readShort(r,e),e+=2,a.usWeightClass=o.readUshort(r,e),e+=2,a.usWidthClass=o.readUshort(r,e),e+=2,a.fsType=o.readUshort(r,e),e+=2,a.ySubscriptXSize=o.readShort(r,e),e+=2,a.ySubscriptYSize=o.readShort(r,e),e+=2,a.ySubscriptXOffset=o.readShort(r,e),e+=2,a.ySubscriptYOffset=o.readShort(r,e),e+=2,a.ySuperscriptXSize=o.readShort(r,e),e+=2,a.ySuperscriptYSize=o.readShort(r,e),e+=2,a.ySuperscriptXOffset=o.readShort(r,e),e+=2,a.ySuperscriptYOffset=o.readShort(r,e),e+=2,a.yStrikeoutSize=o.readShort(r,e),e+=2,a.yStrikeoutPosition=o.readShort(r,e),e+=2,a.sFamilyClass=o.readShort(r,e),e+=2,a.panose=o.readBytes(r,e,10),e+=10,a.ulUnicodeRange1=o.readUint(r,e),e+=4,a.ulUnicodeRange2=o.readUint(r,e),e+=4,a.ulUnicodeRange3=o.readUint(r,e),e+=4,a.ulUnicodeRange4=o.readUint(r,e),e+=4,a.achVendID=[o.readInt8(r,e),o.readInt8(r,e+1),o.readInt8(r,e+2),o.readInt8(r,e+3)],e+=4,a.fsSelection=o.readUshort(r,e),e+=2,a.usFirstCharIndex=o.readUshort(r,e),e+=2,a.usLastCharIndex=o.readUshort(r,e),e+=2,a.sTypoAscender=o.readShort(r,e),e+=2,a.sTypoDescender=o.readShort(r,e),e+=2,a.sTypoLineGap=o.readShort(r,e),e+=2,a.usWinAscent=o.readUshort(r,e),e+=2,a.usWinDescent=o.readUshort(r,e),e+=2},t["OS/2"].version1=function(r,e,a){var o=t._bin;return e=t["OS/2"].version0(r,e,a),a.ulCodePageRange1=o.readUint(r,e),e+=4,a.ulCodePageRange2=o.readUint(r,e),e+=4},t["OS/2"].version2=function(r,e,a){var o=t._bin;return e=t["OS/2"].version1(r,e,a),a.sxHeight=o.readShort(r,e),e+=2,a.sCapHeight=o.readShort(r,e),e+=2,a.usDefault=o.readUshort(r,e),e+=2,a.usBreak=o.readUshort(r,e),e+=2,a.usMaxContext=o.readUshort(r,e),e+=2},t["OS/2"].version5=function(r,e,a){var o=t._bin;return e=t["OS/2"].version2(r,e,a),a.usLowerOpticalPointSize=o.readUshort(r,e),e+=2,a.usUpperOpticalPointSize=o.readUshort(r,e),e+=2},t.post={},t.post.parse=function(r,e,a){var o=t._bin,n={};return n.version=o.readFixed(r,e),e+=4,n.italicAngle=o.readFixed(r,e),e+=4,n.underlinePosition=o.readShort(r,e),e+=2,n.underlineThickness=o.readShort(r,e),e+=2,n},t==null&&(t={}),t.U==null&&(t.U={}),t.U.codeToGlyph=function(r,e){var a=r.cmap,o=-1;if(a.p0e4!=null?o=a.p0e4:a.p3e1!=null?o=a.p3e1:a.p1e0!=null?o=a.p1e0:a.p0e3!=null&&(o=a.p0e3),o==-1)throw"no familiar platform and encoding!";var n=a.tables[o];if(n.format==0)return e>=n.map.length?0:n.map[e];if(n.format==4){for(var i=-1,s=0;s<n.endCount.length;s++)if(e<=n.endCount[s]){i=s;break}return i==-1||n.startCount[i]>e?0:65535&(n.idRangeOffset[i]!=0?n.glyphIdArray[e-n.startCount[i]+(n.idRangeOffset[i]>>1)-(n.idRangeOffset.length-i)]:e+n.idDelta[i])}if(n.format==12){if(e>n.groups[n.groups.length-1][1])return 0;for(s=0;s<n.groups.length;s++){var u=n.groups[s];if(u[0]<=e&&e<=u[1])return u[2]+(e-u[0])}return 0}throw"unknown cmap table format "+n.format},t.U.glyphToPath=function(r,e){var a={cmds:[],crds:[]};if(r.SVG&&r.SVG.entries[e]){var o=r.SVG.entries[e];return o==null?a:(typeof o=="string"&&(o=t.SVG.toPath(o),r.SVG.entries[e]=o),o)}if(r.CFF){var n={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:r.CFF.Private?r.CFF.Private.defaultWidthX:0,open:!1},i=r.CFF,s=r.CFF.Private;if(i.ROS){for(var u=0;i.FDSelect[u+2]<=e;)u+=2;s=i.FDArray[i.FDSelect[u+1]].Private}t.U._drawCFF(r.CFF.CharStrings[e],n,i,s,a)}else r.glyf&&t.U._drawGlyf(e,r,a);return a},t.U._drawGlyf=function(r,e,a){var o=e.glyf[r];o==null&&(o=e.glyf[r]=t.glyf._parseGlyf(e,r)),o!=null&&(o.noc>-1?t.U._simpleGlyph(o,a):t.U._compoGlyph(o,e,a))},t.U._simpleGlyph=function(r,e){for(var a=0;a<r.noc;a++){for(var o=a==0?0:r.endPts[a-1]+1,n=r.endPts[a],i=o;i<=n;i++){var s=i==o?n:i-1,u=i==n?o:i+1,f=1&r.flags[i],d=1&r.flags[s],g=1&r.flags[u],m=r.xs[i],p=r.ys[i];if(i==o)if(f){if(!d){t.U.P.moveTo(e,m,p);continue}t.U.P.moveTo(e,r.xs[s],r.ys[s])}else d?t.U.P.moveTo(e,r.xs[s],r.ys[s]):t.U.P.moveTo(e,(r.xs[s]+m)/2,(r.ys[s]+p)/2);f?d&&t.U.P.lineTo(e,m,p):g?t.U.P.qcurveTo(e,m,p,r.xs[u],r.ys[u]):t.U.P.qcurveTo(e,m,p,(m+r.xs[u])/2,(p+r.ys[u])/2)}t.U.P.closePath(e)}},t.U._compoGlyph=function(r,e,a){for(var o=0;o<r.parts.length;o++){var n={cmds:[],crds:[]},i=r.parts[o];t.U._drawGlyf(i.glyphIndex,e,n);for(var s=i.m,u=0;u<n.crds.length;u+=2){var f=n.crds[u],d=n.crds[u+1];a.crds.push(f*s.a+d*s.b+s.tx),a.crds.push(f*s.c+d*s.d+s.ty)}for(u=0;u<n.cmds.length;u++)a.cmds.push(n.cmds[u])}},t.U._getGlyphClass=function(r,e){var a=t._lctf.getInterval(e,r);return a==-1?0:e[a+2]},t.U._applySubs=function(r,e,a,o){for(var n=r.length-e-1,i=0;i<a.tabs.length;i++)if(a.tabs[i]!=null){var s,u=a.tabs[i];if(!u.coverage||(s=t._lctf.coverageIndex(u.coverage,r[e]))!=-1){if(a.ltype==1)r[e],u.fmt==1?r[e]=r[e]+u.delta:r[e]=u.newg[s];else if(a.ltype==4)for(var f=u.vals[s],d=0;d<f.length;d++){var g=f[d],m=g.chain.length;if(!(m>n)){for(var p=!0,U=0,F=0;F<m;F++){for(;r[e+U+(1+F)]==-1;)U++;g.chain[F]!=r[e+U+(1+F)]&&(p=!1)}if(p){for(r[e]=g.nglyph,F=0;F<m+U;F++)r[e+F+1]=-1;break}}}else if(a.ltype==5&&u.fmt==2)for(var w=t._lctf.getInterval(u.cDef,r[e]),y=u.cDef[w+2],k=u.scset[y],I=0;I<k.length;I++){var x=k[I],_=x.input;if(!(_.length>n)){for(p=!0,F=0;F<_.length;F++){var O=t._lctf.getInterval(u.cDef,r[e+1+F]);if(w==-1&&u.cDef[O+2]!=_[F]){p=!1;break}}if(p){var M=x.substLookupRecords;for(d=0;d<M.length;d+=2)M[d],M[d+1]}}}else if(a.ltype==6&&u.fmt==3){if(!t.U._glsCovered(r,u.backCvg,e-u.backCvg.length)||!t.U._glsCovered(r,u.inptCvg,e)||!t.U._glsCovered(r,u.ahedCvg,e+u.inptCvg.length))continue;var X=u.lookupRec;for(I=0;I<X.length;I+=2){w=X[I];var b=o[X[I+1]];t.U._applySubs(r,e+w,b,o)}}}}},t.U._glsCovered=function(r,e,a){for(var o=0;o<e.length;o++)if(t._lctf.coverageIndex(e[o],r[a+o])==-1)return!1;return!0},t.U.glyphsToPath=function(r,e,a){for(var o={cmds:[],crds:[]},n=0,i=0;i<e.length;i++){var s=e[i];if(s!=-1){for(var u=i<e.length-1&&e[i+1]!=-1?e[i+1]:0,f=t.U.glyphToPath(r,s),d=0;d<f.crds.length;d+=2)o.crds.push(f.crds[d]+n),o.crds.push(f.crds[d+1]);for(a&&o.cmds.push(a),d=0;d<f.cmds.length;d++)o.cmds.push(f.cmds[d]);a&&o.cmds.push("X"),n+=r.hmtx.aWidth[s],i<e.length-1&&(n+=t.U.getPairAdjustment(r,s,u))}}return o},t.U.P={},t.U.P.moveTo=function(r,e,a){r.cmds.push("M"),r.crds.push(e,a)},t.U.P.lineTo=function(r,e,a){r.cmds.push("L"),r.crds.push(e,a)},t.U.P.curveTo=function(r,e,a,o,n,i,s){r.cmds.push("C"),r.crds.push(e,a,o,n,i,s)},t.U.P.qcurveTo=function(r,e,a,o,n){r.cmds.push("Q"),r.crds.push(e,a,o,n)},t.U.P.closePath=function(r){r.cmds.push("Z")},t.U._drawCFF=function(r,e,a,o,n){for(var i=e.stack,s=e.nStems,u=e.haveWidth,f=e.width,d=e.open,g=0,m=e.x,p=e.y,U=0,F=0,w=0,y=0,k=0,I=0,x=0,_=0,O=0,M=0,X={val:0,size:0};g<r.length;){t.CFF.getCharString(r,g,X);var b=X.val;if(g+=X.size,b=="o1"||b=="o18")i.length%2!=0&&!u&&(f=i.shift()+o.nominalWidthX),s+=i.length>>1,i.length=0,u=!0;else if(b=="o3"||b=="o23")i.length%2!=0&&!u&&(f=i.shift()+o.nominalWidthX),s+=i.length>>1,i.length=0,u=!0;else if(b=="o4")i.length>1&&!u&&(f=i.shift()+o.nominalWidthX,u=!0),d&&t.U.P.closePath(n),p+=i.pop(),t.U.P.moveTo(n,m,p),d=!0;else if(b=="o5")for(;i.length>0;)m+=i.shift(),p+=i.shift(),t.U.P.lineTo(n,m,p);else if(b=="o6"||b=="o7")for(var E=i.length,A=b=="o6",j=0;j<E;j++){var W=i.shift();A?m+=W:p+=W,A=!A,t.U.P.lineTo(n,m,p)}else if(b=="o8"||b=="o24"){E=i.length;for(var ne=0;ne+6<=E;)U=m+i.shift(),F=p+i.shift(),w=U+i.shift(),y=F+i.shift(),m=w+i.shift(),p=y+i.shift(),t.U.P.curveTo(n,U,F,w,y,m,p),ne+=6;b=="o24"&&(m+=i.shift(),p+=i.shift(),t.U.P.lineTo(n,m,p))}else{if(b=="o11")break;if(b=="o1234"||b=="o1235"||b=="o1236"||b=="o1237")b=="o1234"&&(F=p,w=(U=m+i.shift())+i.shift(),M=y=F+i.shift(),I=y,_=p,m=(x=(k=(O=w+i.shift())+i.shift())+i.shift())+i.shift(),t.U.P.curveTo(n,U,F,w,y,O,M),t.U.P.curveTo(n,k,I,x,_,m,p)),b=="o1235"&&(U=m+i.shift(),F=p+i.shift(),w=U+i.shift(),y=F+i.shift(),O=w+i.shift(),M=y+i.shift(),k=O+i.shift(),I=M+i.shift(),x=k+i.shift(),_=I+i.shift(),m=x+i.shift(),p=_+i.shift(),i.shift(),t.U.P.curveTo(n,U,F,w,y,O,M),t.U.P.curveTo(n,k,I,x,_,m,p)),b=="o1236"&&(U=m+i.shift(),F=p+i.shift(),w=U+i.shift(),M=y=F+i.shift(),I=y,x=(k=(O=w+i.shift())+i.shift())+i.shift(),_=I+i.shift(),m=x+i.shift(),t.U.P.curveTo(n,U,F,w,y,O,M),t.U.P.curveTo(n,k,I,x,_,m,p)),b=="o1237"&&(U=m+i.shift(),F=p+i.shift(),w=U+i.shift(),y=F+i.shift(),O=w+i.shift(),M=y+i.shift(),k=O+i.shift(),I=M+i.shift(),x=k+i.shift(),_=I+i.shift(),Math.abs(x-m)>Math.abs(_-p)?m=x+i.shift():p=_+i.shift(),t.U.P.curveTo(n,U,F,w,y,O,M),t.U.P.curveTo(n,k,I,x,_,m,p));else if(b=="o14"){if(i.length>0&&!u&&(f=i.shift()+a.nominalWidthX,u=!0),i.length==4){var se=i.shift(),P=i.shift(),B=i.shift(),v=i.shift(),S=t.CFF.glyphBySE(a,B),C=t.CFF.glyphBySE(a,v);t.U._drawCFF(a.CharStrings[S],e,a,o,n),e.x=se,e.y=P,t.U._drawCFF(a.CharStrings[C],e,a,o,n)}d&&(t.U.P.closePath(n),d=!1)}else if(b=="o19"||b=="o20")i.length%2!=0&&!u&&(f=i.shift()+o.nominalWidthX),s+=i.length>>1,i.length=0,u=!0,g+=s+7>>3;else if(b=="o21")i.length>2&&!u&&(f=i.shift()+o.nominalWidthX,u=!0),p+=i.pop(),m+=i.pop(),d&&t.U.P.closePath(n),t.U.P.moveTo(n,m,p),d=!0;else if(b=="o22")i.length>1&&!u&&(f=i.shift()+o.nominalWidthX,u=!0),m+=i.pop(),d&&t.U.P.closePath(n),t.U.P.moveTo(n,m,p),d=!0;else if(b=="o25"){for(;i.length>6;)m+=i.shift(),p+=i.shift(),t.U.P.lineTo(n,m,p);U=m+i.shift(),F=p+i.shift(),w=U+i.shift(),y=F+i.shift(),m=w+i.shift(),p=y+i.shift(),t.U.P.curveTo(n,U,F,w,y,m,p)}else if(b=="o26")for(i.length%2&&(m+=i.shift());i.length>0;)U=m,F=p+i.shift(),m=w=U+i.shift(),p=(y=F+i.shift())+i.shift(),t.U.P.curveTo(n,U,F,w,y,m,p);else if(b=="o27")for(i.length%2&&(p+=i.shift());i.length>0;)F=p,w=(U=m+i.shift())+i.shift(),y=F+i.shift(),m=w+i.shift(),p=y,t.U.P.curveTo(n,U,F,w,y,m,p);else if(b=="o10"||b=="o29"){var D=b=="o10"?o:a;if(i.length==0)console.debug("error: empty stack");else{var T=i.pop(),z=D.Subrs[T+D.Bias];e.x=m,e.y=p,e.nStems=s,e.haveWidth=u,e.width=f,e.open=d,t.U._drawCFF(z,e,a,o,n),m=e.x,p=e.y,s=e.nStems,u=e.haveWidth,f=e.width,d=e.open}}else if(b=="o30"||b=="o31"){var R=i.length,L=(ne=0,b=="o31");for(ne+=R-(E=-3&R);ne<E;)L?(F=p,w=(U=m+i.shift())+i.shift(),p=(y=F+i.shift())+i.shift(),E-ne==5?(m=w+i.shift(),ne++):m=w,L=!1):(U=m,F=p+i.shift(),w=U+i.shift(),y=F+i.shift(),m=w+i.shift(),E-ne==5?(p=y+i.shift(),ne++):p=y,L=!0),t.U.P.curveTo(n,U,F,w,y,m,p),ne+=4}else{if((b+"").charAt(0)=="o")throw console.debug("Unknown operation: "+b,r),b;i.push(b)}}}e.x=m,e.y=p,e.nStems=s,e.haveWidth=u,e.width=f,e.open=d};var h=t,c={Typr:h};return l.Typr=h,l.default=c,Object.defineProperty(l,"__esModule",{value:!0}),l})({}).Typr}function _a(){return(function(l){var t=Uint8Array,h=Uint16Array,c=Uint32Array,r=new t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),e=new t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),a=new t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),o=function(b,E){for(var A=new h(31),j=0;j<31;++j)A[j]=E+=1<<b[j-1];var W=new c(A[30]);for(j=1;j<30;++j)for(var ne=A[j];ne<A[j+1];++ne)W[ne]=ne-A[j]<<5|j;return[A,W]},n=o(r,2),i=n[0],s=n[1];i[28]=258,s[258]=28;for(var u=o(e,0)[0],f=new h(32768),d=0;d<32768;++d){var g=(43690&d)>>>1|(21845&d)<<1;g=(61680&(g=(52428&g)>>>2|(13107&g)<<2))>>>4|(3855&g)<<4,f[d]=((65280&g)>>>8|(255&g)<<8)>>>1}var m=function(b,E,A){for(var j=b.length,W=0,ne=new h(E);W<j;++W)++ne[b[W]-1];var se,P=new h(E);for(W=0;W<E;++W)P[W]=P[W-1]+ne[W-1]<<1;{se=new h(1<<E);var B=15-E;for(W=0;W<j;++W)if(b[W])for(var v=W<<4|b[W],S=E-b[W],C=P[b[W]-1]++<<S,D=C|(1<<S)-1;C<=D;++C)se[f[C]>>>B]=v}return se},p=new t(288);for(d=0;d<144;++d)p[d]=8;for(d=144;d<256;++d)p[d]=9;for(d=256;d<280;++d)p[d]=7;for(d=280;d<288;++d)p[d]=8;var U=new t(32);for(d=0;d<32;++d)U[d]=5;var F=m(p,9),w=m(U,5),y=function(b){for(var E=b[0],A=1;A<b.length;++A)b[A]>E&&(E=b[A]);return E},k=function(b,E,A){var j=E/8|0;return(b[j]|b[j+1]<<8)>>(7&E)&A},I=function(b,E){var A=E/8|0;return(b[A]|b[A+1]<<8|b[A+2]<<16)>>(7&E)},x=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],_=function(b,E,A){var j=new Error(E||x[b]);if(j.code=b,Error.captureStackTrace&&Error.captureStackTrace(j,_),!A)throw j;return j},O=function(b,E,A){var j=b.length;if(!j||A&&!A.l&&j<5)return E||new t(0);var W=!E||A,ne=!A||A.i;A||(A={}),E||(E=new t(3*j));var se,P=function(me){var _e=E.length;if(me>_e){var Ue=new t(Math.max(2*_e,me));Ue.set(E),E=Ue}},B=A.f||0,v=A.p||0,S=A.b||0,C=A.l,D=A.d,T=A.m,z=A.n,R=8*j;do{if(!C){A.f=B=k(b,v,1);var L=k(b,v+1,3);if(v+=3,!L){var q=b[(Y=((se=v)/8|0)+(7&se&&1)+4)-4]|b[Y-3]<<8,$=Y+q;if($>j){ne&&_(0);break}W&&P(S+q),E.set(b.subarray(Y,$),S),A.b=S+=q,A.p=v=8*$;continue}if(L==1)C=F,D=w,T=9,z=5;else if(L==2){var H=k(b,v,31)+257,N=k(b,v+10,15)+4,fe=H+k(b,v+5,31)+1;v+=14;for(var he=new t(fe),te=new t(19),J=0;J<N;++J)te[a[J]]=k(b,v+3*J,7);v+=3*N;var le=y(te),V=(1<<le)-1,ie=m(te,le);for(J=0;J<fe;){var Y,G=ie[k(b,v,V)];if(v+=15&G,(Y=G>>>4)<16)he[J++]=Y;else{var pe=0,Z=0;for(Y==16?(Z=3+k(b,v,3),v+=2,pe=he[J-1]):Y==17?(Z=3+k(b,v,7),v+=3):Y==18&&(Z=11+k(b,v,127),v+=7);Z--;)he[J++]=pe}}var ee=he.subarray(0,H),Q=he.subarray(H);T=y(ee),z=y(Q),C=m(ee,T),D=m(Q,z)}else _(1);if(v>R){ne&&_(0);break}}W&&P(S+131072);for(var re=(1<<T)-1,ge=(1<<z)-1,K=v;;K=v){var de=(pe=C[I(b,v)&re])>>>4;if((v+=15&pe)>R){ne&&_(0);break}if(pe||_(2),de<256)E[S++]=de;else{if(de==256){K=v,C=null;break}var ke=de-254;if(de>264){var Te=r[J=de-257];ke=k(b,v,(1<<Te)-1)+i[J],v+=Te}var ye=D[I(b,v)&ge],De=ye>>>4;if(ye||_(3),v+=15&ye,Q=u[De],De>3&&(Te=e[De],Q+=I(b,v)&(1<<Te)-1,v+=Te),v>R){ne&&_(0);break}W&&P(S+131072);for(var oe=S+ke;S<oe;S+=4)E[S]=E[S-Q],E[S+1]=E[S+1-Q],E[S+2]=E[S+2-Q],E[S+3]=E[S+3-Q];S=oe}}A.l=C,A.p=K,A.b=S,C&&(B=1,A.m=T,A.d=D,A.n=z)}while(!B);return S==E.length?E:(function(me,_e,Ue){(Ue==null||Ue>me.length)&&(Ue=me.length);var Re=new(me instanceof h?h:me instanceof c?c:t)(Ue-_e);return Re.set(me.subarray(_e,Ue)),Re})(E,0,S)},M=new t(0),X=typeof TextDecoder<"u"&&new TextDecoder;try{X.decode(M,{stream:!0})}catch{}return l.convert_streams=function(b){var E=new DataView(b),A=0;function j(){var H=E.getUint16(A);return A+=2,H}function W(){var H=E.getUint32(A);return A+=4,H}function ne(H){q.setUint16($,H),$+=2}function se(H){q.setUint32($,H),$+=4}for(var P={signature:W(),flavor:W(),length:W(),numTables:j(),reserved:j(),totalSfntSize:W(),majorVersion:j(),minorVersion:j(),metaOffset:W(),metaLength:W(),metaOrigLength:W(),privOffset:W(),privLength:W()},B=0;Math.pow(2,B)<=P.numTables;)B++;B--;for(var v=16*Math.pow(2,B),S=16*P.numTables-v,C=12,D=[],T=0;T<P.numTables;T++)D.push({tag:W(),offset:W(),compLength:W(),origLength:W(),origChecksum:W()}),C+=16;var z,R=new Uint8Array(12+16*D.length+D.reduce(function(H,N){return H+N.origLength+4},0)),L=R.buffer,q=new DataView(L),$=0;return se(P.flavor),ne(P.numTables),ne(v),ne(B),ne(S),D.forEach(function(H){se(H.tag),se(H.origChecksum),se(C),se(H.origLength),H.outOffset=C,(C+=H.origLength)%4!=0&&(C+=4-C%4)}),D.forEach(function(H){var N,fe=b.slice(H.offset,H.offset+H.compLength);if(H.compLength!=H.origLength){var he=new Uint8Array(H.origLength);N=new Uint8Array(fe,2),O(N,he)}else he=new Uint8Array(fe);R.set(he,H.outOffset);var te=0;(C=H.outOffset+H.origLength)%4!=0&&(te=4-C%4),R.set(new Uint8Array(te).buffer,H.outOffset+H.origLength),z=C+te}),L.slice(0,z)},Object.defineProperty(l,"__esModule",{value:!0}),l})({}).convert_streams}function Ca(l,t){let h={M:2,L:2,Q:4,C:6,Z:0},c={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},r=1,e=2,a=4,o=8,n=16,i=32,s;function u(x){if(!s){let _={R:e,L:r,D:a,C:n,U:i,T:o};s=new Map;for(let O in c){let M=0;c[O].split(",").forEach(X=>{let[b,E]=X.split("+");b=parseInt(b,36),E=E?parseInt(E,36):0,s.set(M+=b,_[O]);for(let A=E;A--;)s.set(++M,_[O])})}}return s.get(x)||i}let f=1,d=2,g=3,m=4,p=[null,"isol","init","fina","medi"];function U(x){let _=new Uint8Array(x.length),O=i,M=f,X=-1;for(let b=0;b<x.length;b++){let E=x.codePointAt(b),A=u(E)|0,j=f;A&o||(O&(r|a|n)?A&(e|a|n)?(j=g,(M===f||M===g)&&_[X]++):A&(r|i)&&(M===d||M===m)&&_[X]--:O&(e|i)&&(M===d||M===m)&&_[X]--,M=_[b]=j,O=A,X=b,E>65535&&b++)}return _}function F(x,_){let O=[];for(let X=0;X<_.length;X++){let b=_.codePointAt(X);b>65535&&X++,O.push(l.U.codeToGlyph(x,b))}let M=x.GSUB;if(M){let{lookupList:X,featureList:b}=M,E,A=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,j=[];b.forEach(W=>{if(A.test(W.tag))for(let ne=0;ne<W.tab.length;ne++){if(j[W.tab[ne]])continue;j[W.tab[ne]]=!0;let se=X[W.tab[ne]],P=/^(isol|init|fina|medi)$/.test(W.tag);P&&!E&&(E=U(_));for(let B=0;B<O.length;B++)(!E||!P||p[E[B]]===W.tag)&&l.U._applySubs(O,B,se,X)}})}return O}function w(x,_){let O=new Int16Array(_.length*3),M=0;for(;M<_.length;M++){let A=_[M];if(A===-1)continue;O[M*3+2]=x.hmtx.aWidth[A];let j=x.GPOS;if(j){let W=j.lookupList;for(let ne=0;ne<W.length;ne++){let se=W[ne];for(let P=0;P<se.tabs.length;P++){let B=se.tabs[P];if(se.ltype===1){if(l._lctf.coverageIndex(B.coverage,A)!==-1&&B.pos){E(B.pos,M);break}}else if(se.ltype===2){let v=null,S=X();if(S!==-1){let C=l._lctf.coverageIndex(B.coverage,_[S]);if(C!==-1){if(B.fmt===1){let D=B.pairsets[C];for(let T=0;T<D.length;T++)D[T].gid2===A&&(v=D[T])}else if(B.fmt===2){let D=l.U._getGlyphClass(_[S],B.classDef1),T=l.U._getGlyphClass(A,B.classDef2);v=B.matrix[D][T]}if(v){v.val1&&E(v.val1,S),v.val2&&E(v.val2,M);break}}}}else if(se.ltype===4){let v=l._lctf.coverageIndex(B.markCoverage,A);if(v!==-1){let S=X(b),C=S===-1?-1:l._lctf.coverageIndex(B.baseCoverage,_[S]);if(C!==-1){let D=B.markArray[v],T=B.baseArray[C][D.markClass];O[M*3]=T.x-D.x+O[S*3]-O[S*3+2],O[M*3+1]=T.y-D.y+O[S*3+1];break}}}else if(se.ltype===6){let v=l._lctf.coverageIndex(B.mark1Coverage,A);if(v!==-1){let S=X();if(S!==-1){let C=_[S];if(y(x,C)===3){let D=l._lctf.coverageIndex(B.mark2Coverage,C);if(D!==-1){let T=B.mark1Array[v],z=B.mark2Array[D][T.markClass];O[M*3]=z.x-T.x+O[S*3]-O[S*3+2],O[M*3+1]=z.y-T.y+O[S*3+1];break}}}}}}}}else if(x.kern&&!x.cff){let W=X();if(W!==-1){let ne=x.kern.glyph1.indexOf(_[W]);if(ne!==-1){let se=x.kern.rval[ne].glyph2.indexOf(A);se!==-1&&(O[W*3+2]+=x.kern.rval[ne].vals[se])}}}}return O;function X(A){for(let j=M-1;j>=0;j--)if(_[j]!==-1&&(!A||A(_[j])))return j;return-1}function b(A){return y(x,A)===1}function E(A,j){for(let W=0;W<3;W++)O[j*3+W]+=A[W]||0}}function y(x,_){let O=x.GDEF&&x.GDEF.glyphClassDef;return O?l.U._getGlyphClass(_,O):0}function k(...x){for(let _=0;_<x.length;_++)if(typeof x[_]=="number")return x[_]}function I(x){let _=Object.create(null),O=x["OS/2"],M=x.hhea,X=x.head.unitsPerEm,b=k(O&&O.sTypoAscender,M&&M.ascender,X),E={unitsPerEm:X,ascender:b,descender:k(O&&O.sTypoDescender,M&&M.descender,0),capHeight:k(O&&O.sCapHeight,b),xHeight:k(O&&O.sxHeight,b),lineGap:k(O&&O.sTypoLineGap,M&&M.lineGap),supportsCodePoint(A){return l.U.codeToGlyph(x,A)>0},forEachGlyph(A,j,W,ne){let se=0,P=1/E.unitsPerEm*j,B=F(x,A),v=0,S=w(x,B);return B.forEach((C,D)=>{if(C!==-1){let T=_[C];if(!T){let{cmds:z,crds:R}=l.U.glyphToPath(x,C),L="",q=0;for(let he=0,te=z.length;he<te;he++){let J=h[z[he]];L+=z[he];for(let le=1;le<=J;le++)L+=(le>1?",":"")+R[q++]}let $,H,N,fe;if(R.length){$=H=1/0,N=fe=-1/0;for(let he=0,te=R.length;he<te;he+=2){let J=R[he],le=R[he+1];J<$&&($=J),le<H&&(H=le),J>N&&(N=J),le>fe&&(fe=le)}}else $=N=H=fe=0;T=_[C]={index:C,advanceWidth:x.hmtx.aWidth[C],xMin:$,yMin:H,xMax:N,yMax:fe,path:L}}ne.call(null,T,se+S[D*3]*P,S[D*3+1]*P,v),se+=S[D*3+2]*P,W&&(se+=W*j)}v+=A.codePointAt(v)>65535?2:1}),se}};return E}return function(x){let _=new Uint8Array(x,0,4),O=l._bin.readASCII(_,0,4);if(O==="wOFF")x=t(x);else if(O==="wOF2")throw new Error("woff2 fonts not supported");return I(l.parse(x)[0])}}var Fa=dr({name:"Typr Font Parser",dependencies:[wa,_a,Ca],init(l,t,h){let c=l(),r=t();return h(c,r)}});function Da(){return(function(l){var t=function(){this.buckets=new Map};t.prototype.add=function(w){var y=w>>5;this.buckets.set(y,(this.buckets.get(y)||0)|1<<(31&w))},t.prototype.has=function(w){var y=this.buckets.get(w>>5);return y!==void 0&&(y&1<<(31&w))!=0},t.prototype.serialize=function(){var w=[];return this.buckets.forEach(function(y,k){w.push((+k).toString(36)+":"+y.toString(36))}),w.join(",")},t.prototype.deserialize=function(w){var y=this;this.buckets.clear(),w.split(",").forEach(function(k){var I=k.split(":");y.buckets.set(parseInt(I[0],36),parseInt(I[1],36))})};var h=Math.pow(2,8),c=h-1,r=~c;function e(w){var y=(function(I){return I&r})(w).toString(16),k=(function(I){return(I&r)+h-1})(w).toString(16);return"codepoint-index/plane"+(w>>16)+"/"+y+"-"+k+".json"}function a(w,y){var k=w&c,I=y.codePointAt(k/6|0);return((I=(I||48)-48)&1<<k%6)!=0}function o(w,y){var k;(k=w,k.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map(function(I){return I.split("-").map(function(x){return parseInt(x.trim(),16)})})).forEach(function(I){var x=I[0],_=I[1];_===void 0&&(_=x),y(x,_)})}function n(w,y){o(w,function(k,I){for(var x=k;x<=I;x++)y(x)})}var i={},s={},u=new WeakMap,f="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function d(w){var y=u.get(w);return y||(y=new t,n(w.ranges,function(k){return y.add(k)}),u.set(w,y)),y}var g,m=new Map;function p(w,y,k){return w[y]?y:w[k]?k:(function(I){for(var x in I)return x})(w)}function U(w,y){var k=y;if(!w.includes(k)){k=1/0;for(var I=0;I<w.length;I++)Math.abs(w[I]-y)<Math.abs(k-y)&&(k=w[I])}return k}function F(w){return g||(g=new Set,n("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",function(y){g.add(y)})),g.has(w)}return l.CodePointSet=t,l.clearCache=function(){i={},s={}},l.getFontsForString=function(w,y){y===void 0&&(y={});var k,I=y.lang;I===void 0&&(I=new RegExp("\\p{Script=Hangul}","u").test(k=w)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(k)?"ja":"en");var x=y.category;x===void 0&&(x="sans-serif");var _=y.style;_===void 0&&(_="normal");var O=y.weight;O===void 0&&(O=400);var M=(y.dataUrl||f).replace(/\/$/g,""),X=new Map,b=new Uint8Array(w.length),E={},A={},j=new Array(w.length),W=new Map,ne=!1;function se(v){var S=m.get(v);return S||(S=fetch(M+"/"+v).then(function(C){if(!C.ok)throw new Error(C.statusText);return C.json().then(function(D){if(!Array.isArray(D)||D[0]!==1)throw new Error("Incorrect schema version; need 1, got "+D[0]);return D[1]})}).catch(function(C){if(M!==f)return ne||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+M+'", trying default CDN. '+C.message),ne=!0),M=f,m.delete(v),se(v);throw C}),m.set(v,S)),S}for(var P=function(v){var S=w.codePointAt(v),C=e(S);j[v]=C,i[C]||W.has(C)||W.set(C,se(C).then(function(D){i[C]=D})),S>65535&&(v++,B=v)},B=0;B<w.length;B++)P(B);return Promise.all(W.values()).then(function(){W.clear();for(var v=function(C){var D=w.codePointAt(C),T=null,z=i[j[C]],R=void 0;for(var L in z){var q=A[L];if(q===void 0&&(q=A[L]=new RegExp(L).test(I||"en")),q){for(var $ in R=L,z[L])if(a(D,z[L][$])){T=$;break}break}}if(!T){e:for(var H in z)if(H!==R){for(var N in z[H])if(a(D,z[H][N])){T=N;break e}}}T||(console.debug("No font coverage for U+"+D.toString(16)),T="latin"),j[C]=T,s[T]||W.has(T)||W.set(T,se("font-meta/"+T+".json").then(function(fe){s[T]=fe})),D>65535&&(C++,S=C)},S=0;S<w.length;S++)v(S);return Promise.all(W.values())}).then(function(){for(var v,S=null,C=0;C<w.length;C++){var D=w.codePointAt(C);if(S&&(F(D)||d(S).has(D)))b[C]=b[C-1];else{S=s[j[C]];var T=E[S.id];if(!T){var z=S.typeforms,R=p(z,x,"sans-serif"),L=p(z[R],_,"normal"),q=U((v=z[R])===null||v===void 0?void 0:v[L],O);T=E[S.id]=M+"/font-files/"+S.id+"/"+R+"."+L+"."+q+".woff"}var $=X.get(T);$==null&&($=X.size,X.set(T,$)),b[C]=$}D>65535&&(C++,b[C]=b[C-1])}return{fontUrls:Array.from(X.keys()),chars:b}})},Object.defineProperty(l,"__esModule",{value:!0}),l})({})}function Aa(l,t){let h=Object.create(null),c=Object.create(null);function r(a,o){let n=i=>{console.error("Failure loading font ".concat(a),i)};try{let i=new XMLHttpRequest;i.open("get",a,!0),i.responseType="arraybuffer",i.onload=function(){if(i.status>=400)n(new Error(i.statusText));else if(i.status>0)try{let s=l(i.response);s.src=a,o(s)}catch(s){n(s)}},i.onerror=n,i.send()}catch(i){n(i)}}function e(a,o){let n=h[a];n?o(n):c[a]?c[a].push(o):(c[a]=[o],r(a,i=>{i.src=a,h[a]=i,c[a].forEach(s=>s(i)),delete c[a]}))}return function(a,o,{lang:n,fonts:i=[],style:s="normal",weight:u="normal",unicodeFontsURL:f}={}){let d=new Uint8Array(a.length),g=[];a.length||F();let m=new Map,p=[];if(s!=="italic"&&(s="normal"),typeof u!="number"&&(u=u==="bold"?700:400),i&&!Array.isArray(i)&&(i=[i]),i=i.slice().filter(y=>!y.lang||y.lang.test(n)).reverse(),i.length){let y=0;(function k(I=0){for(let x=I,_=a.length;x<_;x++){let O=a.codePointAt(x);if(y===1&&g[d[x-1]].supportsCodePoint(O)||x>0&&/\s/.test(a[x]))d[x]=d[x-1],y===2&&(p[p.length-1][1]=x);else for(let M=d[x],X=i.length;M<=X;M++)if(M===X){let b=y===2?p[p.length-1]:p[p.length]=[x,x];b[1]=x,y=2}else{d[x]=M;let{src:b,unicodeRange:E}=i[M];if(!E||w(O,E)){let A=h[b];if(!A){e(b,()=>{k(x)});return}if(A.supportsCodePoint(O)){let j=m.get(A);typeof j!="number"&&(j=g.length,g.push(A),m.set(A,j)),d[x]=j,y=1;break}}}O>65535&&x+1<_&&(d[x+1]=d[x],x++,y===2&&(p[p.length-1][1]=x))}U()})()}else p.push([0,a.length-1]),U();function U(){if(p.length){let y=p.map(k=>a.substring(k[0],k[1]+1)).join(`
`);t.getFontsForString(y,{lang:n||void 0,style:s,weight:u,dataUrl:f}).then(({fontUrls:k,chars:I})=>{let x=g.length,_=0;p.forEach(M=>{for(let X=0,b=M[1]-M[0];X<=b;X++)d[M[0]+X]=I[_++]+x;_++});let O=0;k.forEach((M,X)=>{e(M,b=>{g[X+x]=b,++O===k.length&&F()})})})}else F()}function F(){o({chars:d,fonts:g})}function w(y,k){for(let I=0;I<k.length;I++){let[x,_=x]=k[I];if(x<=y&&y<=_)return!0}return!1}}}var Ma=dr({name:"FontResolver",dependencies:[Aa,Fa,Da],init(l,t,h){return l(t,h())}});function Ea(l,t){let h=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,c="[^\\S\\u00A0]",r=new RegExp("".concat(c,"|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]"));function e({text:d,lang:g,fonts:m,style:p,weight:U,preResolvedFonts:F,unicodeFontsURL:w},y){let k=({chars:I,fonts:x})=>{let _,O,M=[];for(let X=0;X<I.length;X++)I[X]!==O?(O=I[X],M.push(_={start:X,end:X,fontObj:x[I[X]]})):_.end=X;y(M)};F?k(F):l(d,k,{lang:g,fonts:m,style:p,weight:U,unicodeFontsURL:w})}function a({text:d="",font:g,lang:m,sdfGlyphSize:p=64,fontSize:U=400,fontWeight:F=1,fontStyle:w="normal",letterSpacing:y=0,lineHeight:k="normal",maxWidth:I=1/0,direction:x,textAlign:_="left",textIndent:O=0,whiteSpace:M="normal",overflowWrap:X="normal",anchorX:b=0,anchorY:E=0,metricsOnly:A=!1,unicodeFontsURL:j,preResolvedFonts:W=null,includeCaretPositions:ne=!1,chunkedBoundsSize:se=8192,colorRanges:P=null},B){let v=s(),S={fontLoad:0,typesetting:0};d.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),d=d.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),U=+U,y=+y,I=+I,k=k||"normal",O=+O,e({text:d,lang:m,style:w,weight:F,fonts:typeof g=="string"?[{src:g}]:g,unicodeFontsURL:j,preResolvedFonts:W},C=>{S.fontLoad=s()-v;let D=isFinite(I),T=null,z=null,R=null,L=null,q=null,$=null,H=null,N=null,fe=0,he=0,te=M!=="nowrap",J=new Map,le=s(),V=O,ie=0,Y=new u,G=[Y];C.forEach(re=>{let{fontObj:ge}=re,{ascender:K,descender:de,unitsPerEm:ke,lineGap:Te,capHeight:ye,xHeight:De}=ge,oe=J.get(ge);if(!oe){let ue=U/ke,ce=k==="normal"?(K-de+Te)*ue:k*U,Xe=(ce-(K-de)*ue)/2,xe=Math.min(ce,(K-de)*ue),be=(K+de)/2*ue+xe/2;oe={index:J.size,src:ge.src,fontObj:ge,fontSizeMult:ue,unitsPerEm:ke,ascender:K*ue,descender:de*ue,capHeight:ye*ue,xHeight:De*ue,lineHeight:ce,baseline:-Xe-K*ue,caretTop:be,caretBottom:be-xe},J.set(ge,oe)}let{fontSizeMult:me}=oe,_e=d.slice(re.start,re.end+1),Ue,Re;ge.forEachGlyph(_e,U,y,(ue,ce,Xe,xe)=>{ce+=ie,xe+=re.start,Ue=ce,Re=ue;let be=d.charAt(xe),Ae=ue.advanceWidth*me,Ce=Y.count,ve;if("isEmpty"in ue||(ue.isWhitespace=!!be&&new RegExp(c).test(be),ue.canBreakAfter=!!be&&r.test(be),ue.isEmpty=ue.xMin===ue.xMax||ue.yMin===ue.yMax||h.test(be)),!ue.isWhitespace&&!ue.isEmpty&&he++,te&&D&&!ue.isWhitespace&&ce+Ae+V>I&&Ce){if(Y.glyphAt(Ce-1).glyphObj.canBreakAfter)ve=new u,V=-ce;else for(let Ee=Ce;Ee--;)if(Ee===0&&X==="break-word"){ve=new u,V=-ce;break}else if(Y.glyphAt(Ee).glyphObj.canBreakAfter){ve=Y.splitAt(Ee+1);let Ie=ve.glyphAt(0).x;V-=Ie;for(let Fe=ve.count;Fe--;)ve.glyphAt(Fe).x-=Ie;break}ve&&(Y.isSoftWrapped=!0,Y=ve,G.push(Y),fe=I)}let Se=Y.glyphAt(Y.count);Se.glyphObj=ue,Se.x=ce+V,Se.y=Xe,Se.width=Ae,Se.charIndex=xe,Se.fontData=oe,be===`
`&&(Y=new u,G.push(Y),V=-(ce+Ae+y*U)+O)}),ie=Ue+Re.advanceWidth*me+y*U});let pe=0;G.forEach(re=>{let ge=!0;for(let K=re.count;K--;){let de=re.glyphAt(K);ge&&!de.glyphObj.isWhitespace&&(re.width=de.x+de.width,re.width>fe&&(fe=re.width),ge=!1);let{lineHeight:ke,capHeight:Te,xHeight:ye,baseline:De}=de.fontData;ke>re.lineHeight&&(re.lineHeight=ke);let oe=De-re.baseline;oe<0&&(re.baseline+=oe,re.cap+=oe,re.ex+=oe),re.cap=Math.max(re.cap,re.baseline+Te),re.ex=Math.max(re.ex,re.baseline+ye)}re.baseline-=pe,re.cap-=pe,re.ex-=pe,pe+=re.lineHeight});let Z=0,ee=0;if(b&&(typeof b=="number"?Z=-b:typeof b=="string"&&(Z=-fe*(b==="left"?0:b==="center"?.5:b==="right"?1:n(b)))),E&&(typeof E=="number"?ee=-E:typeof E=="string"&&(ee=E==="top"?0:E==="top-baseline"?-G[0].baseline:E==="top-cap"?-G[0].cap:E==="top-ex"?-G[0].ex:E==="middle"?pe/2:E==="bottom"?pe:E==="bottom-baseline"?-G[G.length-1].baseline:n(E)*pe)),!A){let re=t.getEmbeddingLevels(d,x);T=new Uint16Array(he),z=new Uint8Array(he),R=new Float32Array(he*2),L={},H=[1/0,1/0,-1/0,-1/0],N=[],ne&&($=new Float32Array(d.length*4)),P&&(q=new Uint8Array(he*3));let ge=0,K=-1,de=-1,ke,Te;if(G.forEach((ye,De)=>{let{count:oe,width:me}=ye;if(oe>0){let _e=0;for(let xe=oe;xe--&&ye.glyphAt(xe).glyphObj.isWhitespace;)_e++;let Ue=0,Re=0;if(_==="center")Ue=(fe-me)/2;else if(_==="right")Ue=fe-me;else if(_==="justify"&&ye.isSoftWrapped){let xe=0;for(let be=oe-_e;be--;)ye.glyphAt(be).glyphObj.isWhitespace&&xe++;Re=(fe-me)/xe}if(Re||Ue){let xe=0;for(let be=0;be<oe;be++){let Ae=ye.glyphAt(be),Ce=Ae.glyphObj;Ae.x+=Ue+xe,Re!==0&&Ce.isWhitespace&&be<oe-_e&&(xe+=Re,Ae.width+=Re)}}let ue=t.getReorderSegments(d,re,ye.glyphAt(0).charIndex,ye.glyphAt(ye.count-1).charIndex);for(let xe=0;xe<ue.length;xe++){let[be,Ae]=ue[xe],Ce=1/0,ve=-1/0;for(let Se=0;Se<oe;Se++)if(ye.glyphAt(Se).charIndex>=be){let Ee=Se,Ie=Se;for(;Ie<oe;Ie++){let Fe=ye.glyphAt(Ie);if(Fe.charIndex>Ae)break;Ie<oe-_e&&(Ce=Math.min(Ce,Fe.x),ve=Math.max(ve,Fe.x+Fe.width))}for(let Fe=Ee;Fe<Ie;Fe++){let Ne=ye.glyphAt(Fe);Ne.x=ve-(Ne.x+Ne.width-Ce)}break}}let ce,Xe=xe=>ce=xe;for(let xe=0;xe<oe;xe++){let be=ye.glyphAt(xe);ce=be.glyphObj;let Ae=ce.index,Ce=re.levels[be.charIndex]&1;if(Ce){let ve=t.getMirroredCharacter(d[be.charIndex]);ve&&be.fontData.fontObj.forEachGlyph(ve,0,0,Xe)}if(ne){let{charIndex:ve,fontData:Se}=be,Ee=be.x+Z,Ie=be.x+be.width+Z;$[ve*4]=Ce?Ie:Ee,$[ve*4+1]=Ce?Ee:Ie,$[ve*4+2]=ye.baseline+Se.caretBottom+ee,$[ve*4+3]=ye.baseline+Se.caretTop+ee;let Fe=ve-K;Fe>1&&i($,K,Fe),K=ve}if(P){let{charIndex:ve}=be;for(;ve>de;)de++,P.hasOwnProperty(de)&&(Te=P[de])}if(!ce.isWhitespace&&!ce.isEmpty){let ve=ge++,{fontSizeMult:Se,src:Ee,index:Ie}=be.fontData,Fe=L[Ee]||(L[Ee]={});Fe[Ae]||(Fe[Ae]={path:ce.path,pathBounds:[ce.xMin,ce.yMin,ce.xMax,ce.yMax]});let Ne=be.x+Z,Ke=be.y+ye.baseline+ee;R[ve*2]=Ne,R[ve*2+1]=Ke;let je=Ne+ce.xMin*Se,He=Ke+ce.yMin*Se,qe=Ne+ce.xMax*Se,Qe=Ke+ce.yMax*Se;je<H[0]&&(H[0]=je),He<H[1]&&(H[1]=He),qe>H[2]&&(H[2]=qe),Qe>H[3]&&(H[3]=Qe),ve%se===0&&(ke={start:ve,end:ve,rect:[1/0,1/0,-1/0,-1/0]},N.push(ke)),ke.end++;let Pe=ke.rect;if(je<Pe[0]&&(Pe[0]=je),He<Pe[1]&&(Pe[1]=He),qe>Pe[2]&&(Pe[2]=qe),Qe>Pe[3]&&(Pe[3]=Qe),T[ve]=Ae,z[ve]=Ie,P){let We=ve*3;q[We]=Te>>16&255,q[We+1]=Te>>8&255,q[We+2]=Te&255}}}}}),$){let ye=d.length-K;ye>1&&i($,K,ye)}}let Q=[];J.forEach(({index:re,src:ge,unitsPerEm:K,ascender:de,descender:ke,lineHeight:Te,capHeight:ye,xHeight:De})=>{Q[re]={src:ge,unitsPerEm:K,ascender:de,descender:ke,lineHeight:Te,capHeight:ye,xHeight:De}}),S.typesetting=s()-le,B({glyphIds:T,glyphFontIndices:z,glyphPositions:R,glyphData:L,fontData:Q,caretPositions:$,glyphColors:q,chunkedBounds:N,fontSize:U,topBaseline:ee+G[0].baseline,blockBounds:[Z,ee-pe,Z+fe,ee],visibleBounds:H,timings:S})})}function o(d,g){a(la(ua({},d),{metricsOnly:!0}),m=>{let[p,U,F,w]=m.blockBounds;g({width:F-p,height:w-U})})}function n(d){let g=d.match(/^([\d.]+)%$/),m=g?parseFloat(g[1]):NaN;return isNaN(m)?0:m/100}function i(d,g,m){let p=d[g*4],U=d[g*4+1],F=d[g*4+2],w=d[g*4+3],y=(U-p)/m;for(let k=0;k<m;k++){let I=(g+k)*4;d[I]=p+y*k,d[I+1]=p+y*(k+1),d[I+2]=F,d[I+3]=w}}function s(){return(self.performance||Date).now()}function u(){this.data=[]}let f=["glyphObj","x","y","width","charIndex","fontData"];return u.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/f.length)},glyphAt(d){let g=u.flyweight;return g.data=this.data,g.index=d,g},splitAt(d){let g=new u;return g.data=this.data.splice(d*f.length),g}},u.flyweight=f.reduce((d,g,m,p)=>(Object.defineProperty(d,g,{get(){return this.data[this.index*f.length+m]},set(U){this.data[this.index*f.length+m]=U}}),d),{data:null,index:0}),{typeset:a,measure:o}}var er=()=>(self.performance||Date).now(),Yr=Tn(),on;function Ia(l,t,h,c,r,e,a,o,n,i,s=!0){return s?Ba(l,t,h,c,r,e,a,o,n,i).then(null,u=>(on||(console.warn("WebGL SDF generation failed, falling back to JS",u),on=!0),ln(l,t,h,c,r,e,a,o,n,i))):ln(l,t,h,c,r,e,a,o,n,i)}var Hr=[],Ra=5,Tt=0;function _n(){let l=er();for(;Hr.length&&er()-l<Ra;)Hr.shift()();Tt=Hr.length?setTimeout(_n,0):0}var Ba=(...l)=>new Promise((t,h)=>{Hr.push(()=>{let c=er();try{Yr.webgl.generateIntoCanvas(...l),t({timing:er()-c})}catch(r){h(r)}}),Tt||(Tt=setTimeout(_n,0))}),Oa=4,Pa=2e3,sn={},Ga=0;function ln(l,t,h,c,r,e,a,o,n,i){let s="TroikaTextSDFGenerator_JS_"+Ga++%Oa,u=sn[s];return u||(u=sn[s]={workerModule:dr({name:s,workerId:s,dependencies:[Tn,er],init(f,d){let g=f().javascript.generate;return function(...m){let p=d();return{textureData:g(...m),timing:d()-p}}},getTransferables(f){return[f.textureData.buffer]}}),requests:0,idleTimer:null}),u.requests++,clearTimeout(u.idleTimer),u.workerModule(l,t,h,c,r,e).then(({textureData:f,timing:d})=>{let g=er(),m=new Uint8Array(f.length*4);for(let p=0;p<f.length;p++)m[p*4+i]=f[p];return Yr.webglUtils.renderImageData(a,m,o,n,l,t,1<<3-i),d+=er()-g,--u.requests===0&&(u.idleTimer=setTimeout(()=>{va(s)},Pa)),{timing:d}})}function La(l){l._warm||(Yr.webgl.isSupported(l),l._warm=!0)}var za=Yr.webglUtils.resizeWebGLCanvasWithoutClearing,$e={defaultFontURL:null,unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048,useWorker:!0},Wa=new qr,Cn=!1;function or(){return(self.performance||Date).now()}function Va(l){Cn?console.warn("configureTextBuilder called after first font request; will be ignored."):An($e,l)}var un=Object.create(null);function Fn(l,t){Cn=!0,l=An({},l);let h=or(),{defaultFontURL:c}=$e,r=[];if(c&&r.push({label:"default",src:hn(c)}),l.font&&r.push({label:"user",src:hn(l.font)}),l.font=r,l.text=""+l.text,l.sdfGlyphSize=l.sdfGlyphSize||$e.sdfGlyphSize,l.unicodeFontsURL=l.unicodeFontsURL||$e.unicodeFontsURL,l.colorRanges!=null){let f={};for(let d in l.colorRanges)if(l.colorRanges.hasOwnProperty(d)){let g=l.colorRanges[d];typeof g!="number"&&(g=Wa.set(g).getHex()),f[d]=g}l.colorRanges=f}Object.freeze(l);let{textureWidth:e,sdfExponent:a}=$e,{sdfGlyphSize:o}=l,n=e/o*4,i=un[o];if(!i){let f=document.createElement("canvas");f.width=e,f.height=o*256/n,i=un[o]={glyphCount:0,sdfGlyphSize:o,sdfCanvas:f,sdfTexture:new ea(f,void 0,void 0,void 0,Kt,Kt),contextLost:!1,glyphsByFont:new Map},i.sdfTexture.generateMipmaps=!1,Na(i)}let{sdfTexture:s,sdfCanvas:u}=i;($e.useWorker?En:Ha)(l).then(f=>{let{glyphIds:d,glyphFontIndices:g,fontData:m,glyphPositions:p,fontSize:U,timings:F}=f,w=[],y=new Float32Array(d.length*4),k=0,I=0,x=or(),_=m.map(E=>{let A=i.glyphsByFont.get(E.src);return A||i.glyphsByFont.set(E.src,A=new Map),A});d.forEach((E,A)=>{let j=g[A],{src:W,unitsPerEm:ne}=m[j],se=_[j].get(E);if(!se){let{path:C,pathBounds:D}=f.glyphData[W][E],T=Math.max(D[2]-D[0],D[3]-D[1])/o*($e.sdfMargin*o+.5),z=i.glyphCount++,R=[D[0]-T,D[1]-T,D[2]+T,D[3]+T];_[j].set(E,se={path:C,atlasIndex:z,sdfViewBox:R}),w.push(se)}let{sdfViewBox:P}=se,B=p[I++],v=p[I++],S=U/ne;y[k++]=B+P[0]*S,y[k++]=v+P[1]*S,y[k++]=B+P[2]*S,y[k++]=v+P[3]*S,d[A]=se.atlasIndex}),F.quads=(F.quads||0)+(or()-x);let O=or();F.sdf={};let M=u.height,X=Math.ceil(i.glyphCount/n),b=Math.pow(2,Math.ceil(Math.log2(X*o)));b>M&&(console.info("Increasing SDF texture size ".concat(M,"->").concat(b)),za(u,e,b),s.dispose()),Promise.all(w.map(E=>Dn(E,i,l.gpuAccelerateSDF).then(({timing:A})=>{F.sdf[E.atlasIndex]=A}))).then(()=>{w.length&&!i.contextLost&&(Mn(i),s.needsUpdate=!0),F.sdfTotal=or()-O,F.total=or()-h,t(Object.freeze({parameters:l,sdfTexture:s,sdfGlyphSize:o,sdfExponent:a,glyphBounds:y,glyphAtlasIndices:d,glyphColors:f.glyphColors,caretPositions:f.caretPositions,chunkedBounds:f.chunkedBounds,ascender:f.ascender,descender:f.descender,lineHeight:f.lineHeight,capHeight:f.capHeight,xHeight:f.xHeight,topBaseline:f.topBaseline,blockBounds:f.blockBounds,visibleBounds:f.visibleBounds,timings:f.timings}))})}),Promise.resolve().then(()=>{i.contextLost||La(u)})}function Dn({path:l,atlasIndex:t,sdfViewBox:h},{sdfGlyphSize:c,sdfCanvas:r,contextLost:e},a){if(e)return Promise.resolve({timing:-1});let{textureWidth:o,sdfExponent:n}=$e,i=Math.max(h[2]-h[0],h[3]-h[1]),s=Math.floor(t/4),u=s%(o/c)*c,f=Math.floor(s/(o/c))*c,d=t%4;return Ia(c,c,l,h,i,n,r,u,f,d,a)}function Na(l){let t=l.sdfCanvas;t.addEventListener("webglcontextlost",h=>{console.log("Context Lost",h),h.preventDefault(),l.contextLost=!0}),t.addEventListener("webglcontextrestored",h=>{console.log("Context Restored",h),l.contextLost=!1;let c=[];l.glyphsByFont.forEach(r=>{r.forEach(e=>{c.push(Dn(e,l,!0))})}),Promise.all(c).then(()=>{Mn(l),l.sdfTexture.needsUpdate=!0})})}function fn({font:l,characters:t,sdfGlyphSize:h},c){let r=Array.isArray(t)?t.join(`
`):""+t;Fn({font:l,sdfGlyphSize:h,text:r},c)}function An(l,t){for(let h in t)t.hasOwnProperty(h)&&(l[h]=t[h]);return l}var Vr;function hn(l){return Vr||(Vr=typeof document>"u"?{}:document.createElement("a")),Vr.href=l,Vr.href}function Mn(l){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");let{sdfCanvas:t,sdfTexture:h}=l,{width:c,height:r}=t,e=l.sdfCanvas.getContext("webgl"),a=h.image.data;(!a||a.length!==c*r*4)&&(a=new Uint8Array(c*r*4),h.image={width:c,height:r,data:a},h.flipY=!1,h.isDataTexture=!0),e.readPixels(0,0,c,r,e.RGBA,e.UNSIGNED_BYTE,a)}}var ja=dr({name:"Typesetter",dependencies:[Ea,Ma,ma],init(l,t,h){return l(t,h())}}),En=dr({name:"Typesetter",dependencies:[ja],init(l){return function(t){return new Promise(h=>{l.typeset(t,h)})}},getTransferables(l){let t=[];for(let h in l)l[h]&&l[h].buffer&&t.push(l[h].buffer);return t}}),Ha=En.onMainThread,dn={};function Xa(l){let t=dn[l];return t||(t=dn[l]=new Ct(1,1,l,l).translate(.5,.5,0)),t}var Xr="aTroikaGlyphBounds",_r="aTroikaGlyphIndex",qa="aTroikaGlyphColor",Ya=class extends Kn{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Qn,this.boundingBox=new bn}computeBoundingSphere(){}computeBoundingBox(){}set detail(l){if(l!==this._detail){this._detail=l,(typeof l!="number"||l<1)&&(l=1);let t=Xa(l);["position","normal","uv"].forEach(h=>{this.attributes[h]=t.attributes[h].clone()}),this.setIndex(t.getIndex().clone())}}get detail(){return this._detail}set curveRadius(l){l!==this._curveRadius&&(this._curveRadius=l,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(l,t,h,c,r){this.updateAttributeData(Xr,l,4),this.updateAttributeData(_r,t,1),this.updateAttributeData(qa,r,3),this._blockBounds=h,this._chunkedBounds=c,this.instanceCount=t.length,this._updateBounds()}_updateBounds(){let l=this._blockBounds;if(l){let{curveRadius:t,boundingBox:h}=this;if(t){let{PI:c,floor:r,min:e,max:a,sin:o,cos:n}=Math,i=c/2,s=c*2,u=Math.abs(t),f=l[0]/u,d=l[2]/u,g=r((f+i)/s)!==r((d+i)/s)?-u:e(o(f)*u,o(d)*u),m=r((f-i)/s)!==r((d-i)/s)?u:a(o(f)*u,o(d)*u),p=r((f+c)/s)!==r((d+c)/s)?u*2:a(u-n(f)*u,u-n(d)*u);h.min.set(g,l[1],t<0?-p:0),h.max.set(m,l[3],t<0?0:p)}else h.min.set(l[0],l[1],0),h.max.set(l[2],l[3],0);h.getBoundingSphere(this.boundingSphere)}}applyClipRect(l){let t=this.getAttribute(_r).count,h=this._chunkedBounds;if(h)for(let c=h.length;c--;){t=h[c].end;let r=h[c].rect;if(r[1]<l.w&&r[3]>l.y&&r[0]<l.z&&r[2]>l.x)break}this.instanceCount=t}updateAttributeData(l,t,h){let c=this.getAttribute(l);t?c&&c.array.length===t.length?(c.array.set(t),c.needsUpdate=!0):(this.setAttribute(l,new Jn(t,h)),delete this._maxInstanceCount,this.dispose()):c&&this.deleteAttribute(l)}},Za=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaEdgeOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,$a=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaEdgeOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaEdgeOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,Ka=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaEdgeOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,Qa=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaEdgeOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function In(l){let t=Fr(l,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Cr},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new Qt(0,0,0,0)},uTroikaClipRect:{value:new Qt(0,0,0,0)},uTroikaEdgeOffset:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Cr},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new qr},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new ra},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:Za,vertexTransform:$a,fragmentDefs:Ka,fragmentColorTransform:Qa,customRewriter({vertexShader:h,fragmentShader:c}){let r=/\buniform\s+vec3\s+diffuse\b/;return r.test(c)&&(c=c.replace(r,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),r.test(h)||(h=h.replace(wn,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:h,fragmentShader:c}}});return t.transparent=!0,t.forceSinglePass=!0,Object.defineProperties(t,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),t}var Ft=new Zn({color:16777215,side:ta,transparent:!0}),cn=8421504,vn=new xn,Nr=new hr,mt=new hr,Ur=[],Ja=new hr,yt="+x+y";function pn(l){return Array.isArray(l)?l[0]:l}var Rn=()=>{let l=new _t(new Ct(1,1),Ft);return Rn=()=>l,l},Bn=()=>{let l=new _t(new Ct(1,1,32,1),Ft);return Bn=()=>l,l},ei={type:"syncstart"},ri={type:"synccomplete"},On=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],ti=On.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail"),ur=class extends _t{constructor(){let l=new Ya;super(l,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=cn,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=yt,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(l){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(l):(this._isSyncing=!0,this.dispatchEvent(ei),Fn({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},t=>{this._isSyncing=!1,this._textRenderInfo=t,this.geometry.updateGlyphs(t.glyphBounds,t.glyphAtlasIndices,t.blockBounds,t.chunkedBounds,t.glyphColors);let h=this._queuedSyncs;h&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{h.forEach(c=>c&&c())})),this.dispatchEvent(ri),l&&l()})))}onBeforeRender(l,t,h,c,r,e){this.sync(),r.isTroikaTextMaterial&&this._prepareForRender(r)}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}createDerivedMaterial(l){return In(l)}get material(){let l=this._derivedMaterial,t=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=Ft.clone());if((!l||!l.isDerivedFrom(t))&&(l=this._derivedMaterial=this.createDerivedMaterial(t),t.addEventListener("dispose",function h(){t.removeEventListener("dispose",h),l.dispose()})),this.hasOutline()){let h=l._outlineMtl;return h||(h=l._outlineMtl=Object.create(l,{id:{value:l.id+.1}}),h.isTextOutlineMaterial=!0,h.depthWrite=!1,h.map=null,l.addEventListener("dispose",function c(){l.removeEventListener("dispose",c),h.dispose()})),[h,l]}else return l}set material(l){l&&l.isTroikaTextMaterial?(this._derivedMaterial=l,this._baseMaterial=l.baseMaterial):this._baseMaterial=l}hasOutline(){return!!(this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY)}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(l){this.geometry.detail=l}get curveRadius(){return this.geometry.curveRadius}set curveRadius(l){this.geometry.curveRadius=l}get customDepthMaterial(){return pn(this.material).getDepthMaterial()}set customDepthMaterial(l){}get customDistanceMaterial(){return pn(this.material).getDistanceMaterial()}set customDistanceMaterial(l){}_prepareForRender(l){let t=l.isTextOutlineMaterial,h=l.uniforms,c=this.textRenderInfo;if(c){let{sdfTexture:a,blockBounds:o}=c;h.uTroikaSDFTexture.value=a,h.uTroikaSDFTextureSize.value.set(a.image.width,a.image.height),h.uTroikaSDFGlyphSize.value=c.sdfGlyphSize,h.uTroikaSDFExponent.value=c.sdfExponent,h.uTroikaTotalBounds.value.fromArray(o),h.uTroikaUseGlyphColors.value=!t&&!!c.glyphColors;let n=0,i=0,s=0,u,f,d,g=0,m=0;if(t){let{outlineWidth:U,outlineOffsetX:F,outlineOffsetY:w,outlineBlur:y,outlineOpacity:k}=this;n=this._parsePercent(U)||0,i=Math.max(0,this._parsePercent(y)||0),u=k,g=this._parsePercent(F)||0,m=this._parsePercent(w)||0}else s=Math.max(0,this._parsePercent(this.strokeWidth)||0),s&&(d=this.strokeColor,h.uTroikaStrokeColor.value.set(d??cn),f=this.strokeOpacity,f==null&&(f=1)),u=this.fillOpacity;h.uTroikaEdgeOffset.value=n,h.uTroikaPositionOffset.value.set(g,m),h.uTroikaBlurRadius.value=i,h.uTroikaStrokeWidth.value=s,h.uTroikaStrokeOpacity.value=f,h.uTroikaFillOpacity.value=u??1,h.uTroikaCurveRadius.value=this.curveRadius||0;let p=this.clipRect;if(p&&Array.isArray(p)&&p.length===4)h.uTroikaClipRect.value.fromArray(p);else{let U=(this.fontSize||.1)*100;h.uTroikaClipRect.value.set(o[0]-U,o[1]-U,o[2]+U,o[3]+U)}this.geometry.applyClipRect(h.uTroikaClipRect.value)}h.uTroikaSDFDebug.value=!!this.debugSDF,l.polygonOffset=!!this.depthOffset,l.polygonOffsetFactor=l.polygonOffsetUnits=this.depthOffset||0;let r=t?this.outlineColor||0:this.color;if(r==null)delete l.color;else{let a=l.hasOwnProperty("color")?l.color:l.color=new qr;(r!==a._input||typeof r=="object")&&a.set(a._input=r)}let e=this.orientation||yt;if(e!==l._orientation){let a=h.uTroikaOrient.value;e=e.replace(/[^-+xyz]/g,"");let o=e!==yt&&e.match(/^([-+])([xyz])([-+])([xyz])$/);if(o){let[,n,i,s,u]=o;Nr.set(0,0,0)[i]=n==="-"?1:-1,mt.set(0,0,0)[u]=s==="-"?-1:1,vn.lookAt(Ja,Nr.cross(mt),mt),a.setFromMatrix4(vn)}else a.identity();l._orientation=e}}_parsePercent(l){if(typeof l=="string"){let t=l.match(/^(-?[\d.]+)%$/),h=t?parseFloat(t[1]):NaN;l=(isNaN(h)?0:h/100)*this.fontSize}return l}localPositionToTextCoords(l,t=new Cr){t.copy(l);let h=this.curveRadius;return h&&(t.x=Math.atan2(l.x,Math.abs(h)-Math.abs(l.z))*Math.abs(h)),t}worldPositionToTextCoords(l,t=new Cr){return Nr.copy(l),this.localPositionToTextCoords(this.worldToLocal(Nr),t)}raycast(l,t){let{textRenderInfo:h,curveRadius:c}=this;if(h){let r=h.blockBounds,e=c?Bn():Rn(),a=e.geometry,{position:o,uv:n}=a.attributes;for(let i=0;i<n.count;i++){let s=r[0]+n.getX(i)*(r[2]-r[0]),u=r[1]+n.getY(i)*(r[3]-r[1]),f=0;c&&(f=c-Math.cos(s/c)*c,s=Math.sin(s/c)*c),o.setXYZ(i,s,u,f)}a.boundingSphere=this.geometry.boundingSphere,a.boundingBox=this.geometry.boundingBox,e.matrixWorld=this.matrixWorld,e.material.side=this.material.side,Ur.length=0,e.raycast(l,Ur);for(let i=0;i<Ur.length;i++)Ur[i].object=this,t.push(Ur[i])}}copy(l){let t=this.geometry;return super.copy(l),this.geometry=t,ti.forEach(h=>{this[h]=l[h]}),this}clone(){return new this.constructor().copy(this)}};On.forEach(l=>{let t="_private_"+l;Object.defineProperty(ur.prototype,l,{get(){return this[t]},set(h){h!==this[t]&&(this[t]=h,this._needsSync=!0)}})});var ni={type:"syncstart"},ai={type:"synccomplete"},lr="aTroikaTextBatchMemberIndex",wt=32,gn=new bn,mn=new qr,vi=class Pn extends ur{constructor(){super(),this._members=new Map,this._dataTextures={},this._onMemberSynced=t=>{this._members.get(t.target).dirty=!0}}add(...t){for(let h=0;h<t.length;h++)t[h]instanceof ur?this.addText(t[h]):super.add(t[h]);return this}remove(...t){for(let h=0;h<t.length;h++)t[h]instanceof ur?this.removeText(t[h]):super.remove(t[h]);return this}addText(t){this._members.has(t)||(this._members.set(t,{index:-1,glyphCount:-1,dirty:!0}),t.addEventListener("synccomplete",this._onMemberSynced))}removeText(t){this._needsRepack=!0,t.removeEventListener("synccomplete",this._onMemberSynced),this._members.delete(t)}createDerivedMaterial(t){return ii(t)}updateMatrixWorld(t){super.updateMatrixWorld(t),this.updateBounds()}updateBounds(){let t=this.geometry.boundingBox.makeEmpty();this._members.forEach((h,c)=>{c.matrixAutoUpdate&&c.updateMatrix(),gn.copy(c.geometry.boundingBox).applyMatrix4(c.matrix),t.union(gn)}),t.getBoundingSphere(this.geometry.boundingSphere)}hasOutline(){for(let t of this._members.keys())if(t.hasOutline())return!0;return!1}_prepareForRender(t){let h=t.isTextOutlineMaterial;t.uniforms.uTroikaIsOutline.value=h;let c=this._dataTextures[h?"outline":"main"],r=Math.pow(2,Math.ceil(Math.log2(this._members.size*wt)));if(!c||r!==c.image.data.length){c&&c.dispose();let o=Math.min(r/4,1024);c=this._dataTextures[h?"outline":"main"]=new Hn(new Float32Array(r),o,r/4/o,Xn,qn)}let e=c.image.data,a=(o,n)=>{n!==e[o]&&(e[o]=n,c.needsUpdate=!0)};this._members.forEach(({index:o,dirty:n},i)=>{if(o>-1){let s=o*wt,u=i.matrix.elements;for(let x=0;x<16;x++)a(s+x,u[x]);i._prepareForRender(t);let{uTroikaTotalBounds:f,uTroikaClipRect:d,uTroikaPositionOffset:g,uTroikaEdgeOffset:m,uTroikaBlurRadius:p,uTroikaStrokeWidth:U,uTroikaStrokeColor:F,uTroikaStrokeOpacity:w,uTroikaFillOpacity:y,uTroikaCurveRadius:k}=t.uniforms;for(let x=0;x<4;x++)a(s+16+x,f.value.getComponent(x));for(let x=0;x<4;x++)a(s+20+x,d.value.getComponent(x));let I=h?i.outlineColor||0:i.color;I==null&&(I=this.color),I==null&&(I=this.material.color),I==null&&(I=16777215),a(s+24,mn.set(I).getHex()),a(s+25,y.value),a(s+26,k.value),h?(a(s+28,g.value.x),a(s+29,g.value.y),a(s+30,m.value),a(s+31,p.value)):(a(s+28,U.value),a(s+29,mn.set(F.value).getHex()),a(s+30,w.value))}}),t.setMatrixTexture(c),super._prepareForRender(t)}sync(t){let h=this._needsRepack?[]:null;this._needsRepack=!1,this._members.forEach((c,r)=>{(c.dirty||r._needsSync)&&(c.dirty=!1,(h||(h=[])).push(new Promise(e=>{r._needsSync?r.sync(e):e()})))}),h&&(this.dispatchEvent(ni),Promise.all(h).then(()=>{let{geometry:c}=this,r=c.attributes,e=r[lr]&&r[lr].array||new Uint16Array(0),a=r[_r]&&r[_r].array||new Float32Array(0),o=r[Xr]&&r[Xr].array||new Float32Array(0),n=0;this._members.forEach((u,{textRenderInfo:f})=>{f&&(n+=f.glyphAtlasIndices.length,this._textRenderInfo=f)}),n!==e.length&&(e=bt(e,n),a=bt(a,n),o=bt(o,n*4));let i=0,s=0;this._members.forEach((u,{textRenderInfo:f})=>{if(f){let d=f.glyphAtlasIndices.length;e.fill(i,s,s+d),a.set(f.glyphAtlasIndices,s,s+d),o.set(f.glyphBounds,s*4,(s+d)*4),s+=d,u.index=i++}}),c.updateAttributeData(lr,e,1),c.getAttribute(lr).setUsage(Yn),c.updateAttributeData(_r,a,1),c.updateAttributeData(Xr,o,4),this.updateBounds(),this.dispatchEvent(ai),t&&t()}))}copy(t){return t instanceof Pn&&(super.copy(t),this._members.forEach((h,c)=>this.removeText(c)),t._members.forEach((h,c)=>this.addText(c))),this}dispose(){super.dispose(),Object.values(this._dataTextures).forEach(t=>t.dispose())}};function bt(l,t){let h=new l.constructor(t);return h.set(l.subarray(0,t)),h}function ii(l){let t="uTroikaMatricesTexture",h="uTroikaMatricesTextureSize",c=Fr(l,{chained:!0,uniforms:{[h]:{value:new Cr},[t]:{value:null}},vertexDefs:`
      uniform highp sampler2D `.concat(t,`;
      uniform vec2 `).concat(h,`;
      attribute float `).concat(lr,`;

      vec4 troikaBatchTexel(float offset) {
        offset += `).concat(lr," * ").concat(wt.toFixed(1),` / 4.0;
        float w = `).concat(h,`.x;
        vec2 uv = (vec2(mod(offset, w), floor(offset / w)) + 0.5) / `).concat(h,`;
        return texture2D(`).concat(t,`, uv);
      }
    `),vertexTransform:`
      mat4 matrix = mat4(
        troikaBatchTexel(0.0),
        troikaBatchTexel(1.0),
        troikaBatchTexel(2.0),
        troikaBatchTexel(3.0)
      );
      position.xyz = (matrix * vec4(position, 1.0)).xyz;
    `});return c=In(c),c=Fr(c,{chained:!0,uniforms:{uTroikaIsOutline:{value:!1}},customRewriter(r){return["uTroikaTotalBounds","uTroikaClipRect","uTroikaPositionOffset","uTroikaEdgeOffset","uTroikaBlurRadius","uTroikaStrokeWidth","uTroikaStrokeColor","uTroikaStrokeOpacity","uTroikaFillOpacity","uTroikaCurveRadius","diffuse"].forEach(e=>{r=oi(r,e)}),r},vertexDefs:`
      uniform bool uTroikaIsOutline;
      vec3 troikaFloatToColor(float v) {
        return mod(floor(vec3(v / 65536.0, v / 256.0, v)), 256.0) / 256.0;
      }
    `,vertexTransform:`
      uTroikaTotalBounds = troikaBatchTexel(4.0);
      uTroikaClipRect = troikaBatchTexel(5.0);
      
      vec4 data = troikaBatchTexel(6.0);
      diffuse = troikaFloatToColor(data.x);
      uTroikaFillOpacity = data.y;
      uTroikaCurveRadius = data.z;
      
      data = troikaBatchTexel(7.0);
      if (uTroikaIsOutline) {
        if (data == vec4(0.0)) { // degenerate if zero outline
          position = vec3(0.0);
        } else {
          uTroikaPositionOffset = data.xy;
          uTroikaEdgeOffset = data.z;
          uTroikaBlurRadius = data.w;
        }
      } else {
        uTroikaStrokeWidth = data.x;
        uTroikaStrokeColor = troikaFloatToColor(data.y);
        uTroikaStrokeOpacity = data.z;
      }
    `}),c.setMatrixTexture=r=>{c.uniforms[t].value=r,c.uniforms[h].value.set(r.image.width,r.image.height)},c}function oi({vertexShader:l,fragmentShader:t},h,c=h){let r=new RegExp("uniform\\s+(bool|float|vec[234]|mat[34])\\s+".concat(h,"\\b")),e,a=!1;t=t.replace(r,(n,i)=>(a=!0,"varying ".concat(e=i," ").concat(c)));let o=!1;return l=l.replace(r,(n,i)=>(o=!0,"".concat(a?"varying":""," ").concat(e=i," ").concat(c))),o||(l="".concat(a?"varying":""," ").concat(e," ").concat(c,`;
`).concat(l)),{vertexShader:l,fragmentShader:t}}rr();var yn="abcdefghijklmnopqrstuvwxyz";function si(l){return new Promise((t,h)=>{l?typeof l=="string"?fn({font:l,characters:yn},()=>{t(l)}):h(new Error("bad fontUrl ".concat(l))):kn(()=>import("./roboto-regular-ERMR6E6W-Bi3WZmYt.js"),[]).then(c=>{fn({font:c.default,characters:yn},()=>{t(c.default)})})})}var xt=.1,li=new hr;function ui(l,t,h,c){return t<=0||h<=0?Promise.reject("incoorect dimension [".concat(t,", ").concat(h,"]")):new Promise((r,e)=>{l.sync(a);function a(){if(!l.geometry.boundingBox)return;let{x:o,y:n}=l.geometry.boundingBox.getSize(li);if(n>h||o>t){if(l.fontSize===xt)return e("cannot find suitable font size for ".concat(l.text,". MaxSize: [").concat(t,", ").concat(h,"],  Current size: [").concat(o,", ").concat(n,"]. min font size").concat(xt,"."));l.fontSize=Math.max(xt,l.fontSize-c),l.sync(a)}else return r({size:[o,n]})}})}function pi(l){return new Promise(t=>{l.sync(()=>{t()})})}async function Gn(){return(await kn(async()=>{const{default:l}=await import("./roboto-regular-ERMR6E6W-Bi3WZmYt.js");return{default:l}},[])).default}function gi({useWorker:l=!0}){Va({useWorker:l})}var St=new xn,sr=new hr,fi=new hr(0,0,1);async function mi(l,t,h,c){var r,e,a,o,n,i,s,u,f,d,g,m;let p=t.feature.properties,U=new ur;t.textMesh=U,U.text=p.text,U.anchorX="center",U.anchorY="middle",U.textAlign=(r=p.align)!=null?r:"center",U.color=(e=p.color)!=null?e:"black",U.fontSize=p.fontSize||20;let F=(a=h.font)!=null?a:we.font;F?U.font=F:fr?U.font=await fr:U.font=await Gn(),U.outlineOpacity=(o=h.outlineOpacity)!=null?o:we.outlineOpacity,U.outlineColor=(n=h.outlineColor)!=null?n:we.outlineColor,U.outlineOffsetY=(i=h.outlineOffsetY)!=null?i:we.outlineOffsetY,U.outlineOffsetX=(s=h.outlineOffsetX)!=null?s:we.outlineOffsetX,U.outlineWidth=(u=h.outlineWidth)!=null?u:we.outlineWidth,U.outlineBlur=(f=h.outlineBlur)!=null?f:we.outlineBlur,U.strokeWidth=(d=h.strokeWidth)!=null?d:we.strokeWidth,U.strokeColor=(g=h.strokeColor)!=null?g:we.strokeColor,U.strokeOpacity=(m=h.strokeOpacity)!=null?m:we.strokeOpacity;let w=c(t.feature.geometry.coordinates);return U.position.copy(w),U.position.z=p.verticalOffset,U.rotation.z=Sn.degToRad(-p.rotation),U.userData={entityId:l.toString(),rotationZ:-p.rotation},{text:U}}async function yi(l,t,h,c){var r,e,a,o,n,i,s,u,f,d,g,m,p,U,F;let w=t.feature.properties,{textArea:y}=w;if(!y)throw new Error("textArea is required");let k=(r=h.margin)!=null?r:we.margin,[I,x,_,O]=Array.isArray(k)?k:[k,k,k,k],M=new ur;M.text=w.content;let X=y.maxHeight-I-_,b=y.maxWidth-O-x;M.fontSize=Math.min(X,(e=h.fontSize)!=null?e:we.fontSize),M.color=(a=h.color)!=null?a:we.color,M.maxWidth=(o=h.maxWidth)!=null?o:b,M.anchorX="center",M.anchorY="middle",M.textAlign="center";let E=(n=h.font)!=null?n:we.font;E?M.font=E:fr?M.font=await fr:M.font=await Gn(),M.outlineOpacity=(i=h.outlineOpacity)!=null?i:we.outlineOpacity,M.outlineColor=(s=h.outlineColor)!=null?s:we.outlineColor,M.outlineOffsetY=(u=h.outlineOffsetY)!=null?u:we.outlineOffsetY,M.outlineOffsetX=(f=h.outlineOffsetX)!=null?f:we.outlineOffsetX,M.outlineWidth=(d=h.outlineWidth)!=null?d:we.outlineWidth,M.outlineBlur=(g=h.outlineBlur)!=null?g:we.outlineBlur,M.strokeWidth=(m=h.strokeWidth)!=null?m:we.strokeWidth,M.strokeColor=(p=h.strokeColor)!=null?p:we.strokeColor,M.strokeOpacity=(U=h.strokeOpacity)!=null?U:we.strokeOpacity;let A=c(y.position,sr);M.position.copy(A);let j=$n(Math.PI/2-Sn.degToRad(y.rotation));M.rotation.z=j,M.userData={entityId:l.toString(),rotationZ:j};let W;try{W=(await ui(M,b,X,M.fontSize*.2)).size}catch(ne){throw(F=M.dispose)==null||F.call(M),new Error("Cannot fit text to area: entityId: ".concat(t.polygonEntityId," ").concat(ne))}if(W)return St.identity(),sr.set(0,0,1),St.makeRotationAxis(fi,j),sr.set(y.align==="near"?O+W[0]/2:y.maxWidth/2,0,0),sr.applyMatrix4(St),M.position.x-=sr.x,M.position.y-=sr.y,t.textMesh=M,{text:M}}var fr;function bi(l){return fr=si(l),fr}export{vi as BatchedText,ur as Text,gi as configureTroikaTextBuilder,yi as createTroikaTextArea,mi as createTroikaTextPoint,fr as fontPreloadLoadPromise,bi as preloadFont,pi as syncText};
