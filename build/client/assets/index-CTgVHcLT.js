const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/text3d-643VYZAG-COLF9LO1.js","assets/chunk-UIGDSWPH-74DChMva.js","assets/index-Boai_r5o.js","assets/internal-LMJ6JIND-DZyG3Ttv.js","assets/GLTFExporter-LWJJKW2X-D4VfamO9.js","assets/GLTFLoader-EQV4GOIS-CJ5c0SNG.js","assets/inspector-IL7LET64-CJpBHuVl.js"])))=>i.map(i=>d[i]);
import{a as nt,R as np,C as lne,p as IB}from"./chunk-UIGDSWPH-74DChMva.js";import{a as une}from"./index-Boai_r5o.js";const cne="modulepreload",hne=function(t){return"/"+t},CB={},N1=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){let l=function(u){return Promise.all(u.map(c=>Promise.resolve(c).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),s=o?.nonce||o?.getAttribute("nonce");i=l(r.map(u=>{if(u=hne(u),u in CB)return;CB[u]=!0;const c=u.endsWith(".css"),h=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${h}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":cne,c||(d.as="script"),d.crossOrigin="",d.href=u,s&&d.setAttribute("nonce",s),document.head.appendChild(d),c)return new Promise((p,m)=>{d.addEventListener("load",p),d.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(o){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return i.then(o=>{for(const s of o||[])s.status==="rejected"&&a(s.reason);return e().catch(a)})};var dne=Object.create,bA=Object.defineProperty,pne=Object.defineProperties,fne=Object.getOwnPropertyDescriptor,mne=Object.getOwnPropertyDescriptors,gne=Object.getOwnPropertyNames,Qw=Object.getOwnPropertySymbols,yne=Object.getPrototypeOf,oP=Object.prototype.hasOwnProperty,k9=Object.prototype.propertyIsEnumerable,kb=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),sP=t=>{throw TypeError(t)},NI=(t,e,r)=>e in t?bA(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ae=(t,e)=>{for(var r in e||(e={}))oP.call(e,r)&&NI(t,r,e[r]);if(Qw)for(var r of Qw(e))k9.call(e,r)&&NI(t,r,e[r]);return t},lt=(t,e)=>pne(t,mne(e)),O9=t=>typeof t=="symbol"?t:t+"",yu=(t,e)=>{var r={};for(var n in t)oP.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&Qw)for(var n of Qw(t))e.indexOf(n)<0&&k9.call(t,n)&&(r[n]=t[n]);return r},vne=(t,e)=>()=>(t&&(e=t(t=0)),e),Ir=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),So=(t,e)=>{for(var r in e)bA(t,r,{get:e[r],enumerable:!0})},_ne=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of gne(e))!oP.call(t,i)&&i!==r&&bA(t,i,{get:()=>e[i],enumerable:!(n=fne(e,i))||n.enumerable});return t},Zt=(t,e,r)=>(r=t!=null?dne(yne(t)):{},_ne(e||!t||!t.__esModule?bA(r,"default",{value:t,enumerable:!0}):r,t)),S=(t,e,r)=>NI(t,typeof e!="symbol"?e+"":e,r),lP=(t,e,r)=>e.has(t)||sP("Cannot "+r),f=(t,e,r)=>(lP(t,e,"read from private field"),r?r.call(t):e.get(t)),K=(t,e,r)=>e.has(t)?sP("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),ne=(t,e,r,n)=>(lP(t,e,"write to private field"),e.set(t,r),r),ot=(t,e,r)=>(lP(t,e,"access private method"),r),B9=function(t,e){this[0]=t,this[1]=e},xne=(t,e,r)=>{var n=(o,s,l,u)=>{try{var c=r[o](s),h=(s=c.value)instanceof B9,d=c.done;Promise.resolve(h?s[0]:s).then(p=>h?n(o==="return"?o:"next",s[1]?{done:p.done,value:p.value}:p,l,u):l({value:p,done:d})).catch(p=>n("throw",p,l,u))}catch(p){u(p)}},i=o=>a[o]=s=>new Promise((l,u)=>n(o,s,l,u)),a={};return r=r.apply(t,e),a[kb("asyncIterator")]=()=>a,i("next"),i("throw"),i("return"),a},ut=t=>{var e=t[kb("asyncIterator")],r=!1,n,i={};return e==null?(e=t[kb("iterator")](),n=a=>i[a]=o=>e[a](o)):(e=e.call(t),n=a=>i[a]=o=>{if(r){if(r=!1,a==="throw")throw o;return o}return r=!0,{done:!1,value:new B9(new Promise(s=>{var l=e[a](o);l instanceof Object||sP("Object expected"),s(l)}),1)}}),i[kb("iterator")]=()=>i,n("next"),"throw"in e?n("throw"):i.throw=a=>{throw a},"return"in e&&n("return"),i},Oi,C=vne(()=>{Oi={env:{NODE_ENV:"production",npm_package_version:"6.3.1"}}});C();var uP="173",ES={LEFT:0,MIDDLE:1,RIGHT:2},bne=0,MB=1,wne=2,z9=1,Ane=2,uc=3,_s=0,xa=1,po=2,Qh=0,qm=1,TB=2,PB=3,DB=4,Sne=5,ip=100,Ene=101,Ine=102,Cne=103,Mne=104,Tne=200,Pne=201,Dne=202,kne=203,$I=204,UI=205,One=206,Bne=207,zne=208,Fne=209,Rne=210,Lne=211,Nne=212,$ne=213,Une=214,jI=0,VI=1,GI=2,mg=3,ZI=4,WI=5,HI=6,XI=7,cP=0,jne=1,Vne=2,ed=0,Gne=1,Zne=2,Wne=3,Hne=4,Xne=5,qne=6,Yne=7,kB="attached",Jne="detached",F9=300,gg=301,yg=302,e4=303,qI=304,wA=306,Ml=1e3,hp=1001,YI=1002,gs=1003,Kne=1004,$_=1005,vu=1006,IS=1007,dp=1008,Fl=1009,R9=1010,L9=1011,Yv=1012,hP=1013,id=1014,ps=1015,$1=1016,dP=1017,pP=1018,vg=1020,N9=35902,$9=1021,U9=1022,Ha=1023,j9=1024,V9=1025,Ym=1026,_g=1027,fP=1028,AA=1029,G9=1030,mP=1031,gP=1033,Ob=33776,Bb=33777,zb=33778,Fb=33779,JI=35840,KI=35841,QI=35842,eC=35843,tC=36196,rC=37492,nC=37496,iC=37808,aC=37809,oC=37810,sC=37811,lC=37812,uC=37813,cC=37814,hC=37815,dC=37816,pC=37817,fC=37818,mC=37819,gC=37820,yC=37821,Rb=36492,vC=36494,_C=36495,Z9=36283,xC=36284,bC=36285,wC=36286,t4=2300,AC=2301,CS=2302,OB=2400,BB=2401,zB=2402,Qne=2500,eie=0,tie=1,FB=2,rie=3200,nie=3201,yP=0,iie=1,Zh="",Za="srgb",Op="srgb-linear",r4="linear",En="srgb",bc=7680,Jm=7681,MS=34055,TS=34056,W9=517,n4=519,aie=512,oie=513,sie=514,H9=515,lie=516,uie=517,cie=518,hie=519,SC=35044,CJe=35048,EC="300 es",Tc=2e3,i4=2001,c0=class{addEventListener(e,r){this._listeners===void 0&&(this._listeners={});let n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(r)===-1&&n[e].push(r)}hasEventListener(e,r){let n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(r)!==-1}removeEventListener(e,r){let n=this._listeners;if(n===void 0)return;let i=n[e];if(i!==void 0){let a=i.indexOf(r);a!==-1&&i.splice(a,1)}}dispatchEvent(e){let r=this._listeners;if(r===void 0)return;let n=r[e.type];if(n!==void 0){e.target=this;let i=n.slice(0);for(let a=0,o=i.length;a<o;a++)i[a].call(this,e);e.target=null}}},Ra=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],RB=1234567,Km=Math.PI/180,xg=180/Math.PI;function Gs(){let t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,r=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Ra[t&255]+Ra[t>>8&255]+Ra[t>>16&255]+Ra[t>>24&255]+"-"+Ra[e&255]+Ra[e>>8&255]+"-"+Ra[e>>16&15|64]+Ra[e>>24&255]+"-"+Ra[r&63|128]+Ra[r>>8&255]+"-"+Ra[r>>16&255]+Ra[r>>24&255]+Ra[n&255]+Ra[n>>8&255]+Ra[n>>16&255]+Ra[n>>24&255]).toLowerCase()}function zr(t,e,r){return Math.max(e,Math.min(r,t))}function vP(t,e){return(t%e+e)%e}function die(t,e,r,n,i){return n+(t-e)*(i-n)/(r-e)}function pie(t,e,r){return t!==e?(r-t)/(e-t):0}function Dv(t,e,r){return(1-r)*t+r*e}function fie(t,e,r,n){return Dv(t,e,1-Math.exp(-r*n))}function mie(t,e=1){return e-Math.abs(vP(t,e*2)-e)}function gie(t,e,r){return t<=e?0:t>=r?1:(t=(t-e)/(r-e),t*t*(3-2*t))}function yie(t,e,r){return t<=e?0:t>=r?1:(t=(t-e)/(r-e),t*t*t*(t*(t*6-15)+10))}function vie(t,e){return t+Math.floor(Math.random()*(e-t+1))}function _ie(t,e){return t+Math.random()*(e-t)}function xie(t){return t*(.5-Math.random())}function bie(t){t!==void 0&&(RB=t);let e=RB+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function wie(t){return t*Km}function Aie(t){return t*xg}function Sie(t){return(t&t-1)===0&&t!==0}function Eie(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function Iie(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function Cie(t,e,r,n,i){let a=Math.cos,o=Math.sin,s=a(r/2),l=o(r/2),u=a((e+n)/2),c=o((e+n)/2),h=a((e-n)/2),d=o((e-n)/2),p=a((n-e)/2),m=o((n-e)/2);switch(i){case"XYX":t.set(s*c,l*h,l*d,s*u);break;case"YZY":t.set(l*d,s*c,l*h,s*u);break;case"ZXZ":t.set(l*h,l*d,s*c,s*u);break;case"XZX":t.set(s*c,l*m,l*p,s*u);break;case"YXY":t.set(l*p,s*c,l*m,s*u);break;case"ZYZ":t.set(l*m,l*p,s*c,s*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function Il(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function bn(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}var In={DEG2RAD:Km,RAD2DEG:xg,generateUUID:Gs,clamp:zr,euclideanModulo:vP,mapLinear:die,inverseLerp:pie,lerp:Dv,damp:fie,pingpong:mie,smoothstep:gie,smootherstep:yie,randInt:vie,randFloat:_ie,randFloatSpread:xie,seededRandom:bie,degToRad:wie,radToDeg:Aie,isPowerOfTwo:Sie,ceilPowerOfTwo:Eie,floorPowerOfTwo:Iie,setQuaternionFromProperEuler:Cie,normalize:bn,denormalize:Il},Je=class X9{constructor(e=0,r=0){X9.prototype.isVector2=!0,this.x=e,this.y=r}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,r){return this.x=e,this.y=r,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,r){switch(e){case 0:this.x=r;break;case 1:this.y=r;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,r){return this.x=e.x+r.x,this.y=e.y+r.y,this}addScaledVector(e,r){return this.x+=e.x*r,this.y+=e.y*r,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,r){return this.x=e.x-r.x,this.y=e.y-r.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let r=this.x,n=this.y,i=e.elements;return this.x=i[0]*r+i[3]*n+i[6],this.y=i[1]*r+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,r){return this.x=zr(this.x,e.x,r.x),this.y=zr(this.y,e.y,r.y),this}clampScalar(e,r){return this.x=zr(this.x,e,r),this.y=zr(this.y,e,r),this}clampLength(e,r){let n=this.length();return this.divideScalar(n||1).multiplyScalar(zr(n,e,r))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){let r=Math.sqrt(this.lengthSq()*e.lengthSq());if(r===0)return Math.PI/2;let n=this.dot(e)/r;return Math.acos(zr(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let r=this.x-e.x,n=this.y-e.y;return r*r+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,r){return this.x+=(e.x-this.x)*r,this.y+=(e.y-this.y)*r,this}lerpVectors(e,r,n){return this.x=e.x+(r.x-e.x)*n,this.y=e.y+(r.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,r=0){return this.x=e[r],this.y=e[r+1],this}toArray(e=[],r=0){return e[r]=this.x,e[r+1]=this.y,e}fromBufferAttribute(e,r){return this.x=e.getX(r),this.y=e.getY(r),this}rotateAround(e,r){let n=Math.cos(r),i=Math.sin(r),a=this.x-e.x,o=this.y-e.y;return this.x=a*n-o*i+e.x,this.y=a*i+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},Br=class q9{constructor(e,r,n,i,a,o,s,l,u){q9.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,r,n,i,a,o,s,l,u)}set(e,r,n,i,a,o,s,l,u){let c=this.elements;return c[0]=e,c[1]=i,c[2]=s,c[3]=r,c[4]=a,c[5]=l,c[6]=n,c[7]=o,c[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let r=this.elements,n=e.elements;return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],this}extractBasis(e,r,n){return e.setFromMatrix3Column(this,0),r.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let r=e.elements;return this.set(r[0],r[4],r[8],r[1],r[5],r[9],r[2],r[6],r[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,r){let n=e.elements,i=r.elements,a=this.elements,o=n[0],s=n[3],l=n[6],u=n[1],c=n[4],h=n[7],d=n[2],p=n[5],m=n[8],y=i[0],v=i[3],_=i[6],w=i[1],b=i[4],A=i[7],E=i[2],M=i[5],P=i[8];return a[0]=o*y+s*w+l*E,a[3]=o*v+s*b+l*M,a[6]=o*_+s*A+l*P,a[1]=u*y+c*w+h*E,a[4]=u*v+c*b+h*M,a[7]=u*_+c*A+h*P,a[2]=d*y+p*w+m*E,a[5]=d*v+p*b+m*M,a[8]=d*_+p*A+m*P,this}multiplyScalar(e){let r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=e,r[4]*=e,r[7]*=e,r[2]*=e,r[5]*=e,r[8]*=e,this}determinant(){let e=this.elements,r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8];return r*o*c-r*s*u-n*a*c+n*s*l+i*a*u-i*o*l}invert(){let e=this.elements,r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=c*o-s*u,d=s*l-c*a,p=u*a-o*l,m=r*h+n*d+i*p;if(m===0)return this.set(0,0,0,0,0,0,0,0,0);let y=1/m;return e[0]=h*y,e[1]=(i*u-c*n)*y,e[2]=(s*n-i*o)*y,e[3]=d*y,e[4]=(c*r-i*l)*y,e[5]=(i*a-s*r)*y,e[6]=p*y,e[7]=(n*l-u*r)*y,e[8]=(o*r-n*a)*y,this}transpose(){let e,r=this.elements;return e=r[1],r[1]=r[3],r[3]=e,e=r[2],r[2]=r[6],r[6]=e,e=r[5],r[5]=r[7],r[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let r=this.elements;return e[0]=r[0],e[1]=r[3],e[2]=r[6],e[3]=r[1],e[4]=r[4],e[5]=r[7],e[6]=r[2],e[7]=r[5],e[8]=r[8],this}setUvTransform(e,r,n,i,a,o,s){let l=Math.cos(a),u=Math.sin(a);return this.set(n*l,n*u,-n*(l*o+u*s)+o+e,-i*u,i*l,-i*(-u*o+l*s)+s+r,0,0,1),this}scale(e,r){return this.premultiply(PS.makeScale(e,r)),this}rotate(e){return this.premultiply(PS.makeRotation(-e)),this}translate(e,r){return this.premultiply(PS.makeTranslation(e,r)),this}makeTranslation(e,r){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,r,0,0,1),this}makeRotation(e){let r=Math.cos(e),n=Math.sin(e);return this.set(r,-n,0,n,r,0,0,0,1),this}makeScale(e,r){return this.set(e,0,0,0,r,0,0,0,1),this}equals(e){let r=this.elements,n=e.elements;for(let i=0;i<9;i++)if(r[i]!==n[i])return!1;return!0}fromArray(e,r=0){for(let n=0;n<9;n++)this.elements[n]=e[n+r];return this}toArray(e=[],r=0){let n=this.elements;return e[r]=n[0],e[r+1]=n[1],e[r+2]=n[2],e[r+3]=n[3],e[r+4]=n[4],e[r+5]=n[5],e[r+6]=n[6],e[r+7]=n[7],e[r+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}},PS=new Br;function Y9(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}function Jv(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function Mie(){let t=Jv("canvas");return t.style.display="block",t}var LB={};function Bf(t){t in LB||(LB[t]=!0,console.warn(t))}function Tie(t,e,r){return new Promise(function(n,i){function a(){switch(t.clientWaitSync(e,t.SYNC_FLUSH_COMMANDS_BIT,0)){case t.WAIT_FAILED:i();break;case t.TIMEOUT_EXPIRED:setTimeout(a,r);break;default:n()}}setTimeout(a,r)})}function Pie(t){let e=t.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function Die(t){let e=t.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}var NB=new Br().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),$B=new Br().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function kie(){let t={enabled:!0,workingColorSpace:Op,spaces:{},convert:function(i,a,o){return this.enabled===!1||a===o||!a||!o||(this.spaces[a].transfer===En&&(i.r=Rc(i.r),i.g=Rc(i.g),i.b=Rc(i.b)),this.spaces[a].primaries!==this.spaces[o].primaries&&(i.applyMatrix3(this.spaces[a].toXYZ),i.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===En&&(i.r=Qm(i.r),i.g=Qm(i.g),i.b=Qm(i.b))),i},fromWorkingColorSpace:function(i,a){return this.convert(i,this.workingColorSpace,a)},toWorkingColorSpace:function(i,a){return this.convert(i,a,this.workingColorSpace)},getPrimaries:function(i){return this.spaces[i].primaries},getTransfer:function(i){return i===Zh?r4:this.spaces[i].transfer},getLuminanceCoefficients:function(i,a=this.workingColorSpace){return i.fromArray(this.spaces[a].luminanceCoefficients)},define:function(i){Object.assign(this.spaces,i)},_getMatrix:function(i,a,o){return i.copy(this.spaces[a].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(i){return this.spaces[i].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(i=this.workingColorSpace){return this.spaces[i].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],r=[.2126,.7152,.0722],n=[.3127,.329];return t.define({[Op]:{primaries:e,whitePoint:n,transfer:r4,toXYZ:NB,fromXYZ:$B,luminanceCoefficients:r,workingColorSpaceConfig:{unpackColorSpace:Za},outputColorSpaceConfig:{drawingBufferColorSpace:Za}},[Za]:{primaries:e,whitePoint:n,transfer:En,toXYZ:NB,fromXYZ:$B,luminanceCoefficients:r,outputColorSpaceConfig:{drawingBufferColorSpace:Za}}}),t}var an=kie();function Rc(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function Qm(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}var hf,Oie=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let r;if(e instanceof HTMLCanvasElement)r=e;else{hf===void 0&&(hf=Jv("canvas")),hf.width=e.width,hf.height=e.height;let n=hf.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),r=hf}return r.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let r=Jv("canvas");r.width=e.width,r.height=e.height;let n=r.getContext("2d");n.drawImage(e,0,0,e.width,e.height);let i=n.getImageData(0,0,e.width,e.height),a=i.data;for(let o=0;o<a.length;o++)a[o]=Rc(a[o]/255)*255;return n.putImageData(i,0,0),r}else if(e.data){let r=e.data.slice(0);for(let n=0;n<r.length;n++)r instanceof Uint8Array||r instanceof Uint8ClampedArray?r[n]=Math.floor(Rc(r[n]/255)*255):r[n]=Rc(r[n]);return{data:r,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},Bie=0,J9=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Bie++}),this.uuid=Gs(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let r=e===void 0||typeof e=="string";if(!r&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let n={uuid:this.uuid,url:""},i=this.data;if(i!==null){let a;if(Array.isArray(i)){a=[];for(let o=0,s=i.length;o<s;o++)i[o].isDataTexture?a.push(DS(i[o].image)):a.push(DS(i[o]))}else a=DS(i);n.url=a}return r||(e.images[this.uuid]=n),n}};function DS(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?Oie.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var zie=0,Ho=class Lb extends c0{constructor(e=Lb.DEFAULT_IMAGE,r=Lb.DEFAULT_MAPPING,n=hp,i=hp,a=vu,o=dp,s=Ha,l=Fl,u=Lb.DEFAULT_ANISOTROPY,c=Zh){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:zie++}),this.uuid=Gs(),this.name="",this.source=new J9(e),this.mipmaps=[],this.mapping=r,this.channel=0,this.wrapS=n,this.wrapT=i,this.magFilter=a,this.minFilter=o,this.anisotropy=u,this.format=s,this.internalFormat=null,this.type=l,this.offset=new Je(0,0),this.repeat=new Je(1,1),this.center=new Je(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Br,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let r=e===void 0||typeof e=="string";if(!r&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];let n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),r||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==F9)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Ml:e.x=e.x-Math.floor(e.x);break;case hp:e.x=e.x<0?0:1;break;case YI:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Ml:e.y=e.y-Math.floor(e.y);break;case hp:e.y=e.y<0?0:1;break;case YI:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}};Ho.DEFAULT_IMAGE=null;Ho.DEFAULT_MAPPING=F9;Ho.DEFAULT_ANISOTROPY=1;var _n=class K9{constructor(e=0,r=0,n=0,i=1){K9.prototype.isVector4=!0,this.x=e,this.y=r,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,r,n,i){return this.x=e,this.y=r,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,r){switch(e){case 0:this.x=r;break;case 1:this.y=r;break;case 2:this.z=r;break;case 3:this.w=r;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,r){return this.x=e.x+r.x,this.y=e.y+r.y,this.z=e.z+r.z,this.w=e.w+r.w,this}addScaledVector(e,r){return this.x+=e.x*r,this.y+=e.y*r,this.z+=e.z*r,this.w+=e.w*r,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,r){return this.x=e.x-r.x,this.y=e.y-r.y,this.z=e.z-r.z,this.w=e.w-r.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let r=this.x,n=this.y,i=this.z,a=this.w,o=e.elements;return this.x=o[0]*r+o[4]*n+o[8]*i+o[12]*a,this.y=o[1]*r+o[5]*n+o[9]*i+o[13]*a,this.z=o[2]*r+o[6]*n+o[10]*i+o[14]*a,this.w=o[3]*r+o[7]*n+o[11]*i+o[15]*a,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let r=Math.sqrt(1-e.w*e.w);return r<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/r,this.y=e.y/r,this.z=e.z/r),this}setAxisAngleFromRotationMatrix(e){let r,n,i,a,o=e.elements,s=o[0],l=o[4],u=o[8],c=o[1],h=o[5],d=o[9],p=o[2],m=o[6],y=o[10];if(Math.abs(l-c)<.01&&Math.abs(u-p)<.01&&Math.abs(d-m)<.01){if(Math.abs(l+c)<.1&&Math.abs(u+p)<.1&&Math.abs(d+m)<.1&&Math.abs(s+h+y-3)<.1)return this.set(1,0,0,0),this;r=Math.PI;let _=(s+1)/2,w=(h+1)/2,b=(y+1)/2,A=(l+c)/4,E=(u+p)/4,M=(d+m)/4;return _>w&&_>b?_<.01?(n=0,i=.707106781,a=.707106781):(n=Math.sqrt(_),i=A/n,a=E/n):w>b?w<.01?(n=.707106781,i=0,a=.707106781):(i=Math.sqrt(w),n=A/i,a=M/i):b<.01?(n=.707106781,i=.707106781,a=0):(a=Math.sqrt(b),n=E/a,i=M/a),this.set(n,i,a,r),this}let v=Math.sqrt((m-d)*(m-d)+(u-p)*(u-p)+(c-l)*(c-l));return Math.abs(v)<.001&&(v=1),this.x=(m-d)/v,this.y=(u-p)/v,this.z=(c-l)/v,this.w=Math.acos((s+h+y-1)/2),this}setFromMatrixPosition(e){let r=e.elements;return this.x=r[12],this.y=r[13],this.z=r[14],this.w=r[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,r){return this.x=zr(this.x,e.x,r.x),this.y=zr(this.y,e.y,r.y),this.z=zr(this.z,e.z,r.z),this.w=zr(this.w,e.w,r.w),this}clampScalar(e,r){return this.x=zr(this.x,e,r),this.y=zr(this.y,e,r),this.z=zr(this.z,e,r),this.w=zr(this.w,e,r),this}clampLength(e,r){let n=this.length();return this.divideScalar(n||1).multiplyScalar(zr(n,e,r))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,r){return this.x+=(e.x-this.x)*r,this.y+=(e.y-this.y)*r,this.z+=(e.z-this.z)*r,this.w+=(e.w-this.w)*r,this}lerpVectors(e,r,n){return this.x=e.x+(r.x-e.x)*n,this.y=e.y+(r.y-e.y)*n,this.z=e.z+(r.z-e.z)*n,this.w=e.w+(r.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,r=0){return this.x=e[r],this.y=e[r+1],this.z=e[r+2],this.w=e[r+3],this}toArray(e=[],r=0){return e[r]=this.x,e[r+1]=this.y,e[r+2]=this.z,e[r+3]=this.w,e}fromBufferAttribute(e,r){return this.x=e.getX(r),this.y=e.getY(r),this.z=e.getZ(r),this.w=e.getW(r),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},Fie=class extends c0{constructor(e=1,r=1,n={}){super(),this.isRenderTarget=!0,this.width=e,this.height=r,this.depth=1,this.scissor=new _n(0,0,e,r),this.scissorTest=!1,this.viewport=new _n(0,0,e,r);let i={width:e,height:r,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:vu,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},n);let a=new Ho(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);a.flipY=!1,a.generateMipmaps=n.generateMipmaps,a.internalFormat=n.internalFormat,this.textures=[];let o=n.count;for(let s=0;s<o;s++)this.textures[s]=a.clone(),this.textures[s].isRenderTargetTexture=!0,this.textures[s].renderTarget=this;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,r,n=1){if(this.width!==e||this.height!==r||this.depth!==n){this.width=e,this.height=r,this.depth=n;for(let i=0,a=this.textures.length;i<a;i++)this.textures[i].image.width=e,this.textures[i].image.height=r,this.textures[i].image.depth=n;this.dispose()}this.viewport.set(0,0,e,r),this.scissor.set(0,0,e,r)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,i=e.textures.length;n<i;n++)this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0,this.textures[n].renderTarget=this;let r=Object.assign({},e.texture.image);return this.texture.source=new J9(r),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},ad=class extends Fie{constructor(e=1,r=1,n={}){super(e,r,n),this.isWebGLRenderTarget=!0}},Q9=class extends Ho{constructor(e=null,r=1,n=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:r,height:n,depth:i},this.magFilter=gs,this.minFilter=gs,this.wrapR=hp,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}},Rie=class extends Ho{constructor(e=null,r=1,n=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:r,height:n,depth:i},this.magFilter=gs,this.minFilter=gs,this.wrapR=hp,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},Iu=class{constructor(e=0,r=0,n=0,i=1){this.isQuaternion=!0,this._x=e,this._y=r,this._z=n,this._w=i}static slerpFlat(e,r,n,i,a,o,s){let l=n[i+0],u=n[i+1],c=n[i+2],h=n[i+3],d=a[o+0],p=a[o+1],m=a[o+2],y=a[o+3];if(s===0){e[r+0]=l,e[r+1]=u,e[r+2]=c,e[r+3]=h;return}if(s===1){e[r+0]=d,e[r+1]=p,e[r+2]=m,e[r+3]=y;return}if(h!==y||l!==d||u!==p||c!==m){let v=1-s,_=l*d+u*p+c*m+h*y,w=_>=0?1:-1,b=1-_*_;if(b>Number.EPSILON){let E=Math.sqrt(b),M=Math.atan2(E,_*w);v=Math.sin(v*M)/E,s=Math.sin(s*M)/E}let A=s*w;if(l=l*v+d*A,u=u*v+p*A,c=c*v+m*A,h=h*v+y*A,v===1-s){let E=1/Math.sqrt(l*l+u*u+c*c+h*h);l*=E,u*=E,c*=E,h*=E}}e[r]=l,e[r+1]=u,e[r+2]=c,e[r+3]=h}static multiplyQuaternionsFlat(e,r,n,i,a,o){let s=n[i],l=n[i+1],u=n[i+2],c=n[i+3],h=a[o],d=a[o+1],p=a[o+2],m=a[o+3];return e[r]=s*m+c*h+l*p-u*d,e[r+1]=l*m+c*d+u*h-s*p,e[r+2]=u*m+c*p+s*d-l*h,e[r+3]=c*m-s*h-l*d-u*p,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,r,n,i){return this._x=e,this._y=r,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,r=!0){let n=e._x,i=e._y,a=e._z,o=e._order,s=Math.cos,l=Math.sin,u=s(n/2),c=s(i/2),h=s(a/2),d=l(n/2),p=l(i/2),m=l(a/2);switch(o){case"XYZ":this._x=d*c*h+u*p*m,this._y=u*p*h-d*c*m,this._z=u*c*m+d*p*h,this._w=u*c*h-d*p*m;break;case"YXZ":this._x=d*c*h+u*p*m,this._y=u*p*h-d*c*m,this._z=u*c*m-d*p*h,this._w=u*c*h+d*p*m;break;case"ZXY":this._x=d*c*h-u*p*m,this._y=u*p*h+d*c*m,this._z=u*c*m+d*p*h,this._w=u*c*h-d*p*m;break;case"ZYX":this._x=d*c*h-u*p*m,this._y=u*p*h+d*c*m,this._z=u*c*m-d*p*h,this._w=u*c*h+d*p*m;break;case"YZX":this._x=d*c*h+u*p*m,this._y=u*p*h+d*c*m,this._z=u*c*m-d*p*h,this._w=u*c*h-d*p*m;break;case"XZY":this._x=d*c*h-u*p*m,this._y=u*p*h-d*c*m,this._z=u*c*m+d*p*h,this._w=u*c*h+d*p*m;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return r===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,r){let n=r/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){let r=e.elements,n=r[0],i=r[4],a=r[8],o=r[1],s=r[5],l=r[9],u=r[2],c=r[6],h=r[10],d=n+s+h;if(d>0){let p=.5/Math.sqrt(d+1);this._w=.25/p,this._x=(c-l)*p,this._y=(a-u)*p,this._z=(o-i)*p}else if(n>s&&n>h){let p=2*Math.sqrt(1+n-s-h);this._w=(c-l)/p,this._x=.25*p,this._y=(i+o)/p,this._z=(a+u)/p}else if(s>h){let p=2*Math.sqrt(1+s-n-h);this._w=(a-u)/p,this._x=(i+o)/p,this._y=.25*p,this._z=(l+c)/p}else{let p=2*Math.sqrt(1+h-n-s);this._w=(o-i)/p,this._x=(a+u)/p,this._y=(l+c)/p,this._z=.25*p}return this._onChangeCallback(),this}setFromUnitVectors(e,r){let n=e.dot(r)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*r.z-e.z*r.y,this._y=e.z*r.x-e.x*r.z,this._z=e.x*r.y-e.y*r.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(zr(this.dot(e),-1,1)))}rotateTowards(e,r){let n=this.angleTo(e);if(n===0)return this;let i=Math.min(1,r/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,r){let n=e._x,i=e._y,a=e._z,o=e._w,s=r._x,l=r._y,u=r._z,c=r._w;return this._x=n*c+o*s+i*u-a*l,this._y=i*c+o*l+a*s-n*u,this._z=a*c+o*u+n*l-i*s,this._w=o*c-n*s-i*l-a*u,this._onChangeCallback(),this}slerp(e,r){if(r===0)return this;if(r===1)return this.copy(e);let n=this._x,i=this._y,a=this._z,o=this._w,s=o*e._w+n*e._x+i*e._y+a*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=o,this._x=n,this._y=i,this._z=a,this;let l=1-s*s;if(l<=Number.EPSILON){let p=1-r;return this._w=p*o+r*this._w,this._x=p*n+r*this._x,this._y=p*i+r*this._y,this._z=p*a+r*this._z,this.normalize(),this}let u=Math.sqrt(l),c=Math.atan2(u,s),h=Math.sin((1-r)*c)/u,d=Math.sin(r*c)/u;return this._w=o*h+this._w*d,this._x=n*h+this._x*d,this._y=i*h+this._y*d,this._z=a*h+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,r,n){return this.copy(e).slerp(r,n)}random(){let e=2*Math.PI*Math.random(),r=2*Math.PI*Math.random(),n=Math.random(),i=Math.sqrt(1-n),a=Math.sqrt(n);return this.set(i*Math.sin(e),i*Math.cos(e),a*Math.sin(r),a*Math.cos(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,r=0){return this._x=e[r],this._y=e[r+1],this._z=e[r+2],this._w=e[r+3],this._onChangeCallback(),this}toArray(e=[],r=0){return e[r]=this._x,e[r+1]=this._y,e[r+2]=this._z,e[r+3]=this._w,e}fromBufferAttribute(e,r){return this._x=e.getX(r),this._y=e.getY(r),this._z=e.getZ(r),this._w=e.getW(r),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},Q=class eN{constructor(e=0,r=0,n=0){eN.prototype.isVector3=!0,this.x=e,this.y=r,this.z=n}set(e,r,n){return n===void 0&&(n=this.z),this.x=e,this.y=r,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,r){switch(e){case 0:this.x=r;break;case 1:this.y=r;break;case 2:this.z=r;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,r){return this.x=e.x+r.x,this.y=e.y+r.y,this.z=e.z+r.z,this}addScaledVector(e,r){return this.x+=e.x*r,this.y+=e.y*r,this.z+=e.z*r,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,r){return this.x=e.x-r.x,this.y=e.y-r.y,this.z=e.z-r.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,r){return this.x=e.x*r.x,this.y=e.y*r.y,this.z=e.z*r.z,this}applyEuler(e){return this.applyQuaternion(UB.setFromEuler(e))}applyAxisAngle(e,r){return this.applyQuaternion(UB.setFromAxisAngle(e,r))}applyMatrix3(e){let r=this.x,n=this.y,i=this.z,a=e.elements;return this.x=a[0]*r+a[3]*n+a[6]*i,this.y=a[1]*r+a[4]*n+a[7]*i,this.z=a[2]*r+a[5]*n+a[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let r=this.x,n=this.y,i=this.z,a=e.elements,o=1/(a[3]*r+a[7]*n+a[11]*i+a[15]);return this.x=(a[0]*r+a[4]*n+a[8]*i+a[12])*o,this.y=(a[1]*r+a[5]*n+a[9]*i+a[13])*o,this.z=(a[2]*r+a[6]*n+a[10]*i+a[14])*o,this}applyQuaternion(e){let r=this.x,n=this.y,i=this.z,a=e.x,o=e.y,s=e.z,l=e.w,u=2*(o*i-s*n),c=2*(s*r-a*i),h=2*(a*n-o*r);return this.x=r+l*u+o*h-s*c,this.y=n+l*c+s*u-a*h,this.z=i+l*h+a*c-o*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let r=this.x,n=this.y,i=this.z,a=e.elements;return this.x=a[0]*r+a[4]*n+a[8]*i,this.y=a[1]*r+a[5]*n+a[9]*i,this.z=a[2]*r+a[6]*n+a[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,r){return this.x=zr(this.x,e.x,r.x),this.y=zr(this.y,e.y,r.y),this.z=zr(this.z,e.z,r.z),this}clampScalar(e,r){return this.x=zr(this.x,e,r),this.y=zr(this.y,e,r),this.z=zr(this.z,e,r),this}clampLength(e,r){let n=this.length();return this.divideScalar(n||1).multiplyScalar(zr(n,e,r))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,r){return this.x+=(e.x-this.x)*r,this.y+=(e.y-this.y)*r,this.z+=(e.z-this.z)*r,this}lerpVectors(e,r,n){return this.x=e.x+(r.x-e.x)*n,this.y=e.y+(r.y-e.y)*n,this.z=e.z+(r.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,r){let n=e.x,i=e.y,a=e.z,o=r.x,s=r.y,l=r.z;return this.x=i*l-a*s,this.y=a*o-n*l,this.z=n*s-i*o,this}projectOnVector(e){let r=e.lengthSq();if(r===0)return this.set(0,0,0);let n=e.dot(this)/r;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return kS.copy(this).projectOnVector(e),this.sub(kS)}reflect(e){return this.sub(kS.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let r=Math.sqrt(this.lengthSq()*e.lengthSq());if(r===0)return Math.PI/2;let n=this.dot(e)/r;return Math.acos(zr(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let r=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return r*r+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,r,n){let i=Math.sin(r)*e;return this.x=i*Math.sin(n),this.y=Math.cos(r)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,r,n){return this.x=e*Math.sin(r),this.y=n,this.z=e*Math.cos(r),this}setFromMatrixPosition(e){let r=e.elements;return this.x=r[12],this.y=r[13],this.z=r[14],this}setFromMatrixScale(e){let r=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=r,this.y=n,this.z=i,this}setFromMatrixColumn(e,r){return this.fromArray(e.elements,r*4)}setFromMatrix3Column(e,r){return this.fromArray(e.elements,r*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,r=0){return this.x=e[r],this.y=e[r+1],this.z=e[r+2],this}toArray(e=[],r=0){return e[r]=this.x,e[r+1]=this.y,e[r+2]=this.z,e}fromBufferAttribute(e,r){return this.x=e.getX(r),this.y=e.getY(r),this.z=e.getZ(r),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=Math.random()*Math.PI*2,r=Math.random()*2-1,n=Math.sqrt(1-r*r);return this.x=n*Math.cos(e),this.y=r,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},kS=new Q,UB=new Iu,qn=class{constructor(e=new Q(1/0,1/0,1/0),r=new Q(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=r}set(e,r){return this.min.copy(e),this.max.copy(r),this}setFromArray(e){this.makeEmpty();for(let r=0,n=e.length;r<n;r+=3)this.expandByPoint(il.fromArray(e,r));return this}setFromBufferAttribute(e){this.makeEmpty();for(let r=0,n=e.count;r<n;r++)this.expandByPoint(il.fromBufferAttribute(e,r));return this}setFromPoints(e){this.makeEmpty();for(let r=0,n=e.length;r<n;r++)this.expandByPoint(e[r]);return this}setFromCenterAndSize(e,r){let n=il.copy(r).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,r=!1){return this.makeEmpty(),this.expandByObject(e,r)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,r=!1){e.updateWorldMatrix(!1,!1);let n=e.geometry;if(n!==void 0){let a=n.getAttribute("position");if(r===!0&&a!==void 0&&e.isInstancedMesh!==!0)for(let o=0,s=a.count;o<s;o++)e.isMesh===!0?e.getVertexPosition(o,il):il.fromBufferAttribute(a,o),il.applyMatrix4(e.matrixWorld),this.expandByPoint(il);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),U_.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),U_.copy(n.boundingBox)),U_.applyMatrix4(e.matrixWorld),this.union(U_)}let i=e.children;for(let a=0,o=i.length;a<o;a++)this.expandByObject(i[a],r);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,r){return r.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,il),il.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let r,n;return e.normal.x>0?(r=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(r=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(r+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(r+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(r+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(r+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),r<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(H0),j_.subVectors(this.max,H0),df.subVectors(e.a,H0),pf.subVectors(e.b,H0),ff.subVectors(e.c,H0),lh.subVectors(pf,df),uh.subVectors(ff,pf),Dd.subVectors(df,ff);let r=[0,-lh.z,lh.y,0,-uh.z,uh.y,0,-Dd.z,Dd.y,lh.z,0,-lh.x,uh.z,0,-uh.x,Dd.z,0,-Dd.x,-lh.y,lh.x,0,-uh.y,uh.x,0,-Dd.y,Dd.x,0];return!OS(r,df,pf,ff,j_)||(r=[1,0,0,0,1,0,0,0,1],!OS(r,df,pf,ff,j_))?!1:(V_.crossVectors(lh,uh),r=[V_.x,V_.y,V_.z],OS(r,df,pf,ff,j_))}clampPoint(e,r){return r.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,il).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(il).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Ku[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ku[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ku[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ku[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ku[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ku[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ku[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ku[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ku),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},Ku=[new Q,new Q,new Q,new Q,new Q,new Q,new Q,new Q],il=new Q,U_=new qn,df=new Q,pf=new Q,ff=new Q,lh=new Q,uh=new Q,Dd=new Q,H0=new Q,j_=new Q,V_=new Q,kd=new Q;function OS(t,e,r,n,i){for(let a=0,o=t.length-3;a<=o;a+=3){kd.fromArray(t,a);let s=i.x*Math.abs(kd.x)+i.y*Math.abs(kd.y)+i.z*Math.abs(kd.z),l=e.dot(kd),u=r.dot(kd),c=n.dot(kd);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>s)return!1}return!0}var Lie=new qn,X0=new Q,BS=new Q,jo=class{constructor(e=new Q,r=-1){this.isSphere=!0,this.center=e,this.radius=r}set(e,r){return this.center.copy(e),this.radius=r,this}setFromPoints(e,r){let n=this.center;r!==void 0?n.copy(r):Lie.setFromPoints(e).getCenter(n);let i=0;for(let a=0,o=e.length;a<o;a++)i=Math.max(i,n.distanceToSquared(e[a]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let r=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=r*r}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,r){let n=this.center.distanceToSquared(e);return r.copy(e),n>this.radius*this.radius&&(r.sub(this.center).normalize(),r.multiplyScalar(this.radius).add(this.center)),r}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;X0.subVectors(e,this.center);let r=X0.lengthSq();if(r>this.radius*this.radius){let n=Math.sqrt(r),i=(n-this.radius)*.5;this.center.addScaledVector(X0,i/n),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(BS.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(X0.copy(e.center).add(BS)),this.expandByPoint(X0.copy(e.center).sub(BS))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},Qu=new Q,zS=new Q,G_=new Q,ch=new Q,FS=new Q,Z_=new Q,RS=new Q,U1=class{constructor(e=new Q,r=new Q(0,0,-1)){this.origin=e,this.direction=r}set(e,r){return this.origin.copy(e),this.direction.copy(r),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,r){return r.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Qu)),this}closestPointToPoint(e,r){r.subVectors(e,this.origin);let n=r.dot(this.direction);return n<0?r.copy(this.origin):r.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let r=Qu.subVectors(e,this.origin).dot(this.direction);return r<0?this.origin.distanceToSquared(e):(Qu.copy(this.origin).addScaledVector(this.direction,r),Qu.distanceToSquared(e))}distanceSqToSegment(e,r,n,i){zS.copy(e).add(r).multiplyScalar(.5),G_.copy(r).sub(e).normalize(),ch.copy(this.origin).sub(zS);let a=e.distanceTo(r)*.5,o=-this.direction.dot(G_),s=ch.dot(this.direction),l=-ch.dot(G_),u=ch.lengthSq(),c=Math.abs(1-o*o),h,d,p,m;if(c>0)if(h=o*l-s,d=o*s-l,m=a*c,h>=0)if(d>=-m)if(d<=m){let y=1/c;h*=y,d*=y,p=h*(h+o*d+2*s)+d*(o*h+d+2*l)+u}else d=a,h=Math.max(0,-(o*d+s)),p=-h*h+d*(d+2*l)+u;else d=-a,h=Math.max(0,-(o*d+s)),p=-h*h+d*(d+2*l)+u;else d<=-m?(h=Math.max(0,-(-o*a+s)),d=h>0?-a:Math.min(Math.max(-a,-l),a),p=-h*h+d*(d+2*l)+u):d<=m?(h=0,d=Math.min(Math.max(-a,-l),a),p=d*(d+2*l)+u):(h=Math.max(0,-(o*a+s)),d=h>0?a:Math.min(Math.max(-a,-l),a),p=-h*h+d*(d+2*l)+u);else d=o>0?-a:a,h=Math.max(0,-(o*d+s)),p=-h*h+d*(d+2*l)+u;return n&&n.copy(this.origin).addScaledVector(this.direction,h),i&&i.copy(zS).addScaledVector(G_,d),p}intersectSphere(e,r){Qu.subVectors(e.center,this.origin);let n=Qu.dot(this.direction),i=Qu.dot(Qu)-n*n,a=e.radius*e.radius;if(i>a)return null;let o=Math.sqrt(a-i),s=n-o,l=n+o;return l<0?null:s<0?this.at(l,r):this.at(s,r)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let r=e.normal.dot(this.direction);if(r===0)return e.distanceToPoint(this.origin)===0?0:null;let n=-(this.origin.dot(e.normal)+e.constant)/r;return n>=0?n:null}intersectPlane(e,r){let n=this.distanceToPlane(e);return n===null?null:this.at(n,r)}intersectsPlane(e){let r=e.distanceToPoint(this.origin);return r===0||e.normal.dot(this.direction)*r<0}intersectBox(e,r){let n,i,a,o,s,l,u=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,d=this.origin;return u>=0?(n=(e.min.x-d.x)*u,i=(e.max.x-d.x)*u):(n=(e.max.x-d.x)*u,i=(e.min.x-d.x)*u),c>=0?(a=(e.min.y-d.y)*c,o=(e.max.y-d.y)*c):(a=(e.max.y-d.y)*c,o=(e.min.y-d.y)*c),n>o||a>i||((a>n||isNaN(n))&&(n=a),(o<i||isNaN(i))&&(i=o),h>=0?(s=(e.min.z-d.z)*h,l=(e.max.z-d.z)*h):(s=(e.max.z-d.z)*h,l=(e.min.z-d.z)*h),n>l||s>i)||((s>n||n!==n)&&(n=s),(l<i||i!==i)&&(i=l),i<0)?null:this.at(n>=0?n:i,r)}intersectsBox(e){return this.intersectBox(e,Qu)!==null}intersectTriangle(e,r,n,i,a){FS.subVectors(r,e),Z_.subVectors(n,e),RS.crossVectors(FS,Z_);let o=this.direction.dot(RS),s;if(o>0){if(i)return null;s=1}else if(o<0)s=-1,o=-o;else return null;ch.subVectors(this.origin,e);let l=s*this.direction.dot(Z_.crossVectors(ch,Z_));if(l<0)return null;let u=s*this.direction.dot(FS.cross(ch));if(u<0||l+u>o)return null;let c=-s*ch.dot(RS);return c<0?null:this.at(c/o,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},gr=class IC{constructor(e,r,n,i,a,o,s,l,u,c,h,d,p,m,y,v){IC.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,r,n,i,a,o,s,l,u,c,h,d,p,m,y,v)}set(e,r,n,i,a,o,s,l,u,c,h,d,p,m,y,v){let _=this.elements;return _[0]=e,_[4]=r,_[8]=n,_[12]=i,_[1]=a,_[5]=o,_[9]=s,_[13]=l,_[2]=u,_[6]=c,_[10]=h,_[14]=d,_[3]=p,_[7]=m,_[11]=y,_[15]=v,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new IC().fromArray(this.elements)}copy(e){let r=this.elements,n=e.elements;return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15],this}copyPosition(e){let r=this.elements,n=e.elements;return r[12]=n[12],r[13]=n[13],r[14]=n[14],this}setFromMatrix3(e){let r=e.elements;return this.set(r[0],r[3],r[6],0,r[1],r[4],r[7],0,r[2],r[5],r[8],0,0,0,0,1),this}extractBasis(e,r,n){return e.setFromMatrixColumn(this,0),r.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,r,n){return this.set(e.x,r.x,n.x,0,e.y,r.y,n.y,0,e.z,r.z,n.z,0,0,0,0,1),this}extractRotation(e){let r=this.elements,n=e.elements,i=1/mf.setFromMatrixColumn(e,0).length(),a=1/mf.setFromMatrixColumn(e,1).length(),o=1/mf.setFromMatrixColumn(e,2).length();return r[0]=n[0]*i,r[1]=n[1]*i,r[2]=n[2]*i,r[3]=0,r[4]=n[4]*a,r[5]=n[5]*a,r[6]=n[6]*a,r[7]=0,r[8]=n[8]*o,r[9]=n[9]*o,r[10]=n[10]*o,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}makeRotationFromEuler(e){let r=this.elements,n=e.x,i=e.y,a=e.z,o=Math.cos(n),s=Math.sin(n),l=Math.cos(i),u=Math.sin(i),c=Math.cos(a),h=Math.sin(a);if(e.order==="XYZ"){let d=o*c,p=o*h,m=s*c,y=s*h;r[0]=l*c,r[4]=-l*h,r[8]=u,r[1]=p+m*u,r[5]=d-y*u,r[9]=-s*l,r[2]=y-d*u,r[6]=m+p*u,r[10]=o*l}else if(e.order==="YXZ"){let d=l*c,p=l*h,m=u*c,y=u*h;r[0]=d+y*s,r[4]=m*s-p,r[8]=o*u,r[1]=o*h,r[5]=o*c,r[9]=-s,r[2]=p*s-m,r[6]=y+d*s,r[10]=o*l}else if(e.order==="ZXY"){let d=l*c,p=l*h,m=u*c,y=u*h;r[0]=d-y*s,r[4]=-o*h,r[8]=m+p*s,r[1]=p+m*s,r[5]=o*c,r[9]=y-d*s,r[2]=-o*u,r[6]=s,r[10]=o*l}else if(e.order==="ZYX"){let d=o*c,p=o*h,m=s*c,y=s*h;r[0]=l*c,r[4]=m*u-p,r[8]=d*u+y,r[1]=l*h,r[5]=y*u+d,r[9]=p*u-m,r[2]=-u,r[6]=s*l,r[10]=o*l}else if(e.order==="YZX"){let d=o*l,p=o*u,m=s*l,y=s*u;r[0]=l*c,r[4]=y-d*h,r[8]=m*h+p,r[1]=h,r[5]=o*c,r[9]=-s*c,r[2]=-u*c,r[6]=p*h+m,r[10]=d-y*h}else if(e.order==="XZY"){let d=o*l,p=o*u,m=s*l,y=s*u;r[0]=l*c,r[4]=-h,r[8]=u*c,r[1]=d*h+y,r[5]=o*c,r[9]=p*h-m,r[2]=m*h-p,r[6]=s*c,r[10]=y*h+d}return r[3]=0,r[7]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Nie,e,$ie)}lookAt(e,r,n){let i=this.elements;return Qo.subVectors(e,r),Qo.lengthSq()===0&&(Qo.z=1),Qo.normalize(),hh.crossVectors(n,Qo),hh.lengthSq()===0&&(Math.abs(n.z)===1?Qo.x+=1e-4:Qo.z+=1e-4,Qo.normalize(),hh.crossVectors(n,Qo)),hh.normalize(),W_.crossVectors(Qo,hh),i[0]=hh.x,i[4]=W_.x,i[8]=Qo.x,i[1]=hh.y,i[5]=W_.y,i[9]=Qo.y,i[2]=hh.z,i[6]=W_.z,i[10]=Qo.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,r){let n=e.elements,i=r.elements,a=this.elements,o=n[0],s=n[4],l=n[8],u=n[12],c=n[1],h=n[5],d=n[9],p=n[13],m=n[2],y=n[6],v=n[10],_=n[14],w=n[3],b=n[7],A=n[11],E=n[15],M=i[0],P=i[4],k=i[8],D=i[12],O=i[1],B=i[5],L=i[9],R=i[13],T=i[2],N=i[6],$=i[10],V=i[14],G=i[3],ee=i[7],ie=i[11],me=i[15];return a[0]=o*M+s*O+l*T+u*G,a[4]=o*P+s*B+l*N+u*ee,a[8]=o*k+s*L+l*$+u*ie,a[12]=o*D+s*R+l*V+u*me,a[1]=c*M+h*O+d*T+p*G,a[5]=c*P+h*B+d*N+p*ee,a[9]=c*k+h*L+d*$+p*ie,a[13]=c*D+h*R+d*V+p*me,a[2]=m*M+y*O+v*T+_*G,a[6]=m*P+y*B+v*N+_*ee,a[10]=m*k+y*L+v*$+_*ie,a[14]=m*D+y*R+v*V+_*me,a[3]=w*M+b*O+A*T+E*G,a[7]=w*P+b*B+A*N+E*ee,a[11]=w*k+b*L+A*$+E*ie,a[15]=w*D+b*R+A*V+E*me,this}multiplyScalar(e){let r=this.elements;return r[0]*=e,r[4]*=e,r[8]*=e,r[12]*=e,r[1]*=e,r[5]*=e,r[9]*=e,r[13]*=e,r[2]*=e,r[6]*=e,r[10]*=e,r[14]*=e,r[3]*=e,r[7]*=e,r[11]*=e,r[15]*=e,this}determinant(){let e=this.elements,r=e[0],n=e[4],i=e[8],a=e[12],o=e[1],s=e[5],l=e[9],u=e[13],c=e[2],h=e[6],d=e[10],p=e[14],m=e[3],y=e[7],v=e[11],_=e[15];return m*(+a*l*h-i*u*h-a*s*d+n*u*d+i*s*p-n*l*p)+y*(+r*l*p-r*u*d+a*o*d-i*o*p+i*u*c-a*l*c)+v*(+r*u*h-r*s*p-a*o*h+n*o*p+a*s*c-n*u*c)+_*(-i*s*c-r*l*h+r*s*d+i*o*h-n*o*d+n*l*c)}transpose(){let e=this.elements,r;return r=e[1],e[1]=e[4],e[4]=r,r=e[2],e[2]=e[8],e[8]=r,r=e[6],e[6]=e[9],e[9]=r,r=e[3],e[3]=e[12],e[12]=r,r=e[7],e[7]=e[13],e[13]=r,r=e[11],e[11]=e[14],e[14]=r,this}setPosition(e,r,n){let i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=r,i[14]=n),this}invert(){let e=this.elements,r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],p=e[11],m=e[12],y=e[13],v=e[14],_=e[15],w=h*v*u-y*d*u+y*l*p-s*v*p-h*l*_+s*d*_,b=m*d*u-c*v*u-m*l*p+o*v*p+c*l*_-o*d*_,A=c*y*u-m*h*u+m*s*p-o*y*p-c*s*_+o*h*_,E=m*h*l-c*y*l-m*s*d+o*y*d+c*s*v-o*h*v,M=r*w+n*b+i*A+a*E;if(M===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let P=1/M;return e[0]=w*P,e[1]=(y*d*a-h*v*a-y*i*p+n*v*p+h*i*_-n*d*_)*P,e[2]=(s*v*a-y*l*a+y*i*u-n*v*u-s*i*_+n*l*_)*P,e[3]=(h*l*a-s*d*a-h*i*u+n*d*u+s*i*p-n*l*p)*P,e[4]=b*P,e[5]=(c*v*a-m*d*a+m*i*p-r*v*p-c*i*_+r*d*_)*P,e[6]=(m*l*a-o*v*a-m*i*u+r*v*u+o*i*_-r*l*_)*P,e[7]=(o*d*a-c*l*a+c*i*u-r*d*u-o*i*p+r*l*p)*P,e[8]=A*P,e[9]=(m*h*a-c*y*a-m*n*p+r*y*p+c*n*_-r*h*_)*P,e[10]=(o*y*a-m*s*a+m*n*u-r*y*u-o*n*_+r*s*_)*P,e[11]=(c*s*a-o*h*a-c*n*u+r*h*u+o*n*p-r*s*p)*P,e[12]=E*P,e[13]=(c*y*i-m*h*i+m*n*d-r*y*d-c*n*v+r*h*v)*P,e[14]=(m*s*i-o*y*i-m*n*l+r*y*l+o*n*v-r*s*v)*P,e[15]=(o*h*i-c*s*i+c*n*l-r*h*l-o*n*d+r*s*d)*P,this}scale(e){let r=this.elements,n=e.x,i=e.y,a=e.z;return r[0]*=n,r[4]*=i,r[8]*=a,r[1]*=n,r[5]*=i,r[9]*=a,r[2]*=n,r[6]*=i,r[10]*=a,r[3]*=n,r[7]*=i,r[11]*=a,this}getMaxScaleOnAxis(){let e=this.elements,r=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(r,n,i))}makeTranslation(e,r,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,r,0,0,1,n,0,0,0,1),this}makeRotationX(e){let r=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,r,-n,0,0,n,r,0,0,0,0,1),this}makeRotationY(e){let r=Math.cos(e),n=Math.sin(e);return this.set(r,0,n,0,0,1,0,0,-n,0,r,0,0,0,0,1),this}makeRotationZ(e){let r=Math.cos(e),n=Math.sin(e);return this.set(r,-n,0,0,n,r,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,r){let n=Math.cos(r),i=Math.sin(r),a=1-n,o=e.x,s=e.y,l=e.z,u=a*o,c=a*s;return this.set(u*o+n,u*s-i*l,u*l+i*s,0,u*s+i*l,c*s+n,c*l-i*o,0,u*l-i*s,c*l+i*o,a*l*l+n,0,0,0,0,1),this}makeScale(e,r,n){return this.set(e,0,0,0,0,r,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,r,n,i,a,o){return this.set(1,n,a,0,e,1,o,0,r,i,1,0,0,0,0,1),this}compose(e,r,n){let i=this.elements,a=r._x,o=r._y,s=r._z,l=r._w,u=a+a,c=o+o,h=s+s,d=a*u,p=a*c,m=a*h,y=o*c,v=o*h,_=s*h,w=l*u,b=l*c,A=l*h,E=n.x,M=n.y,P=n.z;return i[0]=(1-(y+_))*E,i[1]=(p+A)*E,i[2]=(m-b)*E,i[3]=0,i[4]=(p-A)*M,i[5]=(1-(d+_))*M,i[6]=(v+w)*M,i[7]=0,i[8]=(m+b)*P,i[9]=(v-w)*P,i[10]=(1-(d+y))*P,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,r,n){let i=this.elements,a=mf.set(i[0],i[1],i[2]).length(),o=mf.set(i[4],i[5],i[6]).length(),s=mf.set(i[8],i[9],i[10]).length();this.determinant()<0&&(a=-a),e.x=i[12],e.y=i[13],e.z=i[14],al.copy(this);let l=1/a,u=1/o,c=1/s;return al.elements[0]*=l,al.elements[1]*=l,al.elements[2]*=l,al.elements[4]*=u,al.elements[5]*=u,al.elements[6]*=u,al.elements[8]*=c,al.elements[9]*=c,al.elements[10]*=c,r.setFromRotationMatrix(al),n.x=a,n.y=o,n.z=s,this}makePerspective(e,r,n,i,a,o,s=Tc){let l=this.elements,u=2*a/(r-e),c=2*a/(n-i),h=(r+e)/(r-e),d=(n+i)/(n-i),p,m;if(s===Tc)p=-(o+a)/(o-a),m=-2*o*a/(o-a);else if(s===i4)p=-o/(o-a),m=-o*a/(o-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+s);return l[0]=u,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=c,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=p,l[14]=m,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,r,n,i,a,o,s=Tc){let l=this.elements,u=1/(r-e),c=1/(n-i),h=1/(o-a),d=(r+e)*u,p=(n+i)*c,m,y;if(s===Tc)m=(o+a)*h,y=-2*h;else if(s===i4)m=a*h,y=-1*h;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+s);return l[0]=2*u,l[4]=0,l[8]=0,l[12]=-d,l[1]=0,l[5]=2*c,l[9]=0,l[13]=-p,l[2]=0,l[6]=0,l[10]=y,l[14]=-m,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){let r=this.elements,n=e.elements;for(let i=0;i<16;i++)if(r[i]!==n[i])return!1;return!0}fromArray(e,r=0){for(let n=0;n<16;n++)this.elements[n]=e[n+r];return this}toArray(e=[],r=0){let n=this.elements;return e[r]=n[0],e[r+1]=n[1],e[r+2]=n[2],e[r+3]=n[3],e[r+4]=n[4],e[r+5]=n[5],e[r+6]=n[6],e[r+7]=n[7],e[r+8]=n[8],e[r+9]=n[9],e[r+10]=n[10],e[r+11]=n[11],e[r+12]=n[12],e[r+13]=n[13],e[r+14]=n[14],e[r+15]=n[15],e}},mf=new Q,al=new gr,Nie=new Q(0,0,0),$ie=new Q(1,1,1),hh=new Q,W_=new Q,Qo=new Q,jB=new gr,VB=new Iu,Vo=class tN{constructor(e=0,r=0,n=0,i=tN.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=r,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,r,n,i=this._order){return this._x=e,this._y=r,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,r=this._order,n=!0){let i=e.elements,a=i[0],o=i[4],s=i[8],l=i[1],u=i[5],c=i[9],h=i[2],d=i[6],p=i[10];switch(r){case"XYZ":this._y=Math.asin(zr(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,p),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(d,u),this._z=0);break;case"YXZ":this._x=Math.asin(-zr(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(s,p),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,a),this._z=0);break;case"ZXY":this._x=Math.asin(zr(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(l,a));break;case"ZYX":this._y=Math.asin(-zr(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(d,p),this._z=Math.atan2(l,a)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(zr(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,a)):(this._x=0,this._y=Math.atan2(s,p));break;case"XZY":this._z=Math.asin(-zr(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,u),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-c,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+r)}return this._order=r,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,r,n){return jB.makeRotationFromQuaternion(e),this.setFromRotationMatrix(jB,r,n)}setFromVector3(e,r=this._order){return this.set(e.x,e.y,e.z,r)}reorder(e){return VB.setFromEuler(this),this.setFromQuaternion(VB,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],r=0){return e[r]=this._x,e[r+1]=this._y,e[r+2]=this._z,e[r+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};Vo.DEFAULT_ORDER="XYZ";var _P=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},Uie=0,GB=new Q,gf=new Iu,ec=new gr,H_=new Q,q0=new Q,jie=new Q,Vie=new Iu,ZB=new Q(1,0,0),WB=new Q(0,1,0),HB=new Q(0,0,1),XB={type:"added"},Gie={type:"removed"},yf={type:"childadded",child:null},LS={type:"childremoved",child:null},Yn=class Nb extends c0{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Uie++}),this.uuid=Gs(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Nb.DEFAULT_UP.clone();let e=new Q,r=new Vo,n=new Iu,i=new Q(1,1,1);function a(){n.setFromEuler(r,!1)}function o(){r.setFromQuaternion(n,void 0,!1)}r._onChange(a),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:r},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new gr},normalMatrix:{value:new Br}}),this.matrix=new gr,this.matrixWorld=new gr,this.matrixAutoUpdate=Nb.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Nb.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new _P,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,r){this.quaternion.setFromAxisAngle(e,r)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,r){return gf.setFromAxisAngle(e,r),this.quaternion.multiply(gf),this}rotateOnWorldAxis(e,r){return gf.setFromAxisAngle(e,r),this.quaternion.premultiply(gf),this}rotateX(e){return this.rotateOnAxis(ZB,e)}rotateY(e){return this.rotateOnAxis(WB,e)}rotateZ(e){return this.rotateOnAxis(HB,e)}translateOnAxis(e,r){return GB.copy(e).applyQuaternion(this.quaternion),this.position.add(GB.multiplyScalar(r)),this}translateX(e){return this.translateOnAxis(ZB,e)}translateY(e){return this.translateOnAxis(WB,e)}translateZ(e){return this.translateOnAxis(HB,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(ec.copy(this.matrixWorld).invert())}lookAt(e,r,n){e.isVector3?H_.copy(e):H_.set(e,r,n);let i=this.parent;this.updateWorldMatrix(!0,!1),q0.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ec.lookAt(q0,H_,this.up):ec.lookAt(H_,q0,this.up),this.quaternion.setFromRotationMatrix(ec),i&&(ec.extractRotation(i.matrixWorld),gf.setFromRotationMatrix(ec),this.quaternion.premultiply(gf.invert()))}add(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.add(arguments[r]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(XB),yf.child=e,this.dispatchEvent(yf),yf.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}let r=this.children.indexOf(e);return r!==-1&&(e.parent=null,this.children.splice(r,1),e.dispatchEvent(Gie),LS.child=e,this.dispatchEvent(LS),LS.child=null),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),ec.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),ec.multiply(e.parent.matrixWorld)),e.applyMatrix4(ec),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(XB),yf.child=e,this.dispatchEvent(yf),yf.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,r){if(this[e]===r)return this;for(let n=0,i=this.children.length;n<i;n++){let a=this.children[n].getObjectByProperty(e,r);if(a!==void 0)return a}}getObjectsByProperty(e,r,n=[]){this[e]===r&&n.push(this);let i=this.children;for(let a=0,o=i.length;a<o;a++)i[a].getObjectsByProperty(e,r,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(q0,e,jie),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(q0,Vie,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let r=this.matrixWorld.elements;return e.set(r[8],r[9],r[10]).normalize()}raycast(){}traverse(e){e(this);let r=this.children;for(let n=0,i=r.length;n<i;n++)r[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let r=this.children;for(let n=0,i=r.length;n<i;n++)r[n].traverseVisible(e)}traverseAncestors(e){let r=this.parent;r!==null&&(e(r),r.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);let r=this.children;for(let n=0,i=r.length;n<i;n++)r[n].updateMatrixWorld(e)}updateWorldMatrix(e,r){let n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),r===!0){let i=this.children;for(let a=0,o=i.length;a<o;a++)i[a].updateWorldMatrix(!1,!0)}}toJSON(e){let r=e===void 0||typeof e=="string",n={};r&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});let i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map(s=>({boxInitialized:s.boxInitialized,boxMin:s.box.min.toArray(),boxMax:s.box.max.toArray(),sphereInitialized:s.sphereInitialized,sphereRadius:s.sphere.radius,sphereCenter:s.sphere.center.toArray()})),i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(i.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()}));function a(s,l){return s[l.uuid]===void 0&&(s[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=a(e.geometries,this.geometry);let s=this.geometry.parameters;if(s!==void 0&&s.shapes!==void 0){let l=s.shapes;if(Array.isArray(l))for(let u=0,c=l.length;u<c;u++){let h=l[u];a(e.shapes,h)}else a(e.shapes,l)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let s=[];for(let l=0,u=this.material.length;l<u;l++)s.push(a(e.materials,this.material[l]));i.material=s}else i.material=a(e.materials,this.material);if(this.children.length>0){i.children=[];for(let s=0;s<this.children.length;s++)i.children.push(this.children[s].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let s=0;s<this.animations.length;s++){let l=this.animations[s];i.animations.push(a(e.animations,l))}}if(r){let s=o(e.geometries),l=o(e.materials),u=o(e.textures),c=o(e.images),h=o(e.shapes),d=o(e.skeletons),p=o(e.animations),m=o(e.nodes);s.length>0&&(n.geometries=s),l.length>0&&(n.materials=l),u.length>0&&(n.textures=u),c.length>0&&(n.images=c),h.length>0&&(n.shapes=h),d.length>0&&(n.skeletons=d),p.length>0&&(n.animations=p),m.length>0&&(n.nodes=m)}return n.object=i,n;function o(s){let l=[];for(let u in s){let c=s[u];delete c.metadata,l.push(c)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,r=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),r===!0)for(let n=0;n<e.children.length;n++){let i=e.children[n];this.add(i.clone())}return this}};Yn.DEFAULT_UP=new Q(0,1,0);Yn.DEFAULT_MATRIX_AUTO_UPDATE=!0;Yn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var ol=new Q,tc=new Q,NS=new Q,rc=new Q,vf=new Q,_f=new Q,qB=new Q,$S=new Q,US=new Q,jS=new Q,VS=new _n,GS=new _n,ZS=new _n,zf=class Ff{constructor(e=new Q,r=new Q,n=new Q){this.a=e,this.b=r,this.c=n}static getNormal(e,r,n,i){i.subVectors(n,r),ol.subVectors(e,r),i.cross(ol);let a=i.lengthSq();return a>0?i.multiplyScalar(1/Math.sqrt(a)):i.set(0,0,0)}static getBarycoord(e,r,n,i,a){ol.subVectors(i,r),tc.subVectors(n,r),NS.subVectors(e,r);let o=ol.dot(ol),s=ol.dot(tc),l=ol.dot(NS),u=tc.dot(tc),c=tc.dot(NS),h=o*u-s*s;if(h===0)return a.set(0,0,0),null;let d=1/h,p=(u*l-s*c)*d,m=(o*c-s*l)*d;return a.set(1-p-m,m,p)}static containsPoint(e,r,n,i){return this.getBarycoord(e,r,n,i,rc)===null?!1:rc.x>=0&&rc.y>=0&&rc.x+rc.y<=1}static getInterpolation(e,r,n,i,a,o,s,l){return this.getBarycoord(e,r,n,i,rc)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(a,rc.x),l.addScaledVector(o,rc.y),l.addScaledVector(s,rc.z),l)}static getInterpolatedAttribute(e,r,n,i,a,o){return VS.setScalar(0),GS.setScalar(0),ZS.setScalar(0),VS.fromBufferAttribute(e,r),GS.fromBufferAttribute(e,n),ZS.fromBufferAttribute(e,i),o.setScalar(0),o.addScaledVector(VS,a.x),o.addScaledVector(GS,a.y),o.addScaledVector(ZS,a.z),o}static isFrontFacing(e,r,n,i){return ol.subVectors(n,r),tc.subVectors(e,r),ol.cross(tc).dot(i)<0}set(e,r,n){return this.a.copy(e),this.b.copy(r),this.c.copy(n),this}setFromPointsAndIndices(e,r,n,i){return this.a.copy(e[r]),this.b.copy(e[n]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,r,n,i){return this.a.fromBufferAttribute(e,r),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ol.subVectors(this.c,this.b),tc.subVectors(this.a,this.b),ol.cross(tc).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Ff.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,r){return Ff.getBarycoord(e,this.a,this.b,this.c,r)}getInterpolation(e,r,n,i,a){return Ff.getInterpolation(e,this.a,this.b,this.c,r,n,i,a)}containsPoint(e){return Ff.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Ff.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,r){let n=this.a,i=this.b,a=this.c,o,s;vf.subVectors(i,n),_f.subVectors(a,n),$S.subVectors(e,n);let l=vf.dot($S),u=_f.dot($S);if(l<=0&&u<=0)return r.copy(n);US.subVectors(e,i);let c=vf.dot(US),h=_f.dot(US);if(c>=0&&h<=c)return r.copy(i);let d=l*h-c*u;if(d<=0&&l>=0&&c<=0)return o=l/(l-c),r.copy(n).addScaledVector(vf,o);jS.subVectors(e,a);let p=vf.dot(jS),m=_f.dot(jS);if(m>=0&&p<=m)return r.copy(a);let y=p*u-l*m;if(y<=0&&u>=0&&m<=0)return s=u/(u-m),r.copy(n).addScaledVector(_f,s);let v=c*m-p*h;if(v<=0&&h-c>=0&&p-m>=0)return qB.subVectors(a,i),s=(h-c)/(h-c+(p-m)),r.copy(i).addScaledVector(qB,s);let _=1/(v+y+d);return o=y*_,s=d*_,r.copy(n).addScaledVector(vf,o).addScaledVector(_f,s)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},rN={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},dh={h:0,s:0,l:0},X_={h:0,s:0,l:0};function WS(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*6*(2/3-r):t}var jt=class{constructor(e,r,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,r,n)}set(e,r,n){if(r===void 0&&n===void 0){let i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,r,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,r=Za){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,an.toWorkingColorSpace(this,r),this}setRGB(e,r,n,i=an.workingColorSpace){return this.r=e,this.g=r,this.b=n,an.toWorkingColorSpace(this,i),this}setHSL(e,r,n,i=an.workingColorSpace){if(e=vP(e,1),r=zr(r,0,1),n=zr(n,0,1),r===0)this.r=this.g=this.b=n;else{let a=n<=.5?n*(1+r):n+r-n*r,o=2*n-a;this.r=WS(o,a,e+1/3),this.g=WS(o,a,e),this.b=WS(o,a,e-1/3)}return an.toWorkingColorSpace(this,i),this}setStyle(e,r=Za){function n(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let a,o=i[1],s=i[2];switch(o){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,r);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,r);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,r);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){let a=i[1],o=a.length;if(o===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,r);if(o===6)return this.setHex(parseInt(a,16),r);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,r);return this}setColorName(e,r=Za){let n=rN[e.toLowerCase()];return n!==void 0?this.setHex(n,r):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Rc(e.r),this.g=Rc(e.g),this.b=Rc(e.b),this}copyLinearToSRGB(e){return this.r=Qm(e.r),this.g=Qm(e.g),this.b=Qm(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Za){return an.fromWorkingColorSpace(La.copy(this),e),Math.round(zr(La.r*255,0,255))*65536+Math.round(zr(La.g*255,0,255))*256+Math.round(zr(La.b*255,0,255))}getHexString(e=Za){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,r=an.workingColorSpace){an.fromWorkingColorSpace(La.copy(this),r);let n=La.r,i=La.g,a=La.b,o=Math.max(n,i,a),s=Math.min(n,i,a),l,u,c=(s+o)/2;if(s===o)l=0,u=0;else{let h=o-s;switch(u=c<=.5?h/(o+s):h/(2-o-s),o){case n:l=(i-a)/h+(i<a?6:0);break;case i:l=(a-n)/h+2;break;case a:l=(n-i)/h+4;break}l/=6}return e.h=l,e.s=u,e.l=c,e}getRGB(e,r=an.workingColorSpace){return an.fromWorkingColorSpace(La.copy(this),r),e.r=La.r,e.g=La.g,e.b=La.b,e}getStyle(e=Za){an.fromWorkingColorSpace(La.copy(this),e);let r=La.r,n=La.g,i=La.b;return e!==Za?"color(".concat(e," ").concat(r.toFixed(3)," ").concat(n.toFixed(3)," ").concat(i.toFixed(3),")"):"rgb(".concat(Math.round(r*255),",").concat(Math.round(n*255),",").concat(Math.round(i*255),")")}offsetHSL(e,r,n){return this.getHSL(dh),this.setHSL(dh.h+e,dh.s+r,dh.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,r){return this.r=e.r+r.r,this.g=e.g+r.g,this.b=e.b+r.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,r){return this.r+=(e.r-this.r)*r,this.g+=(e.g-this.g)*r,this.b+=(e.b-this.b)*r,this}lerpColors(e,r,n){return this.r=e.r+(r.r-e.r)*n,this.g=e.g+(r.g-e.g)*n,this.b=e.b+(r.b-e.b)*n,this}lerpHSL(e,r){this.getHSL(dh),e.getHSL(X_);let n=Dv(dh.h,X_.h,r),i=Dv(dh.s,X_.s,r),a=Dv(dh.l,X_.l,r);return this.setHSL(n,i,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){let r=this.r,n=this.g,i=this.b,a=e.elements;return this.r=a[0]*r+a[3]*n+a[6]*i,this.g=a[1]*r+a[4]*n+a[7]*i,this.b=a[2]*r+a[5]*n+a[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,r=0){return this.r=e[r],this.g=e[r+1],this.b=e[r+2],this}toArray(e=[],r=0){return e[r]=this.r,e[r+1]=this.g,e[r+2]=this.b,e}fromBufferAttribute(e,r){return this.r=e.getX(r),this.g=e.getY(r),this.b=e.getZ(r),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}},La=new jt;jt.NAMES=rN;var Zie=0,gd=class extends c0{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Zie++}),this.uuid=Gs(),this.name="",this.type="Material",this.blending=qm,this.side=_s,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=$I,this.blendDst=UI,this.blendEquation=ip,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new jt(0,0,0),this.blendAlpha=0,this.depthFunc=mg,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=n4,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=bc,this.stencilZFail=bc,this.stencilZPass=bc,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let r in e){let n=e[r];if(n===void 0){console.warn("THREE.Material: parameter '".concat(r,"' has value of undefined."));continue}let i=this[r];if(i===void 0){console.warn("THREE.Material: '".concat(r,"' is not a property of THREE.").concat(this.type,"."));continue}i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[r]=n}}toJSON(e){let r=e===void 0||typeof e=="string";r&&(e={textures:{},images:{}});let n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==qm&&(n.blending=this.blending),this.side!==_s&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==$I&&(n.blendSrc=this.blendSrc),this.blendDst!==UI&&(n.blendDst=this.blendDst),this.blendEquation!==ip&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==mg&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==n4&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==bc&&(n.stencilFail=this.stencilFail),this.stencilZFail!==bc&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==bc&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function i(a){let o=[];for(let s in a){let l=a[s];delete l.metadata,o.push(l)}return o}if(r){let a=i(e.textures),o=i(e.images);a.length>0&&(n.textures=a),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let r=e.clippingPlanes,n=null;if(r!==null){let i=r.length;n=new Array(i);for(let a=0;a!==i;++a)n[a]=r[a].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}},Go=class extends gd{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new jt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Vo,this.combine=cP,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},Gi=new Q,q_=new Je,Wie=0,Xn=class{constructor(e,r,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:Wie++}),this.name="",this.array=e,this.itemSize=r,this.count=e!==void 0?e.length/r:0,this.normalized=n,this.usage=SC,this.updateRanges=[],this.gpuType=ps,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,r){this.updateRanges.push({start:e,count:r})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,r,n){e*=this.itemSize,n*=r.itemSize;for(let i=0,a=this.itemSize;i<a;i++)this.array[e+i]=r.array[n+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let r=0,n=this.count;r<n;r++)q_.fromBufferAttribute(this,r),q_.applyMatrix3(e),this.setXY(r,q_.x,q_.y);else if(this.itemSize===3)for(let r=0,n=this.count;r<n;r++)Gi.fromBufferAttribute(this,r),Gi.applyMatrix3(e),this.setXYZ(r,Gi.x,Gi.y,Gi.z);return this}applyMatrix4(e){for(let r=0,n=this.count;r<n;r++)Gi.fromBufferAttribute(this,r),Gi.applyMatrix4(e),this.setXYZ(r,Gi.x,Gi.y,Gi.z);return this}applyNormalMatrix(e){for(let r=0,n=this.count;r<n;r++)Gi.fromBufferAttribute(this,r),Gi.applyNormalMatrix(e),this.setXYZ(r,Gi.x,Gi.y,Gi.z);return this}transformDirection(e){for(let r=0,n=this.count;r<n;r++)Gi.fromBufferAttribute(this,r),Gi.transformDirection(e),this.setXYZ(r,Gi.x,Gi.y,Gi.z);return this}set(e,r=0){return this.array.set(e,r),this}getComponent(e,r){let n=this.array[e*this.itemSize+r];return this.normalized&&(n=Il(n,this.array)),n}setComponent(e,r,n){return this.normalized&&(n=bn(n,this.array)),this.array[e*this.itemSize+r]=n,this}getX(e){let r=this.array[e*this.itemSize];return this.normalized&&(r=Il(r,this.array)),r}setX(e,r){return this.normalized&&(r=bn(r,this.array)),this.array[e*this.itemSize]=r,this}getY(e){let r=this.array[e*this.itemSize+1];return this.normalized&&(r=Il(r,this.array)),r}setY(e,r){return this.normalized&&(r=bn(r,this.array)),this.array[e*this.itemSize+1]=r,this}getZ(e){let r=this.array[e*this.itemSize+2];return this.normalized&&(r=Il(r,this.array)),r}setZ(e,r){return this.normalized&&(r=bn(r,this.array)),this.array[e*this.itemSize+2]=r,this}getW(e){let r=this.array[e*this.itemSize+3];return this.normalized&&(r=Il(r,this.array)),r}setW(e,r){return this.normalized&&(r=bn(r,this.array)),this.array[e*this.itemSize+3]=r,this}setXY(e,r,n){return e*=this.itemSize,this.normalized&&(r=bn(r,this.array),n=bn(n,this.array)),this.array[e+0]=r,this.array[e+1]=n,this}setXYZ(e,r,n,i){return e*=this.itemSize,this.normalized&&(r=bn(r,this.array),n=bn(n,this.array),i=bn(i,this.array)),this.array[e+0]=r,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,r,n,i,a){return e*=this.itemSize,this.normalized&&(r=bn(r,this.array),n=bn(n,this.array),i=bn(i,this.array),a=bn(a,this.array)),this.array[e+0]=r,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==SC&&(e.usage=this.usage),e}},nN=class extends Xn{constructor(e,r,n){super(new Uint16Array(e),r,n)}},iN=class extends Xn{constructor(e,r,n){super(new Uint32Array(e),r,n)}},vo=class extends Xn{constructor(e,r,n){super(new Float32Array(e),r,n)}},Hie=0,Ps=new gr,HS=new Yn,xf=new Q,es=new qn,Y0=new qn,ca=new Q,Ja=class aN extends c0{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Hie++}),this.uuid=Gs(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Y9(e)?iN:nN)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,r){return this.attributes[e]=r,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,r,n=0){this.groups.push({start:e,count:r,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,r){this.drawRange.start=e,this.drawRange.count=r}applyMatrix4(e){let r=this.attributes.position;r!==void 0&&(r.applyMatrix4(e),r.needsUpdate=!0);let n=this.attributes.normal;if(n!==void 0){let a=new Br().getNormalMatrix(e);n.applyNormalMatrix(a),n.needsUpdate=!0}let i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Ps.makeRotationFromQuaternion(e),this.applyMatrix4(Ps),this}rotateX(e){return Ps.makeRotationX(e),this.applyMatrix4(Ps),this}rotateY(e){return Ps.makeRotationY(e),this.applyMatrix4(Ps),this}rotateZ(e){return Ps.makeRotationZ(e),this.applyMatrix4(Ps),this}translate(e,r,n){return Ps.makeTranslation(e,r,n),this.applyMatrix4(Ps),this}scale(e,r,n){return Ps.makeScale(e,r,n),this.applyMatrix4(Ps),this}lookAt(e){return HS.lookAt(e),HS.updateMatrix(),this.applyMatrix4(HS.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(xf).negate(),this.translate(xf.x,xf.y,xf.z),this}setFromPoints(e){let r=this.getAttribute("position");if(r===void 0){let n=[];for(let i=0,a=e.length;i<a;i++){let o=e[i];n.push(o.x,o.y,o.z||0)}this.setAttribute("position",new vo(n,3))}else{let n=Math.min(e.length,r.count);for(let i=0;i<n;i++){let a=e[i];r.setXYZ(i,a.x,a.y,a.z||0)}e.length>r.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),r.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new qn);let e=this.attributes.position,r=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Q(-1/0,-1/0,-1/0),new Q(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),r)for(let n=0,i=r.length;n<i;n++){let a=r[n];es.setFromBufferAttribute(a),this.morphTargetsRelative?(ca.addVectors(this.boundingBox.min,es.min),this.boundingBox.expandByPoint(ca),ca.addVectors(this.boundingBox.max,es.max),this.boundingBox.expandByPoint(ca)):(this.boundingBox.expandByPoint(es.min),this.boundingBox.expandByPoint(es.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new jo);let e=this.attributes.position,r=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Q,1/0);return}if(e){let n=this.boundingSphere.center;if(es.setFromBufferAttribute(e),r)for(let a=0,o=r.length;a<o;a++){let s=r[a];Y0.setFromBufferAttribute(s),this.morphTargetsRelative?(ca.addVectors(es.min,Y0.min),es.expandByPoint(ca),ca.addVectors(es.max,Y0.max),es.expandByPoint(ca)):(es.expandByPoint(Y0.min),es.expandByPoint(Y0.max))}es.getCenter(n);let i=0;for(let a=0,o=e.count;a<o;a++)ca.fromBufferAttribute(e,a),i=Math.max(i,n.distanceToSquared(ca));if(r)for(let a=0,o=r.length;a<o;a++){let s=r[a],l=this.morphTargetsRelative;for(let u=0,c=s.count;u<c;u++)ca.fromBufferAttribute(s,u),l&&(xf.fromBufferAttribute(e,u),ca.add(xf)),i=Math.max(i,n.distanceToSquared(ca))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,r=this.attributes;if(e===null||r.position===void 0||r.normal===void 0||r.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let n=r.position,i=r.normal,a=r.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Xn(new Float32Array(4*n.count),4));let o=this.getAttribute("tangent"),s=[],l=[];for(let k=0;k<n.count;k++)s[k]=new Q,l[k]=new Q;let u=new Q,c=new Q,h=new Q,d=new Je,p=new Je,m=new Je,y=new Q,v=new Q;function _(k,D,O){u.fromBufferAttribute(n,k),c.fromBufferAttribute(n,D),h.fromBufferAttribute(n,O),d.fromBufferAttribute(a,k),p.fromBufferAttribute(a,D),m.fromBufferAttribute(a,O),c.sub(u),h.sub(u),p.sub(d),m.sub(d);let B=1/(p.x*m.y-m.x*p.y);isFinite(B)&&(y.copy(c).multiplyScalar(m.y).addScaledVector(h,-p.y).multiplyScalar(B),v.copy(h).multiplyScalar(p.x).addScaledVector(c,-m.x).multiplyScalar(B),s[k].add(y),s[D].add(y),s[O].add(y),l[k].add(v),l[D].add(v),l[O].add(v))}let w=this.groups;w.length===0&&(w=[{start:0,count:e.count}]);for(let k=0,D=w.length;k<D;++k){let O=w[k],B=O.start,L=O.count;for(let R=B,T=B+L;R<T;R+=3)_(e.getX(R+0),e.getX(R+1),e.getX(R+2))}let b=new Q,A=new Q,E=new Q,M=new Q;function P(k){E.fromBufferAttribute(i,k),M.copy(E);let D=s[k];b.copy(D),b.sub(E.multiplyScalar(E.dot(D))).normalize(),A.crossVectors(M,D);let O=A.dot(l[k])<0?-1:1;o.setXYZW(k,b.x,b.y,b.z,O)}for(let k=0,D=w.length;k<D;++k){let O=w[k],B=O.start,L=O.count;for(let R=B,T=B+L;R<T;R+=3)P(e.getX(R+0)),P(e.getX(R+1)),P(e.getX(R+2))}}computeVertexNormals(){let e=this.index,r=this.getAttribute("position");if(r!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Xn(new Float32Array(r.count*3),3),this.setAttribute("normal",n);else for(let d=0,p=n.count;d<p;d++)n.setXYZ(d,0,0,0);let i=new Q,a=new Q,o=new Q,s=new Q,l=new Q,u=new Q,c=new Q,h=new Q;if(e)for(let d=0,p=e.count;d<p;d+=3){let m=e.getX(d+0),y=e.getX(d+1),v=e.getX(d+2);i.fromBufferAttribute(r,m),a.fromBufferAttribute(r,y),o.fromBufferAttribute(r,v),c.subVectors(o,a),h.subVectors(i,a),c.cross(h),s.fromBufferAttribute(n,m),l.fromBufferAttribute(n,y),u.fromBufferAttribute(n,v),s.add(c),l.add(c),u.add(c),n.setXYZ(m,s.x,s.y,s.z),n.setXYZ(y,l.x,l.y,l.z),n.setXYZ(v,u.x,u.y,u.z)}else for(let d=0,p=r.count;d<p;d+=3)i.fromBufferAttribute(r,d+0),a.fromBufferAttribute(r,d+1),o.fromBufferAttribute(r,d+2),c.subVectors(o,a),h.subVectors(i,a),c.cross(h),n.setXYZ(d+0,c.x,c.y,c.z),n.setXYZ(d+1,c.x,c.y,c.z),n.setXYZ(d+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let r=0,n=e.count;r<n;r++)ca.fromBufferAttribute(e,r),ca.normalize(),e.setXYZ(r,ca.x,ca.y,ca.z)}toNonIndexed(){function e(s,l){let u=s.array,c=s.itemSize,h=s.normalized,d=new u.constructor(l.length*c),p=0,m=0;for(let y=0,v=l.length;y<v;y++){s.isInterleavedBufferAttribute?p=l[y]*s.data.stride+s.offset:p=l[y]*c;for(let _=0;_<c;_++)d[m++]=u[p++]}return new Xn(d,c,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let r=new aN,n=this.index.array,i=this.attributes;for(let s in i){let l=i[s],u=e(l,n);r.setAttribute(s,u)}let a=this.morphAttributes;for(let s in a){let l=[],u=a[s];for(let c=0,h=u.length;c<h;c++){let d=u[c],p=e(d,n);l.push(p)}r.morphAttributes[s]=l}r.morphTargetsRelative=this.morphTargetsRelative;let o=this.groups;for(let s=0,l=o.length;s<l;s++){let u=o[s];r.addGroup(u.start,u.count,u.materialIndex)}return r}toJSON(){let e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let l=this.parameters;for(let u in l)l[u]!==void 0&&(e[u]=l[u]);return e}e.data={attributes:{}};let r=this.index;r!==null&&(e.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});let n=this.attributes;for(let l in n){let u=n[l];e.data.attributes[l]=u.toJSON(e.data)}let i={},a=!1;for(let l in this.morphAttributes){let u=this.morphAttributes[l],c=[];for(let h=0,d=u.length;h<d;h++){let p=u[h];c.push(p.toJSON(e.data))}c.length>0&&(i[l]=c,a=!0)}a&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);let o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));let s=this.boundingSphere;return s!==null&&(e.data.boundingSphere={center:s.center.toArray(),radius:s.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let r={};this.name=e.name;let n=e.index;n!==null&&this.setIndex(n.clone(r));let i=e.attributes;for(let u in i){let c=i[u];this.setAttribute(u,c.clone(r))}let a=e.morphAttributes;for(let u in a){let c=[],h=a[u];for(let d=0,p=h.length;d<p;d++)c.push(h[d].clone(r));this.morphAttributes[u]=c}this.morphTargetsRelative=e.morphTargetsRelative;let o=e.groups;for(let u=0,c=o.length;u<c;u++){let h=o[u];this.addGroup(h.start,h.count,h.materialIndex)}let s=e.boundingBox;s!==null&&(this.boundingBox=s.clone());let l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}},YB=new gr,Od=new U1,Y_=new jo,JB=new Q,J_=new Q,K_=new Q,Q_=new Q,XS=new Q,ex=new Q,KB=new Q,tx=new Q,Er=class extends Yn{constructor(e=new Ja,r=new Go){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=r,this.updateMorphTargets()}copy(e,r){return super.copy(e,r),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,r=Object.keys(e);if(r.length>0){let n=e[r[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,a=n.length;i<a;i++){let o=n[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=i}}}}getVertexPosition(e,r){let n=this.geometry,i=n.attributes.position,a=n.morphAttributes.position,o=n.morphTargetsRelative;r.fromBufferAttribute(i,e);let s=this.morphTargetInfluences;if(a&&s){ex.set(0,0,0);for(let l=0,u=a.length;l<u;l++){let c=s[l],h=a[l];c!==0&&(XS.fromBufferAttribute(h,e),o?ex.addScaledVector(XS,c):ex.addScaledVector(XS.sub(r),c))}r.add(ex)}return r}raycast(e,r){let n=this.geometry,i=this.material,a=this.matrixWorld;i!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),Y_.copy(n.boundingSphere),Y_.applyMatrix4(a),Od.copy(e.ray).recast(e.near),!(Y_.containsPoint(Od.origin)===!1&&(Od.intersectSphere(Y_,JB)===null||Od.origin.distanceToSquared(JB)>(e.far-e.near)**2))&&(YB.copy(a).invert(),Od.copy(e.ray).applyMatrix4(YB),!(n.boundingBox!==null&&Od.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,r,Od)))}_computeIntersections(e,r,n){let i,a=this.geometry,o=this.material,s=a.index,l=a.attributes.position,u=a.attributes.uv,c=a.attributes.uv1,h=a.attributes.normal,d=a.groups,p=a.drawRange;if(s!==null)if(Array.isArray(o))for(let m=0,y=d.length;m<y;m++){let v=d[m],_=o[v.materialIndex],w=Math.max(v.start,p.start),b=Math.min(s.count,Math.min(v.start+v.count,p.start+p.count));for(let A=w,E=b;A<E;A+=3){let M=s.getX(A),P=s.getX(A+1),k=s.getX(A+2);i=rx(this,_,e,n,u,c,h,M,P,k),i&&(i.faceIndex=Math.floor(A/3),i.face.materialIndex=v.materialIndex,r.push(i))}}else{let m=Math.max(0,p.start),y=Math.min(s.count,p.start+p.count);for(let v=m,_=y;v<_;v+=3){let w=s.getX(v),b=s.getX(v+1),A=s.getX(v+2);i=rx(this,o,e,n,u,c,h,w,b,A),i&&(i.faceIndex=Math.floor(v/3),r.push(i))}}else if(l!==void 0)if(Array.isArray(o))for(let m=0,y=d.length;m<y;m++){let v=d[m],_=o[v.materialIndex],w=Math.max(v.start,p.start),b=Math.min(l.count,Math.min(v.start+v.count,p.start+p.count));for(let A=w,E=b;A<E;A+=3){let M=A,P=A+1,k=A+2;i=rx(this,_,e,n,u,c,h,M,P,k),i&&(i.faceIndex=Math.floor(A/3),i.face.materialIndex=v.materialIndex,r.push(i))}}else{let m=Math.max(0,p.start),y=Math.min(l.count,p.start+p.count);for(let v=m,_=y;v<_;v+=3){let w=v,b=v+1,A=v+2;i=rx(this,o,e,n,u,c,h,w,b,A),i&&(i.faceIndex=Math.floor(v/3),r.push(i))}}}};function Xie(t,e,r,n,i,a,o,s){let l;if(e.side===xa?l=n.intersectTriangle(o,a,i,!0,s):l=n.intersectTriangle(i,a,o,e.side===_s,s),l===null)return null;tx.copy(s),tx.applyMatrix4(t.matrixWorld);let u=r.ray.origin.distanceTo(tx);return u<r.near||u>r.far?null:{distance:u,point:tx.clone(),object:t}}function rx(t,e,r,n,i,a,o,s,l,u){t.getVertexPosition(s,J_),t.getVertexPosition(l,K_),t.getVertexPosition(u,Q_);let c=Xie(t,e,r,n,J_,K_,Q_,KB);if(c){let h=new Q;zf.getBarycoord(KB,J_,K_,Q_,h),i&&(c.uv=zf.getInterpolatedAttribute(i,s,l,u,h,new Je)),a&&(c.uv1=zf.getInterpolatedAttribute(a,s,l,u,h,new Je)),o&&(c.normal=zf.getInterpolatedAttribute(o,s,l,u,h,new Q),c.normal.dot(n.direction)>0&&c.normal.multiplyScalar(-1));let d={a:s,b:l,c:u,normal:new Q,materialIndex:0};zf.getNormal(J_,K_,Q_,d.normal),c.face=d,c.barycoord=h}return c}var od=class oN extends Ja{constructor(e=1,r=1,n=1,i=1,a=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:r,depth:n,widthSegments:i,heightSegments:a,depthSegments:o};let s=this;i=Math.floor(i),a=Math.floor(a),o=Math.floor(o);let l=[],u=[],c=[],h=[],d=0,p=0;m("z","y","x",-1,-1,n,r,e,o,a,0),m("z","y","x",1,-1,n,r,-e,o,a,1),m("x","z","y",1,1,e,n,r,i,o,2),m("x","z","y",1,-1,e,n,-r,i,o,3),m("x","y","z",1,-1,e,r,n,i,a,4),m("x","y","z",-1,-1,e,r,-n,i,a,5),this.setIndex(l),this.setAttribute("position",new vo(u,3)),this.setAttribute("normal",new vo(c,3)),this.setAttribute("uv",new vo(h,2));function m(y,v,_,w,b,A,E,M,P,k,D){let O=A/P,B=E/k,L=A/2,R=E/2,T=M/2,N=P+1,$=k+1,V=0,G=0,ee=new Q;for(let ie=0;ie<$;ie++){let me=ie*B-R;for(let Me=0;Me<N;Me++){let Ae=Me*O-L;ee[y]=Ae*w,ee[v]=me*b,ee[_]=T,u.push(ee.x,ee.y,ee.z),ee[y]=0,ee[v]=0,ee[_]=M>0?1:-1,c.push(ee.x,ee.y,ee.z),h.push(Me/P),h.push(1-ie/k),V+=1}}for(let ie=0;ie<k;ie++)for(let me=0;me<P;me++){let Me=d+me+N*ie,Ae=d+me+N*(ie+1),le=d+(me+1)+N*(ie+1),_e=d+(me+1)+N*ie;l.push(Me,Ae,_e),l.push(Ae,le,_e),G+=6}s.addGroup(p,G,D),p+=G,d+=V}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new oN(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function bg(t){let e={};for(let r in t){e[r]={};for(let n in t[r]){let i=t[r][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[r][n]=null):e[r][n]=i.clone():Array.isArray(i)?e[r][n]=i.slice():e[r][n]=i}}return e}function uo(t){let e={};for(let r=0;r<t.length;r++){let n=bg(t[r]);for(let i in n)e[i]=n[i]}return e}function qie(t){let e=[];for(let r=0;r<t.length;r++)e.push(t[r].clone());return e}function sN(t){let e=t.getRenderTarget();return e===null?t.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:an.workingColorSpace}var Yie={clone:bg,merge:uo},Jie=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Kie=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,ys=class extends gd{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Jie,this.fragmentShader=Kie,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=bg(e.uniforms),this.uniformsGroups=qie(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let r=super.toJSON(e);r.glslVersion=this.glslVersion,r.uniforms={};for(let i in this.uniforms){let a=this.uniforms[i].value;a&&a.isTexture?r.uniforms[i]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?r.uniforms[i]={type:"c",value:a.getHex()}:a&&a.isVector2?r.uniforms[i]={type:"v2",value:a.toArray()}:a&&a.isVector3?r.uniforms[i]={type:"v3",value:a.toArray()}:a&&a.isVector4?r.uniforms[i]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?r.uniforms[i]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?r.uniforms[i]={type:"m4",value:a.toArray()}:r.uniforms[i]={value:a}}Object.keys(this.defines).length>0&&(r.defines=this.defines),r.vertexShader=this.vertexShader,r.fragmentShader=this.fragmentShader,r.lights=this.lights,r.clipping=this.clipping;let n={};for(let i in this.extensions)this.extensions[i]===!0&&(n[i]=!0);return Object.keys(n).length>0&&(r.extensions=n),r}},xP=class extends Yn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new gr,this.projectionMatrix=new gr,this.projectionMatrixInverse=new gr,this.coordinateSystem=Tc}copy(e,r){return super.copy(e,r),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,r){super.updateWorldMatrix(e,r),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},ph=new Q,QB=new Je,e7=new Je,co=class extends xP{constructor(e=50,r=1,n=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=r,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,r){return super.copy(e,r),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let r=.5*this.getFilmHeight()/e;this.fov=xg*2*Math.atan(r),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(Km*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return xg*2*Math.atan(Math.tan(Km*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,r,n){ph.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(ph.x,ph.y).multiplyScalar(-e/ph.z),ph.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(ph.x,ph.y).multiplyScalar(-e/ph.z)}getViewSize(e,r){return this.getViewBounds(e,QB,e7),r.subVectors(e7,QB)}setViewOffset(e,r,n,i,a,o){this.aspect=e/r,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=r,this.view.offsetX=n,this.view.offsetY=i,this.view.width=a,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,r=e*Math.tan(Km*.5*this.fov)/this.zoom,n=2*r,i=this.aspect*n,a=-.5*i,o=this.view;if(this.view!==null&&this.view.enabled){let l=o.fullWidth,u=o.fullHeight;a+=o.offsetX*i/l,r-=o.offsetY*n/u,i*=o.width/l,n*=o.height/u}let s=this.filmOffset;s!==0&&(a+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+i,r,r-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let r=super.toJSON(e);return r.object.fov=this.fov,r.object.zoom=this.zoom,r.object.near=this.near,r.object.far=this.far,r.object.focus=this.focus,r.object.aspect=this.aspect,this.view!==null&&(r.object.view=Object.assign({},this.view)),r.object.filmGauge=this.filmGauge,r.object.filmOffset=this.filmOffset,r}},bf=-90,wf=1,Qie=class extends Yn{constructor(e,r,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;let i=new co(bf,wf,e,r);i.layers=this.layers,this.add(i);let a=new co(bf,wf,e,r);a.layers=this.layers,this.add(a);let o=new co(bf,wf,e,r);o.layers=this.layers,this.add(o);let s=new co(bf,wf,e,r);s.layers=this.layers,this.add(s);let l=new co(bf,wf,e,r);l.layers=this.layers,this.add(l);let u=new co(bf,wf,e,r);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){let e=this.coordinateSystem,r=this.children.concat(),[n,i,a,o,s,l]=r;for(let u of r)this.remove(u);if(e===Tc)n.up.set(0,1,0),n.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),a.up.set(0,0,-1),a.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),s.up.set(0,1,0),s.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===i4)n.up.set(0,-1,0),n.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),a.up.set(0,0,1),a.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),s.up.set(0,-1,0),s.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(let u of r)this.add(u),u.updateMatrixWorld()}update(e,r){this.parent===null&&this.updateMatrixWorld();let{renderTarget:n,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());let[a,o,s,l,u,c]=this.children,h=e.getRenderTarget(),d=e.getActiveCubeFace(),p=e.getActiveMipmapLevel(),m=e.xr.enabled;e.xr.enabled=!1;let y=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,i),e.render(r,a),e.setRenderTarget(n,1,i),e.render(r,o),e.setRenderTarget(n,2,i),e.render(r,s),e.setRenderTarget(n,3,i),e.render(r,l),e.setRenderTarget(n,4,i),e.render(r,u),n.texture.generateMipmaps=y,e.setRenderTarget(n,5,i),e.render(r,c),e.setRenderTarget(h,d,p),e.xr.enabled=m,n.texture.needsPMREMUpdate=!0}},lN=class extends Ho{constructor(e,r,n,i,a,o,s,l,u,c){e=e!==void 0?e:[],r=r!==void 0?r:gg,super(e,r,n,i,a,o,s,l,u,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},eae=class extends ad{constructor(e=1,r={}){super(e,e,r),this.isWebGLCubeRenderTarget=!0;let n={width:e,height:e,depth:1},i=[n,n,n,n,n,n];this.texture=new lN(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=r.generateMipmaps!==void 0?r.generateMipmaps:!1,this.texture.minFilter=r.minFilter!==void 0?r.minFilter:vu}fromEquirectangularTexture(e,r){this.texture.type=r.type,this.texture.colorSpace=r.colorSpace,this.texture.generateMipmaps=r.generateMipmaps,this.texture.minFilter=r.minFilter,this.texture.magFilter=r.magFilter;let n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new od(5,5,5),a=new ys({name:"CubemapFromEquirect",uniforms:bg(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:xa,blending:Qh});a.uniforms.tEquirect.value=r;let o=new Er(i,a),s=r.minFilter;return r.minFilter===dp&&(r.minFilter=vu),new Qie(1,10,this).update(e,o),r.minFilter=s,o.geometry.dispose(),o.material.dispose(),this}clear(e,r,n,i){let a=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(r,n,i);e.setRenderTarget(a)}},pp=class extends Yn{constructor(){super(),this.isGroup=!0,this.type="Group"}},tae={type:"move"},qS=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new pp,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new pp,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Q,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Q),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new pp,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Q,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Q),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let r=this._hand;if(r)for(let n of e.hand.values())this._getHandJoint(r,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,r,n){let i=null,a=null,o=null,s=this._targetRay,l=this._grip,u=this._hand;if(e&&r.session.visibilityState!=="visible-blurred"){if(u&&e.hand){o=!0;for(let y of e.hand.values()){let v=r.getJointPose(y,n),_=this._getHandJoint(u,y);v!==null&&(_.matrix.fromArray(v.transform.matrix),_.matrix.decompose(_.position,_.rotation,_.scale),_.matrixWorldNeedsUpdate=!0,_.jointRadius=v.radius),_.visible=v!==null}let c=u.joints["index-finger-tip"],h=u.joints["thumb-tip"],d=c.position.distanceTo(h.position),p=.02,m=.005;u.inputState.pinching&&d>p+m?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&d<=p-m&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(a=r.getPose(e.gripSpace,n),a!==null&&(l.matrix.fromArray(a.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,a.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(a.linearVelocity)):l.hasLinearVelocity=!1,a.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(a.angularVelocity)):l.hasAngularVelocity=!1));s!==null&&(i=r.getPose(e.targetRaySpace,n),i===null&&a!==null&&(i=a),i!==null&&(s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,i.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(i.linearVelocity)):s.hasLinearVelocity=!1,i.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(i.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(tae)))}return s!==null&&(s.visible=i!==null),l!==null&&(l.visible=a!==null),u!==null&&(u.visible=o!==null),this}_getHandJoint(e,r){if(e.joints[r.jointName]===void 0){let n=new pp;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[r.jointName]=n,e.add(n)}return e.joints[r.jointName]}},bP=class extends Yn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Vo,this.environmentIntensity=1,this.environmentRotation=new Vo,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,r){return super.copy(e,r),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let r=super.toJSON(e);return this.fog!==null&&(r.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(r.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(r.object.backgroundIntensity=this.backgroundIntensity),r.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(r.object.environmentIntensity=this.environmentIntensity),r.object.environmentRotation=this.environmentRotation.toArray(),r}},nKe=class{constructor(e,r){this.isInterleavedBuffer=!0,this.array=e,this.stride=r,this.count=e!==void 0?e.length/r:0,this.usage=SC,this.updateRanges=[],this.version=0,this.uuid=Gs()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,r){this.updateRanges.push({start:e,count:r})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,r,n){e*=this.stride,n*=r.stride;for(let i=0,a=this.stride;i<a;i++)this.array[e+i]=r.array[n+i];return this}set(e,r=0){return this.array.set(e,r),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Gs()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let r=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(r,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Gs()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},io=new Q,aKe=class uN{constructor(e,r,n,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=r,this.offset=n,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let r=0,n=this.data.count;r<n;r++)io.fromBufferAttribute(this,r),io.applyMatrix4(e),this.setXYZ(r,io.x,io.y,io.z);return this}applyNormalMatrix(e){for(let r=0,n=this.count;r<n;r++)io.fromBufferAttribute(this,r),io.applyNormalMatrix(e),this.setXYZ(r,io.x,io.y,io.z);return this}transformDirection(e){for(let r=0,n=this.count;r<n;r++)io.fromBufferAttribute(this,r),io.transformDirection(e),this.setXYZ(r,io.x,io.y,io.z);return this}getComponent(e,r){let n=this.array[e*this.data.stride+this.offset+r];return this.normalized&&(n=Il(n,this.array)),n}setComponent(e,r,n){return this.normalized&&(n=bn(n,this.array)),this.data.array[e*this.data.stride+this.offset+r]=n,this}setX(e,r){return this.normalized&&(r=bn(r,this.array)),this.data.array[e*this.data.stride+this.offset]=r,this}setY(e,r){return this.normalized&&(r=bn(r,this.array)),this.data.array[e*this.data.stride+this.offset+1]=r,this}setZ(e,r){return this.normalized&&(r=bn(r,this.array)),this.data.array[e*this.data.stride+this.offset+2]=r,this}setW(e,r){return this.normalized&&(r=bn(r,this.array)),this.data.array[e*this.data.stride+this.offset+3]=r,this}getX(e){let r=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(r=Il(r,this.array)),r}getY(e){let r=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(r=Il(r,this.array)),r}getZ(e){let r=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(r=Il(r,this.array)),r}getW(e){let r=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(r=Il(r,this.array)),r}setXY(e,r,n){return e=e*this.data.stride+this.offset,this.normalized&&(r=bn(r,this.array),n=bn(n,this.array)),this.data.array[e+0]=r,this.data.array[e+1]=n,this}setXYZ(e,r,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(r=bn(r,this.array),n=bn(n,this.array),i=bn(i,this.array)),this.data.array[e+0]=r,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,r,n,i,a){return e=e*this.data.stride+this.offset,this.normalized&&(r=bn(r,this.array),n=bn(n,this.array),i=bn(i,this.array),a=bn(a,this.array)),this.data.array[e+0]=r,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=a,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let r=[];for(let n=0;n<this.count;n++){let i=n*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)r.push(this.data.array[i+a])}return new Xn(new this.array.constructor(r),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new uN(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let r=[];for(let n=0;n<this.count;n++){let i=n*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)r.push(this.data.array[i+a])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:r,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},t7=new Q,r7=new _n,n7=new _n,rae=new Q,i7=new gr,nx=new Q,YS=new jo,a7=new gr,JS=new U1,oKe=class extends Er{constructor(e,r){super(e,r),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=kB,this.bindMatrix=new gr,this.bindMatrixInverse=new gr,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){let e=this.geometry;this.boundingBox===null&&(this.boundingBox=new qn),this.boundingBox.makeEmpty();let r=e.getAttribute("position");for(let n=0;n<r.count;n++)this.getVertexPosition(n,nx),this.boundingBox.expandByPoint(nx)}computeBoundingSphere(){let e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new jo),this.boundingSphere.makeEmpty();let r=e.getAttribute("position");for(let n=0;n<r.count;n++)this.getVertexPosition(n,nx),this.boundingSphere.expandByPoint(nx)}copy(e,r){return super.copy(e,r),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,r){let n=this.material,i=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),YS.copy(this.boundingSphere),YS.applyMatrix4(i),e.ray.intersectsSphere(YS)!==!1&&(a7.copy(i).invert(),JS.copy(e.ray).applyMatrix4(a7),!(this.boundingBox!==null&&JS.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,r,JS)))}getVertexPosition(e,r){return super.getVertexPosition(e,r),this.applyBoneTransform(e,r),r}bind(e,r){this.skeleton=e,r===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),r=this.matrixWorld),this.bindMatrix.copy(r),this.bindMatrixInverse.copy(r).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let e=new _n,r=this.geometry.attributes.skinWeight;for(let n=0,i=r.count;n<i;n++){e.fromBufferAttribute(r,n);let a=1/e.manhattanLength();a!==1/0?e.multiplyScalar(a):e.set(1,0,0,0),r.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===kB?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===Jne?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,r){let n=this.skeleton,i=this.geometry;r7.fromBufferAttribute(i.attributes.skinIndex,e),n7.fromBufferAttribute(i.attributes.skinWeight,e),t7.copy(r).applyMatrix4(this.bindMatrix),r.set(0,0,0);for(let a=0;a<4;a++){let o=n7.getComponent(a);if(o!==0){let s=r7.getComponent(a);i7.multiplyMatrices(n.bones[s].matrixWorld,n.boneInverses[s]),r.addScaledVector(rae.copy(t7).applyMatrix4(i7),o)}}return r.applyMatrix4(this.bindMatrixInverse)}},nae=class extends Yn{constructor(){super(),this.isBone=!0,this.type="Bone"}},eg=class extends Ho{constructor(e=null,r=1,n=1,i,a,o,s,l,u=gs,c=gs,h,d){super(null,o,s,l,u,c,i,a,h,d),this.isDataTexture=!0,this.image={data:e,width:r,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},o7=new gr,iae=new gr,cKe=class cN{constructor(e=[],r=[]){this.uuid=Gs(),this.bones=e.slice(0),this.boneInverses=r,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){let e=this.bones,r=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),r.length===0)this.calculateInverses();else if(e.length!==r.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new gr)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,r=this.bones.length;e<r;e++){let n=new gr;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,r=this.bones.length;e<r;e++){let n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,r=this.bones.length;e<r;e++){let n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){let e=this.bones,r=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let a=0,o=e.length;a<o;a++){let s=e[a]?e[a].matrixWorld:iae;o7.multiplyMatrices(s,r[a]),o7.toArray(n,a*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new cN(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);let r=new Float32Array(e*e*4);r.set(this.boneMatrices);let n=new eg(r,e,e,Ha,ps);return n.needsUpdate=!0,this.boneMatrices=r,this.boneTexture=n,this}getBoneByName(e){for(let r=0,n=this.bones.length;r<n;r++){let i=this.bones[r];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,r){this.uuid=e.uuid;for(let n=0,i=e.bones.length;n<i;n++){let a=e.bones[n],o=r[a];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",a),o=new nae),this.bones.push(o),this.boneInverses.push(new gr().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){let e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let r=this.bones,n=this.boneInverses;for(let i=0,a=r.length;i<a;i++){let o=r[i];e.bones.push(o.uuid);let s=n[i];e.boneInverses.push(s.toArray())}return e}},s7=class extends Xn{constructor(e,r,n,i=1){super(e,r,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},Af=new gr,l7=new gr,ix=[],u7=new qn,aae=new gr,J0=new Er,K0=new jo,Bm=class extends Er{constructor(e,r,n){super(e,r),this.isInstancedMesh=!0,this.instanceMatrix=new s7(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<n;i++)this.setMatrixAt(i,aae)}computeBoundingBox(){let e=this.geometry,r=this.count;this.boundingBox===null&&(this.boundingBox=new qn),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<r;n++)this.getMatrixAt(n,Af),u7.copy(e.boundingBox).applyMatrix4(Af),this.boundingBox.union(u7)}computeBoundingSphere(){let e=this.geometry,r=this.count;this.boundingSphere===null&&(this.boundingSphere=new jo),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<r;n++)this.getMatrixAt(n,Af),K0.copy(e.boundingSphere).applyMatrix4(Af),this.boundingSphere.union(K0)}copy(e,r){return super.copy(e,r),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,r){r.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,r){r.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,r){let n=r.morphTargetInfluences,i=this.morphTexture.source.data.data,a=n.length+1,o=e*a+1;for(let s=0;s<n.length;s++)n[s]=i[o+s]}raycast(e,r){let n=this.matrixWorld,i=this.count;if(J0.geometry=this.geometry,J0.material=this.material,J0.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),K0.copy(this.boundingSphere),K0.applyMatrix4(n),e.ray.intersectsSphere(K0)!==!1))for(let a=0;a<i;a++){this.getMatrixAt(a,Af),l7.multiplyMatrices(n,Af),J0.matrixWorld=l7,J0.raycast(e,ix);for(let o=0,s=ix.length;o<s;o++){let l=ix[o];l.instanceId=a,l.object=this,r.push(l)}ix.length=0}}setColorAt(e,r){this.instanceColor===null&&(this.instanceColor=new s7(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),r.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,r){r.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,r){let n=r.morphTargetInfluences,i=n.length+1;this.morphTexture===null&&(this.morphTexture=new eg(new Float32Array(i*this.count),i,this.count,fP,ps));let a=this.morphTexture.source.data.data,o=0;for(let u=0;u<n.length;u++)o+=n[u];let s=this.geometry.morphTargetsRelative?1:1-o,l=i*e;a[l]=s,a.set(n,l+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}},KS=new Q,oae=new Q,sae=new Br,jh=class{constructor(e=new Q(1,0,0),r=0){this.isPlane=!0,this.normal=e,this.constant=r}set(e,r){return this.normal.copy(e),this.constant=r,this}setComponents(e,r,n,i){return this.normal.set(e,r,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,r){return this.normal.copy(e),this.constant=-r.dot(this.normal),this}setFromCoplanarPoints(e,r,n){let i=KS.subVectors(n,r).cross(oae.subVectors(e,r)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,r){return r.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,r){let n=e.delta(KS),i=this.normal.dot(n);if(i===0)return this.distanceToPoint(e.start)===0?r.copy(e.start):null;let a=-(e.start.dot(this.normal)+this.constant)/i;return a<0||a>1?null:r.copy(e.start).addScaledVector(n,a)}intersectsLine(e){let r=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return r<0&&n>0||n<0&&r>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,r){let n=r||sae.getNormalMatrix(e),i=this.coplanarPoint(KS).applyMatrix4(e),a=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},Bd=new jo,ax=new Q,h0=class{constructor(e=new jh,r=new jh,n=new jh,i=new jh,a=new jh,o=new jh){this.planes=[e,r,n,i,a,o]}set(e,r,n,i,a,o){let s=this.planes;return s[0].copy(e),s[1].copy(r),s[2].copy(n),s[3].copy(i),s[4].copy(a),s[5].copy(o),this}copy(e){let r=this.planes;for(let n=0;n<6;n++)r[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,r=Tc){let n=this.planes,i=e.elements,a=i[0],o=i[1],s=i[2],l=i[3],u=i[4],c=i[5],h=i[6],d=i[7],p=i[8],m=i[9],y=i[10],v=i[11],_=i[12],w=i[13],b=i[14],A=i[15];if(n[0].setComponents(l-a,d-u,v-p,A-_).normalize(),n[1].setComponents(l+a,d+u,v+p,A+_).normalize(),n[2].setComponents(l+o,d+c,v+m,A+w).normalize(),n[3].setComponents(l-o,d-c,v-m,A-w).normalize(),n[4].setComponents(l-s,d-h,v-y,A-b).normalize(),r===Tc)n[5].setComponents(l+s,d+h,v+y,A+b).normalize();else if(r===i4)n[5].setComponents(s,h,y,b).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+r);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Bd.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{let r=e.geometry;r.boundingSphere===null&&r.computeBoundingSphere(),Bd.copy(r.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Bd)}intersectsSprite(e){return Bd.center.set(0,0,0),Bd.radius=.7071067811865476,Bd.applyMatrix4(e.matrixWorld),this.intersectsSphere(Bd)}intersectsSphere(e){let r=this.planes,n=e.center,i=-e.radius;for(let a=0;a<6;a++)if(r[a].distanceToPoint(n)<i)return!1;return!0}intersectsBox(e){let r=this.planes;for(let n=0;n<6;n++){let i=r[n];if(ax.x=i.normal.x>0?e.max.x:e.min.x,ax.y=i.normal.y>0?e.max.y:e.min.y,ax.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(ax)<0)return!1}return!0}containsPoint(e){let r=this.planes;for(let n=0;n<6;n++)if(r[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function QS(t,e){return t-e}function lae(t,e){return t.z-e.z}function uae(t,e){return e.z-t.z}var cae=class{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,r,n,i){let a=this.pool,o=this.list;this.index>=a.length&&a.push({start:-1,count:-1,z:-1,index:-1});let s=a[this.index];o.push(s),this.index++,s.start=e,s.count=r,s.z=n,s.index=i}reset(){this.list.length=0,this.index=0}},ko=new gr,hae=new jt(1,1,1),eE=new h0,ox=new qn,zd=new jo,Q0=new Q,c7=new Q,dae=new Q,tE=new cae,Na=new Er,sx=[];function pae(t,e,r=0){let n=e.itemSize;if(t.isInterleavedBufferAttribute||t.array.constructor!==e.array.constructor){let i=t.count;for(let a=0;a<i;a++)for(let o=0;o<n;o++)e.setComponent(a+r,o,t.getComponent(a,o))}else e.array.set(t.array,r*n);e.needsUpdate=!0}function Fd(t,e){if(t.constructor!==e.constructor){let r=Math.min(t.length,e.length);for(let n=0;n<r;n++)e[n]=t[n]}else{let r=Math.min(t.length,e.length);e.set(new t.constructor(t.buffer,0,r))}}var wP=class extends Er{get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}constructor(e,r,n=r*2,i){super(new Ja,i),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=r,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);let r=new Float32Array(e*e*4),n=new eg(r,e,e,Ha,ps);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);let r=new Uint32Array(e*e),n=new eg(r,e,e,AA,id);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);let r=new Float32Array(e*e*4).fill(1),n=new eg(r,e,e,Ha,ps);n.colorSpace=an.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){let r=this.geometry,n=this._maxVertexCount,i=this._maxIndexCount;if(this._geometryInitialized===!1){for(let a in e.attributes){let o=e.getAttribute(a),{array:s,itemSize:l,normalized:u}=o,c=new s.constructor(n*l),h=new Xn(c,l,u);r.setAttribute(a,h)}if(e.getIndex()!==null){let a=n>65535?new Uint32Array(i):new Uint16Array(i);r.setIndex(new Xn(a,1))}this._geometryInitialized=!0}}_validateGeometry(e){let r=this.geometry;if(!!e.getIndex()!=!!r.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(let n in r.attributes){if(!e.hasAttribute(n))throw new Error('THREE.BatchedMesh: Added geometry missing "'.concat(n,'". All geometries must have consistent attributes.'));let i=e.getAttribute(n),a=r.getAttribute(n);if(i.itemSize!==a.itemSize||i.normalized!==a.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){let r=this._instanceInfo;if(e<0||e>=r.length||r[e].active===!1)throw new Error("THREE.BatchedMesh: Invalid instanceId ".concat(e,". Instance is either out of range or has been deleted."))}validateGeometryId(e){let r=this._geometryInfo;if(e<0||e>=r.length||r[e].active===!1)throw new Error("THREE.BatchedMesh: Invalid geometryId ".concat(e,". Geometry is either out of range or has been deleted."))}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new qn);let e=this.boundingBox,r=this._instanceInfo;e.makeEmpty();for(let n=0,i=r.length;n<i;n++){if(r[n].active===!1)continue;let a=r[n].geometryIndex;this.getMatrixAt(n,ko),this.getBoundingBoxAt(a,ox).applyMatrix4(ko),e.union(ox)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new jo);let e=this.boundingSphere,r=this._instanceInfo;e.makeEmpty();for(let n=0,i=r.length;n<i;n++){if(r[n].active===!1)continue;let a=r[n].geometryIndex;this.getMatrixAt(n,ko),this.getBoundingSphereAt(a,zd).applyMatrix4(ko),e.union(zd)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");let r={visible:!0,active:!0,geometryIndex:e},n=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(QS),n=this._availableInstanceIds.shift(),this._instanceInfo[n]=r):(n=this._instanceInfo.length,this._instanceInfo.push(r));let i=this._matricesTexture;ko.identity().toArray(i.image.data,n*16),i.needsUpdate=!0;let a=this._colorsTexture;return a&&(hae.toArray(a.image.data,n*4),a.needsUpdate=!0),this._visibilityChanged=!0,n}addGeometry(e,r=-1,n=-1){this._initializeGeometry(e),this._validateGeometry(e);let i={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},a=this._geometryInfo;i.vertexStart=this._nextVertexStart,i.reservedVertexCount=r===-1?e.getAttribute("position").count:r;let o=e.getIndex();if(o!==null&&(i.indexStart=this._nextIndexStart,i.reservedIndexCount=n===-1?o.count:n),i.indexStart!==-1&&i.indexStart+i.reservedIndexCount>this._maxIndexCount||i.vertexStart+i.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let s;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(QS),s=this._availableGeometryIds.shift(),a[s]=i):(s=this._geometryCount,this._geometryCount++,a.push(i)),this.setGeometryAt(s,e),this._nextIndexStart=i.indexStart+i.reservedIndexCount,this._nextVertexStart=i.vertexStart+i.reservedVertexCount,s}setGeometryAt(e,r){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(r);let n=this.geometry,i=n.getIndex()!==null,a=n.getIndex(),o=r.getIndex(),s=this._geometryInfo[e];if(i&&o.count>s.reservedIndexCount||r.attributes.position.count>s.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");let l=s.vertexStart,u=s.reservedVertexCount;s.vertexCount=r.getAttribute("position").count;for(let c in n.attributes){let h=r.getAttribute(c),d=n.getAttribute(c);pae(h,d,l);let p=h.itemSize;for(let m=h.count,y=u;m<y;m++){let v=l+m;for(let _=0;_<p;_++)d.setComponent(v,_,0)}d.needsUpdate=!0,d.addUpdateRange(l*p,u*p)}if(i){let c=s.indexStart,h=s.reservedIndexCount;s.indexCount=r.getIndex().count;for(let d=0;d<o.count;d++)a.setX(c+d,l+o.getX(d));for(let d=o.count,p=h;d<p;d++)a.setX(c+d,l);a.needsUpdate=!0,a.addUpdateRange(c,s.reservedIndexCount)}return s.start=i?s.indexStart:s.vertexStart,s.count=i?s.indexCount:s.vertexCount,s.boundingBox=null,r.boundingBox!==null&&(s.boundingBox=r.boundingBox.clone()),s.boundingSphere=null,r.boundingSphere!==null&&(s.boundingSphere=r.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){let r=this._geometryInfo;if(e>=r.length||r[e].active===!1)return this;let n=this._instanceInfo;for(let i=0,a=n.length;i<a;i++)n[i].active&&n[i].geometryIndex===e&&this.deleteInstance(i);return r[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,r=0,n=this._geometryInfo,i=n.map((o,s)=>s).sort((o,s)=>n[o].vertexStart-n[s].vertexStart),a=this.geometry;for(let o=0,s=n.length;o<s;o++){let l=i[o],u=n[l];if(u.active!==!1){if(a.index!==null){if(u.indexStart!==r){let{indexStart:c,vertexStart:h,reservedIndexCount:d}=u,p=a.index,m=p.array,y=e-h;for(let v=c;v<c+d;v++)m[v]=m[v]+y;p.array.copyWithin(r,c,c+d),p.addUpdateRange(r,d),u.indexStart=r}r+=u.reservedIndexCount}if(u.vertexStart!==e){let{vertexStart:c,reservedVertexCount:h}=u,d=a.attributes;for(let p in d){let m=d[p],{array:y,itemSize:v}=m;y.copyWithin(e*v,c*v,(c+h)*v),m.addUpdateRange(e*v,h*v)}u.vertexStart=e}e+=u.reservedVertexCount,u.start=a.index?u.indexStart:u.vertexStart,this._nextIndexStart=a.index?u.indexStart+u.reservedIndexCount:0,this._nextVertexStart=u.vertexStart+u.reservedVertexCount}}return this}getBoundingBoxAt(e,r){if(e>=this._geometryCount)return null;let n=this.geometry,i=this._geometryInfo[e];if(i.boundingBox===null){let a=new qn,o=n.index,s=n.attributes.position;for(let l=i.start,u=i.start+i.count;l<u;l++){let c=l;o&&(c=o.getX(c)),a.expandByPoint(Q0.fromBufferAttribute(s,c))}i.boundingBox=a}return r.copy(i.boundingBox),r}getBoundingSphereAt(e,r){if(e>=this._geometryCount)return null;let n=this.geometry,i=this._geometryInfo[e];if(i.boundingSphere===null){let a=new jo;this.getBoundingBoxAt(e,ox),ox.getCenter(a.center);let o=n.index,s=n.attributes.position,l=0;for(let u=i.start,c=i.start+i.count;u<c;u++){let h=u;o&&(h=o.getX(h)),Q0.fromBufferAttribute(s,h),l=Math.max(l,a.center.distanceToSquared(Q0))}a.radius=Math.sqrt(l),i.boundingSphere=a}return r.copy(i.boundingSphere),r}setMatrixAt(e,r){this.validateInstanceId(e);let n=this._matricesTexture,i=this._matricesTexture.image.data;return r.toArray(i,e*16),n.needsUpdate=!0,this}getMatrixAt(e,r){return this.validateInstanceId(e),r.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,r){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),r.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,r){return this.validateInstanceId(e),r.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,r){return this.validateInstanceId(e),this._instanceInfo[e].visible===r?this:(this._instanceInfo[e].visible=r,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,r){return this.validateInstanceId(e),this.validateGeometryId(r),this._instanceInfo[e].geometryIndex=r,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,r={}){this.validateGeometryId(e);let n=this._geometryInfo[e];return r.vertexStart=n.vertexStart,r.vertexCount=n.vertexCount,r.reservedVertexCount=n.reservedVertexCount,r.indexStart=n.indexStart,r.indexCount=n.indexCount,r.reservedIndexCount=n.reservedIndexCount,r.start=n.start,r.count=n.count,r}setInstanceCount(e){let r=this._availableInstanceIds,n=this._instanceInfo;for(r.sort(QS);r[r.length-1]===n.length;)n.pop(),r.pop();if(e<n.length)throw new Error("BatchedMesh: Instance ids outside the range ".concat(e," are being used. Cannot shrink instance count."));let i=new Int32Array(e),a=new Int32Array(e);Fd(this._multiDrawCounts,i),Fd(this._multiDrawStarts,a),this._multiDrawCounts=i,this._multiDrawStarts=a,this._maxInstanceCount=e;let o=this._indirectTexture,s=this._matricesTexture,l=this._colorsTexture;o.dispose(),this._initIndirectTexture(),Fd(o.image.data,this._indirectTexture.image.data),s.dispose(),this._initMatricesTexture(),Fd(s.image.data,this._matricesTexture.image.data),l&&(l.dispose(),this._initColorsTexture(),Fd(l.image.data,this._colorsTexture.image.data))}setGeometrySize(e,r){let n=[...this._geometryInfo].filter(o=>o.active);if(Math.max(...n.map(o=>o.vertexStart+o.reservedVertexCount))>e)throw new Error("BatchedMesh: Geometry vertex values are being used outside the range ".concat(r,". Cannot shrink further."));if(this.geometry.index&&Math.max(...n.map(o=>o.indexStart+o.reservedIndexCount))>r)throw new Error("BatchedMesh: Geometry index values are being used outside the range ".concat(r,". Cannot shrink further."));let i=this.geometry;i.dispose(),this._maxVertexCount=e,this._maxIndexCount=r,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new Ja,this._initializeGeometry(i));let a=this.geometry;i.index&&Fd(i.index.array,a.index.array);for(let o in i.attributes)Fd(i.attributes[o].array,a.attributes[o].array)}raycast(e,r){let n=this._instanceInfo,i=this._geometryInfo,a=this.matrixWorld,o=this.geometry;Na.material=this.material,Na.geometry.index=o.index,Na.geometry.attributes=o.attributes,Na.geometry.boundingBox===null&&(Na.geometry.boundingBox=new qn),Na.geometry.boundingSphere===null&&(Na.geometry.boundingSphere=new jo);for(let s=0,l=n.length;s<l;s++){if(!n[s].visible||!n[s].active)continue;let u=n[s].geometryIndex,c=i[u];Na.geometry.setDrawRange(c.start,c.count),this.getMatrixAt(s,Na.matrixWorld).premultiply(a),this.getBoundingBoxAt(u,Na.geometry.boundingBox),this.getBoundingSphereAt(u,Na.geometry.boundingSphere),Na.raycast(e,sx);for(let h=0,d=sx.length;h<d;h++){let p=sx[h];p.object=this,p.batchId=s,r.push(p)}sx.length=0}Na.material=null,Na.geometry.index=null,Na.geometry.attributes={},Na.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(r=>lt(ae({},r),{boundingBox:r.boundingBox!==null?r.boundingBox.clone():null,boundingSphere:r.boundingSphere!==null?r.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(r=>ae({},r)),this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null),this}onBeforeRender(e,r,n,i,a){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;let o=i.getIndex(),s=o===null?1:o.array.BYTES_PER_ELEMENT,l=this._instanceInfo,u=this._multiDrawStarts,c=this._multiDrawCounts,h=this._geometryInfo,d=this.perObjectFrustumCulled,p=this._indirectTexture,m=p.image.data;d&&(ko.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),eE.setFromProjectionMatrix(ko,e.coordinateSystem));let y=0;if(this.sortObjects){ko.copy(this.matrixWorld).invert(),Q0.setFromMatrixPosition(n.matrixWorld).applyMatrix4(ko),c7.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(ko);for(let w=0,b=l.length;w<b;w++)if(l[w].visible&&l[w].active){let A=l[w].geometryIndex;this.getMatrixAt(w,ko),this.getBoundingSphereAt(A,zd).applyMatrix4(ko);let E=!1;if(d&&(E=!eE.intersectsSphere(zd)),!E){let M=h[A],P=dae.subVectors(zd.center,Q0).dot(c7);tE.push(M.start,M.count,P,w)}}let v=tE.list,_=this.customSort;_===null?v.sort(a.transparent?uae:lae):_.call(this,v,n);for(let w=0,b=v.length;w<b;w++){let A=v[w];u[y]=A.start*s,c[y]=A.count,m[y]=A.index,y++}tE.reset()}else for(let v=0,_=l.length;v<_;v++)if(l[v].visible&&l[v].active){let w=l[v].geometryIndex,b=!1;if(d&&(this.getMatrixAt(v,ko),this.getBoundingSphereAt(w,zd).applyMatrix4(ko),b=!eE.intersectsSphere(zd)),!b){let A=h[w];u[y]=A.start*s,c[y]=A.count,m[y]=v,y++}}p.needsUpdate=!0,this._multiDrawCount=y,this._visibilityChanged=!1}onBeforeShadow(e,r,n,i,a,o){this.onBeforeRender(e,null,i,a,o)}},hN=class extends gd{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new jt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},a4=new Q,o4=new Q,h7=new gr,ey=new U1,lx=new jo,rE=new Q,d7=new Q,dN=class extends Yn{constructor(e=new Ja,r=new hN){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=r,this.updateMorphTargets()}copy(e,r){return super.copy(e,r),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let r=e.attributes.position,n=[0];for(let i=1,a=r.count;i<a;i++)a4.fromBufferAttribute(r,i-1),o4.fromBufferAttribute(r,i),n[i]=n[i-1],n[i]+=a4.distanceTo(o4);e.setAttribute("lineDistance",new vo(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,r){let n=this.geometry,i=this.matrixWorld,a=e.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),lx.copy(n.boundingSphere),lx.applyMatrix4(i),lx.radius+=a,e.ray.intersectsSphere(lx)===!1)return;h7.copy(i).invert(),ey.copy(e.ray).applyMatrix4(h7);let s=a/((this.scale.x+this.scale.y+this.scale.z)/3),l=s*s,u=this.isLineSegments?2:1,c=n.index,h=n.attributes.position;if(c!==null){let d=Math.max(0,o.start),p=Math.min(c.count,o.start+o.count);for(let m=d,y=p-1;m<y;m+=u){let v=c.getX(m),_=c.getX(m+1),w=ux(this,e,ey,l,v,_,m);w&&r.push(w)}if(this.isLineLoop){let m=c.getX(p-1),y=c.getX(d),v=ux(this,e,ey,l,m,y,p-1);v&&r.push(v)}}else{let d=Math.max(0,o.start),p=Math.min(h.count,o.start+o.count);for(let m=d,y=p-1;m<y;m+=u){let v=ux(this,e,ey,l,m,m+1,m);v&&r.push(v)}if(this.isLineLoop){let m=ux(this,e,ey,l,p-1,d,p-1);m&&r.push(m)}}}updateMorphTargets(){let e=this.geometry.morphAttributes,r=Object.keys(e);if(r.length>0){let n=e[r[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,a=n.length;i<a;i++){let o=n[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=i}}}}};function ux(t,e,r,n,i,a,o){let s=t.geometry.attributes.position;if(a4.fromBufferAttribute(s,i),o4.fromBufferAttribute(s,a),r.distanceSqToSegment(a4,o4,rE,d7)>n)return;rE.applyMatrix4(t.matrixWorld);let l=e.ray.origin.distanceTo(rE);if(!(l<e.near||l>e.far))return{distance:l,point:d7.clone().applyMatrix4(t.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:t}}var p7=new Q,f7=new Q,AP=class extends dN{constructor(e,r){super(e,r),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let r=e.attributes.position,n=[];for(let i=0,a=r.count;i<a;i+=2)p7.fromBufferAttribute(r,i),f7.fromBufferAttribute(r,i+1),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+p7.distanceTo(f7);e.setAttribute("lineDistance",new vo(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},xKe=class extends dN{constructor(e,r){super(e,r),this.isLineLoop=!0,this.type="LineLoop"}},fae=class extends gd{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new jt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}},m7=new gr,CC=new U1,cx=new jo,hx=new Q,AKe=class extends Yn{constructor(e=new Ja,r=new fae){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=r,this.updateMorphTargets()}copy(e,r){return super.copy(e,r),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,r){let n=this.geometry,i=this.matrixWorld,a=e.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),cx.copy(n.boundingSphere),cx.applyMatrix4(i),cx.radius+=a,e.ray.intersectsSphere(cx)===!1)return;m7.copy(i).invert(),CC.copy(e.ray).applyMatrix4(m7);let s=a/((this.scale.x+this.scale.y+this.scale.z)/3),l=s*s,u=n.index,c=n.attributes.position;if(u!==null){let h=Math.max(0,o.start),d=Math.min(u.count,o.start+o.count);for(let p=h,m=d;p<m;p++){let y=u.getX(p);hx.fromBufferAttribute(c,y),g7(hx,y,l,i,e,r,this)}}else{let h=Math.max(0,o.start),d=Math.min(c.count,o.start+o.count);for(let p=h,m=d;p<m;p++)hx.fromBufferAttribute(c,p),g7(hx,p,l,i,e,r,this)}}updateMorphTargets(){let e=this.geometry.morphAttributes,r=Object.keys(e);if(r.length>0){let n=e[r[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,a=n.length;i<a;i++){let o=n[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=i}}}}};function g7(t,e,r,n,i,a,o){let s=CC.distanceSqToPoint(t);if(s<r){let l=new Q;CC.closestPointToPoint(t,l),l.applyMatrix4(n);let u=i.ray.origin.distanceTo(l);if(u<i.near||u>i.far)return;a.push({distance:u,distanceToRay:Math.sqrt(s),point:l,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}var EKe=class extends Ho{constructor(e,r,n,i,a,o,s,l,u,c,h,d){super(null,o,s,l,u,c,i,a,h,d),this.isCompressedTexture=!0,this.image={width:r,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}},pN=class extends Ho{constructor(e,r,n,i,a,o,s,l,u,c=Ym){if(c!==Ym&&c!==_g)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&c===Ym&&(n=id),n===void 0&&c===_g&&(n=vg),super(null,i,a,o,s,l,c,n,u),this.isDepthTexture=!0,this.image={width:e,height:r},this.magFilter=s!==void 0?s:gs,this.minFilter=l!==void 0?l:gs,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){let r=super.toJSON(e);return this.compareFunction!==null&&(r.compareFunction=this.compareFunction),r}},Fu=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,r){let n=this.getUtoTmapping(e);return this.getPoint(n,r)}getPoints(e=5){let r=[];for(let n=0;n<=e;n++)r.push(this.getPoint(n/e));return r}getSpacedPoints(e=5){let r=[];for(let n=0;n<=e;n++)r.push(this.getPointAt(n/e));return r}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let r=[],n,i=this.getPoint(0),a=0;r.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),a+=n.distanceTo(i),r.push(a),i=n;return this.cacheArcLengths=r,r}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,r){let n=this.getLengths(),i=0,a=n.length,o;r?o=r:o=e*n[a-1];let s=0,l=a-1,u;for(;s<=l;)if(i=Math.floor(s+(l-s)/2),u=n[i]-o,u<0)s=i+1;else if(u>0)l=i-1;else{l=i;break}if(i=l,n[i]===o)return i/(a-1);let c=n[i],h=n[i+1]-c,d=(o-c)/h;return(i+d)/(a-1)}getTangent(e,r){let n=e-1e-4,i=e+1e-4;n<0&&(n=0),i>1&&(i=1);let a=this.getPoint(n),o=this.getPoint(i),s=r||(a.isVector2?new Je:new Q);return s.copy(o).sub(a).normalize(),s}getTangentAt(e,r){let n=this.getUtoTmapping(e);return this.getTangent(n,r)}computeFrenetFrames(e,r){let n=new Q,i=[],a=[],o=[],s=new Q,l=new gr;for(let p=0;p<=e;p++){let m=p/e;i[p]=this.getTangentAt(m,new Q)}a[0]=new Q,o[0]=new Q;let u=Number.MAX_VALUE,c=Math.abs(i[0].x),h=Math.abs(i[0].y),d=Math.abs(i[0].z);c<=u&&(u=c,n.set(1,0,0)),h<=u&&(u=h,n.set(0,1,0)),d<=u&&n.set(0,0,1),s.crossVectors(i[0],n).normalize(),a[0].crossVectors(i[0],s),o[0].crossVectors(i[0],a[0]);for(let p=1;p<=e;p++){if(a[p]=a[p-1].clone(),o[p]=o[p-1].clone(),s.crossVectors(i[p-1],i[p]),s.length()>Number.EPSILON){s.normalize();let m=Math.acos(zr(i[p-1].dot(i[p]),-1,1));a[p].applyMatrix4(l.makeRotationAxis(s,m))}o[p].crossVectors(i[p],a[p])}if(r===!0){let p=Math.acos(zr(a[0].dot(a[e]),-1,1));p/=e,i[0].dot(s.crossVectors(a[0],a[e]))>0&&(p=-p);for(let m=1;m<=e;m++)a[m].applyMatrix4(l.makeRotationAxis(i[m],p*m)),o[m].crossVectors(i[m],a[m])}return{tangents:i,normals:a,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},SP=class extends Fu{constructor(e=0,r=0,n=1,i=1,a=0,o=Math.PI*2,s=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=r,this.xRadius=n,this.yRadius=i,this.aStartAngle=a,this.aEndAngle=o,this.aClockwise=s,this.aRotation=l}getPoint(e,r=new Je){let n=r,i=Math.PI*2,a=this.aEndAngle-this.aStartAngle,o=Math.abs(a)<Number.EPSILON;for(;a<0;)a+=i;for(;a>i;)a-=i;a<Number.EPSILON&&(o?a=0:a=i),this.aClockwise===!0&&!o&&(a===i?a=-i:a=a-i);let s=this.aStartAngle+e*a,l=this.aX+this.xRadius*Math.cos(s),u=this.aY+this.yRadius*Math.sin(s);if(this.aRotation!==0){let c=Math.cos(this.aRotation),h=Math.sin(this.aRotation),d=l-this.aX,p=u-this.aY;l=d*c-p*h+this.aX,u=d*h+p*c+this.aY}return n.set(l,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},mae=class extends SP{constructor(e,r,n,i,a,o){super(e,r,n,n,i,a,o),this.isArcCurve=!0,this.type="ArcCurve"}};function EP(){let t=0,e=0,r=0,n=0;function i(a,o,s,l){t=a,e=s,r=-3*a+3*o-2*s-l,n=2*a-2*o+s+l}return{initCatmullRom:function(a,o,s,l,u){i(o,s,u*(s-a),u*(l-o))},initNonuniformCatmullRom:function(a,o,s,l,u,c,h){let d=(o-a)/u-(s-a)/(u+c)+(s-o)/c,p=(s-o)/c-(l-o)/(c+h)+(l-s)/h;d*=c,p*=c,i(o,s,d,p)},calc:function(a){let o=a*a,s=o*a;return t+e*a+r*o+n*s}}}var dx=new Q,nE=new EP,iE=new EP,aE=new EP,fN=class extends Fu{constructor(t=[],e=!1,r="centripetal",n=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=r,this.tension=n}getPoint(t,e=new Q){let r=e,n=this.points,i=n.length,a=(i-(this.closed?0:1))*t,o=Math.floor(a),s=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/i)+1)*i:s===0&&o===i-1&&(o=i-2,s=1);let l,u;this.closed||o>0?l=n[(o-1)%i]:(dx.subVectors(n[0],n[1]).add(n[0]),l=dx);let c=n[o%i],h=n[(o+1)%i];if(this.closed||o+2<i?u=n[(o+2)%i]:(dx.subVectors(n[i-1],n[i-2]).add(n[i-1]),u=dx),this.curveType==="centripetal"||this.curveType==="chordal"){let d=this.curveType==="chordal"?.5:.25,p=Math.pow(l.distanceToSquared(c),d),m=Math.pow(c.distanceToSquared(h),d),y=Math.pow(h.distanceToSquared(u),d);m<1e-4&&(m=1),p<1e-4&&(p=m),y<1e-4&&(y=m),nE.initNonuniformCatmullRom(l.x,c.x,h.x,u.x,p,m,y),iE.initNonuniformCatmullRom(l.y,c.y,h.y,u.y,p,m,y),aE.initNonuniformCatmullRom(l.z,c.z,h.z,u.z,p,m,y)}else this.curveType==="catmullrom"&&(nE.initCatmullRom(l.x,c.x,h.x,u.x,this.tension),iE.initCatmullRom(l.y,c.y,h.y,u.y,this.tension),aE.initCatmullRom(l.z,c.z,h.z,u.z,this.tension));return r.set(nE.calc(s),iE.calc(s),aE.calc(s)),r}copy(t){super.copy(t),this.points=[];for(let e=0,r=t.points.length;e<r;e++){let n=t.points[e];this.points.push(n.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){let t=super.toJSON();t.points=[];for(let e=0,r=this.points.length;e<r;e++){let n=this.points[e];t.points.push(n.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,r=t.points.length;e<r;e++){let n=t.points[e];this.points.push(new Q().fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}};function y7(t,e,r,n,i){let a=(n-e)*.5,o=(i-r)*.5,s=t*t,l=t*s;return(2*r-2*n+a+o)*l+(-3*r+3*n-2*a-o)*s+a*t+r}function gae(t,e){let r=1-t;return r*r*e}function yae(t,e){return 2*(1-t)*t*e}function vae(t,e){return t*t*e}function kv(t,e,r,n){return gae(t,e)+yae(t,r)+vae(t,n)}function _ae(t,e){let r=1-t;return r*r*r*e}function xae(t,e){let r=1-t;return 3*r*r*t*e}function bae(t,e){return 3*(1-t)*t*t*e}function wae(t,e){return t*t*t*e}function Ov(t,e,r,n,i){return _ae(t,e)+xae(t,r)+bae(t,n)+wae(t,i)}var mN=class extends Fu{constructor(e=new Je,r=new Je,n=new Je,i=new Je){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=r,this.v2=n,this.v3=i}getPoint(e,r=new Je){let n=r,i=this.v0,a=this.v1,o=this.v2,s=this.v3;return n.set(Ov(e,i.x,a.x,o.x,s.x),Ov(e,i.y,a.y,o.y,s.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},Aae=class extends Fu{constructor(e=new Q,r=new Q,n=new Q,i=new Q){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=r,this.v2=n,this.v3=i}getPoint(e,r=new Q){let n=r,i=this.v0,a=this.v1,o=this.v2,s=this.v3;return n.set(Ov(e,i.x,a.x,o.x,s.x),Ov(e,i.y,a.y,o.y,s.y),Ov(e,i.z,a.z,o.z,s.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},gN=class extends Fu{constructor(e=new Je,r=new Je){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=r}getPoint(e,r=new Je){let n=r;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,r){return this.getPoint(e,r)}getTangent(e,r=new Je){return r.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,r){return this.getTangent(e,r)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},Sae=class extends Fu{constructor(e=new Q,r=new Q){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=r}getPoint(e,r=new Q){let n=r;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,r){return this.getPoint(e,r)}getTangent(e,r=new Q){return r.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,r){return this.getTangent(e,r)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},yN=class extends Fu{constructor(e=new Je,r=new Je,n=new Je){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=r,this.v2=n}getPoint(e,r=new Je){let n=r,i=this.v0,a=this.v1,o=this.v2;return n.set(kv(e,i.x,a.x,o.x),kv(e,i.y,a.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},vN=class extends Fu{constructor(e=new Q,r=new Q,n=new Q){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=r,this.v2=n}getPoint(e,r=new Q){let n=r,i=this.v0,a=this.v1,o=this.v2;return n.set(kv(e,i.x,a.x,o.x),kv(e,i.y,a.y,o.y),kv(e,i.z,a.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},_N=class extends Fu{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,r=new Je){let n=r,i=this.points,a=(i.length-1)*e,o=Math.floor(a),s=a-o,l=i[o===0?o:o-1],u=i[o],c=i[o>i.length-2?i.length-1:o+1],h=i[o>i.length-3?i.length-1:o+2];return n.set(y7(s,l.x,u.x,c.x,h.x),y7(s,l.y,u.y,c.y,h.y)),n}copy(e){super.copy(e),this.points=[];for(let r=0,n=e.points.length;r<n;r++){let i=e.points[r];this.points.push(i.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let r=0,n=this.points.length;r<n;r++){let i=this.points[r];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let r=0,n=e.points.length;r<n;r++){let i=e.points[r];this.points.push(new Je().fromArray(i))}return this}},s4=Object.freeze({__proto__:null,ArcCurve:mae,CatmullRomCurve3:fN,CubicBezierCurve:mN,CubicBezierCurve3:Aae,EllipseCurve:SP,LineCurve:gN,LineCurve3:Sae,QuadraticBezierCurve:yN,QuadraticBezierCurve3:vN,SplineCurve:_N}),Eae=class extends Fu{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),r=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(r)){let n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new s4[n](r,e))}return this}getPoint(e,r){let n=e*this.getLength(),i=this.getCurveLengths(),a=0;for(;a<i.length;){if(i[a]>=n){let o=i[a]-n,s=this.curves[a],l=s.getLength(),u=l===0?0:1-o/l;return s.getPointAt(u,r)}a++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],r=0;for(let n=0,i=this.curves.length;n<i;n++)r+=this.curves[n].getLength(),e.push(r);return this.cacheLengths=e,e}getSpacedPoints(e=40){let r=[];for(let n=0;n<=e;n++)r.push(this.getPoint(n/e));return this.autoClose&&r.push(r[0]),r}getPoints(e=12){let r=[],n;for(let i=0,a=this.curves;i<a.length;i++){let o=a[i],s=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(s);for(let u=0;u<l.length;u++){let c=l[u];n&&n.equals(c)||(r.push(c),n=c)}}return this.autoClose&&r.length>1&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r}copy(e){super.copy(e),this.curves=[];for(let r=0,n=e.curves.length;r<n;r++){let i=e.curves[r];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let r=0,n=this.curves.length;r<n;r++){let i=this.curves[r];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let r=0,n=e.curves.length;r<n;r++){let i=e.curves[r];this.curves.push(new s4[i.type]().fromJSON(i))}return this}},wg=class extends Eae{constructor(e){super(),this.type="Path",this.currentPoint=new Je,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let r=1,n=e.length;r<n;r++)this.lineTo(e[r].x,e[r].y);return this}moveTo(e,r){return this.currentPoint.set(e,r),this}lineTo(e,r){let n=new gN(this.currentPoint.clone(),new Je(e,r));return this.curves.push(n),this.currentPoint.set(e,r),this}quadraticCurveTo(e,r,n,i){let a=new yN(this.currentPoint.clone(),new Je(e,r),new Je(n,i));return this.curves.push(a),this.currentPoint.set(n,i),this}bezierCurveTo(e,r,n,i,a,o){let s=new mN(this.currentPoint.clone(),new Je(e,r),new Je(n,i),new Je(a,o));return this.curves.push(s),this.currentPoint.set(a,o),this}splineThru(e){let r=[this.currentPoint.clone()].concat(e),n=new _N(r);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,r,n,i,a,o){let s=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+s,r+l,n,i,a,o),this}absarc(e,r,n,i,a,o){return this.absellipse(e,r,n,n,i,a,o),this}ellipse(e,r,n,i,a,o,s,l){let u=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+u,r+c,n,i,a,o,s,l),this}absellipse(e,r,n,i,a,o,s,l){let u=new SP(e,r,n,i,a,o,s,l);if(this.curves.length>0){let h=u.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(u);let c=u.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}},px=new Q,fx=new Q,oE=new Q,mx=new zf,Iae=class extends Ja{constructor(e=null,r=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:r},e!==null){let n=Math.pow(10,4),i=Math.cos(Km*r),a=e.getIndex(),o=e.getAttribute("position"),s=a?a.count:o.count,l=[0,0,0],u=["a","b","c"],c=new Array(3),h={},d=[];for(let p=0;p<s;p+=3){a?(l[0]=a.getX(p),l[1]=a.getX(p+1),l[2]=a.getX(p+2)):(l[0]=p,l[1]=p+1,l[2]=p+2);let{a:m,b:y,c:v}=mx;if(m.fromBufferAttribute(o,l[0]),y.fromBufferAttribute(o,l[1]),v.fromBufferAttribute(o,l[2]),mx.getNormal(oE),c[0]="".concat(Math.round(m.x*n),",").concat(Math.round(m.y*n),",").concat(Math.round(m.z*n)),c[1]="".concat(Math.round(y.x*n),",").concat(Math.round(y.y*n),",").concat(Math.round(y.z*n)),c[2]="".concat(Math.round(v.x*n),",").concat(Math.round(v.y*n),",").concat(Math.round(v.z*n)),!(c[0]===c[1]||c[1]===c[2]||c[2]===c[0]))for(let _=0;_<3;_++){let w=(_+1)%3,b=c[_],A=c[w],E=mx[u[_]],M=mx[u[w]],P="".concat(b,"_").concat(A),k="".concat(A,"_").concat(b);k in h&&h[k]?(oE.dot(h[k].normal)<=i&&(d.push(E.x,E.y,E.z),d.push(M.x,M.y,M.z)),h[k]=null):P in h||(h[P]={index0:l[_],index1:l[w],normal:oE.clone()})}}for(let p in h)if(h[p]){let{index0:m,index1:y}=h[p];px.fromBufferAttribute(o,m),fx.fromBufferAttribute(o,y),d.push(px.x,px.y,px.z),d.push(fx.x,fx.y,fx.z)}this.setAttribute("position",new vo(d,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}},j1=class extends wg{constructor(e){super(e),this.uuid=Gs(),this.type="Shape",this.holes=[]}getPointsHoles(e){let r=[];for(let n=0,i=this.holes.length;n<i;n++)r[n]=this.holes[n].getPoints(e);return r}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let r=0,n=e.holes.length;r<n;r++){let i=e.holes[r];this.holes.push(i.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let r=0,n=this.holes.length;r<n;r++){let i=this.holes[r];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let r=0,n=e.holes.length;r<n;r++){let i=e.holes[r];this.holes.push(new wg().fromJSON(i))}return this}},Cae={triangulate:function(t,e,r=2){let n=e&&e.length,i=n?e[0]*r:t.length,a=xN(t,0,i,r,!0),o=[];if(!a||a.next===a.prev)return o;let s,l,u,c,h,d,p;if(n&&(a=kae(t,e,a,r)),t.length>80*r){s=u=t[0],l=c=t[1];for(let m=r;m<i;m+=r)h=t[m],d=t[m+1],h<s&&(s=h),d<l&&(l=d),h>u&&(u=h),d>c&&(c=d);p=Math.max(u-s,c-l),p=p!==0?32767/p:0}return Kv(a,o,r,s,l,p,0),o}};function xN(t,e,r,n,i){let a,o;if(i===Vae(t,e,r,n)>0)for(a=e;a<r;a+=n)o=v7(a,t[a],t[a+1],o);else for(a=r-n;a>=e;a-=n)o=v7(a,t[a],t[a+1],o);return o&&SA(o,o.next)&&(e1(o),o=o.next),o}function Bp(t,e){if(!t)return t;e||(e=t);let r=t,n;do if(n=!1,!r.steiner&&(SA(r,r.next)||gi(r.prev,r,r.next)===0)){if(e1(r),r=e=r.prev,r===r.next)break;n=!0}else r=r.next;while(n||r!==e);return e}function Kv(t,e,r,n,i,a,o){if(!t)return;!o&&a&&Rae(t,n,i,a);let s=t,l,u;for(;t.prev!==t.next;){if(l=t.prev,u=t.next,a?Tae(t,n,i,a):Mae(t)){e.push(l.i/r|0),e.push(t.i/r|0),e.push(u.i/r|0),e1(t),t=u.next,s=u.next;continue}if(t=u,t===s){o?o===1?(t=Pae(Bp(t),e,r),Kv(t,e,r,n,i,a,2)):o===2&&Dae(t,e,r,n,i,a):Kv(Bp(t),e,r,n,i,a,1);break}}}function Mae(t){let e=t.prev,r=t,n=t.next;if(gi(e,r,n)>=0)return!1;let i=e.x,a=r.x,o=n.x,s=e.y,l=r.y,u=n.y,c=i<a?i<o?i:o:a<o?a:o,h=s<l?s<u?s:u:l<u?l:u,d=i>a?i>o?i:o:a>o?a:o,p=s>l?s>u?s:u:l>u?l:u,m=n.next;for(;m!==e;){if(m.x>=c&&m.x<=d&&m.y>=h&&m.y<=p&&zm(i,s,a,l,o,u,m.x,m.y)&&gi(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function Tae(t,e,r,n){let i=t.prev,a=t,o=t.next;if(gi(i,a,o)>=0)return!1;let s=i.x,l=a.x,u=o.x,c=i.y,h=a.y,d=o.y,p=s<l?s<u?s:u:l<u?l:u,m=c<h?c<d?c:d:h<d?h:d,y=s>l?s>u?s:u:l>u?l:u,v=c>h?c>d?c:d:h>d?h:d,_=MC(p,m,e,r,n),w=MC(y,v,e,r,n),b=t.prevZ,A=t.nextZ;for(;b&&b.z>=_&&A&&A.z<=w;){if(b.x>=p&&b.x<=y&&b.y>=m&&b.y<=v&&b!==i&&b!==o&&zm(s,c,l,h,u,d,b.x,b.y)&&gi(b.prev,b,b.next)>=0||(b=b.prevZ,A.x>=p&&A.x<=y&&A.y>=m&&A.y<=v&&A!==i&&A!==o&&zm(s,c,l,h,u,d,A.x,A.y)&&gi(A.prev,A,A.next)>=0))return!1;A=A.nextZ}for(;b&&b.z>=_;){if(b.x>=p&&b.x<=y&&b.y>=m&&b.y<=v&&b!==i&&b!==o&&zm(s,c,l,h,u,d,b.x,b.y)&&gi(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;A&&A.z<=w;){if(A.x>=p&&A.x<=y&&A.y>=m&&A.y<=v&&A!==i&&A!==o&&zm(s,c,l,h,u,d,A.x,A.y)&&gi(A.prev,A,A.next)>=0)return!1;A=A.nextZ}return!0}function Pae(t,e,r){let n=t;do{let i=n.prev,a=n.next.next;!SA(i,a)&&bN(i,n,n.next,a)&&Qv(i,a)&&Qv(a,i)&&(e.push(i.i/r|0),e.push(n.i/r|0),e.push(a.i/r|0),e1(n),e1(n.next),n=t=a),n=n.next}while(n!==t);return Bp(n)}function Dae(t,e,r,n,i,a){let o=t;do{let s=o.next.next;for(;s!==o.prev;){if(o.i!==s.i&&$ae(o,s)){let l=wN(o,s);o=Bp(o,o.next),l=Bp(l,l.next),Kv(o,e,r,n,i,a,0),Kv(l,e,r,n,i,a,0);return}s=s.next}o=o.next}while(o!==t)}function kae(t,e,r,n){let i=[],a,o,s,l,u;for(a=0,o=e.length;a<o;a++)s=e[a]*n,l=a<o-1?e[a+1]*n:t.length,u=xN(t,s,l,n,!1),u===u.next&&(u.steiner=!0),i.push(Nae(u));for(i.sort(Oae),a=0;a<i.length;a++)r=Bae(i[a],r);return r}function Oae(t,e){return t.x-e.x}function Bae(t,e){let r=zae(t,e);if(!r)return e;let n=wN(r,t);return Bp(n,n.next),Bp(r,r.next)}function zae(t,e){let r=e,n=-1/0,i,a=t.x,o=t.y;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){let d=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(d<=a&&d>n&&(n=d,i=r.x<r.next.x?r:r.next,d===a))return i}r=r.next}while(r!==e);if(!i)return null;let s=i,l=i.x,u=i.y,c=1/0,h;r=i;do a>=r.x&&r.x>=l&&a!==r.x&&zm(o<u?a:n,o,l,u,o<u?n:a,o,r.x,r.y)&&(h=Math.abs(o-r.y)/(a-r.x),Qv(r,t)&&(h<c||h===c&&(r.x>i.x||r.x===i.x&&Fae(i,r)))&&(i=r,c=h)),r=r.next;while(r!==s);return i}function Fae(t,e){return gi(t.prev,t,e.prev)<0&&gi(e.next,t,t.next)<0}function Rae(t,e,r,n){let i=t;do i.z===0&&(i.z=MC(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,Lae(i)}function Lae(t){let e,r,n,i,a,o,s,l,u=1;do{for(r=t,t=null,a=null,o=0;r;){for(o++,n=r,s=0,e=0;e<u&&(s++,n=n.nextZ,!!n);e++);for(l=u;s>0||l>0&&n;)s!==0&&(l===0||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,l--),a?a.nextZ=i:t=i,i.prevZ=a,a=i;r=n}a.nextZ=null,u*=2}while(o>1);return t}function MC(t,e,r,n,i){return t=(t-r)*i|0,e=(e-n)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function Nae(t){let e=t,r=t;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==t);return r}function zm(t,e,r,n,i,a,o,s){return(i-o)*(e-s)>=(t-o)*(a-s)&&(t-o)*(n-s)>=(r-o)*(e-s)&&(r-o)*(a-s)>=(i-o)*(n-s)}function $ae(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!Uae(t,e)&&(Qv(t,e)&&Qv(e,t)&&jae(t,e)&&(gi(t.prev,t,e.prev)||gi(t,e.prev,e))||SA(t,e)&&gi(t.prev,t,t.next)>0&&gi(e.prev,e,e.next)>0)}function gi(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function SA(t,e){return t.x===e.x&&t.y===e.y}function bN(t,e,r,n){let i=yx(gi(t,e,r)),a=yx(gi(t,e,n)),o=yx(gi(r,n,t)),s=yx(gi(r,n,e));return!!(i!==a&&o!==s||i===0&&gx(t,r,e)||a===0&&gx(t,n,e)||o===0&&gx(r,t,n)||s===0&&gx(r,e,n))}function gx(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function yx(t){return t>0?1:t<0?-1:0}function Uae(t,e){let r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&bN(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}function Qv(t,e){return gi(t.prev,t,t.next)<0?gi(t,e,t.next)>=0&&gi(t,t.prev,e)>=0:gi(t,e,t.prev)<0||gi(t,t.next,e)<0}function jae(t,e){let r=t,n=!1,i=(t.x+e.x)/2,a=(t.y+e.y)/2;do r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==t);return n}function wN(t,e){let r=new TC(t.i,t.x,t.y),n=new TC(e.i,e.x,e.y),i=t.next,a=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}function v7(t,e,r,n){let i=new TC(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function e1(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function TC(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Vae(t,e,r,n){let i=0;for(let a=e,o=r-n;a<r;a+=n)i+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return i}var sE=class AN{static area(e){let r=e.length,n=0;for(let i=r-1,a=0;a<r;i=a++)n+=e[i].x*e[a].y-e[a].x*e[i].y;return n*.5}static isClockWise(e){return AN.area(e)<0}static triangulateShape(e,r){let n=[],i=[],a=[];_7(e),x7(n,e);let o=e.length;r.forEach(_7);for(let l=0;l<r.length;l++)i.push(o),o+=r[l].length,x7(n,r[l]);let s=Cae.triangulate(n,i);for(let l=0;l<s.length;l+=3)a.push(s.slice(l,l+3));return a}};function _7(t){let e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function x7(t,e){for(let r=0;r<e.length;r++)t.push(e[r].x),t.push(e[r].y)}var EA=class SN extends Ja{constructor(e=new j1([new Je(.5,.5),new Je(-.5,.5),new Je(-.5,-.5),new Je(.5,-.5)]),r={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:r},e=Array.isArray(e)?e:[e];let n=this,i=[],a=[];for(let s=0,l=e.length;s<l;s++){let u=e[s];o(u)}this.setAttribute("position",new vo(i,3)),this.setAttribute("uv",new vo(a,2)),this.computeVertexNormals();function o(s){let l=[],u=r.curveSegments!==void 0?r.curveSegments:12,c=r.steps!==void 0?r.steps:1,h=r.depth!==void 0?r.depth:1,d=r.bevelEnabled!==void 0?r.bevelEnabled:!0,p=r.bevelThickness!==void 0?r.bevelThickness:.2,m=r.bevelSize!==void 0?r.bevelSize:p-.1,y=r.bevelOffset!==void 0?r.bevelOffset:0,v=r.bevelSegments!==void 0?r.bevelSegments:3,_=r.extrudePath,w=r.UVGenerator!==void 0?r.UVGenerator:Gae,b,A=!1,E,M,P,k;_&&(b=_.getSpacedPoints(c),A=!0,d=!1,E=_.computeFrenetFrames(c,!1),M=new Q,P=new Q,k=new Q),d||(v=0,p=0,m=0,y=0);let D=s.extractPoints(u),O=D.shape,B=D.holes;if(!sE.isClockWise(O)){O=O.reverse();for(let q=0,oe=B.length;q<oe;q++){let ce=B[q];sE.isClockWise(ce)&&(B[q]=ce.reverse())}}let L=sE.triangulateShape(O,B),R=O;for(let q=0,oe=B.length;q<oe;q++){let ce=B[q];O=O.concat(ce)}function T(q,oe,ce){return oe||console.error("THREE.ExtrudeGeometry: vec does not exist"),q.clone().addScaledVector(oe,ce)}let N=O.length,$=L.length;function V(q,oe,ce){let X,ke,Ce,Ee=q.x-oe.x,Ne=q.y-oe.y,st=ce.x-q.x,Ke=ce.y-q.y,J=Ee*Ee+Ne*Ne,Z=Ee*Ke-Ne*st;if(Math.abs(Z)>Number.EPSILON){let fe=Math.sqrt(J),Fe=Math.sqrt(st*st+Ke*Ke),Ve=oe.x-Ne/fe,ze=oe.y+Ee/fe,Tt=ce.x-Ke/Fe,ft=ce.y+st/Fe,St=((Tt-Ve)*Ke-(ft-ze)*st)/(Ee*Ke-Ne*st);X=Ve+Ee*St-q.x,ke=ze+Ne*St-q.y;let nr=X*X+ke*ke;if(nr<=2)return new Je(X,ke);Ce=Math.sqrt(nr/2)}else{let fe=!1;Ee>Number.EPSILON?st>Number.EPSILON&&(fe=!0):Ee<-Number.EPSILON?st<-Number.EPSILON&&(fe=!0):Math.sign(Ne)===Math.sign(Ke)&&(fe=!0),fe?(X=-Ne,ke=Ee,Ce=Math.sqrt(J)):(X=Ee,ke=Ne,Ce=Math.sqrt(J/2))}return new Je(X/Ce,ke/Ce)}let G=[];for(let q=0,oe=R.length,ce=oe-1,X=q+1;q<oe;q++,ce++,X++)ce===oe&&(ce=0),X===oe&&(X=0),G[q]=V(R[q],R[ce],R[X]);let ee=[],ie,me=G.concat();for(let q=0,oe=B.length;q<oe;q++){let ce=B[q];ie=[];for(let X=0,ke=ce.length,Ce=ke-1,Ee=X+1;X<ke;X++,Ce++,Ee++)Ce===ke&&(Ce=0),Ee===ke&&(Ee=0),ie[X]=V(ce[X],ce[Ce],ce[Ee]);ee.push(ie),me=me.concat(ie)}for(let q=0;q<v;q++){let oe=q/v,ce=p*Math.cos(oe*Math.PI/2),X=m*Math.sin(oe*Math.PI/2)+y;for(let ke=0,Ce=R.length;ke<Ce;ke++){let Ee=T(R[ke],G[ke],X);Le(Ee.x,Ee.y,-ce)}for(let ke=0,Ce=B.length;ke<Ce;ke++){let Ee=B[ke];ie=ee[ke];for(let Ne=0,st=Ee.length;Ne<st;Ne++){let Ke=T(Ee[Ne],ie[Ne],X);Le(Ke.x,Ke.y,-ce)}}}let Me=m+y;for(let q=0;q<N;q++){let oe=d?T(O[q],me[q],Me):O[q];A?(P.copy(E.normals[0]).multiplyScalar(oe.x),M.copy(E.binormals[0]).multiplyScalar(oe.y),k.copy(b[0]).add(P).add(M),Le(k.x,k.y,k.z)):Le(oe.x,oe.y,0)}for(let q=1;q<=c;q++)for(let oe=0;oe<N;oe++){let ce=d?T(O[oe],me[oe],Me):O[oe];A?(P.copy(E.normals[q]).multiplyScalar(ce.x),M.copy(E.binormals[q]).multiplyScalar(ce.y),k.copy(b[q]).add(P).add(M),Le(k.x,k.y,k.z)):Le(ce.x,ce.y,h/c*q)}for(let q=v-1;q>=0;q--){let oe=q/v,ce=p*Math.cos(oe*Math.PI/2),X=m*Math.sin(oe*Math.PI/2)+y;for(let ke=0,Ce=R.length;ke<Ce;ke++){let Ee=T(R[ke],G[ke],X);Le(Ee.x,Ee.y,h+ce)}for(let ke=0,Ce=B.length;ke<Ce;ke++){let Ee=B[ke];ie=ee[ke];for(let Ne=0,st=Ee.length;Ne<st;Ne++){let Ke=T(Ee[Ne],ie[Ne],X);A?Le(Ke.x,Ke.y+b[c-1].y,b[c-1].x+ce):Le(Ke.x,Ke.y,h+ce)}}}Ae(),le();function Ae(){let q=i.length/3;if(d){let oe=0,ce=N*oe;for(let X=0;X<$;X++){let ke=L[X];Se(ke[2]+ce,ke[1]+ce,ke[0]+ce)}oe=c+v*2,ce=N*oe;for(let X=0;X<$;X++){let ke=L[X];Se(ke[0]+ce,ke[1]+ce,ke[2]+ce)}}else{for(let oe=0;oe<$;oe++){let ce=L[oe];Se(ce[2],ce[1],ce[0])}for(let oe=0;oe<$;oe++){let ce=L[oe];Se(ce[0]+N*c,ce[1]+N*c,ce[2]+N*c)}}n.addGroup(q,i.length/3-q,0)}function le(){let q=i.length/3,oe=0;_e(R,oe),oe+=R.length;for(let ce=0,X=B.length;ce<X;ce++){let ke=B[ce];_e(ke,oe),oe+=ke.length}n.addGroup(q,i.length/3-q,1)}function _e(q,oe){let ce=q.length;for(;--ce>=0;){let X=ce,ke=ce-1;ke<0&&(ke=q.length-1);for(let Ce=0,Ee=c+v*2;Ce<Ee;Ce++){let Ne=N*Ce,st=N*(Ce+1),Ke=oe+X+Ne,J=oe+ke+Ne,Z=oe+ke+st,fe=oe+X+st;Ue(Ke,J,Z,fe)}}}function Le(q,oe,ce){l.push(q),l.push(oe),l.push(ce)}function Se(q,oe,ce){Y(q),Y(oe),Y(ce);let X=i.length/3,ke=w.generateTopUV(n,i,X-3,X-2,X-1);we(ke[0]),we(ke[1]),we(ke[2])}function Ue(q,oe,ce,X){Y(q),Y(oe),Y(X),Y(oe),Y(ce),Y(X);let ke=i.length/3,Ce=w.generateSideWallUV(n,i,ke-6,ke-3,ke-2,ke-1);we(Ce[0]),we(Ce[1]),we(Ce[3]),we(Ce[1]),we(Ce[2]),we(Ce[3])}function Y(q){i.push(l[q*3+0]),i.push(l[q*3+1]),i.push(l[q*3+2])}function we(q){a.push(q.x),a.push(q.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON(),r=this.parameters.shapes,n=this.parameters.options;return Zae(r,n,e)}static fromJSON(e,r){let n=[];for(let a=0,o=e.shapes.length;a<o;a++){let s=r[e.shapes[a]];n.push(s)}let i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new s4[i.type]().fromJSON(i)),new SN(n,e.options)}},Gae={generateTopUV:function(t,e,r,n,i){let a=e[r*3],o=e[r*3+1],s=e[n*3],l=e[n*3+1],u=e[i*3],c=e[i*3+1];return[new Je(a,o),new Je(s,l),new Je(u,c)]},generateSideWallUV:function(t,e,r,n,i,a){let o=e[r*3],s=e[r*3+1],l=e[r*3+2],u=e[n*3],c=e[n*3+1],h=e[n*3+2],d=e[i*3],p=e[i*3+1],m=e[i*3+2],y=e[a*3],v=e[a*3+1],_=e[a*3+2];return Math.abs(s-c)<Math.abs(o-u)?[new Je(o,1-l),new Je(u,1-h),new Je(d,1-m),new Je(y,1-_)]:[new Je(s,1-l),new Je(c,1-h),new Je(p,1-m),new Je(v,1-_)]}};function Zae(t,e,r){if(r.shapes=[],Array.isArray(t))for(let n=0,i=t.length;n<i;n++){let a=t[n];r.shapes.push(a.uuid)}else r.shapes.push(t.uuid);return r.options=Object.assign({},e),e.extrudePath!==void 0&&(r.options.extrudePath=e.extrudePath.toJSON()),r}var yd=class EN extends Ja{constructor(e=1,r=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:r,widthSegments:n,heightSegments:i};let a=e/2,o=r/2,s=Math.floor(n),l=Math.floor(i),u=s+1,c=l+1,h=e/s,d=r/l,p=[],m=[],y=[],v=[];for(let _=0;_<c;_++){let w=_*d-o;for(let b=0;b<u;b++){let A=b*h-a;m.push(A,-w,0),y.push(0,0,1),v.push(b/s),v.push(1-_/l)}}for(let _=0;_<l;_++)for(let w=0;w<s;w++){let b=w+u*_,A=w+u*(_+1),E=w+1+u*(_+1),M=w+1+u*_;p.push(b,A,M),p.push(A,E,M)}this.setIndex(p),this.setAttribute("position",new vo(m,3)),this.setAttribute("normal",new vo(y,3)),this.setAttribute("uv",new vo(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new EN(e.width,e.height,e.widthSegments,e.heightSegments)}},Wae=class IN extends Ja{constructor(e=new vN(new Q(-1,-1,0),new Q(-1,1,0),new Q(1,1,0)),r=64,n=1,i=8,a=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:r,radius:n,radialSegments:i,closed:a};let o=e.computeFrenetFrames(r,a);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;let s=new Q,l=new Q,u=new Je,c=new Q,h=[],d=[],p=[],m=[];y(),this.setIndex(m),this.setAttribute("position",new vo(h,3)),this.setAttribute("normal",new vo(d,3)),this.setAttribute("uv",new vo(p,2));function y(){for(let b=0;b<r;b++)v(b);v(a===!1?r:0),w(),_()}function v(b){c=e.getPointAt(b/r,c);let A=o.normals[b],E=o.binormals[b];for(let M=0;M<=i;M++){let P=M/i*Math.PI*2,k=Math.sin(P),D=-Math.cos(P);l.x=D*A.x+k*E.x,l.y=D*A.y+k*E.y,l.z=D*A.z+k*E.z,l.normalize(),d.push(l.x,l.y,l.z),s.x=c.x+n*l.x,s.y=c.y+n*l.y,s.z=c.z+n*l.z,h.push(s.x,s.y,s.z)}}function _(){for(let b=1;b<=r;b++)for(let A=1;A<=i;A++){let E=(i+1)*(b-1)+(A-1),M=(i+1)*b+(A-1),P=(i+1)*b+A,k=(i+1)*(b-1)+A;m.push(E,M,k),m.push(M,P,k)}}function w(){for(let b=0;b<=r;b++)for(let A=0;A<=i;A++)u.x=b/r,u.y=A/i,p.push(u.x,u.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new IN(new s4[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}},l4=class extends gd{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new jt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new jt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=yP,this.normalScale=new Je(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Vo,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},VKe=class extends l4{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Je(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return zr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(r){this.ior=(1+.4*r)/(1-.4*r)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new jt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new jt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new jt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}},PC=class extends gd{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new jt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new jt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=yP,this.normalScale=new Je(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Vo,this.combine=cP,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},Hae=class extends gd{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=rie,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},Xae=class extends gd{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}};function vx(t,e,r){return!t||t.constructor===e?t:typeof e.BYTES_PER_ELEMENT=="number"?new e(t):Array.prototype.slice.call(t)}function qae(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Yae(t){function e(i,a){return t[i]-t[a]}let r=t.length,n=new Array(r);for(let i=0;i!==r;++i)n[i]=i;return n.sort(e),n}function b7(t,e,r){let n=t.length,i=new t.constructor(n);for(let a=0,o=0;o!==n;++a){let s=r[a]*e;for(let l=0;l!==e;++l)i[o++]=t[s+l]}return i}function CN(t,e,r,n){let i=1,a=t[0];for(;a!==void 0&&a[n]===void 0;)a=t[i++];if(a===void 0)return;let o=a[n];if(o!==void 0)if(Array.isArray(o))do o=a[n],o!==void 0&&(e.push(a.time),r.push.apply(r,o)),a=t[i++];while(a!==void 0);else if(o.toArray!==void 0)do o=a[n],o!==void 0&&(e.push(a.time),o.toArray(r,r.length)),a=t[i++];while(a!==void 0);else do o=a[n],o!==void 0&&(e.push(a.time),r.push(o)),a=t[i++];while(a!==void 0)}var IA=class{constructor(e,r,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new r.constructor(n),this.sampleValues=r,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){let r=this.parameterPositions,n=this._cachedIndex,i=r[n],a=r[n-1];r:{e:{let o;t:{n:if(!(e<i)){for(let s=n+2;;){if(i===void 0){if(e<a)break n;return n=r.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===s)break;if(a=i,i=r[++n],e<i)break e}o=r.length;break t}if(!(e>=a)){let s=r[1];e<s&&(n=2,a=s);for(let l=n-2;;){if(a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===l)break;if(i=a,a=r[--n-1],e>=a)break e}o=n,n=0;break t}break r}for(;n<o;){let s=n+o>>>1;e<r[s]?o=s:n=s+1}if(i=r[n],a=r[n-1],a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return n=r.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,a,i)}return this.interpolate_(n,a,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let r=this.resultBuffer,n=this.sampleValues,i=this.valueSize,a=e*i;for(let o=0;o!==i;++o)r[o]=n[a+o];return r}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},Jae=class extends IA{constructor(e,r,n,i){super(e,r,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:OB,endingEnd:OB}}intervalChanged_(e,r,n){let i=this.parameterPositions,a=e-2,o=e+1,s=i[a],l=i[o];if(s===void 0)switch(this.getSettings_().endingStart){case BB:a=e,s=2*r-n;break;case zB:a=i.length-2,s=r+i[a]-i[a+1];break;default:a=e,s=n}if(l===void 0)switch(this.getSettings_().endingEnd){case BB:o=e,l=2*n-r;break;case zB:o=1,l=n+i[1]-i[0];break;default:o=e-1,l=r}let u=(n-r)*.5,c=this.valueSize;this._weightPrev=u/(r-s),this._weightNext=u/(l-n),this._offsetPrev=a*c,this._offsetNext=o*c}interpolate_(e,r,n,i){let a=this.resultBuffer,o=this.sampleValues,s=this.valueSize,l=e*s,u=l-s,c=this._offsetPrev,h=this._offsetNext,d=this._weightPrev,p=this._weightNext,m=(n-r)/(i-r),y=m*m,v=y*m,_=-d*v+2*d*y-d*m,w=(1+d)*v+(-1.5-2*d)*y+(-.5+d)*m+1,b=(-1-p)*v+(1.5+p)*y+.5*m,A=p*v-p*y;for(let E=0;E!==s;++E)a[E]=_*o[c+E]+w*o[u+E]+b*o[l+E]+A*o[h+E];return a}},Kae=class extends IA{constructor(e,r,n,i){super(e,r,n,i)}interpolate_(e,r,n,i){let a=this.resultBuffer,o=this.sampleValues,s=this.valueSize,l=e*s,u=l-s,c=(n-r)/(i-r),h=1-c;for(let d=0;d!==s;++d)a[d]=o[u+d]*h+o[l+d]*c;return a}},Qae=class extends IA{constructor(e,r,n,i){super(e,r,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}},Ru=class{constructor(e,r,n,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(r===void 0||r.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=vx(r,this.TimeBufferType),this.values=vx(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){let r=e.constructor,n;if(r.toJSON!==this.toJSON)n=r.toJSON(e);else{n={name:e.name,times:vx(e.times,Array),values:vx(e.values,Array)};let i=e.getInterpolation();i!==e.DefaultInterpolation&&(n.interpolation=i)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new Qae(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Kae(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Jae(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let r;switch(e){case t4:r=this.InterpolantFactoryMethodDiscrete;break;case AC:r=this.InterpolantFactoryMethodLinear;break;case CS:r=this.InterpolantFactoryMethodSmooth;break}if(r===void 0){let n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=r,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return t4;case this.InterpolantFactoryMethodLinear:return AC;case this.InterpolantFactoryMethodSmooth:return CS}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let r=this.times;for(let n=0,i=r.length;n!==i;++n)r[n]+=e}return this}scale(e){if(e!==1){let r=this.times;for(let n=0,i=r.length;n!==i;++n)r[n]*=e}return this}trim(e,r){let n=this.times,i=n.length,a=0,o=i-1;for(;a!==i&&n[a]<e;)++a;for(;o!==-1&&n[o]>r;)--o;if(++o,a!==0||o!==i){a>=o&&(o=Math.max(o,1),a=o-1);let s=this.getValueSize();this.times=n.slice(a,o),this.values=this.values.slice(a*s,o*s)}return this}validate(){let e=!0,r=this.getValueSize();r-Math.floor(r)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let n=this.times,i=this.values,a=n.length;a===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let s=0;s!==a;s++){let l=n[s];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,s,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,s,l,o),e=!1;break}o=l}if(i!==void 0&&qae(i))for(let s=0,l=i.length;s!==l;++s){let u=i[s];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,s,u),e=!1;break}}return e}optimize(){let e=this.times.slice(),r=this.values.slice(),n=this.getValueSize(),i=this.getInterpolation()===CS,a=e.length-1,o=1;for(let s=1;s<a;++s){let l=!1,u=e[s],c=e[s+1];if(u!==c&&(s!==1||u!==e[0]))if(i)l=!0;else{let h=s*n,d=h-n,p=h+n;for(let m=0;m!==n;++m){let y=r[h+m];if(y!==r[d+m]||y!==r[p+m]){l=!0;break}}}if(l){if(s!==o){e[o]=e[s];let h=s*n,d=o*n;for(let p=0;p!==n;++p)r[d+p]=r[h+p]}++o}}if(a>0){e[o]=e[a];for(let s=a*n,l=o*n,u=0;u!==n;++u)r[l+u]=r[s+u];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=r.slice(0,o*n)):(this.times=e,this.values=r),this}clone(){let e=this.times.slice(),r=this.values.slice(),n=this.constructor,i=new n(this.name,e,r);return i.createInterpolant=this.createInterpolant,i}};Ru.prototype.TimeBufferType=Float32Array;Ru.prototype.ValueBufferType=Float32Array;Ru.prototype.DefaultInterpolation=AC;var d0=class extends Ru{constructor(e,r,n){super(e,r,n)}};d0.prototype.ValueTypeName="bool";d0.prototype.ValueBufferType=Array;d0.prototype.DefaultInterpolation=t4;d0.prototype.InterpolantFactoryMethodLinear=void 0;d0.prototype.InterpolantFactoryMethodSmooth=void 0;var MN=class extends Ru{};MN.prototype.ValueTypeName="color";var u4=class extends Ru{};u4.prototype.ValueTypeName="number";var eoe=class extends IA{constructor(e,r,n,i){super(e,r,n,i)}interpolate_(e,r,n,i){let a=this.resultBuffer,o=this.sampleValues,s=this.valueSize,l=(n-r)/(i-r),u=e*s;for(let c=u+s;u!==c;u+=4)Iu.slerpFlat(a,0,o,u-s,o,u,l);return a}},CA=class extends Ru{InterpolantFactoryMethodLinear(e){return new eoe(this.times,this.values,this.getValueSize(),e)}};CA.prototype.ValueTypeName="quaternion";CA.prototype.InterpolantFactoryMethodSmooth=void 0;var p0=class extends Ru{constructor(e,r,n){super(e,r,n)}};p0.prototype.ValueTypeName="string";p0.prototype.ValueBufferType=Array;p0.prototype.DefaultInterpolation=t4;p0.prototype.InterpolantFactoryMethodLinear=void 0;p0.prototype.InterpolantFactoryMethodSmooth=void 0;var c4=class extends Ru{};c4.prototype.ValueTypeName="vector";var oQe=class{constructor(e="",r=-1,n=[],i=Qne){this.name=e,this.tracks=n,this.duration=r,this.blendMode=i,this.uuid=Gs(),this.duration<0&&this.resetDuration()}static parse(e){let r=[],n=e.tracks,i=1/(e.fps||1);for(let o=0,s=n.length;o!==s;++o)r.push(roe(n[o]).scale(i));let a=new this(e.name,e.duration,r,e.blendMode);return a.uuid=e.uuid,a}static toJSON(e){let r=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:r,uuid:e.uuid,blendMode:e.blendMode};for(let a=0,o=n.length;a!==o;++a)r.push(Ru.toJSON(n[a]));return i}static CreateFromMorphTargetSequence(e,r,n,i){let a=r.length,o=[];for(let s=0;s<a;s++){let l=[],u=[];l.push((s+a-1)%a,s,(s+1)%a),u.push(0,1,0);let c=Yae(l);l=b7(l,1,c),u=b7(u,1,c),!i&&l[0]===0&&(l.push(a),u.push(u[0])),o.push(new u4(".morphTargetInfluences["+r[s].name+"]",l,u).scale(1/n))}return new this(e,-1,o)}static findByName(e,r){let n=e;if(!Array.isArray(e)){let i=e;n=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<n.length;i++)if(n[i].name===r)return n[i];return null}static CreateClipsFromMorphTargetSequences(e,r,n){let i={},a=/^([\w-]*?)([\d]+)$/;for(let s=0,l=e.length;s<l;s++){let u=e[s],c=u.name.match(a);if(c&&c.length>1){let h=c[1],d=i[h];d||(i[h]=d=[]),d.push(u)}}let o=[];for(let s in i)o.push(this.CreateFromMorphTargetSequence(s,i[s],r,n));return o}static parseAnimation(e,r){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let n=function(c,h,d,p,m){if(d.length!==0){let y=[],v=[];CN(d,y,v,p),y.length!==0&&m.push(new c(h,y,v))}},i=[],a=e.name||"default",o=e.fps||30,s=e.blendMode,l=e.length||-1,u=e.hierarchy||[];for(let c=0;c<u.length;c++){let h=u[c].keys;if(!(!h||h.length===0))if(h[0].morphTargets){let d={},p;for(p=0;p<h.length;p++)if(h[p].morphTargets)for(let m=0;m<h[p].morphTargets.length;m++)d[h[p].morphTargets[m]]=-1;for(let m in d){let y=[],v=[];for(let _=0;_!==h[p].morphTargets.length;++_){let w=h[p];y.push(w.time),v.push(w.morphTarget===m?1:0)}i.push(new u4(".morphTargetInfluence["+m+"]",y,v))}l=d.length*o}else{let d=".bones["+r[c].name+"]";n(c4,d+".position",h,"pos",i),n(CA,d+".quaternion",h,"rot",i),n(c4,d+".scale",h,"scl",i)}}return i.length===0?null:new this(a,l,i,s)}resetDuration(){let e=this.tracks,r=0;for(let n=0,i=e.length;n!==i;++n){let a=this.tracks[n];r=Math.max(r,a.times[a.times.length-1])}return this.duration=r,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let r=0;r<this.tracks.length;r++)e=e&&this.tracks[r].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let r=0;r<this.tracks.length;r++)e.push(this.tracks[r].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function toe(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return u4;case"vector":case"vector2":case"vector3":case"vector4":return c4;case"color":return MN;case"quaternion":return CA;case"bool":case"boolean":return d0;case"string":return p0}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function roe(t){if(t.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let e=toe(t.type);if(t.times===void 0){let r=[],n=[];CN(t.keys,r,n,"value"),t.times=r,t.values=n}return e.parse!==void 0?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}var Yh={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},noe=class{constructor(e,r,n){let i=this,a=!1,o=0,s=0,l,u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=r,this.onError=n,this.itemStart=function(c){s++,a===!1&&i.onStart!==void 0&&i.onStart(c,o,s),a=!0},this.itemEnd=function(c){o++,i.onProgress!==void 0&&i.onProgress(c,o,s),o===s&&(a=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(c){i.onError!==void 0&&i.onError(c)},this.resolveURL=function(c){return l?l(c):c},this.setURLModifier=function(c){return l=c,this},this.addHandler=function(c,h){return u.push(c,h),this},this.removeHandler=function(c){let h=u.indexOf(c);return h!==-1&&u.splice(h,2),this},this.getHandler=function(c){for(let h=0,d=u.length;h<d;h+=2){let p=u[h],m=u[h+1];if(p.global&&(p.lastIndex=0),p.test(c))return m}return null}}},ioe=new noe,V1=class{constructor(e){this.manager=e!==void 0?e:ioe,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,r){let n=this;return new Promise(function(i,a){n.load(e,i,r,a)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};V1.DEFAULT_MATERIAL_NAME="__DEFAULT";var nc={},aoe=class extends Error{constructor(e,r){super(e),this.response=r}},hQe=class extends V1{constructor(e){super(e)}load(e,r,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let a=Yh.get(e);if(a!==void 0)return this.manager.itemStart(e),setTimeout(()=>{r&&r(a),this.manager.itemEnd(e)},0),a;if(nc[e]!==void 0){nc[e].push({onLoad:r,onProgress:n,onError:i});return}nc[e]=[],nc[e].push({onLoad:r,onProgress:n,onError:i});let o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),s=this.mimeType,l=this.responseType;fetch(o).then(u=>{if(u.status===200||u.status===0){if(u.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||u.body===void 0||u.body.getReader===void 0)return u;let c=nc[e],h=u.body.getReader(),d=u.headers.get("X-File-Size")||u.headers.get("Content-Length"),p=d?parseInt(d):0,m=p!==0,y=0,v=new ReadableStream({start(_){w();function w(){h.read().then(({done:b,value:A})=>{if(b)_.close();else{y+=A.byteLength;let E=new ProgressEvent("progress",{lengthComputable:m,loaded:y,total:p});for(let M=0,P=c.length;M<P;M++){let k=c[M];k.onProgress&&k.onProgress(E)}_.enqueue(A),w()}},b=>{_.error(b)})}}});return new Response(v)}else throw new aoe('fetch for "'.concat(u.url,'" responded with ').concat(u.status,": ").concat(u.statusText),u)}).then(u=>{switch(l){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(c=>new DOMParser().parseFromString(c,s));case"json":return u.json();default:if(s===void 0)return u.text();{let c=/charset="?([^;"\s]*)"?/i.exec(s),h=c&&c[1]?c[1].toLowerCase():void 0,d=new TextDecoder(h);return u.arrayBuffer().then(p=>d.decode(p))}}}).then(u=>{Yh.add(e,u);let c=nc[e];delete nc[e];for(let h=0,d=c.length;h<d;h++){let p=c[h];p.onLoad&&p.onLoad(u)}}).catch(u=>{let c=nc[e];if(c===void 0)throw this.manager.itemError(e),u;delete nc[e];for(let h=0,d=c.length;h<d;h++){let p=c[h];p.onError&&p.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}},ooe=class extends V1{constructor(e){super(e)}load(e,r,n,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let a=this,o=Yh.get(e);if(o!==void 0)return a.manager.itemStart(e),setTimeout(function(){r&&r(o),a.manager.itemEnd(e)},0),o;let s=Jv("img");function l(){c(),Yh.add(e,this),r&&r(this),a.manager.itemEnd(e)}function u(h){c(),i&&i(h),a.manager.itemError(e),a.manager.itemEnd(e)}function c(){s.removeEventListener("load",l,!1),s.removeEventListener("error",u,!1)}return s.addEventListener("load",l,!1),s.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(s.crossOrigin=this.crossOrigin),a.manager.itemStart(e),s.src=e,s}},TN=class extends V1{constructor(e){super(e)}load(e,r,n,i){let a=new Ho,o=new ooe(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(s){a.image=s,a.needsUpdate=!0,r!==void 0&&r(a)},n,i),a}},MA=class extends Yn{constructor(e,r=1){super(),this.isLight=!0,this.type="Light",this.color=new jt(e),this.intensity=r}dispose(){}copy(e,r){return super.copy(e,r),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let r=super.toJSON(e);return r.object.color=this.color.getHex(),r.object.intensity=this.intensity,this.groundColor!==void 0&&(r.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(r.object.distance=this.distance),this.angle!==void 0&&(r.object.angle=this.angle),this.decay!==void 0&&(r.object.decay=this.decay),this.penumbra!==void 0&&(r.object.penumbra=this.penumbra),this.shadow!==void 0&&(r.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(r.object.target=this.target.uuid),r}},lE=new gr,w7=new Q,A7=new Q,IP=class{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Je(512,512),this.map=null,this.mapPass=null,this.matrix=new gr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new h0,this._frameExtents=new Je(1,1),this._viewportCount=1,this._viewports=[new _n(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let r=this.camera,n=this.matrix;w7.setFromMatrixPosition(e.matrixWorld),r.position.copy(w7),A7.setFromMatrixPosition(e.target.matrixWorld),r.lookAt(A7),r.updateMatrixWorld(),lE.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(lE),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(lE)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},soe=class extends IP{constructor(){super(new co(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let r=this.camera,n=xg*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,a=e.distance||r.far;(n!==r.fov||i!==r.aspect||a!==r.far)&&(r.fov=n,r.aspect=i,r.far=a,r.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},vQe=class extends MA{constructor(e,r,n=0,i=Math.PI/3,a=0,o=2){super(e,r),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Yn.DEFAULT_UP),this.updateMatrix(),this.target=new Yn,this.distance=n,this.angle=i,this.penumbra=a,this.decay=o,this.map=null,this.shadow=new soe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,r){return super.copy(e,r),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},S7=new gr,ty=new Q,uE=new Q,loe=class extends IP{constructor(){super(new co(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Je(4,2),this._viewportCount=6,this._viewports=[new _n(2,1,1,1),new _n(0,1,1,1),new _n(3,1,1,1),new _n(1,1,1,1),new _n(3,0,1,1),new _n(1,0,1,1)],this._cubeDirections=[new Q(1,0,0),new Q(-1,0,0),new Q(0,0,1),new Q(0,0,-1),new Q(0,1,0),new Q(0,-1,0)],this._cubeUps=[new Q(0,1,0),new Q(0,1,0),new Q(0,1,0),new Q(0,1,0),new Q(0,0,1),new Q(0,0,-1)]}updateMatrices(e,r=0){let n=this.camera,i=this.matrix,a=e.distance||n.far;a!==n.far&&(n.far=a,n.updateProjectionMatrix()),ty.setFromMatrixPosition(e.matrixWorld),n.position.copy(ty),uE.copy(n.position),uE.add(this._cubeDirections[r]),n.up.copy(this._cubeUps[r]),n.lookAt(uE),n.updateMatrixWorld(),i.makeTranslation(-ty.x,-ty.y,-ty.z),S7.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(S7)}},bQe=class extends MA{constructor(e,r,n=0,i=2){super(e,r),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new loe}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,r){return super.copy(e,r),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},PN=class extends xP{constructor(e=-1,r=1,n=1,i=-1,a=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=r,this.top=n,this.bottom=i,this.near=a,this.far=o,this.updateProjectionMatrix()}copy(e,r){return super.copy(e,r),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,r,n,i,a,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=r,this.view.offsetX=n,this.view.offsetY=i,this.view.width=a,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),r=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2,a=n-e,o=n+e,s=i+r,l=i-r;if(this.view!==null&&this.view.enabled){let u=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=u*this.view.offsetX,o=a+u*this.view.width,s-=c*this.view.offsetY,l=s-c*this.view.height}this.projectionMatrix.makeOrthographic(a,o,s,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let r=super.toJSON(e);return r.object.zoom=this.zoom,r.object.left=this.left,r.object.right=this.right,r.object.top=this.top,r.object.bottom=this.bottom,r.object.near=this.near,r.object.far=this.far,this.view!==null&&(r.object.view=Object.assign({},this.view)),r}},uoe=class extends IP{constructor(){super(new PN(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},DN=class extends MA{constructor(e,r){super(e,r),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Yn.DEFAULT_UP),this.updateMatrix(),this.target=new Yn,this.shadow=new uoe}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},coe=class extends MA{constructor(e,r){super(e,r),this.isAmbientLight=!0,this.type="AmbientLight"}},CQe=class{static decodeText(e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return new TextDecoder().decode(e);let r="";for(let n=0,i=e.length;n<i;n++)r+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(r))}catch{return r}}static extractUrlBase(e){let r=e.lastIndexOf("/");return r===-1?"./":e.slice(0,r+1)}static resolveURL(e,r){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(r)&&/^\//.test(e)&&(r=r.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:r+e)}},TQe=class extends Ja{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}},DQe=class extends V1{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,r,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let a=this,o=Yh.get(e);if(o!==void 0){if(a.manager.itemStart(e),o.then){o.then(u=>{r&&r(u),a.manager.itemEnd(e)}).catch(u=>{i&&i(u)});return}return setTimeout(function(){r&&r(o),a.manager.itemEnd(e)},0),o}let s={};s.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",s.headers=this.requestHeader;let l=fetch(e,s).then(function(u){return u.blob()}).then(function(u){return createImageBitmap(u,Object.assign(a.options,{colorSpaceConversion:"none"}))}).then(function(u){return Yh.add(e,u),r&&r(u),a.manager.itemEnd(e),u}).catch(function(u){i&&i(u),Yh.remove(e),a.manager.itemError(e),a.manager.itemEnd(e)});Yh.add(e,l),a.manager.itemStart(e)}},hoe=class extends co{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e,this.index=0}},doe=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=E7(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let r=E7();e=(r-this.oldTime)/1e3,this.oldTime=r,this.elapsedTime+=e}return e}};function E7(){return performance.now()}var CP="\\[\\]\\.:\\/",poe=new RegExp("["+CP+"]","g"),MP="[^"+CP+"]",foe="[^"+CP.replace("\\.","")+"]",moe=/((?:WC+[\/:])*)/.source.replace("WC",MP),goe=/(WCOD+)?/.source.replace("WCOD",foe),yoe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",MP),voe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",MP),_oe=new RegExp("^"+moe+goe+yoe+voe+"$"),xoe=["material","materials","bones","map"],boe=class{constructor(e,r,n){let i=n||Ti.parseTrackName(r);this._targetGroup=e,this._bindings=e.subscribe_(r,i)}getValue(e,r){this.bind();let n=this._targetGroup.nCachedObjects_,i=this._bindings[n];i!==void 0&&i.getValue(e,r)}setValue(e,r){let n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,a=n.length;i!==a;++i)n[i].setValue(e,r)}bind(){let e=this._bindings;for(let r=this._targetGroup.nCachedObjects_,n=e.length;r!==n;++r)e[r].bind()}unbind(){let e=this._bindings;for(let r=this._targetGroup.nCachedObjects_,n=e.length;r!==n;++r)e[r].unbind()}},Ti=class Rf{constructor(e,r,n){this.path=r,this.parsedPath=n||Rf.parseTrackName(r),this.node=Rf.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,r,n){return e&&e.isAnimationObjectGroup?new Rf.Composite(e,r,n):new Rf(e,r,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(poe,"")}static parseTrackName(e){let r=_oe.exec(e);if(r===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let n={nodeName:r[2],objectName:r[3],objectIndex:r[4],propertyName:r[5],propertyIndex:r[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){let a=n.nodeName.substring(i+1);xoe.indexOf(a)!==-1&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=a)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,r){if(r===void 0||r===""||r==="."||r===-1||r===e.name||r===e.uuid)return e;if(e.skeleton){let n=e.skeleton.getBoneByName(r);if(n!==void 0)return n}if(e.children){let n=function(a){for(let o=0;o<a.length;o++){let s=a[o];if(s.name===r||s.uuid===r)return s;let l=n(s.children);if(l)return l}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,r){e[r]=this.targetObject[this.propertyName]}_getValue_array(e,r){let n=this.resolvedProperty;for(let i=0,a=n.length;i!==a;++i)e[r++]=n[i]}_getValue_arrayElement(e,r){e[r]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,r){this.resolvedProperty.toArray(e,r)}_setValue_direct(e,r){this.targetObject[this.propertyName]=e[r]}_setValue_direct_setNeedsUpdate(e,r){this.targetObject[this.propertyName]=e[r],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,r){this.targetObject[this.propertyName]=e[r],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,r){let n=this.resolvedProperty;for(let i=0,a=n.length;i!==a;++i)n[i]=e[r++]}_setValue_array_setNeedsUpdate(e,r){let n=this.resolvedProperty;for(let i=0,a=n.length;i!==a;++i)n[i]=e[r++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,r){let n=this.resolvedProperty;for(let i=0,a=n.length;i!==a;++i)n[i]=e[r++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,r){this.resolvedProperty[this.propertyIndex]=e[r]}_setValue_arrayElement_setNeedsUpdate(e,r){this.resolvedProperty[this.propertyIndex]=e[r],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,r){this.resolvedProperty[this.propertyIndex]=e[r],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,r){this.resolvedProperty.fromArray(e,r)}_setValue_fromArray_setNeedsUpdate(e,r){this.resolvedProperty.fromArray(e,r),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,r){this.resolvedProperty.fromArray(e,r),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,r){this.bind(),this.getValue(e,r)}_setValue_unbound(e,r){this.bind(),this.setValue(e,r)}bind(){let e=this.node,r=this.parsedPath,n=r.objectName,i=r.propertyName,a=r.propertyIndex;if(e||(e=Rf.findNode(this.rootNode,r.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let u=r.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let c=0;c<e.length;c++)if(e[c].name===u){u=c;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(u!==void 0){if(e[u]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[u]}}let o=e[i];if(o===void 0){let u=r.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+i+" but it wasn't found.",e);return}let s=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?s=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(s=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(a!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[a]!==void 0&&(a=e.morphTargetDictionary[a])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=a}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][s]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};Ti.Composite=boe;Ti.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Ti.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Ti.prototype.GetterByBindingType=[Ti.prototype._getValue_direct,Ti.prototype._getValue_array,Ti.prototype._getValue_arrayElement,Ti.prototype._getValue_toArray];Ti.prototype.SetterByBindingTypeAndVersioning=[[Ti.prototype._setValue_direct,Ti.prototype._setValue_direct_setNeedsUpdate,Ti.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ti.prototype._setValue_array,Ti.prototype._setValue_array_setNeedsUpdate,Ti.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ti.prototype._setValue_arrayElement,Ti.prototype._setValue_arrayElement_setNeedsUpdate,Ti.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ti.prototype._setValue_fromArray,Ti.prototype._setValue_fromArray_setNeedsUpdate,Ti.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var I7=new gr,G1=class{constructor(e,r,n=0,i=1/0){this.ray=new U1(e,r),this.near=n,this.far=i,this.camera=null,this.layers=new _P,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,r){this.ray.set(e,r)}setFromCamera(e,r){r.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(r.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(r).sub(this.ray.origin).normalize(),this.camera=r):r.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(r.near+r.far)/(r.near-r.far)).unproject(r),this.ray.direction.set(0,0,-1).transformDirection(r.matrixWorld),this.camera=r):console.error("THREE.Raycaster: Unsupported camera type: "+r.type)}setFromXRController(e){return I7.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(I7),this}intersectObject(e,r=!0,n=[]){return DC(e,this,n,r),n.sort(C7),n}intersectObjects(e,r=!0,n=[]){for(let i=0,a=e.length;i<a;i++)DC(e[i],this,n,r);return n.sort(C7),n}};function C7(t,e){return t.distance-e.distance}function DC(t,e,r,n){let i=!0;if(t.layers.test(e.layers)&&t.raycast(e,r)===!1&&(i=!1),i===!0&&n===!0){let a=t.children;for(let o=0,s=a.length;o<s;o++)DC(a[o],e,r,!0)}}var M7=new Je,kN=class{constructor(e=new Je(1/0,1/0),r=new Je(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=r}set(e,r){return this.min.copy(e),this.max.copy(r),this}setFromPoints(e){this.makeEmpty();for(let r=0,n=e.length;r<n;r++)this.expandByPoint(e[r]);return this}setFromCenterAndSize(e,r){let n=M7.copy(r).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,r){return r.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,r){return r.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,M7).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}};function T7(t,e,r,n){let i=woe(n);switch(r){case $9:return t*e;case j9:return t*e;case V9:return t*e*2;case fP:return t*e/i.components*i.byteLength;case AA:return t*e/i.components*i.byteLength;case G9:return t*e*2/i.components*i.byteLength;case mP:return t*e*2/i.components*i.byteLength;case U9:return t*e*3/i.components*i.byteLength;case Ha:return t*e*4/i.components*i.byteLength;case gP:return t*e*4/i.components*i.byteLength;case Ob:case Bb:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case zb:case Fb:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case KI:case eC:return Math.max(t,16)*Math.max(e,8)/4;case JI:case QI:return Math.max(t,8)*Math.max(e,8)/2;case tC:case rC:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case nC:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case iC:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case aC:return Math.floor((t+4)/5)*Math.floor((e+3)/4)*16;case oC:return Math.floor((t+4)/5)*Math.floor((e+4)/5)*16;case sC:return Math.floor((t+5)/6)*Math.floor((e+4)/5)*16;case lC:return Math.floor((t+5)/6)*Math.floor((e+5)/6)*16;case uC:return Math.floor((t+7)/8)*Math.floor((e+4)/5)*16;case cC:return Math.floor((t+7)/8)*Math.floor((e+5)/6)*16;case hC:return Math.floor((t+7)/8)*Math.floor((e+7)/8)*16;case dC:return Math.floor((t+9)/10)*Math.floor((e+4)/5)*16;case pC:return Math.floor((t+9)/10)*Math.floor((e+5)/6)*16;case fC:return Math.floor((t+9)/10)*Math.floor((e+7)/8)*16;case mC:return Math.floor((t+9)/10)*Math.floor((e+9)/10)*16;case gC:return Math.floor((t+11)/12)*Math.floor((e+9)/10)*16;case yC:return Math.floor((t+11)/12)*Math.floor((e+11)/12)*16;case Rb:case vC:case _C:return Math.ceil(t/4)*Math.ceil(e/4)*16;case Z9:case xC:return Math.ceil(t/4)*Math.ceil(e/4)*8;case bC:case wC:return Math.ceil(t/4)*Math.ceil(e/4)*16}throw new Error("Unable to determine texture byte length for ".concat(r," format."))}function woe(t){switch(t){case Fl:case R9:return{byteLength:1,components:1};case Yv:case L9:case $1:return{byteLength:2,components:1};case dP:case pP:return{byteLength:2,components:4};case id:case hP:case ps:return{byteLength:4,components:1};case N9:return{byteLength:4,components:3}}throw new Error("Unknown texture type ".concat(t,"."))}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:uP}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=uP);C();function ON(){let t=null,e=!1,r=null,n=null;function i(a,o){r(a,o),n=t.requestAnimationFrame(i)}return{start:function(){e!==!0&&r!==null&&(n=t.requestAnimationFrame(i),e=!0)},stop:function(){t.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(a){r=a},setContext:function(a){t=a}}}function Aoe(t){let e=new WeakMap;function r(s,l){let u=s.array,c=s.usage,h=u.byteLength,d=t.createBuffer();t.bindBuffer(l,d),t.bufferData(l,u,c),s.onUploadCallback();let p;if(u instanceof Float32Array)p=t.FLOAT;else if(u instanceof Uint16Array)s.isFloat16BufferAttribute?p=t.HALF_FLOAT:p=t.UNSIGNED_SHORT;else if(u instanceof Int16Array)p=t.SHORT;else if(u instanceof Uint32Array)p=t.UNSIGNED_INT;else if(u instanceof Int32Array)p=t.INT;else if(u instanceof Int8Array)p=t.BYTE;else if(u instanceof Uint8Array)p=t.UNSIGNED_BYTE;else if(u instanceof Uint8ClampedArray)p=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:d,type:p,bytesPerElement:u.BYTES_PER_ELEMENT,version:s.version,size:h}}function n(s,l,u){let c=l.array,h=l.updateRanges;if(t.bindBuffer(u,s),h.length===0)t.bufferSubData(u,0,c);else{h.sort((p,m)=>p.start-m.start);let d=0;for(let p=1;p<h.length;p++){let m=h[d],y=h[p];y.start<=m.start+m.count+1?m.count=Math.max(m.count,y.start+y.count-m.start):(++d,h[d]=y)}h.length=d+1;for(let p=0,m=h.length;p<m;p++){let y=h[p];t.bufferSubData(u,y.start*c.BYTES_PER_ELEMENT,c,y.start,y.count)}l.clearUpdateRanges()}l.onUploadCallback()}function i(s){return s.isInterleavedBufferAttribute&&(s=s.data),e.get(s)}function a(s){s.isInterleavedBufferAttribute&&(s=s.data);let l=e.get(s);l&&(t.deleteBuffer(l.buffer),e.delete(s))}function o(s,l){if(s.isInterleavedBufferAttribute&&(s=s.data),s.isGLBufferAttribute){let c=e.get(s);(!c||c.version<s.version)&&e.set(s,{buffer:s.buffer,type:s.type,bytesPerElement:s.elementSize,version:s.version});return}let u=e.get(s);if(u===void 0)e.set(s,r(s,l));else if(u.version<s.version){if(u.size!==s.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(u.buffer,s,l),u.version=s.version}}return{get:i,remove:a,update:o}}var Soe=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,Eoe=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,Ioe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,Coe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Moe=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,Toe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Poe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Doe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,koe=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,Ooe=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,Boe=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,zoe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Foe=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,Roe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Loe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Noe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,$oe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Uoe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,joe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Voe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Goe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Zoe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,Woe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,Hoe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,Xoe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,qoe=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Yoe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Joe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,Koe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Qoe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,ese="gl_FragColor = linearToOutputTexel( gl_FragColor );",tse=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,rse=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,nse=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,ise=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,ase=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,ose=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,sse=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,lse=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,use=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,cse=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,hse=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,dse=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,pse=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,fse=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,mse=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,gse=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,yse=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,vse=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,_se=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,xse=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,bse=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,wse=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Ase=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Sse=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Ese=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,Ise=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Cse=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Mse=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Tse=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,Pse=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,Dse=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,kse=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Ose=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Bse=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,zse=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Fse=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,Rse=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Lse=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Nse=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,$se=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Use=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,jse=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Vse=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Gse=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Zse=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Wse=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,Hse=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,Xse=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,qse=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,Yse=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Jse=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Kse=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Qse=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,ele=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,tle=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,rle=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,nle=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,ile=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,ale=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,ole=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,sle=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,lle=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,ule=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,cle=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,hle=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,dle=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,ple=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,fle=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,mle=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,gle=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,yle=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,vle=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,_le=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,xle=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,ble=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,wle=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,Ale=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Sle=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Ele=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Ile=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Cle=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Mle=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Tle=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Ple=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,Dle=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,kle=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Ole=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Ble=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,zle=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Fle=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Rle=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Lle=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Nle=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,$le=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Ule=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,jle=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Vle=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Gle=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Zle=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Wle=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Hle=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Xle=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,qle=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Yle=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Jle=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Kle=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Qle=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,eue=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,tue=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,rue=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Mr={alphahash_fragment:Soe,alphahash_pars_fragment:Eoe,alphamap_fragment:Ioe,alphamap_pars_fragment:Coe,alphatest_fragment:Moe,alphatest_pars_fragment:Toe,aomap_fragment:Poe,aomap_pars_fragment:Doe,batching_pars_vertex:koe,batching_vertex:Ooe,begin_vertex:Boe,beginnormal_vertex:zoe,bsdfs:Foe,iridescence_fragment:Roe,bumpmap_pars_fragment:Loe,clipping_planes_fragment:Noe,clipping_planes_pars_fragment:$oe,clipping_planes_pars_vertex:Uoe,clipping_planes_vertex:joe,color_fragment:Voe,color_pars_fragment:Goe,color_pars_vertex:Zoe,color_vertex:Woe,common:Hoe,cube_uv_reflection_fragment:Xoe,defaultnormal_vertex:qoe,displacementmap_pars_vertex:Yoe,displacementmap_vertex:Joe,emissivemap_fragment:Koe,emissivemap_pars_fragment:Qoe,colorspace_fragment:ese,colorspace_pars_fragment:tse,envmap_fragment:rse,envmap_common_pars_fragment:nse,envmap_pars_fragment:ise,envmap_pars_vertex:ase,envmap_physical_pars_fragment:gse,envmap_vertex:ose,fog_vertex:sse,fog_pars_vertex:lse,fog_fragment:use,fog_pars_fragment:cse,gradientmap_pars_fragment:hse,lightmap_pars_fragment:dse,lights_lambert_fragment:pse,lights_lambert_pars_fragment:fse,lights_pars_begin:mse,lights_toon_fragment:yse,lights_toon_pars_fragment:vse,lights_phong_fragment:_se,lights_phong_pars_fragment:xse,lights_physical_fragment:bse,lights_physical_pars_fragment:wse,lights_fragment_begin:Ase,lights_fragment_maps:Sse,lights_fragment_end:Ese,logdepthbuf_fragment:Ise,logdepthbuf_pars_fragment:Cse,logdepthbuf_pars_vertex:Mse,logdepthbuf_vertex:Tse,map_fragment:Pse,map_pars_fragment:Dse,map_particle_fragment:kse,map_particle_pars_fragment:Ose,metalnessmap_fragment:Bse,metalnessmap_pars_fragment:zse,morphinstance_vertex:Fse,morphcolor_vertex:Rse,morphnormal_vertex:Lse,morphtarget_pars_vertex:Nse,morphtarget_vertex:$se,normal_fragment_begin:Use,normal_fragment_maps:jse,normal_pars_fragment:Vse,normal_pars_vertex:Gse,normal_vertex:Zse,normalmap_pars_fragment:Wse,clearcoat_normal_fragment_begin:Hse,clearcoat_normal_fragment_maps:Xse,clearcoat_pars_fragment:qse,iridescence_pars_fragment:Yse,opaque_fragment:Jse,packing:Kse,premultiplied_alpha_fragment:Qse,project_vertex:ele,dithering_fragment:tle,dithering_pars_fragment:rle,roughnessmap_fragment:nle,roughnessmap_pars_fragment:ile,shadowmap_pars_fragment:ale,shadowmap_pars_vertex:ole,shadowmap_vertex:sle,shadowmask_pars_fragment:lle,skinbase_vertex:ule,skinning_pars_vertex:cle,skinning_vertex:hle,skinnormal_vertex:dle,specularmap_fragment:ple,specularmap_pars_fragment:fle,tonemapping_fragment:mle,tonemapping_pars_fragment:gle,transmission_fragment:yle,transmission_pars_fragment:vle,uv_pars_fragment:_le,uv_pars_vertex:xle,uv_vertex:ble,worldpos_vertex:wle,background_vert:Ale,background_frag:Sle,backgroundCube_vert:Ele,backgroundCube_frag:Ile,cube_vert:Cle,cube_frag:Mle,depth_vert:Tle,depth_frag:Ple,distanceRGBA_vert:Dle,distanceRGBA_frag:kle,equirect_vert:Ole,equirect_frag:Ble,linedashed_vert:zle,linedashed_frag:Fle,meshbasic_vert:Rle,meshbasic_frag:Lle,meshlambert_vert:Nle,meshlambert_frag:$le,meshmatcap_vert:Ule,meshmatcap_frag:jle,meshnormal_vert:Vle,meshnormal_frag:Gle,meshphong_vert:Zle,meshphong_frag:Wle,meshphysical_vert:Hle,meshphysical_frag:Xle,meshtoon_vert:qle,meshtoon_frag:Yle,points_vert:Jle,points_frag:Kle,shadow_vert:Qle,shadow_frag:eue,sprite_vert:tue,sprite_frag:rue},Dt={common:{diffuse:{value:new jt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Br},alphaMap:{value:null},alphaMapTransform:{value:new Br},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Br}},envmap:{envMap:{value:null},envMapRotation:{value:new Br},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Br}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Br}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Br},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Br},normalScale:{value:new Je(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Br},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Br}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Br}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Br}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new jt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new jt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Br},alphaTest:{value:0},uvTransform:{value:new Br}},sprite:{diffuse:{value:new jt(16777215)},opacity:{value:1},center:{value:new Je(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Br},alphaMap:{value:null},alphaMapTransform:{value:new Br},alphaTest:{value:0}}},hu={basic:{uniforms:uo([Dt.common,Dt.specularmap,Dt.envmap,Dt.aomap,Dt.lightmap,Dt.fog]),vertexShader:Mr.meshbasic_vert,fragmentShader:Mr.meshbasic_frag},lambert:{uniforms:uo([Dt.common,Dt.specularmap,Dt.envmap,Dt.aomap,Dt.lightmap,Dt.emissivemap,Dt.bumpmap,Dt.normalmap,Dt.displacementmap,Dt.fog,Dt.lights,{emissive:{value:new jt(0)}}]),vertexShader:Mr.meshlambert_vert,fragmentShader:Mr.meshlambert_frag},phong:{uniforms:uo([Dt.common,Dt.specularmap,Dt.envmap,Dt.aomap,Dt.lightmap,Dt.emissivemap,Dt.bumpmap,Dt.normalmap,Dt.displacementmap,Dt.fog,Dt.lights,{emissive:{value:new jt(0)},specular:{value:new jt(1118481)},shininess:{value:30}}]),vertexShader:Mr.meshphong_vert,fragmentShader:Mr.meshphong_frag},standard:{uniforms:uo([Dt.common,Dt.envmap,Dt.aomap,Dt.lightmap,Dt.emissivemap,Dt.bumpmap,Dt.normalmap,Dt.displacementmap,Dt.roughnessmap,Dt.metalnessmap,Dt.fog,Dt.lights,{emissive:{value:new jt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Mr.meshphysical_vert,fragmentShader:Mr.meshphysical_frag},toon:{uniforms:uo([Dt.common,Dt.aomap,Dt.lightmap,Dt.emissivemap,Dt.bumpmap,Dt.normalmap,Dt.displacementmap,Dt.gradientmap,Dt.fog,Dt.lights,{emissive:{value:new jt(0)}}]),vertexShader:Mr.meshtoon_vert,fragmentShader:Mr.meshtoon_frag},matcap:{uniforms:uo([Dt.common,Dt.bumpmap,Dt.normalmap,Dt.displacementmap,Dt.fog,{matcap:{value:null}}]),vertexShader:Mr.meshmatcap_vert,fragmentShader:Mr.meshmatcap_frag},points:{uniforms:uo([Dt.points,Dt.fog]),vertexShader:Mr.points_vert,fragmentShader:Mr.points_frag},dashed:{uniforms:uo([Dt.common,Dt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Mr.linedashed_vert,fragmentShader:Mr.linedashed_frag},depth:{uniforms:uo([Dt.common,Dt.displacementmap]),vertexShader:Mr.depth_vert,fragmentShader:Mr.depth_frag},normal:{uniforms:uo([Dt.common,Dt.bumpmap,Dt.normalmap,Dt.displacementmap,{opacity:{value:1}}]),vertexShader:Mr.meshnormal_vert,fragmentShader:Mr.meshnormal_frag},sprite:{uniforms:uo([Dt.sprite,Dt.fog]),vertexShader:Mr.sprite_vert,fragmentShader:Mr.sprite_frag},background:{uniforms:{uvTransform:{value:new Br},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Mr.background_vert,fragmentShader:Mr.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Br}},vertexShader:Mr.backgroundCube_vert,fragmentShader:Mr.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Mr.cube_vert,fragmentShader:Mr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Mr.equirect_vert,fragmentShader:Mr.equirect_frag},distanceRGBA:{uniforms:uo([Dt.common,Dt.displacementmap,{referencePosition:{value:new Q},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Mr.distanceRGBA_vert,fragmentShader:Mr.distanceRGBA_frag},shadow:{uniforms:uo([Dt.lights,Dt.fog,{color:{value:new jt(0)},opacity:{value:1}}]),vertexShader:Mr.shadow_vert,fragmentShader:Mr.shadow_frag}};hu.physical={uniforms:uo([hu.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Br},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Br},clearcoatNormalScale:{value:new Je(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Br},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Br},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Br},sheen:{value:0},sheenColor:{value:new jt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Br},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Br},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Br},transmissionSamplerSize:{value:new Je},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Br},attenuationDistance:{value:0},attenuationColor:{value:new jt(0)},specularColor:{value:new jt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Br},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Br},anisotropyVector:{value:new Je},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Br}}]),vertexShader:Mr.meshphysical_vert,fragmentShader:Mr.meshphysical_frag};var _x={r:0,b:0,g:0},Rd=new Vo,nue=new gr;function iue(t,e,r,n,i,a,o){let s=new jt(0),l=a===!0?0:1,u,c,h=null,d=0,p=null;function m(b){let A=b.isScene===!0?b.background:null;return A&&A.isTexture&&(A=(b.backgroundBlurriness>0?r:e).get(A)),A}function y(b){let A=!1,E=m(b);E===null?_(s,l):E&&E.isColor&&(_(E,1),A=!0);let M=t.xr.getEnvironmentBlendMode();M==="additive"?n.buffers.color.setClear(0,0,0,1,o):M==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,o),(t.autoClear||A)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil))}function v(b,A){let E=m(A);E&&(E.isCubeTexture||E.mapping===wA)?(c===void 0&&(c=new Er(new od(1,1,1),new ys({name:"BackgroundCubeMaterial",uniforms:bg(hu.backgroundCube.uniforms),vertexShader:hu.backgroundCube.vertexShader,fragmentShader:hu.backgroundCube.fragmentShader,side:xa,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(M,P,k){this.matrixWorld.copyPosition(k.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(c)),Rd.copy(A.backgroundRotation),Rd.x*=-1,Rd.y*=-1,Rd.z*=-1,E.isCubeTexture&&E.isRenderTargetTexture===!1&&(Rd.y*=-1,Rd.z*=-1),c.material.uniforms.envMap.value=E,c.material.uniforms.flipEnvMap.value=E.isCubeTexture&&E.isRenderTargetTexture===!1?-1:1,c.material.uniforms.backgroundBlurriness.value=A.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=A.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(nue.makeRotationFromEuler(Rd)),c.material.toneMapped=an.getTransfer(E.colorSpace)!==En,(h!==E||d!==E.version||p!==t.toneMapping)&&(c.material.needsUpdate=!0,h=E,d=E.version,p=t.toneMapping),c.layers.enableAll(),b.unshift(c,c.geometry,c.material,0,0,null)):E&&E.isTexture&&(u===void 0&&(u=new Er(new yd(2,2),new ys({name:"BackgroundMaterial",uniforms:bg(hu.background.uniforms),vertexShader:hu.background.vertexShader,fragmentShader:hu.background.fragmentShader,side:_s,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(u)),u.material.uniforms.t2D.value=E,u.material.uniforms.backgroundIntensity.value=A.backgroundIntensity,u.material.toneMapped=an.getTransfer(E.colorSpace)!==En,E.matrixAutoUpdate===!0&&E.updateMatrix(),u.material.uniforms.uvTransform.value.copy(E.matrix),(h!==E||d!==E.version||p!==t.toneMapping)&&(u.material.needsUpdate=!0,h=E,d=E.version,p=t.toneMapping),u.layers.enableAll(),b.unshift(u,u.geometry,u.material,0,0,null))}function _(b,A){b.getRGB(_x,sN(t)),n.buffers.color.setClear(_x.r,_x.g,_x.b,A,o)}function w(){c!==void 0&&(c.geometry.dispose(),c.material.dispose(),c=void 0),u!==void 0&&(u.geometry.dispose(),u.material.dispose(),u=void 0)}return{getClearColor:function(){return s},setClearColor:function(b,A=1){s.set(b),l=A,_(s,l)},getClearAlpha:function(){return l},setClearAlpha:function(b){l=b,_(s,l)},render:y,addToRenderList:v,dispose:w}}function aue(t,e){let r=t.getParameter(t.MAX_VERTEX_ATTRIBS),n={},i=d(null),a=i,o=!1;function s(O,B,L,R,T){let N=!1,$=h(R,L,B);a!==$&&(a=$,u(a.object)),N=p(O,R,L,T),N&&m(O,R,L,T),T!==null&&e.update(T,t.ELEMENT_ARRAY_BUFFER),(N||o)&&(o=!1,A(O,B,L,R),T!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.get(T).buffer))}function l(){return t.createVertexArray()}function u(O){return t.bindVertexArray(O)}function c(O){return t.deleteVertexArray(O)}function h(O,B,L){let R=L.wireframe===!0,T=n[O.id];T===void 0&&(T={},n[O.id]=T);let N=T[B.id];N===void 0&&(N={},T[B.id]=N);let $=N[R];return $===void 0&&($=d(l()),N[R]=$),$}function d(O){let B=[],L=[],R=[];for(let T=0;T<r;T++)B[T]=0,L[T]=0,R[T]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:B,enabledAttributes:L,attributeDivisors:R,object:O,attributes:{},index:null}}function p(O,B,L,R){let T=a.attributes,N=B.attributes,$=0,V=L.getAttributes();for(let G in V)if(V[G].location>=0){let ee=T[G],ie=N[G];if(ie===void 0&&(G==="instanceMatrix"&&O.instanceMatrix&&(ie=O.instanceMatrix),G==="instanceColor"&&O.instanceColor&&(ie=O.instanceColor)),ee===void 0||ee.attribute!==ie||ie&&ee.data!==ie.data)return!0;$++}return a.attributesNum!==$||a.index!==R}function m(O,B,L,R){let T={},N=B.attributes,$=0,V=L.getAttributes();for(let G in V)if(V[G].location>=0){let ee=N[G];ee===void 0&&(G==="instanceMatrix"&&O.instanceMatrix&&(ee=O.instanceMatrix),G==="instanceColor"&&O.instanceColor&&(ee=O.instanceColor));let ie={};ie.attribute=ee,ee&&ee.data&&(ie.data=ee.data),T[G]=ie,$++}a.attributes=T,a.attributesNum=$,a.index=R}function y(){let O=a.newAttributes;for(let B=0,L=O.length;B<L;B++)O[B]=0}function v(O){_(O,0)}function _(O,B){let L=a.newAttributes,R=a.enabledAttributes,T=a.attributeDivisors;L[O]=1,R[O]===0&&(t.enableVertexAttribArray(O),R[O]=1),T[O]!==B&&(t.vertexAttribDivisor(O,B),T[O]=B)}function w(){let O=a.newAttributes,B=a.enabledAttributes;for(let L=0,R=B.length;L<R;L++)B[L]!==O[L]&&(t.disableVertexAttribArray(L),B[L]=0)}function b(O,B,L,R,T,N,$){$===!0?t.vertexAttribIPointer(O,B,L,T,N):t.vertexAttribPointer(O,B,L,R,T,N)}function A(O,B,L,R){y();let T=R.attributes,N=L.getAttributes(),$=B.defaultAttributeValues;for(let V in N){let G=N[V];if(G.location>=0){let ee=T[V];if(ee===void 0&&(V==="instanceMatrix"&&O.instanceMatrix&&(ee=O.instanceMatrix),V==="instanceColor"&&O.instanceColor&&(ee=O.instanceColor)),ee!==void 0){let ie=ee.normalized,me=ee.itemSize,Me=e.get(ee);if(Me===void 0)continue;let Ae=Me.buffer,le=Me.type,_e=Me.bytesPerElement,Le=le===t.INT||le===t.UNSIGNED_INT||ee.gpuType===hP;if(ee.isInterleavedBufferAttribute){let Se=ee.data,Ue=Se.stride,Y=ee.offset;if(Se.isInstancedInterleavedBuffer){for(let we=0;we<G.locationSize;we++)_(G.location+we,Se.meshPerAttribute);O.isInstancedMesh!==!0&&R._maxInstanceCount===void 0&&(R._maxInstanceCount=Se.meshPerAttribute*Se.count)}else for(let we=0;we<G.locationSize;we++)v(G.location+we);t.bindBuffer(t.ARRAY_BUFFER,Ae);for(let we=0;we<G.locationSize;we++)b(G.location+we,me/G.locationSize,le,ie,Ue*_e,(Y+me/G.locationSize*we)*_e,Le)}else{if(ee.isInstancedBufferAttribute){for(let Se=0;Se<G.locationSize;Se++)_(G.location+Se,ee.meshPerAttribute);O.isInstancedMesh!==!0&&R._maxInstanceCount===void 0&&(R._maxInstanceCount=ee.meshPerAttribute*ee.count)}else for(let Se=0;Se<G.locationSize;Se++)v(G.location+Se);t.bindBuffer(t.ARRAY_BUFFER,Ae);for(let Se=0;Se<G.locationSize;Se++)b(G.location+Se,me/G.locationSize,le,ie,me*_e,me/G.locationSize*Se*_e,Le)}}else if($!==void 0){let ie=$[V];if(ie!==void 0)switch(ie.length){case 2:t.vertexAttrib2fv(G.location,ie);break;case 3:t.vertexAttrib3fv(G.location,ie);break;case 4:t.vertexAttrib4fv(G.location,ie);break;default:t.vertexAttrib1fv(G.location,ie)}}}}w()}function E(){k();for(let O in n){let B=n[O];for(let L in B){let R=B[L];for(let T in R)c(R[T].object),delete R[T];delete B[L]}delete n[O]}}function M(O){if(n[O.id]===void 0)return;let B=n[O.id];for(let L in B){let R=B[L];for(let T in R)c(R[T].object),delete R[T];delete B[L]}delete n[O.id]}function P(O){for(let B in n){let L=n[B];if(L[O.id]===void 0)continue;let R=L[O.id];for(let T in R)c(R[T].object),delete R[T];delete L[O.id]}}function k(){D(),o=!0,a!==i&&(a=i,u(a.object))}function D(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:s,reset:k,resetDefaultState:D,dispose:E,releaseStatesOfGeometry:M,releaseStatesOfProgram:P,initAttributes:y,enableAttribute:v,disableUnusedAttributes:w}}function oue(t,e,r){let n;function i(u){n=u}function a(u,c){t.drawArrays(n,u,c),r.update(c,n,1)}function o(u,c,h){h!==0&&(t.drawArraysInstanced(n,u,c,h),r.update(c,n,h))}function s(u,c,h){if(h===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,u,0,c,0,h);let d=0;for(let p=0;p<h;p++)d+=c[p];r.update(d,n,1)}function l(u,c,h,d){if(h===0)return;let p=e.get("WEBGL_multi_draw");if(p===null)for(let m=0;m<u.length;m++)o(u[m],c[m],d[m]);else{p.multiDrawArraysInstancedWEBGL(n,u,0,c,0,d,0,h);let m=0;for(let y=0;y<h;y++)m+=c[y]*d[y];r.update(m,n,1)}}this.setMode=i,this.render=a,this.renderInstances=o,this.renderMultiDraw=s,this.renderMultiDrawInstances=l}function sue(t,e,r,n){let i;function a(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){let P=e.get("EXT_texture_filter_anisotropic");i=t.getParameter(P.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function o(P){return!(P!==Ha&&n.convert(P)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT))}function s(P){let k=P===$1&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(P!==Fl&&n.convert(P)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE)&&P!==ps&&!k)}function l(P){if(P==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";P="mediump"}return P==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let u=r.precision!==void 0?r.precision:"highp",c=l(u);c!==u&&(console.warn("THREE.WebGLRenderer:",u,"not supported, using",c,"instead."),u=c);let h=r.logarithmicDepthBuffer===!0,d=r.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),p=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),m=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),y=t.getParameter(t.MAX_TEXTURE_SIZE),v=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),_=t.getParameter(t.MAX_VERTEX_ATTRIBS),w=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),b=t.getParameter(t.MAX_VARYING_VECTORS),A=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),E=m>0,M=t.getParameter(t.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:a,getMaxPrecision:l,textureFormatReadable:o,textureTypeReadable:s,precision:u,logarithmicDepthBuffer:h,reverseDepthBuffer:d,maxTextures:p,maxVertexTextures:m,maxTextureSize:y,maxCubemapSize:v,maxAttributes:_,maxVertexUniforms:w,maxVaryings:b,maxFragmentUniforms:A,vertexTextures:E,maxSamples:M}}function lue(t){let e=this,r=null,n=0,i=!1,a=!1,o=new jh,s=new Br,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d){let p=h.length!==0||d||n!==0||i;return i=d,n=h.length,p},this.beginShadows=function(){a=!0,c(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(h,d){r=c(h,d,0)},this.setState=function(h,d,p){let m=h.clippingPlanes,y=h.clipIntersection,v=h.clipShadows,_=t.get(h);if(!i||m===null||m.length===0||a&&!v)a?c(null):u();else{let w=a?0:n,b=w*4,A=_.clippingState||null;l.value=A,A=c(m,d,b,p);for(let E=0;E!==b;++E)A[E]=r[E];_.clippingState=A,this.numIntersection=y?this.numPlanes:0,this.numPlanes+=w}};function u(){l.value!==r&&(l.value=r,l.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function c(h,d,p,m){let y=h!==null?h.length:0,v=null;if(y!==0){if(v=l.value,m!==!0||v===null){let _=p+y*4,w=d.matrixWorldInverse;s.getNormalMatrix(w),(v===null||v.length<_)&&(v=new Float32Array(_));for(let b=0,A=p;b!==y;++b,A+=4)o.copy(h[b]).applyMatrix4(w,s),o.normal.toArray(v,A),v[A+3]=o.constant}l.value=v,l.needsUpdate=!0}return e.numPlanes=y,e.numIntersection=0,v}}function uue(t){let e=new WeakMap;function r(o,s){return s===e4?o.mapping=gg:s===qI&&(o.mapping=yg),o}function n(o){if(o&&o.isTexture){let s=o.mapping;if(s===e4||s===qI)if(e.has(o)){let l=e.get(o).texture;return r(l,o.mapping)}else{let l=o.image;if(l&&l.height>0){let u=new eae(l.height);return u.fromEquirectangularTexture(t,o),e.set(o,u),o.addEventListener("dispose",i),r(u.texture,o.mapping)}else return null}}return o}function i(o){let s=o.target;s.removeEventListener("dispose",i);let l=e.get(s);l!==void 0&&(e.delete(s),l.dispose())}function a(){e=new WeakMap}return{get:n,dispose:a}}var Fm=4,P7=[.125,.215,.35,.446,.526,.582],ap=20,cE=new PN,D7=new jt,hE=null,dE=0,pE=0,fE=!1,Vd=(1+Math.sqrt(5))/2,Sf=1/Vd,k7=[new Q(-Vd,Sf,0),new Q(Vd,Sf,0),new Q(-Sf,0,Vd),new Q(Sf,0,Vd),new Q(0,Vd,-Sf),new Q(0,Vd,Sf),new Q(-1,1,-1),new Q(1,1,-1),new Q(-1,1,1),new Q(1,1,1)],O7=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,r=0,n=.1,i=100){hE=this._renderer.getRenderTarget(),dE=this._renderer.getActiveCubeFace(),pE=this._renderer.getActiveMipmapLevel(),fE=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);let a=this._allocateTargets();return a.depthBuffer=!0,this._sceneToCubeUV(e,n,i,a),r>0&&this._blur(a,0,0,r),this._applyPMREM(a),this._cleanup(a),a}fromEquirectangular(e,r=null){return this._fromTexture(e,r)}fromCubemap(e,r=null){return this._fromTexture(e,r)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=F7(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=z7(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(hE,dE,pE),this._renderer.xr.enabled=fE,e.scissorTest=!1,xx(e,0,0,e.width,e.height)}_fromTexture(e,r){e.mapping===gg||e.mapping===yg?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),hE=this._renderer.getRenderTarget(),dE=this._renderer.getActiveCubeFace(),pE=this._renderer.getActiveMipmapLevel(),fE=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;let n=r||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),r=4*this._cubeSize,n={magFilter:vu,minFilter:vu,generateMipmaps:!1,type:$1,format:Ha,colorSpace:Op,depthBuffer:!1},i=B7(e,r,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==r){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=B7(e,r,n);let{_lodMax:a}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=cue(a)),this._blurMaterial=hue(a,e,r)}return i}_compileMaterial(e){let r=new Er(this._lodPlanes[0],e);this._renderer.compile(r,cE)}_sceneToCubeUV(e,r,n,i){let a=new co(90,1,r,n),o=[1,-1,1,1,1,1],s=[1,1,1,-1,-1,-1],l=this._renderer,u=l.autoClear,c=l.toneMapping;l.getClearColor(D7),l.toneMapping=ed,l.autoClear=!1;let h=new Go({name:"PMREM.Background",side:xa,depthWrite:!1,depthTest:!1}),d=new Er(new od,h),p=!1,m=e.background;m?m.isColor&&(h.color.copy(m),e.background=null,p=!0):(h.color.copy(D7),p=!0);for(let y=0;y<6;y++){let v=y%3;v===0?(a.up.set(0,o[y],0),a.lookAt(s[y],0,0)):v===1?(a.up.set(0,0,o[y]),a.lookAt(0,s[y],0)):(a.up.set(0,o[y],0),a.lookAt(0,0,s[y]));let _=this._cubeSize;xx(i,v*_,y>2?_:0,_,_),l.setRenderTarget(i),p&&l.render(d,a),l.render(e,a)}d.geometry.dispose(),d.material.dispose(),l.toneMapping=c,l.autoClear=u,e.background=m}_textureToCubeUV(e,r){let n=this._renderer,i=e.mapping===gg||e.mapping===yg;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=F7()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=z7());let a=i?this._cubemapMaterial:this._equirectMaterial,o=new Er(this._lodPlanes[0],a),s=a.uniforms;s.envMap.value=e;let l=this._cubeSize;xx(r,0,0,3*l,2*l),n.setRenderTarget(r),n.render(o,cE)}_applyPMREM(e){let r=this._renderer,n=r.autoClear;r.autoClear=!1;let i=this._lodPlanes.length;for(let a=1;a<i;a++){let o=Math.sqrt(this._sigmas[a]*this._sigmas[a]-this._sigmas[a-1]*this._sigmas[a-1]),s=k7[(i-a-1)%k7.length];this._blur(e,a-1,a,o,s)}r.autoClear=n}_blur(e,r,n,i,a){let o=this._pingPongRenderTarget;this._halfBlur(e,o,r,n,i,"latitudinal",a),this._halfBlur(o,e,n,n,i,"longitudinal",a)}_halfBlur(e,r,n,i,a,o,s){let l=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let c=3,h=new Er(this._lodPlanes[i],u),d=u.uniforms,p=this._sizeLods[n]-1,m=isFinite(a)?Math.PI/(2*p):2*Math.PI/(2*ap-1),y=a/m,v=isFinite(a)?1+Math.floor(c*y):ap;v>ap&&console.warn("sigmaRadians, ".concat(a,", is too large and will clip, as it requested ").concat(v," samples when the maximum is set to ").concat(ap));let _=[],w=0;for(let P=0;P<ap;++P){let k=P/y,D=Math.exp(-k*k/2);_.push(D),P===0?w+=D:P<v&&(w+=2*D)}for(let P=0;P<_.length;P++)_[P]=_[P]/w;d.envMap.value=e.texture,d.samples.value=v,d.weights.value=_,d.latitudinal.value=o==="latitudinal",s&&(d.poleAxis.value=s);let{_lodMax:b}=this;d.dTheta.value=m,d.mipInt.value=b-n;let A=this._sizeLods[i],E=3*A*(i>b-Fm?i-b+Fm:0),M=4*(this._cubeSize-A);xx(r,E,M,3*A,2*A),l.setRenderTarget(r),l.render(h,cE)}};function cue(t){let e=[],r=[],n=[],i=t,a=t-Fm+1+P7.length;for(let o=0;o<a;o++){let s=Math.pow(2,i);r.push(s);let l=1/s;o>t-Fm?l=P7[o-t+Fm-1]:o===0&&(l=0),n.push(l);let u=1/(s-2),c=-u,h=1+u,d=[c,c,h,c,h,h,c,c,h,h,c,h],p=6,m=6,y=3,v=2,_=1,w=new Float32Array(y*m*p),b=new Float32Array(v*m*p),A=new Float32Array(_*m*p);for(let M=0;M<p;M++){let P=M%3*2/3-1,k=M>2?0:-1,D=[P,k,0,P+2/3,k,0,P+2/3,k+1,0,P,k,0,P+2/3,k+1,0,P,k+1,0];w.set(D,y*m*M),b.set(d,v*m*M);let O=[M,M,M,M,M,M];A.set(O,_*m*M)}let E=new Ja;E.setAttribute("position",new Xn(w,y)),E.setAttribute("uv",new Xn(b,v)),E.setAttribute("faceIndex",new Xn(A,_)),e.push(E),i>Fm&&i--}return{lodPlanes:e,sizeLods:r,sigmas:n}}function B7(t,e,r){let n=new ad(t,e,r);return n.texture.mapping=wA,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function xx(t,e,r,n,i){t.viewport.set(e,r,n,i),t.scissor.set(e,r,n,i)}function hue(t,e,r){let n=new Float32Array(ap),i=new Q(0,1,0);return new ys({name:"SphericalGaussianBlur",defines:{n:ap,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/r,CUBEUV_MAX_MIP:"".concat(t,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:TP(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Qh,depthTest:!1,depthWrite:!1})}function z7(){return new ys({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:TP(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Qh,depthTest:!1,depthWrite:!1})}function F7(){return new ys({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:TP(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Qh,depthTest:!1,depthWrite:!1})}function TP(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function due(t){let e=new WeakMap,r=null;function n(s){if(s&&s.isTexture){let l=s.mapping,u=l===e4||l===qI,c=l===gg||l===yg;if(u||c){let h=e.get(s),d=h!==void 0?h.texture.pmremVersion:0;if(s.isRenderTargetTexture&&s.pmremVersion!==d)return r===null&&(r=new O7(t)),h=u?r.fromEquirectangular(s,h):r.fromCubemap(s,h),h.texture.pmremVersion=s.pmremVersion,e.set(s,h),h.texture;if(h!==void 0)return h.texture;{let p=s.image;return u&&p&&p.height>0||c&&p&&i(p)?(r===null&&(r=new O7(t)),h=u?r.fromEquirectangular(s):r.fromCubemap(s),h.texture.pmremVersion=s.pmremVersion,e.set(s,h),s.addEventListener("dispose",a),h.texture):null}}}return s}function i(s){let l=0,u=6;for(let c=0;c<u;c++)s[c]!==void 0&&l++;return l===u}function a(s){let l=s.target;l.removeEventListener("dispose",a);let u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function o(){e=new WeakMap,r!==null&&(r.dispose(),r=null)}return{get:n,dispose:o}}function pue(t){let e={};function r(n){if(e[n]!==void 0)return e[n];let i;switch(n){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=t.getExtension(n)}return e[n]=i,i}return{has:function(n){return r(n)!==null},init:function(){r("EXT_color_buffer_float"),r("WEBGL_clip_cull_distance"),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float"),r("WEBGL_multisampled_render_to_texture"),r("WEBGL_render_shared_exponent")},get:function(n){let i=r(n);return i===null&&Bf("THREE.WebGLRenderer: "+n+" extension not supported."),i}}}function fue(t,e,r,n){let i={},a=new WeakMap;function o(h){let d=h.target;d.index!==null&&e.remove(d.index);for(let m in d.attributes)e.remove(d.attributes[m]);d.removeEventListener("dispose",o),delete i[d.id];let p=a.get(d);p&&(e.remove(p),a.delete(d)),n.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,r.memory.geometries--}function s(h,d){return i[d.id]===!0||(d.addEventListener("dispose",o),i[d.id]=!0,r.memory.geometries++),d}function l(h){let d=h.attributes;for(let p in d)e.update(d[p],t.ARRAY_BUFFER)}function u(h){let d=[],p=h.index,m=h.attributes.position,y=0;if(p!==null){let w=p.array;y=p.version;for(let b=0,A=w.length;b<A;b+=3){let E=w[b+0],M=w[b+1],P=w[b+2];d.push(E,M,M,P,P,E)}}else if(m!==void 0){let w=m.array;y=m.version;for(let b=0,A=w.length/3-1;b<A;b+=3){let E=b+0,M=b+1,P=b+2;d.push(E,M,M,P,P,E)}}else return;let v=new(Y9(d)?iN:nN)(d,1);v.version=y;let _=a.get(h);_&&e.remove(_),a.set(h,v)}function c(h){let d=a.get(h);if(d){let p=h.index;p!==null&&d.version<p.version&&u(h)}else u(h);return a.get(h)}return{get:s,update:l,getWireframeAttribute:c}}function mue(t,e,r){let n;function i(d){n=d}let a,o;function s(d){a=d.type,o=d.bytesPerElement}function l(d,p){t.drawElements(n,p,a,d*o),r.update(p,n,1)}function u(d,p,m){m!==0&&(t.drawElementsInstanced(n,p,a,d*o,m),r.update(p,n,m))}function c(d,p,m){if(m===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,p,0,a,d,0,m);let y=0;for(let v=0;v<m;v++)y+=p[v];r.update(y,n,1)}function h(d,p,m,y){if(m===0)return;let v=e.get("WEBGL_multi_draw");if(v===null)for(let _=0;_<d.length;_++)u(d[_]/o,p[_],y[_]);else{v.multiDrawElementsInstancedWEBGL(n,p,0,a,d,0,y,0,m);let _=0;for(let w=0;w<m;w++)_+=p[w]*y[w];r.update(_,n,1)}}this.setMode=i,this.setIndex=s,this.render=l,this.renderInstances=u,this.renderMultiDraw=c,this.renderMultiDrawInstances=h}function gue(t){let e={geometries:0,textures:0},r={frame:0,calls:0,triangles:0,points:0,lines:0};function n(a,o,s){switch(r.calls++,o){case t.TRIANGLES:r.triangles+=s*(a/3);break;case t.LINES:r.lines+=s*(a/2);break;case t.LINE_STRIP:r.lines+=s*(a-1);break;case t.LINE_LOOP:r.lines+=s*a;break;case t.POINTS:r.points+=s*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function i(){r.calls=0,r.triangles=0,r.points=0,r.lines=0}return{memory:e,render:r,programs:null,autoReset:!0,reset:i,update:n}}function yue(t,e,r){let n=new WeakMap,i=new _n;function a(o,s,l){let u=o.morphTargetInfluences,c=s.morphAttributes.position||s.morphAttributes.normal||s.morphAttributes.color,h=c!==void 0?c.length:0,d=n.get(s);if(d===void 0||d.count!==h){let p=function(){k.dispose(),n.delete(s),s.removeEventListener("dispose",p)};d!==void 0&&d.texture.dispose();let m=s.morphAttributes.position!==void 0,y=s.morphAttributes.normal!==void 0,v=s.morphAttributes.color!==void 0,_=s.morphAttributes.position||[],w=s.morphAttributes.normal||[],b=s.morphAttributes.color||[],A=0;m===!0&&(A=1),y===!0&&(A=2),v===!0&&(A=3);let E=s.attributes.position.count*A,M=1;E>e.maxTextureSize&&(M=Math.ceil(E/e.maxTextureSize),E=e.maxTextureSize);let P=new Float32Array(E*M*4*h),k=new Q9(P,E,M,h);k.type=ps,k.needsUpdate=!0;let D=A*4;for(let O=0;O<h;O++){let B=_[O],L=w[O],R=b[O],T=E*M*4*O;for(let N=0;N<B.count;N++){let $=N*D;m===!0&&(i.fromBufferAttribute(B,N),P[T+$+0]=i.x,P[T+$+1]=i.y,P[T+$+2]=i.z,P[T+$+3]=0),y===!0&&(i.fromBufferAttribute(L,N),P[T+$+4]=i.x,P[T+$+5]=i.y,P[T+$+6]=i.z,P[T+$+7]=0),v===!0&&(i.fromBufferAttribute(R,N),P[T+$+8]=i.x,P[T+$+9]=i.y,P[T+$+10]=i.z,P[T+$+11]=R.itemSize===4?i.w:1)}}d={count:h,texture:k,size:new Je(E,M)},n.set(s,d),s.addEventListener("dispose",p)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)l.getUniforms().setValue(t,"morphTexture",o.morphTexture,r);else{let p=0;for(let y=0;y<u.length;y++)p+=u[y];let m=s.morphTargetsRelative?1:1-p;l.getUniforms().setValue(t,"morphTargetBaseInfluence",m),l.getUniforms().setValue(t,"morphTargetInfluences",u)}l.getUniforms().setValue(t,"morphTargetsTexture",d.texture,r),l.getUniforms().setValue(t,"morphTargetsTextureSize",d.size)}return{update:a}}function vue(t,e,r,n){let i=new WeakMap;function a(l){let u=n.render.frame,c=l.geometry,h=e.get(l,c);if(i.get(h)!==u&&(e.update(h),i.set(h,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",s)===!1&&l.addEventListener("dispose",s),i.get(l)!==u&&(r.update(l.instanceMatrix,t.ARRAY_BUFFER),l.instanceColor!==null&&r.update(l.instanceColor,t.ARRAY_BUFFER),i.set(l,u))),l.isSkinnedMesh){let d=l.skeleton;i.get(d)!==u&&(d.update(),i.set(d,u))}return h}function o(){i=new WeakMap}function s(l){let u=l.target;u.removeEventListener("dispose",s),r.remove(u.instanceMatrix),u.instanceColor!==null&&r.remove(u.instanceColor)}return{update:a,dispose:o}}var BN=new Ho,R7=new pN(1,1),zN=new Q9,FN=new Rie,RN=new lN,L7=[],N7=[],$7=new Float32Array(16),U7=new Float32Array(9),j7=new Float32Array(4);function f0(t,e,r){let n=t[0];if(n<=0||n>0)return t;let i=e*r,a=L7[i];if(a===void 0&&(a=new Float32Array(i),L7[i]=a),e!==0){n.toArray(a,0);for(let o=1,s=0;o!==e;++o)s+=r,t[o].toArray(a,s)}return a}function oa(t,e){if(t.length!==e.length)return!1;for(let r=0,n=t.length;r<n;r++)if(t[r]!==e[r])return!1;return!0}function sa(t,e){for(let r=0,n=e.length;r<n;r++)t[r]=e[r]}function TA(t,e){let r=N7[e];r===void 0&&(r=new Int32Array(e),N7[e]=r);for(let n=0;n!==e;++n)r[n]=t.allocateTextureUnit();return r}function _ue(t,e){let r=this.cache;r[0]!==e&&(t.uniform1f(this.addr,e),r[0]=e)}function xue(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),r[0]=e.x,r[1]=e.y);else{if(oa(r,e))return;t.uniform2fv(this.addr,e),sa(r,e)}}function bue(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y||r[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),r[0]=e.x,r[1]=e.y,r[2]=e.z);else if(e.r!==void 0)(r[0]!==e.r||r[1]!==e.g||r[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),r[0]=e.r,r[1]=e.g,r[2]=e.b);else{if(oa(r,e))return;t.uniform3fv(this.addr,e),sa(r,e)}}function wue(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y||r[2]!==e.z||r[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),r[0]=e.x,r[1]=e.y,r[2]=e.z,r[3]=e.w);else{if(oa(r,e))return;t.uniform4fv(this.addr,e),sa(r,e)}}function Aue(t,e){let r=this.cache,n=e.elements;if(n===void 0){if(oa(r,e))return;t.uniformMatrix2fv(this.addr,!1,e),sa(r,e)}else{if(oa(r,n))return;j7.set(n),t.uniformMatrix2fv(this.addr,!1,j7),sa(r,n)}}function Sue(t,e){let r=this.cache,n=e.elements;if(n===void 0){if(oa(r,e))return;t.uniformMatrix3fv(this.addr,!1,e),sa(r,e)}else{if(oa(r,n))return;U7.set(n),t.uniformMatrix3fv(this.addr,!1,U7),sa(r,n)}}function Eue(t,e){let r=this.cache,n=e.elements;if(n===void 0){if(oa(r,e))return;t.uniformMatrix4fv(this.addr,!1,e),sa(r,e)}else{if(oa(r,n))return;$7.set(n),t.uniformMatrix4fv(this.addr,!1,$7),sa(r,n)}}function Iue(t,e){let r=this.cache;r[0]!==e&&(t.uniform1i(this.addr,e),r[0]=e)}function Cue(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),r[0]=e.x,r[1]=e.y);else{if(oa(r,e))return;t.uniform2iv(this.addr,e),sa(r,e)}}function Mue(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y||r[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),r[0]=e.x,r[1]=e.y,r[2]=e.z);else{if(oa(r,e))return;t.uniform3iv(this.addr,e),sa(r,e)}}function Tue(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y||r[2]!==e.z||r[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),r[0]=e.x,r[1]=e.y,r[2]=e.z,r[3]=e.w);else{if(oa(r,e))return;t.uniform4iv(this.addr,e),sa(r,e)}}function Pue(t,e){let r=this.cache;r[0]!==e&&(t.uniform1ui(this.addr,e),r[0]=e)}function Due(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),r[0]=e.x,r[1]=e.y);else{if(oa(r,e))return;t.uniform2uiv(this.addr,e),sa(r,e)}}function kue(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y||r[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),r[0]=e.x,r[1]=e.y,r[2]=e.z);else{if(oa(r,e))return;t.uniform3uiv(this.addr,e),sa(r,e)}}function Oue(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y||r[2]!==e.z||r[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),r[0]=e.x,r[1]=e.y,r[2]=e.z,r[3]=e.w);else{if(oa(r,e))return;t.uniform4uiv(this.addr,e),sa(r,e)}}function Bue(t,e,r){let n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i);let a;this.type===t.SAMPLER_2D_SHADOW?(R7.compareFunction=H9,a=R7):a=BN,r.setTexture2D(e||a,i)}function zue(t,e,r){let n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i),r.setTexture3D(e||FN,i)}function Fue(t,e,r){let n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i),r.setTextureCube(e||RN,i)}function Rue(t,e,r){let n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i),r.setTexture2DArray(e||zN,i)}function Lue(t){switch(t){case 5126:return _ue;case 35664:return xue;case 35665:return bue;case 35666:return wue;case 35674:return Aue;case 35675:return Sue;case 35676:return Eue;case 5124:case 35670:return Iue;case 35667:case 35671:return Cue;case 35668:case 35672:return Mue;case 35669:case 35673:return Tue;case 5125:return Pue;case 36294:return Due;case 36295:return kue;case 36296:return Oue;case 35678:case 36198:case 36298:case 36306:case 35682:return Bue;case 35679:case 36299:case 36307:return zue;case 35680:case 36300:case 36308:case 36293:return Fue;case 36289:case 36303:case 36311:case 36292:return Rue}}function Nue(t,e){t.uniform1fv(this.addr,e)}function $ue(t,e){let r=f0(e,this.size,2);t.uniform2fv(this.addr,r)}function Uue(t,e){let r=f0(e,this.size,3);t.uniform3fv(this.addr,r)}function jue(t,e){let r=f0(e,this.size,4);t.uniform4fv(this.addr,r)}function Vue(t,e){let r=f0(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,r)}function Gue(t,e){let r=f0(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,r)}function Zue(t,e){let r=f0(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,r)}function Wue(t,e){t.uniform1iv(this.addr,e)}function Hue(t,e){t.uniform2iv(this.addr,e)}function Xue(t,e){t.uniform3iv(this.addr,e)}function que(t,e){t.uniform4iv(this.addr,e)}function Yue(t,e){t.uniform1uiv(this.addr,e)}function Jue(t,e){t.uniform2uiv(this.addr,e)}function Kue(t,e){t.uniform3uiv(this.addr,e)}function Que(t,e){t.uniform4uiv(this.addr,e)}function ece(t,e,r){let n=this.cache,i=e.length,a=TA(r,i);oa(n,a)||(t.uniform1iv(this.addr,a),sa(n,a));for(let o=0;o!==i;++o)r.setTexture2D(e[o]||BN,a[o])}function tce(t,e,r){let n=this.cache,i=e.length,a=TA(r,i);oa(n,a)||(t.uniform1iv(this.addr,a),sa(n,a));for(let o=0;o!==i;++o)r.setTexture3D(e[o]||FN,a[o])}function rce(t,e,r){let n=this.cache,i=e.length,a=TA(r,i);oa(n,a)||(t.uniform1iv(this.addr,a),sa(n,a));for(let o=0;o!==i;++o)r.setTextureCube(e[o]||RN,a[o])}function nce(t,e,r){let n=this.cache,i=e.length,a=TA(r,i);oa(n,a)||(t.uniform1iv(this.addr,a),sa(n,a));for(let o=0;o!==i;++o)r.setTexture2DArray(e[o]||zN,a[o])}function ice(t){switch(t){case 5126:return Nue;case 35664:return $ue;case 35665:return Uue;case 35666:return jue;case 35674:return Vue;case 35675:return Gue;case 35676:return Zue;case 5124:case 35670:return Wue;case 35667:case 35671:return Hue;case 35668:case 35672:return Xue;case 35669:case 35673:return que;case 5125:return Yue;case 36294:return Jue;case 36295:return Kue;case 36296:return Que;case 35678:case 36198:case 36298:case 36306:case 35682:return ece;case 35679:case 36299:case 36307:return tce;case 35680:case 36300:case 36308:case 36293:return rce;case 36289:case 36303:case 36311:case 36292:return nce}}var ace=class{constructor(e,r,n){this.id=e,this.addr=n,this.cache=[],this.type=r.type,this.setValue=Lue(r.type)}},oce=class{constructor(e,r,n){this.id=e,this.addr=n,this.cache=[],this.type=r.type,this.size=r.size,this.setValue=ice(r.type)}},sce=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,r,n){let i=this.seq;for(let a=0,o=i.length;a!==o;++a){let s=i[a];s.setValue(e,r[s.id],n)}}},mE=/(\w+)(\])?(\[|\.)?/g;function V7(t,e){t.seq.push(e),t.map[e.id]=e}function lce(t,e,r){let n=t.name,i=n.length;for(mE.lastIndex=0;;){let a=mE.exec(n),o=mE.lastIndex,s=a[1],l=a[2]==="]",u=a[3];if(l&&(s=s|0),u===void 0||u==="["&&o+2===i){V7(r,u===void 0?new ace(s,t,e):new oce(s,t,e));break}else{let c=r.map[s];c===void 0&&(c=new sce(s),V7(r,c)),r=c}}}var $b=class{constructor(e,r){this.seq=[],this.map={};let n=e.getProgramParameter(r,e.ACTIVE_UNIFORMS);for(let i=0;i<n;++i){let a=e.getActiveUniform(r,i),o=e.getUniformLocation(r,a.name);lce(a,o,this)}}setValue(e,r,n,i){let a=this.map[r];a!==void 0&&a.setValue(e,n,i)}setOptional(e,r,n){let i=r[n];i!==void 0&&this.setValue(e,n,i)}static upload(e,r,n,i){for(let a=0,o=r.length;a!==o;++a){let s=r[a],l=n[s.id];l.needsUpdate!==!1&&s.setValue(e,l.value,i)}}static seqWithValue(e,r){let n=[];for(let i=0,a=e.length;i!==a;++i){let o=e[i];o.id in r&&n.push(o)}return n}};function G7(t,e,r){let n=t.createShader(e);return t.shaderSource(n,r),t.compileShader(n),n}var uce=37297,cce=0;function hce(t,e){let r=t.split(`
`),n=[],i=Math.max(e-6,0),a=Math.min(e+6,r.length);for(let o=i;o<a;o++){let s=o+1;n.push("".concat(s===e?">":" "," ").concat(s,": ").concat(r[o]))}return n.join(`
`)}var Z7=new Br;function dce(t){an._getMatrix(Z7,an.workingColorSpace,t);let e="mat3( ".concat(Z7.elements.map(r=>r.toFixed(4))," )");switch(an.getTransfer(t)){case r4:return[e,"LinearTransferOETF"];case En:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",t),[e,"LinearTransferOETF"]}}function W7(t,e,r){let n=t.getShaderParameter(e,t.COMPILE_STATUS),i=t.getShaderInfoLog(e).trim();if(n&&i==="")return"";let a=/ERROR: 0:(\d+)/.exec(i);if(a){let o=parseInt(a[1]);return r.toUpperCase()+`

`+i+`

`+hce(t.getShaderSource(e),o)}else return i}function pce(t,e){let r=dce(e);return["vec4 ".concat(t,"( vec4 value ) {"),"	return ".concat(r[1],"( vec4( value.rgb * ").concat(r[0],", value.a ) );"),"}"].join(`
`)}function fce(t,e){let r;switch(e){case Gne:r="Linear";break;case Zne:r="Reinhard";break;case Wne:r="Cineon";break;case Hne:r="ACESFilmic";break;case qne:r="AgX";break;case Yne:r="Neutral";break;case Xne:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),r="Linear"}return"vec3 "+t+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}var bx=new Q;function mce(){an.getLuminanceCoefficients(bx);let t=bx.x.toFixed(4),e=bx.y.toFixed(4),r=bx.z.toFixed(4);return["float luminance( const in vec3 rgb ) {","	const vec3 weights = vec3( ".concat(t,", ").concat(e,", ").concat(r," );"),"	return dot( weights, rgb );","}"].join(`
`)}function gce(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Py).join(`
`)}function yce(t){let e=[];for(let r in t){let n=t[r];n!==!1&&e.push("#define "+r+" "+n)}return e.join(`
`)}function vce(t,e){let r={},n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){let a=t.getActiveAttrib(e,i),o=a.name,s=1;a.type===t.FLOAT_MAT2&&(s=2),a.type===t.FLOAT_MAT3&&(s=3),a.type===t.FLOAT_MAT4&&(s=4),r[o]={type:a.type,location:t.getAttribLocation(e,o),locationSize:s}}return r}function Py(t){return t!==""}function H7(t,e){let r=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,r).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function X7(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var _ce=/^[ \t]*#include +<([\w\d./]+)>/gm;function kC(t){return t.replace(_ce,bce)}var xce=new Map;function bce(t,e){let r=Mr[e];if(r===void 0){let n=xce.get(e);if(n!==void 0)r=Mr[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return kC(r)}var wce=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function q7(t){return t.replace(wce,Ace)}function Ace(t,e,r,n){let i="";for(let a=parseInt(e);a<parseInt(r);a++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function Y7(t){let e="precision ".concat(t.precision,` float;
	precision `).concat(t.precision,` int;
	precision `).concat(t.precision,` sampler2D;
	precision `).concat(t.precision,` samplerCube;
	precision `).concat(t.precision,` sampler3D;
	precision `).concat(t.precision,` sampler2DArray;
	precision `).concat(t.precision,` sampler2DShadow;
	precision `).concat(t.precision,` samplerCubeShadow;
	precision `).concat(t.precision,` sampler2DArrayShadow;
	precision `).concat(t.precision,` isampler2D;
	precision `).concat(t.precision,` isampler3D;
	precision `).concat(t.precision,` isamplerCube;
	precision `).concat(t.precision,` isampler2DArray;
	precision `).concat(t.precision,` usampler2D;
	precision `).concat(t.precision,` usampler3D;
	precision `).concat(t.precision,` usamplerCube;
	precision `).concat(t.precision,` usampler2DArray;
	`);return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Sce(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===z9?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===Ane?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===uc&&(e="SHADOWMAP_TYPE_VSM"),e}function Ece(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case gg:case yg:e="ENVMAP_TYPE_CUBE";break;case wA:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Ice(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case yg:e="ENVMAP_MODE_REFRACTION";break}return e}function Cce(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case cP:e="ENVMAP_BLENDING_MULTIPLY";break;case jne:e="ENVMAP_BLENDING_MIX";break;case Vne:e="ENVMAP_BLENDING_ADD";break}return e}function Mce(t){let e=t.envMapCubeUVHeight;if(e===null)return null;let r=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,r),112)),texelHeight:n,maxMip:r}}function Tce(t,e,r,n){let i=t.getContext(),a=r.defines,o=r.vertexShader,s=r.fragmentShader,l=Sce(r),u=Ece(r),c=Ice(r),h=Cce(r),d=Mce(r),p=gce(r),m=yce(a),y=i.createProgram(),v,_,w=r.glslVersion?"#version "+r.glslVersion+`
`:"";r.isRawShaderMaterial?(v=["#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,m].filter(Py).join(`
`),v.length>0&&(v+=`
`),_=["#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,m].filter(Py).join(`
`),_.length>0&&(_+=`
`)):(v=[Y7(r),"#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,m,r.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",r.batching?"#define USE_BATCHING":"",r.batchingColor?"#define USE_BATCHING_COLOR":"",r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.instancingMorph?"#define USE_INSTANCING_MORPH":"",r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+c:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",r.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",r.displacementMap?"#define USE_DISPLACEMENTMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.anisotropy?"#define USE_ANISOTROPY":"",r.anisotropyMap?"#define USE_ANISOTROPYMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",r.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaHash?"#define USE_ALPHAHASH":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",r.mapUv?"#define MAP_UV "+r.mapUv:"",r.alphaMapUv?"#define ALPHAMAP_UV "+r.alphaMapUv:"",r.lightMapUv?"#define LIGHTMAP_UV "+r.lightMapUv:"",r.aoMapUv?"#define AOMAP_UV "+r.aoMapUv:"",r.emissiveMapUv?"#define EMISSIVEMAP_UV "+r.emissiveMapUv:"",r.bumpMapUv?"#define BUMPMAP_UV "+r.bumpMapUv:"",r.normalMapUv?"#define NORMALMAP_UV "+r.normalMapUv:"",r.displacementMapUv?"#define DISPLACEMENTMAP_UV "+r.displacementMapUv:"",r.metalnessMapUv?"#define METALNESSMAP_UV "+r.metalnessMapUv:"",r.roughnessMapUv?"#define ROUGHNESSMAP_UV "+r.roughnessMapUv:"",r.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+r.anisotropyMapUv:"",r.clearcoatMapUv?"#define CLEARCOATMAP_UV "+r.clearcoatMapUv:"",r.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+r.clearcoatNormalMapUv:"",r.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+r.clearcoatRoughnessMapUv:"",r.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+r.iridescenceMapUv:"",r.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+r.iridescenceThicknessMapUv:"",r.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+r.sheenColorMapUv:"",r.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+r.sheenRoughnessMapUv:"",r.specularMapUv?"#define SPECULARMAP_UV "+r.specularMapUv:"",r.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+r.specularColorMapUv:"",r.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+r.specularIntensityMapUv:"",r.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+r.transmissionMapUv:"",r.thicknessMapUv?"#define THICKNESSMAP_UV "+r.thicknessMapUv:"",r.vertexTangents&&r.flatShading===!1?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUv1s?"#define USE_UV1":"",r.vertexUv2s?"#define USE_UV2":"",r.vertexUv3s?"#define USE_UV3":"",r.pointsUvs?"#define USE_POINTS_UV":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&r.flatShading===!1?"#define USE_MORPHNORMALS":"",r.morphColors?"#define USE_MORPHCOLORS":"",r.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+r.morphTextureStride:"",r.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+r.morphTargetsCount:"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.numLightProbes>0?"#define USE_LIGHT_PROBES":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Py).join(`
`),_=[Y7(r),"#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,m,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+u:"",r.envMap?"#define "+c:"",r.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",r.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.anisotropy?"#define USE_ANISOTROPY":"",r.anisotropyMap?"#define USE_ANISOTROPYMAP":"",r.clearcoat?"#define USE_CLEARCOAT":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.dispersion?"#define USE_DISPERSION":"",r.iridescence?"#define USE_IRIDESCENCE":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",r.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaTest?"#define USE_ALPHATEST":"",r.alphaHash?"#define USE_ALPHAHASH":"",r.sheen?"#define USE_SHEEN":"",r.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.vertexTangents&&r.flatShading===!1?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor||r.batchingColor?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUv1s?"#define USE_UV1":"",r.vertexUv2s?"#define USE_UV2":"",r.vertexUv3s?"#define USE_UV3":"",r.pointsUvs?"#define USE_POINTS_UV":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.numLightProbes>0?"#define USE_LIGHT_PROBES":"",r.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",r.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.toneMapping!==ed?"#define TONE_MAPPING":"",r.toneMapping!==ed?Mr.tonemapping_pars_fragment:"",r.toneMapping!==ed?fce("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.opaque?"#define OPAQUE":"",Mr.colorspace_pars_fragment,pce("linearToOutputTexel",r.outputColorSpace),mce(),r.useDepthPacking?"#define DEPTH_PACKING "+r.depthPacking:"",`
`].filter(Py).join(`
`)),o=kC(o),o=H7(o,r),o=X7(o,r),s=kC(s),s=H7(s,r),s=X7(s,r),o=q7(o),s=q7(s),r.isRawShaderMaterial!==!0&&(w=`#version 300 es
`,v=[p,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+v,_=["#define varying in",r.glslVersion===EC?"":"layout(location = 0) out highp vec4 pc_fragColor;",r.glslVersion===EC?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+_);let b=w+v+o,A=w+_+s,E=G7(i,i.VERTEX_SHADER,b),M=G7(i,i.FRAGMENT_SHADER,A);i.attachShader(y,E),i.attachShader(y,M),r.index0AttributeName!==void 0?i.bindAttribLocation(y,0,r.index0AttributeName):r.morphTargets===!0&&i.bindAttribLocation(y,0,"position"),i.linkProgram(y);function P(B){if(t.debug.checkShaderErrors){let L=i.getProgramInfoLog(y).trim(),R=i.getShaderInfoLog(E).trim(),T=i.getShaderInfoLog(M).trim(),N=!0,$=!0;if(i.getProgramParameter(y,i.LINK_STATUS)===!1)if(N=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(i,y,E,M);else{let V=W7(i,E,"vertex"),G=W7(i,M,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(y,i.VALIDATE_STATUS)+`

Material Name: `+B.name+`
Material Type: `+B.type+`

Program Info Log: `+L+`
`+V+`
`+G)}else L!==""?console.warn("THREE.WebGLProgram: Program Info Log:",L):(R===""||T==="")&&($=!1);$&&(B.diagnostics={runnable:N,programLog:L,vertexShader:{log:R,prefix:v},fragmentShader:{log:T,prefix:_}})}i.deleteShader(E),i.deleteShader(M),k=new $b(i,y),D=vce(i,y)}let k;this.getUniforms=function(){return k===void 0&&P(this),k};let D;this.getAttributes=function(){return D===void 0&&P(this),D};let O=r.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return O===!1&&(O=i.getProgramParameter(y,uce)),O},this.destroy=function(){n.releaseStatesOfProgram(this),i.deleteProgram(y),this.program=void 0},this.type=r.shaderType,this.name=r.shaderName,this.id=cce++,this.cacheKey=e,this.usedTimes=1,this.program=y,this.vertexShader=E,this.fragmentShader=M,this}var Pce=0,Dce=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let r=e.vertexShader,n=e.fragmentShader,i=this._getShaderStage(r),a=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(i)===!1&&(o.add(i),i.usedTimes++),o.has(a)===!1&&(o.add(a),a.usedTimes++),this}remove(e){let r=this.materialCache.get(e);for(let n of r)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let r=this.materialCache,n=r.get(e);return n===void 0&&(n=new Set,r.set(e,n)),n}_getShaderStage(e){let r=this.shaderCache,n=r.get(e);return n===void 0&&(n=new kce(e),r.set(e,n)),n}},kce=class{constructor(e){this.id=Pce++,this.code=e,this.usedTimes=0}};function Oce(t,e,r,n,i,a,o){let s=new _P,l=new Dce,u=new Set,c=[],h=i.logarithmicDepthBuffer,d=i.vertexTextures,p=i.precision,m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function y(D){return u.add(D),D===0?"uv":"uv".concat(D)}function v(D,O,B,L,R){let T=L.fog,N=R.geometry,$=D.isMeshStandardMaterial?L.environment:null,V=(D.isMeshStandardMaterial?r:e).get(D.envMap||$),G=V&&V.mapping===wA?V.image.height:null,ee=m[D.type];D.precision!==null&&(p=i.getMaxPrecision(D.precision),p!==D.precision&&console.warn("THREE.WebGLProgram.getParameters:",D.precision,"not supported, using",p,"instead."));let ie=N.morphAttributes.position||N.morphAttributes.normal||N.morphAttributes.color,me=ie!==void 0?ie.length:0,Me=0;N.morphAttributes.position!==void 0&&(Me=1),N.morphAttributes.normal!==void 0&&(Me=2),N.morphAttributes.color!==void 0&&(Me=3);let Ae,le,_e,Le;if(ee){let Zr=hu[ee];Ae=Zr.vertexShader,le=Zr.fragmentShader}else Ae=D.vertexShader,le=D.fragmentShader,l.update(D),_e=l.getVertexShaderID(D),Le=l.getFragmentShaderID(D);let Se=t.getRenderTarget(),Ue=t.state.buffers.depth.getReversed(),Y=R.isInstancedMesh===!0,we=R.isBatchedMesh===!0,q=!!D.map,oe=!!D.matcap,ce=!!V,X=!!D.aoMap,ke=!!D.lightMap,Ce=!!D.bumpMap,Ee=!!D.normalMap,Ne=!!D.displacementMap,st=!!D.emissiveMap,Ke=!!D.metalnessMap,J=!!D.roughnessMap,Z=D.anisotropy>0,fe=D.clearcoat>0,Fe=D.dispersion>0,Ve=D.iridescence>0,ze=D.sheen>0,Tt=D.transmission>0,ft=Z&&!!D.anisotropyMap,St=fe&&!!D.clearcoatMap,nr=fe&&!!D.clearcoatNormalMap,He=fe&&!!D.clearcoatRoughnessMap,Ge=Ve&&!!D.iridescenceMap,je=Ve&&!!D.iridescenceThicknessMap,tt=ze&&!!D.sheenColorMap,Ze=ze&&!!D.sheenRoughnessMap,At=!!D.specularMap,vt=!!D.specularColorMap,Kt=!!D.specularIntensityMap,he=Tt&&!!D.transmissionMap,ct=Tt&&!!D.thicknessMap,De=!!D.gradientMap,qe=!!D.alphaMap,mt=D.alphaTest>0,Et=!!D.alphaHash,Wt=!!D.extensions,en=ed;D.toneMapped&&(Se===null||Se.isXRRenderTarget===!0)&&(en=t.toneMapping);let Ii={shaderID:ee,shaderType:D.type,shaderName:D.name,vertexShader:Ae,fragmentShader:le,defines:D.defines,customVertexShaderID:_e,customFragmentShaderID:Le,isRawShaderMaterial:D.isRawShaderMaterial===!0,glslVersion:D.glslVersion,precision:p,batching:we,batchingColor:we&&R._colorsTexture!==null,instancing:Y,instancingColor:Y&&R.instanceColor!==null,instancingMorph:Y&&R.morphTexture!==null,supportsVertexTextures:d,outputColorSpace:Se===null?t.outputColorSpace:Se.isXRRenderTarget===!0?Se.texture.colorSpace:Op,alphaToCoverage:!!D.alphaToCoverage,map:q,matcap:oe,envMap:ce,envMapMode:ce&&V.mapping,envMapCubeUVHeight:G,aoMap:X,lightMap:ke,bumpMap:Ce,normalMap:Ee,displacementMap:d&&Ne,emissiveMap:st,normalMapObjectSpace:Ee&&D.normalMapType===iie,normalMapTangentSpace:Ee&&D.normalMapType===yP,metalnessMap:Ke,roughnessMap:J,anisotropy:Z,anisotropyMap:ft,clearcoat:fe,clearcoatMap:St,clearcoatNormalMap:nr,clearcoatRoughnessMap:He,dispersion:Fe,iridescence:Ve,iridescenceMap:Ge,iridescenceThicknessMap:je,sheen:ze,sheenColorMap:tt,sheenRoughnessMap:Ze,specularMap:At,specularColorMap:vt,specularIntensityMap:Kt,transmission:Tt,transmissionMap:he,thicknessMap:ct,gradientMap:De,opaque:D.transparent===!1&&D.blending===qm&&D.alphaToCoverage===!1,alphaMap:qe,alphaTest:mt,alphaHash:Et,combine:D.combine,mapUv:q&&y(D.map.channel),aoMapUv:X&&y(D.aoMap.channel),lightMapUv:ke&&y(D.lightMap.channel),bumpMapUv:Ce&&y(D.bumpMap.channel),normalMapUv:Ee&&y(D.normalMap.channel),displacementMapUv:Ne&&y(D.displacementMap.channel),emissiveMapUv:st&&y(D.emissiveMap.channel),metalnessMapUv:Ke&&y(D.metalnessMap.channel),roughnessMapUv:J&&y(D.roughnessMap.channel),anisotropyMapUv:ft&&y(D.anisotropyMap.channel),clearcoatMapUv:St&&y(D.clearcoatMap.channel),clearcoatNormalMapUv:nr&&y(D.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:He&&y(D.clearcoatRoughnessMap.channel),iridescenceMapUv:Ge&&y(D.iridescenceMap.channel),iridescenceThicknessMapUv:je&&y(D.iridescenceThicknessMap.channel),sheenColorMapUv:tt&&y(D.sheenColorMap.channel),sheenRoughnessMapUv:Ze&&y(D.sheenRoughnessMap.channel),specularMapUv:At&&y(D.specularMap.channel),specularColorMapUv:vt&&y(D.specularColorMap.channel),specularIntensityMapUv:Kt&&y(D.specularIntensityMap.channel),transmissionMapUv:he&&y(D.transmissionMap.channel),thicknessMapUv:ct&&y(D.thicknessMap.channel),alphaMapUv:qe&&y(D.alphaMap.channel),vertexTangents:!!N.attributes.tangent&&(Ee||Z),vertexColors:D.vertexColors,vertexAlphas:D.vertexColors===!0&&!!N.attributes.color&&N.attributes.color.itemSize===4,pointsUvs:R.isPoints===!0&&!!N.attributes.uv&&(q||qe),fog:!!T,useFog:D.fog===!0,fogExp2:!!T&&T.isFogExp2,flatShading:D.flatShading===!0,sizeAttenuation:D.sizeAttenuation===!0,logarithmicDepthBuffer:h,reverseDepthBuffer:Ue,skinning:R.isSkinnedMesh===!0,morphTargets:N.morphAttributes.position!==void 0,morphNormals:N.morphAttributes.normal!==void 0,morphColors:N.morphAttributes.color!==void 0,morphTargetsCount:me,morphTextureStride:Me,numDirLights:O.directional.length,numPointLights:O.point.length,numSpotLights:O.spot.length,numSpotLightMaps:O.spotLightMap.length,numRectAreaLights:O.rectArea.length,numHemiLights:O.hemi.length,numDirLightShadows:O.directionalShadowMap.length,numPointLightShadows:O.pointShadowMap.length,numSpotLightShadows:O.spotShadowMap.length,numSpotLightShadowsWithMaps:O.numSpotLightShadowsWithMaps,numLightProbes:O.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:D.dithering,shadowMapEnabled:t.shadowMap.enabled&&B.length>0,shadowMapType:t.shadowMap.type,toneMapping:en,decodeVideoTexture:q&&D.map.isVideoTexture===!0&&an.getTransfer(D.map.colorSpace)===En,decodeVideoTextureEmissive:st&&D.emissiveMap.isVideoTexture===!0&&an.getTransfer(D.emissiveMap.colorSpace)===En,premultipliedAlpha:D.premultipliedAlpha,doubleSided:D.side===po,flipSided:D.side===xa,useDepthPacking:D.depthPacking>=0,depthPacking:D.depthPacking||0,index0AttributeName:D.index0AttributeName,extensionClipCullDistance:Wt&&D.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Wt&&D.extensions.multiDraw===!0||we)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:D.customProgramCacheKey()};return Ii.vertexUv1s=u.has(1),Ii.vertexUv2s=u.has(2),Ii.vertexUv3s=u.has(3),u.clear(),Ii}function _(D){let O=[];if(D.shaderID?O.push(D.shaderID):(O.push(D.customVertexShaderID),O.push(D.customFragmentShaderID)),D.defines!==void 0)for(let B in D.defines)O.push(B),O.push(D.defines[B]);return D.isRawShaderMaterial===!1&&(w(O,D),b(O,D),O.push(t.outputColorSpace)),O.push(D.customProgramCacheKey),O.join()}function w(D,O){D.push(O.precision),D.push(O.outputColorSpace),D.push(O.envMapMode),D.push(O.envMapCubeUVHeight),D.push(O.mapUv),D.push(O.alphaMapUv),D.push(O.lightMapUv),D.push(O.aoMapUv),D.push(O.bumpMapUv),D.push(O.normalMapUv),D.push(O.displacementMapUv),D.push(O.emissiveMapUv),D.push(O.metalnessMapUv),D.push(O.roughnessMapUv),D.push(O.anisotropyMapUv),D.push(O.clearcoatMapUv),D.push(O.clearcoatNormalMapUv),D.push(O.clearcoatRoughnessMapUv),D.push(O.iridescenceMapUv),D.push(O.iridescenceThicknessMapUv),D.push(O.sheenColorMapUv),D.push(O.sheenRoughnessMapUv),D.push(O.specularMapUv),D.push(O.specularColorMapUv),D.push(O.specularIntensityMapUv),D.push(O.transmissionMapUv),D.push(O.thicknessMapUv),D.push(O.combine),D.push(O.fogExp2),D.push(O.sizeAttenuation),D.push(O.morphTargetsCount),D.push(O.morphAttributeCount),D.push(O.numDirLights),D.push(O.numPointLights),D.push(O.numSpotLights),D.push(O.numSpotLightMaps),D.push(O.numHemiLights),D.push(O.numRectAreaLights),D.push(O.numDirLightShadows),D.push(O.numPointLightShadows),D.push(O.numSpotLightShadows),D.push(O.numSpotLightShadowsWithMaps),D.push(O.numLightProbes),D.push(O.shadowMapType),D.push(O.toneMapping),D.push(O.numClippingPlanes),D.push(O.numClipIntersection),D.push(O.depthPacking)}function b(D,O){s.disableAll(),O.supportsVertexTextures&&s.enable(0),O.instancing&&s.enable(1),O.instancingColor&&s.enable(2),O.instancingMorph&&s.enable(3),O.matcap&&s.enable(4),O.envMap&&s.enable(5),O.normalMapObjectSpace&&s.enable(6),O.normalMapTangentSpace&&s.enable(7),O.clearcoat&&s.enable(8),O.iridescence&&s.enable(9),O.alphaTest&&s.enable(10),O.vertexColors&&s.enable(11),O.vertexAlphas&&s.enable(12),O.vertexUv1s&&s.enable(13),O.vertexUv2s&&s.enable(14),O.vertexUv3s&&s.enable(15),O.vertexTangents&&s.enable(16),O.anisotropy&&s.enable(17),O.alphaHash&&s.enable(18),O.batching&&s.enable(19),O.dispersion&&s.enable(20),O.batchingColor&&s.enable(21),D.push(s.mask),s.disableAll(),O.fog&&s.enable(0),O.useFog&&s.enable(1),O.flatShading&&s.enable(2),O.logarithmicDepthBuffer&&s.enable(3),O.reverseDepthBuffer&&s.enable(4),O.skinning&&s.enable(5),O.morphTargets&&s.enable(6),O.morphNormals&&s.enable(7),O.morphColors&&s.enable(8),O.premultipliedAlpha&&s.enable(9),O.shadowMapEnabled&&s.enable(10),O.doubleSided&&s.enable(11),O.flipSided&&s.enable(12),O.useDepthPacking&&s.enable(13),O.dithering&&s.enable(14),O.transmission&&s.enable(15),O.sheen&&s.enable(16),O.opaque&&s.enable(17),O.pointsUvs&&s.enable(18),O.decodeVideoTexture&&s.enable(19),O.decodeVideoTextureEmissive&&s.enable(20),O.alphaToCoverage&&s.enable(21),D.push(s.mask)}function A(D){let O=m[D.type],B;if(O){let L=hu[O];B=Yie.clone(L.uniforms)}else B=D.uniforms;return B}function E(D,O){let B;for(let L=0,R=c.length;L<R;L++){let T=c[L];if(T.cacheKey===O){B=T,++B.usedTimes;break}}return B===void 0&&(B=new Tce(t,O,D,a),c.push(B)),B}function M(D){if(--D.usedTimes===0){let O=c.indexOf(D);c[O]=c[c.length-1],c.pop(),D.destroy()}}function P(D){l.remove(D)}function k(){l.dispose()}return{getParameters:v,getProgramCacheKey:_,getUniforms:A,acquireProgram:E,releaseProgram:M,releaseShaderCache:P,programs:c,dispose:k}}function Bce(){let t=new WeakMap;function e(o){return t.has(o)}function r(o){let s=t.get(o);return s===void 0&&(s={},t.set(o,s)),s}function n(o){t.delete(o)}function i(o,s,l){t.get(o)[s]=l}function a(){t=new WeakMap}return{has:e,get:r,remove:n,update:i,dispose:a}}function zce(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function J7(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function K7(){let t=[],e=0,r=[],n=[],i=[];function a(){e=0,r.length=0,n.length=0,i.length=0}function o(h,d,p,m,y,v){let _=t[e];return _===void 0?(_={id:h.id,object:h,geometry:d,material:p,groupOrder:m,renderOrder:h.renderOrder,z:y,group:v},t[e]=_):(_.id=h.id,_.object=h,_.geometry=d,_.material=p,_.groupOrder=m,_.renderOrder=h.renderOrder,_.z=y,_.group=v),e++,_}function s(h,d,p,m,y,v){let _=o(h,d,p,m,y,v);p.transmission>0?n.push(_):p.transparent===!0?i.push(_):r.push(_)}function l(h,d,p,m,y,v){let _=o(h,d,p,m,y,v);p.transmission>0?n.unshift(_):p.transparent===!0?i.unshift(_):r.unshift(_)}function u(h,d){r.length>1&&r.sort(h||zce),n.length>1&&n.sort(d||J7),i.length>1&&i.sort(d||J7)}function c(){for(let h=e,d=t.length;h<d;h++){let p=t[h];if(p.id===null)break;p.id=null,p.object=null,p.geometry=null,p.material=null,p.group=null}}return{opaque:r,transmissive:n,transparent:i,init:a,push:s,unshift:l,finish:c,sort:u}}function Fce(){let t=new WeakMap;function e(n,i){let a=t.get(n),o;return a===void 0?(o=new K7,t.set(n,[o])):i>=a.length?(o=new K7,a.push(o)):o=a[i],o}function r(){t=new WeakMap}return{get:e,dispose:r}}function Rce(){let t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let r;switch(e.type){case"DirectionalLight":r={direction:new Q,color:new jt};break;case"SpotLight":r={position:new Q,direction:new Q,color:new jt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new Q,color:new jt,distance:0,decay:0};break;case"HemisphereLight":r={direction:new Q,skyColor:new jt,groundColor:new jt};break;case"RectAreaLight":r={color:new jt,position:new Q,halfWidth:new Q,halfHeight:new Q};break}return t[e.id]=r,r}}}function Lce(){let t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let r;switch(e.type){case"DirectionalLight":r={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Je};break;case"SpotLight":r={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Je};break;case"PointLight":r={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Je,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=r,r}}}var Nce=0;function $ce(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function Uce(t){let e=new Rce,r=Lce(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)n.probe.push(new Q);let i=new Q,a=new gr,o=new gr;function s(u){let c=0,h=0,d=0;for(let D=0;D<9;D++)n.probe[D].set(0,0,0);let p=0,m=0,y=0,v=0,_=0,w=0,b=0,A=0,E=0,M=0,P=0;u.sort($ce);for(let D=0,O=u.length;D<O;D++){let B=u[D],L=B.color,R=B.intensity,T=B.distance,N=B.shadow&&B.shadow.map?B.shadow.map.texture:null;if(B.isAmbientLight)c+=L.r*R,h+=L.g*R,d+=L.b*R;else if(B.isLightProbe){for(let $=0;$<9;$++)n.probe[$].addScaledVector(B.sh.coefficients[$],R);P++}else if(B.isDirectionalLight){let $=e.get(B);if($.color.copy(B.color).multiplyScalar(B.intensity),B.castShadow){let V=B.shadow,G=r.get(B);G.shadowIntensity=V.intensity,G.shadowBias=V.bias,G.shadowNormalBias=V.normalBias,G.shadowRadius=V.radius,G.shadowMapSize=V.mapSize,n.directionalShadow[p]=G,n.directionalShadowMap[p]=N,n.directionalShadowMatrix[p]=B.shadow.matrix,w++}n.directional[p]=$,p++}else if(B.isSpotLight){let $=e.get(B);$.position.setFromMatrixPosition(B.matrixWorld),$.color.copy(L).multiplyScalar(R),$.distance=T,$.coneCos=Math.cos(B.angle),$.penumbraCos=Math.cos(B.angle*(1-B.penumbra)),$.decay=B.decay,n.spot[y]=$;let V=B.shadow;if(B.map&&(n.spotLightMap[E]=B.map,E++,V.updateMatrices(B),B.castShadow&&M++),n.spotLightMatrix[y]=V.matrix,B.castShadow){let G=r.get(B);G.shadowIntensity=V.intensity,G.shadowBias=V.bias,G.shadowNormalBias=V.normalBias,G.shadowRadius=V.radius,G.shadowMapSize=V.mapSize,n.spotShadow[y]=G,n.spotShadowMap[y]=N,A++}y++}else if(B.isRectAreaLight){let $=e.get(B);$.color.copy(L).multiplyScalar(R),$.halfWidth.set(B.width*.5,0,0),$.halfHeight.set(0,B.height*.5,0),n.rectArea[v]=$,v++}else if(B.isPointLight){let $=e.get(B);if($.color.copy(B.color).multiplyScalar(B.intensity),$.distance=B.distance,$.decay=B.decay,B.castShadow){let V=B.shadow,G=r.get(B);G.shadowIntensity=V.intensity,G.shadowBias=V.bias,G.shadowNormalBias=V.normalBias,G.shadowRadius=V.radius,G.shadowMapSize=V.mapSize,G.shadowCameraNear=V.camera.near,G.shadowCameraFar=V.camera.far,n.pointShadow[m]=G,n.pointShadowMap[m]=N,n.pointShadowMatrix[m]=B.shadow.matrix,b++}n.point[m]=$,m++}else if(B.isHemisphereLight){let $=e.get(B);$.skyColor.copy(B.color).multiplyScalar(R),$.groundColor.copy(B.groundColor).multiplyScalar(R),n.hemi[_]=$,_++}}v>0&&(t.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Dt.LTC_FLOAT_1,n.rectAreaLTC2=Dt.LTC_FLOAT_2):(n.rectAreaLTC1=Dt.LTC_HALF_1,n.rectAreaLTC2=Dt.LTC_HALF_2)),n.ambient[0]=c,n.ambient[1]=h,n.ambient[2]=d;let k=n.hash;(k.directionalLength!==p||k.pointLength!==m||k.spotLength!==y||k.rectAreaLength!==v||k.hemiLength!==_||k.numDirectionalShadows!==w||k.numPointShadows!==b||k.numSpotShadows!==A||k.numSpotMaps!==E||k.numLightProbes!==P)&&(n.directional.length=p,n.spot.length=y,n.rectArea.length=v,n.point.length=m,n.hemi.length=_,n.directionalShadow.length=w,n.directionalShadowMap.length=w,n.pointShadow.length=b,n.pointShadowMap.length=b,n.spotShadow.length=A,n.spotShadowMap.length=A,n.directionalShadowMatrix.length=w,n.pointShadowMatrix.length=b,n.spotLightMatrix.length=A+E-M,n.spotLightMap.length=E,n.numSpotLightShadowsWithMaps=M,n.numLightProbes=P,k.directionalLength=p,k.pointLength=m,k.spotLength=y,k.rectAreaLength=v,k.hemiLength=_,k.numDirectionalShadows=w,k.numPointShadows=b,k.numSpotShadows=A,k.numSpotMaps=E,k.numLightProbes=P,n.version=Nce++)}function l(u,c){let h=0,d=0,p=0,m=0,y=0,v=c.matrixWorldInverse;for(let _=0,w=u.length;_<w;_++){let b=u[_];if(b.isDirectionalLight){let A=n.directional[h];A.direction.setFromMatrixPosition(b.matrixWorld),i.setFromMatrixPosition(b.target.matrixWorld),A.direction.sub(i),A.direction.transformDirection(v),h++}else if(b.isSpotLight){let A=n.spot[p];A.position.setFromMatrixPosition(b.matrixWorld),A.position.applyMatrix4(v),A.direction.setFromMatrixPosition(b.matrixWorld),i.setFromMatrixPosition(b.target.matrixWorld),A.direction.sub(i),A.direction.transformDirection(v),p++}else if(b.isRectAreaLight){let A=n.rectArea[m];A.position.setFromMatrixPosition(b.matrixWorld),A.position.applyMatrix4(v),o.identity(),a.copy(b.matrixWorld),a.premultiply(v),o.extractRotation(a),A.halfWidth.set(b.width*.5,0,0),A.halfHeight.set(0,b.height*.5,0),A.halfWidth.applyMatrix4(o),A.halfHeight.applyMatrix4(o),m++}else if(b.isPointLight){let A=n.point[d];A.position.setFromMatrixPosition(b.matrixWorld),A.position.applyMatrix4(v),d++}else if(b.isHemisphereLight){let A=n.hemi[y];A.direction.setFromMatrixPosition(b.matrixWorld),A.direction.transformDirection(v),y++}}}return{setup:s,setupView:l,state:n}}function Q7(t){let e=new Uce(t),r=[],n=[];function i(c){u.camera=c,r.length=0,n.length=0}function a(c){r.push(c)}function o(c){n.push(c)}function s(){e.setup(r)}function l(c){e.setupView(r,c)}let u={lightsArray:r,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:i,state:u,setupLights:s,setupLightsView:l,pushLight:a,pushShadow:o}}function jce(t){let e=new WeakMap;function r(i,a=0){let o=e.get(i),s;return o===void 0?(s=new Q7(t),e.set(i,[s])):a>=o.length?(s=new Q7(t),o.push(s)):s=o[a],s}function n(){e=new WeakMap}return{get:r,dispose:n}}var Vce=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Gce=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Zce(t,e,r){let n=new h0,i=new Je,a=new Je,o=new _n,s=new Hae({depthPacking:nie}),l=new Xae,u={},c=r.maxTextureSize,h={[_s]:xa,[xa]:_s,[po]:po},d=new ys({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Je},radius:{value:4}},vertexShader:Vce,fragmentShader:Gce}),p=d.clone();p.defines.HORIZONTAL_PASS=1;let m=new Ja;m.setAttribute("position",new Xn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let y=new Er(m,d),v=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=z9;let _=this.type;this.render=function(M,P,k){if(v.enabled===!1||v.autoUpdate===!1&&v.needsUpdate===!1||M.length===0)return;let D=t.getRenderTarget(),O=t.getActiveCubeFace(),B=t.getActiveMipmapLevel(),L=t.state;L.setBlending(Qh),L.buffers.color.setClear(1,1,1,1),L.buffers.depth.setTest(!0),L.setScissorTest(!1);let R=_!==uc&&this.type===uc,T=_===uc&&this.type!==uc;for(let N=0,$=M.length;N<$;N++){let V=M[N],G=V.shadow;if(G===void 0){console.warn("THREE.WebGLShadowMap:",V,"has no shadow.");continue}if(G.autoUpdate===!1&&G.needsUpdate===!1)continue;i.copy(G.mapSize);let ee=G.getFrameExtents();if(i.multiply(ee),a.copy(G.mapSize),(i.x>c||i.y>c)&&(i.x>c&&(a.x=Math.floor(c/ee.x),i.x=a.x*ee.x,G.mapSize.x=a.x),i.y>c&&(a.y=Math.floor(c/ee.y),i.y=a.y*ee.y,G.mapSize.y=a.y)),G.map===null||R===!0||T===!0){let me=this.type!==uc?{minFilter:gs,magFilter:gs}:{};G.map!==null&&G.map.dispose(),G.map=new ad(i.x,i.y,me),G.map.texture.name=V.name+".shadowMap",G.camera.updateProjectionMatrix()}t.setRenderTarget(G.map),t.clear();let ie=G.getViewportCount();for(let me=0;me<ie;me++){let Me=G.getViewport(me);o.set(a.x*Me.x,a.y*Me.y,a.x*Me.z,a.y*Me.w),L.viewport(o),G.updateMatrices(V,me),n=G.getFrustum(),A(P,k,G.camera,V,this.type)}G.isPointLightShadow!==!0&&this.type===uc&&w(G,k),G.needsUpdate=!1}_=this.type,v.needsUpdate=!1,t.setRenderTarget(D,O,B)};function w(M,P){let k=e.update(y);d.defines.VSM_SAMPLES!==M.blurSamples&&(d.defines.VSM_SAMPLES=M.blurSamples,p.defines.VSM_SAMPLES=M.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),M.mapPass===null&&(M.mapPass=new ad(i.x,i.y)),d.uniforms.shadow_pass.value=M.map.texture,d.uniforms.resolution.value=M.mapSize,d.uniforms.radius.value=M.radius,t.setRenderTarget(M.mapPass),t.clear(),t.renderBufferDirect(P,null,k,d,y,null),p.uniforms.shadow_pass.value=M.mapPass.texture,p.uniforms.resolution.value=M.mapSize,p.uniforms.radius.value=M.radius,t.setRenderTarget(M.map),t.clear(),t.renderBufferDirect(P,null,k,p,y,null)}function b(M,P,k,D){let O=null,B=k.isPointLight===!0?M.customDistanceMaterial:M.customDepthMaterial;if(B!==void 0)O=B;else if(O=k.isPointLight===!0?l:s,t.localClippingEnabled&&P.clipShadows===!0&&Array.isArray(P.clippingPlanes)&&P.clippingPlanes.length!==0||P.displacementMap&&P.displacementScale!==0||P.alphaMap&&P.alphaTest>0||P.map&&P.alphaTest>0){let L=O.uuid,R=P.uuid,T=u[L];T===void 0&&(T={},u[L]=T);let N=T[R];N===void 0&&(N=O.clone(),T[R]=N,P.addEventListener("dispose",E)),O=N}if(O.visible=P.visible,O.wireframe=P.wireframe,D===uc?O.side=P.shadowSide!==null?P.shadowSide:P.side:O.side=P.shadowSide!==null?P.shadowSide:h[P.side],O.alphaMap=P.alphaMap,O.alphaTest=P.alphaTest,O.map=P.map,O.clipShadows=P.clipShadows,O.clippingPlanes=P.clippingPlanes,O.clipIntersection=P.clipIntersection,O.displacementMap=P.displacementMap,O.displacementScale=P.displacementScale,O.displacementBias=P.displacementBias,O.wireframeLinewidth=P.wireframeLinewidth,O.linewidth=P.linewidth,k.isPointLight===!0&&O.isMeshDistanceMaterial===!0){let L=t.properties.get(O);L.light=k}return O}function A(M,P,k,D,O){if(M.visible===!1)return;if(M.layers.test(P.layers)&&(M.isMesh||M.isLine||M.isPoints)&&(M.castShadow||M.receiveShadow&&O===uc)&&(!M.frustumCulled||n.intersectsObject(M))){M.modelViewMatrix.multiplyMatrices(k.matrixWorldInverse,M.matrixWorld);let L=e.update(M),R=M.material;if(Array.isArray(R)){let T=L.groups;for(let N=0,$=T.length;N<$;N++){let V=T[N],G=R[V.materialIndex];if(G&&G.visible){let ee=b(M,G,D,O);M.onBeforeShadow(t,M,P,k,L,ee,V),t.renderBufferDirect(k,null,L,ee,M,V),M.onAfterShadow(t,M,P,k,L,ee,V)}}}else if(R.visible){let T=b(M,R,D,O);M.onBeforeShadow(t,M,P,k,L,T,null),t.renderBufferDirect(k,null,L,T,M,null),M.onAfterShadow(t,M,P,k,L,T,null)}}let B=M.children;for(let L=0,R=B.length;L<R;L++)A(B[L],P,k,D,O)}function E(M){M.target.removeEventListener("dispose",E);for(let P in u){let k=u[P],D=M.target.uuid;D in k&&(k[D].dispose(),delete k[D])}}}var Wce={[jI]:VI,[GI]:HI,[ZI]:XI,[mg]:WI,[VI]:jI,[HI]:GI,[XI]:ZI,[WI]:mg};function Hce(t,e){function r(){let he=!1,ct=new _n,De=null,qe=new _n(0,0,0,0);return{setMask:function(mt){De!==mt&&!he&&(t.colorMask(mt,mt,mt,mt),De=mt)},setLocked:function(mt){he=mt},setClear:function(mt,Et,Wt,en,Ii){Ii===!0&&(mt*=en,Et*=en,Wt*=en),ct.set(mt,Et,Wt,en),qe.equals(ct)===!1&&(t.clearColor(mt,Et,Wt,en),qe.copy(ct))},reset:function(){he=!1,De=null,qe.set(-1,0,0,0)}}}function n(){let he=!1,ct=!1,De=null,qe=null,mt=null;return{setReversed:function(Et){if(ct!==Et){let Wt=e.get("EXT_clip_control");ct?Wt.clipControlEXT(Wt.LOWER_LEFT_EXT,Wt.ZERO_TO_ONE_EXT):Wt.clipControlEXT(Wt.LOWER_LEFT_EXT,Wt.NEGATIVE_ONE_TO_ONE_EXT);let en=mt;mt=null,this.setClear(en)}ct=Et},getReversed:function(){return ct},setTest:function(Et){Et?Se(t.DEPTH_TEST):Ue(t.DEPTH_TEST)},setMask:function(Et){De!==Et&&!he&&(t.depthMask(Et),De=Et)},setFunc:function(Et){if(ct&&(Et=Wce[Et]),qe!==Et){switch(Et){case jI:t.depthFunc(t.NEVER);break;case VI:t.depthFunc(t.ALWAYS);break;case GI:t.depthFunc(t.LESS);break;case mg:t.depthFunc(t.LEQUAL);break;case ZI:t.depthFunc(t.EQUAL);break;case WI:t.depthFunc(t.GEQUAL);break;case HI:t.depthFunc(t.GREATER);break;case XI:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}qe=Et}},setLocked:function(Et){he=Et},setClear:function(Et){mt!==Et&&(ct&&(Et=1-Et),t.clearDepth(Et),mt=Et)},reset:function(){he=!1,De=null,qe=null,mt=null,ct=!1}}}function i(){let he=!1,ct=null,De=null,qe=null,mt=null,Et=null,Wt=null,en=null,Ii=null;return{setTest:function(Zr){he||(Zr?Se(t.STENCIL_TEST):Ue(t.STENCIL_TEST))},setMask:function(Zr){ct!==Zr&&!he&&(t.stencilMask(Zr),ct=Zr)},setFunc:function(Zr,Pn,Fa){(De!==Zr||qe!==Pn||mt!==Fa)&&(t.stencilFunc(Zr,Pn,Fa),De=Zr,qe=Pn,mt=Fa)},setOp:function(Zr,Pn,Fa){(Et!==Zr||Wt!==Pn||en!==Fa)&&(t.stencilOp(Zr,Pn,Fa),Et=Zr,Wt=Pn,en=Fa)},setLocked:function(Zr){he=Zr},setClear:function(Zr){Ii!==Zr&&(t.clearStencil(Zr),Ii=Zr)},reset:function(){he=!1,ct=null,De=null,qe=null,mt=null,Et=null,Wt=null,en=null,Ii=null}}}let a=new r,o=new n,s=new i,l=new WeakMap,u=new WeakMap,c={},h={},d=new WeakMap,p=[],m=null,y=!1,v=null,_=null,w=null,b=null,A=null,E=null,M=null,P=new jt(0,0,0),k=0,D=!1,O=null,B=null,L=null,R=null,T=null,N=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),$=!1,V=0,G=t.getParameter(t.VERSION);G.indexOf("WebGL")!==-1?(V=parseFloat(/^WebGL (\d)/.exec(G)[1]),$=V>=1):G.indexOf("OpenGL ES")!==-1&&(V=parseFloat(/^OpenGL ES (\d)/.exec(G)[1]),$=V>=2);let ee=null,ie={},me=t.getParameter(t.SCISSOR_BOX),Me=t.getParameter(t.VIEWPORT),Ae=new _n().fromArray(me),le=new _n().fromArray(Me);function _e(he,ct,De,qe){let mt=new Uint8Array(4),Et=t.createTexture();t.bindTexture(he,Et),t.texParameteri(he,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(he,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let Wt=0;Wt<De;Wt++)he===t.TEXTURE_3D||he===t.TEXTURE_2D_ARRAY?t.texImage3D(ct,0,t.RGBA,1,1,qe,0,t.RGBA,t.UNSIGNED_BYTE,mt):t.texImage2D(ct+Wt,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,mt);return Et}let Le={};Le[t.TEXTURE_2D]=_e(t.TEXTURE_2D,t.TEXTURE_2D,1),Le[t.TEXTURE_CUBE_MAP]=_e(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),Le[t.TEXTURE_2D_ARRAY]=_e(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),Le[t.TEXTURE_3D]=_e(t.TEXTURE_3D,t.TEXTURE_3D,1,1),a.setClear(0,0,0,1),o.setClear(1),s.setClear(0),Se(t.DEPTH_TEST),o.setFunc(mg),Ce(!1),Ee(MB),Se(t.CULL_FACE),X(Qh);function Se(he){c[he]!==!0&&(t.enable(he),c[he]=!0)}function Ue(he){c[he]!==!1&&(t.disable(he),c[he]=!1)}function Y(he,ct){return h[he]!==ct?(t.bindFramebuffer(he,ct),h[he]=ct,he===t.DRAW_FRAMEBUFFER&&(h[t.FRAMEBUFFER]=ct),he===t.FRAMEBUFFER&&(h[t.DRAW_FRAMEBUFFER]=ct),!0):!1}function we(he,ct){let De=p,qe=!1;if(he){De=d.get(ct),De===void 0&&(De=[],d.set(ct,De));let mt=he.textures;if(De.length!==mt.length||De[0]!==t.COLOR_ATTACHMENT0){for(let Et=0,Wt=mt.length;Et<Wt;Et++)De[Et]=t.COLOR_ATTACHMENT0+Et;De.length=mt.length,qe=!0}}else De[0]!==t.BACK&&(De[0]=t.BACK,qe=!0);qe&&t.drawBuffers(De)}function q(he){return m!==he?(t.useProgram(he),m=he,!0):!1}let oe={[ip]:t.FUNC_ADD,[Ene]:t.FUNC_SUBTRACT,[Ine]:t.FUNC_REVERSE_SUBTRACT};oe[Cne]=t.MIN,oe[Mne]=t.MAX;let ce={[Tne]:t.ZERO,[Pne]:t.ONE,[Dne]:t.SRC_COLOR,[$I]:t.SRC_ALPHA,[Rne]:t.SRC_ALPHA_SATURATE,[zne]:t.DST_COLOR,[One]:t.DST_ALPHA,[kne]:t.ONE_MINUS_SRC_COLOR,[UI]:t.ONE_MINUS_SRC_ALPHA,[Fne]:t.ONE_MINUS_DST_COLOR,[Bne]:t.ONE_MINUS_DST_ALPHA,[Lne]:t.CONSTANT_COLOR,[Nne]:t.ONE_MINUS_CONSTANT_COLOR,[$ne]:t.CONSTANT_ALPHA,[Une]:t.ONE_MINUS_CONSTANT_ALPHA};function X(he,ct,De,qe,mt,Et,Wt,en,Ii,Zr){if(he===Qh){y===!0&&(Ue(t.BLEND),y=!1);return}if(y===!1&&(Se(t.BLEND),y=!0),he!==Sne){if(he!==v||Zr!==D){if((_!==ip||A!==ip)&&(t.blendEquation(t.FUNC_ADD),_=ip,A=ip),Zr)switch(he){case qm:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case TB:t.blendFunc(t.ONE,t.ONE);break;case PB:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case DB:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",he);break}else switch(he){case qm:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case TB:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case PB:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case DB:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",he);break}w=null,b=null,E=null,M=null,P.set(0,0,0),k=0,v=he,D=Zr}return}mt=mt||ct,Et=Et||De,Wt=Wt||qe,(ct!==_||mt!==A)&&(t.blendEquationSeparate(oe[ct],oe[mt]),_=ct,A=mt),(De!==w||qe!==b||Et!==E||Wt!==M)&&(t.blendFuncSeparate(ce[De],ce[qe],ce[Et],ce[Wt]),w=De,b=qe,E=Et,M=Wt),(en.equals(P)===!1||Ii!==k)&&(t.blendColor(en.r,en.g,en.b,Ii),P.copy(en),k=Ii),v=he,D=!1}function ke(he,ct){he.side===po?Ue(t.CULL_FACE):Se(t.CULL_FACE);let De=he.side===xa;ct&&(De=!De),Ce(De),he.blending===qm&&he.transparent===!1?X(Qh):X(he.blending,he.blendEquation,he.blendSrc,he.blendDst,he.blendEquationAlpha,he.blendSrcAlpha,he.blendDstAlpha,he.blendColor,he.blendAlpha,he.premultipliedAlpha),o.setFunc(he.depthFunc),o.setTest(he.depthTest),o.setMask(he.depthWrite),a.setMask(he.colorWrite);let qe=he.stencilWrite;s.setTest(qe),qe&&(s.setMask(he.stencilWriteMask),s.setFunc(he.stencilFunc,he.stencilRef,he.stencilFuncMask),s.setOp(he.stencilFail,he.stencilZFail,he.stencilZPass)),st(he.polygonOffset,he.polygonOffsetFactor,he.polygonOffsetUnits),he.alphaToCoverage===!0?Se(t.SAMPLE_ALPHA_TO_COVERAGE):Ue(t.SAMPLE_ALPHA_TO_COVERAGE)}function Ce(he){O!==he&&(he?t.frontFace(t.CW):t.frontFace(t.CCW),O=he)}function Ee(he){he!==bne?(Se(t.CULL_FACE),he!==B&&(he===MB?t.cullFace(t.BACK):he===wne?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):Ue(t.CULL_FACE),B=he}function Ne(he){he!==L&&($&&t.lineWidth(he),L=he)}function st(he,ct,De){he?(Se(t.POLYGON_OFFSET_FILL),(R!==ct||T!==De)&&(t.polygonOffset(ct,De),R=ct,T=De)):Ue(t.POLYGON_OFFSET_FILL)}function Ke(he){he?Se(t.SCISSOR_TEST):Ue(t.SCISSOR_TEST)}function J(he){he===void 0&&(he=t.TEXTURE0+N-1),ee!==he&&(t.activeTexture(he),ee=he)}function Z(he,ct,De){De===void 0&&(ee===null?De=t.TEXTURE0+N-1:De=ee);let qe=ie[De];qe===void 0&&(qe={type:void 0,texture:void 0},ie[De]=qe),(qe.type!==he||qe.texture!==ct)&&(ee!==De&&(t.activeTexture(De),ee=De),t.bindTexture(he,ct||Le[he]),qe.type=he,qe.texture=ct)}function fe(){let he=ie[ee];he!==void 0&&he.type!==void 0&&(t.bindTexture(he.type,null),he.type=void 0,he.texture=void 0)}function Fe(){try{t.compressedTexImage2D.apply(t,arguments)}catch(he){console.error("THREE.WebGLState:",he)}}function Ve(){try{t.compressedTexImage3D.apply(t,arguments)}catch(he){console.error("THREE.WebGLState:",he)}}function ze(){try{t.texSubImage2D.apply(t,arguments)}catch(he){console.error("THREE.WebGLState:",he)}}function Tt(){try{t.texSubImage3D.apply(t,arguments)}catch(he){console.error("THREE.WebGLState:",he)}}function ft(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(he){console.error("THREE.WebGLState:",he)}}function St(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(he){console.error("THREE.WebGLState:",he)}}function nr(){try{t.texStorage2D.apply(t,arguments)}catch(he){console.error("THREE.WebGLState:",he)}}function He(){try{t.texStorage3D.apply(t,arguments)}catch(he){console.error("THREE.WebGLState:",he)}}function Ge(){try{t.texImage2D.apply(t,arguments)}catch(he){console.error("THREE.WebGLState:",he)}}function je(){try{t.texImage3D.apply(t,arguments)}catch(he){console.error("THREE.WebGLState:",he)}}function tt(he){Ae.equals(he)===!1&&(t.scissor(he.x,he.y,he.z,he.w),Ae.copy(he))}function Ze(he){le.equals(he)===!1&&(t.viewport(he.x,he.y,he.z,he.w),le.copy(he))}function At(he,ct){let De=u.get(ct);De===void 0&&(De=new WeakMap,u.set(ct,De));let qe=De.get(he);qe===void 0&&(qe=t.getUniformBlockIndex(ct,he.name),De.set(he,qe))}function vt(he,ct){let De=u.get(ct).get(he);l.get(ct)!==De&&(t.uniformBlockBinding(ct,De,he.__bindingPointIndex),l.set(ct,De))}function Kt(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),o.setReversed(!1),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),c={},ee=null,ie={},h={},d=new WeakMap,p=[],m=null,y=!1,v=null,_=null,w=null,b=null,A=null,E=null,M=null,P=new jt(0,0,0),k=0,D=!1,O=null,B=null,L=null,R=null,T=null,Ae.set(0,0,t.canvas.width,t.canvas.height),le.set(0,0,t.canvas.width,t.canvas.height),a.reset(),o.reset(),s.reset()}return{buffers:{color:a,depth:o,stencil:s},enable:Se,disable:Ue,bindFramebuffer:Y,drawBuffers:we,useProgram:q,setBlending:X,setMaterial:ke,setFlipSided:Ce,setCullFace:Ee,setLineWidth:Ne,setPolygonOffset:st,setScissorTest:Ke,activeTexture:J,bindTexture:Z,unbindTexture:fe,compressedTexImage2D:Fe,compressedTexImage3D:Ve,texImage2D:Ge,texImage3D:je,updateUBOMapping:At,uniformBlockBinding:vt,texStorage2D:nr,texStorage3D:He,texSubImage2D:ze,texSubImage3D:Tt,compressedTexSubImage2D:ft,compressedTexSubImage3D:St,scissor:tt,viewport:Ze,reset:Kt}}function Xce(t,e,r,n,i,a,o){let s=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),u=new Je,c=new WeakMap,h,d=new WeakMap,p=!1;try{p=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function m(J,Z){return p?new OffscreenCanvas(J,Z):Jv("canvas")}function y(J,Z,fe){let Fe=1,Ve=Ke(J);if((Ve.width>fe||Ve.height>fe)&&(Fe=fe/Math.max(Ve.width,Ve.height)),Fe<1)if(typeof HTMLImageElement<"u"&&J instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&J instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&J instanceof ImageBitmap||typeof VideoFrame<"u"&&J instanceof VideoFrame){let ze=Math.floor(Fe*Ve.width),Tt=Math.floor(Fe*Ve.height);h===void 0&&(h=m(ze,Tt));let ft=Z?m(ze,Tt):h;return ft.width=ze,ft.height=Tt,ft.getContext("2d").drawImage(J,0,0,ze,Tt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Ve.width+"x"+Ve.height+") to ("+ze+"x"+Tt+")."),ft}else return"data"in J&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Ve.width+"x"+Ve.height+")."),J;return J}function v(J){return J.generateMipmaps}function _(J){t.generateMipmap(J)}function w(J){return J.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:J.isWebGL3DRenderTarget?t.TEXTURE_3D:J.isWebGLArrayRenderTarget||J.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:t.TEXTURE_2D}function b(J,Z,fe,Fe,Ve=!1){if(J!==null){if(t[J]!==void 0)return t[J];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+J+"'")}let ze=Z;if(Z===t.RED&&(fe===t.FLOAT&&(ze=t.R32F),fe===t.HALF_FLOAT&&(ze=t.R16F),fe===t.UNSIGNED_BYTE&&(ze=t.R8)),Z===t.RED_INTEGER&&(fe===t.UNSIGNED_BYTE&&(ze=t.R8UI),fe===t.UNSIGNED_SHORT&&(ze=t.R16UI),fe===t.UNSIGNED_INT&&(ze=t.R32UI),fe===t.BYTE&&(ze=t.R8I),fe===t.SHORT&&(ze=t.R16I),fe===t.INT&&(ze=t.R32I)),Z===t.RG&&(fe===t.FLOAT&&(ze=t.RG32F),fe===t.HALF_FLOAT&&(ze=t.RG16F),fe===t.UNSIGNED_BYTE&&(ze=t.RG8)),Z===t.RG_INTEGER&&(fe===t.UNSIGNED_BYTE&&(ze=t.RG8UI),fe===t.UNSIGNED_SHORT&&(ze=t.RG16UI),fe===t.UNSIGNED_INT&&(ze=t.RG32UI),fe===t.BYTE&&(ze=t.RG8I),fe===t.SHORT&&(ze=t.RG16I),fe===t.INT&&(ze=t.RG32I)),Z===t.RGB_INTEGER&&(fe===t.UNSIGNED_BYTE&&(ze=t.RGB8UI),fe===t.UNSIGNED_SHORT&&(ze=t.RGB16UI),fe===t.UNSIGNED_INT&&(ze=t.RGB32UI),fe===t.BYTE&&(ze=t.RGB8I),fe===t.SHORT&&(ze=t.RGB16I),fe===t.INT&&(ze=t.RGB32I)),Z===t.RGBA_INTEGER&&(fe===t.UNSIGNED_BYTE&&(ze=t.RGBA8UI),fe===t.UNSIGNED_SHORT&&(ze=t.RGBA16UI),fe===t.UNSIGNED_INT&&(ze=t.RGBA32UI),fe===t.BYTE&&(ze=t.RGBA8I),fe===t.SHORT&&(ze=t.RGBA16I),fe===t.INT&&(ze=t.RGBA32I)),Z===t.RGB&&fe===t.UNSIGNED_INT_5_9_9_9_REV&&(ze=t.RGB9_E5),Z===t.RGBA){let Tt=Ve?r4:an.getTransfer(Fe);fe===t.FLOAT&&(ze=t.RGBA32F),fe===t.HALF_FLOAT&&(ze=t.RGBA16F),fe===t.UNSIGNED_BYTE&&(ze=Tt===En?t.SRGB8_ALPHA8:t.RGBA8),fe===t.UNSIGNED_SHORT_4_4_4_4&&(ze=t.RGBA4),fe===t.UNSIGNED_SHORT_5_5_5_1&&(ze=t.RGB5_A1)}return(ze===t.R16F||ze===t.R32F||ze===t.RG16F||ze===t.RG32F||ze===t.RGBA16F||ze===t.RGBA32F)&&e.get("EXT_color_buffer_float"),ze}function A(J,Z){let fe;return J?Z===null||Z===id||Z===vg?fe=t.DEPTH24_STENCIL8:Z===ps?fe=t.DEPTH32F_STENCIL8:Z===Yv&&(fe=t.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):Z===null||Z===id||Z===vg?fe=t.DEPTH_COMPONENT24:Z===ps?fe=t.DEPTH_COMPONENT32F:Z===Yv&&(fe=t.DEPTH_COMPONENT16),fe}function E(J,Z){return v(J)===!0||J.isFramebufferTexture&&J.minFilter!==gs&&J.minFilter!==vu?Math.log2(Math.max(Z.width,Z.height))+1:J.mipmaps!==void 0&&J.mipmaps.length>0?J.mipmaps.length:J.isCompressedTexture&&Array.isArray(J.image)?Z.mipmaps.length:1}function M(J){let Z=J.target;Z.removeEventListener("dispose",M),k(Z),Z.isVideoTexture&&c.delete(Z)}function P(J){let Z=J.target;Z.removeEventListener("dispose",P),O(Z)}function k(J){let Z=n.get(J);if(Z.__webglInit===void 0)return;let fe=J.source,Fe=d.get(fe);if(Fe){let Ve=Fe[Z.__cacheKey];Ve.usedTimes--,Ve.usedTimes===0&&D(J),Object.keys(Fe).length===0&&d.delete(fe)}n.remove(J)}function D(J){let Z=n.get(J);t.deleteTexture(Z.__webglTexture);let fe=J.source,Fe=d.get(fe);delete Fe[Z.__cacheKey],o.memory.textures--}function O(J){let Z=n.get(J);if(J.depthTexture&&(J.depthTexture.dispose(),n.remove(J.depthTexture)),J.isWebGLCubeRenderTarget)for(let Fe=0;Fe<6;Fe++){if(Array.isArray(Z.__webglFramebuffer[Fe]))for(let Ve=0;Ve<Z.__webglFramebuffer[Fe].length;Ve++)t.deleteFramebuffer(Z.__webglFramebuffer[Fe][Ve]);else t.deleteFramebuffer(Z.__webglFramebuffer[Fe]);Z.__webglDepthbuffer&&t.deleteRenderbuffer(Z.__webglDepthbuffer[Fe])}else{if(Array.isArray(Z.__webglFramebuffer))for(let Fe=0;Fe<Z.__webglFramebuffer.length;Fe++)t.deleteFramebuffer(Z.__webglFramebuffer[Fe]);else t.deleteFramebuffer(Z.__webglFramebuffer);if(Z.__webglDepthbuffer&&t.deleteRenderbuffer(Z.__webglDepthbuffer),Z.__webglMultisampledFramebuffer&&t.deleteFramebuffer(Z.__webglMultisampledFramebuffer),Z.__webglColorRenderbuffer)for(let Fe=0;Fe<Z.__webglColorRenderbuffer.length;Fe++)Z.__webglColorRenderbuffer[Fe]&&t.deleteRenderbuffer(Z.__webglColorRenderbuffer[Fe]);Z.__webglDepthRenderbuffer&&t.deleteRenderbuffer(Z.__webglDepthRenderbuffer)}let fe=J.textures;for(let Fe=0,Ve=fe.length;Fe<Ve;Fe++){let ze=n.get(fe[Fe]);ze.__webglTexture&&(t.deleteTexture(ze.__webglTexture),o.memory.textures--),n.remove(fe[Fe])}n.remove(J)}let B=0;function L(){B=0}function R(){let J=B;return J>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+J+" texture units while this GPU supports only "+i.maxTextures),B+=1,J}function T(J){let Z=[];return Z.push(J.wrapS),Z.push(J.wrapT),Z.push(J.wrapR||0),Z.push(J.magFilter),Z.push(J.minFilter),Z.push(J.anisotropy),Z.push(J.internalFormat),Z.push(J.format),Z.push(J.type),Z.push(J.generateMipmaps),Z.push(J.premultiplyAlpha),Z.push(J.flipY),Z.push(J.unpackAlignment),Z.push(J.colorSpace),Z.join()}function N(J,Z){let fe=n.get(J);if(J.isVideoTexture&&Ne(J),J.isRenderTargetTexture===!1&&J.version>0&&fe.__version!==J.version){let Fe=J.image;if(Fe===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Fe.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{le(fe,J,Z);return}}r.bindTexture(t.TEXTURE_2D,fe.__webglTexture,t.TEXTURE0+Z)}function $(J,Z){let fe=n.get(J);if(J.version>0&&fe.__version!==J.version){le(fe,J,Z);return}r.bindTexture(t.TEXTURE_2D_ARRAY,fe.__webglTexture,t.TEXTURE0+Z)}function V(J,Z){let fe=n.get(J);if(J.version>0&&fe.__version!==J.version){le(fe,J,Z);return}r.bindTexture(t.TEXTURE_3D,fe.__webglTexture,t.TEXTURE0+Z)}function G(J,Z){let fe=n.get(J);if(J.version>0&&fe.__version!==J.version){_e(fe,J,Z);return}r.bindTexture(t.TEXTURE_CUBE_MAP,fe.__webglTexture,t.TEXTURE0+Z)}let ee={[Ml]:t.REPEAT,[hp]:t.CLAMP_TO_EDGE,[YI]:t.MIRRORED_REPEAT},ie={[gs]:t.NEAREST,[Kne]:t.NEAREST_MIPMAP_NEAREST,[$_]:t.NEAREST_MIPMAP_LINEAR,[vu]:t.LINEAR,[IS]:t.LINEAR_MIPMAP_NEAREST,[dp]:t.LINEAR_MIPMAP_LINEAR},me={[aie]:t.NEVER,[hie]:t.ALWAYS,[oie]:t.LESS,[H9]:t.LEQUAL,[sie]:t.EQUAL,[cie]:t.GEQUAL,[lie]:t.GREATER,[uie]:t.NOTEQUAL};function Me(J,Z){if(Z.type===ps&&e.has("OES_texture_float_linear")===!1&&(Z.magFilter===vu||Z.magFilter===IS||Z.magFilter===$_||Z.magFilter===dp||Z.minFilter===vu||Z.minFilter===IS||Z.minFilter===$_||Z.minFilter===dp)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),t.texParameteri(J,t.TEXTURE_WRAP_S,ee[Z.wrapS]),t.texParameteri(J,t.TEXTURE_WRAP_T,ee[Z.wrapT]),(J===t.TEXTURE_3D||J===t.TEXTURE_2D_ARRAY)&&t.texParameteri(J,t.TEXTURE_WRAP_R,ee[Z.wrapR]),t.texParameteri(J,t.TEXTURE_MAG_FILTER,ie[Z.magFilter]),t.texParameteri(J,t.TEXTURE_MIN_FILTER,ie[Z.minFilter]),Z.compareFunction&&(t.texParameteri(J,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(J,t.TEXTURE_COMPARE_FUNC,me[Z.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(Z.magFilter===gs||Z.minFilter!==$_&&Z.minFilter!==dp||Z.type===ps&&e.has("OES_texture_float_linear")===!1)return;if(Z.anisotropy>1||n.get(Z).__currentAnisotropy){let fe=e.get("EXT_texture_filter_anisotropic");t.texParameterf(J,fe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Z.anisotropy,i.getMaxAnisotropy())),n.get(Z).__currentAnisotropy=Z.anisotropy}}}function Ae(J,Z){let fe=!1;J.__webglInit===void 0&&(J.__webglInit=!0,Z.addEventListener("dispose",M));let Fe=Z.source,Ve=d.get(Fe);Ve===void 0&&(Ve={},d.set(Fe,Ve));let ze=T(Z);if(ze!==J.__cacheKey){Ve[ze]===void 0&&(Ve[ze]={texture:t.createTexture(),usedTimes:0},o.memory.textures++,fe=!0),Ve[ze].usedTimes++;let Tt=Ve[J.__cacheKey];Tt!==void 0&&(Ve[J.__cacheKey].usedTimes--,Tt.usedTimes===0&&D(Z)),J.__cacheKey=ze,J.__webglTexture=Ve[ze].texture}return fe}function le(J,Z,fe){let Fe=t.TEXTURE_2D;(Z.isDataArrayTexture||Z.isCompressedArrayTexture)&&(Fe=t.TEXTURE_2D_ARRAY),Z.isData3DTexture&&(Fe=t.TEXTURE_3D);let Ve=Ae(J,Z),ze=Z.source;r.bindTexture(Fe,J.__webglTexture,t.TEXTURE0+fe);let Tt=n.get(ze);if(ze.version!==Tt.__version||Ve===!0){r.activeTexture(t.TEXTURE0+fe);let ft=an.getPrimaries(an.workingColorSpace),St=Z.colorSpace===Zh?null:an.getPrimaries(Z.colorSpace),nr=Z.colorSpace===Zh||ft===St?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,Z.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Z.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,Z.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,nr);let He=y(Z.image,!1,i.maxTextureSize);He=st(Z,He);let Ge=a.convert(Z.format,Z.colorSpace),je=a.convert(Z.type),tt=b(Z.internalFormat,Ge,je,Z.colorSpace,Z.isVideoTexture);Me(Fe,Z);let Ze,At=Z.mipmaps,vt=Z.isVideoTexture!==!0,Kt=Tt.__version===void 0||Ve===!0,he=ze.dataReady,ct=E(Z,He);if(Z.isDepthTexture)tt=A(Z.format===_g,Z.type),Kt&&(vt?r.texStorage2D(t.TEXTURE_2D,1,tt,He.width,He.height):r.texImage2D(t.TEXTURE_2D,0,tt,He.width,He.height,0,Ge,je,null));else if(Z.isDataTexture)if(At.length>0){vt&&Kt&&r.texStorage2D(t.TEXTURE_2D,ct,tt,At[0].width,At[0].height);for(let De=0,qe=At.length;De<qe;De++)Ze=At[De],vt?he&&r.texSubImage2D(t.TEXTURE_2D,De,0,0,Ze.width,Ze.height,Ge,je,Ze.data):r.texImage2D(t.TEXTURE_2D,De,tt,Ze.width,Ze.height,0,Ge,je,Ze.data);Z.generateMipmaps=!1}else vt?(Kt&&r.texStorage2D(t.TEXTURE_2D,ct,tt,He.width,He.height),he&&r.texSubImage2D(t.TEXTURE_2D,0,0,0,He.width,He.height,Ge,je,He.data)):r.texImage2D(t.TEXTURE_2D,0,tt,He.width,He.height,0,Ge,je,He.data);else if(Z.isCompressedTexture)if(Z.isCompressedArrayTexture){vt&&Kt&&r.texStorage3D(t.TEXTURE_2D_ARRAY,ct,tt,At[0].width,At[0].height,He.depth);for(let De=0,qe=At.length;De<qe;De++)if(Ze=At[De],Z.format!==Ha)if(Ge!==null)if(vt){if(he)if(Z.layerUpdates.size>0){let mt=T7(Ze.width,Ze.height,Z.format,Z.type);for(let Et of Z.layerUpdates){let Wt=Ze.data.subarray(Et*mt/Ze.data.BYTES_PER_ELEMENT,(Et+1)*mt/Ze.data.BYTES_PER_ELEMENT);r.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,De,0,0,Et,Ze.width,Ze.height,1,Ge,Wt)}Z.clearLayerUpdates()}else r.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,De,0,0,0,Ze.width,Ze.height,He.depth,Ge,Ze.data)}else r.compressedTexImage3D(t.TEXTURE_2D_ARRAY,De,tt,Ze.width,Ze.height,He.depth,0,Ze.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else vt?he&&r.texSubImage3D(t.TEXTURE_2D_ARRAY,De,0,0,0,Ze.width,Ze.height,He.depth,Ge,je,Ze.data):r.texImage3D(t.TEXTURE_2D_ARRAY,De,tt,Ze.width,Ze.height,He.depth,0,Ge,je,Ze.data)}else{vt&&Kt&&r.texStorage2D(t.TEXTURE_2D,ct,tt,At[0].width,At[0].height);for(let De=0,qe=At.length;De<qe;De++)Ze=At[De],Z.format!==Ha?Ge!==null?vt?he&&r.compressedTexSubImage2D(t.TEXTURE_2D,De,0,0,Ze.width,Ze.height,Ge,Ze.data):r.compressedTexImage2D(t.TEXTURE_2D,De,tt,Ze.width,Ze.height,0,Ze.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):vt?he&&r.texSubImage2D(t.TEXTURE_2D,De,0,0,Ze.width,Ze.height,Ge,je,Ze.data):r.texImage2D(t.TEXTURE_2D,De,tt,Ze.width,Ze.height,0,Ge,je,Ze.data)}else if(Z.isDataArrayTexture)if(vt){if(Kt&&r.texStorage3D(t.TEXTURE_2D_ARRAY,ct,tt,He.width,He.height,He.depth),he)if(Z.layerUpdates.size>0){let De=T7(He.width,He.height,Z.format,Z.type);for(let qe of Z.layerUpdates){let mt=He.data.subarray(qe*De/He.data.BYTES_PER_ELEMENT,(qe+1)*De/He.data.BYTES_PER_ELEMENT);r.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,qe,He.width,He.height,1,Ge,je,mt)}Z.clearLayerUpdates()}else r.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,He.width,He.height,He.depth,Ge,je,He.data)}else r.texImage3D(t.TEXTURE_2D_ARRAY,0,tt,He.width,He.height,He.depth,0,Ge,je,He.data);else if(Z.isData3DTexture)vt?(Kt&&r.texStorage3D(t.TEXTURE_3D,ct,tt,He.width,He.height,He.depth),he&&r.texSubImage3D(t.TEXTURE_3D,0,0,0,0,He.width,He.height,He.depth,Ge,je,He.data)):r.texImage3D(t.TEXTURE_3D,0,tt,He.width,He.height,He.depth,0,Ge,je,He.data);else if(Z.isFramebufferTexture){if(Kt)if(vt)r.texStorage2D(t.TEXTURE_2D,ct,tt,He.width,He.height);else{let De=He.width,qe=He.height;for(let mt=0;mt<ct;mt++)r.texImage2D(t.TEXTURE_2D,mt,tt,De,qe,0,Ge,je,null),De>>=1,qe>>=1}}else if(At.length>0){if(vt&&Kt){let De=Ke(At[0]);r.texStorage2D(t.TEXTURE_2D,ct,tt,De.width,De.height)}for(let De=0,qe=At.length;De<qe;De++)Ze=At[De],vt?he&&r.texSubImage2D(t.TEXTURE_2D,De,0,0,Ge,je,Ze):r.texImage2D(t.TEXTURE_2D,De,tt,Ge,je,Ze);Z.generateMipmaps=!1}else if(vt){if(Kt){let De=Ke(He);r.texStorage2D(t.TEXTURE_2D,ct,tt,De.width,De.height)}he&&r.texSubImage2D(t.TEXTURE_2D,0,0,0,Ge,je,He)}else r.texImage2D(t.TEXTURE_2D,0,tt,Ge,je,He);v(Z)&&_(Fe),Tt.__version=ze.version,Z.onUpdate&&Z.onUpdate(Z)}J.__version=Z.version}function _e(J,Z,fe){if(Z.image.length!==6)return;let Fe=Ae(J,Z),Ve=Z.source;r.bindTexture(t.TEXTURE_CUBE_MAP,J.__webglTexture,t.TEXTURE0+fe);let ze=n.get(Ve);if(Ve.version!==ze.__version||Fe===!0){r.activeTexture(t.TEXTURE0+fe);let Tt=an.getPrimaries(an.workingColorSpace),ft=Z.colorSpace===Zh?null:an.getPrimaries(Z.colorSpace),St=Z.colorSpace===Zh||Tt===ft?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,Z.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Z.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,Z.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,St);let nr=Z.isCompressedTexture||Z.image[0].isCompressedTexture,He=Z.image[0]&&Z.image[0].isDataTexture,Ge=[];for(let qe=0;qe<6;qe++)!nr&&!He?Ge[qe]=y(Z.image[qe],!0,i.maxCubemapSize):Ge[qe]=He?Z.image[qe].image:Z.image[qe],Ge[qe]=st(Z,Ge[qe]);let je=Ge[0],tt=a.convert(Z.format,Z.colorSpace),Ze=a.convert(Z.type),At=b(Z.internalFormat,tt,Ze,Z.colorSpace),vt=Z.isVideoTexture!==!0,Kt=ze.__version===void 0||Fe===!0,he=Ve.dataReady,ct=E(Z,je);Me(t.TEXTURE_CUBE_MAP,Z);let De;if(nr){vt&&Kt&&r.texStorage2D(t.TEXTURE_CUBE_MAP,ct,At,je.width,je.height);for(let qe=0;qe<6;qe++){De=Ge[qe].mipmaps;for(let mt=0;mt<De.length;mt++){let Et=De[mt];Z.format!==Ha?tt!==null?vt?he&&r.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+qe,mt,0,0,Et.width,Et.height,tt,Et.data):r.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+qe,mt,At,Et.width,Et.height,0,Et.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):vt?he&&r.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+qe,mt,0,0,Et.width,Et.height,tt,Ze,Et.data):r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+qe,mt,At,Et.width,Et.height,0,tt,Ze,Et.data)}}}else{if(De=Z.mipmaps,vt&&Kt){De.length>0&&ct++;let qe=Ke(Ge[0]);r.texStorage2D(t.TEXTURE_CUBE_MAP,ct,At,qe.width,qe.height)}for(let qe=0;qe<6;qe++)if(He){vt?he&&r.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+qe,0,0,0,Ge[qe].width,Ge[qe].height,tt,Ze,Ge[qe].data):r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+qe,0,At,Ge[qe].width,Ge[qe].height,0,tt,Ze,Ge[qe].data);for(let mt=0;mt<De.length;mt++){let Et=De[mt].image[qe].image;vt?he&&r.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+qe,mt+1,0,0,Et.width,Et.height,tt,Ze,Et.data):r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+qe,mt+1,At,Et.width,Et.height,0,tt,Ze,Et.data)}}else{vt?he&&r.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+qe,0,0,0,tt,Ze,Ge[qe]):r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+qe,0,At,tt,Ze,Ge[qe]);for(let mt=0;mt<De.length;mt++){let Et=De[mt];vt?he&&r.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+qe,mt+1,0,0,tt,Ze,Et.image[qe]):r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+qe,mt+1,At,tt,Ze,Et.image[qe])}}}v(Z)&&_(t.TEXTURE_CUBE_MAP),ze.__version=Ve.version,Z.onUpdate&&Z.onUpdate(Z)}J.__version=Z.version}function Le(J,Z,fe,Fe,Ve,ze){let Tt=a.convert(fe.format,fe.colorSpace),ft=a.convert(fe.type),St=b(fe.internalFormat,Tt,ft,fe.colorSpace),nr=n.get(Z),He=n.get(fe);if(He.__renderTarget=Z,!nr.__hasExternalTextures){let Ge=Math.max(1,Z.width>>ze),je=Math.max(1,Z.height>>ze);Ve===t.TEXTURE_3D||Ve===t.TEXTURE_2D_ARRAY?r.texImage3D(Ve,ze,St,Ge,je,Z.depth,0,Tt,ft,null):r.texImage2D(Ve,ze,St,Ge,je,0,Tt,ft,null)}r.bindFramebuffer(t.FRAMEBUFFER,J),Ee(Z)?s.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,Fe,Ve,He.__webglTexture,0,Ce(Z)):(Ve===t.TEXTURE_2D||Ve>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&Ve<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,Fe,Ve,He.__webglTexture,ze),r.bindFramebuffer(t.FRAMEBUFFER,null)}function Se(J,Z,fe){if(t.bindRenderbuffer(t.RENDERBUFFER,J),Z.depthBuffer){let Fe=Z.depthTexture,Ve=Fe&&Fe.isDepthTexture?Fe.type:null,ze=A(Z.stencilBuffer,Ve),Tt=Z.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,ft=Ce(Z);Ee(Z)?s.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,ft,ze,Z.width,Z.height):fe?t.renderbufferStorageMultisample(t.RENDERBUFFER,ft,ze,Z.width,Z.height):t.renderbufferStorage(t.RENDERBUFFER,ze,Z.width,Z.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,Tt,t.RENDERBUFFER,J)}else{let Fe=Z.textures;for(let Ve=0;Ve<Fe.length;Ve++){let ze=Fe[Ve],Tt=a.convert(ze.format,ze.colorSpace),ft=a.convert(ze.type),St=b(ze.internalFormat,Tt,ft,ze.colorSpace),nr=Ce(Z);fe&&Ee(Z)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,nr,St,Z.width,Z.height):Ee(Z)?s.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,nr,St,Z.width,Z.height):t.renderbufferStorage(t.RENDERBUFFER,St,Z.width,Z.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function Ue(J,Z){if(Z&&Z.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(t.FRAMEBUFFER,J),!(Z.depthTexture&&Z.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");let fe=n.get(Z.depthTexture);fe.__renderTarget=Z,(!fe.__webglTexture||Z.depthTexture.image.width!==Z.width||Z.depthTexture.image.height!==Z.height)&&(Z.depthTexture.image.width=Z.width,Z.depthTexture.image.height=Z.height,Z.depthTexture.needsUpdate=!0),N(Z.depthTexture,0);let Fe=fe.__webglTexture,Ve=Ce(Z);if(Z.depthTexture.format===Ym)Ee(Z)?s.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,Fe,0,Ve):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,Fe,0);else if(Z.depthTexture.format===_g)Ee(Z)?s.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,Fe,0,Ve):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,Fe,0);else throw new Error("Unknown depthTexture format")}function Y(J){let Z=n.get(J),fe=J.isWebGLCubeRenderTarget===!0;if(Z.__boundDepthTexture!==J.depthTexture){let Fe=J.depthTexture;if(Z.__depthDisposeCallback&&Z.__depthDisposeCallback(),Fe){let Ve=()=>{delete Z.__boundDepthTexture,delete Z.__depthDisposeCallback,Fe.removeEventListener("dispose",Ve)};Fe.addEventListener("dispose",Ve),Z.__depthDisposeCallback=Ve}Z.__boundDepthTexture=Fe}if(J.depthTexture&&!Z.__autoAllocateDepthBuffer){if(fe)throw new Error("target.depthTexture not supported in Cube render targets");Ue(Z.__webglFramebuffer,J)}else if(fe){Z.__webglDepthbuffer=[];for(let Fe=0;Fe<6;Fe++)if(r.bindFramebuffer(t.FRAMEBUFFER,Z.__webglFramebuffer[Fe]),Z.__webglDepthbuffer[Fe]===void 0)Z.__webglDepthbuffer[Fe]=t.createRenderbuffer(),Se(Z.__webglDepthbuffer[Fe],J,!1);else{let Ve=J.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,ze=Z.__webglDepthbuffer[Fe];t.bindRenderbuffer(t.RENDERBUFFER,ze),t.framebufferRenderbuffer(t.FRAMEBUFFER,Ve,t.RENDERBUFFER,ze)}}else if(r.bindFramebuffer(t.FRAMEBUFFER,Z.__webglFramebuffer),Z.__webglDepthbuffer===void 0)Z.__webglDepthbuffer=t.createRenderbuffer(),Se(Z.__webglDepthbuffer,J,!1);else{let Fe=J.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Ve=Z.__webglDepthbuffer;t.bindRenderbuffer(t.RENDERBUFFER,Ve),t.framebufferRenderbuffer(t.FRAMEBUFFER,Fe,t.RENDERBUFFER,Ve)}r.bindFramebuffer(t.FRAMEBUFFER,null)}function we(J,Z,fe){let Fe=n.get(J);Z!==void 0&&Le(Fe.__webglFramebuffer,J,J.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),fe!==void 0&&Y(J)}function q(J){let Z=J.texture,fe=n.get(J),Fe=n.get(Z);J.addEventListener("dispose",P);let Ve=J.textures,ze=J.isWebGLCubeRenderTarget===!0,Tt=Ve.length>1;if(Tt||(Fe.__webglTexture===void 0&&(Fe.__webglTexture=t.createTexture()),Fe.__version=Z.version,o.memory.textures++),ze){fe.__webglFramebuffer=[];for(let ft=0;ft<6;ft++)if(Z.mipmaps&&Z.mipmaps.length>0){fe.__webglFramebuffer[ft]=[];for(let St=0;St<Z.mipmaps.length;St++)fe.__webglFramebuffer[ft][St]=t.createFramebuffer()}else fe.__webglFramebuffer[ft]=t.createFramebuffer()}else{if(Z.mipmaps&&Z.mipmaps.length>0){fe.__webglFramebuffer=[];for(let ft=0;ft<Z.mipmaps.length;ft++)fe.__webglFramebuffer[ft]=t.createFramebuffer()}else fe.__webglFramebuffer=t.createFramebuffer();if(Tt)for(let ft=0,St=Ve.length;ft<St;ft++){let nr=n.get(Ve[ft]);nr.__webglTexture===void 0&&(nr.__webglTexture=t.createTexture(),o.memory.textures++)}if(J.samples>0&&Ee(J)===!1){fe.__webglMultisampledFramebuffer=t.createFramebuffer(),fe.__webglColorRenderbuffer=[],r.bindFramebuffer(t.FRAMEBUFFER,fe.__webglMultisampledFramebuffer);for(let ft=0;ft<Ve.length;ft++){let St=Ve[ft];fe.__webglColorRenderbuffer[ft]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,fe.__webglColorRenderbuffer[ft]);let nr=a.convert(St.format,St.colorSpace),He=a.convert(St.type),Ge=b(St.internalFormat,nr,He,St.colorSpace,J.isXRRenderTarget===!0),je=Ce(J);t.renderbufferStorageMultisample(t.RENDERBUFFER,je,Ge,J.width,J.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+ft,t.RENDERBUFFER,fe.__webglColorRenderbuffer[ft])}t.bindRenderbuffer(t.RENDERBUFFER,null),J.depthBuffer&&(fe.__webglDepthRenderbuffer=t.createRenderbuffer(),Se(fe.__webglDepthRenderbuffer,J,!0)),r.bindFramebuffer(t.FRAMEBUFFER,null)}}if(ze){r.bindTexture(t.TEXTURE_CUBE_MAP,Fe.__webglTexture),Me(t.TEXTURE_CUBE_MAP,Z);for(let ft=0;ft<6;ft++)if(Z.mipmaps&&Z.mipmaps.length>0)for(let St=0;St<Z.mipmaps.length;St++)Le(fe.__webglFramebuffer[ft][St],J,Z,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+ft,St);else Le(fe.__webglFramebuffer[ft],J,Z,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+ft,0);v(Z)&&_(t.TEXTURE_CUBE_MAP),r.unbindTexture()}else if(Tt){for(let ft=0,St=Ve.length;ft<St;ft++){let nr=Ve[ft],He=n.get(nr);r.bindTexture(t.TEXTURE_2D,He.__webglTexture),Me(t.TEXTURE_2D,nr),Le(fe.__webglFramebuffer,J,nr,t.COLOR_ATTACHMENT0+ft,t.TEXTURE_2D,0),v(nr)&&_(t.TEXTURE_2D)}r.unbindTexture()}else{let ft=t.TEXTURE_2D;if((J.isWebGL3DRenderTarget||J.isWebGLArrayRenderTarget)&&(ft=J.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),r.bindTexture(ft,Fe.__webglTexture),Me(ft,Z),Z.mipmaps&&Z.mipmaps.length>0)for(let St=0;St<Z.mipmaps.length;St++)Le(fe.__webglFramebuffer[St],J,Z,t.COLOR_ATTACHMENT0,ft,St);else Le(fe.__webglFramebuffer,J,Z,t.COLOR_ATTACHMENT0,ft,0);v(Z)&&_(ft),r.unbindTexture()}J.depthBuffer&&Y(J)}function oe(J){let Z=J.textures;for(let fe=0,Fe=Z.length;fe<Fe;fe++){let Ve=Z[fe];if(v(Ve)){let ze=w(J),Tt=n.get(Ve).__webglTexture;r.bindTexture(ze,Tt),_(ze),r.unbindTexture()}}}let ce=[],X=[];function ke(J){if(J.samples>0){if(Ee(J)===!1){let Z=J.textures,fe=J.width,Fe=J.height,Ve=t.COLOR_BUFFER_BIT,ze=J.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Tt=n.get(J),ft=Z.length>1;if(ft)for(let St=0;St<Z.length;St++)r.bindFramebuffer(t.FRAMEBUFFER,Tt.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+St,t.RENDERBUFFER,null),r.bindFramebuffer(t.FRAMEBUFFER,Tt.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+St,t.TEXTURE_2D,null,0);r.bindFramebuffer(t.READ_FRAMEBUFFER,Tt.__webglMultisampledFramebuffer),r.bindFramebuffer(t.DRAW_FRAMEBUFFER,Tt.__webglFramebuffer);for(let St=0;St<Z.length;St++){if(J.resolveDepthBuffer&&(J.depthBuffer&&(Ve|=t.DEPTH_BUFFER_BIT),J.stencilBuffer&&J.resolveStencilBuffer&&(Ve|=t.STENCIL_BUFFER_BIT)),ft){t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,Tt.__webglColorRenderbuffer[St]);let nr=n.get(Z[St]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,nr,0)}t.blitFramebuffer(0,0,fe,Fe,0,0,fe,Fe,Ve,t.NEAREST),l===!0&&(ce.length=0,X.length=0,ce.push(t.COLOR_ATTACHMENT0+St),J.depthBuffer&&J.resolveDepthBuffer===!1&&(ce.push(ze),X.push(ze),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,X)),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,ce))}if(r.bindFramebuffer(t.READ_FRAMEBUFFER,null),r.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),ft)for(let St=0;St<Z.length;St++){r.bindFramebuffer(t.FRAMEBUFFER,Tt.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+St,t.RENDERBUFFER,Tt.__webglColorRenderbuffer[St]);let nr=n.get(Z[St]).__webglTexture;r.bindFramebuffer(t.FRAMEBUFFER,Tt.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+St,t.TEXTURE_2D,nr,0)}r.bindFramebuffer(t.DRAW_FRAMEBUFFER,Tt.__webglMultisampledFramebuffer)}else if(J.depthBuffer&&J.resolveDepthBuffer===!1&&l){let Z=J.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[Z])}}}function Ce(J){return Math.min(i.maxSamples,J.samples)}function Ee(J){let Z=n.get(J);return J.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&Z.__useRenderToTexture!==!1}function Ne(J){let Z=o.render.frame;c.get(J)!==Z&&(c.set(J,Z),J.update())}function st(J,Z){let fe=J.colorSpace,Fe=J.format,Ve=J.type;return J.isCompressedTexture===!0||J.isVideoTexture===!0||fe!==Op&&fe!==Zh&&(an.getTransfer(fe)===En?(Fe!==Ha||Ve!==Fl)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",fe)),Z}function Ke(J){return typeof HTMLImageElement<"u"&&J instanceof HTMLImageElement?(u.width=J.naturalWidth||J.width,u.height=J.naturalHeight||J.height):typeof VideoFrame<"u"&&J instanceof VideoFrame?(u.width=J.displayWidth,u.height=J.displayHeight):(u.width=J.width,u.height=J.height),u}this.allocateTextureUnit=R,this.resetTextureUnits=L,this.setTexture2D=N,this.setTexture2DArray=$,this.setTexture3D=V,this.setTextureCube=G,this.rebindTextures=we,this.setupRenderTarget=q,this.updateRenderTargetMipmap=oe,this.updateMultisampleRenderTarget=ke,this.setupDepthRenderbuffer=Y,this.setupFrameBufferTexture=Le,this.useMultisampledRTT=Ee}function qce(t,e){function r(n,i=Zh){let a,o=an.getTransfer(i);if(n===Fl)return t.UNSIGNED_BYTE;if(n===dP)return t.UNSIGNED_SHORT_4_4_4_4;if(n===pP)return t.UNSIGNED_SHORT_5_5_5_1;if(n===N9)return t.UNSIGNED_INT_5_9_9_9_REV;if(n===R9)return t.BYTE;if(n===L9)return t.SHORT;if(n===Yv)return t.UNSIGNED_SHORT;if(n===hP)return t.INT;if(n===id)return t.UNSIGNED_INT;if(n===ps)return t.FLOAT;if(n===$1)return t.HALF_FLOAT;if(n===$9)return t.ALPHA;if(n===U9)return t.RGB;if(n===Ha)return t.RGBA;if(n===j9)return t.LUMINANCE;if(n===V9)return t.LUMINANCE_ALPHA;if(n===Ym)return t.DEPTH_COMPONENT;if(n===_g)return t.DEPTH_STENCIL;if(n===fP)return t.RED;if(n===AA)return t.RED_INTEGER;if(n===G9)return t.RG;if(n===mP)return t.RG_INTEGER;if(n===gP)return t.RGBA_INTEGER;if(n===Ob||n===Bb||n===zb||n===Fb)if(o===En)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(n===Ob)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Bb)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===zb)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Fb)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(n===Ob)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Bb)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===zb)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Fb)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===JI||n===KI||n===QI||n===eC)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(n===JI)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===KI)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===QI)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===eC)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===tC||n===rC||n===nC)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(n===tC||n===rC)return o===En?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(n===nC)return o===En?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===iC||n===aC||n===oC||n===sC||n===lC||n===uC||n===cC||n===hC||n===dC||n===pC||n===fC||n===mC||n===gC||n===yC)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(n===iC)return o===En?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===aC)return o===En?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===oC)return o===En?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===sC)return o===En?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===lC)return o===En?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===uC)return o===En?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===cC)return o===En?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===hC)return o===En?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===dC)return o===En?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===pC)return o===En?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===fC)return o===En?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===mC)return o===En?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===gC)return o===En?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===yC)return o===En?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===Rb||n===vC||n===_C)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(n===Rb)return o===En?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===vC)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===_C)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===Z9||n===xC||n===bC||n===wC)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(n===Rb)return a.COMPRESSED_RED_RGTC1_EXT;if(n===xC)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===bC)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===wC)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===vg?t.UNSIGNED_INT_24_8:t[n]!==void 0?t[n]:null}return{convert:r}}var Yce=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,Jce=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`,Kce=class{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,r,n){if(this.texture===null){let i=new Ho,a=e.properties.get(i);a.__webglTexture=r.texture,(r.depthNear!==n.depthNear||r.depthFar!==n.depthFar)&&(this.depthNear=r.depthNear,this.depthFar=r.depthFar),this.texture=i}}getMesh(e){if(this.texture!==null&&this.mesh===null){let r=e.cameras[0].viewport,n=new ys({vertexShader:Yce,fragmentShader:Jce,uniforms:{depthColor:{value:this.texture},depthWidth:{value:r.z},depthHeight:{value:r.w}}});this.mesh=new Er(new yd(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}},Qce=class extends c0{constructor(e,r){super();let n=this,i=null,a=1,o=null,s="local-floor",l=1,u=null,c=null,h=null,d=null,p=null,m=null,y=new Kce,v=r.getContextAttributes(),_=null,w=null,b=[],A=[],E=new Je,M=null,P=new co;P.viewport=new _n;let k=new co;k.viewport=new _n;let D=[P,k],O=new hoe,B=null,L=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(le){let _e=b[le];return _e===void 0&&(_e=new qS,b[le]=_e),_e.getTargetRaySpace()},this.getControllerGrip=function(le){let _e=b[le];return _e===void 0&&(_e=new qS,b[le]=_e),_e.getGripSpace()},this.getHand=function(le){let _e=b[le];return _e===void 0&&(_e=new qS,b[le]=_e),_e.getHandSpace()};function R(le){let _e=A.indexOf(le.inputSource);if(_e===-1)return;let Le=b[_e];Le!==void 0&&(Le.update(le.inputSource,le.frame,u||o),Le.dispatchEvent({type:le.type,data:le.inputSource}))}function T(){i.removeEventListener("select",R),i.removeEventListener("selectstart",R),i.removeEventListener("selectend",R),i.removeEventListener("squeeze",R),i.removeEventListener("squeezestart",R),i.removeEventListener("squeezeend",R),i.removeEventListener("end",T),i.removeEventListener("inputsourceschange",N);for(let le=0;le<b.length;le++){let _e=A[le];_e!==null&&(A[le]=null,b[le].disconnect(_e))}B=null,L=null,y.reset(),e.setRenderTarget(_),p=null,d=null,h=null,i=null,w=null,Ae.stop(),n.isPresenting=!1,e.setPixelRatio(M),e.setSize(E.width,E.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(le){a=le,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(le){s=le,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||o},this.setReferenceSpace=function(le){u=le},this.getBaseLayer=function(){return d!==null?d:p},this.getBinding=function(){return h},this.getFrame=function(){return m},this.getSession=function(){return i},this.setSession=async function(le){if(i=le,i!==null){if(_=e.getRenderTarget(),i.addEventListener("select",R),i.addEventListener("selectstart",R),i.addEventListener("selectend",R),i.addEventListener("squeeze",R),i.addEventListener("squeezestart",R),i.addEventListener("squeezeend",R),i.addEventListener("end",T),i.addEventListener("inputsourceschange",N),v.xrCompatible!==!0&&await r.makeXRCompatible(),M=e.getPixelRatio(),e.getSize(E),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let _e=null,Le=null,Se=null;v.depth&&(Se=v.stencil?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24,_e=v.stencil?_g:Ym,Le=v.stencil?vg:id);let Ue={colorFormat:r.RGBA8,depthFormat:Se,scaleFactor:a};h=new XRWebGLBinding(i,r),d=h.createProjectionLayer(Ue),i.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),w=new ad(d.textureWidth,d.textureHeight,{format:Ha,type:Fl,depthTexture:new pN(d.textureWidth,d.textureHeight,Le,void 0,void 0,void 0,void 0,void 0,void 0,_e),stencilBuffer:v.stencil,colorSpace:e.outputColorSpace,samples:v.antialias?4:0,resolveDepthBuffer:d.ignoreDepthValues===!1})}else{let _e={antialias:v.antialias,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:a};p=new XRWebGLLayer(i,r,_e),i.updateRenderState({baseLayer:p}),e.setPixelRatio(1),e.setSize(p.framebufferWidth,p.framebufferHeight,!1),w=new ad(p.framebufferWidth,p.framebufferHeight,{format:Ha,type:Fl,colorSpace:e.outputColorSpace,stencilBuffer:v.stencil})}w.isXRRenderTarget=!0,this.setFoveation(l),u=null,o=await i.requestReferenceSpace(s),Ae.setContext(i),Ae.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode},this.getDepthTexture=function(){return y.getDepthTexture()};function N(le){for(let _e=0;_e<le.removed.length;_e++){let Le=le.removed[_e],Se=A.indexOf(Le);Se>=0&&(A[Se]=null,b[Se].disconnect(Le))}for(let _e=0;_e<le.added.length;_e++){let Le=le.added[_e],Se=A.indexOf(Le);if(Se===-1){for(let Y=0;Y<b.length;Y++)if(Y>=A.length){A.push(Le),Se=Y;break}else if(A[Y]===null){A[Y]=Le,Se=Y;break}if(Se===-1)break}let Ue=b[Se];Ue&&Ue.connect(Le)}}let $=new Q,V=new Q;function G(le,_e,Le){$.setFromMatrixPosition(_e.matrixWorld),V.setFromMatrixPosition(Le.matrixWorld);let Se=$.distanceTo(V),Ue=_e.projectionMatrix.elements,Y=Le.projectionMatrix.elements,we=Ue[14]/(Ue[10]-1),q=Ue[14]/(Ue[10]+1),oe=(Ue[9]+1)/Ue[5],ce=(Ue[9]-1)/Ue[5],X=(Ue[8]-1)/Ue[0],ke=(Y[8]+1)/Y[0],Ce=we*X,Ee=we*ke,Ne=Se/(-X+ke),st=Ne*-X;if(_e.matrixWorld.decompose(le.position,le.quaternion,le.scale),le.translateX(st),le.translateZ(Ne),le.matrixWorld.compose(le.position,le.quaternion,le.scale),le.matrixWorldInverse.copy(le.matrixWorld).invert(),Ue[10]===-1)le.projectionMatrix.copy(_e.projectionMatrix),le.projectionMatrixInverse.copy(_e.projectionMatrixInverse);else{let Ke=we+Ne,J=q+Ne,Z=Ce-st,fe=Ee+(Se-st),Fe=oe*q/J*Ke,Ve=ce*q/J*Ke;le.projectionMatrix.makePerspective(Z,fe,Fe,Ve,Ke,J),le.projectionMatrixInverse.copy(le.projectionMatrix).invert()}}function ee(le,_e){_e===null?le.matrixWorld.copy(le.matrix):le.matrixWorld.multiplyMatrices(_e.matrixWorld,le.matrix),le.matrixWorldInverse.copy(le.matrixWorld).invert()}this.updateCamera=function(le){if(i===null)return;let _e=le.near,Le=le.far;y.texture!==null&&(y.depthNear>0&&(_e=y.depthNear),y.depthFar>0&&(Le=y.depthFar)),O.near=k.near=P.near=_e,O.far=k.far=P.far=Le,(B!==O.near||L!==O.far)&&(i.updateRenderState({depthNear:O.near,depthFar:O.far}),B=O.near,L=O.far),P.layers.mask=le.layers.mask|2,k.layers.mask=le.layers.mask|4,O.layers.mask=P.layers.mask|k.layers.mask;let Se=le.parent,Ue=O.cameras;ee(O,Se);for(let Y=0;Y<Ue.length;Y++)ee(Ue[Y],Se);Ue.length===2?G(O,P,k):O.projectionMatrix.copy(P.projectionMatrix),ie(le,O,Se)};function ie(le,_e,Le){Le===null?le.matrix.copy(_e.matrixWorld):(le.matrix.copy(Le.matrixWorld),le.matrix.invert(),le.matrix.multiply(_e.matrixWorld)),le.matrix.decompose(le.position,le.quaternion,le.scale),le.updateMatrixWorld(!0),le.projectionMatrix.copy(_e.projectionMatrix),le.projectionMatrixInverse.copy(_e.projectionMatrixInverse),le.isPerspectiveCamera&&(le.fov=xg*2*Math.atan(1/le.projectionMatrix.elements[5]),le.zoom=1)}this.getCamera=function(){return O},this.getFoveation=function(){if(!(d===null&&p===null))return l},this.setFoveation=function(le){l=le,d!==null&&(d.fixedFoveation=le),p!==null&&p.fixedFoveation!==void 0&&(p.fixedFoveation=le)},this.hasDepthSensing=function(){return y.texture!==null},this.getDepthSensingMesh=function(){return y.getMesh(O)};let me=null;function Me(le,_e){if(c=_e.getViewerPose(u||o),m=_e,c!==null){let Le=c.views;p!==null&&(e.setRenderTargetFramebuffer(w,p.framebuffer),e.setRenderTarget(w));let Se=!1;Le.length!==O.cameras.length&&(O.cameras.length=0,Se=!0);for(let Y=0;Y<Le.length;Y++){let we=Le[Y],q=null;if(p!==null)q=p.getViewport(we);else{let ce=h.getViewSubImage(d,we);q=ce.viewport,Y===0&&(e.setRenderTargetTextures(w,ce.colorTexture,d.ignoreDepthValues?void 0:ce.depthStencilTexture),e.setRenderTarget(w))}let oe=D[Y];oe===void 0&&(oe=new co,oe.layers.enable(Y),oe.viewport=new _n,D[Y]=oe),oe.matrix.fromArray(we.transform.matrix),oe.matrix.decompose(oe.position,oe.quaternion,oe.scale),oe.projectionMatrix.fromArray(we.projectionMatrix),oe.projectionMatrixInverse.copy(oe.projectionMatrix).invert(),oe.viewport.set(q.x,q.y,q.width,q.height),Y===0&&(O.matrix.copy(oe.matrix),O.matrix.decompose(O.position,O.quaternion,O.scale)),Se===!0&&O.cameras.push(oe)}let Ue=i.enabledFeatures;if(Ue&&Ue.includes("depth-sensing")&&i.depthUsage=="gpu-optimized"&&h){let Y=h.getDepthInformation(Le[0]);Y&&Y.isValid&&Y.texture&&y.init(e,Y,i.renderState)}}for(let Le=0;Le<b.length;Le++){let Se=A[Le],Ue=b[Le];Se!==null&&Ue!==void 0&&Ue.update(Se,_e,u||o)}me&&me(le,_e),_e.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:_e}),m=null}let Ae=new ON;Ae.setAnimationLoop(Me),this.setAnimationLoop=function(le){me=le},this.dispose=function(){}}},Ld=new Vo,ehe=new gr;function the(t,e){function r(v,_){v.matrixAutoUpdate===!0&&v.updateMatrix(),_.value.copy(v.matrix)}function n(v,_){_.color.getRGB(v.fogColor.value,sN(t)),_.isFog?(v.fogNear.value=_.near,v.fogFar.value=_.far):_.isFogExp2&&(v.fogDensity.value=_.density)}function i(v,_,w,b,A){_.isMeshBasicMaterial||_.isMeshLambertMaterial?a(v,_):_.isMeshToonMaterial?(a(v,_),h(v,_)):_.isMeshPhongMaterial?(a(v,_),c(v,_)):_.isMeshStandardMaterial?(a(v,_),d(v,_),_.isMeshPhysicalMaterial&&p(v,_,A)):_.isMeshMatcapMaterial?(a(v,_),m(v,_)):_.isMeshDepthMaterial?a(v,_):_.isMeshDistanceMaterial?(a(v,_),y(v,_)):_.isMeshNormalMaterial?a(v,_):_.isLineBasicMaterial?(o(v,_),_.isLineDashedMaterial&&s(v,_)):_.isPointsMaterial?l(v,_,w,b):_.isSpriteMaterial?u(v,_):_.isShadowMaterial?(v.color.value.copy(_.color),v.opacity.value=_.opacity):_.isShaderMaterial&&(_.uniformsNeedUpdate=!1)}function a(v,_){v.opacity.value=_.opacity,_.color&&v.diffuse.value.copy(_.color),_.emissive&&v.emissive.value.copy(_.emissive).multiplyScalar(_.emissiveIntensity),_.map&&(v.map.value=_.map,r(_.map,v.mapTransform)),_.alphaMap&&(v.alphaMap.value=_.alphaMap,r(_.alphaMap,v.alphaMapTransform)),_.bumpMap&&(v.bumpMap.value=_.bumpMap,r(_.bumpMap,v.bumpMapTransform),v.bumpScale.value=_.bumpScale,_.side===xa&&(v.bumpScale.value*=-1)),_.normalMap&&(v.normalMap.value=_.normalMap,r(_.normalMap,v.normalMapTransform),v.normalScale.value.copy(_.normalScale),_.side===xa&&v.normalScale.value.negate()),_.displacementMap&&(v.displacementMap.value=_.displacementMap,r(_.displacementMap,v.displacementMapTransform),v.displacementScale.value=_.displacementScale,v.displacementBias.value=_.displacementBias),_.emissiveMap&&(v.emissiveMap.value=_.emissiveMap,r(_.emissiveMap,v.emissiveMapTransform)),_.specularMap&&(v.specularMap.value=_.specularMap,r(_.specularMap,v.specularMapTransform)),_.alphaTest>0&&(v.alphaTest.value=_.alphaTest);let w=e.get(_),b=w.envMap,A=w.envMapRotation;b&&(v.envMap.value=b,Ld.copy(A),Ld.x*=-1,Ld.y*=-1,Ld.z*=-1,b.isCubeTexture&&b.isRenderTargetTexture===!1&&(Ld.y*=-1,Ld.z*=-1),v.envMapRotation.value.setFromMatrix4(ehe.makeRotationFromEuler(Ld)),v.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,v.reflectivity.value=_.reflectivity,v.ior.value=_.ior,v.refractionRatio.value=_.refractionRatio),_.lightMap&&(v.lightMap.value=_.lightMap,v.lightMapIntensity.value=_.lightMapIntensity,r(_.lightMap,v.lightMapTransform)),_.aoMap&&(v.aoMap.value=_.aoMap,v.aoMapIntensity.value=_.aoMapIntensity,r(_.aoMap,v.aoMapTransform))}function o(v,_){v.diffuse.value.copy(_.color),v.opacity.value=_.opacity,_.map&&(v.map.value=_.map,r(_.map,v.mapTransform))}function s(v,_){v.dashSize.value=_.dashSize,v.totalSize.value=_.dashSize+_.gapSize,v.scale.value=_.scale}function l(v,_,w,b){v.diffuse.value.copy(_.color),v.opacity.value=_.opacity,v.size.value=_.size*w,v.scale.value=b*.5,_.map&&(v.map.value=_.map,r(_.map,v.uvTransform)),_.alphaMap&&(v.alphaMap.value=_.alphaMap,r(_.alphaMap,v.alphaMapTransform)),_.alphaTest>0&&(v.alphaTest.value=_.alphaTest)}function u(v,_){v.diffuse.value.copy(_.color),v.opacity.value=_.opacity,v.rotation.value=_.rotation,_.map&&(v.map.value=_.map,r(_.map,v.mapTransform)),_.alphaMap&&(v.alphaMap.value=_.alphaMap,r(_.alphaMap,v.alphaMapTransform)),_.alphaTest>0&&(v.alphaTest.value=_.alphaTest)}function c(v,_){v.specular.value.copy(_.specular),v.shininess.value=Math.max(_.shininess,1e-4)}function h(v,_){_.gradientMap&&(v.gradientMap.value=_.gradientMap)}function d(v,_){v.metalness.value=_.metalness,_.metalnessMap&&(v.metalnessMap.value=_.metalnessMap,r(_.metalnessMap,v.metalnessMapTransform)),v.roughness.value=_.roughness,_.roughnessMap&&(v.roughnessMap.value=_.roughnessMap,r(_.roughnessMap,v.roughnessMapTransform)),_.envMap&&(v.envMapIntensity.value=_.envMapIntensity)}function p(v,_,w){v.ior.value=_.ior,_.sheen>0&&(v.sheenColor.value.copy(_.sheenColor).multiplyScalar(_.sheen),v.sheenRoughness.value=_.sheenRoughness,_.sheenColorMap&&(v.sheenColorMap.value=_.sheenColorMap,r(_.sheenColorMap,v.sheenColorMapTransform)),_.sheenRoughnessMap&&(v.sheenRoughnessMap.value=_.sheenRoughnessMap,r(_.sheenRoughnessMap,v.sheenRoughnessMapTransform))),_.clearcoat>0&&(v.clearcoat.value=_.clearcoat,v.clearcoatRoughness.value=_.clearcoatRoughness,_.clearcoatMap&&(v.clearcoatMap.value=_.clearcoatMap,r(_.clearcoatMap,v.clearcoatMapTransform)),_.clearcoatRoughnessMap&&(v.clearcoatRoughnessMap.value=_.clearcoatRoughnessMap,r(_.clearcoatRoughnessMap,v.clearcoatRoughnessMapTransform)),_.clearcoatNormalMap&&(v.clearcoatNormalMap.value=_.clearcoatNormalMap,r(_.clearcoatNormalMap,v.clearcoatNormalMapTransform),v.clearcoatNormalScale.value.copy(_.clearcoatNormalScale),_.side===xa&&v.clearcoatNormalScale.value.negate())),_.dispersion>0&&(v.dispersion.value=_.dispersion),_.iridescence>0&&(v.iridescence.value=_.iridescence,v.iridescenceIOR.value=_.iridescenceIOR,v.iridescenceThicknessMinimum.value=_.iridescenceThicknessRange[0],v.iridescenceThicknessMaximum.value=_.iridescenceThicknessRange[1],_.iridescenceMap&&(v.iridescenceMap.value=_.iridescenceMap,r(_.iridescenceMap,v.iridescenceMapTransform)),_.iridescenceThicknessMap&&(v.iridescenceThicknessMap.value=_.iridescenceThicknessMap,r(_.iridescenceThicknessMap,v.iridescenceThicknessMapTransform))),_.transmission>0&&(v.transmission.value=_.transmission,v.transmissionSamplerMap.value=w.texture,v.transmissionSamplerSize.value.set(w.width,w.height),_.transmissionMap&&(v.transmissionMap.value=_.transmissionMap,r(_.transmissionMap,v.transmissionMapTransform)),v.thickness.value=_.thickness,_.thicknessMap&&(v.thicknessMap.value=_.thicknessMap,r(_.thicknessMap,v.thicknessMapTransform)),v.attenuationDistance.value=_.attenuationDistance,v.attenuationColor.value.copy(_.attenuationColor)),_.anisotropy>0&&(v.anisotropyVector.value.set(_.anisotropy*Math.cos(_.anisotropyRotation),_.anisotropy*Math.sin(_.anisotropyRotation)),_.anisotropyMap&&(v.anisotropyMap.value=_.anisotropyMap,r(_.anisotropyMap,v.anisotropyMapTransform))),v.specularIntensity.value=_.specularIntensity,v.specularColor.value.copy(_.specularColor),_.specularColorMap&&(v.specularColorMap.value=_.specularColorMap,r(_.specularColorMap,v.specularColorMapTransform)),_.specularIntensityMap&&(v.specularIntensityMap.value=_.specularIntensityMap,r(_.specularIntensityMap,v.specularIntensityMapTransform))}function m(v,_){_.matcap&&(v.matcap.value=_.matcap)}function y(v,_){let w=e.get(_).light;v.referencePosition.value.setFromMatrixPosition(w.matrixWorld),v.nearDistance.value=w.shadow.camera.near,v.farDistance.value=w.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:i}}function rhe(t,e,r,n){let i={},a={},o=[],s=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);function l(w,b){let A=b.program;n.uniformBlockBinding(w,A)}function u(w,b){let A=i[w.id];A===void 0&&(m(w),A=c(w),i[w.id]=A,w.addEventListener("dispose",v));let E=b.program;n.updateUBOMapping(w,E);let M=e.render.frame;a[w.id]!==M&&(d(w),a[w.id]=M)}function c(w){let b=h();w.__bindingPointIndex=b;let A=t.createBuffer(),E=w.__size,M=w.usage;return t.bindBuffer(t.UNIFORM_BUFFER,A),t.bufferData(t.UNIFORM_BUFFER,E,M),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,b,A),A}function h(){for(let w=0;w<s;w++)if(o.indexOf(w)===-1)return o.push(w),w;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(w){let b=i[w.id],A=w.uniforms,E=w.__cache;t.bindBuffer(t.UNIFORM_BUFFER,b);for(let M=0,P=A.length;M<P;M++){let k=Array.isArray(A[M])?A[M]:[A[M]];for(let D=0,O=k.length;D<O;D++){let B=k[D];if(p(B,M,D,E)===!0){let L=B.__offset,R=Array.isArray(B.value)?B.value:[B.value],T=0;for(let N=0;N<R.length;N++){let $=R[N],V=y($);typeof $=="number"||typeof $=="boolean"?(B.__data[0]=$,t.bufferSubData(t.UNIFORM_BUFFER,L+T,B.__data)):$.isMatrix3?(B.__data[0]=$.elements[0],B.__data[1]=$.elements[1],B.__data[2]=$.elements[2],B.__data[3]=0,B.__data[4]=$.elements[3],B.__data[5]=$.elements[4],B.__data[6]=$.elements[5],B.__data[7]=0,B.__data[8]=$.elements[6],B.__data[9]=$.elements[7],B.__data[10]=$.elements[8],B.__data[11]=0):($.toArray(B.__data,T),T+=V.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,L,B.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}function p(w,b,A,E){let M=w.value,P=b+"_"+A;if(E[P]===void 0)return typeof M=="number"||typeof M=="boolean"?E[P]=M:E[P]=M.clone(),!0;{let k=E[P];if(typeof M=="number"||typeof M=="boolean"){if(k!==M)return E[P]=M,!0}else if(k.equals(M)===!1)return k.copy(M),!0}return!1}function m(w){let b=w.uniforms,A=0,E=16;for(let P=0,k=b.length;P<k;P++){let D=Array.isArray(b[P])?b[P]:[b[P]];for(let O=0,B=D.length;O<B;O++){let L=D[O],R=Array.isArray(L.value)?L.value:[L.value];for(let T=0,N=R.length;T<N;T++){let $=R[T],V=y($),G=A%E,ee=G%V.boundary,ie=G+ee;A+=ee,ie!==0&&E-ie<V.storage&&(A+=E-ie),L.__data=new Float32Array(V.storage/Float32Array.BYTES_PER_ELEMENT),L.__offset=A,A+=V.storage}}}let M=A%E;return M>0&&(A+=E-M),w.__size=A,w.__cache={},this}function y(w){let b={boundary:0,storage:0};return typeof w=="number"||typeof w=="boolean"?(b.boundary=4,b.storage=4):w.isVector2?(b.boundary=8,b.storage=8):w.isVector3||w.isColor?(b.boundary=16,b.storage=12):w.isVector4?(b.boundary=16,b.storage=16):w.isMatrix3?(b.boundary=48,b.storage=48):w.isMatrix4?(b.boundary=64,b.storage=64):w.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",w),b}function v(w){let b=w.target;b.removeEventListener("dispose",v);let A=o.indexOf(b.__bindingPointIndex);o.splice(A,1),t.deleteBuffer(i[b.id]),delete i[b.id],delete a[b.id]}function _(){for(let w in i)t.deleteBuffer(i[w]);o=[],i={},a={}}return{bind:l,update:u,dispose:_}}var nhe=class{constructor(e={}){let{canvas:r=Mie(),context:n=null,depth:i=!0,stencil:a=!1,alpha:o=!1,antialias:s=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:u=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:h=!1,reverseDepthBuffer:d=!1}=e;this.isWebGLRenderer=!0;let p;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");p=n.getContextAttributes().alpha}else p=o;let m=new Uint32Array(4),y=new Int32Array(4),v=null,_=null,w=[],b=[];this.domElement=r,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Za,this.toneMapping=ed,this.toneMappingExposure=1;let A=this,E=!1,M=0,P=0,k=null,D=-1,O=null,B=new _n,L=new _n,R=null,T=new jt(0),N=0,$=r.width,V=r.height,G=1,ee=null,ie=null,me=new _n(0,0,$,V),Me=new _n(0,0,$,V),Ae=!1,le=new h0,_e=!1,Le=!1;this.transmissionResolutionScale=1;let Se=new gr,Ue=new gr,Y=new Q,we=new _n,q={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0},oe=!1;function ce(){return k===null?G:1}let X=n;function ke(H,pe){return r.getContext(H,pe)}try{let H={alpha:!0,depth:i,stencil:a,antialias:s,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:c,failIfMajorPerformanceCaveat:h};if("setAttribute"in r&&r.setAttribute("data-engine","three.js r".concat(uP)),r.addEventListener("webglcontextlost",qe,!1),r.addEventListener("webglcontextrestored",mt,!1),r.addEventListener("webglcontextcreationerror",Et,!1),X===null){let pe="webgl2";if(X=ke(pe,H),X===null)throw ke(pe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(H){throw console.error("THREE.WebGLRenderer: "+H.message),H}let Ce,Ee,Ne,st,Ke,J,Z,fe,Fe,Ve,ze,Tt,ft,St,nr,He,Ge,je,tt,Ze,At,vt,Kt,he;function ct(){Ce=new pue(X),Ce.init(),vt=new qce(X,Ce),Ee=new sue(X,Ce,e,vt),Ne=new Hce(X,Ce),Ee.reverseDepthBuffer&&d&&Ne.buffers.depth.setReversed(!0),st=new gue(X),Ke=new Bce,J=new Xce(X,Ce,Ne,Ke,Ee,vt,st),Z=new uue(A),fe=new due(A),Fe=new Aoe(X),Kt=new aue(X,Fe),Ve=new fue(X,Fe,st,Kt),ze=new vue(X,Ve,Fe,st),tt=new yue(X,Ee,J),He=new lue(Ke),Tt=new Oce(A,Z,fe,Ce,Ee,Kt,He),ft=new the(A,Ke),St=new Fce,nr=new jce(Ce),je=new iue(A,Z,fe,Ne,ze,p,l),Ge=new Zce(A,ze,Ee),he=new rhe(X,st,Ee,Ne),Ze=new oue(X,Ce,st),At=new mue(X,Ce,st),st.programs=Tt.programs,A.capabilities=Ee,A.extensions=Ce,A.properties=Ke,A.renderLists=St,A.shadowMap=Ge,A.state=Ne,A.info=st}ct();let De=new Qce(A,X);this.xr=De,this.getContext=function(){return X},this.getContextAttributes=function(){return X.getContextAttributes()},this.forceContextLoss=function(){let H=Ce.get("WEBGL_lose_context");H&&H.loseContext()},this.forceContextRestore=function(){let H=Ce.get("WEBGL_lose_context");H&&H.restoreContext()},this.getPixelRatio=function(){return G},this.setPixelRatio=function(H){H!==void 0&&(G=H,this.setSize($,V,!1))},this.getSize=function(H){return H.set($,V)},this.setSize=function(H,pe,be=!0){if(De.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}$=H,V=pe,r.width=Math.floor(H*G),r.height=Math.floor(pe*G),be===!0&&(r.style.width=H+"px",r.style.height=pe+"px"),this.setViewport(0,0,H,pe)},this.getDrawingBufferSize=function(H){return H.set($*G,V*G).floor()},this.setDrawingBufferSize=function(H,pe,be){$=H,V=pe,G=be,r.width=Math.floor(H*be),r.height=Math.floor(pe*be),this.setViewport(0,0,H,pe)},this.getCurrentViewport=function(H){return H.copy(B)},this.getViewport=function(H){return H.copy(me)},this.setViewport=function(H,pe,be,Te){H.isVector4?me.set(H.x,H.y,H.z,H.w):me.set(H,pe,be,Te),Ne.viewport(B.copy(me).multiplyScalar(G).round())},this.getScissor=function(H){return H.copy(Me)},this.setScissor=function(H,pe,be,Te){H.isVector4?Me.set(H.x,H.y,H.z,H.w):Me.set(H,pe,be,Te),Ne.scissor(L.copy(Me).multiplyScalar(G).round())},this.getScissorTest=function(){return Ae},this.setScissorTest=function(H){Ne.setScissorTest(Ae=H)},this.setOpaqueSort=function(H){ee=H},this.setTransparentSort=function(H){ie=H},this.getClearColor=function(H){return H.copy(je.getClearColor())},this.setClearColor=function(){je.setClearColor.apply(je,arguments)},this.getClearAlpha=function(){return je.getClearAlpha()},this.setClearAlpha=function(){je.setClearAlpha.apply(je,arguments)},this.clear=function(H=!0,pe=!0,be=!0){let Te=0;if(H){let de=!1;if(k!==null){let Ye=k.texture.format;de=Ye===gP||Ye===mP||Ye===AA}if(de){let Ye=k.texture.type,Ct=Ye===Fl||Ye===id||Ye===Yv||Ye===vg||Ye===dP||Ye===pP,_t=je.getClearColor(),Ft=je.getClearAlpha(),or=_t.r,ur=_t.g,dr=_t.b;Ct?(m[0]=or,m[1]=ur,m[2]=dr,m[3]=Ft,X.clearBufferuiv(X.COLOR,0,m)):(y[0]=or,y[1]=ur,y[2]=dr,y[3]=Ft,X.clearBufferiv(X.COLOR,0,y))}else Te|=X.COLOR_BUFFER_BIT}pe&&(Te|=X.DEPTH_BUFFER_BIT),be&&(Te|=X.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),X.clear(Te)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){r.removeEventListener("webglcontextlost",qe,!1),r.removeEventListener("webglcontextrestored",mt,!1),r.removeEventListener("webglcontextcreationerror",Et,!1),je.dispose(),St.dispose(),nr.dispose(),Ke.dispose(),Z.dispose(),fe.dispose(),ze.dispose(),Kt.dispose(),he.dispose(),Tt.dispose(),De.dispose(),De.removeEventListener("sessionstart",Hu),De.removeEventListener("sessionend",ah),Qi.stop()};function qe(H){H.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),E=!0}function mt(){console.log("THREE.WebGLRenderer: Context Restored."),E=!1;let H=st.autoReset,pe=Ge.enabled,be=Ge.autoUpdate,Te=Ge.needsUpdate,de=Ge.type;ct(),st.autoReset=H,Ge.enabled=pe,Ge.autoUpdate=be,Ge.needsUpdate=Te,Ge.type=de}function Et(H){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",H.statusMessage)}function Wt(H){let pe=H.target;pe.removeEventListener("dispose",Wt),en(pe)}function en(H){Ii(H),Ke.remove(H)}function Ii(H){let pe=Ke.get(H).programs;pe!==void 0&&(pe.forEach(function(be){Tt.releaseProgram(be)}),H.isShaderMaterial&&Tt.releaseShaderCache(H))}this.renderBufferDirect=function(H,pe,be,Te,de,Ye){pe===null&&(pe=q);let Ct=de.isMesh&&de.matrixWorld.determinant()<0,_t=oh(H,pe,be,Te,de);Ne.setMaterial(Te,Ct);let Ft=be.index,or=1;if(Te.wireframe===!0){if(Ft=Ve.getWireframeAttribute(be),Ft===void 0)return;or=2}let ur=be.drawRange,dr=be.attributes.position,Wr=ur.start*or,sn=(ur.start+ur.count)*or;Ye!==null&&(Wr=Math.max(Wr,Ye.start*or),sn=Math.min(sn,(Ye.start+Ye.count)*or)),Ft!==null?(Wr=Math.max(Wr,0),sn=Math.min(sn,Ft.count)):dr!=null&&(Wr=Math.max(Wr,0),sn=Math.min(sn,dr.count));let $r=sn-Wr;if($r<0||$r===1/0)return;Kt.setup(de,Te,_t,be,Ft);let ln,gn=Ze;if(Ft!==null&&(ln=Fe.get(Ft),gn=At,gn.setIndex(ln)),de.isMesh)Te.wireframe===!0?(Ne.setLineWidth(Te.wireframeLinewidth*ce()),gn.setMode(X.LINES)):gn.setMode(X.TRIANGLES);else if(de.isLine){let Qt=Te.linewidth;Qt===void 0&&(Qt=1),Ne.setLineWidth(Qt*ce()),de.isLineSegments?gn.setMode(X.LINES):de.isLineLoop?gn.setMode(X.LINE_LOOP):gn.setMode(X.LINE_STRIP)}else de.isPoints?gn.setMode(X.POINTS):de.isSprite&&gn.setMode(X.TRIANGLES);if(de.isBatchedMesh)if(de._multiDrawInstances!==null)gn.renderMultiDrawInstances(de._multiDrawStarts,de._multiDrawCounts,de._multiDrawCount,de._multiDrawInstances);else if(Ce.get("WEBGL_multi_draw"))gn.renderMultiDraw(de._multiDrawStarts,de._multiDrawCounts,de._multiDrawCount);else{let Qt=de._multiDrawStarts,qt=de._multiDrawCounts,Po=de._multiDrawCount,no=Ft?Fe.get(Ft).bytesPerElement:1,Yo=Ke.get(Te).currentProgram.getUniforms();for(let ea=0;ea<Po;ea++)Yo.setValue(X,"_gl_DrawID",ea),gn.render(Qt[ea]/no,qt[ea])}else if(de.isInstancedMesh)gn.renderInstances(Wr,$r,de.count);else if(be.isInstancedBufferGeometry){let Qt=be._maxInstanceCount!==void 0?be._maxInstanceCount:1/0,qt=Math.min(be.instanceCount,Qt);gn.renderInstances(Wr,$r,qt)}else gn.render(Wr,$r)};function Zr(H,pe,be){H.transparent===!0&&H.side===po&&H.forceSinglePass===!1?(H.side=xa,H.needsUpdate=!0,ua(H,pe,be),H.side=_s,H.needsUpdate=!0,ua(H,pe,be),H.side=po):ua(H,pe,be)}this.compile=function(H,pe,be=null){be===null&&(be=H),_=nr.get(be),_.init(pe),b.push(_),be.traverseVisible(function(de){de.isLight&&de.layers.test(pe.layers)&&(_.pushLight(de),de.castShadow&&_.pushShadow(de))}),H!==be&&H.traverseVisible(function(de){de.isLight&&de.layers.test(pe.layers)&&(_.pushLight(de),de.castShadow&&_.pushShadow(de))}),_.setupLights();let Te=new Set;return H.traverse(function(de){if(!(de.isMesh||de.isPoints||de.isLine||de.isSprite))return;let Ye=de.material;if(Ye)if(Array.isArray(Ye))for(let Ct=0;Ct<Ye.length;Ct++){let _t=Ye[Ct];Zr(_t,be,de),Te.add(_t)}else Zr(Ye,be,de),Te.add(Ye)}),b.pop(),_=null,Te},this.compileAsync=function(H,pe,be=null){let Te=this.compile(H,pe,be);return new Promise(de=>{function Ye(){if(Te.forEach(function(Ct){Ke.get(Ct).currentProgram.isReady()&&Te.delete(Ct)}),Te.size===0){de(H);return}setTimeout(Ye,10)}Ce.get("KHR_parallel_shader_compile")!==null?Ye():setTimeout(Ye,10)})};let Pn=null;function Fa(H){Pn&&Pn(H)}function Hu(){Qi.stop()}function ah(){Qi.start()}let Qi=new ON;Qi.setAnimationLoop(Fa),typeof self<"u"&&Qi.setContext(self),this.setAnimationLoop=function(H){Pn=H,De.setAnimationLoop(H),H===null?Qi.stop():Qi.start()},De.addEventListener("sessionstart",Hu),De.addEventListener("sessionend",ah),this.render=function(H,pe){if(pe!==void 0&&pe.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(E===!0)return;if(H.matrixWorldAutoUpdate===!0&&H.updateMatrixWorld(),pe.parent===null&&pe.matrixWorldAutoUpdate===!0&&pe.updateMatrixWorld(),De.enabled===!0&&De.isPresenting===!0&&(De.cameraAutoUpdate===!0&&De.updateCamera(pe),pe=De.getCamera()),H.isScene===!0&&H.onBeforeRender(A,H,pe,k),_=nr.get(H,b.length),_.init(pe),b.push(_),Ue.multiplyMatrices(pe.projectionMatrix,pe.matrixWorldInverse),le.setFromProjectionMatrix(Ue),Le=this.localClippingEnabled,_e=He.init(this.clippingPlanes,Le),v=St.get(H,w.length),v.init(),w.push(v),De.enabled===!0&&De.isPresenting===!0){let Ye=A.xr.getDepthSensingMesh();Ye!==null&&Co(Ye,pe,-1/0,A.sortObjects)}Co(H,pe,0,A.sortObjects),v.finish(),A.sortObjects===!0&&v.sort(ee,ie),oe=De.enabled===!1||De.isPresenting===!1||De.hasDepthSensing()===!1,oe&&je.addToRenderList(v,H),this.info.render.frame++,_e===!0&&He.beginShadows();let be=_.state.shadowsArray;Ge.render(be,H,pe),_e===!0&&He.endShadows(),this.info.autoReset===!0&&this.info.reset();let Te=v.opaque,de=v.transmissive;if(_.setupLights(),pe.isArrayCamera){let Ye=pe.cameras;if(de.length>0)for(let Ct=0,_t=Ye.length;Ct<_t;Ct++){let Ft=Ye[Ct];Xu(Te,de,H,Ft)}oe&&je.render(H);for(let Ct=0,_t=Ye.length;Ct<_t;Ct++){let Ft=Ye[Ct];Mo(v,H,Ft,Ft.viewport)}}else de.length>0&&Xu(Te,de,H,pe),oe&&je.render(H),Mo(v,H,pe);k!==null&&P===0&&(J.updateMultisampleRenderTarget(k),J.updateRenderTargetMipmap(k)),H.isScene===!0&&H.onAfterRender(A,H,pe),Kt.resetDefaultState(),D=-1,O=null,b.pop(),b.length>0?(_=b[b.length-1],_e===!0&&He.setGlobalState(A.clippingPlanes,_.state.camera)):_=null,w.pop(),w.length>0?v=w[w.length-1]:v=null};function Co(H,pe,be,Te){if(H.visible===!1)return;if(H.layers.test(pe.layers)){if(H.isGroup)be=H.renderOrder;else if(H.isLOD)H.autoUpdate===!0&&H.update(pe);else if(H.isLight)_.pushLight(H),H.castShadow&&_.pushShadow(H);else if(H.isSprite){if(!H.frustumCulled||le.intersectsSprite(H)){Te&&we.setFromMatrixPosition(H.matrixWorld).applyMatrix4(Ue);let Ye=ze.update(H),Ct=H.material;Ct.visible&&v.push(H,Ye,Ct,be,we.z,null)}}else if((H.isMesh||H.isLine||H.isPoints)&&(!H.frustumCulled||le.intersectsObject(H))){let Ye=ze.update(H),Ct=H.material;if(Te&&(H.boundingSphere!==void 0?(H.boundingSphere===null&&H.computeBoundingSphere(),we.copy(H.boundingSphere.center)):(Ye.boundingSphere===null&&Ye.computeBoundingSphere(),we.copy(Ye.boundingSphere.center)),we.applyMatrix4(H.matrixWorld).applyMatrix4(Ue)),Array.isArray(Ct)){let _t=Ye.groups;for(let Ft=0,or=_t.length;Ft<or;Ft++){let ur=_t[Ft],dr=Ct[ur.materialIndex];dr&&dr.visible&&v.push(H,Ye,dr,be,we.z,ur)}}else Ct.visible&&v.push(H,Ye,Ct,be,we.z,null)}}let de=H.children;for(let Ye=0,Ct=de.length;Ye<Ct;Ye++)Co(de[Ye],pe,be,Te)}function Mo(H,pe,be,Te){let de=H.opaque,Ye=H.transmissive,Ct=H.transparent;_.setupLightsView(be),_e===!0&&He.setGlobalState(A.clippingPlanes,be),Te&&Ne.viewport(B.copy(Te)),de.length>0&&Ts(de,pe,be),Ye.length>0&&Ts(Ye,pe,be),Ct.length>0&&Ts(Ct,pe,be),Ne.buffers.depth.setTest(!0),Ne.buffers.depth.setMask(!0),Ne.buffers.color.setMask(!0),Ne.setPolygonOffset(!1)}function Xu(H,pe,be,Te){if((be.isScene===!0?be.overrideMaterial:null)!==null)return;_.state.transmissionRenderTarget[Te.id]===void 0&&(_.state.transmissionRenderTarget[Te.id]=new ad(1,1,{generateMipmaps:!0,type:Ce.has("EXT_color_buffer_half_float")||Ce.has("EXT_color_buffer_float")?$1:Fl,minFilter:dp,samples:4,stencilBuffer:a,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:an.workingColorSpace}));let de=_.state.transmissionRenderTarget[Te.id],Ye=Te.viewport||B;de.setSize(Ye.z*A.transmissionResolutionScale,Ye.w*A.transmissionResolutionScale);let Ct=A.getRenderTarget();A.setRenderTarget(de),A.getClearColor(T),N=A.getClearAlpha(),N<1&&A.setClearColor(16777215,.5),A.clear(),oe&&je.render(be);let _t=A.toneMapping;A.toneMapping=ed;let Ft=Te.viewport;if(Te.viewport!==void 0&&(Te.viewport=void 0),_.setupLightsView(Te),_e===!0&&He.setGlobalState(A.clippingPlanes,Te),Ts(H,be,Te),J.updateMultisampleRenderTarget(de),J.updateRenderTargetMipmap(de),Ce.has("WEBGL_multisampled_render_to_texture")===!1){let or=!1;for(let ur=0,dr=pe.length;ur<dr;ur++){let Wr=pe[ur],sn=Wr.object,$r=Wr.geometry,ln=Wr.material,gn=Wr.group;if(ln.side===po&&sn.layers.test(Te.layers)){let Qt=ln.side;ln.side=xa,ln.needsUpdate=!0,qu(sn,be,Te,$r,ln,gn),ln.side=Qt,ln.needsUpdate=!0,or=!0}}or===!0&&(J.updateMultisampleRenderTarget(de),J.updateRenderTargetMipmap(de))}A.setRenderTarget(Ct),A.setClearColor(T,N),Ft!==void 0&&(Te.viewport=Ft),A.toneMapping=_t}function Ts(H,pe,be){let Te=pe.isScene===!0?pe.overrideMaterial:null;for(let de=0,Ye=H.length;de<Ye;de++){let Ct=H[de],_t=Ct.object,Ft=Ct.geometry,or=Te===null?Ct.material:Te,ur=Ct.group;_t.layers.test(be.layers)&&qu(_t,pe,be,Ft,or,ur)}}function qu(H,pe,be,Te,de,Ye){H.onBeforeRender(A,pe,be,Te,de,Ye),H.modelViewMatrix.multiplyMatrices(be.matrixWorldInverse,H.matrixWorld),H.normalMatrix.getNormalMatrix(H.modelViewMatrix),de.onBeforeRender(A,pe,be,Te,H,Ye),de.transparent===!0&&de.side===po&&de.forceSinglePass===!1?(de.side=xa,de.needsUpdate=!0,A.renderBufferDirect(be,pe,Te,de,H,Ye),de.side=_s,de.needsUpdate=!0,A.renderBufferDirect(be,pe,Te,de,H,Ye),de.side=po):A.renderBufferDirect(be,pe,Te,de,H,Ye),H.onAfterRender(A,pe,be,Te,de,Ye)}function ua(H,pe,be){pe.isScene!==!0&&(pe=q);let Te=Ke.get(H),de=_.state.lights,Ye=_.state.shadowsArray,Ct=de.state.version,_t=Tt.getParameters(H,de.state,Ye,pe,be),Ft=Tt.getProgramCacheKey(_t),or=Te.programs;Te.environment=H.isMeshStandardMaterial?pe.environment:null,Te.fog=pe.fog,Te.envMap=(H.isMeshStandardMaterial?fe:Z).get(H.envMap||Te.environment),Te.envMapRotation=Te.environment!==null&&H.envMap===null?pe.environmentRotation:H.envMapRotation,or===void 0&&(H.addEventListener("dispose",Wt),or=new Map,Te.programs=or);let ur=or.get(Ft);if(ur!==void 0){if(Te.currentProgram===ur&&Te.lightsStateVersion===Ct)return To(H,_t),ur}else _t.uniforms=Tt.getUniforms(H),H.onBeforeCompile(_t,A),ur=Tt.acquireProgram(_t,Ft),or.set(Ft,ur),Te.uniforms=_t.uniforms;let dr=Te.uniforms;return(!H.isShaderMaterial&&!H.isRawShaderMaterial||H.clipping===!0)&&(dr.clippingPlanes=He.uniform),To(H,_t),Te.needsLights=Pd(H),Te.lightsStateVersion=Ct,Te.needsLights&&(dr.ambientLightColor.value=de.state.ambient,dr.lightProbe.value=de.state.probe,dr.directionalLights.value=de.state.directional,dr.directionalLightShadows.value=de.state.directionalShadow,dr.spotLights.value=de.state.spot,dr.spotLightShadows.value=de.state.spotShadow,dr.rectAreaLights.value=de.state.rectArea,dr.ltc_1.value=de.state.rectAreaLTC1,dr.ltc_2.value=de.state.rectAreaLTC2,dr.pointLights.value=de.state.point,dr.pointLightShadows.value=de.state.pointShadow,dr.hemisphereLights.value=de.state.hemi,dr.directionalShadowMap.value=de.state.directionalShadowMap,dr.directionalShadowMatrix.value=de.state.directionalShadowMatrix,dr.spotShadowMap.value=de.state.spotShadowMap,dr.spotLightMatrix.value=de.state.spotLightMatrix,dr.spotLightMap.value=de.state.spotLightMap,dr.pointShadowMap.value=de.state.pointShadowMap,dr.pointShadowMatrix.value=de.state.pointShadowMatrix),Te.currentProgram=ur,Te.uniformsList=null,ur}function Yu(H){if(H.uniformsList===null){let pe=H.currentProgram.getUniforms();H.uniformsList=$b.seqWithValue(pe.seq,H.uniforms)}return H.uniformsList}function To(H,pe){let be=Ke.get(H);be.outputColorSpace=pe.outputColorSpace,be.batching=pe.batching,be.batchingColor=pe.batchingColor,be.instancing=pe.instancing,be.instancingColor=pe.instancingColor,be.instancingMorph=pe.instancingMorph,be.skinning=pe.skinning,be.morphTargets=pe.morphTargets,be.morphNormals=pe.morphNormals,be.morphColors=pe.morphColors,be.morphTargetsCount=pe.morphTargetsCount,be.numClippingPlanes=pe.numClippingPlanes,be.numIntersection=pe.numClipIntersection,be.vertexAlphas=pe.vertexAlphas,be.vertexTangents=pe.vertexTangents,be.toneMapping=pe.toneMapping}function oh(H,pe,be,Te,de){pe.isScene!==!0&&(pe=q),J.resetTextureUnits();let Ye=pe.fog,Ct=Te.isMeshStandardMaterial?pe.environment:null,_t=k===null?A.outputColorSpace:k.isXRRenderTarget===!0?k.texture.colorSpace:Op,Ft=(Te.isMeshStandardMaterial?fe:Z).get(Te.envMap||Ct),or=Te.vertexColors===!0&&!!be.attributes.color&&be.attributes.color.itemSize===4,ur=!!be.attributes.tangent&&(!!Te.normalMap||Te.anisotropy>0),dr=!!be.morphAttributes.position,Wr=!!be.morphAttributes.normal,sn=!!be.morphAttributes.color,$r=ed;Te.toneMapped&&(k===null||k.isXRRenderTarget===!0)&&($r=A.toneMapping);let ln=be.morphAttributes.position||be.morphAttributes.normal||be.morphAttributes.color,gn=ln!==void 0?ln.length:0,Qt=Ke.get(Te),qt=_.state.lights;if(_e===!0&&(Le===!0||H!==O)){let z=H===O&&Te.id===D;He.setState(Te,H,z)}let Po=!1;Te.version===Qt.__version?(Qt.needsLights&&Qt.lightsStateVersion!==qt.state.version||Qt.outputColorSpace!==_t||de.isBatchedMesh&&Qt.batching===!1||!de.isBatchedMesh&&Qt.batching===!0||de.isBatchedMesh&&Qt.batchingColor===!0&&de.colorTexture===null||de.isBatchedMesh&&Qt.batchingColor===!1&&de.colorTexture!==null||de.isInstancedMesh&&Qt.instancing===!1||!de.isInstancedMesh&&Qt.instancing===!0||de.isSkinnedMesh&&Qt.skinning===!1||!de.isSkinnedMesh&&Qt.skinning===!0||de.isInstancedMesh&&Qt.instancingColor===!0&&de.instanceColor===null||de.isInstancedMesh&&Qt.instancingColor===!1&&de.instanceColor!==null||de.isInstancedMesh&&Qt.instancingMorph===!0&&de.morphTexture===null||de.isInstancedMesh&&Qt.instancingMorph===!1&&de.morphTexture!==null||Qt.envMap!==Ft||Te.fog===!0&&Qt.fog!==Ye||Qt.numClippingPlanes!==void 0&&(Qt.numClippingPlanes!==He.numPlanes||Qt.numIntersection!==He.numIntersection)||Qt.vertexAlphas!==or||Qt.vertexTangents!==ur||Qt.morphTargets!==dr||Qt.morphNormals!==Wr||Qt.morphColors!==sn||Qt.toneMapping!==$r||Qt.morphTargetsCount!==gn)&&(Po=!0):(Po=!0,Qt.__version=Te.version);let no=Qt.currentProgram;Po===!0&&(no=ua(Te,pe,de));let Yo=!1,ea=!1,Ju=!1,g=no.getUniforms(),x=Qt.uniforms;if(Ne.useProgram(no.program)&&(Yo=!0,ea=!0,Ju=!0),Te.id!==D&&(D=Te.id,ea=!0),Yo||O!==H){Ne.buffers.depth.getReversed()?(Se.copy(H.projectionMatrix),Pie(Se),Die(Se),g.setValue(X,"projectionMatrix",Se)):g.setValue(X,"projectionMatrix",H.projectionMatrix),g.setValue(X,"viewMatrix",H.matrixWorldInverse);let z=g.map.cameraPosition;z!==void 0&&z.setValue(X,Y.setFromMatrixPosition(H.matrixWorld)),Ee.logarithmicDepthBuffer&&g.setValue(X,"logDepthBufFC",2/(Math.log(H.far+1)/Math.LN2)),(Te.isMeshPhongMaterial||Te.isMeshToonMaterial||Te.isMeshLambertMaterial||Te.isMeshBasicMaterial||Te.isMeshStandardMaterial||Te.isShaderMaterial)&&g.setValue(X,"isOrthographic",H.isOrthographicCamera===!0),O!==H&&(O=H,ea=!0,Ju=!0)}if(de.isSkinnedMesh){g.setOptional(X,de,"bindMatrix"),g.setOptional(X,de,"bindMatrixInverse");let z=de.skeleton;z&&(z.boneTexture===null&&z.computeBoneTexture(),g.setValue(X,"boneTexture",z.boneTexture,J))}de.isBatchedMesh&&(g.setOptional(X,de,"batchingTexture"),g.setValue(X,"batchingTexture",de._matricesTexture,J),g.setOptional(X,de,"batchingIdTexture"),g.setValue(X,"batchingIdTexture",de._indirectTexture,J),g.setOptional(X,de,"batchingColorTexture"),de._colorsTexture!==null&&g.setValue(X,"batchingColorTexture",de._colorsTexture,J));let I=be.morphAttributes;if((I.position!==void 0||I.normal!==void 0||I.color!==void 0)&&tt.update(de,be,no),(ea||Qt.receiveShadow!==de.receiveShadow)&&(Qt.receiveShadow=de.receiveShadow,g.setValue(X,"receiveShadow",de.receiveShadow)),Te.isMeshGouraudMaterial&&Te.envMap!==null&&(x.envMap.value=Ft,x.flipEnvMap.value=Ft.isCubeTexture&&Ft.isRenderTargetTexture===!1?-1:1),Te.isMeshStandardMaterial&&Te.envMap===null&&pe.environment!==null&&(x.envMapIntensity.value=pe.environmentIntensity),ea&&(g.setValue(X,"toneMappingExposure",A.toneMappingExposure),Qt.needsLights&&sh(x,Ju),Ye&&Te.fog===!0&&ft.refreshFogUniforms(x,Ye),ft.refreshMaterialUniforms(x,Te,G,V,_.state.transmissionRenderTarget[H.id]),$b.upload(X,Yu(Qt),x,J)),Te.isShaderMaterial&&Te.uniformsNeedUpdate===!0&&($b.upload(X,Yu(Qt),x,J),Te.uniformsNeedUpdate=!1),Te.isSpriteMaterial&&g.setValue(X,"center",de.center),g.setValue(X,"modelViewMatrix",de.modelViewMatrix),g.setValue(X,"normalMatrix",de.normalMatrix),g.setValue(X,"modelMatrix",de.matrixWorld),Te.isShaderMaterial||Te.isRawShaderMaterial){let z=Te.uniformsGroups;for(let F=0,j=z.length;F<j;F++){let W=z[F];he.update(W,no),he.bind(W,no)}}return no}function sh(H,pe){H.ambientLightColor.needsUpdate=pe,H.lightProbe.needsUpdate=pe,H.directionalLights.needsUpdate=pe,H.directionalLightShadows.needsUpdate=pe,H.pointLights.needsUpdate=pe,H.pointLightShadows.needsUpdate=pe,H.spotLights.needsUpdate=pe,H.spotLightShadows.needsUpdate=pe,H.rectAreaLights.needsUpdate=pe,H.hemisphereLights.needsUpdate=pe}function Pd(H){return H.isMeshLambertMaterial||H.isMeshToonMaterial||H.isMeshPhongMaterial||H.isMeshStandardMaterial||H.isShadowMaterial||H.isShaderMaterial&&H.lights===!0}this.getActiveCubeFace=function(){return M},this.getActiveMipmapLevel=function(){return P},this.getRenderTarget=function(){return k},this.setRenderTargetTextures=function(H,pe,be){Ke.get(H.texture).__webglTexture=pe,Ke.get(H.depthTexture).__webglTexture=be;let Te=Ke.get(H);Te.__hasExternalTextures=!0,Te.__autoAllocateDepthBuffer=be===void 0,Te.__autoAllocateDepthBuffer||Ce.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Te.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(H,pe){let be=Ke.get(H);be.__webglFramebuffer=pe,be.__useDefaultFramebuffer=pe===void 0};let se=X.createFramebuffer();this.setRenderTarget=function(H,pe=0,be=0){k=H,M=pe,P=be;let Te=!0,de=null,Ye=!1,Ct=!1;if(H){let _t=Ke.get(H);if(_t.__useDefaultFramebuffer!==void 0)Ne.bindFramebuffer(X.FRAMEBUFFER,null),Te=!1;else if(_t.__webglFramebuffer===void 0)J.setupRenderTarget(H);else if(_t.__hasExternalTextures)J.rebindTextures(H,Ke.get(H.texture).__webglTexture,Ke.get(H.depthTexture).__webglTexture);else if(H.depthBuffer){let ur=H.depthTexture;if(_t.__boundDepthTexture!==ur){if(ur!==null&&Ke.has(ur)&&(H.width!==ur.image.width||H.height!==ur.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");J.setupDepthRenderbuffer(H)}}let Ft=H.texture;(Ft.isData3DTexture||Ft.isDataArrayTexture||Ft.isCompressedArrayTexture)&&(Ct=!0);let or=Ke.get(H).__webglFramebuffer;H.isWebGLCubeRenderTarget?(Array.isArray(or[pe])?de=or[pe][be]:de=or[pe],Ye=!0):H.samples>0&&J.useMultisampledRTT(H)===!1?de=Ke.get(H).__webglMultisampledFramebuffer:Array.isArray(or)?de=or[be]:de=or,B.copy(H.viewport),L.copy(H.scissor),R=H.scissorTest}else B.copy(me).multiplyScalar(G).floor(),L.copy(Me).multiplyScalar(G).floor(),R=Ae;if(be!==0&&(de=se),Ne.bindFramebuffer(X.FRAMEBUFFER,de)&&Te&&Ne.drawBuffers(H,de),Ne.viewport(B),Ne.scissor(L),Ne.setScissorTest(R),Ye){let _t=Ke.get(H.texture);X.framebufferTexture2D(X.FRAMEBUFFER,X.COLOR_ATTACHMENT0,X.TEXTURE_CUBE_MAP_POSITIVE_X+pe,_t.__webglTexture,be)}else if(Ct){let _t=Ke.get(H.texture),Ft=pe;X.framebufferTextureLayer(X.FRAMEBUFFER,X.COLOR_ATTACHMENT0,_t.__webglTexture,be,Ft)}else if(H!==null&&be!==0){let _t=Ke.get(H.texture);X.framebufferTexture2D(X.FRAMEBUFFER,X.COLOR_ATTACHMENT0,X.TEXTURE_2D,_t.__webglTexture,be)}D=-1},this.readRenderTargetPixels=function(H,pe,be,Te,de,Ye,Ct){if(!(H&&H.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let _t=Ke.get(H).__webglFramebuffer;if(H.isWebGLCubeRenderTarget&&Ct!==void 0&&(_t=_t[Ct]),_t){Ne.bindFramebuffer(X.FRAMEBUFFER,_t);try{let Ft=H.texture,or=Ft.format,ur=Ft.type;if(!Ee.textureFormatReadable(or)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Ee.textureTypeReadable(ur)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}pe>=0&&pe<=H.width-Te&&be>=0&&be<=H.height-de&&X.readPixels(pe,be,Te,de,vt.convert(or),vt.convert(ur),Ye)}finally{let Ft=k!==null?Ke.get(k).__webglFramebuffer:null;Ne.bindFramebuffer(X.FRAMEBUFFER,Ft)}}},this.readRenderTargetPixelsAsync=async function(H,pe,be,Te,de,Ye,Ct){if(!(H&&H.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let _t=Ke.get(H).__webglFramebuffer;if(H.isWebGLCubeRenderTarget&&Ct!==void 0&&(_t=_t[Ct]),_t){let Ft=H.texture,or=Ft.format,ur=Ft.type;if(!Ee.textureFormatReadable(or))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Ee.textureTypeReadable(ur))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(pe>=0&&pe<=H.width-Te&&be>=0&&be<=H.height-de){Ne.bindFramebuffer(X.FRAMEBUFFER,_t);let dr=X.createBuffer();X.bindBuffer(X.PIXEL_PACK_BUFFER,dr),X.bufferData(X.PIXEL_PACK_BUFFER,Ye.byteLength,X.STREAM_READ),X.readPixels(pe,be,Te,de,vt.convert(or),vt.convert(ur),0);let Wr=k!==null?Ke.get(k).__webglFramebuffer:null;Ne.bindFramebuffer(X.FRAMEBUFFER,Wr);let sn=X.fenceSync(X.SYNC_GPU_COMMANDS_COMPLETE,0);return X.flush(),await Tie(X,sn,4),X.bindBuffer(X.PIXEL_PACK_BUFFER,dr),X.getBufferSubData(X.PIXEL_PACK_BUFFER,0,Ye),X.deleteBuffer(dr),X.deleteSync(sn),Ye}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(H,pe=null,be=0){H.isTexture!==!0&&(Bf("WebGLRenderer: copyFramebufferToTexture function signature has changed."),pe=arguments[0]||null,H=arguments[1]);let Te=Math.pow(2,-be),de=Math.floor(H.image.width*Te),Ye=Math.floor(H.image.height*Te),Ct=pe!==null?pe.x:0,_t=pe!==null?pe.y:0;J.setTexture2D(H,0),X.copyTexSubImage2D(X.TEXTURE_2D,be,0,0,Ct,_t,de,Ye),Ne.unbindTexture()};let Pt=X.createFramebuffer(),bt=X.createFramebuffer();this.copyTextureToTexture=function(H,pe,be=null,Te=null,de=0,Ye=null){H.isTexture!==!0&&(Bf("WebGLRenderer: copyTextureToTexture function signature has changed."),Te=arguments[0]||null,H=arguments[1],pe=arguments[2],Ye=arguments[3]||0,be=null),Ye===null&&(de!==0?(Bf("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Ye=de,de=0):Ye=0);let Ct,_t,Ft,or,ur,dr,Wr,sn,$r,ln=H.isCompressedTexture?H.mipmaps[Ye]:H.image;if(be!==null)Ct=be.max.x-be.min.x,_t=be.max.y-be.min.y,Ft=be.isBox3?be.max.z-be.min.z:1,or=be.min.x,ur=be.min.y,dr=be.isBox3?be.min.z:0;else{let I=Math.pow(2,-de);Ct=Math.floor(ln.width*I),_t=Math.floor(ln.height*I),H.isDataArrayTexture?Ft=ln.depth:H.isData3DTexture?Ft=Math.floor(ln.depth*I):Ft=1,or=0,ur=0,dr=0}Te!==null?(Wr=Te.x,sn=Te.y,$r=Te.z):(Wr=0,sn=0,$r=0);let gn=vt.convert(pe.format),Qt=vt.convert(pe.type),qt;pe.isData3DTexture?(J.setTexture3D(pe,0),qt=X.TEXTURE_3D):pe.isDataArrayTexture||pe.isCompressedArrayTexture?(J.setTexture2DArray(pe,0),qt=X.TEXTURE_2D_ARRAY):(J.setTexture2D(pe,0),qt=X.TEXTURE_2D),X.pixelStorei(X.UNPACK_FLIP_Y_WEBGL,pe.flipY),X.pixelStorei(X.UNPACK_PREMULTIPLY_ALPHA_WEBGL,pe.premultiplyAlpha),X.pixelStorei(X.UNPACK_ALIGNMENT,pe.unpackAlignment);let Po=X.getParameter(X.UNPACK_ROW_LENGTH),no=X.getParameter(X.UNPACK_IMAGE_HEIGHT),Yo=X.getParameter(X.UNPACK_SKIP_PIXELS),ea=X.getParameter(X.UNPACK_SKIP_ROWS),Ju=X.getParameter(X.UNPACK_SKIP_IMAGES);X.pixelStorei(X.UNPACK_ROW_LENGTH,ln.width),X.pixelStorei(X.UNPACK_IMAGE_HEIGHT,ln.height),X.pixelStorei(X.UNPACK_SKIP_PIXELS,or),X.pixelStorei(X.UNPACK_SKIP_ROWS,ur),X.pixelStorei(X.UNPACK_SKIP_IMAGES,dr);let g=H.isDataArrayTexture||H.isData3DTexture,x=pe.isDataArrayTexture||pe.isData3DTexture;if(H.isDepthTexture){let I=Ke.get(H),z=Ke.get(pe),F=Ke.get(I.__renderTarget),j=Ke.get(z.__renderTarget);Ne.bindFramebuffer(X.READ_FRAMEBUFFER,F.__webglFramebuffer),Ne.bindFramebuffer(X.DRAW_FRAMEBUFFER,j.__webglFramebuffer);for(let W=0;W<Ft;W++)g&&(X.framebufferTextureLayer(X.READ_FRAMEBUFFER,X.COLOR_ATTACHMENT0,Ke.get(H).__webglTexture,de,dr+W),X.framebufferTextureLayer(X.DRAW_FRAMEBUFFER,X.COLOR_ATTACHMENT0,Ke.get(pe).__webglTexture,Ye,$r+W)),X.blitFramebuffer(or,ur,Ct,_t,Wr,sn,Ct,_t,X.DEPTH_BUFFER_BIT,X.NEAREST);Ne.bindFramebuffer(X.READ_FRAMEBUFFER,null),Ne.bindFramebuffer(X.DRAW_FRAMEBUFFER,null)}else if(de!==0||H.isRenderTargetTexture||Ke.has(H)){let I=Ke.get(H),z=Ke.get(pe);Ne.bindFramebuffer(X.READ_FRAMEBUFFER,Pt),Ne.bindFramebuffer(X.DRAW_FRAMEBUFFER,bt);for(let F=0;F<Ft;F++)g?X.framebufferTextureLayer(X.READ_FRAMEBUFFER,X.COLOR_ATTACHMENT0,I.__webglTexture,de,dr+F):X.framebufferTexture2D(X.READ_FRAMEBUFFER,X.COLOR_ATTACHMENT0,X.TEXTURE_2D,I.__webglTexture,de),x?X.framebufferTextureLayer(X.DRAW_FRAMEBUFFER,X.COLOR_ATTACHMENT0,z.__webglTexture,Ye,$r+F):X.framebufferTexture2D(X.DRAW_FRAMEBUFFER,X.COLOR_ATTACHMENT0,X.TEXTURE_2D,z.__webglTexture,Ye),de!==0?X.blitFramebuffer(or,ur,Ct,_t,Wr,sn,Ct,_t,X.COLOR_BUFFER_BIT,X.NEAREST):x?X.copyTexSubImage3D(qt,Ye,Wr,sn,$r+F,or,ur,Ct,_t):X.copyTexSubImage2D(qt,Ye,Wr,sn,or,ur,Ct,_t);Ne.bindFramebuffer(X.READ_FRAMEBUFFER,null),Ne.bindFramebuffer(X.DRAW_FRAMEBUFFER,null)}else x?H.isDataTexture||H.isData3DTexture?X.texSubImage3D(qt,Ye,Wr,sn,$r,Ct,_t,Ft,gn,Qt,ln.data):pe.isCompressedArrayTexture?X.compressedTexSubImage3D(qt,Ye,Wr,sn,$r,Ct,_t,Ft,gn,ln.data):X.texSubImage3D(qt,Ye,Wr,sn,$r,Ct,_t,Ft,gn,Qt,ln):H.isDataTexture?X.texSubImage2D(X.TEXTURE_2D,Ye,Wr,sn,Ct,_t,gn,Qt,ln.data):H.isCompressedTexture?X.compressedTexSubImage2D(X.TEXTURE_2D,Ye,Wr,sn,ln.width,ln.height,gn,ln.data):X.texSubImage2D(X.TEXTURE_2D,Ye,Wr,sn,Ct,_t,gn,Qt,ln);X.pixelStorei(X.UNPACK_ROW_LENGTH,Po),X.pixelStorei(X.UNPACK_IMAGE_HEIGHT,no),X.pixelStorei(X.UNPACK_SKIP_PIXELS,Yo),X.pixelStorei(X.UNPACK_SKIP_ROWS,ea),X.pixelStorei(X.UNPACK_SKIP_IMAGES,Ju),Ye===0&&pe.generateMipmaps&&X.generateMipmap(qt),Ne.unbindTexture()},this.copyTextureToTexture3D=function(H,pe,be=null,Te=null,de=0){return H.isTexture!==!0&&(Bf("WebGLRenderer: copyTextureToTexture3D function signature has changed."),be=arguments[0]||null,Te=arguments[1]||null,H=arguments[2],pe=arguments[3],de=arguments[4]||0),Bf('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(H,pe,be,Te,de)},this.initRenderTarget=function(H){Ke.get(H).__webglFramebuffer===void 0&&J.setupRenderTarget(H)},this.initTexture=function(H){H.isCubeTexture?J.setTextureCube(H,0):H.isData3DTexture?J.setTexture3D(H,0):H.isDataArrayTexture||H.isCompressedArrayTexture?J.setTexture2DArray(H,0):J.setTexture2D(H,0),Ne.unbindTexture()},this.resetState=function(){M=0,P=0,k=null,Ne.reset(),Kt.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Tc}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;let r=this.getContext();r.drawingBufferColorspace=an._getDrawingBufferColorSpace(e),r.unpackColorSpace=an._getUnpackColorSpace()}};C();function vd(t,e=!1){let r=t[0].index!==null,n=new Set(Object.keys(t[0].attributes)),i=new Set(Object.keys(t[0].morphAttributes)),a={},o={},s=t[0].morphTargetsRelative,l=new Ja,u=0;for(let c=0;c<t.length;++c){let h=t[c],d=0;if(r!==(h.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let p in h.attributes){if(!n.has(p))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+'. All geometries must have compatible attributes; make sure "'+p+'" attribute exists among all geometries, or in none of them.'),null;a[p]===void 0&&(a[p]=[]),a[p].push(h.attributes[p]),d++}if(d!==n.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". Make sure all geometries have the same number of attributes."),null;if(s!==h.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let p in h.morphAttributes){if(!i.has(p))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+".  .morphAttributes must be consistent throughout all geometries."),null;o[p]===void 0&&(o[p]=[]),o[p].push(h.morphAttributes[p])}if(e){let p;if(r)p=h.index.count;else if(h.attributes.position!==void 0)p=h.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". The geometry must have either an index or a position attribute"),null;l.addGroup(u,p,c),u+=p}}if(r){let c=0,h=[];for(let d=0;d<t.length;++d){let p=t[d].index;for(let m=0;m<p.count;++m)h.push(p.getX(m)+c);c+=t[d].attributes.position.count}l.setIndex(h)}for(let c in a){let h=ez(a[c]);if(!h)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+c+" attribute."),null;l.setAttribute(c,h)}for(let c in o){let h=o[c][0].length;if(h===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[c]=[];for(let d=0;d<h;++d){let p=[];for(let y=0;y<o[c].length;++y)p.push(o[c][y][d]);let m=ez(p);if(!m)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+c+" morphAttribute."),null;l.morphAttributes[c].push(m)}}return l}function ez(t){let e,r,n,i=-1,a=0;for(let u=0;u<t.length;++u){let c=t[u];if(e===void 0&&(e=c.array.constructor),e!==c.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(r===void 0&&(r=c.itemSize),r!==c.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(n===void 0&&(n=c.normalized),n!==c.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(i===-1&&(i=c.gpuType),i!==c.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;a+=c.count*r}let o=new e(a),s=new Xn(o,r,n),l=0;for(let u=0;u<t.length;++u){let c=t[u];if(c.isInterleavedBufferAttribute){let h=l/r;for(let d=0,p=c.count;d<p;d++)for(let m=0;m<r;m++){let y=c.getComponent(d,m);s.setComponent(d+h,m,y)}}else o.set(c.array,l);l+=c.count*r}return i!==void 0&&(s.gpuType=i),s}function XQe(t,e){if(e===eie)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),t;if(e===FB||e===tie){let r=t.getIndex();if(r===null){let o=[],s=t.getAttribute("position");if(s!==void 0){for(let l=0;l<s.count;l++)o.push(l);t.setIndex(o),r=t.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t}let n=r.count-2,i=[];if(e===FB)for(let o=1;o<=n;o++)i.push(r.getX(0)),i.push(r.getX(o)),i.push(r.getX(o+1));else for(let o=0;o<n;o++)o%2===0?(i.push(r.getX(o)),i.push(r.getX(o+1)),i.push(r.getX(o+2))):(i.push(r.getX(o+2)),i.push(r.getX(o+1)),i.push(r.getX(o)));i.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let a=t.clone();return a.setIndex(i),a.clearGroups(),a}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),t}const LN=Object.freeze({status:"aborted"});function Ie(t,e,r){function n(s,l){var u;Object.defineProperty(s,"_zod",{value:s._zod??{},enumerable:!1}),(u=s._zod).traits??(u.traits=new Set),s._zod.traits.add(t),e(s,l);for(const c in o.prototype)c in s||Object.defineProperty(s,c,{value:o.prototype[c].bind(s)});s._zod.constr=o,s._zod.def=l}const i=r?.Parent??Object;class a extends i{}Object.defineProperty(a,"name",{value:t});function o(s){var l;const u=r?.Parent?new a:this;n(u,s),(l=u._zod).deferred??(l.deferred=[]);for(const c of u._zod.deferred)c();return u}return Object.defineProperty(o,"init",{value:n}),Object.defineProperty(o,Symbol.hasInstance,{value:s=>r?.Parent&&s instanceof r.Parent?!0:s?._zod?.traits?.has(t)}),Object.defineProperty(o,"name",{value:t}),o}const NN=Symbol("zod_brand");class Ep extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class PA extends Error{constructor(e){super(`Encountered unidirectional transform during encode: ${e}`),this.name="ZodEncodeError"}}const h4={};function xo(t){return t&&Object.assign(h4,t),h4}function ihe(t){return t}function ahe(t){return t}function ohe(t){}function she(t){throw new Error}function lhe(t){}function PP(t){const e=Object.values(t).filter(n=>typeof n=="number");return Object.entries(t).filter(([n,i])=>e.indexOf(+n)===-1).map(([n,i])=>i)}function gt(t,e="|"){return t.map(r=>yr(r)).join(e)}function d4(t,e){return typeof e=="bigint"?e.toString():e}function Z1(t){return{get value(){{const e=t();return Object.defineProperty(this,"value",{value:e}),e}}}}function Hp(t){return t==null}function DA(t){const e=t.startsWith("^")?1:0,r=t.endsWith("$")?t.length-1:t.length;return t.slice(e,r)}function $N(t,e){const r=(t.toString().split(".")[1]||"").length,n=e.toString();let i=(n.split(".")[1]||"").length;if(i===0&&/\d?e-\d?/.test(n)){const l=n.match(/\d?e-(\d?)/);l?.[1]&&(i=Number.parseInt(l[1]))}const a=r>i?r:i,o=Number.parseInt(t.toFixed(a).replace(".","")),s=Number.parseInt(e.toFixed(a).replace(".",""));return o%s/10**a}const tz=Symbol("evaluating");function Vr(t,e,r){let n;Object.defineProperty(t,e,{get(){if(n!==tz)return n===void 0&&(n=tz,n=r()),n},set(i){Object.defineProperty(t,e,{value:i})},configurable:!0})}function uhe(t){return Object.create(Object.getPrototypeOf(t),Object.getOwnPropertyDescriptors(t))}function _d(t,e,r){Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0})}function Xc(...t){const e={};for(const r of t){const n=Object.getOwnPropertyDescriptors(r);Object.assign(e,n)}return Object.defineProperties({},e)}function che(t){return Xc(t._zod.def)}function hhe(t,e){return e?e.reduce((r,n)=>r?.[n],t):t}function dhe(t){const e=Object.keys(t),r=e.map(n=>t[n]);return Promise.all(r).then(n=>{const i={};for(let a=0;a<e.length;a++)i[e[a]]=n[a];return i})}function phe(t=10){const e="abcdefghijklmnopqrstuvwxyz";let r="";for(let n=0;n<t;n++)r+=e[Math.floor(Math.random()*e.length)];return r}function OC(t){return JSON.stringify(t)}const DP="captureStackTrace"in Error?Error.captureStackTrace:(...t)=>{};function Ag(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}const UN=Z1(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function zp(t){if(Ag(t)===!1)return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return!(Ag(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function kA(t){return zp(t)?{...t}:Array.isArray(t)?[...t]:t}function fhe(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}const mhe=t=>{const e=typeof t;switch(e){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(t)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":return Array.isArray(t)?"array":t===null?"null":t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?"promise":typeof Map<"u"&&t instanceof Map?"map":typeof Set<"u"&&t instanceof Set?"set":typeof Date<"u"&&t instanceof Date?"date":typeof File<"u"&&t instanceof File?"file":"object";default:throw new Error(`Unknown data type: ${e}`)}},p4=new Set(["string","number","symbol"]),jN=new Set(["string","number","bigint","boolean","symbol","undefined"]);function sd(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ks(t,e,r){const n=new t._zod.constr(e??t._zod.def);return(!e||r?.parent)&&(n._zod.parent=t),n}function et(t){const e=t;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function ghe(t){let e;return new Proxy({},{get(r,n,i){return e??(e=t()),Reflect.get(e,n,i)},set(r,n,i,a){return e??(e=t()),Reflect.set(e,n,i,a)},has(r,n){return e??(e=t()),Reflect.has(e,n)},deleteProperty(r,n){return e??(e=t()),Reflect.deleteProperty(e,n)},ownKeys(r){return e??(e=t()),Reflect.ownKeys(e)},getOwnPropertyDescriptor(r,n){return e??(e=t()),Reflect.getOwnPropertyDescriptor(e,n)},defineProperty(r,n,i){return e??(e=t()),Reflect.defineProperty(e,n,i)}})}function yr(t){return typeof t=="bigint"?t.toString()+"n":typeof t=="string"?`"${t}"`:`${t}`}function VN(t){return Object.keys(t).filter(e=>t[e]._zod.optin==="optional"&&t[e]._zod.optout==="optional")}const GN={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},ZN={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function WN(t,e){const r=t._zod.def,n=Xc(t._zod.def,{get shape(){const i={};for(const a in e){if(!(a in r.shape))throw new Error(`Unrecognized key: "${a}"`);e[a]&&(i[a]=r.shape[a])}return _d(this,"shape",i),i},checks:[]});return Ks(t,n)}function HN(t,e){const r=t._zod.def,n=Xc(t._zod.def,{get shape(){const i={...t._zod.def.shape};for(const a in e){if(!(a in r.shape))throw new Error(`Unrecognized key: "${a}"`);e[a]&&delete i[a]}return _d(this,"shape",i),i},checks:[]});return Ks(t,n)}function XN(t,e){if(!zp(e))throw new Error("Invalid input to extend: expected a plain object");const r=t._zod.def.checks;if(r&&r.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const i=Xc(t._zod.def,{get shape(){const a={...t._zod.def.shape,...e};return _d(this,"shape",a),a},checks:[]});return Ks(t,i)}function qN(t,e){if(!zp(e))throw new Error("Invalid input to safeExtend: expected a plain object");const r={...t._zod.def,get shape(){const n={...t._zod.def.shape,...e};return _d(this,"shape",n),n},checks:t._zod.def.checks};return Ks(t,r)}function YN(t,e){const r=Xc(t._zod.def,{get shape(){const n={...t._zod.def.shape,...e._zod.def.shape};return _d(this,"shape",n),n},get catchall(){return e._zod.def.catchall},checks:[]});return Ks(t,r)}function JN(t,e,r){const n=Xc(e._zod.def,{get shape(){const i=e._zod.def.shape,a={...i};if(r)for(const o in r){if(!(o in i))throw new Error(`Unrecognized key: "${o}"`);r[o]&&(a[o]=t?new t({type:"optional",innerType:i[o]}):i[o])}else for(const o in i)a[o]=t?new t({type:"optional",innerType:i[o]}):i[o];return _d(this,"shape",a),a},checks:[]});return Ks(e,n)}function KN(t,e,r){const n=Xc(e._zod.def,{get shape(){const i=e._zod.def.shape,a={...i};if(r)for(const o in r){if(!(o in a))throw new Error(`Unrecognized key: "${o}"`);r[o]&&(a[o]=new t({type:"nonoptional",innerType:i[o]}))}else for(const o in i)a[o]=new t({type:"nonoptional",innerType:i[o]});return _d(this,"shape",a),a},checks:[]});return Ks(e,n)}function fp(t,e=0){if(t.aborted===!0)return!0;for(let r=e;r<t.issues.length;r++)if(t.issues[r]?.continue!==!0)return!0;return!1}function Tl(t,e){return e.map(r=>{var n;return(n=r).path??(n.path=[]),r.path.unshift(t),r})}function Dy(t){return typeof t=="string"?t:t?.message}function Rl(t,e,r){const n={...t,path:t.path??[]};if(!t.message){const i=Dy(t.inst?._zod.def?.error?.(t))??Dy(e?.error?.(t))??Dy(r.customError?.(t))??Dy(r.localeError?.(t))??"Invalid input";n.message=i}return delete n.inst,delete n.continue,e?.reportInput||delete n.input,n}function OA(t){return t instanceof Set?"set":t instanceof Map?"map":t instanceof File?"file":"unknown"}function BA(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function Sg(...t){const[e,r,n]=t;return typeof e=="string"?{message:e,code:"custom",input:r,inst:n}:{...e}}function yhe(t){return Object.entries(t).filter(([e,r])=>Number.isNaN(Number.parseInt(e,10))).map(e=>e[1])}function QN(t){const e=atob(t),r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return r}function e$(t){let e="";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return btoa(e)}function vhe(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),r="=".repeat((4-e.length%4)%4);return QN(e+r)}function _he(t){return e$(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function xhe(t){const e=t.replace(/^0x/,"");if(e.length%2!==0)throw new Error("Invalid hex string length");const r=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2)r[n/2]=Number.parseInt(e.slice(n,n+2),16);return r}function bhe(t){return Array.from(t).map(e=>e.toString(16).padStart(2,"0")).join("")}class whe{constructor(...e){}}const t$=Object.freeze(Object.defineProperty({__proto__:null,BIGINT_FORMAT_RANGES:ZN,Class:whe,NUMBER_FORMAT_RANGES:GN,aborted:fp,allowsEval:UN,assert:lhe,assertEqual:ihe,assertIs:ohe,assertNever:she,assertNotEqual:ahe,assignProp:_d,base64ToUint8Array:QN,base64urlToUint8Array:vhe,cached:Z1,captureStackTrace:DP,cleanEnum:yhe,cleanRegex:DA,clone:Ks,cloneDef:che,createTransparentProxy:ghe,defineLazy:Vr,esc:OC,escapeRegex:sd,extend:XN,finalizeIssue:Rl,floatSafeRemainder:$N,getElementAtPath:hhe,getEnumValues:PP,getLengthableOrigin:BA,getParsedType:mhe,getSizableOrigin:OA,hexToUint8Array:xhe,isObject:Ag,isPlainObject:zp,issue:Sg,joinValues:gt,jsonStringifyReplacer:d4,merge:YN,mergeDefs:Xc,normalizeParams:et,nullish:Hp,numKeys:fhe,objectClone:uhe,omit:HN,optionalKeys:VN,partial:JN,pick:WN,prefixIssues:Tl,primitiveTypes:jN,promiseAllObject:dhe,propertyKeyTypes:p4,randomString:phe,required:KN,safeExtend:qN,shallowClone:kA,stringifyPrimitive:yr,uint8ArrayToBase64:e$,uint8ArrayToBase64url:_he,uint8ArrayToHex:bhe,unwrapMessage:Dy},Symbol.toStringTag,{value:"Module"})),r$=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),t.message=JSON.stringify(e,d4,2),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},kP=Ie("$ZodError",r$),Es=Ie("$ZodError",r$,{Parent:Error});function OP(t,e=r=>r.message){const r={},n=[];for(const i of t.issues)i.path.length>0?(r[i.path[0]]=r[i.path[0]]||[],r[i.path[0]].push(e(i))):n.push(e(i));return{formErrors:n,fieldErrors:r}}function BP(t,e=r=>r.message){const r={_errors:[]},n=i=>{for(const a of i.issues)if(a.code==="invalid_union"&&a.errors.length)a.errors.map(o=>n({issues:o}));else if(a.code==="invalid_key")n({issues:a.issues});else if(a.code==="invalid_element")n({issues:a.issues});else if(a.path.length===0)r._errors.push(e(a));else{let o=r,s=0;for(;s<a.path.length;){const l=a.path[s];s===a.path.length-1?(o[l]=o[l]||{_errors:[]},o[l]._errors.push(e(a))):o[l]=o[l]||{_errors:[]},o=o[l],s++}}};return n(t),r}function n$(t,e=r=>r.message){const r={errors:[]},n=(i,a=[])=>{var o,s;for(const l of i.issues)if(l.code==="invalid_union"&&l.errors.length)l.errors.map(u=>n({issues:u},l.path));else if(l.code==="invalid_key")n({issues:l.issues},l.path);else if(l.code==="invalid_element")n({issues:l.issues},l.path);else{const u=[...a,...l.path];if(u.length===0){r.errors.push(e(l));continue}let c=r,h=0;for(;h<u.length;){const d=u[h],p=h===u.length-1;typeof d=="string"?(c.properties??(c.properties={}),(o=c.properties)[d]??(o[d]={errors:[]}),c=c.properties[d]):(c.items??(c.items=[]),(s=c.items)[d]??(s[d]={errors:[]}),c=c.items[d]),p&&c.errors.push(e(l)),h++}}};return n(t),r}function i$(t){const e=[],r=t.map(n=>typeof n=="object"?n.key:n);for(const n of r)typeof n=="number"?e.push(`[${n}]`):typeof n=="symbol"?e.push(`[${JSON.stringify(String(n))}]`):/[^\w$]/.test(n)?e.push(`[${JSON.stringify(n)}]`):(e.length&&e.push("."),e.push(n));return e.join("")}function a$(t){const e=[],r=[...t.issues].sort((n,i)=>(n.path??[]).length-(i.path??[]).length);for(const n of r)e.push(` ${n.message}`),n.path?.length&&e.push(`   at ${i$(n.path)}`);return e.join(`
`)}const W1=t=>(e,r,n,i)=>{const a=n?Object.assign(n,{async:!1}):{async:!1},o=e._zod.run({value:r,issues:[]},a);if(o instanceof Promise)throw new Ep;if(o.issues.length){const s=new(i?.Err??t)(o.issues.map(l=>Rl(l,a,xo())));throw DP(s,i?.callee),s}return o.value},BC=W1(Es),H1=t=>async(e,r,n,i)=>{const a=n?Object.assign(n,{async:!0}):{async:!0};let o=e._zod.run({value:r,issues:[]},a);if(o instanceof Promise&&(o=await o),o.issues.length){const s=new(i?.Err??t)(o.issues.map(l=>Rl(l,a,xo())));throw DP(s,i?.callee),s}return o.value},zC=H1(Es),X1=t=>(e,r,n)=>{const i=n?{...n,async:!1}:{async:!1},a=e._zod.run({value:r,issues:[]},i);if(a instanceof Promise)throw new Ep;return a.issues.length?{success:!1,error:new(t??kP)(a.issues.map(o=>Rl(o,i,xo())))}:{success:!0,data:a.value}},o$=X1(Es),q1=t=>async(e,r,n)=>{const i=n?Object.assign(n,{async:!0}):{async:!0};let a=e._zod.run({value:r,issues:[]},i);return a instanceof Promise&&(a=await a),a.issues.length?{success:!1,error:new t(a.issues.map(o=>Rl(o,i,xo())))}:{success:!0,data:a.value}},s$=q1(Es),zP=t=>(e,r,n)=>{const i=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return W1(t)(e,r,i)},Ahe=zP(Es),FP=t=>(e,r,n)=>W1(t)(e,r,n),She=FP(Es),RP=t=>async(e,r,n)=>{const i=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return H1(t)(e,r,i)},Ehe=RP(Es),LP=t=>async(e,r,n)=>H1(t)(e,r,n),Ihe=LP(Es),NP=t=>(e,r,n)=>{const i=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return X1(t)(e,r,i)},Che=NP(Es),$P=t=>(e,r,n)=>X1(t)(e,r,n),Mhe=$P(Es),UP=t=>async(e,r,n)=>{const i=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return q1(t)(e,r,i)},The=UP(Es),jP=t=>async(e,r,n)=>q1(t)(e,r,n),Phe=jP(Es),l$=/^[cC][^\s-]{8,}$/,u$=/^[0-9a-z]+$/,c$=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,h$=/^[0-9a-vA-V]{20}$/,d$=/^[A-Za-z0-9]{27}$/,p$=/^[a-zA-Z0-9_-]{21}$/,f$=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,Dhe=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,m$=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Eg=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,khe=Eg(4),Ohe=Eg(6),Bhe=Eg(7),g$=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,zhe=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Fhe=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,y$=/^[^\s@"]{1,64}@[^\s@]{1,255}$/u,Rhe=y$,Lhe=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Nhe="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function v$(){return new RegExp(Nhe,"u")}const _$=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,x$=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,b$=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,w$=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,A$=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,VP=/^[A-Za-z0-9_-]*$/,GP=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,S$=/^([a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/,E$=/^\+(?:[0-9]){6,14}[0-9]$/,I$="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",C$=new RegExp(`^${I$}$`);function M$(t){const e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${e}`:t.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function T$(t){return new RegExp(`^${M$(t)}$`)}function P$(t){const e=M$({precision:t.precision}),r=["Z"];t.local&&r.push(""),t.offset&&r.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const n=`${e}(?:${r.join("|")})`;return new RegExp(`^${I$}T(?:${n})$`)}const D$=t=>{const e=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)},k$=/^-?\d+n?$/,O$=/^-?\d+$/,B$=/^-?\d+(?:\.\d+)?/,z$=/^(?:true|false)$/i,F$=/^null$/i,R$=/^undefined$/i,L$=/^[^A-Z]*$/,N$=/^[^a-z]*$/,$$=/^[0-9a-fA-F]*$/;function Y1(t,e){return new RegExp(`^[A-Za-z0-9+/]{${t}}${e}$`)}function J1(t){return new RegExp(`^[A-Za-z0-9_-]{${t}}$`)}const $he=/^[0-9a-fA-F]{32}$/,Uhe=Y1(22,"=="),jhe=J1(22),Vhe=/^[0-9a-fA-F]{40}$/,Ghe=Y1(27,"="),Zhe=J1(27),Whe=/^[0-9a-fA-F]{64}$/,Hhe=Y1(43,"="),Xhe=J1(43),qhe=/^[0-9a-fA-F]{96}$/,Yhe=Y1(64,""),Jhe=J1(64),Khe=/^[0-9a-fA-F]{128}$/,Qhe=Y1(86,"=="),ede=J1(86),ZP=Object.freeze(Object.defineProperty({__proto__:null,base64:A$,base64url:VP,bigint:k$,boolean:z$,browserEmail:Lhe,cidrv4:b$,cidrv6:w$,cuid:l$,cuid2:u$,date:C$,datetime:P$,domain:S$,duration:f$,e164:E$,email:g$,emoji:v$,extendedDuration:Dhe,guid:m$,hex:$$,hostname:GP,html5Email:zhe,idnEmail:Rhe,integer:O$,ipv4:_$,ipv6:x$,ksuid:d$,lowercase:L$,md5_base64:Uhe,md5_base64url:jhe,md5_hex:$he,nanoid:p$,null:F$,number:B$,rfc5322Email:Fhe,sha1_base64:Ghe,sha1_base64url:Zhe,sha1_hex:Vhe,sha256_base64:Hhe,sha256_base64url:Xhe,sha256_hex:Whe,sha384_base64:Yhe,sha384_base64url:Jhe,sha384_hex:qhe,sha512_base64:Qhe,sha512_base64url:ede,sha512_hex:Khe,string:D$,time:T$,ulid:c$,undefined:R$,unicodeEmail:y$,uppercase:N$,uuid:Eg,uuid4:khe,uuid6:Ohe,uuid7:Bhe,xid:h$},Symbol.toStringTag,{value:"Module"})),Ri=Ie("$ZodCheck",(t,e)=>{var r;t._zod??(t._zod={}),t._zod.def=e,(r=t._zod).onattach??(r.onattach=[])}),U$={number:"number",bigint:"bigint",object:"date"},WP=Ie("$ZodCheckLessThan",(t,e)=>{Ri.init(t,e);const r=U$[typeof e.value];t._zod.onattach.push(n=>{const i=n._zod.bag,a=(e.inclusive?i.maximum:i.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<a&&(e.inclusive?i.maximum=e.value:i.exclusiveMaximum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value<=e.value:n.value<e.value)||n.issues.push({origin:r,code:"too_big",maximum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),HP=Ie("$ZodCheckGreaterThan",(t,e)=>{Ri.init(t,e);const r=U$[typeof e.value];t._zod.onattach.push(n=>{const i=n._zod.bag,a=(e.inclusive?i.minimum:i.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>a&&(e.inclusive?i.minimum=e.value:i.exclusiveMinimum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value>=e.value:n.value>e.value)||n.issues.push({origin:r,code:"too_small",minimum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),j$=Ie("$ZodCheckMultipleOf",(t,e)=>{Ri.init(t,e),t._zod.onattach.push(r=>{var n;(n=r._zod.bag).multipleOf??(n.multipleOf=e.value)}),t._zod.check=r=>{if(typeof r.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%e.value===BigInt(0):$N(r.value,e.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:e.value,input:r.value,inst:t,continue:!e.abort})}}),V$=Ie("$ZodCheckNumberFormat",(t,e)=>{Ri.init(t,e),e.format=e.format||"float64";const r=e.format?.includes("int"),n=r?"int":"number",[i,a]=GN[e.format];t._zod.onattach.push(o=>{const s=o._zod.bag;s.format=e.format,s.minimum=i,s.maximum=a,r&&(s.pattern=O$)}),t._zod.check=o=>{const s=o.value;if(r){if(!Number.isInteger(s)){o.issues.push({expected:n,format:e.format,code:"invalid_type",continue:!1,input:s,inst:t});return}if(!Number.isSafeInteger(s)){s>0?o.issues.push({input:s,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort}):o.issues.push({input:s,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort});return}}s<i&&o.issues.push({origin:"number",input:s,code:"too_small",minimum:i,inclusive:!0,inst:t,continue:!e.abort}),s>a&&o.issues.push({origin:"number",input:s,code:"too_big",maximum:a,inst:t})}}),G$=Ie("$ZodCheckBigIntFormat",(t,e)=>{Ri.init(t,e);const[r,n]=ZN[e.format];t._zod.onattach.push(i=>{const a=i._zod.bag;a.format=e.format,a.minimum=r,a.maximum=n}),t._zod.check=i=>{const a=i.value;a<r&&i.issues.push({origin:"bigint",input:a,code:"too_small",minimum:r,inclusive:!0,inst:t,continue:!e.abort}),a>n&&i.issues.push({origin:"bigint",input:a,code:"too_big",maximum:n,inst:t})}}),Z$=Ie("$ZodCheckMaxSize",(t,e)=>{var r;Ri.init(t,e),(r=t._zod.def).when??(r.when=n=>{const i=n.value;return!Hp(i)&&i.size!==void 0}),t._zod.onattach.push(n=>{const i=n._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<i&&(n._zod.bag.maximum=e.maximum)}),t._zod.check=n=>{const i=n.value;i.size<=e.maximum||n.issues.push({origin:OA(i),code:"too_big",maximum:e.maximum,inclusive:!0,input:i,inst:t,continue:!e.abort})}}),W$=Ie("$ZodCheckMinSize",(t,e)=>{var r;Ri.init(t,e),(r=t._zod.def).when??(r.when=n=>{const i=n.value;return!Hp(i)&&i.size!==void 0}),t._zod.onattach.push(n=>{const i=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>i&&(n._zod.bag.minimum=e.minimum)}),t._zod.check=n=>{const i=n.value;i.size>=e.minimum||n.issues.push({origin:OA(i),code:"too_small",minimum:e.minimum,inclusive:!0,input:i,inst:t,continue:!e.abort})}}),H$=Ie("$ZodCheckSizeEquals",(t,e)=>{var r;Ri.init(t,e),(r=t._zod.def).when??(r.when=n=>{const i=n.value;return!Hp(i)&&i.size!==void 0}),t._zod.onattach.push(n=>{const i=n._zod.bag;i.minimum=e.size,i.maximum=e.size,i.size=e.size}),t._zod.check=n=>{const i=n.value,a=i.size;if(a===e.size)return;const o=a>e.size;n.issues.push({origin:OA(i),...o?{code:"too_big",maximum:e.size}:{code:"too_small",minimum:e.size},inclusive:!0,exact:!0,input:n.value,inst:t,continue:!e.abort})}}),X$=Ie("$ZodCheckMaxLength",(t,e)=>{var r;Ri.init(t,e),(r=t._zod.def).when??(r.when=n=>{const i=n.value;return!Hp(i)&&i.length!==void 0}),t._zod.onattach.push(n=>{const i=n._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<i&&(n._zod.bag.maximum=e.maximum)}),t._zod.check=n=>{const i=n.value;if(i.length<=e.maximum)return;const o=BA(i);n.issues.push({origin:o,code:"too_big",maximum:e.maximum,inclusive:!0,input:i,inst:t,continue:!e.abort})}}),q$=Ie("$ZodCheckMinLength",(t,e)=>{var r;Ri.init(t,e),(r=t._zod.def).when??(r.when=n=>{const i=n.value;return!Hp(i)&&i.length!==void 0}),t._zod.onattach.push(n=>{const i=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>i&&(n._zod.bag.minimum=e.minimum)}),t._zod.check=n=>{const i=n.value;if(i.length>=e.minimum)return;const o=BA(i);n.issues.push({origin:o,code:"too_small",minimum:e.minimum,inclusive:!0,input:i,inst:t,continue:!e.abort})}}),Y$=Ie("$ZodCheckLengthEquals",(t,e)=>{var r;Ri.init(t,e),(r=t._zod.def).when??(r.when=n=>{const i=n.value;return!Hp(i)&&i.length!==void 0}),t._zod.onattach.push(n=>{const i=n._zod.bag;i.minimum=e.length,i.maximum=e.length,i.length=e.length}),t._zod.check=n=>{const i=n.value,a=i.length;if(a===e.length)return;const o=BA(i),s=a>e.length;n.issues.push({origin:o,...s?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:n.value,inst:t,continue:!e.abort})}}),K1=Ie("$ZodCheckStringFormat",(t,e)=>{var r,n;Ri.init(t,e),t._zod.onattach.push(i=>{const a=i._zod.bag;a.format=e.format,e.pattern&&(a.patterns??(a.patterns=new Set),a.patterns.add(e.pattern))}),e.pattern?(r=t._zod).check??(r.check=i=>{e.pattern.lastIndex=0,!e.pattern.test(i.value)&&i.issues.push({origin:"string",code:"invalid_format",format:e.format,input:i.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(n=t._zod).check??(n.check=()=>{})}),J$=Ie("$ZodCheckRegex",(t,e)=>{K1.init(t,e),t._zod.check=r=>{e.pattern.lastIndex=0,!e.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),K$=Ie("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=L$),K1.init(t,e)}),Q$=Ie("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=N$),K1.init(t,e)}),eU=Ie("$ZodCheckIncludes",(t,e)=>{Ri.init(t,e);const r=sd(e.includes),n=new RegExp(typeof e.position=="number"?`^.{${e.position}}${r}`:r);e.pattern=n,t._zod.onattach.push(i=>{const a=i._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(n)}),t._zod.check=i=>{i.value.includes(e.includes,e.position)||i.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:i.value,inst:t,continue:!e.abort})}}),tU=Ie("$ZodCheckStartsWith",(t,e)=>{Ri.init(t,e);const r=new RegExp(`^${sd(e.prefix)}.*`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{const i=n._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(r)}),t._zod.check=n=>{n.value.startsWith(e.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:n.value,inst:t,continue:!e.abort})}}),rU=Ie("$ZodCheckEndsWith",(t,e)=>{Ri.init(t,e);const r=new RegExp(`.*${sd(e.suffix)}$`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{const i=n._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(r)}),t._zod.check=n=>{n.value.endsWith(e.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:n.value,inst:t,continue:!e.abort})}});function rz(t,e,r){t.issues.length&&e.issues.push(...Tl(r,t.issues))}const nU=Ie("$ZodCheckProperty",(t,e)=>{Ri.init(t,e),t._zod.check=r=>{const n=e.schema._zod.run({value:r.value[e.property],issues:[]},{});if(n instanceof Promise)return n.then(i=>rz(i,r,e.property));rz(n,r,e.property)}}),iU=Ie("$ZodCheckMimeType",(t,e)=>{Ri.init(t,e);const r=new Set(e.mime);t._zod.onattach.push(n=>{n._zod.bag.mime=e.mime}),t._zod.check=n=>{r.has(n.value.type)||n.issues.push({code:"invalid_value",values:e.mime,input:n.value.type,inst:t,continue:!e.abort})}}),aU=Ie("$ZodCheckOverwrite",(t,e)=>{Ri.init(t,e),t._zod.check=r=>{r.value=e.tx(r.value)}});class oU{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}const n=e.split(`
`).filter(o=>o),i=Math.min(...n.map(o=>o.length-o.trimStart().length)),a=n.map(o=>o.slice(i)).map(o=>" ".repeat(this.indent*2)+o);for(const o of a)this.content.push(o)}compile(){const e=Function,r=this?.args,i=[...(this?.content??[""]).map(a=>`  ${a}`)];return new e(...r,i.join(`
`))}}const sU={major:4,minor:1,patch:12},_r=Ie("$ZodType",(t,e)=>{var r;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=sU;const n=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&n.unshift(t);for(const i of n)for(const a of i._zod.onattach)a(t);if(n.length===0)(r=t._zod).deferred??(r.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{const i=(o,s,l)=>{let u=fp(o),c;for(const h of s){if(h._zod.def.when){if(!h._zod.def.when(o))continue}else if(u)continue;const d=o.issues.length,p=h._zod.check(o);if(p instanceof Promise&&l?.async===!1)throw new Ep;if(c||p instanceof Promise)c=(c??Promise.resolve()).then(async()=>{await p,o.issues.length!==d&&(u||(u=fp(o,d)))});else{if(o.issues.length===d)continue;u||(u=fp(o,d))}}return c?c.then(()=>o):o},a=(o,s,l)=>{if(fp(o))return o.aborted=!0,o;const u=i(s,n,l);if(u instanceof Promise){if(l.async===!1)throw new Ep;return u.then(c=>t._zod.parse(c,l))}return t._zod.parse(u,l)};t._zod.run=(o,s)=>{if(s.skipChecks)return t._zod.parse(o,s);if(s.direction==="backward"){const u=t._zod.parse({value:o.value,issues:[]},{...s,skipChecks:!0});return u instanceof Promise?u.then(c=>a(c,o,s)):a(u,o,s)}const l=t._zod.parse(o,s);if(l instanceof Promise){if(s.async===!1)throw new Ep;return l.then(u=>i(u,n,s))}return i(l,n,s)}}t["~standard"]={validate:i=>{try{const a=o$(t,i);return a.success?{value:a.data}:{issues:a.error?.issues}}catch{return s$(t,i).then(o=>o.success?{value:o.data}:{issues:o.error?.issues})}},vendor:"zod",version:1}}),Q1=Ie("$ZodString",(t,e)=>{_r.init(t,e),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??D$(t._zod.bag),t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:t}),r}}),Jn=Ie("$ZodStringFormat",(t,e)=>{K1.init(t,e),Q1.init(t,e)}),lU=Ie("$ZodGUID",(t,e)=>{e.pattern??(e.pattern=m$),Jn.init(t,e)}),uU=Ie("$ZodUUID",(t,e)=>{if(e.version){const n={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(n===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=Eg(n))}else e.pattern??(e.pattern=Eg());Jn.init(t,e)}),cU=Ie("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=g$),Jn.init(t,e)}),hU=Ie("$ZodURL",(t,e)=>{Jn.init(t,e),t._zod.check=r=>{try{const n=r.value.trim(),i=new URL(n);e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(i.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:GP.source,input:r.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(i.protocol.endsWith(":")?i.protocol.slice(0,-1):i.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:r.value,inst:t,continue:!e.abort})),e.normalize?r.value=i.href:r.value=n;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:t,continue:!e.abort})}}}),dU=Ie("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=v$()),Jn.init(t,e)}),pU=Ie("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=p$),Jn.init(t,e)}),fU=Ie("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=l$),Jn.init(t,e)}),mU=Ie("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=u$),Jn.init(t,e)}),gU=Ie("$ZodULID",(t,e)=>{e.pattern??(e.pattern=c$),Jn.init(t,e)}),yU=Ie("$ZodXID",(t,e)=>{e.pattern??(e.pattern=h$),Jn.init(t,e)}),vU=Ie("$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=d$),Jn.init(t,e)}),_U=Ie("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=P$(e)),Jn.init(t,e)}),xU=Ie("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=C$),Jn.init(t,e)}),bU=Ie("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=T$(e)),Jn.init(t,e)}),wU=Ie("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=f$),Jn.init(t,e)}),AU=Ie("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=_$),Jn.init(t,e),t._zod.onattach.push(r=>{const n=r._zod.bag;n.format="ipv4"})}),SU=Ie("$ZodIPv6",(t,e)=>{e.pattern??(e.pattern=x$),Jn.init(t,e),t._zod.onattach.push(r=>{const n=r._zod.bag;n.format="ipv6"}),t._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:t,continue:!e.abort})}}}),EU=Ie("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=b$),Jn.init(t,e)}),IU=Ie("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=w$),Jn.init(t,e),t._zod.check=r=>{const n=r.value.split("/");try{if(n.length!==2)throw new Error;const[i,a]=n;if(!a)throw new Error;const o=Number(a);if(`${o}`!==a)throw new Error;if(o<0||o>128)throw new Error;new URL(`http://[${i}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:t,continue:!e.abort})}}});function XP(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}const CU=Ie("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=A$),Jn.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64"}),t._zod.check=r=>{XP(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:t,continue:!e.abort})}});function MU(t){if(!VP.test(t))return!1;const e=t.replace(/[-_]/g,n=>n==="-"?"+":"/"),r=e.padEnd(Math.ceil(e.length/4)*4,"=");return XP(r)}const TU=Ie("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=VP),Jn.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64url"}),t._zod.check=r=>{MU(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:t,continue:!e.abort})}}),PU=Ie("$ZodE164",(t,e)=>{e.pattern??(e.pattern=E$),Jn.init(t,e)});function DU(t,e=null){try{const r=t.split(".");if(r.length!==3)return!1;const[n]=r;if(!n)return!1;const i=JSON.parse(atob(n));return!("typ"in i&&i?.typ!=="JWT"||!i.alg||e&&(!("alg"in i)||i.alg!==e))}catch{return!1}}const kU=Ie("$ZodJWT",(t,e)=>{Jn.init(t,e),t._zod.check=r=>{DU(r.value,e.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:t,continue:!e.abort})}}),OU=Ie("$ZodCustomStringFormat",(t,e)=>{Jn.init(t,e),t._zod.check=r=>{e.fn(r.value)||r.issues.push({code:"invalid_format",format:e.format,input:r.value,inst:t,continue:!e.abort})}}),qP=Ie("$ZodNumber",(t,e)=>{_r.init(t,e),t._zod.pattern=t._zod.bag.pattern??B$,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=Number(r.value)}catch{}const i=r.value;if(typeof i=="number"&&!Number.isNaN(i)&&Number.isFinite(i))return r;const a=typeof i=="number"?Number.isNaN(i)?"NaN":Number.isFinite(i)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:i,inst:t,...a?{received:a}:{}}),r}}),BU=Ie("$ZodNumber",(t,e)=>{V$.init(t,e),qP.init(t,e)}),YP=Ie("$ZodBoolean",(t,e)=>{_r.init(t,e),t._zod.pattern=z$,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=!!r.value}catch{}const i=r.value;return typeof i=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:i,inst:t}),r}}),JP=Ie("$ZodBigInt",(t,e)=>{_r.init(t,e),t._zod.pattern=k$,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=BigInt(r.value)}catch{}return typeof r.value=="bigint"||r.issues.push({expected:"bigint",code:"invalid_type",input:r.value,inst:t}),r}}),zU=Ie("$ZodBigInt",(t,e)=>{G$.init(t,e),JP.init(t,e)}),FU=Ie("$ZodSymbol",(t,e)=>{_r.init(t,e),t._zod.parse=(r,n)=>{const i=r.value;return typeof i=="symbol"||r.issues.push({expected:"symbol",code:"invalid_type",input:i,inst:t}),r}}),RU=Ie("$ZodUndefined",(t,e)=>{_r.init(t,e),t._zod.pattern=R$,t._zod.values=new Set([void 0]),t._zod.optin="optional",t._zod.optout="optional",t._zod.parse=(r,n)=>{const i=r.value;return typeof i>"u"||r.issues.push({expected:"undefined",code:"invalid_type",input:i,inst:t}),r}}),LU=Ie("$ZodNull",(t,e)=>{_r.init(t,e),t._zod.pattern=F$,t._zod.values=new Set([null]),t._zod.parse=(r,n)=>{const i=r.value;return i===null||r.issues.push({expected:"null",code:"invalid_type",input:i,inst:t}),r}}),NU=Ie("$ZodAny",(t,e)=>{_r.init(t,e),t._zod.parse=r=>r}),$U=Ie("$ZodUnknown",(t,e)=>{_r.init(t,e),t._zod.parse=r=>r}),UU=Ie("$ZodNever",(t,e)=>{_r.init(t,e),t._zod.parse=(r,n)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:t}),r)}),jU=Ie("$ZodVoid",(t,e)=>{_r.init(t,e),t._zod.parse=(r,n)=>{const i=r.value;return typeof i>"u"||r.issues.push({expected:"void",code:"invalid_type",input:i,inst:t}),r}}),VU=Ie("$ZodDate",(t,e)=>{_r.init(t,e),t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=new Date(r.value)}catch{}const i=r.value,a=i instanceof Date;return a&&!Number.isNaN(i.getTime())||r.issues.push({expected:"date",code:"invalid_type",input:i,...a?{received:"Invalid Date"}:{},inst:t}),r}});function nz(t,e,r){t.issues.length&&e.issues.push(...Tl(r,t.issues)),e.value[r]=t.value}const GU=Ie("$ZodArray",(t,e)=>{_r.init(t,e),t._zod.parse=(r,n)=>{const i=r.value;if(!Array.isArray(i))return r.issues.push({expected:"array",code:"invalid_type",input:i,inst:t}),r;r.value=Array(i.length);const a=[];for(let o=0;o<i.length;o++){const s=i[o],l=e.element._zod.run({value:s,issues:[]},n);l instanceof Promise?a.push(l.then(u=>nz(u,r,o))):nz(l,r,o)}return a.length?Promise.all(a).then(()=>r):r}});function f4(t,e,r,n){t.issues.length&&e.issues.push(...Tl(r,t.issues)),t.value===void 0?r in n&&(e.value[r]=void 0):e.value[r]=t.value}function ZU(t){const e=Object.keys(t.shape);for(const n of e)if(!t.shape?.[n]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${n}": expected a Zod schema`);const r=VN(t.shape);return{...t,keys:e,keySet:new Set(e),numKeys:e.length,optionalKeys:new Set(r)}}function WU(t,e,r,n,i,a){const o=[],s=i.keySet,l=i.catchall._zod,u=l.def.type;for(const c of Object.keys(e)){if(s.has(c))continue;if(u==="never"){o.push(c);continue}const h=l.run({value:e[c],issues:[]},n);h instanceof Promise?t.push(h.then(d=>f4(d,r,c,e))):f4(h,r,c,e)}return o.length&&r.issues.push({code:"unrecognized_keys",keys:o,input:e,inst:a}),t.length?Promise.all(t).then(()=>r):r}const HU=Ie("$ZodObject",(t,e)=>{if(_r.init(t,e),!Object.getOwnPropertyDescriptor(e,"shape")?.get){const s=e.shape;Object.defineProperty(e,"shape",{get:()=>{const l={...s};return Object.defineProperty(e,"shape",{value:l}),l}})}const n=Z1(()=>ZU(e));Vr(t._zod,"propValues",()=>{const s=e.shape,l={};for(const u in s){const c=s[u]._zod;if(c.values){l[u]??(l[u]=new Set);for(const h of c.values)l[u].add(h)}}return l});const i=Ag,a=e.catchall;let o;t._zod.parse=(s,l)=>{o??(o=n.value);const u=s.value;if(!i(u))return s.issues.push({expected:"object",code:"invalid_type",input:u,inst:t}),s;s.value={};const c=[],h=o.shape;for(const d of o.keys){const m=h[d]._zod.run({value:u[d],issues:[]},l);m instanceof Promise?c.push(m.then(y=>f4(y,s,d,u))):f4(m,s,d,u)}return a?WU(c,u,s,l,n.value,t):c.length?Promise.all(c).then(()=>s):s}}),XU=Ie("$ZodObjectJIT",(t,e)=>{HU.init(t,e);const r=t._zod.parse,n=Z1(()=>ZU(e)),i=d=>{const p=new oU(["shape","payload","ctx"]),m=n.value,y=b=>{const A=OC(b);return`shape[${A}]._zod.run({ value: input[${A}], issues: [] }, ctx)`};p.write("const input = payload.value;");const v=Object.create(null);let _=0;for(const b of m.keys)v[b]=`key_${_++}`;p.write("const newResult = {};");for(const b of m.keys){const A=v[b],E=OC(b);p.write(`const ${A} = ${y(b)};`),p.write(`
        if (${A}.issues.length) {
          payload.issues = payload.issues.concat(${A}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${E}, ...iss.path] : [${E}]
          })));
        }
        
        
        if (${A}.value === undefined) {
          if (${E} in input) {
            newResult[${E}] = undefined;
          }
        } else {
          newResult[${E}] = ${A}.value;
        }
        
      `)}p.write("payload.value = newResult;"),p.write("return payload;");const w=p.compile();return(b,A)=>w(d,b,A)};let a;const o=Ag,s=!h4.jitless,u=s&&UN.value,c=e.catchall;let h;t._zod.parse=(d,p)=>{h??(h=n.value);const m=d.value;return o(m)?s&&u&&p?.async===!1&&p.jitless!==!0?(a||(a=i(e.shape)),d=a(d,p),c?WU([],m,d,p,h,t):d):r(d,p):(d.issues.push({expected:"object",code:"invalid_type",input:m,inst:t}),d)}});function iz(t,e,r,n){for(const a of t)if(a.issues.length===0)return e.value=a.value,e;const i=t.filter(a=>!fp(a));return i.length===1?(e.value=i[0].value,i[0]):(e.issues.push({code:"invalid_union",input:e.value,inst:r,errors:t.map(a=>a.issues.map(o=>Rl(o,n,xo())))}),e)}const KP=Ie("$ZodUnion",(t,e)=>{_r.init(t,e),Vr(t._zod,"optin",()=>e.options.some(i=>i._zod.optin==="optional")?"optional":void 0),Vr(t._zod,"optout",()=>e.options.some(i=>i._zod.optout==="optional")?"optional":void 0),Vr(t._zod,"values",()=>{if(e.options.every(i=>i._zod.values))return new Set(e.options.flatMap(i=>Array.from(i._zod.values)))}),Vr(t._zod,"pattern",()=>{if(e.options.every(i=>i._zod.pattern)){const i=e.options.map(a=>a._zod.pattern);return new RegExp(`^(${i.map(a=>DA(a.source)).join("|")})$`)}});const r=e.options.length===1,n=e.options[0]._zod.run;t._zod.parse=(i,a)=>{if(r)return n(i,a);let o=!1;const s=[];for(const l of e.options){const u=l._zod.run({value:i.value,issues:[]},a);if(u instanceof Promise)s.push(u),o=!0;else{if(u.issues.length===0)return u;s.push(u)}}return o?Promise.all(s).then(l=>iz(l,i,t,a)):iz(s,i,t,a)}}),qU=Ie("$ZodDiscriminatedUnion",(t,e)=>{KP.init(t,e);const r=t._zod.parse;Vr(t._zod,"propValues",()=>{const i={};for(const a of e.options){const o=a._zod.propValues;if(!o||Object.keys(o).length===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(a)}"`);for(const[s,l]of Object.entries(o)){i[s]||(i[s]=new Set);for(const u of l)i[s].add(u)}}return i});const n=Z1(()=>{const i=e.options,a=new Map;for(const o of i){const s=o._zod.propValues?.[e.discriminator];if(!s||s.size===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(o)}"`);for(const l of s){if(a.has(l))throw new Error(`Duplicate discriminator value "${String(l)}"`);a.set(l,o)}}return a});t._zod.parse=(i,a)=>{const o=i.value;if(!Ag(o))return i.issues.push({code:"invalid_type",expected:"object",input:o,inst:t}),i;const s=n.value.get(o?.[e.discriminator]);return s?s._zod.run(i,a):e.unionFallback?r(i,a):(i.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",discriminator:e.discriminator,input:o,path:[e.discriminator],inst:t}),i)}}),YU=Ie("$ZodIntersection",(t,e)=>{_r.init(t,e),t._zod.parse=(r,n)=>{const i=r.value,a=e.left._zod.run({value:i,issues:[]},n),o=e.right._zod.run({value:i,issues:[]},n);return a instanceof Promise||o instanceof Promise?Promise.all([a,o]).then(([l,u])=>az(r,l,u)):az(r,a,o)}});function FC(t,e){if(t===e)return{valid:!0,data:t};if(t instanceof Date&&e instanceof Date&&+t==+e)return{valid:!0,data:t};if(zp(t)&&zp(e)){const r=Object.keys(e),n=Object.keys(t).filter(a=>r.indexOf(a)!==-1),i={...t,...e};for(const a of n){const o=FC(t[a],e[a]);if(!o.valid)return{valid:!1,mergeErrorPath:[a,...o.mergeErrorPath]};i[a]=o.data}return{valid:!0,data:i}}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return{valid:!1,mergeErrorPath:[]};const r=[];for(let n=0;n<t.length;n++){const i=t[n],a=e[n],o=FC(i,a);if(!o.valid)return{valid:!1,mergeErrorPath:[n,...o.mergeErrorPath]};r.push(o.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function az(t,e,r){if(e.issues.length&&t.issues.push(...e.issues),r.issues.length&&t.issues.push(...r.issues),fp(t))return t;const n=FC(e.value,r.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return t.value=n.data,t}const QP=Ie("$ZodTuple",(t,e)=>{_r.init(t,e);const r=e.items,n=r.length-[...r].reverse().findIndex(i=>i._zod.optin!=="optional");t._zod.parse=(i,a)=>{const o=i.value;if(!Array.isArray(o))return i.issues.push({input:o,inst:t,expected:"tuple",code:"invalid_type"}),i;i.value=[];const s=[];if(!e.rest){const u=o.length>r.length,c=o.length<n-1;if(u||c)return i.issues.push({...u?{code:"too_big",maximum:r.length}:{code:"too_small",minimum:r.length},input:o,inst:t,origin:"array"}),i}let l=-1;for(const u of r){if(l++,l>=o.length&&l>=n)continue;const c=u._zod.run({value:o[l],issues:[]},a);c instanceof Promise?s.push(c.then(h=>wx(h,i,l))):wx(c,i,l)}if(e.rest){const u=o.slice(r.length);for(const c of u){l++;const h=e.rest._zod.run({value:c,issues:[]},a);h instanceof Promise?s.push(h.then(d=>wx(d,i,l))):wx(h,i,l)}}return s.length?Promise.all(s).then(()=>i):i}});function wx(t,e,r){t.issues.length&&e.issues.push(...Tl(r,t.issues)),e.value[r]=t.value}const JU=Ie("$ZodRecord",(t,e)=>{_r.init(t,e),t._zod.parse=(r,n)=>{const i=r.value;if(!zp(i))return r.issues.push({expected:"record",code:"invalid_type",input:i,inst:t}),r;const a=[];if(e.keyType._zod.values){const o=e.keyType._zod.values;r.value={};for(const l of o)if(typeof l=="string"||typeof l=="number"||typeof l=="symbol"){const u=e.valueType._zod.run({value:i[l],issues:[]},n);u instanceof Promise?a.push(u.then(c=>{c.issues.length&&r.issues.push(...Tl(l,c.issues)),r.value[l]=c.value})):(u.issues.length&&r.issues.push(...Tl(l,u.issues)),r.value[l]=u.value)}let s;for(const l in i)o.has(l)||(s=s??[],s.push(l));s&&s.length>0&&r.issues.push({code:"unrecognized_keys",input:i,inst:t,keys:s})}else{r.value={};for(const o of Reflect.ownKeys(i)){if(o==="__proto__")continue;const s=e.keyType._zod.run({value:o,issues:[]},n);if(s instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(s.issues.length){r.issues.push({code:"invalid_key",origin:"record",issues:s.issues.map(u=>Rl(u,n,xo())),input:o,path:[o],inst:t}),r.value[s.value]=s.value;continue}const l=e.valueType._zod.run({value:i[o],issues:[]},n);l instanceof Promise?a.push(l.then(u=>{u.issues.length&&r.issues.push(...Tl(o,u.issues)),r.value[s.value]=u.value})):(l.issues.length&&r.issues.push(...Tl(o,l.issues)),r.value[s.value]=l.value)}}return a.length?Promise.all(a).then(()=>r):r}}),KU=Ie("$ZodMap",(t,e)=>{_r.init(t,e),t._zod.parse=(r,n)=>{const i=r.value;if(!(i instanceof Map))return r.issues.push({expected:"map",code:"invalid_type",input:i,inst:t}),r;const a=[];r.value=new Map;for(const[o,s]of i){const l=e.keyType._zod.run({value:o,issues:[]},n),u=e.valueType._zod.run({value:s,issues:[]},n);l instanceof Promise||u instanceof Promise?a.push(Promise.all([l,u]).then(([c,h])=>{oz(c,h,r,o,i,t,n)})):oz(l,u,r,o,i,t,n)}return a.length?Promise.all(a).then(()=>r):r}});function oz(t,e,r,n,i,a,o){t.issues.length&&(p4.has(typeof n)?r.issues.push(...Tl(n,t.issues)):r.issues.push({code:"invalid_key",origin:"map",input:i,inst:a,issues:t.issues.map(s=>Rl(s,o,xo()))})),e.issues.length&&(p4.has(typeof n)?r.issues.push(...Tl(n,e.issues)):r.issues.push({origin:"map",code:"invalid_element",input:i,inst:a,key:n,issues:e.issues.map(s=>Rl(s,o,xo()))})),r.value.set(t.value,e.value)}const QU=Ie("$ZodSet",(t,e)=>{_r.init(t,e),t._zod.parse=(r,n)=>{const i=r.value;if(!(i instanceof Set))return r.issues.push({input:i,inst:t,expected:"set",code:"invalid_type"}),r;const a=[];r.value=new Set;for(const o of i){const s=e.valueType._zod.run({value:o,issues:[]},n);s instanceof Promise?a.push(s.then(l=>sz(l,r))):sz(s,r)}return a.length?Promise.all(a).then(()=>r):r}});function sz(t,e){t.issues.length&&e.issues.push(...t.issues),e.value.add(t.value)}const ej=Ie("$ZodEnum",(t,e)=>{_r.init(t,e);const r=PP(e.entries),n=new Set(r);t._zod.values=n,t._zod.pattern=new RegExp(`^(${r.filter(i=>p4.has(typeof i)).map(i=>typeof i=="string"?sd(i):i.toString()).join("|")})$`),t._zod.parse=(i,a)=>{const o=i.value;return n.has(o)||i.issues.push({code:"invalid_value",values:r,input:o,inst:t}),i}}),tj=Ie("$ZodLiteral",(t,e)=>{if(_r.init(t,e),e.values.length===0)throw new Error("Cannot create literal schema with no valid values");t._zod.values=new Set(e.values),t._zod.pattern=new RegExp(`^(${e.values.map(r=>typeof r=="string"?sd(r):r?sd(r.toString()):String(r)).join("|")})$`),t._zod.parse=(r,n)=>{const i=r.value;return t._zod.values.has(i)||r.issues.push({code:"invalid_value",values:e.values,input:i,inst:t}),r}}),rj=Ie("$ZodFile",(t,e)=>{_r.init(t,e),t._zod.parse=(r,n)=>{const i=r.value;return i instanceof File||r.issues.push({expected:"file",code:"invalid_type",input:i,inst:t}),r}}),nj=Ie("$ZodTransform",(t,e)=>{_r.init(t,e),t._zod.parse=(r,n)=>{if(n.direction==="backward")throw new PA(t.constructor.name);const i=e.transform(r.value,r);if(n.async)return(i instanceof Promise?i:Promise.resolve(i)).then(o=>(r.value=o,r));if(i instanceof Promise)throw new Ep;return r.value=i,r}});function lz(t,e){return t.issues.length&&e===void 0?{issues:[],value:void 0}:t}const ij=Ie("$ZodOptional",(t,e)=>{_r.init(t,e),t._zod.optin="optional",t._zod.optout="optional",Vr(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),Vr(t._zod,"pattern",()=>{const r=e.innerType._zod.pattern;return r?new RegExp(`^(${DA(r.source)})?$`):void 0}),t._zod.parse=(r,n)=>{if(e.innerType._zod.optin==="optional"){const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(a=>lz(a,r.value)):lz(i,r.value)}return r.value===void 0?r:e.innerType._zod.run(r,n)}}),aj=Ie("$ZodNullable",(t,e)=>{_r.init(t,e),Vr(t._zod,"optin",()=>e.innerType._zod.optin),Vr(t._zod,"optout",()=>e.innerType._zod.optout),Vr(t._zod,"pattern",()=>{const r=e.innerType._zod.pattern;return r?new RegExp(`^(${DA(r.source)}|null)$`):void 0}),Vr(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(r,n)=>r.value===null?r:e.innerType._zod.run(r,n)}),oj=Ie("$ZodDefault",(t,e)=>{_r.init(t,e),t._zod.optin="optional",Vr(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{if(n.direction==="backward")return e.innerType._zod.run(r,n);if(r.value===void 0)return r.value=e.defaultValue,r;const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(a=>uz(a,e)):uz(i,e)}});function uz(t,e){return t.value===void 0&&(t.value=e.defaultValue),t}const sj=Ie("$ZodPrefault",(t,e)=>{_r.init(t,e),t._zod.optin="optional",Vr(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>(n.direction==="backward"||r.value===void 0&&(r.value=e.defaultValue),e.innerType._zod.run(r,n))}),lj=Ie("$ZodNonOptional",(t,e)=>{_r.init(t,e),Vr(t._zod,"values",()=>{const r=e.innerType._zod.values;return r?new Set([...r].filter(n=>n!==void 0)):void 0}),t._zod.parse=(r,n)=>{const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(a=>cz(a,t)):cz(i,t)}});function cz(t,e){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}const uj=Ie("$ZodSuccess",(t,e)=>{_r.init(t,e),t._zod.parse=(r,n)=>{if(n.direction==="backward")throw new PA("ZodSuccess");const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(a=>(r.value=a.issues.length===0,r)):(r.value=i.issues.length===0,r)}}),cj=Ie("$ZodCatch",(t,e)=>{_r.init(t,e),Vr(t._zod,"optin",()=>e.innerType._zod.optin),Vr(t._zod,"optout",()=>e.innerType._zod.optout),Vr(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{if(n.direction==="backward")return e.innerType._zod.run(r,n);const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(a=>(r.value=a.value,a.issues.length&&(r.value=e.catchValue({...r,error:{issues:a.issues.map(o=>Rl(o,n,xo()))},input:r.value}),r.issues=[]),r)):(r.value=i.value,i.issues.length&&(r.value=e.catchValue({...r,error:{issues:i.issues.map(a=>Rl(a,n,xo()))},input:r.value}),r.issues=[]),r)}}),hj=Ie("$ZodNaN",(t,e)=>{_r.init(t,e),t._zod.parse=(r,n)=>((typeof r.value!="number"||!Number.isNaN(r.value))&&r.issues.push({input:r.value,inst:t,expected:"nan",code:"invalid_type"}),r)}),dj=Ie("$ZodPipe",(t,e)=>{_r.init(t,e),Vr(t._zod,"values",()=>e.in._zod.values),Vr(t._zod,"optin",()=>e.in._zod.optin),Vr(t._zod,"optout",()=>e.out._zod.optout),Vr(t._zod,"propValues",()=>e.in._zod.propValues),t._zod.parse=(r,n)=>{if(n.direction==="backward"){const a=e.out._zod.run(r,n);return a instanceof Promise?a.then(o=>Ax(o,e.in,n)):Ax(a,e.in,n)}const i=e.in._zod.run(r,n);return i instanceof Promise?i.then(a=>Ax(a,e.out,n)):Ax(i,e.out,n)}});function Ax(t,e,r){return t.issues.length?(t.aborted=!0,t):e._zod.run({value:t.value,issues:t.issues},r)}const eD=Ie("$ZodCodec",(t,e)=>{_r.init(t,e),Vr(t._zod,"values",()=>e.in._zod.values),Vr(t._zod,"optin",()=>e.in._zod.optin),Vr(t._zod,"optout",()=>e.out._zod.optout),Vr(t._zod,"propValues",()=>e.in._zod.propValues),t._zod.parse=(r,n)=>{if((n.direction||"forward")==="forward"){const a=e.in._zod.run(r,n);return a instanceof Promise?a.then(o=>Sx(o,e,n)):Sx(a,e,n)}else{const a=e.out._zod.run(r,n);return a instanceof Promise?a.then(o=>Sx(o,e,n)):Sx(a,e,n)}}});function Sx(t,e,r){if(t.issues.length)return t.aborted=!0,t;if((r.direction||"forward")==="forward"){const i=e.transform(t.value,t);return i instanceof Promise?i.then(a=>Ex(t,a,e.out,r)):Ex(t,i,e.out,r)}else{const i=e.reverseTransform(t.value,t);return i instanceof Promise?i.then(a=>Ex(t,a,e.in,r)):Ex(t,i,e.in,r)}}function Ex(t,e,r,n){return t.issues.length?(t.aborted=!0,t):r._zod.run({value:e,issues:t.issues},n)}const pj=Ie("$ZodReadonly",(t,e)=>{_r.init(t,e),Vr(t._zod,"propValues",()=>e.innerType._zod.propValues),Vr(t._zod,"values",()=>e.innerType._zod.values),Vr(t._zod,"optin",()=>e.innerType._zod.optin),Vr(t._zod,"optout",()=>e.innerType._zod.optout),t._zod.parse=(r,n)=>{if(n.direction==="backward")return e.innerType._zod.run(r,n);const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(hz):hz(i)}});function hz(t){return t.value=Object.freeze(t.value),t}const fj=Ie("$ZodTemplateLiteral",(t,e)=>{_r.init(t,e);const r=[];for(const n of e.parts)if(typeof n=="object"&&n!==null){if(!n._zod.pattern)throw new Error(`Invalid template literal part, no pattern found: ${[...n._zod.traits].shift()}`);const i=n._zod.pattern instanceof RegExp?n._zod.pattern.source:n._zod.pattern;if(!i)throw new Error(`Invalid template literal part: ${n._zod.traits}`);const a=i.startsWith("^")?1:0,o=i.endsWith("$")?i.length-1:i.length;r.push(i.slice(a,o))}else if(n===null||jN.has(typeof n))r.push(sd(`${n}`));else throw new Error(`Invalid template literal part: ${n}`);t._zod.pattern=new RegExp(`^${r.join("")}$`),t._zod.parse=(n,i)=>typeof n.value!="string"?(n.issues.push({input:n.value,inst:t,expected:"template_literal",code:"invalid_type"}),n):(t._zod.pattern.lastIndex=0,t._zod.pattern.test(n.value)||n.issues.push({input:n.value,inst:t,code:"invalid_format",format:e.format??"template_literal",pattern:t._zod.pattern.source}),n)}),mj=Ie("$ZodFunction",(t,e)=>(_r.init(t,e),t._def=e,t._zod.def=e,t.implement=r=>{if(typeof r!="function")throw new Error("implement() must be called with a function");return function(...n){const i=t._def.input?BC(t._def.input,n):n,a=Reflect.apply(r,this,i);return t._def.output?BC(t._def.output,a):a}},t.implementAsync=r=>{if(typeof r!="function")throw new Error("implementAsync() must be called with a function");return async function(...n){const i=t._def.input?await zC(t._def.input,n):n,a=await Reflect.apply(r,this,i);return t._def.output?await zC(t._def.output,a):a}},t._zod.parse=(r,n)=>typeof r.value!="function"?(r.issues.push({code:"invalid_type",expected:"function",input:r.value,inst:t}),r):(t._def.output&&t._def.output._zod.def.type==="promise"?r.value=t.implementAsync(r.value):r.value=t.implement(r.value),r),t.input=(...r)=>{const n=t.constructor;return Array.isArray(r[0])?new n({type:"function",input:new QP({type:"tuple",items:r[0],rest:r[1]}),output:t._def.output}):new n({type:"function",input:r[0],output:t._def.output})},t.output=r=>{const n=t.constructor;return new n({type:"function",input:t._def.input,output:r})},t)),gj=Ie("$ZodPromise",(t,e)=>{_r.init(t,e),t._zod.parse=(r,n)=>Promise.resolve(r.value).then(i=>e.innerType._zod.run({value:i,issues:[]},n))}),yj=Ie("$ZodLazy",(t,e)=>{_r.init(t,e),Vr(t._zod,"innerType",()=>e.getter()),Vr(t._zod,"pattern",()=>t._zod.innerType._zod.pattern),Vr(t._zod,"propValues",()=>t._zod.innerType._zod.propValues),Vr(t._zod,"optin",()=>t._zod.innerType._zod.optin??void 0),Vr(t._zod,"optout",()=>t._zod.innerType._zod.optout??void 0),t._zod.parse=(r,n)=>t._zod.innerType._zod.run(r,n)}),vj=Ie("$ZodCustom",(t,e)=>{Ri.init(t,e),_r.init(t,e),t._zod.parse=(r,n)=>r,t._zod.check=r=>{const n=r.value,i=e.fn(n);if(i instanceof Promise)return i.then(a=>dz(a,r,n,t));dz(i,r,n,t)}});function dz(t,e,r,n){if(!t){const i={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(i.params=n._zod.def.params),e.issues.push(Sg(i))}}const tde=()=>{const t={string:{unit:"",verb:" "},file:{unit:"",verb:" "},array:{unit:"",verb:" "},set:{unit:"",verb:" "}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"number";case"object":{if(Array.isArray(i))return"array";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"",email:" ",url:"",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"   ISO",date:"  ISO",time:"  ISO",duration:"  ISO",ipv4:" IPv4",ipv6:" IPv6",cidrv4:"   IPv4",cidrv6:"   IPv6",base64:"  base64-encoded",base64url:"  base64url-encoded",json_string:"   JSON",e164:"   E.164",jwt:"JWT",template_literal:""};return i=>{switch(i.code){case"invalid_type":return`  :   ${i.expected}    ${r(i.input)}`;case"invalid_value":return i.values.length===1?`  :   ${yr(i.values[0])}`:`  :     : ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?`   :    ${i.origin??""} ${a} ${i.maximum.toString()} ${o.unit??""}`:`  :    ${i.origin??""} ${a} ${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?`  :   ${i.origin}   ${a} ${i.minimum.toString()} ${o.unit}`:`  :   ${i.origin}   ${a} ${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?`  :     "${i.prefix}"`:a.format==="ends_with"?`  :     "${a.suffix}"`:a.format==="includes"?`  :    "${a.includes}"`:a.format==="regex"?`  :     ${a.pattern}`:`${n[a.format]??i.format}  `}case"not_multiple_of":return`  :      ${i.divisor}`;case"unrecognized_keys":return`${i.keys.length>1?"":""} ${i.keys.length>1?"":""}: ${gt(i.keys," ")}`;case"invalid_key":return`    ${i.origin}`;case"invalid_union":return"  ";case"invalid_element":return`    ${i.origin}`;default:return"  "}}};function rde(){return{localeError:tde()}}const nde=()=>{const t={string:{unit:"simvol",verb:"olmaldr"},file:{unit:"bayt",verb:"olmaldr"},array:{unit:"element",verb:"olmaldr"},set:{unit:"element",verb:"olmaldr"}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"number";case"object":{if(Array.isArray(i))return"array";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"};return i=>{switch(i.code){case"invalid_type":return`Yanl dyr: gzlniln ${i.expected}, daxil olan ${r(i.input)}`;case"invalid_value":return i.values.length===1?`Yanl dyr: gzlniln ${yr(i.values[0])}`:`Yanl seim: aadaklardan biri olmaldr: ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?`ox byk: gzlniln ${i.origin??"dyr"} ${a}${i.maximum.toString()} ${o.unit??"element"}`:`ox byk: gzlniln ${i.origin??"dyr"} ${a}${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?`ox kiik: gzlniln ${i.origin} ${a}${i.minimum.toString()} ${o.unit}`:`ox kiik: gzlniln ${i.origin} ${a}${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?`Yanl mtn: "${a.prefix}" il balamaldr`:a.format==="ends_with"?`Yanl mtn: "${a.suffix}" il bitmlidir`:a.format==="includes"?`Yanl mtn: "${a.includes}" daxil olmaldr`:a.format==="regex"?`Yanl mtn: ${a.pattern} ablonuna uyun olmaldr`:`Yanl ${n[a.format]??i.format}`}case"not_multiple_of":return`Yanl dd: ${i.divisor} il bln biln olmaldr`;case"unrecognized_keys":return`Tannmayan aar${i.keys.length>1?"lar":""}: ${gt(i.keys,", ")}`;case"invalid_key":return`${i.origin} daxilind yanl aar`;case"invalid_union":return"Yanl dyr";case"invalid_element":return`${i.origin} daxilind yanl dyr`;default:return"Yanl dyr"}}};function ide(){return{localeError:nde()}}function pz(t,e,r,n){const i=Math.abs(t),a=i%10,o=i%100;return o>=11&&o<=19?n:a===1?e:a>=2&&a<=4?r:n}const ade=()=>{const t={string:{unit:{one:"",few:"",many:""},verb:""},array:{unit:{one:"",few:"",many:""},verb:""},set:{unit:{one:"",few:"",many:""},verb:""},file:{unit:{one:"",few:"",many:""},verb:""}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"";case"object":{if(Array.isArray(i))return"";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"",email:"email ",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO   ",date:"ISO ",time:"ISO ",duration:"ISO ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"   base64",base64url:"   base64url",json_string:"JSON ",e164:" E.164",jwt:"JWT",template_literal:""};return i=>{switch(i.code){case"invalid_type":return` :  ${i.expected},  ${r(i.input)}`;case"invalid_value":return i.values.length===1?` :  ${yr(i.values[0])}`:` :    ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);if(o){const s=Number(i.maximum),l=pz(s,o.unit.one,o.unit.few,o.unit.many);return` : ,  ${i.origin??""}  ${o.verb} ${a}${i.maximum.toString()} ${l}`}return` : ,  ${i.origin??""}   ${a}${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);if(o){const s=Number(i.minimum),l=pz(s,o.unit.one,o.unit.few,o.unit.many);return` : ,  ${i.origin}  ${o.verb} ${a}${i.minimum.toString()} ${l}`}return` : ,  ${i.origin}   ${a}${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?` :    "${a.prefix}"`:a.format==="ends_with"?` :    "${a.suffix}"`:a.format==="includes"?` :   "${a.includes}"`:a.format==="regex"?` :    ${a.pattern}`:` ${n[a.format]??i.format}`}case"not_multiple_of":return` :    ${i.divisor}`;case"unrecognized_keys":return` ${i.keys.length>1?"":""}: ${gt(i.keys,", ")}`;case"invalid_key":return`   ${i.origin}`;case"invalid_union":return" ";case"invalid_element":return`   ${i.origin}`;default:return" "}}};function ode(){return{localeError:ade()}}const sde=t=>{const e=typeof t;switch(e){case"number":return Number.isNaN(t)?"NaN":"";case"object":{if(Array.isArray(t))return"";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return e},lde=()=>{const t={string:{unit:"",verb:" "},file:{unit:"",verb:" "},array:{unit:"",verb:" "},set:{unit:"",verb:" "}};function e(n){return t[n]??null}const r={regex:"",email:" ",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO ",date:"ISO ",time:"ISO ",duration:"ISO ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"base64- ",base64url:"base64url- ",json_string:"JSON ",e164:"E.164 ",jwt:"JWT",template_literal:""};return n=>{switch(n.code){case"invalid_type":return` :  ${n.expected},  ${sde(n.input)}`;case"invalid_value":return n.values.length===1?` :  ${yr(n.values[0])}`:` :    ${gt(n.values,"|")}`;case"too_big":{const i=n.inclusive?"<=":"<",a=e(n.origin);return a?` :   ${n.origin??""}   ${i}${n.maximum.toString()} ${a.unit??""}`:` :   ${n.origin??""}   ${i}${n.maximum.toString()}`}case"too_small":{const i=n.inclusive?">=":">",a=e(n.origin);return a?` :   ${n.origin}   ${i}${n.minimum.toString()} ${a.unit}`:` :   ${n.origin}   ${i}${n.minimum.toString()}`}case"invalid_format":{const i=n;if(i.format==="starts_with")return` :     "${i.prefix}"`;if(i.format==="ends_with")return` :     "${i.suffix}"`;if(i.format==="includes")return` :    "${i.includes}"`;if(i.format==="regex")return` :     ${i.pattern}`;let a="";return i.format==="emoji"&&(a=""),i.format==="datetime"&&(a=""),i.format==="date"&&(a=""),i.format==="time"&&(a=""),i.format==="duration"&&(a=""),`${a} ${r[i.format]??n.format}`}case"not_multiple_of":return` :      ${n.divisor}`;case"unrecognized_keys":return`${n.keys.length>1?"":""} ${n.keys.length>1?"":""}: ${gt(n.keys,", ")}`;case"invalid_key":return`   ${n.origin}`;case"invalid_union":return" ";case"invalid_element":return`   ${n.origin}`;default:return" "}}};function ude(){return{localeError:lde()}}const cde=()=>{const t={string:{unit:"carcters",verb:"contenir"},file:{unit:"bytes",verb:"contenir"},array:{unit:"elements",verb:"contenir"},set:{unit:"elements",verb:"contenir"}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"number";case"object":{if(Array.isArray(i))return"array";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"entrada",email:"adrea electrnica",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"data i hora ISO",date:"data ISO",time:"hora ISO",duration:"durada ISO",ipv4:"adrea IPv4",ipv6:"adrea IPv6",cidrv4:"rang IPv4",cidrv6:"rang IPv6",base64:"cadena codificada en base64",base64url:"cadena codificada en base64url",json_string:"cadena JSON",e164:"nmero E.164",jwt:"JWT",template_literal:"entrada"};return i=>{switch(i.code){case"invalid_type":return`Tipus invlid: s'esperava ${i.expected}, s'ha rebut ${r(i.input)}`;case"invalid_value":return i.values.length===1?`Valor invlid: s'esperava ${yr(i.values[0])}`:`Opci invlida: s'esperava una de ${gt(i.values," o ")}`;case"too_big":{const a=i.inclusive?"com a mxim":"menys de",o=e(i.origin);return o?`Massa gran: s'esperava que ${i.origin??"el valor"} contingus ${a} ${i.maximum.toString()} ${o.unit??"elements"}`:`Massa gran: s'esperava que ${i.origin??"el valor"} fos ${a} ${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?"com a mnim":"ms de",o=e(i.origin);return o?`Massa petit: s'esperava que ${i.origin} contingus ${a} ${i.minimum.toString()} ${o.unit}`:`Massa petit: s'esperava que ${i.origin} fos ${a} ${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?`Format invlid: ha de comenar amb "${a.prefix}"`:a.format==="ends_with"?`Format invlid: ha d'acabar amb "${a.suffix}"`:a.format==="includes"?`Format invlid: ha d'incloure "${a.includes}"`:a.format==="regex"?`Format invlid: ha de coincidir amb el patr ${a.pattern}`:`Format invlid per a ${n[a.format]??i.format}`}case"not_multiple_of":return`Nmero invlid: ha de ser mltiple de ${i.divisor}`;case"unrecognized_keys":return`Clau${i.keys.length>1?"s":""} no reconeguda${i.keys.length>1?"s":""}: ${gt(i.keys,", ")}`;case"invalid_key":return`Clau invlida a ${i.origin}`;case"invalid_union":return"Entrada invlida";case"invalid_element":return`Element invlid a ${i.origin}`;default:return"Entrada invlida"}}};function hde(){return{localeError:cde()}}const dde=()=>{const t={string:{unit:"znak",verb:"mt"},file:{unit:"bajt",verb:"mt"},array:{unit:"prvk",verb:"mt"},set:{unit:"prvk",verb:"mt"}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"slo";case"string":return"etzec";case"boolean":return"boolean";case"bigint":return"bigint";case"function":return"funkce";case"symbol":return"symbol";case"undefined":return"undefined";case"object":{if(Array.isArray(i))return"pole";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"regulrn vraz",email:"e-mailov adresa",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"datum a as ve formtu ISO",date:"datum ve formtu ISO",time:"as ve formtu ISO",duration:"doba trvn ISO",ipv4:"IPv4 adresa",ipv6:"IPv6 adresa",cidrv4:"rozsah IPv4",cidrv6:"rozsah IPv6",base64:"etzec zakdovan ve formtu base64",base64url:"etzec zakdovan ve formtu base64url",json_string:"etzec ve formtu JSON",e164:"slo E.164",jwt:"JWT",template_literal:"vstup"};return i=>{switch(i.code){case"invalid_type":return`Neplatn vstup: oekvno ${i.expected}, obdreno ${r(i.input)}`;case"invalid_value":return i.values.length===1?`Neplatn vstup: oekvno ${yr(i.values[0])}`:`Neplatn monost: oekvna jedna z hodnot ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?`Hodnota je pli velk: ${i.origin??"hodnota"} mus mt ${a}${i.maximum.toString()} ${o.unit??"prvk"}`:`Hodnota je pli velk: ${i.origin??"hodnota"} mus bt ${a}${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?`Hodnota je pli mal: ${i.origin??"hodnota"} mus mt ${a}${i.minimum.toString()} ${o.unit??"prvk"}`:`Hodnota je pli mal: ${i.origin??"hodnota"} mus bt ${a}${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?`Neplatn etzec: mus zanat na "${a.prefix}"`:a.format==="ends_with"?`Neplatn etzec: mus konit na "${a.suffix}"`:a.format==="includes"?`Neplatn etzec: mus obsahovat "${a.includes}"`:a.format==="regex"?`Neplatn etzec: mus odpovdat vzoru ${a.pattern}`:`Neplatn formt ${n[a.format]??i.format}`}case"not_multiple_of":return`Neplatn slo: mus bt nsobkem ${i.divisor}`;case"unrecognized_keys":return`Neznm kle: ${gt(i.keys,", ")}`;case"invalid_key":return`Neplatn kl v ${i.origin}`;case"invalid_union":return"Neplatn vstup";case"invalid_element":return`Neplatn hodnota v ${i.origin}`;default:return"Neplatn vstup"}}};function pde(){return{localeError:dde()}}const fde=()=>{const t={string:{unit:"tegn",verb:"havde"},file:{unit:"bytes",verb:"havde"},array:{unit:"elementer",verb:"indeholdt"},set:{unit:"elementer",verb:"indeholdt"}},e={string:"streng",number:"tal",boolean:"boolean",array:"liste",object:"objekt",set:"st",file:"fil"};function r(o){return t[o]??null}function n(o){return e[o]??o}const i=o=>{const s=typeof o;switch(s){case"number":return Number.isNaN(o)?"NaN":"tal";case"object":return Array.isArray(o)?"liste":o===null?"null":Object.getPrototypeOf(o)!==Object.prototype&&o.constructor?o.constructor.name:"objekt"}return s},a={regex:"input",email:"e-mailadresse",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO dato- og klokkeslt",date:"ISO-dato",time:"ISO-klokkeslt",duration:"ISO-varighed",ipv4:"IPv4-omrde",ipv6:"IPv6-omrde",cidrv4:"IPv4-spektrum",cidrv6:"IPv6-spektrum",base64:"base64-kodet streng",base64url:"base64url-kodet streng",json_string:"JSON-streng",e164:"E.164-nummer",jwt:"JWT",template_literal:"input"};return o=>{switch(o.code){case"invalid_type":return`Ugyldigt input: forventede ${n(o.expected)}, fik ${n(i(o.input))}`;case"invalid_value":return o.values.length===1?`Ugyldig vrdi: forventede ${yr(o.values[0])}`:`Ugyldigt valg: forventede en af flgende ${gt(o.values,"|")}`;case"too_big":{const s=o.inclusive?"<=":"<",l=r(o.origin),u=n(o.origin);return l?`For stor: forventede ${u??"value"} ${l.verb} ${s} ${o.maximum.toString()} ${l.unit??"elementer"}`:`For stor: forventede ${u??"value"} havde ${s} ${o.maximum.toString()}`}case"too_small":{const s=o.inclusive?">=":">",l=r(o.origin),u=n(o.origin);return l?`For lille: forventede ${u} ${l.verb} ${s} ${o.minimum.toString()} ${l.unit}`:`For lille: forventede ${u} havde ${s} ${o.minimum.toString()}`}case"invalid_format":{const s=o;return s.format==="starts_with"?`Ugyldig streng: skal starte med "${s.prefix}"`:s.format==="ends_with"?`Ugyldig streng: skal ende med "${s.suffix}"`:s.format==="includes"?`Ugyldig streng: skal indeholde "${s.includes}"`:s.format==="regex"?`Ugyldig streng: skal matche mnsteret ${s.pattern}`:`Ugyldig ${a[s.format]??o.format}`}case"not_multiple_of":return`Ugyldigt tal: skal vre deleligt med ${o.divisor}`;case"unrecognized_keys":return`${o.keys.length>1?"Ukendte ngler":"Ukendt ngle"}: ${gt(o.keys,", ")}`;case"invalid_key":return`Ugyldig ngle i ${o.origin}`;case"invalid_union":return"Ugyldigt input: matcher ingen af de tilladte typer";case"invalid_element":return`Ugyldig vrdi i ${o.origin}`;default:return"Ugyldigt input"}}};function mde(){return{localeError:fde()}}const gde=()=>{const t={string:{unit:"Zeichen",verb:"zu haben"},file:{unit:"Bytes",verb:"zu haben"},array:{unit:"Elemente",verb:"zu haben"},set:{unit:"Elemente",verb:"zu haben"}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"Zahl";case"object":{if(Array.isArray(i))return"Array";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"Eingabe",email:"E-Mail-Adresse",url:"URL",emoji:"Emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO-Datum und -Uhrzeit",date:"ISO-Datum",time:"ISO-Uhrzeit",duration:"ISO-Dauer",ipv4:"IPv4-Adresse",ipv6:"IPv6-Adresse",cidrv4:"IPv4-Bereich",cidrv6:"IPv6-Bereich",base64:"Base64-codierter String",base64url:"Base64-URL-codierter String",json_string:"JSON-String",e164:"E.164-Nummer",jwt:"JWT",template_literal:"Eingabe"};return i=>{switch(i.code){case"invalid_type":return`Ungltige Eingabe: erwartet ${i.expected}, erhalten ${r(i.input)}`;case"invalid_value":return i.values.length===1?`Ungltige Eingabe: erwartet ${yr(i.values[0])}`:`Ungltige Option: erwartet eine von ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?`Zu gro: erwartet, dass ${i.origin??"Wert"} ${a}${i.maximum.toString()} ${o.unit??"Elemente"} hat`:`Zu gro: erwartet, dass ${i.origin??"Wert"} ${a}${i.maximum.toString()} ist`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?`Zu klein: erwartet, dass ${i.origin} ${a}${i.minimum.toString()} ${o.unit} hat`:`Zu klein: erwartet, dass ${i.origin} ${a}${i.minimum.toString()} ist`}case"invalid_format":{const a=i;return a.format==="starts_with"?`Ungltiger String: muss mit "${a.prefix}" beginnen`:a.format==="ends_with"?`Ungltiger String: muss mit "${a.suffix}" enden`:a.format==="includes"?`Ungltiger String: muss "${a.includes}" enthalten`:a.format==="regex"?`Ungltiger String: muss dem Muster ${a.pattern} entsprechen`:`Ungltig: ${n[a.format]??i.format}`}case"not_multiple_of":return`Ungltige Zahl: muss ein Vielfaches von ${i.divisor} sein`;case"unrecognized_keys":return`${i.keys.length>1?"Unbekannte Schlssel":"Unbekannter Schlssel"}: ${gt(i.keys,", ")}`;case"invalid_key":return`Ungltiger Schlssel in ${i.origin}`;case"invalid_union":return"Ungltige Eingabe";case"invalid_element":return`Ungltiger Wert in ${i.origin}`;default:return"Ungltige Eingabe"}}};function yde(){return{localeError:gde()}}const vde=t=>{const e=typeof t;switch(e){case"number":return Number.isNaN(t)?"NaN":"number";case"object":{if(Array.isArray(t))return"array";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return e},_de=()=>{const t={string:{unit:"characters",verb:"to have"},file:{unit:"bytes",verb:"to have"},array:{unit:"items",verb:"to have"},set:{unit:"items",verb:"to have"}};function e(n){return t[n]??null}const r={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"};return n=>{switch(n.code){case"invalid_type":return`Invalid input: expected ${n.expected}, received ${vde(n.input)}`;case"invalid_value":return n.values.length===1?`Invalid input: expected ${yr(n.values[0])}`:`Invalid option: expected one of ${gt(n.values,"|")}`;case"too_big":{const i=n.inclusive?"<=":"<",a=e(n.origin);return a?`Too big: expected ${n.origin??"value"} to have ${i}${n.maximum.toString()} ${a.unit??"elements"}`:`Too big: expected ${n.origin??"value"} to be ${i}${n.maximum.toString()}`}case"too_small":{const i=n.inclusive?">=":">",a=e(n.origin);return a?`Too small: expected ${n.origin} to have ${i}${n.minimum.toString()} ${a.unit}`:`Too small: expected ${n.origin} to be ${i}${n.minimum.toString()}`}case"invalid_format":{const i=n;return i.format==="starts_with"?`Invalid string: must start with "${i.prefix}"`:i.format==="ends_with"?`Invalid string: must end with "${i.suffix}"`:i.format==="includes"?`Invalid string: must include "${i.includes}"`:i.format==="regex"?`Invalid string: must match pattern ${i.pattern}`:`Invalid ${r[i.format]??n.format}`}case"not_multiple_of":return`Invalid number: must be a multiple of ${n.divisor}`;case"unrecognized_keys":return`Unrecognized key${n.keys.length>1?"s":""}: ${gt(n.keys,", ")}`;case"invalid_key":return`Invalid key in ${n.origin}`;case"invalid_union":return"Invalid input";case"invalid_element":return`Invalid value in ${n.origin}`;default:return"Invalid input"}}};function _j(){return{localeError:_de()}}const xde=t=>{const e=typeof t;switch(e){case"number":return Number.isNaN(t)?"NaN":"nombro";case"object":{if(Array.isArray(t))return"tabelo";if(t===null)return"senvalora";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return e},bde=()=>{const t={string:{unit:"karaktrojn",verb:"havi"},file:{unit:"bajtojn",verb:"havi"},array:{unit:"elementojn",verb:"havi"},set:{unit:"elementojn",verb:"havi"}};function e(n){return t[n]??null}const r={regex:"enigo",email:"retadreso",url:"URL",emoji:"emoio",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO-datotempo",date:"ISO-dato",time:"ISO-tempo",duration:"ISO-daro",ipv4:"IPv4-adreso",ipv6:"IPv6-adreso",cidrv4:"IPv4-rango",cidrv6:"IPv6-rango",base64:"64-ume kodita karaktraro",base64url:"URL-64-ume kodita karaktraro",json_string:"JSON-karaktraro",e164:"E.164-nombro",jwt:"JWT",template_literal:"enigo"};return n=>{switch(n.code){case"invalid_type":return`Nevalida enigo: atendiis ${n.expected}, riceviis ${xde(n.input)}`;case"invalid_value":return n.values.length===1?`Nevalida enigo: atendiis ${yr(n.values[0])}`:`Nevalida opcio: atendiis unu el ${gt(n.values,"|")}`;case"too_big":{const i=n.inclusive?"<=":"<",a=e(n.origin);return a?`Tro granda: atendiis ke ${n.origin??"valoro"} havu ${i}${n.maximum.toString()} ${a.unit??"elementojn"}`:`Tro granda: atendiis ke ${n.origin??"valoro"} havu ${i}${n.maximum.toString()}`}case"too_small":{const i=n.inclusive?">=":">",a=e(n.origin);return a?`Tro malgranda: atendiis ke ${n.origin} havu ${i}${n.minimum.toString()} ${a.unit}`:`Tro malgranda: atendiis ke ${n.origin} estu ${i}${n.minimum.toString()}`}case"invalid_format":{const i=n;return i.format==="starts_with"?`Nevalida karaktraro: devas komencii per "${i.prefix}"`:i.format==="ends_with"?`Nevalida karaktraro: devas finii per "${i.suffix}"`:i.format==="includes"?`Nevalida karaktraro: devas inkluzivi "${i.includes}"`:i.format==="regex"?`Nevalida karaktraro: devas kongrui kun la modelo ${i.pattern}`:`Nevalida ${r[i.format]??n.format}`}case"not_multiple_of":return`Nevalida nombro: devas esti oblo de ${n.divisor}`;case"unrecognized_keys":return`Nekonata${n.keys.length>1?"j":""} losilo${n.keys.length>1?"j":""}: ${gt(n.keys,", ")}`;case"invalid_key":return`Nevalida losilo en ${n.origin}`;case"invalid_union":return"Nevalida enigo";case"invalid_element":return`Nevalida valoro en ${n.origin}`;default:return"Nevalida enigo"}}};function wde(){return{localeError:bde()}}const Ade=()=>{const t={string:{unit:"caracteres",verb:"tener"},file:{unit:"bytes",verb:"tener"},array:{unit:"elementos",verb:"tener"},set:{unit:"elementos",verb:"tener"}},e={string:"texto",number:"nmero",boolean:"booleano",array:"arreglo",object:"objeto",set:"conjunto",file:"archivo",date:"fecha",bigint:"nmero grande",symbol:"smbolo",undefined:"indefinido",null:"nulo",function:"funcin",map:"mapa",record:"registro",tuple:"tupla",enum:"enumeracin",union:"unin",literal:"literal",promise:"promesa",void:"vaco",never:"nunca",unknown:"desconocido",any:"cualquiera"};function r(o){return t[o]??null}function n(o){return e[o]??o}const i=o=>{const s=typeof o;switch(s){case"number":return Number.isNaN(o)?"NaN":"number";case"object":return Array.isArray(o)?"array":o===null?"null":Object.getPrototypeOf(o)!==Object.prototype?o.constructor.name:"object"}return s},a={regex:"entrada",email:"direccin de correo electrnico",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"fecha y hora ISO",date:"fecha ISO",time:"hora ISO",duration:"duracin ISO",ipv4:"direccin IPv4",ipv6:"direccin IPv6",cidrv4:"rango IPv4",cidrv6:"rango IPv6",base64:"cadena codificada en base64",base64url:"URL codificada en base64",json_string:"cadena JSON",e164:"nmero E.164",jwt:"JWT",template_literal:"entrada"};return o=>{switch(o.code){case"invalid_type":return`Entrada invlida: se esperaba ${n(o.expected)}, recibido ${n(i(o.input))}`;case"invalid_value":return o.values.length===1?`Entrada invlida: se esperaba ${yr(o.values[0])}`:`Opcin invlida: se esperaba una de ${gt(o.values,"|")}`;case"too_big":{const s=o.inclusive?"<=":"<",l=r(o.origin),u=n(o.origin);return l?`Demasiado grande: se esperaba que ${u??"valor"} tuviera ${s}${o.maximum.toString()} ${l.unit??"elementos"}`:`Demasiado grande: se esperaba que ${u??"valor"} fuera ${s}${o.maximum.toString()}`}case"too_small":{const s=o.inclusive?">=":">",l=r(o.origin),u=n(o.origin);return l?`Demasiado pequeo: se esperaba que ${u} tuviera ${s}${o.minimum.toString()} ${l.unit}`:`Demasiado pequeo: se esperaba que ${u} fuera ${s}${o.minimum.toString()}`}case"invalid_format":{const s=o;return s.format==="starts_with"?`Cadena invlida: debe comenzar con "${s.prefix}"`:s.format==="ends_with"?`Cadena invlida: debe terminar en "${s.suffix}"`:s.format==="includes"?`Cadena invlida: debe incluir "${s.includes}"`:s.format==="regex"?`Cadena invlida: debe coincidir con el patrn ${s.pattern}`:`Invlido ${a[s.format]??o.format}`}case"not_multiple_of":return`Nmero invlido: debe ser mltiplo de ${o.divisor}`;case"unrecognized_keys":return`Llave${o.keys.length>1?"s":""} desconocida${o.keys.length>1?"s":""}: ${gt(o.keys,", ")}`;case"invalid_key":return`Llave invlida en ${n(o.origin)}`;case"invalid_union":return"Entrada invlida";case"invalid_element":return`Valor invlido en ${n(o.origin)}`;default:return"Entrada invlida"}}};function Sde(){return{localeError:Ade()}}const Ede=()=>{const t={string:{unit:"",verb:" "},file:{unit:"",verb:" "},array:{unit:"",verb:" "},set:{unit:"",verb:" "}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"";case"object":{if(Array.isArray(i))return"";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"",email:" ",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"   ",date:" ",time:" ",duration:"  ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"base64-encoded ",base64url:"base64url-encoded ",json_string:"JSON ",e164:"E.164 ",jwt:"JWT",template_literal:""};return i=>{switch(i.code){case"invalid_type":return` :  ${i.expected}  ${r(i.input)}  `;case"invalid_value":return i.values.length===1?` :  ${yr(i.values[0])} `:` :    ${gt(i.values,"|")} `;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?` : ${i.origin??""}  ${a}${i.maximum.toString()} ${o.unit??""} `:` : ${i.origin??""}  ${a}${i.maximum.toString()} `}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?` : ${i.origin}  ${a}${i.minimum.toString()} ${o.unit} `:` : ${i.origin}  ${a}${i.minimum.toString()} `}case"invalid_format":{const a=i;return a.format==="starts_with"?` :   "${a.prefix}"  `:a.format==="ends_with"?` :   "${a.suffix}"  `:a.format==="includes"?` :   "${a.includes}" `:a.format==="regex"?` :    ${a.pattern}   `:`${n[a.format]??i.format} `}case"not_multiple_of":return` :   ${i.divisor} `;case"unrecognized_keys":return`${i.keys.length>1?"":""} : ${gt(i.keys,", ")}`;case"invalid_key":return`   ${i.origin}`;case"invalid_union":return" ";case"invalid_element":return`   ${i.origin}`;default:return" "}}};function Ide(){return{localeError:Ede()}}const Cde=()=>{const t={string:{unit:"merkki",subject:"merkkijonon"},file:{unit:"tavua",subject:"tiedoston"},array:{unit:"alkiota",subject:"listan"},set:{unit:"alkiota",subject:"joukon"},number:{unit:"",subject:"luvun"},bigint:{unit:"",subject:"suuren kokonaisluvun"},int:{unit:"",subject:"kokonaisluvun"},date:{unit:"",subject:"pivmrn"}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"number";case"object":{if(Array.isArray(i))return"array";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"snnllinen lauseke",email:"shkpostiosoite",url:"URL-osoite",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO-aikaleima",date:"ISO-pivmr",time:"ISO-aika",duration:"ISO-kesto",ipv4:"IPv4-osoite",ipv6:"IPv6-osoite",cidrv4:"IPv4-alue",cidrv6:"IPv6-alue",base64:"base64-koodattu merkkijono",base64url:"base64url-koodattu merkkijono",json_string:"JSON-merkkijono",e164:"E.164-luku",jwt:"JWT",template_literal:"templaattimerkkijono"};return i=>{switch(i.code){case"invalid_type":return`Virheellinen tyyppi: odotettiin ${i.expected}, oli ${r(i.input)}`;case"invalid_value":return i.values.length===1?`Virheellinen syte: tytyy olla ${yr(i.values[0])}`:`Virheellinen valinta: tytyy olla yksi seuraavista: ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?`Liian suuri: ${o.subject} tytyy olla ${a}${i.maximum.toString()} ${o.unit}`.trim():`Liian suuri: arvon tytyy olla ${a}${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?`Liian pieni: ${o.subject} tytyy olla ${a}${i.minimum.toString()} ${o.unit}`.trim():`Liian pieni: arvon tytyy olla ${a}${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?`Virheellinen syte: tytyy alkaa "${a.prefix}"`:a.format==="ends_with"?`Virheellinen syte: tytyy loppua "${a.suffix}"`:a.format==="includes"?`Virheellinen syte: tytyy sislt "${a.includes}"`:a.format==="regex"?`Virheellinen syte: tytyy vastata snnllist lauseketta ${a.pattern}`:`Virheellinen ${n[a.format]??i.format}`}case"not_multiple_of":return`Virheellinen luku: tytyy olla luvun ${i.divisor} monikerta`;case"unrecognized_keys":return`${i.keys.length>1?"Tuntemattomat avaimet":"Tuntematon avain"}: ${gt(i.keys,", ")}`;case"invalid_key":return"Virheellinen avain tietueessa";case"invalid_union":return"Virheellinen unioni";case"invalid_element":return"Virheellinen arvo joukossa";default:return"Virheellinen syte"}}};function Mde(){return{localeError:Cde()}}const Tde=()=>{const t={string:{unit:"caractres",verb:"avoir"},file:{unit:"octets",verb:"avoir"},array:{unit:"lments",verb:"avoir"},set:{unit:"lments",verb:"avoir"}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"nombre";case"object":{if(Array.isArray(i))return"tableau";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"entre",email:"adresse e-mail",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"date et heure ISO",date:"date ISO",time:"heure ISO",duration:"dure ISO",ipv4:"adresse IPv4",ipv6:"adresse IPv6",cidrv4:"plage IPv4",cidrv6:"plage IPv6",base64:"chane encode en base64",base64url:"chane encode en base64url",json_string:"chane JSON",e164:"numro E.164",jwt:"JWT",template_literal:"entre"};return i=>{switch(i.code){case"invalid_type":return`Entre invalide : ${i.expected} attendu, ${r(i.input)} reu`;case"invalid_value":return i.values.length===1?`Entre invalide : ${yr(i.values[0])} attendu`:`Option invalide : une valeur parmi ${gt(i.values,"|")} attendue`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?`Trop grand : ${i.origin??"valeur"} doit ${o.verb} ${a}${i.maximum.toString()} ${o.unit??"lment(s)"}`:`Trop grand : ${i.origin??"valeur"} doit tre ${a}${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?`Trop petit : ${i.origin} doit ${o.verb} ${a}${i.minimum.toString()} ${o.unit}`:`Trop petit : ${i.origin} doit tre ${a}${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?`Chane invalide : doit commencer par "${a.prefix}"`:a.format==="ends_with"?`Chane invalide : doit se terminer par "${a.suffix}"`:a.format==="includes"?`Chane invalide : doit inclure "${a.includes}"`:a.format==="regex"?`Chane invalide : doit correspondre au modle ${a.pattern}`:`${n[a.format]??i.format} invalide`}case"not_multiple_of":return`Nombre invalide : doit tre un multiple de ${i.divisor}`;case"unrecognized_keys":return`Cl${i.keys.length>1?"s":""} non reconnue${i.keys.length>1?"s":""} : ${gt(i.keys,", ")}`;case"invalid_key":return`Cl invalide dans ${i.origin}`;case"invalid_union":return"Entre invalide";case"invalid_element":return`Valeur invalide dans ${i.origin}`;default:return"Entre invalide"}}};function Pde(){return{localeError:Tde()}}const Dde=()=>{const t={string:{unit:"caractres",verb:"avoir"},file:{unit:"octets",verb:"avoir"},array:{unit:"lments",verb:"avoir"},set:{unit:"lments",verb:"avoir"}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"number";case"object":{if(Array.isArray(i))return"array";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"entre",email:"adresse courriel",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"date-heure ISO",date:"date ISO",time:"heure ISO",duration:"dure ISO",ipv4:"adresse IPv4",ipv6:"adresse IPv6",cidrv4:"plage IPv4",cidrv6:"plage IPv6",base64:"chane encode en base64",base64url:"chane encode en base64url",json_string:"chane JSON",e164:"numro E.164",jwt:"JWT",template_literal:"entre"};return i=>{switch(i.code){case"invalid_type":return`Entre invalide : attendu ${i.expected}, reu ${r(i.input)}`;case"invalid_value":return i.values.length===1?`Entre invalide : attendu ${yr(i.values[0])}`:`Option invalide : attendu l'une des valeurs suivantes ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"":"<",o=e(i.origin);return o?`Trop grand : attendu que ${i.origin??"la valeur"} ait ${a}${i.maximum.toString()} ${o.unit}`:`Trop grand : attendu que ${i.origin??"la valeur"} soit ${a}${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?"":">",o=e(i.origin);return o?`Trop petit : attendu que ${i.origin} ait ${a}${i.minimum.toString()} ${o.unit}`:`Trop petit : attendu que ${i.origin} soit ${a}${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?`Chane invalide : doit commencer par "${a.prefix}"`:a.format==="ends_with"?`Chane invalide : doit se terminer par "${a.suffix}"`:a.format==="includes"?`Chane invalide : doit inclure "${a.includes}"`:a.format==="regex"?`Chane invalide : doit correspondre au motif ${a.pattern}`:`${n[a.format]??i.format} invalide`}case"not_multiple_of":return`Nombre invalide : doit tre un multiple de ${i.divisor}`;case"unrecognized_keys":return`Cl${i.keys.length>1?"s":""} non reconnue${i.keys.length>1?"s":""} : ${gt(i.keys,", ")}`;case"invalid_key":return`Cl invalide dans ${i.origin}`;case"invalid_union":return"Entre invalide";case"invalid_element":return`Valeur invalide dans ${i.origin}`;default:return"Entre invalide"}}};function kde(){return{localeError:Dde()}}const Ode=()=>{const t={string:{unit:"",verb:""},file:{unit:"",verb:""},array:{unit:"",verb:""},set:{unit:"",verb:""}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"number";case"object":{if(Array.isArray(i))return"array";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"",email:" ",url:" ",emoji:"'",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"  ISO",date:" ISO",time:" ISO",duration:"  ISO",ipv4:" IPv4",ipv6:" IPv6",cidrv4:" IPv4",cidrv6:" IPv6",base64:"  64",base64url:"  64  ",json_string:" JSON",e164:" E.164",jwt:"JWT",template_literal:""};return i=>{switch(i.code){case"invalid_type":return`  :  ${i.expected},  ${r(i.input)}`;case"invalid_value":return i.values.length===1?`  :  ${yr(i.values[0])}`:`  :     ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?` : ${i.origin??"value"}   ${a}${i.maximum.toString()} ${o.unit??"elements"}`:` : ${i.origin??"value"}   ${a}${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?` : ${i.origin}   ${a}${i.minimum.toString()} ${o.unit}`:` : ${i.origin}   ${a}${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?`  :   "${a.prefix}"`:a.format==="ends_with"?`  :    "${a.suffix}"`:a.format==="includes"?`  :   "${a.includes}"`:a.format==="regex"?`  :    ${a.pattern}`:`${n[a.format]??i.format}  `}case"not_multiple_of":return`  :     ${i.divisor}`;case"unrecognized_keys":return`${i.keys.length>1?"":""}  ${i.keys.length>1?"":""}: ${gt(i.keys,", ")}`;case"invalid_key":return`   ${i.origin}`;case"invalid_union":return"  ";case"invalid_element":return`   ${i.origin}`;default:return"  "}}};function Bde(){return{localeError:Ode()}}const zde=()=>{const t={string:{unit:"karakter",verb:"legyen"},file:{unit:"byte",verb:"legyen"},array:{unit:"elem",verb:"legyen"},set:{unit:"elem",verb:"legyen"}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"szm";case"object":{if(Array.isArray(i))return"tmb";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"bemenet",email:"email cm",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO idblyeg",date:"ISO dtum",time:"ISO id",duration:"ISO idintervallum",ipv4:"IPv4 cm",ipv6:"IPv6 cm",cidrv4:"IPv4 tartomny",cidrv6:"IPv6 tartomny",base64:"base64-kdolt string",base64url:"base64url-kdolt string",json_string:"JSON string",e164:"E.164 szm",jwt:"JWT",template_literal:"bemenet"};return i=>{switch(i.code){case"invalid_type":return`rvnytelen bemenet: a vrt rtk ${i.expected}, a kapott rtk ${r(i.input)}`;case"invalid_value":return i.values.length===1?`rvnytelen bemenet: a vrt rtk ${yr(i.values[0])}`:`rvnytelen opci: valamelyik rtk vrt ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?`Tl nagy: ${i.origin??"rtk"} mrete tl nagy ${a}${i.maximum.toString()} ${o.unit??"elem"}`:`Tl nagy: a bemeneti rtk ${i.origin??"rtk"} tl nagy: ${a}${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?`Tl kicsi: a bemeneti rtk ${i.origin} mrete tl kicsi ${a}${i.minimum.toString()} ${o.unit}`:`Tl kicsi: a bemeneti rtk ${i.origin} tl kicsi ${a}${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?`rvnytelen string: "${a.prefix}" rtkkel kell kezddnie`:a.format==="ends_with"?`rvnytelen string: "${a.suffix}" rtkkel kell vgzdnie`:a.format==="includes"?`rvnytelen string: "${a.includes}" rtket kell tartalmaznia`:a.format==="regex"?`rvnytelen string: ${a.pattern} mintnak kell megfelelnie`:`rvnytelen ${n[a.format]??i.format}`}case"not_multiple_of":return`rvnytelen szm: ${i.divisor} tbbszrsnek kell lennie`;case"unrecognized_keys":return`Ismeretlen kulcs${i.keys.length>1?"s":""}: ${gt(i.keys,", ")}`;case"invalid_key":return`rvnytelen kulcs ${i.origin}`;case"invalid_union":return"rvnytelen bemenet";case"invalid_element":return`rvnytelen rtk: ${i.origin}`;default:return"rvnytelen bemenet"}}};function Fde(){return{localeError:zde()}}const Rde=()=>{const t={string:{unit:"karakter",verb:"memiliki"},file:{unit:"byte",verb:"memiliki"},array:{unit:"item",verb:"memiliki"},set:{unit:"item",verb:"memiliki"}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"number";case"object":{if(Array.isArray(i))return"array";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"input",email:"alamat email",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"tanggal dan waktu format ISO",date:"tanggal format ISO",time:"jam format ISO",duration:"durasi format ISO",ipv4:"alamat IPv4",ipv6:"alamat IPv6",cidrv4:"rentang alamat IPv4",cidrv6:"rentang alamat IPv6",base64:"string dengan enkode base64",base64url:"string dengan enkode base64url",json_string:"string JSON",e164:"angka E.164",jwt:"JWT",template_literal:"input"};return i=>{switch(i.code){case"invalid_type":return`Input tidak valid: diharapkan ${i.expected}, diterima ${r(i.input)}`;case"invalid_value":return i.values.length===1?`Input tidak valid: diharapkan ${yr(i.values[0])}`:`Pilihan tidak valid: diharapkan salah satu dari ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?`Terlalu besar: diharapkan ${i.origin??"value"} memiliki ${a}${i.maximum.toString()} ${o.unit??"elemen"}`:`Terlalu besar: diharapkan ${i.origin??"value"} menjadi ${a}${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?`Terlalu kecil: diharapkan ${i.origin} memiliki ${a}${i.minimum.toString()} ${o.unit}`:`Terlalu kecil: diharapkan ${i.origin} menjadi ${a}${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?`String tidak valid: harus dimulai dengan "${a.prefix}"`:a.format==="ends_with"?`String tidak valid: harus berakhir dengan "${a.suffix}"`:a.format==="includes"?`String tidak valid: harus menyertakan "${a.includes}"`:a.format==="regex"?`String tidak valid: harus sesuai pola ${a.pattern}`:`${n[a.format]??i.format} tidak valid`}case"not_multiple_of":return`Angka tidak valid: harus kelipatan dari ${i.divisor}`;case"unrecognized_keys":return`Kunci tidak dikenali ${i.keys.length>1?"s":""}: ${gt(i.keys,", ")}`;case"invalid_key":return`Kunci tidak valid di ${i.origin}`;case"invalid_union":return"Input tidak valid";case"invalid_element":return`Nilai tidak valid di ${i.origin}`;default:return"Input tidak valid"}}};function Lde(){return{localeError:Rde()}}const Nde=t=>{const e=typeof t;switch(e){case"number":return Number.isNaN(t)?"NaN":"nmer";case"object":{if(Array.isArray(t))return"fylki";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return e},$de=()=>{const t={string:{unit:"stafi",verb:"a hafa"},file:{unit:"bti",verb:"a hafa"},array:{unit:"hluti",verb:"a hafa"},set:{unit:"hluti",verb:"a hafa"}};function e(n){return t[n]??null}const r={regex:"gildi",email:"netfang",url:"vefsl",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO dagsetning og tmi",date:"ISO dagsetning",time:"ISO tmi",duration:"ISO tmalengd",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded strengur",base64url:"base64url-encoded strengur",json_string:"JSON strengur",e164:"E.164 tlugildi",jwt:"JWT",template_literal:"gildi"};return n=>{switch(n.code){case"invalid_type":return`Rangt gildi:  slst inn ${Nde(n.input)} ar sem  a vera ${n.expected}`;case"invalid_value":return n.values.length===1?`Rangt gildi: gert r fyrir ${yr(n.values[0])}`:`gilt val: m vera eitt af eftirfarandi ${gt(n.values,"|")}`;case"too_big":{const i=n.inclusive?"<=":"<",a=e(n.origin);return a?`Of strt: gert er r fyrir a ${n.origin??"gildi"} hafi ${i}${n.maximum.toString()} ${a.unit??"hluti"}`:`Of strt: gert er r fyrir a ${n.origin??"gildi"} s ${i}${n.maximum.toString()}`}case"too_small":{const i=n.inclusive?">=":">",a=e(n.origin);return a?`Of lti: gert er r fyrir a ${n.origin} hafi ${i}${n.minimum.toString()} ${a.unit}`:`Of lti: gert er r fyrir a ${n.origin} s ${i}${n.minimum.toString()}`}case"invalid_format":{const i=n;return i.format==="starts_with"?`gildur strengur: verur a byrja  "${i.prefix}"`:i.format==="ends_with"?`gildur strengur: verur a enda  "${i.suffix}"`:i.format==="includes"?`gildur strengur: verur a innihalda "${i.includes}"`:i.format==="regex"?`gildur strengur: verur a fylgja mynstri ${i.pattern}`:`Rangt ${r[i.format]??n.format}`}case"not_multiple_of":return`Rng tala: verur a vera margfeldi af ${n.divisor}`;case"unrecognized_keys":return`ekkt ${n.keys.length>1?"ir lyklar":"ur lykill"}: ${gt(n.keys,", ")}`;case"invalid_key":return`Rangur lykill  ${n.origin}`;case"invalid_union":return"Rangt gildi";case"invalid_element":return`Rangt gildi  ${n.origin}`;default:return"Rangt gildi"}}};function Ude(){return{localeError:$de()}}const jde=()=>{const t={string:{unit:"caratteri",verb:"avere"},file:{unit:"byte",verb:"avere"},array:{unit:"elementi",verb:"avere"},set:{unit:"elementi",verb:"avere"}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"numero";case"object":{if(Array.isArray(i))return"vettore";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"input",email:"indirizzo email",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"data e ora ISO",date:"data ISO",time:"ora ISO",duration:"durata ISO",ipv4:"indirizzo IPv4",ipv6:"indirizzo IPv6",cidrv4:"intervallo IPv4",cidrv6:"intervallo IPv6",base64:"stringa codificata in base64",base64url:"URL codificata in base64",json_string:"stringa JSON",e164:"numero E.164",jwt:"JWT",template_literal:"input"};return i=>{switch(i.code){case"invalid_type":return`Input non valido: atteso ${i.expected}, ricevuto ${r(i.input)}`;case"invalid_value":return i.values.length===1?`Input non valido: atteso ${yr(i.values[0])}`:`Opzione non valida: atteso uno tra ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?`Troppo grande: ${i.origin??"valore"} deve avere ${a}${i.maximum.toString()} ${o.unit??"elementi"}`:`Troppo grande: ${i.origin??"valore"} deve essere ${a}${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?`Troppo piccolo: ${i.origin} deve avere ${a}${i.minimum.toString()} ${o.unit}`:`Troppo piccolo: ${i.origin} deve essere ${a}${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?`Stringa non valida: deve iniziare con "${a.prefix}"`:a.format==="ends_with"?`Stringa non valida: deve terminare con "${a.suffix}"`:a.format==="includes"?`Stringa non valida: deve includere "${a.includes}"`:a.format==="regex"?`Stringa non valida: deve corrispondere al pattern ${a.pattern}`:`Invalid ${n[a.format]??i.format}`}case"not_multiple_of":return`Numero non valido: deve essere un multiplo di ${i.divisor}`;case"unrecognized_keys":return`Chiav${i.keys.length>1?"i":"e"} non riconosciut${i.keys.length>1?"e":"a"}: ${gt(i.keys,", ")}`;case"invalid_key":return`Chiave non valida in ${i.origin}`;case"invalid_union":return"Input non valido";case"invalid_element":return`Valore non valido in ${i.origin}`;default:return"Input non valido"}}};function Vde(){return{localeError:jde()}}const Gde=()=>{const t={string:{unit:"",verb:""},file:{unit:"",verb:""},array:{unit:"",verb:""},set:{unit:"",verb:""}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"";case"object":{if(Array.isArray(i))return"";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"",email:"",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO",date:"ISO",time:"ISO",duration:"ISO",ipv4:"IPv4",ipv6:"IPv6",cidrv4:"IPv4",cidrv6:"IPv6",base64:"base64",base64url:"base64url",json_string:"JSON",e164:"E.164",jwt:"JWT",template_literal:""};return i=>{switch(i.code){case"invalid_type":return`: ${i.expected}${r(i.input)}`;case"invalid_value":return i.values.length===1?`: ${yr(i.values[0])}`:`: ${gt(i.values,"")}`;case"too_big":{const a=i.inclusive?"":"",o=e(i.origin);return o?`: ${i.origin??""}${i.maximum.toString()}${o.unit??""}${a}`:`: ${i.origin??""}${i.maximum.toString()}${a}`}case"too_small":{const a=i.inclusive?"":"",o=e(i.origin);return o?`: ${i.origin}${i.minimum.toString()}${o.unit}${a}`:`: ${i.origin}${i.minimum.toString()}${a}`}case"invalid_format":{const a=i;return a.format==="starts_with"?`: "${a.prefix}"`:a.format==="ends_with"?`: "${a.suffix}"`:a.format==="includes"?`: "${a.includes}"`:a.format==="regex"?`: ${a.pattern}`:`${n[a.format]??i.format}`}case"not_multiple_of":return`: ${i.divisor}`;case"unrecognized_keys":return`${i.keys.length>1?"":""}: ${gt(i.keys,"")}`;case"invalid_key":return`${i.origin}`;case"invalid_union":return"";case"invalid_element":return`${i.origin}`;default:return""}}};function Zde(){return{localeError:Gde()}}const Wde=t=>{const e=typeof t;switch(e){case"number":return Number.isNaN(t)?"NaN":"";case"object":{if(Array.isArray(t))return"";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return{string:"",boolean:"",undefined:"undefined",bigint:"bigint",symbol:"symbol",function:""}[e]??e},Hde=()=>{const t={string:{unit:"",verb:" "},file:{unit:"",verb:" "},array:{unit:"",verb:" "},set:{unit:"",verb:" "}};function e(n){return t[n]??null}const r={regex:"",email:"- ",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"-",date:"",time:"",duration:"",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"base64- ",base64url:"base64url- ",json_string:"JSON ",e164:"E.164 ",jwt:"JWT",template_literal:""};return n=>{switch(n.code){case"invalid_type":return` :  ${n.expected},  ${Wde(n.input)}`;case"invalid_value":return n.values.length===1?` :  ${yr(n.values[0])}`:` :  - ${gt(n.values,"|")}-`;case"too_big":{const i=n.inclusive?"<=":"<",a=e(n.origin);return a?` :  ${n.origin??""} ${a.verb} ${i}${n.maximum.toString()} ${a.unit}`:` :  ${n.origin??""}  ${i}${n.maximum.toString()}`}case"too_small":{const i=n.inclusive?">=":">",a=e(n.origin);return a?` :  ${n.origin} ${a.verb} ${i}${n.minimum.toString()} ${a.unit}`:` :  ${n.origin}  ${i}${n.minimum.toString()}`}case"invalid_format":{const i=n;return i.format==="starts_with"?` :   "${i.prefix}"-`:i.format==="ends_with"?` :   "${i.suffix}"-`:i.format==="includes"?` :   "${i.includes}"-`:i.format==="regex"?` :    ${i.pattern}`:` ${r[i.format]??n.format}`}case"not_multiple_of":return` :   ${n.divisor}- `;case"unrecognized_keys":return` ${n.keys.length>1?"":""}: ${gt(n.keys,", ")}`;case"invalid_key":return`  ${n.origin}-`;case"invalid_union":return" ";case"invalid_element":return`  ${n.origin}-`;default:return" "}}};function Xde(){return{localeError:Hde()}}const qde=()=>{const t={string:{unit:"",verb:""},file:{unit:"",verb:""},array:{unit:"",verb:""},set:{unit:"",verb:""}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?" (NaN)":"";case"object":{if(Array.isArray(i))return" (Array)";if(i===null)return" (null)";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"",email:"",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"  ISO",date:" ISO",time:" ISO",duration:" ISO",ipv4:" IPv4",ipv6:" IPv6",cidrv4:" IPv4",cidrv6:" IPv6",base64:" base64",base64url:" base64url",json_string:" JSON",e164:" E.164",jwt:"JWT",template_literal:""};return i=>{switch(i.code){case"invalid_type":return`  ${i.expected}  ${r(i.input)}`;case"invalid_value":return i.values.length===1?`  ${yr(i.values[0])}`:`  ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?`  ${i.origin??""} ${a} ${i.maximum.toString()} ${o.unit??""}`:`  ${i.origin??""} ${a} ${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?`  ${i.origin} ${a} ${i.minimum.toString()} ${o.unit}`:`  ${i.origin} ${a} ${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?`  "${a.prefix}"`:a.format==="ends_with"?`  "${a.suffix}"`:a.format==="includes"?`  "${a.includes}"`:a.format==="regex"?`  ${a.pattern}`:` ${n[a.format]??i.format}`}case"not_multiple_of":return`  ${i.divisor}`;case"unrecognized_keys":return` ${gt(i.keys,", ")}`;case"invalid_key":return` ${i.origin}`;case"invalid_union":return"";case"invalid_element":return` ${i.origin}`;default:return""}}};function xj(){return{localeError:qde()}}function Yde(){return xj()}const Jde=()=>{const t={string:{unit:"",verb:"to have"},file:{unit:"",verb:"to have"},array:{unit:"",verb:"to have"},set:{unit:"",verb:"to have"}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"number";case"object":{if(Array.isArray(i))return"array";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"",email:" ",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO ",date:"ISO ",time:"ISO ",duration:"ISO ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"base64  ",base64url:"base64url  ",json_string:"JSON ",e164:"E.164 ",jwt:"JWT",template_literal:""};return i=>{switch(i.code){case"invalid_type":return` :   ${i.expected},   ${r(i.input)}`;case"invalid_value":return i.values.length===1?` :  ${yr(i.values[0])}  `:` : ${gt(i.values," ")}   `;case"too_big":{const a=i.inclusive?"":"",o=a===""?" ":" ",s=e(i.origin),l=s?.unit??"";return s?`${i.origin??""}  : ${i.maximum.toString()}${l} ${a}${o}`:`${i.origin??""}  : ${i.maximum.toString()} ${a}${o}`}case"too_small":{const a=i.inclusive?"":"",o=a===""?" ":" ",s=e(i.origin),l=s?.unit??"";return s?`${i.origin??""}  : ${i.minimum.toString()}${l} ${a}${o}`:`${i.origin??""}  : ${i.minimum.toString()} ${a}${o}`}case"invalid_format":{const a=i;return a.format==="starts_with"?` : "${a.prefix}"()  `:a.format==="ends_with"?` : "${a.suffix}"()  `:a.format==="includes"?` : "${a.includes}"()  `:a.format==="regex"?` :  ${a.pattern}   `:` ${n[a.format]??i.format}`}case"not_multiple_of":return` : ${i.divisor}  `;case"unrecognized_keys":return`   : ${gt(i.keys,", ")}`;case"invalid_key":return` : ${i.origin}`;case"invalid_union":return" ";case"invalid_element":return` : ${i.origin}`;default:return" "}}};function Kde(){return{localeError:Jde()}}const Qde=t=>ky(typeof t,t),ky=(t,e=void 0)=>{switch(t){case"number":return Number.isNaN(e)?"NaN":"skaiius";case"bigint":return"sveikasis skaiius";case"string":return"eilut";case"boolean":return"login reikm";case"undefined":case"void":return"neapibrta reikm";case"function":return"funkcija";case"symbol":return"simbolis";case"object":return e===void 0?"neinomas objektas":e===null?"nulin reikm":Array.isArray(e)?"masyvas":Object.getPrototypeOf(e)!==Object.prototype&&e.constructor?e.constructor.name:"objektas";case"null":return"nulin reikm"}return t},ry=t=>t.charAt(0).toUpperCase()+t.slice(1);function fz(t){const e=Math.abs(t),r=e%10,n=e%100;return n>=11&&n<=19||r===0?"many":r===1?"one":"few"}const epe=()=>{const t={string:{unit:{one:"simbolis",few:"simboliai",many:"simboli"},verb:{smaller:{inclusive:"turi bti ne ilgesn kaip",notInclusive:"turi bti trumpesn kaip"},bigger:{inclusive:"turi bti ne trumpesn kaip",notInclusive:"turi bti ilgesn kaip"}}},file:{unit:{one:"baitas",few:"baitai",many:"bait"},verb:{smaller:{inclusive:"turi bti ne didesnis kaip",notInclusive:"turi bti maesnis kaip"},bigger:{inclusive:"turi bti ne maesnis kaip",notInclusive:"turi bti didesnis kaip"}}},array:{unit:{one:"element",few:"elementus",many:"element"},verb:{smaller:{inclusive:"turi turti ne daugiau kaip",notInclusive:"turi turti maiau kaip"},bigger:{inclusive:"turi turti ne maiau kaip",notInclusive:"turi turti daugiau kaip"}}},set:{unit:{one:"element",few:"elementus",many:"element"},verb:{smaller:{inclusive:"turi turti ne daugiau kaip",notInclusive:"turi turti maiau kaip"},bigger:{inclusive:"turi turti ne maiau kaip",notInclusive:"turi turti daugiau kaip"}}}};function e(n,i,a,o){const s=t[n]??null;return s===null?s:{unit:s.unit[i],verb:s.verb[o][a?"inclusive":"notInclusive"]}}const r={regex:"vestis",email:"el. pato adresas",url:"URL",emoji:"jaustukas",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO data ir laikas",date:"ISO data",time:"ISO laikas",duration:"ISO trukm",ipv4:"IPv4 adresas",ipv6:"IPv6 adresas",cidrv4:"IPv4 tinklo prefiksas (CIDR)",cidrv6:"IPv6 tinklo prefiksas (CIDR)",base64:"base64 ukoduota eilut",base64url:"base64url ukoduota eilut",json_string:"JSON eilut",e164:"E.164 numeris",jwt:"JWT",template_literal:"vestis"};return n=>{switch(n.code){case"invalid_type":return`Gautas tipas ${Qde(n.input)}, o tiktasi - ${ky(n.expected)}`;case"invalid_value":return n.values.length===1?`Privalo bti ${yr(n.values[0])}`:`Privalo bti vienas i ${gt(n.values,"|")} pasirinkim`;case"too_big":{const i=ky(n.origin),a=e(n.origin,fz(Number(n.maximum)),n.inclusive??!1,"smaller");if(a?.verb)return`${ry(i??n.origin??"reikm")} ${a.verb} ${n.maximum.toString()} ${a.unit??"element"}`;const o=n.inclusive?"ne didesnis kaip":"maesnis kaip";return`${ry(i??n.origin??"reikm")} turi bti ${o} ${n.maximum.toString()} ${a?.unit}`}case"too_small":{const i=ky(n.origin),a=e(n.origin,fz(Number(n.minimum)),n.inclusive??!1,"bigger");if(a?.verb)return`${ry(i??n.origin??"reikm")} ${a.verb} ${n.minimum.toString()} ${a.unit??"element"}`;const o=n.inclusive?"ne maesnis kaip":"didesnis kaip";return`${ry(i??n.origin??"reikm")} turi bti ${o} ${n.minimum.toString()} ${a?.unit}`}case"invalid_format":{const i=n;return i.format==="starts_with"?`Eilut privalo prasidti "${i.prefix}"`:i.format==="ends_with"?`Eilut privalo pasibaigti "${i.suffix}"`:i.format==="includes"?`Eilut privalo traukti "${i.includes}"`:i.format==="regex"?`Eilut privalo atitikti ${i.pattern}`:`Neteisingas ${r[i.format]??n.format}`}case"not_multiple_of":return`Skaiius privalo bti ${n.divisor} kartotinis.`;case"unrecognized_keys":return`Neatpaint${n.keys.length>1?"i":"as"} rakt${n.keys.length>1?"ai":"as"}: ${gt(n.keys,", ")}`;case"invalid_key":return"Rastas klaidingas raktas";case"invalid_union":return"Klaidinga vestis";case"invalid_element":{const i=ky(n.origin);return`${ry(i??n.origin??"reikm")} turi klaiding vest`}default:return"Klaidinga vestis"}}};function tpe(){return{localeError:epe()}}const rpe=()=>{const t={string:{unit:"",verb:" "},file:{unit:"",verb:" "},array:{unit:"",verb:" "},set:{unit:"",verb:" "}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"";case"object":{if(Array.isArray(i))return"";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"",email:"  -",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO   ",date:"ISO ",time:"ISO ",duration:"ISO ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"base64- ",base64url:"base64url- ",json_string:"JSON ",e164:"E.164 ",jwt:"JWT",template_literal:""};return i=>{switch(i.code){case"invalid_type":return` :   ${i.expected},  ${r(i.input)}`;case"invalid_value":return i.values.length===1?`Invalid input: expected ${yr(i.values[0])}`:` :    ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?` :   ${i.origin??""}   ${a}${i.maximum.toString()} ${o.unit??""}`:` :   ${i.origin??""}   ${a}${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?` :   ${i.origin}   ${a}${i.minimum.toString()} ${o.unit}`:` :   ${i.origin}   ${a}${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?` :     "${a.prefix}"`:a.format==="ends_with"?` :     "${a.suffix}"`:a.format==="includes"?` :    "${a.includes}"`:a.format==="regex"?` :      ${a.pattern}`:`Invalid ${n[a.format]??i.format}`}case"not_multiple_of":return` :      ${i.divisor}`;case"unrecognized_keys":return`${i.keys.length>1?" ":" "}: ${gt(i.keys,", ")}`;case"invalid_key":return`   ${i.origin}`;case"invalid_union":return" ";case"invalid_element":return`   ${i.origin}`;default:return" "}}};function npe(){return{localeError:rpe()}}const ipe=()=>{const t={string:{unit:"aksara",verb:"mempunyai"},file:{unit:"bait",verb:"mempunyai"},array:{unit:"elemen",verb:"mempunyai"},set:{unit:"elemen",verb:"mempunyai"}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"nombor";case"object":{if(Array.isArray(i))return"array";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"input",email:"alamat e-mel",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"tarikh masa ISO",date:"tarikh ISO",time:"masa ISO",duration:"tempoh ISO",ipv4:"alamat IPv4",ipv6:"alamat IPv6",cidrv4:"julat IPv4",cidrv6:"julat IPv6",base64:"string dikodkan base64",base64url:"string dikodkan base64url",json_string:"string JSON",e164:"nombor E.164",jwt:"JWT",template_literal:"input"};return i=>{switch(i.code){case"invalid_type":return`Input tidak sah: dijangka ${i.expected}, diterima ${r(i.input)}`;case"invalid_value":return i.values.length===1?`Input tidak sah: dijangka ${yr(i.values[0])}`:`Pilihan tidak sah: dijangka salah satu daripada ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?`Terlalu besar: dijangka ${i.origin??"nilai"} ${o.verb} ${a}${i.maximum.toString()} ${o.unit??"elemen"}`:`Terlalu besar: dijangka ${i.origin??"nilai"} adalah ${a}${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?`Terlalu kecil: dijangka ${i.origin} ${o.verb} ${a}${i.minimum.toString()} ${o.unit}`:`Terlalu kecil: dijangka ${i.origin} adalah ${a}${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?`String tidak sah: mesti bermula dengan "${a.prefix}"`:a.format==="ends_with"?`String tidak sah: mesti berakhir dengan "${a.suffix}"`:a.format==="includes"?`String tidak sah: mesti mengandungi "${a.includes}"`:a.format==="regex"?`String tidak sah: mesti sepadan dengan corak ${a.pattern}`:`${n[a.format]??i.format} tidak sah`}case"not_multiple_of":return`Nombor tidak sah: perlu gandaan ${i.divisor}`;case"unrecognized_keys":return`Kunci tidak dikenali: ${gt(i.keys,", ")}`;case"invalid_key":return`Kunci tidak sah dalam ${i.origin}`;case"invalid_union":return"Input tidak sah";case"invalid_element":return`Nilai tidak sah dalam ${i.origin}`;default:return"Input tidak sah"}}};function ape(){return{localeError:ipe()}}const ope=()=>{const t={string:{unit:"tekens"},file:{unit:"bytes"},array:{unit:"elementen"},set:{unit:"elementen"}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"getal";case"object":{if(Array.isArray(i))return"array";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"invoer",email:"emailadres",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datum en tijd",date:"ISO datum",time:"ISO tijd",duration:"ISO duur",ipv4:"IPv4-adres",ipv6:"IPv6-adres",cidrv4:"IPv4-bereik",cidrv6:"IPv6-bereik",base64:"base64-gecodeerde tekst",base64url:"base64 URL-gecodeerde tekst",json_string:"JSON string",e164:"E.164-nummer",jwt:"JWT",template_literal:"invoer"};return i=>{switch(i.code){case"invalid_type":return`Ongeldige invoer: verwacht ${i.expected}, ontving ${r(i.input)}`;case"invalid_value":return i.values.length===1?`Ongeldige invoer: verwacht ${yr(i.values[0])}`:`Ongeldige optie: verwacht n van ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?`Te lang: verwacht dat ${i.origin??"waarde"} ${a}${i.maximum.toString()} ${o.unit??"elementen"} bevat`:`Te lang: verwacht dat ${i.origin??"waarde"} ${a}${i.maximum.toString()} is`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?`Te kort: verwacht dat ${i.origin} ${a}${i.minimum.toString()} ${o.unit} bevat`:`Te kort: verwacht dat ${i.origin} ${a}${i.minimum.toString()} is`}case"invalid_format":{const a=i;return a.format==="starts_with"?`Ongeldige tekst: moet met "${a.prefix}" beginnen`:a.format==="ends_with"?`Ongeldige tekst: moet op "${a.suffix}" eindigen`:a.format==="includes"?`Ongeldige tekst: moet "${a.includes}" bevatten`:a.format==="regex"?`Ongeldige tekst: moet overeenkomen met patroon ${a.pattern}`:`Ongeldig: ${n[a.format]??i.format}`}case"not_multiple_of":return`Ongeldig getal: moet een veelvoud van ${i.divisor} zijn`;case"unrecognized_keys":return`Onbekende key${i.keys.length>1?"s":""}: ${gt(i.keys,", ")}`;case"invalid_key":return`Ongeldige key in ${i.origin}`;case"invalid_union":return"Ongeldige invoer";case"invalid_element":return`Ongeldige waarde in ${i.origin}`;default:return"Ongeldige invoer"}}};function spe(){return{localeError:ope()}}const lpe=()=>{const t={string:{unit:"tegn",verb:" ha"},file:{unit:"bytes",verb:" ha"},array:{unit:"elementer",verb:" inneholde"},set:{unit:"elementer",verb:" inneholde"}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"tall";case"object":{if(Array.isArray(i))return"liste";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"input",email:"e-postadresse",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO dato- og klokkeslett",date:"ISO-dato",time:"ISO-klokkeslett",duration:"ISO-varighet",ipv4:"IPv4-omrde",ipv6:"IPv6-omrde",cidrv4:"IPv4-spekter",cidrv6:"IPv6-spekter",base64:"base64-enkodet streng",base64url:"base64url-enkodet streng",json_string:"JSON-streng",e164:"E.164-nummer",jwt:"JWT",template_literal:"input"};return i=>{switch(i.code){case"invalid_type":return`Ugyldig input: forventet ${i.expected}, fikk ${r(i.input)}`;case"invalid_value":return i.values.length===1?`Ugyldig verdi: forventet ${yr(i.values[0])}`:`Ugyldig valg: forventet en av ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?`For stor(t): forventet ${i.origin??"value"} til  ha ${a}${i.maximum.toString()} ${o.unit??"elementer"}`:`For stor(t): forventet ${i.origin??"value"} til  ha ${a}${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?`For lite(n): forventet ${i.origin} til  ha ${a}${i.minimum.toString()} ${o.unit}`:`For lite(n): forventet ${i.origin} til  ha ${a}${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?`Ugyldig streng: m starte med "${a.prefix}"`:a.format==="ends_with"?`Ugyldig streng: m ende med "${a.suffix}"`:a.format==="includes"?`Ugyldig streng: m inneholde "${a.includes}"`:a.format==="regex"?`Ugyldig streng: m matche mnsteret ${a.pattern}`:`Ugyldig ${n[a.format]??i.format}`}case"not_multiple_of":return`Ugyldig tall: m vre et multiplum av ${i.divisor}`;case"unrecognized_keys":return`${i.keys.length>1?"Ukjente nkler":"Ukjent nkkel"}: ${gt(i.keys,", ")}`;case"invalid_key":return`Ugyldig nkkel i ${i.origin}`;case"invalid_union":return"Ugyldig input";case"invalid_element":return`Ugyldig verdi i ${i.origin}`;default:return"Ugyldig input"}}};function upe(){return{localeError:lpe()}}const cpe=()=>{const t={string:{unit:"harf",verb:"olmaldr"},file:{unit:"bayt",verb:"olmaldr"},array:{unit:"unsur",verb:"olmaldr"},set:{unit:"unsur",verb:"olmaldr"}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"numara";case"object":{if(Array.isArray(i))return"saf";if(i===null)return"gayb";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"giren",email:"epostagh",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO hengm",date:"ISO tarihi",time:"ISO zaman",duration:"ISO mddeti",ipv4:"IPv4 nin",ipv6:"IPv6 nin",cidrv4:"IPv4 menzili",cidrv6:"IPv6 menzili",base64:"base64-ifreli metin",base64url:"base64url-ifreli metin",json_string:"JSON metin",e164:"E.164 says",jwt:"JWT",template_literal:"giren"};return i=>{switch(i.code){case"invalid_type":return`Fsit giren: umulan ${i.expected}, alnan ${r(i.input)}`;case"invalid_value":return i.values.length===1?`Fsit giren: umulan ${yr(i.values[0])}`:`Fsit tercih: mteberler ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?`Fazla byk: ${i.origin??"value"}, ${a}${i.maximum.toString()} ${o.unit??"elements"} sahip olmalyd.`:`Fazla byk: ${i.origin??"value"}, ${a}${i.maximum.toString()} olmalyd.`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?`Fazla kk: ${i.origin}, ${a}${i.minimum.toString()} ${o.unit} sahip olmalyd.`:`Fazla kk: ${i.origin}, ${a}${i.minimum.toString()} olmalyd.`}case"invalid_format":{const a=i;return a.format==="starts_with"?`Fsit metin: "${a.prefix}" ile balamal.`:a.format==="ends_with"?`Fsit metin: "${a.suffix}" ile bitmeli.`:a.format==="includes"?`Fsit metin: "${a.includes}" ihtiv etmeli.`:a.format==="regex"?`Fsit metin: ${a.pattern} nakna uymal.`:`Fsit ${n[a.format]??i.format}`}case"not_multiple_of":return`Fsit say: ${i.divisor} kat olmalyd.`;case"unrecognized_keys":return`Tannmayan anahtar ${i.keys.length>1?"s":""}: ${gt(i.keys,", ")}`;case"invalid_key":return`${i.origin} iin tannmayan anahtar var.`;case"invalid_union":return"Giren tannamad.";case"invalid_element":return`${i.origin} iin tannmayan kymet var.`;default:return"Kymet tannamad."}}};function hpe(){return{localeError:cpe()}}const dpe=()=>{const t={string:{unit:"",verb:""},file:{unit:"",verb:""},array:{unit:"",verb:""},set:{unit:"",verb:""}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"";case"object":{if(Array.isArray(i))return"";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"",email:"",url:"  ",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"  ",date:"",time:"",duration:"",ipv4:" IPv4 ",ipv6:" IPv6 ",cidrv4:" IPv4 ",cidrv6:" IPv6 ",base64:"base64-encoded ",base64url:"base64url-encoded ",json_string:"JSON ",e164:" E.164 ",jwt:"JWT",template_literal:""};return i=>{switch(i.code){case"invalid_type":return` :  ${i.expected} ,  ${r(i.input)}  `;case"invalid_value":return i.values.length===1?` :  ${yr(i.values[0])} `:` :    ${gt(i.values,"|")}  `;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?` : ${i.origin??""}  ${a}${i.maximum.toString()} ${o.unit??""} `:` : ${i.origin??""}  ${a}${i.maximum.toString()} `}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?` : ${i.origin}  ${a}${i.minimum.toString()} ${o.unit} `:` : ${i.origin}  ${a}${i.minimum.toString()} `}case"invalid_format":{const a=i;return a.format==="starts_with"?` :   "${a.prefix}"   `:a.format==="ends_with"?` :   "${a.suffix}"    `:a.format==="includes"?` :  "${a.includes}" `:a.format==="regex"?` :   ${a.pattern}   `:`${n[a.format]??i.format}  `}case"not_multiple_of":return` :   ${i.divisor}  `;case"unrecognized_keys":return` ${i.keys.length>1?"":""}: ${gt(i.keys,", ")}`;case"invalid_key":return`   ${i.origin} `;case"invalid_union":return" ";case"invalid_element":return`   ${i.origin} `;default:return" "}}};function ppe(){return{localeError:dpe()}}const fpe=()=>{const t={string:{unit:"znakw",verb:"mie"},file:{unit:"bajtw",verb:"mie"},array:{unit:"elementw",verb:"mie"},set:{unit:"elementw",verb:"mie"}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"liczba";case"object":{if(Array.isArray(i))return"tablica";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"wyraenie",email:"adres email",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"data i godzina w formacie ISO",date:"data w formacie ISO",time:"godzina w formacie ISO",duration:"czas trwania ISO",ipv4:"adres IPv4",ipv6:"adres IPv6",cidrv4:"zakres IPv4",cidrv6:"zakres IPv6",base64:"cig znakw zakodowany w formacie base64",base64url:"cig znakw zakodowany w formacie base64url",json_string:"cig znakw w formacie JSON",e164:"liczba E.164",jwt:"JWT",template_literal:"wejcie"};return i=>{switch(i.code){case"invalid_type":return`Nieprawidowe dane wejciowe: oczekiwano ${i.expected}, otrzymano ${r(i.input)}`;case"invalid_value":return i.values.length===1?`Nieprawidowe dane wejciowe: oczekiwano ${yr(i.values[0])}`:`Nieprawidowa opcja: oczekiwano jednej z wartoci ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?`Za dua warto: oczekiwano, e ${i.origin??"warto"} bdzie mie ${a}${i.maximum.toString()} ${o.unit??"elementw"}`:`Zbyt du(y/a/e): oczekiwano, e ${i.origin??"warto"} bdzie wynosi ${a}${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?`Za maa warto: oczekiwano, e ${i.origin??"warto"} bdzie mie ${a}${i.minimum.toString()} ${o.unit??"elementw"}`:`Zbyt ma(y/a/e): oczekiwano, e ${i.origin??"warto"} bdzie wynosi ${a}${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?`Nieprawidowy cig znakw: musi zaczyna si od "${a.prefix}"`:a.format==="ends_with"?`Nieprawidowy cig znakw: musi koczy si na "${a.suffix}"`:a.format==="includes"?`Nieprawidowy cig znakw: musi zawiera "${a.includes}"`:a.format==="regex"?`Nieprawidowy cig znakw: musi odpowiada wzorcowi ${a.pattern}`:`Nieprawidow(y/a/e) ${n[a.format]??i.format}`}case"not_multiple_of":return`Nieprawidowa liczba: musi by wielokrotnoci ${i.divisor}`;case"unrecognized_keys":return`Nierozpoznane klucze${i.keys.length>1?"s":""}: ${gt(i.keys,", ")}`;case"invalid_key":return`Nieprawidowy klucz w ${i.origin}`;case"invalid_union":return"Nieprawidowe dane wejciowe";case"invalid_element":return`Nieprawidowa warto w ${i.origin}`;default:return"Nieprawidowe dane wejciowe"}}};function mpe(){return{localeError:fpe()}}const gpe=()=>{const t={string:{unit:"caracteres",verb:"ter"},file:{unit:"bytes",verb:"ter"},array:{unit:"itens",verb:"ter"},set:{unit:"itens",verb:"ter"}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"nmero";case"object":{if(Array.isArray(i))return"array";if(i===null)return"nulo";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"padro",email:"endereo de e-mail",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"data e hora ISO",date:"data ISO",time:"hora ISO",duration:"durao ISO",ipv4:"endereo IPv4",ipv6:"endereo IPv6",cidrv4:"faixa de IPv4",cidrv6:"faixa de IPv6",base64:"texto codificado em base64",base64url:"URL codificada em base64",json_string:"texto JSON",e164:"nmero E.164",jwt:"JWT",template_literal:"entrada"};return i=>{switch(i.code){case"invalid_type":return`Tipo invlido: esperado ${i.expected}, recebido ${r(i.input)}`;case"invalid_value":return i.values.length===1?`Entrada invlida: esperado ${yr(i.values[0])}`:`Opo invlida: esperada uma das ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?`Muito grande: esperado que ${i.origin??"valor"} tivesse ${a}${i.maximum.toString()} ${o.unit??"elementos"}`:`Muito grande: esperado que ${i.origin??"valor"} fosse ${a}${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?`Muito pequeno: esperado que ${i.origin} tivesse ${a}${i.minimum.toString()} ${o.unit}`:`Muito pequeno: esperado que ${i.origin} fosse ${a}${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?`Texto invlido: deve comear com "${a.prefix}"`:a.format==="ends_with"?`Texto invlido: deve terminar com "${a.suffix}"`:a.format==="includes"?`Texto invlido: deve incluir "${a.includes}"`:a.format==="regex"?`Texto invlido: deve corresponder ao padro ${a.pattern}`:`${n[a.format]??i.format} invlido`}case"not_multiple_of":return`Nmero invlido: deve ser mltiplo de ${i.divisor}`;case"unrecognized_keys":return`Chave${i.keys.length>1?"s":""} desconhecida${i.keys.length>1?"s":""}: ${gt(i.keys,", ")}`;case"invalid_key":return`Chave invlida em ${i.origin}`;case"invalid_union":return"Entrada invlida";case"invalid_element":return`Valor invlido em ${i.origin}`;default:return"Campo invlido"}}};function ype(){return{localeError:gpe()}}function mz(t,e,r,n){const i=Math.abs(t),a=i%10,o=i%100;return o>=11&&o<=19?n:a===1?e:a>=2&&a<=4?r:n}const vpe=()=>{const t={string:{unit:{one:"",few:"",many:""},verb:""},file:{unit:{one:"",few:"",many:""},verb:""},array:{unit:{one:"",few:"",many:""},verb:""},set:{unit:{one:"",few:"",many:""},verb:""}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"";case"object":{if(Array.isArray(i))return"";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"",email:"email ",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO   ",date:"ISO ",time:"ISO ",duration:"ISO ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"   base64",base64url:"   base64url",json_string:"JSON ",e164:" E.164",jwt:"JWT",template_literal:""};return i=>{switch(i.code){case"invalid_type":return` :  ${i.expected},  ${r(i.input)}`;case"invalid_value":return i.values.length===1?` :  ${yr(i.values[0])}`:` :    ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);if(o){const s=Number(i.maximum),l=mz(s,o.unit.one,o.unit.few,o.unit.many);return`  : ,  ${i.origin??""}   ${a}${i.maximum.toString()} ${l}`}return`  : ,  ${i.origin??""}  ${a}${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);if(o){const s=Number(i.minimum),l=mz(s,o.unit.one,o.unit.few,o.unit.many);return`  : ,  ${i.origin}   ${a}${i.minimum.toString()} ${l}`}return`  : ,  ${i.origin}  ${a}${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?` :    "${a.prefix}"`:a.format==="ends_with"?` :    "${a.suffix}"`:a.format==="includes"?` :   "${a.includes}"`:a.format==="regex"?` :    ${a.pattern}`:` ${n[a.format]??i.format}`}case"not_multiple_of":return` :    ${i.divisor}`;case"unrecognized_keys":return`${i.keys.length>1?"":""} ${i.keys.length>1?"":""}: ${gt(i.keys,", ")}`;case"invalid_key":return`   ${i.origin}`;case"invalid_union":return"  ";case"invalid_element":return`   ${i.origin}`;default:return"  "}}};function _pe(){return{localeError:vpe()}}const xpe=()=>{const t={string:{unit:"znakov",verb:"imeti"},file:{unit:"bajtov",verb:"imeti"},array:{unit:"elementov",verb:"imeti"},set:{unit:"elementov",verb:"imeti"}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"tevilo";case"object":{if(Array.isArray(i))return"tabela";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"vnos",email:"e-potni naslov",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datum in as",date:"ISO datum",time:"ISO as",duration:"ISO trajanje",ipv4:"IPv4 naslov",ipv6:"IPv6 naslov",cidrv4:"obseg IPv4",cidrv6:"obseg IPv6",base64:"base64 kodiran niz",base64url:"base64url kodiran niz",json_string:"JSON niz",e164:"E.164 tevilka",jwt:"JWT",template_literal:"vnos"};return i=>{switch(i.code){case"invalid_type":return`Neveljaven vnos: priakovano ${i.expected}, prejeto ${r(i.input)}`;case"invalid_value":return i.values.length===1?`Neveljaven vnos: priakovano ${yr(i.values[0])}`:`Neveljavna monost: priakovano eno izmed ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?`Preveliko: priakovano, da bo ${i.origin??"vrednost"} imelo ${a}${i.maximum.toString()} ${o.unit??"elementov"}`:`Preveliko: priakovano, da bo ${i.origin??"vrednost"} ${a}${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?`Premajhno: priakovano, da bo ${i.origin} imelo ${a}${i.minimum.toString()} ${o.unit}`:`Premajhno: priakovano, da bo ${i.origin} ${a}${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?`Neveljaven niz: mora se zaeti z "${a.prefix}"`:a.format==="ends_with"?`Neveljaven niz: mora se konati z "${a.suffix}"`:a.format==="includes"?`Neveljaven niz: mora vsebovati "${a.includes}"`:a.format==="regex"?`Neveljaven niz: mora ustrezati vzorcu ${a.pattern}`:`Neveljaven ${n[a.format]??i.format}`}case"not_multiple_of":return`Neveljavno tevilo: mora biti vekratnik ${i.divisor}`;case"unrecognized_keys":return`Neprepoznan${i.keys.length>1?"i kljui":" klju"}: ${gt(i.keys,", ")}`;case"invalid_key":return`Neveljaven klju v ${i.origin}`;case"invalid_union":return"Neveljaven vnos";case"invalid_element":return`Neveljavna vrednost v ${i.origin}`;default:return"Neveljaven vnos"}}};function bpe(){return{localeError:xpe()}}const wpe=()=>{const t={string:{unit:"tecken",verb:"att ha"},file:{unit:"bytes",verb:"att ha"},array:{unit:"objekt",verb:"att innehlla"},set:{unit:"objekt",verb:"att innehlla"}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"antal";case"object":{if(Array.isArray(i))return"lista";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"reguljrt uttryck",email:"e-postadress",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO-datum och tid",date:"ISO-datum",time:"ISO-tid",duration:"ISO-varaktighet",ipv4:"IPv4-intervall",ipv6:"IPv6-intervall",cidrv4:"IPv4-spektrum",cidrv6:"IPv6-spektrum",base64:"base64-kodad strng",base64url:"base64url-kodad strng",json_string:"JSON-strng",e164:"E.164-nummer",jwt:"JWT",template_literal:"mall-literal"};return i=>{switch(i.code){case"invalid_type":return`Ogiltig inmatning: frvntat ${i.expected}, fick ${r(i.input)}`;case"invalid_value":return i.values.length===1?`Ogiltig inmatning: frvntat ${yr(i.values[0])}`:`Ogiltigt val: frvntade en av ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?`Fr stor(t): frvntade ${i.origin??"vrdet"} att ha ${a}${i.maximum.toString()} ${o.unit??"element"}`:`Fr stor(t): frvntat ${i.origin??"vrdet"} att ha ${a}${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?`Fr lite(t): frvntade ${i.origin??"vrdet"} att ha ${a}${i.minimum.toString()} ${o.unit}`:`Fr lite(t): frvntade ${i.origin??"vrdet"} att ha ${a}${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?`Ogiltig strng: mste brja med "${a.prefix}"`:a.format==="ends_with"?`Ogiltig strng: mste sluta med "${a.suffix}"`:a.format==="includes"?`Ogiltig strng: mste innehlla "${a.includes}"`:a.format==="regex"?`Ogiltig strng: mste matcha mnstret "${a.pattern}"`:`Ogiltig(t) ${n[a.format]??i.format}`}case"not_multiple_of":return`Ogiltigt tal: mste vara en multipel av ${i.divisor}`;case"unrecognized_keys":return`${i.keys.length>1?"Oknda nycklar":"Oknd nyckel"}: ${gt(i.keys,", ")}`;case"invalid_key":return`Ogiltig nyckel i ${i.origin??"vrdet"}`;case"invalid_union":return"Ogiltig input";case"invalid_element":return`Ogiltigt vrde i ${i.origin??"vrdet"}`;default:return"Ogiltig input"}}};function Ape(){return{localeError:wpe()}}const Spe=()=>{const t={string:{unit:"",verb:" "},file:{unit:"",verb:" "},array:{unit:"",verb:" "},set:{unit:"",verb:" "}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?" ":"";case"object":{if(Array.isArray(i))return"";if(i===null)return"";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"",email:" ",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO  ",date:"ISO ",time:"ISO ",duration:"ISO  ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"base64-encoded ",base64url:"base64url-encoded ",json_string:"JSON ",e164:"E.164 ",jwt:"JWT",template_literal:"input"};return i=>{switch(i.code){case"invalid_type":return` :  ${i.expected},  ${r(i.input)}`;case"invalid_value":return i.values.length===1?` :  ${yr(i.values[0])}`:` :  ${gt(i.values,"|")}  `;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?` :  ${i.origin??""} ${a}${i.maximum.toString()} ${o.unit??""}   `:` :  ${i.origin??""} ${a}${i.maximum.toString()}   `}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?` :  ${i.origin} ${a}${i.minimum.toString()} ${o.unit}   `:` :  ${i.origin} ${a}${i.minimum.toString()}   `}case"invalid_format":{const a=i;return a.format==="starts_with"?` : "${a.prefix}"   `:a.format==="ends_with"?` : "${a.suffix}"   `:a.format==="includes"?` : "${a.includes}"   `:a.format==="regex"?` : ${a.pattern}   `:` ${n[a.format]??i.format}`}case"not_multiple_of":return` : ${i.divisor}    `;case"unrecognized_keys":return`  ${i.keys.length>1?"":""}: ${gt(i.keys,", ")}`;case"invalid_key":return`${i.origin}   `;case"invalid_union":return" ";case"invalid_element":return`${i.origin}   `;default:return" "}}};function Epe(){return{localeError:Spe()}}const Ipe=()=>{const t={string:{unit:"",verb:""},file:{unit:"",verb:""},array:{unit:"",verb:""},set:{unit:"",verb:""}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?" (NaN)":"";case"object":{if(Array.isArray(i))return" (Array)";if(i===null)return" (null)";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"",email:"",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:" ISO",date:" ISO",time:" ISO",duration:" ISO",ipv4:" IPv4",ipv6:" IPv6",cidrv4:" IP  IPv4",cidrv6:" IP  IPv6",base64:" Base64",base64url:" Base64  URL",json_string:" JSON",e164:" (E.164)",jwt:" JWT",template_literal:""};return i=>{switch(i.code){case"invalid_type":return`:  ${i.expected}  ${r(i.input)}`;case"invalid_value":return i.values.length===1?`:  ${yr(i.values[0])}`:`:  ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"":"",o=e(i.origin);return o?`: ${i.origin??""} ${a} ${i.maximum.toString()} ${o.unit??""}`:`: ${i.origin??""} ${a} ${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?"":"",o=e(i.origin);return o?`: ${i.origin} ${a} ${i.minimum.toString()} ${o.unit}`:`: ${i.origin} ${a} ${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?`:  "${a.prefix}"`:a.format==="ends_with"?`:  "${a.suffix}"`:a.format==="includes"?`:  "${a.includes}" `:a.format==="regex"?`:  ${a.pattern}`:`: ${n[a.format]??i.format}`}case"not_multiple_of":return`:  ${i.divisor} `;case"unrecognized_keys":return`: ${gt(i.keys,", ")}`;case"invalid_key":return` ${i.origin}`;case"invalid_union":return": ";case"invalid_element":return` ${i.origin}`;default:return""}}};function Cpe(){return{localeError:Ipe()}}const Mpe=t=>{const e=typeof t;switch(e){case"number":return Number.isNaN(t)?"NaN":"number";case"object":{if(Array.isArray(t))return"array";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return e},Tpe=()=>{const t={string:{unit:"karakter",verb:"olmal"},file:{unit:"bayt",verb:"olmal"},array:{unit:"e",verb:"olmal"},set:{unit:"e",verb:"olmal"}};function e(n){return t[n]??null}const r={regex:"girdi",email:"e-posta adresi",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO tarih ve saat",date:"ISO tarih",time:"ISO saat",duration:"ISO sre",ipv4:"IPv4 adresi",ipv6:"IPv6 adresi",cidrv4:"IPv4 aral",cidrv6:"IPv6 aral",base64:"base64 ile ifrelenmi metin",base64url:"base64url ile ifrelenmi metin",json_string:"JSON dizesi",e164:"E.164 says",jwt:"JWT",template_literal:"ablon dizesi"};return n=>{switch(n.code){case"invalid_type":return`Geersiz deer: beklenen ${n.expected}, alnan ${Mpe(n.input)}`;case"invalid_value":return n.values.length===1?`Geersiz deer: beklenen ${yr(n.values[0])}`:`Geersiz seenek: aadakilerden biri olmal: ${gt(n.values,"|")}`;case"too_big":{const i=n.inclusive?"<=":"<",a=e(n.origin);return a?`ok byk: beklenen ${n.origin??"deer"} ${i}${n.maximum.toString()} ${a.unit??"e"}`:`ok byk: beklenen ${n.origin??"deer"} ${i}${n.maximum.toString()}`}case"too_small":{const i=n.inclusive?">=":">",a=e(n.origin);return a?`ok kk: beklenen ${n.origin} ${i}${n.minimum.toString()} ${a.unit}`:`ok kk: beklenen ${n.origin} ${i}${n.minimum.toString()}`}case"invalid_format":{const i=n;return i.format==="starts_with"?`Geersiz metin: "${i.prefix}" ile balamal`:i.format==="ends_with"?`Geersiz metin: "${i.suffix}" ile bitmeli`:i.format==="includes"?`Geersiz metin: "${i.includes}" iermeli`:i.format==="regex"?`Geersiz metin: ${i.pattern} desenine uymal`:`Geersiz ${r[i.format]??n.format}`}case"not_multiple_of":return`Geersiz say: ${n.divisor} ile tam blnebilmeli`;case"unrecognized_keys":return`Tannmayan anahtar${n.keys.length>1?"lar":""}: ${gt(n.keys,", ")}`;case"invalid_key":return`${n.origin} iinde geersiz anahtar`;case"invalid_union":return"Geersiz deer";case"invalid_element":return`${n.origin} iinde geersiz deer`;default:return"Geersiz deer"}}};function Ppe(){return{localeError:Tpe()}}const Dpe=()=>{const t={string:{unit:"",verb:""},file:{unit:"",verb:""},array:{unit:"",verb:""},set:{unit:"",verb:""}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"";case"object":{if(Array.isArray(i))return"";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:" ",email:"  ",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"   ISO",date:" ISO",time:" ISO",duration:" ISO",ipv4:" IPv4",ipv6:" IPv6",cidrv4:" IPv4",cidrv6:" IPv6",base64:"   base64",base64url:"   base64url",json_string:" JSON",e164:" E.164",jwt:"JWT",template_literal:" "};return i=>{switch(i.code){case"invalid_type":return`  :  ${i.expected},  ${r(i.input)}`;case"invalid_value":return i.values.length===1?`  :  ${yr(i.values[0])}`:` :    ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?` : ,  ${i.origin??""} ${o.verb} ${a}${i.maximum.toString()} ${o.unit??""}`:` : ,  ${i.origin??""}  ${a}${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?` : ,  ${i.origin} ${o.verb} ${a}${i.minimum.toString()} ${o.unit}`:` : ,  ${i.origin}  ${a}${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?` :    "${a.prefix}"`:a.format==="ends_with"?` :    "${a.suffix}"`:a.format==="includes"?` :   "${a.includes}"`:a.format==="regex"?` :    ${a.pattern}`:` ${n[a.format]??i.format}`}case"not_multiple_of":return` :    ${i.divisor}`;case"unrecognized_keys":return` ${i.keys.length>1?"":""}: ${gt(i.keys,", ")}`;case"invalid_key":return`   ${i.origin}`;case"invalid_union":return"  ";case"invalid_element":return`   ${i.origin}`;default:return"  "}}};function bj(){return{localeError:Dpe()}}function kpe(){return bj()}const Ope=()=>{const t={string:{unit:"",verb:""},file:{unit:"",verb:""},array:{unit:"",verb:""},set:{unit:"",verb:""}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"";case"object":{if(Array.isArray(i))return"";if(i===null)return"";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:" ",email:"  ",url:"  ",emoji:"",uuid:"   ",uuidv4:"     4",uuidv6:"     6",nanoid:"  ",guid:"   ",cuid:"   ",cuid2:"    2",ulid:"   ",xid:"  ",ksuid:"    ",datetime:"    ",date:"   ",time:"   ",duration:"   ",ipv4:"   4 ",ipv6:"   6 ",cidrv4:"   4 ",cidrv6:"   6 ",base64:" 64   ",base64url:" 64      ",json_string:"    ",e164:" 164 ",jwt:"  ",template_literal:" "};return i=>{switch(i.code){case"invalid_type":return`  : ${i.expected}   ${r(i.input)}  `;case"invalid_value":return i.values.length===1?`  : ${yr(i.values[0])}  `:` : ${gt(i.values,"|")}     `;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?` : ${i.origin??""}  ${a}${i.maximum.toString()} ${o.unit??""}   `:` : ${i.origin??""}  ${a}${i.maximum.toString()}   `}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?` : ${i.origin}  ${a}${i.minimum.toString()} ${o.unit}   `:` : ${i.origin}  ${a}${i.minimum.toString()}   `}case"invalid_format":{const a=i;return a.format==="starts_with"?` : "${a.prefix}"    `:a.format==="ends_with"?` : "${a.suffix}"    `:a.format==="includes"?` : "${a.includes}"   `:a.format==="regex"?` :  ${a.pattern}    `:` ${n[a.format]??i.format}`}case"not_multiple_of":return` : ${i.divisor}    `;case"unrecognized_keys":return`   ${i.keys.length>1?"":""}: ${gt(i.keys," ")}`;case"invalid_key":return`${i.origin}   `;case"invalid_union":return"  ";case"invalid_element":return`${i.origin}   `;default:return"  "}}};function Bpe(){return{localeError:Ope()}}const zpe=()=>{const t={string:{unit:"k t",verb:"c"},file:{unit:"byte",verb:"c"},array:{unit:"phn t",verb:"c"},set:{unit:"phn t",verb:"c"}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"s";case"object":{if(Array.isArray(i))return"mng";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"u vo",email:"a ch email",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ngy gi ISO",date:"ngy ISO",time:"gi ISO",duration:"khong thi gian ISO",ipv4:"a ch IPv4",ipv6:"a ch IPv6",cidrv4:"di IPv4",cidrv6:"di IPv6",base64:"chui m ha base64",base64url:"chui m ha base64url",json_string:"chui JSON",e164:"s E.164",jwt:"JWT",template_literal:"u vo"};return i=>{switch(i.code){case"invalid_type":return`u vo khng hp l: mong i ${i.expected}, nhn c ${r(i.input)}`;case"invalid_value":return i.values.length===1?`u vo khng hp l: mong i ${yr(i.values[0])}`:`Ty chn khng hp l: mong i mt trong cc gi tr ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?`Qu ln: mong i ${i.origin??"gi tr"} ${o.verb} ${a}${i.maximum.toString()} ${o.unit??"phn t"}`:`Qu ln: mong i ${i.origin??"gi tr"} ${a}${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?`Qu nh: mong i ${i.origin} ${o.verb} ${a}${i.minimum.toString()} ${o.unit}`:`Qu nh: mong i ${i.origin} ${a}${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?`Chui khng hp l: phi bt u bng "${a.prefix}"`:a.format==="ends_with"?`Chui khng hp l: phi kt thc bng "${a.suffix}"`:a.format==="includes"?`Chui khng hp l: phi bao gm "${a.includes}"`:a.format==="regex"?`Chui khng hp l: phi khp vi mu ${a.pattern}`:`${n[a.format]??i.format} khng hp l`}case"not_multiple_of":return`S khng hp l: phi l bi s ca ${i.divisor}`;case"unrecognized_keys":return`Kha khng c nhn dng: ${gt(i.keys,", ")}`;case"invalid_key":return`Kha khng hp l trong ${i.origin}`;case"invalid_union":return"u vo khng hp l";case"invalid_element":return`Gi tr khng hp l trong ${i.origin}`;default:return"u vo khng hp l"}}};function Fpe(){return{localeError:zpe()}}const Rpe=()=>{const t={string:{unit:"",verb:""},file:{unit:"",verb:""},array:{unit:"",verb:""},set:{unit:"",verb:""}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"(NaN)":"";case"object":{if(Array.isArray(i))return"";if(i===null)return"(null)";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"",email:"",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO",date:"ISO",time:"ISO",duration:"ISO",ipv4:"IPv4",ipv6:"IPv6",cidrv4:"IPv4",cidrv6:"IPv6",base64:"base64",base64url:"base64url",json_string:"JSON",e164:"E.164",jwt:"JWT",template_literal:""};return i=>{switch(i.code){case"invalid_type":return` ${i.expected} ${r(i.input)}`;case"invalid_value":return i.values.length===1?` ${yr(i.values[0])}`:` ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?` ${i.origin??""} ${a}${i.maximum.toString()} ${o.unit??""}`:` ${i.origin??""} ${a}${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?` ${i.origin} ${a}${i.minimum.toString()} ${o.unit}`:` ${i.origin} ${a}${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?` "${a.prefix}" `:a.format==="ends_with"?` "${a.suffix}" `:a.format==="includes"?` "${a.includes}"`:a.format==="regex"?` ${a.pattern}`:`${n[a.format]??i.format}`}case"not_multiple_of":return` ${i.divisor} `;case"unrecognized_keys":return`(key): ${gt(i.keys,", ")}`;case"invalid_key":return`${i.origin} (key)`;case"invalid_union":return"";case"invalid_element":return`${i.origin} (value)`;default:return""}}};function Lpe(){return{localeError:Rpe()}}const Npe=()=>{const t={string:{unit:"",verb:""},file:{unit:"",verb:""},array:{unit:"",verb:""},set:{unit:"",verb:""}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"number";case"object":{if(Array.isArray(i))return"array";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"",email:"",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO ",date:"ISO ",time:"ISO ",duration:"ISO ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"base64 ",base64url:"base64url ",json_string:"JSON ",e164:"E.164 ",jwt:"JWT",template_literal:""};return i=>{switch(i.code){case"invalid_type":return` ${i.expected} ${r(i.input)}`;case"invalid_value":return i.values.length===1?` ${yr(i.values[0])}`:` ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?` ${i.origin??""}  ${a}${i.maximum.toString()} ${o.unit??""}`:` ${i.origin??""}  ${a}${i.maximum.toString()}`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?` ${i.origin}  ${a}${i.minimum.toString()} ${o.unit}`:` ${i.origin}  ${a}${i.minimum.toString()}`}case"invalid_format":{const a=i;return a.format==="starts_with"?` "${a.prefix}" `:a.format==="ends_with"?` "${a.suffix}" `:a.format==="includes"?` "${a.includes}"`:a.format==="regex"?` ${a.pattern}`:` ${n[a.format]??i.format}`}case"not_multiple_of":return` ${i.divisor} `;case"unrecognized_keys":return`${i.keys.length>1?"":""}${gt(i.keys,"")}`;case"invalid_key":return`${i.origin} `;case"invalid_union":return"";case"invalid_element":return`${i.origin} `;default:return""}}};function $pe(){return{localeError:Npe()}}const Upe=()=>{const t={string:{unit:"mi",verb:"n"},file:{unit:"bytes",verb:"n"},array:{unit:"nkan",verb:"n"},set:{unit:"nkan",verb:"n"}};function e(i){return t[i]??null}const r=i=>{const a=typeof i;switch(a){case"number":return Number.isNaN(i)?"NaN":"nmb";case"object":{if(Array.isArray(i))return"akop";if(i===null)return"null";if(Object.getPrototypeOf(i)!==Object.prototype&&i.constructor)return i.constructor.name}}return a},n={regex:"r bwl",email:"drs ml",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"kk ISO",date:"j ISO",time:"kk ISO",duration:"kk t p ISO",ipv4:"drs IPv4",ipv6:"drs IPv6",cidrv4:"gbgb IPv4",cidrv6:"gbgb IPv6",base64:"r t a k n base64",base64url:"r base64url",json_string:"r JSON",e164:"nmb E.164",jwt:"JWT",template_literal:"r bwl"};return i=>{switch(i.code){case"invalid_type":return`bwl ae: a n lti fi ${i.expected}, m a r ${r(i.input)}`;case"invalid_value":return i.values.length===1?`bwl ae: a n lti fi ${yr(i.values[0])}`:`yn ae: yan kan lra ${gt(i.values,"|")}`;case"too_big":{const a=i.inclusive?"<=":"<",o=e(i.origin);return o?`T p j: a n lti j p ${i.origin??"iye"} ${o.verb} ${a}${i.maximum} ${o.unit}`:`T p j: a n lti j ${a}${i.maximum}`}case"too_small":{const a=i.inclusive?">=":">",o=e(i.origin);return o?`Kr ju: a n lti j p ${i.origin} ${o.verb} ${a}${i.minimum} ${o.unit}`:`Kr ju: a n lti j ${a}${i.minimum}`}case"invalid_format":{const a=i;return a.format==="starts_with"?`r ae: gbd br pl "${a.prefix}"`:a.format==="ends_with"?`r ae: gbd par pl "${a.suffix}"`:a.format==="includes"?`r ae: gbd n "${a.includes}"`:a.format==="regex"?`r ae: gbd b pr mu ${a.pattern}`:`Ae: ${n[a.format]??i.format}`}case"not_multiple_of":return`Nmb ae: gbd j y ppn ti ${i.divisor}`;case"unrecognized_keys":return`Btn m: ${gt(i.keys,", ")}`;case"invalid_key":return`Btn ae nn ${i.origin}`;case"invalid_union":return"bwl ae";case"invalid_element":return`Iye ae nn ${i.origin}`;default:return"bwl ae"}}};function jpe(){return{localeError:Upe()}}const wj=Object.freeze(Object.defineProperty({__proto__:null,ar:rde,az:ide,be:ode,bg:ude,ca:hde,cs:pde,da:mde,de:yde,en:_j,eo:wde,es:Sde,fa:Ide,fi:Mde,fr:Pde,frCA:kde,he:Bde,hu:Fde,id:Lde,is:Ude,it:Vde,ja:Zde,ka:Xde,kh:Yde,km:xj,ko:Kde,lt:tpe,mk:npe,ms:ape,nl:spe,no:upe,ota:hpe,pl:mpe,ps:ppe,pt:ype,ru:_pe,sl:bpe,sv:Ape,ta:Epe,th:Cpe,tr:Ppe,ua:kpe,uk:bj,ur:Bpe,vi:Fpe,yo:jpe,zhCN:Lpe,zhTW:$pe},Symbol.toStringTag,{value:"Module"})),Aj=Symbol("ZodOutput"),Sj=Symbol("ZodInput");class tD{constructor(){this._map=new WeakMap,this._idmap=new Map}add(e,...r){const n=r[0];if(this._map.set(e,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,e)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(e){const r=this._map.get(e);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(e),this}get(e){const r=e._zod.parent;if(r){const n={...this.get(r)??{}};delete n.id;const i={...n,...this._map.get(e)};return Object.keys(i).length?i:void 0}return this._map.get(e)}has(e){return this._map.has(e)}}function rD(){return new tD}const mp=rD();function Ej(t,e){return new t({type:"string",...et(e)})}function Ij(t,e){return new t({type:"string",coerce:!0,...et(e)})}function nD(t,e){return new t({type:"string",format:"email",check:"string_format",abort:!1,...et(e)})}function m4(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...et(e)})}function iD(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...et(e)})}function aD(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...et(e)})}function oD(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...et(e)})}function sD(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...et(e)})}function zA(t,e){return new t({type:"string",format:"url",check:"string_format",abort:!1,...et(e)})}function lD(t,e){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...et(e)})}function uD(t,e){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...et(e)})}function cD(t,e){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...et(e)})}function hD(t,e){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...et(e)})}function dD(t,e){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...et(e)})}function pD(t,e){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...et(e)})}function fD(t,e){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...et(e)})}function mD(t,e){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...et(e)})}function gD(t,e){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...et(e)})}function yD(t,e){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...et(e)})}function vD(t,e){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...et(e)})}function _D(t,e){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...et(e)})}function xD(t,e){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...et(e)})}function bD(t,e){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...et(e)})}function wD(t,e){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...et(e)})}const Cj={Any:null,Minute:-1,Second:0,Millisecond:3,Microsecond:6};function Mj(t,e){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...et(e)})}function Tj(t,e){return new t({type:"string",format:"date",check:"string_format",...et(e)})}function Pj(t,e){return new t({type:"string",format:"time",check:"string_format",precision:null,...et(e)})}function Dj(t,e){return new t({type:"string",format:"duration",check:"string_format",...et(e)})}function kj(t,e){return new t({type:"number",checks:[],...et(e)})}function Oj(t,e){return new t({type:"number",coerce:!0,checks:[],...et(e)})}function Bj(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...et(e)})}function zj(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"float32",...et(e)})}function Fj(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"float64",...et(e)})}function Rj(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"int32",...et(e)})}function Lj(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"uint32",...et(e)})}function Nj(t,e){return new t({type:"boolean",...et(e)})}function $j(t,e){return new t({type:"boolean",coerce:!0,...et(e)})}function Uj(t,e){return new t({type:"bigint",...et(e)})}function jj(t,e){return new t({type:"bigint",coerce:!0,...et(e)})}function Vj(t,e){return new t({type:"bigint",check:"bigint_format",abort:!1,format:"int64",...et(e)})}function Gj(t,e){return new t({type:"bigint",check:"bigint_format",abort:!1,format:"uint64",...et(e)})}function Zj(t,e){return new t({type:"symbol",...et(e)})}function Wj(t,e){return new t({type:"undefined",...et(e)})}function Hj(t,e){return new t({type:"null",...et(e)})}function Xj(t){return new t({type:"any"})}function qj(t){return new t({type:"unknown"})}function Yj(t,e){return new t({type:"never",...et(e)})}function Jj(t,e){return new t({type:"void",...et(e)})}function Kj(t,e){return new t({type:"date",...et(e)})}function Qj(t,e){return new t({type:"date",coerce:!0,...et(e)})}function eV(t,e){return new t({type:"nan",...et(e)})}function Fp(t,e){return new WP({check:"less_than",...et(e),value:t,inclusive:!1})}function Ol(t,e){return new WP({check:"less_than",...et(e),value:t,inclusive:!0})}function Rp(t,e){return new HP({check:"greater_than",...et(e),value:t,inclusive:!1})}function cs(t,e){return new HP({check:"greater_than",...et(e),value:t,inclusive:!0})}function tV(t){return Rp(0,t)}function rV(t){return Fp(0,t)}function nV(t){return Ol(0,t)}function iV(t){return cs(0,t)}function t1(t,e){return new j$({check:"multiple_of",...et(e),value:t})}function FA(t,e){return new Z$({check:"max_size",...et(e),maximum:t})}function r1(t,e){return new W$({check:"min_size",...et(e),minimum:t})}function AD(t,e){return new H$({check:"size_equals",...et(e),size:t})}function RA(t,e){return new X$({check:"max_length",...et(e),maximum:t})}function Ig(t,e){return new q$({check:"min_length",...et(e),minimum:t})}function LA(t,e){return new Y$({check:"length_equals",...et(e),length:t})}function SD(t,e){return new J$({check:"string_format",format:"regex",...et(e),pattern:t})}function ED(t){return new K$({check:"string_format",format:"lowercase",...et(t)})}function ID(t){return new Q$({check:"string_format",format:"uppercase",...et(t)})}function CD(t,e){return new eU({check:"string_format",format:"includes",...et(e),includes:t})}function MD(t,e){return new tU({check:"string_format",format:"starts_with",...et(e),prefix:t})}function TD(t,e){return new rU({check:"string_format",format:"ends_with",...et(e),suffix:t})}function aV(t,e,r){return new nU({check:"property",property:t,schema:e,...et(r)})}function PD(t,e){return new iU({check:"mime_type",mime:t,...et(e)})}function Xp(t){return new aU({check:"overwrite",tx:t})}function DD(t){return Xp(e=>e.normalize(t))}function kD(){return Xp(t=>t.trim())}function OD(){return Xp(t=>t.toLowerCase())}function BD(){return Xp(t=>t.toUpperCase())}function oV(t,e,r){return new t({type:"array",element:e,...et(r)})}function Vpe(t,e,r){return new t({type:"union",options:e,...et(r)})}function Gpe(t,e,r,n){return new t({type:"union",options:r,discriminator:e,...et(n)})}function Zpe(t,e,r){return new t({type:"intersection",left:e,right:r})}function Wpe(t,e,r,n){const i=r instanceof _r,a=i?n:r,o=i?r:null;return new t({type:"tuple",items:e,rest:o,...et(a)})}function Hpe(t,e,r,n){return new t({type:"record",keyType:e,valueType:r,...et(n)})}function Xpe(t,e,r,n){return new t({type:"map",keyType:e,valueType:r,...et(n)})}function qpe(t,e,r){return new t({type:"set",valueType:e,...et(r)})}function Ype(t,e,r){const n=Array.isArray(e)?Object.fromEntries(e.map(i=>[i,i])):e;return new t({type:"enum",entries:n,...et(r)})}function Jpe(t,e,r){return new t({type:"enum",entries:e,...et(r)})}function Kpe(t,e,r){return new t({type:"literal",values:Array.isArray(e)?e:[e],...et(r)})}function sV(t,e){return new t({type:"file",...et(e)})}function Qpe(t,e){return new t({type:"transform",transform:e})}function efe(t,e){return new t({type:"optional",innerType:e})}function tfe(t,e){return new t({type:"nullable",innerType:e})}function rfe(t,e,r){return new t({type:"default",innerType:e,get defaultValue(){return typeof r=="function"?r():kA(r)}})}function nfe(t,e,r){return new t({type:"nonoptional",innerType:e,...et(r)})}function ife(t,e){return new t({type:"success",innerType:e})}function afe(t,e,r){return new t({type:"catch",innerType:e,catchValue:typeof r=="function"?r:()=>r})}function ofe(t,e,r){return new t({type:"pipe",in:e,out:r})}function sfe(t,e){return new t({type:"readonly",innerType:e})}function lfe(t,e,r){return new t({type:"template_literal",parts:e,...et(r)})}function ufe(t,e){return new t({type:"lazy",getter:e})}function cfe(t,e){return new t({type:"promise",innerType:e})}function lV(t,e,r){const n=et(r);return n.abort??(n.abort=!0),new t({type:"custom",check:"custom",fn:e,...n})}function uV(t,e,r){return new t({type:"custom",check:"custom",fn:e,...et(r)})}function cV(t){const e=hV(r=>(r.addIssue=n=>{if(typeof n=="string")r.issues.push(Sg(n,r.value,e._zod.def));else{const i=n;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=r.value),i.inst??(i.inst=e),i.continue??(i.continue=!e._zod.def.abort),r.issues.push(Sg(i))}},t(r.value,r)));return e}function hV(t,e){const r=new Ri({check:"custom",...et(e)});return r._zod.check=t,r}function dV(t,e){const r=et(e);let n=r.truthy??["true","1","yes","on","y","enabled"],i=r.falsy??["false","0","no","off","n","disabled"];r.case!=="sensitive"&&(n=n.map(p=>typeof p=="string"?p.toLowerCase():p),i=i.map(p=>typeof p=="string"?p.toLowerCase():p));const a=new Set(n),o=new Set(i),s=t.Codec??eD,l=t.Boolean??YP,u=t.String??Q1,c=new u({type:"string",error:r.error}),h=new l({type:"boolean",error:r.error}),d=new s({type:"pipe",in:c,out:h,transform:((p,m)=>{let y=p;return r.case!=="sensitive"&&(y=y.toLowerCase()),a.has(y)?!0:o.has(y)?!1:(m.issues.push({code:"invalid_value",expected:"stringbool",values:[...a,...o],input:m.value,inst:d,continue:!1}),{})}),reverseTransform:((p,m)=>p===!0?n[0]||"true":i[0]||"false"),error:r.error});return d}function e_(t,e,r,n={}){const i=et(n),a={...et(n),check:"string_format",type:"string",format:e,fn:typeof r=="function"?r:s=>r.test(s),...i};return r instanceof RegExp&&(a.pattern=r),new t(a)}class RC{constructor(e){this.counter=0,this.metadataRegistry=e?.metadata??mp,this.target=e?.target??"draft-2020-12",this.unrepresentable=e?.unrepresentable??"throw",this.override=e?.override??(()=>{}),this.io=e?.io??"output",this.seen=new Map}process(e,r={path:[],schemaPath:[]}){var n;const i=e._zod.def,a={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},o=this.seen.get(e);if(o)return o.count++,r.schemaPath.includes(e)&&(o.cycle=r.path),o.schema;const s={schema:{},count:1,cycle:void 0,path:r.path};this.seen.set(e,s);const l=e._zod.toJSONSchema?.();if(l)s.schema=l;else{const h={...r,schemaPath:[...r.schemaPath,e],path:r.path},d=e._zod.parent;if(d)s.ref=d,this.process(d,h),this.seen.get(d).isParent=!0;else{const p=s.schema;switch(i.type){case"string":{const m=p;m.type="string";const{minimum:y,maximum:v,format:_,patterns:w,contentEncoding:b}=e._zod.bag;if(typeof y=="number"&&(m.minLength=y),typeof v=="number"&&(m.maxLength=v),_&&(m.format=a[_]??_,m.format===""&&delete m.format),b&&(m.contentEncoding=b),w&&w.size>0){const A=[...w];A.length===1?m.pattern=A[0].source:A.length>1&&(s.schema.allOf=[...A.map(E=>({...this.target==="draft-7"||this.target==="draft-4"||this.target==="openapi-3.0"?{type:"string"}:{},pattern:E.source}))])}break}case"number":{const m=p,{minimum:y,maximum:v,format:_,multipleOf:w,exclusiveMaximum:b,exclusiveMinimum:A}=e._zod.bag;typeof _=="string"&&_.includes("int")?m.type="integer":m.type="number",typeof A=="number"&&(this.target==="draft-4"||this.target==="openapi-3.0"?(m.minimum=A,m.exclusiveMinimum=!0):m.exclusiveMinimum=A),typeof y=="number"&&(m.minimum=y,typeof A=="number"&&this.target!=="draft-4"&&(A>=y?delete m.minimum:delete m.exclusiveMinimum)),typeof b=="number"&&(this.target==="draft-4"||this.target==="openapi-3.0"?(m.maximum=b,m.exclusiveMaximum=!0):m.exclusiveMaximum=b),typeof v=="number"&&(m.maximum=v,typeof b=="number"&&this.target!=="draft-4"&&(b<=v?delete m.maximum:delete m.exclusiveMaximum)),typeof w=="number"&&(m.multipleOf=w);break}case"boolean":{const m=p;m.type="boolean";break}case"bigint":{if(this.unrepresentable==="throw")throw new Error("BigInt cannot be represented in JSON Schema");break}case"symbol":{if(this.unrepresentable==="throw")throw new Error("Symbols cannot be represented in JSON Schema");break}case"null":{this.target==="openapi-3.0"?(p.type="string",p.nullable=!0,p.enum=[null]):p.type="null";break}case"any":break;case"unknown":break;case"undefined":{if(this.unrepresentable==="throw")throw new Error("Undefined cannot be represented in JSON Schema");break}case"void":{if(this.unrepresentable==="throw")throw new Error("Void cannot be represented in JSON Schema");break}case"never":{p.not={};break}case"date":{if(this.unrepresentable==="throw")throw new Error("Date cannot be represented in JSON Schema");break}case"array":{const m=p,{minimum:y,maximum:v}=e._zod.bag;typeof y=="number"&&(m.minItems=y),typeof v=="number"&&(m.maxItems=v),m.type="array",m.items=this.process(i.element,{...h,path:[...h.path,"items"]});break}case"object":{const m=p;m.type="object",m.properties={};const y=i.shape;for(const w in y)m.properties[w]=this.process(y[w],{...h,path:[...h.path,"properties",w]});const v=new Set(Object.keys(y)),_=new Set([...v].filter(w=>{const b=i.shape[w]._zod;return this.io==="input"?b.optin===void 0:b.optout===void 0}));_.size>0&&(m.required=Array.from(_)),i.catchall?._zod.def.type==="never"?m.additionalProperties=!1:i.catchall?i.catchall&&(m.additionalProperties=this.process(i.catchall,{...h,path:[...h.path,"additionalProperties"]})):this.io==="output"&&(m.additionalProperties=!1);break}case"union":{const m=p,y=i.options.map((v,_)=>this.process(v,{...h,path:[...h.path,"anyOf",_]}));m.anyOf=y;break}case"intersection":{const m=p,y=this.process(i.left,{...h,path:[...h.path,"allOf",0]}),v=this.process(i.right,{...h,path:[...h.path,"allOf",1]}),_=b=>"allOf"in b&&Object.keys(b).length===1,w=[..._(y)?y.allOf:[y],..._(v)?v.allOf:[v]];m.allOf=w;break}case"tuple":{const m=p;m.type="array";const y=this.target==="draft-2020-12"?"prefixItems":"items",v=this.target==="draft-2020-12"||this.target==="openapi-3.0"?"items":"additionalItems",_=i.items.map((E,M)=>this.process(E,{...h,path:[...h.path,y,M]})),w=i.rest?this.process(i.rest,{...h,path:[...h.path,v,...this.target==="openapi-3.0"?[i.items.length]:[]]}):null;this.target==="draft-2020-12"?(m.prefixItems=_,w&&(m.items=w)):this.target==="openapi-3.0"?(m.items={anyOf:_},w&&m.items.anyOf.push(w),m.minItems=_.length,w||(m.maxItems=_.length)):(m.items=_,w&&(m.additionalItems=w));const{minimum:b,maximum:A}=e._zod.bag;typeof b=="number"&&(m.minItems=b),typeof A=="number"&&(m.maxItems=A);break}case"record":{const m=p;m.type="object",(this.target==="draft-7"||this.target==="draft-2020-12")&&(m.propertyNames=this.process(i.keyType,{...h,path:[...h.path,"propertyNames"]})),m.additionalProperties=this.process(i.valueType,{...h,path:[...h.path,"additionalProperties"]});break}case"map":{if(this.unrepresentable==="throw")throw new Error("Map cannot be represented in JSON Schema");break}case"set":{if(this.unrepresentable==="throw")throw new Error("Set cannot be represented in JSON Schema");break}case"enum":{const m=p,y=PP(i.entries);y.every(v=>typeof v=="number")&&(m.type="number"),y.every(v=>typeof v=="string")&&(m.type="string"),m.enum=y;break}case"literal":{const m=p,y=[];for(const v of i.values)if(v===void 0){if(this.unrepresentable==="throw")throw new Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof v=="bigint"){if(this.unrepresentable==="throw")throw new Error("BigInt literals cannot be represented in JSON Schema");y.push(Number(v))}else y.push(v);if(y.length!==0)if(y.length===1){const v=y[0];m.type=v===null?"null":typeof v,this.target==="draft-4"||this.target==="openapi-3.0"?m.enum=[v]:m.const=v}else y.every(v=>typeof v=="number")&&(m.type="number"),y.every(v=>typeof v=="string")&&(m.type="string"),y.every(v=>typeof v=="boolean")&&(m.type="string"),y.every(v=>v===null)&&(m.type="null"),m.enum=y;break}case"file":{const m=p,y={type:"string",format:"binary",contentEncoding:"binary"},{minimum:v,maximum:_,mime:w}=e._zod.bag;v!==void 0&&(y.minLength=v),_!==void 0&&(y.maxLength=_),w?w.length===1?(y.contentMediaType=w[0],Object.assign(m,y)):m.anyOf=w.map(b=>({...y,contentMediaType:b})):Object.assign(m,y);break}case"transform":{if(this.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema");break}case"nullable":{const m=this.process(i.innerType,h);this.target==="openapi-3.0"?(s.ref=i.innerType,p.nullable=!0):p.anyOf=[m,{type:"null"}];break}case"nonoptional":{this.process(i.innerType,h),s.ref=i.innerType;break}case"success":{const m=p;m.type="boolean";break}case"default":{this.process(i.innerType,h),s.ref=i.innerType,p.default=JSON.parse(JSON.stringify(i.defaultValue));break}case"prefault":{this.process(i.innerType,h),s.ref=i.innerType,this.io==="input"&&(p._prefault=JSON.parse(JSON.stringify(i.defaultValue)));break}case"catch":{this.process(i.innerType,h),s.ref=i.innerType;let m;try{m=i.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}p.default=m;break}case"nan":{if(this.unrepresentable==="throw")throw new Error("NaN cannot be represented in JSON Schema");break}case"template_literal":{const m=p,y=e._zod.pattern;if(!y)throw new Error("Pattern not found in template literal");m.type="string",m.pattern=y.source;break}case"pipe":{const m=this.io==="input"?i.in._zod.def.type==="transform"?i.out:i.in:i.out;this.process(m,h),s.ref=m;break}case"readonly":{this.process(i.innerType,h),s.ref=i.innerType,p.readOnly=!0;break}case"promise":{this.process(i.innerType,h),s.ref=i.innerType;break}case"optional":{this.process(i.innerType,h),s.ref=i.innerType;break}case"lazy":{const m=e._zod.innerType;this.process(m,h),s.ref=m;break}case"custom":{if(this.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema");break}case"function":{if(this.unrepresentable==="throw")throw new Error("Function types cannot be represented in JSON Schema");break}}}}const u=this.metadataRegistry.get(e);return u&&Object.assign(s.schema,u),this.io==="input"&&ra(e)&&(delete s.schema.examples,delete s.schema.default),this.io==="input"&&s.schema._prefault&&((n=s.schema).default??(n.default=s.schema._prefault)),delete s.schema._prefault,this.seen.get(e).schema}emit(e,r){const n={cycles:r?.cycles??"ref",reused:r?.reused??"inline",external:r?.external??void 0},i=this.seen.get(e);if(!i)throw new Error("Unprocessed schema. This is a bug in Zod.");const a=c=>{const h=this.target==="draft-2020-12"?"$defs":"definitions";if(n.external){const y=n.external.registry.get(c[0])?.id,v=n.external.uri??(w=>w);if(y)return{ref:v(y)};const _=c[1].defId??c[1].schema.id??`schema${this.counter++}`;return c[1].defId=_,{defId:_,ref:`${v("__shared")}#/${h}/${_}`}}if(c[1]===i)return{ref:"#"};const p=`#/${h}/`,m=c[1].schema.id??`__schema${this.counter++}`;return{defId:m,ref:p+m}},o=c=>{if(c[1].schema.$ref)return;const h=c[1],{ref:d,defId:p}=a(c);h.def={...h.schema},p&&(h.defId=p);const m=h.schema;for(const y in m)delete m[y];m.$ref=d};if(n.cycles==="throw")for(const c of this.seen.entries()){const h=c[1];if(h.cycle)throw new Error(`Cycle detected: #/${h.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(const c of this.seen.entries()){const h=c[1];if(e===c[0]){o(c);continue}if(n.external){const p=n.external.registry.get(c[0])?.id;if(e!==c[0]&&p){o(c);continue}}if(this.metadataRegistry.get(c[0])?.id){o(c);continue}if(h.cycle){o(c);continue}if(h.count>1&&n.reused==="ref"){o(c);continue}}const s=(c,h)=>{const d=this.seen.get(c),p=d.def??d.schema,m={...p};if(d.ref===null)return;const y=d.ref;if(d.ref=null,y){s(y,h);const v=this.seen.get(y).schema;v.$ref&&(h.target==="draft-7"||h.target==="draft-4"||h.target==="openapi-3.0")?(p.allOf=p.allOf??[],p.allOf.push(v)):(Object.assign(p,v),Object.assign(p,m))}d.isParent||this.override({zodSchema:c,jsonSchema:p,path:d.path??[]})};for(const c of[...this.seen.entries()].reverse())s(c[0],{target:this.target});const l={};if(this.target==="draft-2020-12"?l.$schema="https://json-schema.org/draft/2020-12/schema":this.target==="draft-7"?l.$schema="http://json-schema.org/draft-07/schema#":this.target==="draft-4"?l.$schema="http://json-schema.org/draft-04/schema#":this.target==="openapi-3.0"||console.warn(`Invalid target: ${this.target}`),n.external?.uri){const c=n.external.registry.get(e)?.id;if(!c)throw new Error("Schema is missing an `id` property");l.$id=n.external.uri(c)}Object.assign(l,i.def);const u=n.external?.defs??{};for(const c of this.seen.entries()){const h=c[1];h.def&&h.defId&&(u[h.defId]=h.def)}n.external||Object.keys(u).length>0&&(this.target==="draft-2020-12"?l.$defs=u:l.definitions=u);try{return JSON.parse(JSON.stringify(l))}catch{throw new Error("Error converting schema to JSON.")}}}function pV(t,e){if(t instanceof tD){const n=new RC(e),i={};for(const s of t._idmap.entries()){const[l,u]=s;n.process(u)}const a={},o={registry:t,uri:e?.uri,defs:i};for(const s of t._idmap.entries()){const[l,u]=s;a[l]=n.emit(u,{...e,external:o})}if(Object.keys(i).length>0){const s=n.target==="draft-2020-12"?"$defs":"definitions";a.__shared={[s]:i}}return{schemas:a}}const r=new RC(e);return r.process(t),r.emit(t,e)}function ra(t,e){const r=e??{seen:new Set};if(r.seen.has(t))return!1;r.seen.add(t);const i=t._zod.def;switch(i.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":return!1;case"array":return ra(i.element,r);case"object":{for(const a in i.shape)if(ra(i.shape[a],r))return!0;return!1}case"union":{for(const a of i.options)if(ra(a,r))return!0;return!1}case"intersection":return ra(i.left,r)||ra(i.right,r);case"tuple":{for(const a of i.items)if(ra(a,r))return!0;return!!(i.rest&&ra(i.rest,r))}case"record":return ra(i.keyType,r)||ra(i.valueType,r);case"map":return ra(i.keyType,r)||ra(i.valueType,r);case"set":return ra(i.valueType,r);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":return ra(i.innerType,r);case"lazy":return ra(i.getter(),r);case"default":return ra(i.innerType,r);case"prefault":return ra(i.innerType,r);case"custom":return!1;case"transform":return!0;case"pipe":return ra(i.in,r)||ra(i.out,r);case"success":return!1;case"catch":return!1;case"function":return!1}throw new Error(`Unknown schema type: ${i.type}`)}const hfe=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),dfe=Object.freeze(Object.defineProperty({__proto__:null,$ZodAny:NU,$ZodArray:GU,$ZodAsyncError:Ep,$ZodBase64:CU,$ZodBase64URL:TU,$ZodBigInt:JP,$ZodBigIntFormat:zU,$ZodBoolean:YP,$ZodCIDRv4:EU,$ZodCIDRv6:IU,$ZodCUID:fU,$ZodCUID2:mU,$ZodCatch:cj,$ZodCheck:Ri,$ZodCheckBigIntFormat:G$,$ZodCheckEndsWith:rU,$ZodCheckGreaterThan:HP,$ZodCheckIncludes:eU,$ZodCheckLengthEquals:Y$,$ZodCheckLessThan:WP,$ZodCheckLowerCase:K$,$ZodCheckMaxLength:X$,$ZodCheckMaxSize:Z$,$ZodCheckMimeType:iU,$ZodCheckMinLength:q$,$ZodCheckMinSize:W$,$ZodCheckMultipleOf:j$,$ZodCheckNumberFormat:V$,$ZodCheckOverwrite:aU,$ZodCheckProperty:nU,$ZodCheckRegex:J$,$ZodCheckSizeEquals:H$,$ZodCheckStartsWith:tU,$ZodCheckStringFormat:K1,$ZodCheckUpperCase:Q$,$ZodCodec:eD,$ZodCustom:vj,$ZodCustomStringFormat:OU,$ZodDate:VU,$ZodDefault:oj,$ZodDiscriminatedUnion:qU,$ZodE164:PU,$ZodEmail:cU,$ZodEmoji:dU,$ZodEncodeError:PA,$ZodEnum:ej,$ZodError:kP,$ZodFile:rj,$ZodFunction:mj,$ZodGUID:lU,$ZodIPv4:AU,$ZodIPv6:SU,$ZodISODate:xU,$ZodISODateTime:_U,$ZodISODuration:wU,$ZodISOTime:bU,$ZodIntersection:YU,$ZodJWT:kU,$ZodKSUID:vU,$ZodLazy:yj,$ZodLiteral:tj,$ZodMap:KU,$ZodNaN:hj,$ZodNanoID:pU,$ZodNever:UU,$ZodNonOptional:lj,$ZodNull:LU,$ZodNullable:aj,$ZodNumber:qP,$ZodNumberFormat:BU,$ZodObject:HU,$ZodObjectJIT:XU,$ZodOptional:ij,$ZodPipe:dj,$ZodPrefault:sj,$ZodPromise:gj,$ZodReadonly:pj,$ZodRealError:Es,$ZodRecord:JU,$ZodRegistry:tD,$ZodSet:QU,$ZodString:Q1,$ZodStringFormat:Jn,$ZodSuccess:uj,$ZodSymbol:FU,$ZodTemplateLiteral:fj,$ZodTransform:nj,$ZodTuple:QP,$ZodType:_r,$ZodULID:gU,$ZodURL:hU,$ZodUUID:uU,$ZodUndefined:RU,$ZodUnion:KP,$ZodUnknown:$U,$ZodVoid:jU,$ZodXID:yU,$brand:NN,$constructor:Ie,$input:Sj,$output:Aj,Doc:oU,JSONSchema:hfe,JSONSchemaGenerator:RC,NEVER:LN,TimePrecision:Cj,_any:Xj,_array:oV,_base64:_D,_base64url:xD,_bigint:Uj,_boolean:Nj,_catch:afe,_check:hV,_cidrv4:yD,_cidrv6:vD,_coercedBigint:jj,_coercedBoolean:$j,_coercedDate:Qj,_coercedNumber:Oj,_coercedString:Ij,_cuid:cD,_cuid2:hD,_custom:lV,_date:Kj,_decode:FP,_decodeAsync:LP,_default:rfe,_discriminatedUnion:Gpe,_e164:bD,_email:nD,_emoji:lD,_encode:zP,_encodeAsync:RP,_endsWith:TD,_enum:Ype,_file:sV,_float32:zj,_float64:Fj,_gt:Rp,_gte:cs,_guid:m4,_includes:CD,_int:Bj,_int32:Rj,_int64:Vj,_intersection:Zpe,_ipv4:mD,_ipv6:gD,_isoDate:Tj,_isoDateTime:Mj,_isoDuration:Dj,_isoTime:Pj,_jwt:wD,_ksuid:fD,_lazy:ufe,_length:LA,_literal:Kpe,_lowercase:ED,_lt:Fp,_lte:Ol,_map:Xpe,_max:Ol,_maxLength:RA,_maxSize:FA,_mime:PD,_min:cs,_minLength:Ig,_minSize:r1,_multipleOf:t1,_nan:eV,_nanoid:uD,_nativeEnum:Jpe,_negative:rV,_never:Yj,_nonnegative:iV,_nonoptional:nfe,_nonpositive:nV,_normalize:DD,_null:Hj,_nullable:tfe,_number:kj,_optional:efe,_overwrite:Xp,_parse:W1,_parseAsync:H1,_pipe:ofe,_positive:tV,_promise:cfe,_property:aV,_readonly:sfe,_record:Hpe,_refine:uV,_regex:SD,_safeDecode:$P,_safeDecodeAsync:jP,_safeEncode:NP,_safeEncodeAsync:UP,_safeParse:X1,_safeParseAsync:q1,_set:qpe,_size:AD,_startsWith:MD,_string:Ej,_stringFormat:e_,_stringbool:dV,_success:ife,_superRefine:cV,_symbol:Zj,_templateLiteral:lfe,_toLowerCase:OD,_toUpperCase:BD,_transform:Qpe,_trim:kD,_tuple:Wpe,_uint32:Lj,_uint64:Gj,_ulid:dD,_undefined:Wj,_union:Vpe,_unknown:qj,_uppercase:ID,_url:zA,_uuid:iD,_uuidv4:aD,_uuidv6:oD,_uuidv7:sD,_void:Jj,_xid:pD,clone:Ks,config:xo,decode:She,decodeAsync:Ihe,encode:Ahe,encodeAsync:Ehe,flattenError:OP,formatError:BP,globalConfig:h4,globalRegistry:mp,isValidBase64:XP,isValidBase64URL:MU,isValidJWT:DU,locales:wj,parse:BC,parseAsync:zC,prettifyError:a$,regexes:ZP,registry:rD,safeDecode:Mhe,safeDecodeAsync:Phe,safeEncode:Che,safeEncodeAsync:The,safeParse:o$,safeParseAsync:s$,toDotPath:i$,toJSONSchema:pV,treeifyError:n$,util:t$,version:sU},Symbol.toStringTag,{value:"Module"})),zD=Ie("ZodISODateTime",(t,e)=>{_U.init(t,e),ai.init(t,e)});function fV(t){return Mj(zD,t)}const FD=Ie("ZodISODate",(t,e)=>{xU.init(t,e),ai.init(t,e)});function mV(t){return Tj(FD,t)}const RD=Ie("ZodISOTime",(t,e)=>{bU.init(t,e),ai.init(t,e)});function gV(t){return Pj(RD,t)}const LD=Ie("ZodISODuration",(t,e)=>{wU.init(t,e),ai.init(t,e)});function yV(t){return Dj(LD,t)}const pfe=Object.freeze(Object.defineProperty({__proto__:null,ZodISODate:FD,ZodISODateTime:zD,ZodISODuration:LD,ZodISOTime:RD,date:mV,datetime:fV,duration:yV,time:gV},Symbol.toStringTag,{value:"Module"})),vV=(t,e)=>{kP.init(t,e),t.name="ZodError",Object.defineProperties(t,{format:{value:r=>BP(t,r)},flatten:{value:r=>OP(t,r)},addIssue:{value:r=>{t.issues.push(r),t.message=JSON.stringify(t.issues,d4,2)}},addIssues:{value:r=>{t.issues.push(...r),t.message=JSON.stringify(t.issues,d4,2)}},isEmpty:{get(){return t.issues.length===0}}})},ffe=Ie("ZodError",vV),Is=Ie("ZodError",vV,{Parent:Error}),_V=W1(Is),xV=H1(Is),bV=X1(Is),wV=q1(Is),AV=zP(Is),SV=FP(Is),EV=RP(Is),IV=LP(Is),CV=NP(Is),MV=$P(Is),TV=UP(Is),PV=jP(Is),kr=Ie("ZodType",(t,e)=>(_r.init(t,e),t.def=e,t.type=e.type,Object.defineProperty(t,"_def",{value:e}),t.check=(...r)=>t.clone(Xc(e,{checks:[...e.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]})),t.clone=(r,n)=>Ks(t,r,n),t.brand=()=>t,t.register=((r,n)=>(r.add(t,n),t)),t.parse=(r,n)=>_V(t,r,n,{callee:t.parse}),t.safeParse=(r,n)=>bV(t,r,n),t.parseAsync=async(r,n)=>xV(t,r,n,{callee:t.parseAsync}),t.safeParseAsync=async(r,n)=>wV(t,r,n),t.spa=t.safeParseAsync,t.encode=(r,n)=>AV(t,r,n),t.decode=(r,n)=>SV(t,r,n),t.encodeAsync=async(r,n)=>EV(t,r,n),t.decodeAsync=async(r,n)=>IV(t,r,n),t.safeEncode=(r,n)=>CV(t,r,n),t.safeDecode=(r,n)=>MV(t,r,n),t.safeEncodeAsync=async(r,n)=>TV(t,r,n),t.safeDecodeAsync=async(r,n)=>PV(t,r,n),t.refine=(r,n)=>t.check(dG(r,n)),t.superRefine=r=>t.check(pG(r)),t.overwrite=r=>t.check(Xp(r)),t.optional=()=>y4(t),t.nullable=()=>v4(t),t.nullish=()=>y4(v4(t)),t.nonoptional=r=>eG(t,r),t.array=()=>bo(t),t.or=r=>zi([t,r]),t.and=r=>VV(t,r),t.transform=r=>_4(t,s5(r)),t.default=r=>JV(t,r),t.prefault=r=>QV(t,r),t.catch=r=>nG(t,r),t.pipe=r=>_4(t,r),t.readonly=()=>oG(t),t.describe=r=>{const n=t.clone();return mp.add(n,{description:r}),n},Object.defineProperty(t,"description",{get(){return mp.get(t)?.description},configurable:!0}),t.meta=(...r)=>{if(r.length===0)return mp.get(t);const n=t.clone();return mp.add(n,r[0]),n},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),ND=Ie("_ZodString",(t,e)=>{Q1.init(t,e),kr.init(t,e);const r=t._zod.bag;t.format=r.format??null,t.minLength=r.minimum??null,t.maxLength=r.maximum??null,t.regex=(...n)=>t.check(SD(...n)),t.includes=(...n)=>t.check(CD(...n)),t.startsWith=(...n)=>t.check(MD(...n)),t.endsWith=(...n)=>t.check(TD(...n)),t.min=(...n)=>t.check(Ig(...n)),t.max=(...n)=>t.check(RA(...n)),t.length=(...n)=>t.check(LA(...n)),t.nonempty=(...n)=>t.check(Ig(1,...n)),t.lowercase=n=>t.check(ED(n)),t.uppercase=n=>t.check(ID(n)),t.trim=()=>t.check(kD()),t.normalize=(...n)=>t.check(DD(...n)),t.toLowerCase=()=>t.check(OD()),t.toUpperCase=()=>t.check(BD())}),NA=Ie("ZodString",(t,e)=>{Q1.init(t,e),ND.init(t,e),t.email=r=>t.check(nD($D,r)),t.url=r=>t.check(zA($A,r)),t.jwt=r=>t.check(wD(t5,r)),t.emoji=r=>t.check(lD(UD,r)),t.guid=r=>t.check(m4(g4,r)),t.uuid=r=>t.check(iD(Pc,r)),t.uuidv4=r=>t.check(aD(Pc,r)),t.uuidv6=r=>t.check(oD(Pc,r)),t.uuidv7=r=>t.check(sD(Pc,r)),t.nanoid=r=>t.check(uD(jD,r)),t.guid=r=>t.check(m4(g4,r)),t.cuid=r=>t.check(cD(VD,r)),t.cuid2=r=>t.check(hD(GD,r)),t.ulid=r=>t.check(dD(ZD,r)),t.base64=r=>t.check(_D(KD,r)),t.base64url=r=>t.check(xD(QD,r)),t.xid=r=>t.check(pD(WD,r)),t.ksuid=r=>t.check(fD(HD,r)),t.ipv4=r=>t.check(mD(XD,r)),t.ipv6=r=>t.check(gD(qD,r)),t.cidrv4=r=>t.check(yD(YD,r)),t.cidrv6=r=>t.check(vD(JD,r)),t.e164=r=>t.check(bD(e5,r)),t.datetime=r=>t.check(fV(r)),t.date=r=>t.check(mV(r)),t.time=r=>t.check(gV(r)),t.duration=r=>t.check(yV(r))});function mr(t){return Ej(NA,t)}const ai=Ie("ZodStringFormat",(t,e)=>{Jn.init(t,e),ND.init(t,e)}),$D=Ie("ZodEmail",(t,e)=>{cU.init(t,e),ai.init(t,e)});function mfe(t){return nD($D,t)}const g4=Ie("ZodGUID",(t,e)=>{lU.init(t,e),ai.init(t,e)});function gfe(t){return m4(g4,t)}const Pc=Ie("ZodUUID",(t,e)=>{uU.init(t,e),ai.init(t,e)});function yfe(t){return iD(Pc,t)}function vfe(t){return aD(Pc,t)}function _fe(t){return oD(Pc,t)}function xfe(t){return sD(Pc,t)}const $A=Ie("ZodURL",(t,e)=>{hU.init(t,e),ai.init(t,e)});function bfe(t){return zA($A,t)}function wfe(t){return zA($A,{protocol:/^https?$/,hostname:S$,...et(t)})}const UD=Ie("ZodEmoji",(t,e)=>{dU.init(t,e),ai.init(t,e)});function Afe(t){return lD(UD,t)}const jD=Ie("ZodNanoID",(t,e)=>{pU.init(t,e),ai.init(t,e)});function Sfe(t){return uD(jD,t)}const VD=Ie("ZodCUID",(t,e)=>{fU.init(t,e),ai.init(t,e)});function Efe(t){return cD(VD,t)}const GD=Ie("ZodCUID2",(t,e)=>{mU.init(t,e),ai.init(t,e)});function Ife(t){return hD(GD,t)}const ZD=Ie("ZodULID",(t,e)=>{gU.init(t,e),ai.init(t,e)});function Cfe(t){return dD(ZD,t)}const WD=Ie("ZodXID",(t,e)=>{yU.init(t,e),ai.init(t,e)});function Mfe(t){return pD(WD,t)}const HD=Ie("ZodKSUID",(t,e)=>{vU.init(t,e),ai.init(t,e)});function Tfe(t){return fD(HD,t)}const XD=Ie("ZodIPv4",(t,e)=>{AU.init(t,e),ai.init(t,e)});function Pfe(t){return mD(XD,t)}const qD=Ie("ZodIPv6",(t,e)=>{SU.init(t,e),ai.init(t,e)});function Dfe(t){return gD(qD,t)}const YD=Ie("ZodCIDRv4",(t,e)=>{EU.init(t,e),ai.init(t,e)});function kfe(t){return yD(YD,t)}const JD=Ie("ZodCIDRv6",(t,e)=>{IU.init(t,e),ai.init(t,e)});function Ofe(t){return vD(JD,t)}const KD=Ie("ZodBase64",(t,e)=>{CU.init(t,e),ai.init(t,e)});function Bfe(t){return _D(KD,t)}const QD=Ie("ZodBase64URL",(t,e)=>{TU.init(t,e),ai.init(t,e)});function zfe(t){return xD(QD,t)}const e5=Ie("ZodE164",(t,e)=>{PU.init(t,e),ai.init(t,e)});function Ffe(t){return bD(e5,t)}const t5=Ie("ZodJWT",(t,e)=>{kU.init(t,e),ai.init(t,e)});function Rfe(t){return wD(t5,t)}const t_=Ie("ZodCustomStringFormat",(t,e)=>{OU.init(t,e),ai.init(t,e)});function Lfe(t,e,r={}){return e_(t_,t,e,r)}function Nfe(t){return e_(t_,"hostname",GP,t)}function $fe(t){return e_(t_,"hex",$$,t)}function Ufe(t,e){const r=e?.enc??"hex",n=`${t}_${r}`,i=ZP[n];if(!i)throw new Error(`Unrecognized hash format: ${n}`);return e_(t_,n,i,e)}const UA=Ie("ZodNumber",(t,e)=>{qP.init(t,e),kr.init(t,e),t.gt=(n,i)=>t.check(Rp(n,i)),t.gte=(n,i)=>t.check(cs(n,i)),t.min=(n,i)=>t.check(cs(n,i)),t.lt=(n,i)=>t.check(Fp(n,i)),t.lte=(n,i)=>t.check(Ol(n,i)),t.max=(n,i)=>t.check(Ol(n,i)),t.int=n=>t.check(LC(n)),t.safe=n=>t.check(LC(n)),t.positive=n=>t.check(Rp(0,n)),t.nonnegative=n=>t.check(cs(0,n)),t.negative=n=>t.check(Fp(0,n)),t.nonpositive=n=>t.check(Ol(0,n)),t.multipleOf=(n,i)=>t.check(t1(n,i)),t.step=(n,i)=>t.check(t1(n,i)),t.finite=()=>t;const r=t._zod.bag;t.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),t.isFinite=!0,t.format=r.format??null});function pt(t){return kj(UA,t)}const m0=Ie("ZodNumberFormat",(t,e)=>{BU.init(t,e),UA.init(t,e)});function LC(t){return Bj(m0,t)}function jfe(t){return zj(m0,t)}function Vfe(t){return Fj(m0,t)}function Gfe(t){return Rj(m0,t)}function Zfe(t){return Lj(m0,t)}const jA=Ie("ZodBoolean",(t,e)=>{YP.init(t,e),kr.init(t,e)});function Lr(t){return Nj(jA,t)}const VA=Ie("ZodBigInt",(t,e)=>{JP.init(t,e),kr.init(t,e),t.gte=(n,i)=>t.check(cs(n,i)),t.min=(n,i)=>t.check(cs(n,i)),t.gt=(n,i)=>t.check(Rp(n,i)),t.gte=(n,i)=>t.check(cs(n,i)),t.min=(n,i)=>t.check(cs(n,i)),t.lt=(n,i)=>t.check(Fp(n,i)),t.lte=(n,i)=>t.check(Ol(n,i)),t.max=(n,i)=>t.check(Ol(n,i)),t.positive=n=>t.check(Rp(BigInt(0),n)),t.negative=n=>t.check(Fp(BigInt(0),n)),t.nonpositive=n=>t.check(Ol(BigInt(0),n)),t.nonnegative=n=>t.check(cs(BigInt(0),n)),t.multipleOf=(n,i)=>t.check(t1(n,i));const r=t._zod.bag;t.minValue=r.minimum??null,t.maxValue=r.maximum??null,t.format=r.format??null});function Wfe(t){return Uj(VA,t)}const r5=Ie("ZodBigIntFormat",(t,e)=>{zU.init(t,e),VA.init(t,e)});function Hfe(t){return Vj(r5,t)}function Xfe(t){return Gj(r5,t)}const DV=Ie("ZodSymbol",(t,e)=>{FU.init(t,e),kr.init(t,e)});function qfe(t){return Zj(DV,t)}const kV=Ie("ZodUndefined",(t,e)=>{RU.init(t,e),kr.init(t,e)});function Yfe(t){return Wj(kV,t)}const OV=Ie("ZodNull",(t,e)=>{LU.init(t,e),kr.init(t,e)});function BV(t){return Hj(OV,t)}const zV=Ie("ZodAny",(t,e)=>{NU.init(t,e),kr.init(t,e)});function FV(){return Xj(zV)}const RV=Ie("ZodUnknown",(t,e)=>{$U.init(t,e),kr.init(t,e)});function Cg(){return qj(RV)}const LV=Ie("ZodNever",(t,e)=>{UU.init(t,e),kr.init(t,e)});function n5(t){return Yj(LV,t)}const NV=Ie("ZodVoid",(t,e)=>{jU.init(t,e),kr.init(t,e)});function Jfe(t){return Jj(NV,t)}const i5=Ie("ZodDate",(t,e)=>{VU.init(t,e),kr.init(t,e),t.min=(n,i)=>t.check(cs(n,i)),t.max=(n,i)=>t.check(Ol(n,i));const r=t._zod.bag;t.minDate=r.minimum?new Date(r.minimum):null,t.maxDate=r.maximum?new Date(r.maximum):null});function Kfe(t){return Kj(i5,t)}const $V=Ie("ZodArray",(t,e)=>{GU.init(t,e),kr.init(t,e),t.element=e.element,t.min=(r,n)=>t.check(Ig(r,n)),t.nonempty=r=>t.check(Ig(1,r)),t.max=(r,n)=>t.check(RA(r,n)),t.length=(r,n)=>t.check(LA(r,n)),t.unwrap=()=>t.element});function bo(t,e){return oV($V,t,e)}function Qfe(t){const e=t._zod.def.shape;return Pa(Object.keys(e))}const GA=Ie("ZodObject",(t,e)=>{XU.init(t,e),kr.init(t,e),Vr(t,"shape",()=>e.shape),t.keyof=()=>Pa(Object.keys(t._zod.def.shape)),t.catchall=r=>t.clone({...t._zod.def,catchall:r}),t.passthrough=()=>t.clone({...t._zod.def,catchall:Cg()}),t.loose=()=>t.clone({...t._zod.def,catchall:Cg()}),t.strict=()=>t.clone({...t._zod.def,catchall:n5()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=r=>XN(t,r),t.safeExtend=r=>qN(t,r),t.merge=r=>YN(t,r),t.pick=r=>WN(t,r),t.omit=r=>HN(t,r),t.partial=(...r)=>JN(WA,t,r[0]),t.required=(...r)=>KN(u5,t,r[0])});function Nr(t,e){const r={type:"object",shape:t??{},...et(e)};return new GA(r)}function _a(t,e){return new GA({type:"object",shape:t,catchall:n5(),...et(e)})}function eme(t,e){return new GA({type:"object",shape:t,catchall:Cg(),...et(e)})}const a5=Ie("ZodUnion",(t,e)=>{KP.init(t,e),kr.init(t,e),t.options=e.options});function zi(t,e){return new a5({type:"union",options:t,...et(e)})}const UV=Ie("ZodDiscriminatedUnion",(t,e)=>{a5.init(t,e),qU.init(t,e)});function tme(t,e,r){return new UV({type:"union",options:e,discriminator:t,...et(r)})}const jV=Ie("ZodIntersection",(t,e)=>{YU.init(t,e),kr.init(t,e)});function VV(t,e){return new jV({type:"intersection",left:t,right:e})}const GV=Ie("ZodTuple",(t,e)=>{QP.init(t,e),kr.init(t,e),t.rest=r=>t.clone({...t._zod.def,rest:r})});function ld(t,e,r){const n=e instanceof _r,i=n?r:e,a=n?e:null;return new GV({type:"tuple",items:t,rest:a,...et(i)})}const o5=Ie("ZodRecord",(t,e)=>{JU.init(t,e),kr.init(t,e),t.keyType=e.keyType,t.valueType=e.valueType});function ZA(t,e,r){return new o5({type:"record",keyType:t,valueType:e,...et(r)})}function rme(t,e,r){const n=Ks(t);return n._zod.values=void 0,new o5({type:"record",keyType:n,valueType:e,...et(r)})}const ZV=Ie("ZodMap",(t,e)=>{KU.init(t,e),kr.init(t,e),t.keyType=e.keyType,t.valueType=e.valueType});function nme(t,e,r){return new ZV({type:"map",keyType:t,valueType:e,...et(r)})}const WV=Ie("ZodSet",(t,e)=>{QU.init(t,e),kr.init(t,e),t.min=(...r)=>t.check(r1(...r)),t.nonempty=r=>t.check(r1(1,r)),t.max=(...r)=>t.check(FA(...r)),t.size=(...r)=>t.check(AD(...r))});function ime(t,e){return new WV({type:"set",valueType:t,...et(e)})}const n1=Ie("ZodEnum",(t,e)=>{ej.init(t,e),kr.init(t,e),t.enum=e.entries,t.options=Object.values(e.entries);const r=new Set(Object.keys(e.entries));t.extract=(n,i)=>{const a={};for(const o of n)if(r.has(o))a[o]=e.entries[o];else throw new Error(`Key ${o} not found in enum`);return new n1({...e,checks:[],...et(i),entries:a})},t.exclude=(n,i)=>{const a={...e.entries};for(const o of n)if(r.has(o))delete a[o];else throw new Error(`Key ${o} not found in enum`);return new n1({...e,checks:[],...et(i),entries:a})}});function Pa(t,e){const r=Array.isArray(t)?Object.fromEntries(t.map(n=>[n,n])):t;return new n1({type:"enum",entries:r,...et(e)})}function ame(t,e){return new n1({type:"enum",entries:t,...et(e)})}const HV=Ie("ZodLiteral",(t,e)=>{tj.init(t,e),kr.init(t,e),t.values=new Set(e.values),Object.defineProperty(t,"value",{get(){if(e.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return e.values[0]}})});function $i(t,e){return new HV({type:"literal",values:Array.isArray(t)?t:[t],...et(e)})}const XV=Ie("ZodFile",(t,e)=>{rj.init(t,e),kr.init(t,e),t.min=(r,n)=>t.check(r1(r,n)),t.max=(r,n)=>t.check(FA(r,n)),t.mime=(r,n)=>t.check(PD(Array.isArray(r)?r:[r],n))});function ome(t){return sV(XV,t)}const qV=Ie("ZodTransform",(t,e)=>{nj.init(t,e),kr.init(t,e),t._zod.parse=(r,n)=>{if(n.direction==="backward")throw new PA(t.constructor.name);r.addIssue=a=>{if(typeof a=="string")r.issues.push(Sg(a,r.value,e));else{const o=a;o.fatal&&(o.continue=!1),o.code??(o.code="custom"),o.input??(o.input=r.value),o.inst??(o.inst=t),r.issues.push(Sg(o))}};const i=e.transform(r.value,r);return i instanceof Promise?i.then(a=>(r.value=a,r)):(r.value=i,r)}});function s5(t){return new qV({type:"transform",transform:t})}const WA=Ie("ZodOptional",(t,e)=>{ij.init(t,e),kr.init(t,e),t.unwrap=()=>t._zod.def.innerType});function y4(t){return new WA({type:"optional",innerType:t})}const YV=Ie("ZodNullable",(t,e)=>{aj.init(t,e),kr.init(t,e),t.unwrap=()=>t._zod.def.innerType});function v4(t){return new YV({type:"nullable",innerType:t})}function sme(t){return y4(v4(t))}const l5=Ie("ZodDefault",(t,e)=>{oj.init(t,e),kr.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function JV(t,e){return new l5({type:"default",innerType:t,get defaultValue(){return typeof e=="function"?e():kA(e)}})}const KV=Ie("ZodPrefault",(t,e)=>{sj.init(t,e),kr.init(t,e),t.unwrap=()=>t._zod.def.innerType});function QV(t,e){return new KV({type:"prefault",innerType:t,get defaultValue(){return typeof e=="function"?e():kA(e)}})}const u5=Ie("ZodNonOptional",(t,e)=>{lj.init(t,e),kr.init(t,e),t.unwrap=()=>t._zod.def.innerType});function eG(t,e){return new u5({type:"nonoptional",innerType:t,...et(e)})}const tG=Ie("ZodSuccess",(t,e)=>{uj.init(t,e),kr.init(t,e),t.unwrap=()=>t._zod.def.innerType});function lme(t){return new tG({type:"success",innerType:t})}const rG=Ie("ZodCatch",(t,e)=>{cj.init(t,e),kr.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function nG(t,e){return new rG({type:"catch",innerType:t,catchValue:typeof e=="function"?e:()=>e})}const iG=Ie("ZodNaN",(t,e)=>{hj.init(t,e),kr.init(t,e)});function ume(t){return eV(iG,t)}const c5=Ie("ZodPipe",(t,e)=>{dj.init(t,e),kr.init(t,e),t.in=e.in,t.out=e.out});function _4(t,e){return new c5({type:"pipe",in:t,out:e})}const h5=Ie("ZodCodec",(t,e)=>{c5.init(t,e),eD.init(t,e)});function cme(t,e,r){return new h5({type:"pipe",in:t,out:e,transform:r.decode,reverseTransform:r.encode})}const aG=Ie("ZodReadonly",(t,e)=>{pj.init(t,e),kr.init(t,e),t.unwrap=()=>t._zod.def.innerType});function oG(t){return new aG({type:"readonly",innerType:t})}const sG=Ie("ZodTemplateLiteral",(t,e)=>{fj.init(t,e),kr.init(t,e)});function hme(t,e){return new sG({type:"template_literal",parts:t,...et(e)})}const lG=Ie("ZodLazy",(t,e)=>{yj.init(t,e),kr.init(t,e),t.unwrap=()=>t._zod.def.getter()});function uG(t){return new lG({type:"lazy",getter:t})}const cG=Ie("ZodPromise",(t,e)=>{gj.init(t,e),kr.init(t,e),t.unwrap=()=>t._zod.def.innerType});function dme(t){return new cG({type:"promise",innerType:t})}const hG=Ie("ZodFunction",(t,e)=>{mj.init(t,e),kr.init(t,e)});function gz(t){return new hG({type:"function",input:Array.isArray(t?.input)?ld(t?.input):t?.input??bo(Cg()),output:t?.output??Cg()})}const HA=Ie("ZodCustom",(t,e)=>{vj.init(t,e),kr.init(t,e)});function pme(t){const e=new Ri({check:"custom"});return e._zod.check=t,e}function d5(t,e){return lV(HA,t??(()=>!0),e)}function dG(t,e={}){return uV(HA,t,e)}function pG(t){return cV(t)}function fme(t,e={error:`Input not instance of ${t.name}`}){const r=new HA({type:"custom",check:"custom",fn:n=>n instanceof t,abort:!0,...et(e)});return r._zod.bag.Class=t,r}const mme=(...t)=>dV({Codec:h5,Boolean:jA,String:NA},...t);function gme(t){const e=uG(()=>zi([mr(t),pt(),Lr(),BV(),bo(e),ZA(mr(),e)]));return e}function yme(t,e){return _4(s5(t),e)}const vme={invalid_type:"invalid_type",too_big:"too_big",too_small:"too_small",invalid_format:"invalid_format",not_multiple_of:"not_multiple_of",unrecognized_keys:"unrecognized_keys",invalid_union:"invalid_union",invalid_key:"invalid_key",invalid_element:"invalid_element",invalid_value:"invalid_value",custom:"custom"};function _me(t){xo({customError:t})}function xme(){return xo().customError}var NC;NC||(NC={});function bme(t){return Ij(NA,t)}function wme(t){return Oj(UA,t)}function Ame(t){return $j(jA,t)}function Sme(t){return jj(VA,t)}function Eme(t){return Qj(i5,t)}const Ime=Object.freeze(Object.defineProperty({__proto__:null,bigint:Sme,boolean:Ame,date:Eme,number:wme,string:bme},Symbol.toStringTag,{value:"Module"}));xo(_j());const at=Object.freeze(Object.defineProperty({__proto__:null,$brand:NN,$input:Sj,$output:Aj,NEVER:LN,TimePrecision:Cj,ZodAny:zV,ZodArray:$V,ZodBase64:KD,ZodBase64URL:QD,ZodBigInt:VA,ZodBigIntFormat:r5,ZodBoolean:jA,ZodCIDRv4:YD,ZodCIDRv6:JD,ZodCUID:VD,ZodCUID2:GD,ZodCatch:rG,ZodCodec:h5,ZodCustom:HA,ZodCustomStringFormat:t_,ZodDate:i5,ZodDefault:l5,ZodDiscriminatedUnion:UV,ZodE164:e5,ZodEmail:$D,ZodEmoji:UD,ZodEnum:n1,ZodError:ffe,ZodFile:XV,get ZodFirstPartyTypeKind(){return NC},ZodFunction:hG,ZodGUID:g4,ZodIPv4:XD,ZodIPv6:qD,ZodISODate:FD,ZodISODateTime:zD,ZodISODuration:LD,ZodISOTime:RD,ZodIntersection:jV,ZodIssueCode:vme,ZodJWT:t5,ZodKSUID:HD,ZodLazy:lG,ZodLiteral:HV,ZodMap:ZV,ZodNaN:iG,ZodNanoID:jD,ZodNever:LV,ZodNonOptional:u5,ZodNull:OV,ZodNullable:YV,ZodNumber:UA,ZodNumberFormat:m0,ZodObject:GA,ZodOptional:WA,ZodPipe:c5,ZodPrefault:KV,ZodPromise:cG,ZodReadonly:aG,ZodRealError:Is,ZodRecord:o5,ZodSet:WV,ZodString:NA,ZodStringFormat:ai,ZodSuccess:tG,ZodSymbol:DV,ZodTemplateLiteral:sG,ZodTransform:qV,ZodTuple:GV,ZodType:kr,ZodULID:ZD,ZodURL:$A,ZodUUID:Pc,ZodUndefined:kV,ZodUnion:a5,ZodUnknown:RV,ZodVoid:NV,ZodXID:WD,_ZodString:ND,_default:JV,_function:gz,any:FV,array:bo,base64:Bfe,base64url:zfe,bigint:Wfe,boolean:Lr,catch:nG,check:pme,cidrv4:kfe,cidrv6:Ofe,clone:Ks,codec:cme,coerce:Ime,config:xo,core:dfe,cuid:Efe,cuid2:Ife,custom:d5,date:Kfe,decode:SV,decodeAsync:IV,discriminatedUnion:tme,e164:Ffe,email:mfe,emoji:Afe,encode:AV,encodeAsync:EV,endsWith:TD,enum:Pa,file:ome,flattenError:OP,float32:jfe,float64:Vfe,formatError:BP,function:gz,getErrorMap:xme,globalRegistry:mp,gt:Rp,gte:cs,guid:gfe,hash:Ufe,hex:$fe,hostname:Nfe,httpUrl:wfe,includes:CD,instanceof:fme,int:LC,int32:Gfe,int64:Hfe,intersection:VV,ipv4:Pfe,ipv6:Dfe,iso:pfe,json:gme,jwt:Rfe,keyof:Qfe,ksuid:Tfe,lazy:uG,length:LA,literal:$i,locales:wj,looseObject:eme,lowercase:ED,lt:Fp,lte:Ol,map:nme,maxLength:RA,maxSize:FA,mime:PD,minLength:Ig,minSize:r1,multipleOf:t1,nan:ume,nanoid:Sfe,nativeEnum:ame,negative:rV,never:n5,nonnegative:iV,nonoptional:eG,nonpositive:nV,normalize:DD,null:BV,nullable:v4,nullish:sme,number:pt,object:Nr,optional:y4,overwrite:Xp,parse:_V,parseAsync:xV,partialRecord:rme,pipe:_4,positive:tV,prefault:QV,preprocess:yme,prettifyError:a$,promise:dme,property:aV,readonly:oG,record:ZA,refine:dG,regex:SD,regexes:ZP,registry:rD,safeDecode:MV,safeDecodeAsync:PV,safeEncode:CV,safeEncodeAsync:TV,safeParse:bV,safeParseAsync:wV,set:ime,setErrorMap:_me,size:AD,startsWith:MD,strictObject:_a,string:mr,stringFormat:Lfe,stringbool:mme,success:lme,superRefine:pG,symbol:qfe,templateLiteral:hme,toJSONSchema:pV,toLowerCase:OD,toUpperCase:BD,transform:s5,treeifyError:n$,trim:kD,tuple:ld,uint32:Zfe,uint64:Xfe,ulid:Cfe,undefined:Yfe,union:zi,unknown:Cg,uppercase:ID,url:bfe,util:t$,uuid:yfe,uuidv4:vfe,uuidv6:_fe,uuidv7:xfe,void:Jfe,xid:Mfe},Symbol.toStringTag,{value:"Module"}));var xr=Ir((t,e)=>{C(),e.exports=r;function r(n,i){this.x=n,this.y=i}r.prototype={clone:function(){return new r(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,i){return this.clone()._rotateAround(n,i)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var i=n.x-this.x,a=n.y-this.y;return i*i+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,i){return Math.atan2(this.x*i-this.y*n,this.x*n+this.y*i)},_matMult:function(n){var i=n[0]*this.x+n[1]*this.y,a=n[2]*this.x+n[3]*this.y;return this.x=i,this.y=a,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var i=Math.cos(n),a=Math.sin(n),o=i*this.x-a*this.y,s=a*this.x+i*this.y;return this.x=o,this.y=s,this},_rotateAround:function(n,i){var a=Math.cos(n),o=Math.sin(n),s=i.x+a*(this.x-i.x)-o*(this.y-i.y),l=i.y+o*(this.x-i.x)+a*(this.y-i.y);return this.x=s,this.y=l,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},r.convert=function(n){return n instanceof r?n:Array.isArray(n)?new r(n[0],n[1]):n}}),Cme=Ir((t,e)=>{C(),e.exports=r;function r(n,i,a,o){this.cx=3*n,this.bx=3*(a-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(o-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=i,this.p2x=a,this.p2y=o}r.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,i){if(i===void 0&&(i=1e-6),n<0)return 0;if(n>1)return 1;for(var a=n,o=0;o<8;o++){var s=this.sampleCurveX(a)-n;if(Math.abs(s)<i)return a;var l=this.sampleCurveDerivativeX(a);if(Math.abs(l)<1e-6)break;a=a-s/l}var u=0,c=1;for(a=n,o=0;o<20&&(s=this.sampleCurveX(a),!(Math.abs(s-n)<i));o++)n>s?u=a:c=a,a=(c-u)*.5+u;return a},solve:function(n,i){return this.sampleCurveY(this.solveCurveX(n,i))}}}),Mme=Ir((t,e)=>{C();function r(n,i){var a,o,s,l,u,c,h,d;for(a=n.length&3,o=n.length-a,s=i,u=3432918353,c=461845907,d=0;d<o;)h=n.charCodeAt(d)&255|(n.charCodeAt(++d)&255)<<8|(n.charCodeAt(++d)&255)<<16|(n.charCodeAt(++d)&255)<<24,++d,h=(h&65535)*u+(((h>>>16)*u&65535)<<16)&4294967295,h=h<<15|h>>>17,h=(h&65535)*c+(((h>>>16)*c&65535)<<16)&4294967295,s^=h,s=s<<13|s>>>19,l=(s&65535)*5+(((s>>>16)*5&65535)<<16)&4294967295,s=(l&65535)+27492+(((l>>>16)+58964&65535)<<16);switch(h=0,a){case 3:h^=(n.charCodeAt(d+2)&255)<<16;case 2:h^=(n.charCodeAt(d+1)&255)<<8;case 1:h^=n.charCodeAt(d)&255,h=(h&65535)*u+(((h>>>16)*u&65535)<<16)&4294967295,h=h<<15|h>>>17,h=(h&65535)*c+(((h>>>16)*c&65535)<<16)&4294967295,s^=h}return s^=n.length,s^=s>>>16,s=(s&65535)*2246822507+(((s>>>16)*2246822507&65535)<<16)&4294967295,s^=s>>>13,s=(s&65535)*3266489909+(((s>>>16)*3266489909&65535)<<16)&4294967295,s^=s>>>16,s>>>0}typeof e<"u"&&(e.exports=r)}),Tme=Ir((t,e)=>{C();function r(n,i){for(var a=n.length,o=i^a,s=0,l;a>=4;)l=n.charCodeAt(s)&255|(n.charCodeAt(++s)&255)<<8|(n.charCodeAt(++s)&255)<<16|(n.charCodeAt(++s)&255)<<24,l=(l&65535)*1540483477+(((l>>>16)*1540483477&65535)<<16),l^=l>>>24,l=(l&65535)*1540483477+(((l>>>16)*1540483477&65535)<<16),o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16)^l,a-=4,++s;switch(a){case 3:o^=(n.charCodeAt(s+2)&255)<<16;case 2:o^=(n.charCodeAt(s+1)&255)<<8;case 1:o^=n.charCodeAt(s)&255,o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16)}return o^=o>>>13,o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16),o^=o>>>15,o>>>0}typeof e!==void 0&&(e.exports=r)}),fG=Ir((t,e)=>{C();var r=Mme(),n=Tme();e.exports=r,e.exports.murmur3=r,e.exports.murmur2=n}),mG=Ir((t,e)=>{C();var r=xr();e.exports=n;function n(l,u,c,h,d){this.properties={},this.extent=c,this.type=0,this._pbf=l,this._geometry=-1,this._keys=h,this._values=d,l.readFields(i,this,u)}function i(l,u,c){l==1?u.id=c.readVarint():l==2?a(c,u):l==3?u.type=c.readVarint():l==4&&(u._geometry=c.pos)}function a(l,u){for(var c=l.readVarint()+l.pos;l.pos<c;){var h=u._keys[l.readVarint()],d=u._values[l.readVarint()];u.properties[h]=d}}n.types=["Unknown","Point","LineString","Polygon"],n.prototype.loadGeometry=function(){var l=this._pbf;l.pos=this._geometry;for(var u=l.readVarint()+l.pos,c=1,h=0,d=0,p=0,m=[],y;l.pos<u;){if(h<=0){var v=l.readVarint();c=v&7,h=v>>3}if(h--,c===1||c===2)d+=l.readSVarint(),p+=l.readSVarint(),c===1&&(y&&m.push(y),y=[]),y.push(new r(d,p));else if(c===7)y&&y.push(y[0].clone());else throw new Error("unknown command "+c)}return y&&m.push(y),m},n.prototype.bbox=function(){var l=this._pbf;l.pos=this._geometry;for(var u=l.readVarint()+l.pos,c=1,h=0,d=0,p=0,m=1/0,y=-1/0,v=1/0,_=-1/0;l.pos<u;){if(h<=0){var w=l.readVarint();c=w&7,h=w>>3}if(h--,c===1||c===2)d+=l.readSVarint(),p+=l.readSVarint(),d<m&&(m=d),d>y&&(y=d),p<v&&(v=p),p>_&&(_=p);else if(c!==7)throw new Error("unknown command "+c)}return[m,v,y,_]},n.prototype.toGeoJSON=function(l,u,c){var h=this.extent*Math.pow(2,c),d=this.extent*l,p=this.extent*u,m=this.loadGeometry(),y=n.types[this.type],v,_;function w(E){for(var M=0;M<E.length;M++){var P=E[M],k=180-(P.y+p)*360/h;E[M]=[(P.x+d)*360/h-180,360/Math.PI*Math.atan(Math.exp(k*Math.PI/180))-90]}}switch(this.type){case 1:var b=[];for(v=0;v<m.length;v++)b[v]=m[v][0];m=b,w(m);break;case 2:for(v=0;v<m.length;v++)w(m[v]);break;case 3:for(m=o(m),v=0;v<m.length;v++)for(_=0;_<m[v].length;_++)w(m[v][_]);break}m.length===1?m=m[0]:y="Multi"+y;var A={type:"Feature",geometry:{type:y,coordinates:m},properties:this.properties};return"id"in this&&(A.id=this.id),A};function o(l){var u=l.length;if(u<=1)return[l];for(var c=[],h,d,p=0;p<u;p++){var m=s(l[p]);m!==0&&(d===void 0&&(d=m<0),d===m<0?(h&&c.push(h),h=[l[p]]):h.push(l[p]))}return h&&c.push(h),c}function s(l){for(var u=0,c=0,h=l.length,d=h-1,p,m;c<h;d=c++)p=l[c],m=l[d],u+=(m.x-p.x)*(p.y+m.y);return u}}),gG=Ir((t,e)=>{C();var r=mG();e.exports=n;function n(o,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],o.readFields(i,this,s),this.length=this._features.length}function i(o,s,l){o===15?s.version=l.readVarint():o===1?s.name=l.readString():o===5?s.extent=l.readVarint():o===2?s._features.push(l.pos):o===3?s._keys.push(l.readString()):o===4&&s._values.push(a(l))}function a(o){for(var s=null,l=o.readVarint()+o.pos;o.pos<l;){var u=o.readVarint()>>3;s=u===1?o.readString():u===2?o.readFloat():u===3?o.readDouble():u===4?o.readVarint64():u===5?o.readVarint():u===6?o.readSVarint():u===7?o.readBoolean():null}return s}n.prototype.feature=function(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];var s=this._pbf.readVarint()+this._pbf.pos;return new r(this._pbf,s,this.extent,this._keys,this._values)}}),Pme=Ir((t,e)=>{C();var r=gG();e.exports=n;function n(a,o){this.layers=a.readFields(i,{},o)}function i(a,o,s){if(a===3){var l=new r(s,s.readVarint()+s.pos);l.length&&(o[l.name]=l)}}}),XA=Ir((t,e)=>{C(),e.exports.VectorTile=Pme(),e.exports.VectorTileFeature=mG(),e.exports.VectorTileLayer=gG()}),Dme=Ir(t=>{C(),t.read=function(e,r,n,i,a){var o,s,l=a*8-i-1,u=(1<<l)-1,c=u>>1,h=-7,d=n?a-1:0,p=n?-1:1,m=e[r+d];for(d+=p,o=m&(1<<-h)-1,m>>=-h,h+=l;h>0;o=o*256+e[r+d],d+=p,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=i;h>0;s=s*256+e[r+d],d+=p,h-=8);if(o===0)o=1-c;else{if(o===u)return s?NaN:(m?-1:1)*(1/0);s=s+Math.pow(2,i),o=o-c}return(m?-1:1)*s*Math.pow(2,o-i)},t.write=function(e,r,n,i,a,o){var s,l,u,c=o*8-a-1,h=(1<<c)-1,d=h>>1,p=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,m=i?0:o-1,y=i?1:-1,v=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(l=isNaN(r)?1:0,s=h):(s=Math.floor(Math.log(r)/Math.LN2),r*(u=Math.pow(2,-s))<1&&(s--,u*=2),s+d>=1?r+=p/u:r+=p*Math.pow(2,1-d),r*u>=2&&(s++,u/=2),s+d>=h?(l=0,s=h):s+d>=1?(l=(r*u-1)*Math.pow(2,a),s=s+d):(l=r*Math.pow(2,d-1)*Math.pow(2,a),s=0));a>=8;e[n+m]=l&255,m+=y,l/=256,a-=8);for(s=s<<a|l,c+=a;c>0;e[n+m]=s&255,m+=y,s/=256,c-=8);e[n+m-y]|=v*128}}),yG=Ir((t,e)=>{C(),e.exports=n;var r=Dme();function n(T){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(T)?T:new Uint8Array(T||0),this.pos=0,this.type=0,this.length=this.buf.length}n.Varint=0,n.Fixed64=1,n.Bytes=2,n.Fixed32=5;var i=65536*65536,a=1/i,o=12,s=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");n.prototype={destroy:function(){this.buf=null},readFields:function(T,N,$){for($=$||this.length;this.pos<$;){var V=this.readVarint(),G=V>>3,ee=this.pos;this.type=V&7,T(G,N,this),this.pos===ee&&this.skip(V)}return N},readMessage:function(T,N){return this.readFields(T,N,this.readVarint()+this.pos)},readFixed32:function(){var T=k(this.buf,this.pos);return this.pos+=4,T},readSFixed32:function(){var T=O(this.buf,this.pos);return this.pos+=4,T},readFixed64:function(){var T=k(this.buf,this.pos)+k(this.buf,this.pos+4)*i;return this.pos+=8,T},readSFixed64:function(){var T=k(this.buf,this.pos)+O(this.buf,this.pos+4)*i;return this.pos+=8,T},readFloat:function(){var T=r.read(this.buf,this.pos,!0,23,4);return this.pos+=4,T},readDouble:function(){var T=r.read(this.buf,this.pos,!0,52,8);return this.pos+=8,T},readVarint:function(T){var N=this.buf,$,V;return V=N[this.pos++],$=V&127,V<128||(V=N[this.pos++],$|=(V&127)<<7,V<128)||(V=N[this.pos++],$|=(V&127)<<14,V<128)||(V=N[this.pos++],$|=(V&127)<<21,V<128)?$:(V=N[this.pos],$|=(V&15)<<28,l($,T,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var T=this.readVarint();return T%2===1?(T+1)/-2:T/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var T=this.readVarint()+this.pos,N=this.pos;return this.pos=T,T-N>=o&&s?L(this.buf,N,T):B(this.buf,N,T)},readBytes:function(){var T=this.readVarint()+this.pos,N=this.buf.subarray(this.pos,T);return this.pos=T,N},readPackedVarint:function(T,N){if(this.type!==n.Bytes)return T.push(this.readVarint(N));var $=u(this);for(T=T||[];this.pos<$;)T.push(this.readVarint(N));return T},readPackedSVarint:function(T){if(this.type!==n.Bytes)return T.push(this.readSVarint());var N=u(this);for(T=T||[];this.pos<N;)T.push(this.readSVarint());return T},readPackedBoolean:function(T){if(this.type!==n.Bytes)return T.push(this.readBoolean());var N=u(this);for(T=T||[];this.pos<N;)T.push(this.readBoolean());return T},readPackedFloat:function(T){if(this.type!==n.Bytes)return T.push(this.readFloat());var N=u(this);for(T=T||[];this.pos<N;)T.push(this.readFloat());return T},readPackedDouble:function(T){if(this.type!==n.Bytes)return T.push(this.readDouble());var N=u(this);for(T=T||[];this.pos<N;)T.push(this.readDouble());return T},readPackedFixed32:function(T){if(this.type!==n.Bytes)return T.push(this.readFixed32());var N=u(this);for(T=T||[];this.pos<N;)T.push(this.readFixed32());return T},readPackedSFixed32:function(T){if(this.type!==n.Bytes)return T.push(this.readSFixed32());var N=u(this);for(T=T||[];this.pos<N;)T.push(this.readSFixed32());return T},readPackedFixed64:function(T){if(this.type!==n.Bytes)return T.push(this.readFixed64());var N=u(this);for(T=T||[];this.pos<N;)T.push(this.readFixed64());return T},readPackedSFixed64:function(T){if(this.type!==n.Bytes)return T.push(this.readSFixed64());var N=u(this);for(T=T||[];this.pos<N;)T.push(this.readSFixed64());return T},skip:function(T){var N=T&7;if(N===n.Varint)for(;this.buf[this.pos++]>127;);else if(N===n.Bytes)this.pos=this.readVarint()+this.pos;else if(N===n.Fixed32)this.pos+=4;else if(N===n.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+N)},writeTag:function(T,N){this.writeVarint(T<<3|N)},realloc:function(T){for(var N=this.length||16;N<this.pos+T;)N*=2;if(N!==this.length){var $=new Uint8Array(N);$.set(this.buf),this.buf=$,this.length=N}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(T){this.realloc(4),D(this.buf,T,this.pos),this.pos+=4},writeSFixed32:function(T){this.realloc(4),D(this.buf,T,this.pos),this.pos+=4},writeFixed64:function(T){this.realloc(8),D(this.buf,T&-1,this.pos),D(this.buf,Math.floor(T*a),this.pos+4),this.pos+=8},writeSFixed64:function(T){this.realloc(8),D(this.buf,T&-1,this.pos),D(this.buf,Math.floor(T*a),this.pos+4),this.pos+=8},writeVarint:function(T){if(T=+T||0,T>268435455||T<0){h(T,this);return}this.realloc(4),this.buf[this.pos++]=T&127|(T>127?128:0),!(T<=127)&&(this.buf[this.pos++]=(T>>>=7)&127|(T>127?128:0),!(T<=127)&&(this.buf[this.pos++]=(T>>>=7)&127|(T>127?128:0),!(T<=127)&&(this.buf[this.pos++]=T>>>7&127)))},writeSVarint:function(T){this.writeVarint(T<0?-T*2-1:T*2)},writeBoolean:function(T){this.writeVarint(!!T)},writeString:function(T){T=String(T),this.realloc(T.length*4),this.pos++;var N=this.pos;this.pos=R(this.buf,T,this.pos);var $=this.pos-N;$>=128&&m(N,$,this),this.pos=N-1,this.writeVarint($),this.pos+=$},writeFloat:function(T){this.realloc(4),r.write(this.buf,T,this.pos,!0,23,4),this.pos+=4},writeDouble:function(T){this.realloc(8),r.write(this.buf,T,this.pos,!0,52,8),this.pos+=8},writeBytes:function(T){var N=T.length;this.writeVarint(N),this.realloc(N);for(var $=0;$<N;$++)this.buf[this.pos++]=T[$]},writeRawMessage:function(T,N){this.pos++;var $=this.pos;T(N,this);var V=this.pos-$;V>=128&&m($,V,this),this.pos=$-1,this.writeVarint(V),this.pos+=V},writeMessage:function(T,N,$){this.writeTag(T,n.Bytes),this.writeRawMessage(N,$)},writePackedVarint:function(T,N){N.length&&this.writeMessage(T,y,N)},writePackedSVarint:function(T,N){N.length&&this.writeMessage(T,v,N)},writePackedBoolean:function(T,N){N.length&&this.writeMessage(T,b,N)},writePackedFloat:function(T,N){N.length&&this.writeMessage(T,_,N)},writePackedDouble:function(T,N){N.length&&this.writeMessage(T,w,N)},writePackedFixed32:function(T,N){N.length&&this.writeMessage(T,A,N)},writePackedSFixed32:function(T,N){N.length&&this.writeMessage(T,E,N)},writePackedFixed64:function(T,N){N.length&&this.writeMessage(T,M,N)},writePackedSFixed64:function(T,N){N.length&&this.writeMessage(T,P,N)},writeBytesField:function(T,N){this.writeTag(T,n.Bytes),this.writeBytes(N)},writeFixed32Field:function(T,N){this.writeTag(T,n.Fixed32),this.writeFixed32(N)},writeSFixed32Field:function(T,N){this.writeTag(T,n.Fixed32),this.writeSFixed32(N)},writeFixed64Field:function(T,N){this.writeTag(T,n.Fixed64),this.writeFixed64(N)},writeSFixed64Field:function(T,N){this.writeTag(T,n.Fixed64),this.writeSFixed64(N)},writeVarintField:function(T,N){this.writeTag(T,n.Varint),this.writeVarint(N)},writeSVarintField:function(T,N){this.writeTag(T,n.Varint),this.writeSVarint(N)},writeStringField:function(T,N){this.writeTag(T,n.Bytes),this.writeString(N)},writeFloatField:function(T,N){this.writeTag(T,n.Fixed32),this.writeFloat(N)},writeDoubleField:function(T,N){this.writeTag(T,n.Fixed64),this.writeDouble(N)},writeBooleanField:function(T,N){this.writeVarintField(T,!!N)}};function l(T,N,$){var V=$.buf,G,ee;if(ee=V[$.pos++],G=(ee&112)>>4,ee<128||(ee=V[$.pos++],G|=(ee&127)<<3,ee<128)||(ee=V[$.pos++],G|=(ee&127)<<10,ee<128)||(ee=V[$.pos++],G|=(ee&127)<<17,ee<128)||(ee=V[$.pos++],G|=(ee&127)<<24,ee<128)||(ee=V[$.pos++],G|=(ee&1)<<31,ee<128))return c(T,G,N);throw new Error("Expected varint not more than 10 bytes")}function u(T){return T.type===n.Bytes?T.readVarint()+T.pos:T.pos+1}function c(T,N,$){return $?N*4294967296+(T>>>0):(N>>>0)*4294967296+(T>>>0)}function h(T,N){var $,V;if(T>=0?($=T%4294967296|0,V=T/4294967296|0):($=~(-T%4294967296),V=~(-T/4294967296),$^4294967295?$=$+1|0:($=0,V=V+1|0)),T>=18446744073709552e3||T<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");N.realloc(10),d($,V,N),p(V,N)}function d(T,N,$){$.buf[$.pos++]=T&127|128,T>>>=7,$.buf[$.pos++]=T&127|128,T>>>=7,$.buf[$.pos++]=T&127|128,T>>>=7,$.buf[$.pos++]=T&127|128,T>>>=7,$.buf[$.pos]=T&127}function p(T,N){var $=(T&7)<<4;N.buf[N.pos++]|=$|((T>>>=3)?128:0),T&&(N.buf[N.pos++]=T&127|((T>>>=7)?128:0),T&&(N.buf[N.pos++]=T&127|((T>>>=7)?128:0),T&&(N.buf[N.pos++]=T&127|((T>>>=7)?128:0),T&&(N.buf[N.pos++]=T&127|((T>>>=7)?128:0),T&&(N.buf[N.pos++]=T&127)))))}function m(T,N,$){var V=N<=16383?1:N<=2097151?2:N<=268435455?3:Math.floor(Math.log(N)/(Math.LN2*7));$.realloc(V);for(var G=$.pos-1;G>=T;G--)$.buf[G+V]=$.buf[G]}function y(T,N){for(var $=0;$<T.length;$++)N.writeVarint(T[$])}function v(T,N){for(var $=0;$<T.length;$++)N.writeSVarint(T[$])}function _(T,N){for(var $=0;$<T.length;$++)N.writeFloat(T[$])}function w(T,N){for(var $=0;$<T.length;$++)N.writeDouble(T[$])}function b(T,N){for(var $=0;$<T.length;$++)N.writeBoolean(T[$])}function A(T,N){for(var $=0;$<T.length;$++)N.writeFixed32(T[$])}function E(T,N){for(var $=0;$<T.length;$++)N.writeSFixed32(T[$])}function M(T,N){for(var $=0;$<T.length;$++)N.writeFixed64(T[$])}function P(T,N){for(var $=0;$<T.length;$++)N.writeSFixed64(T[$])}function k(T,N){return(T[N]|T[N+1]<<8|T[N+2]<<16)+T[N+3]*16777216}function D(T,N,$){T[$]=N,T[$+1]=N>>>8,T[$+2]=N>>>16,T[$+3]=N>>>24}function O(T,N){return(T[N]|T[N+1]<<8|T[N+2]<<16)+(T[N+3]<<24)}function B(T,N,$){for(var V="",G=N;G<$;){var ee=T[G],ie=null,me=ee>239?4:ee>223?3:ee>191?2:1;if(G+me>$)break;var Me,Ae,le;me===1?ee<128&&(ie=ee):me===2?(Me=T[G+1],(Me&192)===128&&(ie=(ee&31)<<6|Me&63,ie<=127&&(ie=null))):me===3?(Me=T[G+1],Ae=T[G+2],(Me&192)===128&&(Ae&192)===128&&(ie=(ee&15)<<12|(Me&63)<<6|Ae&63,(ie<=2047||ie>=55296&&ie<=57343)&&(ie=null))):me===4&&(Me=T[G+1],Ae=T[G+2],le=T[G+3],(Me&192)===128&&(Ae&192)===128&&(le&192)===128&&(ie=(ee&15)<<18|(Me&63)<<12|(Ae&63)<<6|le&63,(ie<=65535||ie>=1114112)&&(ie=null))),ie===null?(ie=65533,me=1):ie>65535&&(ie-=65536,V+=String.fromCharCode(ie>>>10&1023|55296),ie=56320|ie&1023),V+=String.fromCharCode(ie),G+=me}return V}function L(T,N,$){return s.decode(T.subarray(N,$))}function R(T,N,$){for(var V=0,G,ee;V<N.length;V++){if(G=N.charCodeAt(V),G>55295&&G<57344)if(ee)if(G<56320){T[$++]=239,T[$++]=191,T[$++]=189,ee=G;continue}else G=ee-55296<<10|G-56320|65536,ee=null;else{G>56319||V+1===N.length?(T[$++]=239,T[$++]=191,T[$++]=189):ee=G;continue}else ee&&(T[$++]=239,T[$++]=191,T[$++]=189,ee=null);G<128?T[$++]=G:(G<2048?T[$++]=G>>6|192:(G<65536?T[$++]=G>>12|224:(T[$++]=G>>18|240,T[$++]=G>>12&63|128),T[$++]=G>>6&63|128),T[$++]=G&63|128)}return $}}),vG=Ir((t,e)=>{C();var r=200,n="__lodash_hash_undefined__",i=800,a=16,o=9007199254740991,s="[object Arguments]",l="[object Array]",u="[object AsyncFunction]",c="[object Boolean]",h="[object Date]",d="[object Error]",p="[object Function]",m="[object GeneratorFunction]",y="[object Map]",v="[object Number]",_="[object Null]",w="[object Object]",b="[object Proxy]",A="[object RegExp]",E="[object Set]",M="[object String]",P="[object Undefined]",k="[object WeakMap]",D="[object ArrayBuffer]",O="[object DataView]",B="[object Float32Array]",L="[object Float64Array]",R="[object Int8Array]",T="[object Int16Array]",N="[object Int32Array]",$="[object Uint8Array]",V="[object Uint8ClampedArray]",G="[object Uint16Array]",ee="[object Uint32Array]",ie=/[\\^$.*+?()[\]{}|]/g,me=/^\[object .+?Constructor\]$/,Me=/^(?:0|[1-9]\d*)$/,Ae={};Ae[B]=Ae[L]=Ae[R]=Ae[T]=Ae[N]=Ae[$]=Ae[V]=Ae[G]=Ae[ee]=!0,Ae[s]=Ae[l]=Ae[D]=Ae[c]=Ae[O]=Ae[h]=Ae[d]=Ae[p]=Ae[y]=Ae[v]=Ae[w]=Ae[A]=Ae[E]=Ae[M]=Ae[k]=!1;var le=typeof global=="object"&&global&&global.Object===Object&&global,_e=typeof self=="object"&&self&&self.Object===Object&&self,Le=le||_e||Function("return this")(),Se=typeof t=="object"&&t&&!t.nodeType&&t,Ue=Se&&typeof e=="object"&&e&&!e.nodeType&&e,Y=Ue&&Ue.exports===Se,we=Y&&le.process,q=(function(){try{var te=Ue&&Ue.require&&Ue.require("util").types;return te||we&&we.binding&&we.binding("util")}catch{}})(),oe=q&&q.isTypedArray;function ce(te,ve,$e){switch($e.length){case 0:return te.call(ve);case 1:return te.call(ve,$e[0]);case 2:return te.call(ve,$e[0],$e[1]);case 3:return te.call(ve,$e[0],$e[1],$e[2])}return te.apply(ve,$e)}function X(te,ve){for(var $e=-1,Ut=Array(te);++$e<te;)Ut[$e]=ve($e);return Ut}function ke(te){return function(ve){return te(ve)}}function Ce(te,ve){return te?.[ve]}function Ee(te,ve){return function($e){return te(ve($e))}}var Ne=Array.prototype,st=Function.prototype,Ke=Object.prototype,J=Le["__core-js_shared__"],Z=st.toString,fe=Ke.hasOwnProperty,Fe=(function(){var te=/[^.]+$/.exec(J&&J.keys&&J.keys.IE_PROTO||"");return te?"Symbol(src)_1."+te:""})(),Ve=Ke.toString,ze=Z.call(Object),Tt=RegExp("^"+Z.call(fe).replace(ie,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ft=Y?Le.Buffer:void 0,St=Le.Symbol,nr=Le.Uint8Array;ft&&ft.allocUnsafe;var He=Ee(Object.getPrototypeOf,Object),Ge=Object.create,je=Ke.propertyIsEnumerable,tt=Ne.splice,Ze=St?St.toStringTag:void 0,At=(function(){try{var te=ea(Object,"defineProperty");return te({},"",{}),te}catch{}})(),vt=ft?ft.isBuffer:void 0,Kt=Math.max,he=Date.now,ct=ea(Le,"Map"),De=ea(Object,"create"),qe=(function(){function te(){}return function(ve){if(!Do(ve))return{};if(Ge)return Ge(ve);te.prototype=ve;var $e=new te;return te.prototype=void 0,$e}})();function mt(te){var ve=-1,$e=te==null?0:te.length;for(this.clear();++ve<$e;){var Ut=te[ve];this.set(Ut[0],Ut[1])}}function Et(){this.__data__=De?De(null):{},this.size=0}function Wt(te){var ve=this.has(te)&&delete this.__data__[te];return this.size-=ve?1:0,ve}function en(te){var ve=this.__data__;if(De){var $e=ve[te];return $e===n?void 0:$e}return fe.call(ve,te)?ve[te]:void 0}function Ii(te){var ve=this.__data__;return De?ve[te]!==void 0:fe.call(ve,te)}function Zr(te,ve){var $e=this.__data__;return this.size+=this.has(te)?0:1,$e[te]=De&&ve===void 0?n:ve,this}mt.prototype.clear=Et,mt.prototype.delete=Wt,mt.prototype.get=en,mt.prototype.has=Ii,mt.prototype.set=Zr;function Pn(te){var ve=-1,$e=te==null?0:te.length;for(this.clear();++ve<$e;){var Ut=te[ve];this.set(Ut[0],Ut[1])}}function Fa(){this.__data__=[],this.size=0}function Hu(te){var ve=this.__data__,$e=be(ve,te);if($e<0)return!1;var Ut=ve.length-1;return $e==Ut?ve.pop():tt.call(ve,$e,1),--this.size,!0}function ah(te){var ve=this.__data__,$e=be(ve,te);return $e<0?void 0:ve[$e][1]}function Qi(te){return be(this.__data__,te)>-1}function Co(te,ve){var $e=this.__data__,Ut=be($e,te);return Ut<0?(++this.size,$e.push([te,ve])):$e[Ut][1]=ve,this}Pn.prototype.clear=Fa,Pn.prototype.delete=Hu,Pn.prototype.get=ah,Pn.prototype.has=Qi,Pn.prototype.set=Co;function Mo(te){var ve=-1,$e=te==null?0:te.length;for(this.clear();++ve<$e;){var Ut=te[ve];this.set(Ut[0],Ut[1])}}function Xu(){this.size=0,this.__data__={hash:new mt,map:new(ct||Pn),string:new mt}}function Ts(te){var ve=Yo(this,te).delete(te);return this.size-=ve?1:0,ve}function qu(te){return Yo(this,te).get(te)}function ua(te){return Yo(this,te).has(te)}function Yu(te,ve){var $e=Yo(this,te),Ut=$e.size;return $e.set(te,ve),this.size+=$e.size==Ut?0:1,this}Mo.prototype.clear=Xu,Mo.prototype.delete=Ts,Mo.prototype.get=qu,Mo.prototype.has=ua,Mo.prototype.set=Yu;function To(te){var ve=this.__data__=new Pn(te);this.size=ve.size}function oh(){this.__data__=new Pn,this.size=0}function sh(te){var ve=this.__data__,$e=ve.delete(te);return this.size=ve.size,$e}function Pd(te){return this.__data__.get(te)}function se(te){return this.__data__.has(te)}function Pt(te,ve){var $e=this.__data__;if($e instanceof Pn){var Ut=$e.__data__;if(!ct||Ut.length<r-1)return Ut.push([te,ve]),this.size=++$e.size,this;$e=this.__data__=new Mo(Ut)}return $e.set(te,ve),this.size=$e.size,this}To.prototype.clear=oh,To.prototype.delete=sh,To.prototype.get=Pd,To.prototype.has=se,To.prototype.set=Pt;function bt(te,ve){var $e=Cr(te),Ut=!$e&&Yt(te),Yr=!$e&&!Ut&&Jo(te),Dn=!$e&&!Ut&&!Yr&&wB(te),oi=$e||Ut||Yr||Dn,hn=oi?X(te.length,String):[],si=hn.length;for(var nl in te)!(oi&&(nl=="length"||Yr&&(nl=="offset"||nl=="parent")||Dn&&(nl=="buffer"||nl=="byteLength"||nl=="byteOffset")||x(nl,si)))&&hn.push(nl);return hn}function H(te,ve,$e){($e!==void 0&&!er(te[ve],$e)||$e===void 0&&!(ve in te))&&Te(te,ve,$e)}function pe(te,ve,$e){var Ut=te[ve];(!(fe.call(te,ve)&&er(Ut,$e))||$e===void 0&&!(ve in te))&&Te(te,ve,$e)}function be(te,ve){for(var $e=te.length;$e--;)if(er(te[$e][0],ve))return $e;return-1}function Te(te,ve,$e){ve=="__proto__"&&At?At(te,ve,{configurable:!0,enumerable:!0,value:$e,writable:!0}):te[ve]=$e}var de=no();function Ye(te){return te==null?te===void 0?P:_:Ze&&Ze in Object(te)?Ju(te):re(te)}function Ct(te){return Z0(te)&&Ye(te)==s}function _t(te){if(!Do(te)||F(te))return!1;var ve=G0(te)?Tt:me;return ve.test(Bt(te))}function Ft(te){return Z0(te)&&N_(te.length)&&!!Ae[Ye(te)]}function or(te){if(!Do(te))return W(te);var ve=j(te),$e=[];for(var Ut in te)Ut=="constructor"&&(ve||!fe.call(te,Ut))||$e.push(Ut);return $e}function ur(te,ve,$e,Ut,Yr){te!==ve&&de(ve,function(Dn,oi){if(Yr||(Yr=new To),Do(Dn))dr(te,ve,oi,$e,ur,Ut,Yr);else{var hn=Ut?Ut(Pe(te,oi),Dn,oi+"",te,ve,Yr):void 0;hn===void 0&&(hn=Dn),H(te,oi,hn)}},AB)}function dr(te,ve,$e,Ut,Yr,Dn,oi){var hn=Pe(te,$e),si=Pe(ve,$e),nl=oi.get(si);if(nl){H(te,$e,nl);return}var Ko=Dn?Dn(hn,si,$e+"",te,ve,oi):void 0,W0=Ko===void 0;if(W0){var AS=Cr(si),SS=!AS&&Jo(si),EB=!AS&&!SS&&wB(si);Ko=si,AS||SS||EB?Cr(hn)?Ko=hn:Aa(hn)?Ko=Qt(hn):SS?(W0=!1,Ko=$r(si)):EB?(W0=!1,Ko=gn(si)):Ko=[]:nne(si)||Yt(si)?(Ko=hn,Yt(hn)?Ko=ine(hn):(!Do(hn)||G0(hn))&&(Ko=g(si))):W0=!1}W0&&(oi.set(si,Ko),Yr(Ko,si,Ut,Dn,oi),oi.delete(si)),H(te,$e,Ko)}function Wr(te,ve){return rt(ye(te,ve,SB),te+"")}var sn=At?function(te,ve){return At(te,"toString",{configurable:!0,enumerable:!1,value:one(ve),writable:!0})}:SB;function $r(te,ve){return te.slice()}function ln(te){var ve=new te.constructor(te.byteLength);return new nr(ve).set(new nr(te)),ve}function gn(te,ve){var $e=ln(te.buffer);return new te.constructor($e,te.byteOffset,te.length)}function Qt(te,ve){var $e=-1,Ut=te.length;for(ve||(ve=Array(Ut));++$e<Ut;)ve[$e]=te[$e];return ve}function qt(te,ve,$e,Ut){var Yr=!$e;$e||($e={});for(var Dn=-1,oi=ve.length;++Dn<oi;){var hn=ve[Dn],si=void 0;si===void 0&&(si=te[hn]),Yr?Te($e,hn,si):pe($e,hn,si)}return $e}function Po(te){return Wr(function(ve,$e){var Ut=-1,Yr=$e.length,Dn=Yr>1?$e[Yr-1]:void 0,oi=Yr>2?$e[2]:void 0;for(Dn=te.length>3&&typeof Dn=="function"?(Yr--,Dn):void 0,oi&&I($e[0],$e[1],oi)&&(Dn=Yr<3?void 0:Dn,Yr=1),ve=Object(ve);++Ut<Yr;){var hn=$e[Ut];hn&&te(ve,hn,Ut,Dn)}return ve})}function no(te){return function(ve,$e,Ut){for(var Yr=-1,Dn=Object(ve),oi=Ut(ve),hn=oi.length;hn--;){var si=oi[++Yr];if($e(Dn[si],si,Dn)===!1)break}return ve}}function Yo(te,ve){var $e=te.__data__;return z(ve)?$e[typeof ve=="string"?"string":"hash"]:$e.map}function ea(te,ve){var $e=Ce(te,ve);return _t($e)?$e:void 0}function Ju(te){var ve=fe.call(te,Ze),$e=te[Ze];try{te[Ze]=void 0;var Ut=!0}catch{}var Yr=Ve.call(te);return Ut&&(ve?te[Ze]=$e:delete te[Ze]),Yr}function g(te){return typeof te.constructor=="function"&&!j(te)?qe(He(te)):{}}function x(te,ve){var $e=typeof te;return ve=ve??o,!!ve&&($e=="number"||$e!="symbol"&&Me.test(te))&&te>-1&&te%1==0&&te<ve}function I(te,ve,$e){if(!Do($e))return!1;var Ut=typeof ve;return(Ut=="number"?Kn($e)&&x(ve,$e.length):Ut=="string"&&ve in $e)?er($e[ve],te):!1}function z(te){var ve=typeof te;return ve=="string"||ve=="number"||ve=="symbol"||ve=="boolean"?te!=="__proto__":te===null}function F(te){return!!Fe&&Fe in te}function j(te){var ve=te&&te.constructor,$e=typeof ve=="function"&&ve.prototype||Ke;return te===$e}function W(te){var ve=[];if(te!=null)for(var $e in Object(te))ve.push($e);return ve}function re(te){return Ve.call(te)}function ye(te,ve,$e){return ve=Kt(ve===void 0?te.length-1:ve,0),function(){for(var Ut=arguments,Yr=-1,Dn=Kt(Ut.length-ve,0),oi=Array(Dn);++Yr<Dn;)oi[Yr]=Ut[ve+Yr];Yr=-1;for(var hn=Array(ve+1);++Yr<ve;)hn[Yr]=Ut[Yr];return hn[ve]=$e(oi),ce(te,this,hn)}}function Pe(te,ve){if(!(ve==="constructor"&&typeof te[ve]=="function")&&ve!="__proto__")return te[ve]}var rt=yt(sn);function yt(te){var ve=0,$e=0;return function(){var Ut=he(),Yr=a-(Ut-$e);if($e=Ut,Yr>0){if(++ve>=i)return arguments[0]}else ve=0;return te.apply(void 0,arguments)}}function Bt(te){if(te!=null){try{return Z.call(te)}catch{}try{return te+""}catch{}}return""}function er(te,ve){return te===ve||te!==te&&ve!==ve}var Yt=Ct((function(){return arguments})())?Ct:function(te){return Z0(te)&&fe.call(te,"callee")&&!je.call(te,"callee")},Cr=Array.isArray;function Kn(te){return te!=null&&N_(te.length)&&!G0(te)}function Aa(te){return Z0(te)&&Kn(te)}var Jo=vt||sne;function G0(te){if(!Do(te))return!1;var ve=Ye(te);return ve==p||ve==m||ve==u||ve==b}function N_(te){return typeof te=="number"&&te>-1&&te%1==0&&te<=o}function Do(te){var ve=typeof te;return te!=null&&(ve=="object"||ve=="function")}function Z0(te){return te!=null&&typeof te=="object"}function nne(te){if(!Z0(te)||Ye(te)!=w)return!1;var ve=He(te);if(ve===null)return!0;var $e=fe.call(ve,"constructor")&&ve.constructor;return typeof $e=="function"&&$e instanceof $e&&Z.call($e)==ze}var wB=oe?ke(oe):Ft;function ine(te){return qt(te,AB(te))}function AB(te){return Kn(te)?bt(te):or(te)}var ane=Po(function(te,ve,$e){ur(te,ve,$e)});function one(te){return function(){return te}}function SB(te){return te}function sne(){return!1}e.exports=ane}),kme=Ir((t,e)=>{C();var r=!1,n={},i=!1;typeof e<"u"&&e.exports?(e.exports=n,i=!0):typeof document<"u"?window.ClipperLib=n:self.ClipperLib=n;var a;i?(o="chrome",a="Netscape"):(o=navigator.userAgent.toString().toLowerCase(),a=navigator.appName);var o,s={};o.indexOf("chrome")!=-1&&o.indexOf("chromium")==-1?s.chrome=1:s.chrome=0,o.indexOf("chromium")!=-1?s.chromium=1:s.chromium=0,o.indexOf("safari")!=-1&&o.indexOf("chrome")==-1&&o.indexOf("chromium")==-1?s.safari=1:s.safari=0,o.indexOf("firefox")!=-1?s.firefox=1:s.firefox=0,o.indexOf("firefox/17")!=-1?s.firefox17=1:s.firefox17=0,o.indexOf("firefox/15")!=-1?s.firefox15=1:s.firefox15=0,o.indexOf("firefox/3")!=-1?s.firefox3=1:s.firefox3=0,o.indexOf("opera")!=-1?s.opera=1:s.opera=0,o.indexOf("msie 10")!=-1?s.msie10=1:s.msie10=0,o.indexOf("msie 9")!=-1?s.msie9=1:s.msie9=0,o.indexOf("msie 8")!=-1?s.msie8=1:s.msie8=0,o.indexOf("msie 7")!=-1?s.msie7=1:s.msie7=0,o.indexOf("msie ")!=-1?s.msie=1:s.msie=0,n.biginteger_used=null;var l;function u(g,x,I){n.biginteger_used=1,g!=null&&(typeof g=="number"&&typeof x>"u"?this.fromInt(g):typeof g=="number"?this.fromNumber(g,x,I):x==null&&typeof g!="string"?this.fromString(g,256):this.fromString(g,x))}function c(){return new u(null)}function h(g,x,I,z,F,j){for(;--j>=0;){var W=x*this[g++]+I[z]+F;F=Math.floor(W/67108864),I[z++]=W&67108863}return F}function d(g,x,I,z,F,j){for(var W=x&32767,re=x>>15;--j>=0;){var ye=this[g]&32767,Pe=this[g++]>>15,rt=re*ye+Pe*W;ye=W*ye+((rt&32767)<<15)+I[z]+(F&1073741823),F=(ye>>>30)+(rt>>>15)+re*Pe+(F>>>30),I[z++]=ye&1073741823}return F}function p(g,x,I,z,F,j){for(var W=x&16383,re=x>>14;--j>=0;){var ye=this[g]&16383,Pe=this[g++]>>14,rt=re*ye+Pe*W;ye=W*ye+((rt&16383)<<14)+I[z]+F,F=(ye>>28)+(rt>>14)+re*Pe,I[z++]=ye&268435455}return F}a=="Microsoft Internet Explorer"?(u.prototype.am=d,l=30):a!="Netscape"?(u.prototype.am=h,l=26):(u.prototype.am=p,l=28),u.prototype.DB=l,u.prototype.DM=(1<<l)-1,u.prototype.DV=1<<l;var m=52;u.prototype.FV=Math.pow(2,m),u.prototype.F1=m-l,u.prototype.F2=2*l-m;var y="0123456789abcdefghijklmnopqrstuvwxyz",v=new Array,_,w;for(_=48,w=0;w<=9;++w)v[_++]=w;for(_=97,w=10;w<36;++w)v[_++]=w;for(_=65,w=10;w<36;++w)v[_++]=w;function b(g){return y.charAt(g)}function A(g,x){var I=v[g.charCodeAt(x)];return I??-1}function E(g){for(var x=this.t-1;x>=0;--x)g[x]=this[x];g.t=this.t,g.s=this.s}function M(g){this.t=1,this.s=g<0?-1:0,g>0?this[0]=g:g<-1?this[0]=g+this.DV:this.t=0}function P(g){var x=c();return x.fromInt(g),x}function k(g,x){var I;if(x==16)I=4;else if(x==8)I=3;else if(x==256)I=8;else if(x==2)I=1;else if(x==32)I=5;else if(x==4)I=2;else{this.fromRadix(g,x);return}this.t=0,this.s=0;for(var z=g.length,F=!1,j=0;--z>=0;){var W=I==8?g[z]&255:A(g,z);if(W<0){g.charAt(z)=="-"&&(F=!0);continue}F=!1,j==0?this[this.t++]=W:j+I>this.DB?(this[this.t-1]|=(W&(1<<this.DB-j)-1)<<j,this[this.t++]=W>>this.DB-j):this[this.t-1]|=W<<j,j+=I,j>=this.DB&&(j-=this.DB)}I==8&&(g[0]&128)!=0&&(this.s=-1,j>0&&(this[this.t-1]|=(1<<this.DB-j)-1<<j)),this.clamp(),F&&u.ZERO.subTo(this,this)}function D(){for(var g=this.s&this.DM;this.t>0&&this[this.t-1]==g;)--this.t}function O(g){if(this.s<0)return"-"+this.negate().toString(g);var x;if(g==16)x=4;else if(g==8)x=3;else if(g==2)x=1;else if(g==32)x=5;else if(g==4)x=2;else return this.toRadix(g);var I=(1<<x)-1,z,F=!1,j="",W=this.t,re=this.DB-W*this.DB%x;if(W-- >0)for(re<this.DB&&(z=this[W]>>re)>0&&(F=!0,j=b(z));W>=0;)re<x?(z=(this[W]&(1<<re)-1)<<x-re,z|=this[--W]>>(re+=this.DB-x)):(z=this[W]>>(re-=x)&I,re<=0&&(re+=this.DB,--W)),z>0&&(F=!0),F&&(j+=b(z));return F?j:"0"}function B(){var g=c();return u.ZERO.subTo(this,g),g}function L(){return this.s<0?this.negate():this}function R(g){var x=this.s-g.s;if(x!=0)return x;var I=this.t;if(x=I-g.t,x!=0)return this.s<0?-x:x;for(;--I>=0;)if((x=this[I]-g[I])!=0)return x;return 0}function T(g){var x=1,I;return(I=g>>>16)!=0&&(g=I,x+=16),(I=g>>8)!=0&&(g=I,x+=8),(I=g>>4)!=0&&(g=I,x+=4),(I=g>>2)!=0&&(g=I,x+=2),(I=g>>1)!=0&&(g=I,x+=1),x}function N(){return this.t<=0?0:this.DB*(this.t-1)+T(this[this.t-1]^this.s&this.DM)}function $(g,x){var I;for(I=this.t-1;I>=0;--I)x[I+g]=this[I];for(I=g-1;I>=0;--I)x[I]=0;x.t=this.t+g,x.s=this.s}function V(g,x){for(var I=g;I<this.t;++I)x[I-g]=this[I];x.t=Math.max(this.t-g,0),x.s=this.s}function G(g,x){var I=g%this.DB,z=this.DB-I,F=(1<<z)-1,j=Math.floor(g/this.DB),W=this.s<<I&this.DM,re;for(re=this.t-1;re>=0;--re)x[re+j+1]=this[re]>>z|W,W=(this[re]&F)<<I;for(re=j-1;re>=0;--re)x[re]=0;x[j]=W,x.t=this.t+j+1,x.s=this.s,x.clamp()}function ee(g,x){x.s=this.s;var I=Math.floor(g/this.DB);if(I>=this.t){x.t=0;return}var z=g%this.DB,F=this.DB-z,j=(1<<z)-1;x[0]=this[I]>>z;for(var W=I+1;W<this.t;++W)x[W-I-1]|=(this[W]&j)<<F,x[W-I]=this[W]>>z;z>0&&(x[this.t-I-1]|=(this.s&j)<<F),x.t=this.t-I,x.clamp()}function ie(g,x){for(var I=0,z=0,F=Math.min(g.t,this.t);I<F;)z+=this[I]-g[I],x[I++]=z&this.DM,z>>=this.DB;if(g.t<this.t){for(z-=g.s;I<this.t;)z+=this[I],x[I++]=z&this.DM,z>>=this.DB;z+=this.s}else{for(z+=this.s;I<g.t;)z-=g[I],x[I++]=z&this.DM,z>>=this.DB;z-=g.s}x.s=z<0?-1:0,z<-1?x[I++]=this.DV+z:z>0&&(x[I++]=z),x.t=I,x.clamp()}function me(g,x){var I=this.abs(),z=g.abs(),F=I.t;for(x.t=F+z.t;--F>=0;)x[F]=0;for(F=0;F<z.t;++F)x[F+I.t]=I.am(0,z[F],x,F,0,I.t);x.s=0,x.clamp(),this.s!=g.s&&u.ZERO.subTo(x,x)}function Me(g){for(var x=this.abs(),I=g.t=2*x.t;--I>=0;)g[I]=0;for(I=0;I<x.t-1;++I){var z=x.am(I,x[I],g,2*I,0,1);(g[I+x.t]+=x.am(I+1,2*x[I],g,2*I+1,z,x.t-I-1))>=x.DV&&(g[I+x.t]-=x.DV,g[I+x.t+1]=1)}g.t>0&&(g[g.t-1]+=x.am(I,x[I],g,2*I,0,1)),g.s=0,g.clamp()}function Ae(g,x,I){var z=g.abs();if(!(z.t<=0)){var F=this.abs();if(F.t<z.t){x?.fromInt(0),I!=null&&this.copyTo(I);return}I==null&&(I=c());var j=c(),W=this.s,re=g.s,ye=this.DB-T(z[z.t-1]);ye>0?(z.lShiftTo(ye,j),F.lShiftTo(ye,I)):(z.copyTo(j),F.copyTo(I));var Pe=j.t,rt=j[Pe-1];if(rt!=0){var yt=rt*(1<<this.F1)+(Pe>1?j[Pe-2]>>this.F2:0),Bt=this.FV/yt,er=(1<<this.F1)/yt,Yt=1<<this.F2,Cr=I.t,Kn=Cr-Pe,Aa=x??c();for(j.dlShiftTo(Kn,Aa),I.compareTo(Aa)>=0&&(I[I.t++]=1,I.subTo(Aa,I)),u.ONE.dlShiftTo(Pe,Aa),Aa.subTo(j,j);j.t<Pe;)j[j.t++]=0;for(;--Kn>=0;){var Jo=I[--Cr]==rt?this.DM:Math.floor(I[Cr]*Bt+(I[Cr-1]+Yt)*er);if((I[Cr]+=j.am(0,Jo,I,Kn,0,Pe))<Jo)for(j.dlShiftTo(Kn,Aa),I.subTo(Aa,I);I[Cr]<--Jo;)I.subTo(Aa,I)}x!=null&&(I.drShiftTo(Pe,x),W!=re&&u.ZERO.subTo(x,x)),I.t=Pe,I.clamp(),ye>0&&I.rShiftTo(ye,I),W<0&&u.ZERO.subTo(I,I)}}}function le(g){var x=c();return this.abs().divRemTo(g,null,x),this.s<0&&x.compareTo(u.ZERO)>0&&g.subTo(x,x),x}function _e(g){this.m=g}function Le(g){return g.s<0||g.compareTo(this.m)>=0?g.mod(this.m):g}function Se(g){return g}function Ue(g){g.divRemTo(this.m,null,g)}function Y(g,x,I){g.multiplyTo(x,I),this.reduce(I)}function we(g,x){g.squareTo(x),this.reduce(x)}_e.prototype.convert=Le,_e.prototype.revert=Se,_e.prototype.reduce=Ue,_e.prototype.mulTo=Y,_e.prototype.sqrTo=we;function q(){if(this.t<1)return 0;var g=this[0];if((g&1)==0)return 0;var x=g&3;return x=x*(2-(g&15)*x)&15,x=x*(2-(g&255)*x)&255,x=x*(2-((g&65535)*x&65535))&65535,x=x*(2-g*x%this.DV)%this.DV,x>0?this.DV-x:-x}function oe(g){this.m=g,this.mp=g.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<g.DB-15)-1,this.mt2=2*g.t}function ce(g){var x=c();return g.abs().dlShiftTo(this.m.t,x),x.divRemTo(this.m,null,x),g.s<0&&x.compareTo(u.ZERO)>0&&this.m.subTo(x,x),x}function X(g){var x=c();return g.copyTo(x),this.reduce(x),x}function ke(g){for(;g.t<=this.mt2;)g[g.t++]=0;for(var x=0;x<this.m.t;++x){var I=g[x]&32767,z=I*this.mpl+((I*this.mph+(g[x]>>15)*this.mpl&this.um)<<15)&g.DM;for(I=x+this.m.t,g[I]+=this.m.am(0,z,g,x,0,this.m.t);g[I]>=g.DV;)g[I]-=g.DV,g[++I]++}g.clamp(),g.drShiftTo(this.m.t,g),g.compareTo(this.m)>=0&&g.subTo(this.m,g)}function Ce(g,x){g.squareTo(x),this.reduce(x)}function Ee(g,x,I){g.multiplyTo(x,I),this.reduce(I)}oe.prototype.convert=ce,oe.prototype.revert=X,oe.prototype.reduce=ke,oe.prototype.mulTo=Ee,oe.prototype.sqrTo=Ce;function Ne(){return(this.t>0?this[0]&1:this.s)==0}function st(g,x){if(g>4294967295||g<1)return u.ONE;var I=c(),z=c(),F=x.convert(this),j=T(g)-1;for(F.copyTo(I);--j>=0;)if(x.sqrTo(I,z),(g&1<<j)>0)x.mulTo(z,F,I);else{var W=I;I=z,z=W}return x.revert(I)}function Ke(g,x){var I;return g<256||x.isEven()?I=new _e(x):I=new oe(x),this.exp(g,I)}u.prototype.copyTo=E,u.prototype.fromInt=M,u.prototype.fromString=k,u.prototype.clamp=D,u.prototype.dlShiftTo=$,u.prototype.drShiftTo=V,u.prototype.lShiftTo=G,u.prototype.rShiftTo=ee,u.prototype.subTo=ie,u.prototype.multiplyTo=me,u.prototype.squareTo=Me,u.prototype.divRemTo=Ae,u.prototype.invDigit=q,u.prototype.isEven=Ne,u.prototype.exp=st,u.prototype.toString=O,u.prototype.negate=B,u.prototype.abs=L,u.prototype.compareTo=R,u.prototype.bitLength=N,u.prototype.mod=le,u.prototype.modPowInt=Ke,u.ZERO=P(0),u.ONE=P(1);function J(){var g=c();return this.copyTo(g),g}function Z(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function fe(){return this.t==0?this.s:this[0]<<24>>24}function Fe(){return this.t==0?this.s:this[0]<<16>>16}function Ve(g){return Math.floor(Math.LN2*this.DB/Math.log(g))}function ze(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function Tt(g){if(g==null&&(g=10),this.signum()==0||g<2||g>36)return"0";var x=this.chunkSize(g),I=Math.pow(g,x),z=P(I),F=c(),j=c(),W="";for(this.divRemTo(z,F,j);F.signum()>0;)W=(I+j.intValue()).toString(g).substr(1)+W,F.divRemTo(z,F,j);return j.intValue().toString(g)+W}function ft(g,x){this.fromInt(0),x==null&&(x=10);for(var I=this.chunkSize(x),z=Math.pow(x,I),F=!1,j=0,W=0,re=0;re<g.length;++re){var ye=A(g,re);if(ye<0){g.charAt(re)=="-"&&this.signum()==0&&(F=!0);continue}W=x*W+ye,++j>=I&&(this.dMultiply(z),this.dAddOffset(W,0),j=0,W=0)}j>0&&(this.dMultiply(Math.pow(x,j)),this.dAddOffset(W,0)),F&&u.ZERO.subTo(this,this)}function St(g,x,I){if(typeof x=="number")if(g<2)this.fromInt(1);else for(this.fromNumber(g,I),this.testBit(g-1)||this.bitwiseTo(u.ONE.shiftLeft(g-1),vt,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(x);)this.dAddOffset(2,0),this.bitLength()>g&&this.subTo(u.ONE.shiftLeft(g-1),this);else{var z=new Array,F=g&7;z.length=(g>>3)+1,x.nextBytes(z),F>0?z[0]&=(1<<F)-1:z[0]=0,this.fromString(z,256)}}function nr(){var g=this.t,x=new Array;x[0]=this.s;var I=this.DB-g*this.DB%8,z,F=0;if(g-- >0)for(I<this.DB&&(z=this[g]>>I)!=(this.s&this.DM)>>I&&(x[F++]=z|this.s<<this.DB-I);g>=0;)I<8?(z=(this[g]&(1<<I)-1)<<8-I,z|=this[--g]>>(I+=this.DB-8)):(z=this[g]>>(I-=8)&255,I<=0&&(I+=this.DB,--g)),(z&128)!=0&&(z|=-256),F==0&&(this.s&128)!=(z&128)&&++F,(F>0||z!=this.s)&&(x[F++]=z);return x}function He(g){return this.compareTo(g)==0}function Ge(g){return this.compareTo(g)<0?this:g}function je(g){return this.compareTo(g)>0?this:g}function tt(g,x,I){var z,F,j=Math.min(g.t,this.t);for(z=0;z<j;++z)I[z]=x(this[z],g[z]);if(g.t<this.t){for(F=g.s&this.DM,z=j;z<this.t;++z)I[z]=x(this[z],F);I.t=this.t}else{for(F=this.s&this.DM,z=j;z<g.t;++z)I[z]=x(F,g[z]);I.t=g.t}I.s=x(this.s,g.s),I.clamp()}function Ze(g,x){return g&x}function At(g){var x=c();return this.bitwiseTo(g,Ze,x),x}function vt(g,x){return g|x}function Kt(g){var x=c();return this.bitwiseTo(g,vt,x),x}function he(g,x){return g^x}function ct(g){var x=c();return this.bitwiseTo(g,he,x),x}function De(g,x){return g&~x}function qe(g){var x=c();return this.bitwiseTo(g,De,x),x}function mt(){for(var g=c(),x=0;x<this.t;++x)g[x]=this.DM&~this[x];return g.t=this.t,g.s=~this.s,g}function Et(g){var x=c();return g<0?this.rShiftTo(-g,x):this.lShiftTo(g,x),x}function Wt(g){var x=c();return g<0?this.lShiftTo(-g,x):this.rShiftTo(g,x),x}function en(g){if(g==0)return-1;var x=0;return(g&65535)==0&&(g>>=16,x+=16),(g&255)==0&&(g>>=8,x+=8),(g&15)==0&&(g>>=4,x+=4),(g&3)==0&&(g>>=2,x+=2),(g&1)==0&&++x,x}function Ii(){for(var g=0;g<this.t;++g)if(this[g]!=0)return g*this.DB+en(this[g]);return this.s<0?this.t*this.DB:-1}function Zr(g){for(var x=0;g!=0;)g&=g-1,++x;return x}function Pn(){for(var g=0,x=this.s&this.DM,I=0;I<this.t;++I)g+=Zr(this[I]^x);return g}function Fa(g){var x=Math.floor(g/this.DB);return x>=this.t?this.s!=0:(this[x]&1<<g%this.DB)!=0}function Hu(g,x){var I=u.ONE.shiftLeft(g);return this.bitwiseTo(I,x,I),I}function ah(g){return this.changeBit(g,vt)}function Qi(g){return this.changeBit(g,De)}function Co(g){return this.changeBit(g,he)}function Mo(g,x){for(var I=0,z=0,F=Math.min(g.t,this.t);I<F;)z+=this[I]+g[I],x[I++]=z&this.DM,z>>=this.DB;if(g.t<this.t){for(z+=g.s;I<this.t;)z+=this[I],x[I++]=z&this.DM,z>>=this.DB;z+=this.s}else{for(z+=this.s;I<g.t;)z+=g[I],x[I++]=z&this.DM,z>>=this.DB;z+=g.s}x.s=z<0?-1:0,z>0?x[I++]=z:z<-1&&(x[I++]=this.DV+z),x.t=I,x.clamp()}function Xu(g){var x=c();return this.addTo(g,x),x}function Ts(g){var x=c();return this.subTo(g,x),x}function qu(g){var x=c();return this.multiplyTo(g,x),x}function ua(){var g=c();return this.squareTo(g),g}function Yu(g){var x=c();return this.divRemTo(g,x,null),x}function To(g){var x=c();return this.divRemTo(g,null,x),x}function oh(g){var x=c(),I=c();return this.divRemTo(g,x,I),new Array(x,I)}function sh(g){this[this.t]=this.am(0,g-1,this,0,0,this.t),++this.t,this.clamp()}function Pd(g,x){if(g!=0){for(;this.t<=x;)this[this.t++]=0;for(this[x]+=g;this[x]>=this.DV;)this[x]-=this.DV,++x>=this.t&&(this[this.t++]=0),++this[x]}}function se(){}function Pt(g){return g}function bt(g,x,I){g.multiplyTo(x,I)}function H(g,x){g.squareTo(x)}se.prototype.convert=Pt,se.prototype.revert=Pt,se.prototype.mulTo=bt,se.prototype.sqrTo=H;function pe(g){return this.exp(g,new se)}function be(g,x,I){var z=Math.min(this.t+g.t,x);for(I.s=0,I.t=z;z>0;)I[--z]=0;var F;for(F=I.t-this.t;z<F;++z)I[z+this.t]=this.am(0,g[z],I,z,0,this.t);for(F=Math.min(g.t,x);z<F;++z)this.am(0,g[z],I,z,0,x-z);I.clamp()}function Te(g,x,I){--x;var z=I.t=this.t+g.t-x;for(I.s=0;--z>=0;)I[z]=0;for(z=Math.max(x-this.t,0);z<g.t;++z)I[this.t+z-x]=this.am(x-z,g[z],I,0,0,this.t+z-x);I.clamp(),I.drShiftTo(1,I)}function de(g){this.r2=c(),this.q3=c(),u.ONE.dlShiftTo(2*g.t,this.r2),this.mu=this.r2.divide(g),this.m=g}function Ye(g){if(g.s<0||g.t>2*this.m.t)return g.mod(this.m);if(g.compareTo(this.m)<0)return g;var x=c();return g.copyTo(x),this.reduce(x),x}function Ct(g){return g}function _t(g){for(g.drShiftTo(this.m.t-1,this.r2),g.t>this.m.t+1&&(g.t=this.m.t+1,g.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);g.compareTo(this.r2)<0;)g.dAddOffset(1,this.m.t+1);for(g.subTo(this.r2,g);g.compareTo(this.m)>=0;)g.subTo(this.m,g)}function Ft(g,x){g.squareTo(x),this.reduce(x)}function or(g,x,I){g.multiplyTo(x,I),this.reduce(I)}de.prototype.convert=Ye,de.prototype.revert=Ct,de.prototype.reduce=_t,de.prototype.mulTo=or,de.prototype.sqrTo=Ft;function ur(g,x){var I=g.bitLength(),z,F=P(1),j;if(I<=0)return F;I<18?z=1:I<48?z=3:I<144?z=4:I<768?z=5:z=6,I<8?j=new _e(x):x.isEven()?j=new de(x):j=new oe(x);var W=new Array,re=3,ye=z-1,Pe=(1<<z)-1;if(W[1]=j.convert(this),z>1){var rt=c();for(j.sqrTo(W[1],rt);re<=Pe;)W[re]=c(),j.mulTo(rt,W[re-2],W[re]),re+=2}var yt=g.t-1,Bt,er=!0,Yt=c(),Cr;for(I=T(g[yt])-1;yt>=0;){for(I>=ye?Bt=g[yt]>>I-ye&Pe:(Bt=(g[yt]&(1<<I+1)-1)<<ye-I,yt>0&&(Bt|=g[yt-1]>>this.DB+I-ye)),re=z;(Bt&1)==0;)Bt>>=1,--re;if((I-=re)<0&&(I+=this.DB,--yt),er)W[Bt].copyTo(F),er=!1;else{for(;re>1;)j.sqrTo(F,Yt),j.sqrTo(Yt,F),re-=2;re>0?j.sqrTo(F,Yt):(Cr=F,F=Yt,Yt=Cr),j.mulTo(Yt,W[Bt],F)}for(;yt>=0&&(g[yt]&1<<I)==0;)j.sqrTo(F,Yt),Cr=F,F=Yt,Yt=Cr,--I<0&&(I=this.DB-1,--yt)}return j.revert(F)}function dr(g){var x=this.s<0?this.negate():this.clone(),I=g.s<0?g.negate():g.clone();if(x.compareTo(I)<0){var z=x;x=I,I=z}var F=x.getLowestSetBit(),j=I.getLowestSetBit();if(j<0)return x;for(F<j&&(j=F),j>0&&(x.rShiftTo(j,x),I.rShiftTo(j,I));x.signum()>0;)(F=x.getLowestSetBit())>0&&x.rShiftTo(F,x),(F=I.getLowestSetBit())>0&&I.rShiftTo(F,I),x.compareTo(I)>=0?(x.subTo(I,x),x.rShiftTo(1,x)):(I.subTo(x,I),I.rShiftTo(1,I));return j>0&&I.lShiftTo(j,I),I}function Wr(g){if(g<=0)return 0;var x=this.DV%g,I=this.s<0?g-1:0;if(this.t>0)if(x==0)I=this[0]%g;else for(var z=this.t-1;z>=0;--z)I=(x*I+this[z])%g;return I}function sn(g){var x=g.isEven();if(this.isEven()&&x||g.signum()==0)return u.ZERO;for(var I=g.clone(),z=this.clone(),F=P(1),j=P(0),W=P(0),re=P(1);I.signum()!=0;){for(;I.isEven();)I.rShiftTo(1,I),x?((!F.isEven()||!j.isEven())&&(F.addTo(this,F),j.subTo(g,j)),F.rShiftTo(1,F)):j.isEven()||j.subTo(g,j),j.rShiftTo(1,j);for(;z.isEven();)z.rShiftTo(1,z),x?((!W.isEven()||!re.isEven())&&(W.addTo(this,W),re.subTo(g,re)),W.rShiftTo(1,W)):re.isEven()||re.subTo(g,re),re.rShiftTo(1,re);I.compareTo(z)>=0?(I.subTo(z,I),x&&F.subTo(W,F),j.subTo(re,j)):(z.subTo(I,z),x&&W.subTo(F,W),re.subTo(j,re))}if(z.compareTo(u.ONE)!=0)return u.ZERO;if(re.compareTo(g)>=0)return re.subtract(g);if(re.signum()<0)re.addTo(g,re);else return re;return re.signum()<0?re.add(g):re}var $r=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],ln=(1<<26)/$r[$r.length-1];function gn(g){var x,I=this.abs();if(I.t==1&&I[0]<=$r[$r.length-1]){for(x=0;x<$r.length;++x)if(I[0]==$r[x])return!0;return!1}if(I.isEven())return!1;for(x=1;x<$r.length;){for(var z=$r[x],F=x+1;F<$r.length&&z<ln;)z*=$r[F++];for(z=I.modInt(z);x<F;)if(z%$r[x++]==0)return!1}return I.millerRabin(g)}function Qt(g){var x=this.subtract(u.ONE),I=x.getLowestSetBit();if(I<=0)return!1;var z=x.shiftRight(I);g=g+1>>1,g>$r.length&&(g=$r.length);for(var F=c(),j=0;j<g;++j){F.fromInt($r[Math.floor(Math.random()*$r.length)]);var W=F.modPow(z,this);if(W.compareTo(u.ONE)!=0&&W.compareTo(x)!=0){for(var re=1;re++<I&&W.compareTo(x)!=0;)if(W=W.modPowInt(2,this),W.compareTo(u.ONE)==0)return!1;if(W.compareTo(x)!=0)return!1}}return!0}u.prototype.chunkSize=Ve,u.prototype.toRadix=Tt,u.prototype.fromRadix=ft,u.prototype.fromNumber=St,u.prototype.bitwiseTo=tt,u.prototype.changeBit=Hu,u.prototype.addTo=Mo,u.prototype.dMultiply=sh,u.prototype.dAddOffset=Pd,u.prototype.multiplyLowerTo=be,u.prototype.multiplyUpperTo=Te,u.prototype.modInt=Wr,u.prototype.millerRabin=Qt,u.prototype.clone=J,u.prototype.intValue=Z,u.prototype.byteValue=fe,u.prototype.shortValue=Fe,u.prototype.signum=ze,u.prototype.toByteArray=nr,u.prototype.equals=He,u.prototype.min=Ge,u.prototype.max=je,u.prototype.and=At,u.prototype.or=Kt,u.prototype.xor=ct,u.prototype.andNot=qe,u.prototype.not=mt,u.prototype.shiftLeft=Et,u.prototype.shiftRight=Wt,u.prototype.getLowestSetBit=Ii,u.prototype.bitCount=Pn,u.prototype.testBit=Fa,u.prototype.setBit=ah,u.prototype.clearBit=Qi,u.prototype.flipBit=Co,u.prototype.add=Xu,u.prototype.subtract=Ts,u.prototype.multiply=qu,u.prototype.divide=Yu,u.prototype.remainder=To,u.prototype.divideAndRemainder=oh,u.prototype.modPow=ur,u.prototype.modInverse=sn,u.prototype.pow=pe,u.prototype.gcd=dr,u.prototype.isProbablePrime=gn,u.prototype.square=ua;var qt=u;qt.prototype.IsNegative=function(){return this.compareTo(qt.ZERO)==-1},qt.op_Equality=function(g,x){return g.compareTo(x)==0},qt.op_Inequality=function(g,x){return g.compareTo(x)!=0},qt.op_GreaterThan=function(g,x){return g.compareTo(x)>0},qt.op_LessThan=function(g,x){return g.compareTo(x)<0},qt.op_Addition=function(g,x){return new qt(g).add(new qt(x))},qt.op_Subtraction=function(g,x){return new qt(g).subtract(new qt(x))},qt.Int128Mul=function(g,x){return new qt(g).multiply(new qt(x))},qt.op_Division=function(g,x){return g.divide(x)},qt.prototype.ToDouble=function(){return parseFloat(this.toString())},typeof Po>"u"&&(Po=function(g,x){var I;if(typeof Object.getOwnPropertyNames>"u"){for(I in x.prototype)(typeof g.prototype[I]>"u"||g.prototype[I]==Object.prototype[I])&&(g.prototype[I]=x.prototype[I]);for(I in x)typeof g[I]>"u"&&(g[I]=x[I]);g.$baseCtor=x}else{for(var z=Object.getOwnPropertyNames(x.prototype),F=0;F<z.length;F++)typeof Object.getOwnPropertyDescriptor(g.prototype,z[F])>"u"&&Object.defineProperty(g.prototype,z[F],Object.getOwnPropertyDescriptor(x.prototype,z[F]));for(I in x)typeof g[I]>"u"&&(g[I]=x[I]);g.$baseCtor=x}});var Po;n.Path=function(){return[]},n.Paths=function(){return[]},n.DoublePoint=function(){var g=arguments;this.X=0,this.Y=0,g.length==1?(this.X=g[0].X,this.Y=g[0].Y):g.length==2&&(this.X=g[0],this.Y=g[1])},n.DoublePoint0=function(){this.X=0,this.Y=0},n.DoublePoint1=function(g){this.X=g.X,this.Y=g.Y},n.DoublePoint2=function(g,x){this.X=g,this.Y=x},n.PolyNode=function(){this.m_Parent=null,this.m_polygon=new n.Path,this.m_Index=0,this.m_jointype=0,this.m_endtype=0,this.m_Childs=[],this.IsOpen=!1},n.PolyNode.prototype.IsHoleNode=function(){for(var g=!0,x=this.m_Parent;x!==null;)g=!g,x=x.m_Parent;return g},n.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length},n.PolyNode.prototype.Contour=function(){return this.m_polygon},n.PolyNode.prototype.AddChild=function(g){var x=this.m_Childs.length;this.m_Childs.push(g),g.m_Parent=this,g.m_Index=x},n.PolyNode.prototype.GetNext=function(){return this.m_Childs.length>0?this.m_Childs[0]:this.GetNextSiblingUp()},n.PolyNode.prototype.GetNextSiblingUp=function(){return this.m_Parent===null?null:this.m_Index==this.m_Parent.m_Childs.length-1?this.m_Parent.GetNextSiblingUp():this.m_Parent.m_Childs[this.m_Index+1]},n.PolyNode.prototype.Childs=function(){return this.m_Childs},n.PolyNode.prototype.Parent=function(){return this.m_Parent},n.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()},n.PolyTree=function(){this.m_AllPolys=[],n.PolyNode.call(this)},n.PolyTree.prototype.Clear=function(){for(var g=0,x=this.m_AllPolys.length;g<x;g++)this.m_AllPolys[g]=null;this.m_AllPolys.length=0,this.m_Childs.length=0},n.PolyTree.prototype.GetFirst=function(){return this.m_Childs.length>0?this.m_Childs[0]:null},n.PolyTree.prototype.Total=function(){return this.m_AllPolys.length},Po(n.PolyTree,n.PolyNode),n.Math_Abs_Int64=n.Math_Abs_Int32=n.Math_Abs_Double=function(g){return Math.abs(g)},n.Math_Max_Int32_Int32=function(g,x){return Math.max(g,x)},s.msie||s.opera||s.safari?n.Cast_Int32=function(g){return g|0}:n.Cast_Int32=function(g){return~~g},s.chrome?n.Cast_Int64=function(g){return g<-2147483648||g>2147483647?g<0?Math.ceil(g):Math.floor(g):~~g}:s.firefox&&typeof Number.toInteger=="function"?n.Cast_Int64=function(g){return Number.toInteger(g)}:s.msie7||s.msie8?n.Cast_Int64=function(g){return parseInt(g,10)}:s.msie?n.Cast_Int64=function(g){return g<-2147483648||g>2147483647?g<0?Math.ceil(g):Math.floor(g):g|0}:n.Cast_Int64=function(g){return g<0?Math.ceil(g):Math.floor(g)},n.Clear=function(g){g.length=0},n.PI=3.141592653589793,n.PI2=2*3.141592653589793,n.IntPoint=function(){var g=arguments,x=g.length,I,z;if(this.X=0,this.Y=0,!r)if(x==2)this.X=g[0],this.Y=g[1];else if(x==1)if(g[0]instanceof n.DoublePoint){var I=g[0];this.X=n.Clipper.Round(I.X),this.Y=n.Clipper.Round(I.Y)}else{var z=g[0];this.X=z.X,this.Y=z.Y}else this.X=0,this.Y=0},n.IntPoint.op_Equality=function(g,x){return g.X==x.X&&g.Y==x.Y},n.IntPoint.op_Inequality=function(g,x){return g.X!=x.X||g.Y!=x.Y},n.IntPoint0=function(){this.X=0,this.Y=0},n.IntPoint1=function(g){this.X=g.X,this.Y=g.Y},n.IntPoint1dp=function(g){this.X=n.Clipper.Round(g.X),this.Y=n.Clipper.Round(g.Y)},n.IntPoint2=function(g,x){this.X=g,this.Y=x},n.IntRect=function(){var g=arguments,x=g.length;x==4?(this.left=g[0],this.top=g[1],this.right=g[2],this.bottom=g[3]):x==1?(this.left=ir.left,this.top=ir.top,this.right=ir.right,this.bottom=ir.bottom):(this.left=0,this.top=0,this.right=0,this.bottom=0)},n.IntRect0=function(){this.left=0,this.top=0,this.right=0,this.bottom=0},n.IntRect1=function(g){this.left=g.left,this.top=g.top,this.right=g.right,this.bottom=g.bottom},n.IntRect4=function(g,x,I,z){this.left=g,this.top=x,this.right=I,this.bottom=z},n.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3},n.PolyType={ptSubject:0,ptClip:1},n.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3},n.JoinType={jtSquare:0,jtRound:1,jtMiter:2},n.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4},n.EdgeSide={esLeft:0,esRight:1},n.Direction={dRightToLeft:0,dLeftToRight:1},n.TEdge=function(){this.Bot=new n.IntPoint,this.Curr=new n.IntPoint,this.Top=new n.IntPoint,this.Delta=new n.IntPoint,this.Dx=0,this.PolyTyp=n.PolyType.ptSubject,this.Side=n.EdgeSide.esLeft,this.WindDelta=0,this.WindCnt=0,this.WindCnt2=0,this.OutIdx=0,this.Next=null,this.Prev=null,this.NextInLML=null,this.NextInAEL=null,this.PrevInAEL=null,this.NextInSEL=null,this.PrevInSEL=null},n.IntersectNode=function(){this.Edge1=null,this.Edge2=null,this.Pt=new n.IntPoint},n.MyIntersectNodeSort=function(){},n.MyIntersectNodeSort.Compare=function(g,x){return x.Pt.Y-g.Pt.Y},n.LocalMinima=function(){this.Y=0,this.LeftBound=null,this.RightBound=null,this.Next=null},n.Scanbeam=function(){this.Y=0,this.Next=null},n.OutRec=function(){this.Idx=0,this.IsHole=!1,this.IsOpen=!1,this.FirstLeft=null,this.Pts=null,this.BottomPt=null,this.PolyNode=null},n.OutPt=function(){this.Idx=0,this.Pt=new n.IntPoint,this.Next=null,this.Prev=null},n.Join=function(){this.OutPt1=null,this.OutPt2=null,this.OffPt=new n.IntPoint},n.ClipperBase=function(){this.m_MinimaList=null,this.m_CurrentLM=null,this.m_edges=new Array,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1,this.PreserveCollinear=!1,this.m_MinimaList=null,this.m_CurrentLM=null,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},n.ClipperBase.horizontal=-9007199254740992,n.ClipperBase.Skip=-2,n.ClipperBase.Unassigned=-1,n.ClipperBase.tolerance=1e-20,n.ClipperBase.loRange=47453132,n.ClipperBase.hiRange=0xfffffffffffff,n.ClipperBase.near_zero=function(g){return g>-n.ClipperBase.tolerance&&g<n.ClipperBase.tolerance},n.ClipperBase.IsHorizontal=function(g){return g.Delta.Y===0},n.ClipperBase.prototype.PointIsVertex=function(g,x){var I=x;do{if(n.IntPoint.op_Equality(I.Pt,g))return!0;I=I.Next}while(I!=x);return!1},n.ClipperBase.prototype.PointOnLineSegment=function(g,x,I,z){return z?g.X==x.X&&g.Y==x.Y||g.X==I.X&&g.Y==I.Y||g.X>x.X==g.X<I.X&&g.Y>x.Y==g.Y<I.Y&&qt.op_Equality(qt.Int128Mul(g.X-x.X,I.Y-x.Y),qt.Int128Mul(I.X-x.X,g.Y-x.Y)):g.X==x.X&&g.Y==x.Y||g.X==I.X&&g.Y==I.Y||g.X>x.X==g.X<I.X&&g.Y>x.Y==g.Y<I.Y&&(g.X-x.X)*(I.Y-x.Y)==(I.X-x.X)*(g.Y-x.Y)},n.ClipperBase.prototype.PointOnPolygon=function(g,x,I){for(var z=x;;){if(this.PointOnLineSegment(g,z.Pt,z.Next.Pt,I))return!0;if(z=z.Next,z==x)break}return!1},n.ClipperBase.prototype.SlopesEqual=n.ClipperBase.SlopesEqual=function(){var g=arguments,x=g.length,I,z,F,j,W,re,ye;return x==3?(I=g[0],z=g[1],ye=g[2],ye?qt.op_Equality(qt.Int128Mul(I.Delta.Y,z.Delta.X),qt.Int128Mul(I.Delta.X,z.Delta.Y)):n.Cast_Int64(I.Delta.Y*z.Delta.X)==n.Cast_Int64(I.Delta.X*z.Delta.Y)):x==4?(F=g[0],j=g[1],W=g[2],ye=g[3],ye?qt.op_Equality(qt.Int128Mul(F.Y-j.Y,j.X-W.X),qt.Int128Mul(F.X-j.X,j.Y-W.Y)):n.Cast_Int64((F.Y-j.Y)*(j.X-W.X))-n.Cast_Int64((F.X-j.X)*(j.Y-W.Y))===0):(F=g[0],j=g[1],W=g[2],re=g[3],ye=g[4],ye?qt.op_Equality(qt.Int128Mul(F.Y-j.Y,W.X-re.X),qt.Int128Mul(F.X-j.X,W.Y-re.Y)):n.Cast_Int64((F.Y-j.Y)*(W.X-re.X))-n.Cast_Int64((F.X-j.X)*(W.Y-re.Y))===0)},n.ClipperBase.SlopesEqual3=function(g,x,I){return I?qt.op_Equality(qt.Int128Mul(g.Delta.Y,x.Delta.X),qt.Int128Mul(g.Delta.X,x.Delta.Y)):n.Cast_Int64(g.Delta.Y*x.Delta.X)==n.Cast_Int64(g.Delta.X*x.Delta.Y)},n.ClipperBase.SlopesEqual4=function(g,x,I,z){return z?qt.op_Equality(qt.Int128Mul(g.Y-x.Y,x.X-I.X),qt.Int128Mul(g.X-x.X,x.Y-I.Y)):n.Cast_Int64((g.Y-x.Y)*(x.X-I.X))-n.Cast_Int64((g.X-x.X)*(x.Y-I.Y))===0},n.ClipperBase.SlopesEqual5=function(g,x,I,z,F){return F?qt.op_Equality(qt.Int128Mul(g.Y-x.Y,I.X-z.X),qt.Int128Mul(g.X-x.X,I.Y-z.Y)):n.Cast_Int64((g.Y-x.Y)*(I.X-z.X))-n.Cast_Int64((g.X-x.X)*(I.Y-z.Y))===0},n.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var g=0,x=this.m_edges.length;g<x;++g){for(var I=0,z=this.m_edges[g].length;I<z;++I)this.m_edges[g][I]=null;n.Clear(this.m_edges[g])}n.Clear(this.m_edges),this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},n.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;this.m_MinimaList!==null;){var g=this.m_MinimaList.Next;this.m_MinimaList=null,this.m_MinimaList=g}this.m_CurrentLM=null},n.ClipperBase.prototype.RangeTest=function(g,x){x.Value?(g.X>n.ClipperBase.hiRange||g.Y>n.ClipperBase.hiRange||-g.X>n.ClipperBase.hiRange||-g.Y>n.ClipperBase.hiRange)&&n.Error("Coordinate outside allowed range in RangeTest()."):(g.X>n.ClipperBase.loRange||g.Y>n.ClipperBase.loRange||-g.X>n.ClipperBase.loRange||-g.Y>n.ClipperBase.loRange)&&(x.Value=!0,this.RangeTest(g,x))},n.ClipperBase.prototype.InitEdge=function(g,x,I,z){g.Next=x,g.Prev=I,g.Curr.X=z.X,g.Curr.Y=z.Y,g.OutIdx=-1},n.ClipperBase.prototype.InitEdge2=function(g,x){g.Curr.Y>=g.Next.Curr.Y?(g.Bot.X=g.Curr.X,g.Bot.Y=g.Curr.Y,g.Top.X=g.Next.Curr.X,g.Top.Y=g.Next.Curr.Y):(g.Top.X=g.Curr.X,g.Top.Y=g.Curr.Y,g.Bot.X=g.Next.Curr.X,g.Bot.Y=g.Next.Curr.Y),this.SetDx(g),g.PolyTyp=x},n.ClipperBase.prototype.FindNextLocMin=function(g){for(var x;;){for(;n.IntPoint.op_Inequality(g.Bot,g.Prev.Bot)||n.IntPoint.op_Equality(g.Curr,g.Top);)g=g.Next;if(g.Dx!=n.ClipperBase.horizontal&&g.Prev.Dx!=n.ClipperBase.horizontal)break;for(;g.Prev.Dx==n.ClipperBase.horizontal;)g=g.Prev;for(x=g;g.Dx==n.ClipperBase.horizontal;)g=g.Next;if(g.Top.Y!=g.Prev.Bot.Y){x.Prev.Bot.X<g.Bot.X&&(g=x);break}}return g},n.ClipperBase.prototype.ProcessBound=function(g,x){var I=g,z=g,F,j;if(g.Dx==n.ClipperBase.horizontal&&(x?j=g.Prev.Bot.X:j=g.Next.Bot.X,g.Bot.X!=j&&this.ReverseHorizontal(g)),z.OutIdx!=n.ClipperBase.Skip)if(x){for(;z.Top.Y==z.Next.Bot.Y&&z.Next.OutIdx!=n.ClipperBase.Skip;)z=z.Next;if(z.Dx==n.ClipperBase.horizontal&&z.Next.OutIdx!=n.ClipperBase.Skip){for(F=z;F.Prev.Dx==n.ClipperBase.horizontal;)F=F.Prev;F.Prev.Top.X==z.Next.Top.X?x||(z=F.Prev):F.Prev.Top.X>z.Next.Top.X&&(z=F.Prev)}for(;g!=z;)g.NextInLML=g.Next,g.Dx==n.ClipperBase.horizontal&&g!=I&&g.Bot.X!=g.Prev.Top.X&&this.ReverseHorizontal(g),g=g.Next;g.Dx==n.ClipperBase.horizontal&&g!=I&&g.Bot.X!=g.Prev.Top.X&&this.ReverseHorizontal(g),z=z.Next}else{for(;z.Top.Y==z.Prev.Bot.Y&&z.Prev.OutIdx!=n.ClipperBase.Skip;)z=z.Prev;if(z.Dx==n.ClipperBase.horizontal&&z.Prev.OutIdx!=n.ClipperBase.Skip){for(F=z;F.Next.Dx==n.ClipperBase.horizontal;)F=F.Next;F.Next.Top.X==z.Prev.Top.X?x||(z=F.Next):F.Next.Top.X>z.Prev.Top.X&&(z=F.Next)}for(;g!=z;)g.NextInLML=g.Prev,g.Dx==n.ClipperBase.horizontal&&g!=I&&g.Bot.X!=g.Next.Top.X&&this.ReverseHorizontal(g),g=g.Prev;g.Dx==n.ClipperBase.horizontal&&g!=I&&g.Bot.X!=g.Next.Top.X&&this.ReverseHorizontal(g),z=z.Prev}if(z.OutIdx==n.ClipperBase.Skip){if(g=z,x){for(;g.Top.Y==g.Next.Bot.Y;)g=g.Next;for(;g!=z&&g.Dx==n.ClipperBase.horizontal;)g=g.Prev}else{for(;g.Top.Y==g.Prev.Bot.Y;)g=g.Prev;for(;g!=z&&g.Dx==n.ClipperBase.horizontal;)g=g.Next}if(g==z)x?z=g.Next:z=g.Prev;else{x?g=z.Next:g=z.Prev;var W=new n.LocalMinima;W.Next=null,W.Y=g.Bot.Y,W.LeftBound=null,W.RightBound=g,W.RightBound.WindDelta=0,z=this.ProcessBound(W.RightBound,x),this.InsertLocalMinima(W)}}return z},n.ClipperBase.prototype.AddPath=function(g,x,I){!I&&x==n.PolyType.ptClip&&n.Error("AddPath: Open paths must be subject.");var z=g.length-1;if(I)for(;z>0&&n.IntPoint.op_Equality(g[z],g[0]);)--z;for(;z>0&&n.IntPoint.op_Equality(g[z],g[z-1]);)--z;if(I&&z<2||!I&&z<1)return!1;for(var F=new Array,j=0;j<=z;j++)F.push(new n.TEdge);var W=!0;F[1].Curr.X=g[1].X,F[1].Curr.Y=g[1].Y;var re={Value:this.m_UseFullRange};this.RangeTest(g[0],re),this.m_UseFullRange=re.Value,re.Value=this.m_UseFullRange,this.RangeTest(g[z],re),this.m_UseFullRange=re.Value,this.InitEdge(F[0],F[1],F[z],g[0]),this.InitEdge(F[z],F[0],F[z-1],g[z]);for(var j=z-1;j>=1;--j)re.Value=this.m_UseFullRange,this.RangeTest(g[j],re),this.m_UseFullRange=re.Value,this.InitEdge(F[j],F[j+1],F[j-1],g[j]);for(var ye=F[0],Pe=ye,rt=ye;;){if(n.IntPoint.op_Equality(Pe.Curr,Pe.Next.Curr)){if(Pe==Pe.Next)break;Pe==ye&&(ye=Pe.Next),Pe=this.RemoveEdge(Pe),rt=Pe;continue}if(Pe.Prev==Pe.Next)break;if(I&&n.ClipperBase.SlopesEqual(Pe.Prev.Curr,Pe.Curr,Pe.Next.Curr,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(Pe.Prev.Curr,Pe.Curr,Pe.Next.Curr))){Pe==ye&&(ye=Pe.Next),Pe=this.RemoveEdge(Pe),Pe=Pe.Prev,rt=Pe;continue}if(Pe=Pe.Next,Pe==rt)break}if(!I&&Pe==Pe.Next||I&&Pe.Prev==Pe.Next)return!1;I||(this.m_HasOpenPaths=!0,ye.Prev.OutIdx=n.ClipperBase.Skip),Pe=ye;do this.InitEdge2(Pe,x),Pe=Pe.Next,W&&Pe.Curr.Y!=ye.Curr.Y&&(W=!1);while(Pe!=ye);if(W){if(I)return!1;Pe.Prev.OutIdx=n.ClipperBase.Skip,Pe.Prev.Bot.X<Pe.Prev.Top.X&&this.ReverseHorizontal(Pe.Prev);var yt=new n.LocalMinima;for(yt.Next=null,yt.Y=Pe.Bot.Y,yt.LeftBound=null,yt.RightBound=Pe,yt.RightBound.Side=n.EdgeSide.esRight,yt.RightBound.WindDelta=0;Pe.Next.OutIdx!=n.ClipperBase.Skip;)Pe.NextInLML=Pe.Next,Pe.Bot.X!=Pe.Prev.Top.X&&this.ReverseHorizontal(Pe),Pe=Pe.Next;return this.InsertLocalMinima(yt),this.m_edges.push(F),!0}this.m_edges.push(F);for(var Bt,er=null;Pe=this.FindNextLocMin(Pe),Pe!=er;){er==null&&(er=Pe);var yt=new n.LocalMinima;yt.Next=null,yt.Y=Pe.Bot.Y,Pe.Dx<Pe.Prev.Dx?(yt.LeftBound=Pe.Prev,yt.RightBound=Pe,Bt=!1):(yt.LeftBound=Pe,yt.RightBound=Pe.Prev,Bt=!0),yt.LeftBound.Side=n.EdgeSide.esLeft,yt.RightBound.Side=n.EdgeSide.esRight,I?yt.LeftBound.Next==yt.RightBound?yt.LeftBound.WindDelta=-1:yt.LeftBound.WindDelta=1:yt.LeftBound.WindDelta=0,yt.RightBound.WindDelta=-yt.LeftBound.WindDelta,Pe=this.ProcessBound(yt.LeftBound,Bt);var Yt=this.ProcessBound(yt.RightBound,!Bt);yt.LeftBound.OutIdx==n.ClipperBase.Skip?yt.LeftBound=null:yt.RightBound.OutIdx==n.ClipperBase.Skip&&(yt.RightBound=null),this.InsertLocalMinima(yt),Bt||(Pe=Yt)}return!0},n.ClipperBase.prototype.AddPaths=function(g,x,I){for(var z=!1,F=0,j=g.length;F<j;++F)this.AddPath(g[F],x,I)&&(z=!0);return z},n.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=function(g,x,I){return n.IntPoint.op_Equality(g,I)||n.IntPoint.op_Equality(g,x)||n.IntPoint.op_Equality(I,x)?!1:g.X!=I.X?x.X>g.X==x.X<I.X:x.Y>g.Y==x.Y<I.Y},n.ClipperBase.prototype.RemoveEdge=function(g){g.Prev.Next=g.Next,g.Next.Prev=g.Prev;var x=g.Next;return g.Prev=null,x},n.ClipperBase.prototype.SetDx=function(g){g.Delta.X=g.Top.X-g.Bot.X,g.Delta.Y=g.Top.Y-g.Bot.Y,g.Delta.Y===0?g.Dx=n.ClipperBase.horizontal:g.Dx=g.Delta.X/g.Delta.Y},n.ClipperBase.prototype.InsertLocalMinima=function(g){if(this.m_MinimaList===null)this.m_MinimaList=g;else if(g.Y>=this.m_MinimaList.Y)g.Next=this.m_MinimaList,this.m_MinimaList=g;else{for(var x=this.m_MinimaList;x.Next!==null&&g.Y<x.Next.Y;)x=x.Next;g.Next=x.Next,x.Next=g}},n.ClipperBase.prototype.PopLocalMinima=function(){this.m_CurrentLM!==null&&(this.m_CurrentLM=this.m_CurrentLM.Next)},n.ClipperBase.prototype.ReverseHorizontal=function(g){var x=g.Top.X;g.Top.X=g.Bot.X,g.Bot.X=x},n.ClipperBase.prototype.Reset=function(){if(this.m_CurrentLM=this.m_MinimaList,this.m_CurrentLM!=null)for(var g=this.m_MinimaList;g!=null;){var x=g.LeftBound;x!=null&&(x.Curr.X=x.Bot.X,x.Curr.Y=x.Bot.Y,x.Side=n.EdgeSide.esLeft,x.OutIdx=n.ClipperBase.Unassigned),x=g.RightBound,x!=null&&(x.Curr.X=x.Bot.X,x.Curr.Y=x.Bot.Y,x.Side=n.EdgeSide.esRight,x.OutIdx=n.ClipperBase.Unassigned),g=g.Next}},n.Clipper=function(g){typeof g>"u"&&(g=0),this.m_PolyOuts=null,this.m_ClipType=n.ClipType.ctIntersection,this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=null,this.m_IntersectNodeComparer=null,this.m_ExecuteLocked=!1,this.m_ClipFillType=n.PolyFillType.pftEvenOdd,this.m_SubjFillType=n.PolyFillType.pftEvenOdd,this.m_Joins=null,this.m_GhostJoins=null,this.m_UsingPolyTree=!1,this.ReverseSolution=!1,this.StrictlySimple=!1,n.ClipperBase.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=new Array,this.m_IntersectNodeComparer=n.MyIntersectNodeSort.Compare,this.m_ExecuteLocked=!1,this.m_UsingPolyTree=!1,this.m_PolyOuts=new Array,this.m_Joins=new Array,this.m_GhostJoins=new Array,this.ReverseSolution=(1&g)!==0,this.StrictlySimple=(2&g)!==0,this.PreserveCollinear=(4&g)!==0},n.Clipper.ioReverseSolution=1,n.Clipper.ioStrictlySimple=2,n.Clipper.ioPreserveCollinear=4,n.Clipper.prototype.Clear=function(){this.m_edges.length!==0&&(this.DisposeAllPolyPts(),n.ClipperBase.prototype.Clear.call(this))},n.Clipper.prototype.DisposeScanbeamList=function(){for(;this.m_Scanbeam!==null;){var g=this.m_Scanbeam.Next;this.m_Scanbeam=null,this.m_Scanbeam=g}},n.Clipper.prototype.Reset=function(){n.ClipperBase.prototype.Reset.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null;for(var g=this.m_MinimaList;g!==null;)this.InsertScanbeam(g.Y),g=g.Next},n.Clipper.prototype.InsertScanbeam=function(g){if(this.m_Scanbeam===null)this.m_Scanbeam=new n.Scanbeam,this.m_Scanbeam.Next=null,this.m_Scanbeam.Y=g;else if(g>this.m_Scanbeam.Y){var x=new n.Scanbeam;x.Y=g,x.Next=this.m_Scanbeam,this.m_Scanbeam=x}else{for(var I=this.m_Scanbeam;I.Next!==null&&g<=I.Next.Y;)I=I.Next;if(g==I.Y)return;var x=new n.Scanbeam;x.Y=g,x.Next=I.Next,I.Next=x}},n.Clipper.prototype.Execute=function(){var g=arguments,x=g.length,I=g[1]instanceof n.PolyTree;if(x==4&&!I){var z=g[0],F=g[1],j=g[2],W=g[3];if(this.m_ExecuteLocked)return!1;this.m_HasOpenPaths&&n.Error("Error: PolyTree struct is need for open path clipping."),this.m_ExecuteLocked=!0,n.Clear(F),this.m_SubjFillType=j,this.m_ClipFillType=W,this.m_ClipType=z,this.m_UsingPolyTree=!1;try{var re=this.ExecuteInternal();re&&this.BuildResult(F)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return re}else if(x==4&&I){var z=g[0],ye=g[1],j=g[2],W=g[3];if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0,this.m_SubjFillType=j,this.m_ClipFillType=W,this.m_ClipType=z,this.m_UsingPolyTree=!0;try{var re=this.ExecuteInternal();re&&this.BuildResult2(ye)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return re}else if(x==2&&!I){var z=g[0],F=g[1];return this.Execute(z,F,n.PolyFillType.pftEvenOdd,n.PolyFillType.pftEvenOdd)}else if(x==2&&I){var z=g[0],ye=g[1];return this.Execute(z,ye,n.PolyFillType.pftEvenOdd,n.PolyFillType.pftEvenOdd)}},n.Clipper.prototype.FixHoleLinkage=function(g){if(!(g.FirstLeft===null||g.IsHole!=g.FirstLeft.IsHole&&g.FirstLeft.Pts!==null)){for(var x=g.FirstLeft;x!==null&&(x.IsHole==g.IsHole||x.Pts===null);)x=x.FirstLeft;g.FirstLeft=x}},n.Clipper.prototype.ExecuteInternal=function(){try{if(this.Reset(),this.m_CurrentLM===null)return!1;var g=this.PopScanbeam();do{if(this.InsertLocalMinimaIntoAEL(g),n.Clear(this.m_GhostJoins),this.ProcessHorizontals(!1),this.m_Scanbeam===null)break;var x=this.PopScanbeam();if(!this.ProcessIntersections(g,x))return!1;this.ProcessEdgesAtTopOfScanbeam(x),g=x}while(this.m_Scanbeam!==null||this.m_CurrentLM!==null);for(var I=0,z=this.m_PolyOuts.length;I<z;I++){var F=this.m_PolyOuts[I];F.Pts===null||F.IsOpen||(F.IsHole^this.ReverseSolution)==this.Area(F)>0&&this.ReversePolyPtLinks(F.Pts)}this.JoinCommonEdges();for(var I=0,z=this.m_PolyOuts.length;I<z;I++){var F=this.m_PolyOuts[I];F.Pts!==null&&!F.IsOpen&&this.FixupOutPolygon(F)}return this.StrictlySimple&&this.DoSimplePolygons(),!0}finally{n.Clear(this.m_Joins),n.Clear(this.m_GhostJoins)}},n.Clipper.prototype.PopScanbeam=function(){var g=this.m_Scanbeam.Y;return this.m_Scanbeam,this.m_Scanbeam=this.m_Scanbeam.Next,g},n.Clipper.prototype.DisposeAllPolyPts=function(){for(var g=0,x=this.m_PolyOuts.length;g<x;++g)this.DisposeOutRec(g);n.Clear(this.m_PolyOuts)},n.Clipper.prototype.DisposeOutRec=function(g){var x=this.m_PolyOuts[g];x.Pts!==null&&this.DisposeOutPts(x.Pts),x=null,this.m_PolyOuts[g]=null},n.Clipper.prototype.DisposeOutPts=function(g){if(g!==null)for(g.Prev.Next=null;g!==null;)g=g.Next},n.Clipper.prototype.AddJoin=function(g,x,I){var z=new n.Join;z.OutPt1=g,z.OutPt2=x,z.OffPt.X=I.X,z.OffPt.Y=I.Y,this.m_Joins.push(z)},n.Clipper.prototype.AddGhostJoin=function(g,x){var I=new n.Join;I.OutPt1=g,I.OffPt.X=x.X,I.OffPt.Y=x.Y,this.m_GhostJoins.push(I)},n.Clipper.prototype.InsertLocalMinimaIntoAEL=function(g){for(;this.m_CurrentLM!==null&&this.m_CurrentLM.Y==g;){var x=this.m_CurrentLM.LeftBound,I=this.m_CurrentLM.RightBound;this.PopLocalMinima();var z=null;if(x===null?(this.InsertEdgeIntoAEL(I,null),this.SetWindingCount(I),this.IsContributing(I)&&(z=this.AddOutPt(I,I.Bot))):I==null?(this.InsertEdgeIntoAEL(x,null),this.SetWindingCount(x),this.IsContributing(x)&&(z=this.AddOutPt(x,x.Bot)),this.InsertScanbeam(x.Top.Y)):(this.InsertEdgeIntoAEL(x,null),this.InsertEdgeIntoAEL(I,x),this.SetWindingCount(x),I.WindCnt=x.WindCnt,I.WindCnt2=x.WindCnt2,this.IsContributing(x)&&(z=this.AddLocalMinPoly(x,I,x.Bot)),this.InsertScanbeam(x.Top.Y)),I!=null&&(n.ClipperBase.IsHorizontal(I)?this.AddEdgeToSEL(I):this.InsertScanbeam(I.Top.Y)),!(x==null||I==null)){if(z!==null&&n.ClipperBase.IsHorizontal(I)&&this.m_GhostJoins.length>0&&I.WindDelta!==0)for(var F=0,j=this.m_GhostJoins.length;F<j;F++){var W=this.m_GhostJoins[F];this.HorzSegmentsOverlap(W.OutPt1.Pt,W.OffPt,I.Bot,I.Top)&&this.AddJoin(W.OutPt1,z,W.OffPt)}if(x.OutIdx>=0&&x.PrevInAEL!==null&&x.PrevInAEL.Curr.X==x.Bot.X&&x.PrevInAEL.OutIdx>=0&&n.ClipperBase.SlopesEqual(x.PrevInAEL,x,this.m_UseFullRange)&&x.WindDelta!==0&&x.PrevInAEL.WindDelta!==0){var re=this.AddOutPt(x.PrevInAEL,x.Bot);this.AddJoin(z,re,x.Top)}if(x.NextInAEL!=I){if(I.OutIdx>=0&&I.PrevInAEL.OutIdx>=0&&n.ClipperBase.SlopesEqual(I.PrevInAEL,I,this.m_UseFullRange)&&I.WindDelta!==0&&I.PrevInAEL.WindDelta!==0){var re=this.AddOutPt(I.PrevInAEL,I.Bot);this.AddJoin(z,re,I.Top)}var ye=x.NextInAEL;if(ye!==null)for(;ye!=I;)this.IntersectEdges(I,ye,x.Curr,!1),ye=ye.NextInAEL}}}},n.Clipper.prototype.InsertEdgeIntoAEL=function(g,x){if(this.m_ActiveEdges===null)g.PrevInAEL=null,g.NextInAEL=null,this.m_ActiveEdges=g;else if(x===null&&this.E2InsertsBeforeE1(this.m_ActiveEdges,g))g.PrevInAEL=null,g.NextInAEL=this.m_ActiveEdges,this.m_ActiveEdges.PrevInAEL=g,this.m_ActiveEdges=g;else{for(x===null&&(x=this.m_ActiveEdges);x.NextInAEL!==null&&!this.E2InsertsBeforeE1(x.NextInAEL,g);)x=x.NextInAEL;g.NextInAEL=x.NextInAEL,x.NextInAEL!==null&&(x.NextInAEL.PrevInAEL=g),g.PrevInAEL=x,x.NextInAEL=g}},n.Clipper.prototype.E2InsertsBeforeE1=function(g,x){return x.Curr.X==g.Curr.X?x.Top.Y>g.Top.Y?x.Top.X<n.Clipper.TopX(g,x.Top.Y):g.Top.X>n.Clipper.TopX(x,g.Top.Y):x.Curr.X<g.Curr.X},n.Clipper.prototype.IsEvenOddFillType=function(g){return g.PolyTyp==n.PolyType.ptSubject?this.m_SubjFillType==n.PolyFillType.pftEvenOdd:this.m_ClipFillType==n.PolyFillType.pftEvenOdd},n.Clipper.prototype.IsEvenOddAltFillType=function(g){return g.PolyTyp==n.PolyType.ptSubject?this.m_ClipFillType==n.PolyFillType.pftEvenOdd:this.m_SubjFillType==n.PolyFillType.pftEvenOdd},n.Clipper.prototype.IsContributing=function(g){var x,I;switch(g.PolyTyp==n.PolyType.ptSubject?(x=this.m_SubjFillType,I=this.m_ClipFillType):(x=this.m_ClipFillType,I=this.m_SubjFillType),x){case n.PolyFillType.pftEvenOdd:if(g.WindDelta===0&&g.WindCnt!=1)return!1;break;case n.PolyFillType.pftNonZero:if(Math.abs(g.WindCnt)!=1)return!1;break;case n.PolyFillType.pftPositive:if(g.WindCnt!=1)return!1;break;default:if(g.WindCnt!=-1)return!1;break}switch(this.m_ClipType){case n.ClipType.ctIntersection:switch(I){case n.PolyFillType.pftEvenOdd:case n.PolyFillType.pftNonZero:return g.WindCnt2!==0;case n.PolyFillType.pftPositive:return g.WindCnt2>0;default:return g.WindCnt2<0}case n.ClipType.ctUnion:switch(I){case n.PolyFillType.pftEvenOdd:case n.PolyFillType.pftNonZero:return g.WindCnt2===0;case n.PolyFillType.pftPositive:return g.WindCnt2<=0;default:return g.WindCnt2>=0}case n.ClipType.ctDifference:if(g.PolyTyp==n.PolyType.ptSubject)switch(I){case n.PolyFillType.pftEvenOdd:case n.PolyFillType.pftNonZero:return g.WindCnt2===0;case n.PolyFillType.pftPositive:return g.WindCnt2<=0;default:return g.WindCnt2>=0}else switch(I){case n.PolyFillType.pftEvenOdd:case n.PolyFillType.pftNonZero:return g.WindCnt2!==0;case n.PolyFillType.pftPositive:return g.WindCnt2>0;default:return g.WindCnt2<0}case n.ClipType.ctXor:if(g.WindDelta===0)switch(I){case n.PolyFillType.pftEvenOdd:case n.PolyFillType.pftNonZero:return g.WindCnt2===0;case n.PolyFillType.pftPositive:return g.WindCnt2<=0;default:return g.WindCnt2>=0}else return!0}return!0},n.Clipper.prototype.SetWindingCount=function(g){for(var x=g.PrevInAEL;x!==null&&(x.PolyTyp!=g.PolyTyp||x.WindDelta===0);)x=x.PrevInAEL;if(x===null)g.WindCnt=g.WindDelta===0?1:g.WindDelta,g.WindCnt2=0,x=this.m_ActiveEdges;else if(g.WindDelta===0&&this.m_ClipType!=n.ClipType.ctUnion)g.WindCnt=1,g.WindCnt2=x.WindCnt2,x=x.NextInAEL;else if(this.IsEvenOddFillType(g)){if(g.WindDelta===0){for(var I=!0,z=x.PrevInAEL;z!==null;)z.PolyTyp==x.PolyTyp&&z.WindDelta!==0&&(I=!I),z=z.PrevInAEL;g.WindCnt=I?0:1}else g.WindCnt=g.WindDelta;g.WindCnt2=x.WindCnt2,x=x.NextInAEL}else x.WindCnt*x.WindDelta<0?Math.abs(x.WindCnt)>1?x.WindDelta*g.WindDelta<0?g.WindCnt=x.WindCnt:g.WindCnt=x.WindCnt+g.WindDelta:g.WindCnt=g.WindDelta===0?1:g.WindDelta:g.WindDelta===0?g.WindCnt=x.WindCnt<0?x.WindCnt-1:x.WindCnt+1:x.WindDelta*g.WindDelta<0?g.WindCnt=x.WindCnt:g.WindCnt=x.WindCnt+g.WindDelta,g.WindCnt2=x.WindCnt2,x=x.NextInAEL;if(this.IsEvenOddAltFillType(g))for(;x!=g;)x.WindDelta!==0&&(g.WindCnt2=g.WindCnt2===0?1:0),x=x.NextInAEL;else for(;x!=g;)g.WindCnt2+=x.WindDelta,x=x.NextInAEL},n.Clipper.prototype.AddEdgeToSEL=function(g){this.m_SortedEdges===null?(this.m_SortedEdges=g,g.PrevInSEL=null,g.NextInSEL=null):(g.NextInSEL=this.m_SortedEdges,g.PrevInSEL=null,this.m_SortedEdges.PrevInSEL=g,this.m_SortedEdges=g)},n.Clipper.prototype.CopyAELToSEL=function(){var g=this.m_ActiveEdges;for(this.m_SortedEdges=g;g!==null;)g.PrevInSEL=g.PrevInAEL,g.NextInSEL=g.NextInAEL,g=g.NextInAEL},n.Clipper.prototype.SwapPositionsInAEL=function(g,x){if(!(g.NextInAEL==g.PrevInAEL||x.NextInAEL==x.PrevInAEL)){if(g.NextInAEL==x){var I=x.NextInAEL;I!==null&&(I.PrevInAEL=g);var z=g.PrevInAEL;z!==null&&(z.NextInAEL=x),x.PrevInAEL=z,x.NextInAEL=g,g.PrevInAEL=x,g.NextInAEL=I}else if(x.NextInAEL==g){var I=g.NextInAEL;I!==null&&(I.PrevInAEL=x);var z=x.PrevInAEL;z!==null&&(z.NextInAEL=g),g.PrevInAEL=z,g.NextInAEL=x,x.PrevInAEL=g,x.NextInAEL=I}else{var I=g.NextInAEL,z=g.PrevInAEL;g.NextInAEL=x.NextInAEL,g.NextInAEL!==null&&(g.NextInAEL.PrevInAEL=g),g.PrevInAEL=x.PrevInAEL,g.PrevInAEL!==null&&(g.PrevInAEL.NextInAEL=g),x.NextInAEL=I,x.NextInAEL!==null&&(x.NextInAEL.PrevInAEL=x),x.PrevInAEL=z,x.PrevInAEL!==null&&(x.PrevInAEL.NextInAEL=x)}g.PrevInAEL===null?this.m_ActiveEdges=g:x.PrevInAEL===null&&(this.m_ActiveEdges=x)}},n.Clipper.prototype.SwapPositionsInSEL=function(g,x){if(!(g.NextInSEL===null&&g.PrevInSEL===null)&&!(x.NextInSEL===null&&x.PrevInSEL===null)){if(g.NextInSEL==x){var I=x.NextInSEL;I!==null&&(I.PrevInSEL=g);var z=g.PrevInSEL;z!==null&&(z.NextInSEL=x),x.PrevInSEL=z,x.NextInSEL=g,g.PrevInSEL=x,g.NextInSEL=I}else if(x.NextInSEL==g){var I=g.NextInSEL;I!==null&&(I.PrevInSEL=x);var z=x.PrevInSEL;z!==null&&(z.NextInSEL=g),g.PrevInSEL=z,g.NextInSEL=x,x.PrevInSEL=g,x.NextInSEL=I}else{var I=g.NextInSEL,z=g.PrevInSEL;g.NextInSEL=x.NextInSEL,g.NextInSEL!==null&&(g.NextInSEL.PrevInSEL=g),g.PrevInSEL=x.PrevInSEL,g.PrevInSEL!==null&&(g.PrevInSEL.NextInSEL=g),x.NextInSEL=I,x.NextInSEL!==null&&(x.NextInSEL.PrevInSEL=x),x.PrevInSEL=z,x.PrevInSEL!==null&&(x.PrevInSEL.NextInSEL=x)}g.PrevInSEL===null?this.m_SortedEdges=g:x.PrevInSEL===null&&(this.m_SortedEdges=x)}},n.Clipper.prototype.AddLocalMaxPoly=function(g,x,I){this.AddOutPt(g,I),x.WindDelta==0&&this.AddOutPt(x,I),g.OutIdx==x.OutIdx?(g.OutIdx=-1,x.OutIdx=-1):g.OutIdx<x.OutIdx?this.AppendPolygon(g,x):this.AppendPolygon(x,g)},n.Clipper.prototype.AddLocalMinPoly=function(g,x,I){var z,F,j;if(n.ClipperBase.IsHorizontal(x)||g.Dx>x.Dx?(z=this.AddOutPt(g,I),x.OutIdx=g.OutIdx,g.Side=n.EdgeSide.esLeft,x.Side=n.EdgeSide.esRight,F=g,F.PrevInAEL==x?j=x.PrevInAEL:j=F.PrevInAEL):(z=this.AddOutPt(x,I),g.OutIdx=x.OutIdx,g.Side=n.EdgeSide.esRight,x.Side=n.EdgeSide.esLeft,F=x,F.PrevInAEL==g?j=g.PrevInAEL:j=F.PrevInAEL),j!==null&&j.OutIdx>=0&&n.Clipper.TopX(j,I.Y)==n.Clipper.TopX(F,I.Y)&&n.ClipperBase.SlopesEqual(F,j,this.m_UseFullRange)&&F.WindDelta!==0&&j.WindDelta!==0){var W=this.AddOutPt(j,I);this.AddJoin(z,W,F.Top)}return z},n.Clipper.prototype.CreateOutRec=function(){var g=new n.OutRec;return g.Idx=-1,g.IsHole=!1,g.IsOpen=!1,g.FirstLeft=null,g.Pts=null,g.BottomPt=null,g.PolyNode=null,this.m_PolyOuts.push(g),g.Idx=this.m_PolyOuts.length-1,g},n.Clipper.prototype.AddOutPt=function(g,x){var I=g.Side==n.EdgeSide.esLeft;if(g.OutIdx<0){var z=this.CreateOutRec();z.IsOpen=g.WindDelta===0;var F=new n.OutPt;return z.Pts=F,F.Idx=z.Idx,F.Pt.X=x.X,F.Pt.Y=x.Y,F.Next=F,F.Prev=F,z.IsOpen||this.SetHoleState(g,z),g.OutIdx=z.Idx,F}else{var z=this.m_PolyOuts[g.OutIdx],j=z.Pts;if(I&&n.IntPoint.op_Equality(x,j.Pt))return j;if(!I&&n.IntPoint.op_Equality(x,j.Prev.Pt))return j.Prev;var F=new n.OutPt;return F.Idx=z.Idx,F.Pt.X=x.X,F.Pt.Y=x.Y,F.Next=j,F.Prev=j.Prev,F.Prev.Next=F,j.Prev=F,I&&(z.Pts=F),F}},n.Clipper.prototype.SwapPoints=function(g,x){var I=new n.IntPoint(g.Value);g.Value.X=x.Value.X,g.Value.Y=x.Value.Y,x.Value.X=I.X,x.Value.Y=I.Y},n.Clipper.prototype.HorzSegmentsOverlap=function(g,x,I,z){return g.X>I.X==g.X<z.X||x.X>I.X==x.X<z.X||I.X>g.X==I.X<x.X||z.X>g.X==z.X<x.X||g.X==I.X&&x.X==z.X?!0:g.X==z.X&&x.X==I.X},n.Clipper.prototype.InsertPolyPtBetween=function(g,x,I){var z=new n.OutPt;return z.Pt.X=I.X,z.Pt.Y=I.Y,x==g.Next?(g.Next=z,x.Prev=z,z.Next=x,z.Prev=g):(x.Next=z,g.Prev=z,z.Next=g,z.Prev=x),z},n.Clipper.prototype.SetHoleState=function(g,x){for(var I=!1,z=g.PrevInAEL;z!==null;)z.OutIdx>=0&&z.WindDelta!=0&&(I=!I,x.FirstLeft===null&&(x.FirstLeft=this.m_PolyOuts[z.OutIdx])),z=z.PrevInAEL;I&&(x.IsHole=!0)},n.Clipper.prototype.GetDx=function(g,x){return g.Y==x.Y?n.ClipperBase.horizontal:(x.X-g.X)/(x.Y-g.Y)},n.Clipper.prototype.FirstIsBottomPt=function(g,x){for(var I=g.Prev;n.IntPoint.op_Equality(I.Pt,g.Pt)&&I!=g;)I=I.Prev;var z=Math.abs(this.GetDx(g.Pt,I.Pt));for(I=g.Next;n.IntPoint.op_Equality(I.Pt,g.Pt)&&I!=g;)I=I.Next;var F=Math.abs(this.GetDx(g.Pt,I.Pt));for(I=x.Prev;n.IntPoint.op_Equality(I.Pt,x.Pt)&&I!=x;)I=I.Prev;var j=Math.abs(this.GetDx(x.Pt,I.Pt));for(I=x.Next;n.IntPoint.op_Equality(I.Pt,x.Pt)&&I!=x;)I=I.Next;var W=Math.abs(this.GetDx(x.Pt,I.Pt));return z>=j&&z>=W||F>=j&&F>=W},n.Clipper.prototype.GetBottomPt=function(g){for(var x=null,I=g.Next;I!=g;)I.Pt.Y>g.Pt.Y?(g=I,x=null):I.Pt.Y==g.Pt.Y&&I.Pt.X<=g.Pt.X&&(I.Pt.X<g.Pt.X?(x=null,g=I):I.Next!=g&&I.Prev!=g&&(x=I)),I=I.Next;if(x!==null)for(;x!=I;)for(this.FirstIsBottomPt(I,x)||(g=x),x=x.Next;n.IntPoint.op_Inequality(x.Pt,g.Pt);)x=x.Next;return g},n.Clipper.prototype.GetLowermostRec=function(g,x){g.BottomPt===null&&(g.BottomPt=this.GetBottomPt(g.Pts)),x.BottomPt===null&&(x.BottomPt=this.GetBottomPt(x.Pts));var I=g.BottomPt,z=x.BottomPt;return I.Pt.Y>z.Pt.Y?g:I.Pt.Y<z.Pt.Y?x:I.Pt.X<z.Pt.X?g:I.Pt.X>z.Pt.X||I.Next==I?x:z.Next==z||this.FirstIsBottomPt(I,z)?g:x},n.Clipper.prototype.Param1RightOfParam2=function(g,x){do if(g=g.FirstLeft,g==x)return!0;while(g!==null);return!1},n.Clipper.prototype.GetOutRec=function(g){for(var x=this.m_PolyOuts[g];x!=this.m_PolyOuts[x.Idx];)x=this.m_PolyOuts[x.Idx];return x},n.Clipper.prototype.AppendPolygon=function(g,x){var I=this.m_PolyOuts[g.OutIdx],z=this.m_PolyOuts[x.OutIdx],F;this.Param1RightOfParam2(I,z)?F=z:this.Param1RightOfParam2(z,I)?F=I:F=this.GetLowermostRec(I,z);var j=I.Pts,W=j.Prev,re=z.Pts,ye=re.Prev,Pe;g.Side==n.EdgeSide.esLeft?(x.Side==n.EdgeSide.esLeft?(this.ReversePolyPtLinks(re),re.Next=j,j.Prev=re,W.Next=ye,ye.Prev=W,I.Pts=ye):(ye.Next=j,j.Prev=ye,re.Prev=W,W.Next=re,I.Pts=re),Pe=n.EdgeSide.esLeft):(x.Side==n.EdgeSide.esRight?(this.ReversePolyPtLinks(re),W.Next=ye,ye.Prev=W,re.Next=j,j.Prev=re):(W.Next=re,re.Prev=W,j.Prev=ye,ye.Next=j),Pe=n.EdgeSide.esRight),I.BottomPt=null,F==z&&(z.FirstLeft!=I&&(I.FirstLeft=z.FirstLeft),I.IsHole=z.IsHole),z.Pts=null,z.BottomPt=null,z.FirstLeft=I;var rt=g.OutIdx,yt=x.OutIdx;g.OutIdx=-1,x.OutIdx=-1;for(var Bt=this.m_ActiveEdges;Bt!==null;){if(Bt.OutIdx==yt){Bt.OutIdx=rt,Bt.Side=Pe;break}Bt=Bt.NextInAEL}z.Idx=I.Idx},n.Clipper.prototype.ReversePolyPtLinks=function(g){if(g!==null){var x,I;x=g;do I=x.Next,x.Next=x.Prev,x.Prev=I,x=I;while(x!=g)}},n.Clipper.SwapSides=function(g,x){var I=g.Side;g.Side=x.Side,x.Side=I},n.Clipper.SwapPolyIndexes=function(g,x){var I=g.OutIdx;g.OutIdx=x.OutIdx,x.OutIdx=I},n.Clipper.prototype.IntersectEdges=function(g,x,I,z){var F=!z&&g.NextInLML===null&&g.Top.X==I.X&&g.Top.Y==I.Y,j=!z&&x.NextInLML===null&&x.Top.X==I.X&&x.Top.Y==I.Y,W=g.OutIdx>=0,re=x.OutIdx>=0;if(g.WindDelta===0||x.WindDelta===0){g.WindDelta===0&&x.WindDelta===0?(F||j)&&W&&re&&this.AddLocalMaxPoly(g,x,I):g.PolyTyp==x.PolyTyp&&g.WindDelta!=x.WindDelta&&this.m_ClipType==n.ClipType.ctUnion?g.WindDelta===0?re&&(this.AddOutPt(g,I),W&&(g.OutIdx=-1)):W&&(this.AddOutPt(x,I),re&&(x.OutIdx=-1)):g.PolyTyp!=x.PolyTyp&&(g.WindDelta===0&&Math.abs(x.WindCnt)==1&&(this.m_ClipType!=n.ClipType.ctUnion||x.WindCnt2===0)?(this.AddOutPt(g,I),W&&(g.OutIdx=-1)):x.WindDelta===0&&Math.abs(g.WindCnt)==1&&(this.m_ClipType!=n.ClipType.ctUnion||g.WindCnt2===0)&&(this.AddOutPt(x,I),re&&(x.OutIdx=-1))),F&&(g.OutIdx<0?this.DeleteFromAEL(g):n.Error("Error intersecting polylines")),j&&(x.OutIdx<0?this.DeleteFromAEL(x):n.Error("Error intersecting polylines"));return}if(g.PolyTyp==x.PolyTyp)if(this.IsEvenOddFillType(g)){var ye=g.WindCnt;g.WindCnt=x.WindCnt,x.WindCnt=ye}else g.WindCnt+x.WindDelta===0?g.WindCnt=-g.WindCnt:g.WindCnt+=x.WindDelta,x.WindCnt-g.WindDelta===0?x.WindCnt=-x.WindCnt:x.WindCnt-=g.WindDelta;else this.IsEvenOddFillType(x)?g.WindCnt2=g.WindCnt2===0?1:0:g.WindCnt2+=x.WindDelta,this.IsEvenOddFillType(g)?x.WindCnt2=x.WindCnt2===0?1:0:x.WindCnt2-=g.WindDelta;var Pe,rt,yt,Bt;g.PolyTyp==n.PolyType.ptSubject?(Pe=this.m_SubjFillType,yt=this.m_ClipFillType):(Pe=this.m_ClipFillType,yt=this.m_SubjFillType),x.PolyTyp==n.PolyType.ptSubject?(rt=this.m_SubjFillType,Bt=this.m_ClipFillType):(rt=this.m_ClipFillType,Bt=this.m_SubjFillType);var er,Yt;switch(Pe){case n.PolyFillType.pftPositive:er=g.WindCnt;break;case n.PolyFillType.pftNegative:er=-g.WindCnt;break;default:er=Math.abs(g.WindCnt);break}switch(rt){case n.PolyFillType.pftPositive:Yt=x.WindCnt;break;case n.PolyFillType.pftNegative:Yt=-x.WindCnt;break;default:Yt=Math.abs(x.WindCnt);break}if(W&&re)F||j||er!==0&&er!=1||Yt!==0&&Yt!=1||g.PolyTyp!=x.PolyTyp&&this.m_ClipType!=n.ClipType.ctXor?this.AddLocalMaxPoly(g,x,I):(this.AddOutPt(g,I),this.AddOutPt(x,I),n.Clipper.SwapSides(g,x),n.Clipper.SwapPolyIndexes(g,x));else if(W)(Yt===0||Yt==1)&&(this.AddOutPt(g,I),n.Clipper.SwapSides(g,x),n.Clipper.SwapPolyIndexes(g,x));else if(re)(er===0||er==1)&&(this.AddOutPt(x,I),n.Clipper.SwapSides(g,x),n.Clipper.SwapPolyIndexes(g,x));else if((er===0||er==1)&&(Yt===0||Yt==1)&&!F&&!j){var Cr,Kn;switch(yt){case n.PolyFillType.pftPositive:Cr=g.WindCnt2;break;case n.PolyFillType.pftNegative:Cr=-g.WindCnt2;break;default:Cr=Math.abs(g.WindCnt2);break}switch(Bt){case n.PolyFillType.pftPositive:Kn=x.WindCnt2;break;case n.PolyFillType.pftNegative:Kn=-x.WindCnt2;break;default:Kn=Math.abs(x.WindCnt2);break}if(g.PolyTyp!=x.PolyTyp)this.AddLocalMinPoly(g,x,I);else if(er==1&&Yt==1)switch(this.m_ClipType){case n.ClipType.ctIntersection:Cr>0&&Kn>0&&this.AddLocalMinPoly(g,x,I);break;case n.ClipType.ctUnion:Cr<=0&&Kn<=0&&this.AddLocalMinPoly(g,x,I);break;case n.ClipType.ctDifference:(g.PolyTyp==n.PolyType.ptClip&&Cr>0&&Kn>0||g.PolyTyp==n.PolyType.ptSubject&&Cr<=0&&Kn<=0)&&this.AddLocalMinPoly(g,x,I);break;case n.ClipType.ctXor:this.AddLocalMinPoly(g,x,I);break}else n.Clipper.SwapSides(g,x)}F!=j&&(F&&g.OutIdx>=0||j&&x.OutIdx>=0)&&(n.Clipper.SwapSides(g,x),n.Clipper.SwapPolyIndexes(g,x)),F&&this.DeleteFromAEL(g),j&&this.DeleteFromAEL(x)},n.Clipper.prototype.DeleteFromAEL=function(g){var x=g.PrevInAEL,I=g.NextInAEL;x===null&&I===null&&g!=this.m_ActiveEdges||(x!==null?x.NextInAEL=I:this.m_ActiveEdges=I,I!==null&&(I.PrevInAEL=x),g.NextInAEL=null,g.PrevInAEL=null)},n.Clipper.prototype.DeleteFromSEL=function(g){var x=g.PrevInSEL,I=g.NextInSEL;x===null&&I===null&&g!=this.m_SortedEdges||(x!==null?x.NextInSEL=I:this.m_SortedEdges=I,I!==null&&(I.PrevInSEL=x),g.NextInSEL=null,g.PrevInSEL=null)},n.Clipper.prototype.UpdateEdgeIntoAEL=function(g){g.NextInLML===null&&n.Error("UpdateEdgeIntoAEL: invalid call");var x=g.PrevInAEL,I=g.NextInAEL;return g.NextInLML.OutIdx=g.OutIdx,x!==null?x.NextInAEL=g.NextInLML:this.m_ActiveEdges=g.NextInLML,I!==null&&(I.PrevInAEL=g.NextInLML),g.NextInLML.Side=g.Side,g.NextInLML.WindDelta=g.WindDelta,g.NextInLML.WindCnt=g.WindCnt,g.NextInLML.WindCnt2=g.WindCnt2,g=g.NextInLML,g.Curr.X=g.Bot.X,g.Curr.Y=g.Bot.Y,g.PrevInAEL=x,g.NextInAEL=I,n.ClipperBase.IsHorizontal(g)||this.InsertScanbeam(g.Top.Y),g},n.Clipper.prototype.ProcessHorizontals=function(g){for(var x=this.m_SortedEdges;x!==null;)this.DeleteFromSEL(x),this.ProcessHorizontal(x,g),x=this.m_SortedEdges},n.Clipper.prototype.GetHorzDirection=function(g,x){g.Bot.X<g.Top.X?(x.Left=g.Bot.X,x.Right=g.Top.X,x.Dir=n.Direction.dLeftToRight):(x.Left=g.Top.X,x.Right=g.Bot.X,x.Dir=n.Direction.dRightToLeft)},n.Clipper.prototype.PrepareHorzJoins=function(g,x){var I=this.m_PolyOuts[g.OutIdx].Pts;g.Side!=n.EdgeSide.esLeft&&(I=I.Prev),x&&(n.IntPoint.op_Equality(I.Pt,g.Top)?this.AddGhostJoin(I,g.Bot):this.AddGhostJoin(I,g.Top))},n.Clipper.prototype.ProcessHorizontal=function(g,x){var I={Dir:null,Left:null,Right:null};this.GetHorzDirection(g,I);for(var z=I.Dir,F=I.Left,j=I.Right,W=g,re=null;W.NextInLML!==null&&n.ClipperBase.IsHorizontal(W.NextInLML);)W=W.NextInLML;for(W.NextInLML===null&&(re=this.GetMaximaPair(W));;){for(var ye=g==W,Pe=this.GetNextInAEL(g,z);Pe!==null&&!(Pe.Curr.X==g.Top.X&&g.NextInLML!==null&&Pe.Dx<g.NextInLML.Dx);){var rt=this.GetNextInAEL(Pe,z);if(z==n.Direction.dLeftToRight&&Pe.Curr.X<=j||z==n.Direction.dRightToLeft&&Pe.Curr.X>=F){if(g.OutIdx>=0&&g.WindDelta!=0&&this.PrepareHorzJoins(g,x),Pe==re&&ye){z==n.Direction.dLeftToRight?this.IntersectEdges(g,Pe,Pe.Top,!1):this.IntersectEdges(Pe,g,Pe.Top,!1),re.OutIdx>=0&&n.Error("ProcessHorizontal error");return}else if(z==n.Direction.dLeftToRight){var yt=new n.IntPoint(Pe.Curr.X,g.Curr.Y);this.IntersectEdges(g,Pe,yt,!0)}else{var yt=new n.IntPoint(Pe.Curr.X,g.Curr.Y);this.IntersectEdges(Pe,g,yt,!0)}this.SwapPositionsInAEL(g,Pe)}else if(z==n.Direction.dLeftToRight&&Pe.Curr.X>=j||z==n.Direction.dRightToLeft&&Pe.Curr.X<=F)break;Pe=rt}if(g.OutIdx>=0&&g.WindDelta!==0&&this.PrepareHorzJoins(g,x),g.NextInLML!==null&&n.ClipperBase.IsHorizontal(g.NextInLML)){g=this.UpdateEdgeIntoAEL(g),g.OutIdx>=0&&this.AddOutPt(g,g.Bot);var I={Dir:z,Left:F,Right:j};this.GetHorzDirection(g,I),z=I.Dir,F=I.Left,j=I.Right}else break}if(g.NextInLML!==null)if(g.OutIdx>=0){var Bt=this.AddOutPt(g,g.Top);if(g=this.UpdateEdgeIntoAEL(g),g.WindDelta===0)return;var er=g.PrevInAEL,rt=g.NextInAEL;if(er!==null&&er.Curr.X==g.Bot.X&&er.Curr.Y==g.Bot.Y&&er.WindDelta!==0&&er.OutIdx>=0&&er.Curr.Y>er.Top.Y&&n.ClipperBase.SlopesEqual(g,er,this.m_UseFullRange)){var Yt=this.AddOutPt(er,g.Bot);this.AddJoin(Bt,Yt,g.Top)}else if(rt!==null&&rt.Curr.X==g.Bot.X&&rt.Curr.Y==g.Bot.Y&&rt.WindDelta!==0&&rt.OutIdx>=0&&rt.Curr.Y>rt.Top.Y&&n.ClipperBase.SlopesEqual(g,rt,this.m_UseFullRange)){var Yt=this.AddOutPt(rt,g.Bot);this.AddJoin(Bt,Yt,g.Top)}}else g=this.UpdateEdgeIntoAEL(g);else re!==null?re.OutIdx>=0?(z==n.Direction.dLeftToRight?this.IntersectEdges(g,re,g.Top,!1):this.IntersectEdges(re,g,g.Top,!1),re.OutIdx>=0&&n.Error("ProcessHorizontal error")):(this.DeleteFromAEL(g),this.DeleteFromAEL(re)):(g.OutIdx>=0&&this.AddOutPt(g,g.Top),this.DeleteFromAEL(g))},n.Clipper.prototype.GetNextInAEL=function(g,x){return x==n.Direction.dLeftToRight?g.NextInAEL:g.PrevInAEL},n.Clipper.prototype.IsMinima=function(g){return g!==null&&g.Prev.NextInLML!=g&&g.Next.NextInLML!=g},n.Clipper.prototype.IsMaxima=function(g,x){return g!==null&&g.Top.Y==x&&g.NextInLML===null},n.Clipper.prototype.IsIntermediate=function(g,x){return g.Top.Y==x&&g.NextInLML!==null},n.Clipper.prototype.GetMaximaPair=function(g){var x=null;return n.IntPoint.op_Equality(g.Next.Top,g.Top)&&g.Next.NextInLML===null?x=g.Next:n.IntPoint.op_Equality(g.Prev.Top,g.Top)&&g.Prev.NextInLML===null&&(x=g.Prev),x!==null&&(x.OutIdx==-2||x.NextInAEL==x.PrevInAEL&&!n.ClipperBase.IsHorizontal(x))?null:x},n.Clipper.prototype.ProcessIntersections=function(g,x){if(this.m_ActiveEdges==null)return!0;try{if(this.BuildIntersectList(g,x),this.m_IntersectList.length==0)return!0;if(this.m_IntersectList.length==1||this.FixupIntersectionOrder())this.ProcessIntersectList();else return!1}catch{this.m_SortedEdges=null,this.m_IntersectList.length=0,n.Error("ProcessIntersections error")}return this.m_SortedEdges=null,!0},n.Clipper.prototype.BuildIntersectList=function(g,x){if(this.m_ActiveEdges!==null){var I=this.m_ActiveEdges;for(this.m_SortedEdges=I;I!==null;)I.PrevInSEL=I.PrevInAEL,I.NextInSEL=I.NextInAEL,I.Curr.X=n.Clipper.TopX(I,x),I=I.NextInAEL;for(var z=!0;z&&this.m_SortedEdges!==null;){for(z=!1,I=this.m_SortedEdges;I.NextInSEL!==null;){var F=I.NextInSEL,j=new n.IntPoint;if(I.Curr.X>F.Curr.X){!this.IntersectPoint(I,F,j)&&I.Curr.X>F.Curr.X+1&&n.Error("Intersection error"),j.Y>g&&(j.Y=g,Math.abs(I.Dx)>Math.abs(F.Dx)?j.X=n.Clipper.TopX(F,g):j.X=n.Clipper.TopX(I,g));var W=new n.IntersectNode;W.Edge1=I,W.Edge2=F,W.Pt.X=j.X,W.Pt.Y=j.Y,this.m_IntersectList.push(W),this.SwapPositionsInSEL(I,F),z=!0}else I=F}if(I.PrevInSEL!==null)I.PrevInSEL.NextInSEL=null;else break}this.m_SortedEdges=null}},n.Clipper.prototype.EdgesAdjacent=function(g){return g.Edge1.NextInSEL==g.Edge2||g.Edge1.PrevInSEL==g.Edge2},n.Clipper.IntersectNodeSort=function(g,x){return x.Pt.Y-g.Pt.Y},n.Clipper.prototype.FixupIntersectionOrder=function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer),this.CopyAELToSEL();for(var g=this.m_IntersectList.length,x=0;x<g;x++){if(!this.EdgesAdjacent(this.m_IntersectList[x])){for(var I=x+1;I<g&&!this.EdgesAdjacent(this.m_IntersectList[I]);)I++;if(I==g)return!1;var z=this.m_IntersectList[x];this.m_IntersectList[x]=this.m_IntersectList[I],this.m_IntersectList[I]=z}this.SwapPositionsInSEL(this.m_IntersectList[x].Edge1,this.m_IntersectList[x].Edge2)}return!0},n.Clipper.prototype.ProcessIntersectList=function(){for(var g=0,x=this.m_IntersectList.length;g<x;g++){var I=this.m_IntersectList[g];this.IntersectEdges(I.Edge1,I.Edge2,I.Pt,!0),this.SwapPositionsInAEL(I.Edge1,I.Edge2)}this.m_IntersectList.length=0};var no=function(g){return g<0?Math.ceil(g-.5):Math.round(g)},Yo=function(g){return g<0?Math.ceil(g-.5):Math.floor(g+.5)},ea=function(g){return g<0?-Math.round(Math.abs(g)):Math.round(g)},Ju=function(g){return g<0?(g-=.5,g<-2147483648?Math.ceil(g):g|0):(g+=.5,g>2147483647?Math.floor(g):g|0)};s.msie?n.Clipper.Round=no:s.chromium?n.Clipper.Round=ea:s.safari?n.Clipper.Round=Ju:n.Clipper.Round=Yo,n.Clipper.TopX=function(g,x){return x==g.Top.Y?g.Top.X:g.Bot.X+n.Clipper.Round(g.Dx*(x-g.Bot.Y))},n.Clipper.prototype.IntersectPoint=function(g,x,I){I.X=0,I.Y=0;var z,F;if(n.ClipperBase.SlopesEqual(g,x,this.m_UseFullRange)||g.Dx==x.Dx)return x.Bot.Y>g.Bot.Y?(I.X=x.Bot.X,I.Y=x.Bot.Y):(I.X=g.Bot.X,I.Y=g.Bot.Y),!1;if(g.Delta.X===0)I.X=g.Bot.X,n.ClipperBase.IsHorizontal(x)?I.Y=x.Bot.Y:(F=x.Bot.Y-x.Bot.X/x.Dx,I.Y=n.Clipper.Round(I.X/x.Dx+F));else if(x.Delta.X===0)I.X=x.Bot.X,n.ClipperBase.IsHorizontal(g)?I.Y=g.Bot.Y:(z=g.Bot.Y-g.Bot.X/g.Dx,I.Y=n.Clipper.Round(I.X/g.Dx+z));else{z=g.Bot.X-g.Bot.Y*g.Dx,F=x.Bot.X-x.Bot.Y*x.Dx;var j=(F-z)/(g.Dx-x.Dx);I.Y=n.Clipper.Round(j),Math.abs(g.Dx)<Math.abs(x.Dx)?I.X=n.Clipper.Round(g.Dx*j+z):I.X=n.Clipper.Round(x.Dx*j+F)}if(I.Y<g.Top.Y||I.Y<x.Top.Y){if(g.Top.Y>x.Top.Y)return I.Y=g.Top.Y,I.X=n.Clipper.TopX(x,g.Top.Y),I.X<g.Top.X;I.Y=x.Top.Y,Math.abs(g.Dx)<Math.abs(x.Dx)?I.X=n.Clipper.TopX(g,I.Y):I.X=n.Clipper.TopX(x,I.Y)}return!0},n.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(g){for(var x=this.m_ActiveEdges;x!==null;){var I=this.IsMaxima(x,g);if(I){var z=this.GetMaximaPair(x);I=z===null||!n.ClipperBase.IsHorizontal(z)}if(I){var F=x.PrevInAEL;this.DoMaxima(x),F===null?x=this.m_ActiveEdges:x=F.NextInAEL}else{if(this.IsIntermediate(x,g)&&n.ClipperBase.IsHorizontal(x.NextInLML)?(x=this.UpdateEdgeIntoAEL(x),x.OutIdx>=0&&this.AddOutPt(x,x.Bot),this.AddEdgeToSEL(x)):(x.Curr.X=n.Clipper.TopX(x,g),x.Curr.Y=g),this.StrictlySimple){var F=x.PrevInAEL;if(x.OutIdx>=0&&x.WindDelta!==0&&F!==null&&F.OutIdx>=0&&F.Curr.X==x.Curr.X&&F.WindDelta!==0){var j=this.AddOutPt(F,x.Curr),W=this.AddOutPt(x,x.Curr);this.AddJoin(j,W,x.Curr)}}x=x.NextInAEL}}for(this.ProcessHorizontals(!0),x=this.m_ActiveEdges;x!==null;){if(this.IsIntermediate(x,g)){var j=null;x.OutIdx>=0&&(j=this.AddOutPt(x,x.Top)),x=this.UpdateEdgeIntoAEL(x);var F=x.PrevInAEL,re=x.NextInAEL;if(F!==null&&F.Curr.X==x.Bot.X&&F.Curr.Y==x.Bot.Y&&j!==null&&F.OutIdx>=0&&F.Curr.Y>F.Top.Y&&n.ClipperBase.SlopesEqual(x,F,this.m_UseFullRange)&&x.WindDelta!==0&&F.WindDelta!==0){var W=this.AddOutPt(F,x.Bot);this.AddJoin(j,W,x.Top)}else if(re!==null&&re.Curr.X==x.Bot.X&&re.Curr.Y==x.Bot.Y&&j!==null&&re.OutIdx>=0&&re.Curr.Y>re.Top.Y&&n.ClipperBase.SlopesEqual(x,re,this.m_UseFullRange)&&x.WindDelta!==0&&re.WindDelta!==0){var W=this.AddOutPt(re,x.Bot);this.AddJoin(j,W,x.Top)}}x=x.NextInAEL}},n.Clipper.prototype.DoMaxima=function(g){var x=this.GetMaximaPair(g);if(x===null){g.OutIdx>=0&&this.AddOutPt(g,g.Top),this.DeleteFromAEL(g);return}for(var I=g.NextInAEL,z=!0;I!==null&&I!=x;)this.IntersectEdges(g,I,g.Top,!0),this.SwapPositionsInAEL(g,I),I=g.NextInAEL;g.OutIdx==-1&&x.OutIdx==-1?(this.DeleteFromAEL(g),this.DeleteFromAEL(x)):g.OutIdx>=0&&x.OutIdx>=0?this.IntersectEdges(g,x,g.Top,!1):z&&g.WindDelta===0?(g.OutIdx>=0&&(this.AddOutPt(g,g.Top),g.OutIdx=-1),this.DeleteFromAEL(g),x.OutIdx>=0&&(this.AddOutPt(x,g.Top),x.OutIdx=-1),this.DeleteFromAEL(x)):n.Error("DoMaxima error")},n.Clipper.ReversePaths=function(g){for(var x=0,I=g.length;x<I;x++)g[x].reverse()},n.Clipper.Orientation=function(g){return n.Clipper.Area(g)>=0},n.Clipper.prototype.PointCount=function(g){if(g===null)return 0;var x=0,I=g;do x++,I=I.Next;while(I!=g);return x},n.Clipper.prototype.BuildResult=function(g){n.Clear(g);for(var x=0,I=this.m_PolyOuts.length;x<I;x++){var z=this.m_PolyOuts[x];if(z.Pts!==null){var F=z.Pts.Prev,j=this.PointCount(F);if(!(j<2)){for(var W=new Array(j),re=0;re<j;re++)W[re]=F.Pt,F=F.Prev;g.push(W)}}}},n.Clipper.prototype.BuildResult2=function(g){g.Clear();for(var x=0,I=this.m_PolyOuts.length;x<I;x++){var z=this.m_PolyOuts[x],F=this.PointCount(z.Pts);if(!(z.IsOpen&&F<2||!z.IsOpen&&F<3)){this.FixHoleLinkage(z);var j=new n.PolyNode;g.m_AllPolys.push(j),z.PolyNode=j,j.m_polygon.length=F;for(var W=z.Pts.Prev,re=0;re<F;re++)j.m_polygon[re]=W.Pt,W=W.Prev}}for(var x=0,I=this.m_PolyOuts.length;x<I;x++){var z=this.m_PolyOuts[x];z.PolyNode!==null&&(z.IsOpen?(z.PolyNode.IsOpen=!0,g.AddChild(z.PolyNode)):z.FirstLeft!==null&&z.FirstLeft.PolyNode!=null?z.FirstLeft.PolyNode.AddChild(z.PolyNode):g.AddChild(z.PolyNode))}},n.Clipper.prototype.FixupOutPolygon=function(g){var x=null;g.BottomPt=null;for(var I=g.Pts;;){if(I.Prev==I||I.Prev==I.Next){this.DisposeOutPts(I),g.Pts=null;return}if(n.IntPoint.op_Equality(I.Pt,I.Next.Pt)||n.IntPoint.op_Equality(I.Pt,I.Prev.Pt)||n.ClipperBase.SlopesEqual(I.Prev.Pt,I.Pt,I.Next.Pt,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(I.Prev.Pt,I.Pt,I.Next.Pt)))x=null,I.Prev.Next=I.Next,I.Next.Prev=I.Prev,I=I.Prev;else{if(I==x)break;x===null&&(x=I),I=I.Next}}g.Pts=I},n.Clipper.prototype.DupOutPt=function(g,x){var I=new n.OutPt;return I.Pt.X=g.Pt.X,I.Pt.Y=g.Pt.Y,I.Idx=g.Idx,x?(I.Next=g.Next,I.Prev=g,g.Next.Prev=I,g.Next=I):(I.Prev=g.Prev,I.Next=g,g.Prev.Next=I,g.Prev=I),I},n.Clipper.prototype.GetOverlap=function(g,x,I,z,F){return g<x?I<z?(F.Left=Math.max(g,I),F.Right=Math.min(x,z)):(F.Left=Math.max(g,z),F.Right=Math.min(x,I)):I<z?(F.Left=Math.max(x,I),F.Right=Math.min(g,z)):(F.Left=Math.max(x,z),F.Right=Math.min(g,I)),F.Left<F.Right},n.Clipper.prototype.JoinHorz=function(g,x,I,z,F,j){var W=g.Pt.X>x.Pt.X?n.Direction.dRightToLeft:n.Direction.dLeftToRight,re=I.Pt.X>z.Pt.X?n.Direction.dRightToLeft:n.Direction.dLeftToRight;if(W==re)return!1;if(W==n.Direction.dLeftToRight){for(;g.Next.Pt.X<=F.X&&g.Next.Pt.X>=g.Pt.X&&g.Next.Pt.Y==F.Y;)g=g.Next;j&&g.Pt.X!=F.X&&(g=g.Next),x=this.DupOutPt(g,!j),n.IntPoint.op_Inequality(x.Pt,F)&&(g=x,g.Pt.X=F.X,g.Pt.Y=F.Y,x=this.DupOutPt(g,!j))}else{for(;g.Next.Pt.X>=F.X&&g.Next.Pt.X<=g.Pt.X&&g.Next.Pt.Y==F.Y;)g=g.Next;!j&&g.Pt.X!=F.X&&(g=g.Next),x=this.DupOutPt(g,j),n.IntPoint.op_Inequality(x.Pt,F)&&(g=x,g.Pt.X=F.X,g.Pt.Y=F.Y,x=this.DupOutPt(g,j))}if(re==n.Direction.dLeftToRight){for(;I.Next.Pt.X<=F.X&&I.Next.Pt.X>=I.Pt.X&&I.Next.Pt.Y==F.Y;)I=I.Next;j&&I.Pt.X!=F.X&&(I=I.Next),z=this.DupOutPt(I,!j),n.IntPoint.op_Inequality(z.Pt,F)&&(I=z,I.Pt.X=F.X,I.Pt.Y=F.Y,z=this.DupOutPt(I,!j))}else{for(;I.Next.Pt.X>=F.X&&I.Next.Pt.X<=I.Pt.X&&I.Next.Pt.Y==F.Y;)I=I.Next;!j&&I.Pt.X!=F.X&&(I=I.Next),z=this.DupOutPt(I,j),n.IntPoint.op_Inequality(z.Pt,F)&&(I=z,I.Pt.X=F.X,I.Pt.Y=F.Y,z=this.DupOutPt(I,j))}return W==n.Direction.dLeftToRight==j?(g.Prev=I,I.Next=g,x.Next=z,z.Prev=x):(g.Next=I,I.Prev=g,x.Prev=z,z.Next=x),!0},n.Clipper.prototype.JoinPoints=function(g,x,I){var z=g.OutPt1,F=new n.OutPt,j=g.OutPt2,W=new n.OutPt,re=g.OutPt1.Pt.Y==g.OffPt.Y;if(re&&n.IntPoint.op_Equality(g.OffPt,g.OutPt1.Pt)&&n.IntPoint.op_Equality(g.OffPt,g.OutPt2.Pt)){for(F=g.OutPt1.Next;F!=z&&n.IntPoint.op_Equality(F.Pt,g.OffPt);)F=F.Next;var ye=F.Pt.Y>g.OffPt.Y;for(W=g.OutPt2.Next;W!=j&&n.IntPoint.op_Equality(W.Pt,g.OffPt);)W=W.Next;var Pe=W.Pt.Y>g.OffPt.Y;return ye==Pe?!1:ye?(F=this.DupOutPt(z,!1),W=this.DupOutPt(j,!0),z.Prev=j,j.Next=z,F.Next=W,W.Prev=F,g.OutPt1=z,g.OutPt2=F,!0):(F=this.DupOutPt(z,!0),W=this.DupOutPt(j,!1),z.Next=j,j.Prev=z,F.Prev=W,W.Next=F,g.OutPt1=z,g.OutPt2=F,!0)}else if(re){for(F=z;z.Prev.Pt.Y==z.Pt.Y&&z.Prev!=F&&z.Prev!=j;)z=z.Prev;for(;F.Next.Pt.Y==F.Pt.Y&&F.Next!=z&&F.Next!=j;)F=F.Next;if(F.Next==z||F.Next==j)return!1;for(W=j;j.Prev.Pt.Y==j.Pt.Y&&j.Prev!=W&&j.Prev!=F;)j=j.Prev;for(;W.Next.Pt.Y==W.Pt.Y&&W.Next!=j&&W.Next!=z;)W=W.Next;if(W.Next==j||W.Next==z)return!1;var rt={Left:null,Right:null};if(!this.GetOverlap(z.Pt.X,F.Pt.X,j.Pt.X,W.Pt.X,rt))return!1;var yt=rt.Left,Bt=rt.Right,er=new n.IntPoint,Yt;return z.Pt.X>=yt&&z.Pt.X<=Bt?(er.X=z.Pt.X,er.Y=z.Pt.Y,Yt=z.Pt.X>F.Pt.X):j.Pt.X>=yt&&j.Pt.X<=Bt?(er.X=j.Pt.X,er.Y=j.Pt.Y,Yt=j.Pt.X>W.Pt.X):F.Pt.X>=yt&&F.Pt.X<=Bt?(er.X=F.Pt.X,er.Y=F.Pt.Y,Yt=F.Pt.X>z.Pt.X):(er.X=W.Pt.X,er.Y=W.Pt.Y,Yt=W.Pt.X>j.Pt.X),g.OutPt1=z,g.OutPt2=j,this.JoinHorz(z,F,j,W,er,Yt)}else{for(F=z.Next;n.IntPoint.op_Equality(F.Pt,z.Pt)&&F!=z;)F=F.Next;var Cr=F.Pt.Y>z.Pt.Y||!n.ClipperBase.SlopesEqual(z.Pt,F.Pt,g.OffPt,this.m_UseFullRange);if(Cr){for(F=z.Prev;n.IntPoint.op_Equality(F.Pt,z.Pt)&&F!=z;)F=F.Prev;if(F.Pt.Y>z.Pt.Y||!n.ClipperBase.SlopesEqual(z.Pt,F.Pt,g.OffPt,this.m_UseFullRange))return!1}for(W=j.Next;n.IntPoint.op_Equality(W.Pt,j.Pt)&&W!=j;)W=W.Next;var Kn=W.Pt.Y>j.Pt.Y||!n.ClipperBase.SlopesEqual(j.Pt,W.Pt,g.OffPt,this.m_UseFullRange);if(Kn){for(W=j.Prev;n.IntPoint.op_Equality(W.Pt,j.Pt)&&W!=j;)W=W.Prev;if(W.Pt.Y>j.Pt.Y||!n.ClipperBase.SlopesEqual(j.Pt,W.Pt,g.OffPt,this.m_UseFullRange))return!1}return F==z||W==j||F==W||x==I&&Cr==Kn?!1:Cr?(F=this.DupOutPt(z,!1),W=this.DupOutPt(j,!0),z.Prev=j,j.Next=z,F.Next=W,W.Prev=F,g.OutPt1=z,g.OutPt2=F,!0):(F=this.DupOutPt(z,!0),W=this.DupOutPt(j,!1),z.Next=j,j.Prev=z,F.Prev=W,W.Next=F,g.OutPt1=z,g.OutPt2=F,!0)}},n.Clipper.GetBounds=function(g){for(var x=0,I=g.length;x<I&&g[x].length==0;)x++;if(x==I)return new n.IntRect(0,0,0,0);var z=new n.IntRect;for(z.left=g[x][0].X,z.right=z.left,z.top=g[x][0].Y,z.bottom=z.top;x<I;x++)for(var F=0,j=g[x].length;F<j;F++)g[x][F].X<z.left?z.left=g[x][F].X:g[x][F].X>z.right&&(z.right=g[x][F].X),g[x][F].Y<z.top?z.top=g[x][F].Y:g[x][F].Y>z.bottom&&(z.bottom=g[x][F].Y);return z},n.Clipper.prototype.GetBounds2=function(g){var x=g,I=new n.IntRect;for(I.left=g.Pt.X,I.right=g.Pt.X,I.top=g.Pt.Y,I.bottom=g.Pt.Y,g=g.Next;g!=x;)g.Pt.X<I.left&&(I.left=g.Pt.X),g.Pt.X>I.right&&(I.right=g.Pt.X),g.Pt.Y<I.top&&(I.top=g.Pt.Y),g.Pt.Y>I.bottom&&(I.bottom=g.Pt.Y),g=g.Next;return I},n.Clipper.PointInPolygon=function(g,x){var I=0,z=x.length;if(z<3)return 0;for(var F=x[0],j=1;j<=z;++j){var W=j==z?x[0]:x[j];if(W.Y==g.Y&&(W.X==g.X||F.Y==g.Y&&W.X>g.X==F.X<g.X))return-1;if(F.Y<g.Y!=W.Y<g.Y){if(F.X>=g.X)if(W.X>g.X)I=1-I;else{var re=(F.X-g.X)*(W.Y-g.Y)-(W.X-g.X)*(F.Y-g.Y);if(re==0)return-1;re>0==W.Y>F.Y&&(I=1-I)}else if(W.X>g.X){var re=(F.X-g.X)*(W.Y-g.Y)-(W.X-g.X)*(F.Y-g.Y);if(re==0)return-1;re>0==W.Y>F.Y&&(I=1-I)}}F=W}return I},n.Clipper.prototype.PointInPolygon=function(g,x){for(var I=0,z=x;;){var F=x.Pt.X,j=x.Pt.Y,W=x.Next.Pt.X,re=x.Next.Pt.Y;if(re==g.Y&&(W==g.X||j==g.Y&&W>g.X==F<g.X))return-1;if(j<g.Y!=re<g.Y){if(F>=g.X)if(W>g.X)I=1-I;else{var ye=(F-g.X)*(re-g.Y)-(W-g.X)*(j-g.Y);if(ye==0)return-1;ye>0==re>j&&(I=1-I)}else if(W>g.X){var ye=(F-g.X)*(re-g.Y)-(W-g.X)*(j-g.Y);if(ye==0)return-1;ye>0==re>j&&(I=1-I)}}if(x=x.Next,z==x)break}return I},n.Clipper.prototype.Poly2ContainsPoly1=function(g,x){var I=g;do{var z=this.PointInPolygon(I.Pt,x);if(z>=0)return z!=0;I=I.Next}while(I!=g);return!0},n.Clipper.prototype.FixupFirstLefts1=function(g,x){for(var I=0,z=this.m_PolyOuts.length;I<z;I++){var F=this.m_PolyOuts[I];F.Pts!==null&&F.FirstLeft==g&&this.Poly2ContainsPoly1(F.Pts,x.Pts)&&(F.FirstLeft=x)}},n.Clipper.prototype.FixupFirstLefts2=function(g,x){for(var I=0,z=this.m_PolyOuts,F=z.length,j=z[I];I<F;I++,j=z[I])j.FirstLeft==g&&(j.FirstLeft=x)},n.Clipper.ParseFirstLeft=function(g){for(;g!=null&&g.Pts==null;)g=g.FirstLeft;return g},n.Clipper.prototype.JoinCommonEdges=function(){for(var g=0,x=this.m_Joins.length;g<x;g++){var I=this.m_Joins[g],z=this.GetOutRec(I.OutPt1.Idx),F=this.GetOutRec(I.OutPt2.Idx);if(!(z.Pts==null||F.Pts==null)){var j;if(z==F?j=z:this.Param1RightOfParam2(z,F)?j=F:this.Param1RightOfParam2(F,z)?j=z:j=this.GetLowermostRec(z,F),!!this.JoinPoints(I,z,F))if(z==F){if(z.Pts=I.OutPt1,z.BottomPt=null,F=this.CreateOutRec(),F.Pts=I.OutPt2,this.UpdateOutPtIdxs(F),this.m_UsingPolyTree)for(var W=0,re=this.m_PolyOuts.length;W<re-1;W++){var ye=this.m_PolyOuts[W];ye.Pts==null||n.Clipper.ParseFirstLeft(ye.FirstLeft)!=z||ye.IsHole==z.IsHole||this.Poly2ContainsPoly1(ye.Pts,I.OutPt2)&&(ye.FirstLeft=F)}this.Poly2ContainsPoly1(F.Pts,z.Pts)?(F.IsHole=!z.IsHole,F.FirstLeft=z,this.m_UsingPolyTree&&this.FixupFirstLefts2(F,z),(F.IsHole^this.ReverseSolution)==this.Area(F)>0&&this.ReversePolyPtLinks(F.Pts)):this.Poly2ContainsPoly1(z.Pts,F.Pts)?(F.IsHole=z.IsHole,z.IsHole=!F.IsHole,F.FirstLeft=z.FirstLeft,z.FirstLeft=F,this.m_UsingPolyTree&&this.FixupFirstLefts2(z,F),(z.IsHole^this.ReverseSolution)==this.Area(z)>0&&this.ReversePolyPtLinks(z.Pts)):(F.IsHole=z.IsHole,F.FirstLeft=z.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(z,F))}else F.Pts=null,F.BottomPt=null,F.Idx=z.Idx,z.IsHole=j.IsHole,j==F&&(z.FirstLeft=F.FirstLeft),F.FirstLeft=z,this.m_UsingPolyTree&&this.FixupFirstLefts2(F,z)}}},n.Clipper.prototype.UpdateOutPtIdxs=function(g){var x=g.Pts;do x.Idx=g.Idx,x=x.Prev;while(x!=g.Pts)},n.Clipper.prototype.DoSimplePolygons=function(){for(var g=0;g<this.m_PolyOuts.length;){var x=this.m_PolyOuts[g++],I=x.Pts;if(I!==null)do{for(var z=I.Next;z!=x.Pts;){if(n.IntPoint.op_Equality(I.Pt,z.Pt)&&z.Next!=I&&z.Prev!=I){var F=I.Prev,j=z.Prev;I.Prev=j,j.Next=I,z.Prev=F,F.Next=z,x.Pts=I;var W=this.CreateOutRec();W.Pts=z,this.UpdateOutPtIdxs(W),this.Poly2ContainsPoly1(W.Pts,x.Pts)?(W.IsHole=!x.IsHole,W.FirstLeft=x):this.Poly2ContainsPoly1(x.Pts,W.Pts)?(W.IsHole=x.IsHole,x.IsHole=!W.IsHole,W.FirstLeft=x.FirstLeft,x.FirstLeft=W):(W.IsHole=x.IsHole,W.FirstLeft=x.FirstLeft),z=I}z=z.Next}I=I.Next}while(I!=x.Pts)}},n.Clipper.Area=function(g){var x=g.length;if(x<3)return 0;for(var I=0,z=0,F=x-1;z<x;++z)I+=(g[F].X+g[z].X)*(g[F].Y-g[z].Y),F=z;return-I*.5},n.Clipper.prototype.Area=function(g){var x=g.Pts;if(x==null)return 0;var I=0;do I=I+(x.Prev.Pt.X+x.Pt.X)*(x.Prev.Pt.Y-x.Pt.Y),x=x.Next;while(x!=g.Pts);return I*.5},n.Clipper.SimplifyPolygon=function(g,x){var I=new Array,z=new n.Clipper(0);return z.StrictlySimple=!0,z.AddPath(g,n.PolyType.ptSubject,!0),z.Execute(n.ClipType.ctUnion,I,x,x),I},n.Clipper.SimplifyPolygons=function(g,x){typeof x>"u"&&(x=n.PolyFillType.pftEvenOdd);var I=new Array,z=new n.Clipper(0);return z.StrictlySimple=!0,z.AddPaths(g,n.PolyType.ptSubject,!0),z.Execute(n.ClipType.ctUnion,I,x,x),I},n.Clipper.DistanceSqrd=function(g,x){var I=g.X-x.X,z=g.Y-x.Y;return I*I+z*z},n.Clipper.DistanceFromLineSqrd=function(g,x,I){var z=x.Y-I.Y,F=I.X-x.X,j=z*x.X+F*x.Y;return j=z*g.X+F*g.Y-j,j*j/(z*z+F*F)},n.Clipper.SlopesNearCollinear=function(g,x,I,z){return n.Clipper.DistanceFromLineSqrd(x,g,I)<z},n.Clipper.PointsAreClose=function(g,x,I){var z=g.X-x.X,F=g.Y-x.Y;return z*z+F*F<=I},n.Clipper.ExcludeOp=function(g){var x=g.Prev;return x.Next=g.Next,g.Next.Prev=x,x.Idx=0,x},n.Clipper.CleanPolygon=function(g,x){typeof x>"u"&&(x=1.415);var I=g.length;if(I==0)return new Array;for(var z=new Array(I),F=0;F<I;++F)z[F]=new n.OutPt;for(var F=0;F<I;++F)z[F].Pt=g[F],z[F].Next=z[(F+1)%I],z[F].Next.Prev=z[F],z[F].Idx=0;for(var j=x*x,W=z[0];W.Idx==0&&W.Next!=W.Prev;)n.Clipper.PointsAreClose(W.Pt,W.Prev.Pt,j)?(W=n.Clipper.ExcludeOp(W),I--):n.Clipper.PointsAreClose(W.Prev.Pt,W.Next.Pt,j)?(n.Clipper.ExcludeOp(W.Next),W=n.Clipper.ExcludeOp(W),I-=2):n.Clipper.SlopesNearCollinear(W.Prev.Pt,W.Pt,W.Next.Pt,j)?(W=n.Clipper.ExcludeOp(W),I--):(W.Idx=1,W=W.Next);I<3&&(I=0);for(var re=new Array(I),F=0;F<I;++F)re[F]=new n.IntPoint(W.Pt),W=W.Next;return z=null,re},n.Clipper.CleanPolygons=function(g,x){for(var I=new Array(g.length),z=0,F=g.length;z<F;z++)I[z]=n.Clipper.CleanPolygon(g[z],x);return I},n.Clipper.Minkowski=function(g,x,I,z){var F=z?1:0,j=g.length,W=x.length,re=new Array;if(I)for(var ye=0;ye<W;ye++){for(var Pe=new Array(j),rt=0,yt=g.length,Bt=g[rt];rt<yt;rt++,Bt=g[rt])Pe[rt]=new n.IntPoint(x[ye].X+Bt.X,x[ye].Y+Bt.Y);re.push(Pe)}else for(var ye=0;ye<W;ye++){for(var Pe=new Array(j),rt=0,yt=g.length,Bt=g[rt];rt<yt;rt++,Bt=g[rt])Pe[rt]=new n.IntPoint(x[ye].X-Bt.X,x[ye].Y-Bt.Y);re.push(Pe)}for(var er=new Array,ye=0;ye<W-1+F;ye++)for(var rt=0;rt<j;rt++){var Yt=new Array;Yt.push(re[ye%W][rt%j]),Yt.push(re[(ye+1)%W][rt%j]),Yt.push(re[(ye+1)%W][(rt+1)%j]),Yt.push(re[ye%W][(rt+1)%j]),n.Clipper.Orientation(Yt)||Yt.reverse(),er.push(Yt)}var Cr=new n.Clipper(0);return Cr.AddPaths(er,n.PolyType.ptSubject,!0),Cr.Execute(n.ClipType.ctUnion,re,n.PolyFillType.pftNonZero,n.PolyFillType.pftNonZero),re},n.Clipper.MinkowskiSum=function(){var g=arguments,x=g.length;if(x==3){var I=g[0],z=g[1],F=g[2];return n.Clipper.Minkowski(I,z,!0,F)}else if(x==4){for(var I=g[0],j=g[1],W=g[2],F=g[3],re=new n.Clipper,ye,Pe=0,rt=j.length;Pe<rt;++Pe){var ye=n.Clipper.Minkowski(I,j[Pe],!0,F);re.AddPaths(ye,n.PolyType.ptSubject,!0)}F&&re.AddPaths(j,n.PolyType.ptClip,!0);var yt=new n.Paths;return re.Execute(n.ClipType.ctUnion,yt,W,W),yt}},n.Clipper.MinkowskiDiff=function(g,x,I){return n.Clipper.Minkowski(g,x,!1,I)},n.Clipper.PolyTreeToPaths=function(g){var x=new Array;return n.Clipper.AddPolyNodeToPaths(g,n.Clipper.NodeType.ntAny,x),x},n.Clipper.AddPolyNodeToPaths=function(g,x,I){var z=!0;switch(x){case n.Clipper.NodeType.ntOpen:return;case n.Clipper.NodeType.ntClosed:z=!g.IsOpen;break}g.m_polygon.length>0&&z&&I.push(g.m_polygon);for(var F=0,j=g.Childs(),W=j.length,re=j[F];F<W;F++,re=j[F])n.Clipper.AddPolyNodeToPaths(re,x,I)},n.Clipper.OpenPathsFromPolyTree=function(g){for(var x=new n.Paths,I=0,z=g.ChildCount();I<z;I++)g.Childs()[I].IsOpen&&x.push(g.Childs()[I].m_polygon);return x},n.Clipper.ClosedPathsFromPolyTree=function(g){var x=new n.Paths;return n.Clipper.AddPolyNodeToPaths(g,n.Clipper.NodeType.ntClosed,x),x},Po(n.Clipper,n.ClipperBase),n.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2},n.ClipperOffset=function(g,x){typeof g>"u"&&(g=2),typeof x>"u"&&(x=n.ClipperOffset.def_arc_tolerance),this.m_destPolys=new n.Paths,this.m_srcPoly=new n.Path,this.m_destPoly=new n.Path,this.m_normals=new Array,this.m_delta=0,this.m_sinA=0,this.m_sin=0,this.m_cos=0,this.m_miterLim=0,this.m_StepsPerRad=0,this.m_lowest=new n.IntPoint,this.m_polyNodes=new n.PolyNode,this.MiterLimit=g,this.ArcTolerance=x,this.m_lowest.X=-1},n.ClipperOffset.two_pi=6.28318530717959,n.ClipperOffset.def_arc_tolerance=.25,n.ClipperOffset.prototype.Clear=function(){n.Clear(this.m_polyNodes.Childs()),this.m_lowest.X=-1},n.ClipperOffset.Round=n.Clipper.Round,n.ClipperOffset.prototype.AddPath=function(g,x,I){var z=g.length-1;if(!(z<0)){var F=new n.PolyNode;if(F.m_jointype=x,F.m_endtype=I,I==n.EndType.etClosedLine||I==n.EndType.etClosedPolygon)for(;z>0&&n.IntPoint.op_Equality(g[0],g[z]);)z--;F.m_polygon.push(g[0]);for(var j=0,W=0,re=1;re<=z;re++)n.IntPoint.op_Inequality(F.m_polygon[j],g[re])&&(j++,F.m_polygon.push(g[re]),(g[re].Y>F.m_polygon[W].Y||g[re].Y==F.m_polygon[W].Y&&g[re].X<F.m_polygon[W].X)&&(W=j));if(!(I==n.EndType.etClosedPolygon&&j<2||I!=n.EndType.etClosedPolygon&&j<0)&&(this.m_polyNodes.AddChild(F),I==n.EndType.etClosedPolygon))if(this.m_lowest.X<0)this.m_lowest=new n.IntPoint(0,W);else{var ye=this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon[this.m_lowest.Y];(F.m_polygon[W].Y>ye.Y||F.m_polygon[W].Y==ye.Y&&F.m_polygon[W].X<ye.X)&&(this.m_lowest=new n.IntPoint(this.m_polyNodes.ChildCount()-1,W))}}},n.ClipperOffset.prototype.AddPaths=function(g,x,I){for(var z=0,F=g.length;z<F;z++)this.AddPath(g[z],x,I)},n.ClipperOffset.prototype.FixOrientations=function(){if(this.m_lowest.X>=0&&!n.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon))for(var g=0;g<this.m_polyNodes.ChildCount();g++){var x=this.m_polyNodes.Childs()[g];(x.m_endtype==n.EndType.etClosedPolygon||x.m_endtype==n.EndType.etClosedLine&&n.Clipper.Orientation(x.m_polygon))&&x.m_polygon.reverse()}else for(var g=0;g<this.m_polyNodes.ChildCount();g++){var x=this.m_polyNodes.Childs()[g];x.m_endtype==n.EndType.etClosedLine&&!n.Clipper.Orientation(x.m_polygon)&&x.m_polygon.reverse()}},n.ClipperOffset.GetUnitNormal=function(g,x){var I=x.X-g.X,z=x.Y-g.Y;if(I==0&&z==0)return new n.DoublePoint(0,0);var F=1/Math.sqrt(I*I+z*z);return I*=F,z*=F,new n.DoublePoint(z,-I)},n.ClipperOffset.prototype.DoOffset=function(g){if(this.m_destPolys=new Array,this.m_delta=g,n.ClipperBase.near_zero(g)){for(var x=0;x<this.m_polyNodes.ChildCount();x++){var I=this.m_polyNodes.Childs()[x];I.m_endtype==n.EndType.etClosedPolygon&&this.m_destPolys.push(I.m_polygon)}return}this.MiterLimit>2?this.m_miterLim=2/(this.MiterLimit*this.MiterLimit):this.m_miterLim=.5;var z;this.ArcTolerance<=0?z=n.ClipperOffset.def_arc_tolerance:this.ArcTolerance>Math.abs(g)*n.ClipperOffset.def_arc_tolerance?z=Math.abs(g)*n.ClipperOffset.def_arc_tolerance:z=this.ArcTolerance;var F=3.14159265358979/Math.acos(1-z/Math.abs(g));this.m_sin=Math.sin(n.ClipperOffset.two_pi/F),this.m_cos=Math.cos(n.ClipperOffset.two_pi/F),this.m_StepsPerRad=F/n.ClipperOffset.two_pi,g<0&&(this.m_sin=-this.m_sin);for(var x=0;x<this.m_polyNodes.ChildCount();x++){var I=this.m_polyNodes.Childs()[x];this.m_srcPoly=I.m_polygon;var j=this.m_srcPoly.length;if(!(j==0||g<=0&&(j<3||I.m_endtype!=n.EndType.etClosedPolygon))){if(this.m_destPoly=new Array,j==1){if(I.m_jointype==n.JoinType.jtRound)for(var W=1,re=0,ye=1;ye<=F;ye++){this.m_destPoly.push(new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[0].X+W*g),n.ClipperOffset.Round(this.m_srcPoly[0].Y+re*g)));var Pe=W;W=W*this.m_cos-this.m_sin*re,re=Pe*this.m_sin+re*this.m_cos}else for(var W=-1,re=-1,ye=0;ye<4;++ye)this.m_destPoly.push(new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[0].X+W*g),n.ClipperOffset.Round(this.m_srcPoly[0].Y+re*g))),W<0?W=1:re<0?re=1:W=-1;this.m_destPolys.push(this.m_destPoly);continue}this.m_normals.length=0;for(var ye=0;ye<j-1;ye++)this.m_normals.push(n.ClipperOffset.GetUnitNormal(this.m_srcPoly[ye],this.m_srcPoly[ye+1]));if(I.m_endtype==n.EndType.etClosedLine||I.m_endtype==n.EndType.etClosedPolygon?this.m_normals.push(n.ClipperOffset.GetUnitNormal(this.m_srcPoly[j-1],this.m_srcPoly[0])):this.m_normals.push(new n.DoublePoint(this.m_normals[j-2])),I.m_endtype==n.EndType.etClosedPolygon){for(var rt=j-1,ye=0;ye<j;ye++)rt=this.OffsetPoint(ye,rt,I.m_jointype);this.m_destPolys.push(this.m_destPoly)}else if(I.m_endtype==n.EndType.etClosedLine){for(var rt=j-1,ye=0;ye<j;ye++)rt=this.OffsetPoint(ye,rt,I.m_jointype);this.m_destPolys.push(this.m_destPoly),this.m_destPoly=new Array;for(var yt=this.m_normals[j-1],ye=j-1;ye>0;ye--)this.m_normals[ye]=new n.DoublePoint(-this.m_normals[ye-1].X,-this.m_normals[ye-1].Y);this.m_normals[0]=new n.DoublePoint(-yt.X,-yt.Y),rt=0;for(var ye=j-1;ye>=0;ye--)rt=this.OffsetPoint(ye,rt,I.m_jointype);this.m_destPolys.push(this.m_destPoly)}else{for(var rt=0,ye=1;ye<j-1;++ye)rt=this.OffsetPoint(ye,rt,I.m_jointype);var Bt;if(I.m_endtype==n.EndType.etOpenButt){var ye=j-1;Bt=new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[ye].X+this.m_normals[ye].X*g),n.ClipperOffset.Round(this.m_srcPoly[ye].Y+this.m_normals[ye].Y*g)),this.m_destPoly.push(Bt),Bt=new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[ye].X-this.m_normals[ye].X*g),n.ClipperOffset.Round(this.m_srcPoly[ye].Y-this.m_normals[ye].Y*g)),this.m_destPoly.push(Bt)}else{var ye=j-1;rt=j-2,this.m_sinA=0,this.m_normals[ye]=new n.DoublePoint(-this.m_normals[ye].X,-this.m_normals[ye].Y),I.m_endtype==n.EndType.etOpenSquare?this.DoSquare(ye,rt):this.DoRound(ye,rt)}for(var ye=j-1;ye>0;ye--)this.m_normals[ye]=new n.DoublePoint(-this.m_normals[ye-1].X,-this.m_normals[ye-1].Y);this.m_normals[0]=new n.DoublePoint(-this.m_normals[1].X,-this.m_normals[1].Y),rt=j-1;for(var ye=rt-1;ye>0;--ye)rt=this.OffsetPoint(ye,rt,I.m_jointype);I.m_endtype==n.EndType.etOpenButt?(Bt=new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[0].X-this.m_normals[0].X*g),n.ClipperOffset.Round(this.m_srcPoly[0].Y-this.m_normals[0].Y*g)),this.m_destPoly.push(Bt),Bt=new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[0].X+this.m_normals[0].X*g),n.ClipperOffset.Round(this.m_srcPoly[0].Y+this.m_normals[0].Y*g)),this.m_destPoly.push(Bt)):(rt=1,this.m_sinA=0,I.m_endtype==n.EndType.etOpenSquare?this.DoSquare(0,1):this.DoRound(0,1)),this.m_destPolys.push(this.m_destPoly)}}}},n.ClipperOffset.prototype.Execute=function(){var g=arguments,x=g[0]instanceof n.PolyTree;if(x){var I=g[0],z=g[1];I.Clear(),this.FixOrientations(),this.DoOffset(z);var F=new n.Clipper(0);if(F.AddPaths(this.m_destPolys,n.PolyType.ptSubject,!0),z>0)F.Execute(n.ClipType.ctUnion,I,n.PolyFillType.pftPositive,n.PolyFillType.pftPositive);else{var j=n.Clipper.GetBounds(this.m_destPolys),W=new n.Path;if(W.push(new n.IntPoint(j.left-10,j.bottom+10)),W.push(new n.IntPoint(j.right+10,j.bottom+10)),W.push(new n.IntPoint(j.right+10,j.top-10)),W.push(new n.IntPoint(j.left-10,j.top-10)),F.AddPath(W,n.PolyType.ptSubject,!0),F.ReverseSolution=!0,F.Execute(n.ClipType.ctUnion,I,n.PolyFillType.pftNegative,n.PolyFillType.pftNegative),I.ChildCount()==1&&I.Childs()[0].ChildCount()>0){var re=I.Childs()[0];I.Childs()[0]=re.Childs()[0];for(var ye=1;ye<re.ChildCount();ye++)I.AddChild(re.Childs()[ye])}else I.Clear()}}else{var I=g[0],z=g[1];n.Clear(I),this.FixOrientations(),this.DoOffset(z);var F=new n.Clipper(0);if(F.AddPaths(this.m_destPolys,n.PolyType.ptSubject,!0),z>0)F.Execute(n.ClipType.ctUnion,I,n.PolyFillType.pftPositive,n.PolyFillType.pftPositive);else{var j=n.Clipper.GetBounds(this.m_destPolys),W=new n.Path;W.push(new n.IntPoint(j.left-10,j.bottom+10)),W.push(new n.IntPoint(j.right+10,j.bottom+10)),W.push(new n.IntPoint(j.right+10,j.top-10)),W.push(new n.IntPoint(j.left-10,j.top-10)),F.AddPath(W,n.PolyType.ptSubject,!0),F.ReverseSolution=!0,F.Execute(n.ClipType.ctUnion,I,n.PolyFillType.pftNegative,n.PolyFillType.pftNegative),I.length>0&&I.splice(0,1)}}},n.ClipperOffset.prototype.OffsetPoint=function(g,x,I){if(this.m_sinA=this.m_normals[x].X*this.m_normals[g].Y-this.m_normals[g].X*this.m_normals[x].Y,this.m_sinA<5e-5&&this.m_sinA>-5e-5)return x;if(this.m_sinA>1?this.m_sinA=1:this.m_sinA<-1&&(this.m_sinA=-1),this.m_sinA*this.m_delta<0)this.m_destPoly.push(new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[g].X+this.m_normals[x].X*this.m_delta),n.ClipperOffset.Round(this.m_srcPoly[g].Y+this.m_normals[x].Y*this.m_delta))),this.m_destPoly.push(new n.IntPoint(this.m_srcPoly[g])),this.m_destPoly.push(new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[g].X+this.m_normals[g].X*this.m_delta),n.ClipperOffset.Round(this.m_srcPoly[g].Y+this.m_normals[g].Y*this.m_delta)));else switch(I){case n.JoinType.jtMiter:{var z=1+(this.m_normals[g].X*this.m_normals[x].X+this.m_normals[g].Y*this.m_normals[x].Y);z>=this.m_miterLim?this.DoMiter(g,x,z):this.DoSquare(g,x);break}case n.JoinType.jtSquare:this.DoSquare(g,x);break;case n.JoinType.jtRound:this.DoRound(g,x);break}return x=g,x},n.ClipperOffset.prototype.DoSquare=function(g,x){var I=Math.tan(Math.atan2(this.m_sinA,this.m_normals[x].X*this.m_normals[g].X+this.m_normals[x].Y*this.m_normals[g].Y)/4);this.m_destPoly.push(new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[g].X+this.m_delta*(this.m_normals[x].X-this.m_normals[x].Y*I)),n.ClipperOffset.Round(this.m_srcPoly[g].Y+this.m_delta*(this.m_normals[x].Y+this.m_normals[x].X*I)))),this.m_destPoly.push(new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[g].X+this.m_delta*(this.m_normals[g].X+this.m_normals[g].Y*I)),n.ClipperOffset.Round(this.m_srcPoly[g].Y+this.m_delta*(this.m_normals[g].Y-this.m_normals[g].X*I))))},n.ClipperOffset.prototype.DoMiter=function(g,x,I){var z=this.m_delta/I;this.m_destPoly.push(new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[g].X+(this.m_normals[x].X+this.m_normals[g].X)*z),n.ClipperOffset.Round(this.m_srcPoly[g].Y+(this.m_normals[x].Y+this.m_normals[g].Y)*z)))},n.ClipperOffset.prototype.DoRound=function(g,x){for(var I=Math.atan2(this.m_sinA,this.m_normals[x].X*this.m_normals[g].X+this.m_normals[x].Y*this.m_normals[g].Y),z=n.Cast_Int32(n.ClipperOffset.Round(this.m_StepsPerRad*Math.abs(I))),F=this.m_normals[x].X,j=this.m_normals[x].Y,W,re=0;re<z;++re)this.m_destPoly.push(new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[g].X+F*this.m_delta),n.ClipperOffset.Round(this.m_srcPoly[g].Y+j*this.m_delta))),W=F,F=F*this.m_cos-this.m_sin*j,j=W*this.m_sin+j*this.m_cos;this.m_destPoly.push(new n.IntPoint(n.ClipperOffset.Round(this.m_srcPoly[g].X+this.m_normals[g].X*this.m_delta),n.ClipperOffset.Round(this.m_srcPoly[g].Y+this.m_normals[g].Y*this.m_delta)))},n.Error=function(g){try{throw new Error(g)}catch(x){alert(x.message)}},n.JS={},n.JS.AreaOfPolygon=function(g,x){return x||(x=1),n.Clipper.Area(g)/(x*x)},n.JS.AreaOfPolygons=function(g,x){x||(x=1);for(var I=0,z=0;z<g.length;z++)I+=n.Clipper.Area(g[z]);return I/(x*x)},n.JS.BoundsOfPath=function(g,x){return n.JS.BoundsOfPaths([g],x)},n.JS.BoundsOfPaths=function(g,x){x||(x=1);var I=n.Clipper.GetBounds(g);return I.left/=x,I.bottom/=x,I.right/=x,I.top/=x,I},n.JS.Clean=function(z,x){if(!(z instanceof Array))return[];var I=z[0]instanceof Array,z=n.JS.Clone(z);if(typeof x!="number"||x===null)return n.Error("Delta is not a number in Clean()."),z;if(z.length===0||z.length==1&&z[0].length===0||x<0)return z;I||(z=[z]);for(var F=z.length,j,W,re,ye,Pe,rt,yt,Bt=[],er=0;er<F;er++)if(W=z[er],j=W.length,j!==0){if(j<3){re=W,Bt.push(re);continue}for(re=W,ye=x*x,Pe=W[0],rt=1,yt=1;yt<j;yt++)(W[yt].X-Pe.X)*(W[yt].X-Pe.X)+(W[yt].Y-Pe.Y)*(W[yt].Y-Pe.Y)<=ye||(re[rt]=W[yt],Pe=W[yt],rt++);Pe=W[rt-1],(W[0].X-Pe.X)*(W[0].X-Pe.X)+(W[0].Y-Pe.Y)*(W[0].Y-Pe.Y)<=ye&&rt--,rt<j&&re.splice(rt,j-rt),re.length&&Bt.push(re)}return!I&&Bt.length?Bt=Bt[0]:!I&&Bt.length===0?Bt=[]:I&&Bt.length===0&&(Bt=[[]]),Bt},n.JS.Clone=function(g){if(!(g instanceof Array))return[];if(g.length===0)return[];if(g.length==1&&g[0].length===0)return[[]];var x=g[0]instanceof Array;x||(g=[g]);var I=g.length,z,F,j,W,re=new Array(I);for(F=0;F<I;F++){for(z=g[F].length,W=new Array(z),j=0;j<z;j++)W[j]={X:g[F][j].X,Y:g[F][j].Y};re[F]=W}return x||(re=re[0]),re},n.JS.Lighten=function(g,x){if(!(g instanceof Array))return[];if(typeof x!="number"||x===null)return n.Error("Tolerance is not a number in Lighten()."),n.JS.Clone(g);if(g.length===0||g.length==1&&g[0].length===0||x<0)return n.JS.Clone(g);g[0]instanceof Array||(g=[g]);var I,z,F,j,W,re,ye,Pe,rt,yt,Bt,er,Yt,Cr,Kn,Aa,Jo,G0=g.length,N_=x*x,Do=[];for(I=0;I<G0;I++)if(F=g[I],re=F.length,re!=0){for(j=0;j<1e6;j++){for(W=[],re=F.length,F[re-1].X!=F[0].X||F[re-1].Y!=F[0].Y?(er=1,F.push({X:F[0].X,Y:F[0].Y}),re=F.length):er=0,Bt=[],z=0;z<re-2;z++)ye=F[z],rt=F[z+1],Pe=F[z+2],Aa=ye.X,Jo=ye.Y,Yt=Pe.X-Aa,Cr=Pe.Y-Jo,(Yt!==0||Cr!==0)&&(Kn=((rt.X-Aa)*Yt+(rt.Y-Jo)*Cr)/(Yt*Yt+Cr*Cr),Kn>1?(Aa=Pe.X,Jo=Pe.Y):Kn>0&&(Aa+=Yt*Kn,Jo+=Cr*Kn)),Yt=rt.X-Aa,Cr=rt.Y-Jo,yt=Yt*Yt+Cr*Cr,yt<=N_&&(Bt[z+1]=1,z++);for(W.push({X:F[0].X,Y:F[0].Y}),z=1;z<re-1;z++)Bt[z]||W.push({X:F[z].X,Y:F[z].Y});if(W.push({X:F[re-1].X,Y:F[re-1].Y}),er&&F.pop(),Bt.length)F=W;else break}re=W.length,W[re-1].X==W[0].X&&W[re-1].Y==W[0].Y&&W.pop(),W.length>2&&Do.push(W)}return!g[0]instanceof Array&&(Do=Do[0]),typeof Do>"u"&&(Do=[[]]),Do},n.JS.PerimeterOfPath=function(g,x,I){if(typeof g>"u")return 0;var z=Math.sqrt,F=0,j,W,re=0,ye=0,Pe=0,rt=0,yt=g.length;if(yt<2)return 0;for(x&&(g[yt]=g[0],yt++);--yt;)j=g[yt],re=j.X,ye=j.Y,W=g[yt-1],Pe=W.X,rt=W.Y,F+=z((re-Pe)*(re-Pe)+(ye-rt)*(ye-rt));return x&&g.pop(),F/I},n.JS.PerimeterOfPaths=function(g,x,I){I||(I=1);for(var z=0,F=0;F<g.length;F++)z+=n.JS.PerimeterOfPath(g[F],x,I);return z},n.JS.ScaleDownPath=function(g,x){var I,z;for(x||(x=1),I=g.length;I--;)z=g[I],z.X=z.X/x,z.Y=z.Y/x},n.JS.ScaleDownPaths=function(g,x){var I,z,F;for(x||(x=1),I=g.length;I--;)for(z=g[I].length;z--;)F=g[I][z],F.X=F.X/x,F.Y=F.Y/x},n.JS.ScaleUpPath=function(g,x){var I,z,F=Math.round;for(x||(x=1),I=g.length;I--;)z=g[I],z.X=F(z.X*x),z.Y=F(z.Y*x)},n.JS.ScaleUpPaths=function(g,x){var I,z,F,j=Math.round;for(x||(x=1),I=g.length;I--;)for(z=g[I].length;z--;)F=g[I][z],F.X=j(F.X*x),F.Y=j(F.Y*x)},n.ExPolygons=function(){return[]},n.ExPolygon=function(){this.outer=null,this.holes=null},n.JS.AddOuterPolyNodeToExPolygons=function(g,x){var I=new n.ExPolygon;I.outer=g.Contour();var z=g.Childs(),F=z.length;I.holes=new Array(F);var j,W,re,ye,Pe,rt;for(re=0;re<F;re++)for(j=z[re],I.holes[re]=j.Contour(),ye=0,Pe=j.Childs(),rt=Pe.length;ye<rt;ye++)W=Pe[ye],n.JS.AddOuterPolyNodeToExPolygons(W,x);x.push(I)},n.JS.ExPolygonsToPaths=function(g){var x,I,z,F,j=new n.Paths;for(x=0,z=g.length;x<z;x++)for(j.push(g[x].outer),I=0,F=g[x].holes.length;I<F;I++)j.push(g[x].holes[I]);return j},n.JS.PolyTreeToExPolygons=function(g){var x=new n.ExPolygons,I,z,F,j;for(z=0,F=g.Childs(),j=F.length;z<j;z++)I=F[z],n.JS.AddOuterPolyNodeToExPolygons(I,x);return x},e.exports=n});C();var p5="[MappedinJS]",Ome=(t=>(t[t.LOG=0]="LOG",t[t.WARN=1]="WARN",t[t.ERROR=2]="ERROR",t[t.SILENT=3]="SILENT",t))(Ome||{});function Bme(t="",{prefix:e=p5}={}){let r="".concat(e).concat(t?"-".concat(t):""),n=(i,a)=>{if(typeof window<"u"&&window.rnDebug){let o=a.map(s=>s instanceof Error&&s.stack?"".concat(s.message,`
`).concat(s.stack):s);window.rnDebug("".concat(t," ").concat(i,": ").concat(o.join(" ")))}};return{logState:Oi.env.NODE_ENV==="test"?3:0,log(...i){this.logState<=0&&(console.log(r,...i),n("log",i))},warn(...i){this.logState<=1&&(console.warn(r,...i),n("warn",i))},error(...i){this.logState<=2&&(console.error(r,...i),n("error",i))},assert(...i){console.assert(...i)},time(i){console.time(i)},timeEnd(i){console.timeEnd(i)},setLevel(i){0<=i&&i<=3&&(this.logState=i)}}}var zme=Bme(),Be=zme;C();C();var Oy=class extends Error{};Oy.prototype.name="InvalidTokenError";function Fme(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function Rme(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return Fme(e)}catch{return atob(e)}}function Lme(t,e){if(typeof t!="string")throw new Oy("Invalid token specified: must be a string");e||(e={});let r=e.header===!0?0:1,n=t.split(".")[r];if(typeof n!="string")throw new Oy("Invalid token specified: missing part #".concat(r+1));let i;try{i=Rme(n)}catch(a){throw new Oy("Invalid token specified: invalid base64 for part #".concat(r+1," (").concat(a.message,")"))}try{return JSON.parse(i)}catch(a){throw new Oy("Invalid token specified: invalid json for part #".concat(r+1," (").concat(a.message,")"))}}C();var ud=63710088e-1;C();function wc(t,e,r,n){return(t<e||t>r)&&Be.warn(n),Math.min(r,Math.max(e,t))}C();function Nme(t,e){if(t==null||e==null)return t===e;if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function _G(t){var e,r;let n=Lme(t);if(n.sub==null)throw new Error("Access token is missing sub claim.");return{sub:n.sub,aud:typeof n.aud=="string"?[n.aud]:(e=n.aud)!=null?e:[],capabilities:(r=n.capabilities)!=null?r:{}}}function i1(t){return t*(Math.PI/180)}function Ip(t,e){let r=Math.pow(10,e);return Math.sign(t)*Math.round(Math.abs(t)*r)/r}function yz(t,e){return(t%e+e)%e}function $me(t,e){let r=yz(t,Math.PI*2),n=yz(e,Math.PI*2),i=n-r,a=n+(i>Math.PI?-Math.PI*2:i<-Math.PI?Math.PI*2:0);return{start:r,end:a}}function Bv(t){return t instanceof kN?Number.isFinite(t.min.x)&&Number.isFinite(t.min.y)&&Number.isFinite(t.max.x)&&Number.isFinite(t.max.y):Number.isFinite(t.min.x)&&Number.isFinite(t.min.y)&&Number.isFinite(t.max.x)&&Number.isFinite(t.max.y)&&Number.isFinite(t.min.z)&&Number.isFinite(t.max.z)}function $C(){return typeof window<"u"&&window!==null}function Ume(t,e){let[r,n]=t,[i,a]=e,o=i1(i-r),s=i1(a-n);return Math.sqrt(o*o+s*s)*ud}function Cp(t,e){let[r,n]=t.map(u=>i1(u)),[i,a]=e.map(u=>i1(u)),o=a-n,s=(i-r)*Math.cos((n+a)/2),l=o;return Math.sqrt(s*s+l*l)*ud}C();function jme(t,e,r=!1){let n=null,i=0;return function(...a){i++,i===1&&r===!0&&t(...a);let o=()=>{(!r||i>1)&&t(...a),n=null,i=0};clearTimeout(n),n=setTimeout(o,e)}}C();C();function Vme(t,e){return"".concat(e," ").concat(t)}var ho=class extends Error{constructor(t,e=p5){super(Vme(t,e)),this.name="MappedinError"}},Gme=class extends ho{constructor(t,e=p5){super(t,e),this.name="MappedinRenderError"}};C();var Zme=class xG extends Error{constructor(e){super(e),S(this,"name","AssertionError"),Error.captureStackTrace&&Error.captureStackTrace(this,xG)}};function bG(t,e){if(t==null){let r;if(e!=null&&e.customMessage)r=e.customMessage;else{let a=e!=null&&e.valueName?"'".concat(e.valueName,"'"):"value";r="Expected ".concat(a," to be defined, but received ").concat(t)}let n=e?.errorClass||Zme,i=new n(r);throw e?.captureStackTrace!==!1&&Error.captureStackTrace&&Error.captureStackTrace(i,bG),i}}function x4(t,e,r){if(bG(t),t?.type!==e){let n="Expected type ".concat(e," but got ").concat(t?.type);throw new Error(n)}}C();var gE=[0,4,6,8,10],Wn=()=>{let t=new Array(16).fill(0),e=Math.random()*4294967296;for(let n=0;n<t.length;n++)n>0&&(n&3)===0&&(e=Math.random()*4294967296),t[n]=e>>>((n&3)<<3)&255;let r=t.map(n=>n.toString(16).padStart(2,"0"));return r[6]="4"+r[6][1],r[8]=["8","9","a","b"].includes(r[7][0])?r[7]:"a"+r[7][1],gE.map((n,i)=>r.slice(n,i===gE.length-1?void 0:gE[i+1]).join("")).join("-")};function wG(t,e=0){let r=3735928559^e,n=1103547991^e;for(let i=0,a;i<t.length;i++)a=t.charCodeAt(i),r=Math.imul(r^a,2654435761),n=Math.imul(n^a,1597334677);return r=Math.imul(r^r>>>16,2246822507)^Math.imul(n^n>>>13,3266489909),n=Math.imul(n^n>>>16,2246822507)^Math.imul(r^r>>>13,3266489909),4294967296*(2097151&n)+(r>>>0)}C();var wi=class{constructor(){S(this,"_subscribers",{}),S(this,"_destroyed",!1)}publish(t,e){!this._subscribers||!this._subscribers[t]||this._destroyed||this._subscribers[t].forEach(function(r){typeof r=="function"&&r(e)})}on(t,e){(!this._subscribers||this._destroyed)&&(this._subscribers={}),this._subscribers[t]=this._subscribers[t]||[],this._subscribers[t].push(e)}off(t,e){if(!this._subscribers||this._subscribers[t]==null||this._destroyed)return;let r=this._subscribers[t].indexOf(e);r!==-1&&this._subscribers[t].splice(r,1)}destroy(){this._destroyed=!0,this._subscribers={}}};C();var vz="mi-session-data",_z="mi-local-data",Ix="id",Cx="deviceId",Rm,Xl,ql,AG=class SG{constructor(){K(this,Xl),K(this,ql);try{let e=sessionStorage.getItem(vz);e?ne(this,Xl,JSON.parse(e)):ne(this,Xl,{[Ix]:Wn()})}catch{ne(this,Xl,{[Ix]:Wn()})}try{let e=localStorage.getItem(_z);e?ne(this,ql,JSON.parse(e)):ne(this,ql,{[Cx]:Wn()})}catch{ne(this,ql,{[Cx]:Wn()})}f(this,Xl)[Ix]||(f(this,Xl)[Ix]=Wn()),f(this,ql)[Cx]||(f(this,ql)[Cx]=Wn())}static getInstance(){return f(this,Rm)||ne(this,Rm,new SG),f(this,Rm)}static ___clearInstance(){ne(this,Rm,void 0)}saveSessionData(e,r){f(this,Xl)[e]=r;try{return sessionStorage.setItem(vz,JSON.stringify(f(this,Xl))),!0}catch{return!1}}loadSessionData(e){let r=f(this,Xl)[e];if(r!=null)return r}saveLocalData(e,r){f(this,ql)[e]=r;try{return localStorage.setItem(_z,JSON.stringify(f(this,ql))),!0}catch{return!1}}loadLocalData(e){let r=f(this,ql)[e];if(r!=null)return r}};Rm=new WeakMap,Xl=new WeakMap,ql=new WeakMap,K(AG,Rm);var Mg=AG;C();var Wme=new Set(Object.keys(jt.NAMES)),yE;function EG(){return yE==null&&(yE=new jt),yE}var Hme=t=>Wme.has(t.toLowerCase()),Xme=t=>{if(!t.startsWith("#"))return!1;let e=t.slice(1);if(e.length!==3&&e.length!==6)return!1;for(let r=0;r<e.length;r++)if(!(e[r]>="0"&&e[r]<="9"||e[r]>="A"&&e[r]<="F"||e[r]>="a"&&e[r]<="f"))return!1;return!0},qme=t=>{if(!t.startsWith("rgb(")&&!t.startsWith("rgba("))return!1;let e=t.indexOf("("),r=t.lastIndexOf(")");if(e===-1||r===-1||r<=e||r!==t.length-1)return!1;let n=t.slice(e+1,r).split(",");if(n.length!==3&&n.length!==4)return!1;for(let i=0;i<n.length;i++){let a=n[i].trim();if(i<3)if(a.endsWith("%")){let o=parseFloat(a.slice(0,-1));if(isNaN(o)||o<0||o>100)return!1}else{let o=parseInt(a,10);if(isNaN(o)||o<0||o>255)return!1}else{let o=parseFloat(a);if(isNaN(o)||o<0||o>1)return!1}}return!0},Yme=t=>{if(!t.startsWith("hsl(")&&!t.startsWith("hsla("))return!1;let e=t.indexOf("("),r=t.lastIndexOf(")");if(e===-1||r===-1||r<=e||r!==t.length-1)return!1;let n=t.slice(e+1,r).split(",");if(n.length!==3&&n.length!==4)return!1;for(let i=0;i<n.length;i++){let a=n[i].trim();if(i===0){let o=parseFloat(a);if(isNaN(o))return!1}else if(i<3){if(!a.endsWith("%"))return!1;let o=parseFloat(a.slice(0,-1));if(isNaN(o)||o<0||o>100)return!1}else{let o=parseFloat(a);if(isNaN(o)||o<0||o>1)return!1}}return!0},tg=t=>t==null||typeof t!="string"?!1:!!(Xme(t)||qme(t)||Yme(t)||Hme(t)),xz=t=>{let e=EG();return e.set(t),[e.r,e.g,e.b]},Jme=t=>{let e=EG();return e.set(t[0],t[1],t[2]),"#"+e.getHexString()};C();var Kme=["ease-in","ease-out","ease-in-out","linear"],f5=t=>t,Qme=t=>t*t,IG=t=>1-Math.cos(t*Math.PI/2),ege=t=>1-(1-t)*(1-t),CG={linear:f5,"ease-in":Qme,"ease-out":ege,"ease-in-out":IG};function m5(t,e,r,n,i,a=f5){if(e===r)return i;t=Math.max(e,Math.min(t,r));let o=(t-Math.min(e,r))/Math.abs(r-e),s=typeof a=="function"?a(o):CG[a](o);return n+s*(i-n)}function MG(t,e){let r=0;if(e.length<2)return r;let n=e[0]<e[1]?(i,a)=>i>a:(i,a)=>i<a;for(;r<e.length-1&&n(t,e[r+1]);)r++;return r>e.length-2?Math.max(0,e.length-2):r}function tge(t,e,r,n="ease-in"){if(e.length!==r.length)throw new ho("Input and output ranges must have the same number of values.");t=Math.max(e[0],Math.min(t,e[e.length-1]));let i=MG(t,e),a=(t-e[i])/(e[i+1]-e[i]),o=typeof n=="function"?n(a):CG[n](a);return r[i]+o*(r[i+1]-r[i])}C();function bz(t){return(t%(2*Math.PI)+2*Math.PI)%(2*Math.PI)}C();C();var rge={version:"6.0.1-beta.51"};C();C();var nge=Zt(xr(),1),ige=Zt(Cme(),1);C();C();var vE;function TG(){return vE==null&&(vE=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),vE}var Mx;function age(){if(Mx==null&&(Mx=!1,TG())){let t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let r=0;r<25;r++){let n=r*4;t.fillStyle="rgb(".concat(n,",").concat(n+1,",").concat(n+2,")"),t.fillRect(r%5,Math.floor(r/5),1,1)}let e=t.getImageData(0,0,5,5).data;for(let r=0;r<100;r++)if(r%4!==3&&e[r]!==r){Mx=!0;break}}}return Mx||!1}C();C();var vr=1e-6,Tn=typeof Float32Array<"u"?Float32Array:Array,_u=Math.random;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var a1={};So(a1,{LDU:()=>wge,add:()=>Age,adjoint:()=>fge,clone:()=>sge,copy:()=>lge,create:()=>oge,determinant:()=>mge,equals:()=>Ege,exactEquals:()=>Sge,frob:()=>bge,fromRotation:()=>vge,fromScaling:()=>_ge,fromValues:()=>cge,identity:()=>uge,invert:()=>pge,mul:()=>Mge,multiply:()=>PG,multiplyScalar:()=>Ige,multiplyScalarAndAdd:()=>Cge,rotate:()=>gge,scale:()=>yge,set:()=>hge,str:()=>xge,sub:()=>Tge,subtract:()=>DG,transpose:()=>dge});C();function oge(){var t=new Tn(4);return Tn!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}function sge(t){var e=new Tn(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function lge(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function uge(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function cge(t,e,r,n){var i=new Tn(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i}function hge(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t}function dge(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t}function pge(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r*a-i*n;return o?(o=1/o,t[0]=a*o,t[1]=-n*o,t[2]=-i*o,t[3]=r*o,t):null}function fge(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t}function mge(t){return t[0]*t[3]-t[2]*t[1]}function PG(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=r[0],l=r[1],u=r[2],c=r[3];return t[0]=n*s+a*l,t[1]=i*s+o*l,t[2]=n*u+a*c,t[3]=i*u+o*c,t}function gge(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(r),l=Math.cos(r);return t[0]=n*l+a*s,t[1]=i*l+o*s,t[2]=n*-s+a*l,t[3]=i*-s+o*l,t}function yge(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=r[0],l=r[1];return t[0]=n*s,t[1]=i*s,t[2]=a*l,t[3]=o*l,t}function vge(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t}function _ge(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t}function xge(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function bge(t){return Math.hypot(t[0],t[1],t[2],t[3])}function wge(t,e,r,n){return t[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-t[2]*r[1],[t,e,r]}function Age(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function DG(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function Sge(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function Ege(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=e[0],s=e[1],l=e[2],u=e[3];return Math.abs(r-o)<=vr*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=vr*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-l)<=vr*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(a-u)<=vr*Math.max(1,Math.abs(a),Math.abs(u))}function Ige(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function Cge(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t}var Mge=PG,Tge=DG,o1={};So(o1,{add:()=>Kge,adjoint:()=>Lge,clone:()=>Dge,copy:()=>kge,create:()=>kG,determinant:()=>Nge,equals:()=>r0e,exactEquals:()=>t0e,frob:()=>Jge,fromMat2d:()=>Wge,fromMat4:()=>Pge,fromQuat:()=>Hge,fromRotation:()=>Gge,fromScaling:()=>Zge,fromTranslation:()=>Vge,fromValues:()=>Oge,identity:()=>zge,invert:()=>Rge,mul:()=>n0e,multiply:()=>OG,multiplyScalar:()=>Qge,multiplyScalarAndAdd:()=>e0e,normalFromMat4:()=>Xge,projection:()=>qge,rotate:()=>Uge,scale:()=>jge,set:()=>Bge,str:()=>Yge,sub:()=>i0e,subtract:()=>BG,translate:()=>$ge,transpose:()=>Fge});C();function kG(){var t=new Tn(9);return Tn!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Pge(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function Dge(t){var e=new Tn(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function kge(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Oge(t,e,r,n,i,a,o,s,l){var u=new Tn(9);return u[0]=t,u[1]=e,u[2]=r,u[3]=n,u[4]=i,u[5]=a,u[6]=o,u[7]=s,u[8]=l,u}function Bge(t,e,r,n,i,a,o,s,l,u){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=l,t[8]=u,t}function zge(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Fge(t,e){if(t===e){var r=e[1],n=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Rge(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=c*o-s*u,d=-c*a+s*l,p=u*a-o*l,m=r*h+n*d+i*p;return m?(m=1/m,t[0]=h*m,t[1]=(-c*n+i*u)*m,t[2]=(s*n-i*o)*m,t[3]=d*m,t[4]=(c*r-i*l)*m,t[5]=(-s*r+i*a)*m,t[6]=p*m,t[7]=(-u*r+n*l)*m,t[8]=(o*r-n*a)*m,t):null}function Lge(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8];return t[0]=o*c-s*u,t[1]=i*u-n*c,t[2]=n*s-i*o,t[3]=s*l-a*c,t[4]=r*c-i*l,t[5]=i*a-r*s,t[6]=a*u-o*l,t[7]=n*l-r*u,t[8]=r*o-n*a,t}function Nge(t){var e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7],u=t[8];return e*(u*a-o*l)+r*(-u*i+o*s)+n*(l*i-a*s)}function OG(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=r[0],p=r[1],m=r[2],y=r[3],v=r[4],_=r[5],w=r[6],b=r[7],A=r[8];return t[0]=d*n+p*o+m*u,t[1]=d*i+p*s+m*c,t[2]=d*a+p*l+m*h,t[3]=y*n+v*o+_*u,t[4]=y*i+v*s+_*c,t[5]=y*a+v*l+_*h,t[6]=w*n+b*o+A*u,t[7]=w*i+b*s+A*c,t[8]=w*a+b*l+A*h,t}function $ge(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=r[0],p=r[1];return t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=l,t[6]=d*n+p*o+u,t[7]=d*i+p*s+c,t[8]=d*a+p*l+h,t}function Uge(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=Math.sin(r),p=Math.cos(r);return t[0]=p*n+d*o,t[1]=p*i+d*s,t[2]=p*a+d*l,t[3]=p*o-d*n,t[4]=p*s-d*i,t[5]=p*l-d*a,t[6]=u,t[7]=c,t[8]=h,t}function jge(t,e,r){var n=r[0],i=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Vge(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function Gge(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Zge(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Wge(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function Hge(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r+r,s=n+n,l=i+i,u=r*o,c=n*o,h=n*s,d=i*o,p=i*s,m=i*l,y=a*o,v=a*s,_=a*l;return t[0]=1-h-m,t[3]=c-_,t[6]=d+v,t[1]=c+_,t[4]=1-u-m,t[7]=p-y,t[2]=d-v,t[5]=p+y,t[8]=1-u-h,t}function Xge(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],p=e[11],m=e[12],y=e[13],v=e[14],_=e[15],w=r*s-n*o,b=r*l-i*o,A=r*u-a*o,E=n*l-i*s,M=n*u-a*s,P=i*u-a*l,k=c*y-h*m,D=c*v-d*m,O=c*_-p*m,B=h*v-d*y,L=h*_-p*y,R=d*_-p*v,T=w*R-b*L+A*B+E*O-M*D+P*k;return T?(T=1/T,t[0]=(s*R-l*L+u*B)*T,t[1]=(l*O-o*R-u*D)*T,t[2]=(o*L-s*O+u*k)*T,t[3]=(i*L-n*R-a*B)*T,t[4]=(r*R-i*O+a*D)*T,t[5]=(n*O-r*L-a*k)*T,t[6]=(y*P-v*M+_*E)*T,t[7]=(v*A-m*P-_*b)*T,t[8]=(m*M-y*A+_*w)*T,t):null}function qge(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function Yge(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Jge(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function Kge(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t}function BG(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}function Qge(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t}function e0e(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t}function t0e(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function r0e(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=e[0],d=e[1],p=e[2],m=e[3],y=e[4],v=e[5],_=e[6],w=e[7],b=e[8];return Math.abs(r-h)<=vr*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(n-d)<=vr*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(i-p)<=vr*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(a-m)<=vr*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(o-y)<=vr*Math.max(1,Math.abs(o),Math.abs(y))&&Math.abs(s-v)<=vr*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(l-_)<=vr*Math.max(1,Math.abs(l),Math.abs(_))&&Math.abs(u-w)<=vr*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(c-b)<=vr*Math.max(1,Math.abs(c),Math.abs(b))}var n0e=OG,i0e=BG,Xe={};So(Xe,{add:()=>j0e,adjoint:()=>d0e,clone:()=>o0e,copy:()=>s0e,create:()=>a0e,determinant:()=>p0e,equals:()=>W0e,exactEquals:()=>Z0e,frob:()=>U0e,fromQuat:()=>D0e,fromQuat2:()=>I0e,fromRotation:()=>w0e,fromRotationTranslation:()=>RG,fromRotationTranslationScale:()=>T0e,fromRotationTranslationScaleOrigin:()=>P0e,fromScaling:()=>b0e,fromTranslation:()=>x0e,fromValues:()=>l0e,fromXRotation:()=>A0e,fromYRotation:()=>S0e,fromZRotation:()=>E0e,frustum:()=>k0e,getRotation:()=>M0e,getScaling:()=>LG,getTranslation:()=>C0e,identity:()=>zG,invert:()=>h0e,lookAt:()=>L0e,mul:()=>H0e,multiply:()=>FG,multiplyScalar:()=>V0e,multiplyScalarAndAdd:()=>G0e,ortho:()=>F0e,orthoNO:()=>$G,orthoZO:()=>R0e,perspective:()=>O0e,perspectiveFromFieldOfView:()=>z0e,perspectiveNO:()=>NG,perspectiveZO:()=>B0e,rotate:()=>g0e,rotateX:()=>y0e,rotateY:()=>v0e,rotateZ:()=>_0e,scale:()=>m0e,set:()=>u0e,str:()=>$0e,sub:()=>X0e,subtract:()=>UG,targetTo:()=>N0e,translate:()=>f0e,transpose:()=>c0e});C();function a0e(){var t=new Tn(16);return Tn!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function o0e(t){var e=new Tn(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function s0e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function l0e(t,e,r,n,i,a,o,s,l,u,c,h,d,p,m,y){var v=new Tn(16);return v[0]=t,v[1]=e,v[2]=r,v[3]=n,v[4]=i,v[5]=a,v[6]=o,v[7]=s,v[8]=l,v[9]=u,v[10]=c,v[11]=h,v[12]=d,v[13]=p,v[14]=m,v[15]=y,v}function u0e(t,e,r,n,i,a,o,s,l,u,c,h,d,p,m,y,v){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=l,t[8]=u,t[9]=c,t[10]=h,t[11]=d,t[12]=p,t[13]=m,t[14]=y,t[15]=v,t}function zG(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function c0e(t,e){if(t===e){var r=e[1],n=e[2],i=e[3],a=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=a,t[11]=e[14],t[12]=i,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function h0e(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],p=e[11],m=e[12],y=e[13],v=e[14],_=e[15],w=r*s-n*o,b=r*l-i*o,A=r*u-a*o,E=n*l-i*s,M=n*u-a*s,P=i*u-a*l,k=c*y-h*m,D=c*v-d*m,O=c*_-p*m,B=h*v-d*y,L=h*_-p*y,R=d*_-p*v,T=w*R-b*L+A*B+E*O-M*D+P*k;return T?(T=1/T,t[0]=(s*R-l*L+u*B)*T,t[1]=(i*L-n*R-a*B)*T,t[2]=(y*P-v*M+_*E)*T,t[3]=(d*M-h*P-p*E)*T,t[4]=(l*O-o*R-u*D)*T,t[5]=(r*R-i*O+a*D)*T,t[6]=(v*A-m*P-_*b)*T,t[7]=(c*P-d*A+p*b)*T,t[8]=(o*L-s*O+u*k)*T,t[9]=(n*O-r*L-a*k)*T,t[10]=(m*M-y*A+_*w)*T,t[11]=(h*A-c*M-p*w)*T,t[12]=(s*D-o*B-l*k)*T,t[13]=(r*B-n*D+i*k)*T,t[14]=(y*b-m*E-v*w)*T,t[15]=(c*E-h*b+d*w)*T,t):null}function d0e(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],p=e[11],m=e[12],y=e[13],v=e[14],_=e[15];return t[0]=s*(d*_-p*v)-h*(l*_-u*v)+y*(l*p-u*d),t[1]=-(n*(d*_-p*v)-h*(i*_-a*v)+y*(i*p-a*d)),t[2]=n*(l*_-u*v)-s*(i*_-a*v)+y*(i*u-a*l),t[3]=-(n*(l*p-u*d)-s*(i*p-a*d)+h*(i*u-a*l)),t[4]=-(o*(d*_-p*v)-c*(l*_-u*v)+m*(l*p-u*d)),t[5]=r*(d*_-p*v)-c*(i*_-a*v)+m*(i*p-a*d),t[6]=-(r*(l*_-u*v)-o*(i*_-a*v)+m*(i*u-a*l)),t[7]=r*(l*p-u*d)-o*(i*p-a*d)+c*(i*u-a*l),t[8]=o*(h*_-p*y)-c*(s*_-u*y)+m*(s*p-u*h),t[9]=-(r*(h*_-p*y)-c*(n*_-a*y)+m*(n*p-a*h)),t[10]=r*(s*_-u*y)-o*(n*_-a*y)+m*(n*u-a*s),t[11]=-(r*(s*p-u*h)-o*(n*p-a*h)+c*(n*u-a*s)),t[12]=-(o*(h*v-d*y)-c*(s*v-l*y)+m*(s*d-l*h)),t[13]=r*(h*v-d*y)-c*(n*v-i*y)+m*(n*d-i*h),t[14]=-(r*(s*v-l*y)-o*(n*v-i*y)+m*(n*l-i*s)),t[15]=r*(s*d-l*h)-o*(n*d-i*h)+c*(n*l-i*s),t}function p0e(t){var e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7],u=t[8],c=t[9],h=t[10],d=t[11],p=t[12],m=t[13],y=t[14],v=t[15],_=e*o-r*a,w=e*s-n*a,b=e*l-i*a,A=r*s-n*o,E=r*l-i*o,M=n*l-i*s,P=u*m-c*p,k=u*y-h*p,D=u*v-d*p,O=c*y-h*m,B=c*v-d*m,L=h*v-d*y;return _*L-w*B+b*O+A*D-E*k+M*P}function FG(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],p=e[10],m=e[11],y=e[12],v=e[13],_=e[14],w=e[15],b=r[0],A=r[1],E=r[2],M=r[3];return t[0]=b*n+A*s+E*h+M*y,t[1]=b*i+A*l+E*d+M*v,t[2]=b*a+A*u+E*p+M*_,t[3]=b*o+A*c+E*m+M*w,b=r[4],A=r[5],E=r[6],M=r[7],t[4]=b*n+A*s+E*h+M*y,t[5]=b*i+A*l+E*d+M*v,t[6]=b*a+A*u+E*p+M*_,t[7]=b*o+A*c+E*m+M*w,b=r[8],A=r[9],E=r[10],M=r[11],t[8]=b*n+A*s+E*h+M*y,t[9]=b*i+A*l+E*d+M*v,t[10]=b*a+A*u+E*p+M*_,t[11]=b*o+A*c+E*m+M*w,b=r[12],A=r[13],E=r[14],M=r[15],t[12]=b*n+A*s+E*h+M*y,t[13]=b*i+A*l+E*d+M*v,t[14]=b*a+A*u+E*p+M*_,t[15]=b*o+A*c+E*m+M*w,t}function f0e(t,e,r){var n=r[0],i=r[1],a=r[2],o,s,l,u,c,h,d,p,m,y,v,_;return e===t?(t[12]=e[0]*n+e[4]*i+e[8]*a+e[12],t[13]=e[1]*n+e[5]*i+e[9]*a+e[13],t[14]=e[2]*n+e[6]*i+e[10]*a+e[14],t[15]=e[3]*n+e[7]*i+e[11]*a+e[15]):(o=e[0],s=e[1],l=e[2],u=e[3],c=e[4],h=e[5],d=e[6],p=e[7],m=e[8],y=e[9],v=e[10],_=e[11],t[0]=o,t[1]=s,t[2]=l,t[3]=u,t[4]=c,t[5]=h,t[6]=d,t[7]=p,t[8]=m,t[9]=y,t[10]=v,t[11]=_,t[12]=o*n+c*i+m*a+e[12],t[13]=s*n+h*i+y*a+e[13],t[14]=l*n+d*i+v*a+e[14],t[15]=u*n+p*i+_*a+e[15]),t}function m0e(t,e,r){var n=r[0],i=r[1],a=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function g0e(t,e,r,n){var i=n[0],a=n[1],o=n[2],s=Math.hypot(i,a,o),l,u,c,h,d,p,m,y,v,_,w,b,A,E,M,P,k,D,O,B,L,R,T,N;return s<vr?null:(s=1/s,i*=s,a*=s,o*=s,l=Math.sin(r),u=Math.cos(r),c=1-u,h=e[0],d=e[1],p=e[2],m=e[3],y=e[4],v=e[5],_=e[6],w=e[7],b=e[8],A=e[9],E=e[10],M=e[11],P=i*i*c+u,k=a*i*c+o*l,D=o*i*c-a*l,O=i*a*c-o*l,B=a*a*c+u,L=o*a*c+i*l,R=i*o*c+a*l,T=a*o*c-i*l,N=o*o*c+u,t[0]=h*P+y*k+b*D,t[1]=d*P+v*k+A*D,t[2]=p*P+_*k+E*D,t[3]=m*P+w*k+M*D,t[4]=h*O+y*B+b*L,t[5]=d*O+v*B+A*L,t[6]=p*O+_*B+E*L,t[7]=m*O+w*B+M*L,t[8]=h*R+y*T+b*N,t[9]=d*R+v*T+A*N,t[10]=p*R+_*T+E*N,t[11]=m*R+w*T+M*N,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function y0e(t,e,r){var n=Math.sin(r),i=Math.cos(r),a=e[4],o=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+u*n,t[5]=o*i+c*n,t[6]=s*i+h*n,t[7]=l*i+d*n,t[8]=u*i-a*n,t[9]=c*i-o*n,t[10]=h*i-s*n,t[11]=d*i-l*n,t}function v0e(t,e,r){var n=Math.sin(r),i=Math.cos(r),a=e[0],o=e[1],s=e[2],l=e[3],u=e[8],c=e[9],h=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-u*n,t[1]=o*i-c*n,t[2]=s*i-h*n,t[3]=l*i-d*n,t[8]=a*n+u*i,t[9]=o*n+c*i,t[10]=s*n+h*i,t[11]=l*n+d*i,t}function _0e(t,e,r){var n=Math.sin(r),i=Math.cos(r),a=e[0],o=e[1],s=e[2],l=e[3],u=e[4],c=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+u*n,t[1]=o*i+c*n,t[2]=s*i+h*n,t[3]=l*i+d*n,t[4]=u*i-a*n,t[5]=c*i-o*n,t[6]=h*i-s*n,t[7]=d*i-l*n,t}function x0e(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function b0e(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function w0e(t,e,r){var n=r[0],i=r[1],a=r[2],o=Math.hypot(n,i,a),s,l,u;return o<vr?null:(o=1/o,n*=o,i*=o,a*=o,s=Math.sin(e),l=Math.cos(e),u=1-l,t[0]=n*n*u+l,t[1]=i*n*u+a*s,t[2]=a*n*u-i*s,t[3]=0,t[4]=n*i*u-a*s,t[5]=i*i*u+l,t[6]=a*i*u+n*s,t[7]=0,t[8]=n*a*u+i*s,t[9]=i*a*u-n*s,t[10]=a*a*u+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function A0e(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function S0e(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function E0e(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function RG(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=n+n,l=i+i,u=a+a,c=n*s,h=n*l,d=n*u,p=i*l,m=i*u,y=a*u,v=o*s,_=o*l,w=o*u;return t[0]=1-(p+y),t[1]=h+w,t[2]=d-_,t[3]=0,t[4]=h-w,t[5]=1-(c+y),t[6]=m+v,t[7]=0,t[8]=d+_,t[9]=m-v,t[10]=1-(c+p),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function I0e(t,e){var r=new Tn(3),n=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=n*n+i*i+a*a+o*o;return h>0?(r[0]=(s*o+c*n+l*a-u*i)*2/h,r[1]=(l*o+c*i+u*n-s*a)*2/h,r[2]=(u*o+c*a+s*i-l*n)*2/h):(r[0]=(s*o+c*n+l*a-u*i)*2,r[1]=(l*o+c*i+u*n-s*a)*2,r[2]=(u*o+c*a+s*i-l*n)*2),RG(t,e,r),t}function C0e(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function LG(t,e){var r=e[0],n=e[1],i=e[2],a=e[4],o=e[5],s=e[6],l=e[8],u=e[9],c=e[10];return t[0]=Math.hypot(r,n,i),t[1]=Math.hypot(a,o,s),t[2]=Math.hypot(l,u,c),t}function M0e(t,e){var r=new Tn(3);LG(r,e);var n=1/r[0],i=1/r[1],a=1/r[2],o=e[0]*n,s=e[1]*i,l=e[2]*a,u=e[4]*n,c=e[5]*i,h=e[6]*a,d=e[8]*n,p=e[9]*i,m=e[10]*a,y=o+c+m,v=0;return y>0?(v=Math.sqrt(y+1)*2,t[3]=.25*v,t[0]=(h-p)/v,t[1]=(d-l)/v,t[2]=(s-u)/v):o>c&&o>m?(v=Math.sqrt(1+o-c-m)*2,t[3]=(h-p)/v,t[0]=.25*v,t[1]=(s+u)/v,t[2]=(d+l)/v):c>m?(v=Math.sqrt(1+c-o-m)*2,t[3]=(d-l)/v,t[0]=(s+u)/v,t[1]=.25*v,t[2]=(h+p)/v):(v=Math.sqrt(1+m-o-c)*2,t[3]=(s-u)/v,t[0]=(d+l)/v,t[1]=(h+p)/v,t[2]=.25*v),t}function T0e(t,e,r,n){var i=e[0],a=e[1],o=e[2],s=e[3],l=i+i,u=a+a,c=o+o,h=i*l,d=i*u,p=i*c,m=a*u,y=a*c,v=o*c,_=s*l,w=s*u,b=s*c,A=n[0],E=n[1],M=n[2];return t[0]=(1-(m+v))*A,t[1]=(d+b)*A,t[2]=(p-w)*A,t[3]=0,t[4]=(d-b)*E,t[5]=(1-(h+v))*E,t[6]=(y+_)*E,t[7]=0,t[8]=(p+w)*M,t[9]=(y-_)*M,t[10]=(1-(h+m))*M,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function P0e(t,e,r,n,i){var a=e[0],o=e[1],s=e[2],l=e[3],u=a+a,c=o+o,h=s+s,d=a*u,p=a*c,m=a*h,y=o*c,v=o*h,_=s*h,w=l*u,b=l*c,A=l*h,E=n[0],M=n[1],P=n[2],k=i[0],D=i[1],O=i[2],B=(1-(y+_))*E,L=(p+A)*E,R=(m-b)*E,T=(p-A)*M,N=(1-(d+_))*M,$=(v+w)*M,V=(m+b)*P,G=(v-w)*P,ee=(1-(d+y))*P;return t[0]=B,t[1]=L,t[2]=R,t[3]=0,t[4]=T,t[5]=N,t[6]=$,t[7]=0,t[8]=V,t[9]=G,t[10]=ee,t[11]=0,t[12]=r[0]+k-(B*k+T*D+V*O),t[13]=r[1]+D-(L*k+N*D+G*O),t[14]=r[2]+O-(R*k+$*D+ee*O),t[15]=1,t}function D0e(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r+r,s=n+n,l=i+i,u=r*o,c=n*o,h=n*s,d=i*o,p=i*s,m=i*l,y=a*o,v=a*s,_=a*l;return t[0]=1-h-m,t[1]=c+_,t[2]=d-v,t[3]=0,t[4]=c-_,t[5]=1-u-m,t[6]=p+y,t[7]=0,t[8]=d+v,t[9]=p-y,t[10]=1-u-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function k0e(t,e,r,n,i,a,o){var s=1/(r-e),l=1/(i-n),u=1/(a-o);return t[0]=a*2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a*2*l,t[6]=0,t[7]=0,t[8]=(r+e)*s,t[9]=(i+n)*l,t[10]=(o+a)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*u,t[15]=0,t}function NG(t,e,r,n,i){var a=1/Math.tan(e/2),o;return t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(o=1/(n-i),t[10]=(i+n)*o,t[14]=2*i*n*o):(t[10]=-1,t[14]=-2*n),t}var O0e=NG;function B0e(t,e,r,n,i){var a=1/Math.tan(e/2),o;return t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(o=1/(n-i),t[10]=i*o,t[14]=i*n*o):(t[10]=-1,t[14]=-n),t}function z0e(t,e,r,n){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+s),u=2/(i+a);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-((o-s)*l*.5),t[9]=(i-a)*u*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t}function $G(t,e,r,n,i,a,o){var s=1/(e-r),l=1/(n-i),u=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+r)*s,t[13]=(i+n)*l,t[14]=(o+a)*u,t[15]=1,t}var F0e=$G;function R0e(t,e,r,n,i,a,o){var s=1/(e-r),l=1/(n-i),u=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=u,t[11]=0,t[12]=(e+r)*s,t[13]=(i+n)*l,t[14]=a*u,t[15]=1,t}function L0e(t,e,r,n){var i,a,o,s,l,u,c,h,d,p,m=e[0],y=e[1],v=e[2],_=n[0],w=n[1],b=n[2],A=r[0],E=r[1],M=r[2];return Math.abs(m-A)<vr&&Math.abs(y-E)<vr&&Math.abs(v-M)<vr?zG(t):(c=m-A,h=y-E,d=v-M,p=1/Math.hypot(c,h,d),c*=p,h*=p,d*=p,i=w*d-b*h,a=b*c-_*d,o=_*h-w*c,p=Math.hypot(i,a,o),p?(p=1/p,i*=p,a*=p,o*=p):(i=0,a=0,o=0),s=h*o-d*a,l=d*i-c*o,u=c*a-h*i,p=Math.hypot(s,l,u),p?(p=1/p,s*=p,l*=p,u*=p):(s=0,l=0,u=0),t[0]=i,t[1]=s,t[2]=c,t[3]=0,t[4]=a,t[5]=l,t[6]=h,t[7]=0,t[8]=o,t[9]=u,t[10]=d,t[11]=0,t[12]=-(i*m+a*y+o*v),t[13]=-(s*m+l*y+u*v),t[14]=-(c*m+h*y+d*v),t[15]=1,t)}function N0e(t,e,r,n){var i=e[0],a=e[1],o=e[2],s=n[0],l=n[1],u=n[2],c=i-r[0],h=a-r[1],d=o-r[2],p=c*c+h*h+d*d;p>0&&(p=1/Math.sqrt(p),c*=p,h*=p,d*=p);var m=l*d-u*h,y=u*c-s*d,v=s*h-l*c;return p=m*m+y*y+v*v,p>0&&(p=1/Math.sqrt(p),m*=p,y*=p,v*=p),t[0]=m,t[1]=y,t[2]=v,t[3]=0,t[4]=h*v-d*y,t[5]=d*m-c*v,t[6]=c*y-h*m,t[7]=0,t[8]=c,t[9]=h,t[10]=d,t[11]=0,t[12]=i,t[13]=a,t[14]=o,t[15]=1,t}function $0e(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function U0e(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function j0e(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function UG(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function V0e(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}function G0e(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t}function Z0e(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function W0e(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],p=t[11],m=t[12],y=t[13],v=t[14],_=t[15],w=e[0],b=e[1],A=e[2],E=e[3],M=e[4],P=e[5],k=e[6],D=e[7],O=e[8],B=e[9],L=e[10],R=e[11],T=e[12],N=e[13],$=e[14],V=e[15];return Math.abs(r-w)<=vr*Math.max(1,Math.abs(r),Math.abs(w))&&Math.abs(n-b)<=vr*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(i-A)<=vr*Math.max(1,Math.abs(i),Math.abs(A))&&Math.abs(a-E)<=vr*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(o-M)<=vr*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(s-P)<=vr*Math.max(1,Math.abs(s),Math.abs(P))&&Math.abs(l-k)<=vr*Math.max(1,Math.abs(l),Math.abs(k))&&Math.abs(u-D)<=vr*Math.max(1,Math.abs(u),Math.abs(D))&&Math.abs(c-O)<=vr*Math.max(1,Math.abs(c),Math.abs(O))&&Math.abs(h-B)<=vr*Math.max(1,Math.abs(h),Math.abs(B))&&Math.abs(d-L)<=vr*Math.max(1,Math.abs(d),Math.abs(L))&&Math.abs(p-R)<=vr*Math.max(1,Math.abs(p),Math.abs(R))&&Math.abs(m-T)<=vr*Math.max(1,Math.abs(m),Math.abs(T))&&Math.abs(y-N)<=vr*Math.max(1,Math.abs(y),Math.abs(N))&&Math.abs(v-$)<=vr*Math.max(1,Math.abs(v),Math.abs($))&&Math.abs(_-V)<=vr*Math.max(1,Math.abs(_),Math.abs(V))}var H0e=FG,X0e=UG,qA={};So(qA,{add:()=>mve,calculateW:()=>ive,clone:()=>hve,conjugate:()=>lve,copy:()=>pve,create:()=>jC,dot:()=>xZ,equals:()=>bve,exactEquals:()=>xve,exp:()=>gZ,fromEuler:()=>uve,fromMat3:()=>vZ,fromValues:()=>dve,getAngle:()=>eve,getAxisAngle:()=>Qye,identity:()=>Kye,invert:()=>sve,len:()=>vve,length:()=>bZ,lerp:()=>yve,ln:()=>yZ,mul:()=>gve,multiply:()=>mZ,normalize:()=>x5,pow:()=>ave,random:()=>ove,rotateX:()=>tve,rotateY:()=>rve,rotateZ:()=>nve,rotationTo:()=>wve,scale:()=>_Z,set:()=>fve,setAxes:()=>Sve,setAxisAngle:()=>fZ,slerp:()=>jb,sqlerp:()=>Ave,sqrLen:()=>_ve,squaredLength:()=>wZ,str:()=>cve});C();var Qe={};So(Qe,{add:()=>K0e,angle:()=>vye,bezier:()=>cye,ceil:()=>Q0e,clone:()=>q0e,copy:()=>Y0e,create:()=>g5,cross:()=>Ub,dist:()=>Iye,distance:()=>WG,div:()=>Eye,divide:()=>ZG,dot:()=>y5,equals:()=>wye,exactEquals:()=>bye,floor:()=>eye,forEach:()=>Tye,fromValues:()=>UC,hermite:()=>uye,inverse:()=>sye,len:()=>YG,length:()=>jG,lerp:()=>lye,max:()=>rye,min:()=>tye,mul:()=>Sye,multiply:()=>GG,negate:()=>oye,normalize:()=>qG,random:()=>hye,rotateX:()=>mye,rotateY:()=>gye,rotateZ:()=>yye,round:()=>nye,scale:()=>iye,scaleAndAdd:()=>aye,set:()=>J0e,sqrDist:()=>Cye,sqrLen:()=>Mye,squaredDistance:()=>HG,squaredLength:()=>XG,str:()=>xye,sub:()=>Aye,subtract:()=>VG,transformMat3:()=>pye,transformMat4:()=>dye,transformQuat:()=>fye,zero:()=>_ye});C();function g5(){var t=new Tn(3);return Tn!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function q0e(t){var e=new Tn(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function jG(t){var e=t[0],r=t[1],n=t[2];return Math.hypot(e,r,n)}function UC(t,e,r){var n=new Tn(3);return n[0]=t,n[1]=e,n[2]=r,n}function Y0e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function J0e(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t}function K0e(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function VG(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function GG(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function ZG(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function Q0e(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function eye(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function tye(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t}function rye(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t}function nye(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function iye(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function aye(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t}function WG(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return Math.hypot(r,n,i)}function HG(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return r*r+n*n+i*i}function XG(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n}function oye(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function sye(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function qG(t,e){var r=e[0],n=e[1],i=e[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function y5(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ub(t,e,r){var n=e[0],i=e[1],a=e[2],o=r[0],s=r[1],l=r[2];return t[0]=i*l-a*s,t[1]=a*o-n*l,t[2]=n*s-i*o,t}function lye(t,e,r,n){var i=e[0],a=e[1],o=e[2];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t[2]=o+n*(r[2]-o),t}function uye(t,e,r,n,i,a){var o=a*a,s=o*(2*a-3)+1,l=o*(a-2)+a,u=o*(a-1),c=o*(3-2*a);return t[0]=e[0]*s+r[0]*l+n[0]*u+i[0]*c,t[1]=e[1]*s+r[1]*l+n[1]*u+i[1]*c,t[2]=e[2]*s+r[2]*l+n[2]*u+i[2]*c,t}function cye(t,e,r,n,i,a){var o=1-a,s=o*o,l=a*a,u=s*o,c=3*a*s,h=3*l*o,d=l*a;return t[0]=e[0]*u+r[0]*c+n[0]*h+i[0]*d,t[1]=e[1]*u+r[1]*c+n[1]*h+i[1]*d,t[2]=e[2]*u+r[2]*c+n[2]*h+i[2]*d,t}function hye(t,e){e=e||1;var r=_u()*2*Math.PI,n=_u()*2-1,i=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*i,t[1]=Math.sin(r)*i,t[2]=n*e,t}function dye(t,e,r){var n=e[0],i=e[1],a=e[2],o=r[3]*n+r[7]*i+r[11]*a+r[15];return o=o||1,t[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/o,t[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/o,t[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/o,t}function pye(t,e,r){var n=e[0],i=e[1],a=e[2];return t[0]=n*r[0]+i*r[3]+a*r[6],t[1]=n*r[1]+i*r[4]+a*r[7],t[2]=n*r[2]+i*r[5]+a*r[8],t}function fye(t,e,r){var n=r[0],i=r[1],a=r[2],o=r[3],s=e[0],l=e[1],u=e[2],c=i*u-a*l,h=a*s-n*u,d=n*l-i*s,p=i*d-a*h,m=a*c-n*d,y=n*h-i*c,v=o*2;return c*=v,h*=v,d*=v,p*=2,m*=2,y*=2,t[0]=s+c+p,t[1]=l+h+m,t[2]=u+d+y,t}function mye(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function gye(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function yye(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function vye(t,e){var r=t[0],n=t[1],i=t[2],a=e[0],o=e[1],s=e[2],l=Math.sqrt(r*r+n*n+i*i),u=Math.sqrt(a*a+o*o+s*s),c=l*u,h=c&&y5(t,e)/c;return Math.acos(Math.min(Math.max(h,-1),1))}function _ye(t){return t[0]=0,t[1]=0,t[2]=0,t}function xye(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function bye(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function wye(t,e){var r=t[0],n=t[1],i=t[2],a=e[0],o=e[1],s=e[2];return Math.abs(r-a)<=vr*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-o)<=vr*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-s)<=vr*Math.max(1,Math.abs(i),Math.abs(s))}var Aye=VG,Sye=GG,Eye=ZG,Iye=WG,Cye=HG,YG=jG,Mye=XG,Tye=(function(){var t=g5();return function(e,r,n,i,a,o){var s,l;for(r||(r=3),n||(n=0),i?l=Math.min(i*r+n,e.length):l=e.length,s=n;s<l;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],a(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}})(),Pi={};So(Pi,{add:()=>rZ,ceil:()=>Pye,clone:()=>KG,copy:()=>eZ,create:()=>JG,cross:()=>Lye,dist:()=>Hye,distance:()=>sZ,div:()=>Wye,divide:()=>aZ,dot:()=>cZ,equals:()=>pZ,exactEquals:()=>dZ,floor:()=>Dye,forEach:()=>Jye,fromValues:()=>QG,inverse:()=>Rye,len:()=>qye,length:()=>v5,lerp:()=>hZ,max:()=>Oye,min:()=>kye,mul:()=>Zye,multiply:()=>iZ,negate:()=>Fye,normalize:()=>uZ,random:()=>Nye,round:()=>Bye,scale:()=>oZ,scaleAndAdd:()=>zye,set:()=>tZ,sqrDist:()=>Xye,sqrLen:()=>Yye,squaredDistance:()=>lZ,squaredLength:()=>_5,str:()=>Vye,sub:()=>Gye,subtract:()=>nZ,transformMat4:()=>$ye,transformQuat:()=>Uye,zero:()=>jye});C();function JG(){var t=new Tn(4);return Tn!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function KG(t){var e=new Tn(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function QG(t,e,r,n){var i=new Tn(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i}function eZ(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function tZ(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t}function rZ(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function nZ(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function iZ(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function aZ(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function Pye(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Dye(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function kye(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t}function Oye(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t}function Bye(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function oZ(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function zye(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t}function sZ(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],a=e[3]-t[3];return Math.hypot(r,n,i,a)}function lZ(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],a=e[3]-t[3];return r*r+n*n+i*i+a*a}function v5(t){var e=t[0],r=t[1],n=t[2],i=t[3];return Math.hypot(e,r,n,i)}function _5(t){var e=t[0],r=t[1],n=t[2],i=t[3];return e*e+r*r+n*n+i*i}function Fye(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function Rye(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function uZ(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r*r+n*n+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),t[0]=r*o,t[1]=n*o,t[2]=i*o,t[3]=a*o,t}function cZ(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Lye(t,e,r,n){var i=r[0]*n[1]-r[1]*n[0],a=r[0]*n[2]-r[2]*n[0],o=r[0]*n[3]-r[3]*n[0],s=r[1]*n[2]-r[2]*n[1],l=r[1]*n[3]-r[3]*n[1],u=r[2]*n[3]-r[3]*n[2],c=e[0],h=e[1],d=e[2],p=e[3];return t[0]=h*u-d*l+p*s,t[1]=-(c*u)+d*o-p*a,t[2]=c*l-h*o+p*i,t[3]=-(c*s)+h*a-d*i,t}function hZ(t,e,r,n){var i=e[0],a=e[1],o=e[2],s=e[3];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t[2]=o+n*(r[2]-o),t[3]=s+n*(r[3]-s),t}function Nye(t,e){e=e||1;var r,n,i,a,o,s;do r=_u()*2-1,n=_u()*2-1,o=r*r+n*n;while(o>=1);do i=_u()*2-1,a=_u()*2-1,s=i*i+a*a;while(s>=1);var l=Math.sqrt((1-o)/s);return t[0]=e*r,t[1]=e*n,t[2]=e*i*l,t[3]=e*a*l,t}function $ye(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o,t[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o,t[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o,t[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o,t}function Uye(t,e,r){var n=e[0],i=e[1],a=e[2],o=r[0],s=r[1],l=r[2],u=r[3],c=u*n+s*a-l*i,h=u*i+l*n-o*a,d=u*a+o*i-s*n,p=-o*n-s*i-l*a;return t[0]=c*u+p*-o+h*-l-d*-s,t[1]=h*u+p*-s+d*-o-c*-l,t[2]=d*u+p*-l+c*-s-h*-o,t[3]=e[3],t}function jye(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function Vye(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function dZ(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function pZ(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=e[0],s=e[1],l=e[2],u=e[3];return Math.abs(r-o)<=vr*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=vr*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-l)<=vr*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(a-u)<=vr*Math.max(1,Math.abs(a),Math.abs(u))}var Gye=nZ,Zye=iZ,Wye=aZ,Hye=sZ,Xye=lZ,qye=v5,Yye=_5,Jye=(function(){var t=JG();return function(e,r,n,i,a,o){var s,l;for(r||(r=4),n||(n=0),i?l=Math.min(i*r+n,e.length):l=e.length,s=n;s<l;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],a(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}})();function jC(){var t=new Tn(4);return Tn!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Kye(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function fZ(t,e,r){r=r*.5;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function Qye(t,e){var r=Math.acos(e[3])*2,n=Math.sin(r/2);return n>vr?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),r}function eve(t,e){var r=xZ(t,e);return Math.acos(2*r*r-1)}function mZ(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=r[0],l=r[1],u=r[2],c=r[3];return t[0]=n*c+o*s+i*u-a*l,t[1]=i*c+o*l+a*s-n*u,t[2]=a*c+o*u+n*l-i*s,t[3]=o*c-n*s-i*l-a*u,t}function tve(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(r),l=Math.cos(r);return t[0]=n*l+o*s,t[1]=i*l+a*s,t[2]=a*l-i*s,t[3]=o*l-n*s,t}function rve(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(r),l=Math.cos(r);return t[0]=n*l-a*s,t[1]=i*l+o*s,t[2]=a*l+n*s,t[3]=o*l-i*s,t}function nve(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(r),l=Math.cos(r);return t[0]=n*l+i*s,t[1]=i*l-n*s,t[2]=a*l+o*s,t[3]=o*l-a*s,t}function ive(t,e){var r=e[0],n=e[1],i=e[2];return t[0]=r,t[1]=n,t[2]=i,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),t}function gZ(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=Math.sqrt(r*r+n*n+i*i),s=Math.exp(a),l=o>0?s*Math.sin(o)/o:0;return t[0]=r*l,t[1]=n*l,t[2]=i*l,t[3]=s*Math.cos(o),t}function yZ(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=Math.sqrt(r*r+n*n+i*i),s=o>0?Math.atan2(o,a)/o:0;return t[0]=r*s,t[1]=n*s,t[2]=i*s,t[3]=.5*Math.log(r*r+n*n+i*i+a*a),t}function ave(t,e,r){return yZ(t,e),_Z(t,t,r),gZ(t,t),t}function jb(t,e,r,n){var i=e[0],a=e[1],o=e[2],s=e[3],l=r[0],u=r[1],c=r[2],h=r[3],d,p,m,y,v;return p=i*l+a*u+o*c+s*h,p<0&&(p=-p,l=-l,u=-u,c=-c,h=-h),1-p>vr?(d=Math.acos(p),m=Math.sin(d),y=Math.sin((1-n)*d)/m,v=Math.sin(n*d)/m):(y=1-n,v=n),t[0]=y*i+v*l,t[1]=y*a+v*u,t[2]=y*o+v*c,t[3]=y*s+v*h,t}function ove(t){var e=_u(),r=_u(),n=_u(),i=Math.sqrt(1-e),a=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*r),t[1]=i*Math.cos(2*Math.PI*r),t[2]=a*Math.sin(2*Math.PI*n),t[3]=a*Math.cos(2*Math.PI*n),t}function sve(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r*r+n*n+i*i+a*a,s=o?1/o:0;return t[0]=-r*s,t[1]=-n*s,t[2]=-i*s,t[3]=a*s,t}function lve(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function vZ(t,e){var r=e[0]+e[4]+e[8],n;if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;n=Math.sqrt(e[i*3+i]-e[a*3+a]-e[o*3+o]+1),t[i]=.5*n,n=.5/n,t[3]=(e[a*3+o]-e[o*3+a])*n,t[a]=(e[a*3+i]+e[i*3+a])*n,t[o]=(e[o*3+i]+e[i*3+o])*n}return t}function uve(t,e,r,n){var i=.5*Math.PI/180;e*=i,r*=i,n*=i;var a=Math.sin(e),o=Math.cos(e),s=Math.sin(r),l=Math.cos(r),u=Math.sin(n),c=Math.cos(n);return t[0]=a*l*c-o*s*u,t[1]=o*s*c+a*l*u,t[2]=o*l*u-a*s*c,t[3]=o*l*c+a*s*u,t}function cve(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var hve=KG,dve=QG,pve=eZ,fve=tZ,mve=rZ,gve=mZ,_Z=oZ,xZ=cZ,yve=hZ,bZ=v5,vve=bZ,wZ=_5,_ve=wZ,x5=uZ,xve=dZ,bve=pZ,wve=(function(){var t=g5(),e=UC(1,0,0),r=UC(0,1,0);return function(n,i,a){var o=y5(i,a);return o<-.999999?(Ub(t,e,i),YG(t)<1e-6&&Ub(t,r,i),qG(t,t),fZ(n,t,Math.PI),n):o>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(Ub(t,i,a),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+o,x5(n,n))}})(),Ave=(function(){var t=jC(),e=jC();return function(r,n,i,a,o,s){return jb(t,n,o,s),jb(e,i,a,s),jb(r,t,e,2*s*(1-s)),r}})(),Sve=(function(){var t=kG();return function(e,r,n,i){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],x5(e,vZ(e,t))}})(),No={};So(No,{add:()=>Tve,angle:()=>qve,ceil:()=>Pve,clone:()=>Eve,copy:()=>Cve,create:()=>AZ,cross:()=>Uve,dist:()=>i1e,distance:()=>CZ,div:()=>n1e,divide:()=>IZ,dot:()=>$ve,equals:()=>Qve,exactEquals:()=>Kve,floor:()=>Dve,forEach:()=>s1e,fromValues:()=>Ive,inverse:()=>Lve,len:()=>e1e,length:()=>TZ,lerp:()=>jve,max:()=>Ove,min:()=>kve,mul:()=>r1e,multiply:()=>EZ,negate:()=>Rve,normalize:()=>Nve,random:()=>Vve,rotate:()=>Xve,round:()=>Bve,scale:()=>zve,scaleAndAdd:()=>Fve,set:()=>Mve,sqrDist:()=>a1e,sqrLen:()=>o1e,squaredDistance:()=>MZ,squaredLength:()=>PZ,str:()=>Jve,sub:()=>t1e,subtract:()=>SZ,transformMat2:()=>Gve,transformMat2d:()=>Zve,transformMat3:()=>Wve,transformMat4:()=>Hve,zero:()=>Yve});C();function AZ(){var t=new Tn(2);return Tn!=Float32Array&&(t[0]=0,t[1]=0),t}function Eve(t){var e=new Tn(2);return e[0]=t[0],e[1]=t[1],e}function Ive(t,e){var r=new Tn(2);return r[0]=t,r[1]=e,r}function Cve(t,e){return t[0]=e[0],t[1]=e[1],t}function Mve(t,e,r){return t[0]=e,t[1]=r,t}function Tve(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function SZ(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function EZ(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function IZ(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function Pve(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function Dve(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function kve(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t}function Ove(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t}function Bve(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function zve(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t}function Fve(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t}function CZ(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.hypot(r,n)}function MZ(t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n}function TZ(t){var e=t[0],r=t[1];return Math.hypot(e,r)}function PZ(t){var e=t[0],r=t[1];return e*e+r*r}function Rve(t,e){return t[0]=-e[0],t[1]=-e[1],t}function Lve(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function Nve(t,e){var r=e[0],n=e[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}function $ve(t,e){return t[0]*e[0]+t[1]*e[1]}function Uve(t,e,r){var n=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=n,t}function jve(t,e,r,n){var i=e[0],a=e[1];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t}function Vve(t,e){e=e||1;var r=_u()*2*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t}function Gve(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i,t[1]=r[1]*n+r[3]*i,t}function Zve(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i+r[4],t[1]=r[1]*n+r[3]*i+r[5],t}function Wve(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[3]*i+r[6],t[1]=r[1]*n+r[4]*i+r[7],t}function Hve(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[4]*i+r[12],t[1]=r[1]*n+r[5]*i+r[13],t}function Xve(t,e,r,n){var i=e[0]-r[0],a=e[1]-r[1],o=Math.sin(n),s=Math.cos(n);return t[0]=i*s-a*o+r[0],t[1]=i*o+a*s+r[1],t}function qve(t,e){var r=t[0],n=t[1],i=e[0],a=e[1],o=Math.sqrt(r*r+n*n)*Math.sqrt(i*i+a*a),s=o&&(r*i+n*a)/o;return Math.acos(Math.min(Math.max(s,-1),1))}function Yve(t){return t[0]=0,t[1]=0,t}function Jve(t){return"vec2("+t[0]+", "+t[1]+")"}function Kve(t,e){return t[0]===e[0]&&t[1]===e[1]}function Qve(t,e){var r=t[0],n=t[1],i=e[0],a=e[1];return Math.abs(r-i)<=vr*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-a)<=vr*Math.max(1,Math.abs(n),Math.abs(a))}var e1e=TZ,t1e=SZ,r1e=EZ,n1e=IZ,i1e=CZ,a1e=MZ,o1e=PZ,s1e=(function(){var t=AZ();return function(e,r,n,i,a,o){var s,l;for(r||(r=2),n||(n=0),i?l=Math.min(i*r+n,e.length):l=e.length,s=n;s<l;s+=r)t[0]=e[s],t[1]=e[s+1],a(t,t,o),e[s]=t[0],e[s+1]=t[1];return e}})();C();C();function xs(t,e,r){return e*(8192/(t.tileSize*Math.pow(2,r-t.tileID.overscaledZ)))}function ny(){return new Float64Array(4)}function Li(){return new Float64Array(3)}function Wh(){return new Float64Array(16)}function Lf(){let t=new Float64Array(16);return Xe.identity(t),t}function DZ(){let t=new Float32Array(16);return Xe.identity(t),t}function cd(t,e,r,n,i=!1){if(!r[0]&&!r[1])return[0,0];let a=i?n==="map"?-t.bearingInRadians:0:n==="viewport"?t.bearingInRadians:0;if(a){let o=Math.sin(a),s=Math.cos(a);r=[r[0]*s-r[1]*o,r[0]*o+r[1]*s]}return[i?r[0]:xs(e,r[0],t.zoom),i?r[1]:xs(e,r[1],t.zoom)]}function VC(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]}function Ds(t,e,r){let n=o1.determinant([t[0],t[1],t[2],e[0],e[1],e[2],r[0],r[1],r[2]]);if(n===0)return null;let i=Qe.cross([],[e[0],e[1],e[2]],[r[0],r[1],r[2]]),a=Qe.cross([],[r[0],r[1],r[2]],[t[0],t[1],t[2]]),o=Qe.cross([],[t[0],t[1],t[2]],[e[0],e[1],e[2]]),s=Qe.scale([],i,-t[3]);return Qe.add(s,s,Qe.scale([],a,-e[3])),Qe.add(s,s,Qe.scale([],o,-r[3])),Qe.scale(s,s,1/n),s}function l1e(t,e,r){let n=t[0]*r[0]+t[1]*r[1]+t[2]*r[2],i=e[0]*r[0]+e[1]*r[1]+e[2]*r[2];return i===0?null:(-n-r[3])/i}function Tx(t,e,r,n){let i=Math.sqrt(t*t+e*e),a=Math.sqrt(r*r+n*n);t/=i,e/=i,r/=a,n/=a;let o=t*r+e*n,s=Math.acos(o);return-e*r+t*n>0?s:-s}function os(t,e){let r=Tg(t,360),n=Tg(e,360),i=n-r,a=n>r?i-360:i+360;return Math.abs(i)<Math.abs(a)?i:a}function Px(t,e){let r=Tg(t,Math.PI*2),n=Tg(e,Math.PI*2);return Math.min(Math.abs(r-n),Math.abs(r-n+Math.PI*2),Math.abs(r-n-Math.PI*2))}function Tg(t,e){return(t%e+e)%e}function Vb(t,e,r,n,i){let a=on((t-e)/(r-e),0,1);return rg(n,i,a)}function rg(t,e,r){return t*(1-r)+e*r}function u1e(t){let e=1/0,r=1/0,n=-1/0,i=-1/0;for(let a of t)e=Math.min(e,a.x),r=Math.min(r,a.y),n=Math.max(n,a.x),i=Math.max(i,a.y);return[e,r,n,i]}function kZ(t){if(t<=0)return 0;if(t>=1)return 1;let e=t*t,r=e*t;return 4*(t<.5?r:3*(t-e)+r-.75)}function b5(t,e,r,n){let i=new ige.default(t,e,r,n);return a=>i.solve(a)}var GC=b5(.25,.1,.25,1);function on(t,e,r){return Math.min(r,Math.max(e,t))}function Mp(t,e,r){let n=r-e,i=((t-e)%n+n)%n+e;return i===e?r:i}function c1e(t,e){let r=[];for(let n in t)n in e||r.push(n);return r}function zt(t,...e){for(let r of e)for(let n in r)t[n]=r[n];return t}function r_(t,e){let r={};for(let n=0;n<e.length;n++){let i=e[n];i in t&&(r[i]=t[i])}return r}var h1e=1;function OZ(){return h1e++}function d1e(t){return Math.log(t)/Math.LN2%1===0}function p1e(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function mo(t){return Math.pow(2,t)}function go(t){return Math.log(t)/Math.LN2}function w5(t,e,r){let n={};for(let i in t)n[i]=e.call(this,t[i],i,t);return n}function BZ(t,e,r){let n={};for(let i in t)e.call(this,t[i],i,t)&&(n[i]=t[i]);return n}function uu(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!uu(t[r],e[r]))return!1;return!0}if(typeof t=="object"&&t!==null&&e!==null){if(typeof e!="object"||Object.keys(t).length!==Object.keys(e).length)return!1;for(let r in t)if(!uu(t[r],e[r]))return!1;return!0}return t===e}function $o(t){return Array.isArray(t)?t.map($o):typeof t=="object"&&t?w5(t,$o):t}var wz={};function Ui(t){wz[t]||(typeof console<"u"&&console.warn(t),wz[t]=!0)}function Jh(t,e,r){return(r.y-t.y)*(e.x-t.x)>(e.y-t.y)*(r.x-t.x)}function f1e(t,e,r,n){let i=e.y-t.y,a=e.x-t.x,o=n.y-r.y,s=n.x-r.x,l=o*a-s*i;if(l===0)return null;let u=t.y-r.y,c=t.x-r.x,h=(s*u-o*c)/l;return new nge.default(t.x+h*a,t.y+h*i)}function m1e([t,e,r]){return e+=90,e*=Math.PI/180,r*=Math.PI/180,{x:t*Math.cos(e)*Math.sin(r),y:t*Math.sin(e)*Math.sin(r),z:t*Math.cos(r)}}function Pg(t){return typeof WorkerGlobalScope<"u"&&typeof t<"u"&&t instanceof WorkerGlobalScope}function g1e(t){let e=/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,r={};if(t.replace(e,(n,i,a,o)=>{let s=a||o;return r[i]=s?s.toLowerCase():!0,""}),r["max-age"]){let n=parseInt(r["max-age"],10);isNaN(n)?delete r["max-age"]:r["max-age"]=n}return r}var _E=null;function y1e(t){if(_E==null){let e=t.navigator?t.navigator.userAgent:null;_E=!!t.safari||!!(e&&(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return _E}function Lc(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap}var v1e=async t=>{if(t.byteLength===0)return createImageBitmap(new ImageData(1,1));let e=new Blob([new Uint8Array(t)],{type:"image/png"});try{return createImageBitmap(e)}catch(r){throw new Error("Could not load image because of ".concat(r.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))}},Az="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",_1e=t=>new Promise((e,r)=>{let n=new Image;n.onload=()=>{e(n),URL.revokeObjectURL(n.src),n.onload=null,window.requestAnimationFrame(()=>{n.src=Az})},n.onerror=()=>r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));let i=new Blob([new Uint8Array(t)],{type:"image/png"});n.src=t.byteLength?URL.createObjectURL(i):Az});function x1e(t,e,r,n,i){let a=Math.max(-e,0)*4,o=(Math.max(0,r)-r)*n*4+a,s=n*4,l=Math.max(0,e),u=Math.max(0,r),c=Math.min(t.width,e+n),h=Math.min(t.height,r+i);return{rect:{x:l,y:u,width:c-l,height:h-u},layout:[{offset:o,stride:s}]}}async function b1e(t,e,r,n,i){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");let a=new VideoFrame(t,{timestamp:0});try{let o=a?.format;if(!o||!(o.startsWith("BGR")||o.startsWith("RGB")))throw new Error("Unrecognized format ".concat(o));let s=o.startsWith("BGR"),l=new Uint8ClampedArray(n*i*4);if(await a.copyTo(l,x1e(t,e,r,n,i)),s)for(let u=0;u<l.length;u+=4){let c=l[u];l[u]=l[u+2],l[u+2]=c}return l}finally{a.close()}}function ZC(t,e,r,n){return t.addEventListener(e,r,n),{unsubscribe:()=>{t.removeEventListener(e,r,n)}}}function Zn(t){return t*Math.PI/180}function Lm(t){return t/Math.PI*180}function zZ(t,e){return t.roll==e.roll&&t.pitch==e.pitch&&t.bearing==e.bearing}function w1e(t){let e=new Float64Array(9);o1.fromQuat(e,t);let r=Lm(-Math.asin(on(e[2],-1,1))),n,i;return Math.hypot(e[5],e[8])<.001?(n=0,i=-Lm(Math.atan2(e[3],e[4]))):(n=Lm(e[5]===0&&e[8]===0?0:Math.atan2(e[5],e[8])),i=Lm(e[1]===0&&e[0]===0?0:Math.atan2(e[1],e[0]))),{roll:n,pitch:r+90,bearing:i}}function A1e(t,e,r){let n=No.fromValues(e.x-r.x,e.y-r.y),i=No.fromValues(t.x-r.x,t.y-r.y),a=n[0]*i[1]-n[1]*i[0],o=Math.atan2(a,No.dot(n,i));return Lm(o)}function Sz(t,e,r){let n=new Float64Array(4);return qA.fromEuler(n,t,e-90,r),n}var YA=25,A5=0,Cu=85.051129,FZ={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},RZ={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0};function S1e(t,e){return FZ[e]&&"touches"in t}function E1e(t,e){return RZ[e]&&(t instanceof MouseEvent||t instanceof WheelEvent)}function I1e(t){return FZ[t]||RZ[t]}C();C();var LZ="AbortError";function C1e(t){return t.message===LZ}function JA(){return new Error(LZ)}var M1e=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),Dx,xE,Dr={now:M1e,frame(t,e,r){let n=requestAnimationFrame(a=>{i(),e(a)}),{unsubscribe:i}=ZC(t.signal,"abort",()=>{i(),cancelAnimationFrame(n),r(JA())},!1)},frameAsync(t){return new Promise((e,r)=>{this.frame(t,e,r)})},getImageData(t,e=0){return this.getImageCanvasContext(t).getImageData(-e,-e,t.width+2*e,t.height+2*e)},getImageCanvasContext(t){let e=window.document.createElement("canvas"),r=e.getContext("2d",{willReadFrequently:!0});if(!r)throw new Error("failed to create canvas 2d context");return e.width=t.width,e.height=t.height,r.drawImage(t,0,0,t.width,t.height),r},resolveURL(t){return Dx||(Dx=document.createElement("a")),Dx.href=t,Dx.href},hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return matchMedia?(xE==null&&(xE=matchMedia("(prefers-reduced-motion: reduce)")),xE.matches):!1}};C();var T1e=Zt(xr(),1),Nf=class kn{static testProp(e){if(!kn.docStyle)return e[0];for(let r=0;r<e.length;r++)if(e[r]in kn.docStyle)return e[r];return e[0]}static create(e,r,n){let i=window.document.createElement(e);return r!==void 0&&(i.className=r),n&&n.appendChild(i),i}static createNS(e,r){return window.document.createElementNS(e,r)}static disableDrag(){kn.docStyle&&kn.selectProp&&(kn.userSelect=kn.docStyle[kn.selectProp],kn.docStyle[kn.selectProp]="none")}static enableDrag(){kn.docStyle&&kn.selectProp&&(kn.docStyle[kn.selectProp]=kn.userSelect)}static setTransform(e,r){e.style[kn.transformProp]=r}static addEventListener(e,r,n,i={}){"passive"in i?e.addEventListener(r,n,i):e.addEventListener(r,n,i.capture)}static removeEventListener(e,r,n,i={}){"passive"in i?e.removeEventListener(r,n,i):e.removeEventListener(r,n,i.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",kn.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",kn.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",kn.suppressClickInternal,!0)},0)}static getScale(e){let r=e.getBoundingClientRect();return{x:r.width/e.offsetWidth||1,y:r.height/e.offsetHeight||1,boundingClientRect:r}}static getPoint(e,r,n){let i=r.boundingClientRect;return new T1e.default((n.clientX-i.left)/r.x-e.clientLeft,(n.clientY-i.top)/r.y-e.clientTop)}static mousePos(e,r){let n=kn.getScale(e);return kn.getPoint(e,n,r)}static touchPos(e,r){let n=[],i=kn.getScale(e);for(let a=0;a<r.length;a++)n.push(kn.getPoint(e,i,r[a]));return n}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){let r=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),n=r.querySelectorAll("script");for(let i of n)i.remove();return kn.clean(r),r.innerHTML}static isPossiblyDangerous(e,r){let n=r.replace(/\s+/g,"").toLowerCase();if(["src","href","xlink:href"].includes(e)&&(n.includes("javascript:")||n.includes("data:"))||e.startsWith("on"))return!0}static clean(e){let r=e.children;for(let n of r)kn.removeAttributes(n),kn.clean(n)}static removeAttributes(e){for(let{name:r,value:n}of e.attributes)kn.isPossiblyDangerous(r,n)&&e.removeAttribute(r)}};Nf.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,Nf.selectProp=Nf.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),Nf.transformProp=Nf.testProp(["transform","WebkitTransform"]);var Fr=Nf;C();C();C();var s1={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{}};function NZ(t){return s1.REGISTERED_PROTOCOLS[t.substring(0,t.indexOf("://"))]}C();var WC="global-dispatcher",b4=class extends Error{constructor(e,r,n,i){super("AJAXError: ".concat(r," (").concat(e,"): ").concat(n)),this.status=e,this.statusText=r,this.url=n,this.body=i}},S5=()=>Pg(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,P1e=t=>/^file:/.test(t)||/^file:/.test(S5())&&!/^\w+:/.test(t);async function D1e(t,e){let r=new Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,cache:t.cache,referrer:S5(),signal:e.signal});t.type==="json"&&!r.headers.has("Accept")&&r.headers.set("Accept","application/json");let n;try{n=await fetch(r)}catch(o){throw new b4(0,o.message,t.url,new Blob)}if(!n.ok){let o=await n.blob();throw new b4(n.status,n.statusText,t.url,o)}let i;t.type==="arrayBuffer"||t.type==="image"?i=n.arrayBuffer():t.type==="json"?i=n.json():i=n.text();let a=await i;if(e.signal.aborted)throw JA();return{data:a,cacheControl:n.headers.get("Cache-Control"),expires:n.headers.get("Expires")}}function k1e(t,e){return new Promise((r,n)=>{var i;let a=new XMLHttpRequest;a.open(t.method||"GET",t.url,!0),(t.type==="arrayBuffer"||t.type==="image")&&(a.responseType="arraybuffer");for(let o in t.headers)a.setRequestHeader(o,t.headers[o]);t.type==="json"&&(a.responseType="text",(i=t.headers)!=null&&i.Accept||a.setRequestHeader("Accept","application/json")),a.withCredentials=t.credentials==="include",a.onerror=()=>{n(new Error(a.statusText))},a.onload=()=>{if(!e.signal.aborted)if((a.status>=200&&a.status<300||a.status===0)&&a.response!==null){let o=a.response;if(t.type==="json")try{o=JSON.parse(a.response)}catch(s){n(s);return}r({data:o,cacheControl:a.getResponseHeader("Cache-Control"),expires:a.getResponseHeader("Expires")})}else{let o=new Blob([a.response],{type:a.getResponseHeader("Content-Type")});n(new b4(a.status,a.statusText,t.url,o))}},e.signal.addEventListener("abort",()=>{a.abort(),n(JA())}),a.send(t.body)})}var KA=function(t,e){if(/:\/\//.test(t.url)&&!/^https?:|^file:/.test(t.url)){let r=NZ(t.url);if(r)return r(t,e);if(Pg(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:t,targetMapId:WC},e)}if(!P1e(t.url)){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return D1e(t,e);if(Pg(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:t,mustQueue:!0,targetMapId:WC},e)}return k1e(t,e)},QA=(t,e)=>KA(zt(t,{type:"json"}),e),O1e=(t,e)=>KA(zt(t,{type:"arrayBuffer"}),e);function $Z(t){if(!t||t.indexOf("://")<=0||t.indexOf("data:image/")===0||t.indexOf("blob:")===0)return!0;let e=new URL(t),r=window.location;return e.protocol===r.protocol&&e.host===r.host}var B1e=t=>{let e=window.document.createElement("video");return e.muted=!0,new Promise(r=>{e.onloadstart=()=>{r(e)};for(let n of t){let i=window.document.createElement("source");$Z(n)||(e.crossOrigin="Anonymous"),i.src=n,e.appendChild(i)}})};C();C();var E5={supported:!1,testSupport:z1e},By,I5=!1,Nm,UZ=!1;typeof document<"u"&&(Nm=document.createElement("img"),Nm.onload=()=>{By&&jZ(By),By=null,UZ=!0},Nm.onerror=()=>{I5=!0,By=null},Nm.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");function z1e(t){I5||!Nm||(UZ?jZ(t):By=t)}function jZ(t){let e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,Nm),t.isContextLost())return;E5.supported=!0}catch{}t.deleteTexture(e),I5=!0}var Au;(t=>{let e,r,n,i;t.resetRequestQueue=()=>{e=[],r=0,n=0,i={}},t.addThrottleControl=c=>{let h=n++;return i[h]=c,h},t.removeThrottleControl=c=>{delete i[c],l()};let a=()=>{for(let c of Object.keys(i))if(i[c]())return!0;return!1};t.getImage=(c,h,d=!0)=>new Promise((p,m)=>{E5.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),zt(c,{type:"image"});let y={abortController:h,requestParameters:c,supportImageRefresh:d,state:"queued",onError:v=>{m(v)},onSuccess:v=>{p(v)}};e.push(y),l()});let o=c=>typeof createImageBitmap=="function"?v1e(c):_1e(c),s=async c=>{c.state="running";let{requestParameters:h,supportImageRefresh:d,onError:p,onSuccess:m,abortController:y}=c,v=d===!1&&!Pg(self)&&!NZ(h.url)&&(!h.headers||Object.keys(h.headers).reduce((w,b)=>w&&b==="accept",!0));r++;let _=v?u(h,y):KA(h,y);try{let w=await _;if(delete c.abortController,c.state="completed",w.data instanceof HTMLImageElement||Lc(w.data))m(w);else if(w.data){let b=await o(w.data);m({data:b,cacheControl:w.cacheControl,expires:w.expires})}}catch(w){delete c.abortController,p(w)}finally{r--,l()}},l=()=>{let c=a()?s1.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:s1.MAX_PARALLEL_IMAGE_REQUESTS;for(let h=r;h<c&&e.length>0;h++){let d=e.shift();if(d.abortController.signal.aborted){h--;continue}s(d)}},u=(c,h)=>new Promise((d,p)=>{let m=new Image,y=c.url,v=c.credentials;v&&v==="include"?m.crossOrigin="use-credentials":(v&&v==="same-origin"||!$Z(y))&&(m.crossOrigin="anonymous"),h.signal.addEventListener("abort",()=>{m.src="",p(JA())}),m.fetchPriority="high",m.onload=()=>{m.onerror=m.onload=null,d({data:m})},m.onerror=()=>{m.onerror=m.onload=null,!h.signal.aborted&&p(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},m.src=y})})(Au||(Au={}));Au.resetRequestQueue();C();var F1e=class{constructor(e){this._transformRequestFn=e}transformRequest(e,r){return this._transformRequestFn?this._transformRequestFn(e,r)||{url:e}:{url:e}}setTransformRequest(e){this._transformRequestFn=e}};C();C();function Ez(t,e,r){r[t]&&r[t].indexOf(e)!==-1||(r[t]=r[t]||[],r[t].push(e))}function bE(t,e,r){if(r&&r[t]){let n=r[t].indexOf(e);n!==-1&&r[t].splice(n,1)}}var ht=class{constructor(e,r={}){zt(this,r),this.type=e}},Jt=class extends ht{constructor(t,e={}){super("error",zt({error:t},e))}},Xo=class{on(e,r){return this._listeners=this._listeners||{},Ez(e,r,this._listeners),{unsubscribe:()=>{this.off(e,r)}}}off(e,r){return bE(e,r,this._listeners),bE(e,r,this._oneTimeListeners),this}once(e,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},Ez(e,r,this._oneTimeListeners),this):new Promise(n=>this.once(e,n))}fire(e,r){typeof e=="string"&&(e=new ht(e,r||{}));let n=e.type;if(this.listens(n)){e.target=this;let i=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];for(let s of i)s.call(this,e);let a=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];for(let s of a)bE(n,s,this._oneTimeListeners),s.call(this,e);let o=this._eventedParent;o&&(zt(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),o.fire(e))}else e instanceof Jt&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,r){return this._eventedParent=e,this._eventedParentData=r,this}};C();C();C();C();var R1e=8,L1e={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},N1e={"*":{type:"source"}},$1e=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],U1e={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},j1e={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},V1e={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},G1e={type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},Z1e={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},W1e={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},H1e={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},X1e=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],q1e={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Y1e={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},J1e={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},K1e={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Q1e={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},e_e={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},t_e={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},r_e={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},n_e={type:"array",value:"*"},i_e={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},a_e={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},o_e={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},s_e={type:"array",value:"*",minimum:1},l_e={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},u_e={"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},c_e={source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},h_e={type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},d_e=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],p_e={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},f_e={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},m_e={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},g_e={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},y_e={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},v_e={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},__e={"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},x_e={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},b_e={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},w_e={"*":{type:"string"}},Oe={$version:R1e,$root:L1e,sources:N1e,source:$1e,source_vector:U1e,source_raster:j1e,source_raster_dem:V1e,source_geojson:G1e,source_video:Z1e,source_image:W1e,layer:H1e,layout:X1e,layout_background:q1e,layout_fill:Y1e,layout_circle:J1e,layout_heatmap:K1e,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:Q1e,layout_symbol:e_e,layout_raster:t_e,layout_hillshade:r_e,"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:n_e,filter_operator:i_e,geometry_type:a_e,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:o_e,expression:s_e,light:l_e,sky:u_e,terrain:c_e,projection:h_e,paint:d_e,paint_fill:p_e,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:f_e,paint_circle:m_e,paint_heatmap:g_e,paint_symbol:y_e,paint_raster:v_e,paint_hillshade:__e,"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:x_e,transition:b_e,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:w_e},A_e=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function S_e(t,e){let r={};for(let n in t)n!=="ref"&&(r[n]=t[n]);return A_e.forEach(n=>{n in e&&(r[n]=e[n])}),r}function Iz(t){t=t.slice();let e=Object.create(null);for(let r=0;r<t.length;r++)e[t[r].id]=t[r];for(let r=0;r<t.length;r++)"ref"in t[r]&&(t[r]=S_e(t[r],e[t[r].ref]));return t}function dn(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!dn(t[r],e[r]))return!1;return!0}if(typeof t=="object"&&t!==null&&e!==null){if(typeof e!="object"||Object.keys(t).length!==Object.keys(e).length)return!1;for(let r in t)if(!dn(t[r],e[r]))return!1;return!0}return t===e}function Ls(t,e){t.push(e)}function VZ(t,e,r){Ls(r,{command:"addSource",args:[t,e[t]]})}function GZ(t,e,r){Ls(e,{command:"removeSource",args:[t]}),r[t]=!0}function E_e(t,e,r,n){GZ(t,r,n),VZ(t,e,r)}function I_e(t,e,r){let n;for(n in t[r])if(Object.prototype.hasOwnProperty.call(t[r],n)&&n!=="data"&&!dn(t[r][n],e[r][n]))return!1;for(n in e[r])if(Object.prototype.hasOwnProperty.call(e[r],n)&&n!=="data"&&!dn(t[r][n],e[r][n]))return!1;return!0}function C_e(t,e,r,n){t=t||{},e=e||{};let i;for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(Object.prototype.hasOwnProperty.call(e,i)||GZ(i,r,n));for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&(Object.prototype.hasOwnProperty.call(t,i)?dn(t[i],e[i])||(t[i].type==="geojson"&&e[i].type==="geojson"&&I_e(t,e,i)?Ls(r,{command:"setGeoJSONSourceData",args:[i,e[i].data]}):E_e(i,e,r,n)):VZ(i,e,r))}function kx(t,e,r,n,i,a){t=t||{},e=e||{};for(let o in t)Object.prototype.hasOwnProperty.call(t,o)&&(dn(t[o],e[o])||r.push({command:a,args:[n,o,e[o],i]}));for(let o in e)!Object.prototype.hasOwnProperty.call(e,o)||Object.prototype.hasOwnProperty.call(t,o)||dn(t[o],e[o])||r.push({command:a,args:[n,o,e[o],i]})}function Cz(t){return t.id}function Mz(t,e){return t[e.id]=e,t}function M_e(t,e,r){t=t||[],e=e||[];let n=t.map(Cz),i=e.map(Cz),a=t.reduce(Mz,{}),o=e.reduce(Mz,{}),s=n.slice(),l=Object.create(null),u,c,h,d,p;for(let m=0,y=0;m<n.length;m++)u=n[m],Object.prototype.hasOwnProperty.call(o,u)?y++:(Ls(r,{command:"removeLayer",args:[u]}),s.splice(s.indexOf(u,y),1));for(let m=0,y=0;m<i.length;m++)u=i[i.length-1-m],s[s.length-1-m]!==u&&(Object.prototype.hasOwnProperty.call(a,u)?(Ls(r,{command:"removeLayer",args:[u]}),s.splice(s.lastIndexOf(u,s.length-y),1)):y++,d=s[s.length-m],Ls(r,{command:"addLayer",args:[o[u],d]}),s.splice(s.length-m,0,u),l[u]=!0);for(let m=0;m<i.length;m++)if(u=i[m],c=a[u],h=o[u],!(l[u]||dn(c,h))){if(!dn(c.source,h.source)||!dn(c["source-layer"],h["source-layer"])||!dn(c.type,h.type)){Ls(r,{command:"removeLayer",args:[u]}),d=s[s.lastIndexOf(u)+1],Ls(r,{command:"addLayer",args:[h,d]});continue}kx(c.layout,h.layout,r,u,null,"setLayoutProperty"),kx(c.paint,h.paint,r,u,null,"setPaintProperty"),dn(c.filter,h.filter)||Ls(r,{command:"setFilter",args:[u,h.filter]}),(!dn(c.minzoom,h.minzoom)||!dn(c.maxzoom,h.maxzoom))&&Ls(r,{command:"setLayerZoomRange",args:[u,h.minzoom,h.maxzoom]});for(p in c)Object.prototype.hasOwnProperty.call(c,p)&&(p==="layout"||p==="paint"||p==="filter"||p==="metadata"||p==="minzoom"||p==="maxzoom"||(p.indexOf("paint.")===0?kx(c[p],h[p],r,u,p.slice(6),"setPaintProperty"):dn(c[p],h[p])||Ls(r,{command:"setLayerProperty",args:[u,p,h[p]]})));for(p in h)!Object.prototype.hasOwnProperty.call(h,p)||Object.prototype.hasOwnProperty.call(c,p)||p==="layout"||p==="paint"||p==="filter"||p==="metadata"||p==="minzoom"||p==="maxzoom"||(p.indexOf("paint.")===0?kx(c[p],h[p],r,u,p.slice(6),"setPaintProperty"):dn(c[p],h[p])||Ls(r,{command:"setLayerProperty",args:[u,p,h[p]]}))}}function T_e(t,e){if(!t)return[{command:"setStyle",args:[e]}];let r=[];try{if(!dn(t.version,e.version))return[{command:"setStyle",args:[e]}];dn(t.center,e.center)||r.push({command:"setCenter",args:[e.center]}),dn(t.state,e.state)||r.push({command:"setGlobalState",args:[e.state]}),dn(t.centerAltitude,e.centerAltitude)||r.push({command:"setCenterAltitude",args:[e.centerAltitude]}),dn(t.zoom,e.zoom)||r.push({command:"setZoom",args:[e.zoom]}),dn(t.bearing,e.bearing)||r.push({command:"setBearing",args:[e.bearing]}),dn(t.pitch,e.pitch)||r.push({command:"setPitch",args:[e.pitch]}),dn(t.roll,e.roll)||r.push({command:"setRoll",args:[e.roll]}),dn(t.sprite,e.sprite)||r.push({command:"setSprite",args:[e.sprite]}),dn(t.glyphs,e.glyphs)||r.push({command:"setGlyphs",args:[e.glyphs]}),dn(t.transition,e.transition)||r.push({command:"setTransition",args:[e.transition]}),dn(t.light,e.light)||r.push({command:"setLight",args:[e.light]}),dn(t.terrain,e.terrain)||r.push({command:"setTerrain",args:[e.terrain]}),dn(t.sky,e.sky)||r.push({command:"setSky",args:[e.sky]}),dn(t.projection,e.projection)||r.push({command:"setProjection",args:[e.projection]});let n={},i=[];C_e(t.sources,e.sources,i,n);let a=[];t.layers&&t.layers.forEach(o=>{"source"in o&&n[o.source]?r.push({command:"removeLayer",args:[o.id]}):a.push(o)}),r=r.concat(i),M_e(a,e.layers,r)}catch(n){console.warn("Unable to compute style diff:",n),r=[{command:"setStyle",args:[e]}]}return r}var it=class{constructor(t,e,r,n){this.message=(t?"".concat(t,": "):"")+r,n&&(this.identifier=n),e!=null&&e.__line__&&(this.line=e.__line__)}};function Dg(t,...e){for(let r of e)for(let n in r)t[n]=r[n];return t}var fu=class extends Error{constructor(t,e){super(e),this.message=e,this.key=t}},P_e=class ZZ{constructor(e,r=[]){this.parent=e,this.bindings={};for(let[n,i]of r)this.bindings[n]=i}concat(e){return new ZZ(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error("".concat(e," not found in scope."))}has(e){return this.bindings[e]?!0:this.parent?this.parent.has(e):!1}},n_={kind:"null"},wt={kind:"number"},Tr={kind:"string"},Sr={kind:"boolean"},Bl={kind:"color"},e3={kind:"projectionDefinition"},Tp={kind:"object"},br={kind:"value"},D_e={kind:"error"},t3={kind:"collator"},i_={kind:"formatted"},r3={kind:"padding"},l1={kind:"colorArray"},n3={kind:"numberArray"},a_={kind:"resolvedImage"},i3={kind:"variableAnchorOffsetCollection"};function hs(t,e){return{kind:"array",itemType:t,N:e}}function hi(t){if(t.kind==="array"){let e=hi(t.itemType);return typeof t.N=="number"?"array<".concat(e,", ").concat(t.N,">"):t.itemType.kind==="value"?"array":"array<".concat(e,">")}else return t.kind}var k_e=[n_,wt,Tr,Sr,Bl,e3,i_,Tp,hs(br),r3,n3,l1,a_,i3];function u1(t,e){if(e.kind==="error")return null;if(t.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!u1(t.itemType,e.itemType))&&(typeof t.N!="number"||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if(t.kind==="value"){for(let r of k_e)if(!u1(r,e))return null}}return"Expected ".concat(hi(t)," but found ").concat(hi(e)," instead.")}function C5(t,e){return e.some(r=>r.kind===t.kind)}function Pp(t,e){return e.some(r=>r==="null"?t===null:r==="array"?Array.isArray(t):r==="object"?t&&!Array.isArray(t)&&typeof t=="object":r===typeof t)}function fh(t,e){return t.kind==="array"&&e.kind==="array"?t.itemType.kind===e.itemType.kind&&typeof t.N=="number":t.kind===e.kind}var WZ=.96422,HZ=1,XZ=.82521,qZ=4/29,ng=6/29,YZ=3*ng*ng,O_e=ng*ng*ng,B_e=Math.PI/180,z_e=180/Math.PI;function JZ(t){return t=t%360,t<0&&(t+=360),t}function KZ([t,e,r,n]){t=wE(t),e=wE(e),r=wE(r);let i,a,o=AE((.2225045*t+.7168786*e+.0606169*r)/HZ);t===e&&e===r?i=a=o:(i=AE((.4360747*t+.3850649*e+.1430804*r)/WZ),a=AE((.0139322*t+.0971045*e+.7141733*r)/XZ));let s=116*o-16;return[s<0?0:s,500*(i-o),200*(o-a),n]}function wE(t){return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function AE(t){return t>O_e?Math.pow(t,1/3):t/YZ+qZ}function QZ([t,e,r,n]){let i=(t+16)/116,a=isNaN(e)?i:i+e/500,o=isNaN(r)?i:i-r/200;return i=HZ*EE(i),a=WZ*EE(a),o=XZ*EE(o),[SE(3.1338561*a-1.6168667*i-.4906146*o),SE(-.9787684*a+1.9161415*i+.033454*o),SE(.0719453*a-.2289914*i+1.4052427*o),n]}function SE(t){return t=t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055,t<0?0:t>1?1:t}function EE(t){return t>ng?t*t*t:YZ*(t-qZ)}function F_e(t){let[e,r,n,i]=KZ(t),a=Math.sqrt(r*r+n*n);return[Math.round(a*1e4)?JZ(Math.atan2(n,r)*z_e):NaN,a,e,i]}function R_e([t,e,r,n]){return t=isNaN(t)?0:t*B_e,QZ([r,Math.cos(t)*e,Math.sin(t)*e,n])}function L_e([t,e,r,n]){t=JZ(t),e/=100,r/=100;function i(a){let o=(a+t/30)%12,s=e*Math.min(r,1-r);return r-s*Math.max(-1,Math.min(o-3,9-o,1))}return[i(0),i(8),i(4),n]}var N_e=Object.hasOwn||function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};function zv(t,e){return N_e(t,e)?t[e]:void 0}function $_e(t){if(t=t.toLowerCase().trim(),t==="transparent")return[0,0,0,0];let e=zv(U_e,t);if(e){let[i,a,o]=e;return[i/255,a/255,o/255,1]}if(t.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(t)){let i=t.length<6?1:2,a=1;return[Ox(t.slice(a,a+=i)),Ox(t.slice(a,a+=i)),Ox(t.slice(a,a+=i)),Ox(t.slice(a,a+i)||"ff")]}if(t.startsWith("rgb")){let i=/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,a=t.match(i);if(a){let[o,s,l,u,c,h,d,p,m,y,v,_]=a,w=[u||" ",d||" ",y].join("");if(w==="  "||w==="  /"||w===",,"||w===",,,"){let b=[l,h,m].join(""),A=b==="%%%"?100:b===""?255:0;if(A){let E=[$f(+s/A,0,1),$f(+c/A,0,1),$f(+p/A,0,1),v?Tz(+v,_):1];if(Pz(E))return E}}return}}let r=/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,n=t.match(r);if(n){let[i,a,o,s,l,u,c,h,d]=n,p=[o||" ",l||" ",c].join("");if(p==="  "||p==="  /"||p===",,"||p===",,,"){let m=[+a,$f(+s,0,100),$f(+u,0,100),h?Tz(+h,d):1];if(Pz(m))return L_e(m)}}}function Ox(t){return parseInt(t.padEnd(2,t),16)/255}function Tz(t,e){return $f(e?t/100:t,0,1)}function $f(t,e,r){return Math.min(Math.max(e,t),r)}function Pz(t){return!t.some(Number.isNaN)}var U_e={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function td(t,e,r){return t+r*(e-t)}function kg(t,e,r){return t.map((n,i)=>td(n,e[i],r))}function j_e(t){return t==="rgb"||t==="hcl"||t==="lab"}var Gt=class Uf{constructor(e,r,n,i=1,a=!0){this.r=e,this.g=r,this.b=n,this.a=i,a||(this.r*=i,this.g*=i,this.b*=i,i||this.overwriteGetter("rgb",[e,r,n,i]))}static parse(e){if(e instanceof Uf)return e;if(typeof e!="string")return;let r=$_e(e);if(r)return new Uf(...r,!1)}get rgb(){let{r:e,g:r,b:n,a:i}=this,a=i||1/0;return this.overwriteGetter("rgb",[e/a,r/a,n/a,i])}get hcl(){return this.overwriteGetter("hcl",F_e(this.rgb))}get lab(){return this.overwriteGetter("lab",KZ(this.rgb))}overwriteGetter(e,r){return Object.defineProperty(this,e,{value:r}),r}toString(){let[e,r,n,i]=this.rgb;return"rgba(".concat([e,r,n].map(a=>Math.round(a*255)).join(","),",").concat(i,")")}static interpolate(e,r,n,i="rgb"){switch(i){case"rgb":{let[a,o,s,l]=kg(e.rgb,r.rgb,n);return new Uf(a,o,s,l,!1)}case"hcl":{let[a,o,s,l]=e.hcl,[u,c,h,d]=r.hcl,p,m;if(!isNaN(a)&&!isNaN(u)){let b=u-a;u>a&&b>180?b-=360:u<a&&a-u>180&&(b+=360),p=a+n*b}else isNaN(a)?isNaN(u)?p=NaN:(p=u,(s===1||s===0)&&(m=c)):(p=a,(h===1||h===0)&&(m=o));let[y,v,_,w]=R_e([p,m??td(o,c,n),td(s,h,n),td(l,d,n)]);return new Uf(y,v,_,w,!1)}case"lab":{let[a,o,s,l]=QZ(kg(e.lab,r.lab,n));return new Uf(a,o,s,l,!1)}}}};Gt.black=new Gt(0,0,0,1);Gt.white=new Gt(1,1,1,1);Gt.transparent=new Gt(0,0,0,0);Gt.red=new Gt(1,0,0,1);var M5=class{constructor(e,r,n){e?this.sensitivity=r?"variant":"case":this.sensitivity=r?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,r){return this.collator.compare(e,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}},V_e=["bottom","center","top"],HC=class{constructor(e,r,n,i,a,o){this.text=e,this.image=r,this.scale=n,this.fontStack=i,this.textColor=a,this.verticalAlign=o}},Uc=class Gb{constructor(e){this.sections=e}static fromString(e){return new Gb([new HC(e,null,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Gb?e:Gb.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}},Lu=class zy{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof zy)return e;if(typeof e=="number")return new zy([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(let r of e)if(typeof r!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]];break}return new zy(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,r,n){return new zy(kg(e.values,r.values,n))}},Nu=class Fy{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Fy)return e;if(typeof e=="number")return new Fy([e]);if(Array.isArray(e)){for(let r of e)if(typeof r!="number")return;return new Fy(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,r,n){return new Fy(kg(e.values,r.values,n))}},Zs=class Ry{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Ry)return e;if(typeof e=="string"){let n=Gt.parse(e);return n?new Ry([n]):void 0}if(!Array.isArray(e))return;let r=[];for(let n of e){if(typeof n!="string")return;let i=Gt.parse(n);if(!i)return;r.push(i)}return new Ry(r)}toString(){return JSON.stringify(this.values)}static interpolate(e,r,n,i="rgb"){let a=[];if(e.values.length!=r.values.length)throw new Error("colorArray: Arrays have mismatched length (".concat(e.values.length," vs. ").concat(r.values.length,"), cannot interpolate."));for(let o=0;o<e.values.length;o++)a.push(Gt.interpolate(e.values[o],r.values[o],n,i));return new Ry(a)}},mi=class extends Error{constructor(t){super(t),this.name="RuntimeError"}toJSON(){return this.message}},G_e=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]),xd=class Zb{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Zb)return e;if(!(!Array.isArray(e)||e.length<1||e.length%2!==0)){for(let r=0;r<e.length;r+=2){let n=e[r],i=e[r+1];if(typeof n!="string"||!G_e.has(n)||!Array.isArray(i)||i.length!==2||typeof i[0]!="number"||typeof i[1]!="number")return}return new Zb(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,r,n){let i=e.values,a=r.values;if(i.length!==a.length)throw new mi("Cannot interpolate values of different length. from: ".concat(e.toString(),", to: ").concat(r.toString()));let o=[];for(let s=0;s<i.length;s+=2){if(i[s]!==a[s])throw new mi("Cannot interpolate values containing mismatched anchors. from[".concat(s,"]: ").concat(i[s],", to[").concat(s,"]: ").concat(a[s]));o.push(i[s]);let[l,u]=i[s+1],[c,h]=a[s+1];o.push([td(l,c,n),td(u,h,n)])}return new Zb(o)}},Mu=class eW{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new eW({name:e,available:!1}):null}},qp=class jf{constructor(e,r,n){this.from=e,this.to=r,this.transition=n}static interpolate(e,r,n){return new jf(e,r,n)}static parse(e){if(e instanceof jf)return e;if(Array.isArray(e)&&e.length===3&&typeof e[0]=="string"&&typeof e[1]=="string"&&typeof e[2]=="number")return new jf(e[0],e[1],e[2]);if(typeof e=="object"&&typeof e.from=="string"&&typeof e.to=="string"&&typeof e.transition=="number")return new jf(e.from,e.to,e.transition);if(typeof e=="string")return new jf(e,e,1)}};function tW(t,e,r,n){if(!(typeof t=="number"&&t>=0&&t<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof r=="number"&&r>=0&&r<=255)){let i=typeof n=="number"?[t,e,r,n]:[t,e,r];return"Invalid rgba value [".concat(i.join(", "),"]: 'r', 'g', and 'b' must be between 0 and 255.")}return typeof n>"u"||typeof n=="number"&&n>=0&&n<=1?null:"Invalid rgba value [".concat([t,e,r,n].join(", "),"]: 'a' must be between 0 and 1.")}function c1(t){if(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||t instanceof qp||t instanceof Gt||t instanceof M5||t instanceof Uc||t instanceof Lu||t instanceof Nu||t instanceof Zs||t instanceof xd||t instanceof Mu)return!0;if(Array.isArray(t)){for(let e of t)if(!c1(e))return!1;return!0}else if(typeof t=="object"){for(let e in t)if(!c1(t[e]))return!1;return!0}else return!1}function ji(t){if(t===null)return n_;if(typeof t=="string")return Tr;if(typeof t=="boolean")return Sr;if(typeof t=="number")return wt;if(t instanceof Gt)return Bl;if(t instanceof qp)return e3;if(t instanceof M5)return t3;if(t instanceof Uc)return i_;if(t instanceof Lu)return r3;if(t instanceof Nu)return n3;if(t instanceof Zs)return l1;if(t instanceof xd)return i3;if(t instanceof Mu)return a_;if(Array.isArray(t)){let e=t.length,r;for(let n of t){let i=ji(n);if(!r)r=i;else{if(r===i)continue;r=br;break}}return hs(r||br,e)}else return Tp}function Fv(t){let e=typeof t;return t===null?"":e==="string"||e==="number"||e==="boolean"?String(t):t instanceof Gt||t instanceof qp||t instanceof Uc||t instanceof Lu||t instanceof Nu||t instanceof Zs||t instanceof xd||t instanceof Mu?t.toString():JSON.stringify(t)}var h1=class rW{constructor(e,r){this.type=e,this.value=r}static parse(e,r){if(e.length!==2)return r.error("'literal' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(!c1(e[1]))return r.error("invalid value");let n=e[1],i=ji(n),a=r.expectedType;return i.kind==="array"&&i.N===0&&a&&a.kind==="array"&&(typeof a.N!="number"||a.N===0)&&(i=a),new rW(i,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}},Bx={string:Tr,number:wt,boolean:Sr,object:Tp},Ic=class nW{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let n=1,i,a=e[0];if(a==="array"){let s;if(e.length>2){let u=e[1];if(typeof u!="string"||!(u in Bx)||u==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);s=Bx[u],n++}else s=br;let l;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return r.error('The length argument to "array" must be a positive integer literal',2);l=e[2],n++}i=hs(s,l)}else{if(!Bx[a])throw new Error("Types doesn't contain name = ".concat(a));i=Bx[a]}let o=[];for(;n<e.length;n++){let s=r.parse(e[n],n,br);if(!s)return null;o.push(s)}return new nW(i,o)}evaluate(e){for(let r=0;r<this.args.length;r++){let n=this.args[r].evaluate(e);if(u1(this.type,ji(n))){if(r===this.args.length-1)throw new mi("Expected value to be of type ".concat(hi(this.type),", but found ").concat(hi(ji(n))," instead."))}else return n}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}},Dz={"to-boolean":Sr,"to-color":Bl,"to-number":wt,"to-string":Tr},$m=class iW{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let n=e[0];if(!Dz[n])throw new Error("Can't parse ".concat(n," as it is not part of the known types"));if((n==="to-boolean"||n==="to-string")&&e.length!==2)return r.error("Expected one argument.");let i=Dz[n],a=[];for(let o=1;o<e.length;o++){let s=r.parse(e[o],o,br);if(!s)return null;a.push(s)}return new iW(i,a)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let r,n;for(let i of this.args){if(r=i.evaluate(e),n=null,r instanceof Gt)return r;if(typeof r=="string"){let a=e.parseColor(r);if(a)return a}else if(Array.isArray(r)&&(r.length<3||r.length>4?n="Invalid rgba value ".concat(JSON.stringify(r),": expected an array containing either three or four numeric values."):n=tW(r[0],r[1],r[2],r[3]),!n))return new Gt(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new mi(n||"Could not parse color from value '".concat(typeof r=="string"?r:JSON.stringify(r),"'"))}case"padding":{let r;for(let n of this.args){r=n.evaluate(e);let i=Lu.parse(r);if(i)return i}throw new mi("Could not parse padding from value '".concat(typeof r=="string"?r:JSON.stringify(r),"'"))}case"numberArray":{let r;for(let n of this.args){r=n.evaluate(e);let i=Nu.parse(r);if(i)return i}throw new mi("Could not parse numberArray from value '".concat(typeof r=="string"?r:JSON.stringify(r),"'"))}case"colorArray":{let r;for(let n of this.args){r=n.evaluate(e);let i=Zs.parse(r);if(i)return i}throw new mi("Could not parse colorArray from value '".concat(typeof r=="string"?r:JSON.stringify(r),"'"))}case"variableAnchorOffsetCollection":{let r;for(let n of this.args){r=n.evaluate(e);let i=xd.parse(r);if(i)return i}throw new mi("Could not parse variableAnchorOffsetCollection from value '".concat(typeof r=="string"?r:JSON.stringify(r),"'"))}case"number":{let r=null;for(let n of this.args){if(r=n.evaluate(e),r===null)return 0;let i=Number(r);if(!isNaN(i))return i}throw new mi("Could not convert ".concat(JSON.stringify(r)," to number."))}case"formatted":return Uc.fromString(Fv(this.args[0].evaluate(e)));case"resolvedImage":return Mu.fromString(Fv(this.args[0].evaluate(e)));case"projectionDefinition":return this.args[0].evaluate(e);default:return Fv(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}},Z_e=["Unknown","Point","LineString","Polygon"],aW=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Z_e[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let r=this._parseColorCache.get(e);return r||(r=Gt.parse(e),this._parseColorCache.set(e,r)),r}},oW=class sW{constructor(e,r,n=[],i,a=new P_e,o=[]){this.registry=e,this.path=n,this.key=n.map(s=>"[".concat(s,"]")).join(""),this.scope=a,this.errors=o,this.expectedType=i,this._isConstant=r}parse(e,r,n,i,a={}){return r?this.concat(r,n,i)._parse(e,a):this._parse(e,a)}_parse(e,r){(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number")&&(e=["literal",e]);function n(i,a,o){return o==="assert"?new Ic(a,[i]):o==="coerce"?new $m(a,[i]):i}if(Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let i=e[0];if(typeof i!="string")return this.error("Expression name must be a string, but found ".concat(typeof i,' instead. If you wanted a literal array, use ["literal", [...]].'),0),null;let a=this.registry[i];if(a){let o=a.parse(e,this);if(!o)return null;if(this.expectedType){let s=this.expectedType,l=o.type;if((s.kind==="string"||s.kind==="number"||s.kind==="boolean"||s.kind==="object"||s.kind==="array")&&l.kind==="value")o=n(o,s,r.typeAnnotation||"assert");else if(s.kind==="projectionDefinition"&&["string","array"].includes(l.kind)||["color","formatted","resolvedImage"].includes(s.kind)&&["value","string"].includes(l.kind)||["padding","numberArray"].includes(s.kind)&&["value","number","array"].includes(l.kind)||s.kind==="colorArray"&&["value","string","array"].includes(l.kind)||s.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(l.kind))o=n(o,s,r.typeAnnotation||"coerce");else if(this.checkSubtype(s,l))return null}if(!(o instanceof h1)&&o.type.kind!=="resolvedImage"&&this._isConstant(o)){let s=new aW;try{o=new h1(o.type,o.evaluate(s))}catch(l){return this.error(l.message),null}}return o}return this.error('Unknown expression "'.concat(i,'". If you wanted a literal array, use ["literal", [...]].'),0)}else return typeof e>"u"?this.error("'undefined' value invalid. Use null instead."):typeof e=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found ".concat(typeof e," instead."))}concat(e,r,n){let i=typeof e=="number"?this.path.concat(e):this.path,a=n?this.scope.concat(n):this.scope;return new sW(this.registry,this._isConstant,i,r||null,a,this.errors)}error(e,...r){let n="".concat(this.key).concat(r.map(i=>"[".concat(i,"]")).join(""));this.errors.push(new fu(n,e))}checkSubtype(e,r){let n=u1(e,r);return n&&this.error(n),n}},lW=class uW{constructor(e,r){this.type=r.type,this.bindings=[].concat(e),this.result=r}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(let r of this.bindings)e(r[1]);e(this.result)}static parse(e,r){if(e.length<4)return r.error("Expected at least 3 arguments, but found ".concat(e.length-1," instead."));let n=[];for(let a=1;a<e.length-1;a+=2){let o=e[a];if(typeof o!="string")return r.error("Expected string, but found ".concat(typeof o," instead."),a);if(/[^a-zA-Z0-9_]/.test(o))return r.error("Variable names must contain only alphanumeric characters or '_'.",a);let s=r.parse(e[a+1],a+1);if(!s)return null;n.push([o,s])}let i=r.parse(e[e.length-1],e.length-1,r.expectedType,n);return i?new uW(n,i):null}outputDefined(){return this.result.outputDefined()}},cW=class hW{constructor(e,r){this.type=r.type,this.name=e,this.boundExpression=r}static parse(e,r){if(e.length!==2||typeof e[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");let n=e[1];return r.scope.has(n)?new hW(n,r.scope.get(n)):r.error('Unknown variable "'.concat(n,'". Make sure "').concat(n,'" has been bound in an enclosing "let" expression before using it.'),1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}},W_e=class dW{constructor(e,r,n){this.type=e,this.index=r,this.input=n}static parse(e,r){if(e.length!==3)return r.error("Expected 2 arguments, but found ".concat(e.length-1," instead."));let n=r.parse(e[1],1,wt),i=r.parse(e[2],2,hs(r.expectedType||br));if(!n||!i)return null;let a=i.type;return new dW(a.itemType,n,i)}evaluate(e){let r=this.index.evaluate(e),n=this.input.evaluate(e);if(r<0)throw new mi("Array index out of bounds: ".concat(r," < 0."));if(r>=n.length)throw new mi("Array index out of bounds: ".concat(r," > ").concat(n.length-1,"."));if(r!==Math.floor(r))throw new mi("Array index must be an integer, but found ".concat(r," instead."));return n[r]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}},H_e=class pW{constructor(e,r){this.type=Sr,this.needle=e,this.haystack=r}static parse(e,r){if(e.length!==3)return r.error("Expected 2 arguments, but found ".concat(e.length-1," instead."));let n=r.parse(e[1],1,br),i=r.parse(e[2],2,br);return!n||!i?null:C5(n.type,[Sr,Tr,wt,n_,br])?new pW(n,i):r.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(hi(n.type)," instead"))}evaluate(e){let r=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(!n)return!1;if(!Pp(r,["boolean","string","number","null"]))throw new mi("Expected first argument to be of type boolean, string, number or null, but found ".concat(hi(ji(r))," instead."));if(!Pp(n,["string","array"]))throw new mi("Expected second argument to be of type array or string, but found ".concat(hi(ji(n))," instead."));return n.indexOf(r)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}},X_e=class XC{constructor(e,r,n){this.type=wt,this.needle=e,this.haystack=r,this.fromIndex=n}static parse(e,r){if(e.length<=2||e.length>=5)return r.error("Expected 3 or 4 arguments, but found ".concat(e.length-1," instead."));let n=r.parse(e[1],1,br),i=r.parse(e[2],2,br);if(!n||!i)return null;if(!C5(n.type,[Sr,Tr,wt,n_,br]))return r.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(hi(n.type)," instead"));if(e.length===4){let a=r.parse(e[3],3,wt);return a?new XC(n,i,a):null}else return new XC(n,i)}evaluate(e){let r=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(!Pp(r,["boolean","string","number","null"]))throw new mi("Expected first argument to be of type boolean, string, number or null, but found ".concat(hi(ji(r))," instead."));let i;if(this.fromIndex&&(i=this.fromIndex.evaluate(e)),Pp(n,["string"])){let a=n.indexOf(r,i);return a===-1?-1:[...n.slice(0,a)].length}else{if(Pp(n,["array"]))return n.indexOf(r,i);throw new mi("Expected second argument to be of type array or string, but found ".concat(hi(ji(n))," instead."))}}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}},q_e=class fW{constructor(e,r,n,i,a,o){this.inputType=e,this.type=r,this.input=n,this.cases=i,this.outputs=a,this.otherwise=o}static parse(e,r){if(e.length<5)return r.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if(e.length%2!==1)return r.error("Expected an even number of arguments.");let n,i;r.expectedType&&r.expectedType.kind!=="value"&&(i=r.expectedType);let a={},o=[];for(let u=2;u<e.length-1;u+=2){let c=e[u],h=e[u+1];Array.isArray(c)||(c=[c]);let d=r.concat(u);if(c.length===0)return d.error("Expected at least one branch label.");for(let m of c){if(typeof m!="number"&&typeof m!="string")return d.error("Branch labels must be numbers or strings.");if(typeof m=="number"&&Math.abs(m)>Number.MAX_SAFE_INTEGER)return d.error("Branch labels must be integers no larger than ".concat(Number.MAX_SAFE_INTEGER,"."));if(typeof m=="number"&&Math.floor(m)!==m)return d.error("Numeric branch labels must be integer values.");if(!n)n=ji(m);else if(d.checkSubtype(n,ji(m)))return null;if(typeof a[String(m)]<"u")return d.error("Branch labels must be unique.");a[String(m)]=o.length}let p=r.parse(h,u,i);if(!p)return null;i=i||p.type,o.push(p)}let s=r.parse(e[1],1,br);if(!s)return null;let l=r.parse(e[e.length-1],e.length-1,i);return!l||s.type.kind!=="value"&&r.concat(1).checkSubtype(n,s.type)?null:new fW(n,i,s,a,o,l)}evaluate(e){let r=this.input.evaluate(e);return(ji(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}},Y_e=class mW{constructor(e,r,n){this.type=e,this.branches=r,this.otherwise=n}static parse(e,r){if(e.length<4)return r.error("Expected at least 3 arguments, but found only ".concat(e.length-1,"."));if(e.length%2!==0)return r.error("Expected an odd number of arguments.");let n;r.expectedType&&r.expectedType.kind!=="value"&&(n=r.expectedType);let i=[];for(let o=1;o<e.length-1;o+=2){let s=r.parse(e[o],o,Sr);if(!s)return null;let l=r.parse(e[o+1],o+1,n);if(!l)return null;i.push([s,l]),n=n||l.type}let a=r.parse(e[e.length-1],e.length-1,n);if(!a)return null;if(!n)throw new Error("Can't infer output type");return new mW(n,i,a)}evaluate(e){for(let[r,n]of this.branches)if(r.evaluate(e))return n.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(let[r,n]of this.branches)e(r),e(n);e(this.otherwise)}outputDefined(){return this.branches.every(([e,r])=>r.outputDefined())&&this.otherwise.outputDefined()}},J_e=class qC{constructor(e,r,n,i){this.type=e,this.input=r,this.beginIndex=n,this.endIndex=i}static parse(e,r){if(e.length<=2||e.length>=5)return r.error("Expected 3 or 4 arguments, but found ".concat(e.length-1," instead."));let n=r.parse(e[1],1,br),i=r.parse(e[2],2,wt);if(!n||!i)return null;if(!C5(n.type,[hs(br),Tr,br]))return r.error("Expected first argument to be of type array or string, but found ".concat(hi(n.type)," instead"));if(e.length===4){let a=r.parse(e[3],3,wt);return a?new qC(n.type,n,i,a):null}else return new qC(n.type,n,i)}evaluate(e){let r=this.input.evaluate(e),n=this.beginIndex.evaluate(e),i;if(this.endIndex&&(i=this.endIndex.evaluate(e)),Pp(r,["string"]))return[...r].slice(n,i).join("");if(Pp(r,["array"]))return r.slice(n,i);throw new mi("Expected first argument to be of type array or string, but found ".concat(hi(ji(r))," instead."))}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}};function a3(t,e){let r=t.length-1,n=0,i=r,a=0,o,s;for(;n<=i;)if(a=Math.floor((n+i)/2),o=t[a],s=t[a+1],o<=e){if(a===r||e<s)return a;n=a+1}else if(o>e)i=a-1;else throw new mi("Input is not a number.");return 0}var T5=class gW{constructor(e,r,n){this.type=e,this.input=r,this.labels=[],this.outputs=[];for(let[i,a]of n)this.labels.push(i),this.outputs.push(a)}static parse(e,r){if(e.length-1<4)return r.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if((e.length-1)%2!==0)return r.error("Expected an even number of arguments.");let n=r.parse(e[1],1,wt);if(!n)return null;let i=[],a=null;r.expectedType&&r.expectedType.kind!=="value"&&(a=r.expectedType);for(let o=1;o<e.length;o+=2){let s=o===1?-1/0:e[o],l=e[o+1],u=o,c=o+1;if(typeof s!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(i.length&&i[i.length-1][0]>=s)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);let h=r.parse(l,c,a);if(!h)return null;a=a||h.type,i.push([s,h])}return new gW(a,n,i)}evaluate(e){let r=this.labels,n=this.outputs;if(r.length===1)return n[0].evaluate(e);let i=this.input.evaluate(e);if(i<=r[0])return n[0].evaluate(e);let a=r.length;if(i>=r[a-1])return n[a-1].evaluate(e);let o=a3(r,i);return n[o].evaluate(e)}eachChild(e){e(this.input);for(let r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}};function K_e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var IE,kz;function Q_e(){if(kz)return IE;kz=1,IE=t;function t(e,r,n,i){this.cx=3*e,this.bx=3*(n-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(i-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=r,this.p2x=n,this.p2y=i}return t.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,r){if(r===void 0&&(r=1e-6),e<0)return 0;if(e>1)return 1;for(var n=e,i=0;i<8;i++){var a=this.sampleCurveX(n)-e;if(Math.abs(a)<r)return n;var o=this.sampleCurveDerivativeX(n);if(Math.abs(o)<1e-6)break;n=n-a/o}var s=0,l=1;for(n=e,i=0;i<20&&(a=this.sampleCurveX(n),!(Math.abs(a-e)<r));i++)e>a?s=n:l=n,n=(l-s)*.5+s;return n},solve:function(e,r){return this.sampleCurveY(this.solveCurveX(e,r))}},IE}var exe=Q_e(),txe=K_e(exe),zl=class YC{constructor(e,r,n,i,a){this.type=e,this.operator=r,this.interpolation=n,this.input=i,this.labels=[],this.outputs=[];for(let[o,s]of a)this.labels.push(o),this.outputs.push(s)}static interpolationFactor(e,r,n,i){let a=0;if(e.name==="exponential")a=CE(r,e.base,n,i);else if(e.name==="linear")a=CE(r,1,n,i);else if(e.name==="cubic-bezier"){let o=e.controlPoints;a=new txe(o[0],o[1],o[2],o[3]).solve(CE(r,1,n,i))}return a}static parse(e,r){let[n,i,a,...o]=e;if(!Array.isArray(i)||i.length===0)return r.error("Expected an interpolation type expression.",1);if(i[0]==="linear")i={name:"linear"};else if(i[0]==="exponential"){let u=i[1];if(typeof u!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:u}}else if(i[0]==="cubic-bezier"){let u=i.slice(1);if(u.length!==4||u.some(c=>typeof c!="number"||c<0||c>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:u}}else return r.error("Unknown interpolation type ".concat(String(i[0])),1,0);if(e.length-1<4)return r.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if((e.length-1)%2!==0)return r.error("Expected an even number of arguments.");if(a=r.parse(a,2,wt),!a)return null;let s=[],l=null;(n==="interpolate-hcl"||n==="interpolate-lab")&&r.expectedType!=l1?l=Bl:r.expectedType&&r.expectedType.kind!=="value"&&(l=r.expectedType);for(let u=0;u<o.length;u+=2){let c=o[u],h=o[u+1],d=u+3,p=u+4;if(typeof c!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',d);if(s.length&&s[s.length-1][0]>=c)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',d);let m=r.parse(h,p,l);if(!m)return null;l=l||m.type,s.push([c,m])}return!fh(l,wt)&&!fh(l,e3)&&!fh(l,Bl)&&!fh(l,r3)&&!fh(l,n3)&&!fh(l,l1)&&!fh(l,i3)&&!fh(l,hs(wt))?r.error("Type ".concat(hi(l)," is not interpolatable.")):new YC(l,n,i,a,s)}evaluate(e){let r=this.labels,n=this.outputs;if(r.length===1)return n[0].evaluate(e);let i=this.input.evaluate(e);if(i<=r[0])return n[0].evaluate(e);let a=r.length;if(i>=r[a-1])return n[a-1].evaluate(e);let o=a3(r,i),s=r[o],l=r[o+1],u=YC.interpolationFactor(this.interpolation,i,s,l),c=n[o].evaluate(e),h=n[o+1].evaluate(e);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return td(c,h,u);case"color":return Gt.interpolate(c,h,u);case"padding":return Lu.interpolate(c,h,u);case"colorArray":return Zs.interpolate(c,h,u);case"numberArray":return Nu.interpolate(c,h,u);case"variableAnchorOffsetCollection":return xd.interpolate(c,h,u);case"array":return kg(c,h,u);case"projectionDefinition":return qp.interpolate(c,h,u)}case"interpolate-hcl":switch(this.type.kind){case"color":return Gt.interpolate(c,h,u,"hcl");case"colorArray":return Zs.interpolate(c,h,u,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Gt.interpolate(c,h,u,"lab");case"colorArray":return Zs.interpolate(c,h,u,"lab")}}}eachChild(e){e(this.input);for(let r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}};function CE(t,e,r,n){let i=n-r,a=t-r;return i===0?0:e===1?a/i:(Math.pow(e,a)-1)/(Math.pow(e,i)-1)}var di={color:Gt.interpolate,number:td,padding:Lu.interpolate,numberArray:Nu.interpolate,colorArray:Zs.interpolate,variableAnchorOffsetCollection:xd.interpolate,array:kg},yW=class JC{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let n=null,i=r.expectedType;i&&i.kind!=="value"&&(n=i);let a=[];for(let o of e.slice(1)){let s=r.parse(o,1+a.length,n,void 0,{typeAnnotation:"omit"});if(!s)return null;n=n||s.type,a.push(s)}if(!n)throw new Error("No output type");return i&&a.some(o=>u1(i,o.type))?new JC(br,a):new JC(n,a)}evaluate(e){let r=null,n=0,i;for(let a of this.args)if(n++,r=a.evaluate(e),r&&r instanceof Mu&&!r.available&&(i||(i=r.name),r=null,n===this.args.length&&(r=i)),r!==null)break;return r}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}};function Oz(t,e){return t==="=="||t==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function rxe(t,e,r){return e===r}function nxe(t,e,r){return e!==r}function ixe(t,e,r){return e<r}function axe(t,e,r){return e>r}function oxe(t,e,r){return e<=r}function sxe(t,e,r){return e>=r}function vW(t,e,r,n){return n.compare(e,r)===0}function lxe(t,e,r,n){return!vW(t,e,r,n)}function uxe(t,e,r,n){return n.compare(e,r)<0}function cxe(t,e,r,n){return n.compare(e,r)>0}function hxe(t,e,r,n){return n.compare(e,r)<=0}function dxe(t,e,r,n){return n.compare(e,r)>=0}function g0(t,e,r){let n=t!=="=="&&t!=="!=";return class _W{constructor(a,o,s){this.type=Sr,this.lhs=a,this.rhs=o,this.collator=s,this.hasUntypedArgument=a.type.kind==="value"||o.type.kind==="value"}static parse(a,o){if(a.length!==3&&a.length!==4)return o.error("Expected two or three arguments.");let s=a[0],l=o.parse(a[1],1,br);if(!l)return null;if(!Oz(s,l.type))return o.concat(1).error('"'.concat(s,`" comparisons are not supported for type '`).concat(hi(l.type),"'."));let u=o.parse(a[2],2,br);if(!u)return null;if(!Oz(s,u.type))return o.concat(2).error('"'.concat(s,`" comparisons are not supported for type '`).concat(hi(u.type),"'."));if(l.type.kind!==u.type.kind&&l.type.kind!=="value"&&u.type.kind!=="value")return o.error("Cannot compare types '".concat(hi(l.type),"' and '").concat(hi(u.type),"'."));n&&(l.type.kind==="value"&&u.type.kind!=="value"?l=new Ic(u.type,[l]):l.type.kind!=="value"&&u.type.kind==="value"&&(u=new Ic(l.type,[u])));let c=null;if(a.length===4){if(l.type.kind!=="string"&&u.type.kind!=="string"&&l.type.kind!=="value"&&u.type.kind!=="value")return o.error("Cannot use collator to compare non-string types.");if(c=o.parse(a[3],3,t3),!c)return null}return new _W(l,u,c)}evaluate(a){let o=this.lhs.evaluate(a),s=this.rhs.evaluate(a);if(n&&this.hasUntypedArgument){let l=ji(o),u=ji(s);if(l.kind!==u.kind||!(l.kind==="string"||l.kind==="number"))throw new mi('Expected arguments for "'.concat(t,'" to be (string, string) or (number, number), but found (').concat(l.kind,", ").concat(u.kind,") instead."))}if(this.collator&&!n&&this.hasUntypedArgument){let l=ji(o),u=ji(s);if(l.kind!=="string"||u.kind!=="string")return e(a,o,s)}return this.collator?r(a,o,s,this.collator.evaluate(a)):e(a,o,s)}eachChild(a){a(this.lhs),a(this.rhs),this.collator&&a(this.collator)}outputDefined(){return!0}}}var pxe=g0("==",rxe,vW),fxe=g0("!=",nxe,lxe),mxe=g0("<",ixe,uxe),gxe=g0(">",axe,cxe),yxe=g0("<=",oxe,hxe),vxe=g0(">=",sxe,dxe),xW=class bW{constructor(e,r,n){this.type=t3,this.locale=n,this.caseSensitive=e,this.diacriticSensitive=r}static parse(e,r){if(e.length!==2)return r.error("Expected one argument.");let n=e[1];if(typeof n!="object"||Array.isArray(n))return r.error("Collator options argument must be an object.");let i=r.parse(n["case-sensitive"]===void 0?!1:n["case-sensitive"],1,Sr);if(!i)return null;let a=r.parse(n["diacritic-sensitive"]===void 0?!1:n["diacritic-sensitive"],1,Sr);if(!a)return null;let o=null;return n.locale&&(o=r.parse(n.locale,1,Tr),!o)?null:new bW(i,a,o)}evaluate(e){return new M5(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}},_xe=class wW{constructor(e,r,n,i,a){this.type=Tr,this.number=e,this.locale=r,this.currency=n,this.minFractionDigits=i,this.maxFractionDigits=a}static parse(e,r){if(e.length!==3)return r.error("Expected two arguments.");let n=r.parse(e[1],1,wt);if(!n)return null;let i=e[2];if(typeof i!="object"||Array.isArray(i))return r.error("NumberFormat options argument must be an object.");let a=null;if(i.locale&&(a=r.parse(i.locale,1,Tr),!a))return null;let o=null;if(i.currency&&(o=r.parse(i.currency,1,Tr),!o))return null;let s=null;if(i["min-fraction-digits"]&&(s=r.parse(i["min-fraction-digits"],1,wt),!s))return null;let l=null;return i["max-fraction-digits"]&&(l=r.parse(i["max-fraction-digits"],1,wt),!l)?null:new wW(n,a,o,s,l)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}},AW=class SW{constructor(e){this.type=i_,this.sections=e}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let n=e[1];if(!Array.isArray(n)&&typeof n=="object")return r.error("First argument must be an image or text section.");let i=[],a=!1;for(let o=1;o<=e.length-1;++o){let s=e[o];if(a&&typeof s=="object"&&!Array.isArray(s)){a=!1;let l=null;if(s["font-scale"]&&(l=r.parse(s["font-scale"],1,wt),!l))return null;let u=null;if(s["text-font"]&&(u=r.parse(s["text-font"],1,hs(Tr)),!u))return null;let c=null;if(s["text-color"]&&(c=r.parse(s["text-color"],1,Bl),!c))return null;let h=null;if(s["vertical-align"]){if(typeof s["vertical-align"]=="string"&&!V_e.includes(s["vertical-align"]))return r.error("'vertical-align' must be one of: 'bottom', 'center', 'top' but found '".concat(s["vertical-align"],"' instead."));if(h=r.parse(s["vertical-align"],1,Tr),!h)return null}let d=i[i.length-1];d.scale=l,d.font=u,d.textColor=c,d.verticalAlign=h}else{let l=r.parse(e[o],1,br);if(!l)return null;let u=l.type.kind;if(u!=="string"&&u!=="value"&&u!=="null"&&u!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");a=!0,i.push({content:l,scale:null,font:null,textColor:null,verticalAlign:null})}}return new SW(i)}evaluate(e){let r=n=>{let i=n.content.evaluate(e);return ji(i)===a_?new HC("",i,null,null,null,n.verticalAlign?n.verticalAlign.evaluate(e):null):new HC(Fv(i),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null,n.verticalAlign?n.verticalAlign.evaluate(e):null)};return new Uc(this.sections.map(r))}eachChild(e){for(let r of this.sections)e(r.content),r.scale&&e(r.scale),r.font&&e(r.font),r.textColor&&e(r.textColor),r.verticalAlign&&e(r.verticalAlign)}outputDefined(){return!1}},xxe=class EW{constructor(e){this.type=a_,this.input=e}static parse(e,r){if(e.length!==2)return r.error("Expected two arguments.");let n=r.parse(e[1],1,Tr);return n?new EW(n):r.error("No image name provided.")}evaluate(e){let r=this.input.evaluate(e),n=Mu.fromString(r);return n&&e.availableImages&&(n.available=e.availableImages.indexOf(r)>-1),n}eachChild(e){e(this.input)}outputDefined(){return!1}},bxe=class IW{constructor(e){this.type=wt,this.input=e}static parse(e,r){if(e.length!==2)return r.error("Expected 1 argument, but found ".concat(e.length-1," instead."));let n=r.parse(e[1],1);return n?n.type.kind!=="array"&&n.type.kind!=="string"&&n.type.kind!=="value"?r.error("Expected argument of type string or array, but found ".concat(hi(n.type)," instead.")):new IW(n):null}evaluate(e){let r=this.input.evaluate(e);if(typeof r=="string")return[...r].length;if(Array.isArray(r))return r.length;throw new mi("Expected value to be of type string or array, but found ".concat(hi(ji(r))," instead."))}eachChild(e){e(this.input)}outputDefined(){return!1}},Su=8192;function wxe(t,e){let r=Axe(t[0]),n=Exe(t[1]),i=Math.pow(2,e.z);return[Math.round(r*i*Su),Math.round(n*i*Su)]}function P5(t,e){let r=Math.pow(2,e.z),n=(t[0]/Su+e.x)/r,i=(t[1]/Su+e.y)/r;return[Sxe(n),Ixe(i)]}function Axe(t){return(180+t)/360}function Sxe(t){return t*360-180}function Exe(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Ixe(t){return 360/Math.PI*Math.atan(Math.exp((180-t*360)*Math.PI/180))-90}function o_(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function d1(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function Cxe(t,e,r){return e[1]>t[1]!=r[1]>t[1]&&t[0]<(r[0]-e[0])*(t[1]-e[1])/(r[1]-e[1])+e[0]}function Mxe(t,e,r){let n=t[0]-e[0],i=t[1]-e[1],a=t[0]-r[0],o=t[1]-r[1];return n*o-a*i===0&&n*a<=0&&i*o<=0}function o3(t,e,r,n){let i=[e[0]-t[0],e[1]-t[1]],a=[n[0]-r[0],n[1]-r[1]];return kxe(a,i)===0?!1:!!(Bz(t,e,r,n)&&Bz(r,n,t,e))}function Txe(t,e,r){for(let n of r)for(let i=0;i<n.length-1;++i)if(o3(t,e,n[i],n[i+1]))return!0;return!1}function y0(t,e,r=!1){let n=!1;for(let i of e)for(let a=0;a<i.length-1;a++){if(Mxe(t,i[a],i[a+1]))return r;Cxe(t,i[a],i[a+1])&&(n=!n)}return n}function Pxe(t,e){for(let r of e)if(y0(t,r))return!0;return!1}function CW(t,e){for(let r of t)if(!y0(r,e))return!1;for(let r=0;r<t.length-1;++r)if(Txe(t[r],t[r+1],e))return!1;return!0}function Dxe(t,e){for(let r of e)if(CW(t,r))return!0;return!1}function kxe(t,e){return t[0]*e[1]-t[1]*e[0]}function Bz(t,e,r,n){let i=t[0]-r[0],a=t[1]-r[1],o=e[0]-r[0],s=e[1]-r[1],l=n[0]-r[0],u=n[1]-r[1],c=i*u-l*a,h=o*u-l*s;return c>0&&h<0||c<0&&h>0}function D5(t,e,r){let n=[];for(let i=0;i<t.length;i++){let a=[];for(let o=0;o<t[i].length;o++){let s=wxe(t[i][o],r);o_(e,s),a.push(s)}n.push(a)}return n}function MW(t,e,r){let n=[];for(let i=0;i<t.length;i++){let a=D5(t[i],e,r);n.push(a)}return n}function TW(t,e,r,n){if(t[0]<r[0]||t[0]>r[2]){let i=n*.5,a=t[0]-r[0]>i?-n:r[0]-t[0]>i?n:0;a===0&&(a=t[0]-r[2]>i?-n:r[2]-t[0]>i?n:0),t[0]+=a}o_(e,t)}function Oxe(t){t[0]=t[1]=1/0,t[2]=t[3]=-1/0}function zz(t,e,r,n){let i=Math.pow(2,n.z)*Su,a=[n.x*Su,n.y*Su],o=[];for(let s of t)for(let l of s){let u=[l.x+a[0],l.y+a[1]];TW(u,e,r,i),o.push(u)}return o}function Fz(t,e,r,n){let i=Math.pow(2,n.z)*Su,a=[n.x*Su,n.y*Su],o=[];for(let s of t){let l=[];for(let u of s){let c=[u.x+a[0],u.y+a[1]];o_(e,c),l.push(c)}o.push(l)}if(e[2]-e[0]<=i/2){Oxe(e);for(let s of o)for(let l of s)TW(l,e,r,i)}return o}function Bxe(t,e){let r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if(e.type==="Polygon"){let a=D5(e.coordinates,n,i),o=zz(t.geometry(),r,n,i);if(!d1(r,n))return!1;for(let s of o)if(!y0(s,a))return!1}if(e.type==="MultiPolygon"){let a=MW(e.coordinates,n,i),o=zz(t.geometry(),r,n,i);if(!d1(r,n))return!1;for(let s of o)if(!Pxe(s,a))return!1}return!0}function zxe(t,e){let r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if(e.type==="Polygon"){let a=D5(e.coordinates,n,i),o=Fz(t.geometry(),r,n,i);if(!d1(r,n))return!1;for(let s of o)if(!CW(s,a))return!1}if(e.type==="MultiPolygon"){let a=MW(e.coordinates,n,i),o=Fz(t.geometry(),r,n,i);if(!d1(r,n))return!1;for(let s of o)if(!Dxe(s,a))return!1}return!0}var k5=class Wb{constructor(e,r){this.type=Sr,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error("'within' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(c1(e[1])){let n=e[1];if(n.type==="FeatureCollection"){let i=[];for(let a of n.features){let{type:o,coordinates:s}=a.geometry;o==="Polygon"&&i.push(s),o==="MultiPolygon"&&i.push(...s)}if(i.length){let a={type:"MultiPolygon",coordinates:i};return new Wb(n,a)}}else if(n.type==="Feature"){let i=n.geometry.type;if(i==="Polygon"||i==="MultiPolygon")return new Wb(n,n.geometry)}else if(n.type==="Polygon"||n.type==="MultiPolygon")return new Wb(n,n)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return Bxe(e,this.geometries);if(e.geometryType()==="LineString")return zxe(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}},PW=class{constructor(e=[],r=(n,i)=>n<i?-1:n>i?1:0){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;let e=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:r,compare:n}=this,i=r[e];for(;e>0;){let a=e-1>>1,o=r[a];if(n(i,o)>=0)break;r[e]=o,e=a}r[e]=i}_down(e){let{data:r,compare:n}=this,i=this.length>>1,a=r[e];for(;e<i;){let o=(e<<1)+1,s=o+1;if(s<this.length&&n(r[s],r[o])<0&&(o=s),n(r[o],a)>=0)break;r[e]=r[o],e=o}r[e]=a}};function DW(t,e,r=0,n=t.length-1,i=Fxe){for(;n>r;){if(n-r>600){let l=n-r+1,u=e-r+1,c=Math.log(l),h=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*h*(l-h)/l)*(u-l/2<0?-1:1),p=Math.max(r,Math.floor(e-u*h/l+d)),m=Math.min(n,Math.floor(e+(l-u)*h/l+d));DW(t,e,p,m,i)}let a=t[e],o=r,s=n;for(iy(t,r,e),i(t[n],a)>0&&iy(t,r,n);o<s;){for(iy(t,o,s),o++,s--;i(t[o],a)<0;)o++;for(;i(t[s],a)>0;)s--}i(t[r],a)===0?iy(t,r,s):(s++,iy(t,s,n)),s<=e&&(r=s+1),e<=s&&(n=s-1)}}function iy(t,e,r){let n=t[e];t[e]=t[r],t[r]=n}function Fxe(t,e){return t<e?-1:t>e?1:0}function O5(t,e){if(t.length<=1)return[t];let r=[],n,i;for(let a of t){let o=Lxe(a);o!==0&&(a.area=Math.abs(o),i===void 0&&(i=o<0),i===o<0?(n&&r.push(n),n=[a]):n.push(a))}if(n&&r.push(n),e>1)for(let a=0;a<r.length;a++)r[a].length<=e||(DW(r[a],e,1,r[a].length-1,Rxe),r[a]=r[a].slice(0,e));return r}function Rxe(t,e){return e.area-t.area}function Lxe(t){let e=0;for(let r=0,n=t.length,i=n-1,a,o;r<n;i=r++)a=t[r],o=t[i],e+=(o.x-a.x)*(a.y+o.y);return e}var Nxe=6378.137,Rz=1/298.257223563,Lz=Rz*(2-Rz),Nz=Math.PI/180,B5=class{constructor(e){let r=Nz*Nxe*1e3,n=Math.cos(e*Nz),i=1/(1-Lz*(1-n*n)),a=Math.sqrt(i);this.kx=r*a*n,this.ky=r*a*i*(1-Lz)}distance(e,r){let n=this.wrap(e[0]-r[0])*this.kx,i=(e[1]-r[1])*this.ky;return Math.sqrt(n*n+i*i)}pointOnLine(e,r){let n=1/0,i,a,o,s;for(let l=0;l<e.length-1;l++){let u=e[l][0],c=e[l][1],h=this.wrap(e[l+1][0]-u)*this.kx,d=(e[l+1][1]-c)*this.ky,p=0;(h!==0||d!==0)&&(p=(this.wrap(r[0]-u)*this.kx*h+(r[1]-c)*this.ky*d)/(h*h+d*d),p>1?(u=e[l+1][0],c=e[l+1][1]):p>0&&(u+=h/this.kx*p,c+=d/this.ky*p)),h=this.wrap(r[0]-u)*this.kx,d=(r[1]-c)*this.ky;let m=h*h+d*d;m<n&&(n=m,i=u,a=c,o=l,s=p)}return{point:[i,a],index:o,t:Math.max(0,Math.min(1,s))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}},KC=100,QC=50;function kW(t,e){return e[0]-t[0]}function w4(t){return t[1]-t[0]+1}function jc(t,e){return t[1]>=t[0]&&t[1]<e}function eM(t,e){if(t[0]>t[1])return[null,null];let r=w4(t);if(e){if(r===2)return[t,null];let i=Math.floor(r/2);return[[t[0],t[0]+i],[t[0]+i,t[1]]]}if(r===1)return[t,null];let n=Math.floor(r/2)-1;return[[t[0],t[0]+n],[t[0]+n+1,t[1]]]}function tM(t,e){if(!jc(e,t.length))return[1/0,1/0,-1/0,-1/0];let r=[1/0,1/0,-1/0,-1/0];for(let n=e[0];n<=e[1];++n)o_(r,t[n]);return r}function rM(t){let e=[1/0,1/0,-1/0,-1/0];for(let r of t)for(let n of r)o_(e,n);return e}function $z(t){return t[0]!==-1/0&&t[1]!==-1/0&&t[2]!==1/0&&t[3]!==1/0}function z5(t,e,r){if(!$z(t)||!$z(e))return NaN;let n=0,i=0;return t[2]<e[0]&&(n=e[0]-t[2]),t[0]>e[2]&&(n=t[0]-e[2]),t[1]>e[3]&&(i=t[1]-e[3]),t[3]<e[1]&&(i=e[1]-t[3]),r.distance([0,0],[n,i])}function gp(t,e,r){let n=r.pointOnLine(e,t);return r.distance(t,n.point)}function F5(t,e,r,n,i){let a=Math.min(gp(t,[r,n],i),gp(e,[r,n],i)),o=Math.min(gp(r,[t,e],i),gp(n,[t,e],i));return Math.min(a,o)}function $xe(t,e,r,n,i){if(!(jc(e,t.length)&&jc(n,r.length)))return 1/0;let a=1/0;for(let o=e[0];o<e[1];++o){let s=t[o],l=t[o+1];for(let u=n[0];u<n[1];++u){let c=r[u],h=r[u+1];if(o3(s,l,c,h))return 0;a=Math.min(a,F5(s,l,c,h,i))}}return a}function Uxe(t,e,r,n,i){if(!(jc(e,t.length)&&jc(n,r.length)))return NaN;let a=1/0;for(let o=e[0];o<=e[1];++o)for(let s=n[0];s<=n[1];++s)if(a=Math.min(a,i.distance(t[o],r[s])),a===0)return a;return a}function jxe(t,e,r){if(y0(t,e,!0))return 0;let n=1/0;for(let i of e){let a=i[0],o=i[i.length-1];if(a!==o&&(n=Math.min(n,gp(t,[o,a],r)),n===0))return n;let s=r.pointOnLine(i,t);if(n=Math.min(n,r.distance(t,s.point)),n===0)return n}return n}function Vxe(t,e,r,n){if(!jc(e,t.length))return NaN;for(let a=e[0];a<=e[1];++a)if(y0(t[a],r,!0))return 0;let i=1/0;for(let a=e[0];a<e[1];++a){let o=t[a],s=t[a+1];for(let l of r)for(let u=0,c=l.length,h=c-1;u<c;h=u++){let d=l[h],p=l[u];if(o3(o,s,d,p))return 0;i=Math.min(i,F5(o,s,d,p,n))}}return i}function Uz(t,e){for(let r of t)for(let n of r)if(y0(n,e,!0))return!0;return!1}function Gxe(t,e,r,n=1/0){let i=rM(t),a=rM(e);if(n!==1/0&&z5(i,a,r)>=n)return n;if(d1(i,a)){if(Uz(t,e))return 0}else if(Uz(e,t))return 0;let o=1/0;for(let s of t)for(let l=0,u=s.length,c=u-1;l<u;c=l++){let h=s[c],d=s[l];for(let p of e)for(let m=0,y=p.length,v=y-1;m<y;v=m++){let _=p[v],w=p[m];if(o3(h,d,_,w))return 0;o=Math.min(o,F5(h,d,_,w,r))}}return o}function jz(t,e,r,n,i,a){if(!a)return;let o=z5(tM(n,a),i,r);o<e&&t.push([o,a,[0,0]])}function zx(t,e,r,n,i,a,o){if(!a||!o)return;let s=z5(tM(n,a),tM(i,o),r);s<e&&t.push([s,a,o])}function A4(t,e,r,n,i=1/0){let a=Math.min(n.distance(t[0],r[0][0]),i);if(a===0)return a;let o=new PW([[0,[0,t.length-1],[0,0]]],kW),s=rM(r);for(;o.length>0;){let l=o.pop();if(l[0]>=a)continue;let u=l[1],c=e?QC:KC;if(w4(u)<=c){if(!jc(u,t.length))return NaN;if(e){let h=Vxe(t,u,r,n);if(isNaN(h)||h===0)return h;a=Math.min(a,h)}else for(let h=u[0];h<=u[1];++h){let d=jxe(t[h],r,n);if(a=Math.min(a,d),a===0)return 0}}else{let h=eM(u,e);jz(o,a,n,t,s,h[0]),jz(o,a,n,t,s,h[1])}}return a}function S4(t,e,r,n,i,a=1/0){let o=Math.min(a,i.distance(t[0],r[0]));if(o===0)return o;let s=new PW([[0,[0,t.length-1],[0,r.length-1]]],kW);for(;s.length>0;){let l=s.pop();if(l[0]>=o)continue;let u=l[1],c=l[2],h=e?QC:KC,d=n?QC:KC;if(w4(u)<=h&&w4(c)<=d){if(!jc(u,t.length)&&jc(c,r.length))return NaN;let p;if(e&&n)p=$xe(t,u,r,c,i),o=Math.min(o,p);else if(e&&!n){let m=t.slice(u[0],u[1]+1);for(let y=c[0];y<=c[1];++y)if(p=gp(r[y],m,i),o=Math.min(o,p),o===0)return o}else if(!e&&n){let m=r.slice(c[0],c[1]+1);for(let y=u[0];y<=u[1];++y)if(p=gp(t[y],m,i),o=Math.min(o,p),o===0)return o}else p=Uxe(t,u,r,c,i),o=Math.min(o,p)}else{let p=eM(u,e),m=eM(c,n);zx(s,o,i,t,r,p[0],m[0]),zx(s,o,i,t,r,p[0],m[1]),zx(s,o,i,t,r,p[1],m[0]),zx(s,o,i,t,r,p[1],m[1])}}return o}function Zxe(t,e){let r=t.geometry(),n=r.flat().map(o=>P5([o.x,o.y],t.canonical));if(r.length===0)return NaN;let i=new B5(n[0][1]),a=1/0;for(let o of e){switch(o.type){case"Point":a=Math.min(a,S4(n,!1,[o.coordinates],!1,i,a));break;case"LineString":a=Math.min(a,S4(n,!1,o.coordinates,!0,i,a));break;case"Polygon":a=Math.min(a,A4(n,!1,o.coordinates,i,a));break}if(a===0)return a}return a}function Wxe(t,e){let r=t.geometry(),n=r.flat().map(o=>P5([o.x,o.y],t.canonical));if(r.length===0)return NaN;let i=new B5(n[0][1]),a=1/0;for(let o of e){switch(o.type){case"Point":a=Math.min(a,S4(n,!0,[o.coordinates],!1,i,a));break;case"LineString":a=Math.min(a,S4(n,!0,o.coordinates,!0,i,a));break;case"Polygon":a=Math.min(a,A4(n,!0,o.coordinates,i,a));break}if(a===0)return a}return a}function Hxe(t,e){let r=t.geometry();if(r.length===0||r[0].length===0)return NaN;let n=O5(r,0).map(o=>o.map(s=>s.map(l=>P5([l.x,l.y],t.canonical)))),i=new B5(n[0][0][0][1]),a=1/0;for(let o of e)for(let s of n){switch(o.type){case"Point":a=Math.min(a,A4([o.coordinates],!1,s,i,a));break;case"LineString":a=Math.min(a,A4(o.coordinates,!0,s,i,a));break;case"Polygon":a=Math.min(a,Gxe(s,o.coordinates,i,a));break}if(a===0)return a}return a}function ME(t){return t.type==="MultiPolygon"?t.coordinates.map(e=>({type:"Polygon",coordinates:e})):t.type==="MultiLineString"?t.coordinates.map(e=>({type:"LineString",coordinates:e})):t.type==="MultiPoint"?t.coordinates.map(e=>({type:"Point",coordinates:e})):[t]}var R5=class Hb{constructor(e,r){this.type=wt,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error("'distance' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(c1(e[1])){let n=e[1];if(n.type==="FeatureCollection")return new Hb(n,n.features.map(i=>ME(i.geometry)).flat());if(n.type==="Feature")return new Hb(n,ME(n.geometry));if("type"in n&&"coordinates"in n)return new Hb(n,ME(n))}return r.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return Zxe(e,this.geometries);if(e.geometryType()==="LineString")return Wxe(e,this.geometries);if(e.geometryType()==="Polygon")return Hxe(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}},L5=class OW{constructor(e){this.type=br,this.key=e}static parse(e,r){if(e.length!==2)return r.error("Expected 1 argument, but found ".concat(e.length-1," instead."));let n=e[1];return n==null?r.error("Global state property must be defined."):typeof n!="string"?r.error("Global state property must be string, but found ".concat(typeof e[1]," instead.")):new OW(n)}evaluate(e){var r;let n=(r=e.globals)===null||r===void 0?void 0:r.globalState;return!n||Object.keys(n).length===0?null:zv(n,this.key)}eachChild(){}outputDefined(){return!1}},ig={"==":pxe,"!=":fxe,">":gxe,"<":mxe,">=":vxe,"<=":yxe,array:Ic,at:W_e,boolean:Ic,case:Y_e,coalesce:yW,collator:xW,format:AW,image:xxe,in:H_e,"index-of":X_e,interpolate:zl,"interpolate-hcl":zl,"interpolate-lab":zl,length:bxe,let:lW,literal:h1,match:q_e,number:Ic,"number-format":_xe,object:Ic,slice:J_e,step:T5,string:Ic,"to-boolean":$m,"to-color":$m,"to-number":$m,"to-string":$m,var:cW,within:k5,distance:R5,"global-state":L5},Yp=class Ly{constructor(e,r,n,i){this.name=e,this.type=r,this._evaluate=n,this.args=i}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,r){let n=e[0],i=Ly.definitions[n];if(!i)return r.error('Unknown expression "'.concat(n,'". If you wanted a literal array, use ["literal", [...]].'),0);let a=Array.isArray(i)?i[0]:i.type,o=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,s=o.filter(([u])=>!Array.isArray(u)||u.length===e.length-1),l=null;for(let[u,c]of s){l=new oW(r.registry,E4,r.path,null,r.scope);let h=[],d=!1;for(let p=1;p<e.length;p++){let m=e[p],y=Array.isArray(u)?u[p-1]:u.type,v=l.parse(m,1+h.length,y);if(!v){d=!0;break}h.push(v)}if(!d){if(Array.isArray(u)&&u.length!==h.length){l.error("Expected ".concat(u.length," arguments, but found ").concat(h.length," instead."));continue}for(let p=0;p<h.length;p++){let m=Array.isArray(u)?u[p]:u.type,y=h[p];l.concat(p+1).checkSubtype(m,y.type)}if(l.errors.length===0)return new Ly(n,a,c,h)}}if(s.length===1)r.errors.push(...l.errors);else{let u=(s.length?s:o).map(([h])=>qxe(h)).join(" | "),c=[];for(let h=1;h<e.length;h++){let d=r.parse(e[h],1+c.length);if(!d)return null;c.push(hi(d.type))}r.error("Expected arguments of type ".concat(u,", but found (").concat(c.join(", "),") instead."))}return null}static register(e,r){Ly.definitions=r;for(let n in r)e[n]=Ly}};function Vz(t,[e,r,n,i]){e=e.evaluate(t),r=r.evaluate(t),n=n.evaluate(t);let a=i?i.evaluate(t):1,o=tW(e,r,n,a);if(o)throw new mi(o);return new Gt(e/255,r/255,n/255,a,!1)}function Gz(t,e){return t in e}function TE(t,e){let r=e[t];return typeof r>"u"?null:r}function Xxe(t,e,r,n){for(;r<=n;){let i=r+n>>1;if(e[i]===t)return!0;e[i]>t?n=i-1:r=i+1}return!1}function Nd(t){return{type:t}}Yp.register(ig,{error:[D_e,[Tr],(t,[e])=>{throw new mi(e.evaluate(t))}],typeof:[Tr,[br],(t,[e])=>hi(ji(e.evaluate(t)))],"to-rgba":[hs(wt,4),[Bl],(t,[e])=>{let[r,n,i,a]=e.evaluate(t).rgb;return[r*255,n*255,i*255,a]}],rgb:[Bl,[wt,wt,wt],Vz],rgba:[Bl,[wt,wt,wt,wt],Vz],has:{type:Sr,overloads:[[[Tr],(t,[e])=>Gz(e.evaluate(t),t.properties())],[[Tr,Tp],(t,[e,r])=>Gz(e.evaluate(t),r.evaluate(t))]]},get:{type:br,overloads:[[[Tr],(t,[e])=>TE(e.evaluate(t),t.properties())],[[Tr,Tp],(t,[e,r])=>TE(e.evaluate(t),r.evaluate(t))]]},"feature-state":[br,[Tr],(t,[e])=>TE(e.evaluate(t),t.featureState||{})],properties:[Tp,[],t=>t.properties()],"geometry-type":[Tr,[],t=>t.geometryType()],id:[br,[],t=>t.id()],zoom:[wt,[],t=>t.globals.zoom],"heatmap-density":[wt,[],t=>t.globals.heatmapDensity||0],elevation:[wt,[],t=>t.globals.elevation||0],"line-progress":[wt,[],t=>t.globals.lineProgress||0],accumulated:[br,[],t=>t.globals.accumulated===void 0?null:t.globals.accumulated],"+":[wt,Nd(wt),(t,e)=>{let r=0;for(let n of e)r+=n.evaluate(t);return r}],"*":[wt,Nd(wt),(t,e)=>{let r=1;for(let n of e)r*=n.evaluate(t);return r}],"-":{type:wt,overloads:[[[wt,wt],(t,[e,r])=>e.evaluate(t)-r.evaluate(t)],[[wt],(t,[e])=>-e.evaluate(t)]]},"/":[wt,[wt,wt],(t,[e,r])=>e.evaluate(t)/r.evaluate(t)],"%":[wt,[wt,wt],(t,[e,r])=>e.evaluate(t)%r.evaluate(t)],ln2:[wt,[],()=>Math.LN2],pi:[wt,[],()=>Math.PI],e:[wt,[],()=>Math.E],"^":[wt,[wt,wt],(t,[e,r])=>Math.pow(e.evaluate(t),r.evaluate(t))],sqrt:[wt,[wt],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[wt,[wt],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[wt,[wt],(t,[e])=>Math.log(e.evaluate(t))],log2:[wt,[wt],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[wt,[wt],(t,[e])=>Math.sin(e.evaluate(t))],cos:[wt,[wt],(t,[e])=>Math.cos(e.evaluate(t))],tan:[wt,[wt],(t,[e])=>Math.tan(e.evaluate(t))],asin:[wt,[wt],(t,[e])=>Math.asin(e.evaluate(t))],acos:[wt,[wt],(t,[e])=>Math.acos(e.evaluate(t))],atan:[wt,[wt],(t,[e])=>Math.atan(e.evaluate(t))],min:[wt,Nd(wt),(t,e)=>Math.min(...e.map(r=>r.evaluate(t)))],max:[wt,Nd(wt),(t,e)=>Math.max(...e.map(r=>r.evaluate(t)))],abs:[wt,[wt],(t,[e])=>Math.abs(e.evaluate(t))],round:[wt,[wt],(t,[e])=>{let r=e.evaluate(t);return r<0?-Math.round(-r):Math.round(r)}],floor:[wt,[wt],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[wt,[wt],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[Sr,[Tr,br],(t,[e,r])=>t.properties()[e.value]===r.value],"filter-id-==":[Sr,[br],(t,[e])=>t.id()===e.value],"filter-type-==":[Sr,[Tr],(t,[e])=>t.geometryType()===e.value],"filter-<":[Sr,[Tr,br],(t,[e,r])=>{let n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n<i}],"filter-id-<":[Sr,[br],(t,[e])=>{let r=t.id(),n=e.value;return typeof r==typeof n&&r<n}],"filter->":[Sr,[Tr,br],(t,[e,r])=>{let n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n>i}],"filter-id->":[Sr,[br],(t,[e])=>{let r=t.id(),n=e.value;return typeof r==typeof n&&r>n}],"filter-<=":[Sr,[Tr,br],(t,[e,r])=>{let n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n<=i}],"filter-id-<=":[Sr,[br],(t,[e])=>{let r=t.id(),n=e.value;return typeof r==typeof n&&r<=n}],"filter->=":[Sr,[Tr,br],(t,[e,r])=>{let n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n>=i}],"filter-id->=":[Sr,[br],(t,[e])=>{let r=t.id(),n=e.value;return typeof r==typeof n&&r>=n}],"filter-has":[Sr,[br],(t,[e])=>e.value in t.properties()],"filter-has-id":[Sr,[],t=>t.id()!==null&&t.id()!==void 0],"filter-type-in":[Sr,[hs(Tr)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[Sr,[hs(br)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[Sr,[Tr,hs(br)],(t,[e,r])=>r.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[Sr,[Tr,hs(br)],(t,[e,r])=>Xxe(t.properties()[e.value],r.value,0,r.value.length-1)],all:{type:Sr,overloads:[[[Sr,Sr],(t,[e,r])=>e.evaluate(t)&&r.evaluate(t)],[Nd(Sr),(t,e)=>{for(let r of e)if(!r.evaluate(t))return!1;return!0}]]},any:{type:Sr,overloads:[[[Sr,Sr],(t,[e,r])=>e.evaluate(t)||r.evaluate(t)],[Nd(Sr),(t,e)=>{for(let r of e)if(r.evaluate(t))return!0;return!1}]]},"!":[Sr,[Sr],(t,[e])=>!e.evaluate(t)],"is-supported-script":[Sr,[Tr],(t,[e])=>{let r=t.globals&&t.globals.isSupportedScript;return r?r(e.evaluate(t)):!0}],upcase:[Tr,[Tr],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[Tr,[Tr],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[Tr,Nd(br),(t,e)=>e.map(r=>Fv(r.evaluate(t))).join("")],"resolved-locale":[Tr,[t3],(t,[e])=>e.evaluate(t).resolvedLocale()]});function qxe(t){return Array.isArray(t)?"(".concat(t.map(hi).join(", "),")"):"(".concat(hi(t.type),"...)")}function E4(t){if(t instanceof cW)return E4(t.boundExpression);if(t instanceof Yp&&t.name==="error"||t instanceof xW||t instanceof k5||t instanceof R5||t instanceof L5)return!1;let e=t instanceof $m||t instanceof Ic,r=!0;return t.eachChild(n=>{e?r=r&&E4(n):r=r&&n instanceof h1}),r?s3(t)&&l3(t,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"]):!1}function s3(t){if(t instanceof Yp&&(t.name==="get"&&t.args.length===1||t.name==="feature-state"||t.name==="has"&&t.args.length===1||t.name==="properties"||t.name==="geometry-type"||t.name==="id"||/^filter-/.test(t.name))||t instanceof k5||t instanceof R5)return!1;let e=!0;return t.eachChild(r=>{e&&!s3(r)&&(e=!1)}),e}function p1(t){if(t instanceof Yp&&t.name==="feature-state")return!1;let e=!0;return t.eachChild(r=>{e&&!p1(r)&&(e=!1)}),e}function l3(t,e){if(t instanceof Yp&&e.indexOf(t.name)>=0)return!1;let r=!0;return t.eachChild(n=>{r&&!l3(n,e)&&(r=!1)}),r}function nM(t){return{result:"success",value:t}}function Vf(t){return{result:"error",value:t}}function Og(t){return t["property-type"]==="data-driven"||t["property-type"]==="cross-faded-data-driven"}function BW(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function N5(t){return!!t.expression&&t.expression.interpolated}function Pr(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":t===null?"null":typeof t}function u3(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)&&ji(t)===Tp}function Yxe(t){return t}function Jxe(t){switch(t.type){case"color":return Gt.parse;case"padding":return Lu.parse;case"numberArray":return Nu.parse;case"colorArray":return Zs.parse;default:return null}}function Kxe(t){switch(t){case"exponential":return FW;case"interval":return ebe;case"categorical":return Qxe;case"identity":return tbe;default:throw new Error('Unknown function type "'.concat(t,'"'))}}function zW(t,e){let r=t.stops&&typeof t.stops[0][0]=="object",n=r||t.property!==void 0,i=r||!n,a=t.type||(N5(e)?"exponential":"interval"),o=Jxe(e);if(o&&(t=Dg({},t),t.stops&&(t.stops=t.stops.map(c=>[c[0],o(c[1])])),t.default?t.default=o(t.default):t.default=o(e.default)),t.colorSpace&&!j_e(t.colorSpace))throw new Error('Unknown color space: "'.concat(t.colorSpace,'"'));let s=Kxe(a),l,u;if(a==="categorical"){l=Object.create(null);for(let c of t.stops)l[c[0]]=c[1];u=typeof t.stops[0][0]}if(r){let c={},h=[];for(let m=0;m<t.stops.length;m++){let y=t.stops[m],v=y[0].zoom;c[v]===void 0&&(c[v]={zoom:v,type:t.type,property:t.property,default:t.default,stops:[]},h.push(v)),c[v].stops.push([y[0].value,y[1]])}let d=[];for(let m of h)d.push([c[m].zoom,zW(c[m],e)]);let p={name:"linear"};return{kind:"composite",interpolationType:p,interpolationFactor:zl.interpolationFactor.bind(void 0,p),zoomStops:d.map(m=>m[0]),evaluate({zoom:m},y){return FW({stops:d,base:t.base},e,m).evaluate(m,y)}}}else if(i){let c=a==="exponential"?{name:"exponential",base:t.base!==void 0?t.base:1}:null;return{kind:"camera",interpolationType:c,interpolationFactor:zl.interpolationFactor.bind(void 0,c),zoomStops:t.stops.map(h=>h[0]),evaluate:({zoom:h})=>s(t,e,h,l,u)}}else return{kind:"source",evaluate(c,h){let d=h&&h.properties?h.properties[t.property]:void 0;return d===void 0?s_(t.default,e.default):s(t,e,d,l,u)}}}function s_(t,e,r){if(t!==void 0)return t;if(e!==void 0)return e;if(r!==void 0)return r}function Qxe(t,e,r,n,i){let a=typeof r===i?n[r]:void 0;return s_(a,t.default,e.default)}function ebe(t,e,r){if(Pr(r)!=="number")return s_(t.default,e.default);let n=t.stops.length;if(n===1||r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[n-1][0])return t.stops[n-1][1];let i=a3(t.stops.map(a=>a[0]),r);return t.stops[i][1]}function FW(t,e,r){let n=t.base!==void 0?t.base:1;if(Pr(r)!=="number")return s_(t.default,e.default);let i=t.stops.length;if(i===1||r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[i-1][0])return t.stops[i-1][1];let a=a3(t.stops.map(c=>c[0]),r),o=rbe(r,n,t.stops[a][0],t.stops[a+1][0]),s=t.stops[a][1],l=t.stops[a+1][1],u=di[e.type]||Yxe;return typeof s.evaluate=="function"?{evaluate(...c){let h=s.evaluate.apply(void 0,c),d=l.evaluate.apply(void 0,c);if(!(h===void 0||d===void 0))return u(h,d,o,t.colorSpace)}}:u(s,l,o,t.colorSpace)}function tbe(t,e,r){switch(e.type){case"color":r=Gt.parse(r);break;case"formatted":r=Uc.fromString(r.toString());break;case"resolvedImage":r=Mu.fromString(r.toString());break;case"padding":r=Lu.parse(r);break;case"colorArray":r=Zs.parse(r);break;case"numberArray":r=Nu.parse(r);break;default:Pr(r)!==e.type&&(e.type!=="enum"||!e.values[r])&&(r=void 0)}return s_(r,t.default,e.default)}function rbe(t,e,r,n){let i=n-r,a=t-r;return i===0?0:e===1?a/i:(Math.pow(e,a)-1)/(Math.pow(e,i)-1)}var $5=class{constructor(e,r){this.expression=e,this._warningHistory={},this._evaluator=new aW,this._defaultValue=r?obe(r):null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(e,r,n,i,a,o){return this._evaluator.globals=e,this._evaluator.feature=r,this._evaluator.featureState=n,this._evaluator.canonical=i,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=o,this.expression.evaluate(this._evaluator)}evaluate(e,r,n,i,a,o){this._evaluator.globals=e,this._evaluator.feature=r||null,this._evaluator.featureState=n||null,this._evaluator.canonical=i,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=o||null;try{let s=this.expression.evaluate(this._evaluator);if(s==null||typeof s=="number"&&s!==s)return this._defaultValue;if(this._enumValues&&!(s in this._enumValues))throw new mi("Expected value to be one of ".concat(Object.keys(this._enumValues).map(l=>JSON.stringify(l)).join(", "),", but found ").concat(JSON.stringify(s)," instead."));return s}catch(s){return this._warningHistory[s.message]||(this._warningHistory[s.message]=!0,typeof console<"u"&&console.warn(s.message)),this._defaultValue}}};function c3(t){return Array.isArray(t)&&t.length>0&&typeof t[0]=="string"&&t[0]in ig}function U5(t,e){let r=new oW(ig,E4,[],e?abe(e):void 0),n=r.parse(t,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return n?nM(new $5(n,e)):Vf(r.errors)}var f1=class{constructor(e,r){this.kind=e,this._styleExpression=r,this.isStateDependent=e!=="constant"&&!p1(r.expression),this.globalStateRefs=h3(r.expression)}evaluateWithoutErrorHandling(e,r,n,i,a,o){return this._styleExpression.evaluateWithoutErrorHandling(e,r,n,i,a,o)}evaluate(e,r,n,i,a,o){return this._styleExpression.evaluate(e,r,n,i,a,o)}},I4=class{constructor(e,r,n,i){this.kind=e,this.zoomStops=n,this._styleExpression=r,this.isStateDependent=e!=="camera"&&!p1(r.expression),this.globalStateRefs=h3(r.expression),this.interpolationType=i}evaluateWithoutErrorHandling(e,r,n,i,a,o){return this._styleExpression.evaluateWithoutErrorHandling(e,r,n,i,a,o)}evaluate(e,r,n,i,a,o){return this._styleExpression.evaluate(e,r,n,i,a,o)}interpolationFactor(e,r,n){return this.interpolationType?zl.interpolationFactor(this.interpolationType,e,r,n):0}};function nbe(t){return t._styleExpression!==void 0}function RW(t,e){let r=U5(t,e);if(r.result==="error")return r;let n=r.value.expression,i=s3(n);if(!i&&!Og(e))return Vf([new fu("","data expressions not supported")]);let a=l3(n,["zoom"]);if(!a&&!BW(e))return Vf([new fu("","zoom expressions not supported")]);let o=Xb(n);if(!o&&!a)return Vf([new fu("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(o instanceof fu)return Vf([o]);if(o instanceof zl&&!N5(e))return Vf([new fu("",'"interpolate" expressions cannot be used with this property')]);if(!o)return nM(i?new f1("constant",r.value):new f1("source",r.value));let s=o instanceof zl?o.interpolation:void 0;return nM(i?new I4("camera",r.value,o.labels,s):new I4("composite",r.value,o.labels,s))}var LW=class NW{constructor(e,r){this._parameters=e,this._specification=r,Dg(this,zW(this._parameters,this._specification))}static deserialize(e){return new NW(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}};function ibe(t,e){if(u3(t))return new LW(t,e);if(c3(t)){let r=RW(t,e);if(r.result==="error")throw new Error(r.value.map(n=>"".concat(n.key,": ").concat(n.message)).join(", "));return r.value}else{let r=t;return e.type==="color"&&typeof t=="string"?r=Gt.parse(t):e.type==="padding"&&(typeof t=="number"||Array.isArray(t))?r=Lu.parse(t):e.type==="numberArray"&&(typeof t=="number"||Array.isArray(t))?r=Nu.parse(t):e.type==="colorArray"&&(typeof t=="string"||Array.isArray(t))?r=Zs.parse(t):e.type==="variableAnchorOffsetCollection"&&Array.isArray(t)?r=xd.parse(t):e.type==="projectionDefinition"&&typeof t=="string"&&(r=qp.parse(t)),{globalStateRefs:new Set,kind:"constant",evaluate:()=>r}}}function Xb(t){let e=null;if(t instanceof lW)e=Xb(t.result);else if(t instanceof yW){for(let r of t.args)if(e=Xb(r),e)break}else(t instanceof T5||t instanceof zl)&&t.input instanceof Yp&&t.input.name==="zoom"&&(e=t);return e instanceof fu||t.eachChild(r=>{let n=Xb(r);n instanceof fu?e=n:!e&&n?e=new fu("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&n&&e!==n&&(e=new fu("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function h3(t,e=new Set){return t instanceof L5&&e.add(t.key),t.eachChild(r=>{h3(r,e)}),e}function abe(t){let e={color:Bl,string:Tr,number:wt,enum:Tr,boolean:Sr,formatted:i_,padding:r3,numberArray:n3,colorArray:l1,projectionDefinition:e3,resolvedImage:a_,variableAnchorOffsetCollection:i3};return t.type==="array"?hs(e[t.value]||br,t.length):e[t.type]}function obe(t){if(t.type==="color"&&u3(t.default))return new Gt(0,0,0,0);switch(t.type){case"color":return Gt.parse(t.default)||null;case"padding":return Lu.parse(t.default)||null;case"numberArray":return Nu.parse(t.default)||null;case"colorArray":return Zs.parse(t.default)||null;case"variableAnchorOffsetCollection":return xd.parse(t.default)||null;case"projectionDefinition":return qp.parse(t.default)||null;default:return t.default===void 0?null:t.default}}function j5(t){if(t===!0||t===!1)return!0;if(!Array.isArray(t)||t.length===0)return!1;switch(t[0]){case"has":return t.length>=2&&t[1]!=="$id"&&t[1]!=="$type";case"in":return t.length>=3&&(typeof t[1]!="string"||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return t.length!==3||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(let e of t.slice(1))if(!j5(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}var sbe={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function m1(t){if(t==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};j5(t)||(t=C4(t));let e=U5(t,sbe);if(e.result==="error")throw new Error(e.value.map(r=>"".concat(r.key,": ").concat(r.message)).join(", "));{let r=$W(t);return{filter:(n,i,a)=>e.value.evaluate(n,i,{},a),needGeometry:r,getGlobalStateRefs:()=>h3(e.value.expression)}}}function lbe(t,e){return t<e?-1:t>e?1:0}function $W(t){if(!Array.isArray(t))return!1;if(t[0]==="within"||t[0]==="distance")return!0;for(let e=1;e<t.length;e++)if($W(t[e]))return!0;return!1}function C4(t){if(!t)return!0;let e=t[0];return t.length<=1?e!=="any":e==="=="?PE(t[1],t[2],"=="):e==="!="?Fx(PE(t[1],t[2],"==")):e==="<"||e===">"||e==="<="||e===">="?PE(t[1],t[2],e):e==="any"?ube(t.slice(1)):e==="all"?["all"].concat(t.slice(1).map(C4)):e==="none"?["all"].concat(t.slice(1).map(C4).map(Fx)):e==="in"?Zz(t[1],t.slice(2)):e==="!in"?Fx(Zz(t[1],t.slice(2))):e==="has"?Wz(t[1]):e==="!has"?Fx(Wz(t[1])):!0}function PE(t,e,r){switch(t){case"$type":return["filter-type-".concat(r),e];case"$id":return["filter-id-".concat(r),e];default:return["filter-".concat(r),t,e]}}function ube(t){return["any"].concat(t.map(C4))}function Zz(t,e){if(e.length===0)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(r=>typeof r!=typeof e[0])?["filter-in-large",t,["literal",e.sort(lbe)]]:["filter-in-small",t,["literal",e]]}}function Wz(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Fx(t){return["!",t]}function cbe(){let t={},e=Oe.$version;for(let r in Oe.$root){let n=Oe.$root[r];if(n.required){let i=null;r==="version"?i=e:n.type==="array"?i=[]:i={},i!=null&&(t[r]=i)}}return t}function UW(t){let e=t.key,r=t.value;return r?[new it(e,r,"constants have been deprecated as of v8")]:[]}function Di(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Lp(t){if(Array.isArray(t))return t.map(Lp);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){let e={};for(let r in t)e[r]=Lp(t[r]);return e}return Di(t)}function Vs(t){let e=t.key,r=t.value,n=t.valueSpec||{},i=t.objectElementValidators||{},a=t.style,o=t.styleSpec,s=t.validateSpec,l=[],u=Pr(r);if(u!=="object")return[new it(e,r,"object expected, ".concat(u," found"))];for(let c in r){let h=c.split(".")[0],d=zv(n,h)||n["*"],p;if(zv(i,h))p=i[h];else if(zv(n,h))p=s;else if(i["*"])p=i["*"];else if(n["*"])p=s;else{l.push(new it(e,r[c],'unknown property "'.concat(c,'"')));continue}l=l.concat(p({key:(e&&"".concat(e,"."))+c,value:r[c],valueSpec:d,style:a,styleSpec:o,object:r,objectKey:c,validateSpec:s},r))}for(let c in n)i[c]||n[c].required&&n[c].default===void 0&&r[c]===void 0&&l.push(new it(e,r,'missing required property "'.concat(c,'"')));return l}function V5(t){let e=t.value,r=t.valueSpec,n=t.validateSpec,i=t.style,a=t.styleSpec,o=t.key,s=t.arrayElementValidator||n;if(Pr(e)!=="array")return[new it(o,e,"array expected, ".concat(Pr(e)," found"))];if(r.length&&e.length!==r.length)return[new it(o,e,"array length ".concat(r.length," expected, length ").concat(e.length," found"))];if(r["min-length"]&&e.length<r["min-length"])return[new it(o,e,"array length at least ".concat(r["min-length"]," expected, length ").concat(e.length," found"))];let l={type:r.value,values:r.values};a.$version<7&&(l.function=r.function),Pr(r.value)==="object"&&(l=r.value);let u=[];for(let c=0;c<e.length;c++)u=u.concat(s({array:e,arrayIndex:c,value:e[c],valueSpec:l,validateSpec:t.validateSpec,style:i,styleSpec:a,key:"".concat(o,"[").concat(c,"]")}));return u}function d3(t){let e=t.key,r=t.value,n=t.valueSpec,i=Pr(r);return i==="number"&&r!==r&&(i="NaN"),i!=="number"?[new it(e,r,"number expected, ".concat(i," found"))]:"minimum"in n&&r<n.minimum?[new it(e,r,"".concat(r," is less than the minimum value ").concat(n.minimum))]:"maximum"in n&&r>n.maximum?[new it(e,r,"".concat(r," is greater than the maximum value ").concat(n.maximum))]:[]}function jW(t){let e=t.valueSpec,r=Di(t.value.type),n,i={},a,o,s=r!=="categorical"&&t.value.property===void 0,l=!s,u=Pr(t.value.stops)==="array"&&Pr(t.value.stops[0])==="array"&&Pr(t.value.stops[0][0])==="object",c=Vs({key:t.key,value:t.value,valueSpec:t.styleSpec.function,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:h,default:m}});return r==="identity"&&s&&c.push(new it(t.key,t.value,'missing required property "property"')),r!=="identity"&&!t.value.stops&&c.push(new it(t.key,t.value,'missing required property "stops"')),r==="exponential"&&t.valueSpec.expression&&!N5(t.valueSpec)&&c.push(new it(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!Og(t.valueSpec)?c.push(new it(t.key,t.value,"property functions not supported")):s&&!BW(t.valueSpec)&&c.push(new it(t.key,t.value,"zoom functions not supported"))),(r==="categorical"||u)&&t.value.property===void 0&&c.push(new it(t.key,t.value,'"property" property is required')),c;function h(y){if(r==="identity")return[new it(y.key,y.value,'identity function may not have a "stops" property')];let v=[],_=y.value;return v=v.concat(V5({key:y.key,value:_,valueSpec:y.valueSpec,validateSpec:y.validateSpec,style:y.style,styleSpec:y.styleSpec,arrayElementValidator:d})),Pr(_)==="array"&&_.length===0&&v.push(new it(y.key,_,"array must have at least one stop")),v}function d(y){let v=[],_=y.value,w=y.key;if(Pr(_)!=="array")return[new it(w,_,"array expected, ".concat(Pr(_)," found"))];if(_.length!==2)return[new it(w,_,"array length 2 expected, length ".concat(_.length," found"))];if(u){if(Pr(_[0])!=="object")return[new it(w,_,"object expected, ".concat(Pr(_[0])," found"))];if(_[0].zoom===void 0)return[new it(w,_,"object stop key must have zoom")];if(_[0].value===void 0)return[new it(w,_,"object stop key must have value")];if(o&&o>Di(_[0].zoom))return[new it(w,_[0].zoom,"stop zoom values must appear in ascending order")];Di(_[0].zoom)!==o&&(o=Di(_[0].zoom),a=void 0,i={}),v=v.concat(Vs({key:"".concat(w,"[0]"),value:_[0],valueSpec:{zoom:{}},validateSpec:y.validateSpec,style:y.style,styleSpec:y.styleSpec,objectElementValidators:{zoom:d3,value:p}}))}else v=v.concat(p({key:"".concat(w,"[0]"),value:_[0],validateSpec:y.validateSpec,style:y.style,styleSpec:y.styleSpec},_));return c3(Lp(_[1]))?v.concat([new it("".concat(w,"[1]"),_[1],"expressions are not allowed in function stops.")]):v.concat(y.validateSpec({key:"".concat(w,"[1]"),value:_[1],valueSpec:e,validateSpec:y.validateSpec,style:y.style,styleSpec:y.styleSpec}))}function p(y,v){let _=Pr(y.value),w=Di(y.value),b=y.value!==null?y.value:v;if(!n)n=_;else if(_!==n)return[new it(y.key,b,"".concat(_," stop domain type must match previous stop domain type ").concat(n))];if(_!=="number"&&_!=="string"&&_!=="boolean")return[new it(y.key,b,"stop domain value must be a number, string, or boolean")];if(_!=="number"&&r!=="categorical"){let A="number expected, ".concat(_," found");return Og(e)&&r===void 0&&(A+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new it(y.key,b,A)]}return r==="categorical"&&_==="number"&&(!isFinite(w)||Math.floor(w)!==w)?[new it(y.key,b,"integer expected, found ".concat(w))]:r!=="categorical"&&_==="number"&&a!==void 0&&w<a?[new it(y.key,b,"stop domain values must appear in ascending order")]:(a=w,r==="categorical"&&w in i?[new it(y.key,b,"stop domain values must be unique")]:(i[w]=!0,[]))}function m(y){return y.validateSpec({key:y.key,value:y.value,valueSpec:e,validateSpec:y.validateSpec,style:y.style,styleSpec:y.styleSpec})}}function Bg(t){let e=(t.expressionContext==="property"?RW:U5)(Lp(t.value),t.valueSpec);if(e.result==="error")return e.value.map(n=>new it("".concat(t.key).concat(n.key),t.value,n.message));let r=e.value.expression||e.value._styleExpression.expression;if(t.expressionContext==="property"&&t.propertyKey==="text-font"&&!r.outputDefined())return[new it(t.key,t.value,'Invalid data expression for "'.concat(t.propertyKey,'". Output values must be contained as literals within the expression.'))];if(t.expressionContext==="property"&&t.propertyType==="layout"&&!p1(r))return[new it(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if(t.expressionContext==="filter"&&!p1(r))return[new it(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&t.expressionContext.indexOf("cluster")===0){if(!l3(r,["zoom","feature-state"]))return[new it(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(t.expressionContext==="cluster-initial"&&!s3(r))return[new it(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function hbe(t){let e=t.value,r=t.key,n=Pr(e);return n!=="boolean"?[new it(r,e,"boolean expected, ".concat(n," found"))]:[]}function iM(t){let e=t.key,r=t.value,n=Pr(r);return n!=="string"?[new it(e,r,"color expected, ".concat(n," found"))]:Gt.parse(String(r))?[]:[new it(e,r,'color expected, "'.concat(r,'" found'))]}function g1(t){let e=t.key,r=t.value,n=t.valueSpec,i=[];return Array.isArray(n.values)?n.values.indexOf(Di(r))===-1&&i.push(new it(e,r,"expected one of [".concat(n.values.join(", "),"], ").concat(JSON.stringify(r)," found"))):Object.keys(n.values).indexOf(Di(r))===-1&&i.push(new it(e,r,"expected one of [".concat(Object.keys(n.values).join(", "),"], ").concat(JSON.stringify(r)," found"))),i}function G5(t){return j5(Lp(t.value))?Bg(Dg({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):VW(t)}function VW(t){let e=t.value,r=t.key;if(Pr(e)!=="array")return[new it(r,e,"array expected, ".concat(Pr(e)," found"))];let n=t.styleSpec,i,a=[];if(e.length<1)return[new it(r,e,"filter array must have at least 1 element")];switch(a=a.concat(g1({key:"".concat(r,"[0]"),value:e[0],valueSpec:n.filter_operator,style:t.style,styleSpec:t.styleSpec})),Di(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Di(e[1])==="$type"&&a.push(new it(r,e,'"$type" cannot be use with operator "'.concat(e[0],'"')));case"==":case"!=":e.length!==3&&a.push(new it(r,e,'filter array for operator "'.concat(e[0],'" must have 3 elements')));case"in":case"!in":e.length>=2&&(i=Pr(e[1]),i!=="string"&&a.push(new it("".concat(r,"[1]"),e[1],"string expected, ".concat(i," found"))));for(let o=2;o<e.length;o++)i=Pr(e[o]),Di(e[1])==="$type"?a=a.concat(g1({key:"".concat(r,"[").concat(o,"]"),value:e[o],valueSpec:n.geometry_type,style:t.style,styleSpec:t.styleSpec})):i!=="string"&&i!=="number"&&i!=="boolean"&&a.push(new it("".concat(r,"[").concat(o,"]"),e[o],"string, number, or boolean expected, ".concat(i," found")));break;case"any":case"all":case"none":for(let o=1;o<e.length;o++)a=a.concat(VW({key:"".concat(r,"[").concat(o,"]"),value:e[o],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":i=Pr(e[1]),e.length!==2?a.push(new it(r,e,'filter array for "'.concat(e[0],'" operator must have 2 elements'))):i!=="string"&&a.push(new it("".concat(r,"[1]"),e[1],"string expected, ".concat(i," found")));break}return a}function GW(t,e){let r=t.key,n=t.validateSpec,i=t.style,a=t.styleSpec,o=t.value,s=t.objectKey,l=a["".concat(e,"_").concat(t.layerType)];if(!l)return[];let u=s.match(/^(.*)-transition$/);if(e==="paint"&&u&&l[u[1]]&&l[u[1]].transition)return n({key:r,value:o,valueSpec:a.transition,style:i,styleSpec:a});let c=t.valueSpec||l[s];if(!c)return[new it(r,o,'unknown property "'.concat(s,'"'))];let h;if(Pr(o)==="string"&&Og(c)&&!c.tokens&&(h=/^{([^}]+)}$/.exec(o)))return[new it(r,o,'"'.concat(s,`" does not support interpolation syntax
`)+'Use an identity property function instead: `{ "type": "identity", "property": '.concat(JSON.stringify(h[1])," }`."))];let d=[];return t.layerType==="symbol"&&(s==="text-field"&&i&&!i.glyphs&&d.push(new it(r,o,'use of "text-field" requires a style "glyphs" property')),s==="text-font"&&u3(Lp(o))&&Di(o.type)==="identity"&&d.push(new it(r,o,'"text-font" does not support identity functions'))),d.concat(n({key:t.key,value:o,valueSpec:c,style:i,styleSpec:a,expressionContext:"property",propertyType:e,propertyKey:s}))}function ZW(t){return GW(t,"paint")}function WW(t){return GW(t,"layout")}function HW(t){let e=[],r=t.value,n=t.key,i=t.style,a=t.styleSpec;if(Pr(r)!=="object")return[new it(n,r,"object expected, ".concat(Pr(r)," found"))];!r.type&&!r.ref&&e.push(new it(n,r,'either "type" or "ref" is required'));let o=Di(r.type),s=Di(r.ref);if(r.id){let l=Di(r.id);for(let u=0;u<t.arrayIndex;u++){let c=i.layers[u];Di(c.id)===l&&e.push(new it(n,r.id,'duplicate layer id "'.concat(r.id,'", previously used at line ').concat(c.id.__line__)))}}if("ref"in r){["type","source","source-layer","filter","layout"].forEach(u=>{u in r&&e.push(new it(n,r[u],'"'.concat(u,'" is prohibited for ref layers')))});let l;i.layers.forEach(u=>{Di(u.id)===s&&(l=u)}),l?l.ref?e.push(new it(n,r.ref,"ref cannot reference another ref layer")):o=Di(l.type):e.push(new it(n,r.ref,'ref layer "'.concat(s,'" not found')))}else if(o!=="background")if(!r.source)e.push(new it(n,r,'missing required property "source"'));else{let l=i.sources&&i.sources[r.source],u=l&&Di(l.type);l?u==="vector"&&o==="raster"?e.push(new it(n,r.source,'layer "'.concat(r.id,'" requires a raster source'))):u!=="raster-dem"&&o==="hillshade"?e.push(new it(n,r.source,'layer "'.concat(r.id,'" requires a raster-dem source'))):u!=="raster-dem"&&o==="color-relief"?e.push(new it(n,r.source,'layer "'.concat(r.id,'" requires a raster-dem source'))):u==="raster"&&o!=="raster"?e.push(new it(n,r.source,'layer "'.concat(r.id,'" requires a vector source'))):u==="vector"&&!r["source-layer"]?e.push(new it(n,r,'layer "'.concat(r.id,'" must specify a "source-layer"'))):u==="raster-dem"&&o!=="hillshade"&&o!=="color-relief"?e.push(new it(n,r.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):o==="line"&&r.paint&&r.paint["line-gradient"]&&(u!=="geojson"||!l.lineMetrics)&&e.push(new it(n,r,'layer "'.concat(r.id,'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.'))):e.push(new it(n,r.source,'source "'.concat(r.source,'" not found')))}return e=e.concat(Vs({key:n,value:r,valueSpec:a.layer,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{"*"(){return[]},type(){return t.validateSpec({key:"".concat(n,".type"),value:r.type,valueSpec:a.layer.type,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,object:r,objectKey:"type"})},filter:G5,layout(l){return Vs({layer:r,key:l.key,value:l.value,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*"(u){return WW(Dg({layerType:o},u))}}})},paint(l){return Vs({layer:r,key:l.key,value:l.value,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*"(u){return ZW(Dg({layerType:o},u))}}})}}})),e}function Np(t){let e=t.value,r=t.key,n=Pr(e);return n!=="string"?[new it(r,e,"string expected, ".concat(n," found"))]:[]}function dbe(t){var e;let r=(e=t.sourceName)!==null&&e!==void 0?e:"",n=t.value,i=t.styleSpec,a=i.source_raster_dem,o=t.style,s=[],l=Pr(n);if(n===void 0)return s;if(l!=="object")return s.push(new it("source_raster_dem",n,"object expected, ".concat(l," found"))),s;let u=Di(n.encoding)==="custom",c=["redFactor","greenFactor","blueFactor","baseShift"],h=t.value.encoding?'"'.concat(t.value.encoding,'"'):"Default";for(let d in n)!u&&c.includes(d)?s.push(new it(d,n[d],'In "'.concat(r,'": "').concat(d,'" is only valid when "encoding" is set to "custom". ').concat(h," encoding found"))):a[d]?s=s.concat(t.validateSpec({key:d,value:n[d],valueSpec:a[d],validateSpec:t.validateSpec,style:o,styleSpec:i})):s.push(new it(d,n[d],'unknown property "'.concat(d,'"')));return s}var Hz={promoteId:pbe};function XW(t){let e=t.value,r=t.key,n=t.styleSpec,i=t.style,a=t.validateSpec;if(!e.type)return[new it(r,e,'"type" is required')];let o=Di(e.type),s;switch(o){case"vector":case"raster":return s=Vs({key:r,value:e,valueSpec:n["source_".concat(o.replace("-","_"))],style:t.style,styleSpec:n,objectElementValidators:Hz,validateSpec:a}),s;case"raster-dem":return s=dbe({sourceName:r,value:e,style:t.style,styleSpec:n,validateSpec:a}),s;case"geojson":if(s=Vs({key:r,value:e,valueSpec:n.source_geojson,style:i,styleSpec:n,validateSpec:a,objectElementValidators:Hz}),e.cluster)for(let l in e.clusterProperties){let[u,c]=e.clusterProperties[l],h=typeof u=="string"?[u,["accumulated"],["get",l]]:u;s.push(...Bg({key:"".concat(r,".").concat(l,".map"),value:c,expressionContext:"cluster-map"})),s.push(...Bg({key:"".concat(r,".").concat(l,".reduce"),value:h,expressionContext:"cluster-reduce"}))}return s;case"video":return Vs({key:r,value:e,valueSpec:n.source_video,style:i,validateSpec:a,styleSpec:n});case"image":return Vs({key:r,value:e,valueSpec:n.source_image,style:i,validateSpec:a,styleSpec:n});case"canvas":return[new it(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return g1({key:"".concat(r,".type"),value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function pbe({key:t,value:e}){if(Pr(e)==="string")return Np({key:t,value:e});{let r=[];for(let n in e)r.push(...Np({key:"".concat(t,".").concat(n),value:e[n]}));return r}}function qW(t){let e=t.value,r=t.styleSpec,n=r.light,i=t.style,a=[],o=Pr(e);if(e===void 0)return a;if(o!=="object")return a=a.concat([new it("light",e,"object expected, ".concat(o," found"))]),a;for(let s in e){let l=s.match(/^(.*)-transition$/);l&&n[l[1]]&&n[l[1]].transition?a=a.concat(t.validateSpec({key:s,value:e[s],valueSpec:r.transition,validateSpec:t.validateSpec,style:i,styleSpec:r})):n[s]?a=a.concat(t.validateSpec({key:s,value:e[s],valueSpec:n[s],validateSpec:t.validateSpec,style:i,styleSpec:r})):a=a.concat([new it(s,e[s],'unknown property "'.concat(s,'"'))])}return a}function YW(t){let e=t.value,r=t.styleSpec,n=r.sky,i=t.style,a=Pr(e);if(e===void 0)return[];if(a!=="object")return[new it("sky",e,"object expected, ".concat(a," found"))];let o=[];for(let s in e)n[s]?o=o.concat(t.validateSpec({key:s,value:e[s],valueSpec:n[s],style:i,styleSpec:r})):o=o.concat([new it(s,e[s],'unknown property "'.concat(s,'"'))]);return o}function JW(t){let e=t.value,r=t.styleSpec,n=r.terrain,i=t.style,a=[],o=Pr(e);if(e===void 0)return a;if(o!=="object")return a=a.concat([new it("terrain",e,"object expected, ".concat(o," found"))]),a;for(let s in e)n[s]?a=a.concat(t.validateSpec({key:s,value:e[s],valueSpec:n[s],validateSpec:t.validateSpec,style:i,styleSpec:r})):a=a.concat([new it(s,e[s],'unknown property "'.concat(s,'"'))]);return a}function fbe(t){return Np(t).length===0?[]:Bg(t)}function mbe(t){return Np(t).length===0?[]:Bg(t)}function gbe(t){let e=t.key,r=t.value;if(Pr(r)==="array"){if(r.length<1||r.length>4)return[new it(e,r,"padding requires 1 to 4 values; ".concat(r.length," values found"))];let n={type:"number"},i=[];for(let a=0;a<r.length;a++)i=i.concat(t.validateSpec({key:"".concat(e,"[").concat(a,"]"),value:r[a],validateSpec:t.validateSpec,valueSpec:n}));return i}else return d3({key:e,value:r,valueSpec:{}})}function ybe(t){let e=t.key,r=t.value;if(Pr(r)==="array"){let n={type:"number"};if(r.length<1)return[new it(e,r,"array length at least 1 expected, length 0 found")];let i=[];for(let a=0;a<r.length;a++)i=i.concat(t.validateSpec({key:"".concat(e,"[").concat(a,"]"),value:r[a],validateSpec:t.validateSpec,valueSpec:n}));return i}else return d3({key:e,value:r,valueSpec:{}})}function vbe(t){let e=t.key,r=t.value;if(Pr(r)==="array"){if(r.length<1)return[new it(e,r,"array length at least 1 expected, length 0 found")];let n=[];for(let i=0;i<r.length;i++)n=n.concat(iM({key:"".concat(e,"[").concat(i,"]"),value:r[i]}));return n}else return iM({key:e,value:r})}function _be(t){let e=t.key,r=t.value,n=Pr(r),i=t.styleSpec;if(n!=="array"||r.length<1||r.length%2!==0)return[new it(e,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let a=[];for(let o=0;o<r.length;o+=2)a=a.concat(g1({key:"".concat(e,"[").concat(o,"]"),value:r[o],valueSpec:i.layout_symbol["text-anchor"]})),a=a.concat(V5({key:"".concat(e,"[").concat(o+1,"]"),value:r[o+1],valueSpec:{length:2,value:"number"},validateSpec:t.validateSpec,style:t.style,styleSpec:i}));return a}function KW(t){let e=[],r=t.value,n=t.key;if(Array.isArray(r)){let i=[],a=[];for(let o in r){r[o].id&&i.includes(r[o].id)&&e.push(new it(n,r,"all the sprites' ids must be unique, but ".concat(r[o].id," is duplicated"))),i.push(r[o].id),r[o].url&&a.includes(r[o].url)&&e.push(new it(n,r,"all the sprites' URLs must be unique, but ".concat(r[o].url," is duplicated"))),a.push(r[o].url);let s={id:{type:"string",required:!0},url:{type:"string",required:!0}};e=e.concat(Vs({key:"".concat(n,"[").concat(o,"]"),value:r[o],valueSpec:s,validateSpec:t.validateSpec}))}return e}else return Np({key:n,value:r})}function xbe(t){let e=t.value,r=t.styleSpec,n=r.projection,i=t.style,a=Pr(e);if(e===void 0)return[];if(a!=="object")return[new it("projection",e,"object expected, ".concat(a," found"))];let o=[];for(let s in e)n[s]?o=o.concat(t.validateSpec({key:s,value:e[s],valueSpec:n[s],style:i,styleSpec:r})):o=o.concat([new it(s,e[s],'unknown property "'.concat(s,'"'))]);return o}function bbe(t){let e=t.key,r=t.value;r=r instanceof String?r.valueOf():r;let n=Pr(r);return n==="array"&&!Abe(r)&&!wbe(r)?[new it(e,r,"projection expected, invalid array ".concat(JSON.stringify(r)," found"))]:["array","string"].includes(n)?[]:[new it(e,r,'projection expected, invalid type "'.concat(n,'" found'))]}function wbe(t){return!!["interpolate","step","literal"].includes(t[0])}function Abe(t){return Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"}function Sbe(t){return!!t&&t.constructor===Object}function QW(t){return Sbe(t.value)?[]:[new it(t.key,t.value,"object expected, ".concat(Pr(t.value)," found"))]}var Xz={"*"(){return[]},array:V5,boolean:hbe,number:d3,color:iM,constants:UW,enum:g1,filter:G5,function:jW,layer:HW,object:Vs,source:XW,light:qW,sky:YW,terrain:JW,projection:xbe,projectionDefinition:bbe,string:Np,formatted:fbe,resolvedImage:mbe,padding:gbe,numberArray:ybe,colorArray:vbe,variableAnchorOffsetCollection:_be,sprite:KW,state:QW};function M4(t){let e=t.value,r=t.valueSpec,n=t.styleSpec;return t.validateSpec=M4,r.expression&&u3(Di(e))?jW(t):r.expression&&c3(Lp(e))?Bg(t):r.type&&Xz[r.type]?Xz[r.type](t):Vs(Dg({},t,{valueSpec:r.type?n[r.type]:r}))}function eH(t){let e=t.value,r=t.key,n=Np(t);return n.length||(e.indexOf("{fontstack}")===-1&&n.push(new it(r,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&n.push(new it(r,e,'"glyphs" url must include a "{range}" token'))),n}function Qs(t,e=Oe){let r=[];return r=r.concat(M4({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,validateSpec:M4,objectElementValidators:{glyphs:eH,"*"(){return[]}}})),t.constants&&(r=r.concat(UW({key:"constants",value:t.constants}))),tH(r)}Qs.source=Ul($l(XW));Qs.sprite=Ul($l(KW));Qs.glyphs=Ul($l(eH));Qs.light=Ul($l(qW));Qs.sky=Ul($l(YW));Qs.terrain=Ul($l(JW));Qs.state=Ul($l(QW));Qs.layer=Ul($l(HW));Qs.filter=Ul($l(G5));Qs.paintProperty=Ul($l(ZW));Qs.layoutProperty=Ul($l(WW));function $l(t){return function(e){return t(lt(ae({},e),{validateSpec:M4}))}}function tH(t){return[].concat(t).sort((e,r)=>e.line-r.line)}function Ul(t){return function(...e){return tH(t.apply(this,e))}}C();var Ni=Qs;Ni.source;var Ebe=Ni.light,Ibe=Ni.sky;Ni.terrain;Ni.filter;var Cbe=Ni.paintProperty,Mbe=Ni.layoutProperty;function p3(t,e){let r=!1;if(e&&e.length)for(let n of e)t.fire(new Jt(new Error(n.message))),r=!0;return r}C();C();C();var aM=class rH{constructor(e,r,n){let i=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;let o=new Int32Array(this.arrayBuffer);e=o[0],r=o[1],n=o[2],this.d=r+2*n;for(let u=0;u<this.d*this.d;u++){let c=o[3+u],h=o[3+u+1];i.push(c===h?null:o.subarray(c,h))}let s=o[3+i.length],l=o[3+i.length+1];this.keys=o.subarray(s,l),this.bboxes=o.subarray(l),this.insert=this._insertReadonly}else{this.d=r+2*n;for(let o=0;o<this.d*this.d;o++)i.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=e,this.padding=n,this.scale=r/e,this.uid=0;let a=n/r*e;this.min=-a,this.max=e+a}insert(e,r,n,i,a){this._forEachCell(r,n,i,a,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(a)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,r,n,i,a,o){this.cells[a].push(o)}query(e,r,n,i,a){let o=this.min,s=this.max;if(e<=o&&r<=o&&s<=n&&s<=i&&!a)return Array.prototype.slice.call(this.keys);{let l=[],u={};return this._forEachCell(e,r,n,i,this._queryCell,l,u,a),l}}_queryCell(e,r,n,i,a,o,s,l){let u=this.cells[a];if(u!==null){let c=this.keys,h=this.bboxes;for(let d=0;d<u.length;d++){let p=u[d];if(s[p]===void 0){let m=p*4;(l?l(h[m+0],h[m+1],h[m+2],h[m+3]):e<=h[m+2]&&r<=h[m+3]&&n>=h[m+0]&&i>=h[m+1])?(s[p]=!0,o.push(c[p])):s[p]=!1}}}}_forEachCell(e,r,n,i,a,o,s,l){let u=this._convertToCellCoord(e),c=this._convertToCellCoord(r),h=this._convertToCellCoord(n),d=this._convertToCellCoord(i);for(let p=u;p<=h;p++)for(let m=c;m<=d;m++){let y=this.d*m+p;if(!(l&&!l(this._convertFromCellCoord(p),this._convertFromCellCoord(m),this._convertFromCellCoord(p+1),this._convertFromCellCoord(m+1)))&&a.call(this,e,r,n,i,y,o,s,l))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let e=this.cells,r=3+this.cells.length+1+1,n=0;for(let o=0;o<this.cells.length;o++)n+=this.cells[o].length;let i=new Int32Array(r+n+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;let a=r;for(let o=0;o<e.length;o++){let s=e[o];i[3+o]=a,i.set(s,a),a+=s.length}return i[3+e.length]=a,i.set(this.keys,a),a+=this.keys.length,i[3+e.length+1]=a,i.set(this.bboxes,a),a+=this.bboxes.length,i.buffer}static serialize(e,r){let n=e.toArrayBuffer();return r&&r.push(n),{buffer:n}}static deserialize(e){return new rH(e.buffer)}},Dc={};function Mt(t,e,r={}){if(Dc[t])throw new Error("".concat(t," is already registered."));Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Dc[t]={klass:e,omit:r.omit||[],shallow:r.shallow||[]}}Mt("Object",Object);Mt("Set",Set);Mt("TransferableGridIndex",aM);Mt("Color",Gt);Mt("Error",Error);Mt("AJAXError",b4);Mt("ResolvedImage",Mu);Mt("StylePropertyFunction",LW);Mt("StyleExpression",$5,{omit:["_evaluator"]});Mt("ZoomDependentExpression",I4);Mt("ZoomConstantExpression",f1);Mt("CompoundExpression",Yp,{omit:["_evaluate"]});for(let t in ig)ig[t]._classRegistryKey||Mt("Expression_".concat(t),ig[t]);function nH(t){return t&&typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||t.constructor&&t.constructor.name==="ArrayBuffer")}function Z5(t){let e=t.constructor;return t.$name||e._classRegistryKey}function Tbe(t){if(t===null||typeof t!="object")return!1;let e=Z5(t);return!!(e&&e!=="Object")}function iH(t){return!Tbe(t)&&(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob||t instanceof Error||nH(t)||Lc(t)||ArrayBuffer.isView(t)||t instanceof ImageData)}function Rv(t,e){if(iH(t)){if((nH(t)||Lc(t))&&e&&e.push(t),ArrayBuffer.isView(t)){let a=t;e&&e.push(a.buffer)}return t instanceof ImageData&&e&&e.push(t.data.buffer),t}if(Array.isArray(t)){let a=[];for(let o of t)a.push(Rv(o,e));return a}if(typeof t!="object")throw new Error("can't serialize object of type ".concat(typeof t));let r=Z5(t);if(!r)throw new Error("can't serialize object of unregistered class ".concat(t.constructor.name));if(!Dc[r])throw new Error("".concat(r," is not registered."));let{klass:n}=Dc[r],i=n.serialize?n.serialize(t,e):{};if(n.serialize){if(e&&i===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(let a in t){if(!t.hasOwnProperty(a)||Dc[r].omit.indexOf(a)>=0)continue;let o=t[a];i[a]=Dc[r].shallow.indexOf(a)>=0?o:Rv(o,e)}t instanceof Error&&(i.message=t.message)}if(i.$name)throw new Error("$name property is reserved for worker serialization logic.");return r!=="Object"&&(i.$name=r),i}function Lv(t){if(iH(t))return t;if(Array.isArray(t))return t.map(Lv);if(typeof t!="object")throw new Error("can't deserialize object of type ".concat(typeof t));let e=Z5(t)||"Object";if(!Dc[e])throw new Error("can't deserialize unregistered class ".concat(e));let{klass:r}=Dc[e];if(!r)throw new Error("can't deserialize unregistered class ".concat(e));if(r.deserialize)return r.deserialize(t);let n=Object.create(r.prototype);for(let i of Object.keys(t)){if(i==="$name")continue;let a=t[i];n[i]=Dc[e].shallow.indexOf(i)>=0?a:Lv(a)}return n}C();C();var oM=class{constructor(){this.first=!0}update(e,r){let n=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=r),e!==this.lastZoom?(this.lastZoom=e,this.lastFloorZoom=n,!0):!1)}};C();C();var ia={"Latin-1 Supplement":t=>t>=128&&t<=255,"Hangul Jamo":t=>t>=4352&&t<=4607,Khmer:t=>t>=6016&&t<=6143,"General Punctuation":t=>t>=8192&&t<=8303,"Letterlike Symbols":t=>t>=8448&&t<=8527,"Number Forms":t=>t>=8528&&t<=8591,"Miscellaneous Technical":t=>t>=8960&&t<=9215,"Control Pictures":t=>t>=9216&&t<=9279,"Optical Character Recognition":t=>t>=9280&&t<=9311,"Enclosed Alphanumerics":t=>t>=9312&&t<=9471,"Geometric Shapes":t=>t>=9632&&t<=9727,"Miscellaneous Symbols":t=>t>=9728&&t<=9983,"Miscellaneous Symbols and Arrows":t=>t>=11008&&t<=11263,"Ideographic Description Characters":t=>t>=12272&&t<=12287,"CJK Symbols and Punctuation":t=>t>=12288&&t<=12351,Hiragana:t=>t>=12352&&t<=12447,Katakana:t=>t>=12448&&t<=12543,Kanbun:t=>t>=12688&&t<=12703,"CJK Strokes":t=>t>=12736&&t<=12783,"Enclosed CJK Letters and Months":t=>t>=12800&&t<=13055,"CJK Compatibility":t=>t>=13056&&t<=13311,"Yijing Hexagram Symbols":t=>t>=19904&&t<=19967,"CJK Unified Ideographs":t=>t>=19968&&t<=40959,"Hangul Syllables":t=>t>=44032&&t<=55215,"Private Use Area":t=>t>=57344&&t<=63743,"Vertical Forms":t=>t>=65040&&t<=65055,"CJK Compatibility Forms":t=>t>=65072&&t<=65103,"Small Form Variants":t=>t>=65104&&t<=65135,"Halfwidth and Fullwidth Forms":t=>t>=65280&&t<=65519};function Pbe(t){for(let e of t)if(Bbe(e.charCodeAt(0)))return!0;return!1}function W5(t){let e=t.map(r=>{try{return new RegExp("\\p{sc=".concat(r,"}"),"u").source}catch{return null}}).filter(r=>r);return new RegExp(e.join("|"),"u")}var Dbe=["Arab","Dupl","Mong","Ougr","Syrc"];W5(Dbe);var kbe=["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"],Obe=W5(kbe);function Bbe(t){return t===746||t===747?!0:t<4352?!1:!!(ia["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||ia["CJK Compatibility"](t)||ia["CJK Strokes"](t)||ia["CJK Symbols and Punctuation"](t)&&!(t>=12296&&t<=12305)&&!(t>=12308&&t<=12319)&&t!==12336||ia["Enclosed CJK Letters and Months"](t)||ia["Ideographic Description Characters"](t)||ia.Kanbun(t)||ia.Katakana(t)&&t!==12540||ia["Halfwidth and Fullwidth Forms"](t)&&t!==65288&&t!==65289&&t!==65293&&!(t>=65306&&t<=65310)&&t!==65339&&t!==65341&&t!==65343&&!(t>=65371&&t<=65503)&&t!==65507&&!(t>=65512&&t<=65519)||ia["Small Form Variants"](t)&&!(t>=65112&&t<=65118)&&!(t>=65123&&t<=65126)||ia["Vertical Forms"](t)||ia["Yijing Hexagram Symbols"](t)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(t))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(t))||Obe.test(String.fromCodePoint(t)))}var zbe=["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"],Fbe=W5(zbe);function aH(t){return Fbe.test(String.fromCodePoint(t))}function Rbe(t,e){return!(!e&&aH(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||ia.Khmer(t))}function Lbe(t){for(let e of t)if(aH(e.charCodeAt(0)))return!0;return!1}function Nbe(t,e){for(let r of t)if(!Rbe(r.charCodeAt(0),e))return!1;return!0}C();var $be=class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(e){this.pluginStatus=e.pluginStatus,this.pluginURL=e.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(e){if(zg.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=e.applyArabicShaping,this.processBidirectionalText=e.processBidirectionalText,this.processStyledBidirectionalText=e.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}async syncState(e,r){if(this.isParsed())return this.getState();if(e.pluginStatus!=="loading")return this.setState(e),e;let n=e.pluginURL,i=new Promise(o=>{this.loadScriptResolve=o});r(n);let a=new Promise(o=>setTimeout(()=>o(),this.TIMEOUT));if(await Promise.race([i,a]),this.isParsed()){let o={pluginStatus:"loaded",pluginURL:n};return this.setState(o),o}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error("RTL Text Plugin failed to import scripts from ".concat(n))}},zg=new $be,Fi=class{constructor(e,r){this.zoom=e,r?(this.now=r.now||0,this.fadeDuration=r.fadeDuration||0,this.zoomHistory=r.zoomHistory||new oM,this.transition=r.transition||{},this.globalState=r.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new oM,this.transition={},this.globalState={})}isSupportedScript(e){return Nbe(e,zg.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let e=this.zoom,r=e-Math.floor(e),n=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*r}}},f3=class{constructor(e,r){this.property=e,this.value=r,this.expression=ibe(r===void 0?e.specification.default:r,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(e,r,n){return this.property.possiblyEvaluate(this,e,r,n)}},sM=class{constructor(e){this.property=e,this.value=new f3(e,void 0)}transitioned(e,r){return new qz(this.property,this.value,r,zt({},e.transition,this.transition),e.now)}untransitioned(){return new qz(this.property,this.value,null,{},0)}},m3=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return $o(this._values[e].value.value)}setValue(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new sM(this._values[e].property)),this._values[e].value=new f3(this._values[e].property,r===null?void 0:$o(r))}getTransition(e){return $o(this._values[e].transition)}setTransition(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new sM(this._values[e].property)),this._values[e].transition=$o(r)||void 0}serialize(){let e={};for(let r of Object.keys(this._values)){let n=this.getValue(r);n!==void 0&&(e[r]=n);let i=this.getTransition(r);i!==void 0&&(e["".concat(r,"-transition")]=i)}return e}transitioned(e,r){let n=new Yz(this._properties);for(let i of Object.keys(this._values))n._values[i]=this._values[i].transitioned(e,r._values[i]);return n}untransitioned(){let e=new Yz(this._properties);for(let r of Object.keys(this._values))e._values[r]=this._values[r].untransitioned();return e}},qz=class{constructor(t,e,r,n,i){this.property=t,this.value=e,this.begin=i+n.delay||0,this.end=this.begin+n.duration||0,t.specification.transition&&(n.delay||n.duration)&&(this.prior=r)}possiblyEvaluate(t,e,r){let n=t.now||0,i=this.value.possiblyEvaluate(t,e,r),a=this.prior;if(a){if(n>this.end)return this.prior=null,i;if(this.value.isDataDriven())return this.prior=null,i;if(n<this.begin)return a.possiblyEvaluate(t,e,r);{let o=(n-this.begin)/(this.end-this.begin);return this.property.interpolate(a.possiblyEvaluate(t,e,r),i,kZ(o))}}else return i}},Yz=class{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,e,r){let n=new g3(this._properties);for(let i of Object.keys(this._values))n._values[i]=this._values[i].possiblyEvaluate(t,e,r);return n}hasTransition(){for(let t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}},Ube=class{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return $o(this._values[t].value)}setValue(t,e){this._values[t]=new f3(this._values[t].property,e===null?void 0:$o(e))}serialize(){let t={};for(let e of Object.keys(this._values)){let r=this.getValue(e);r!==void 0&&(t[e]=r)}return t}possiblyEvaluate(t,e,r){let n=new g3(this._properties);for(let i of Object.keys(this._values))n._values[i]=this._values[i].possiblyEvaluate(t,e,r);return n}},Pl=class{constructor(e,r,n){this.property=e,this.value=r,this.parameters=n}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,r,n,i){return this.property.evaluate(this.value,this.parameters,e,r,n,i)}},g3=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}},It=class{constructor(e){this.specification=e}possiblyEvaluate(e,r){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(r)}interpolate(e,r,n){let i=this.specification.type,a=di[i];return a?a(e,r,n):e}},Xt=class{constructor(e,r){this.specification=e,this.overrides=r}possiblyEvaluate(e,r,n,i){return e.expression.kind==="constant"||e.expression.kind==="camera"?new Pl(this,{kind:"constant",value:e.expression.evaluate(r,null,{},n,i)},r):new Pl(this,e.expression,r)}interpolate(e,r,n){if(e.value.kind!=="constant"||r.value.kind!=="constant")return e;if(e.value.value===void 0||r.value.value===void 0)return new Pl(this,{kind:"constant",value:void 0},e.parameters);let i=this.specification.type,a=di[i];if(a){let o=a(e.value.value,r.value.value,n);return new Pl(this,{kind:"constant",value:o},e.parameters)}else return e}evaluate(e,r,n,i,a,o){return e.kind==="constant"?e.value:e.evaluate(r,n,i,a,o)}},y3=class extends Xt{possiblyEvaluate(t,e,r,n){if(t.value===void 0)return new Pl(this,{kind:"constant",value:void 0},e);if(t.expression.kind==="constant"){let i=t.expression.evaluate(e,null,{},r,n),a=t.property.specification.type==="resolvedImage"&&typeof i!="string"?i.name:i,o=this._calculate(a,a,a,e);return new Pl(this,{kind:"constant",value:o},e)}else if(t.expression.kind==="camera"){let i=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new Pl(this,{kind:"constant",value:i},e)}else return new Pl(this,t.expression,e)}evaluate(t,e,r,n,i,a){if(t.kind==="source"){let o=t.evaluate(e,r,n,i,a);return this._calculate(o,o,o,e)}else return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},r,n),t.evaluate({zoom:Math.floor(e.zoom)},r,n),t.evaluate({zoom:Math.floor(e.zoom)+1},r,n),e):t.value}_calculate(t,e,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:r,to:e}}interpolate(t){return t}},H5=class{constructor(e){this.specification=e}possiblyEvaluate(e,r,n,i){if(e.value!==void 0)if(e.expression.kind==="constant"){let a=e.expression.evaluate(r,null,{},n,i);return this._calculate(a,a,a,r)}else return this._calculate(e.expression.evaluate(new Fi(Math.floor(r.zoom-1),r)),e.expression.evaluate(new Fi(Math.floor(r.zoom),r)),e.expression.evaluate(new Fi(Math.floor(r.zoom+1),r)),r)}_calculate(e,r,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:n,to:r}}interpolate(e){return e}},v3=class{constructor(e){this.specification=e}possiblyEvaluate(e,r,n,i){return!!e.expression.evaluate(r,null,{},n,i)}interpolate(){return!1}},Oa=class{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(let r in e){let n=e[r];n.specification.overridable&&this.overridableProperties.push(r);let i=this.defaultPropertyValues[r]=new f3(n,void 0),a=this.defaultTransitionablePropertyValues[r]=new sM(n);this.defaultTransitioningPropertyValues[r]=a.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=i.possiblyEvaluate({})}}};Mt("DataDrivenProperty",Xt);Mt("DataConstantProperty",It);Mt("CrossFadedDataDrivenProperty",y3);Mt("CrossFadedProperty",H5);Mt("ColorRampProperty",v3);var Rx="-transition",jl=class extends Xo{constructor(e,r){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},e.type!=="custom"&&(e=e,this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter,this._featureFilter=m1(e.filter)),r.layout&&(this._unevaluatedLayout=new Ube(r.layout)),r.paint)){this._transitionablePaint=new m3(r.paint);for(let n in e.paint)this.setPaintProperty(n,e.paint[n],{validate:!1});for(let n in e.layout)this.setLayoutProperty(n,e.layout[n],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new g3(r.paint)}}setFilter(e){this.filter=e,this._featureFilter=m1(e)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}getLayoutAffectingGlobalStateRefs(){let e=new Set;if(this._unevaluatedLayout)for(let r in this._unevaluatedLayout._values){let n=this._unevaluatedLayout._values[r];for(let i of n.getGlobalStateRefs())e.add(i)}for(let r of this._featureFilter.getGlobalStateRefs())e.add(r);return e}setLayoutProperty(e,r,n={}){if(r!=null){let i="layers.".concat(this.id,".layout.").concat(e);if(this._validate(Mbe,i,e,r,n))return}if(e==="visibility"){this.visibility=r;return}this._unevaluatedLayout.setValue(e,r)}getPaintProperty(e){return e.endsWith(Rx)?this._transitionablePaint.getTransition(e.slice(0,-Rx.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,r,n={}){if(r!=null){let i="layers.".concat(this.id,".paint.").concat(e);if(this._validate(Cbe,i,e,r,n))return!1}if(e.endsWith(Rx))return this._transitionablePaint.setTransition(e.slice(0,-Rx.length),r||void 0),!1;{let i=this._transitionablePaint._values[e],a=i.property.specification["property-type"]==="cross-faded-data-driven",o=i.value.isDataDriven(),s=i.value;this._transitionablePaint.setValue(e,r),this._handleSpecialPaintPropertyUpdate(e);let l=this._transitionablePaint._values[e].value;return l.isDataDriven()||o||a||this._handleOverridablePaintPropertyUpdate(e,s,l)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,r,n){return!1}isHidden(e){return this.minzoom&&e<this.minzoom||this.maxzoom&&e>=this.maxzoom?!0:this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,r){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,r)}serialize(){let e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),BZ(e,(r,n)=>r!==void 0&&!(n==="layout"&&!Object.keys(r).length)&&!(n==="paint"&&!Object.keys(r).length))}_validate(e,r,n,i,a={}){return a&&a.validate===!1?!1:p3(this,e.call(Ni,{key:r,layerType:this.type,objectKey:n,value:i,styleSpec:Oe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let e in this.paint._values){let r=this.paint.get(e);if(!(!(r instanceof Pl)||!Og(r.property.specification))&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}};C();C();C();var jbe={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},l_=class{constructor(e,r){this._structArray=e,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}},Vbe=128,Gbe=5,Ai=class{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,r){return e._trim(),r&&(e.isTransferred=!0,r.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){let r=Object.create(this.prototype);return r.arrayBuffer=e.arrayBuffer,r.length=e.length,r.capacity=e.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(this.capacity*Gbe),Vbe),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}};function Si(t,e=1){let r=0,n=0,i=t.map(o=>{let s=Zbe(o.type),l=r=Jz(r,Math.max(e,s)),u=o.components||1;return n=Math.max(n,s),r+=s*u,{name:o.name,type:o.type,components:u,offset:l}}),a=Jz(r,Math.max(n,e));return{members:i,size:a,alignment:e}}function Zbe(t){return jbe[t].BYTES_PER_ELEMENT}function Jz(t,e){return Math.ceil(t/e)*e}var Wbe=Zt(xr(),1),u_=class extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r){let n=this.length;return this.resize(n+1),this.emplace(n,e,r)}emplace(e,r,n){let i=e*2;return this.int16[i+0]=r,this.int16[i+1]=n,e}};u_.prototype.bytesPerElement=4;Mt("StructArrayLayout2i4",u_);var _3=class extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,e,r,n)}emplace(e,r,n,i){let a=e*3;return this.int16[a+0]=r,this.int16[a+1]=n,this.int16[a+2]=i,e}};_3.prototype.bytesPerElement=6;Mt("StructArrayLayout3i6",_3);var X5=class extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i){let a=this.length;return this.resize(a+1),this.emplace(a,e,r,n,i)}emplace(e,r,n,i,a){let o=e*4;return this.int16[o+0]=r,this.int16[o+1]=n,this.int16[o+2]=i,this.int16[o+3]=a,e}};X5.prototype.bytesPerElement=8;Mt("StructArrayLayout4i8",X5);var q5=class extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,a,o){let s=this.length;return this.resize(s+1),this.emplace(s,e,r,n,i,a,o)}emplace(e,r,n,i,a,o,s){let l=e*6;return this.int16[l+0]=r,this.int16[l+1]=n,this.int16[l+2]=i,this.int16[l+3]=a,this.int16[l+4]=o,this.int16[l+5]=s,e}};q5.prototype.bytesPerElement=12;Mt("StructArrayLayout2i4i12",q5);var Y5=class extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,a,o){let s=this.length;return this.resize(s+1),this.emplace(s,e,r,n,i,a,o)}emplace(e,r,n,i,a,o,s){let l=e*4,u=e*8;return this.int16[l+0]=r,this.int16[l+1]=n,this.uint8[u+4]=i,this.uint8[u+5]=a,this.uint8[u+6]=o,this.uint8[u+7]=s,e}};Y5.prototype.bytesPerElement=8;Mt("StructArrayLayout2i4ub8",Y5);var y1=class extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r){let n=this.length;return this.resize(n+1),this.emplace(n,e,r)}emplace(e,r,n){let i=e*2;return this.float32[i+0]=r,this.float32[i+1]=n,e}};y1.prototype.bytesPerElement=8;Mt("StructArrayLayout2f8",y1);var J5=class extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,a,o,s,l,u,c){let h=this.length;return this.resize(h+1),this.emplace(h,e,r,n,i,a,o,s,l,u,c)}emplace(e,r,n,i,a,o,s,l,u,c,h){let d=e*10;return this.uint16[d+0]=r,this.uint16[d+1]=n,this.uint16[d+2]=i,this.uint16[d+3]=a,this.uint16[d+4]=o,this.uint16[d+5]=s,this.uint16[d+6]=l,this.uint16[d+7]=u,this.uint16[d+8]=c,this.uint16[d+9]=h,e}};J5.prototype.bytesPerElement=20;Mt("StructArrayLayout10ui20",J5);var K5=class extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,a,o,s,l,u,c,h,d){let p=this.length;return this.resize(p+1),this.emplace(p,e,r,n,i,a,o,s,l,u,c,h,d)}emplace(e,r,n,i,a,o,s,l,u,c,h,d,p){let m=e*12;return this.int16[m+0]=r,this.int16[m+1]=n,this.int16[m+2]=i,this.int16[m+3]=a,this.uint16[m+4]=o,this.uint16[m+5]=s,this.uint16[m+6]=l,this.uint16[m+7]=u,this.int16[m+8]=c,this.int16[m+9]=h,this.int16[m+10]=d,this.int16[m+11]=p,e}};K5.prototype.bytesPerElement=24;Mt("StructArrayLayout4i4ui4i24",K5);var Q5=class extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,e,r,n)}emplace(e,r,n,i){let a=e*3;return this.float32[a+0]=r,this.float32[a+1]=n,this.float32[a+2]=i,e}};Q5.prototype.bytesPerElement=12;Mt("StructArrayLayout3f12",Q5);var ek=class extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){let n=e*1;return this.uint32[n+0]=r,e}};ek.prototype.bytesPerElement=4;Mt("StructArrayLayout1ul4",ek);var tk=class extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,a,o,s,l,u){let c=this.length;return this.resize(c+1),this.emplace(c,e,r,n,i,a,o,s,l,u)}emplace(e,r,n,i,a,o,s,l,u,c){let h=e*10,d=e*5;return this.int16[h+0]=r,this.int16[h+1]=n,this.int16[h+2]=i,this.int16[h+3]=a,this.int16[h+4]=o,this.int16[h+5]=s,this.uint32[d+3]=l,this.uint16[h+8]=u,this.uint16[h+9]=c,e}};tk.prototype.bytesPerElement=20;Mt("StructArrayLayout6i1ul2ui20",tk);var rk=class extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,a,o){let s=this.length;return this.resize(s+1),this.emplace(s,e,r,n,i,a,o)}emplace(e,r,n,i,a,o,s){let l=e*6;return this.int16[l+0]=r,this.int16[l+1]=n,this.int16[l+2]=i,this.int16[l+3]=a,this.int16[l+4]=o,this.int16[l+5]=s,e}};rk.prototype.bytesPerElement=12;Mt("StructArrayLayout2i2i2i12",rk);var nk=class extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,r,n,i){let a=this.length;return this.resize(a+1),this.emplace(a,t,e,r,n,i)}emplace(t,e,r,n,i,a){let o=t*4,s=t*8;return this.float32[o+0]=e,this.float32[o+1]=r,this.float32[o+2]=n,this.int16[s+6]=i,this.int16[s+7]=a,t}};nk.prototype.bytesPerElement=16;Mt("StructArrayLayout2f1f2i16",nk);var ik=class extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,a,o){let s=this.length;return this.resize(s+1),this.emplace(s,e,r,n,i,a,o)}emplace(e,r,n,i,a,o,s){let l=e*16,u=e*4,c=e*8;return this.uint8[l+0]=r,this.uint8[l+1]=n,this.float32[u+1]=i,this.float32[u+2]=a,this.int16[c+6]=o,this.int16[c+7]=s,e}};ik.prototype.bytesPerElement=16;Mt("StructArrayLayout2ub2f2i16",ik);var x3=class extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,e,r,n)}emplace(e,r,n,i){let a=e*3;return this.uint16[a+0]=r,this.uint16[a+1]=n,this.uint16[a+2]=i,e}};x3.prototype.bytesPerElement=6;Mt("StructArrayLayout3ui6",x3);var ak=class extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,i,a,o,s,l,u,c,h,d,p,m,y,v,_){let w=this.length;return this.resize(w+1),this.emplace(w,e,r,n,i,a,o,s,l,u,c,h,d,p,m,y,v,_)}emplace(e,r,n,i,a,o,s,l,u,c,h,d,p,m,y,v,_,w){let b=e*24,A=e*12,E=e*48;return this.int16[b+0]=r,this.int16[b+1]=n,this.uint16[b+2]=i,this.uint16[b+3]=a,this.uint32[A+2]=o,this.uint32[A+3]=s,this.uint32[A+4]=l,this.uint16[b+10]=u,this.uint16[b+11]=c,this.uint16[b+12]=h,this.float32[A+7]=d,this.float32[A+8]=p,this.uint8[E+36]=m,this.uint8[E+37]=y,this.uint8[E+38]=v,this.uint32[A+10]=_,this.int16[b+22]=w,e}};ak.prototype.bytesPerElement=48;Mt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ak);var ok=class extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,i,a,o,s,l,u,c,h,d,p,m,y,v,_,w,b,A,E,M,P,k,D,O,B,L){let R=this.length;return this.resize(R+1),this.emplace(R,e,r,n,i,a,o,s,l,u,c,h,d,p,m,y,v,_,w,b,A,E,M,P,k,D,O,B,L)}emplace(e,r,n,i,a,o,s,l,u,c,h,d,p,m,y,v,_,w,b,A,E,M,P,k,D,O,B,L,R){let T=e*32,N=e*16;return this.int16[T+0]=r,this.int16[T+1]=n,this.int16[T+2]=i,this.int16[T+3]=a,this.int16[T+4]=o,this.int16[T+5]=s,this.int16[T+6]=l,this.int16[T+7]=u,this.uint16[T+8]=c,this.uint16[T+9]=h,this.uint16[T+10]=d,this.uint16[T+11]=p,this.uint16[T+12]=m,this.uint16[T+13]=y,this.uint16[T+14]=v,this.uint16[T+15]=_,this.uint16[T+16]=w,this.uint16[T+17]=b,this.uint16[T+18]=A,this.uint16[T+19]=E,this.uint16[T+20]=M,this.uint16[T+21]=P,this.uint16[T+22]=k,this.uint32[N+12]=D,this.float32[N+13]=O,this.float32[N+14]=B,this.uint16[T+30]=L,this.uint16[T+31]=R,e}};ok.prototype.bytesPerElement=64;Mt("StructArrayLayout8i15ui1ul2f2ui64",ok);var b3=class extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){let n=e*1;return this.float32[n+0]=r,e}};b3.prototype.bytesPerElement=4;Mt("StructArrayLayout1f4",b3);var sk=class extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,e,r,n)}emplace(e,r,n,i){let a=e*6,o=e*3;return this.uint16[a+0]=r,this.float32[o+1]=n,this.float32[o+2]=i,e}};sk.prototype.bytesPerElement=12;Mt("StructArrayLayout1ui2f12",sk);var lk=class extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,e,r,n)}emplace(e,r,n,i){let a=e*2,o=e*4;return this.uint32[a+0]=r,this.uint16[o+2]=n,this.uint16[o+3]=i,e}};lk.prototype.bytesPerElement=8;Mt("StructArrayLayout1ul2ui8",lk);var uk=class extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r){let n=this.length;return this.resize(n+1),this.emplace(n,e,r)}emplace(e,r,n){let i=e*2;return this.uint16[i+0]=r,this.uint16[i+1]=n,e}};uk.prototype.bytesPerElement=4;Mt("StructArrayLayout2ui4",uk);var ck=class extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){let n=e*1;return this.uint16[n+0]=r,e}};ck.prototype.bytesPerElement=2;Mt("StructArrayLayout1ui2",ck);var hk=class extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,i){let a=this.length;return this.resize(a+1),this.emplace(a,e,r,n,i)}emplace(e,r,n,i,a){let o=e*4;return this.float32[o+0]=r,this.float32[o+1]=n,this.float32[o+2]=i,this.float32[o+3]=a,e}};hk.prototype.bytesPerElement=16;Mt("StructArrayLayout4f16",hk);var oH=class extends l_{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Wbe.default(this.anchorPointX,this.anchorPointY)}};oH.prototype.size=20;var sH=class extends tk{get(e){return new oH(this,e)}};Mt("CollisionBoxArray",sH);var lH=class extends l_{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}};lH.prototype.size=48;var uH=class extends ak{get(e){return new lH(this,e)}};Mt("PlacedSymbolArray",uH);var cH=class extends l_{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}};cH.prototype.size=64;var hH=class extends ok{get(e){return new cH(this,e)}};Mt("SymbolInstanceArray",hH);var dH=class extends b3{getoffsetX(e){return this.float32[e*1+0]}};Mt("GlyphOffsetArray",dH);var pH=class extends _3{getx(e){return this.int16[e*3+0]}gety(e){return this.int16[e*3+1]}gettileUnitDistanceFromAnchor(e){return this.int16[e*3+2]}};Mt("SymbolLineVertexArray",pH);var fH=class extends l_{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}};fH.prototype.size=12;var mH=class extends sk{get(e){return new fH(this,e)}};Mt("TextAnchorOffsetArray",mH);var gH=class extends l_{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}};gH.prototype.size=8;var yH=class extends lk{get(e){return new gH(this,e)}};Mt("FeatureIndexArray",yH);var kc=class extends u_{},Hbe=class extends _3{},Xbe=class extends X5{},qbe=class extends u_{},Ybe=class extends u_{},Jbe=class extends q5{},Kbe=class extends Y5{},Qbe=class extends y1{},Ef=class extends J5{},e2e=class extends K5{},t2e=class extends Q5{},r2e=class extends ek{},Kz=class extends rk{},n2e=class extends nk{},i2e=class extends ik{},a2e=class extends x3{},Vl=class extends x3{},lM=class extends uk{},o2e=class extends ck{};C();var s2e=Si([{name:"a_pos",components:2,type:"Int16"}],4),{members:l2e}=s2e;C();var Hn=class Gf{constructor(e=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=e}prepareSegment(e,r,n,i){let a=this.segments[this.segments.length-1];return e>Gf.MAX_VERTEX_ARRAY_LENGTH&&Ui("Max vertices per segment is ".concat(Gf.MAX_VERTEX_ARRAY_LENGTH,": bucket requested ").concat(e,". Consider using the `fillLargeMeshArrays` function if you require meshes with more than ").concat(Gf.MAX_VERTEX_ARRAY_LENGTH," vertices.")),this._forceNewSegmentOnNextPrepare||!a||a.vertexLength+e>Gf.MAX_VERTEX_ARRAY_LENGTH||a.sortKey!==i?this.createNewSegment(r,n,i):a}createNewSegment(e,r,n){let i={vertexOffset:e.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0,vaos:{}};return n!==void 0&&(i.sortKey=n),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(i),i}getOrCreateLatestSegment(e,r,n){return this.prepareSegment(0,e,r,n)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(let e of this.segments)for(let r in e.vaos)e.vaos[r].destroy()}static simpleSegment(e,r,n,i){return new Gf([{vertexOffset:e,primitiveOffset:r,vertexLength:n,primitiveLength:i,vaos:{},sortKey:0}])}};Hn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1;Mt("SegmentVector",Hn);C();C();function Qz(t,e){return t=on(Math.floor(t),0,255),e=on(Math.floor(e),0,255),256*t+e}C();var T4=Si([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);C();var u2e=Zt(fG(),1),vH=class _H{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,r,n,i){this.ids.push(eF(e)),this.positions.push(r,n,i)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");let r=eF(e),n=0,i=this.ids.length-1;for(;n<i;){let o=n+i>>1;this.ids[o]>=r?i=o:n=o+1}let a=[];for(;this.ids[n]===r;){let o=this.positions[3*n],s=this.positions[3*n+1],l=this.positions[3*n+2];a.push({index:o,start:s,end:l}),n++}return a}static serialize(e,r){let n=new Float64Array(e.ids),i=new Uint32Array(e.positions);return uM(n,i,0,n.length-1),r&&r.push(n.buffer,i.buffer),{ids:n,positions:i}}static deserialize(e){let r=new _H;return r.ids=e.ids,r.positions=e.positions,r.indexed=!0,r}};function eF(t){let e=+t;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:(0,u2e.default)(String(t))}function uM(t,e,r,n){for(;r<n;){let i=t[r+n>>1],a=r-1,o=n+1;for(;;){do a++;while(t[a]<i);do o--;while(t[o]>i);if(a>=o)break;Lx(t,a,o),Lx(e,3*a,3*o),Lx(e,3*a+1,3*o+1),Lx(e,3*a+2,3*o+2)}o-r<n-o?(uM(t,e,r,o),r=o+1):(uM(t,e,o+1,n),n=o)}}function Lx(t,e,r){let n=t[e];t[e]=t[r],t[r]=n}Mt("FeaturePositionMap",vH);C();var qc=class{constructor(t,e){this.gl=t.gl,this.location=e}},lr=class extends qc{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))}},dt=class extends qc{constructor(e,r){super(e,r),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}},tr=class extends qc{constructor(t,e){super(t,e),this.current=[0,0]}set(t){(t[0]!==this.current[0]||t[1]!==this.current[1])&&(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))}},fs=class extends qc{constructor(t,e){super(t,e),this.current=[0,0,0]}set(t){(t[0]!==this.current[0]||t[1]!==this.current[1]||t[2]!==this.current[2])&&(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))}},hd=class extends qc{constructor(t,e){super(t,e),this.current=[0,0,0,0]}set(t){(t[0]!==this.current[0]||t[1]!==this.current[1]||t[2]!==this.current[2]||t[3]!==this.current[3])&&(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}},dd=class extends qc{constructor(e,r){super(e,r),this.current=Gt.transparent}set(e){(e.r!==this.current.r||e.g!==this.current.g||e.b!==this.current.b||e.a!==this.current.a)&&(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}},tF=class extends qc{constructor(e,r){super(e,r),this.current=new Array}set(e){if(e!=this.current){this.current=e;let r=new Float32Array(e.length*4);for(let n=0;n<e.length;n++)r[4*n]=e[n].r,r[4*n+1]=e[n].g,r[4*n+2]=e[n].b,r[4*n+3]=e[n].a;this.gl.uniform4fv(this.location,r)}}},rF=class extends qc{constructor(t,e){super(t,e),this.current=new Array}set(t){if(t!=this.current){this.current=t;let e=new Float32Array(t);this.gl.uniform1fv(this.location,e)}}},c2e=new Float32Array(16),bs=class extends qc{constructor(e,r){super(e,r),this.current=c2e}set(e){if(e[12]!==this.current[12]||e[0]!==this.current[0]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);return}for(let r=1;r<16;r++)if(e[r]!==this.current[r]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);break}}};function cM(t){return[Qz(255*t.r,255*t.g),Qz(255*t.b,255*t.a)]}var Ny=class{constructor(e,r,n){this.value=e,this.uniformNames=r.map(i=>"u_".concat(i)),this.type=n}setUniform(e,r,n){e.set(n.constantOr(this.value))}getBinding(e,r,n){return this.type==="color"?new dd(e,r):new dt(e,r)}},Zf=class{constructor(e,r){this.uniformNames=r.map(n=>"u_".concat(n)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=e.tlbr}setUniform(e,r,n,i){let a=i==="u_pattern_to"?this.patternTo:i==="u_pattern_from"?this.patternFrom:i==="u_pixel_ratio_to"?this.pixelRatioTo:i==="u_pixel_ratio_from"?this.pixelRatioFrom:null;a&&e.set(a)}getBinding(e,r,n){return n.substr(0,9)==="u_pattern"?new hd(e,r):new dt(e,r)}},cc=class{constructor(e,r,n,i){this.expression=e,this.type=n,this.maxValue=0,this.paintVertexAttributes=r.map(a=>({name:"a_".concat(a),type:"Float32",components:n==="color"?2:1,offset:0})),this.paintVertexArray=new i}populatePaintArray(e,r,n,i,a){let o=this.paintVertexArray.length,s=this.expression.evaluate(new Fi(0),r,{},i,[],a);this.paintVertexArray.resize(e),this._setPaintValue(o,e,s)}updatePaintArray(e,r,n,i){let a=this.expression.evaluate({zoom:0},n,i);this._setPaintValue(e,r,a)}_setPaintValue(e,r,n){if(this.type==="color"){let i=cM(n);for(let a=e;a<r;a++)this.paintVertexArray.emplace(a,i[0],i[1])}else{for(let i=e;i<r;i++)this.paintVertexArray.emplace(i,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}},ll=class{constructor(t,e,r,n,i,a){this.expression=t,this.uniformNames=e.map(o=>"u_".concat(o,"_t")),this.type=r,this.useIntegerZoom=n,this.zoom=i,this.maxValue=0,this.paintVertexAttributes=e.map(o=>({name:"a_".concat(o),type:"Float32",components:r==="color"?4:2,offset:0})),this.paintVertexArray=new a}populatePaintArray(t,e,r,n,i){let a=this.expression.evaluate(new Fi(this.zoom),e,{},n,[],i),o=this.expression.evaluate(new Fi(this.zoom+1),e,{},n,[],i),s=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(s,t,a,o)}updatePaintArray(t,e,r,n){let i=this.expression.evaluate({zoom:this.zoom},r,n),a=this.expression.evaluate({zoom:this.zoom+1},r,n);this._setPaintValue(t,e,i,a)}_setPaintValue(t,e,r,n){if(this.type==="color"){let i=cM(r),a=cM(n);for(let o=t;o<e;o++)this.paintVertexArray.emplace(o,i[0],i[1],a[0],a[1])}else{for(let i=t;i<e;i++)this.paintVertexArray.emplace(i,r,n);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(n))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,e){let r=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,n=on(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);t.set(n)}getBinding(t,e,r){return new dt(t,e)}},bh=class{constructor(e,r,n,i,a,o){this.expression=e,this.type=r,this.useIntegerZoom=n,this.zoom=i,this.layerId=o,this.zoomInPaintVertexArray=new a,this.zoomOutPaintVertexArray=new a}populatePaintArray(e,r,n){let i=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(i,e,r.patterns&&r.patterns[this.layerId],n)}updatePaintArray(e,r,n,i,a){this._setPaintValues(e,r,n.patterns&&n.patterns[this.layerId],a)}_setPaintValues(e,r,n,i){if(!i||!n)return;let{min:a,mid:o,max:s}=n,l=i[a],u=i[o],c=i[s];if(!(!l||!u||!c))for(let h=e;h<r;h++)this.zoomInPaintVertexArray.emplace(h,u.tl[0],u.tl[1],u.br[0],u.br[1],l.tl[0],l.tl[1],l.br[0],l.br[1],u.pixelRatio,l.pixelRatio),this.zoomOutPaintVertexArray.emplace(h,u.tl[0],u.tl[1],u.br[0],u.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1],u.pixelRatio,c.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,T4.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,T4.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}},xH=class{constructor(e,r,n){this.binders={},this._buffers=[];let i=[];for(let a in e.paint._values){if(!n(a))continue;let o=e.paint.get(a);if(!(o instanceof Pl)||!Og(o.property.specification))continue;let s=h2e(a,e.type),l=o.value,u=o.property.specification.type,c=o.property.useIntegerZoom,h=o.property.specification["property-type"],d=h==="cross-faded"||h==="cross-faded-data-driven";if(l.kind==="constant")this.binders[a]=d?new Zf(l.value,s):new Ny(l.value,s,u),i.push("/u_".concat(a));else if(l.kind==="source"||d){let p=nF(a,u,"source");this.binders[a]=d?new bh(l,u,c,r,p,e.id):new cc(l,s,u,p),i.push("/a_".concat(a))}else{let p=nF(a,u,"composite");this.binders[a]=new ll(l,s,u,c,r,p),i.push("/z_".concat(a))}}this.cacheKey=i.sort().join("")}getMaxValue(e){let r=this.binders[e];return r instanceof cc||r instanceof ll?r.maxValue:0}populatePaintArrays(e,r,n,i,a){for(let o in this.binders){let s=this.binders[o];(s instanceof cc||s instanceof ll||s instanceof bh)&&s.populatePaintArray(e,r,n,i,a)}}setConstantPatternPositions(e,r){for(let n in this.binders){let i=this.binders[n];i instanceof Zf&&i.setConstantPatternPositions(e,r)}}updatePaintArrays(e,r,n,i,a){let o=!1;for(let s in e){let l=r.getPositions(s);for(let u of l){let c=n.feature(u.index);for(let h in this.binders){let d=this.binders[h];if((d instanceof cc||d instanceof ll||d instanceof bh)&&d.expression.isStateDependent===!0){let p=i.paint.get(h);d.expression=p.value,d.updatePaintArray(u.start,u.end,c,e[s],a),o=!0}}}}return o}defines(){let e=[];for(let r in this.binders){let n=this.binders[r];(n instanceof Ny||n instanceof Zf)&&e.push(...n.uniformNames.map(i=>"#define HAS_UNIFORM_".concat(i)))}return e}getBinderAttributes(){let e=[];for(let r in this.binders){let n=this.binders[r];if(n instanceof cc||n instanceof ll)for(let i=0;i<n.paintVertexAttributes.length;i++)e.push(n.paintVertexAttributes[i].name);else if(n instanceof bh)for(let i=0;i<T4.members.length;i++)e.push(T4.members[i].name)}return e}getBinderUniforms(){let e=[];for(let r in this.binders){let n=this.binders[r];if(n instanceof Ny||n instanceof Zf||n instanceof ll)for(let i of n.uniformNames)e.push(i)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,r){let n=[];for(let i in this.binders){let a=this.binders[i];if(a instanceof Ny||a instanceof Zf||a instanceof ll){for(let o of a.uniformNames)if(r[o]){let s=a.getBinding(e,r[o],o);n.push({name:o,property:i,binding:s})}}}return n}setUniforms(e,r,n,i){for(let{name:a,property:o,binding:s}of r)this.binders[o].setUniform(s,i,n.get(o),a)}updatePaintBuffers(e){this._buffers=[];for(let r in this.binders){let n=this.binders[r];if(e&&n instanceof bh){let i=e.fromScale===2?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;i&&this._buffers.push(i)}else(n instanceof cc||n instanceof ll)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(e){for(let r in this.binders){let n=this.binders[r];(n instanceof cc||n instanceof ll||n instanceof bh)&&n.upload(e)}this.updatePaintBuffers()}destroy(){for(let e in this.binders){let r=this.binders[e];(r instanceof cc||r instanceof ll||r instanceof bh)&&r.destroy()}}},$p=class{constructor(e,r,n=()=>!0){this.programConfigurations={};for(let i of e)this.programConfigurations[i.id]=new xH(i,r,n);this.needsUpload=!1,this._featureMap=new vH,this._bufferOffset=0}populatePaintArrays(e,r,n,i,a,o){for(let s in this.programConfigurations)this.programConfigurations[s].populatePaintArrays(e,r,i,a,o);r.id!==void 0&&this._featureMap.add(r.id,n,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,r,n,i){for(let a of n)this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(e,this._featureMap,r,a,i)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(let r in this.programConfigurations)this.programConfigurations[r].upload(e);this.needsUpload=!1}}destroy(){for(let e in this.programConfigurations)this.programConfigurations[e].destroy()}};function h2e(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace("".concat(e,"-"),"").replace(/-/g,"_")]}function d2e(t){return{"line-pattern":{source:Ef,composite:Ef},"fill-pattern":{source:Ef,composite:Ef},"fill-extrusion-pattern":{source:Ef,composite:Ef}}[t]}function nF(t,e,r){let n={color:{source:y1,composite:hk},number:{source:b3,composite:y1}},i=d2e(t);return i&&i[r]||n[e][r]}Mt("ConstantBinder",Ny);Mt("CrossFadedConstantBinder",Zf);Mt("SourceExpressionBinder",cc);Mt("CrossFadedCompositeBinder",bh);Mt("CompositeExpressionBinder",ll);Mt("ProgramConfiguration",xH,{omit:["_buffers"]});Mt("ProgramConfigurationSet",$p);C();C();var p2e=15,hM=Math.pow(2,p2e-1)-1,iF=-hM-1;function Jp(t){let e=8192/t.extent,r=t.loadGeometry();for(let n=0;n<r.length;n++){let i=r[n];for(let a=0;a<i.length;a++){let o=i[a],s=Math.round(o.x*e),l=Math.round(o.y*e);o.x=on(s,iF,hM),o.y=on(l,iF,hM),(s<o.x||s>o.x+1||l<o.y||l>o.y+1)&&Ui("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}C();function Kp(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?Jp(t):[]}}var aF=-32768;function f2e(t,e,r,n,i){t.emplaceBack(aF+e*8+n,aF+r*8+i)}var dk=class{constructor(e){this.zoom=e.zoom,this.globalState=e.globalState,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new qbe,this.indexArray=new Vl,this.segments=new Hn,this.programConfigurations=new $p(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,n){let i=this.layers[0],a=[],o=null,s=!1,l=i.type==="heatmap";if(i.type==="circle"){let c=i;o=c.layout.get("circle-sort-key"),s=!o.isConstant(),l=l||c.paint.get("circle-pitch-alignment")==="map"}let u=l?r.subdivisionGranularity.circle:1;for(let{feature:c,id:h,index:d,sourceLayerIndex:p}of e){let m=this.layers[0]._featureFilter.needGeometry,y=Kp(c,m);if(!this.layers[0]._featureFilter.filter(new Fi(this.zoom,{globalState:this.globalState}),y,n))continue;let v=s?o.evaluate(y,{},n):void 0,_={id:h,properties:c.properties,type:c.type,sourceLayerIndex:p,index:d,geometry:m?y.geometry:Jp(c),patterns:{},sortKey:v};a.push(_)}s&&a.sort((c,h)=>c.sortKey-h.sortKey);for(let c of a){let{geometry:h,index:d,sourceLayerIndex:p}=c,m=e[d].feature;this.addFeature(c,h,d,n,u),r.featureIndex.insert(m,h,d,p,this.index)}}update(e,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,l2e),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,r,n,i,a=1){let o;switch(a){case 1:o=[0,7];break;case 3:o=[0,2,5,7];break;case 5:o=[0,1,3,4,6,7];break;case 7:o=[0,1,2,3,4,5,6,7];break;default:throw new Error("Invalid circle bucket granularity: ".concat(a,"; valid values are 1, 3, 5, 7."))}let s=o.length;for(let l of r)for(let u of l){let c=u.x,h=u.y;if(c<0||c>=8192||h<0||h>=8192)continue;let d=this.segments.prepareSegment(s*s,this.layoutVertexArray,this.indexArray,e.sortKey),p=d.vertexLength;for(let m=0;m<s;m++)for(let y=0;y<s;y++)f2e(this.layoutVertexArray,c,h,o[y],o[m]);for(let m=0;m<s-1;m++)for(let y=0;y<s-1;y++){let v=p+m*s+y,_=p+(m+1)*s+y;this.indexArray.emplaceBack(v,_+1,v+1),this.indexArray.emplaceBack(v,_,_+1)}d.vertexLength+=s*s,d.primitiveLength+=(s-1)*(s-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,{},i)}};Mt("CircleBucket",dk,{omit:["layers"]});C();var Nx=Zt(xr(),1);function bH(t,e){for(let r=0;r<t.length;r++)if(Fg(e,t[r]))return!0;for(let r=0;r<e.length;r++)if(Fg(t,e[r]))return!0;return!!pk(t,e)}function m2e(t,e,r){return!!(Fg(t,e)||dM(e,t,r))}function wH(t,e){if(t.length===1)return oF(e,t[0]);for(let r=0;r<e.length;r++){let n=e[r];for(let i=0;i<n.length;i++)if(Fg(t,n[i]))return!0}for(let r=0;r<t.length;r++)if(oF(e,t[r]))return!0;for(let r=0;r<e.length;r++)if(pk(t,e[r]))return!0;return!1}function g2e(t,e,r){for(let n=0;n<e.length;n++){let i=e[n];if(t.length>=3){for(let a=0;a<i.length;a++)if(Fg(t,i[a]))return!0}if(y2e(t,i,r))return!0}return!1}function y2e(t,e,r){if(t.length>1){if(pk(t,e))return!0;for(let n=0;n<e.length;n++)if(dM(e[n],t,r))return!0}for(let n=0;n<t.length;n++)if(dM(t[n],e,r))return!0;return!1}function pk(t,e){if(t.length===0||e.length===0)return!1;for(let r=0;r<t.length-1;r++){let n=t[r],i=t[r+1];for(let a=0;a<e.length-1;a++){let o=e[a],s=e[a+1];if(v2e(n,i,o,s))return!0}}return!1}function v2e(t,e,r,n){return Jh(t,r,n)!==Jh(e,r,n)&&Jh(t,e,r)!==Jh(t,e,n)}function dM(t,e,r){let n=r*r;if(e.length===1)return t.distSqr(e[0])<n;for(let i=1;i<e.length;i++){let a=e[i-1],o=e[i];if(_2e(t,a,o)<n)return!0}return!1}function _2e(t,e,r){let n=e.distSqr(r);if(n===0)return t.distSqr(e);let i=((t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y))/n;return i<0?t.distSqr(e):i>1?t.distSqr(r):t.distSqr(r.sub(e)._mult(i)._add(e))}function oF(t,e){let r=!1,n,i,a;for(let o=0;o<t.length;o++){n=t[o];for(let s=0,l=n.length-1;s<n.length;l=s++)i=n[s],a=n[l],i.y>e.y!=a.y>e.y&&e.x<(a.x-i.x)*(e.y-i.y)/(a.y-i.y)+i.x&&(r=!r)}return r}function Fg(t,e){let r=!1;for(let n=0,i=t.length-1;n<t.length;i=n++){let a=t[n],o=t[i];a.y>e.y!=o.y>e.y&&e.x<(o.x-a.x)*(e.y-a.y)/(o.y-a.y)+a.x&&(r=!r)}return r}function x2e(t,e,r,n,i){for(let o of t)if(e<=o.x&&r<=o.y&&n>=o.x&&i>=o.y)return!0;let a=[new Nx.default(e,r),new Nx.default(e,i),new Nx.default(n,i),new Nx.default(n,r)];if(t.length>2){for(let o of a)if(Fg(t,o))return!0}for(let o=0;o<t.length-1;o++){let s=t[o],l=t[o+1];if(b2e(s,l,a))return!0}return!1}function b2e(t,e,r){let n=r[0],i=r[2];if(t.x<n.x&&e.x<n.x||t.x>i.x&&e.x>i.x||t.y<n.y&&e.y<n.y||t.y>i.y&&e.y>i.y)return!1;let a=Jh(t,e,r[0]);return a!==Jh(t,e,r[1])||a!==Jh(t,e,r[2])||a!==Jh(t,e,r[3])}C();var pM=Zt(xr(),1);function Nv(t,e,r){let n=e.paint.get(t).value;return n.kind==="constant"?n.value:r.programConfigurations.get(e.id).getMaxValue(t)}function w3(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function A3(t,e,r,n,i){if(!e[0]&&!e[1])return t;let a=pM.default.convert(e)._mult(i);r==="viewport"&&a._rotate(-n);let o=[];for(let s=0;s<t.length;s++){let l=t[s];o.push(l.sub(a))}return o}function w2e(t,e){let r=[];for(let n=0;n<t.length;n++){let i=t[n],a=[];for(let o=0;o<i.length;o++){let s=i[o-1],l=i[o],u=i[o+1],c=o===0?new pM.default(0,0):l.sub(s)._unit()._perp(),h=o===i.length-1?new pM.default(0,0):u.sub(l)._unit()._perp(),d=c._add(h)._unit(),p=d.x*h.x+d.y*h.y;p!==0&&d._mult(1/p),a.push(d._mult(e)._add(l))}r.push(a)}return r}C();var sF,A2e=()=>sF=sF||new Oa({"circle-sort-key":new Xt(Oe.layout_circle["circle-sort-key"])}),lF,S2e=()=>lF=lF||new Oa({"circle-radius":new Xt(Oe.paint_circle["circle-radius"]),"circle-color":new Xt(Oe.paint_circle["circle-color"]),"circle-blur":new Xt(Oe.paint_circle["circle-blur"]),"circle-opacity":new Xt(Oe.paint_circle["circle-opacity"]),"circle-translate":new It(Oe.paint_circle["circle-translate"]),"circle-translate-anchor":new It(Oe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new It(Oe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new It(Oe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Xt(Oe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Xt(Oe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Xt(Oe.paint_circle["circle-stroke-opacity"])}),E2e={get paint(){return S2e()},get layout(){return A2e()}},I2e=Zt(xr(),1),C2e=t=>t.type==="circle",M2e=class extends jl{constructor(e){super(e,E2e)}createBucket(e){return new dk(e)}queryRadius(e){let r=e;return Nv("circle-radius",this,r)+Nv("circle-stroke-width",this,r)+w3(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:e,feature:r,featureState:n,geometry:i,transform:a,pixelsToTileUnits:o,unwrappedTileID:s,getElevation:l}){let u=A3(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-a.bearingInRadians,o),c=this.paint.get("circle-radius").evaluate(r,n),h=this.paint.get("circle-stroke-width").evaluate(r,n),d=c+h,p=this.paint.get("circle-pitch-alignment")==="map",m=p?u:T2e(u,a,s,l),y=p?d*o:d;for(let v of i)for(let _ of v){let w=p?_:AH(_,a,s,l),b=y,A=a.projectTileCoordinates(_.x,_.y,s,l).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?b*=A/a.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(b*=a.cameraToCenterDistance/A),m2e(m,w,b))return!0}return!1}};function AH(t,e,r,n){let i=e.projectTileCoordinates(t.x,t.y,r,n).point;return new I2e.default((i.x*.5+.5)*e.width,(-i.y*.5+.5)*e.height)}function T2e(t,e,r,n){return t.map(i=>AH(i,e,r,n))}C();C();var SH=class extends dk{};Mt("HeatmapBucket",SH,{omit:["layers"]});C();var uF,P2e=()=>uF=uF||new Oa({"heatmap-radius":new Xt(Oe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Xt(Oe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new It(Oe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new v3(Oe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new It(Oe.paint_heatmap["heatmap-opacity"])}),D2e={get paint(){return P2e()}};C();C();function fk(t,{width:e,height:r},n,i){if(!i)i=new Uint8Array(e*r*n);else if(i instanceof Uint8ClampedArray)i=new Uint8Array(i.buffer);else if(i.length!==e*r*n)throw new RangeError("mismatched image size. expected: ".concat(i.length," but got: ").concat(e*r*n));return t.width=e,t.height=r,t.data=i,t}function EH(t,{width:e,height:r},n){if(e===t.width&&r===t.height)return;let i=fk({},{width:e,height:r},n);mk(t,i,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,e),height:Math.min(t.height,r)},n),t.width=e,t.height=r,t.data=i.data}function mk(t,e,r,n,i,a){if(i.width===0||i.height===0)return e;if(i.width>t.width||i.height>t.height||r.x>t.width-i.width||r.y>t.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>e.width||i.height>e.height||n.x>e.width-i.width||n.y>e.height-i.height)throw new RangeError("out of range destination coordinates for image copy");let o=t.data,s=e.data;if(o===s)throw new Error("srcData equals dstData, so image is already copied");for(let l=0;l<i.height;l++){let u=((r.y+l)*t.width+r.x)*a,c=((n.y+l)*e.width+n.x)*a;for(let h=0;h<i.width*a;h++)s[c+h]=o[u+h]}return e}var gk=class IH{constructor(e,r){fk(this,e,1,r)}resize(e){EH(this,e,1)}clone(){return new IH({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,n,i,a){mk(e,r,n,i,a,1)}},ti=class CH{constructor(e,r){fk(this,e,4,r)}resize(e){EH(this,e,4)}replace(e,r){r?this.data.set(e):e instanceof Uint8ClampedArray?this.data=new Uint8Array(e.buffer):this.data=e}clone(){return new CH({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,n,i,a){mk(e,r,n,i,a,4)}setPixel(e,r,n){let i=(e*this.width+r)*4;this.data[i+0]=Math.round(n.r*255/n.a),this.data[i+1]=Math.round(n.g*255/n.a),this.data[i+2]=Math.round(n.b*255/n.a),this.data[i+3]=Math.round(n.a*255)}};Mt("AlphaImage",gk);Mt("RGBAImage",ti);function MH(t){let e={},r=t.resolution||256,n=t.clips?t.clips.length:1,i=t.image||new ti({width:r,height:n});if(!d1e(r))throw new Error("width is not a power of 2 - ".concat(r));let a=(o,s,l)=>{e[t.evaluationKey]=l;let u=t.expression.evaluate(e);i.setPixel(o/4/r,s/4,u)};if(t.clips)for(let o=0,s=0;o<n;++o,s+=r*4)for(let l=0,u=0;l<r;l++,u+=4){let c=l/(r-1),{start:h,end:d}=t.clips[o],p=h*(1-c)+d*c;a(s,u,p)}else for(let o=0,s=0;o<r;o++,s+=4){let l=o/(r-1);a(0,s,l)}return i}var v1="big-fb",k2e=t=>t.type==="heatmap",O2e=class extends jl{createBucket(e){return new SH(e)}constructor(e){super(e,D2e),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){let e=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=MH({expression:e,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(v1)&&this.heatmapFbos.delete(v1)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}};C();C();var cF,B2e=()=>cF=cF||new Oa({"hillshade-illumination-direction":new It(Oe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new It(Oe.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new It(Oe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new It(Oe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new It(Oe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new It(Oe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new It(Oe.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new It(Oe.paint_hillshade["hillshade-method"])}),z2e={get paint(){return B2e()}},F2e=t=>t.type==="hillshade",R2e=class extends jl{constructor(e){super(e,z2e),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let e=this.paint.get("hillshade-illumination-direction").values,r=this.paint.get("hillshade-illumination-altitude").values,n=this.paint.get("hillshade-highlight-color").values,i=this.paint.get("hillshade-shadow-color").values,a=Math.max(e.length,r.length,n.length,i.length);e=e.concat(Array(a-e.length).fill(e.at(-1))),r=r.concat(Array(a-r.length).fill(r.at(-1))),n=n.concat(Array(a-n.length).fill(n.at(-1))),i=i.concat(Array(a-i.length).fill(i.at(-1)));let o=r.map(Zn);return{directionRadians:e.map(Zn),altitudeRadians:o,shadowColor:i,highlightColor:n}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}};C();C();var hF,L2e=()=>hF=hF||new Oa({"color-relief-opacity":new It(Oe["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new v3(Oe["paint_color-relief"]["color-relief-color"])}),N2e={get paint(){return L2e()}};C();var ki=class{constructor(e,r,n,i){this.context=e,this.format=n,this.texture=e.gl.createTexture(),this.update(r,i)}update(e,r,n){let{width:i,height:a}=e,o=(!this.size||this.size[0]!==i||this.size[1]!==a)&&!n,{context:s}=this,{gl:l}=s;if(this.useMipmap=!!(r&&r.useMipmap),l.bindTexture(l.TEXTURE_2D,this.texture),s.pixelStoreUnpackFlipY.set(!1),s.pixelStoreUnpack.set(1),s.pixelStoreUnpackPremultiplyAlpha.set(this.format===l.RGBA&&(!r||r.premultiply!==!1)),o)this.size=[i,a],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||Lc(e)?l.texImage2D(l.TEXTURE_2D,0,this.format,this.format,l.UNSIGNED_BYTE,e):l.texImage2D(l.TEXTURE_2D,0,this.format,i,a,0,this.format,l.UNSIGNED_BYTE,e.data);else{let{x:u,y:c}=n||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||Lc(e)?l.texSubImage2D(l.TEXTURE_2D,0,u,c,l.RGBA,l.UNSIGNED_BYTE,e):l.texSubImage2D(l.TEXTURE_2D,0,u,c,i,a,l.RGBA,l.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&l.generateMipmap(l.TEXTURE_2D),s.pixelStoreUnpackFlipY.setDefault(),s.pixelStoreUnpack.setDefault(),s.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(e,r,n){let{context:i}=this,{gl:a}=i;a.bindTexture(a.TEXTURE_2D,this.texture),n===a.LINEAR_MIPMAP_NEAREST&&!this.isSizePowerOfTwo()&&(n=a.LINEAR),e!==this.filter&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,e),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,n||e),this.filter=e),r!==this.wrap&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,r),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,r),this.wrap=r)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1===0}destroy(){let{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}};C();var $2e=class{constructor(e,r,n,i=1,a=1,o=1,s=0){if(this.uid=e,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(n&&!["mapbox","terrarium","custom"].includes(n)){Ui('"'.concat(n,'" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".'));return}this.stride=r.height;let l=this.dim=r.height-2;switch(this.data=new Uint32Array(r.data.buffer),n){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=i,this.greenFactor=a,this.blueFactor=o,this.baseShift=s;break;case"mapbox":default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4;break}for(let u=0;u<l;u++)this.data[this._idx(-1,u)]=this.data[this._idx(0,u)],this.data[this._idx(l,u)]=this.data[this._idx(l-1,u)],this.data[this._idx(u,-1)]=this.data[this._idx(u,0)],this.data[this._idx(u,l)]=this.data[this._idx(u,l-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(l,-1)]=this.data[this._idx(l-1,0)],this.data[this._idx(-1,l)]=this.data[this._idx(0,l-1)],this.data[this._idx(l,l)]=this.data[this._idx(l-1,l-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let u=0;u<l;u++)for(let c=0;c<l;c++){let h=this.get(u,c);h>this.max&&(this.max=h),h<this.min&&(this.min=h)}}get(e,r){let n=new Uint8Array(this.data.buffer),i=this._idx(e,r)*4;return this.unpack(n[i],n[i+1],n[i+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,r){if(e<-1||e>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(e+1)}unpack(e,r,n){return e*this.redFactor+r*this.greenFactor+n*this.blueFactor-this.baseShift}pack(e){return TH(e,this.getUnpackVector())}getPixels(){return new ti({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,r,n){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let i=r*this.dim,a=r*this.dim+this.dim,o=n*this.dim,s=n*this.dim+this.dim;switch(r){case-1:i=a-1;break;case 1:a=i+1;break}switch(n){case-1:o=s-1;break;case 1:s=o+1;break}let l=-r*this.dim,u=-n*this.dim;for(let c=o;c<s;c++)for(let h=i;h<a;h++)this.data[this._idx(h,c)]=e.data[this._idx(h+l,c+u)]}};function TH(t,e){let r=e[0],n=e[1],i=e[2],a=e[3],o=Math.min(r,n,i),s=Math.round((t+a)/o);return{r:Math.floor(s*o/r)%256,g:Math.floor(s*o/n)%256,b:Math.floor(s*o/i)%256}}Mt("DEMData",$2e);var U2e=t=>t.type==="color-relief",j2e=class extends jl{constructor(e){super(e,N2e)}_createColorRamp(e){let r={elevationStops:[],colorStops:[]},n=this._transitionablePaint._values["color-relief-color"].value.expression;if(n instanceof f1&&n._styleExpression.expression instanceof zl){this.colorRampExpression=n;let o=n._styleExpression.expression;r.elevationStops=o.labels,r.colorStops=[];for(let s of r.elevationStops)r.colorStops.push(o.evaluate({globals:{elevation:s}}))}if(r.elevationStops.length<1&&(r.elevationStops=[0],r.colorStops=[Gt.transparent]),r.elevationStops.length<2&&(r.elevationStops.push(r.elevationStops[0]+1),r.colorStops.push(r.colorStops[0])),r.elevationStops.length<=e)return r;let i={elevationStops:[],colorStops:[]},a=(r.elevationStops.length-1)/(e-1);for(let o=0;o<r.elevationStops.length-.5;o+=a)i.elevationStops.push(r.elevationStops[Math.round(o)]),i.colorStops.push(r.colorStops[Math.round(o)]);return Ui("Too many colors in specification of ".concat(this.id," color-relief layer, may not render properly.")),i}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(e,r,n){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;let i=this._createColorRamp(r),a=new ti({width:i.colorStops.length,height:1}),o=new ti({width:i.colorStops.length,height:1});for(let s=0;s<i.elevationStops.length;s++){let l=TH(i.elevationStops[s],n);o.setPixel(0,s,new Gt(l.r/255,l.g/255,l.b/255,1)),a.setPixel(0,s,i.colorStops[s])}return this.colorRampTextures={elevationTexture:new ki(e,o,e.gl.RGBA),colorTexture:new ki(e,a,e.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}};C();C();C();var V2e=Si([{name:"a_pos",components:2,type:"Int16"}],4),{members:G2e}=V2e;C();function yk(t,e,r){let n=r.patternDependencies,i=!1;for(let a of e){let o=a.paint.get("".concat(t,"-pattern"));o.isConstant()||(i=!0);let s=o.constantOr(null);s&&(i=!0,n[s.to]=!0,n[s.from]=!0)}return i}function vk(t,e,r,n,i){let a=i.patternDependencies;for(let o of e){let s=o.paint.get("".concat(t,"-pattern")).value;if(s.kind!=="constant"){let l=s.evaluate({zoom:n-1},r,{},i.availableImages),u=s.evaluate({zoom:n},r,{},i.availableImages),c=s.evaluate({zoom:n+1},r,{},i.availableImages);l=l&&l.name?l.name:l,u=u&&u.name?u.name:u,c=c&&c.name?c.name:c,a[l]=!0,a[u]=!0,a[c]=!0,r.patterns[o.id]={min:l,mid:u,max:c}}}return r}C();var $x=Zt(xr(),1);C();function Z2e(t,e,r=2){let n=e&&e.length,i=n?e[0]*r:t.length,a=PH(t,0,i,r,!0),o=[];if(!a||a.next===a.prev)return o;let s,l,u;if(n&&(a=Y2e(t,e,a,r)),t.length>80*r){s=1/0,l=1/0;let c=-1/0,h=-1/0;for(let d=r;d<i;d+=r){let p=t[d],m=t[d+1];p<s&&(s=p),m<l&&(l=m),p>c&&(c=p),m>h&&(h=m)}u=Math.max(c-s,h-l),u=u!==0?32767/u:0}return _1(a,o,r,s,l,u,0),o}function PH(t,e,r,n,i){let a;if(i===swe(t,e,r,n)>0)for(let o=e;o<r;o+=n)a=dF(o/n|0,t[o],t[o+1],a);else for(let o=r-n;o>=e;o-=n)a=dF(o/n|0,t[o],t[o+1],a);return a&&Rg(a,a.next)&&(b1(a),a=a.next),a}function Up(t,e){if(!t)return t;e||(e=t);let r=t,n;do if(n=!1,!r.steiner&&(Rg(r,r.next)||yi(r.prev,r,r.next)===0)){if(b1(r),r=e=r.prev,r===r.next)break;n=!0}else r=r.next;while(n||r!==e);return e}function _1(t,e,r,n,i,a,o){if(!t)return;!o&&a&&twe(t,n,i,a);let s=t;for(;t.prev!==t.next;){let l=t.prev,u=t.next;if(a?H2e(t,n,i,a):W2e(t)){e.push(l.i,t.i,u.i),b1(t),t=u.next,s=u.next;continue}if(t=u,t===s){o?o===1?(t=X2e(Up(t),e),_1(t,e,r,n,i,a,2)):o===2&&q2e(t,e,r,n,i,a):_1(Up(t),e,r,n,i,a,1);break}}}function W2e(t){let e=t.prev,r=t,n=t.next;if(yi(e,r,n)>=0)return!1;let i=e.x,a=r.x,o=n.x,s=e.y,l=r.y,u=n.y,c=Math.min(i,a,o),h=Math.min(s,l,u),d=Math.max(i,a,o),p=Math.max(s,l,u),m=n.next;for(;m!==e;){if(m.x>=c&&m.x<=d&&m.y>=h&&m.y<=p&&$y(i,s,a,l,o,u,m.x,m.y)&&yi(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function H2e(t,e,r,n){let i=t.prev,a=t,o=t.next;if(yi(i,a,o)>=0)return!1;let s=i.x,l=a.x,u=o.x,c=i.y,h=a.y,d=o.y,p=Math.min(s,l,u),m=Math.min(c,h,d),y=Math.max(s,l,u),v=Math.max(c,h,d),_=fM(p,m,e,r,n),w=fM(y,v,e,r,n),b=t.prevZ,A=t.nextZ;for(;b&&b.z>=_&&A&&A.z<=w;){if(b.x>=p&&b.x<=y&&b.y>=m&&b.y<=v&&b!==i&&b!==o&&$y(s,c,l,h,u,d,b.x,b.y)&&yi(b.prev,b,b.next)>=0||(b=b.prevZ,A.x>=p&&A.x<=y&&A.y>=m&&A.y<=v&&A!==i&&A!==o&&$y(s,c,l,h,u,d,A.x,A.y)&&yi(A.prev,A,A.next)>=0))return!1;A=A.nextZ}for(;b&&b.z>=_;){if(b.x>=p&&b.x<=y&&b.y>=m&&b.y<=v&&b!==i&&b!==o&&$y(s,c,l,h,u,d,b.x,b.y)&&yi(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;A&&A.z<=w;){if(A.x>=p&&A.x<=y&&A.y>=m&&A.y<=v&&A!==i&&A!==o&&$y(s,c,l,h,u,d,A.x,A.y)&&yi(A.prev,A,A.next)>=0)return!1;A=A.nextZ}return!0}function X2e(t,e){let r=t;do{let n=r.prev,i=r.next.next;!Rg(n,i)&&kH(n,r,r.next,i)&&x1(n,i)&&x1(i,n)&&(e.push(n.i,r.i,i.i),b1(r),b1(r.next),r=t=i),r=r.next}while(r!==t);return Up(r)}function q2e(t,e,r,n,i,a){let o=t;do{let s=o.next.next;for(;s!==o.prev;){if(o.i!==s.i&&iwe(o,s)){let l=OH(o,s);o=Up(o,o.next),l=Up(l,l.next),_1(o,e,r,n,i,a,0),_1(l,e,r,n,i,a,0);return}s=s.next}o=o.next}while(o!==t)}function Y2e(t,e,r,n){let i=[];for(let a=0,o=e.length;a<o;a++){let s=e[a]*n,l=a<o-1?e[a+1]*n:t.length,u=PH(t,s,l,n,!1);u===u.next&&(u.steiner=!0),i.push(nwe(u))}i.sort(J2e);for(let a=0;a<i.length;a++)r=K2e(i[a],r);return r}function J2e(t,e){let r=t.x-e.x;if(r===0&&(r=t.y-e.y,r===0)){let n=(t.next.y-t.y)/(t.next.x-t.x),i=(e.next.y-e.y)/(e.next.x-e.x);r=n-i}return r}function K2e(t,e){let r=Q2e(t,e);if(!r)return e;let n=OH(r,t);return Up(n,n.next),Up(r,r.next)}function Q2e(t,e){let r=e,n=t.x,i=t.y,a=-1/0,o;if(Rg(t,r))return r;do{if(Rg(t,r.next))return r.next;if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){let h=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(h<=n&&h>a&&(a=h,o=r.x<r.next.x?r:r.next,h===n))return o}r=r.next}while(r!==e);if(!o)return null;let s=o,l=o.x,u=o.y,c=1/0;r=o;do{if(n>=r.x&&r.x>=l&&n!==r.x&&DH(i<u?n:a,i,l,u,i<u?a:n,i,r.x,r.y)){let h=Math.abs(i-r.y)/(n-r.x);x1(r,t)&&(h<c||h===c&&(r.x>o.x||r.x===o.x&&ewe(o,r)))&&(o=r,c=h)}r=r.next}while(r!==s);return o}function ewe(t,e){return yi(t.prev,t,e.prev)<0&&yi(e.next,t,t.next)<0}function twe(t,e,r,n){let i=t;do i.z===0&&(i.z=fM(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,rwe(i)}function rwe(t){let e,r=1;do{let n=t,i;t=null;let a=null;for(e=0;n;){e++;let o=n,s=0;for(let u=0;u<r&&(s++,o=o.nextZ,!!o);u++);let l=r;for(;s>0||l>0&&o;)s!==0&&(l===0||!o||n.z<=o.z)?(i=n,n=n.nextZ,s--):(i=o,o=o.nextZ,l--),a?a.nextZ=i:t=i,i.prevZ=a,a=i;n=o}a.nextZ=null,r*=2}while(e>1);return t}function fM(t,e,r,n,i){return t=(t-r)*i|0,e=(e-n)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function nwe(t){let e=t,r=t;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==t);return r}function DH(t,e,r,n,i,a,o,s){return(i-o)*(e-s)>=(t-o)*(a-s)&&(t-o)*(n-s)>=(r-o)*(e-s)&&(r-o)*(a-s)>=(i-o)*(n-s)}function $y(t,e,r,n,i,a,o,s){return!(t===o&&e===s)&&DH(t,e,r,n,i,a,o,s)}function iwe(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!awe(t,e)&&(x1(t,e)&&x1(e,t)&&owe(t,e)&&(yi(t.prev,t,e.prev)||yi(t,e.prev,e))||Rg(t,e)&&yi(t.prev,t,t.next)>0&&yi(e.prev,e,e.next)>0)}function yi(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Rg(t,e){return t.x===e.x&&t.y===e.y}function kH(t,e,r,n){let i=jx(yi(t,e,r)),a=jx(yi(t,e,n)),o=jx(yi(r,n,t)),s=jx(yi(r,n,e));return!!(i!==a&&o!==s||i===0&&Ux(t,r,e)||a===0&&Ux(t,n,e)||o===0&&Ux(r,t,n)||s===0&&Ux(r,e,n))}function Ux(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function jx(t){return t>0?1:t<0?-1:0}function awe(t,e){let r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&kH(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}function x1(t,e){return yi(t.prev,t,t.next)<0?yi(t,e,t.next)>=0&&yi(t,t.prev,e)>=0:yi(t,e,t.prev)<0||yi(t,t.next,e)<0}function owe(t,e){let r=t,n=!1,i=(t.x+e.x)/2,a=(t.y+e.y)/2;do r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==t);return n}function OH(t,e){let r=mM(t.i,t.x,t.y),n=mM(e.i,e.x,e.y),i=t.next,a=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}function dF(t,e,r,n){let i=mM(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function b1(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function mM(t,e,r){return{i:t,x:e,y:r,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function swe(t,e,r,n){let i=0;for(let a=e,o=r-n;a<r;a+=n)i+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return i}C();var Oc=class{constructor(t,e){if(e>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=e}getGranularityForZoomLevel(t){let e=1<<t;return Math.max(Math.floor(this._baseZoomGranularity/e),this._minGranularity,1)}},gM=class{constructor(e){this.fill=e.fill,this.line=e.line,this.tile=e.tile,this.stencil=e.stencil,this.circle=e.circle}};gM.noSubdivision=new gM({fill:new Oc(0,0),line:new Oc(0,0),tile:new Oc(0,0),stencil:new Oc(0,0),circle:1});var _k=gM;Mt("SubdivisionGranularityExpression",Oc);Mt("SubdivisionGranularitySetting",_k);var Vh=-32768,op=32767,lwe=class{constructor(e,r){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=e,this._granularityCellSize=8192/e,this._canonical=r}_getKey(e,r){return e=e+32768,r=r+32768,e<<16|r<<0}_vertexToIndex(e,r){if(e<-32768||r<-32768||e>32767||r>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");let n=Math.round(e)|0,i=Math.round(r)|0,a=this._getKey(n,i);if(this._vertexDictionary.has(a))return this._vertexDictionary.get(a);let o=this._vertexBuffer.length/2;return this._vertexDictionary.set(a,o),this._vertexBuffer.push(n,i),o}_subdivideTrianglesScanline(e){if(this._granularity<2)return cwe(this._vertexBuffer,e);let r=[],n=e.length;for(let i=0;i<n;i+=3){let a=[e[i+0],e[i+1],e[i+2]],o=[this._vertexBuffer[e[i+0]*2+0],this._vertexBuffer[e[i+0]*2+1],this._vertexBuffer[e[i+1]*2+0],this._vertexBuffer[e[i+1]*2+1],this._vertexBuffer[e[i+2]*2+0],this._vertexBuffer[e[i+2]*2+1]],s=1/0,l=1/0,u=-1/0,c=-1/0;for(let y=0;y<3;y++){let v=o[y*2],_=o[y*2+1];s=Math.min(s,v),u=Math.max(u,v),l=Math.min(l,_),c=Math.max(c,_)}if(s===u||l===c)continue;let h=Math.floor(s/this._granularityCellSize),d=Math.ceil(u/this._granularityCellSize),p=Math.floor(l/this._granularityCellSize),m=Math.ceil(c/this._granularityCellSize);if(h===d&&p===m){r.push(...a);continue}for(let y=p;y<m;y++){let v=this._scanlineGenerateVertexRingForCellRow(y,o,a);hwe(this._vertexBuffer,v,r)}}return r}_scanlineGenerateVertexRingForCellRow(e,r,n){let i=e*this._granularityCellSize,a=i+this._granularityCellSize,o=[];for(let s=0;s<3;s++){let l=r[s*2],u=r[s*2+1],c=r[(s+1)*2%6],h=r[((s+1)*2+1)%6],d=r[(s+2)*2%6],p=r[((s+2)*2+1)%6],m=c-l,y=h-u,v=m===0,_=y===0,w=(i-u)/y,b=(a-u)/y,A=Math.min(w,b),E=Math.max(w,b);if(!_&&(A>=1||E<=0)||_&&(u<i||u>a)){h>=i&&h<=a&&o.push(n[(s+1)%3]);continue}if(!_&&A>0){let k=l+m*A,D=u+y*A;o.push(this._vertexToIndex(k,D))}let M=l+m*Math.max(A,0),P=l+m*Math.min(E,1);if(v||this._generateIntraEdgeVertices(o,l,u,c,h,M,P),!_&&E<1){let k=l+m*E,D=u+y*E;o.push(this._vertexToIndex(k,D))}(_||h>=i&&h<=a)&&o.push(n[(s+1)%3]),!_&&(h<=i||h>=a)&&this._generateInterEdgeVertices(o,l,u,c,h,d,p,P,i,a)}return o}_generateIntraEdgeVertices(e,r,n,i,a,o,s){let l=i-r,u=a-n,c=u===0,h=c?Math.min(r,i):Math.min(o,s),d=c?Math.max(r,i):Math.max(o,s),p=Math.floor(h/this._granularityCellSize)+1,m=Math.ceil(d/this._granularityCellSize)-1;if(c?r<i:o<s)for(let y=p;y<=m;y++){let v=y*this._granularityCellSize,_=n+u*(v-r)/l;e.push(this._vertexToIndex(v,_))}else for(let y=m;y>=p;y--){let v=y*this._granularityCellSize,_=n+u*(v-r)/l;e.push(this._vertexToIndex(v,_))}}_generateInterEdgeVertices(e,r,n,i,a,o,s,l,u,c){let h=a-n,d=o-i,p=s-a,m=(u-a)/p,y=(c-a)/p,v=Math.min(m,y),_=Math.max(m,y),w=i+d*v,b=Math.floor(Math.min(w,l)/this._granularityCellSize)+1,A=Math.ceil(Math.max(w,l)/this._granularityCellSize)-1,E=l<w,M=p===0;if(M&&(s===u||s===c))return;if(M||v>=1||_<=0){let k=r-o,D=n-s,O=(u-s)/D,B=(c-s)/D,L=Math.min(O,B),R=o+k*L;b=Math.floor(Math.min(R,l)/this._granularityCellSize)+1,A=Math.ceil(Math.max(R,l)/this._granularityCellSize)-1,E=l<R}let P=h>0?c:u;if(E)for(let k=b;k<=A;k++){let D=k*this._granularityCellSize;e.push(this._vertexToIndex(D,P))}else for(let k=A;k>=b;k--){let D=k*this._granularityCellSize;e.push(this._vertexToIndex(D,P))}}_generateOutline(e){let r=[];for(let n of e){let i=xk(n,this._granularity,!0),a=this._pointArrayToIndices(i),o=[];for(let s=1;s<a.length;s++)o.push(a[s-1]),o.push(a[s]);r.push(o)}return r}_handlePoles(e){let r=!1,n=!1;this._canonical&&(this._canonical.y===0&&(r=!0),this._canonical.y===(1<<this._canonical.z)-1&&(n=!0)),(r||n)&&this._fillPoles(e,r,n)}_ensureNoPoleVertices(){let e=this._vertexBuffer;for(let r=0;r<e.length;r+=2){let n=e[r+1];n===Vh&&(e[r+1]=Vh+1),n===op&&(e[r+1]=op-1)}}_generatePoleQuad(e,r,n,i,a,o){i>a!=(o===Vh)?(e.push(r),e.push(n),e.push(this._vertexToIndex(i,o)),e.push(n),e.push(this._vertexToIndex(a,o)),e.push(this._vertexToIndex(i,o))):(e.push(n),e.push(r),e.push(this._vertexToIndex(i,o)),e.push(this._vertexToIndex(a,o)),e.push(n),e.push(this._vertexToIndex(i,o)))}_fillPoles(e,r,n){let i=this._vertexBuffer,a=0,o=8192,s=e.length;for(let l=2;l<s;l+=3){let u=e[l-2],c=e[l-1],h=e[l],d=i[u*2],p=i[u*2+1],m=i[c*2],y=i[c*2+1],v=i[h*2],_=i[h*2+1];r&&(p===a&&y===a&&this._generatePoleQuad(e,u,c,d,m,Vh),y===a&&_===a&&this._generatePoleQuad(e,c,h,m,v,Vh),_===a&&p===a&&this._generatePoleQuad(e,h,u,v,d,Vh)),n&&(p===o&&y===o&&this._generatePoleQuad(e,u,c,d,m,op),y===o&&_===o&&this._generatePoleQuad(e,c,h,m,v,op),_===o&&p===o&&this._generatePoleQuad(e,h,u,v,d,op))}}_initializeVertices(e){for(let r=0;r<e.length;r+=2)this._vertexToIndex(e[r],e[r+1])}subdividePolygonInternal(e,r){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;let{flattened:n,holeIndices:i}=uwe(e);this._initializeVertices(n);let a;try{let s=Z2e(n,i),l=this._convertIndices(n,s);a=this._subdivideTrianglesScanline(l)}catch(s){console.error(s)}let o=[];return r&&(o=this._generateOutline(e)),this._ensureNoPoleVertices(),this._handlePoles(a),{verticesFlattened:this._vertexBuffer,indicesTriangles:a,indicesLineList:o}}_convertIndices(e,r){let n=[];for(let i=0;i<r.length;i++){let a=e[r[i]*2],o=e[r[i]*2+1];n.push(this._vertexToIndex(a,o))}return n}_pointArrayToIndices(e){let r=[];for(let n=0;n<e.length;n++){let i=e[n];r.push(this._vertexToIndex(i.x,i.y))}return r}};function BH(t,e,r,n=!0){return new lwe(r,e).subdividePolygonInternal(t,n)}function xk(t,e,r=!1){if(!t||t.length<1)return[];if(t.length<2)return[];let n=t[0],i=t[t.length-1],a=r&&(n.x!==i.x||n.y!==i.y);if(e<2)return a?[...t,t[0]]:[...t];let o=Math.floor(8192/e),s=[];s.push(new $x.default(t[0].x,t[0].y));let l=t.length,u=a?l:l-1;for(let c=0;c<u;c++){let h=t[c],d=c<l-1?t[c+1]:t[0],p=h.x,m=h.y,y=d.x,v=d.y,_=p!==y,w=m!==v;if(!_&&!w)continue;let b=y-p,A=v-m,E=Math.abs(b),M=Math.abs(A),P=p,k=m;for(;;){let O=b>0?(Math.floor(P/o)+1)*o:(Math.ceil(P/o)-1)*o,B=A>0?(Math.floor(k/o)+1)*o:(Math.ceil(k/o)-1)*o,L=Math.abs(P-O),R=Math.abs(k-B),T=Math.abs(P-y),N=Math.abs(k-v),$=_?L/E:Number.POSITIVE_INFINITY,V=w?R/M:Number.POSITIVE_INFINITY;if((T<=L||!_)&&(N<=R||!w))break;if($<V&&_||!w){P=O,k=k+A*$;let G=new $x.default(P,Math.round(k));(s[s.length-1].x!==G.x||s[s.length-1].y!==G.y)&&s.push(G)}else{P=P+b*V,k=B;let G=new $x.default(Math.round(P),k);(s[s.length-1].x!==G.x||s[s.length-1].y!==G.y)&&s.push(G)}}let D=new $x.default(y,v);(s[s.length-1].x!==D.x||s[s.length-1].y!==D.y)&&s.push(D)}return s}function uwe(t){let e=[],r=[];for(let n of t)if(n.length!==0){n!==t[0]&&e.push(r.length/2);for(let i=0;i<n.length;i++)r.push(n[i].x),r.push(n[i].y)}return{flattened:r,holeIndices:e}}function cwe(t,e){let r=[];for(let n=0;n<e.length;n+=3){let i=e[n],a=e[n+1],o=e[n+2],s=t[i*2],l=t[i*2+1],u=t[a*2],c=t[a*2+1],h=t[o*2],d=t[o*2+1],p=u-s,m=c-l,y=h-s,v=d-l;p*v-m*y>0?(r.push(i),r.push(o),r.push(a)):(r.push(i),r.push(a),r.push(o))}return r}function hwe(t,e,r){if(e.length===0)throw new Error("Subdivision vertex ring is empty.");let n=0,i=t[e[0]*2];for(let l=1;l<e.length;l++){let u=t[e[l]*2];u<i&&(i=u,n=l)}let a=e.length,o=n,s=(o+1)%a;for(;;){let l=o-1>=0?o-1:a-1,u=(s+1)%a,c=t[e[l]*2],h=t[e[l]*2+1],d=t[e[u]*2],p=t[e[u]*2+1],m=t[e[o]*2],y=t[e[o]*2+1],v=t[e[s]*2],_=t[e[s]*2+1],w=!1;if(c<d)w=!0;else if(c>d)w=!1;else{let b=v-m,A=_-y,E=-b,M=y<_?1:-1,P=((c-m)*A+(h-y)*E)*M,k=((d-m)*A+(p-y)*E)*M;P>k&&(w=!0)}if(w){let b=e[l],A=e[o],E=e[s];b!==A&&b!==E&&A!==E&&r.push(E,A,b),o--,o<0&&(o=a-1)}else{let b=e[u],A=e[o],E=e[s];b!==A&&b!==E&&A!==E&&r.push(E,A,b),s++,s>=a&&(s=0)}if(l===u)break}}C();function zH(t,e,r,n,i,a,o,s,l){let u=i.length/2,c=o&&s&&l;if(u<Hn.MAX_VERTEX_ARRAY_LENGTH){let h=e.prepareSegment(u,r,n),d=h.vertexLength;for(let y=0;y<a.length;y+=3)n.emplaceBack(d+a[y],d+a[y+1],d+a[y+2]);h.vertexLength+=u,h.primitiveLength+=a.length/3;let p,m;c&&(m=o.prepareSegment(u,r,s),p=m.vertexLength,m.vertexLength+=u);for(let y=0;y<i.length;y+=2)t(i[y],i[y+1]);if(c)for(let y=0;y<l.length;y++){let v=l[y];for(let _=1;_<v.length;_+=2)s.emplaceBack(p+v[_-1],p+v[_]);m.primitiveLength+=v.length/2}}else dwe(e,r,n,i,a,t),c&&pwe(o,r,s,i,l,t),e.forceNewSegmentOnNextPrepare(),o?.forceNewSegmentOnNextPrepare()}function $v(t,e,r,n,i,a,o){if(a){let s=n.count;return r(e[i*2],e[i*2+1]),t[i]=n.count,n.count++,o.vertexLength++,s}else return t[i]}function dwe(t,e,r,n,i,a){let o=[];for(let h=0;h<n.length/2;h++)o.push(-1);let s={count:0},l=0,u=t.getOrCreateLatestSegment(e,r),c=u.vertexLength;for(let h=2;h<i.length;h+=3){let d=i[h-2],p=i[h-1],m=i[h],y=o[d]<l,v=o[p]<l,_=o[m]<l,w=(y?1:0)+(v?1:0)+(_?1:0);u.vertexLength+w>Hn.MAX_VERTEX_ARRAY_LENGTH&&(u=t.createNewSegment(e,r),l=s.count,y=!0,v=!0,_=!0,c=0);let b=$v(o,n,a,s,d,y,u),A=$v(o,n,a,s,p,v,u),E=$v(o,n,a,s,m,_,u);r.emplaceBack(c+b-l,c+A-l,c+E-l),u.primitiveLength++}}function pwe(t,e,r,n,i,a){let o=[];for(let h=0;h<n.length/2;h++)o.push(-1);let s={count:0},l=0,u=t.getOrCreateLatestSegment(e,r),c=u.vertexLength;for(let h=0;h<i.length;h++){let d=i[h];for(let p=1;p<i[h].length;p+=2){let m=d[p-1],y=d[p],v=o[m]<l,_=o[y]<l,w=(v?1:0)+(_?1:0);u.vertexLength+w>Hn.MAX_VERTEX_ARRAY_LENGTH&&(u=t.createNewSegment(e,r),l=s.count,v=!0,_=!0,c=0);let b=$v(o,n,a,s,m,v,u),A=$v(o,n,a,s,y,_,u);r.emplaceBack(c+b-l,c+A-l),u.primitiveLength++}}}var fwe=500,FH=class{constructor(t){this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(e=>e.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ybe,this.indexArray=new Vl,this.indexArray2=new lM,this.programConfigurations=new $p(t.layers,t.zoom),this.segments=new Hn,this.segments2=new Hn,this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id)}populate(t,e,r){this.hasPattern=yk("fill",this.layers,e);let n=this.layers[0].layout.get("fill-sort-key"),i=!n.isConstant(),a=[];for(let{feature:o,id:s,index:l,sourceLayerIndex:u}of t){let c=this.layers[0]._featureFilter.needGeometry,h=Kp(o,c);if(!this.layers[0]._featureFilter.filter(new Fi(this.zoom,{globalState:this.globalState}),h,r))continue;let d=i?n.evaluate(h,{},r,e.availableImages):void 0,p={id:s,properties:o.properties,type:o.type,sourceLayerIndex:u,index:l,geometry:c?h.geometry:Jp(o),patterns:{},sortKey:d};a.push(p)}i&&a.sort((o,s)=>o.sortKey-s.sortKey);for(let o of a){let{geometry:s,index:l,sourceLayerIndex:u}=o;if(this.hasPattern){let h=vk("fill",this.layers,o,this.zoom,e);this.patternFeatures.push(h)}else this.addFeature(o,s,l,r,{},e.subdivisionGranularity);let c=t[l].feature;e.featureIndex.insert(c,s,l,u,this.index)}}update(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)}addFeatures(t,e,r){for(let n of this.patternFeatures)this.addFeature(n,n.geometry,n.index,e,r,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,G2e),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,e,r,n,i,a){for(let o of O5(e,fwe)){let s=BH(o,n,a.fill.getGranularityForZoomLevel(n.z)),l=this.layoutVertexArray;zH((u,c)=>{l.emplaceBack(u,c)},this.segments,this.layoutVertexArray,this.indexArray,s.verticesFlattened,s.indicesTriangles,this.segments2,this.indexArray2,s.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,i,n)}};Mt("FillBucket",FH,{omit:["layers","patternFeatures"]});C();var pF,mwe=()=>pF=pF||new Oa({"fill-sort-key":new Xt(Oe.layout_fill["fill-sort-key"])}),fF,gwe=()=>fF=fF||new Oa({"fill-antialias":new It(Oe.paint_fill["fill-antialias"]),"fill-opacity":new Xt(Oe.paint_fill["fill-opacity"]),"fill-color":new Xt(Oe.paint_fill["fill-color"]),"fill-outline-color":new Xt(Oe.paint_fill["fill-outline-color"]),"fill-translate":new It(Oe.paint_fill["fill-translate"]),"fill-translate-anchor":new It(Oe.paint_fill["fill-translate-anchor"]),"fill-pattern":new y3(Oe.paint_fill["fill-pattern"])}),ywe={get paint(){return gwe()},get layout(){return mwe()}},vwe=t=>t.type==="fill",_we=class extends jl{constructor(e){super(e,ywe)}recalculate(e,r){super.recalculate(e,r);let n=this.paint._values["fill-outline-color"];n.value.kind==="constant"&&n.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new FH(e)}queryRadius(){return w3(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:e,geometry:r,transform:n,pixelsToTileUnits:i}){let a=A3(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-n.bearingInRadians,i);return wH(a,r)}isTileClipped(){return!0}};C();C();C();var xwe=Si([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),bwe=Si([{name:"a_centroid",components:2,type:"Int16"}],4),{members:wwe}=xwe,Awe=Zt(XA(),1),Swe=Awe.default.VectorTileFeature.types,Ewe=500,DE=Math.pow(2,13);function ay(t,e,r,n,i,a,o,s){t.emplaceBack(e,r,Math.floor(n*DE)*2+o,i*DE*2,a*DE*2,Math.round(s))}var RH=class{constructor(e){this.zoom=e.zoom,this.globalState=e.globalState,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Jbe,this.centroidVertexArray=new kc,this.indexArray=new Vl,this.programConfigurations=new $p(e.layers,e.zoom),this.segments=new Hn,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,n){this.features=[],this.hasPattern=yk("fill-extrusion",this.layers,r);for(let{feature:i,id:a,index:o,sourceLayerIndex:s}of e){let l=this.layers[0]._featureFilter.needGeometry,u=Kp(i,l);if(!this.layers[0]._featureFilter.filter(new Fi(this.zoom,{globalState:this.globalState}),u,n))continue;let c={id:a,sourceLayerIndex:s,index:o,geometry:l?u.geometry:Jp(i),properties:i.properties,type:i.type,patterns:{}};this.hasPattern?this.features.push(vk("fill-extrusion",this.layers,c,this.zoom,r)):this.addFeature(c,c.geometry,o,n,{},r.subdivisionGranularity),r.featureIndex.insert(i,c.geometry,o,s,this.index,!0)}}addFeatures(e,r,n){for(let i of this.features){let{geometry:a}=i;this.addFeature(i,a,i.index,r,n,e.subdivisionGranularity)}}update(e,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,wwe),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,bwe.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,r,n,i,a,o){for(let s of O5(r,Ewe)){let l={x:0,y:0,sampleCount:0},u=this.layoutVertexArray.length;this.processPolygon(l,i,e,s,o);let c=this.layoutVertexArray.length-u,h=Math.floor(l.x/l.sampleCount),d=Math.floor(l.y/l.sampleCount);for(let p=0;p<c;p++)this.centroidVertexArray.emplaceBack(h,d)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,a,i)}processPolygon(e,r,n,i,a){if(i.length<1||mF(i[0]))return;for(let h of i)h.length!==0&&Iwe(e,h);let o={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},s=a.fill.getGranularityForZoomLevel(r.z),l=Swe[n.type]==="Polygon";for(let h of i){if(h.length===0||mF(h))continue;let d=xk(h,s,l);this._generateSideFaces(d,o)}if(!l)return;let u=BH(i,r,s,!1),c=this.layoutVertexArray;zH((h,d)=>{ay(c,h,d,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,u.verticesFlattened,u.indicesTriangles)}_generateSideFaces(e,r){let n=0;for(let i=1;i<e.length;i++){let a=e[i],o=e[i-1];if(Cwe(a,o))continue;r.segment.vertexLength+4>Hn.MAX_VERTEX_ARRAY_LENGTH&&(r.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let s=a.sub(o)._perp()._unit(),l=o.dist(a);n+l>32768&&(n=0),ay(this.layoutVertexArray,a.x,a.y,s.x,s.y,0,0,n),ay(this.layoutVertexArray,a.x,a.y,s.x,s.y,0,1,n),n+=l,ay(this.layoutVertexArray,o.x,o.y,s.x,s.y,0,0,n),ay(this.layoutVertexArray,o.x,o.y,s.x,s.y,0,1,n);let u=r.segment.vertexLength;this.indexArray.emplaceBack(u,u+2,u+1),this.indexArray.emplaceBack(u+1,u+2,u+3),r.segment.vertexLength+=4,r.segment.primitiveLength+=2}}};function Iwe(t,e){for(let r=0;r<e.length;r++){let n=e[r];r===e.length-1&&e[0].x===n.x&&e[0].y===n.y||(t.x+=n.x,t.y+=n.y,t.sampleCount++)}}Mt("FillExtrusionBucket",RH,{omit:["layers","features"]});function Cwe(t,e){return t.x===e.x&&(t.x<0||t.x>8192)||t.y===e.y&&(t.y<0||t.y>8192)}function mF(t){return t.every(e=>e.x<0)||t.every(e=>e.x>8192)||t.every(e=>e.y<0)||t.every(e=>e.y>8192)}C();var gF,Mwe=()=>gF=gF||new Oa({"fill-extrusion-opacity":new It(Oe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Xt(Oe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new It(Oe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new It(Oe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new y3(Oe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Xt(Oe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Xt(Oe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new It(Oe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])}),Twe={get paint(){return Mwe()}},yM=Zt(xr(),1),Pwe=t=>t.type==="fill-extrusion",Dwe=class extends jl{constructor(e){super(e,Twe)}createBucket(e){return new RH(e)}queryRadius(){return w3(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:e,feature:r,featureState:n,geometry:i,transform:a,pixelsToTileUnits:o,pixelPosMatrix:s}){let l=A3(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-a.bearingInRadians,o),u=this.paint.get("fill-extrusion-height").evaluate(r,n),c=this.paint.get("fill-extrusion-base").evaluate(r,n),h=Bwe(l,s,0),d=Owe(i,c,u,s),p=d[0],m=d[1];return kwe(p,m,h)}};function oy(t,e){return t.x*e.x+t.y*e.y}function yF(t,e){if(t.length===1){let r=0,n=e[r++],i;for(;!i||n.equals(i);)if(i=e[r++],!i)return 1/0;for(;r<e.length;r++){let a=e[r],o=t[0],s=i.sub(n),l=a.sub(n),u=o.sub(n),c=oy(s,s),h=oy(s,l),d=oy(l,l),p=oy(u,s),m=oy(u,l),y=c*d-h*h,v=(d*p-h*m)/y,_=(c*m-h*p)/y,w=1-v-_,b=n.z*w+i.z*v+a.z*_;if(isFinite(b))return b}return 1/0}else{let r=1/0;for(let n of e)r=Math.min(r,n.z);return r}}function kwe(t,e,r){let n=1/0;wH(r,e)&&(n=yF(r,e[0]));for(let i=0;i<e.length;i++){let a=e[i],o=t[i];for(let s=0;s<a.length-1;s++){let l=a[s],u=a[s+1],c=o[s],h=o[s+1],d=[l,u,h,c,l];bH(r,d)&&(n=Math.min(n,yF(r,d)))}}return n===1/0?!1:n}function Owe(t,e,r,n){let i=[],a=[],o=n[8]*e,s=n[9]*e,l=n[10]*e,u=n[11]*e,c=n[8]*r,h=n[9]*r,d=n[10]*r,p=n[11]*r;for(let m of t){let y=[],v=[];for(let _ of m){let w=_.x,b=_.y,A=n[0]*w+n[4]*b+n[12],E=n[1]*w+n[5]*b+n[13],M=n[2]*w+n[6]*b+n[14],P=n[3]*w+n[7]*b+n[15],k=A+o,D=E+s,O=M+l,B=P+u,L=A+c,R=E+h,T=M+d,N=P+p,$=new yM.default(k/B,D/B);$.z=O/B,y.push($);let V=new yM.default(L/N,R/N);V.z=T/N,v.push(V)}i.push(y),a.push(v)}return[i,a]}function Bwe(t,e,r){let n=[];for(let i of t){let a=[i.x,i.y,r,1];Pi.transformMat4(a,a,e),n.push(new yM.default(a[0]/a[3],a[1]/a[3]))}return n}C();C();C();var zwe=Si([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Fwe}=zwe;C();var Rwe=Si([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Lwe}=Rwe,Nwe=Zt(XA(),1),$we=Nwe.default.VectorTileFeature.types,vF=63,Uwe=Math.cos(75/2*(Math.PI/180)),jwe=15,Vwe=20,Gwe=15,LH=1/2,_F=Math.pow(2,Gwe-1)/LH,NH=class{constructor(e){this.zoom=e.zoom,this.globalState=e.globalState,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new Kbe,this.layoutVertexArray2=new Qbe,this.indexArray=new Vl,this.programConfigurations=new $p(e.layers,e.zoom),this.segments=new Hn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,n){this.hasPattern=yk("line",this.layers,r);let i=this.layers[0].layout.get("line-sort-key"),a=!i.isConstant(),o=[];for(let{feature:s,id:l,index:u,sourceLayerIndex:c}of e){let h=this.layers[0]._featureFilter.needGeometry,d=Kp(s,h);if(!this.layers[0]._featureFilter.filter(new Fi(this.zoom,{globalState:this.globalState}),d,n))continue;let p=a?i.evaluate(d,{},n):void 0,m={id:l,properties:s.properties,type:s.type,sourceLayerIndex:c,index:u,geometry:h?d.geometry:Jp(s),patterns:{},sortKey:p};o.push(m)}a&&o.sort((s,l)=>s.sortKey-l.sortKey);for(let s of o){let{geometry:l,index:u,sourceLayerIndex:c}=s;if(this.hasPattern){let d=vk("line",this.layers,s,this.zoom,r);this.patternFeatures.push(d)}else this.addFeature(s,l,u,n,{},r.subdivisionGranularity);let h=e[u].feature;r.featureIndex.insert(h,l,u,c,this.index)}}update(e,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n)}addFeatures(e,r,n){for(let i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,r,n,e.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Lwe)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Fwe),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end")){let r=+e.properties.mapbox_clip_start,n=+e.properties.mapbox_clip_end;return{start:r,end:n}}}addFeature(e,r,n,i,a,o){let s=this.layers[0].layout,l=s.get("line-join").evaluate(e,{}),u=s.get("line-cap"),c=s.get("line-miter-limit"),h=s.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(let d of r)this.addLine(d,e,l,u,c,h,i,o);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,a,i)}addLine(e,r,n,i,a,o,s,l){this.distance=0,this.scaledDistance=0,this.totalDistance=0;let u=s?l.line.getGranularityForZoomLevel(s.z):1;if(e=xk(e,u),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let A=0;A<e.length-1;A++)this.totalDistance+=e[A].dist(e[A+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let c=$we[r.type]==="Polygon",h=e.length;for(;h>=2&&e[h-1].equals(e[h-2]);)h--;let d=0;for(;d<h-1&&e[d].equals(e[d+1]);)d++;if(h<(c?3:2))return;n==="bevel"&&(a=1.05);let p=this.overscaling<=16?jwe*8192/(512*this.overscaling):0,m=this.segments.prepareSegment(h*10,this.layoutVertexArray,this.indexArray),y,v,_,w,b;this.e1=this.e2=-1,c&&(y=e[h-2],b=e[d].sub(y)._unit()._perp());for(let A=d;A<h;A++){if(_=A===h-1?c?e[d+1]:void 0:e[A+1],_&&e[A].equals(_))continue;b&&(w=b),y&&(v=y),y=e[A],b=_?_.sub(y)._unit()._perp():w,w=w||b;let E=w.add(b);(E.x!==0||E.y!==0)&&E._unit();let M=w.x*b.x+w.y*b.y,P=E.x*b.x+E.y*b.y,k=P!==0?1/P:1/0,D=2*Math.sqrt(2-2*P),O=P<Uwe&&v&&_,B=w.x*b.y-w.y*b.x>0;if(O&&A>d){let T=y.dist(v);if(T>2*p){let N=y.sub(y.sub(v)._mult(p/T)._round());this.updateDistance(v,N),this.addCurrentVertex(N,w,0,0,m),v=N}}let L=v&&_,R=L?n:c?"butt":i;if(L&&R==="round"&&(k<o?R="miter":k<=2&&(R="fakeround")),R==="miter"&&k>a&&(R="bevel"),R==="bevel"&&(k>2&&(R="flipbevel"),k<a&&(R="miter")),v&&this.updateDistance(v,y),R==="miter")E._mult(k),this.addCurrentVertex(y,E,0,0,m);else if(R==="flipbevel"){if(k>100)E=b.mult(-1);else{let T=k*w.add(b).mag()/w.sub(b).mag();E._perp()._mult(T*(B?-1:1))}this.addCurrentVertex(y,E,0,0,m),this.addCurrentVertex(y,E.mult(-1),0,0,m)}else if(R==="bevel"||R==="fakeround"){let T=-Math.sqrt(k*k-1),N=B?T:0,$=B?0:T;if(v&&this.addCurrentVertex(y,w,N,$,m),R==="fakeround"){let V=Math.round(D*180/Math.PI/Vwe);for(let G=1;G<V;G++){let ee=G/V;if(ee!==.5){let me=ee-.5,Me=1.0904+M*(-3.2452+M*(3.55645-M*1.43519)),Ae=.848013+M*(-1.06021+M*.215638);ee=ee+ee*me*(ee-1)*(Me*me*me+Ae)}let ie=b.sub(w)._mult(ee)._add(w)._unit()._mult(B?-1:1);this.addHalfVertex(y,ie.x,ie.y,!1,B,0,m)}}_&&this.addCurrentVertex(y,b,-N,-$,m)}else if(R==="butt")this.addCurrentVertex(y,E,0,0,m);else if(R==="square"){let T=v?1:-1;this.addCurrentVertex(y,E,T,T,m)}else R==="round"&&(v&&(this.addCurrentVertex(y,w,0,0,m),this.addCurrentVertex(y,w,1,1,m,!0)),_&&(this.addCurrentVertex(y,b,-1,-1,m,!0),this.addCurrentVertex(y,b,0,0,m)));if(O&&A<h-1){let T=y.dist(_);if(T>2*p){let N=y.add(_.sub(y)._mult(p/T)._round());this.updateDistance(y,N),this.addCurrentVertex(N,b,0,0,m),y=N}}}}addCurrentVertex(e,r,n,i,a,o=!1){let s=r.x+r.y*n,l=r.y-r.x*n,u=-r.x+r.y*i,c=-r.y-r.x*i;this.addHalfVertex(e,s,l,o,!1,n,a),this.addHalfVertex(e,u,c,o,!0,-i,a),this.distance>_F/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,r,n,i,a,o))}addHalfVertex({x:e,y:r},n,i,a,o,s,l){let u=(this.lineClips?this.scaledDistance*(_F-1):this.scaledDistance)*LH;if(this.layoutVertexArray.emplaceBack((e<<1)+(a?1:0),(r<<1)+(o?1:0),Math.round(vF*n)+128,Math.round(vF*i)+128,(s===0?0:s<0?-1:1)+1|(u&63)<<2,u>>6),this.lineClips){let h=this.scaledDistance-this.lineClips.start,d=this.lineClips.end-this.lineClips.start,p=h/d;this.layoutVertexArray2.emplaceBack(p,this.lineClipsArray.length)}let c=l.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,c,this.e2),l.primitiveLength++),o?this.e2=c:this.e1=c}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,r){this.distance+=e.dist(r),this.updateScaledDistance()}};Mt("LineBucket",NH,{omit:["layers","patternFeatures"]});C();var xF,Zwe=()=>xF=xF||new Oa({"line-cap":new It(Oe.layout_line["line-cap"]),"line-join":new Xt(Oe.layout_line["line-join"]),"line-miter-limit":new It(Oe.layout_line["line-miter-limit"]),"line-round-limit":new It(Oe.layout_line["line-round-limit"]),"line-sort-key":new Xt(Oe.layout_line["line-sort-key"])}),bF,Wwe=()=>bF=bF||new Oa({"line-opacity":new Xt(Oe.paint_line["line-opacity"]),"line-color":new Xt(Oe.paint_line["line-color"]),"line-translate":new It(Oe.paint_line["line-translate"]),"line-translate-anchor":new It(Oe.paint_line["line-translate-anchor"]),"line-width":new Xt(Oe.paint_line["line-width"]),"line-gap-width":new Xt(Oe.paint_line["line-gap-width"]),"line-offset":new Xt(Oe.paint_line["line-offset"]),"line-blur":new Xt(Oe.paint_line["line-blur"]),"line-dasharray":new H5(Oe.paint_line["line-dasharray"]),"line-pattern":new y3(Oe.paint_line["line-pattern"]),"line-gradient":new v3(Oe.paint_line["line-gradient"])}),wF={get paint(){return Wwe()},get layout(){return Zwe()}},Hwe=class extends Xt{possiblyEvaluate(e,r){return r=new Fi(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(e,r)}evaluate(e,r,n,i){return r=zt({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(e,r,n,i)}},Vx,Xwe=t=>t.type==="line",qwe=class extends jl{constructor(e){super(e,wF),this.gradientVersion=0,Vx||(Vx=new Hwe(wF.paint.properties["line-width"].specification),Vx.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){let r=this.gradientExpression();nbe(r)?this.stepInterpolant=r._styleExpression.expression instanceof T5:this.stepInterpolant=!1,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,r){super.recalculate(e,r),this.paint._values["line-floorwidth"]=Vx.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new NH(e)}queryRadius(e){let r=e,n=AF(Nv("line-width",this,r),Nv("line-gap-width",this,r)),i=Nv("line-offset",this,r);return n/2+Math.abs(i)+w3(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:e,feature:r,featureState:n,geometry:i,transform:a,pixelsToTileUnits:o}){let s=A3(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-a.bearingInRadians,o),l=o/2*AF(this.paint.get("line-width").evaluate(r,n),this.paint.get("line-gap-width").evaluate(r,n)),u=this.paint.get("line-offset").evaluate(r,n);return u&&(i=w2e(i,u*o)),g2e(s,i,l)}isTileClipped(){return!0}};function AF(t,e){return e>0?e+2*t:t}C();C();C();var Ywe=Si([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Jwe=Si([{name:"a_projected_pos",components:3,type:"Float32"}],4);Si([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);var Kwe=Si([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Si([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);var SF=Si([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Qwe=Si([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Si([{name:"triangle",components:3,type:"Uint16"}]);Si([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]);Si([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]);Si([{type:"Float32",name:"offsetX"}]);Si([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);Si([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var Gx=Zt(xr(),1);C();function e4e(t,e,r){let n=e.layout.get("text-transform").evaluate(r,{});return n==="uppercase"?t=t.toLocaleUpperCase():n==="lowercase"&&(t=t.toLocaleLowerCase()),zg.applyArabicShaping&&(t=zg.applyArabicShaping(t)),t}function t4e(t,e,r){return t.sections.forEach(n=>{n.text=e4e(n.text,e,r)}),t}C();function r4e(t){let e={},r={},n=[],i=0;function a(u){n.push(t[u]),i++}function o(u,c,h){let d=r[u];return delete r[u],r[c]=d,n[d].geometry[0].pop(),n[d].geometry[0]=n[d].geometry[0].concat(h[0]),d}function s(u,c,h){let d=e[c];return delete e[c],e[u]=d,n[d].geometry[0].shift(),n[d].geometry[0]=h[0].concat(n[d].geometry[0]),d}function l(u,c,h){let d=h?c[0][c[0].length-1]:c[0][0];return"".concat(u,":").concat(d.x,":").concat(d.y)}for(let u=0;u<t.length;u++){let c=t[u],h=c.geometry,d=c.text?c.text.toString():null;if(!d){a(u);continue}let p=l(d,h),m=l(d,h,!0);if(p in r&&m in e&&r[p]!==e[m]){let y=s(p,m,h),v=o(p,m,n[y].geometry);delete e[p],delete r[m],r[l(d,n[v].geometry,!0)]=v,n[y].geometry=null}else p in r?o(p,m,h):m in e?s(p,m,h):(a(u),e[p]=i-1,r[m]=i-1)}return n.filter(u=>u.geometry)}C();C();var n4e={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};C();var $H=24;C();var i4e=Zt(yG(),1),EF=3;function a4e(t,e,r){t===1&&r.readMessage(o4e,e)}function o4e(t,e,r){if(t===3){let{id:n,bitmap:i,width:a,height:o,left:s,top:l,advance:u}=r.readMessage(s4e,{});e.push({id:n,bitmap:new gk({width:a+2*EF,height:o+2*EF},i),metrics:{width:a,height:o,left:s,top:l,advance:u}})}}function s4e(t,e,r){t===1?e.id=r.readVarint():t===2?e.bitmap=r.readBytes():t===3?e.width=r.readVarint():t===4?e.height=r.readVarint():t===5?e.left=r.readSVarint():t===6?e.top=r.readSVarint():t===7&&(e.advance=r.readVarint())}function l4e(t){return new i4e.default(t).readFields(a4e,[])}C();function u4e(t){let{userImage:e}=t;return e&&e.render&&e.render()?(t.data.replace(new Uint8Array(e.data.buffer)),!0):!1}C();C();function UH(t){let e=0,r=0;for(let o of t)e+=o.w*o.h,r=Math.max(r,o.w);t.sort((o,s)=>s.h-o.h);let n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}],i=0,a=0;for(let o of t)for(let s=n.length-1;s>=0;s--){let l=n[s];if(!(o.w>l.w||o.h>l.h)){if(o.x=l.x,o.y=l.y,a=Math.max(a,o.y+o.h),i=Math.max(i,o.x+o.w),o.w===l.w&&o.h===l.h){let u=n.pop();s<n.length&&(n[s]=u)}else o.h===l.h?(l.x+=o.w,l.w-=o.w):o.w===l.w?(l.y+=o.h,l.h-=o.h):(n.push({x:l.x+o.w,y:l.y,w:l.w-o.w,h:o.h}),l.y+=o.h,l.h-=o.h);break}}return{w:i,h:a,fill:e/(i*a)||0}}var $s=1,bk=class{constructor(t,{pixelRatio:e,version:r,stretchX:n,stretchY:i,content:a,textFitWidth:o,textFitHeight:s}){this.paddedRect=t,this.pixelRatio=e,this.stretchX=n,this.stretchY=i,this.content=a,this.version=r,this.textFitWidth=o,this.textFitHeight=s}get tl(){return[this.paddedRect.x+$s,this.paddedRect.y+$s]}get br(){return[this.paddedRect.x+this.paddedRect.w-$s,this.paddedRect.y+this.paddedRect.h-$s]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-$s*2)/this.pixelRatio,(this.paddedRect.h-$s*2)/this.pixelRatio]}},c4e=class{constructor(e,r){let n={},i={};this.haveRenderCallbacks=[];let a=[];this.addImages(e,n,a),this.addImages(r,i,a);let{w:o,h:s}=UH(a),l=new ti({width:o||1,height:s||1});for(let u in e){let c=e[u],h=n[u].paddedRect;ti.copy(c.data,l,{x:0,y:0},{x:h.x+$s,y:h.y+$s},c.data)}for(let u in r){let c=r[u],h=i[u].paddedRect,d=h.x+$s,p=h.y+$s,m=c.data.width,y=c.data.height;ti.copy(c.data,l,{x:0,y:0},{x:d,y:p},c.data),ti.copy(c.data,l,{x:0,y:y-1},{x:d,y:p-1},{width:m,height:1}),ti.copy(c.data,l,{x:0,y:0},{x:d,y:p+y},{width:m,height:1}),ti.copy(c.data,l,{x:m-1,y:0},{x:d-1,y:p},{width:1,height:y}),ti.copy(c.data,l,{x:0,y:0},{x:d+m,y:p},{width:1,height:y})}this.image=l,this.iconPositions=n,this.patternPositions=i}addImages(e,r,n){for(let i in e){let a=e[i],o={x:0,y:0,w:a.data.width+2*$s,h:a.data.height+2*$s};n.push(o),r[i]=new bk(o,a),a.hasRenderCallback&&this.haveRenderCallbacks.push(i)}}patchUpdatedImages(e,r){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let n in e.updatedImages)this.patchUpdatedImage(this.iconPositions[n],e.getImage(n),r),this.patchUpdatedImage(this.patternPositions[n],e.getImage(n),r)}patchUpdatedImage(e,r,n){if(!e||!r||e.version===r.version)return;e.version=r.version;let[i,a]=e.tl;n.update(r.data,void 0,{x:i,y:a})}};Mt("ImagePosition",bk);Mt("ImageAtlas",c4e);var jH=(t=>(t[t.none=0]="none",t[t.horizontal=1]="horizontal",t[t.vertical=2]="vertical",t[t.horizontalOnly=3]="horizontalOnly",t))(jH||{});function VH(t){let e=.5,r=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0;break}switch(t){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0;break}return{horizontalAlign:e,verticalAlign:r}}var h4e=Zt(XA(),1);C();var d4e=255,qb=128,IF=d4e*qb;function CF(t,e){let{expression:r}=e;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Fi(t+1))};if(r.kind==="source")return{kind:"source"};{let{zoomStops:n,interpolationType:i}=r,a=0;for(;a<n.length&&n[a]<=t;)a++;a=Math.max(0,a-1);let o=a;for(;o<n.length&&n[o]<t+1;)o++;o=Math.min(n.length-1,o);let s=n[a],l=n[o];if(r.kind==="composite")return{kind:"composite",minZoom:s,maxZoom:l,interpolationType:i};let u=r.evaluate(new Fi(s)),c=r.evaluate(new Fi(l));return{kind:"camera",minZoom:s,maxZoom:l,minSize:u,maxSize:c,interpolationType:i}}}function wk(t,{uSize:e,uSizeT:r},{lowerSize:n,upperSize:i}){return t.kind==="source"?n/qb:t.kind==="composite"?di.number(n/qb,i/qb,r):e}function S3(t,e){let r=0,n=0;if(t.kind==="constant")n=t.layoutSize;else if(t.kind!=="source"){let{interpolationType:i,minZoom:a,maxZoom:o}=t,s=i?on(zl.interpolationFactor(i,e,a,o),0,1):0;t.kind==="camera"?n=di.number(t.minSize,t.maxSize,s):r=s}return{uSizeT:r,uSize:n}}C();function P4(t,e,r){let n="never",i=t.get(e);return i?n=i:t.get(r)&&(n="always"),n}var p4e=h4e.default.VectorTileFeature.types,f4e=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Zx(t,e,r,n,i,a,o,s,l,u,c,h,d){let p=s?Math.min(IF,Math.round(s[0])):0,m=s?Math.min(IF,Math.round(s[1])):0;t.emplaceBack(e,r,Math.round(n*32),Math.round(i*32),a,o,(p<<1)+(l?1:0),m,u*16,c*16,h*256,d*256)}function w1(t,e,r){t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r)}function m4e(t){for(let e of t.sections)if(Lbe(e.text))return!0;return!1}var vM=class{constructor(e){this.layoutVertexArray=new e2e,this.indexArray=new Vl,this.programConfigurations=e,this.segments=new Hn,this.dynamicLayoutVertexArray=new t2e,this.opacityVertexArray=new r2e,this.hasVisibleVertices=!1,this.placedSymbolArray=new uH}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,r,n,i){this.isEmpty()||(n&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ywe.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Jwe.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,f4e,!0),this.opacityVertexBuffer.itemSize=1),(n||i)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}};Mt("SymbolBuffers",vM);var _M=class{constructor(e,r,n){this.layoutVertexArray=new e,this.layoutAttributes=r,this.indexArray=new n,this.segments=new Hn,this.collisionVertexArray=new i2e}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Kwe.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}};Mt("CollisionBuffers",_M);var Lg=class{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.globalState=e.globalState,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(s=>s.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];let r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=CF(this.zoom,r["text-size"]),this.iconSizeData=CF(this.zoom,r["icon-size"]);let n=this.layers[0].layout,i=n.get("symbol-sort-key"),a=n.get("symbol-z-order");this.canOverlap=P4(n,"text-overlap","text-allow-overlap")!=="never"||P4(n,"icon-overlap","icon-allow-overlap")!=="never"||n.get("text-ignore-placement")||n.get("icon-ignore-placement"),this.sortFeaturesByKey=a!=="viewport-y"&&!i.isConstant();let o=a==="viewport-y"||a==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=o&&this.canOverlap,n.get("symbol-placement")==="point"&&(this.writingModes=n.get("text-writing-mode").map(s=>jH[s])),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.sourceID=e.sourceID}createArrays(){this.text=new vM(new $p(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new vM(new $p(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new dH,this.lineVertexArray=new pH,this.symbolInstances=new hH,this.textAnchorOffsets=new mH}calculateGlyphDependencies(e,r,n,i,a){for(let o=0;o<e.length;o++)if(r[e.charCodeAt(o)]=!0,(n||i)&&a){let s=n4e[e.charAt(o)];s&&(r[s.charCodeAt(0)]=!0)}}populate(e,r,n){let i=this.layers[0],a=i.layout,o=a.get("text-font"),s=a.get("text-field"),l=a.get("icon-image"),u=(s.value.kind!=="constant"||s.value.value instanceof Uc&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&(o.value.kind!=="constant"||o.value.value.length>0),c=l.value.kind!=="constant"||!!l.value.value||Object.keys(l.parameters).length>0,h=a.get("symbol-sort-key");if(this.features=[],!u&&!c)return;let d=r.iconDependencies,p=r.glyphDependencies,m=r.availableImages,y=new Fi(this.zoom,{globalState:this.globalState});for(let{feature:v,id:_,index:w,sourceLayerIndex:b}of e){let A=i._featureFilter.needGeometry,E=Kp(v,A);if(!i._featureFilter.filter(y,E,n))continue;A||(E.geometry=Jp(v));let M;if(u){let O=i.getValueAndResolveTokens("text-field",E,n,m),B=Uc.factory(O),L=this.hasRTLText=this.hasRTLText||m4e(B);(!L||zg.getRTLTextPluginStatus()==="unavailable"||L&&zg.isParsed())&&(M=t4e(B,i,E))}let P;if(c){let O=i.getValueAndResolveTokens("icon-image",E,n,m);O instanceof Mu?P=O:P=Mu.fromString(O)}if(!M&&!P)continue;let k=this.sortFeaturesByKey?h.evaluate(E,{},n):void 0,D={id:_,text:M,icon:P,index:w,sourceLayerIndex:b,geometry:E.geometry,properties:v.properties,type:p4e[v.type],sortKey:k};if(this.features.push(D),P&&(d[P.name]=!0),M){let O=o.evaluate(E,{},n).join(","),B=a.get("text-rotation-alignment")!=="viewport"&&a.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(2)>=0;for(let L of M.sections)if(L.image)d[L.image.name]=!0;else{let R=Pbe(M.toString()),T=L.fontStack||O,N=p[T]=p[T]||{};this.calculateGlyphDependencies(L.text,N,B,this.allowVerticalPlacement,R)}}}a.get("symbol-placement")==="line"&&(this.features=r4e(this.features)),this.sortFeaturesByKey&&this.features.sort((v,_)=>v.sortKey-_.sortKey)}update(e,r,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,r,this.layers,n),this.icon.programConfigurations.updatePaintArrays(e,r,this.layers,n))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,r){let n=this.lineVertexArray.length;if(e.segment!==void 0){let i=e.dist(r[e.segment+1]),a=e.dist(r[e.segment]),o={};for(let s=e.segment+1;s<r.length;s++)o[s]={x:r[s].x,y:r[s].y,tileUnitDistanceFromAnchor:i},s<r.length-1&&(i+=r[s+1].dist(r[s]));for(let s=e.segment||0;s>=0;s--)o[s]={x:r[s].x,y:r[s].y,tileUnitDistanceFromAnchor:a},s>0&&(a+=r[s-1].dist(r[s]));for(let s=0;s<r.length;s++){let l=o[s];this.lineVertexArray.emplaceBack(l.x,l.y,l.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}addSymbols(e,r,n,i,a,o,s,l,u,c,h,d){let p=e.indexArray,m=e.layoutVertexArray,y=e.segments.prepareSegment(4*r.length,m,p,this.canOverlap?o.sortKey:void 0),v=this.glyphOffsetArray.length,_=y.vertexLength,w=this.allowVerticalPlacement&&s===2?Math.PI/2:0,b=o.text&&o.text.sections;for(let A=0;A<r.length;A++){let{tl:E,tr:M,bl:P,br:k,tex:D,pixelOffsetTL:O,pixelOffsetBR:B,minFontScaleX:L,minFontScaleY:R,glyphOffset:T,isSDF:N,sectionIndex:$}=r[A],V=y.vertexLength,G=T[1];Zx(m,l.x,l.y,E.x,G+E.y,D.x,D.y,n,N,O.x,O.y,L,R),Zx(m,l.x,l.y,M.x,G+M.y,D.x+D.w,D.y,n,N,B.x,O.y,L,R),Zx(m,l.x,l.y,P.x,G+P.y,D.x,D.y+D.h,n,N,O.x,B.y,L,R),Zx(m,l.x,l.y,k.x,G+k.y,D.x+D.w,D.y+D.h,n,N,B.x,B.y,L,R),w1(e.dynamicLayoutVertexArray,l,w),p.emplaceBack(V,V+2,V+1),p.emplaceBack(V+1,V+2,V+3),y.vertexLength+=4,y.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(T[0]),(A===r.length-1||$!==r[A+1].sectionIndex)&&e.programConfigurations.populatePaintArrays(m.length,o,o.index,{},d,b&&b[$])}e.placedSymbolArray.emplaceBack(l.x,l.y,v,this.glyphOffsetArray.length-v,_,u,c,l.segment,n?n[0]:0,n?n[1]:0,i[0],i[1],s,0,!1,0,h)}_addCollisionDebugVertex(e,r,n,i,a,o){return r.emplaceBack(0,0),e.emplaceBack(n.x,n.y,i,a,Math.round(o.x),Math.round(o.y))}addCollisionDebugVertices(e,r,n,i,a,o,s){let l=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),u=l.vertexLength,c=a.layoutVertexArray,h=a.collisionVertexArray,d=s.anchorX,p=s.anchorY;this._addCollisionDebugVertex(c,h,o,d,p,new Gx.default(e,r)),this._addCollisionDebugVertex(c,h,o,d,p,new Gx.default(n,r)),this._addCollisionDebugVertex(c,h,o,d,p,new Gx.default(n,i)),this._addCollisionDebugVertex(c,h,o,d,p,new Gx.default(e,i)),l.vertexLength+=4;let m=a.indexArray;m.emplaceBack(u,u+1),m.emplaceBack(u+1,u+2),m.emplaceBack(u+2,u+3),m.emplaceBack(u+3,u),l.primitiveLength+=4}addDebugCollisionBoxes(e,r,n,i){for(let a=e;a<r;a++){let o=this.collisionBoxArray.get(a),s=o.x1,l=o.y1,u=o.x2,c=o.y2;this.addCollisionDebugVertices(s,l,u,c,i?this.textCollisionBox:this.iconCollisionBox,o.anchorPoint,n)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new _M(Kz,SF.members,lM),this.iconCollisionBox=new _M(Kz,SF.members,lM);for(let e=0;e<this.symbolInstances.length;e++){let r=this.symbolInstances.get(e);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(e,r,n,i,a,o,s,l,u){let c={};for(let h=r;h<n;h++){let d=e.get(h);c.textBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY},c.textFeatureIndex=d.featureIndex;break}for(let h=i;h<a;h++){let d=e.get(h);c.verticalTextBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY},c.verticalTextFeatureIndex=d.featureIndex;break}for(let h=o;h<s;h++){let d=e.get(h);c.iconBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY},c.iconFeatureIndex=d.featureIndex;break}for(let h=l;h<u;h++){let d=e.get(h);c.verticalIconBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY},c.verticalIconFeatureIndex=d.featureIndex;break}return c}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){let n=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,r){let n=e.placedSymbolArray.get(r),i=n.vertexStartIndex+n.numGlyphs*4;for(let a=n.vertexStartIndex;a<i;a+=4)e.indexArray.emplaceBack(a,a+2,a+1),e.indexArray.emplaceBack(a+1,a+2,a+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let r=Math.sin(e),n=Math.cos(e),i=[],a=[],o=[];for(let s=0;s<this.symbolInstances.length;++s){o.push(s);let l=this.symbolInstances.get(s);i.push(Math.round(r*l.anchorX+n*l.anchorY)|0),a.push(l.featureIndex)}return o.sort((s,l)=>i[s]-i[l]||a[l]-a[s]),o}addToSortKeyRanges(e,r){let n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===r?n.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let r of this.symbolInstanceIndexes){let n=this.symbolInstances.get(r);this.featureSortOrder.push(n.featureIndex),[n.rightJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.leftJustifiedTextSymbolIndex].forEach((i,a,o)=>{i>=0&&o.indexOf(i)===a&&this.addIndicesForPlacedSymbol(this.text,i)}),n.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,n.verticalPlacedTextSymbolIndex),n.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,n.placedIconSymbolIndex),n.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,n.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}};Mt("SymbolBucket",Lg,{omit:["layers","collisionBoxArray","features","compareText"]});Lg.MAX_GLYPHS=65535;Lg.addDynamicAttributes=w1;C();function g4e(t,e){return e.replace(/{([^{}]+)}/g,(r,n)=>t&&n in t?String(t[n]):"")}C();var MF,y4e=()=>MF=MF||new Oa({"symbol-placement":new It(Oe.layout_symbol["symbol-placement"]),"symbol-spacing":new It(Oe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new It(Oe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Xt(Oe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new It(Oe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new It(Oe.layout_symbol["icon-allow-overlap"]),"icon-overlap":new It(Oe.layout_symbol["icon-overlap"]),"icon-ignore-placement":new It(Oe.layout_symbol["icon-ignore-placement"]),"icon-optional":new It(Oe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new It(Oe.layout_symbol["icon-rotation-alignment"]),"icon-size":new Xt(Oe.layout_symbol["icon-size"]),"icon-text-fit":new It(Oe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new It(Oe.layout_symbol["icon-text-fit-padding"]),"icon-image":new Xt(Oe.layout_symbol["icon-image"]),"icon-rotate":new Xt(Oe.layout_symbol["icon-rotate"]),"icon-padding":new Xt(Oe.layout_symbol["icon-padding"]),"icon-keep-upright":new It(Oe.layout_symbol["icon-keep-upright"]),"icon-offset":new Xt(Oe.layout_symbol["icon-offset"]),"icon-anchor":new Xt(Oe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new It(Oe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new It(Oe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new It(Oe.layout_symbol["text-rotation-alignment"]),"text-field":new Xt(Oe.layout_symbol["text-field"]),"text-font":new Xt(Oe.layout_symbol["text-font"]),"text-size":new Xt(Oe.layout_symbol["text-size"]),"text-max-width":new Xt(Oe.layout_symbol["text-max-width"]),"text-line-height":new It(Oe.layout_symbol["text-line-height"]),"text-letter-spacing":new Xt(Oe.layout_symbol["text-letter-spacing"]),"text-justify":new Xt(Oe.layout_symbol["text-justify"]),"text-radial-offset":new Xt(Oe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new It(Oe.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Xt(Oe.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Xt(Oe.layout_symbol["text-anchor"]),"text-max-angle":new It(Oe.layout_symbol["text-max-angle"]),"text-writing-mode":new It(Oe.layout_symbol["text-writing-mode"]),"text-rotate":new Xt(Oe.layout_symbol["text-rotate"]),"text-padding":new It(Oe.layout_symbol["text-padding"]),"text-keep-upright":new It(Oe.layout_symbol["text-keep-upright"]),"text-transform":new Xt(Oe.layout_symbol["text-transform"]),"text-offset":new Xt(Oe.layout_symbol["text-offset"]),"text-allow-overlap":new It(Oe.layout_symbol["text-allow-overlap"]),"text-overlap":new It(Oe.layout_symbol["text-overlap"]),"text-ignore-placement":new It(Oe.layout_symbol["text-ignore-placement"]),"text-optional":new It(Oe.layout_symbol["text-optional"])}),TF,v4e=()=>TF=TF||new Oa({"icon-opacity":new Xt(Oe.paint_symbol["icon-opacity"]),"icon-color":new Xt(Oe.paint_symbol["icon-color"]),"icon-halo-color":new Xt(Oe.paint_symbol["icon-halo-color"]),"icon-halo-width":new Xt(Oe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Xt(Oe.paint_symbol["icon-halo-blur"]),"icon-translate":new It(Oe.paint_symbol["icon-translate"]),"icon-translate-anchor":new It(Oe.paint_symbol["icon-translate-anchor"]),"text-opacity":new Xt(Oe.paint_symbol["text-opacity"]),"text-color":new Xt(Oe.paint_symbol["text-color"],{runtimeType:Bl,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new Xt(Oe.paint_symbol["text-halo-color"]),"text-halo-width":new Xt(Oe.paint_symbol["text-halo-width"]),"text-halo-blur":new Xt(Oe.paint_symbol["text-halo-blur"]),"text-translate":new It(Oe.paint_symbol["text-translate"]),"text-translate-anchor":new It(Oe.paint_symbol["text-translate-anchor"])}),kE={get paint(){return v4e()},get layout(){return y4e()}};C();var GH=class{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:n_,this.defaultValue=e}evaluate(e){if(e.formattedSection){let r=this.defaultValue.property.overrides;if(r&&r.hasOverride(e.formattedSection))return r.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){if(!this.defaultValue.isConstant()){let r=this.defaultValue.value;e(r._styleExpression.expression)}}outputDefined(){return!1}serialize(){return null}};Mt("FormatSectionOverride",GH,{omit:["defaultValue"]});var _4e=t=>t.type==="symbol",x4e=class xM extends jl{constructor(e){super(e,kE)}recalculate(e,r){if(super.recalculate(e,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){let n=this.layout.get("text-writing-mode");if(n){let i=[];for(let a of n)i.indexOf(a)<0&&i.push(a);this.layout._values["text-writing-mode"]=i}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,r,n,i){let a=this.layout.get(e).evaluate(r,{},n,i),o=this._unevaluatedLayout._values[e];return!o.isDataDriven()&&!c3(o.value)&&a?g4e(r.properties,a):a}createBucket(e){return new Lg(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let e of kE.paint.overridableProperties){if(!xM.hasPaintOverride(this.layout,e))continue;let r=this.paint.get(e),n=new GH(r),i=new $5(n,r.property.specification),a=null;r.value.kind==="constant"||r.value.kind==="source"?a=new f1("source",i):a=new I4("composite",i,r.value.zoomStops),this.paint._values[e]=new Pl(r.property,a,r.parameters)}}_handleOverridablePaintPropertyUpdate(e,r,n){return!this.layout||r.isDataDriven()||n.isDataDriven()?!1:xM.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,r){let n=e.get("text-field"),i=kE.paint.properties[r],a=!1,o=s=>{for(let l of s)if(i.overrides&&i.overrides.hasOverride(l)){a=!0;return}};if(n.value.kind==="constant"&&n.value.value instanceof Uc)o(n.value.value.sections);else if(n.value.kind==="source"){let s=u=>{if(!a)if(u instanceof h1&&ji(u.value)===i_){let c=u.value;o(c.sections)}else u instanceof AW?o(u.sections):u.eachChild(s)},l=n.value;l._styleExpression&&s(l._styleExpression.expression)}return a}};C();C();var PF,b4e=()=>PF=PF||new Oa({"background-color":new It(Oe.paint_background["background-color"]),"background-pattern":new H5(Oe.paint_background["background-pattern"]),"background-opacity":new It(Oe.paint_background["background-opacity"])}),w4e={get paint(){return b4e()}},A4e=t=>t.type==="background",S4e=class extends jl{constructor(e){super(e,w4e)}};C();C();var DF,E4e=()=>DF=DF||new Oa({"raster-opacity":new It(Oe.paint_raster["raster-opacity"]),"raster-hue-rotate":new It(Oe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new It(Oe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new It(Oe.paint_raster["raster-brightness-max"]),"raster-saturation":new It(Oe.paint_raster["raster-saturation"]),"raster-contrast":new It(Oe.paint_raster["raster-contrast"]),"raster-resampling":new It(Oe.paint_raster["raster-resampling"]),"raster-fade-duration":new It(Oe.paint_raster["raster-fade-duration"])}),I4e={get paint(){return E4e()}},C4e=t=>t.type==="raster",M4e=class extends jl{constructor(e){super(e,I4e)}};C();function T4e(t){let e=[],r=t.id;return r===void 0&&e.push({message:"layers.".concat(r,': missing required property "id"')}),t.render===void 0&&e.push({message:"layers.".concat(r,': missing required method "render"')}),t.renderingMode&&t.renderingMode!=="2d"&&t.renderingMode!=="3d"&&e.push({message:"layers.".concat(r,': property "renderingMode" must be either "2d" or "3d"')}),e}var P4e=t=>t.type==="custom",D4e=class extends jl{constructor(e){super(e,{}),this.onAdd=r=>{this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},this.onRemove=r=>{this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}};function OE(t){if(t.type==="custom")return new D4e(t);switch(t.type){case"background":return new S4e(t);case"circle":return new M2e(t);case"color-relief":return new j2e(t);case"fill":return new _we(t);case"fill-extrusion":return new Dwe(t);case"heatmap":return new O2e(t);case"hillshade":return new R2e(t);case"line":return new qwe(t);case"raster":return new M4e(t);case"symbol":return new x4e(t)}}C();C();function Yb(t){let e=[];if(typeof t=="string")e.push({id:"default",url:t});else if(t&&t.length>0){let r=[];for(let{id:n,url:i}of t){let a="".concat(n).concat(i);r.indexOf(a)===-1&&(r.push(a),e.push({id:n,url:i}))}}return e}function kF(t,e,r){try{let n=new URL(t);return n.pathname+="".concat(e).concat(r),n.toString()}catch{throw new Error('Invalid sprite URL "'.concat(t,'", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically'))}}async function k4e(t,e,r,n){let i=Yb(t),a=r>1?"@2x":"",o={},s={};for(let{id:l,url:u}of i){let c=e.transformRequest(kF(u,a,".json"),"SpriteJSON");o[l]=QA(c,n);let h=e.transformRequest(kF(u,a,".png"),"SpriteImage");s[l]=Au.getImage(h,n)}return await Promise.all([...Object.values(o),...Object.values(s)]),O4e(o,s)}async function O4e(t,e){let r={};for(let n in t){r[n]={};let i=Dr.getImageCanvasContext((await e[n]).data),a=(await t[n]).data;for(let o in a){let{width:s,height:l,x:u,y:c,sdf:h,pixelRatio:d,stretchX:p,stretchY:m,content:y,textFitWidth:v,textFitHeight:_}=a[o],w={width:s,height:l,x:u,y:c,context:i};r[n][o]={data:null,pixelRatio:d,sdf:h,stretchX:p,stretchY:m,content:y,textFitWidth:v,textFitHeight:_,spriteData:w}}}return r}C();var Wx=1,B4e=class extends Xo{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new ti({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(let{ids:r,promiseResolve:n}of this.requestors)n(this._getImagesForIds(r));this.requestors=[]}}getImage(e){let r=this.images[e];if(r&&!r.data&&r.spriteData){let n=r.spriteData;r.data=new ti({width:n.width,height:n.height},n.context.getImageData(n.x,n.y,n.width,n.height).data),r.spriteData=null}return r}addImage(e,r){if(this.images[e])throw new Error("Image id ".concat(e," already exist, use updateImage instead"));this._validate(e,r)&&(this.images[e]=r)}_validate(e,r){let n=!0,i=r.data||r.spriteData;return this._validateStretch(r.stretchX,i&&i.width)||(this.fire(new Jt(new Error('Image "'.concat(e,'" has invalid "stretchX" value')))),n=!1),this._validateStretch(r.stretchY,i&&i.height)||(this.fire(new Jt(new Error('Image "'.concat(e,'" has invalid "stretchY" value')))),n=!1),this._validateContent(r.content,r)||(this.fire(new Jt(new Error('Image "'.concat(e,'" has invalid "content" value')))),n=!1),n}_validateStretch(e,r){if(!e)return!0;let n=0;for(let i of e){if(i[0]<n||i[1]<i[0]||r<i[1])return!1;n=i[1]}return!0}_validateContent(e,r){if(!e)return!0;if(e.length!==4)return!1;let n=r.spriteData,i=n&&n.width||r.data.width,a=n&&n.height||r.data.height;return!(e[0]<0||i<e[0]||e[1]<0||a<e[1]||e[2]<0||i<e[2]||e[3]<0||a<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,r,n=!0){let i=this.getImage(e);if(n&&(i.data.width!==r.data.width||i.data.height!==r.data.height))throw new Error("size mismatch between old image (".concat(i.data.width,"x").concat(i.data.height,") and new image (").concat(r.data.width,"x").concat(r.data.height,")."));r.version=i.version+1,this.images[e]=r,this.updatedImages[e]=!0}removeImage(e){let r=this.images[e];delete this.images[e],delete this.patterns[e],r.userImage&&r.userImage.onRemove&&r.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((r,n)=>{let i=!0;if(!this.isLoaded())for(let a of e)this.images[a]||(i=!1);this.isLoaded()||i?r(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:r})})}_getImagesForIds(e){let r={};for(let n of e){let i=this.getImage(n);i||(this.fire(new ht("styleimagemissing",{id:n})),i=this.getImage(n)),i?r[n]={data:i.data.clone(),pixelRatio:i.pixelRatio,sdf:i.sdf,version:i.version,stretchX:i.stretchX,stretchY:i.stretchY,content:i.content,textFitWidth:i.textFitWidth,textFitHeight:i.textFitHeight,hasRenderCallback:!!(i.userImage&&i.userImage.render)}:Ui('Image "'.concat(n,'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.'))}return r}getPixelSize(){let{width:e,height:r}=this.atlasImage;return{width:e,height:r}}getPattern(e){let r=this.patterns[e],n=this.getImage(e);if(!n)return null;if(r&&r.position.version===n.version)return r.position;if(r)r.position.version=n.version;else{let i=n.data.width+Wx*2,a=n.data.height+Wx*2,o={w:i,h:a,x:0,y:0},s=new bk(o,n);this.patterns[e]={bin:o,position:s}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){let r=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ki(e,this.atlasImage,r.RGBA),this.atlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}_updatePatternAtlas(){let e=[];for(let a in this.patterns)e.push(this.patterns[a].bin);let{w:r,h:n}=UH(e),i=this.atlasImage;i.resize({width:r||1,height:n||1});for(let a in this.patterns){let{bin:o}=this.patterns[a],s=o.x+Wx,l=o.y+Wx,u=this.getImage(a).data,c=u.width,h=u.height;ti.copy(u,i,{x:0,y:0},{x:s,y:l},{width:c,height:h}),ti.copy(u,i,{x:0,y:h-1},{x:s,y:l-1},{width:c,height:1}),ti.copy(u,i,{x:0,y:0},{x:s,y:l+h},{width:c,height:1}),ti.copy(u,i,{x:c-1,y:0},{x:s-1,y:l},{width:1,height:h}),ti.copy(u,i,{x:0,y:0},{x:s+c,y:l},{width:1,height:h})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(let r of e){if(this.callbackDispatchedThisFrame[r])continue;this.callbackDispatchedThisFrame[r]=!0;let n=this.getImage(r);n||Ui('Image with ID: "'.concat(r,'" was not found')),u4e(n)&&this.updateImage(r,n)}}};C();C();async function z4e(t,e,r,n){let i=e*256,a=i+255,o=n.transformRequest(r.replace("{fontstack}",t).replace("{range}","".concat(i,"-").concat(a)),"Glyphs"),s=await O1e(o,new AbortController);if(!s||!s.data)throw new Error("Could not load glyph range. range: ".concat(e,", ").concat(i,"-").concat(a));let l={};for(let u of l4e(s.data))l[u.id]=u;return l}C();var F4e=class{constructor({fontSize:e=24,buffer:r=3,radius:n=8,cutoff:i=.25,fontFamily:a="sans-serif",fontWeight:o="normal",fontStyle:s="normal"}={}){this.buffer=r,this.cutoff=i,this.radius=n;let l=this.size=e+r*4,u=this._createCanvas(l),c=this.ctx=u.getContext("2d",{willReadFrequently:!0});c.font="".concat(s," ").concat(o," ").concat(e,"px ").concat(a),c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(l*l),this.gridInner=new Float64Array(l*l),this.f=new Float64Array(l),this.z=new Float64Array(l+1),this.v=new Uint16Array(l)}_createCanvas(e){let r=document.createElement("canvas");return r.width=r.height=e,r}draw(e){let{width:r,actualBoundingBoxAscent:n,actualBoundingBoxDescent:i,actualBoundingBoxLeft:a,actualBoundingBoxRight:o}=this.ctx.measureText(e),s=Math.ceil(n),l=0,u=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-a))),c=Math.min(this.size-this.buffer,s+Math.ceil(i)),h=u+2*this.buffer,d=c+2*this.buffer,p=Math.max(h*d,0),m=new Uint8ClampedArray(p),y={data:m,width:h,height:d,glyphWidth:u,glyphHeight:c,glyphTop:s,glyphLeft:l,glyphAdvance:r};if(u===0||c===0)return y;let{ctx:v,buffer:_,gridInner:w,gridOuter:b}=this;v.clearRect(_,_,u,c),v.fillText(e,_,_+s);let A=v.getImageData(_,_,u,c);b.fill(1e20,0,p),w.fill(0,0,p);for(let E=0;E<c;E++)for(let M=0;M<u;M++){let P=A.data[4*(E*u+M)+3]/255;if(P===0)continue;let k=(E+_)*h+M+_;if(P===1)b[k]=0,w[k]=1e20;else{let D=.5-P;b[k]=D>0?D*D:0,w[k]=D<0?D*D:0}}OF(b,0,0,h,d,h,this.f,this.v,this.z),OF(w,_,_,u,c,h,this.f,this.v,this.z);for(let E=0;E<p;E++){let M=Math.sqrt(b[E])-Math.sqrt(w[E]);m[E]=Math.round(255-255*(M/this.radius+this.cutoff))}return y}};function OF(t,e,r,n,i,a,o,s,l){for(let u=e;u<e+n;u++)BF(t,r*a+u,a,i,o,s,l);for(let u=r;u<r+i;u++)BF(t,u*a+e,1,n,o,s,l)}function BF(t,e,r,n,i,a,o){a[0]=0,o[0]=-1e20,o[1]=1e20,i[0]=t[e];for(let s=1,l=0,u=0;s<n;s++){i[s]=t[e+s*r];let c=s*s;do{let h=a[l];u=(i[s]-i[h]+c-h*h)/(s-h)/2}while(u<=o[l]&&--l>-1);l++,a[l]=s,o[l]=u,o[l+1]=1e20}for(let s=0,l=0;s<n;s++){for(;o[l+1]<s;)l++;let u=a[l],c=s-u;t[e+s*r]=i[u]+c*c}}var bM=class wM{constructor(e,r){this.requestManager=e,this.localIdeographFontFamily=r,this.entries={}}setURL(e){this.url=e}async getGlyphs(e){let r=[];for(let a in e)for(let o of e[a])r.push(this._getAndCacheGlyphsPromise(a,o));let n=await Promise.all(r),i={};for(let{stack:a,id:o,glyph:s}of n)i[a]||(i[a]={}),i[a][o]=s&&{id:s.id,bitmap:s.bitmap.clone(),metrics:s.metrics};return i}async _getAndCacheGlyphsPromise(e,r){let n=this.entries[e];n||(n=this.entries[e]={glyphs:{},requests:{},ranges:{}});let i=n.glyphs[r];if(i!==void 0)return{stack:e,id:r,glyph:i};if(i=this._tinySDF(n,e,r),i)return n.glyphs[r]=i,{stack:e,id:r,glyph:i};let a=Math.floor(r/256);if(a*256>65535)throw new Error("glyphs > 65535 not supported");if(n.ranges[a])return{stack:e,id:r,glyph:i};if(!this.url)throw new Error("glyphsUrl is not set");if(!n.requests[a]){let s=wM.loadGlyphRange(e,a,this.url,this.requestManager);n.requests[a]=s}let o=await n.requests[a];for(let s in o)this._doesCharSupportLocalGlyph(+s)||(n.glyphs[+s]=o[+s]);return n.ranges[a]=!0,{stack:e,id:r,glyph:o[r]||null}}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||ia["CJK Unified Ideographs"](e)||ia["Hangul Syllables"](e)||ia.Hiragana(e)||ia.Katakana(e)||ia["CJK Symbols and Punctuation"](e)||ia["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,r,n){let i=this.localIdeographFontFamily;if(!i||!this._doesCharSupportLocalGlyph(n))return;let a=2,o=e.tinySDF;if(!o){let l="400";/bold/i.test(r)?l="900":/medium/i.test(r)?l="500":/light/i.test(r)&&(l="200"),o=e.tinySDF=new wM.TinySDF({fontSize:24*a,buffer:3*a,radius:8*a,cutoff:.25,fontFamily:i,fontWeight:l})}let s=o.draw(String.fromCharCode(n));return{id:n,bitmap:new gk({width:s.width||30*a,height:s.height||30*a},s.data),metrics:{width:s.glyphWidth/a||24,height:s.glyphHeight/a||24,left:s.glyphLeft/a+.5||0,top:s.glyphTop/a-27.5||-8,advance:s.glyphAdvance/a||24,isDoubleResolution:!0}}}};bM.loadGlyphRange=z4e,bM.TinySDF=F4e;var R4e=bM;C();var L4e=class{constructor(){this.specification=Oe.light.position}possiblyEvaluate(e,r){return m1e(e.expression.evaluate(r))}interpolate(e,r,n){return{x:di.number(e.x,r.x,n),y:di.number(e.y,r.y,n),z:di.number(e.z,r.z,n)}}},zF="-transition",BE,N4e=class extends Xo{constructor(e){super(),BE=BE||new Oa({anchor:new It(Oe.light.anchor),position:new L4e,color:new It(Oe.light.color),intensity:new It(Oe.light.intensity)}),this._transitionable=new m3(BE),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,r={}){if(!this._validate(Ebe,e,r))for(let n in e){let i=e[n];n.endsWith(zF)?this._transitionable.setTransition(n.slice(0,-zF.length),i):this._transitionable.setValue(n,i)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,n){return n&&n.validate===!1?!1:p3(this,e.call(Ni,{value:r,style:{glyphs:!0,sprite:!0},styleSpec:Oe}))}};C();var $4e=new Oa({"sky-color":new It(Oe.sky["sky-color"]),"horizon-color":new It(Oe.sky["horizon-color"]),"fog-color":new It(Oe.sky["fog-color"]),"fog-ground-blend":new It(Oe.sky["fog-ground-blend"]),"horizon-fog-blend":new It(Oe.sky["horizon-fog-blend"]),"sky-horizon-blend":new It(Oe.sky["sky-horizon-blend"]),"atmosphere-blend":new It(Oe.sky["atmosphere-blend"])}),FF="-transition",U4e=class extends Xo{constructor(e){super(),this._transitionable=new m3($4e),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new Fi(0))}setSky(e,r={}){if(!this._validate(Ibe,e,r)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(let n in e){let i=e[n];n.endsWith(FF)?this._transitionable.setTransition(n.slice(0,-FF.length),i):this._transitionable.setValue(n,i)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,n={}){return n?.validate===!1?!1:p3(this,e.call(Ni,zt({value:r,style:{glyphs:!0,sprite:!0},styleSpec:Oe})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}};C();var j4e=class{constructor(e,r){this.width=e,this.height=r,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,r){let n=e.join(",")+String(r);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(e,r)),this.dashEntry[n]}getDashRanges(e,r,n){let i=e.length%2===1,a=[],o=i?-e[e.length-1]*n:0,s=e[0]*n,l=!0;a.push({left:o,right:s,isDash:l,zeroLength:e[0]===0});let u=e[0];for(let c=1;c<e.length;c++){l=!l;let h=e[c];o=u*n,u+=h,s=u*n,a.push({left:o,right:s,isDash:l,zeroLength:h===0})}return a}addRoundDash(e,r,n){let i=r/2;for(let a=-n;a<=n;a++){let o=this.nextRow+n+a,s=this.width*o,l=0,u=e[l];for(let c=0;c<this.width;c++){c/u.right>1&&(u=e[++l]);let h=Math.abs(c-u.left),d=Math.abs(c-u.right),p=Math.min(h,d),m,y=a/n*(i+1);if(u.isDash){let v=i-Math.abs(y);m=Math.sqrt(p*p+v*v)}else m=i-Math.sqrt(p*p+y*y);this.data[s+c]=Math.max(0,Math.min(255,m+128))}}}addRegularDash(e){for(let s=e.length-1;s>=0;--s){let l=e[s],u=e[s+1];l.zeroLength?e.splice(s,1):u&&u.isDash===l.isDash&&(u.left=l.left,e.splice(s,1))}let r=e[0],n=e[e.length-1];r.isDash===n.isDash&&(r.left=n.left-this.width,n.right=r.right+this.width);let i=this.width*this.nextRow,a=0,o=e[a];for(let s=0;s<this.width;s++){s/o.right>1&&(o=e[++a]);let l=Math.abs(s-o.left),u=Math.abs(s-o.right),c=Math.min(l,u),h=o.isDash?c:-c;this.data[i+s]=Math.max(0,Math.min(255,h+128))}}addDash(e,r){let n=r?7:0,i=2*n+1;if(this.nextRow+i>this.height)return Ui("LineAtlas out of space"),null;let a=0;for(let s=0;s<e.length;s++)a+=e[s];if(a!==0){let s=this.width/a,l=this.getDashRanges(e,this.width,s);r?this.addRoundDash(l,s,n):this.addRegularDash(l)}let o={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:a};return this.nextRow+=i,this.dirty=!0,o}bind(e){let r=e.gl;this.texture?(r.bindTexture(r.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,r.texSubImage2D(r.TEXTURE_2D,0,0,0,this.width,this.height,r.ALPHA,r.UNSIGNED_BYTE,this.data))):(this.texture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,this.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texImage2D(r.TEXTURE_2D,0,r.ALPHA,this.width,this.height,0,r.ALPHA,r.UNSIGNED_BYTE,this.data))}};C();C();C();var V4e=class{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}},G4e={once:!0},Z4e=class{constructor(e,r){this.target=e,this.mapId=r,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new V4e(()=>this.process()),this.subscription=ZC(this.target,"message",n=>this.receive(n),!1),this.globalScope=Pg(self)?e:window}registerMessageHandler(e,r){this.messageHandlers[e]=r}sendAsync(e,r){return new Promise((n,i)=>{let a=Math.round(Math.random()*1e18).toString(36).substring(0,10),o=r?ZC(r.signal,"abort",()=>{o?.unsubscribe(),delete this.resolveRejects[a];let u={id:a,type:"<cancel>",origin:location.origin,targetMapId:e.targetMapId,sourceMapId:this.mapId};this.target.postMessage(u)},G4e):null;this.resolveRejects[a]={resolve:u=>{o?.unsubscribe(),n(u)},reject:u=>{o?.unsubscribe(),i(u)}};let s=[],l=lt(ae({},e),{id:a,sourceMapId:this.mapId,origin:location.origin,data:Rv(e.data,s)});this.target.postMessage(l,{transfer:s})})}receive(e){let r=e.data,n=r.id;if(!(r.origin!=="file://"&&location.origin!=="file://"&&r.origin!=="resource://android"&&location.origin!=="resource://android"&&r.origin!==location.origin)&&!(r.targetMapId&&this.mapId!==r.targetMapId)){if(r.type==="<cancel>"){delete this.tasks[n];let i=this.abortControllers[n];delete this.abortControllers[n],i&&i.abort();return}if(Pg(self)||r.mustQueue){this.tasks[n]=r,this.taskQueue.push(n),this.invoker.trigger();return}this.processTask(n,r)}}process(){if(this.taskQueue.length===0)return;let e=this.taskQueue.shift(),r=this.tasks[e];delete this.tasks[e],this.taskQueue.length>0&&this.invoker.trigger(),r&&this.processTask(e,r)}async processTask(e,r){if(r.type==="<response>"){let a=this.resolveRejects[e];if(delete this.resolveRejects[e],!a)return;r.error?a.reject(Lv(r.error)):a.resolve(Lv(r.data));return}if(!this.messageHandlers[r.type]){this.completeTask(e,new Error("Could not find a registered handler for ".concat(r.type,", map ID: ").concat(this.mapId,", available handlers: ").concat(Object.keys(this.messageHandlers).join(", "))));return}let n=Lv(r.data),i=new AbortController;this.abortControllers[e]=i;try{let a=await this.messageHandlers[r.type](r.sourceMapId,n,i);this.completeTask(e,null,a)}catch(a){this.completeTask(e,a)}}completeTask(e,r,n){let i=[];delete this.abortControllers[e];let a={id:e,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:r?Rv(r):null,data:Rv(n,i)};this.target.postMessage(a,{transfer:i})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}};C();C();C();C();var W4e=`(()=>{var Xy=Object.create;var Wi=Object.defineProperty,Hy=Object.defineProperties,Zy=Object.getOwnPropertyDescriptor,Jy=Object.getOwnPropertyDescriptors,Yy=Object.getOwnPropertyNames,lu=Object.getOwnPropertySymbols,Ky=Object.getPrototypeOf,cu=Object.prototype.hasOwnProperty,Qy=Object.prototype.propertyIsEnumerable;var uu=(t,e,r)=>e in t?Wi(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,$t=(t,e)=>{for(var r in e||(e={}))cu.call(e,r)&&uu(t,r,e[r]);if(lu)for(var r of lu(e))Qy.call(e,r)&&uu(t,r,e[r]);return t},Xi=(t,e)=>Hy(t,Jy(e));var ve=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),em=(t,e)=>{for(var r in e)Wi(t,r,{get:e[r],enumerable:!0})},tm=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Yy(e))!cu.call(t,i)&&i!==r&&Wi(t,i,{get:()=>e[i],enumerable:!(n=Zy(e,i))||n.enumerable});return t};var Y=(t,e,r)=>(r=t!=null?Xy(Ky(t)):{},tm(e||!t||!t.__esModule?Wi(r,"default",{value:t,enumerable:!0}):r,t));var ye=ve((x0,pu)=>{"use strict";pu.exports=dr;function dr(t,e){this.x=t,this.y=e}dr.prototype={clone:function(){return new dr(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,r=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),n=e*this.x-r*this.y,i=r*this.x+e*this.y;return this.x=n,this.y=i,this},_rotateAround:function(t,e){var r=Math.cos(t),n=Math.sin(t),i=e.x+r*(this.x-e.x)-n*(this.y-e.y),o=e.y+n*(this.x-e.x)+r*(this.y-e.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}};dr.convert=function(t){return t instanceof dr?t:Array.isArray(t)?new dr(t[0],t[1]):t}});var mu=ve((b0,yu)=>{"use strict";yu.exports=fu;function fu(t,e,r,n){this.cx=3*t,this.bx=3*(r-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=r,this.p2y=n}fu.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(e===void 0&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var r=t,n=0;n<8;n++){var i=this.sampleCurveX(r)-t;if(Math.abs(i)<e)return r;var o=this.sampleCurveDerivativeX(r);if(Math.abs(o)<1e-6)break;r=r-i/o}var a=0,s=1;for(r=t,n=0;n<20&&(i=this.sampleCurveX(r),!(Math.abs(i-t)<e));n++)t>i?a=r:s=r,r=(s-a)*.5+a;return r},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}}});var cp=ve((Hv,rl)=>{function kg(t,e){var r,n,i,o,a,s,l,u,c,p;for(r=t.length&3,n=t.length-r,i=e,a=3432918353,l=461845907,p=0;p<n;)c=t.charCodeAt(p)&255|(t.charCodeAt(++p)&255)<<8|(t.charCodeAt(++p)&255)<<16|(t.charCodeAt(++p)&255)<<24,++p,c=(c&65535)*a+(((c>>>16)*a&65535)<<16)&4294967295,c=c<<15|c>>>17,c=(c&65535)*l+(((c>>>16)*l&65535)<<16)&4294967295,i^=c,i=i<<13|i>>>19,o=(i&65535)*5+(((i>>>16)*5&65535)<<16)&4294967295,i=(o&65535)+27492+(((o>>>16)+58964&65535)<<16);switch(c=0,r){case 3:c^=(t.charCodeAt(p+2)&255)<<16;case 2:c^=(t.charCodeAt(p+1)&255)<<8;case 1:c^=t.charCodeAt(p)&255,c=(c&65535)*a+(((c>>>16)*a&65535)<<16)&4294967295,c=c<<15|c>>>17,c=(c&65535)*l+(((c>>>16)*l&65535)<<16)&4294967295,i^=c}return i^=t.length,i^=i>>>16,i=(i&65535)*2246822507+(((i>>>16)*2246822507&65535)<<16)&4294967295,i^=i>>>13,i=(i&65535)*3266489909+(((i>>>16)*3266489909&65535)<<16)&4294967295,i^=i>>>16,i>>>0}typeof rl<"u"&&(rl.exports=kg)});var pp=ve((Zv,nl)=>{function Fg(t,e){for(var r=t.length,n=e^r,i=0,o;r>=4;)o=t.charCodeAt(i)&255|(t.charCodeAt(++i)&255)<<8|(t.charCodeAt(++i)&255)<<16|(t.charCodeAt(++i)&255)<<24,o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16),o^=o>>>24,o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16),n=(n&65535)*1540483477+(((n>>>16)*1540483477&65535)<<16)^o,r-=4,++i;switch(r){case 3:n^=(t.charCodeAt(i+2)&255)<<16;case 2:n^=(t.charCodeAt(i+1)&255)<<8;case 1:n^=t.charCodeAt(i)&255,n=(n&65535)*1540483477+(((n>>>16)*1540483477&65535)<<16)}return n^=n>>>13,n=(n&65535)*1540483477+(((n>>>16)*1540483477&65535)<<16),n^=n>>>15,n>>>0}typeof nl!==void 0&&(nl.exports=Fg)});var il=ve((Jv,ia)=>{var fp=cp(),Eg=pp();ia.exports=fp;ia.exports.murmur3=fp;ia.exports.murmur2=Eg});var xl=ve((NS,Zp)=>{"use strict";var gx=ye();Zp.exports=zr;function zr(t,e,r,n,i){this.properties={},this.extent=r,this.type=0,this._pbf=t,this._geometry=-1,this._keys=n,this._values=i,t.readFields(xx,this,e)}function xx(t,e,r){t==1?e.id=r.readVarint():t==2?bx(r,e):t==3?e.type=r.readVarint():t==4&&(e._geometry=r.pos)}function bx(t,e){for(var r=t.readVarint()+t.pos;t.pos<r;){var n=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[n]=i}}zr.types=["Unknown","Point","LineString","Polygon"];zr.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,n=0,i=0,o=0,a=[],s;t.pos<e;){if(n<=0){var l=t.readVarint();r=l&7,n=l>>3}if(n--,r===1||r===2)i+=t.readSVarint(),o+=t.readSVarint(),r===1&&(s&&a.push(s),s=[]),s.push(new gx(i,o));else if(r===7)s&&s.push(s[0].clone());else throw new Error("unknown command "+r)}return s&&a.push(s),a};zr.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,n=0,i=0,o=0,a=1/0,s=-1/0,l=1/0,u=-1/0;t.pos<e;){if(n<=0){var c=t.readVarint();r=c&7,n=c>>3}if(n--,r===1||r===2)i+=t.readSVarint(),o+=t.readSVarint(),i<a&&(a=i),i>s&&(s=i),o<l&&(l=o),o>u&&(u=o);else if(r!==7)throw new Error("unknown command "+r)}return[a,l,s,u]};zr.prototype.toGeoJSON=function(t,e,r){var n=this.extent*Math.pow(2,r),i=this.extent*t,o=this.extent*e,a=this.loadGeometry(),s=zr.types[this.type],l,u;function c(y){for(var m=0;m<y.length;m++){var h=y[m],g=180-(h.y+o)*360/n;y[m]=[(h.x+i)*360/n-180,360/Math.PI*Math.atan(Math.exp(g*Math.PI/180))-90]}}switch(this.type){case 1:var p=[];for(l=0;l<a.length;l++)p[l]=a[l][0];a=p,c(a);break;case 2:for(l=0;l<a.length;l++)c(a[l]);break;case 3:for(a=vx(a),l=0;l<a.length;l++)for(u=0;u<a[l].length;u++)c(a[l][u]);break}a.length===1?a=a[0]:s="Multi"+s;var f={type:"Feature",geometry:{type:s,coordinates:a},properties:this.properties};return"id"in this&&(f.id=this.id),f};function vx(t){var e=t.length;if(e<=1)return[t];for(var r=[],n,i,o=0;o<e;o++){var a=Px(t[o]);a!==0&&(i===void 0&&(i=a<0),i===a<0?(n&&r.push(n),n=[t[o]]):n.push(t[o]))}return n&&r.push(n),r}function Px(t){for(var e=0,r=0,n=t.length,i=n-1,o,a;r<n;i=r++)o=t[r],a=t[i],e+=(a.x-o.x)*(o.y+a.y);return e}});var bl=ve((US,Yp)=>{"use strict";var Sx=xl();Yp.exports=Jp;function Jp(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(wx,this,e),this.length=this._features.length}function wx(t,e,r){t===15?e.version=r.readVarint():t===1?e.name=r.readString():t===5?e.extent=r.readVarint():t===2?e._features.push(r.pos):t===3?e._keys.push(r.readString()):t===4&&e._values.push(Ax(r))}function Ax(t){for(var e=null,r=t.readVarint()+t.pos;t.pos<r;){var n=t.readVarint()>>3;e=n===1?t.readString():n===2?t.readFloat():n===3?t.readDouble():n===4?t.readVarint64():n===5?t.readVarint():n===6?t.readSVarint():n===7?t.readBoolean():null}return e}Jp.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new Sx(this._pbf,e,this.extent,this._keys,this._values)}});var Qp=ve(($S,Kp)=>{"use strict";var _x=bl();Kp.exports=Ix;function Ix(t,e){this.layers=t.readFields(Tx,{},e)}function Tx(t,e,r){if(t===3){var n=new _x(r,r.readVarint()+r.pos);n.length&&(e[n.name]=n)}}});var Rt=ve((jS,Sa)=>{Sa.exports.VectorTile=Qp();Sa.exports.VectorTileFeature=xl();Sa.exports.VectorTileLayer=bl()});var Pf=ve(Al=>{Al.read=function(t,e,r,n,i){var o,a,s=i*8-n-1,l=(1<<s)-1,u=l>>1,c=-7,p=r?i-1:0,f=r?-1:1,y=t[e+p];for(p+=f,o=y&(1<<-c)-1,y>>=-c,c+=s;c>0;o=o*256+t[e+p],p+=f,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=n;c>0;a=a*256+t[e+p],p+=f,c-=8);if(o===0)o=1-u;else{if(o===l)return a?NaN:(y?-1:1)*(1/0);a=a+Math.pow(2,n),o=o-u}return(y?-1:1)*a*Math.pow(2,o-n)};Al.write=function(t,e,r,n,i,o){var a,s,l,u=o*8-i-1,c=(1<<u)-1,p=c>>1,f=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=n?0:o-1,m=n?1:-1,h=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+p>=1?e+=f/l:e+=f*Math.pow(2,1-p),e*l>=2&&(a++,l/=2),a+p>=c?(s=0,a=c):a+p>=1?(s=(e*l-1)*Math.pow(2,i),a=a+p):(s=e*Math.pow(2,p-1)*Math.pow(2,i),a=0));i>=8;t[r+y]=s&255,y+=m,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;t[r+y]=a&255,y+=m,a/=256,u-=8);t[r+y-m]|=h*128}});var hi=ve((PA,If)=>{"use strict";If.exports=J;var Ta=Pf();function J(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}J.Varint=0;J.Fixed64=1;J.Bytes=2;J.Fixed32=5;var _l=65536*65536,Sf=1/_l,Wx=12,_f=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");J.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,o=this.pos;this.type=n&7,t(i,e,this),this.pos===o&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Ca(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Af(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Ca(this.buf,this.pos)+Ca(this.buf,this.pos+4)*_l;return this.pos+=8,t},readSFixed64:function(){var t=Ca(this.buf,this.pos)+Af(this.buf,this.pos+4)*_l;return this.pos+=8,t},readFloat:function(){var t=Ta.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Ta.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e=this.buf,r,n;return n=e[this.pos++],r=n&127,n<128||(n=e[this.pos++],r|=(n&127)<<7,n<128)||(n=e[this.pos++],r|=(n&127)<<14,n<128)||(n=e[this.pos++],r|=(n&127)<<21,n<128)?r:(n=e[this.pos],r|=(n&15)<<28,Xx(r,t,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2===1?(t+1)/-2:t/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=Wx&&_f?sb(this.buf,e,t):ab(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==J.Bytes)return t.push(this.readVarint(e));var r=mt(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==J.Bytes)return t.push(this.readSVarint());var e=mt(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==J.Bytes)return t.push(this.readBoolean());var e=mt(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==J.Bytes)return t.push(this.readFloat());var e=mt(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==J.Bytes)return t.push(this.readDouble());var e=mt(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==J.Bytes)return t.push(this.readFixed32());var e=mt(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==J.Bytes)return t.push(this.readSFixed32());var e=mt(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==J.Bytes)return t.push(this.readFixed64());var e=mt(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==J.Bytes)return t.push(this.readSFixed64());var e=mt(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=t&7;if(e===J.Varint)for(;this.buf[this.pos++]>127;);else if(e===J.Bytes)this.pos=this.readVarint()+this.pos;else if(e===J.Fixed32)this.pos+=4;else if(e===J.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+e)},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Nr(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Nr(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Nr(this.buf,t&-1,this.pos),Nr(this.buf,Math.floor(t*Sf),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Nr(this.buf,t&-1,this.pos),Nr(this.buf,Math.floor(t*Sf),this.pos+4),this.pos+=8},writeVarint:function(t){if(t=+t||0,t>268435455||t<0){Hx(t,this);return}this.realloc(4),this.buf[this.pos++]=t&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=t>>>7&127)))},writeSVarint:function(t){this.writeVarint(t<0?-t*2-1:t*2)},writeBoolean:function(t){this.writeVarint(!!t)},writeString:function(t){t=String(t),this.realloc(t.length*4),this.pos++;var e=this.pos;this.pos=lb(this.buf,t,this.pos);var r=this.pos-e;r>=128&&wf(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),Ta.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Ta.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var n=this.pos-r;n>=128&&wf(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,r){this.writeTag(t,J.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Yx,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Kx,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,tb,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,Qx,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,eb,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,rb,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,nb,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,ib,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,ob,e)},writeBytesField:function(t,e){this.writeTag(t,J.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,J.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,J.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,J.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,J.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,J.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,J.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,J.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,J.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,J.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,!!e)}};function Xx(t,e,r){var n=r.buf,i,o;if(o=n[r.pos++],i=(o&112)>>4,o<128||(o=n[r.pos++],i|=(o&127)<<3,o<128)||(o=n[r.pos++],i|=(o&127)<<10,o<128)||(o=n[r.pos++],i|=(o&127)<<17,o<128)||(o=n[r.pos++],i|=(o&127)<<24,o<128)||(o=n[r.pos++],i|=(o&1)<<31,o<128))return Gr(t,i,e);throw new Error("Expected varint not more than 10 bytes")}function mt(t){return t.type===J.Bytes?t.readVarint()+t.pos:t.pos+1}function Gr(t,e,r){return r?e*4294967296+(t>>>0):(e>>>0)*4294967296+(t>>>0)}function Hx(t,e){var r,n;if(t>=0?(r=t%4294967296|0,n=t/4294967296|0):(r=~(-t%4294967296),n=~(-t/4294967296),r^4294967295?r=r+1|0:(r=0,n=n+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),Zx(r,n,e),Jx(n,e)}function Zx(t,e,r){r.buf[r.pos++]=t&127|128,t>>>=7,r.buf[r.pos++]=t&127|128,t>>>=7,r.buf[r.pos++]=t&127|128,t>>>=7,r.buf[r.pos++]=t&127|128,t>>>=7,r.buf[r.pos]=t&127}function Jx(t,e){var r=(t&7)<<4;e.buf[e.pos++]|=r|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127)))))}function wf(t,e,r){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(Math.LN2*7));r.realloc(n);for(var i=r.pos-1;i>=t;i--)r.buf[i+n]=r.buf[i]}function Yx(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function Kx(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function Qx(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function eb(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function tb(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function rb(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function nb(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function ib(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function ob(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function Ca(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+t[e+3]*16777216}function Nr(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function Af(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function ab(t,e,r){for(var n="",i=e;i<r;){var o=t[i],a=null,s=o>239?4:o>223?3:o>191?2:1;if(i+s>r)break;var l,u,c;s===1?o<128&&(a=o):s===2?(l=t[i+1],(l&192)===128&&(a=(o&31)<<6|l&63,a<=127&&(a=null))):s===3?(l=t[i+1],u=t[i+2],(l&192)===128&&(u&192)===128&&(a=(o&15)<<12|(l&63)<<6|u&63,(a<=2047||a>=55296&&a<=57343)&&(a=null))):s===4&&(l=t[i+1],u=t[i+2],c=t[i+3],(l&192)===128&&(u&192)===128&&(c&192)===128&&(a=(o&15)<<18|(l&63)<<12|(u&63)<<6|c&63,(a<=65535||a>=1114112)&&(a=null))),a===null?(a=65533,s=1):a>65535&&(a-=65536,n+=String.fromCharCode(a>>>10&1023|55296),a=56320|a&1023),n+=String.fromCharCode(a),i+=s}return n}function sb(t,e,r){return _f.decode(t.subarray(e,r))}function lb(t,e,r){for(var n=0,i,o;n<e.length;n++){if(i=e.charCodeAt(n),i>55295&&i<57344)if(o)if(i<56320){t[r++]=239,t[r++]=191,t[r++]=189,o=i;continue}else i=o-55296<<10|i-56320|65536,o=null;else{i>56319||n+1===e.length?(t[r++]=239,t[r++]=191,t[r++]=189):o=i;continue}else o&&(t[r++]=239,t[r++]=191,t[r++]=189,o=null);i<128?t[r++]=i:(i<2048?t[r++]=i>>6|192:(i<65536?t[r++]=i>>12|224:(t[r++]=i>>18|240,t[r++]=i>>12&63|128),t[r++]=i>>6&63|128),t[r++]=i&63|128)}return r}});var Sy=ve((yT,Py)=>{Py.exports=Ya;function Ya(t,e){var r=t&&t.type,n;if(r==="FeatureCollection")for(n=0;n<t.features.length;n++)Ya(t.features[n],e);else if(r==="GeometryCollection")for(n=0;n<t.geometries.length;n++)Ya(t.geometries[n],e);else if(r==="Feature")Ya(t.geometry,e);else if(r==="Polygon")by(t.coordinates,e);else if(r==="MultiPolygon")for(n=0;n<t.coordinates.length;n++)by(t.coordinates[n],e);return t}function by(t,e){if(t.length!==0){vy(t[0],e);for(var r=1;r<t.length;r++)vy(t[r],!e)}}function vy(t,e){for(var r=0,n=0,i=0,o=t.length,a=o-1;i<o;a=i++){var s=(t[i][0]-t[a][0])*(t[a][1]+t[i][1]),l=r+s;n+=Math.abs(r)>=Math.abs(s)?r-l+s:s-l+r,r=l}r+n>=0!=!!e&&t.reverse()}});var Iy=ve((dT,_y)=>{"use strict";var Zb=ye(),Jb=Rt().VectorTileFeature;_y.exports=Ay;function Ay(t,e){this.options=e||{},this.features=t,this.length=t.length}Ay.prototype.feature=function(t){return new Qa(this.features[t],this.options.extent)};function Qa(t,e){this.id=typeof t.id=="number"?t.id:void 0,this.type=t.type,this.rawGeometry=t.type===1?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}Qa.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var e=0;e<t.length;e++){for(var r=t[e],n=[],i=0;i<r.length;i++)n.push(new Zb(r[i][0],r[i][1]));this.geometry.push(n)}return this.geometry};Qa.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,r=-1/0,n=1/0,i=-1/0,o=0;o<t.length;o++)for(var a=t[o],s=0;s<a.length;s++){var l=a[s];e=Math.min(e,l.x),r=Math.max(r,l.x),n=Math.min(n,l.y),i=Math.max(i,l.y)}return[e,n,r,i]};Qa.prototype.toGeoJSON=Jb.prototype.toGeoJSON});var ky=ve((gT,Di)=>{var Yb=hi(),Cy=Iy();Di.exports=jl;Di.exports.fromVectorTileJs=jl;Di.exports.fromGeojsonVt=Kb;Di.exports.GeoJSONWrapper=Cy;function jl(t){var e=new Yb;return Qb(t,e),e.finish()}function Kb(t,e){e=e||{};var r={};for(var n in t)r[n]=new Cy(t[n].features,e),r[n].name=n,r[n].version=e.version,r[n].extent=e.extent;return jl({layers:r})}function Qb(t,e){for(var r in t.layers)e.writeMessage(3,e0,t.layers[r])}function e0(t,e){e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var r,n={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<t.length;r++)n.feature=t.feature(r),e.writeMessage(2,t0,n);var i=n.keys;for(r=0;r<i.length;r++)e.writeStringField(3,i[r]);var o=n.values;for(r=0;r<o.length;r++)e.writeMessage(4,i0,o[r])}function t0(t,e){var r=t.feature;r.id!==void 0&&e.writeVarintField(1,r.id),e.writeMessage(2,r0,t),e.writeVarintField(3,r.type),e.writeMessage(4,n0,r)}function r0(t,e){var r=t.feature,n=t.keys,i=t.values,o=t.keycache,a=t.valuecache;for(var s in r.properties){var l=r.properties[s],u=o[s];if(l!==null){typeof u>"u"&&(n.push(s),u=n.length-1,o[s]=u),e.writeVarint(u);var c=typeof l;c!=="string"&&c!=="boolean"&&c!=="number"&&(l=JSON.stringify(l));var p=c+":"+l,f=a[p];typeof f>"u"&&(i.push(l),f=i.length-1,a[p]=f),e.writeVarint(f)}}}function $l(t,e){return(e<<3)+(t&7)}function Ty(t){return t<<1^t>>31}function n0(t,e){for(var r=t.loadGeometry(),n=t.type,i=0,o=0,a=r.length,s=0;s<a;s++){var l=r[s],u=1;n===1&&(u=l.length),e.writeVarint($l(1,u));for(var c=n===3?l.length-1:l.length,p=0;p<c;p++){p===1&&n!==1&&e.writeVarint($l(2,c-1));var f=l[p].x-i,y=l[p].y-o;e.writeVarint(Ty(f)),e.writeVarint(Ty(y)),i+=f,o+=y}n===3&&e.writeVarint($l(7,1))}}function i0(t,e){var r=typeof t;r==="string"?e.writeStringField(1,t):r==="boolean"?e.writeBooleanField(7,t):r==="number"&&(t%1!==0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}});var Vm=Y(ye(),1),Iu=Y(mu(),1);var cs;function hu(){return cs==null&&(cs=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),cs}var Hi;function du(){if(Hi==null&&(Hi=!1,hu())){let r=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(r){for(let i=0;i<5*5;i++){let o=i*4;r.fillStyle="rgb(".concat(o,",").concat(o+1,",").concat(o+2,")"),r.fillRect(i%5,Math.floor(i/5),1,1)}let n=r.getImageData(0,0,5,5).data;for(let i=0;i<5*5*4;i++)if(i%4!==3&&n[i]!==i){Hi=!0;break}}}return Hi||!1}var Yr=1e-6,Kr=typeof Float32Array<"u"?Float32Array:Array,Qr=Math.random;var w0=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Zi={};em(Zi,{add:()=>sm,ceil:()=>lm,clone:()=>nm,copy:()=>om,create:()=>gu,cross:()=>bm,dist:()=>Em,distance:()=>Pu,div:()=>Fm,divide:()=>vu,dot:()=>xm,equals:()=>Tm,exactEquals:()=>Im,floor:()=>um,forEach:()=>Bm,fromValues:()=>im,inverse:()=>dm,len:()=>Lm,length:()=>wu,lerp:()=>vm,max:()=>pm,min:()=>cm,mul:()=>km,multiply:()=>bu,negate:()=>hm,normalize:()=>gm,random:()=>Pm,round:()=>fm,scale:()=>ym,scaleAndAdd:()=>mm,set:()=>am,sqrDist:()=>Mm,sqrLen:()=>Dm,squaredDistance:()=>Su,squaredLength:()=>Au,str:()=>_m,sub:()=>Cm,subtract:()=>xu,transformMat4:()=>Sm,transformQuat:()=>wm,zero:()=>Am});function gu(){var t=new Kr(4);return Kr!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function nm(t){var e=new Kr(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function im(t,e,r,n){var i=new Kr(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i}function om(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function am(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t}function sm(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function xu(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function bu(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function vu(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function lm(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function um(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function cm(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t}function pm(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t}function fm(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function ym(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function mm(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t}function Pu(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.hypot(r,n,i,o)}function Su(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return r*r+n*n+i*i+o*o}function wu(t){var e=t[0],r=t[1],n=t[2],i=t[3];return Math.hypot(e,r,n,i)}function Au(t){var e=t[0],r=t[1],n=t[2],i=t[3];return e*e+r*r+n*n+i*i}function hm(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function dm(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function gm(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r*r+n*n+i*i+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=r*a,t[1]=n*a,t[2]=i*a,t[3]=o*a,t}function xm(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function bm(t,e,r,n){var i=r[0]*n[1]-r[1]*n[0],o=r[0]*n[2]-r[2]*n[0],a=r[0]*n[3]-r[3]*n[0],s=r[1]*n[2]-r[2]*n[1],l=r[1]*n[3]-r[3]*n[1],u=r[2]*n[3]-r[3]*n[2],c=e[0],p=e[1],f=e[2],y=e[3];return t[0]=p*u-f*l+y*s,t[1]=-(c*u)+f*a-y*o,t[2]=c*l-p*a+y*i,t[3]=-(c*s)+p*o-f*i,t}function vm(t,e,r,n){var i=e[0],o=e[1],a=e[2],s=e[3];return t[0]=i+n*(r[0]-i),t[1]=o+n*(r[1]-o),t[2]=a+n*(r[2]-a),t[3]=s+n*(r[3]-s),t}function Pm(t,e){e=e||1;var r,n,i,o,a,s;do r=Qr()*2-1,n=Qr()*2-1,a=r*r+n*n;while(a>=1);do i=Qr()*2-1,o=Qr()*2-1,s=i*i+o*o;while(s>=1);var l=Math.sqrt((1-a)/s);return t[0]=e*r,t[1]=e*n,t[2]=e*i*l,t[3]=e*o*l,t}function Sm(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*a,t[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*a,t[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*a,t[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*a,t}function wm(t,e,r){var n=e[0],i=e[1],o=e[2],a=r[0],s=r[1],l=r[2],u=r[3],c=u*n+s*o-l*i,p=u*i+l*n-a*o,f=u*o+a*i-s*n,y=-a*n-s*i-l*o;return t[0]=c*u+y*-a+p*-l-f*-s,t[1]=p*u+y*-s+f*-a-c*-l,t[2]=f*u+y*-l+c*-s-p*-a,t[3]=e[3],t}function Am(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function _m(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function Im(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function Tm(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=e[0],s=e[1],l=e[2],u=e[3];return Math.abs(r-a)<=Yr*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-s)<=Yr*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-l)<=Yr*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-u)<=Yr*Math.max(1,Math.abs(o),Math.abs(u))}var Cm=xu,km=bu,Fm=vu,Em=Pu,Mm=Su,Lm=wu,Dm=Au,Bm=function(){var t=gu();return function(e,r,n,i,o,a){var s,l;for(r||(r=4),n||(n=0),i?l=Math.min(i*r+n,e.length):l=e.length,s=n;s<l;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}();function Tu(t){if(t<=0)return 0;if(t>=1)return 1;let e=t*t,r=e*t;return 4*(t<.5?r:3*(t-e)+r-.75)}function Rm(t,e,r,n){let i=new Iu.default(t,e,r,n);return o=>i.solve(o)}var E0=Rm(.25,.1,.25,1);function it(t,e,r){return Math.min(r,Math.max(e,t))}function Cu(t,e,r){let n=r-e,i=((t-e)%n+n)%n+e;return i===e?r:i}function de(t,...e){for(let r of e)for(let n in r)t[n]=r[n];return t}function ku(t){return Math.log(t)/Math.LN2%1===0}function rn(t,e,r){let n={};for(let i in t)n[i]=e.call(r||this,t[i],i,t);return n}function Fu(t,e,r){let n={};for(let i in t)e.call(r||this,t[i],i,t)&&(n[i]=t[i]);return n}function nt(t){return Array.isArray(t)?t.map(nt):typeof t=="object"&&t?rn(t,nt):t}var _u={};function ce(t){_u[t]||(typeof console<"u"&&console.warn(t),_u[t]=!0)}function ot(t,e,r){return(r.y-t.y)*(e.x-t.x)>(e.y-t.y)*(r.x-t.x)}function at(t){return typeof WorkerGlobalScope<"u"&&typeof t<"u"&&t instanceof WorkerGlobalScope}function vt(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap}function zm(t,e,r,n,i){let o=Math.max(-e,0)*4,l=(Math.max(0,r)-r)*n*4+o,u=n*4,c=Math.max(0,e),p=Math.max(0,r),f=Math.min(t.width,e+n),y=Math.min(t.height,r+i);return{rect:{x:c,y:p,width:f-c,height:y-p},layout:[{offset:l,stride:u}]}}async function Om(t,e,r,n,i){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");let o=new VideoFrame(t,{timestamp:0});try{let a=o==null?void 0:o.format;if(!a||!(a.startsWith("BGR")||a.startsWith("RGB")))throw new Error("Unrecognized format ".concat(a));let s=a.startsWith("BGR"),l=new Uint8ClampedArray(n*i*4);if(await o.copyTo(l,zm(t,e,r,n,i)),s)for(let u=0;u<l.length;u+=4){let c=l[u];l[u]=l[u+2],l[u+2]=c}return l}finally{o.close()}}var en,tn;function Gm(t,e,r,n,i){let o=t.width,a=t.height;(!en||!tn)&&(en=new OffscreenCanvas(o,a),tn=en.getContext("2d",{willReadFrequently:!0})),en.width=o,en.height=a,tn.drawImage(t,0,0,o,a);let s=tn.getImageData(e,r,n,i);return tn.clearRect(0,0,o,a),s.data}async function Eu(t,e,r,n,i){if(du())try{return await Om(t,e,r,n,i)}catch(o){}return Gm(t,e,r,n,i)}function ps(t,e,r,n){return t.addEventListener(e,r,n),{unsubscribe:()=>{t.removeEventListener(e,r,n)}}}function fs(t){return t*Math.PI/180}var Ji=25,Yi=0;var jt=class t{constructor(e,r,n){let i=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;let a=new Int32Array(this.arrayBuffer);e=a[0],r=a[1],n=a[2],this.d=r+2*n;for(let u=0;u<this.d*this.d;u++){let c=a[3+u],p=a[3+u+1];i.push(c===p?null:a.subarray(c,p))}let s=a[3+i.length],l=a[3+i.length+1];this.keys=a.subarray(s,l),this.bboxes=a.subarray(l),this.insert=this._insertReadonly}else{this.d=r+2*n;for(let a=0;a<this.d*this.d;a++)i.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=e,this.padding=n,this.scale=r/e,this.uid=0;let o=n/r*e;this.min=-o,this.max=e+o}insert(e,r,n,i,o){this._forEachCell(r,n,i,o,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(o)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,r,n,i,o,a){this.cells[o].push(a)}query(e,r,n,i,o){let a=this.min,s=this.max;if(e<=a&&r<=a&&s<=n&&s<=i&&!o)return Array.prototype.slice.call(this.keys);{let l=[],u={};return this._forEachCell(e,r,n,i,this._queryCell,l,u,o),l}}_queryCell(e,r,n,i,o,a,s,l){let u=this.cells[o];if(u!==null){let c=this.keys,p=this.bboxes;for(let f=0;f<u.length;f++){let y=u[f];if(s[y]===void 0){let m=y*4;(l?l(p[m+0],p[m+1],p[m+2],p[m+3]):e<=p[m+2]&&r<=p[m+3]&&n>=p[m+0]&&i>=p[m+1])?(s[y]=!0,a.push(c[y])):s[y]=!1}}}}_forEachCell(e,r,n,i,o,a,s,l){let u=this._convertToCellCoord(e),c=this._convertToCellCoord(r),p=this._convertToCellCoord(n),f=this._convertToCellCoord(i);for(let y=u;y<=p;y++)for(let m=c;m<=f;m++){let h=this.d*m+y;if(!(l&&!l(this._convertFromCellCoord(y),this._convertFromCellCoord(m),this._convertFromCellCoord(y+1),this._convertFromCellCoord(m+1)))&&o.call(this,e,r,n,i,h,a,s,l))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let e=this.cells,r=3+this.cells.length+1+1,n=0;for(let a=0;a<this.cells.length;a++)n+=this.cells[a].length;let i=new Int32Array(r+n+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;let o=r;for(let a=0;a<e.length;a++){let s=e[a];i[3+a]=o,i.set(s,o),o+=s.length}return i[3+e.length]=o,i.set(this.keys,o),o+=this.keys.length,i[3+e.length+1]=o,i.set(this.bboxes,o),o+=this.bboxes.length,i.buffer}static serialize(e,r){let n=e.toArrayBuffer();return r&&r.push(n),{buffer:n}}static deserialize(e){return new t(e.buffer)}};var Nm=8,Um={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},$m={"*":{type:"source"}},jm=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],qm={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Wm={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Xm={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Hm={type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},Zm={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Jm={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Ym={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},Km=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],Qm={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},eh={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},th={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},rh={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},nh={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},ih={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},oh={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},ah={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},sh={type:"array",value:"*"},lh={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},uh={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},ch={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},ph={type:"array",value:"*",minimum:1},fh={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},yh={"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},mh={source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},hh={type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},dh=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],gh={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},xh={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},bh={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},vh={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Ph={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},Sh={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},wh={"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},Ah={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},_h={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},Ih={"*":{type:"string"}},P={$version:Nm,$root:Um,sources:$m,source:jm,source_vector:qm,source_raster:Wm,source_raster_dem:Xm,source_geojson:Hm,source_video:Zm,source_image:Jm,layer:Ym,layout:Km,layout_background:Qm,layout_fill:eh,layout_circle:th,layout_heatmap:rh,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:nh,layout_symbol:ih,layout_raster:oh,layout_hillshade:ah,"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:sh,filter_operator:lh,geometry_type:uh,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:ch,expression:ph,light:fh,sky:yh,terrain:mh,projection:hh,paint:dh,paint_fill:gh,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:xh,paint_circle:bh,paint_heatmap:vh,paint_symbol:Ph,paint_raster:Sh,paint_hillshade:wh,"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:Ah,transition:_h,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:Ih},Th=["type","source","source-layer","minzoom","maxzoom","filter","layout"];var C=class{constructor(e,r,n,i){this.message=(e?"".concat(e,": "):"")+n,i&&(this.identifier=i),r!=null&&r.__line__&&(this.line=r.__line__)}};function vr(t,...e){for(let r of e)for(let n in r)t[n]=r[n];return t}var Ve=class extends Error{constructor(e,r){super(r),this.message=r,this.key=e}},Ss=class t{constructor(e,r=[]){this.parent=e,this.bindings={};for(let[n,i]of r)this.bindings[n]=i}concat(e){return new t(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error("".concat(e," not found in scope."))}has(e){return this.bindings[e]?!0:this.parent?this.parent.has(e):!1}},Ar={kind:"null"},k={kind:"number"},$={kind:"string"},U={kind:"boolean"},ze={kind:"color"},go={kind:"projectionDefinition"},Xt={kind:"object"},N={kind:"value"},Ch={kind:"error"},xo={kind:"collator"},_r={kind:"formatted"},bo={kind:"padding"},sn={kind:"colorArray"},vo={kind:"numberArray"},Pn={kind:"resolvedImage"},Po={kind:"variableAnchorOffsetCollection"};function Ce(t,e){return{kind:"array",itemType:t,N:e}}function ie(t){if(t.kind==="array"){let e=ie(t.itemType);return typeof t.N=="number"?"array<".concat(e,", ").concat(t.N,">"):t.itemType.kind==="value"?"array":"array<".concat(e,">")}else return t.kind}var kh=[Ar,k,$,U,ze,go,_r,Xt,Ce(N),bo,vo,sn,Pn,Po];function ln(t,e){if(e.kind==="error")return null;if(t.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!ln(t.itemType,e.itemType))&&(typeof t.N!="number"||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if(t.kind==="value"){for(let r of kh)if(!ln(r,e))return null}}return"Expected ".concat(ie(t)," but found ").concat(ie(e)," instead.")}function Gs(t,e){return e.some(r=>r.kind===t.kind)}function Ht(t,e){return e.some(r=>r==="null"?t===null:r==="array"?Array.isArray(t):r==="object"?t&&!Array.isArray(t)&&typeof t=="object":r===typeof t)}function Pt(t,e){return t.kind==="array"&&e.kind==="array"?t.itemType.kind===e.itemType.kind&&typeof t.N=="number":t.kind===e.kind}var Ku=.96422,Qu=1,ec=.82521,tc=4/29,br=6/29,rc=3*br*br,Fh=br*br*br,Eh=Math.PI/180,Mh=180/Math.PI;function nc(t){return t=t%360,t<0&&(t+=360),t}function ic([t,e,r,n]){t=ys(t),e=ys(e),r=ys(r);let i,o,a=ms((.2225045*t+.7168786*e+.0606169*r)/Qu);t===e&&e===r?i=o=a:(i=ms((.4360747*t+.3850649*e+.1430804*r)/Ku),o=ms((.0139322*t+.0971045*e+.7141733*r)/ec));let s=116*a-16;return[s<0?0:s,500*(i-a),200*(a-o),n]}function ys(t){return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function ms(t){return t>Fh?Math.pow(t,1/3):t/rc+tc}function oc([t,e,r,n]){let i=(t+16)/116,o=isNaN(e)?i:i+e/500,a=isNaN(r)?i:i-r/200;return i=Qu*ds(i),o=Ku*ds(o),a=ec*ds(a),[hs(3.1338561*o-1.6168667*i-.4906146*a),hs(-.9787684*o+1.9161415*i+.033454*a),hs(.0719453*o-.2289914*i+1.4052427*a),n]}function hs(t){return t=t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055,t<0?0:t>1?1:t}function ds(t){return t>br?t*t*t:rc*(t-tc)}function Lh(t){let[e,r,n,i]=ic(t),o=Math.sqrt(r*r+n*n);return[Math.round(o*1e4)?nc(Math.atan2(n,r)*Mh):NaN,o,e,i]}function Dh([t,e,r,n]){return t=isNaN(t)?0:t*Eh,oc([r,Math.cos(t)*e,Math.sin(t)*e,n])}function Bh([t,e,r,n]){t=nc(t),e/=100,r/=100;function i(o){let a=(o+t/30)%12,s=e*Math.min(r,1-r);return r-s*Math.max(-1,Math.min(a-3,9-a,1))}return[i(0),i(8),i(4),n]}var Vh=Object.hasOwn||function(e,r){return Object.prototype.hasOwnProperty.call(e,r)};function on(t,e){return Vh(t,e)?t[e]:void 0}function Rh(t){if(t=t.toLowerCase().trim(),t==="transparent")return[0,0,0,0];let e=on(zh,t);if(e){let[i,o,a]=e;return[i/255,o/255,a/255,1]}if(t.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(t)){let o=t.length<6?1:2,a=1;return[Ki(t.slice(a,a+=o)),Ki(t.slice(a,a+=o)),Ki(t.slice(a,a+=o)),Ki(t.slice(a,a+o)||"ff")]}if(t.startsWith("rgb")){let i=/^rgba?\\(\\s*([\\de.+-]+)(%)?(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)(%)?(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)(%)?(?:\\s*([,\\/])\\s*([\\de.+-]+)(%)?)?\\s*\\)$/,o=t.match(i);if(o){let[a,s,l,u,c,p,f,y,m,h,g,d]=o,b=[u||" ",f||" ",h].join("");if(b==="  "||b==="  /"||b===",,"||b===",,,"){let x=[l,p,m].join(""),v=x==="%%%"?100:x===""?255:0;if(v){let S=[gr(+s/v,0,1),gr(+c/v,0,1),gr(+y/v,0,1),g?Mu(+g,d):1];if(Lu(S))return S}}return}}let r=/^hsla?\\(\\s*([\\de.+-]+)(?:deg)?(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)%(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)%(?:\\s*([,\\/])\\s*([\\de.+-]+)(%)?)?\\s*\\)$/,n=t.match(r);if(n){let[i,o,a,s,l,u,c,p,f]=n,y=[a||" ",l||" ",c].join("");if(y==="  "||y==="  /"||y===",,"||y===",,,"){let m=[+o,gr(+s,0,100),gr(+u,0,100),p?Mu(+p,f):1];if(Lu(m))return Bh(m)}}}function Ki(t){return parseInt(t.padEnd(2,t),16)/255}function Mu(t,e){return gr(e?t/100:t,0,1)}function gr(t,e,r){return Math.min(Math.max(e,t),r)}function Lu(t){return!t.some(Number.isNaN)}var zh={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function wt(t,e,r){return t+r*(e-t)}function Pr(t,e,r){return t.map((n,i)=>wt(n,e[i],r))}function Oh(t){return t==="rgb"||t==="hcl"||t==="lab"}var H=class t{constructor(e,r,n,i=1,o=!0){this.r=e,this.g=r,this.b=n,this.a=i,o||(this.r*=i,this.g*=i,this.b*=i,i||this.overwriteGetter("rgb",[e,r,n,i]))}static parse(e){if(e instanceof t)return e;if(typeof e!="string")return;let r=Rh(e);if(r)return new t(...r,!1)}get rgb(){let{r:e,g:r,b:n,a:i}=this,o=i||1/0;return this.overwriteGetter("rgb",[e/o,r/o,n/o,i])}get hcl(){return this.overwriteGetter("hcl",Lh(this.rgb))}get lab(){return this.overwriteGetter("lab",ic(this.rgb))}overwriteGetter(e,r){return Object.defineProperty(this,e,{value:r}),r}toString(){let[e,r,n,i]=this.rgb;return"rgba(".concat([e,r,n].map(o=>Math.round(o*255)).join(","),",").concat(i,")")}static interpolate(e,r,n,i="rgb"){switch(i){case"rgb":{let[o,a,s,l]=Pr(e.rgb,r.rgb,n);return new t(o,a,s,l,!1)}case"hcl":{let[o,a,s,l]=e.hcl,[u,c,p,f]=r.hcl,y,m;if(!isNaN(o)&&!isNaN(u)){let x=u-o;u>o&&x>180?x-=360:u<o&&o-u>180&&(x+=360),y=o+n*x}else isNaN(o)?isNaN(u)?y=NaN:(y=u,(s===1||s===0)&&(m=c)):(y=o,(p===1||p===0)&&(m=a));let[h,g,d,b]=Dh([y,m!=null?m:wt(a,c,n),wt(s,p,n),wt(l,f,n)]);return new t(h,g,d,b,!1)}case"lab":{let[o,a,s,l]=oc(Pr(e.lab,r.lab,n));return new t(o,a,s,l,!1)}}}};H.black=new H(0,0,0,1);H.white=new H(1,1,1,1);H.transparent=new H(0,0,0,0);H.red=new H(1,0,0,1);var un=class{constructor(e,r,n){e?this.sensitivity=r?"variant":"case":this.sensitivity=r?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,r){return this.collator.compare(e,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}},Gh=["bottom","center","top"],cn=class{constructor(e,r,n,i,o,a){this.text=e,this.image=r,this.scale=n,this.fontStack=i,this.textColor=o,this.verticalAlign=a}},Fe=class t{constructor(e){this.sections=e}static fromString(e){return new t([new cn(e,null,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof t?e:t.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}},Oe=class t{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof t)return e;if(typeof e=="number")return new t([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(let r of e)if(typeof r!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]];break}return new t(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,r,n){return new t(Pr(e.values,r.values,n))}},Ge=class t{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof t)return e;if(typeof e=="number")return new t([e]);if(Array.isArray(e)){for(let r of e)if(typeof r!="number")return;return new t(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,r,n){return new t(Pr(e.values,r.values,n))}},Pe=class t{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof t)return e;if(typeof e=="string"){let n=H.parse(e);return n?new t([n]):void 0}if(!Array.isArray(e))return;let r=[];for(let n of e){if(typeof n!="string")return;let i=H.parse(n);if(!i)return;r.push(i)}return new t(r)}toString(){return JSON.stringify(this.values)}static interpolate(e,r,n,i="rgb"){let o=[];if(e.values.length!=r.values.length)throw new Error("colorArray: Arrays have mismatched length (".concat(e.values.length," vs. ").concat(r.values.length,"), cannot interpolate."));for(let a=0;a<e.values.length;a++)o.push(H.interpolate(e.values[a],r.values[a],n,i));return new t(o)}},ne=class extends Error{constructor(e){super(e),this.name="RuntimeError"}toJSON(){return this.message}},Nh=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]),Ee=class t{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof t)return e;if(!(!Array.isArray(e)||e.length<1||e.length%2!==0)){for(let r=0;r<e.length;r+=2){let n=e[r],i=e[r+1];if(typeof n!="string"||!Nh.has(n)||!Array.isArray(i)||i.length!==2||typeof i[0]!="number"||typeof i[1]!="number")return}return new t(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,r,n){let i=e.values,o=r.values;if(i.length!==o.length)throw new ne("Cannot interpolate values of different length. from: ".concat(e.toString(),", to: ").concat(r.toString()));let a=[];for(let s=0;s<i.length;s+=2){if(i[s]!==o[s])throw new ne("Cannot interpolate values containing mismatched anchors. from[".concat(s,"]: ").concat(i[s],", to[").concat(s,"]: ").concat(o[s]));a.push(i[s]);let[l,u]=i[s+1],[c,p]=o[s+1];a.push([wt(l,c,n),wt(u,p,n)])}return new t(a)}},Se=class t{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new t({name:e,available:!1}):null}},At=class t{constructor(e,r,n){this.from=e,this.to=r,this.transition=n}static interpolate(e,r,n){return new t(e,r,n)}static parse(e){if(e instanceof t)return e;if(Array.isArray(e)&&e.length===3&&typeof e[0]=="string"&&typeof e[1]=="string"&&typeof e[2]=="number")return new t(e[0],e[1],e[2]);if(typeof e=="object"&&typeof e.from=="string"&&typeof e.to=="string"&&typeof e.transition=="number")return new t(e.from,e.to,e.transition);if(typeof e=="string")return new t(e,e,1)}};function ac(t,e,r,n){if(!(typeof t=="number"&&t>=0&&t<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof r=="number"&&r>=0&&r<=255)){let i=typeof n=="number"?[t,e,r,n]:[t,e,r];return"Invalid rgba value [".concat(i.join(", "),"]: 'r', 'g', and 'b' must be between 0 and 255.")}return typeof n>"u"||typeof n=="number"&&n>=0&&n<=1?null:"Invalid rgba value [".concat([t,e,r,n].join(", "),"]: 'a' must be between 0 and 1.")}function pn(t){if(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||t instanceof At||t instanceof H||t instanceof un||t instanceof Fe||t instanceof Oe||t instanceof Ge||t instanceof Pe||t instanceof Ee||t instanceof Se)return!0;if(Array.isArray(t)){for(let e of t)if(!pn(e))return!1;return!0}else if(typeof t=="object"){for(let e in t)if(!pn(t[e]))return!1;return!0}else return!1}function ue(t){if(t===null)return Ar;if(typeof t=="string")return $;if(typeof t=="boolean")return U;if(typeof t=="number")return k;if(t instanceof H)return ze;if(t instanceof At)return go;if(t instanceof un)return xo;if(t instanceof Fe)return _r;if(t instanceof Oe)return bo;if(t instanceof Ge)return vo;if(t instanceof Pe)return sn;if(t instanceof Ee)return Po;if(t instanceof Se)return Pn;if(Array.isArray(t)){let e=t.length,r;for(let n of t){let i=ue(n);if(!r)r=i;else{if(r===i)continue;r=N;break}}return Ce(r||N,e)}else return Xt}function an(t){let e=typeof t;return t===null?"":e==="string"||e==="number"||e==="boolean"?String(t):t instanceof H||t instanceof At||t instanceof Fe||t instanceof Oe||t instanceof Ge||t instanceof Pe||t instanceof Ee||t instanceof Se?t.toString():JSON.stringify(t)}var _t=class t{constructor(e,r){this.type=e,this.value=r}static parse(e,r){if(e.length!==2)return r.error("'literal' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(!pn(e[1]))return r.error("invalid value");let n=e[1],i=ue(n),o=r.expectedType;return i.kind==="array"&&i.N===0&&o&&o.kind==="array"&&(typeof o.N!="number"||o.N===0)&&(i=o),new t(i,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}},Qi={string:$,number:k,boolean:U,object:Xt},$e=class t{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let n=1,i,o=e[0];if(o==="array"){let s;if(e.length>2){let u=e[1];if(typeof u!="string"||!(u in Qi)||u==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);s=Qi[u],n++}else s=N;let l;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return r.error('The length argument to "array" must be a positive integer literal',2);l=e[2],n++}i=Ce(s,l)}else{if(!Qi[o])throw new Error("Types doesn't contain name = ".concat(o));i=Qi[o]}let a=[];for(;n<e.length;n++){let s=r.parse(e[n],n,N);if(!s)return null;a.push(s)}return new t(i,a)}evaluate(e){for(let r=0;r<this.args.length;r++){let n=this.args[r].evaluate(e);if(ln(this.type,ue(n))){if(r===this.args.length-1)throw new ne("Expected value to be of type ".concat(ie(this.type),", but found ").concat(ie(ue(n))," instead."))}else return n}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}},Du={"to-boolean":U,"to-color":ze,"to-number":k,"to-string":$},St=class t{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let n=e[0];if(!Du[n])throw new Error("Can't parse ".concat(n," as it is not part of the known types"));if((n==="to-boolean"||n==="to-string")&&e.length!==2)return r.error("Expected one argument.");let i=Du[n],o=[];for(let a=1;a<e.length;a++){let s=r.parse(e[a],a,N);if(!s)return null;o.push(s)}return new t(i,o)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let r,n;for(let i of this.args){if(r=i.evaluate(e),n=null,r instanceof H)return r;if(typeof r=="string"){let o=e.parseColor(r);if(o)return o}else if(Array.isArray(r)&&(r.length<3||r.length>4?n="Invalid rgba value ".concat(JSON.stringify(r),": expected an array containing either three or four numeric values."):n=ac(r[0],r[1],r[2],r[3]),!n))return new H(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new ne(n||"Could not parse color from value '".concat(typeof r=="string"?r:JSON.stringify(r),"'"))}case"padding":{let r;for(let n of this.args){r=n.evaluate(e);let i=Oe.parse(r);if(i)return i}throw new ne("Could not parse padding from value '".concat(typeof r=="string"?r:JSON.stringify(r),"'"))}case"numberArray":{let r;for(let n of this.args){r=n.evaluate(e);let i=Ge.parse(r);if(i)return i}throw new ne("Could not parse numberArray from value '".concat(typeof r=="string"?r:JSON.stringify(r),"'"))}case"colorArray":{let r;for(let n of this.args){r=n.evaluate(e);let i=Pe.parse(r);if(i)return i}throw new ne("Could not parse colorArray from value '".concat(typeof r=="string"?r:JSON.stringify(r),"'"))}case"variableAnchorOffsetCollection":{let r;for(let n of this.args){r=n.evaluate(e);let i=Ee.parse(r);if(i)return i}throw new ne("Could not parse variableAnchorOffsetCollection from value '".concat(typeof r=="string"?r:JSON.stringify(r),"'"))}case"number":{let r=null;for(let n of this.args){if(r=n.evaluate(e),r===null)return 0;let i=Number(r);if(!isNaN(i))return i}throw new ne("Could not convert ".concat(JSON.stringify(r)," to number."))}case"formatted":return Fe.fromString(an(this.args[0].evaluate(e)));case"resolvedImage":return Se.fromString(an(this.args[0].evaluate(e)));case"projectionDefinition":return this.args[0].evaluate(e);default:return an(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}},Uh=["Unknown","Point","LineString","Polygon"],no=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Uh[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let r=this._parseColorCache.get(e);return r||(r=H.parse(e),this._parseColorCache.set(e,r)),r}},io=class t{constructor(e,r,n=[],i,o=new Ss,a=[]){this.registry=e,this.path=n,this.key=n.map(s=>"[".concat(s,"]")).join(""),this.scope=o,this.errors=a,this.expectedType=i,this._isConstant=r}parse(e,r,n,i,o={}){return r?this.concat(r,n,i)._parse(e,o):this._parse(e,o)}_parse(e,r){(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number")&&(e=["literal",e]);function n(i,o,a){return a==="assert"?new $e(o,[i]):a==="coerce"?new St(o,[i]):i}if(Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let i=e[0];if(typeof i!="string")return this.error("Expression name must be a string, but found ".concat(typeof i,' instead. If you wanted a literal array, use ["literal", [...]].'),0),null;let o=this.registry[i];if(o){let a=o.parse(e,this);if(!a)return null;if(this.expectedType){let s=this.expectedType,l=a.type;if((s.kind==="string"||s.kind==="number"||s.kind==="boolean"||s.kind==="object"||s.kind==="array")&&l.kind==="value")a=n(a,s,r.typeAnnotation||"assert");else if(s.kind==="projectionDefinition"&&["string","array"].includes(l.kind)||["color","formatted","resolvedImage"].includes(s.kind)&&["value","string"].includes(l.kind)||["padding","numberArray"].includes(s.kind)&&["value","number","array"].includes(l.kind)||s.kind==="colorArray"&&["value","string","array"].includes(l.kind)||s.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(l.kind))a=n(a,s,r.typeAnnotation||"coerce");else if(this.checkSubtype(s,l))return null}if(!(a instanceof _t)&&a.type.kind!=="resolvedImage"&&this._isConstant(a)){let s=new no;try{a=new _t(a.type,a.evaluate(s))}catch(l){return this.error(l.message),null}}return a}return this.error('Unknown expression "'.concat(i,'". If you wanted a literal array, use ["literal", [...]].'),0)}else return typeof e>"u"?this.error("'undefined' value invalid. Use null instead."):typeof e=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found ".concat(typeof e," instead."))}concat(e,r,n){let i=typeof e=="number"?this.path.concat(e):this.path,o=n?this.scope.concat(n):this.scope;return new t(this.registry,this._isConstant,i,r||null,o,this.errors)}error(e,...r){let n="".concat(this.key).concat(r.map(i=>"[".concat(i,"]")).join(""));this.errors.push(new Ve(n,e))}checkSubtype(e,r){let n=ln(e,r);return n&&this.error(n),n}},oo=class t{constructor(e,r){this.type=r.type,this.bindings=[].concat(e),this.result=r}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(let r of this.bindings)e(r[1]);e(this.result)}static parse(e,r){if(e.length<4)return r.error("Expected at least 3 arguments, but found ".concat(e.length-1," instead."));let n=[];for(let o=1;o<e.length-1;o+=2){let a=e[o];if(typeof a!="string")return r.error("Expected string, but found ".concat(typeof a," instead."),o);if(/[^a-zA-Z0-9_]/.test(a))return r.error("Variable names must contain only alphanumeric characters or '_'.",o);let s=r.parse(e[o+1],o+1);if(!s)return null;n.push([a,s])}let i=r.parse(e[e.length-1],e.length-1,r.expectedType,n);return i?new t(n,i):null}outputDefined(){return this.result.outputDefined()}},ao=class t{constructor(e,r){this.type=r.type,this.name=e,this.boundExpression=r}static parse(e,r){if(e.length!==2||typeof e[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");let n=e[1];return r.scope.has(n)?new t(n,r.scope.get(n)):r.error('Unknown variable "'.concat(n,'". Make sure "').concat(n,'" has been bound in an enclosing "let" expression before using it.'),1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}},ws=class t{constructor(e,r,n){this.type=e,this.index=r,this.input=n}static parse(e,r){if(e.length!==3)return r.error("Expected 2 arguments, but found ".concat(e.length-1," instead."));let n=r.parse(e[1],1,k),i=r.parse(e[2],2,Ce(r.expectedType||N));if(!n||!i)return null;let o=i.type;return new t(o.itemType,n,i)}evaluate(e){let r=this.index.evaluate(e),n=this.input.evaluate(e);if(r<0)throw new ne("Array index out of bounds: ".concat(r," < 0."));if(r>=n.length)throw new ne("Array index out of bounds: ".concat(r," > ").concat(n.length-1,"."));if(r!==Math.floor(r))throw new ne("Array index must be an integer, but found ".concat(r," instead."));return n[r]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}},As=class t{constructor(e,r){this.type=U,this.needle=e,this.haystack=r}static parse(e,r){if(e.length!==3)return r.error("Expected 2 arguments, but found ".concat(e.length-1," instead."));let n=r.parse(e[1],1,N),i=r.parse(e[2],2,N);return!n||!i?null:Gs(n.type,[U,$,k,Ar,N])?new t(n,i):r.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(ie(n.type)," instead"))}evaluate(e){let r=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(!n)return!1;if(!Ht(r,["boolean","string","number","null"]))throw new ne("Expected first argument to be of type boolean, string, number or null, but found ".concat(ie(ue(r))," instead."));if(!Ht(n,["string","array"]))throw new ne("Expected second argument to be of type array or string, but found ".concat(ie(ue(n))," instead."));return n.indexOf(r)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}},_s=class t{constructor(e,r,n){this.type=k,this.needle=e,this.haystack=r,this.fromIndex=n}static parse(e,r){if(e.length<=2||e.length>=5)return r.error("Expected 3 or 4 arguments, but found ".concat(e.length-1," instead."));let n=r.parse(e[1],1,N),i=r.parse(e[2],2,N);if(!n||!i)return null;if(!Gs(n.type,[U,$,k,Ar,N]))return r.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(ie(n.type)," instead"));if(e.length===4){let o=r.parse(e[3],3,k);return o?new t(n,i,o):null}else return new t(n,i)}evaluate(e){let r=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(!Ht(r,["boolean","string","number","null"]))throw new ne("Expected first argument to be of type boolean, string, number or null, but found ".concat(ie(ue(r))," instead."));let i;if(this.fromIndex&&(i=this.fromIndex.evaluate(e)),Ht(n,["string"])){let o=n.indexOf(r,i);return o===-1?-1:[...n.slice(0,o)].length}else{if(Ht(n,["array"]))return n.indexOf(r,i);throw new ne("Expected second argument to be of type array or string, but found ".concat(ie(ue(n))," instead."))}}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}},Is=class t{constructor(e,r,n,i,o,a){this.inputType=e,this.type=r,this.input=n,this.cases=i,this.outputs=o,this.otherwise=a}static parse(e,r){if(e.length<5)return r.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if(e.length%2!==1)return r.error("Expected an even number of arguments.");let n,i;r.expectedType&&r.expectedType.kind!=="value"&&(i=r.expectedType);let o={},a=[];for(let u=2;u<e.length-1;u+=2){let c=e[u],p=e[u+1];Array.isArray(c)||(c=[c]);let f=r.concat(u);if(c.length===0)return f.error("Expected at least one branch label.");for(let m of c){if(typeof m!="number"&&typeof m!="string")return f.error("Branch labels must be numbers or strings.");if(typeof m=="number"&&Math.abs(m)>Number.MAX_SAFE_INTEGER)return f.error("Branch labels must be integers no larger than ".concat(Number.MAX_SAFE_INTEGER,"."));if(typeof m=="number"&&Math.floor(m)!==m)return f.error("Numeric branch labels must be integer values.");if(!n)n=ue(m);else if(f.checkSubtype(n,ue(m)))return null;if(typeof o[String(m)]<"u")return f.error("Branch labels must be unique.");o[String(m)]=a.length}let y=r.parse(p,u,i);if(!y)return null;i=i||y.type,a.push(y)}let s=r.parse(e[1],1,N);if(!s)return null;let l=r.parse(e[e.length-1],e.length-1,i);return!l||s.type.kind!=="value"&&r.concat(1).checkSubtype(n,s.type)?null:new t(n,i,s,o,a,l)}evaluate(e){let r=this.input.evaluate(e);return(ue(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}},Ts=class t{constructor(e,r,n){this.type=e,this.branches=r,this.otherwise=n}static parse(e,r){if(e.length<4)return r.error("Expected at least 3 arguments, but found only ".concat(e.length-1,"."));if(e.length%2!==0)return r.error("Expected an odd number of arguments.");let n;r.expectedType&&r.expectedType.kind!=="value"&&(n=r.expectedType);let i=[];for(let a=1;a<e.length-1;a+=2){let s=r.parse(e[a],a,U);if(!s)return null;let l=r.parse(e[a+1],a+1,n);if(!l)return null;i.push([s,l]),n=n||l.type}let o=r.parse(e[e.length-1],e.length-1,n);if(!o)return null;if(!n)throw new Error("Can't infer output type");return new t(n,i,o)}evaluate(e){for(let[r,n]of this.branches)if(r.evaluate(e))return n.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(let[r,n]of this.branches)e(r),e(n);e(this.otherwise)}outputDefined(){return this.branches.every(([e,r])=>r.outputDefined())&&this.otherwise.outputDefined()}},Cs=class t{constructor(e,r,n,i){this.type=e,this.input=r,this.beginIndex=n,this.endIndex=i}static parse(e,r){if(e.length<=2||e.length>=5)return r.error("Expected 3 or 4 arguments, but found ".concat(e.length-1," instead."));let n=r.parse(e[1],1,N),i=r.parse(e[2],2,k);if(!n||!i)return null;if(!Gs(n.type,[Ce(N),$,N]))return r.error("Expected first argument to be of type array or string, but found ".concat(ie(n.type)," instead"));if(e.length===4){let o=r.parse(e[3],3,k);return o?new t(n.type,n,i,o):null}else return new t(n.type,n,i)}evaluate(e){let r=this.input.evaluate(e),n=this.beginIndex.evaluate(e),i;if(this.endIndex&&(i=this.endIndex.evaluate(e)),Ht(r,["string"]))return[...r].slice(n,i).join("");if(Ht(r,["array"]))return r.slice(n,i);throw new ne("Expected first argument to be of type array or string, but found ".concat(ie(ue(r))," instead."))}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}};function So(t,e){let r=t.length-1,n=0,i=r,o=0,a,s;for(;n<=i;)if(o=Math.floor((n+i)/2),a=t[o],s=t[o+1],a<=e){if(o===r||e<s)return o;n=o+1}else if(a>e)i=o-1;else throw new ne("Input is not a number.");return 0}var Sr=class t{constructor(e,r,n){this.type=e,this.input=r,this.labels=[],this.outputs=[];for(let[i,o]of n)this.labels.push(i),this.outputs.push(o)}static parse(e,r){if(e.length-1<4)return r.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if((e.length-1)%2!==0)return r.error("Expected an even number of arguments.");let n=r.parse(e[1],1,k);if(!n)return null;let i=[],o=null;r.expectedType&&r.expectedType.kind!=="value"&&(o=r.expectedType);for(let a=1;a<e.length;a+=2){let s=a===1?-1/0:e[a],l=e[a+1],u=a,c=a+1;if(typeof s!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(i.length&&i[i.length-1][0]>=s)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);let p=r.parse(l,c,o);if(!p)return null;o=o||p.type,i.push([s,p])}return new t(o,n,i)}evaluate(e){let r=this.labels,n=this.outputs;if(r.length===1)return n[0].evaluate(e);let i=this.input.evaluate(e);if(i<=r[0])return n[0].evaluate(e);let o=r.length;if(i>=r[o-1])return n[o-1].evaluate(e);let a=So(r,i);return n[a].evaluate(e)}eachChild(e){e(this.input);for(let r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}};function $h(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var gs,Bu;function jh(){if(Bu)return gs;Bu=1,gs=t;function t(e,r,n,i){this.cx=3*e,this.bx=3*(n-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(i-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=r,this.p2x=n,this.p2y=i}return t.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,r){if(r===void 0&&(r=1e-6),e<0)return 0;if(e>1)return 1;for(var n=e,i=0;i<8;i++){var o=this.sampleCurveX(n)-e;if(Math.abs(o)<r)return n;var a=this.sampleCurveDerivativeX(n);if(Math.abs(a)<1e-6)break;n=n-o/a}var s=0,l=1;for(n=e,i=0;i<20&&(o=this.sampleCurveX(n),!(Math.abs(o-e)<r));i++)e>o?s=n:l=n,n=(l-s)*.5+s;return n},solve:function(e,r){return this.sampleCurveY(this.solveCurveX(e,r))}},gs}var qh=jh(),Wh=$h(qh),ke=class t{constructor(e,r,n,i,o){this.type=e,this.operator=r,this.interpolation=n,this.input=i,this.labels=[],this.outputs=[];for(let[a,s]of o)this.labels.push(a),this.outputs.push(s)}static interpolationFactor(e,r,n,i){let o=0;if(e.name==="exponential")o=xs(r,e.base,n,i);else if(e.name==="linear")o=xs(r,1,n,i);else if(e.name==="cubic-bezier"){let a=e.controlPoints;o=new Wh(a[0],a[1],a[2],a[3]).solve(xs(r,1,n,i))}return o}static parse(e,r){let[n,i,o,...a]=e;if(!Array.isArray(i)||i.length===0)return r.error("Expected an interpolation type expression.",1);if(i[0]==="linear")i={name:"linear"};else if(i[0]==="exponential"){let u=i[1];if(typeof u!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:u}}else if(i[0]==="cubic-bezier"){let u=i.slice(1);if(u.length!==4||u.some(c=>typeof c!="number"||c<0||c>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:u}}else return r.error("Unknown interpolation type ".concat(String(i[0])),1,0);if(e.length-1<4)return r.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if((e.length-1)%2!==0)return r.error("Expected an even number of arguments.");if(o=r.parse(o,2,k),!o)return null;let s=[],l=null;(n==="interpolate-hcl"||n==="interpolate-lab")&&r.expectedType!=sn?l=ze:r.expectedType&&r.expectedType.kind!=="value"&&(l=r.expectedType);for(let u=0;u<a.length;u+=2){let c=a[u],p=a[u+1],f=u+3,y=u+4;if(typeof c!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',f);if(s.length&&s[s.length-1][0]>=c)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',f);let m=r.parse(p,y,l);if(!m)return null;l=l||m.type,s.push([c,m])}return!Pt(l,k)&&!Pt(l,go)&&!Pt(l,ze)&&!Pt(l,bo)&&!Pt(l,vo)&&!Pt(l,sn)&&!Pt(l,Po)&&!Pt(l,Ce(k))?r.error("Type ".concat(ie(l)," is not interpolatable.")):new t(l,n,i,o,s)}evaluate(e){let r=this.labels,n=this.outputs;if(r.length===1)return n[0].evaluate(e);let i=this.input.evaluate(e);if(i<=r[0])return n[0].evaluate(e);let o=r.length;if(i>=r[o-1])return n[o-1].evaluate(e);let a=So(r,i),s=r[a],l=r[a+1],u=t.interpolationFactor(this.interpolation,i,s,l),c=n[a].evaluate(e),p=n[a+1].evaluate(e);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return wt(c,p,u);case"color":return H.interpolate(c,p,u);case"padding":return Oe.interpolate(c,p,u);case"colorArray":return Pe.interpolate(c,p,u);case"numberArray":return Ge.interpolate(c,p,u);case"variableAnchorOffsetCollection":return Ee.interpolate(c,p,u);case"array":return Pr(c,p,u);case"projectionDefinition":return At.interpolate(c,p,u)}case"interpolate-hcl":switch(this.type.kind){case"color":return H.interpolate(c,p,u,"hcl");case"colorArray":return Pe.interpolate(c,p,u,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return H.interpolate(c,p,u,"lab");case"colorArray":return Pe.interpolate(c,p,u,"lab")}}}eachChild(e){e(this.input);for(let r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}};function xs(t,e,r,n){let i=n-r,o=t-r;return i===0?0:e===1?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}var lt={color:H.interpolate,number:wt,padding:Oe.interpolate,numberArray:Ge.interpolate,colorArray:Pe.interpolate,variableAnchorOffsetCollection:Ee.interpolate,array:Pr},so=class t{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let n=null,i=r.expectedType;i&&i.kind!=="value"&&(n=i);let o=[];for(let s of e.slice(1)){let l=r.parse(s,1+o.length,n,void 0,{typeAnnotation:"omit"});if(!l)return null;n=n||l.type,o.push(l)}if(!n)throw new Error("No output type");return i&&o.some(s=>ln(i,s.type))?new t(N,o):new t(n,o)}evaluate(e){let r=null,n=0,i;for(let o of this.args)if(n++,r=o.evaluate(e),r&&r instanceof Se&&!r.available&&(i||(i=r.name),r=null,n===this.args.length&&(r=i)),r!==null)break;return r}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}};function Vu(t,e){return t==="=="||t==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Xh(t,e,r){return e===r}function Hh(t,e,r){return e!==r}function Zh(t,e,r){return e<r}function Jh(t,e,r){return e>r}function Yh(t,e,r){return e<=r}function Kh(t,e,r){return e>=r}function sc(t,e,r,n){return n.compare(e,r)===0}function Qh(t,e,r,n){return!sc(t,e,r,n)}function ed(t,e,r,n){return n.compare(e,r)<0}function td(t,e,r,n){return n.compare(e,r)>0}function rd(t,e,r,n){return n.compare(e,r)<=0}function nd(t,e,r,n){return n.compare(e,r)>=0}function Ir(t,e,r){let n=t!=="=="&&t!=="!=";return class lc{constructor(o,a,s){this.type=U,this.lhs=o,this.rhs=a,this.collator=s,this.hasUntypedArgument=o.type.kind==="value"||a.type.kind==="value"}static parse(o,a){if(o.length!==3&&o.length!==4)return a.error("Expected two or three arguments.");let s=o[0],l=a.parse(o[1],1,N);if(!l)return null;if(!Vu(s,l.type))return a.concat(1).error('"'.concat(s,"\\" comparisons are not supported for type '").concat(ie(l.type),"'."));let u=a.parse(o[2],2,N);if(!u)return null;if(!Vu(s,u.type))return a.concat(2).error('"'.concat(s,"\\" comparisons are not supported for type '").concat(ie(u.type),"'."));if(l.type.kind!==u.type.kind&&l.type.kind!=="value"&&u.type.kind!=="value")return a.error("Cannot compare types '".concat(ie(l.type),"' and '").concat(ie(u.type),"'."));n&&(l.type.kind==="value"&&u.type.kind!=="value"?l=new $e(u.type,[l]):l.type.kind!=="value"&&u.type.kind==="value"&&(u=new $e(l.type,[u])));let c=null;if(o.length===4){if(l.type.kind!=="string"&&u.type.kind!=="string"&&l.type.kind!=="value"&&u.type.kind!=="value")return a.error("Cannot use collator to compare non-string types.");if(c=a.parse(o[3],3,xo),!c)return null}return new lc(l,u,c)}evaluate(o){let a=this.lhs.evaluate(o),s=this.rhs.evaluate(o);if(n&&this.hasUntypedArgument){let l=ue(a),u=ue(s);if(l.kind!==u.kind||!(l.kind==="string"||l.kind==="number"))throw new ne('Expected arguments for "'.concat(t,'" to be (string, string) or (number, number), but found (').concat(l.kind,", ").concat(u.kind,") instead."))}if(this.collator&&!n&&this.hasUntypedArgument){let l=ue(a),u=ue(s);if(l.kind!=="string"||u.kind!=="string")return e(o,a,s)}return this.collator?r(o,a,s,this.collator.evaluate(o)):e(o,a,s)}eachChild(o){o(this.lhs),o(this.rhs),this.collator&&o(this.collator)}outputDefined(){return!0}}}var id=Ir("==",Xh,sc),od=Ir("!=",Hh,Qh),ad=Ir("<",Zh,ed),sd=Ir(">",Jh,td),ld=Ir("<=",Yh,rd),ud=Ir(">=",Kh,nd),lo=class t{constructor(e,r,n){this.type=xo,this.locale=n,this.caseSensitive=e,this.diacriticSensitive=r}static parse(e,r){if(e.length!==2)return r.error("Expected one argument.");let n=e[1];if(typeof n!="object"||Array.isArray(n))return r.error("Collator options argument must be an object.");let i=r.parse(n["case-sensitive"]===void 0?!1:n["case-sensitive"],1,U);if(!i)return null;let o=r.parse(n["diacritic-sensitive"]===void 0?!1:n["diacritic-sensitive"],1,U);if(!o)return null;let a=null;return n.locale&&(a=r.parse(n.locale,1,$),!a)?null:new t(i,o,a)}evaluate(e){return new un(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}},ks=class t{constructor(e,r,n,i,o){this.type=$,this.number=e,this.locale=r,this.currency=n,this.minFractionDigits=i,this.maxFractionDigits=o}static parse(e,r){if(e.length!==3)return r.error("Expected two arguments.");let n=r.parse(e[1],1,k);if(!n)return null;let i=e[2];if(typeof i!="object"||Array.isArray(i))return r.error("NumberFormat options argument must be an object.");let o=null;if(i.locale&&(o=r.parse(i.locale,1,$),!o))return null;let a=null;if(i.currency&&(a=r.parse(i.currency,1,$),!a))return null;let s=null;if(i["min-fraction-digits"]&&(s=r.parse(i["min-fraction-digits"],1,k),!s))return null;let l=null;return i["max-fraction-digits"]&&(l=r.parse(i["max-fraction-digits"],1,k),!l)?null:new t(n,o,a,s,l)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}},fn=class t{constructor(e){this.type=_r,this.sections=e}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let n=e[1];if(!Array.isArray(n)&&typeof n=="object")return r.error("First argument must be an image or text section.");let i=[],o=!1;for(let a=1;a<=e.length-1;++a){let s=e[a];if(o&&typeof s=="object"&&!Array.isArray(s)){o=!1;let l=null;if(s["font-scale"]&&(l=r.parse(s["font-scale"],1,k),!l))return null;let u=null;if(s["text-font"]&&(u=r.parse(s["text-font"],1,Ce($)),!u))return null;let c=null;if(s["text-color"]&&(c=r.parse(s["text-color"],1,ze),!c))return null;let p=null;if(s["vertical-align"]){if(typeof s["vertical-align"]=="string"&&!Gh.includes(s["vertical-align"]))return r.error("'vertical-align' must be one of: 'bottom', 'center', 'top' but found '".concat(s["vertical-align"],"' instead."));if(p=r.parse(s["vertical-align"],1,$),!p)return null}let f=i[i.length-1];f.scale=l,f.font=u,f.textColor=c,f.verticalAlign=p}else{let l=r.parse(e[a],1,N);if(!l)return null;let u=l.type.kind;if(u!=="string"&&u!=="value"&&u!=="null"&&u!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");o=!0,i.push({content:l,scale:null,font:null,textColor:null,verticalAlign:null})}}return new t(i)}evaluate(e){let r=n=>{let i=n.content.evaluate(e);return ue(i)===Pn?new cn("",i,null,null,null,n.verticalAlign?n.verticalAlign.evaluate(e):null):new cn(an(i),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null,n.verticalAlign?n.verticalAlign.evaluate(e):null)};return new Fe(this.sections.map(r))}eachChild(e){for(let r of this.sections)e(r.content),r.scale&&e(r.scale),r.font&&e(r.font),r.textColor&&e(r.textColor),r.verticalAlign&&e(r.verticalAlign)}outputDefined(){return!1}},Fs=class t{constructor(e){this.type=Pn,this.input=e}static parse(e,r){if(e.length!==2)return r.error("Expected two arguments.");let n=r.parse(e[1],1,$);return n?new t(n):r.error("No image name provided.")}evaluate(e){let r=this.input.evaluate(e),n=Se.fromString(r);return n&&e.availableImages&&(n.available=e.availableImages.indexOf(r)>-1),n}eachChild(e){e(this.input)}outputDefined(){return!1}},Es=class t{constructor(e){this.type=k,this.input=e}static parse(e,r){if(e.length!==2)return r.error("Expected 1 argument, but found ".concat(e.length-1," instead."));let n=r.parse(e[1],1);return n?n.type.kind!=="array"&&n.type.kind!=="string"&&n.type.kind!=="value"?r.error("Expected argument of type string or array, but found ".concat(ie(n.type)," instead.")):new t(n):null}evaluate(e){let r=this.input.evaluate(e);if(typeof r=="string")return[...r].length;if(Array.isArray(r))return r.length;throw new ne("Expected value to be of type string or array, but found ".concat(ie(ue(r))," instead."))}eachChild(e){e(this.input)}outputDefined(){return!1}},He=8192;function cd(t,e){let r=pd(t[0]),n=yd(t[1]),i=Math.pow(2,e.z);return[Math.round(r*i*He),Math.round(n*i*He)]}function Ns(t,e){let r=Math.pow(2,e.z),n=(t[0]/He+e.x)/r,i=(t[1]/He+e.y)/r;return[fd(n),md(i)]}function pd(t){return(180+t)/360}function fd(t){return t*360-180}function yd(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function md(t){return 360/Math.PI*Math.atan(Math.exp((180-t*360)*Math.PI/180))-90}function Sn(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function yn(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function hd(t,e,r){return e[1]>t[1]!=r[1]>t[1]&&t[0]<(r[0]-e[0])*(t[1]-e[1])/(r[1]-e[1])+e[0]}function dd(t,e,r){let n=t[0]-e[0],i=t[1]-e[1],o=t[0]-r[0],a=t[1]-r[1];return n*a-o*i===0&&n*o<=0&&i*a<=0}function wo(t,e,r,n){let i=[e[0]-t[0],e[1]-t[1]],o=[n[0]-r[0],n[1]-r[1]];return vd(o,i)===0?!1:!!(Ru(t,e,r,n)&&Ru(r,n,t,e))}function gd(t,e,r){for(let n of r)for(let i=0;i<n.length-1;++i)if(wo(t,e,n[i],n[i+1]))return!0;return!1}function Tr(t,e,r=!1){let n=!1;for(let i of e)for(let o=0;o<i.length-1;o++){if(dd(t,i[o],i[o+1]))return r;hd(t,i[o],i[o+1])&&(n=!n)}return n}function xd(t,e){for(let r of e)if(Tr(t,r))return!0;return!1}function uc(t,e){for(let r of t)if(!Tr(r,e))return!1;for(let r=0;r<t.length-1;++r)if(gd(t[r],t[r+1],e))return!1;return!0}function bd(t,e){for(let r of e)if(uc(t,r))return!0;return!1}function vd(t,e){return t[0]*e[1]-t[1]*e[0]}function Ru(t,e,r,n){let i=t[0]-r[0],o=t[1]-r[1],a=e[0]-r[0],s=e[1]-r[1],l=n[0]-r[0],u=n[1]-r[1],c=i*u-l*o,p=a*u-l*s;return c>0&&p<0||c<0&&p>0}function Us(t,e,r){let n=[];for(let i=0;i<t.length;i++){let o=[];for(let a=0;a<t[i].length;a++){let s=cd(t[i][a],r);Sn(e,s),o.push(s)}n.push(o)}return n}function cc(t,e,r){let n=[];for(let i=0;i<t.length;i++){let o=Us(t[i],e,r);n.push(o)}return n}function pc(t,e,r,n){if(t[0]<r[0]||t[0]>r[2]){let i=n*.5,o=t[0]-r[0]>i?-n:r[0]-t[0]>i?n:0;o===0&&(o=t[0]-r[2]>i?-n:r[2]-t[0]>i?n:0),t[0]+=o}Sn(e,t)}function Pd(t){t[0]=t[1]=1/0,t[2]=t[3]=-1/0}function zu(t,e,r,n){let i=Math.pow(2,n.z)*He,o=[n.x*He,n.y*He],a=[];for(let s of t)for(let l of s){let u=[l.x+o[0],l.y+o[1]];pc(u,e,r,i),a.push(u)}return a}function Ou(t,e,r,n){let i=Math.pow(2,n.z)*He,o=[n.x*He,n.y*He],a=[];for(let s of t){let l=[];for(let u of s){let c=[u.x+o[0],u.y+o[1]];Sn(e,c),l.push(c)}a.push(l)}if(e[2]-e[0]<=i/2){Pd(e);for(let s of a)for(let l of s)pc(l,e,r,i)}return a}function Sd(t,e){let r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if(e.type==="Polygon"){let o=Us(e.coordinates,n,i),a=zu(t.geometry(),r,n,i);if(!yn(r,n))return!1;for(let s of a)if(!Tr(s,o))return!1}if(e.type==="MultiPolygon"){let o=cc(e.coordinates,n,i),a=zu(t.geometry(),r,n,i);if(!yn(r,n))return!1;for(let s of a)if(!xd(s,o))return!1}return!0}function wd(t,e){let r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if(e.type==="Polygon"){let o=Us(e.coordinates,n,i),a=Ou(t.geometry(),r,n,i);if(!yn(r,n))return!1;for(let s of a)if(!uc(s,o))return!1}if(e.type==="MultiPolygon"){let o=cc(e.coordinates,n,i),a=Ou(t.geometry(),r,n,i);if(!yn(r,n))return!1;for(let s of a)if(!bd(s,o))return!1}return!0}var mn=class t{constructor(e,r){this.type=U,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error("'within' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(pn(e[1])){let n=e[1];if(n.type==="FeatureCollection"){let i=[];for(let o of n.features){let{type:a,coordinates:s}=o.geometry;a==="Polygon"&&i.push(s),a==="MultiPolygon"&&i.push(...s)}if(i.length){let o={type:"MultiPolygon",coordinates:i};return new t(n,o)}}else if(n.type==="Feature"){let i=n.geometry.type;if(i==="Polygon"||i==="MultiPolygon")return new t(n,n.geometry)}else if(n.type==="Polygon"||n.type==="MultiPolygon")return new t(n,n)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return Sd(e,this.geometries);if(e.geometryType()==="LineString")return wd(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}},uo=class{constructor(e=[],r=(n,i)=>n<i?-1:n>i?1:0){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;let e=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:r,compare:n}=this,i=r[e];for(;e>0;){let o=e-1>>1,a=r[o];if(n(i,a)>=0)break;r[e]=a,e=o}r[e]=i}_down(e){let{data:r,compare:n}=this,i=this.length>>1,o=r[e];for(;e<i;){let a=(e<<1)+1,s=a+1;if(s<this.length&&n(r[s],r[a])<0&&(a=s),n(r[a],o)>=0)break;r[e]=r[a],e=a}r[e]=o}};function fc(t,e,r=0,n=t.length-1,i=Ad){for(;n>r;){if(n-r>600){let l=n-r+1,u=e-r+1,c=Math.log(l),p=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*p*(l-p)/l)*(u-l/2<0?-1:1),y=Math.max(r,Math.floor(e-u*p/l+f)),m=Math.min(n,Math.floor(e+(l-u)*p/l+f));fc(t,e,y,m,i)}let o=t[e],a=r,s=n;for(nn(t,r,e),i(t[n],o)>0&&nn(t,r,n);a<s;){for(nn(t,a,s),a++,s--;i(t[a],o)<0;)a++;for(;i(t[s],o)>0;)s--}i(t[r],o)===0?nn(t,r,s):(s++,nn(t,s,n)),s<=e&&(r=s+1),e<=s&&(n=s-1)}}function nn(t,e,r){let n=t[e];t[e]=t[r],t[r]=n}function Ad(t,e){return t<e?-1:t>e?1:0}function Kt(t,e){if(t.length<=1)return[t];let n=[],i,o;for(let a of t){let s=Id(a);s!==0&&(a.area=Math.abs(s),o===void 0&&(o=s<0),o===s<0?(i&&n.push(i),i=[a]):i.push(a))}if(i&&n.push(i),e>1)for(let a=0;a<n.length;a++)n[a].length<=e||(fc(n[a],e,1,n[a].length-1,_d),n[a]=n[a].slice(0,e));return n}function _d(t,e){return e.area-t.area}function Id(t){let e=0;for(let r=0,n=t.length,i=n-1,o,a;r<n;i=r++)o=t[r],a=t[i],e+=(a.x-o.x)*(o.y+a.y);return e}var Td=6378.137,Gu=1/298.257223563,Nu=Gu*(2-Gu),Uu=Math.PI/180,hn=class{constructor(e){let r=Uu*Td*1e3,n=Math.cos(e*Uu),i=1/(1-Nu*(1-n*n)),o=Math.sqrt(i);this.kx=r*o*n,this.ky=r*o*i*(1-Nu)}distance(e,r){let n=this.wrap(e[0]-r[0])*this.kx,i=(e[1]-r[1])*this.ky;return Math.sqrt(n*n+i*i)}pointOnLine(e,r){let n=1/0,i,o,a,s;for(let l=0;l<e.length-1;l++){let u=e[l][0],c=e[l][1],p=this.wrap(e[l+1][0]-u)*this.kx,f=(e[l+1][1]-c)*this.ky,y=0;(p!==0||f!==0)&&(y=(this.wrap(r[0]-u)*this.kx*p+(r[1]-c)*this.ky*f)/(p*p+f*f),y>1?(u=e[l+1][0],c=e[l+1][1]):y>0&&(u+=p/this.kx*y,c+=f/this.ky*y)),p=this.wrap(r[0]-u)*this.kx,f=(r[1]-c)*this.ky;let m=p*p+f*f;m<n&&(n=m,i=u,o=c,a=l,s=y)}return{point:[i,o],index:a,t:Math.max(0,Math.min(1,s))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}},Ms=100,Ls=50;function yc(t,e){return e[0]-t[0]}function co(t){return t[1]-t[0]+1}function st(t,e){return t[1]>=t[0]&&t[1]<e}function Ds(t,e){if(t[0]>t[1])return[null,null];let r=co(t);if(e){if(r===2)return[t,null];let i=Math.floor(r/2);return[[t[0],t[0]+i],[t[0]+i,t[1]]]}if(r===1)return[t,null];let n=Math.floor(r/2)-1;return[[t[0],t[0]+n],[t[0]+n+1,t[1]]]}function Bs(t,e){if(!st(e,t.length))return[1/0,1/0,-1/0,-1/0];let r=[1/0,1/0,-1/0,-1/0];for(let n=e[0];n<=e[1];++n)Sn(r,t[n]);return r}function Vs(t){let e=[1/0,1/0,-1/0,-1/0];for(let r of t)for(let n of r)Sn(e,n);return e}function $u(t){return t[0]!==-1/0&&t[1]!==-1/0&&t[2]!==1/0&&t[3]!==1/0}function $s(t,e,r){if(!$u(t)||!$u(e))return NaN;let n=0,i=0;return t[2]<e[0]&&(n=e[0]-t[2]),t[0]>e[2]&&(n=t[0]-e[2]),t[1]>e[3]&&(i=t[1]-e[3]),t[3]<e[1]&&(i=e[1]-t[3]),r.distance([0,0],[n,i])}function Wt(t,e,r){let n=r.pointOnLine(e,t);return r.distance(t,n.point)}function js(t,e,r,n,i){let o=Math.min(Wt(t,[r,n],i),Wt(e,[r,n],i)),a=Math.min(Wt(r,[t,e],i),Wt(n,[t,e],i));return Math.min(o,a)}function Cd(t,e,r,n,i){if(!(st(e,t.length)&&st(n,r.length)))return 1/0;let a=1/0;for(let s=e[0];s<e[1];++s){let l=t[s],u=t[s+1];for(let c=n[0];c<n[1];++c){let p=r[c],f=r[c+1];if(wo(l,u,p,f))return 0;a=Math.min(a,js(l,u,p,f,i))}}return a}function kd(t,e,r,n,i){if(!(st(e,t.length)&&st(n,r.length)))return NaN;let a=1/0;for(let s=e[0];s<=e[1];++s)for(let l=n[0];l<=n[1];++l)if(a=Math.min(a,i.distance(t[s],r[l])),a===0)return a;return a}function Fd(t,e,r){if(Tr(t,e,!0))return 0;let n=1/0;for(let i of e){let o=i[0],a=i[i.length-1];if(o!==a&&(n=Math.min(n,Wt(t,[a,o],r)),n===0))return n;let s=r.pointOnLine(i,t);if(n=Math.min(n,r.distance(t,s.point)),n===0)return n}return n}function Ed(t,e,r,n){if(!st(e,t.length))return NaN;for(let o=e[0];o<=e[1];++o)if(Tr(t[o],r,!0))return 0;let i=1/0;for(let o=e[0];o<e[1];++o){let a=t[o],s=t[o+1];for(let l of r)for(let u=0,c=l.length,p=c-1;u<c;p=u++){let f=l[p],y=l[u];if(wo(a,s,f,y))return 0;i=Math.min(i,js(a,s,f,y,n))}}return i}function ju(t,e){for(let r of t)for(let n of r)if(Tr(n,e,!0))return!0;return!1}function Md(t,e,r,n=1/0){let i=Vs(t),o=Vs(e);if(n!==1/0&&$s(i,o,r)>=n)return n;if(yn(i,o)){if(ju(t,e))return 0}else if(ju(e,t))return 0;let a=1/0;for(let s of t)for(let l=0,u=s.length,c=u-1;l<u;c=l++){let p=s[c],f=s[l];for(let y of e)for(let m=0,h=y.length,g=h-1;m<h;g=m++){let d=y[g],b=y[m];if(wo(p,f,d,b))return 0;a=Math.min(a,js(p,f,d,b,r))}}return a}function qu(t,e,r,n,i,o){if(!o)return;let a=$s(Bs(n,o),i,r);a<e&&t.push([a,o,[0,0]])}function eo(t,e,r,n,i,o,a){if(!o||!a)return;let s=$s(Bs(n,o),Bs(i,a),r);s<e&&t.push([s,o,a])}function po(t,e,r,n,i=1/0){let o=Math.min(n.distance(t[0],r[0][0]),i);if(o===0)return o;let a=new uo([[0,[0,t.length-1],[0,0]]],yc),s=Vs(r);for(;a.length>0;){let l=a.pop();if(l[0]>=o)continue;let u=l[1],c=e?Ls:Ms;if(co(u)<=c){if(!st(u,t.length))return NaN;if(e){let p=Ed(t,u,r,n);if(isNaN(p)||p===0)return p;o=Math.min(o,p)}else for(let p=u[0];p<=u[1];++p){let f=Fd(t[p],r,n);if(o=Math.min(o,f),o===0)return 0}}else{let p=Ds(u,e);qu(a,o,n,t,s,p[0]),qu(a,o,n,t,s,p[1])}}return o}function fo(t,e,r,n,i,o=1/0){let a=Math.min(o,i.distance(t[0],r[0]));if(a===0)return a;let s=new uo([[0,[0,t.length-1],[0,r.length-1]]],yc);for(;s.length>0;){let l=s.pop();if(l[0]>=a)continue;let u=l[1],c=l[2],p=e?Ls:Ms,f=n?Ls:Ms;if(co(u)<=p&&co(c)<=f){if(!st(u,t.length)&&st(c,r.length))return NaN;let y;if(e&&n)y=Cd(t,u,r,c,i),a=Math.min(a,y);else if(e&&!n){let m=t.slice(u[0],u[1]+1);for(let h=c[0];h<=c[1];++h)if(y=Wt(r[h],m,i),a=Math.min(a,y),a===0)return a}else if(!e&&n){let m=r.slice(c[0],c[1]+1);for(let h=u[0];h<=u[1];++h)if(y=Wt(t[h],m,i),a=Math.min(a,y),a===0)return a}else y=kd(t,u,r,c,i),a=Math.min(a,y)}else{let y=Ds(u,e),m=Ds(c,n);eo(s,a,i,t,r,y[0],m[0]),eo(s,a,i,t,r,y[0],m[1]),eo(s,a,i,t,r,y[1],m[0]),eo(s,a,i,t,r,y[1],m[1])}}return a}function Ld(t,e){let r=t.geometry(),n=r.flat().map(a=>Ns([a.x,a.y],t.canonical));if(r.length===0)return NaN;let i=new hn(n[0][1]),o=1/0;for(let a of e){switch(a.type){case"Point":o=Math.min(o,fo(n,!1,[a.coordinates],!1,i,o));break;case"LineString":o=Math.min(o,fo(n,!1,a.coordinates,!0,i,o));break;case"Polygon":o=Math.min(o,po(n,!1,a.coordinates,i,o));break}if(o===0)return o}return o}function Dd(t,e){let r=t.geometry(),n=r.flat().map(a=>Ns([a.x,a.y],t.canonical));if(r.length===0)return NaN;let i=new hn(n[0][1]),o=1/0;for(let a of e){switch(a.type){case"Point":o=Math.min(o,fo(n,!0,[a.coordinates],!1,i,o));break;case"LineString":o=Math.min(o,fo(n,!0,a.coordinates,!0,i,o));break;case"Polygon":o=Math.min(o,po(n,!0,a.coordinates,i,o));break}if(o===0)return o}return o}function Bd(t,e){let r=t.geometry();if(r.length===0||r[0].length===0)return NaN;let n=Kt(r,0).map(a=>a.map(s=>s.map(l=>Ns([l.x,l.y],t.canonical)))),i=new hn(n[0][0][0][1]),o=1/0;for(let a of e)for(let s of n){switch(a.type){case"Point":o=Math.min(o,po([a.coordinates],!1,s,i,o));break;case"LineString":o=Math.min(o,po(a.coordinates,!0,s,i,o));break;case"Polygon":o=Math.min(o,Md(s,a.coordinates,i,o));break}if(o===0)return o}return o}function bs(t){return t.type==="MultiPolygon"?t.coordinates.map(e=>({type:"Polygon",coordinates:e})):t.type==="MultiLineString"?t.coordinates.map(e=>({type:"LineString",coordinates:e})):t.type==="MultiPoint"?t.coordinates.map(e=>({type:"Point",coordinates:e})):[t]}var dn=class t{constructor(e,r){this.type=k,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error("'distance' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(pn(e[1])){let n=e[1];if(n.type==="FeatureCollection")return new t(n,n.features.map(i=>bs(i.geometry)).flat());if(n.type==="Feature")return new t(n,bs(n.geometry));if("type"in n&&"coordinates"in n)return new t(n,bs(n))}return r.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return Ld(e,this.geometries);if(e.geometryType()==="LineString")return Dd(e,this.geometries);if(e.geometryType()==="Polygon")return Bd(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}},gn=class t{constructor(e){this.type=N,this.key=e}static parse(e,r){if(e.length!==2)return r.error("Expected 1 argument, but found ".concat(e.length-1," instead."));let n=e[1];return n==null?r.error("Global state property must be defined."):typeof n!="string"?r.error("Global state property must be string, but found ".concat(typeof e[1]," instead.")):new t(n)}evaluate(e){var r;let n=(r=e.globals)===null||r===void 0?void 0:r.globalState;return!n||Object.keys(n).length===0?null:on(n,this.key)}eachChild(){}outputDefined(){return!1}},Qt={"==":id,"!=":od,">":sd,"<":ad,">=":ud,"<=":ld,array:$e,at:ws,boolean:$e,case:Ts,coalesce:so,collator:lo,format:fn,image:Fs,in:As,"index-of":_s,interpolate:ke,"interpolate-hcl":ke,"interpolate-lab":ke,length:Es,let:oo,literal:_t,match:Is,number:$e,"number-format":ks,object:$e,slice:Cs,step:Sr,string:$e,"to-boolean":St,"to-color":St,"to-number":St,"to-string":St,var:ao,within:mn,distance:dn,"global-state":gn},Ze=class t{constructor(e,r,n,i){this.name=e,this.type=r,this._evaluate=n,this.args=i}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,r){let n=e[0],i=t.definitions[n];if(!i)return r.error('Unknown expression "'.concat(n,'". If you wanted a literal array, use ["literal", [...]].'),0);let o=Array.isArray(i)?i[0]:i.type,a=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,s=a.filter(([u])=>!Array.isArray(u)||u.length===e.length-1),l=null;for(let[u,c]of s){l=new io(r.registry,yo,r.path,null,r.scope);let p=[],f=!1;for(let y=1;y<e.length;y++){let m=e[y],h=Array.isArray(u)?u[y-1]:u.type,g=l.parse(m,1+p.length,h);if(!g){f=!0;break}p.push(g)}if(!f){if(Array.isArray(u)&&u.length!==p.length){l.error("Expected ".concat(u.length," arguments, but found ").concat(p.length," instead."));continue}for(let y=0;y<p.length;y++){let m=Array.isArray(u)?u[y]:u.type,h=p[y];l.concat(y+1).checkSubtype(m,h.type)}if(l.errors.length===0)return new t(n,o,c,p)}}if(s.length===1)r.errors.push(...l.errors);else{let c=(s.length?s:a).map(([f])=>Rd(f)).join(" | "),p=[];for(let f=1;f<e.length;f++){let y=r.parse(e[f],1+p.length);if(!y)return null;p.push(ie(y.type))}r.error("Expected arguments of type ".concat(c,", but found (").concat(p.join(", "),") instead."))}return null}static register(e,r){t.definitions=r;for(let n in r)e[n]=t}};function Wu(t,[e,r,n,i]){e=e.evaluate(t),r=r.evaluate(t),n=n.evaluate(t);let o=i?i.evaluate(t):1,a=ac(e,r,n,o);if(a)throw new ne(a);return new H(e/255,r/255,n/255,o,!1)}function Xu(t,e){return t in e}function vs(t,e){let r=e[t];return typeof r>"u"?null:r}function Vd(t,e,r,n){for(;r<=n;){let i=r+n>>1;if(e[i]===t)return!0;e[i]>t?n=i-1:r=i+1}return!1}function qt(t){return{type:t}}Ze.register(Qt,{error:[Ch,[$],(t,[e])=>{throw new ne(e.evaluate(t))}],typeof:[$,[N],(t,[e])=>ie(ue(e.evaluate(t)))],"to-rgba":[Ce(k,4),[ze],(t,[e])=>{let[r,n,i,o]=e.evaluate(t).rgb;return[r*255,n*255,i*255,o]}],rgb:[ze,[k,k,k],Wu],rgba:[ze,[k,k,k,k],Wu],has:{type:U,overloads:[[[$],(t,[e])=>Xu(e.evaluate(t),t.properties())],[[$,Xt],(t,[e,r])=>Xu(e.evaluate(t),r.evaluate(t))]]},get:{type:N,overloads:[[[$],(t,[e])=>vs(e.evaluate(t),t.properties())],[[$,Xt],(t,[e,r])=>vs(e.evaluate(t),r.evaluate(t))]]},"feature-state":[N,[$],(t,[e])=>vs(e.evaluate(t),t.featureState||{})],properties:[Xt,[],t=>t.properties()],"geometry-type":[$,[],t=>t.geometryType()],id:[N,[],t=>t.id()],zoom:[k,[],t=>t.globals.zoom],"heatmap-density":[k,[],t=>t.globals.heatmapDensity||0],elevation:[k,[],t=>t.globals.elevation||0],"line-progress":[k,[],t=>t.globals.lineProgress||0],accumulated:[N,[],t=>t.globals.accumulated===void 0?null:t.globals.accumulated],"+":[k,qt(k),(t,e)=>{let r=0;for(let n of e)r+=n.evaluate(t);return r}],"*":[k,qt(k),(t,e)=>{let r=1;for(let n of e)r*=n.evaluate(t);return r}],"-":{type:k,overloads:[[[k,k],(t,[e,r])=>e.evaluate(t)-r.evaluate(t)],[[k],(t,[e])=>-e.evaluate(t)]]},"/":[k,[k,k],(t,[e,r])=>e.evaluate(t)/r.evaluate(t)],"%":[k,[k,k],(t,[e,r])=>e.evaluate(t)%r.evaluate(t)],ln2:[k,[],()=>Math.LN2],pi:[k,[],()=>Math.PI],e:[k,[],()=>Math.E],"^":[k,[k,k],(t,[e,r])=>Math.pow(e.evaluate(t),r.evaluate(t))],sqrt:[k,[k],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[k,[k],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[k,[k],(t,[e])=>Math.log(e.evaluate(t))],log2:[k,[k],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[k,[k],(t,[e])=>Math.sin(e.evaluate(t))],cos:[k,[k],(t,[e])=>Math.cos(e.evaluate(t))],tan:[k,[k],(t,[e])=>Math.tan(e.evaluate(t))],asin:[k,[k],(t,[e])=>Math.asin(e.evaluate(t))],acos:[k,[k],(t,[e])=>Math.acos(e.evaluate(t))],atan:[k,[k],(t,[e])=>Math.atan(e.evaluate(t))],min:[k,qt(k),(t,e)=>Math.min(...e.map(r=>r.evaluate(t)))],max:[k,qt(k),(t,e)=>Math.max(...e.map(r=>r.evaluate(t)))],abs:[k,[k],(t,[e])=>Math.abs(e.evaluate(t))],round:[k,[k],(t,[e])=>{let r=e.evaluate(t);return r<0?-Math.round(-r):Math.round(r)}],floor:[k,[k],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[k,[k],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[U,[$,N],(t,[e,r])=>t.properties()[e.value]===r.value],"filter-id-==":[U,[N],(t,[e])=>t.id()===e.value],"filter-type-==":[U,[$],(t,[e])=>t.geometryType()===e.value],"filter-<":[U,[$,N],(t,[e,r])=>{let n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n<i}],"filter-id-<":[U,[N],(t,[e])=>{let r=t.id(),n=e.value;return typeof r==typeof n&&r<n}],"filter->":[U,[$,N],(t,[e,r])=>{let n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n>i}],"filter-id->":[U,[N],(t,[e])=>{let r=t.id(),n=e.value;return typeof r==typeof n&&r>n}],"filter-<=":[U,[$,N],(t,[e,r])=>{let n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n<=i}],"filter-id-<=":[U,[N],(t,[e])=>{let r=t.id(),n=e.value;return typeof r==typeof n&&r<=n}],"filter->=":[U,[$,N],(t,[e,r])=>{let n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n>=i}],"filter-id->=":[U,[N],(t,[e])=>{let r=t.id(),n=e.value;return typeof r==typeof n&&r>=n}],"filter-has":[U,[N],(t,[e])=>e.value in t.properties()],"filter-has-id":[U,[],t=>t.id()!==null&&t.id()!==void 0],"filter-type-in":[U,[Ce($)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[U,[Ce(N)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[U,[$,Ce(N)],(t,[e,r])=>r.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[U,[$,Ce(N)],(t,[e,r])=>Vd(t.properties()[e.value],r.value,0,r.value.length-1)],all:{type:U,overloads:[[[U,U],(t,[e,r])=>e.evaluate(t)&&r.evaluate(t)],[qt(U),(t,e)=>{for(let r of e)if(!r.evaluate(t))return!1;return!0}]]},any:{type:U,overloads:[[[U,U],(t,[e,r])=>e.evaluate(t)||r.evaluate(t)],[qt(U),(t,e)=>{for(let r of e)if(r.evaluate(t))return!0;return!1}]]},"!":[U,[U],(t,[e])=>!e.evaluate(t)],"is-supported-script":[U,[$],(t,[e])=>{let r=t.globals&&t.globals.isSupportedScript;return r?r(e.evaluate(t)):!0}],upcase:[$,[$],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[$,[$],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[$,qt(N),(t,e)=>e.map(r=>an(r.evaluate(t))).join("")],"resolved-locale":[$,[xo],(t,[e])=>e.evaluate(t).resolvedLocale()]});function Rd(t){return Array.isArray(t)?"(".concat(t.map(ie).join(", "),")"):"(".concat(ie(t.type),"...)")}function yo(t){if(t instanceof ao)return yo(t.boundExpression);if(t instanceof Ze&&t.name==="error")return!1;if(t instanceof lo)return!1;if(t instanceof mn)return!1;if(t instanceof dn)return!1;if(t instanceof gn)return!1;let e=t instanceof St||t instanceof $e,r=!0;return t.eachChild(n=>{e?r=r&&yo(n):r=r&&n instanceof _t}),r?Ao(t)&&_o(t,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"]):!1}function Ao(t){if(t instanceof Ze){if(t.name==="get"&&t.args.length===1)return!1;if(t.name==="feature-state")return!1;if(t.name==="has"&&t.args.length===1)return!1;if(t.name==="properties"||t.name==="geometry-type"||t.name==="id")return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof mn||t instanceof dn)return!1;let e=!0;return t.eachChild(r=>{e&&!Ao(r)&&(e=!1)}),e}function xn(t){if(t instanceof Ze&&t.name==="feature-state")return!1;let e=!0;return t.eachChild(r=>{e&&!xn(r)&&(e=!1)}),e}function _o(t,e){if(t instanceof Ze&&e.indexOf(t.name)>=0)return!1;let r=!0;return t.eachChild(n=>{r&&!_o(n,e)&&(r=!1)}),r}function Rs(t){return{result:"success",value:t}}function xr(t){return{result:"error",value:t}}function It(t){return t["property-type"]==="data-driven"||t["property-type"]==="cross-faded-data-driven"}function mc(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function qs(t){return!!t.expression&&t.expression.interpolated}function j(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":t===null?"null":typeof t}function Io(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)&&ue(t)===Xt}function zd(t){return t}function Od(t){switch(t.type){case"color":return H.parse;case"padding":return Oe.parse;case"numberArray":return Ge.parse;case"colorArray":return Pe.parse;default:return null}}function Gd(t){switch(t){case"exponential":return dc;case"interval":return Ud;case"categorical":return Nd;case"identity":return $d;default:throw new Error('Unknown function type "'.concat(t,'"'))}}function hc(t,e){let r=t.stops&&typeof t.stops[0][0]=="object",n=r||t.property!==void 0,i=r||!n,o=t.type||(qs(e)?"exponential":"interval"),a=Od(e);if(a&&(t=vr({},t),t.stops&&(t.stops=t.stops.map(c=>[c[0],a(c[1])])),t.default?t.default=a(t.default):t.default=a(e.default)),t.colorSpace&&!Oh(t.colorSpace))throw new Error('Unknown color space: "'.concat(t.colorSpace,'"'));let s=Gd(o),l,u;if(o==="categorical"){l=Object.create(null);for(let c of t.stops)l[c[0]]=c[1];u=typeof t.stops[0][0]}if(r){let c={},p=[];for(let m=0;m<t.stops.length;m++){let h=t.stops[m],g=h[0].zoom;c[g]===void 0&&(c[g]={zoom:g,type:t.type,property:t.property,default:t.default,stops:[]},p.push(g)),c[g].stops.push([h[0].value,h[1]])}let f=[];for(let m of p)f.push([c[m].zoom,hc(c[m],e)]);let y={name:"linear"};return{kind:"composite",interpolationType:y,interpolationFactor:ke.interpolationFactor.bind(void 0,y),zoomStops:f.map(m=>m[0]),evaluate({zoom:m},h){return dc({stops:f,base:t.base},e,m).evaluate(m,h)}}}else if(i){let c=o==="exponential"?{name:"exponential",base:t.base!==void 0?t.base:1}:null;return{kind:"camera",interpolationType:c,interpolationFactor:ke.interpolationFactor.bind(void 0,c),zoomStops:t.stops.map(p=>p[0]),evaluate:({zoom:p})=>s(t,e,p,l,u)}}else return{kind:"source",evaluate(c,p){let f=p&&p.properties?p.properties[t.property]:void 0;return f===void 0?wn(t.default,e.default):s(t,e,f,l,u)}}}function wn(t,e,r){if(t!==void 0)return t;if(e!==void 0)return e;if(r!==void 0)return r}function Nd(t,e,r,n,i){let o=typeof r===i?n[r]:void 0;return wn(o,t.default,e.default)}function Ud(t,e,r){if(j(r)!=="number")return wn(t.default,e.default);let n=t.stops.length;if(n===1||r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[n-1][0])return t.stops[n-1][1];let i=So(t.stops.map(o=>o[0]),r);return t.stops[i][1]}function dc(t,e,r){let n=t.base!==void 0?t.base:1;if(j(r)!=="number")return wn(t.default,e.default);let i=t.stops.length;if(i===1||r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[i-1][0])return t.stops[i-1][1];let o=So(t.stops.map(c=>c[0]),r),a=jd(r,n,t.stops[o][0],t.stops[o+1][0]),s=t.stops[o][1],l=t.stops[o+1][1],u=lt[e.type]||zd;return typeof s.evaluate=="function"?{evaluate(...c){let p=s.evaluate.apply(void 0,c),f=l.evaluate.apply(void 0,c);if(!(p===void 0||f===void 0))return u(p,f,a,t.colorSpace)}}:u(s,l,a,t.colorSpace)}function $d(t,e,r){switch(e.type){case"color":r=H.parse(r);break;case"formatted":r=Fe.fromString(r.toString());break;case"resolvedImage":r=Se.fromString(r.toString());break;case"padding":r=Oe.parse(r);break;case"colorArray":r=Pe.parse(r);break;case"numberArray":r=Ge.parse(r);break;default:j(r)!==e.type&&(e.type!=="enum"||!e.values[r])&&(r=void 0)}return wn(r,t.default,e.default)}function jd(t,e,r,n){let i=n-r,o=t-r;return i===0?0:e===1?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}var Zt=class{constructor(e,r){this.expression=e,this._warningHistory={},this._evaluator=new no,this._defaultValue=r?Wd(r):null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(e,r,n,i,o,a){return this._evaluator.globals=e,this._evaluator.feature=r,this._evaluator.featureState=n,this._evaluator.canonical=i,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=a,this.expression.evaluate(this._evaluator)}evaluate(e,r,n,i,o,a){this._evaluator.globals=e,this._evaluator.feature=r||null,this._evaluator.featureState=n||null,this._evaluator.canonical=i,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=a||null;try{let s=this.expression.evaluate(this._evaluator);if(s==null||typeof s=="number"&&s!==s)return this._defaultValue;if(this._enumValues&&!(s in this._enumValues))throw new ne("Expected value to be one of ".concat(Object.keys(this._enumValues).map(l=>JSON.stringify(l)).join(", "),", but found ").concat(JSON.stringify(s)," instead."));return s}catch(s){return this._warningHistory[s.message]||(this._warningHistory[s.message]=!0,typeof console<"u"&&console.warn(s.message)),this._defaultValue}}};function An(t){return Array.isArray(t)&&t.length>0&&typeof t[0]=="string"&&t[0]in Qt}function er(t,e){let r=new io(Qt,yo,[],e?qd(e):void 0),n=r.parse(t,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return n?Rs(new Zt(n,e)):xr(r.errors)}var Je=class{constructor(e,r){this.kind=e,this._styleExpression=r,this.isStateDependent=e!=="constant"&&!xn(r.expression),this.globalStateRefs=To(r.expression)}evaluateWithoutErrorHandling(e,r,n,i,o,a){return this._styleExpression.evaluateWithoutErrorHandling(e,r,n,i,o,a)}evaluate(e,r,n,i,o,a){return this._styleExpression.evaluate(e,r,n,i,o,a)}},Tt=class{constructor(e,r,n,i){this.kind=e,this.zoomStops=n,this._styleExpression=r,this.isStateDependent=e!=="camera"&&!xn(r.expression),this.globalStateRefs=To(r.expression),this.interpolationType=i}evaluateWithoutErrorHandling(e,r,n,i,o,a){return this._styleExpression.evaluateWithoutErrorHandling(e,r,n,i,o,a)}evaluate(e,r,n,i,o,a){return this._styleExpression.evaluate(e,r,n,i,o,a)}interpolationFactor(e,r,n){return this.interpolationType?ke.interpolationFactor(this.interpolationType,e,r,n):0}};function gc(t){return t._styleExpression!==void 0}function xc(t,e){let r=er(t,e);if(r.result==="error")return r;let n=r.value.expression,i=Ao(n);if(!i&&!It(e))return xr([new Ve("","data expressions not supported")]);let o=_o(n,["zoom"]);if(!o&&!mc(e))return xr([new Ve("","zoom expressions not supported")]);let a=ro(n);if(!a&&!o)return xr([new Ve("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(a instanceof Ve)return xr([a]);if(a instanceof ke&&!qs(e))return xr([new Ve("",'"interpolate" expressions cannot be used with this property')]);if(!a)return Rs(i?new Je("constant",r.value):new Je("source",r.value));let s=a instanceof ke?a.interpolation:void 0;return Rs(i?new Tt("camera",r.value,a.labels,s):new Tt("composite",r.value,a.labels,s))}var bn=class t{constructor(e,r){this._parameters=e,this._specification=r,vr(this,hc(this._parameters,this._specification))}static deserialize(e){return new t(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}};function bc(t,e){if(Io(t))return new bn(t,e);if(An(t)){let r=xc(t,e);if(r.result==="error")throw new Error(r.value.map(n=>"".concat(n.key,": ").concat(n.message)).join(", "));return r.value}else{let r=t;return e.type==="color"&&typeof t=="string"?r=H.parse(t):e.type==="padding"&&(typeof t=="number"||Array.isArray(t))?r=Oe.parse(t):e.type==="numberArray"&&(typeof t=="number"||Array.isArray(t))?r=Ge.parse(t):e.type==="colorArray"&&(typeof t=="string"||Array.isArray(t))?r=Pe.parse(t):e.type==="variableAnchorOffsetCollection"&&Array.isArray(t)?r=Ee.parse(t):e.type==="projectionDefinition"&&typeof t=="string"&&(r=At.parse(t)),{globalStateRefs:new Set,kind:"constant",evaluate:()=>r}}}function ro(t){let e=null;if(t instanceof oo)e=ro(t.result);else if(t instanceof so){for(let r of t.args)if(e=ro(r),e)break}else(t instanceof Sr||t instanceof ke)&&t.input instanceof Ze&&t.input.name==="zoom"&&(e=t);return e instanceof Ve||t.eachChild(r=>{let n=ro(r);n instanceof Ve?e=n:!e&&n?e=new Ve("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&n&&e!==n&&(e=new Ve("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function To(t,e=new Set){return t instanceof gn&&e.add(t.key),t.eachChild(r=>{To(r,e)}),e}function qd(t){let e={color:ze,string:$,number:k,enum:$,boolean:U,formatted:_r,padding:bo,numberArray:vo,colorArray:sn,projectionDefinition:go,resolvedImage:Pn,variableAnchorOffsetCollection:Po};return t.type==="array"?Ce(e[t.value]||N,t.length):e[t.type]}function Wd(t){if(t.type==="color"&&Io(t.default))return new H(0,0,0,0);switch(t.type){case"color":return H.parse(t.default)||null;case"padding":return Oe.parse(t.default)||null;case"numberArray":return Ge.parse(t.default)||null;case"colorArray":return Pe.parse(t.default)||null;case"variableAnchorOffsetCollection":return Ee.parse(t.default)||null;case"projectionDefinition":return At.parse(t.default)||null;default:return t.default===void 0?null:t.default}}function Ws(t){if(t===!0||t===!1)return!0;if(!Array.isArray(t)||t.length===0)return!1;switch(t[0]){case"has":return t.length>=2&&t[1]!=="$id"&&t[1]!=="$type";case"in":return t.length>=3&&(typeof t[1]!="string"||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return t.length!==3||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(let e of t.slice(1))if(!Ws(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}var Xd={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ct(t){if(t==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Ws(t)||(t=mo(t));let e=er(t,Xd);if(e.result==="error")throw new Error(e.value.map(r=>"".concat(r.key,": ").concat(r.message)).join(", "));{let r=vc(t);return{filter:(n,i,o)=>e.value.evaluate(n,i,{},o),needGeometry:r,getGlobalStateRefs:()=>To(e.value.expression)}}}function Hd(t,e){return t<e?-1:t>e?1:0}function vc(t){if(!Array.isArray(t))return!1;if(t[0]==="within"||t[0]==="distance")return!0;for(let e=1;e<t.length;e++)if(vc(t[e]))return!0;return!1}function mo(t){if(!t)return!0;let e=t[0];return t.length<=1?e!=="any":e==="=="?Ps(t[1],t[2],"=="):e==="!="?to(Ps(t[1],t[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Ps(t[1],t[2],e):e==="any"?Zd(t.slice(1)):e==="all"?["all"].concat(t.slice(1).map(mo)):e==="none"?["all"].concat(t.slice(1).map(mo).map(to)):e==="in"?Hu(t[1],t.slice(2)):e==="!in"?to(Hu(t[1],t.slice(2))):e==="has"?Zu(t[1]):e==="!has"?to(Zu(t[1])):!0}function Ps(t,e,r){switch(t){case"$type":return["filter-type-".concat(r),e];case"$id":return["filter-id-".concat(r),e];default:return["filter-".concat(r),t,e]}}function Zd(t){return["any"].concat(t.map(mo))}function Hu(t,e){if(e.length===0)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(r=>typeof r!=typeof e[0])?["filter-in-large",t,["literal",e.sort(Hd)]]:["filter-in-small",t,["literal",e]]}}function Zu(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function to(t){return["!",t]}function zs(t){let e=typeof t;if(e==="number"||e==="boolean"||e==="string"||t===void 0||t===null)return JSON.stringify(t);if(Array.isArray(t)){let i="[";for(let o of t)i+="".concat(zs(o),",");return"".concat(i,"]")}let r=Object.keys(t).sort(),n="{";for(let i=0;i<r.length;i++)n+="".concat(JSON.stringify(r[i]),":").concat(zs(t[r[i]]),",");return"".concat(n,"}")}function Jd(t){let e="";for(let r of Th)e+="/".concat(zs(t[r]));return e}function Pc(t,e){let r={};for(let i=0;i<t.length;i++){let o=e&&e[t[i].id]||Jd(t[i]);e&&(e[t[i].id]=o);let a=r[o];a||(a=r[o]=[]),a.push(t[i])}let n=[];for(let i in r)n.push(r[i]);return n}function Sc(t){let e=t.key,r=t.value;return r?[new C(e,r,"constants have been deprecated as of v8")]:[]}function le(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Jt(t){if(Array.isArray(t))return t.map(Jt);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){let e={};for(let r in t)e[r]=Jt(t[r]);return e}return le(t)}function Re(t){let e=t.key,r=t.value,n=t.valueSpec||{},i=t.objectElementValidators||{},o=t.style,a=t.styleSpec,s=t.validateSpec,l=[],u=j(r);if(u!=="object")return[new C(e,r,"object expected, ".concat(u," found"))];for(let c in r){let p=c.split(".")[0],f=on(n,p)||n["*"],y;if(on(i,p))y=i[p];else if(on(n,p))y=s;else if(i["*"])y=i["*"];else if(n["*"])y=s;else{l.push(new C(e,r[c],'unknown property "'.concat(c,'"')));continue}l=l.concat(y({key:(e&&"".concat(e,"."))+c,value:r[c],valueSpec:f,style:o,styleSpec:a,object:r,objectKey:c,validateSpec:s},r))}for(let c in n)i[c]||n[c].required&&n[c].default===void 0&&r[c]===void 0&&l.push(new C(e,r,'missing required property "'.concat(c,'"')));return l}function Xs(t){let e=t.value,r=t.valueSpec,n=t.validateSpec,i=t.style,o=t.styleSpec,a=t.key,s=t.arrayElementValidator||n;if(j(e)!=="array")return[new C(a,e,"array expected, ".concat(j(e)," found"))];if(r.length&&e.length!==r.length)return[new C(a,e,"array length ".concat(r.length," expected, length ").concat(e.length," found"))];if(r["min-length"]&&e.length<r["min-length"])return[new C(a,e,"array length at least ".concat(r["min-length"]," expected, length ").concat(e.length," found"))];let l={type:r.value,values:r.values};o.$version<7&&(l.function=r.function),j(r.value)==="object"&&(l=r.value);let u=[];for(let c=0;c<e.length;c++)u=u.concat(s({array:e,arrayIndex:c,value:e[c],valueSpec:l,validateSpec:t.validateSpec,style:i,styleSpec:o,key:"".concat(a,"[").concat(c,"]")}));return u}function Co(t){let e=t.key,r=t.value,n=t.valueSpec,i=j(r);return i==="number"&&r!==r&&(i="NaN"),i!=="number"?[new C(e,r,"number expected, ".concat(i," found"))]:"minimum"in n&&r<n.minimum?[new C(e,r,"".concat(r," is less than the minimum value ").concat(n.minimum))]:"maximum"in n&&r>n.maximum?[new C(e,r,"".concat(r," is greater than the maximum value ").concat(n.maximum))]:[]}function wc(t){let e=t.valueSpec,r=le(t.value.type),n,i={},o,a,s=r!=="categorical"&&t.value.property===void 0,l=!s,u=j(t.value.stops)==="array"&&j(t.value.stops[0])==="array"&&j(t.value.stops[0][0])==="object",c=Re({key:t.key,value:t.value,valueSpec:t.styleSpec.function,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:p,default:m}});return r==="identity"&&s&&c.push(new C(t.key,t.value,'missing required property "property"')),r!=="identity"&&!t.value.stops&&c.push(new C(t.key,t.value,'missing required property "stops"')),r==="exponential"&&t.valueSpec.expression&&!qs(t.valueSpec)&&c.push(new C(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!It(t.valueSpec)?c.push(new C(t.key,t.value,"property functions not supported")):s&&!mc(t.valueSpec)&&c.push(new C(t.key,t.value,"zoom functions not supported"))),(r==="categorical"||u)&&t.value.property===void 0&&c.push(new C(t.key,t.value,'"property" property is required')),c;function p(h){if(r==="identity")return[new C(h.key,h.value,'identity function may not have a "stops" property')];let g=[],d=h.value;return g=g.concat(Xs({key:h.key,value:d,valueSpec:h.valueSpec,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec,arrayElementValidator:f})),j(d)==="array"&&d.length===0&&g.push(new C(h.key,d,"array must have at least one stop")),g}function f(h){let g=[],d=h.value,b=h.key;if(j(d)!=="array")return[new C(b,d,"array expected, ".concat(j(d)," found"))];if(d.length!==2)return[new C(b,d,"array length 2 expected, length ".concat(d.length," found"))];if(u){if(j(d[0])!=="object")return[new C(b,d,"object expected, ".concat(j(d[0])," found"))];if(d[0].zoom===void 0)return[new C(b,d,"object stop key must have zoom")];if(d[0].value===void 0)return[new C(b,d,"object stop key must have value")];if(a&&a>le(d[0].zoom))return[new C(b,d[0].zoom,"stop zoom values must appear in ascending order")];le(d[0].zoom)!==a&&(a=le(d[0].zoom),o=void 0,i={}),g=g.concat(Re({key:"".concat(b,"[0]"),value:d[0],valueSpec:{zoom:{}},validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{zoom:Co,value:y}}))}else g=g.concat(y({key:"".concat(b,"[0]"),value:d[0],validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec},d));return An(Jt(d[1]))?g.concat([new C("".concat(b,"[1]"),d[1],"expressions are not allowed in function stops.")]):g.concat(h.validateSpec({key:"".concat(b,"[1]"),value:d[1],valueSpec:e,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec}))}function y(h,g){let d=j(h.value),b=le(h.value),x=h.value!==null?h.value:g;if(!n)n=d;else if(d!==n)return[new C(h.key,x,"".concat(d," stop domain type must match previous stop domain type ").concat(n))];if(d!=="number"&&d!=="string"&&d!=="boolean")return[new C(h.key,x,"stop domain value must be a number, string, or boolean")];if(d!=="number"&&r!=="categorical"){let v="number expected, ".concat(d," found");return It(e)&&r===void 0&&(v+='\\nIf you intended to use a categorical function, specify \`"type": "categorical"\`.'),[new C(h.key,x,v)]}return r==="categorical"&&d==="number"&&(!isFinite(b)||Math.floor(b)!==b)?[new C(h.key,x,"integer expected, found ".concat(b))]:r!=="categorical"&&d==="number"&&o!==void 0&&b<o?[new C(h.key,x,"stop domain values must appear in ascending order")]:(o=b,r==="categorical"&&b in i?[new C(h.key,x,"stop domain values must be unique")]:(i[b]=!0,[]))}function m(h){return h.validateSpec({key:h.key,value:h.value,valueSpec:e,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec})}}function wr(t){let e=(t.expressionContext==="property"?xc:er)(Jt(t.value),t.valueSpec);if(e.result==="error")return e.value.map(n=>new C("".concat(t.key).concat(n.key),t.value,n.message));let r=e.value.expression||e.value._styleExpression.expression;if(t.expressionContext==="property"&&t.propertyKey==="text-font"&&!r.outputDefined())return[new C(t.key,t.value,'Invalid data expression for "'.concat(t.propertyKey,'". Output values must be contained as literals within the expression.'))];if(t.expressionContext==="property"&&t.propertyType==="layout"&&!xn(r))return[new C(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if(t.expressionContext==="filter"&&!xn(r))return[new C(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&t.expressionContext.indexOf("cluster")===0){if(!_o(r,["zoom","feature-state"]))return[new C(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(t.expressionContext==="cluster-initial"&&!Ao(r))return[new C(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Yd(t){let e=t.value,r=t.key,n=j(e);return n!=="boolean"?[new C(r,e,"boolean expected, ".concat(n," found"))]:[]}function Os(t){let e=t.key,r=t.value,n=j(r);return n!=="string"?[new C(e,r,"color expected, ".concat(n," found"))]:H.parse(String(r))?[]:[new C(e,r,'color expected, "'.concat(r,'" found'))]}function vn(t){let e=t.key,r=t.value,n=t.valueSpec,i=[];return Array.isArray(n.values)?n.values.indexOf(le(r))===-1&&i.push(new C(e,r,"expected one of [".concat(n.values.join(", "),"], ").concat(JSON.stringify(r)," found"))):Object.keys(n.values).indexOf(le(r))===-1&&i.push(new C(e,r,"expected one of [".concat(Object.keys(n.values).join(", "),"], ").concat(JSON.stringify(r)," found"))),i}function Hs(t){return Ws(Jt(t.value))?wr(vr({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Ac(t)}function Ac(t){let e=t.value,r=t.key;if(j(e)!=="array")return[new C(r,e,"array expected, ".concat(j(e)," found"))];let n=t.styleSpec,i,o=[];if(e.length<1)return[new C(r,e,"filter array must have at least 1 element")];switch(o=o.concat(vn({key:"".concat(r,"[0]"),value:e[0],valueSpec:n.filter_operator,style:t.style,styleSpec:t.styleSpec})),le(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&le(e[1])==="$type"&&o.push(new C(r,e,'"$type" cannot be use with operator "'.concat(e[0],'"')));case"==":case"!=":e.length!==3&&o.push(new C(r,e,'filter array for operator "'.concat(e[0],'" must have 3 elements')));case"in":case"!in":e.length>=2&&(i=j(e[1]),i!=="string"&&o.push(new C("".concat(r,"[1]"),e[1],"string expected, ".concat(i," found"))));for(let a=2;a<e.length;a++)i=j(e[a]),le(e[1])==="$type"?o=o.concat(vn({key:"".concat(r,"[").concat(a,"]"),value:e[a],valueSpec:n.geometry_type,style:t.style,styleSpec:t.styleSpec})):i!=="string"&&i!=="number"&&i!=="boolean"&&o.push(new C("".concat(r,"[").concat(a,"]"),e[a],"string, number, or boolean expected, ".concat(i," found")));break;case"any":case"all":case"none":for(let a=1;a<e.length;a++)o=o.concat(Ac({key:"".concat(r,"[").concat(a,"]"),value:e[a],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":i=j(e[1]),e.length!==2?o.push(new C(r,e,'filter array for "'.concat(e[0],'" operator must have 2 elements'))):i!=="string"&&o.push(new C("".concat(r,"[1]"),e[1],"string expected, ".concat(i," found")));break}return o}function _c(t,e){let r=t.key,n=t.validateSpec,i=t.style,o=t.styleSpec,a=t.value,s=t.objectKey,l=o["".concat(e,"_").concat(t.layerType)];if(!l)return[];let u=s.match(/^(.*)-transition$/);if(e==="paint"&&u&&l[u[1]]&&l[u[1]].transition)return n({key:r,value:a,valueSpec:o.transition,style:i,styleSpec:o});let c=t.valueSpec||l[s];if(!c)return[new C(r,a,'unknown property "'.concat(s,'"'))];let p;if(j(a)==="string"&&It(c)&&!c.tokens&&(p=/^{([^}]+)}$/.exec(a)))return[new C(r,a,'"'.concat(s,'" does not support interpolation syntax\\n')+'Use an identity property function instead: \`{ "type": "identity", "property": '.concat(JSON.stringify(p[1])," }\`."))];let f=[];return t.layerType==="symbol"&&(s==="text-field"&&i&&!i.glyphs&&f.push(new C(r,a,'use of "text-field" requires a style "glyphs" property')),s==="text-font"&&Io(Jt(a))&&le(a.type)==="identity"&&f.push(new C(r,a,'"text-font" does not support identity functions'))),f.concat(n({key:t.key,value:a,valueSpec:c,style:i,styleSpec:o,expressionContext:"property",propertyType:e,propertyKey:s}))}function Ic(t){return _c(t,"paint")}function Tc(t){return _c(t,"layout")}function Cc(t){let e=[],r=t.value,n=t.key,i=t.style,o=t.styleSpec;if(j(r)!=="object")return[new C(n,r,"object expected, ".concat(j(r)," found"))];!r.type&&!r.ref&&e.push(new C(n,r,'either "type" or "ref" is required'));let a=le(r.type),s=le(r.ref);if(r.id){let l=le(r.id);for(let u=0;u<t.arrayIndex;u++){let c=i.layers[u];le(c.id)===l&&e.push(new C(n,r.id,'duplicate layer id "'.concat(r.id,'", previously used at line ').concat(c.id.__line__)))}}if("ref"in r){["type","source","source-layer","filter","layout"].forEach(u=>{u in r&&e.push(new C(n,r[u],'"'.concat(u,'" is prohibited for ref layers')))});let l;i.layers.forEach(u=>{le(u.id)===s&&(l=u)}),l?l.ref?e.push(new C(n,r.ref,"ref cannot reference another ref layer")):a=le(l.type):e.push(new C(n,r.ref,'ref layer "'.concat(s,'" not found')))}else if(a!=="background")if(!r.source)e.push(new C(n,r,'missing required property "source"'));else{let l=i.sources&&i.sources[r.source],u=l&&le(l.type);l?u==="vector"&&a==="raster"?e.push(new C(n,r.source,'layer "'.concat(r.id,'" requires a raster source'))):u!=="raster-dem"&&a==="hillshade"?e.push(new C(n,r.source,'layer "'.concat(r.id,'" requires a raster-dem source'))):u!=="raster-dem"&&a==="color-relief"?e.push(new C(n,r.source,'layer "'.concat(r.id,'" requires a raster-dem source'))):u==="raster"&&a!=="raster"?e.push(new C(n,r.source,'layer "'.concat(r.id,'" requires a vector source'))):u==="vector"&&!r["source-layer"]?e.push(new C(n,r,'layer "'.concat(r.id,'" must specify a "source-layer"'))):u==="raster-dem"&&a!=="hillshade"&&a!=="color-relief"?e.push(new C(n,r.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):a==="line"&&r.paint&&r.paint["line-gradient"]&&(u!=="geojson"||!l.lineMetrics)&&e.push(new C(n,r,'layer "'.concat(r.id,'" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.'))):e.push(new C(n,r.source,'source "'.concat(r.source,'" not found')))}return e=e.concat(Re({key:n,value:r,valueSpec:o.layer,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{"*"(){return[]},type(){return t.validateSpec({key:"".concat(n,".type"),value:r.type,valueSpec:o.layer.type,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,object:r,objectKey:"type"})},filter:Hs,layout(l){return Re({layer:r,key:l.key,value:l.value,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*"(u){return Tc(vr({layerType:a},u))}}})},paint(l){return Re({layer:r,key:l.key,value:l.value,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*"(u){return Ic(vr({layerType:a},u))}}})}}})),e}function Yt(t){let e=t.value,r=t.key,n=j(e);return n!=="string"?[new C(r,e,"string expected, ".concat(n," found"))]:[]}function Kd(t){var e;let r=(e=t.sourceName)!==null&&e!==void 0?e:"",n=t.value,i=t.styleSpec,o=i.source_raster_dem,a=t.style,s=[],l=j(n);if(n===void 0)return s;if(l!=="object")return s.push(new C("source_raster_dem",n,"object expected, ".concat(l," found"))),s;let c=le(n.encoding)==="custom",p=["redFactor","greenFactor","blueFactor","baseShift"],f=t.value.encoding?'"'.concat(t.value.encoding,'"'):"Default";for(let y in n)!c&&p.includes(y)?s.push(new C(y,n[y],'In "'.concat(r,'": "').concat(y,'" is only valid when "encoding" is set to "custom". ').concat(f," encoding found"))):o[y]?s=s.concat(t.validateSpec({key:y,value:n[y],valueSpec:o[y],validateSpec:t.validateSpec,style:a,styleSpec:i})):s.push(new C(y,n[y],'unknown property "'.concat(y,'"')));return s}var Ju={promoteId:Qd};function kc(t){let e=t.value,r=t.key,n=t.styleSpec,i=t.style,o=t.validateSpec;if(!e.type)return[new C(r,e,'"type" is required')];let a=le(e.type),s;switch(a){case"vector":case"raster":return s=Re({key:r,value:e,valueSpec:n["source_".concat(a.replace("-","_"))],style:t.style,styleSpec:n,objectElementValidators:Ju,validateSpec:o}),s;case"raster-dem":return s=Kd({sourceName:r,value:e,style:t.style,styleSpec:n,validateSpec:o}),s;case"geojson":if(s=Re({key:r,value:e,valueSpec:n.source_geojson,style:i,styleSpec:n,validateSpec:o,objectElementValidators:Ju}),e.cluster)for(let l in e.clusterProperties){let[u,c]=e.clusterProperties[l],p=typeof u=="string"?[u,["accumulated"],["get",l]]:u;s.push(...wr({key:"".concat(r,".").concat(l,".map"),value:c,expressionContext:"cluster-map"})),s.push(...wr({key:"".concat(r,".").concat(l,".reduce"),value:p,expressionContext:"cluster-reduce"}))}return s;case"video":return Re({key:r,value:e,valueSpec:n.source_video,style:i,validateSpec:o,styleSpec:n});case"image":return Re({key:r,value:e,valueSpec:n.source_image,style:i,validateSpec:o,styleSpec:n});case"canvas":return[new C(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return vn({key:"".concat(r,".type"),value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Qd({key:t,value:e}){if(j(e)==="string")return Yt({key:t,value:e});{let r=[];for(let n in e)r.push(...Yt({key:"".concat(t,".").concat(n),value:e[n]}));return r}}function Fc(t){let e=t.value,r=t.styleSpec,n=r.light,i=t.style,o=[],a=j(e);if(e===void 0)return o;if(a!=="object")return o=o.concat([new C("light",e,"object expected, ".concat(a," found"))]),o;for(let s in e){let l=s.match(/^(.*)-transition$/);l&&n[l[1]]&&n[l[1]].transition?o=o.concat(t.validateSpec({key:s,value:e[s],valueSpec:r.transition,validateSpec:t.validateSpec,style:i,styleSpec:r})):n[s]?o=o.concat(t.validateSpec({key:s,value:e[s],valueSpec:n[s],validateSpec:t.validateSpec,style:i,styleSpec:r})):o=o.concat([new C(s,e[s],'unknown property "'.concat(s,'"'))])}return o}function Ec(t){let e=t.value,r=t.styleSpec,n=r.sky,i=t.style,o=j(e);if(e===void 0)return[];if(o!=="object")return[new C("sky",e,"object expected, ".concat(o," found"))];let a=[];for(let s in e)n[s]?a=a.concat(t.validateSpec({key:s,value:e[s],valueSpec:n[s],style:i,styleSpec:r})):a=a.concat([new C(s,e[s],'unknown property "'.concat(s,'"'))]);return a}function Mc(t){let e=t.value,r=t.styleSpec,n=r.terrain,i=t.style,o=[],a=j(e);if(e===void 0)return o;if(a!=="object")return o=o.concat([new C("terrain",e,"object expected, ".concat(a," found"))]),o;for(let s in e)n[s]?o=o.concat(t.validateSpec({key:s,value:e[s],valueSpec:n[s],validateSpec:t.validateSpec,style:i,styleSpec:r})):o=o.concat([new C(s,e[s],'unknown property "'.concat(s,'"'))]);return o}function eg(t){return Yt(t).length===0?[]:wr(t)}function tg(t){return Yt(t).length===0?[]:wr(t)}function rg(t){let e=t.key,r=t.value;if(j(r)==="array"){if(r.length<1||r.length>4)return[new C(e,r,"padding requires 1 to 4 values; ".concat(r.length," values found"))];let i={type:"number"},o=[];for(let a=0;a<r.length;a++)o=o.concat(t.validateSpec({key:"".concat(e,"[").concat(a,"]"),value:r[a],validateSpec:t.validateSpec,valueSpec:i}));return o}else return Co({key:e,value:r,valueSpec:{}})}function ng(t){let e=t.key,r=t.value;if(j(r)==="array"){let i={type:"number"};if(r.length<1)return[new C(e,r,"array length at least 1 expected, length 0 found")];let o=[];for(let a=0;a<r.length;a++)o=o.concat(t.validateSpec({key:"".concat(e,"[").concat(a,"]"),value:r[a],validateSpec:t.validateSpec,valueSpec:i}));return o}else return Co({key:e,value:r,valueSpec:{}})}function ig(t){let e=t.key,r=t.value;if(j(r)==="array"){if(r.length<1)return[new C(e,r,"array length at least 1 expected, length 0 found")];let i=[];for(let o=0;o<r.length;o++)i=i.concat(Os({key:"".concat(e,"[").concat(o,"]"),value:r[o]}));return i}else return Os({key:e,value:r})}function og(t){let e=t.key,r=t.value,n=j(r),i=t.styleSpec;if(n!=="array"||r.length<1||r.length%2!==0)return[new C(e,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let o=[];for(let a=0;a<r.length;a+=2)o=o.concat(vn({key:"".concat(e,"[").concat(a,"]"),value:r[a],valueSpec:i.layout_symbol["text-anchor"]})),o=o.concat(Xs({key:"".concat(e,"[").concat(a+1,"]"),value:r[a+1],valueSpec:{length:2,value:"number"},validateSpec:t.validateSpec,style:t.style,styleSpec:i}));return o}function Lc(t){let e=[],r=t.value,n=t.key;if(Array.isArray(r)){let i=[],o=[];for(let a in r){r[a].id&&i.includes(r[a].id)&&e.push(new C(n,r,"all the sprites' ids must be unique, but ".concat(r[a].id," is duplicated"))),i.push(r[a].id),r[a].url&&o.includes(r[a].url)&&e.push(new C(n,r,"all the sprites' URLs must be unique, but ".concat(r[a].url," is duplicated"))),o.push(r[a].url);let s={id:{type:"string",required:!0},url:{type:"string",required:!0}};e=e.concat(Re({key:"".concat(n,"[").concat(a,"]"),value:r[a],valueSpec:s,validateSpec:t.validateSpec}))}return e}else return Yt({key:n,value:r})}function ag(t){let e=t.value,r=t.styleSpec,n=r.projection,i=t.style,o=j(e);if(e===void 0)return[];if(o!=="object")return[new C("projection",e,"object expected, ".concat(o," found"))];let a=[];for(let s in e)n[s]?a=a.concat(t.validateSpec({key:s,value:e[s],valueSpec:n[s],style:i,styleSpec:r})):a=a.concat([new C(s,e[s],'unknown property "'.concat(s,'"'))]);return a}function sg(t){let e=t.key,r=t.value;r=r instanceof String?r.valueOf():r;let n=j(r);return n==="array"&&!ug(r)&&!lg(r)?[new C(e,r,"projection expected, invalid array ".concat(JSON.stringify(r)," found"))]:["array","string"].includes(n)?[]:[new C(e,r,'projection expected, invalid type "'.concat(n,'" found'))]}function lg(t){return!!["interpolate","step","literal"].includes(t[0])}function ug(t){return Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"}function cg(t){return!!t&&t.constructor===Object}function Dc(t){return cg(t.value)?[]:[new C(t.key,t.value,"object expected, ".concat(j(t.value)," found"))]}var Yu={"*"(){return[]},array:Xs,boolean:Yd,number:Co,color:Os,constants:Sc,enum:vn,filter:Hs,function:wc,layer:Cc,object:Re,source:kc,light:Fc,sky:Ec,terrain:Mc,projection:ag,projectionDefinition:sg,string:Yt,formatted:eg,resolvedImage:tg,padding:rg,numberArray:ng,colorArray:ig,variableAnchorOffsetCollection:og,sprite:Lc,state:Dc};function ho(t){let e=t.value,r=t.valueSpec,n=t.styleSpec;return t.validateSpec=ho,r.expression&&Io(le(e))?wc(t):r.expression&&An(Jt(e))?wr(t):r.type&&Yu[r.type]?Yu[r.type](t):Re(vr({},t,{valueSpec:r.type?n[r.type]:r}))}function Bc(t){let e=t.value,r=t.key,n=Yt(t);return n.length||(e.indexOf("{fontstack}")===-1&&n.push(new C(r,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&n.push(new C(r,e,'"glyphs" url must include a "{range}" token'))),n}function Me(t,e=P){let r=[];return r=r.concat(ho({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,validateSpec:ho,objectElementValidators:{glyphs:Bc,"*"(){return[]}}})),t.constants&&(r=r.concat(Sc({key:"constants",value:t.constants}))),Vc(r)}Me.source=qe(je(kc));Me.sprite=qe(je(Lc));Me.glyphs=qe(je(Bc));Me.light=qe(je(Fc));Me.sky=qe(je(Ec));Me.terrain=qe(je(Mc));Me.state=qe(je(Dc));Me.layer=qe(je(Cc));Me.filter=qe(je(Hs));Me.paintProperty=qe(je(Ic));Me.layoutProperty=qe(je(Tc));function je(t){return function(e){return t(Xi($t({},e),{validateSpec:ho}))}}function Vc(t){return[].concat(t).sort((e,r)=>e.line-r.line)}function qe(t){return function(...e){return Vc(t.apply(this,e))}}var Rc="AbortError";function zc(t){return t.message===Rc}function Zs(){return new Error(Rc)}var ko={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Oc(t){return ko.REGISTERED_PROTOCOLS[t.substring(0,t.indexOf("://"))]}function Gc(t,e){ko.REGISTERED_PROTOCOLS[t]=e}function Nc(t){delete ko.REGISTERED_PROTOCOLS[t]}var Uc="global-dispatcher",tr=class extends Error{constructor(e,r,n,i){super("AJAXError: ".concat(r," (").concat(e,"): ").concat(n)),this.status=e,this.statusText=r,this.url=n,this.body=i}},jc=()=>at(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,pg=t=>/^file:/.test(t)||/^file:/.test(jc())&&!/^\\w+:/.test(t);async function fg(t,e){let r=new Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,cache:t.cache,referrer:jc(),signal:e.signal});t.type==="json"&&!r.headers.has("Accept")&&r.headers.set("Accept","application/json");let n;try{n=await fetch(r)}catch(a){throw new tr(0,a.message,t.url,new Blob)}if(!n.ok){let a=await n.blob();throw new tr(n.status,n.statusText,t.url,a)}let i;t.type==="arrayBuffer"||t.type==="image"?i=n.arrayBuffer():t.type==="json"?i=n.json():i=n.text();let o=await i;if(e.signal.aborted)throw Zs();return{data:o,cacheControl:n.headers.get("Cache-Control"),expires:n.headers.get("Expires")}}function yg(t,e){return new Promise((r,n)=>{var o;let i=new XMLHttpRequest;i.open(t.method||"GET",t.url,!0),(t.type==="arrayBuffer"||t.type==="image")&&(i.responseType="arraybuffer");for(let a in t.headers)i.setRequestHeader(a,t.headers[a]);t.type==="json"&&(i.responseType="text",(o=t.headers)!=null&&o.Accept||i.setRequestHeader("Accept","application/json")),i.withCredentials=t.credentials==="include",i.onerror=()=>{n(new Error(i.statusText))},i.onload=()=>{if(!e.signal.aborted)if((i.status>=200&&i.status<300||i.status===0)&&i.response!==null){let a=i.response;if(t.type==="json")try{a=JSON.parse(i.response)}catch(s){n(s);return}r({data:a,cacheControl:i.getResponseHeader("Cache-Control"),expires:i.getResponseHeader("Expires")})}else{let a=new Blob([i.response],{type:i.getResponseHeader("Content-Type")});n(new tr(i.status,i.statusText,t.url,a))}},e.signal.addEventListener("abort",()=>{i.abort(),n(Zs())}),i.send(t.body)})}var qc=function(t,e){if(/:\\/\\//.test(t.url)&&!/^https?:|^file:/.test(t.url)){let r=Oc(t.url);if(r)return r(t,e);if(at(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:t,targetMapId:Uc},e)}if(!pg(t.url)){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return fg(t,e);if(at(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:t,mustQueue:!0,targetMapId:Uc},e)}return yg(t,e)},Wc=(t,e)=>qc(de(t,{type:"json"}),e),Xc=(t,e)=>qc(de(t,{type:"arrayBuffer"}),e);var ut={};function I(t,e,r={}){if(ut[t])throw new Error("".concat(t," is already registered."));Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),ut[t]={klass:e,omit:r.omit||[],shallow:r.shallow||[]}}I("Object",Object);I("Set",Set);I("TransferableGridIndex",jt);I("Color",H);I("Error",Error);I("AJAXError",tr);I("ResolvedImage",Se);I("StylePropertyFunction",bn);I("StyleExpression",Zt,{omit:["_evaluator"]});I("ZoomDependentExpression",Tt);I("ZoomConstantExpression",Je);I("CompoundExpression",Ze,{omit:["_evaluate"]});for(let t in Qt)Qt[t]._classRegistryKey||I("Expression_".concat(t),Qt[t]);function Hc(t){return t&&typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||t.constructor&&t.constructor.name==="ArrayBuffer")}function Js(t){let e=t.constructor;return t.$name||e._classRegistryKey}function mg(t){if(t===null||typeof t!="object")return!1;let e=Js(t);return!!(e&&e!=="Object")}function Zc(t){return!mg(t)&&(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob||t instanceof Error||Hc(t)||vt(t)||ArrayBuffer.isView(t)||t instanceof ImageData)}function Cr(t,e){if(Zc(t)){if((Hc(t)||vt(t))&&e&&e.push(t),ArrayBuffer.isView(t)){let o=t;e&&e.push(o.buffer)}return t instanceof ImageData&&e&&e.push(t.data.buffer),t}if(Array.isArray(t)){let o=[];for(let a of t)o.push(Cr(a,e));return o}if(typeof t!="object")throw new Error("can't serialize object of type ".concat(typeof t));let r=Js(t);if(!r)throw new Error("can't serialize object of unregistered class ".concat(t.constructor.name));if(!ut[r])throw new Error("".concat(r," is not registered."));let{klass:n}=ut[r],i=n.serialize?n.serialize(t,e):{};if(n.serialize){if(e&&i===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(let o in t){if(!t.hasOwnProperty(o)||ut[r].omit.indexOf(o)>=0)continue;let a=t[o];i[o]=ut[r].shallow.indexOf(o)>=0?a:Cr(a,e)}t instanceof Error&&(i.message=t.message)}if(i.$name)throw new Error("$name property is reserved for worker serialization logic.");return r!=="Object"&&(i.$name=r),i}function kr(t){if(Zc(t))return t;if(Array.isArray(t))return t.map(kr);if(typeof t!="object")throw new Error("can't deserialize object of type ".concat(typeof t));let e=Js(t)||"Object";if(!ut[e])throw new Error("can't deserialize unregistered class ".concat(e));let{klass:r}=ut[e];if(!r)throw new Error("can't deserialize unregistered class ".concat(e));if(r.deserialize)return r.deserialize(t);let n=Object.create(r.prototype);for(let i of Object.keys(t)){if(i==="$name")continue;let o=t[i];n[i]=ut[e].shallow.indexOf(i)>=0?o:kr(o)}return n}var Fo=class{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}};var hg={once:!0},Eo=class{constructor(e,r){this.target=e,this.mapId=r,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Fo(()=>this.process()),this.subscription=ps(this.target,"message",n=>this.receive(n),!1),this.globalScope=at(self)?e:window}registerMessageHandler(e,r){this.messageHandlers[e]=r}sendAsync(e,r){return new Promise((n,i)=>{let o=Math.round(Math.random()*1e18).toString(36).substring(0,10),a=r?ps(r.signal,"abort",()=>{a==null||a.unsubscribe(),delete this.resolveRejects[o];let u={id:o,type:"<cancel>",origin:location.origin,targetMapId:e.targetMapId,sourceMapId:this.mapId};this.target.postMessage(u)},hg):null;this.resolveRejects[o]={resolve:u=>{a==null||a.unsubscribe(),n(u)},reject:u=>{a==null||a.unsubscribe(),i(u)}};let s=[],l=Xi($t({},e),{id:o,sourceMapId:this.mapId,origin:location.origin,data:Cr(e.data,s)});this.target.postMessage(l,{transfer:s})})}receive(e){let r=e.data,n=r.id;if(!(r.origin!=="file://"&&location.origin!=="file://"&&r.origin!=="resource://android"&&location.origin!=="resource://android"&&r.origin!==location.origin)&&!(r.targetMapId&&this.mapId!==r.targetMapId)){if(r.type==="<cancel>"){delete this.tasks[n];let i=this.abortControllers[n];delete this.abortControllers[n],i&&i.abort();return}if(at(self)||r.mustQueue){this.tasks[n]=r,this.taskQueue.push(n),this.invoker.trigger();return}this.processTask(n,r)}}process(){if(this.taskQueue.length===0)return;let e=this.taskQueue.shift(),r=this.tasks[e];delete this.tasks[e],this.taskQueue.length>0&&this.invoker.trigger(),r&&this.processTask(e,r)}async processTask(e,r){if(r.type==="<response>"){let o=this.resolveRejects[e];if(delete this.resolveRejects[e],!o)return;r.error?o.reject(kr(r.error)):o.resolve(kr(r.data));return}if(!this.messageHandlers[r.type]){this.completeTask(e,new Error("Could not find a registered handler for ".concat(r.type,", map ID: ").concat(this.mapId,", available handlers: ").concat(Object.keys(this.messageHandlers).join(", "))));return}let n=kr(r.data),i=new AbortController;this.abortControllers[e]=i;try{let o=await this.messageHandlers[r.type](r.sourceMapId,n,i);this.completeTask(e,null,o)}catch(o){this.completeTask(e,o)}}completeTask(e,r,n){let i=[];delete this.abortControllers[e];let o={id:e,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:r?Cr(r):null,data:Cr(n,i)};this.target.postMessage(o,{transfer:i})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}};function Jc(t,e,r){r[t]&&r[t].indexOf(e)!==-1||(r[t]=r[t]||[],r[t].push(e))}function Ys(t,e,r){if(r&&r[t]){let n=r[t].indexOf(e);n!==-1&&r[t].splice(n,1)}}var Mo=class{constructor(e,r={}){de(this,r),this.type=e}},_n=class extends Mo{constructor(e,r={}){super("error",de({error:e},r))}},Lo=class{on(e,r){return this._listeners=this._listeners||{},Jc(e,r,this._listeners),{unsubscribe:()=>{this.off(e,r)}}}off(e,r){return Ys(e,r,this._listeners),Ys(e,r,this._oneTimeListeners),this}once(e,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},Jc(e,r,this._oneTimeListeners),this):new Promise(n=>this.once(e,n))}fire(e,r){typeof e=="string"&&(e=new Mo(e,r||{}));let n=e.type;if(this.listens(n)){e.target=this;let i=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];for(let s of i)s.call(this,e);let o=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];for(let s of o)Ys(n,s,this._oneTimeListeners),s.call(this,e);let a=this._eventedParent;a&&(de(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),a.fire(e))}else e instanceof _n&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,r){return this._eventedParent=e,this._eventedParentData=r,this}};var ct=Me,sv=ct.source,lv=ct.light,uv=ct.sky,cv=ct.terrain,pv=ct.filter,Yc=ct.paintProperty,Kc=ct.layoutProperty;function Qc(t,e){let r=!1;if(e&&e.length)for(let n of e)t.fire(new _n(new Error(n.message))),r=!0;return r}var In=class{constructor(){this.first=!0}update(e,r){let n=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=r),e!==this.lastZoom?(this.lastZoom=e,this.lastFloorZoom=n,!0):!1)}};var q={"Latin-1 Supplement":t=>t>=128&&t<=255,"Hangul Jamo":t=>t>=4352&&t<=4607,Khmer:t=>t>=6016&&t<=6143,"General Punctuation":t=>t>=8192&&t<=8303,"Letterlike Symbols":t=>t>=8448&&t<=8527,"Number Forms":t=>t>=8528&&t<=8591,"Miscellaneous Technical":t=>t>=8960&&t<=9215,"Control Pictures":t=>t>=9216&&t<=9279,"Optical Character Recognition":t=>t>=9280&&t<=9311,"Enclosed Alphanumerics":t=>t>=9312&&t<=9471,"Geometric Shapes":t=>t>=9632&&t<=9727,"Miscellaneous Symbols":t=>t>=9728&&t<=9983,"Miscellaneous Symbols and Arrows":t=>t>=11008&&t<=11263,"Ideographic Description Characters":t=>t>=12272&&t<=12287,"CJK Symbols and Punctuation":t=>t>=12288&&t<=12351,Hiragana:t=>t>=12352&&t<=12447,Katakana:t=>t>=12448&&t<=12543,Kanbun:t=>t>=12688&&t<=12703,"CJK Strokes":t=>t>=12736&&t<=12783,"Enclosed CJK Letters and Months":t=>t>=12800&&t<=13055,"CJK Compatibility":t=>t>=13056&&t<=13311,"Yijing Hexagram Symbols":t=>t>=19904&&t<=19967,"CJK Unified Ideographs":t=>t>=19968&&t<=40959,"Hangul Syllables":t=>t>=44032&&t<=55215,"Private Use Area":t=>t>=57344&&t<=63743,"Vertical Forms":t=>t>=65040&&t<=65055,"CJK Compatibility Forms":t=>t>=65072&&t<=65103,"Small Form Variants":t=>t>=65104&&t<=65135,"Halfwidth and Fullwidth Forms":t=>t>=65280&&t<=65519};function Tn(t){for(let e of t)if(Do(e.charCodeAt(0)))return!0;return!1}function ep(t){for(let e of t)if(!xg(e.charCodeAt(0)))return!1;return!0}function Ks(t){let e=t.map(r=>{try{return new RegExp("\\\\p{sc=".concat(r,"}"),"u").source}catch(n){return null}}).filter(r=>r);return new RegExp(e.join("|"),"u")}var dg=["Arab","Dupl","Mong","Ougr","Syrc"],gg=Ks(dg);function xg(t){return!gg.test(String.fromCodePoint(t))}var bg=["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"],tp=Ks(bg);function rp(t){return t<11904?!1:q["CJK Compatibility Forms"](t)||q["CJK Compatibility"](t)||q["CJK Strokes"](t)||q["CJK Symbols and Punctuation"](t)||q["Enclosed CJK Letters and Months"](t)||q["Halfwidth and Fullwidth Forms"](t)||q["Ideographic Description Characters"](t)||q["Vertical Forms"](t)?!0:tp.test(String.fromCodePoint(t))}function Do(t){return t===746||t===747?!0:t<4352?!1:!!(q["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||q["CJK Compatibility"](t)||q["CJK Strokes"](t)||q["CJK Symbols and Punctuation"](t)&&!(t>=12296&&t<=12305)&&!(t>=12308&&t<=12319)&&t!==12336||q["Enclosed CJK Letters and Months"](t)||q["Ideographic Description Characters"](t)||q.Kanbun(t)||q.Katakana(t)&&t!==12540||q["Halfwidth and Fullwidth Forms"](t)&&t!==65288&&t!==65289&&t!==65293&&!(t>=65306&&t<=65310)&&t!==65339&&t!==65341&&t!==65343&&!(t>=65371&&t<=65503)&&t!==65507&&!(t>=65512&&t<=65519)||q["Small Form Variants"](t)&&!(t>=65112&&t<=65118)&&!(t>=65123&&t<=65126)||q["Vertical Forms"](t)||q["Yijing Hexagram Symbols"](t)||new RegExp("\\\\p{sc=Cans}","u").test(String.fromCodePoint(t))||new RegExp("\\\\p{sc=Hang}","u").test(String.fromCodePoint(t))||tp.test(String.fromCodePoint(t)))}function vg(t){return!!(q["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||q["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||q["Letterlike Symbols"](t)||q["Number Forms"](t)||q["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||q["Control Pictures"](t)&&t!==9251||q["Optical Character Recognition"](t)||q["Enclosed Alphanumerics"](t)||q["Geometric Shapes"](t)||q["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||q["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||q["CJK Symbols and Punctuation"](t)||q.Katakana(t)||q["Private Use Area"](t)||q["CJK Compatibility Forms"](t)||q["Small Form Variants"](t)||q["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}function Qs(t){return!(Do(t)||vg(t))}function np(t){return new RegExp("\\\\p{sc=Arab}","u").test(String.fromCodePoint(t))}var Pg=["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"],Sg=Ks(Pg);function ip(t){return Sg.test(String.fromCodePoint(t))}function wg(t,e){return!(!e&&ip(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||q.Khmer(t))}function op(t){for(let e of t)if(ip(e.charCodeAt(0)))return!0;return!1}function ap(t,e){for(let r of t)if(!wg(r.charCodeAt(0),e))return!1;return!0}var el=class{constructor(){this.TIMEOUT=5e3;this.applyArabicShaping=null;this.processBidirectionalText=null;this.processStyledBidirectionalText=null;this.pluginStatus="unavailable";this.pluginURL=null;this.loadScriptResolve=()=>{}}setState(e){this.pluginStatus=e.pluginStatus,this.pluginURL=e.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(e){if(we.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=e.applyArabicShaping,this.processBidirectionalText=e.processBidirectionalText,this.processStyledBidirectionalText=e.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}async syncState(e,r){if(this.isParsed())return this.getState();if(e.pluginStatus!=="loading")return this.setState(e),e;let n=e.pluginURL,i=new Promise(s=>{this.loadScriptResolve=s});r(n);let o=new Promise(s=>setTimeout(()=>s(),this.TIMEOUT));if(await Promise.race([i,o]),this.isParsed()){let s={pluginStatus:"loaded",pluginURL:n};return this.setState(s),s}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error("RTL Text Plugin failed to import scripts from ".concat(n))}},we=new el;var W=class{constructor(e,r){this.zoom=e,r?(this.now=r.now||0,this.fadeDuration=r.fadeDuration||0,this.zoomHistory=r.zoomHistory||new In,this.transition=r.transition||{},this.globalState=r.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new In,this.transition={},this.globalState={})}isSupportedScript(e){return ap(e,we.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let e=this.zoom,r=e-Math.floor(e),n=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*r}}};var Fr=class{constructor(e,r){this.property=e,this.value=r,this.expression=bc(r===void 0?e.specification.default:r,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(e,r,n){return this.property.possiblyEvaluate(this,e,r,n)}},Cn=class{constructor(e){this.property=e,this.value=new Fr(e,void 0)}transitioned(e,r){return new Vo(this.property,this.value,r,de({},e.transition,this.transition),e.now)}untransitioned(){return new Vo(this.property,this.value,null,{},0)}},Bo=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return nt(this._values[e].value.value)}setValue(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Cn(this._values[e].property)),this._values[e].value=new Fr(this._values[e].property,r===null?void 0:nt(r))}getTransition(e){return nt(this._values[e].transition)}setTransition(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Cn(this._values[e].property)),this._values[e].transition=nt(r)||void 0}serialize(){let e={};for(let r of Object.keys(this._values)){let n=this.getValue(r);n!==void 0&&(e[r]=n);let i=this.getTransition(r);i!==void 0&&(e["".concat(r,"-transition")]=i)}return e}transitioned(e,r){let n=new Ro(this._properties);for(let i of Object.keys(this._values))n._values[i]=this._values[i].transitioned(e,r._values[i]);return n}untransitioned(){let e=new Ro(this._properties);for(let r of Object.keys(this._values))e._values[r]=this._values[r].untransitioned();return e}},Vo=class{constructor(e,r,n,i,o){this.property=e,this.value=r,this.begin=o+i.delay||0,this.end=this.begin+i.duration||0,e.specification.transition&&(i.delay||i.duration)&&(this.prior=n)}possiblyEvaluate(e,r,n){let i=e.now||0,o=this.value.possiblyEvaluate(e,r,n),a=this.prior;if(a){if(i>this.end)return this.prior=null,o;if(this.value.isDataDriven())return this.prior=null,o;if(i<this.begin)return a.possiblyEvaluate(e,r,n);{let s=(i-this.begin)/(this.end-this.begin);return this.property.interpolate(a.possiblyEvaluate(e,r,n),o,Tu(s))}}else return o}},Ro=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,r,n){let i=new kt(this._properties);for(let o of Object.keys(this._values))i._values[o]=this._values[o].possiblyEvaluate(e,r,n);return i}hasTransition(){for(let e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}},zo=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return this._values[e].value!==void 0}getValue(e){return nt(this._values[e].value)}setValue(e,r){this._values[e]=new Fr(this._values[e].property,r===null?void 0:nt(r))}serialize(){let e={};for(let r of Object.keys(this._values)){let n=this.getValue(r);n!==void 0&&(e[r]=n)}return e}possiblyEvaluate(e,r,n){let i=new kt(this._properties);for(let o of Object.keys(this._values))i._values[o]=this._values[o].possiblyEvaluate(e,r,n);return i}},ge=class{constructor(e,r,n){this.property=e,this.value=r,this.parameters=n}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,r,n,i){return this.property.evaluate(this.value,this.parameters,e,r,n,i)}},kt=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}},F=class{constructor(e){this.specification=e}possiblyEvaluate(e,r){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(r)}interpolate(e,r,n){let i=this.specification.type,o=lt[i];return o?o(e,r,n):e}},L=class{constructor(e,r){this.specification=e,this.overrides=r}possiblyEvaluate(e,r,n,i){return e.expression.kind==="constant"||e.expression.kind==="camera"?new ge(this,{kind:"constant",value:e.expression.evaluate(r,null,{},n,i)},r):new ge(this,e.expression,r)}interpolate(e,r,n){if(e.value.kind!=="constant"||r.value.kind!=="constant")return e;if(e.value.value===void 0||r.value.value===void 0)return new ge(this,{kind:"constant",value:void 0},e.parameters);let i=this.specification.type,o=lt[i];if(o){let a=o(e.value.value,r.value.value,n);return new ge(this,{kind:"constant",value:a},e.parameters)}else return e}evaluate(e,r,n,i,o,a){return e.kind==="constant"?e.value:e.evaluate(r,n,i,o,a)}},pt=class extends L{possiblyEvaluate(e,r,n,i){if(e.value===void 0)return new ge(this,{kind:"constant",value:void 0},r);if(e.expression.kind==="constant"){let o=e.expression.evaluate(r,null,{},n,i),s=e.property.specification.type==="resolvedImage"&&typeof o!="string"?o.name:o,l=this._calculate(s,s,s,r);return new ge(this,{kind:"constant",value:l},r)}else if(e.expression.kind==="camera"){let o=this._calculate(e.expression.evaluate({zoom:r.zoom-1}),e.expression.evaluate({zoom:r.zoom}),e.expression.evaluate({zoom:r.zoom+1}),r);return new ge(this,{kind:"constant",value:o},r)}else return new ge(this,e.expression,r)}evaluate(e,r,n,i,o,a){if(e.kind==="source"){let s=e.evaluate(r,n,i,o,a);return this._calculate(s,s,s,r)}else return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(r.zoom)-1},n,i),e.evaluate({zoom:Math.floor(r.zoom)},n,i),e.evaluate({zoom:Math.floor(r.zoom)+1},n,i),r):e.value}_calculate(e,r,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:n,to:r}}interpolate(e){return e}},rr=class{constructor(e){this.specification=e}possiblyEvaluate(e,r,n,i){if(e.value!==void 0)if(e.expression.kind==="constant"){let o=e.expression.evaluate(r,null,{},n,i);return this._calculate(o,o,o,r)}else return this._calculate(e.expression.evaluate(new W(Math.floor(r.zoom-1),r)),e.expression.evaluate(new W(Math.floor(r.zoom),r)),e.expression.evaluate(new W(Math.floor(r.zoom+1),r)),r)}_calculate(e,r,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:n,to:r}}interpolate(e){return e}},ft=class{constructor(e){this.specification=e}possiblyEvaluate(e,r,n,i){return!!e.expression.evaluate(r,null,{},n,i)}interpolate(){return!1}},ee=class{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(let r in e){let n=e[r];n.specification.overridable&&this.overridableProperties.push(r);let i=this.defaultPropertyValues[r]=new Fr(n,void 0),o=this.defaultTransitionablePropertyValues[r]=new Cn(n);this.defaultTransitioningPropertyValues[r]=o.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=i.possiblyEvaluate({})}}};I("DataDrivenProperty",L);I("DataConstantProperty",F);I("CrossFadedDataDrivenProperty",pt);I("CrossFadedProperty",rr);I("ColorRampProperty",ft);var Oo="-transition",oe=class extends Lo{constructor(e,r){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},e.type!=="custom"&&(e=e,this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter,this._featureFilter=Ct(e.filter)),r.layout&&(this._unevaluatedLayout=new zo(r.layout)),r.paint)){this._transitionablePaint=new Bo(r.paint);for(let n in e.paint)this.setPaintProperty(n,e.paint[n],{validate:!1});for(let n in e.layout)this.setLayoutProperty(n,e.layout[n],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new kt(r.paint)}}setFilter(e){this.filter=e,this._featureFilter=Ct(e)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}getLayoutAffectingGlobalStateRefs(){let e=new Set;if(this._unevaluatedLayout)for(let r in this._unevaluatedLayout._values){let n=this._unevaluatedLayout._values[r];for(let i of n.getGlobalStateRefs())e.add(i)}for(let r of this._featureFilter.getGlobalStateRefs())e.add(r);return e}setLayoutProperty(e,r,n={}){if(r!=null){let i="layers.".concat(this.id,".layout.").concat(e);if(this._validate(Kc,i,e,r,n))return}if(e==="visibility"){this.visibility=r;return}this._unevaluatedLayout.setValue(e,r)}getPaintProperty(e){return e.endsWith(Oo)?this._transitionablePaint.getTransition(e.slice(0,-Oo.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,r,n={}){if(r!=null){let i="layers.".concat(this.id,".paint.").concat(e);if(this._validate(Yc,i,e,r,n))return!1}if(e.endsWith(Oo))return this._transitionablePaint.setTransition(e.slice(0,-Oo.length),r||void 0),!1;{let i=this._transitionablePaint._values[e],o=i.property.specification["property-type"]==="cross-faded-data-driven",a=i.value.isDataDriven(),s=i.value;this._transitionablePaint.setValue(e,r),this._handleSpecialPaintPropertyUpdate(e);let l=this._transitionablePaint._values[e].value;return l.isDataDriven()||a||o||this._handleOverridablePaintPropertyUpdate(e,s,l)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,r,n){return!1}isHidden(e){return this.minzoom&&e<this.minzoom||this.maxzoom&&e>=this.maxzoom?!0:this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,r){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,r)}serialize(){let e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Fu(e,(r,n)=>r!==void 0&&!(n==="layout"&&!Object.keys(r).length)&&!(n==="paint"&&!Object.keys(r).length))}_validate(e,r,n,i,o={}){return o&&o.validate===!1?!1:Qc(this,e.call(ct,{key:r,layerType:this.type,objectKey:n,value:i,styleSpec:P,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let e in this.paint._values){let r=this.paint.get(e);if(!(!(r instanceof ge)||!It(r.property.specification))&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}};var Ag={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Ft=class{constructor(e,r){this._structArray=e,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}},_g=128,Ig=5,te=class{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,r){return e._trim(),r&&(e.isTransferred=!0,r.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){let r=Object.create(this.prototype);return r.arrayBuffer=e.arrayBuffer,r.length=e.length,r.capacity=e.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(this.capacity*Ig),_g),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}};function Q(t,e=1){let r=0,n=0,i=t.map(a=>{let s=Tg(a.type),l=r=sp(r,Math.max(e,s)),u=a.components||1;return n=Math.max(n,s),r+=s*u,{name:a.name,type:a.type,components:u,offset:l}}),o=sp(r,Math.max(n,e));return{members:i,size:o,alignment:e}}function Tg(t){return Ag[t].BYTES_PER_ELEMENT}function sp(t,e){return Math.ceil(t/e)*e}var lp=Y(ye(),1),nr=class extends te{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r){let n=this.length;return this.resize(n+1),this.emplace(n,e,r)}emplace(e,r,n){let i=e*2;return this.int16[i+0]=r,this.int16[i+1]=n,e}};nr.prototype.bytesPerElement=4;I("StructArrayLayout2i4",nr);var kn=class extends te{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,e,r,n)}emplace(e,r,n,i){let o=e*3;return this.int16[o+0]=r,this.int16[o+1]=n,this.int16[o+2]=i,e}};kn.prototype.bytesPerElement=6;I("StructArrayLayout3i6",kn);var Go=class extends te{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i){let o=this.length;return this.resize(o+1),this.emplace(o,e,r,n,i)}emplace(e,r,n,i,o){let a=e*4;return this.int16[a+0]=r,this.int16[a+1]=n,this.int16[a+2]=i,this.int16[a+3]=o,e}};Go.prototype.bytesPerElement=8;I("StructArrayLayout4i8",Go);var Fn=class extends te{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a){let s=this.length;return this.resize(s+1),this.emplace(s,e,r,n,i,o,a)}emplace(e,r,n,i,o,a,s){let l=e*6;return this.int16[l+0]=r,this.int16[l+1]=n,this.int16[l+2]=i,this.int16[l+3]=o,this.int16[l+4]=a,this.int16[l+5]=s,e}};Fn.prototype.bytesPerElement=12;I("StructArrayLayout2i4i12",Fn);var En=class extends te{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a){let s=this.length;return this.resize(s+1),this.emplace(s,e,r,n,i,o,a)}emplace(e,r,n,i,o,a,s){let l=e*4,u=e*8;return this.int16[l+0]=r,this.int16[l+1]=n,this.uint8[u+4]=i,this.uint8[u+5]=o,this.uint8[u+6]=a,this.uint8[u+7]=s,e}};En.prototype.bytesPerElement=8;I("StructArrayLayout2i4ub8",En);var Et=class extends te{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r){let n=this.length;return this.resize(n+1),this.emplace(n,e,r)}emplace(e,r,n){let i=e*2;return this.float32[i+0]=r,this.float32[i+1]=n,e}};Et.prototype.bytesPerElement=8;I("StructArrayLayout2f8",Et);var Mn=class extends te{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a,s,l,u,c){let p=this.length;return this.resize(p+1),this.emplace(p,e,r,n,i,o,a,s,l,u,c)}emplace(e,r,n,i,o,a,s,l,u,c,p){let f=e*10;return this.uint16[f+0]=r,this.uint16[f+1]=n,this.uint16[f+2]=i,this.uint16[f+3]=o,this.uint16[f+4]=a,this.uint16[f+5]=s,this.uint16[f+6]=l,this.uint16[f+7]=u,this.uint16[f+8]=c,this.uint16[f+9]=p,e}};Mn.prototype.bytesPerElement=20;I("StructArrayLayout10ui20",Mn);var Ln=class extends te{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a,s,l,u,c,p,f){let y=this.length;return this.resize(y+1),this.emplace(y,e,r,n,i,o,a,s,l,u,c,p,f)}emplace(e,r,n,i,o,a,s,l,u,c,p,f,y){let m=e*12;return this.int16[m+0]=r,this.int16[m+1]=n,this.int16[m+2]=i,this.int16[m+3]=o,this.uint16[m+4]=a,this.uint16[m+5]=s,this.uint16[m+6]=l,this.uint16[m+7]=u,this.int16[m+8]=c,this.int16[m+9]=p,this.int16[m+10]=f,this.int16[m+11]=y,e}};Ln.prototype.bytesPerElement=24;I("StructArrayLayout4i4ui4i24",Ln);var Dn=class extends te{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,e,r,n)}emplace(e,r,n,i){let o=e*3;return this.float32[o+0]=r,this.float32[o+1]=n,this.float32[o+2]=i,e}};Dn.prototype.bytesPerElement=12;I("StructArrayLayout3f12",Dn);var Bn=class extends te{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){let n=e*1;return this.uint32[n+0]=r,e}};Bn.prototype.bytesPerElement=4;I("StructArrayLayout1ul4",Bn);var Vn=class extends te{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a,s,l,u){let c=this.length;return this.resize(c+1),this.emplace(c,e,r,n,i,o,a,s,l,u)}emplace(e,r,n,i,o,a,s,l,u,c){let p=e*10,f=e*5;return this.int16[p+0]=r,this.int16[p+1]=n,this.int16[p+2]=i,this.int16[p+3]=o,this.int16[p+4]=a,this.int16[p+5]=s,this.uint32[f+3]=l,this.uint16[p+8]=u,this.uint16[p+9]=c,e}};Vn.prototype.bytesPerElement=20;I("StructArrayLayout6i1ul2ui20",Vn);var Rn=class extends te{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a){let s=this.length;return this.resize(s+1),this.emplace(s,e,r,n,i,o,a)}emplace(e,r,n,i,o,a,s){let l=e*6;return this.int16[l+0]=r,this.int16[l+1]=n,this.int16[l+2]=i,this.int16[l+3]=o,this.int16[l+4]=a,this.int16[l+5]=s,e}};Rn.prototype.bytesPerElement=12;I("StructArrayLayout2i2i2i12",Rn);var No=class extends te{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o){let a=this.length;return this.resize(a+1),this.emplace(a,e,r,n,i,o)}emplace(e,r,n,i,o,a){let s=e*4,l=e*8;return this.float32[s+0]=r,this.float32[s+1]=n,this.float32[s+2]=i,this.int16[l+6]=o,this.int16[l+7]=a,e}};No.prototype.bytesPerElement=16;I("StructArrayLayout2f1f2i16",No);var zn=class extends te{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a){let s=this.length;return this.resize(s+1),this.emplace(s,e,r,n,i,o,a)}emplace(e,r,n,i,o,a,s){let l=e*16,u=e*4,c=e*8;return this.uint8[l+0]=r,this.uint8[l+1]=n,this.float32[u+1]=i,this.float32[u+2]=o,this.int16[c+6]=a,this.int16[c+7]=s,e}};zn.prototype.bytesPerElement=16;I("StructArrayLayout2ub2f2i16",zn);var On=class extends te{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,e,r,n)}emplace(e,r,n,i){let o=e*3;return this.uint16[o+0]=r,this.uint16[o+1]=n,this.uint16[o+2]=i,e}};On.prototype.bytesPerElement=6;I("StructArrayLayout3ui6",On);var Gn=class extends te{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,g,d){let b=this.length;return this.resize(b+1),this.emplace(b,e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,g,d)}emplace(e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,g,d,b){let x=e*24,v=e*12,S=e*48;return this.int16[x+0]=r,this.int16[x+1]=n,this.uint16[x+2]=i,this.uint16[x+3]=o,this.uint32[v+2]=a,this.uint32[v+3]=s,this.uint32[v+4]=l,this.uint16[x+10]=u,this.uint16[x+11]=c,this.uint16[x+12]=p,this.float32[v+7]=f,this.float32[v+8]=y,this.uint8[S+36]=m,this.uint8[S+37]=h,this.uint8[S+38]=g,this.uint32[v+10]=d,this.int16[x+22]=b,e}};Gn.prototype.bytesPerElement=48;I("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Gn);var Nn=class extends te{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,g,d,b,x,v,S,A,w,T,E,D,B,z){let M=this.length;return this.resize(M+1),this.emplace(M,e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,g,d,b,x,v,S,A,w,T,E,D,B,z)}emplace(e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,g,d,b,x,v,S,A,w,T,E,D,B,z,M){let _=e*32,V=e*16;return this.int16[_+0]=r,this.int16[_+1]=n,this.int16[_+2]=i,this.int16[_+3]=o,this.int16[_+4]=a,this.int16[_+5]=s,this.int16[_+6]=l,this.int16[_+7]=u,this.uint16[_+8]=c,this.uint16[_+9]=p,this.uint16[_+10]=f,this.uint16[_+11]=y,this.uint16[_+12]=m,this.uint16[_+13]=h,this.uint16[_+14]=g,this.uint16[_+15]=d,this.uint16[_+16]=b,this.uint16[_+17]=x,this.uint16[_+18]=v,this.uint16[_+19]=S,this.uint16[_+20]=A,this.uint16[_+21]=w,this.uint16[_+22]=T,this.uint32[V+12]=E,this.float32[V+13]=D,this.float32[V+14]=B,this.uint16[_+30]=z,this.uint16[_+31]=M,e}};Nn.prototype.bytesPerElement=64;I("StructArrayLayout8i15ui1ul2f2ui64",Nn);var ir=class extends te{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){let n=e*1;return this.float32[n+0]=r,e}};ir.prototype.bytesPerElement=4;I("StructArrayLayout1f4",ir);var Un=class extends te{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,e,r,n)}emplace(e,r,n,i){let o=e*6,a=e*3;return this.uint16[o+0]=r,this.float32[a+1]=n,this.float32[a+2]=i,e}};Un.prototype.bytesPerElement=12;I("StructArrayLayout1ui2f12",Un);var $n=class extends te{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,e,r,n)}emplace(e,r,n,i){let o=e*2,a=e*4;return this.uint32[o+0]=r,this.uint16[a+2]=n,this.uint16[a+3]=i,e}};$n.prototype.bytesPerElement=8;I("StructArrayLayout1ul2ui8",$n);var jn=class extends te{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r){let n=this.length;return this.resize(n+1),this.emplace(n,e,r)}emplace(e,r,n){let i=e*2;return this.uint16[i+0]=r,this.uint16[i+1]=n,e}};jn.prototype.bytesPerElement=4;I("StructArrayLayout2ui4",jn);var Uo=class extends te{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){let n=e*1;return this.uint16[n+0]=r,e}};Uo.prototype.bytesPerElement=2;I("StructArrayLayout1ui2",Uo);var Er=class extends te{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,i){let o=this.length;return this.resize(o+1),this.emplace(o,e,r,n,i)}emplace(e,r,n,i,o){let a=e*4;return this.float32[a+0]=r,this.float32[a+1]=n,this.float32[a+2]=i,this.float32[a+3]=o,e}};Er.prototype.bytesPerElement=16;I("StructArrayLayout4f16",Er);var $o=class extends Ft{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new lp.default(this.anchorPointX,this.anchorPointY)}};$o.prototype.size=20;var qn=class extends Vn{get(e){return new $o(this,e)}};I("CollisionBoxArray",qn);var jo=class extends Ft{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}};jo.prototype.size=48;var Wn=class extends Gn{get(e){return new jo(this,e)}};I("PlacedSymbolArray",Wn);var qo=class extends Ft{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}};qo.prototype.size=64;var Xn=class extends Nn{get(e){return new qo(this,e)}};I("SymbolInstanceArray",Xn);var Hn=class extends ir{getoffsetX(e){return this.float32[e*1+0]}};I("GlyphOffsetArray",Hn);var Zn=class extends kn{getx(e){return this.int16[e*3+0]}gety(e){return this.int16[e*3+1]}gettileUnitDistanceFromAnchor(e){return this.int16[e*3+2]}};I("SymbolLineVertexArray",Zn);var Wo=class extends Ft{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}};Wo.prototype.size=12;var Jn=class extends Un{get(e){return new Wo(this,e)}};I("TextAnchorOffsetArray",Jn);var Xo=class extends Ft{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}};Xo.prototype.size=8;var Yn=class extends $n{get(e){return new Xo(this,e)}};I("FeatureIndexArray",Yn);var Ho=class extends nr{};var Zo=class extends nr{},Jo=class extends nr{},Yo=class extends Fn{};var Ko=class extends En{},Qo=class extends Et{},yt=class extends Mn{},ea=class extends Ln{},ta=class extends Dn{},ra=class extends Bn{},Kn=class extends Rn{};var na=class extends zn{};var Le=class extends On{},Mt=class extends jn{};var Cg=Q([{name:"a_pos",components:2,type:"Int16"}],4);var{members:up,size:zv,alignment:Ov}=Cg;var pe=class t{constructor(e=[]){this._forceNewSegmentOnNextPrepare=!1;this.segments=e}prepareSegment(e,r,n,i){let o=this.segments[this.segments.length-1];return e>t.MAX_VERTEX_ARRAY_LENGTH&&ce("Max vertices per segment is ".concat(t.MAX_VERTEX_ARRAY_LENGTH,": bucket requested ").concat(e,". Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ").concat(t.MAX_VERTEX_ARRAY_LENGTH," vertices.")),this._forceNewSegmentOnNextPrepare||!o||o.vertexLength+e>t.MAX_VERTEX_ARRAY_LENGTH||o.sortKey!==i?this.createNewSegment(r,n,i):o}createNewSegment(e,r,n){let i={vertexOffset:e.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0,vaos:{}};return n!==void 0&&(i.sortKey=n),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(i),i}getOrCreateLatestSegment(e,r,n){return this.prepareSegment(0,e,r,n)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(let e of this.segments)for(let r in e.vaos)e.vaos[r].destroy()}static simpleSegment(e,r,n,i){return new t([{vertexOffset:e,primitiveOffset:r,vertexLength:n,primitiveLength:i,vaos:{},sortKey:0}])}};pe.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1;I("SegmentVector",pe);function tl(t,e){return t=it(Math.floor(t),0,255),e=it(Math.floor(e),0,255),256*t+e}var Qn=Q([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var mp=Y(il(),1);var ei=class t{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,r,n,i){this.ids.push(yp(e)),this.positions.push(r,n,i)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");let r=yp(e),n=0,i=this.ids.length-1;for(;n<i;){let a=n+i>>1;this.ids[a]>=r?i=a:n=a+1}let o=[];for(;this.ids[n]===r;){let a=this.positions[3*n],s=this.positions[3*n+1],l=this.positions[3*n+2];o.push({index:a,start:s,end:l}),n++}return o}static serialize(e,r){let n=new Float64Array(e.ids),i=new Uint32Array(e.positions);return ol(n,i,0,n.length-1),r&&r.push(n.buffer,i.buffer),{ids:n,positions:i}}static deserialize(e){let r=new t;return r.ids=e.ids,r.positions=e.positions,r.indexed=!0,r}};function yp(t){let e=+t;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:(0,mp.default)(String(t))}function ol(t,e,r,n){for(;r<n;){let i=t[r+n>>1],o=r-1,a=n+1;for(;;){do o++;while(t[o]<i);do a--;while(t[a]>i);if(o>=a)break;oa(t,o,a),oa(e,3*o,3*a),oa(e,3*o+1,3*a+1),oa(e,3*o+2,3*a+2)}a-r<n-a?(ol(t,e,r,a),r=a+1):(ol(t,e,a+1,n),n=a)}}function oa(t,e,r){let n=t[e];t[e]=t[r],t[r]=n}I("FeaturePositionMap",ei);var ti=class{constructor(e,r){this.gl=e.gl,this.location=r}};var Mr=class extends ti{constructor(e,r){super(e,r),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}};var aa=class extends ti{constructor(e,r){super(e,r),this.current=[0,0,0,0]}set(e){(e[0]!==this.current[0]||e[1]!==this.current[1]||e[2]!==this.current[2]||e[3]!==this.current[3])&&(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}},sa=class extends ti{constructor(e,r){super(e,r),this.current=H.transparent}set(e){(e.r!==this.current.r||e.g!==this.current.g||e.b!==this.current.b||e.a!==this.current.a)&&(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}};var eP=new Float32Array(16);function al(t){return[tl(255*t.r,255*t.g),tl(255*t.b,255*t.a)]}var or=class{constructor(e,r,n){this.value=e,this.uniformNames=r.map(i=>"u_".concat(i)),this.type=n}setUniform(e,r,n){e.set(n.constantOr(this.value))}getBinding(e,r,n){return this.type==="color"?new sa(e,r):new Mr(e,r)}},Lt=class{constructor(e,r){this.uniformNames=r.map(n=>"u_".concat(n)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=e.tlbr}setUniform(e,r,n,i){let o=i==="u_pattern_to"?this.patternTo:i==="u_pattern_from"?this.patternFrom:i==="u_pixel_ratio_to"?this.pixelRatioTo:i==="u_pixel_ratio_from"?this.pixelRatioFrom:null;o&&e.set(o)}getBinding(e,r,n){return n.substr(0,9)==="u_pattern"?new aa(e,r):new Mr(e,r)}},We=class{constructor(e,r,n,i){this.expression=e,this.type=n,this.maxValue=0,this.paintVertexAttributes=r.map(o=>({name:"a_".concat(o),type:"Float32",components:n==="color"?2:1,offset:0})),this.paintVertexArray=new i}populatePaintArray(e,r,n,i,o){let a=this.paintVertexArray.length,s=this.expression.evaluate(new W(0),r,{},i,[],o);this.paintVertexArray.resize(e),this._setPaintValue(a,e,s)}updatePaintArray(e,r,n,i){let o=this.expression.evaluate({zoom:0},n,i);this._setPaintValue(e,r,o)}_setPaintValue(e,r,n){if(this.type==="color"){let i=al(n);for(let o=e;o<r;o++)this.paintVertexArray.emplace(o,i[0],i[1])}else{for(let i=e;i<r;i++)this.paintVertexArray.emplace(i,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}},De=class{constructor(e,r,n,i,o,a){this.expression=e,this.uniformNames=r.map(s=>"u_".concat(s,"_t")),this.type=n,this.useIntegerZoom=i,this.zoom=o,this.maxValue=0,this.paintVertexAttributes=r.map(s=>({name:"a_".concat(s),type:"Float32",components:n==="color"?4:2,offset:0})),this.paintVertexArray=new a}populatePaintArray(e,r,n,i,o){let a=this.expression.evaluate(new W(this.zoom),r,{},i,[],o),s=this.expression.evaluate(new W(this.zoom+1),r,{},i,[],o),l=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(l,e,a,s)}updatePaintArray(e,r,n,i){let o=this.expression.evaluate({zoom:this.zoom},n,i),a=this.expression.evaluate({zoom:this.zoom+1},n,i);this._setPaintValue(e,r,o,a)}_setPaintValue(e,r,n,i){if(this.type==="color"){let o=al(n),a=al(i);for(let s=e;s<r;s++)this.paintVertexArray.emplace(s,o[0],o[1],a[0],a[1])}else{for(let o=e;o<r;o++)this.paintVertexArray.emplace(o,n,i);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(i))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,r){let n=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,i=it(this.expression.interpolationFactor(n,this.zoom,this.zoom+1),0,1);e.set(i)}getBinding(e,r,n){return new Mr(e,r)}},Ye=class{constructor(e,r,n,i,o,a){this.expression=e,this.type=r,this.useIntegerZoom=n,this.zoom=i,this.layerId=a,this.zoomInPaintVertexArray=new o,this.zoomOutPaintVertexArray=new o}populatePaintArray(e,r,n){let i=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(i,e,r.patterns&&r.patterns[this.layerId],n)}updatePaintArray(e,r,n,i,o){this._setPaintValues(e,r,n.patterns&&n.patterns[this.layerId],o)}_setPaintValues(e,r,n,i){if(!i||!n)return;let{min:o,mid:a,max:s}=n,l=i[o],u=i[a],c=i[s];if(!(!l||!u||!c))for(let p=e;p<r;p++)this.zoomInPaintVertexArray.emplace(p,u.tl[0],u.tl[1],u.br[0],u.br[1],l.tl[0],l.tl[1],l.br[0],l.br[1],u.pixelRatio,l.pixelRatio),this.zoomOutPaintVertexArray.emplace(p,u.tl[0],u.tl[1],u.br[0],u.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1],u.pixelRatio,c.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Qn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Qn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}},la=class{constructor(e,r,n){this.binders={},this._buffers=[];let i=[];for(let o in e.paint._values){if(!n(o))continue;let a=e.paint.get(o);if(!(a instanceof ge)||!It(a.property.specification))continue;let s=Mg(o,e.type),l=a.value,u=a.property.specification.type,c=a.property.useIntegerZoom,p=a.property.specification["property-type"],f=p==="cross-faded"||p==="cross-faded-data-driven";if(l.kind==="constant")this.binders[o]=f?new Lt(l.value,s):new or(l.value,s,u),i.push("/u_".concat(o));else if(l.kind==="source"||f){let y=hp(o,u,"source");this.binders[o]=f?new Ye(l,u,c,r,y,e.id):new We(l,s,u,y),i.push("/a_".concat(o))}else{let y=hp(o,u,"composite");this.binders[o]=new De(l,s,u,c,r,y),i.push("/z_".concat(o))}}this.cacheKey=i.sort().join("")}getMaxValue(e){let r=this.binders[e];return r instanceof We||r instanceof De?r.maxValue:0}populatePaintArrays(e,r,n,i,o){for(let a in this.binders){let s=this.binders[a];(s instanceof We||s instanceof De||s instanceof Ye)&&s.populatePaintArray(e,r,n,i,o)}}setConstantPatternPositions(e,r){for(let n in this.binders){let i=this.binders[n];i instanceof Lt&&i.setConstantPatternPositions(e,r)}}updatePaintArrays(e,r,n,i,o){let a=!1;for(let s in e){let l=r.getPositions(s);for(let u of l){let c=n.feature(u.index);for(let p in this.binders){let f=this.binders[p];if((f instanceof We||f instanceof De||f instanceof Ye)&&f.expression.isStateDependent===!0){let y=i.paint.get(p);f.expression=y.value,f.updatePaintArray(u.start,u.end,c,e[s],o),a=!0}}}}return a}defines(){let e=[];for(let r in this.binders){let n=this.binders[r];(n instanceof or||n instanceof Lt)&&e.push(...n.uniformNames.map(i=>"#define HAS_UNIFORM_".concat(i)))}return e}getBinderAttributes(){let e=[];for(let r in this.binders){let n=this.binders[r];if(n instanceof We||n instanceof De)for(let i=0;i<n.paintVertexAttributes.length;i++)e.push(n.paintVertexAttributes[i].name);else if(n instanceof Ye)for(let i=0;i<Qn.members.length;i++)e.push(Qn.members[i].name)}return e}getBinderUniforms(){let e=[];for(let r in this.binders){let n=this.binders[r];if(n instanceof or||n instanceof Lt||n instanceof De)for(let i of n.uniformNames)e.push(i)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,r){let n=[];for(let i in this.binders){let o=this.binders[i];if(o instanceof or||o instanceof Lt||o instanceof De){for(let a of o.uniformNames)if(r[a]){let s=o.getBinding(e,r[a],a);n.push({name:a,property:i,binding:s})}}}return n}setUniforms(e,r,n,i){for(let{name:o,property:a,binding:s}of r)this.binders[a].setUniform(s,i,n.get(a),o)}updatePaintBuffers(e){this._buffers=[];for(let r in this.binders){let n=this.binders[r];if(e&&n instanceof Ye){let i=e.fromScale===2?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;i&&this._buffers.push(i)}else(n instanceof We||n instanceof De)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(e){for(let r in this.binders){let n=this.binders[r];(n instanceof We||n instanceof De||n instanceof Ye)&&n.upload(e)}this.updatePaintBuffers()}destroy(){for(let e in this.binders){let r=this.binders[e];(r instanceof We||r instanceof De||r instanceof Ye)&&r.destroy()}}},Ae=class{constructor(e,r,n=()=>!0){this.programConfigurations={};for(let i of e)this.programConfigurations[i.id]=new la(i,r,n);this.needsUpload=!1,this._featureMap=new ei,this._bufferOffset=0}populatePaintArrays(e,r,n,i,o,a){for(let s in this.programConfigurations)this.programConfigurations[s].populatePaintArrays(e,r,i,o,a);r.id!==void 0&&this._featureMap.add(r.id,n,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,r,n,i){for(let o of n)this.needsUpload=this.programConfigurations[o.id].updatePaintArrays(e,this._featureMap,r,o,i)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(let r in this.programConfigurations)this.programConfigurations[r].upload(e);this.needsUpload=!1}}destroy(){for(let e in this.programConfigurations)this.programConfigurations[e].destroy()}};function Mg(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace("".concat(e,"-"),"").replace(/-/g,"_")]}function Lg(t){return{"line-pattern":{source:yt,composite:yt},"fill-pattern":{source:yt,composite:yt},"fill-extrusion-pattern":{source:yt,composite:yt}}[t]}function hp(t,e,r){let n={color:{source:Et,composite:Er},number:{source:ir,composite:Et}},i=Lg(t);return i&&i[r]||n[e][r]}I("ConstantBinder",or);I("CrossFadedConstantBinder",Lt);I("SourceExpressionBinder",We);I("CrossFadedCompositeBinder",Ye);I("CompositeExpressionBinder",De);I("ProgramConfiguration",la,{omit:["_buffers"]});I("ProgramConfigurationSet",Ae);var Dg=15,sl=Math.pow(2,Dg-1)-1,dp=-sl-1;function _e(t){let e=8192/t.extent,r=t.loadGeometry();for(let n=0;n<r.length;n++){let i=r[n];for(let o=0;o<i.length;o++){let a=i[o],s=Math.round(a.x*e),l=Math.round(a.y*e);a.x=it(s,dp,sl),a.y=it(l,dp,sl),(s<a.x||s>a.x+1||l<a.y||l>a.y+1)&&ce("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function Ne(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?_e(t):[]}}var gp=-32768;function Bg(t,e,r,n,i){t.emplaceBack(gp+e*8+n,gp+r*8+i)}var ar=class{constructor(e){this.zoom=e.zoom,this.globalState=e.globalState,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Zo,this.indexArray=new Le,this.segments=new pe,this.programConfigurations=new Ae(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,n){let i=this.layers[0],o=[],a=null,s=!1,l=i.type==="heatmap";if(i.type==="circle"){let c=i;a=c.layout.get("circle-sort-key"),s=!a.isConstant(),l=l||c.paint.get("circle-pitch-alignment")==="map"}let u=l?r.subdivisionGranularity.circle:1;for(let{feature:c,id:p,index:f,sourceLayerIndex:y}of e){let m=this.layers[0]._featureFilter.needGeometry,h=Ne(c,m);if(!this.layers[0]._featureFilter.filter(new W(this.zoom,{globalState:this.globalState}),h,n))continue;let g=s?a.evaluate(h,{},n):void 0,d={id:p,properties:c.properties,type:c.type,sourceLayerIndex:y,index:f,geometry:m?h.geometry:_e(c),patterns:{},sortKey:g};o.push(d)}s&&o.sort((c,p)=>c.sortKey-p.sortKey);for(let c of o){let{geometry:p,index:f,sourceLayerIndex:y}=c,m=e[f].feature;this.addFeature(c,p,f,n,u),r.featureIndex.insert(m,p,f,y,this.index)}}update(e,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,up),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,r,n,i,o=1){let a;switch(o){case 1:a=[0,7];break;case 3:a=[0,2,5,7];break;case 5:a=[0,1,3,4,6,7];break;case 7:a=[0,1,2,3,4,5,6,7];break;default:throw new Error("Invalid circle bucket granularity: ".concat(o,"; valid values are 1, 3, 5, 7."))}let s=a.length;for(let l of r)for(let u of l){let c=u.x,p=u.y;if(c<0||c>=8192||p<0||p>=8192)continue;let f=this.segments.prepareSegment(s*s,this.layoutVertexArray,this.indexArray,e.sortKey),y=f.vertexLength;for(let m=0;m<s;m++)for(let h=0;h<s;h++)Bg(this.layoutVertexArray,c,p,a[h],a[m]);for(let m=0;m<s-1;m++)for(let h=0;h<s-1;h++){let g=y+m*s+h,d=y+(m+1)*s+h;this.indexArray.emplaceBack(g,d+1,g+1),this.indexArray.emplaceBack(g,d,d+1)}f.vertexLength+=s*s,f.primitiveLength+=(s-1)*(s-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,{},i)}};I("CircleBucket",ar,{omit:["layers"]});var ri=Y(ye(),1);function bp(t,e){for(let r=0;r<t.length;r++)if(Lr(e,t[r]))return!0;for(let r=0;r<e.length;r++)if(Lr(t,e[r]))return!0;return!!ul(t,e)}function vp(t,e,r){return!!(Lr(t,e)||ll(e,t,r))}function ua(t,e){if(t.length===1)return xp(e,t[0]);for(let r=0;r<e.length;r++){let n=e[r];for(let i=0;i<n.length;i++)if(Lr(t,n[i]))return!0}for(let r=0;r<t.length;r++)if(xp(e,t[r]))return!0;for(let r=0;r<e.length;r++)if(ul(t,e[r]))return!0;return!1}function Pp(t,e,r){for(let n=0;n<e.length;n++){let i=e[n];if(t.length>=3){for(let o=0;o<i.length;o++)if(Lr(t,i[o]))return!0}if(Vg(t,i,r))return!0}return!1}function Vg(t,e,r){if(t.length>1){if(ul(t,e))return!0;for(let n=0;n<e.length;n++)if(ll(e[n],t,r))return!0}for(let n=0;n<t.length;n++)if(ll(t[n],e,r))return!0;return!1}function ul(t,e){if(t.length===0||e.length===0)return!1;for(let r=0;r<t.length-1;r++){let n=t[r],i=t[r+1];for(let o=0;o<e.length-1;o++){let a=e[o],s=e[o+1];if(Rg(n,i,a,s))return!0}}return!1}function Rg(t,e,r,n){return ot(t,r,n)!==ot(e,r,n)&&ot(t,e,r)!==ot(t,e,n)}function ll(t,e,r){let n=r*r;if(e.length===1)return t.distSqr(e[0])<n;for(let i=1;i<e.length;i++){let o=e[i-1],a=e[i];if(cl(t,o,a)<n)return!0}return!1}function cl(t,e,r){let n=e.distSqr(r);if(n===0)return t.distSqr(e);let i=((t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y))/n;return i<0?t.distSqr(e):i>1?t.distSqr(r):t.distSqr(r.sub(e)._mult(i)._add(e))}function xp(t,e){let r=!1,n,i,o;for(let a=0;a<t.length;a++){n=t[a];for(let s=0,l=n.length-1;s<n.length;l=s++)i=n[s],o=n[l],i.y>e.y!=o.y>e.y&&e.x<(o.x-i.x)*(e.y-i.y)/(o.y-i.y)+i.x&&(r=!r)}return r}function Lr(t,e){let r=!1;for(let n=0,i=t.length-1;n<t.length;i=n++){let o=t[n],a=t[i];o.y>e.y!=a.y>e.y&&e.x<(a.x-o.x)*(e.y-o.y)/(a.y-o.y)+o.x&&(r=!r)}return r}function Sp(t,e,r,n,i){for(let a of t)if(e<=a.x&&r<=a.y&&n>=a.x&&i>=a.y)return!0;let o=[new ri.default(e,r),new ri.default(e,i),new ri.default(n,i),new ri.default(n,r)];if(t.length>2){for(let a of o)if(Lr(t,a))return!0}for(let a=0;a<t.length-1;a++){let s=t[a],l=t[a+1];if(zg(s,l,o))return!0}return!1}function zg(t,e,r){let n=r[0],i=r[2];if(t.x<n.x&&e.x<n.x||t.x>i.x&&e.x>i.x||t.y<n.y&&e.y<n.y||t.y>i.y&&e.y>i.y)return!1;let o=ot(t,e,r[0]);return o!==ot(t,e,r[1])||o!==ot(t,e,r[2])||o!==ot(t,e,r[3])}var ca=Y(ye(),1);function sr(t,e,r){let n=e.paint.get(t).value;return n.kind==="constant"?n.value:r.programConfigurations.get(e.id).getMaxValue(t)}function Dt(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Bt(t,e,r,n,i){if(!e[0]&&!e[1])return t;let o=ca.default.convert(e)._mult(i);r==="viewport"&&o._rotate(-n);let a=[];for(let s=0;s<t.length;s++){let l=t[s];a.push(l.sub(o))}return a}function wp(t,e){let r=[];for(let n=0;n<t.length;n++){let i=t[n],o=[];for(let a=0;a<i.length;a++){let s=i[a-1],l=i[a],u=i[a+1],c=a===0?new ca.default(0,0):l.sub(s)._unit()._perp(),p=a===i.length-1?new ca.default(0,0):u.sub(l)._unit()._perp(),f=c._add(p)._unit(),y=f.x*p.x+f.y*p.y;y!==0&&f._mult(1/y),o.push(f._mult(e)._add(l))}r.push(o)}return r}var Ap,Og=()=>Ap=Ap||new ee({"circle-sort-key":new L(P.layout_circle["circle-sort-key"])}),_p,Gg=()=>_p=_p||new ee({"circle-radius":new L(P.paint_circle["circle-radius"]),"circle-color":new L(P.paint_circle["circle-color"]),"circle-blur":new L(P.paint_circle["circle-blur"]),"circle-opacity":new L(P.paint_circle["circle-opacity"]),"circle-translate":new F(P.paint_circle["circle-translate"]),"circle-translate-anchor":new F(P.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new F(P.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new F(P.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new L(P.paint_circle["circle-stroke-width"]),"circle-stroke-color":new L(P.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new L(P.paint_circle["circle-stroke-opacity"])}),Ip={get paint(){return Gg()},get layout(){return Og()}};var Tp=Y(ye(),1);var pa=class extends oe{constructor(e){super(e,Ip)}createBucket(e){return new ar(e)}queryRadius(e){let r=e;return sr("circle-radius",this,r)+sr("circle-stroke-width",this,r)+Dt(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:e,feature:r,featureState:n,geometry:i,transform:o,pixelsToTileUnits:a,unwrappedTileID:s,getElevation:l}){let u=Bt(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-o.bearingInRadians,a),c=this.paint.get("circle-radius").evaluate(r,n),p=this.paint.get("circle-stroke-width").evaluate(r,n),f=c+p,y=this.paint.get("circle-pitch-alignment")==="map",m=y?u:Ng(u,o,s,l),h=y?f*a:f;for(let g of i)for(let d of g){let b=y?d:Cp(d,o,s,l),x=h,v=o.projectTileCoordinates(d.x,d.y,s,l).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?x*=v/o.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(x*=o.cameraToCenterDistance/v),vp(m,b,x))return!0}return!1}};function Cp(t,e,r,n){let i=e.projectTileCoordinates(t.x,t.y,r,n).point;return new Tp.default((i.x*.5+.5)*e.width,(-i.y*.5+.5)*e.height)}function Ng(t,e,r,n){return t.map(i=>Cp(i,e,r,n))}var ni=class extends ar{};I("HeatmapBucket",ni,{omit:["layers"]});var kp,Ug=()=>kp=kp||new ee({"heatmap-radius":new L(P.paint_heatmap["heatmap-radius"]),"heatmap-weight":new L(P.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new F(P.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ft(P.paint_heatmap["heatmap-color"]),"heatmap-opacity":new F(P.paint_heatmap["heatmap-opacity"])}),Fp={get paint(){return Ug()}};function pl(t,{width:e,height:r},n,i){if(!i)i=new Uint8Array(e*r*n);else if(i instanceof Uint8ClampedArray)i=new Uint8Array(i.buffer);else if(i.length!==e*r*n)throw new RangeError("mismatched image size. expected: ".concat(i.length," but got: ").concat(e*r*n));return t.width=e,t.height=r,t.data=i,t}function Ep(t,{width:e,height:r},n){if(e===t.width&&r===t.height)return;let i=pl({},{width:e,height:r},n);fl(t,i,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,e),height:Math.min(t.height,r)},n),t.width=e,t.height=r,t.data=i.data}function fl(t,e,r,n,i,o){if(i.width===0||i.height===0)return e;if(i.width>t.width||i.height>t.height||r.x>t.width-i.width||r.y>t.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>e.width||i.height>e.height||n.x>e.width-i.width||n.y>e.height-i.height)throw new RangeError("out of range destination coordinates for image copy");let a=t.data,s=e.data;if(a===s)throw new Error("srcData equals dstData, so image is already copied");for(let l=0;l<i.height;l++){let u=((r.y+l)*t.width+r.x)*o,c=((n.y+l)*e.width+n.x)*o;for(let p=0;p<i.width*o;p++)s[c+p]=a[u+p]}return e}var lr=class t{constructor(e,r){pl(this,e,1,r)}resize(e){Ep(this,e,1)}clone(){return new t({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,n,i,o){fl(e,r,n,i,o,1)}},fe=class t{constructor(e,r){pl(this,e,4,r)}resize(e){Ep(this,e,4)}replace(e,r){r?this.data.set(e):e instanceof Uint8ClampedArray?this.data=new Uint8Array(e.buffer):this.data=e}clone(){return new t({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,n,i,o){fl(e,r,n,i,o,4)}setPixel(e,r,n){let i=(e*this.width+r)*4;this.data[i+0]=Math.round(n.r*255/n.a),this.data[i+1]=Math.round(n.g*255/n.a),this.data[i+2]=Math.round(n.b*255/n.a),this.data[i+3]=Math.round(n.a*255)}};I("AlphaImage",lr);I("RGBAImage",fe);function Mp(t){let e={},r=t.resolution||256,n=t.clips?t.clips.length:1,i=t.image||new fe({width:r,height:n});if(!ku(r))throw new Error("width is not a power of 2 - ".concat(r));let o=(a,s,l)=>{e[t.evaluationKey]=l;let u=t.expression.evaluate(e);i.setPixel(a/4/r,s/4,u)};if(t.clips)for(let a=0,s=0;a<n;++a,s+=r*4)for(let l=0,u=0;l<r;l++,u+=4){let c=l/(r-1),{start:p,end:f}=t.clips[a],y=p*(1-c)+f*c;o(s,u,y)}else for(let a=0,s=0;a<r;a++,s+=4){let l=a/(r-1);o(0,s,l)}return i}var Lp="big-fb";var fa=class extends oe{createBucket(e){return new ni(e)}constructor(e){super(e,Fp),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){let e=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=Mp({expression:e,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Lp)&&this.heatmapFbos.delete(Lp)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}};var Dp,$g=()=>Dp=Dp||new ee({"hillshade-illumination-direction":new F(P.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new F(P.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new F(P.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new F(P.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new F(P.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new F(P.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new F(P.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new F(P.paint_hillshade["hillshade-method"])}),Bp={get paint(){return $g()}};var ya=class extends oe{constructor(e){super(e,Bp),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let e=this.paint.get("hillshade-illumination-direction").values,r=this.paint.get("hillshade-illumination-altitude").values,n=this.paint.get("hillshade-highlight-color").values,i=this.paint.get("hillshade-shadow-color").values,o=Math.max(e.length,r.length,n.length,i.length);e=e.concat(Array(o-e.length).fill(e.at(-1))),r=r.concat(Array(o-r.length).fill(r.at(-1))),n=n.concat(Array(o-n.length).fill(n.at(-1))),i=i.concat(Array(o-i.length).fill(i.at(-1)));let a=r.map(fs);return{directionRadians:e.map(fs),altitudeRadians:a,shadowColor:i,highlightColor:n}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}};var Vp,jg=()=>Vp=Vp||new ee({"color-relief-opacity":new F(P["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new ft(P["paint_color-relief"]["color-relief-color"])}),Rp={get paint(){return jg()}};var ii=class{constructor(e,r,n,i){this.context=e,this.format=n,this.texture=e.gl.createTexture(),this.update(r,i)}update(e,r,n){let{width:i,height:o}=e,a=(!this.size||this.size[0]!==i||this.size[1]!==o)&&!n,{context:s}=this,{gl:l}=s;if(this.useMipmap=!!(r&&r.useMipmap),l.bindTexture(l.TEXTURE_2D,this.texture),s.pixelStoreUnpackFlipY.set(!1),s.pixelStoreUnpack.set(1),s.pixelStoreUnpackPremultiplyAlpha.set(this.format===l.RGBA&&(!r||r.premultiply!==!1)),a)this.size=[i,o],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||vt(e)?l.texImage2D(l.TEXTURE_2D,0,this.format,this.format,l.UNSIGNED_BYTE,e):l.texImage2D(l.TEXTURE_2D,0,this.format,i,o,0,this.format,l.UNSIGNED_BYTE,e.data);else{let{x:u,y:c}=n||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||vt(e)?l.texSubImage2D(l.TEXTURE_2D,0,u,c,l.RGBA,l.UNSIGNED_BYTE,e):l.texSubImage2D(l.TEXTURE_2D,0,u,c,i,o,l.RGBA,l.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&l.generateMipmap(l.TEXTURE_2D),s.pixelStoreUnpackFlipY.setDefault(),s.pixelStoreUnpack.setDefault(),s.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(e,r,n){let{context:i}=this,{gl:o}=i;o.bindTexture(o.TEXTURE_2D,this.texture),n===o.LINEAR_MIPMAP_NEAREST&&!this.isSizePowerOfTwo()&&(n=o.LINEAR),e!==this.filter&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,e),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,n||e),this.filter=e),r!==this.wrap&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,r),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,r),this.wrap=r)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1===0}destroy(){let{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}};var oi=class{constructor(e,r,n,i=1,o=1,a=1,s=0){if(this.uid=e,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(n&&!["mapbox","terrarium","custom"].includes(n)){ce('"'.concat(n,'" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".'));return}this.stride=r.height;let l=this.dim=r.height-2;switch(this.data=new Uint32Array(r.data.buffer),n){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=i,this.greenFactor=o,this.blueFactor=a,this.baseShift=s;break;case"mapbox":default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4;break}for(let u=0;u<l;u++)this.data[this._idx(-1,u)]=this.data[this._idx(0,u)],this.data[this._idx(l,u)]=this.data[this._idx(l-1,u)],this.data[this._idx(u,-1)]=this.data[this._idx(u,0)],this.data[this._idx(u,l)]=this.data[this._idx(u,l-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(l,-1)]=this.data[this._idx(l-1,0)],this.data[this._idx(-1,l)]=this.data[this._idx(0,l-1)],this.data[this._idx(l,l)]=this.data[this._idx(l-1,l-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let u=0;u<l;u++)for(let c=0;c<l;c++){let p=this.get(u,c);p>this.max&&(this.max=p),p<this.min&&(this.min=p)}}get(e,r){let n=new Uint8Array(this.data.buffer),i=this._idx(e,r)*4;return this.unpack(n[i],n[i+1],n[i+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,r){if(e<-1||e>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(e+1)}unpack(e,r,n){return e*this.redFactor+r*this.greenFactor+n*this.blueFactor-this.baseShift}pack(e){return yl(e,this.getUnpackVector())}getPixels(){return new fe({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,r,n){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let i=r*this.dim,o=r*this.dim+this.dim,a=n*this.dim,s=n*this.dim+this.dim;switch(r){case-1:i=o-1;break;case 1:o=i+1;break}switch(n){case-1:a=s-1;break;case 1:s=a+1;break}let l=-r*this.dim,u=-n*this.dim;for(let c=a;c<s;c++)for(let p=i;p<o;p++)this.data[this._idx(p,c)]=e.data[this._idx(p+l,c+u)]}};function yl(t,e){let r=e[0],n=e[1],i=e[2],o=e[3],a=Math.min(r,n,i),s=Math.round((t+o)/a);return{r:Math.floor(s*a/r)%256,g:Math.floor(s*a/n)%256,b:Math.floor(s*a/i)%256}}I("DEMData",oi);var ma=class extends oe{constructor(e){super(e,Rp)}_createColorRamp(e){let r={elevationStops:[],colorStops:[]},n=this._transitionablePaint._values["color-relief-color"].value.expression;if(n instanceof Je&&n._styleExpression.expression instanceof ke){this.colorRampExpression=n;let a=n._styleExpression.expression;r.elevationStops=a.labels,r.colorStops=[];for(let s of r.elevationStops)r.colorStops.push(a.evaluate({globals:{elevation:s}}))}if(r.elevationStops.length<1&&(r.elevationStops=[0],r.colorStops=[H.transparent]),r.elevationStops.length<2&&(r.elevationStops.push(r.elevationStops[0]+1),r.colorStops.push(r.colorStops[0])),r.elevationStops.length<=e)return r;let i={elevationStops:[],colorStops:[]},o=(r.elevationStops.length-1)/(e-1);for(let a=0;a<r.elevationStops.length-.5;a+=o)i.elevationStops.push(r.elevationStops[Math.round(a)]),i.colorStops.push(r.colorStops[Math.round(a)]);return ce("Too many colors in specification of ".concat(this.id," color-relief layer, may not render properly.")),i}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(e,r,n){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;let i=this._createColorRamp(r),o=new fe({width:i.colorStops.length,height:1}),a=new fe({width:i.colorStops.length,height:1});for(let s=0;s<i.elevationStops.length;s++){let l=yl(i.elevationStops[s],n);a.setPixel(0,s,new H(l.r/255,l.g/255,l.b/255,1)),o.setPixel(0,s,i.colorStops[s])}return this.colorRampTextures={elevationTexture:new ii(e,a,e.gl.RGBA),colorTexture:new ii(e,o,e.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}};var qg=Q([{name:"a_pos",components:2,type:"Int16"}],4);var{members:zp,size:Y1,alignment:K1}=qg;function Dr(t,e,r){let n=r.patternDependencies,i=!1;for(let o of e){let a=o.paint.get("".concat(t,"-pattern"));a.isConstant()||(i=!0);let s=a.constantOr(null);s&&(i=!0,n[s.to]=!0,n[s.from]=!0)}return i}function Br(t,e,r,n,i){let o=i.patternDependencies;for(let a of e){let l=a.paint.get("".concat(t,"-pattern")).value;if(l.kind!=="constant"){let u=l.evaluate({zoom:n-1},r,{},i.availableImages),c=l.evaluate({zoom:n},r,{},i.availableImages),p=l.evaluate({zoom:n+1},r,{},i.availableImages);u=u&&u.name?u.name:u,c=c&&c.name?c.name:c,p=p&&p.name?p.name:p,o[u]=!0,o[c]=!0,o[p]=!0,r.patterns[a.id]={min:u,mid:c,max:p}}}return r}var pi=Y(ye(),1);function dl(t,e,r=2){let n=e&&e.length,i=n?e[0]*r:t.length,o=Gp(t,0,i,r,!0),a=[];if(!o||o.next===o.prev)return a;let s,l,u;if(n&&(o=Jg(t,e,o,r)),t.length>80*r){s=1/0,l=1/0;let c=-1/0,p=-1/0;for(let f=r;f<i;f+=r){let y=t[f],m=t[f+1];y<s&&(s=y),m<l&&(l=m),y>c&&(c=y),m>p&&(p=m)}u=Math.max(c-s,p-l),u=u!==0?32767/u:0}return si(o,a,r,s,l,u,0),a}function Gp(t,e,r,n,i){let o;if(i===sx(t,e,r,n)>0)for(let a=e;a<r;a+=n)o=Op(a/n|0,t[a],t[a+1],o);else for(let a=r-n;a>=e;a-=n)o=Op(a/n|0,t[a],t[a+1],o);return o&&Vr(o,o.next)&&(ui(o),o=o.next),o}function ur(t,e){if(!t)return t;e||(e=t);let r=t,n;do if(n=!1,!r.steiner&&(Vr(r,r.next)||se(r.prev,r,r.next)===0)){if(ui(r),r=e=r.prev,r===r.next)break;n=!0}else r=r.next;while(n||r!==e);return e}function si(t,e,r,n,i,o,a){if(!t)return;!a&&o&&tx(t,n,i,o);let s=t;for(;t.prev!==t.next;){let l=t.prev,u=t.next;if(o?Xg(t,n,i,o):Wg(t)){e.push(l.i,t.i,u.i),ui(t),t=u.next,s=u.next;continue}if(t=u,t===s){a?a===1?(t=Hg(ur(t),e),si(t,e,r,n,i,o,2)):a===2&&Zg(t,e,r,n,i,o):si(ur(t),e,r,n,i,o,1);break}}}function Wg(t){let e=t.prev,r=t,n=t.next;if(se(e,r,n)>=0)return!1;let i=e.x,o=r.x,a=n.x,s=e.y,l=r.y,u=n.y,c=Math.min(i,o,a),p=Math.min(s,l,u),f=Math.max(i,o,a),y=Math.max(s,l,u),m=n.next;for(;m!==e;){if(m.x>=c&&m.x<=f&&m.y>=p&&m.y<=y&&ai(i,s,o,l,a,u,m.x,m.y)&&se(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function Xg(t,e,r,n){let i=t.prev,o=t,a=t.next;if(se(i,o,a)>=0)return!1;let s=i.x,l=o.x,u=a.x,c=i.y,p=o.y,f=a.y,y=Math.min(s,l,u),m=Math.min(c,p,f),h=Math.max(s,l,u),g=Math.max(c,p,f),d=ml(y,m,e,r,n),b=ml(h,g,e,r,n),x=t.prevZ,v=t.nextZ;for(;x&&x.z>=d&&v&&v.z<=b;){if(x.x>=y&&x.x<=h&&x.y>=m&&x.y<=g&&x!==i&&x!==a&&ai(s,c,l,p,u,f,x.x,x.y)&&se(x.prev,x,x.next)>=0||(x=x.prevZ,v.x>=y&&v.x<=h&&v.y>=m&&v.y<=g&&v!==i&&v!==a&&ai(s,c,l,p,u,f,v.x,v.y)&&se(v.prev,v,v.next)>=0))return!1;v=v.nextZ}for(;x&&x.z>=d;){if(x.x>=y&&x.x<=h&&x.y>=m&&x.y<=g&&x!==i&&x!==a&&ai(s,c,l,p,u,f,x.x,x.y)&&se(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;v&&v.z<=b;){if(v.x>=y&&v.x<=h&&v.y>=m&&v.y<=g&&v!==i&&v!==a&&ai(s,c,l,p,u,f,v.x,v.y)&&se(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function Hg(t,e){let r=t;do{let n=r.prev,i=r.next.next;!Vr(n,i)&&Up(n,r,r.next,i)&&li(n,i)&&li(i,n)&&(e.push(n.i,r.i,i.i),ui(r),ui(r.next),r=t=i),r=r.next}while(r!==t);return ur(r)}function Zg(t,e,r,n,i,o){let a=t;do{let s=a.next.next;for(;s!==a.prev;){if(a.i!==s.i&&ix(a,s)){let l=$p(a,s);a=ur(a,a.next),l=ur(l,l.next),si(a,e,r,n,i,o,0),si(l,e,r,n,i,o,0);return}s=s.next}a=a.next}while(a!==t)}function Jg(t,e,r,n){let i=[];for(let o=0,a=e.length;o<a;o++){let s=e[o]*n,l=o<a-1?e[o+1]*n:t.length,u=Gp(t,s,l,n,!1);u===u.next&&(u.steiner=!0),i.push(nx(u))}i.sort(Yg);for(let o=0;o<i.length;o++)r=Kg(i[o],r);return r}function Yg(t,e){let r=t.x-e.x;if(r===0&&(r=t.y-e.y,r===0)){let n=(t.next.y-t.y)/(t.next.x-t.x),i=(e.next.y-e.y)/(e.next.x-e.x);r=n-i}return r}function Kg(t,e){let r=Qg(t,e);if(!r)return e;let n=$p(r,t);return ur(n,n.next),ur(r,r.next)}function Qg(t,e){let r=e,n=t.x,i=t.y,o=-1/0,a;if(Vr(t,r))return r;do{if(Vr(t,r.next))return r.next;if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){let p=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(p<=n&&p>o&&(o=p,a=r.x<r.next.x?r:r.next,p===n))return a}r=r.next}while(r!==e);if(!a)return null;let s=a,l=a.x,u=a.y,c=1/0;r=a;do{if(n>=r.x&&r.x>=l&&n!==r.x&&Np(i<u?n:o,i,l,u,i<u?o:n,i,r.x,r.y)){let p=Math.abs(i-r.y)/(n-r.x);li(r,t)&&(p<c||p===c&&(r.x>a.x||r.x===a.x&&ex(a,r)))&&(a=r,c=p)}r=r.next}while(r!==s);return a}function ex(t,e){return se(t.prev,t,e.prev)<0&&se(e.next,t,t.next)<0}function tx(t,e,r,n){let i=t;do i.z===0&&(i.z=ml(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,rx(i)}function rx(t){let e,r=1;do{let n=t,i;t=null;let o=null;for(e=0;n;){e++;let a=n,s=0;for(let u=0;u<r&&(s++,a=a.nextZ,!!a);u++);let l=r;for(;s>0||l>0&&a;)s!==0&&(l===0||!a||n.z<=a.z)?(i=n,n=n.nextZ,s--):(i=a,a=a.nextZ,l--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=a}o.nextZ=null,r*=2}while(e>1);return t}function ml(t,e,r,n,i){return t=(t-r)*i|0,e=(e-n)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function nx(t){let e=t,r=t;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==t);return r}function Np(t,e,r,n,i,o,a,s){return(i-a)*(e-s)>=(t-a)*(o-s)&&(t-a)*(n-s)>=(r-a)*(e-s)&&(r-a)*(o-s)>=(i-a)*(n-s)}function ai(t,e,r,n,i,o,a,s){return!(t===a&&e===s)&&Np(t,e,r,n,i,o,a,s)}function ix(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!ox(t,e)&&(li(t,e)&&li(e,t)&&ax(t,e)&&(se(t.prev,t,e.prev)||se(t,e.prev,e))||Vr(t,e)&&se(t.prev,t,t.next)>0&&se(e.prev,e,e.next)>0)}function se(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Vr(t,e){return t.x===e.x&&t.y===e.y}function Up(t,e,r,n){let i=da(se(t,e,r)),o=da(se(t,e,n)),a=da(se(r,n,t)),s=da(se(r,n,e));return!!(i!==o&&a!==s||i===0&&ha(t,r,e)||o===0&&ha(t,n,e)||a===0&&ha(r,t,n)||s===0&&ha(r,e,n))}function ha(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function da(t){return t>0?1:t<0?-1:0}function ox(t,e){let r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&Up(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}function li(t,e){return se(t.prev,t,t.next)<0?se(t,e,t.next)>=0&&se(t,t.prev,e)>=0:se(t,e,t.prev)<0||se(t,t.next,e)<0}function ax(t,e){let r=t,n=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==t);return n}function $p(t,e){let r=hl(t.i,t.x,t.y),n=hl(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function Op(t,e,r,n){let i=hl(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function ui(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function hl(t,e,r){return{i:t,x:e,y:r,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function sx(t,e,r,n){let i=0;for(let o=e,a=r-n;o<r;o+=n)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}var Vt=class{constructor(e,r){if(r>e)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=e,this._minGranularity=r}getGranularityForZoomLevel(e){let r=1<<e;return Math.max(Math.floor(this._baseZoomGranularity/r),this._minGranularity,1)}},xa=class xa{constructor(e){this.fill=e.fill,this.line=e.line,this.tile=e.tile,this.stencil=e.stencil,this.circle=e.circle}};xa.noSubdivision=new xa({fill:new Vt(0,0),line:new Vt(0,0),tile:new Vt(0,0),stencil:new Vt(0,0),circle:1});var ga=xa;I("SubdivisionGranularityExpression",Vt);I("SubdivisionGranularitySetting",ga);var Rr=-32768,ci=32767,gl=class{constructor(e,r){this._vertexBuffer=[];this._vertexDictionary=new Map;this._used=!1;this._granularity=e,this._granularityCellSize=8192/e,this._canonical=r}_getKey(e,r){return e=e+32768,r=r+32768,e<<16|r<<0}_vertexToIndex(e,r){if(e<-32768||r<-32768||e>32767||r>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");let n=Math.round(e)|0,i=Math.round(r)|0,o=this._getKey(n,i);if(this._vertexDictionary.has(o))return this._vertexDictionary.get(o);let a=this._vertexBuffer.length/2;return this._vertexDictionary.set(o,a),this._vertexBuffer.push(n,i),a}_subdivideTrianglesScanline(e){if(this._granularity<2)return ux(this._vertexBuffer,e);let r=[],n=e.length;for(let i=0;i<n;i+=3){let o=[e[i+0],e[i+1],e[i+2]],a=[this._vertexBuffer[e[i+0]*2+0],this._vertexBuffer[e[i+0]*2+1],this._vertexBuffer[e[i+1]*2+0],this._vertexBuffer[e[i+1]*2+1],this._vertexBuffer[e[i+2]*2+0],this._vertexBuffer[e[i+2]*2+1]],s=1/0,l=1/0,u=-1/0,c=-1/0;for(let h=0;h<3;h++){let g=a[h*2],d=a[h*2+1];s=Math.min(s,g),u=Math.max(u,g),l=Math.min(l,d),c=Math.max(c,d)}if(s===u||l===c)continue;let p=Math.floor(s/this._granularityCellSize),f=Math.ceil(u/this._granularityCellSize),y=Math.floor(l/this._granularityCellSize),m=Math.ceil(c/this._granularityCellSize);if(p===f&&y===m){r.push(...o);continue}for(let h=y;h<m;h++){let g=this._scanlineGenerateVertexRingForCellRow(h,a,o);cx(this._vertexBuffer,g,r)}}return r}_scanlineGenerateVertexRingForCellRow(e,r,n){let i=e*this._granularityCellSize,o=i+this._granularityCellSize,a=[];for(let s=0;s<3;s++){let l=r[s*2],u=r[s*2+1],c=r[(s+1)*2%6],p=r[((s+1)*2+1)%6],f=r[(s+2)*2%6],y=r[((s+2)*2+1)%6],m=c-l,h=p-u,g=m===0,d=h===0,b=(i-u)/h,x=(o-u)/h,v=Math.min(b,x),S=Math.max(b,x);if(!d&&(v>=1||S<=0)||d&&(u<i||u>o)){p>=i&&p<=o&&a.push(n[(s+1)%3]);continue}if(!d&&v>0){let T=l+m*v,E=u+h*v;a.push(this._vertexToIndex(T,E))}let A=l+m*Math.max(v,0),w=l+m*Math.min(S,1);if(g||this._generateIntraEdgeVertices(a,l,u,c,p,A,w),!d&&S<1){let T=l+m*S,E=u+h*S;a.push(this._vertexToIndex(T,E))}(d||p>=i&&p<=o)&&a.push(n[(s+1)%3]),!d&&(p<=i||p>=o)&&this._generateInterEdgeVertices(a,l,u,c,p,f,y,w,i,o)}return a}_generateIntraEdgeVertices(e,r,n,i,o,a,s){let l=i-r,u=o-n,c=u===0,p=c?Math.min(r,i):Math.min(a,s),f=c?Math.max(r,i):Math.max(a,s),y=Math.floor(p/this._granularityCellSize)+1,m=Math.ceil(f/this._granularityCellSize)-1;if(c?r<i:a<s)for(let g=y;g<=m;g++){let d=g*this._granularityCellSize,b=n+u*(d-r)/l;e.push(this._vertexToIndex(d,b))}else for(let g=m;g>=y;g--){let d=g*this._granularityCellSize,b=n+u*(d-r)/l;e.push(this._vertexToIndex(d,b))}}_generateInterEdgeVertices(e,r,n,i,o,a,s,l,u,c){let p=o-n,f=a-i,y=s-o,m=(u-o)/y,h=(c-o)/y,g=Math.min(m,h),d=Math.max(m,h),b=i+f*g,x=Math.floor(Math.min(b,l)/this._granularityCellSize)+1,v=Math.ceil(Math.max(b,l)/this._granularityCellSize)-1,S=l<b,A=y===0;if(A&&(s===u||s===c))return;if(A||g>=1||d<=0){let T=r-a,E=n-s,D=(u-s)/E,B=(c-s)/E,z=Math.min(D,B),M=a+T*z;x=Math.floor(Math.min(M,l)/this._granularityCellSize)+1,v=Math.ceil(Math.max(M,l)/this._granularityCellSize)-1,S=l<M}let w=p>0?c:u;if(S)for(let T=x;T<=v;T++){let E=T*this._granularityCellSize;e.push(this._vertexToIndex(E,w))}else for(let T=v;T>=x;T--){let E=T*this._granularityCellSize;e.push(this._vertexToIndex(E,w))}}_generateOutline(e){let r=[];for(let n of e){let i=Ke(n,this._granularity,!0),o=this._pointArrayToIndices(i),a=[];for(let s=1;s<o.length;s++)a.push(o[s-1]),a.push(o[s]);r.push(a)}return r}_handlePoles(e){let r=!1,n=!1;this._canonical&&(this._canonical.y===0&&(r=!0),this._canonical.y===(1<<this._canonical.z)-1&&(n=!0)),(r||n)&&this._fillPoles(e,r,n)}_ensureNoPoleVertices(){let e=this._vertexBuffer;for(let r=0;r<e.length;r+=2){let n=e[r+1];n===Rr&&(e[r+1]=Rr+1),n===ci&&(e[r+1]=ci-1)}}_generatePoleQuad(e,r,n,i,o,a){i>o!=(a===Rr)?(e.push(r),e.push(n),e.push(this._vertexToIndex(i,a)),e.push(n),e.push(this._vertexToIndex(o,a)),e.push(this._vertexToIndex(i,a))):(e.push(n),e.push(r),e.push(this._vertexToIndex(i,a)),e.push(this._vertexToIndex(o,a)),e.push(n),e.push(this._vertexToIndex(i,a)))}_fillPoles(e,r,n){let i=this._vertexBuffer,o=0,a=8192,s=e.length;for(let l=2;l<s;l+=3){let u=e[l-2],c=e[l-1],p=e[l],f=i[u*2],y=i[u*2+1],m=i[c*2],h=i[c*2+1],g=i[p*2],d=i[p*2+1];r&&(y===o&&h===o&&this._generatePoleQuad(e,u,c,f,m,Rr),h===o&&d===o&&this._generatePoleQuad(e,c,p,m,g,Rr),d===o&&y===o&&this._generatePoleQuad(e,p,u,g,f,Rr)),n&&(y===a&&h===a&&this._generatePoleQuad(e,u,c,f,m,ci),h===a&&d===a&&this._generatePoleQuad(e,c,p,m,g,ci),d===a&&y===a&&this._generatePoleQuad(e,p,u,g,f,ci))}}_initializeVertices(e){for(let r=0;r<e.length;r+=2)this._vertexToIndex(e[r],e[r+1])}subdividePolygonInternal(e,r){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;let{flattened:n,holeIndices:i}=lx(e);this._initializeVertices(n);let o;try{let s=dl(n,i),l=this._convertIndices(n,s);o=this._subdivideTrianglesScanline(l)}catch(s){console.error(s)}let a=[];return r&&(a=this._generateOutline(e)),this._ensureNoPoleVertices(),this._handlePoles(o),{verticesFlattened:this._vertexBuffer,indicesTriangles:o,indicesLineList:a}}_convertIndices(e,r){let n=[];for(let i=0;i<r.length;i++){let o=e[r[i]*2],a=e[r[i]*2+1];n.push(this._vertexToIndex(o,a))}return n}_pointArrayToIndices(e){let r=[];for(let n=0;n<e.length;n++){let i=e[n];r.push(this._vertexToIndex(i.x,i.y))}return r}};function ba(t,e,r,n=!0){return new gl(r,e).subdividePolygonInternal(t,n)}function Ke(t,e,r=!1){if(!t||t.length<1)return[];if(t.length<2)return[];let n=t[0],i=t[t.length-1],o=r&&(n.x!==i.x||n.y!==i.y);if(e<2)return o?[...t,t[0]]:[...t];let a=Math.floor(8192/e),s=[];s.push(new pi.default(t[0].x,t[0].y));let l=t.length,u=o?l:l-1;for(let c=0;c<u;c++){let p=t[c],f=c<l-1?t[c+1]:t[0],y=p.x,m=p.y,h=f.x,g=f.y,d=y!==h,b=m!==g;if(!d&&!b)continue;let x=h-y,v=g-m,S=Math.abs(x),A=Math.abs(v),w=y,T=m;for(;;){let D=x>0?(Math.floor(w/a)+1)*a:(Math.ceil(w/a)-1)*a,B=v>0?(Math.floor(T/a)+1)*a:(Math.ceil(T/a)-1)*a,z=Math.abs(w-D),M=Math.abs(T-B),_=Math.abs(w-h),V=Math.abs(T-g),G=d?z/S:Number.POSITIVE_INFINITY,O=b?M/A:Number.POSITIVE_INFINITY;if((_<=z||!d)&&(V<=M||!b))break;if(G<O&&d||!b){w=D,T=T+v*G;let R=new pi.default(w,Math.round(T));(s[s.length-1].x!==R.x||s[s.length-1].y!==R.y)&&s.push(R)}else{w=w+x*O,T=B;let R=new pi.default(Math.round(w),T);(s[s.length-1].x!==R.x||s[s.length-1].y!==R.y)&&s.push(R)}}let E=new pi.default(h,g);(s[s.length-1].x!==E.x||s[s.length-1].y!==E.y)&&s.push(E)}return s}function lx(t){let e=[],r=[];for(let n of t)if(n.length!==0){n!==t[0]&&e.push(r.length/2);for(let i=0;i<n.length;i++)r.push(n[i].x),r.push(n[i].y)}return{flattened:r,holeIndices:e}}function ux(t,e){let r=[];for(let n=0;n<e.length;n+=3){let i=e[n],o=e[n+1],a=e[n+2],s=t[i*2],l=t[i*2+1],u=t[o*2],c=t[o*2+1],p=t[a*2],f=t[a*2+1],y=u-s,m=c-l,h=p-s,g=f-l;y*g-m*h>0?(r.push(i),r.push(a),r.push(o)):(r.push(i),r.push(o),r.push(a))}return r}function cx(t,e,r){if(e.length===0)throw new Error("Subdivision vertex ring is empty.");let n=0,i=t[e[0]*2];for(let l=1;l<e.length;l++){let u=t[e[l]*2];u<i&&(i=u,n=l)}let o=e.length,a=n,s=(a+1)%o;for(;;){let l=a-1>=0?a-1:o-1,u=(s+1)%o,c=t[e[l]*2],p=t[e[l]*2+1],f=t[e[u]*2],y=t[e[u]*2+1],m=t[e[a]*2],h=t[e[a]*2+1],g=t[e[s]*2],d=t[e[s]*2+1],b=!1;if(c<f)b=!0;else if(c>f)b=!1;else{let x=g-m,S=d-h,A=-x,w=h<d?1:-1,T=((c-m)*S+(p-h)*A)*w,E=((f-m)*S+(y-h)*A)*w;T>E&&(b=!0)}if(b){let x=e[l],v=e[a],S=e[s];x!==v&&x!==S&&v!==S&&r.push(S,v,x),a--,a<0&&(a=o-1)}else{let x=e[u],v=e[a],S=e[s];x!==v&&x!==S&&v!==S&&r.push(S,v,x),s++,s>=o&&(s=0)}if(l===u)break}}function va(t,e,r,n,i,o,a,s,l){let u=i.length/2,c=a&&s&&l;if(u<pe.MAX_VERTEX_ARRAY_LENGTH){let p=e.prepareSegment(u,r,n),f=p.vertexLength;for(let h=0;h<o.length;h+=3)n.emplaceBack(f+o[h],f+o[h+1],f+o[h+2]);p.vertexLength+=u,p.primitiveLength+=o.length/3;let y,m;c&&(m=a.prepareSegment(u,r,s),y=m.vertexLength,m.vertexLength+=u);for(let h=0;h<i.length;h+=2)t(i[h],i[h+1]);if(c)for(let h=0;h<l.length;h++){let g=l[h];for(let d=1;d<g.length;d+=2)s.emplaceBack(y+g[d-1],y+g[d]);m.primitiveLength+=g.length/2}}else px(e,r,n,i,o,t),c&&fx(a,r,s,i,l,t),e.forceNewSegmentOnNextPrepare(),a==null||a.forceNewSegmentOnNextPrepare()}function fi(t,e,r,n,i,o,a){if(o){let s=n.count;return r(e[i*2],e[i*2+1]),t[i]=n.count,n.count++,a.vertexLength++,s}else return t[i]}function px(t,e,r,n,i,o){let a=[];for(let p=0;p<n.length/2;p++)a.push(-1);let s={count:0},l=0,u=t.getOrCreateLatestSegment(e,r),c=u.vertexLength;for(let p=2;p<i.length;p+=3){let f=i[p-2],y=i[p-1],m=i[p],h=a[f]<l,g=a[y]<l,d=a[m]<l,b=(h?1:0)+(g?1:0)+(d?1:0);u.vertexLength+b>pe.MAX_VERTEX_ARRAY_LENGTH&&(u=t.createNewSegment(e,r),l=s.count,h=!0,g=!0,d=!0,c=0);let x=fi(a,n,o,s,f,h,u),v=fi(a,n,o,s,y,g,u),S=fi(a,n,o,s,m,d,u);r.emplaceBack(c+x-l,c+v-l,c+S-l),u.primitiveLength++}}function fx(t,e,r,n,i,o){let a=[];for(let p=0;p<n.length/2;p++)a.push(-1);let s={count:0},l=0,u=t.getOrCreateLatestSegment(e,r),c=u.vertexLength;for(let p=0;p<i.length;p++){let f=i[p];for(let y=1;y<i[p].length;y+=2){let m=f[y-1],h=f[y],g=a[m]<l,d=a[h]<l,b=(g?1:0)+(d?1:0);u.vertexLength+b>pe.MAX_VERTEX_ARRAY_LENGTH&&(u=t.createNewSegment(e,r),l=s.count,g=!0,d=!0,c=0);let x=fi(a,n,o,s,m,g,u),v=fi(a,n,o,s,h,d,u);r.emplaceBack(c+x-l,c+v-l),u.primitiveLength++}}}var yx=500,cr=class{constructor(e){this.zoom=e.zoom,this.globalState=e.globalState,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Jo,this.indexArray=new Le,this.indexArray2=new Mt,this.programConfigurations=new Ae(e.layers,e.zoom),this.segments=new pe,this.segments2=new pe,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,n){this.hasPattern=Dr("fill",this.layers,r);let i=this.layers[0].layout.get("fill-sort-key"),o=!i.isConstant(),a=[];for(let{feature:s,id:l,index:u,sourceLayerIndex:c}of e){let p=this.layers[0]._featureFilter.needGeometry,f=Ne(s,p);if(!this.layers[0]._featureFilter.filter(new W(this.zoom,{globalState:this.globalState}),f,n))continue;let y=o?i.evaluate(f,{},n,r.availableImages):void 0,m={id:l,properties:s.properties,type:s.type,sourceLayerIndex:c,index:u,geometry:p?f.geometry:_e(s),patterns:{},sortKey:y};a.push(m)}o&&a.sort((s,l)=>s.sortKey-l.sortKey);for(let s of a){let{geometry:l,index:u,sourceLayerIndex:c}=s;if(this.hasPattern){let f=Br("fill",this.layers,s,this.zoom,r);this.patternFeatures.push(f)}else this.addFeature(s,l,u,n,{},r.subdivisionGranularity);let p=e[u].feature;r.featureIndex.insert(p,l,u,c,this.index)}}update(e,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n)}addFeatures(e,r,n){for(let i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,r,n,e.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,zp),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,r,n,i,o,a){for(let s of Kt(r,yx)){let l=ba(s,i,a.fill.getGranularityForZoomLevel(i.z)),u=this.layoutVertexArray;va((c,p)=>{u.emplaceBack(c,p)},this.segments,this.layoutVertexArray,this.indexArray,l.verticesFlattened,l.indicesTriangles,this.segments2,this.indexArray2,l.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,o,i)}};I("FillBucket",cr,{omit:["layers","patternFeatures"]});var jp,mx=()=>jp=jp||new ee({"fill-sort-key":new L(P.layout_fill["fill-sort-key"])}),qp,hx=()=>qp=qp||new ee({"fill-antialias":new F(P.paint_fill["fill-antialias"]),"fill-opacity":new L(P.paint_fill["fill-opacity"]),"fill-color":new L(P.paint_fill["fill-color"]),"fill-outline-color":new L(P.paint_fill["fill-outline-color"]),"fill-translate":new F(P.paint_fill["fill-translate"]),"fill-translate-anchor":new F(P.paint_fill["fill-translate-anchor"]),"fill-pattern":new pt(P.paint_fill["fill-pattern"])}),Wp={get paint(){return hx()},get layout(){return mx()}};var Pa=class extends oe{constructor(e){super(e,Wp)}recalculate(e,r){super.recalculate(e,r);let n=this.paint._values["fill-outline-color"];n.value.kind==="constant"&&n.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new cr(e)}queryRadius(){return Dt(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:e,geometry:r,transform:n,pixelsToTileUnits:i}){let o=Bt(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-n.bearingInRadians,i);return ua(o,r)}isTileClipped(){return!0}};var dx=Q([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Xp=Q([{name:"a_centroid",components:2,type:"Int16"}],4);var{members:Hp,size:zS,alignment:OS}=dx;var tf=Y(Rt(),1);var Cx=tf.default.VectorTileFeature.types,kx=500,vl=Math.pow(2,13);function yi(t,e,r,n,i,o,a,s){t.emplaceBack(e,r,Math.floor(n*vl)*2+a,i*vl*2,o*vl*2,Math.round(s))}var pr=class{constructor(e){this.zoom=e.zoom,this.globalState=e.globalState,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Yo,this.centroidVertexArray=new Ho,this.indexArray=new Le,this.programConfigurations=new Ae(e.layers,e.zoom),this.segments=new pe,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,n){this.features=[],this.hasPattern=Dr("fill-extrusion",this.layers,r);for(let{feature:i,id:o,index:a,sourceLayerIndex:s}of e){let l=this.layers[0]._featureFilter.needGeometry,u=Ne(i,l);if(!this.layers[0]._featureFilter.filter(new W(this.zoom,{globalState:this.globalState}),u,n))continue;let c={id:o,sourceLayerIndex:s,index:a,geometry:l?u.geometry:_e(i),properties:i.properties,type:i.type,patterns:{}};this.hasPattern?this.features.push(Br("fill-extrusion",this.layers,c,this.zoom,r)):this.addFeature(c,c.geometry,a,n,{},r.subdivisionGranularity),r.featureIndex.insert(i,c.geometry,a,s,this.index,!0)}}addFeatures(e,r,n){for(let i of this.features){let{geometry:o}=i;this.addFeature(i,o,i.index,r,n,e.subdivisionGranularity)}}update(e,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Hp),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Xp.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,r,n,i,o,a){for(let s of Kt(r,kx)){let l={x:0,y:0,sampleCount:0},u=this.layoutVertexArray.length;this.processPolygon(l,i,e,s,a);let c=this.layoutVertexArray.length-u,p=Math.floor(l.x/l.sampleCount),f=Math.floor(l.y/l.sampleCount);for(let y=0;y<c;y++)this.centroidVertexArray.emplaceBack(p,f)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,o,i)}processPolygon(e,r,n,i,o){if(i.length<1||ef(i[0]))return;for(let p of i)p.length!==0&&Fx(e,p);let a={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},s=o.fill.getGranularityForZoomLevel(r.z),l=Cx[n.type]==="Polygon";for(let p of i){if(p.length===0||ef(p))continue;let f=Ke(p,s,l);this._generateSideFaces(f,a)}if(!l)return;let u=ba(i,r,s,!1),c=this.layoutVertexArray;va((p,f)=>{yi(c,p,f,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,u.verticesFlattened,u.indicesTriangles)}_generateSideFaces(e,r){let n=0;for(let i=1;i<e.length;i++){let o=e[i],a=e[i-1];if(Ex(o,a))continue;r.segment.vertexLength+4>pe.MAX_VERTEX_ARRAY_LENGTH&&(r.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let s=o.sub(a)._perp()._unit(),l=a.dist(o);n+l>32768&&(n=0),yi(this.layoutVertexArray,o.x,o.y,s.x,s.y,0,0,n),yi(this.layoutVertexArray,o.x,o.y,s.x,s.y,0,1,n),n+=l,yi(this.layoutVertexArray,a.x,a.y,s.x,s.y,0,0,n),yi(this.layoutVertexArray,a.x,a.y,s.x,s.y,0,1,n);let u=r.segment.vertexLength;this.indexArray.emplaceBack(u,u+2,u+1),this.indexArray.emplaceBack(u+1,u+2,u+3),r.segment.vertexLength+=4,r.segment.primitiveLength+=2}}};function Fx(t,e){for(let r=0;r<e.length;r++){let n=e[r];r===e.length-1&&e[0].x===n.x&&e[0].y===n.y||(t.x+=n.x,t.y+=n.y,t.sampleCount++)}}I("FillExtrusionBucket",pr,{omit:["layers","features"]});function Ex(t,e){return t.x===e.x&&(t.x<0||t.x>8192)||t.y===e.y&&(t.y<0||t.y>8192)}function ef(t){return t.every(e=>e.x<0)||t.every(e=>e.x>8192)||t.every(e=>e.y<0)||t.every(e=>e.y>8192)}var rf,Mx=()=>rf=rf||new ee({"fill-extrusion-opacity":new F(P["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new L(P["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new F(P["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new F(P["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new pt(P["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new L(P["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new L(P["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new F(P["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])}),nf={get paint(){return Mx()}};var wa=Y(ye(),1);var Aa=class extends oe{constructor(e){super(e,nf)}createBucket(e){return new pr(e)}queryRadius(){return Dt(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:e,feature:r,featureState:n,geometry:i,transform:o,pixelsToTileUnits:a,pixelPosMatrix:s}){let l=Bt(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-o.bearingInRadians,a),u=this.paint.get("fill-extrusion-height").evaluate(r,n),c=this.paint.get("fill-extrusion-base").evaluate(r,n),p=Bx(l,s,0),f=Dx(i,c,u,s),y=f[0],m=f[1];return Lx(y,m,p)}};function mi(t,e){return t.x*e.x+t.y*e.y}function of(t,e){if(t.length===1){let r=0,n=e[r++],i;for(;!i||n.equals(i);)if(i=e[r++],!i)return 1/0;for(;r<e.length;r++){let o=e[r],a=t[0],s=i.sub(n),l=o.sub(n),u=a.sub(n),c=mi(s,s),p=mi(s,l),f=mi(l,l),y=mi(u,s),m=mi(u,l),h=c*f-p*p,g=(f*y-p*m)/h,d=(c*m-p*y)/h,b=1-g-d,x=n.z*b+i.z*g+o.z*d;if(isFinite(x))return x}return 1/0}else{let r=1/0;for(let n of e)r=Math.min(r,n.z);return r}}function Lx(t,e,r){let n=1/0;ua(r,e)&&(n=of(r,e[0]));for(let i=0;i<e.length;i++){let o=e[i],a=t[i];for(let s=0;s<o.length-1;s++){let l=o[s],u=o[s+1],c=a[s],p=a[s+1],f=[l,u,p,c,l];bp(r,f)&&(n=Math.min(n,of(r,f)))}}return n===1/0?!1:n}function Dx(t,e,r,n){let i=[],o=[],a=n[8]*e,s=n[9]*e,l=n[10]*e,u=n[11]*e,c=n[8]*r,p=n[9]*r,f=n[10]*r,y=n[11]*r;for(let m of t){let h=[],g=[];for(let d of m){let b=d.x,x=d.y,v=n[0]*b+n[4]*x+n[12],S=n[1]*b+n[5]*x+n[13],A=n[2]*b+n[6]*x+n[14],w=n[3]*b+n[7]*x+n[15],T=v+a,E=S+s,D=A+l,B=w+u,z=v+c,M=S+p,_=A+f,V=w+y,G=new wa.default(T/B,E/B);G.z=D/B,h.push(G);let O=new wa.default(z/V,M/V);O.z=_/V,g.push(O)}i.push(h),o.push(g)}return[i,o]}function Bx(t,e,r){let n=[];for(let i of t){let o=[i.x,i.y,r,1];Zi.transformMat4(o,o,e),n.push(new wa.default(o[0]/o[3],o[1]/o[3]))}return n}var Vx=Q([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:af,size:Pw,alignment:Sw}=Vx;var Rx=Q([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:sf,size:_w,alignment:Iw}=Rx;var cf=Y(Rt(),1);var zx=cf.default.VectorTileFeature.types,lf=63,Ox=Math.cos(75/2*(Math.PI/180)),Gx=15,Nx=20,Ux=15,pf=1/2,uf=Math.pow(2,Ux-1)/pf,fr=class{constructor(e){this.zoom=e.zoom,this.globalState=e.globalState,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new Ko,this.layoutVertexArray2=new Qo,this.indexArray=new Le,this.programConfigurations=new Ae(e.layers,e.zoom),this.segments=new pe,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,n){this.hasPattern=Dr("line",this.layers,r);let i=this.layers[0].layout.get("line-sort-key"),o=!i.isConstant(),a=[];for(let{feature:s,id:l,index:u,sourceLayerIndex:c}of e){let p=this.layers[0]._featureFilter.needGeometry,f=Ne(s,p);if(!this.layers[0]._featureFilter.filter(new W(this.zoom,{globalState:this.globalState}),f,n))continue;let y=o?i.evaluate(f,{},n):void 0,m={id:l,properties:s.properties,type:s.type,sourceLayerIndex:c,index:u,geometry:p?f.geometry:_e(s),patterns:{},sortKey:y};a.push(m)}o&&a.sort((s,l)=>s.sortKey-l.sortKey);for(let s of a){let{geometry:l,index:u,sourceLayerIndex:c}=s;if(this.hasPattern){let f=Br("line",this.layers,s,this.zoom,r);this.patternFeatures.push(f)}else this.addFeature(s,l,u,n,{},r.subdivisionGranularity);let p=e[u].feature;r.featureIndex.insert(p,l,u,c,this.index)}}update(e,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n)}addFeatures(e,r,n){for(let i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,r,n,e.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,sf)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,af),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end")){let r=+e.properties.mapbox_clip_start,n=+e.properties.mapbox_clip_end;return{start:r,end:n}}}addFeature(e,r,n,i,o,a){let s=this.layers[0].layout,l=s.get("line-join").evaluate(e,{}),u=s.get("line-cap"),c=s.get("line-miter-limit"),p=s.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(let f of r)this.addLine(f,e,l,u,c,p,i,a);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,o,i)}addLine(e,r,n,i,o,a,s,l){this.distance=0,this.scaledDistance=0,this.totalDistance=0;let u=s?l.line.getGranularityForZoomLevel(s.z):1;if(e=Ke(e,u),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let v=0;v<e.length-1;v++)this.totalDistance+=e[v].dist(e[v+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let c=zx[r.type]==="Polygon",p=e.length;for(;p>=2&&e[p-1].equals(e[p-2]);)p--;let f=0;for(;f<p-1&&e[f].equals(e[f+1]);)f++;if(p<(c?3:2))return;n==="bevel"&&(o=1.05);let y=this.overscaling<=16?Gx*8192/(512*this.overscaling):0,m=this.segments.prepareSegment(p*10,this.layoutVertexArray,this.indexArray),h,g,d,b,x;this.e1=this.e2=-1,c&&(h=e[p-2],x=e[f].sub(h)._unit()._perp());for(let v=f;v<p;v++){if(d=v===p-1?c?e[f+1]:void 0:e[v+1],d&&e[v].equals(d))continue;x&&(b=x),h&&(g=h),h=e[v],x=d?d.sub(h)._unit()._perp():b,b=b||x;let S=b.add(x);(S.x!==0||S.y!==0)&&S._unit();let A=b.x*x.x+b.y*x.y,w=S.x*x.x+S.y*x.y,T=w!==0?1/w:1/0,E=2*Math.sqrt(2-2*w),D=w<Ox&&g&&d,B=b.x*x.y-b.y*x.x>0;if(D&&v>f){let _=h.dist(g);if(_>2*y){let V=h.sub(h.sub(g)._mult(y/_)._round());this.updateDistance(g,V),this.addCurrentVertex(V,b,0,0,m),g=V}}let z=g&&d,M=z?n:c?"butt":i;if(z&&M==="round"&&(T<a?M="miter":T<=2&&(M="fakeround")),M==="miter"&&T>o&&(M="bevel"),M==="bevel"&&(T>2&&(M="flipbevel"),T<o&&(M="miter")),g&&this.updateDistance(g,h),M==="miter")S._mult(T),this.addCurrentVertex(h,S,0,0,m);else if(M==="flipbevel"){if(T>100)S=x.mult(-1);else{let _=T*b.add(x).mag()/b.sub(x).mag();S._perp()._mult(_*(B?-1:1))}this.addCurrentVertex(h,S,0,0,m),this.addCurrentVertex(h,S.mult(-1),0,0,m)}else if(M==="bevel"||M==="fakeround"){let _=-Math.sqrt(T*T-1),V=B?_:0,G=B?0:_;if(g&&this.addCurrentVertex(h,b,V,G,m),M==="fakeround"){let O=Math.round(E*180/Math.PI/Nx);for(let R=1;R<O;R++){let K=R/O;if(K!==.5){let re=K-.5,me=1.0904+A*(-3.2452+A*(3.55645-A*1.43519)),Ut=.848013+A*(-1.06021+A*.215638);K=K+K*re*(K-1)*(me*re*re+Ut)}let X=x.sub(b)._mult(K)._add(b)._unit()._mult(B?-1:1);this.addHalfVertex(h,X.x,X.y,!1,B,0,m)}}d&&this.addCurrentVertex(h,x,-V,-G,m)}else if(M==="butt")this.addCurrentVertex(h,S,0,0,m);else if(M==="square"){let _=g?1:-1;this.addCurrentVertex(h,S,_,_,m)}else M==="round"&&(g&&(this.addCurrentVertex(h,b,0,0,m),this.addCurrentVertex(h,b,1,1,m,!0)),d&&(this.addCurrentVertex(h,x,-1,-1,m,!0),this.addCurrentVertex(h,x,0,0,m)));if(D&&v<p-1){let _=h.dist(d);if(_>2*y){let V=h.add(d.sub(h)._mult(y/_)._round());this.updateDistance(h,V),this.addCurrentVertex(V,x,0,0,m),h=V}}}}addCurrentVertex(e,r,n,i,o,a=!1){let s=r.x+r.y*n,l=r.y-r.x*n,u=-r.x+r.y*i,c=-r.y-r.x*i;this.addHalfVertex(e,s,l,a,!1,n,o),this.addHalfVertex(e,u,c,a,!0,-i,o),this.distance>uf/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,r,n,i,o,a))}addHalfVertex({x:e,y:r},n,i,o,a,s,l){let c=(this.lineClips?this.scaledDistance*(uf-1):this.scaledDistance)*pf;if(this.layoutVertexArray.emplaceBack((e<<1)+(o?1:0),(r<<1)+(a?1:0),Math.round(lf*n)+128,Math.round(lf*i)+128,(s===0?0:s<0?-1:1)+1|(c&63)<<2,c>>6),this.lineClips){let f=this.scaledDistance-this.lineClips.start,y=this.lineClips.end-this.lineClips.start,m=f/y;this.layoutVertexArray2.emplaceBack(m,this.lineClipsArray.length)}let p=l.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,p,this.e2),l.primitiveLength++),a?this.e2=p:this.e1=p}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,r){this.distance+=e.dist(r),this.updateScaledDistance()}};I("LineBucket",fr,{omit:["layers","patternFeatures"]});var ff,$x=()=>ff=ff||new ee({"line-cap":new F(P.layout_line["line-cap"]),"line-join":new L(P.layout_line["line-join"]),"line-miter-limit":new F(P.layout_line["line-miter-limit"]),"line-round-limit":new F(P.layout_line["line-round-limit"]),"line-sort-key":new L(P.layout_line["line-sort-key"])}),yf,jx=()=>yf=yf||new ee({"line-opacity":new L(P.paint_line["line-opacity"]),"line-color":new L(P.paint_line["line-color"]),"line-translate":new F(P.paint_line["line-translate"]),"line-translate-anchor":new F(P.paint_line["line-translate-anchor"]),"line-width":new L(P.paint_line["line-width"]),"line-gap-width":new L(P.paint_line["line-gap-width"]),"line-offset":new L(P.paint_line["line-offset"]),"line-blur":new L(P.paint_line["line-blur"]),"line-dasharray":new rr(P.paint_line["line-dasharray"]),"line-pattern":new pt(P.paint_line["line-pattern"]),"line-gradient":new ft(P.paint_line["line-gradient"])}),Pl={get paint(){return jx()},get layout(){return $x()}};var Sl=class extends L{possiblyEvaluate(e,r){return r=new W(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(e,r)}evaluate(e,r,n,i){return r=de({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(e,r,n,i)}},_a;var Ia=class extends oe{constructor(e){super(e,Pl),this.gradientVersion=0,_a||(_a=new Sl(Pl.paint.properties["line-width"].specification),_a.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){let r=this.gradientExpression();gc(r)?this.stepInterpolant=r._styleExpression.expression instanceof Sr:this.stepInterpolant=!1,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,r){super.recalculate(e,r),this.paint._values["line-floorwidth"]=_a.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new fr(e)}queryRadius(e){let r=e,n=mf(sr("line-width",this,r),sr("line-gap-width",this,r)),i=sr("line-offset",this,r);return n/2+Math.abs(i)+Dt(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:e,feature:r,featureState:n,geometry:i,transform:o,pixelsToTileUnits:a}){let s=Bt(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-o.bearingInRadians,a),l=a/2*mf(this.paint.get("line-width").evaluate(r,n),this.paint.get("line-gap-width").evaluate(r,n)),u=this.paint.get("line-offset").evaluate(r,n);return u&&(i=wp(i,u*a)),Pp(s,i,l)}isTileClipped(){return!0}};function mf(t,e){return e>0?e+2*t:t}var hf=Q([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),df=Q([{name:"a_projected_pos",components:3,type:"Float32"}],4),iA=Q([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),gf=Q([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]),oA=Q([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),wl=Q([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),aA=Q([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4),sA=Q([{name:"triangle",components:3,type:"Uint16"}]),lA=Q([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),uA=Q([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),cA=Q([{type:"Float32",name:"offsetX"}]),pA=Q([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),fA=Q([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var Pi=Y(ye(),1);function qx(t,e,r){let n=e.layout.get("text-transform").evaluate(r,{});return n==="uppercase"?t=t.toLocaleUpperCase():n==="lowercase"&&(t=t.toLocaleLowerCase()),we.applyArabicShaping&&(t=we.applyArabicShaping(t)),t}function xf(t,e,r){return t.sections.forEach(n=>{n.text=qx(n.text,e,r)}),t}function bf(t){let e={},r={},n=[],i=0;function o(u){n.push(t[u]),i++}function a(u,c,p){let f=r[u];return delete r[u],r[c]=f,n[f].geometry[0].pop(),n[f].geometry[0]=n[f].geometry[0].concat(p[0]),f}function s(u,c,p){let f=e[c];return delete e[c],e[u]=f,n[f].geometry[0].shift(),n[f].geometry[0]=p[0].concat(n[f].geometry[0]),f}function l(u,c,p){let f=p?c[0][c[0].length-1]:c[0][0];return"".concat(u,":").concat(f.x,":").concat(f.y)}for(let u=0;u<t.length;u++){let c=t[u],p=c.geometry,f=c.text?c.text.toString():null;if(!f){o(u);continue}let y=l(f,p),m=l(f,p,!0);if(y in r&&m in e&&r[y]!==e[m]){let h=s(y,m,p),g=a(y,m,n[h].geometry);delete e[y],delete r[m],r[l(f,n[g].geometry,!0)]=g,n[h].geometry=null}else y in r?a(y,m,p):m in e?s(y,m,p):(o(u),e[y]=i-1,r[m]=i-1)}return n.filter(u=>u.geometry)}var Or={"!":"\\uFE15","#":"\\uFF03",$:"\\uFF04","%":"\\uFF05","&":"\\uFF06","(":"\\uFE35",")":"\\uFE36","*":"\\uFF0A","+":"\\uFF0B",",":"\\uFE10","-":"\\uFE32",".":"\\u30FB","/":"\\uFF0F",":":"\\uFE13",";":"\\uFE14","<":"\\uFE3F","=":"\\uFF1D",">":"\\uFE40","?":"\\uFE16","@":"\\uFF20","[":"\\uFE47","\\\\":"\\uFF3C","]":"\\uFE48","^":"\\uFF3E",_:"\\uFE33","\`":"\\uFF40","{":"\\uFE37","|":"\\u2015","}":"\\uFE38","~":"\\uFF5E","\\xA2":"\\uFFE0","\\xA3":"\\uFFE1","\\xA5":"\\uFFE5","\\xA6":"\\uFFE4","\\xAC":"\\uFFE2","\\xAF":"\\uFFE3","\\u2013":"\\uFE32","\\u2014":"\\uFE31","\\u2018":"\\uFE43","\\u2019":"\\uFE44","\\u201C":"\\uFE41","\\u201D":"\\uFE42","\\u2026":"\\uFE19","\\u2027":"\\u30FB","\\u20A9":"\\uFFE6","\\u3001":"\\uFE11","\\u3002":"\\uFE12","\\u3008":"\\uFE3F","\\u3009":"\\uFE40","\\u300A":"\\uFE3D","\\u300B":"\\uFE3E","\\u300C":"\\uFE41","\\u300D":"\\uFE42","\\u300E":"\\uFE43","\\u300F":"\\uFE44","\\u3010":"\\uFE3B","\\u3011":"\\uFE3C","\\u3014":"\\uFE39","\\u3015":"\\uFE3A","\\u3016":"\\uFE17","\\u3017":"\\uFE18","\\uFF01":"\\uFE15","\\uFF08":"\\uFE35","\\uFF09":"\\uFE36","\\uFF0C":"\\uFE10","\\uFF0D":"\\uFE32","\\uFF0E":"\\u30FB","\\uFF1A":"\\uFE13","\\uFF1B":"\\uFE14","\\uFF1C":"\\uFE3F","\\uFF1E":"\\uFE40","\\uFF1F":"\\uFE16","\\uFF3B":"\\uFE47","\\uFF3D":"\\uFE48","\\uFF3F":"\\uFE33","\\uFF5B":"\\uFE37","\\uFF5C":"\\u2015","\\uFF5D":"\\uFE38","\\uFF5F":"\\uFE35","\\uFF60":"\\uFE36","\\uFF61":"\\uFE12","\\uFF62":"\\uFE41","\\uFF63":"\\uFE42"};function vf(t){let e="";for(let r=0;r<t.length;r++){let n=t.charCodeAt(r+1)||null,i=t.charCodeAt(r-1)||null;(!n||!Qs(n)||Or[t[r+1]])&&(!i||!Qs(i)||Or[t[r-1]])&&Or[t[r]]?e+=Or[t[r]]:e+=t[r]}return e}var ae=24;var ub=Y(hi(),1),cb=3;var ka=cb;function di(t){let e=0,r=0;for(let s of t)e+=s.w*s.h,r=Math.max(r,s.w);t.sort((s,l)=>l.h-s.h);let i=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}],o=0,a=0;for(let s of t)for(let l=i.length-1;l>=0;l--){let u=i[l];if(!(s.w>u.w||s.h>u.h)){if(s.x=u.x,s.y=u.y,a=Math.max(a,s.y+s.h),o=Math.max(o,s.x+s.w),s.w===u.w&&s.h===u.h){let c=i.pop();l<i.length&&(i[l]=c)}else s.h===u.h?(u.x+=s.w,u.w-=s.w):s.w===u.w?(u.y+=s.h,u.h-=s.h):(i.push({x:u.x+s.w,y:u.y,w:u.w-s.w,h:s.h}),u.y+=s.h,u.h-=s.h);break}}return{w:o,h:a,fill:e/(o*a)||0}}var he=1;var Fa=class{constructor(e,{pixelRatio:r,version:n,stretchX:i,stretchY:o,content:a,textFitWidth:s,textFitHeight:l}){this.paddedRect=e,this.pixelRatio=r,this.stretchX=i,this.stretchY=o,this.content=a,this.version=n,this.textFitWidth=s,this.textFitHeight=l}get tl(){return[this.paddedRect.x+he,this.paddedRect.y+he]}get br(){return[this.paddedRect.x+this.paddedRect.w-he,this.paddedRect.y+this.paddedRect.h-he]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-he*2)/this.pixelRatio,(this.paddedRect.h-he*2)/this.pixelRatio]}},gi=class{constructor(e,r){let n={},i={};this.haveRenderCallbacks=[];let o=[];this.addImages(e,n,o),this.addImages(r,i,o);let{w:a,h:s}=di(o),l=new fe({width:a||1,height:s||1});for(let u in e){let c=e[u],p=n[u].paddedRect;fe.copy(c.data,l,{x:0,y:0},{x:p.x+he,y:p.y+he},c.data)}for(let u in r){let c=r[u],p=i[u].paddedRect,f=p.x+he,y=p.y+he,m=c.data.width,h=c.data.height;fe.copy(c.data,l,{x:0,y:0},{x:f,y},c.data),fe.copy(c.data,l,{x:0,y:h-1},{x:f,y:y-1},{width:m,height:1}),fe.copy(c.data,l,{x:0,y:0},{x:f,y:y+h},{width:m,height:1}),fe.copy(c.data,l,{x:m-1,y:0},{x:f-1,y},{width:1,height:h}),fe.copy(c.data,l,{x:0,y:0},{x:f+m,y},{width:1,height:h})}this.image=l,this.iconPositions=n,this.patternPositions=i}addImages(e,r,n){for(let i in e){let o=e[i],a={x:0,y:0,w:o.data.width+2*he,h:o.data.height+2*he};n.push(a),r[i]=new Fa(a,o),o.hasRenderCallback&&this.haveRenderCallbacks.push(i)}}patchUpdatedImages(e,r){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let n in e.updatedImages)this.patchUpdatedImage(this.iconPositions[n],e.getImage(n),r),this.patchUpdatedImage(this.patternPositions[n],e.getImage(n),r)}patchUpdatedImage(e,r,n){if(!e||!r||e.version===r.version)return;e.version=r.version;let[i,o]=e.tl;n.update(r.data,void 0,{x:i,y:o})}};I("ImagePosition",Fa);I("ImageAtlas",gi);var La=(i=>(i[i.none=0]="none",i[i.horizontal=1]="horizontal",i[i.vertical=2]="vertical",i[i.horizontalOnly=3]="horizontalOnly",i))(La||{}),bi=-17;function pb(t){for(let e of t)if(e.positionedGlyphs.length!==0)return!1;return!0}var Tf=57344,Cf=63743,Ea=class t{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(e,r,n){let i=new t;return i.scale=e||1,i.fontStack=r,i.verticalAlign=n||"bottom",i}static forImage(e,r){let n=new t;return n.imageName=e,n.verticalAlign=r||"bottom",n}},xi=class t{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,r){let n=new t;for(let i=0;i<e.sections.length;i++){let o=e.sections[i];o.image?n.addImageSection(o):n.addTextSection(o,r)}return n}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=vf(this.text)}trim(){let e=0;for(let n=0;n<this.text.length&&Ma[this.text.charCodeAt(n)];n++)e++;let r=this.text.length;for(let n=this.text.length-1;n>=0&&n>=e&&Ma[this.text.charCodeAt(n)];n--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)}substring(e,r){let n=new t;return n.text=this.text.substring(e,r),n.sectionIndex=this.sectionIndex.slice(e,r),n.sections=this.sections,n}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,r)=>Math.max(e,this.sections[r].scale),0)}getMaxImageSize(e){let r=0,n=0;for(let i=0;i<this.length();i++){let o=this.getSection(i);if(o.imageName){let a=e[o.imageName];if(!a)continue;let s=a.displaySize;r=Math.max(r,s[0]),n=Math.max(n,s[1])}}return{maxImageWidth:r,maxImageHeight:n}}addTextSection(e,r){this.text+=e.text,this.sections.push(Ea.forText(e.scale,e.fontStack||r,e.verticalAlign));let n=this.sections.length-1;for(let i=0;i<e.text.length;++i)this.sectionIndex.push(n)}addImageSection(e){let r=e.image?e.image.name:"";if(r.length===0){ce("Can't add FormattedSection with an empty image.");return}let n=this.getNextImageSectionCharCode();if(!n){ce("Reached maximum number of images ".concat(Cf-Tf+2));return}this.text+=String.fromCharCode(n),this.sections.push(Ea.forImage(r,e.verticalAlign)),this.sectionIndex.push(this.sections.length-1)}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=Cf?null:++this.imageSectionID:(this.imageSectionID=Tf,this.imageSectionID)}};function fb(t,e){let r=[],n=t.text,i=0;for(let o of e)r.push(t.substring(i,o)),i=o;return i<n.length&&r.push(t.substring(i,n.length)),r}function vi(t,e,r,n,i,o,a,s,l,u,c,p,f,y,m){let h=xi.fromFeature(t,i);p===2&&h.verticalizePunctuation();let g,{processBidirectionalText:d,processStyledBidirectionalText:b}=we;if(d&&h.sections.length===1){g=[];let S=d(h.toString(),Il(h,u,o,e,n,y));for(let A of S){let w=new xi;w.text=A,w.sections=h.sections;for(let T=0;T<A.length;T++)w.sectionIndex.push(0);g.push(w)}}else if(b){g=[];let S=b(h.text,h.sectionIndex,Il(h,u,o,e,n,y));for(let A of S){let w=new xi;w.text=A[0],w.sectionIndex=A[1],w.sections=h.sections,g.push(w)}}else g=fb(h,Il(h,u,o,e,n,y));let x=[],v={positionedLines:x,text:h.toString(),top:c[1],bottom:c[1],left:c[0],right:c[0],writingMode:p,iconsInText:!1,verticalizable:!1};return vb(v,e,r,n,g,a,s,l,p,u,f,m),pb(x)?!1:v}var Ma={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},yb={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},mb={40:!0};function Ef(t,e,r,n,i,o){if(e.imageName){let a=n[e.imageName];return a?a.displaySize[0]*e.scale*ae/o+i:0}else{let a=r[e.fontStack],s=a&&a[t];return s?s.metrics.advance*e.scale+i:0}}function hb(t,e,r,n,i,o){let a=0;for(let l=0;l<t.length();l++){let u=t.getSection(l);a+=Ef(t.getCharCode(l),u,n,i,e,o)}let s=Math.max(1,Math.ceil(a/r));return a/s}function kf(t,e,r,n){let i=Math.pow(t-e,2);return n?t<e?i/2:i*2:i+Math.abs(r)*r}function db(t,e,r){let n=0;return t===10&&(n-=1e4),r&&(n+=150),(t===40||t===65288)&&(n+=50),(e===41||e===65289)&&(n+=50),n}function Ff(t,e,r,n,i,o){let a=null,s=kf(e,r,i,o);for(let l of n){let u=e-l.x,c=kf(u,r,i,o)+l.badness;c<=s&&(a=l,s=c)}return{index:t,x:e,priorBreak:a,badness:s}}function Mf(t){return t?Mf(t.priorBreak).concat(t.index):[]}function Il(t,e,r,n,i,o){if(!t)return[];let a=[],s=hb(t,e,r,n,i,o),l=t.text.indexOf("\\u200B")>=0,u=0;for(let c=0;c<t.length();c++){let p=t.getSection(c),f=t.getCharCode(c);if(Ma[f]||(u+=Ef(f,p,n,i,e,o)),c<t.length()-1){let y=rp(f);(yb[f]||y||p.imageName||c!==t.length()-2&&mb[t.getCharCode(c+1)])&&a.push(Ff(c+1,u,s,a,db(f,t.getCharCode(c+1),y&&l),!1))}}return Mf(Ff(t.length(),u,s,a,0,!0))}function Lf(t){let e=.5,r=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0;break}switch(t){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0;break}return{horizontalAlign:e,verticalAlign:r}}function gb(t,e,r){let n=e.getMaxScale()*ae,{maxImageWidth:i,maxImageHeight:o}=e.getMaxImageSize(t),a=Math.max(n,o*r);return{verticalLineContentWidth:Math.max(n,i*r),horizontalLineContentHeight:a}}function Df(t){switch(t){case"top":return 0;case"center":return .5;default:return 1}}function xb(t,e,r,n){if(t&&t.rect)return t;let i=e[r.fontStack],o=i&&i[n];return o?{rect:null,metrics:o.metrics}:null}function bb(t,e,r){return!(t===1||!e&&!Do(r)||e&&(Ma[r]||np(r)))}function vb(t,e,r,n,i,o,a,s,l,u,c,p){let f=0,y=0,m=0,h=0,g=s==="right"?1:s==="left"?0:.5,d=ae/p,b=0;for(let S of i){S.trim();let A=S.getMaxScale(),w={positionedGlyphs:[],lineOffset:0};t.positionedLines[b]=w;let T=w.positionedGlyphs,E=0;if(!S.length()){y+=o,++b;continue}let D=gb(n,S,d);for(let M=0;M<S.length();M++){let _=S.getSection(M),V=S.getSectionIndex(M),G=S.getCharCode(M),O=bb(l,c,G),R;if(_.imageName){if(t.iconsInText=!0,_.scale=_.scale*d,R=Sb(_,O,A,D,n),!R)continue;E=Math.max(E,R.imageOffset)}else if(R=Pb(_,G,O,D,e,r),!R)continue;let{rect:K,metrics:X,baselineOffset:re}=R;if(T.push({glyph:G,imageName:_.imageName,x:f,y:y+re+bi,vertical:O,scale:_.scale,fontStack:_.fontStack,sectionIndex:V,metrics:X,rect:K}),!O)f+=X.advance*_.scale+u;else{t.verticalizable=!0;let me=_.imageName?X.advance:ae;f+=me*_.scale+u}}if(T.length!==0){let M=f-u;m=Math.max(M,m),wb(T,0,T.length-1,g)}f=0;let B=(A-1)*ae;w.lineOffset=Math.max(E,B);let z=o*A+E;y+=z,h=Math.max(z,h),++b}let{horizontalAlign:x,verticalAlign:v}=Lf(a);Ab(t.positionedLines,g,x,v,m,h,o,y,i.length),t.top+=-v*y,t.bottom=t.top+y,t.left+=-x*m,t.right=t.left+m}function Pb(t,e,r,n,i,o){let a=o[t.fontStack],s=a&&a[e],l=xb(s,i,t,e);if(l===null)return null;let u;if(r)u=n.verticalLineContentWidth-t.scale*ae;else{let c=Df(t.verticalAlign);u=(n.horizontalLineContentHeight-t.scale*ae)*c}return{rect:l.rect,metrics:l.metrics,baselineOffset:u}}function Sb(t,e,r,n,i){let o=i[t.imageName];if(!o)return null;let a=o.paddedRect,s=o.displaySize,l={width:s[0],height:s[1],left:he,top:-ka,advance:e?s[1]:s[0]},u;if(e)u=n.verticalLineContentWidth-s[1]*t.scale;else{let p=Df(t.verticalAlign);u=(n.horizontalLineContentHeight-s[1]*t.scale)*p}let c=(e?s[0]:s[1])*t.scale-ae*r;return{rect:a,metrics:l,baselineOffset:u,imageOffset:c}}function wb(t,e,r,n){if(n===0)return;let i=t[r],o=i.metrics.advance*i.scale,a=(t[r].x+o)*n;for(let s=e;s<=r;s++)t[s].x-=a}function Ab(t,e,r,n,i,o,a,s,l){let u=(e-r)*i,c=0;o!==a?c=-s*n-bi:c=-n*l*a+.5*a;for(let p of t)for(let f of p.positionedGlyphs)f.x+=u,f.y+=c}function Bf(t,e,r){let{horizontalAlign:n,verticalAlign:i}=Lf(r),o=e[0],a=e[1],s=o-t.displaySize[0]*n,l=s+t.displaySize[0],u=a-t.displaySize[1]*i,c=u+t.displaySize[1];return{image:t,top:u,bottom:c,left:s,right:l}}function Da(t){var c,p;let e=t.left,r=t.top,n=t.right-e,i=t.bottom-r,o=t.image.content[2]-t.image.content[0],a=t.image.content[3]-t.image.content[1],s=(c=t.image.textFitWidth)!=null?c:"stretchOrShrink",l=(p=t.image.textFitHeight)!=null?p:"stretchOrShrink",u=o/a;if(l==="proportional"){if(s==="stretchOnly"&&n/i<u||s==="proportional"){let f=Math.ceil(i*u);e*=f/n,n=f}}else if(s==="proportional"&&l==="stretchOnly"&&u!==0&&n/i>u){let f=Math.ceil(n/u);r*=f/i,i=f}return{x1:e,y1:r,x2:e+n,y2:r+i}}function Tl(t,e,r,n,i,o){let a=t.image,s;if(a.content){let g=a.content,d=a.pixelRatio||1;s=[g[0]/d,g[1]/d,a.displaySize[0]-g[2]/d,a.displaySize[1]-g[3]/d]}let l=e.left*o,u=e.right*o,c,p,f,y;r==="width"||r==="both"?(y=i[0]+l-n[3],p=i[0]+u+n[1]):(y=i[0]+(l+u-a.displaySize[0])/2,p=y+a.displaySize[0]);let m=e.top*o,h=e.bottom*o;return r==="height"||r==="both"?(c=i[1]+m-n[0],f=i[1]+h+n[2]):(c=i[1]+(m+h-a.displaySize[1])/2,f=c+a.displaySize[1]),{image:a,top:c,right:p,bottom:f,left:y,collisionPadding:s}}var Vf=Y(Rt(),1);var Ur=255,zt=128,Qe=Ur*zt;function Cl(t,e){let{expression:r}=e;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new W(t+1))};if(r.kind==="source")return{kind:"source"};{let{zoomStops:n,interpolationType:i}=r,o=0;for(;o<n.length&&n[o]<=t;)o++;o=Math.max(0,o-1);let a=o;for(;a<n.length&&n[a]<t+1;)a++;a=Math.min(n.length-1,a);let s=n[o],l=n[a];if(r.kind==="composite")return{kind:"composite",minZoom:s,maxZoom:l,interpolationType:i};let u=r.evaluate(new W(s)),c=r.evaluate(new W(l));return{kind:"camera",minZoom:s,maxZoom:l,minSize:u,maxSize:c,interpolationType:i}}}function kl(t,e,r){let n="never",i=t.get(e);return i?n=i:t.get(r)&&(n="always"),n}var _b=Vf.default.VectorTileFeature.types,Ib=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ba(t,e,r,n,i,o,a,s,l,u,c,p,f){let y=s?Math.min(Qe,Math.round(s[0])):0,m=s?Math.min(Qe,Math.round(s[1])):0;t.emplaceBack(e,r,Math.round(n*32),Math.round(i*32),o,a,(y<<1)+(l?1:0),m,u*16,c*16,p*256,f*256)}function Rf(t,e,r){t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r)}function Tb(t){for(let e of t.sections)if(op(e.text))return!0;return!1}var Si=class{constructor(e){this.layoutVertexArray=new ea,this.indexArray=new Le,this.programConfigurations=e,this.segments=new pe,this.dynamicLayoutVertexArray=new ta,this.opacityVertexArray=new ra,this.hasVisibleVertices=!1,this.placedSymbolArray=new Wn}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,r,n,i){this.isEmpty()||(n&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,hf.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,df.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Ib,!0),this.opacityVertexBuffer.itemSize=1),(n||i)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}};I("SymbolBuffers",Si);var wi=class{constructor(e,r,n){this.layoutVertexArray=new e,this.layoutAttributes=r,this.indexArray=new n,this.segments=new pe,this.collisionVertexArray=new na}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,gf.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}};I("CollisionBuffers",wi);var Xe=class{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.globalState=e.globalState,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(l=>l.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];let n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Cl(this.zoom,n["text-size"]),this.iconSizeData=Cl(this.zoom,n["icon-size"]);let i=this.layers[0].layout,o=i.get("symbol-sort-key"),a=i.get("symbol-z-order");this.canOverlap=kl(i,"text-overlap","text-allow-overlap")!=="never"||kl(i,"icon-overlap","icon-allow-overlap")!=="never"||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=a!=="viewport-y"&&!o.isConstant();let s=a==="viewport-y"||a==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=s&&this.canOverlap,i.get("symbol-placement")==="point"&&(this.writingModes=i.get("text-writing-mode").map(l=>La[l])),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.sourceID=e.sourceID}createArrays(){this.text=new Si(new Ae(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Si(new Ae(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Hn,this.lineVertexArray=new Zn,this.symbolInstances=new Xn,this.textAnchorOffsets=new Jn}calculateGlyphDependencies(e,r,n,i,o){for(let a=0;a<e.length;a++)if(r[e.charCodeAt(a)]=!0,(n||i)&&o){let s=Or[e.charAt(a)];s&&(r[s.charCodeAt(0)]=!0)}}populate(e,r,n){let i=this.layers[0],o=i.layout,a=o.get("text-font"),s=o.get("text-field"),l=o.get("icon-image"),u=(s.value.kind!=="constant"||s.value.value instanceof Fe&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&(a.value.kind!=="constant"||a.value.value.length>0),c=l.value.kind!=="constant"||!!l.value.value||Object.keys(l.parameters).length>0,p=o.get("symbol-sort-key");if(this.features=[],!u&&!c)return;let f=r.iconDependencies,y=r.glyphDependencies,m=r.availableImages,h=new W(this.zoom,{globalState:this.globalState});for(let{feature:g,id:d,index:b,sourceLayerIndex:x}of e){let v=i._featureFilter.needGeometry,S=Ne(g,v);if(!i._featureFilter.filter(h,S,n))continue;v||(S.geometry=_e(g));let A;if(u){let D=i.getValueAndResolveTokens("text-field",S,n,m),B=Fe.factory(D),z=this.hasRTLText=this.hasRTLText||Tb(B);(!z||we.getRTLTextPluginStatus()==="unavailable"||z&&we.isParsed())&&(A=xf(B,i,S))}let w;if(c){let D=i.getValueAndResolveTokens("icon-image",S,n,m);D instanceof Se?w=D:w=Se.fromString(D)}if(!A&&!w)continue;let T=this.sortFeaturesByKey?p.evaluate(S,{},n):void 0,E={id:d,text:A,icon:w,index:b,sourceLayerIndex:x,geometry:S.geometry,properties:g.properties,type:_b[g.type],sortKey:T};if(this.features.push(E),w&&(f[w.name]=!0),A){let D=a.evaluate(S,{},n).join(","),B=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(2)>=0;for(let z of A.sections)if(z.image)f[z.image.name]=!0;else{let M=Tn(A.toString()),_=z.fontStack||D,V=y[_]=y[_]||{};this.calculateGlyphDependencies(z.text,V,B,this.allowVerticalPlacement,M)}}}o.get("symbol-placement")==="line"&&(this.features=bf(this.features)),this.sortFeaturesByKey&&this.features.sort((g,d)=>g.sortKey-d.sortKey)}update(e,r,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,r,this.layers,n),this.icon.programConfigurations.updatePaintArrays(e,r,this.layers,n))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,r){let n=this.lineVertexArray.length;if(e.segment!==void 0){let i=e.dist(r[e.segment+1]),o=e.dist(r[e.segment]),a={};for(let s=e.segment+1;s<r.length;s++)a[s]={x:r[s].x,y:r[s].y,tileUnitDistanceFromAnchor:i},s<r.length-1&&(i+=r[s+1].dist(r[s]));for(let s=e.segment||0;s>=0;s--)a[s]={x:r[s].x,y:r[s].y,tileUnitDistanceFromAnchor:o},s>0&&(o+=r[s-1].dist(r[s]));for(let s=0;s<r.length;s++){let l=a[s];this.lineVertexArray.emplaceBack(l.x,l.y,l.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}addSymbols(e,r,n,i,o,a,s,l,u,c,p,f){let y=e.indexArray,m=e.layoutVertexArray,h=e.segments.prepareSegment(4*r.length,m,y,this.canOverlap?a.sortKey:void 0),g=this.glyphOffsetArray.length,d=h.vertexLength,b=this.allowVerticalPlacement&&s===2?Math.PI/2:0,x=a.text&&a.text.sections;for(let v=0;v<r.length;v++){let{tl:S,tr:A,bl:w,br:T,tex:E,pixelOffsetTL:D,pixelOffsetBR:B,minFontScaleX:z,minFontScaleY:M,glyphOffset:_,isSDF:V,sectionIndex:G}=r[v],O=h.vertexLength,R=_[1];Ba(m,l.x,l.y,S.x,R+S.y,E.x,E.y,n,V,D.x,D.y,z,M),Ba(m,l.x,l.y,A.x,R+A.y,E.x+E.w,E.y,n,V,B.x,D.y,z,M),Ba(m,l.x,l.y,w.x,R+w.y,E.x,E.y+E.h,n,V,D.x,B.y,z,M),Ba(m,l.x,l.y,T.x,R+T.y,E.x+E.w,E.y+E.h,n,V,B.x,B.y,z,M),Rf(e.dynamicLayoutVertexArray,l,b),y.emplaceBack(O,O+2,O+1),y.emplaceBack(O+1,O+2,O+3),h.vertexLength+=4,h.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(_[0]),(v===r.length-1||G!==r[v+1].sectionIndex)&&e.programConfigurations.populatePaintArrays(m.length,a,a.index,{},f,x&&x[G])}e.placedSymbolArray.emplaceBack(l.x,l.y,g,this.glyphOffsetArray.length-g,d,u,c,l.segment,n?n[0]:0,n?n[1]:0,i[0],i[1],s,0,!1,0,p)}_addCollisionDebugVertex(e,r,n,i,o,a){return r.emplaceBack(0,0),e.emplaceBack(n.x,n.y,i,o,Math.round(a.x),Math.round(a.y))}addCollisionDebugVertices(e,r,n,i,o,a,s){let l=o.segments.prepareSegment(4,o.layoutVertexArray,o.indexArray),u=l.vertexLength,c=o.layoutVertexArray,p=o.collisionVertexArray,f=s.anchorX,y=s.anchorY;this._addCollisionDebugVertex(c,p,a,f,y,new Pi.default(e,r)),this._addCollisionDebugVertex(c,p,a,f,y,new Pi.default(n,r)),this._addCollisionDebugVertex(c,p,a,f,y,new Pi.default(n,i)),this._addCollisionDebugVertex(c,p,a,f,y,new Pi.default(e,i)),l.vertexLength+=4;let m=o.indexArray;m.emplaceBack(u,u+1),m.emplaceBack(u+1,u+2),m.emplaceBack(u+2,u+3),m.emplaceBack(u+3,u),l.primitiveLength+=4}addDebugCollisionBoxes(e,r,n,i){for(let o=e;o<r;o++){let a=this.collisionBoxArray.get(o),s=a.x1,l=a.y1,u=a.x2,c=a.y2;this.addCollisionDebugVertices(s,l,u,c,i?this.textCollisionBox:this.iconCollisionBox,a.anchorPoint,n)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new wi(Kn,wl.members,Mt),this.iconCollisionBox=new wi(Kn,wl.members,Mt);for(let e=0;e<this.symbolInstances.length;e++){let r=this.symbolInstances.get(e);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(e,r,n,i,o,a,s,l,u){let c={};for(let p=r;p<n;p++){let f=e.get(p);c.textBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.textFeatureIndex=f.featureIndex;break}for(let p=i;p<o;p++){let f=e.get(p);c.verticalTextBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.verticalTextFeatureIndex=f.featureIndex;break}for(let p=a;p<s;p++){let f=e.get(p);c.iconBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.iconFeatureIndex=f.featureIndex;break}for(let p=l;p<u;p++){let f=e.get(p);c.verticalIconBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.verticalIconFeatureIndex=f.featureIndex;break}return c}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){let n=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,r){let n=e.placedSymbolArray.get(r),i=n.vertexStartIndex+n.numGlyphs*4;for(let o=n.vertexStartIndex;o<i;o+=4)e.indexArray.emplaceBack(o,o+2,o+1),e.indexArray.emplaceBack(o+1,o+2,o+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let r=Math.sin(e),n=Math.cos(e),i=[],o=[],a=[];for(let s=0;s<this.symbolInstances.length;++s){a.push(s);let l=this.symbolInstances.get(s);i.push(Math.round(r*l.anchorX+n*l.anchorY)|0),o.push(l.featureIndex)}return a.sort((s,l)=>i[s]-i[l]||o[l]-o[s]),a}addToSortKeyRanges(e,r){let n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===r?n.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let r of this.symbolInstanceIndexes){let n=this.symbolInstances.get(r);this.featureSortOrder.push(n.featureIndex),[n.rightJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.leftJustifiedTextSymbolIndex].forEach((i,o,a)=>{i>=0&&a.indexOf(i)===o&&this.addIndicesForPlacedSymbol(this.text,i)}),n.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,n.verticalPlacedTextSymbolIndex),n.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,n.placedIconSymbolIndex),n.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,n.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}};I("SymbolBucket",Xe,{omit:["layers","collisionBoxArray","features","compareText"]});Xe.MAX_GLYPHS=65535;Xe.addDynamicAttributes=Rf;function zf(t,e){return e.replace(/{([^{}]+)}/g,(r,n)=>t&&n in t?String(t[n]):"")}var Of,Cb=()=>Of=Of||new ee({"symbol-placement":new F(P.layout_symbol["symbol-placement"]),"symbol-spacing":new F(P.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new F(P.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new L(P.layout_symbol["symbol-sort-key"]),"symbol-z-order":new F(P.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new F(P.layout_symbol["icon-allow-overlap"]),"icon-overlap":new F(P.layout_symbol["icon-overlap"]),"icon-ignore-placement":new F(P.layout_symbol["icon-ignore-placement"]),"icon-optional":new F(P.layout_symbol["icon-optional"]),"icon-rotation-alignment":new F(P.layout_symbol["icon-rotation-alignment"]),"icon-size":new L(P.layout_symbol["icon-size"]),"icon-text-fit":new F(P.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new F(P.layout_symbol["icon-text-fit-padding"]),"icon-image":new L(P.layout_symbol["icon-image"]),"icon-rotate":new L(P.layout_symbol["icon-rotate"]),"icon-padding":new L(P.layout_symbol["icon-padding"]),"icon-keep-upright":new F(P.layout_symbol["icon-keep-upright"]),"icon-offset":new L(P.layout_symbol["icon-offset"]),"icon-anchor":new L(P.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new F(P.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new F(P.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new F(P.layout_symbol["text-rotation-alignment"]),"text-field":new L(P.layout_symbol["text-field"]),"text-font":new L(P.layout_symbol["text-font"]),"text-size":new L(P.layout_symbol["text-size"]),"text-max-width":new L(P.layout_symbol["text-max-width"]),"text-line-height":new F(P.layout_symbol["text-line-height"]),"text-letter-spacing":new L(P.layout_symbol["text-letter-spacing"]),"text-justify":new L(P.layout_symbol["text-justify"]),"text-radial-offset":new L(P.layout_symbol["text-radial-offset"]),"text-variable-anchor":new F(P.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new L(P.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new L(P.layout_symbol["text-anchor"]),"text-max-angle":new F(P.layout_symbol["text-max-angle"]),"text-writing-mode":new F(P.layout_symbol["text-writing-mode"]),"text-rotate":new L(P.layout_symbol["text-rotate"]),"text-padding":new F(P.layout_symbol["text-padding"]),"text-keep-upright":new F(P.layout_symbol["text-keep-upright"]),"text-transform":new L(P.layout_symbol["text-transform"]),"text-offset":new L(P.layout_symbol["text-offset"]),"text-allow-overlap":new F(P.layout_symbol["text-allow-overlap"]),"text-overlap":new F(P.layout_symbol["text-overlap"]),"text-ignore-placement":new F(P.layout_symbol["text-ignore-placement"]),"text-optional":new F(P.layout_symbol["text-optional"])}),Gf,kb=()=>Gf=Gf||new ee({"icon-opacity":new L(P.paint_symbol["icon-opacity"]),"icon-color":new L(P.paint_symbol["icon-color"]),"icon-halo-color":new L(P.paint_symbol["icon-halo-color"]),"icon-halo-width":new L(P.paint_symbol["icon-halo-width"]),"icon-halo-blur":new L(P.paint_symbol["icon-halo-blur"]),"icon-translate":new F(P.paint_symbol["icon-translate"]),"icon-translate-anchor":new F(P.paint_symbol["icon-translate-anchor"]),"text-opacity":new L(P.paint_symbol["text-opacity"]),"text-color":new L(P.paint_symbol["text-color"],{runtimeType:ze,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new L(P.paint_symbol["text-halo-color"]),"text-halo-width":new L(P.paint_symbol["text-halo-width"]),"text-halo-blur":new L(P.paint_symbol["text-halo-blur"]),"text-translate":new F(P.paint_symbol["text-translate"]),"text-translate-anchor":new F(P.paint_symbol["text-translate-anchor"])}),Va={get paint(){return kb()},get layout(){return Cb()}};var Ai=class{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:Ar,this.defaultValue=e}evaluate(e){if(e.formattedSection){let r=this.defaultValue.property.overrides;if(r&&r.hasOverride(e.formattedSection))return r.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){if(!this.defaultValue.isConstant()){let r=this.defaultValue.value;e(r._styleExpression.expression)}}outputDefined(){return!1}serialize(){return null}};I("FormatSectionOverride",Ai,{omit:["defaultValue"]});var Ra=class t extends oe{constructor(e){super(e,Va)}recalculate(e,r){if(super.recalculate(e,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){let n=this.layout.get("text-writing-mode");if(n){let i=[];for(let o of n)i.indexOf(o)<0&&i.push(o);this.layout._values["text-writing-mode"]=i}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,r,n,i){let o=this.layout.get(e).evaluate(r,{},n,i),a=this._unevaluatedLayout._values[e];return!a.isDataDriven()&&!An(a.value)&&o?zf(r.properties,o):o}createBucket(e){return new Xe(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let e of Va.paint.overridableProperties){if(!t.hasPaintOverride(this.layout,e))continue;let r=this.paint.get(e),n=new Ai(r),i=new Zt(n,r.property.specification),o=null;r.value.kind==="constant"||r.value.kind==="source"?o=new Je("source",i):o=new Tt("composite",i,r.value.zoomStops),this.paint._values[e]=new ge(r.property,o,r.parameters)}}_handleOverridablePaintPropertyUpdate(e,r,n){return!this.layout||r.isDataDriven()||n.isDataDriven()?!1:t.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,r){let n=e.get("text-field"),i=Va.paint.properties[r],o=!1,a=s=>{for(let l of s)if(i.overrides&&i.overrides.hasOverride(l)){o=!0;return}};if(n.value.kind==="constant"&&n.value.value instanceof Fe)a(n.value.value.sections);else if(n.value.kind==="source"){let s=u=>{if(!o)if(u instanceof _t&&ue(u.value)===_r){let c=u.value;a(c.sections)}else u instanceof fn?a(u.sections):u.eachChild(s)},l=n.value;l._styleExpression&&s(l._styleExpression.expression)}return o}};function Nf(t,e,r,n=1){let i=t.get("icon-padding").evaluate(e,{},r),o=i&&i.values;return[o[0]*n,o[1]*n,o[2]*n,o[3]*n]}var Uf,Fb=()=>Uf=Uf||new ee({"background-color":new F(P.paint_background["background-color"]),"background-pattern":new rr(P.paint_background["background-pattern"]),"background-opacity":new F(P.paint_background["background-opacity"])}),$f={get paint(){return Fb()}};var za=class extends oe{constructor(e){super(e,$f)}};var jf,Eb=()=>jf=jf||new ee({"raster-opacity":new F(P.paint_raster["raster-opacity"]),"raster-hue-rotate":new F(P.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new F(P.paint_raster["raster-brightness-min"]),"raster-brightness-max":new F(P.paint_raster["raster-brightness-max"]),"raster-saturation":new F(P.paint_raster["raster-saturation"]),"raster-contrast":new F(P.paint_raster["raster-contrast"]),"raster-resampling":new F(P.paint_raster["raster-resampling"]),"raster-fade-duration":new F(P.paint_raster["raster-fade-duration"])}),qf={get paint(){return Eb()}};var Oa=class extends oe{constructor(e){super(e,qf)}};var Ga=class extends oe{constructor(r){super(r,{});this.onAdd=r=>{this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)};this.onRemove=r=>{this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)};this.implementation=r}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}};function Wf(t){if(t.type==="custom")return new Ga(t);switch(t.type){case"background":return new za(t);case"circle":return new pa(t);case"color-relief":return new ma(t);case"fill":return new Pa(t);case"fill-extrusion":return new Aa(t);case"heatmap":return new fa(t);case"hillshade":return new ya(t);case"line":return new Ia(t);case"raster":return new Oa(t);case"symbol":return new Ra(t)}}var Na=class{constructor(e){this.keyCache={},e&&this.replace(e)}replace(e){this._layerConfigs={},this._layers={},this.update(e,[])}update(e,r){for(let i of e){this._layerConfigs[i.id]=i;let o=this._layers[i.id]=Wf(i);o._featureFilter=Ct(o.filter),this.keyCache[i.id]&&delete this.keyCache[i.id]}for(let i of r)delete this.keyCache[i],delete this._layerConfigs[i],delete this._layers[i];this.familiesBySource={};let n=Pc(Object.values(this._layerConfigs),this.keyCache);for(let i of n){let o=i.map(p=>this._layers[p.id]),a=o[0];if(a.visibility==="none")continue;let s=a.source||"",l=this.familiesBySource[s];l||(l=this.familiesBySource[s]={});let u=a.sourceLayer||"_geojsonTileLayer",c=l[u];c||(c=l[u]=[]),c.push(o)}}};var gy=Y(Rt(),1),xy=Y(hi(),1);var $r=class{constructor(e){this._stringToNumber={},this._numberToString=[];for(let r=0;r<e.length;r++){let n=e[r];this._stringToNumber[n]=r,this._numberToString[r]=n}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error("Out of bounds. Index requested n=".concat(e," can't be >= this._numberToString.length ").concat(this._numberToString.length));return this._numberToString[e]}};var Hf=Y(Rt(),1),Zf=Y(hi(),1);var Ua=class{constructor(e,r,n,i,o){this.type="Feature",this._vectorTileFeature=e,e._z=r,e._x=n,e._y=i,this.properties=e.properties,this.id=o}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){let e={geometry:this.geometry};for(let r in this)r==="_geometry"||r==="_vectorTileFeature"||(e[r]=this[r]);return e}};var _i=Y(ye(),1),yr=class t{constructor(){this.minX=1/0;this.maxX=-1/0;this.minY=1/0;this.maxY=-1/0}extend(e){return this.minX=Math.min(this.minX,e.x),this.minY=Math.min(this.minY,e.y),this.maxX=Math.max(this.maxX,e.x),this.maxY=Math.max(this.maxY,e.y),this}expandBy(e){return this.minX-=e,this.minY-=e,this.maxX+=e,this.maxY+=e,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(e){return this.expandBy(-e)}map(e){let r=new t;return r.extend(e(new _i.default(this.minX,this.minY))),r.extend(e(new _i.default(this.maxX,this.minY))),r.extend(e(new _i.default(this.minX,this.maxY))),r.extend(e(new _i.default(this.maxX,this.maxY))),r}static fromPoints(e){let r=new t;for(let n of e)r.extend(n);return r}contains(e){return e.x>=this.minX&&e.x<=this.maxX&&e.y>=this.minY&&e.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(e){return!this.empty()&&!e.empty()&&e.minX>=this.minX&&e.maxX<=this.maxX&&e.minY>=this.minY&&e.maxY<=this.maxY}intersects(e){return!this.empty()&&!e.empty()&&e.minX<=this.maxX&&e.maxX>=this.minX&&e.minY<=this.maxY&&e.maxY>=this.minY}};var Ii=class{constructor(e,r){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new jt(8192,16,0),this.grid3D=new jt(8192,16,0),this.featureIndexArray=new Yn,this.promoteId=r}insert(e,r,n,i,o,a){let s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,i,o);let l=a?this.grid3D:this.grid;for(let u=0;u<r.length;u++){let c=r[u],p=[1/0,1/0,-1/0,-1/0];for(let f=0;f<c.length;f++){let y=c[f];p[0]=Math.min(p[0],y.x),p[1]=Math.min(p[1],y.y),p[2]=Math.max(p[2],y.x),p[3]=Math.max(p[3],y.y)}p[0]<8192&&p[1]<8192&&p[2]>=0&&p[3]>=0&&l.insert(s,p[0],p[1],p[2],p[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Hf.default.VectorTile(new Zf.default(this.rawTileData)).layers,this.sourceLayerCoder=new $r(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,r,n,i){this.loadVTLayers();let o=e.params,a=8192/e.tileSize/e.scale,s=Ct(o.filter),l=e.queryGeometry,u=e.queryPadding*a,c=yr.fromPoints(l),p=this.grid.query(c.minX-u,c.minY-u,c.maxX+u,c.maxY+u),f=yr.fromPoints(e.cameraQueryGeometry).expandBy(u),y=this.grid3D.query(f.minX,f.minY,f.maxX,f.maxY,(g,d,b,x)=>Sp(e.cameraQueryGeometry,g-u,d-u,b+u,x+u));for(let g of y)p.push(g);p.sort(Mb);let m={},h;for(let g=0;g<p.length;g++){let d=p[g];if(d===h)continue;h=d;let b=this.featureIndexArray.get(d),x=null;this.loadMatchingFeature(m,b.bucketIndex,b.sourceLayerIndex,b.featureIndex,s,o.layers,o.availableImages,r,n,i,(v,S,A)=>(x||(x=_e(v)),S.queryIntersectsFeature({queryGeometry:l,feature:v,featureState:A,geometry:x,zoom:this.z,transform:e.transform,pixelsToTileUnits:a,pixelPosMatrix:e.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:e.getElevation})))}return m}loadMatchingFeature(e,r,n,i,o,a,s,l,u,c,p){let f=this.bucketLayerIDs[r];if(a&&!f.some(d=>a.has(d)))return;let y=this.sourceLayerCoder.decode(n),h=this.vtLayers[y].feature(i);if(o.needGeometry){let d=Ne(h,!0);if(!o.filter(new W(this.tileID.overscaledZ),d,this.tileID.canonical))return}else if(!o.filter(new W(this.tileID.overscaledZ),h))return;let g=this.getId(h,y);for(let d=0;d<f.length;d++){let b=f[d];if(a&&!a.has(b))continue;let x=l[b];if(!x)continue;let v={};g&&c&&(v=c.getState(x.sourceLayer||"_geojsonTileLayer",g));let S=de({},u[b]);S.paint=Xf(S.paint,x.paint,h,v,s),S.layout=Xf(S.layout,x.layout,h,v,s);let A=!p||p(h,x,v);if(!A)continue;let w=new Ua(h,this.z,this.x,this.y,g);w.layer=S;let T=e[b];T===void 0&&(T=e[b]=[]),T.push({featureIndex:i,feature:w,intersectionZ:A})}}lookupSymbolFeatures(e,r,n,i,o,a,s,l){let u={};this.loadVTLayers();let c=Ct(o);for(let p of e)this.loadMatchingFeature(u,n,i,p,c,a,s,l,r);return u}hasLayer(e){for(let r of this.bucketLayerIDs)for(let n of r)if(e===n)return!0;return!1}getId(e,r){var i;let n=e.id;if(this.promoteId){let o=typeof this.promoteId=="string"?this.promoteId:this.promoteId[r];n=e.properties[o],typeof n=="boolean"&&(n=Number(n)),n===void 0&&((i=e.properties)!=null&&i.cluster)&&this.promoteId&&(n=Number(e.properties.cluster_id))}return n}};I("FeatureIndex",Ii,{omit:["rawTileData","sourceLayerCoder"]});function Xf(t,e,r,n,i){return rn(t,(o,a)=>{let s=e instanceof kt?e.get(a):null;return s&&s.evaluate?s.evaluate(r,n,i):s})}function Mb(t,e){return e-t}var Jf=Y(ye(),1);var et=class t extends Jf.default{constructor(e,r,n,i){super(e,r),this.angle=n,i!==void 0&&(this.segment=i)}clone(){return new t(this.x,this.y,this.angle,this.segment)}};I("Anchor",et);function Fl(t,e,r,n,i){if(e.segment===void 0||r===0)return!0;let o=e,a=e.segment+1,s=0;for(;s>-r/2;){if(a--,a<0)return!1;s-=t[a].dist(o),o=t[a]}s+=t[a].dist(t[a+1]),a++;let l=[],u=0;for(;s<r/2;){let c=t[a-1],p=t[a],f=t[a+1];if(!f)return!1;let y=c.angleTo(p)-p.angleTo(f);for(y=Math.abs((y+3*Math.PI)%(Math.PI*2)-Math.PI),l.push({distance:s,angleDelta:y}),u+=y;s-l[0].distance>n;)u-=l.shift().angleDelta;if(u>i)return!1;a++,s+=p.dist(f)}return!0}function Yf(t){let e=0;for(let r=0;r<t.length-1;r++)e+=t[r].dist(t[r+1]);return e}function Kf(t,e,r){return t?3/5*e*r:0}function Qf(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function ey(t,e,r,n,i,o){let a=Kf(r,i,o),s=Qf(r,n)*o,l=0,u=Yf(t)/2;for(let c=0;c<t.length-1;c++){let p=t[c],f=t[c+1],y=p.dist(f);if(l+y>u){let m=(u-l)/y,h=lt.number(p.x,f.x,m),g=lt.number(p.y,f.y,m),d=new et(h,g,f.angleTo(p),c);return d._round(),!a||Fl(t,d,s,a,e)?d:void 0}l+=y}}function ty(t,e,r,n,i,o,a,s,l){let u=Kf(n,o,a),c=Qf(n,i),p=c*a,f=t[0].x===0||t[0].x===l||t[0].y===0||t[0].y===l;e-p<e/4&&(e=p+e/4);let y=o*2,m=f?e/2*s%e:(c/2+y)*a*s%e;return ry(t,m,e,u,r,p,f,!1,l)}function ry(t,e,r,n,i,o,a,s,l){let u=o/2,c=Yf(t),p=0,f=e-r,y=[];for(let m=0;m<t.length-1;m++){let h=t[m],g=t[m+1],d=h.dist(g),b=g.angleTo(h);for(;f+r<p+d;){f+=r;let x=(f-p)/d,v=lt.number(h.x,g.x,x),S=lt.number(h.y,g.y,x);if(v>=0&&v<l&&S>=0&&S<l&&f-u>=0&&f+u<=c){let A=new et(v,S,b,m);A._round(),(!n||Fl(t,A,o,n,i))&&y.push(A)}}p+=d}return!s&&!y.length&&!a&&(y=ry(t,p/2,r,n,i,o,a,!0,l)),y}var ht=Y(ye(),1);function ny(t,e,r,n,i){let o=[];for(let a=0;a<t.length;a++){let s=t[a],l;for(let u=0;u<s.length-1;u++){let c=s[u],p=s[u+1];c.x<e&&p.x<e||(c.x<e?c=new ht.default(e,c.y+(p.y-c.y)*((e-c.x)/(p.x-c.x)))._round():p.x<e&&(p=new ht.default(e,c.y+(p.y-c.y)*((e-c.x)/(p.x-c.x)))._round()),!(c.y<r&&p.y<r)&&(c.y<r?c=new ht.default(c.x+(p.x-c.x)*((r-c.y)/(p.y-c.y)),r)._round():p.y<r&&(p=new ht.default(c.x+(p.x-c.x)*((r-c.y)/(p.y-c.y)),r)._round()),!(c.x>=n&&p.x>=n)&&(c.x>=n?c=new ht.default(n,c.y+(p.y-c.y)*((n-c.x)/(p.x-c.x)))._round():p.x>=n&&(p=new ht.default(n,c.y+(p.y-c.y)*((n-c.x)/(p.x-c.x)))._round()),!(c.y>=i&&p.y>=i)&&(c.y>=i?c=new ht.default(c.x+(p.x-c.x)*((i-c.y)/(p.y-c.y)),i)._round():p.y>=i&&(p=new ht.default(c.x+(p.x-c.x)*((i-c.y)/(p.y-c.y)),i)._round()),(!l||!c.equals(l[l.length-1]))&&(l=[c],o.push(l)),l.push(p)))))}}return o}var xe=Y(ye(),1);var jr=he;function El(t,e,r,n){let i=[],o=t.image,a=o.pixelRatio,s=o.paddedRect.w-2*jr,l=o.paddedRect.h-2*jr,u={x1:t.left,y1:t.top,x2:t.right,y2:t.bottom},c=o.stretchX||[[0,s]],p=o.stretchY||[[0,l]],f=(_,V)=>_+V[1]-V[0],y=c.reduce(f,0),m=p.reduce(f,0),h=s-y,g=l-m,d=0,b=y,x=0,v=m,S=0,A=h,w=0,T=g;if(o.content&&n){let _=o.content,V=_[2]-_[0],G=_[3]-_[1];(o.textFitWidth||o.textFitHeight)&&(u=Da(t)),d=$a(c,0,_[0]),x=$a(p,0,_[1]),b=$a(c,_[0],_[2]),v=$a(p,_[1],_[3]),S=_[0]-d,w=_[1]-x,A=V-b,T=G-v}let E=u.x1,D=u.y1,B=u.x2-E,z=u.y2-D,M=(_,V,G,O)=>{let R=ja(_.stretch-d,b,B,E),K=qa(_.fixed-S,A,_.stretch,y),X=ja(V.stretch-x,v,z,D),re=qa(V.fixed-w,T,V.stretch,m),me=ja(G.stretch-d,b,B,E),Ut=qa(G.fixed-S,A,G.stretch,y),tt=ja(O.stretch-x,v,z,D),gt=qa(O.fixed-w,T,O.stretch,m),Ni=new xe.default(R,X),Ui=new xe.default(me,X),$i=new xe.default(me,tt),ji=new xe.default(R,tt),ss=new xe.default(K/a,re/a),Ie=new xe.default(Ut/a,gt/a),xt=e*Math.PI/180;if(xt){let bt=Math.sin(xt),Jr=Math.cos(xt),Be=[Jr,-bt,bt,Jr];Ni._matMult(Be),Ui._matMult(Be),ji._matMult(Be),$i._matMult(Be)}let Zr=_.stretch+_.fixed,ls=G.stretch+G.fixed,qi=V.stretch+V.fixed,us=O.stretch+O.fixed,Te={x:o.paddedRect.x+jr+Zr,y:o.paddedRect.y+jr+qi,w:ls-Zr,h:us-qi},be=A/a/B,rt=T/a/z;return{tl:Ni,tr:Ui,bl:ji,br:$i,tex:Te,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ss,pixelOffsetBR:Ie,minFontScaleX:be,minFontScaleY:rt,isSDF:r}};if(!n||!o.stretchX&&!o.stretchY)i.push(M({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:s+1},{fixed:0,stretch:l+1}));else{let _=iy(c,h,y),V=iy(p,g,m);for(let G=0;G<_.length-1;G++){let O=_[G],R=_[G+1];for(let K=0;K<V.length-1;K++){let X=V[K],re=V[K+1];i.push(M(O,X,R,re))}}}return i}function $a(t,e,r){let n=0;for(let i of t)n+=Math.max(e,Math.min(r,i[1]))-Math.max(e,Math.min(r,i[0]));return n}function iy(t,e,r){let n=[{fixed:-jr,stretch:0}];for(let[i,o]of t){let a=n[n.length-1];n.push({fixed:i-a.stretch,stretch:a.stretch}),n.push({fixed:i-a.stretch,stretch:a.stretch+(o-i)})}return n.push({fixed:e+jr,stretch:r}),n}function ja(t,e,r,n){return t/e*r+n}function qa(t,e,r,n){return t-e*r/n}function oy(t,e,r,n,i,o,a,s){let l=n.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,u=[];for(let c of e.positionedLines)for(let p of c.positionedGlyphs){if(!p.rect)continue;let f=p.rect||{},m=ka+1,h=!0,g=1,d=0,b=(i||s)&&p.vertical,x=p.metrics.advance*p.scale/2;if(s&&e.verticalizable){let X=(p.scale-1)*ae,re=(ae-p.metrics.width*p.scale)/2;d=c.lineOffset/2-(p.imageName?-re:X)}if(p.imageName){let X=a[p.imageName];h=X.sdf,g=X.pixelRatio,m=he/g}let v=i?[p.x+x,p.y]:[0,0],S=i?[0,0]:[p.x+x+r[0],p.y+r[1]-d],A=[0,0];b&&(A=S,S=[0,0]);let w=p.metrics.isDoubleResolution?2:1,T=(p.metrics.left-m)*p.scale-x+S[0],E=(-p.metrics.top-m)*p.scale+S[1],D=T+f.w/w*p.scale/g,B=E+f.h/w*p.scale/g,z=new xe.default(T,E),M=new xe.default(D,E),_=new xe.default(T,B),V=new xe.default(D,B);if(b){let X=new xe.default(-x,x-bi),re=-Math.PI/2,me=ae/2-x,Ut=p.imageName?me:0,tt=new xe.default(5-bi-me,-Ut),gt=new xe.default(...A);z._rotateAround(re,X)._add(tt)._add(gt),M._rotateAround(re,X)._add(tt)._add(gt),_._rotateAround(re,X)._add(tt)._add(gt),V._rotateAround(re,X)._add(tt)._add(gt)}if(l){let X=Math.sin(l),re=Math.cos(l),me=[re,-X,X,re];z._matMult(me),M._matMult(me),_._matMult(me),V._matMult(me)}let G=new xe.default(0,0),O=new xe.default(0,0);u.push({tl:z,tr:M,bl:_,br:V,tex:f,writingMode:e.writingMode,glyphOffset:v,sectionIndex:p.sectionIndex,isSDF:h,pixelOffsetTL:G,pixelOffsetBR:O,minFontScaleX:0,minFontScaleY:0})}return u}var Ti=Y(ye(),1);var mr=class{constructor(e,r,n,i,o,a,s,l,u,c){var p;if(this.boxStartIndex=e.length,u){let f=a.top,y=a.bottom,m=a.collisionPadding;m&&(f-=m[1],y+=m[3]);let h=y-f;h>0&&(h=Math.max(10,h),this.circleDiameter=h)}else{let f=(p=a.image)!=null&&p.content&&(a.image.textFitWidth||a.image.textFitHeight)?Da(a):{x1:a.left,y1:a.top,x2:a.right,y2:a.bottom};f.y1=f.y1*s-l[0],f.y2=f.y2*s+l[2],f.x1=f.x1*s-l[3],f.x2=f.x2*s+l[1];let y=a.collisionPadding;if(y&&(f.x1-=y[0]*s,f.y1-=y[1]*s,f.x2+=y[2]*s,f.y2+=y[3]*s),c){let m=new Ti.default(f.x1,f.y1),h=new Ti.default(f.x2,f.y1),g=new Ti.default(f.x1,f.y2),d=new Ti.default(f.x2,f.y2),b=c*Math.PI/180;m._rotate(b),h._rotate(b),g._rotate(b),d._rotate(b),f.x1=Math.min(m.x,h.x,g.x,d.x),f.x2=Math.max(m.x,h.x,g.x,d.x),f.y1=Math.min(m.y,h.y,g.y,d.y),f.y2=Math.max(m.y,h.y,g.y,d.y)}e.emplaceBack(r.x,r.y,f.x1,f.y1,f.x2,f.y2,n,i,o)}this.boxEndIndex=e.length}};var Ci=class{constructor(e=[],r=(n,i)=>n<i?-1:n>i?1:0){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;let e=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:r,compare:n}=this,i=r[e];for(;e>0;){let o=e-1>>1,a=r[o];if(n(i,a)>=0)break;r[e]=a,e=o}r[e]=i}_down(e){let{data:r,compare:n}=this,i=this.length>>1,o=r[e];for(;e<i;){let a=(e<<1)+1,s=a+1;if(s<this.length&&n(r[s],r[a])<0&&(a=s),n(r[a],o)>=0)break;r[e]=r[a],e=a}r[e]=o}};var Ml=Y(ye(),1);function ay(t,e=1,r=!1){let n=yr.fromPoints(t[0]),i=Math.min(n.width(),n.height()),o=i/2,a=new Ci([],Lb),{minX:s,minY:l,maxX:u,maxY:c}=n;if(i===0)return new Ml.default(s,l);for(let y=s;y<u;y+=i)for(let m=l;m<c;m+=i)a.push(new qr(y+o,m+o,o,t));let p=Bb(t),f=a.length;for(;a.length;){let y=a.pop();(y.d>p.d||!p.d)&&(p=y,r&&console.log("found best %d after %d probes",Math.round(1e4*y.d)/1e4,f)),!(y.max-p.d<=e)&&(o=y.h/2,a.push(new qr(y.p.x-o,y.p.y-o,o,t)),a.push(new qr(y.p.x+o,y.p.y-o,o,t)),a.push(new qr(y.p.x-o,y.p.y+o,o,t)),a.push(new qr(y.p.x+o,y.p.y+o,o,t)),f+=4)}return r&&(console.log("num probes: ".concat(f)),console.log("best distance: ".concat(p.d))),p.p}function Lb(t,e){return e.max-t.max}function qr(t,e,r,n){this.p=new Ml.default(t,e),this.h=r,this.d=Db(this.p,n),this.max=this.d+this.h*Math.SQRT2}function Db(t,e){let r=!1,n=1/0;for(let i=0;i<e.length;i++){let o=e[i];for(let a=0,s=o.length,l=s-1;a<s;l=a++){let u=o[a],c=o[l];u.y>t.y!=c.y>t.y&&t.x<(c.x-u.x)*(t.y-u.y)/(c.y-u.y)+u.x&&(r=!r),n=Math.min(n,cl(t,u,c))}}return(r?1:-1)*Math.sqrt(n)}function Bb(t){let e=0,r=0,n=0,i=t[0];for(let o=0,a=i.length,s=a-1;o<a;s=o++){let l=i[o],u=i[s],c=l.x*u.y-u.x*l.y;r+=(l.x+u.x)*c,n+=(l.y+u.y)*c,e+=c*3}return new qr(r/e,n/e,0,t)}var Vl=Y(il(),1);var Ll=(o=>(o[o.center=1]="center",o[o.left=2]="left",o[o.right=3]="right",o[o.top=4]="top",o[o.bottom=5]="bottom",o[o["top-left"]=6]="top-left",o[o["top-right"]=7]="top-right",o[o["bottom-left"]=8]="bottom-left",o[o["bottom-right"]=9]="bottom-right",o))(Ll||{}),Ot=7,Wa=Number.POSITIVE_INFINITY;function Dl(t,e){function r(i,o){let a=0,s=0;o<0&&(o=0);let l=o/Math.SQRT2;switch(i){case"top-right":case"top-left":s=l-Ot;break;case"bottom-right":case"bottom-left":s=-l+Ot;break;case"bottom":s=-o+Ot;break;case"top":s=o-Ot;break}switch(i){case"top-right":case"bottom-right":a=-l;break;case"top-left":case"bottom-left":a=l;break;case"left":a=o;break;case"right":a=-o;break}return[a,s]}function n(i,o,a){let s=0,l=0;switch(o=Math.abs(o),a=Math.abs(a),i){case"top-right":case"top-left":case"top":l=a-Ot;break;case"bottom-right":case"bottom-left":case"bottom":l=-a+Ot;break}switch(i){case"top-right":case"bottom-right":case"right":s=-o;break;case"top-left":case"bottom-left":case"left":s=o;break}return[s,l]}return e[1]!==Wa?n(t,e[0],e[1]):r(t,e[0])}function Bl(t,e,r){var a;let n=t.layout,i=(a=n.get("text-variable-anchor-offset"))==null?void 0:a.evaluate(e,{},r);if(i){let s=i.values,l=[];for(let u=0;u<s.length;u+=2){let c=l[u]=s[u],p=s[u+1].map(f=>f*ae);c.startsWith("top")?p[1]-=Ot:c.startsWith("bottom")&&(p[1]+=Ot),l[u+1]=p}return new Ee(l)}let o=n.get("text-variable-anchor");if(o){let s;t._unevaluatedLayout.getValue("text-radial-offset")!==void 0?s=[n.get("text-radial-offset").evaluate(e,{},r)*ae,Wa]:s=n.get("text-offset").evaluate(e,{},r).map(c=>c*ae);let u=[];for(let c of o)u.push(c,Dl(c,s));return new Ee(u)}return null}function uy(t){t.bucket.createArrays();let e=512*t.bucket.overscaling;t.bucket.tilePixelRatio=8192/e,t.bucket.compareText={},t.bucket.iconsNeedLinear=!1;let r=t.bucket.layers[0],n=r.layout,i=r._unevaluatedLayout._values,o={layoutIconSize:i["icon-size"].possiblyEvaluate(new W(t.bucket.zoom+1),t.canonical),layoutTextSize:i["text-size"].possiblyEvaluate(new W(t.bucket.zoom+1),t.canonical),textMaxSize:i["text-size"].possiblyEvaluate(new W(18))};if(t.bucket.textSizeData.kind==="composite"){let{minZoom:c,maxZoom:p}=t.bucket.textSizeData;o.compositeTextSizes=[i["text-size"].possiblyEvaluate(new W(c),t.canonical),i["text-size"].possiblyEvaluate(new W(p),t.canonical)]}if(t.bucket.iconSizeData.kind==="composite"){let{minZoom:c,maxZoom:p}=t.bucket.iconSizeData;o.compositeIconSizes=[i["icon-size"].possiblyEvaluate(new W(c),t.canonical),i["icon-size"].possiblyEvaluate(new W(p),t.canonical)]}let a=n.get("text-line-height")*ae,s=n.get("text-rotation-alignment")!=="viewport"&&n.get("symbol-placement")!=="point",l=n.get("text-keep-upright"),u=n.get("text-size");for(let c of t.bucket.features){let p=n.get("text-font").evaluate(c,{},t.canonical).join(","),f=u.evaluate(c,{},t.canonical),y=o.layoutTextSize.evaluate(c,{},t.canonical),m=o.layoutIconSize.evaluate(c,{},t.canonical),h={horizontal:{},vertical:void 0},g=c.text,d=[0,0];if(g){let S=g.toString(),A=n.get("text-letter-spacing").evaluate(c,{},t.canonical)*ae,w=ep(S)?A:0,T=n.get("text-anchor").evaluate(c,{},t.canonical),E=Bl(r,c,t.canonical);if(!E){let _=n.get("text-radial-offset").evaluate(c,{},t.canonical);_?d=Dl(T,[_*ae,Wa]):d=n.get("text-offset").evaluate(c,{},t.canonical).map(V=>V*ae)}let D=s?"center":n.get("text-justify").evaluate(c,{},t.canonical),z=n.get("symbol-placement")==="point"?n.get("text-max-width").evaluate(c,{},t.canonical)*ae:1/0,M=()=>{t.bucket.allowVerticalPlacement&&Tn(S)&&(h.vertical=vi(g,t.glyphMap,t.glyphPositions,t.imagePositions,p,z,a,T,"left",w,d,2,!0,y,f))};if(!s&&E){let _=new Set;if(D==="auto")for(let G=0;G<E.values.length;G+=2)_.add(sy(E.values[G]));else _.add(D);let V=!1;for(let G of _)if(!h.horizontal[G])if(V)h.horizontal[G]=h.horizontal[0];else{let O=vi(g,t.glyphMap,t.glyphPositions,t.imagePositions,p,z,a,"center",G,w,d,1,!1,y,f);O&&(h.horizontal[G]=O,V=O.positionedLines.length===1)}M()}else{D==="auto"&&(D=sy(T));let _=vi(g,t.glyphMap,t.glyphPositions,t.imagePositions,p,z,a,T,D,w,d,1,!1,y,f);_&&(h.horizontal[D]=_),M(),Tn(S)&&s&&l&&(h.vertical=vi(g,t.glyphMap,t.glyphPositions,t.imagePositions,p,z,a,T,D,w,d,2,!1,y,f))}}let b,x=!1;if(c.icon&&c.icon.name){let S=t.imageMap[c.icon.name];S&&(b=Bf(t.imagePositions[c.icon.name],n.get("icon-offset").evaluate(c,{},t.canonical),n.get("icon-anchor").evaluate(c,{},t.canonical)),x=!!S.sdf,t.bucket.sdfIcons===void 0?t.bucket.sdfIcons=x:t.bucket.sdfIcons!==x&&ce("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(S.pixelRatio!==t.bucket.pixelRatio||n.get("icon-rotate").constantOr(1)!==0)&&(t.bucket.iconsNeedLinear=!0))}let v=cy(h.horizontal)||h.vertical;t.bucket.iconsInText=v?v.iconsInText:!1,(v||b)&&Vb(t.bucket,c,h,b,t.imageMap,o,y,m,d,x,t.canonical,t.subdivisionGranularity)}t.showCollisionBoxes&&t.bucket.generateCollisionDebugBuffers()}function sy(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Vb(t,e,r,n,i,o,a,s,l,u,c,p){let f=o.textMaxSize.evaluate(e,{});f===void 0&&(f=a);let y=t.layers[0].layout,m=y.get("icon-offset").evaluate(e,{},c),h=cy(r.horizontal),g=24,d=a/g,b=t.tilePixelRatio*d,x=t.tilePixelRatio*f/g,v=t.tilePixelRatio*s,S=t.tilePixelRatio*y.get("symbol-spacing"),A=y.get("text-padding")*t.tilePixelRatio,w=Nf(y,e,c,t.tilePixelRatio),T=y.get("text-max-angle")/180*Math.PI,E=y.get("text-rotation-alignment")!=="viewport"&&y.get("symbol-placement")!=="point",D=y.get("icon-rotation-alignment")==="map"&&y.get("symbol-placement")!=="point",B=y.get("symbol-placement"),z=S/2,M=y.get("icon-text-fit"),_;n&&M!=="none"&&(t.allowVerticalPlacement&&r.vertical&&(_=Tl(n,r.vertical,M,y.get("icon-text-fit-padding"),m,d)),h&&(n=Tl(n,h,M,y.get("icon-text-fit-padding"),m,d)));let V=c?p.line.getGranularityForZoomLevel(c.z):1,G=(O,R)=>{R.x<0||R.x>=8192||R.y<0||R.y>=8192||zb(t,R,O,r,n,i,_,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,b,[A,A,A,A],E,l,v,w,D,m,e,o,u,c,a)};if(B==="line")for(let O of ny(e.geometry,0,0,8192,8192)){let R=Ke(O,V),K=ty(R,S,T,r.vertical||h,n,g,x,t.overscaling,8192);for(let X of K){let re=h;(!re||!Ob(t,re.text,z,X))&&G(R,X)}}else if(B==="line-center"){for(let O of e.geometry)if(O.length>1){let R=Ke(O,V),K=ey(R,T,r.vertical||h,n,g,x);K&&G(R,K)}}else if(e.type==="Polygon")for(let O of Kt(e.geometry,0)){let R=ay(O,16),K=Ke(O[0],V,!0);G(K,new et(R.x,R.y,0))}else if(e.type==="LineString")for(let O of e.geometry){let R=Ke(O,V);G(R,new et(R[0].x,R[0].y,0))}else if(e.type==="Point")for(let O of e.geometry)for(let R of O)G([R],new et(R.x,R.y,0))}function Rb(t,e){let r=t.length,n=e==null?void 0:e.values;if((n==null?void 0:n.length)>0)for(let i=0;i<n.length;i+=2){let o=Ll[n[i]],a=n[i+1];t.emplaceBack(o,a[0],a[1])}return[r,t.length]}function ly(t,e,r,n,i,o,a,s,l,u,c,p,f,y,m){let h=oy(e,r,s,i,o,a,n,t.allowVerticalPlacement),g=t.textSizeData,d=null;g.kind==="source"?(d=[zt*i.layout.get("text-size").evaluate(a,{})],d[0]>Qe&&ce("".concat(t.layerIds[0],': Value for "text-size" is >= ').concat(Ur,'. Reduce your "text-size".'))):g.kind==="composite"&&(d=[zt*y.compositeTextSizes[0].evaluate(a,{},m),zt*y.compositeTextSizes[1].evaluate(a,{},m)],(d[0]>Qe||d[1]>Qe)&&ce("".concat(t.layerIds[0],': Value for "text-size" is >= ').concat(Ur,'. Reduce your "text-size".'))),t.addSymbols(t.text,h,d,s,o,a,u,e,l.lineStartIndex,l.lineLength,f,m);for(let b of c)p[b]=t.text.placedSymbolArray.length-1;return h.length*4}function cy(t){for(let e in t)return t[e];return null}function zb(t,e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,g,d,b,x,v,S,A,w,T){let E=t.addToLineVertexArray(e,r),D,B,z,M,_=0,V=0,G=0,O=0,R=-1,K=-1,X={},re=(0,Vl.default)("");if(t.allowVerticalPlacement&&n.vertical){let be=s.layout.get("text-rotate").evaluate(v,{},w)+90,rt=n.vertical;z=new mr(l,e,u,c,p,rt,f,y,m,be),a&&(M=new mr(l,e,u,c,p,a,g,d,m,be))}if(i){let Te=s.layout.get("icon-rotate").evaluate(v,{}),be=s.layout.get("icon-text-fit")!=="none",rt=El(i,Te,A,be),bt=a?El(a,Te,A,be):void 0;B=new mr(l,e,u,c,p,i,g,d,!1,Te),_=rt.length*4;let Jr=t.iconSizeData,Be=null;Jr.kind==="source"?(Be=[zt*s.layout.get("icon-size").evaluate(v,{})],Be[0]>Qe&&ce("".concat(t.layerIds[0],': Value for "icon-size" is >= ').concat(Ur,'. Reduce your "icon-size".'))):Jr.kind==="composite"&&(Be=[zt*S.compositeIconSizes[0].evaluate(v,{},w),zt*S.compositeIconSizes[1].evaluate(v,{},w)],(Be[0]>Qe||Be[1]>Qe)&&ce("".concat(t.layerIds[0],': Value for "icon-size" is >= ').concat(Ur,'. Reduce your "icon-size".'))),t.addSymbols(t.icon,rt,Be,x,b,v,0,e,E.lineStartIndex,E.lineLength,-1,w),R=t.icon.placedSymbolArray.length-1,bt&&(V=bt.length*4,t.addSymbols(t.icon,bt,Be,x,b,v,2,e,E.lineStartIndex,E.lineLength,-1,w),K=t.icon.placedSymbolArray.length-1)}let me=Object.keys(n.horizontal);for(let Te of me){let be=n.horizontal[Te];if(!D){re=(0,Vl.default)(be.text);let bt=s.layout.get("text-rotate").evaluate(v,{},w);D=new mr(l,e,u,c,p,be,f,y,m,bt)}let rt=be.positionedLines.length===1;if(G+=ly(t,e,be,o,s,m,v,h,E,n.vertical?1:3,rt?me:[Te],X,R,S,w),rt)break}n.vertical&&(O+=ly(t,e,n.vertical,o,s,m,v,h,E,2,["vertical"],X,K,S,w));let Ut=D?D.boxStartIndex:t.collisionBoxArray.length,tt=D?D.boxEndIndex:t.collisionBoxArray.length,gt=z?z.boxStartIndex:t.collisionBoxArray.length,Ni=z?z.boxEndIndex:t.collisionBoxArray.length,Ui=B?B.boxStartIndex:t.collisionBoxArray.length,$i=B?B.boxEndIndex:t.collisionBoxArray.length,ji=M?M.boxStartIndex:t.collisionBoxArray.length,ss=M?M.boxEndIndex:t.collisionBoxArray.length,Ie=-1,xt=(Te,be)=>Te&&Te.circleDiameter?Math.max(Te.circleDiameter,be):be;Ie=xt(D,Ie),Ie=xt(z,Ie),Ie=xt(B,Ie),Ie=xt(M,Ie);let Zr=Ie>-1?1:0;Zr&&(Ie*=T/ae),t.glyphOffsetArray.length>=Xe.MAX_GLYPHS&&ce("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),v.sortKey!==void 0&&t.addToSortKeyRanges(t.symbolInstances.length,v.sortKey);let ls=Bl(s,v,w),[qi,us]=Rb(t.textAnchorOffsets,ls);t.symbolInstances.emplaceBack(e.x,e.y,X.right>=0?X.right:-1,X.center>=0?X.center:-1,X.left>=0?X.left:-1,X.vertical||-1,R,K,re,Ut,tt,gt,Ni,Ui,$i,ji,ss,u,G,O,_,V,Zr,0,f,Ie,qi,us)}function Ob(t,e,r,n){let i=t.compareText;if(!(e in i))i[e]=[];else{let o=i[e];for(let a=o.length-1;a>=0;a--)if(n.dist(o[a])<r)return!0}return i[e].push(n),!1}var Xa=1,ki=class{constructor(e){let r={},n=[];for(let s in e){let l=e[s],u=r[s]={};for(let c in l){let p=l[+c];if(!p||p.bitmap.width===0||p.bitmap.height===0)continue;let f={x:0,y:0,w:p.bitmap.width+2*Xa,h:p.bitmap.height+2*Xa};n.push(f),u[c]={rect:f,metrics:p.metrics}}}let{w:i,h:o}=di(n),a=new lr({width:i||1,height:o||1});for(let s in e){let l=e[s];for(let u in l){let c=l[+u];if(!c||c.bitmap.width===0||c.bitmap.height===0)continue;let p=r[s][u].rect;lr.copy(c.bitmap,a,{x:0,y:0},{x:p.x+Xa,y:p.y+Xa},c.bitmap)}}this.image=a,this.positions=r}};I("GlyphAtlas",ki);function fy(t,e,r){e=Math.pow(2,r)-e-1;var n=py(t*256,e*256,r),i=py((t+1)*256,(e+1)*256,r);return n[0]+","+n[1]+","+i[0]+","+i[1]}function py(t,e,r){var n=2*Math.PI*6378137/256/Math.pow(2,r),i=t*n-2*Math.PI*6378137/2,o=e*n-2*Math.PI*6378137/2;return[i,o]}var dy=Y(ye(),1);var Rl=63710088e-1,Fi=class t{constructor(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid LngLat object: (".concat(e,", ").concat(r,")"));if(this.lng=+e,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new t(Cu(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}distanceTo(e){let r=Math.PI/180,n=this.lat*r,i=e.lat*r,o=Math.sin(n)*Math.sin(i)+Math.cos(n)*Math.cos(i)*Math.cos((e.lng-this.lng)*r);return Rl*Math.acos(Math.min(o,1))}static convert(e){if(e instanceof t)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new t(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new t(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("\`LngLatLike\` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}};var yy=2*Math.PI*Rl;function my(t){return yy*Math.cos(t*Math.PI/180)}function Gb(t){return(180+t)/360}function Nb(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Ub(t,e){return t/my(e)}function $b(t){return t*360-180}function zl(t){let e=180-t*360;return 360/Math.PI*Math.atan(Math.exp(e*Math.PI/180))-90}function jb(t,e){return t*my(zl(e))}function qb(t){return 1/Math.cos(t*Math.PI/180)}var Ei=class t{constructor(e,r,n=0){this.x=+e,this.y=+r,this.z=+n}static fromLngLat(e,r=0){let n=Fi.convert(e);return new t(Gb(n.lng),Nb(n.lat),Ub(r,n.lat))}toLngLat(){return new Fi($b(this.x),zl(this.y))}toAltitude(){return jb(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/yy*qb(zl(this.y))}};function hy(t,e,r){return!(t<Yi||t>Ji||r<0||r>=Math.pow(2,t)||e<0||e>=Math.pow(2,t))}var Ha=class{constructor(e,r,n){if(!hy(e,r,n))throw new Error("x=".concat(r,", y=").concat(n,", z=").concat(e," outside of bounds. 0<=x<").concat(Math.pow(2,e),", 0<=y<").concat(Math.pow(2,e)," ").concat(Yi,"<=z<=").concat(Ji," "));this.z=e,this.x=r,this.y=n,this.key=Mi(0,e,e,r,n)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,r,n){let i=fy(this.x,this.y,this.z),o=Wb(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(n==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,o).replace(/{bbox-epsg-3857}/g,i)}isChildOf(e){let r=this.z-e.z;return r>0&&e.x===this.x>>r&&e.y===this.y>>r}getTilePoint(e){let r=Math.pow(2,this.z);return new dy.default((e.x*r-this.x)*8192,(e.y*r-this.y)*8192)}toString(){return"".concat(this.z,"/").concat(this.x,"/").concat(this.y)}},Ol=class{constructor(e,r){this.wrap=e,this.canonical=r,this.key=Mi(e,r.z,r.z,r.x,r.y)}},Li=class t{constructor(e,r,n,i,o){this.terrainRttPosMatrix32f=null;if(e<n)throw new Error("overscaledZ should be >= z; overscaledZ = ".concat(e,"; z = ").concat(n));this.overscaledZ=e,this.wrap=r,this.canonical=new Ha(n,+i,+o),this.key=Mi(r,e,n,i,o)}clone(){return new t(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error("targetZ > this.overscaledZ; targetZ = ".concat(e,"; overscaledZ = ").concat(this.overscaledZ));let r=this.canonical.z-e;return e>this.canonical.z?new t(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new t(e,this.wrap,e,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(e,r){if(e>this.overscaledZ)throw new Error("targetZ > this.overscaledZ; targetZ = ".concat(e,"; overscaledZ = ").concat(this.overscaledZ));let n=this.canonical.z-e;return e>this.canonical.z?Mi(this.wrap*+r,e,this.canonical.z,this.canonical.x,this.canonical.y):Mi(this.wrap*+r,e,e,this.canonical.x>>n,this.canonical.y>>n)}isChildOf(e){if(e.wrap!==this.wrap)return!1;let r=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>r&&e.canonical.y===this.canonical.y>>r}children(e){if(this.overscaledZ>=e)return[new t(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let r=this.canonical.z+1,n=this.canonical.x*2,i=this.canonical.y*2;return[new t(r,this.wrap,r,n,i),new t(r,this.wrap,r,n+1,i),new t(r,this.wrap,r,n,i+1),new t(r,this.wrap,r,n+1,i+1)]}isLessThan(e){return this.wrap<e.wrap?!0:this.wrap>e.wrap?!1:this.overscaledZ<e.overscaledZ?!0:this.overscaledZ>e.overscaledZ?!1:this.canonical.x<e.canonical.x?!0:this.canonical.x>e.canonical.x?!1:this.canonical.y<e.canonical.y}wrapped(){return new t(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new t(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Ol(this.wrap,this.canonical)}toString(){return"".concat(this.overscaledZ,"/").concat(this.canonical.x,"/").concat(this.canonical.y)}getTilePoint(e){return this.canonical.getTilePoint(new Ei(e.x-this.wrap,e.y))}};function Mi(t,e,r,n,i){t*=2,t<0&&(t=t*-1-1);let o=1<<r;return(o*o*t+o*i+n).toString(36)+r.toString(36)+e.toString(36)}function Wb(t,e,r){let n="",i;for(let o=t;o>0;o--)i=1<<o-1,n+=(e&i?1:0)+(r&i?2:0);return n}I("CanonicalTileID",Ha);I("OverscaledTileID",Li,{omit:["terrainRttPosMatrix32f"]});var Za=class{constructor(e){this.tileID=new Li(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.inFlightDependencies=[],this.globalState=e.globalState}async parse(e,r,n,i,o){this.status="parsing",this.data=e,this.collisionBoxArray=new qn;let a=new $r(Object.keys(e.layers).sort()),s=new Ii(this.tileID,this.promoteId);s.bucketLayerIDs=[];let l={},u={featureIndex:s,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:n,subdivisionGranularity:o},c=r.familiesBySource[this.source];for(let A in c){let w=e.layers[A];if(!w)continue;w.version===1&&ce('Vector tile source "'.concat(this.source,'" layer "').concat(A,'" ')+"does not use vector tile spec v2 and therefore may have some rendering errors.");let T=a.encode(A),E=[];for(let D=0;D<w.length;D++){let B=w.feature(D),z=s.getId(B,A);E.push({feature:B,id:z,index:D,sourceLayerIndex:T})}for(let D of c[A]){let B=D[0];if(B.source!==this.source&&ce("layer.source = ".concat(B.source," does not equal this.source = ").concat(this.source)),B.minzoom&&this.zoom<Math.floor(B.minzoom)||B.maxzoom&&this.zoom>=B.maxzoom||B.visibility==="none")continue;Gl(D,this.zoom,n),(l[B.id]=B.createBucket({index:s.bucketLayerIDs.length,layers:D,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:T,sourceID:this.source,globalState:this.globalState})).populate(E,u,this.tileID.canonical),s.bucketLayerIDs.push(D.map(M=>M.id))}}let p=rn(u.glyphDependencies,A=>Object.keys(A).map(Number));this.inFlightDependencies.forEach(A=>A==null?void 0:A.abort()),this.inFlightDependencies=[];let f=Promise.resolve({});if(Object.keys(p).length){let A=new AbortController;this.inFlightDependencies.push(A),f=i.sendAsync({type:"GG",data:{stacks:p,source:this.source,tileID:this.tileID,type:"glyphs"}},A)}let y=Object.keys(u.iconDependencies),m=Promise.resolve({});if(y.length){let A=new AbortController;this.inFlightDependencies.push(A),m=i.sendAsync({type:"GI",data:{icons:y,source:this.source,tileID:this.tileID,type:"icons"}},A)}let h=Object.keys(u.patternDependencies),g=Promise.resolve({});if(h.length){let A=new AbortController;this.inFlightDependencies.push(A),g=i.sendAsync({type:"GI",data:{icons:h,source:this.source,tileID:this.tileID,type:"patterns"}},A)}let[d,b,x]=await Promise.all([f,m,g]),v=new ki(d),S=new gi(b,x);for(let A in l){let w=l[A];w instanceof Xe?(Gl(w.layers,this.zoom,n),uy({bucket:w,glyphMap:d,glyphPositions:v.positions,imageMap:b,imagePositions:S.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:u.subdivisionGranularity})):w.hasPattern&&(w instanceof fr||w instanceof cr||w instanceof pr)&&(Gl(w.layers,this.zoom,n),w.addFeatures(u,this.tileID.canonical,S.patternPositions))}return this.status="done",{buckets:Object.values(l).filter(A=>!A.isEmpty()),featureIndex:s,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:v.image,imageAtlas:S,glyphMap:this.returnDependencies?d:null,iconMap:this.returnDependencies?b:null,glyphPositions:this.returnDependencies?v.positions:null}}};function Gl(t,e,r){let n=new W(e);for(let i of t)i.recalculate(n,r)}var Xb=60,rT=1e3/Xb;var Wr=class{constructor(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let e=performance.getEntriesByName(this._marks.measure);return e.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),e=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),e}};var Xr=class{constructor(e,r,n){this.actor=e,this.layerIndex=r,this.availableImages=n,this.fetching={},this.loading={},this.loaded={}}async loadVectorTile(e,r){let n=await Xc(e.request,r);try{return{vectorTile:new gy.default.VectorTile(new xy.default(n.data)),rawData:n.data,cacheControl:n.cacheControl,expires:n.expires}}catch(i){let o=new Uint8Array(n.data),a=o[0]===31&&o[1]===139,s="Unable to parse the tile at ".concat(e.request.url,", ");throw a?s+="please make sure the data is not gzipped and that you have configured the relevant header in the server":s+="got error: ".concat(i.message),new Error(s)}}async loadTile(e){let r=e.uid,n=e&&e.request&&e.request.collectResourceTiming?new Wr(e.request):!1,i=new Za(e);this.loading[r]=i;let o=new AbortController;i.abort=o;try{let a=await this.loadVectorTile(e,o);if(delete this.loading[r],!a)return null;let s=a.rawData,l={};a.expires&&(l.expires=a.expires),a.cacheControl&&(l.cacheControl=a.cacheControl);let u={};if(n){let p=n.finish();p&&(u.resourceTiming=JSON.parse(JSON.stringify(p)))}i.vectorTile=a.vectorTile;let c=i.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor,e.subdivisionGranularity);this.loaded[r]=i,this.fetching[r]={rawTileData:s,cacheControl:l,resourceTiming:u};try{let p=await c;return de({rawTileData:s.slice(0)},p,l,u)}finally{delete this.fetching[r]}}catch(a){throw delete this.loading[r],i.status="done",this.loaded[r]=i,a}}async reloadTile(e){let r=e.uid;if(!this.loaded||!this.loaded[r])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");let n=this.loaded[r];if(n.showCollisionBoxes=e.showCollisionBoxes,n.globalState=e.globalState,n.status==="parsing"){let i=await n.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor,e.subdivisionGranularity),o;if(this.fetching[r]){let{rawTileData:a,cacheControl:s,resourceTiming:l}=this.fetching[r];delete this.fetching[r],o=de({rawTileData:a.slice(0)},i,s,l)}else o=i;return o}if(n.status==="done"&&n.vectorTile)return n.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor,e.subdivisionGranularity)}async abortTile(e){let r=this.loading,n=e.uid;r&&r[n]&&r[n].abort&&(r[n].abort.abort(),delete r[n])}async removeTile(e){this.loaded&&this.loaded[e.uid]&&delete this.loaded[e.uid]}};var Ja=class{constructor(){this.loaded={}}async loadTile(e){let{uid:r,encoding:n,rawImageData:i,redFactor:o,greenFactor:a,blueFactor:s,baseShift:l}=e,u=i.width+2,c=i.height+2,p=vt(i)?new fe({width:u,height:c},await Eu(i,-1,-1,u,c)):i,f=new oi(r,p,n,o,a,s,l);return this.loaded=this.loaded||{},this.loaded[r]=f,f}removeTile(e){let r=this.loaded,n=e.uid;r&&r[n]&&delete r[n]}};var qy=Y(Sy(),1);var Nl=Y(ye(),1),wy=Y(Rt(),1);var Hb=wy.default.VectorTileFeature.prototype.toGeoJSON,Ul=class{constructor(e){this._feature=e,this.extent=8192,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))}loadGeometry(){if(this._feature.type===1){let e=[];for(let r of this._feature.geometry)e.push([new Nl.default(r[0],r[1])]);return e}else{let e=[];for(let r of this._feature.geometry){let n=[];for(let i of r)n.push(new Nl.default(i[0],i[1]));e.push(n)}return e}}toGeoJSON(e,r,n){return Hb.call(this,e,r,n)}},Ka=class{constructor(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=8192,this.length=e.length,this._features=e}feature(e){return new Ul(this._features[e])}};var Wy=Y(ky(),1);var Fy=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],ql=1,Bi=8,Ri=class t{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[r,n]=new Uint8Array(e,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");let i=n>>4;if(i!==ql)throw new Error("Got v".concat(i," data when expected v").concat(ql,"."));let o=Fy[n&15];if(!o)throw new Error("Unrecognized array type.");let[a]=new Uint16Array(e,2,1),[s]=new Uint32Array(e,4,1);return new t(s,a,o,e)}constructor(e,r=64,n=Float64Array,i){if(isNaN(e)||e<0)throw new Error("Unpexpected numItems value: ".concat(e,"."));this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=n,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;let o=Fy.indexOf(this.ArrayType),a=e*2*this.ArrayType.BYTES_PER_ELEMENT,s=e*this.IndexArrayType.BYTES_PER_ELEMENT,l=(8-s%8)%8;if(o<0)throw new Error("Unexpected typed array class: ".concat(n,"."));i&&i instanceof ArrayBuffer?(this.data=i,this.ids=new this.IndexArrayType(this.data,Bi,e),this.coords=new this.ArrayType(this.data,Bi+s+l,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(Bi+a+s+l),this.ids=new this.IndexArrayType(this.data,Bi,e),this.coords=new this.ArrayType(this.data,Bi+s+l,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(ql<<4)+o]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){let n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=e,this.coords[this._pos++]=r,n}finish(){let e=this._pos>>1;if(e!==this.numItems)throw new Error("Added ".concat(e," items when expected ").concat(this.numItems,"."));return Xl(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,n,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:o,coords:a,nodeSize:s}=this,l=[0,o.length-1,0],u=[];for(;l.length;){let c=l.pop()||0,p=l.pop()||0,f=l.pop()||0;if(p-f<=s){for(let g=f;g<=p;g++){let d=a[2*g],b=a[2*g+1];d>=e&&d<=n&&b>=r&&b<=i&&u.push(o[g])}continue}let y=f+p>>1,m=a[2*y],h=a[2*y+1];m>=e&&m<=n&&h>=r&&h<=i&&u.push(o[y]),(c===0?e<=m:r<=h)&&(l.push(f),l.push(y-1),l.push(1-c)),(c===0?n>=m:i>=h)&&(l.push(y+1),l.push(p),l.push(1-c))}return u}within(e,r,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:i,coords:o,nodeSize:a}=this,s=[0,i.length-1,0],l=[],u=n*n;for(;s.length;){let c=s.pop()||0,p=s.pop()||0,f=s.pop()||0;if(p-f<=a){for(let g=f;g<=p;g++)Ey(o[2*g],o[2*g+1],e,r)<=u&&l.push(i[g]);continue}let y=f+p>>1,m=o[2*y],h=o[2*y+1];Ey(m,h,e,r)<=u&&l.push(i[y]),(c===0?e-n<=m:r-n<=h)&&(s.push(f),s.push(y-1),s.push(1-c)),(c===0?e+n>=m:r+n>=h)&&(s.push(y+1),s.push(p),s.push(1-c))}return l}};function Xl(t,e,r,n,i,o){if(i-n<=r)return;let a=n+i>>1;My(t,e,a,n,i,o),Xl(t,e,r,n,a-1,1-o),Xl(t,e,r,a+1,i,1-o)}function My(t,e,r,n,i,o){for(;i>n;){if(i-n>600){let u=i-n+1,c=r-n+1,p=Math.log(u),f=.5*Math.exp(2*p/3),y=.5*Math.sqrt(p*f*(u-f)/u)*(c-u/2<0?-1:1),m=Math.max(n,Math.floor(r-c*f/u+y)),h=Math.min(i,Math.floor(r+(u-c)*f/u+y));My(t,e,r,m,h,o)}let a=e[2*r+o],s=n,l=i;for(Vi(t,e,n,r),e[2*i+o]>a&&Vi(t,e,n,i);s<l;){for(Vi(t,e,s,l),s++,l--;e[2*s+o]<a;)s++;for(;e[2*l+o]>a;)l--}e[2*n+o]===a?Vi(t,e,n,l):(l++,Vi(t,e,l,i)),l<=r&&(n=l+1),r<=l&&(i=l-1)}}function Vi(t,e,r,n){Wl(t,r,n),Wl(e,2*r,2*n),Wl(e,2*r+1,2*n+1)}function Wl(t,e,r){let n=t[e];t[e]=t[r],t[r]=n}function Ey(t,e,r,n){let i=t-r,o=e-n;return i*i+o*o}var o0={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},Ly=Math.fround||(t=>e=>(t[0]=+e,t[0]))(new Float32Array(1)),hr=2,Nt=3,Hl=4,Gt=5,By=6,zi=class{constructor(e){this.options=Object.assign(Object.create(o0),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){let{log:r,minZoom:n,maxZoom:i}=this.options;r&&console.time("total time");let o="prepare ".concat(e.length," points");r&&console.time(o),this.points=e;let a=[];for(let l=0;l<e.length;l++){let u=e[l];if(!u.geometry)continue;let[c,p]=u.geometry.coordinates,f=Ly(es(c)),y=Ly(ts(p));a.push(f,y,1/0,l,-1,1),this.options.reduce&&a.push(0)}let s=this.trees[i+1]=this._createTree(a);r&&console.timeEnd(o);for(let l=i;l>=n;l--){let u=+Date.now();s=this.trees[l]=this._createTree(this._cluster(s,l)),r&&console.log("z%d: %d clusters in %dms",l,s.numItems,+Date.now()-u)}return r&&console.timeEnd("total time"),this}getClusters(e,r){let n=((e[0]+180)%360+360)%360-180,i=Math.max(-90,Math.min(90,e[1])),o=e[2]===180?180:((e[2]+180)%360+360)%360-180,a=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)n=-180,o=180;else if(n>o){let p=this.getClusters([n,i,180,a],r),f=this.getClusters([-180,i,o,a],r);return p.concat(f)}let s=this.trees[this._limitZoom(r)],l=s.range(es(n),ts(a),es(o),ts(i)),u=s.data,c=[];for(let p of l){let f=this.stride*p;c.push(u[f+Gt]>1?Dy(u,f,this.clusterProps):this.points[u[f+Nt]])}return c}getChildren(e){let r=this._getOriginId(e),n=this._getOriginZoom(e),i="No cluster with the specified id.",o=this.trees[n];if(!o)throw new Error(i);let a=o.data;if(r*this.stride>=a.length)throw new Error(i);let s=this.options.radius/(this.options.extent*Math.pow(2,n-1)),l=a[r*this.stride],u=a[r*this.stride+1],c=o.within(l,u,s),p=[];for(let f of c){let y=f*this.stride;a[y+Hl]===e&&p.push(a[y+Gt]>1?Dy(a,y,this.clusterProps):this.points[a[y+Nt]])}if(p.length===0)throw new Error(i);return p}getLeaves(e,r,n){r=r||10,n=n||0;let i=[];return this._appendLeaves(i,e,r,n,0),i}getTile(e,r,n){let i=this.trees[this._limitZoom(e)],o=Math.pow(2,e),{extent:a,radius:s}=this.options,l=s/a,u=(n-l)/o,c=(n+1+l)/o,p={features:[]};return this._addTileFeatures(i.range((r-l)/o,u,(r+1+l)/o,c),i.data,r,n,o,p),r===0&&this._addTileFeatures(i.range(1-l/o,u,1,c),i.data,o,n,o,p),r===o-1&&this._addTileFeatures(i.range(0,u,l/o,c),i.data,-1,n,o,p),p.features.length?p:null}getClusterExpansionZoom(e){let r=this._getOriginZoom(e)-1;for(;r<=this.options.maxZoom;){let n=this.getChildren(e);if(r++,n.length!==1)break;e=n[0].properties.cluster_id}return r}_appendLeaves(e,r,n,i,o){let a=this.getChildren(r);for(let s of a){let l=s.properties;if(l&&l.cluster?o+l.point_count<=i?o+=l.point_count:o=this._appendLeaves(e,l.cluster_id,n,i,o):o<i?o++:e.push(s),e.length===n)break}return o}_createTree(e){let r=new Ri(e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let n=0;n<e.length;n+=this.stride)r.add(e[n],e[n+1]);return r.finish(),r.data=e,r}_addTileFeatures(e,r,n,i,o,a){for(let s of e){let l=s*this.stride,u=r[l+Gt]>1,c,p,f;if(u)c=Vy(r,l,this.clusterProps),p=r[l],f=r[l+1];else{let h=this.points[r[l+Nt]];c=h.properties;let[g,d]=h.geometry.coordinates;p=es(g),f=ts(d)}let y={type:1,geometry:[[Math.round(this.options.extent*(p*o-n)),Math.round(this.options.extent*(f*o-i))]],tags:c},m;u||this.options.generateId?m=r[l+Nt]:m=this.points[r[l+Nt]].id,m!==void 0&&(y.id=m),a.features.push(y)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,r){let{radius:n,extent:i,reduce:o,minPoints:a}=this.options,s=n/(i*Math.pow(2,r)),l=e.data,u=[],c=this.stride;for(let p=0;p<l.length;p+=c){if(l[p+hr]<=r)continue;l[p+hr]=r;let f=l[p],y=l[p+1],m=e.within(l[p],l[p+1],s),h=l[p+Gt],g=h;for(let d of m){let b=d*c;l[b+hr]>r&&(g+=l[b+Gt])}if(g>h&&g>=a){let d=f*h,b=y*h,x,v=-1,S=((p/c|0)<<5)+(r+1)+this.points.length;for(let A of m){let w=A*c;if(l[w+hr]<=r)continue;l[w+hr]=r;let T=l[w+Gt];d+=l[w]*T,b+=l[w+1]*T,l[w+Hl]=S,o&&(x||(x=this._map(l,p,!0),v=this.clusterProps.length,this.clusterProps.push(x)),o(x,this._map(l,w)))}l[p+Hl]=S,u.push(d/g,b/g,1/0,S,-1,g),o&&u.push(v)}else{for(let d=0;d<c;d++)u.push(l[p+d]);if(g>1)for(let d of m){let b=d*c;if(!(l[b+hr]<=r)){l[b+hr]=r;for(let x=0;x<c;x++)u.push(l[b+x])}}}}return u}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,r,n){if(e[r+Gt]>1){let a=this.clusterProps[e[r+By]];return n?Object.assign({},a):a}let i=this.points[e[r+Nt]].properties,o=this.options.map(i);return n&&o===i?Object.assign({},o):o}};function Dy(t,e,r){return{type:"Feature",id:t[e+Nt],properties:Vy(t,e,r),geometry:{type:"Point",coordinates:[a0(t[e]),s0(t[e+1])]}}}function Vy(t,e,r){let n=t[e+Gt],i=n>=1e4?"".concat(Math.round(n/1e3),"k"):n>=1e3?"".concat(Math.round(n/100)/10,"k"):n,o=t[e+By],a=o===-1?{}:Object.assign({},r[o]);return Object.assign(a,{cluster:!0,cluster_id:t[e+Nt],point_count:n,point_count_abbreviated:i})}function es(t){return t/360+.5}function ts(t){let e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function a0(t){return(t-.5)*360}function s0(t){let e=(180-t*360)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function Oi(t,e,r,n){let i=n,o=e+(r-e>>1),a=r-e,s,l=t[e],u=t[e+1],c=t[r],p=t[r+1];for(let f=e+3;f<r;f+=3){let y=l0(t[f],t[f+1],l,u,c,p);if(y>i)s=f,i=y;else if(y===i){let m=Math.abs(f-o);m<a&&(s=f,a=m)}}i>n&&(s-e>3&&Oi(t,e,s,n),t[s+2]=i,r-s>3&&Oi(t,s,r,n))}function l0(t,e,r,n,i,o){let a=i-r,s=o-n;if(a!==0||s!==0){let l=((t-r)*a+(e-n)*s)/(a*a+s*s);l>1?(r=i,n=o):l>0&&(r+=a*l,n+=s*l)}return a=t-r,s=e-n,a*a+s*s}function dt(t,e,r,n){let i={id:t==null?null:t,type:e,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(e==="Point"||e==="MultiPoint"||e==="LineString")rs(i,r);else if(e==="Polygon")rs(i,r[0]);else if(e==="MultiLineString")for(let o of r)rs(i,o);else if(e==="MultiPolygon")for(let o of r)rs(i,o[0]);return i}function rs(t,e){for(let r=0;r<e.length;r+=3)t.minX=Math.min(t.minX,e[r]),t.minY=Math.min(t.minY,e[r+1]),t.maxX=Math.max(t.maxX,e[r]),t.maxY=Math.max(t.maxY,e[r+1])}function Yl(t,e){let r=[];if(t.type==="FeatureCollection")for(let n=0;n<t.features.length;n++)ns(r,t.features[n],e,n);else t.type==="Feature"?ns(r,t,e):ns(r,{geometry:t},e);return r}function ns(t,e,r,n){if(!e.geometry)return;let i=e.geometry.coordinates;if(i&&i.length===0)return;let o=e.geometry.type,a=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),s=[],l=e.id;if(r.promoteId?l=e.properties[r.promoteId]:r.generateId&&(l=n||0),o==="Point")Ry(i,s);else if(o==="MultiPoint")for(let u of i)Ry(u,s);else if(o==="LineString")Jl(i,s,a,!1);else if(o==="MultiLineString")if(r.lineMetrics){for(let u of i)s=[],Jl(u,s,a,!1),t.push(dt(l,"LineString",s,e.properties));return}else Zl(i,s,a,!1);else if(o==="Polygon")Zl(i,s,a,!0);else if(o==="MultiPolygon")for(let u of i){let c=[];Zl(u,c,a,!0),s.push(c)}else if(o==="GeometryCollection"){for(let u of e.geometry.geometries)ns(t,{id:l,geometry:u,properties:e.properties},r,n);return}else throw new Error("Input data is not a valid GeoJSON object.");t.push(dt(l,o,s,e.properties))}function Ry(t,e){e.push(zy(t[0]),Oy(t[1]),0)}function Jl(t,e,r,n){let i,o,a=0;for(let l=0;l<t.length;l++){let u=zy(t[l][0]),c=Oy(t[l][1]);e.push(u,c,0),l>0&&(n?a+=(i*c-u*o)/2:a+=Math.sqrt(Math.pow(u-i,2)+Math.pow(c-o,2))),i=u,o=c}let s=e.length-3;e[2]=1,Oi(e,0,s,r),e[s+2]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function Zl(t,e,r,n){for(let i=0;i<t.length;i++){let o=[];Jl(t[i],o,r,n),e.push(o)}}function zy(t){return t/360+.5}function Oy(t){let e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function Ue(t,e,r,n,i,o,a,s){if(r/=e,n/=e,o>=r&&a<n)return t;if(a<r||o>=n)return null;let l=[];for(let u of t){let c=u.geometry,p=u.type,f=i===0?u.minX:u.minY,y=i===0?u.maxX:u.maxY;if(f>=r&&y<n){l.push(u);continue}else if(y<r||f>=n)continue;let m=[];if(p==="Point"||p==="MultiPoint")u0(c,m,r,n,i);else if(p==="LineString")Ny(c,m,r,n,i,!1,s.lineMetrics);else if(p==="MultiLineString")Kl(c,m,r,n,i,!1);else if(p==="Polygon")Kl(c,m,r,n,i,!0);else if(p==="MultiPolygon")for(let h of c){let g=[];Kl(h,g,r,n,i,!0),g.length&&m.push(g)}if(m.length){if(s.lineMetrics&&p==="LineString"){for(let h of m)l.push(dt(u.id,p,h,u.tags));continue}(p==="LineString"||p==="MultiLineString")&&(m.length===1?(p="LineString",m=m[0]):p="MultiLineString"),(p==="Point"||p==="MultiPoint")&&(p=m.length===3?"Point":"MultiPoint"),l.push(dt(u.id,p,m,u.tags))}}return l.length?l:null}function u0(t,e,r,n,i){for(let o=0;o<t.length;o+=3){let a=t[o+i];a>=r&&a<=n&&Hr(e,t[o],t[o+1],t[o+2])}}function Ny(t,e,r,n,i,o,a){let s=Gy(t),l=i===0?c0:p0,u=t.start,c,p;for(let d=0;d<t.length-3;d+=3){let b=t[d],x=t[d+1],v=t[d+2],S=t[d+3],A=t[d+4],w=i===0?b:x,T=i===0?S:A,E=!1;a&&(c=Math.sqrt(Math.pow(b-S,2)+Math.pow(x-A,2))),w<r?T>r&&(p=l(s,b,x,S,A,r),a&&(s.start=u+c*p)):w>n?T<n&&(p=l(s,b,x,S,A,n),a&&(s.start=u+c*p)):Hr(s,b,x,v),T<r&&w>=r&&(p=l(s,b,x,S,A,r),E=!0),T>n&&w<=n&&(p=l(s,b,x,S,A,n),E=!0),!o&&E&&(a&&(s.end=u+c*p),e.push(s),s=Gy(t)),a&&(u+=c)}let f=t.length-3,y=t[f],m=t[f+1],h=t[f+2],g=i===0?y:m;g>=r&&g<=n&&Hr(s,y,m,h),f=s.length-3,o&&f>=3&&(s[f]!==s[0]||s[f+1]!==s[1])&&Hr(s,s[0],s[1],s[2]),s.length&&e.push(s)}function Gy(t){let e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function Kl(t,e,r,n,i,o){for(let a of t)Ny(a,e,r,n,i,o,!1)}function Hr(t,e,r,n){t.push(e,r,n)}function c0(t,e,r,n,i,o){let a=(o-e)/(n-e);return Hr(t,o,r+(i-r)*a,1),a}function p0(t,e,r,n,i,o){let a=(o-r)/(i-r);return Hr(t,e+(n-e)*a,o,1),a}function eu(t,e){let r=e.buffer/e.extent,n=t,i=Ue(t,1,-1-r,r,0,-1,2,e),o=Ue(t,1,1-r,2+r,0,-1,2,e);return(i||o)&&(n=Ue(t,1,-r,1+r,0,-1,2,e)||[],i&&(n=Uy(i,1).concat(n)),o&&(n=n.concat(Uy(o,-1)))),n}function Uy(t,e){let r=[];for(let n=0;n<t.length;n++){let i=t[n],o=i.type,a;if(o==="Point"||o==="MultiPoint"||o==="LineString")a=Ql(i.geometry,e);else if(o==="MultiLineString"||o==="Polygon"){a=[];for(let s of i.geometry)a.push(Ql(s,e))}else if(o==="MultiPolygon"){a=[];for(let s of i.geometry){let l=[];for(let u of s)l.push(Ql(u,e));a.push(l)}}r.push(dt(i.id,o,a,i.tags))}return r}function Ql(t,e){let r=[];r.size=t.size,t.start!==void 0&&(r.start=t.start,r.end=t.end);for(let n=0;n<t.length;n+=3)r.push(t[n]+e,t[n+1],t[n+2]);return r}function is(t,e){if(t.transformed)return t;let r=1<<t.z,n=t.x,i=t.y;for(let o of t.features){let a=o.geometry,s=o.type;if(o.geometry=[],s===1)for(let l=0;l<a.length;l+=2)o.geometry.push($y(a[l],a[l+1],e,r,n,i));else for(let l=0;l<a.length;l++){let u=[];for(let c=0;c<a[l].length;c+=2)u.push($y(a[l][c],a[l][c+1],e,r,n,i));o.geometry.push(u)}}return t.transformed=!0,t}function $y(t,e,r,n,i,o){return[Math.round(r*(t*n-i)),Math.round(r*(e*n-o))]}function ru(t,e,r,n,i){let o=e===i.maxZoom?0:i.tolerance/((1<<e)*i.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:t.length,source:null,x:r,y:n,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(let s of t)f0(a,s,o,i);return a}function f0(t,e,r,n){let i=e.geometry,o=e.type,a=[];if(t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),o==="Point"||o==="MultiPoint")for(let s=0;s<i.length;s+=3)a.push(i[s],i[s+1]),t.numPoints++,t.numSimplified++;else if(o==="LineString")tu(a,i,t,r,!1,!1);else if(o==="MultiLineString"||o==="Polygon")for(let s=0;s<i.length;s++)tu(a,i[s],t,r,o==="Polygon",s===0);else if(o==="MultiPolygon")for(let s=0;s<i.length;s++){let l=i[s];for(let u=0;u<l.length;u++)tu(a,l[u],t,r,!0,u===0)}if(a.length){let s=e.tags||null;if(o==="LineString"&&n.lineMetrics){s={};for(let u in e.tags)s[u]=e.tags[u];s.mapbox_clip_start=i.start/i.size,s.mapbox_clip_end=i.end/i.size}let l={geometry:a,type:o==="Polygon"||o==="MultiPolygon"?3:o==="LineString"||o==="MultiLineString"?2:1,tags:s};e.id!==null&&(l.id=e.id),t.features.push(l)}}function tu(t,e,r,n,i,o){let a=n*n;if(n>0&&e.size<(i?a:n)){r.numPoints+=e.length/3;return}let s=[];for(let l=0;l<e.length;l+=3)(n===0||e[l+2]>a)&&(r.numSimplified++,s.push(e[l],e[l+1])),r.numPoints++;i&&y0(s,o),t.push(s)}function y0(t,e){let r=0;for(let n=0,i=t.length,o=i-2;n<i;o=n,n+=2)r+=(t[n]-t[o])*(t[n+1]+t[o+1]);if(r>0===e)for(let n=0,i=t.length;n<i/2;n+=2){let o=t[n],a=t[n+1];t[n]=t[i-2-n],t[n+1]=t[i-1-n],t[i-2-n]=o,t[i-1-n]=a}}var m0={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},iu=class{constructor(e,r){r=this.options=h0(Object.create(m0),r);let n=r.debug;if(n&&console.time("preprocess data"),r.maxZoom<0||r.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(r.promoteId&&r.generateId)throw new Error("promoteId and generateId cannot be used together.");let i=Yl(e,r);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",r.indexMaxZoom,r.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),i=eu(i,r),i.length&&this.splitTile(i,0,0,0),n&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(e,r,n,i,o,a,s){let l=[e,r,n,i],u=this.options,c=u.debug;for(;l.length;){i=l.pop(),n=l.pop(),r=l.pop(),e=l.pop();let p=1<<r,f=nu(r,n,i),y=this.tiles[f];if(!y&&(c>1&&console.time("creation"),y=this.tiles[f]=ru(e,r,n,i,u),this.tileCoords.push({z:r,x:n,y:i}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",r,n,i,y.numFeatures,y.numPoints,y.numSimplified),console.timeEnd("creation"));let T="z".concat(r);this.stats[T]=(this.stats[T]||0)+1,this.total++}if(y.source=e,o==null){if(r===u.indexMaxZoom||y.numPoints<=u.indexMaxPoints)continue}else{if(r===u.maxZoom||r===o)continue;if(o!=null){let T=o-r;if(n!==a>>T||i!==s>>T)continue}}if(y.source=null,e.length===0)continue;c>1&&console.time("clipping");let m=.5*u.buffer/u.extent,h=.5-m,g=.5+m,d=1+m,b=null,x=null,v=null,S=null,A=Ue(e,p,n-m,n+g,0,y.minX,y.maxX,u),w=Ue(e,p,n+h,n+d,0,y.minX,y.maxX,u);e=null,A&&(b=Ue(A,p,i-m,i+g,1,y.minY,y.maxY,u),x=Ue(A,p,i+h,i+d,1,y.minY,y.maxY,u),A=null),w&&(v=Ue(w,p,i-m,i+g,1,y.minY,y.maxY,u),S=Ue(w,p,i+h,i+d,1,y.minY,y.maxY,u),w=null),c>1&&console.timeEnd("clipping"),l.push(b||[],r+1,n*2,i*2),l.push(x||[],r+1,n*2,i*2+1),l.push(v||[],r+1,n*2+1,i*2),l.push(S||[],r+1,n*2+1,i*2+1)}}getTile(e,r,n){e=+e,r=+r,n=+n;let i=this.options,{extent:o,debug:a}=i;if(e<0||e>24)return null;let s=1<<e;r=r+s&s-1;let l=nu(e,r,n);if(this.tiles[l])return is(this.tiles[l],o);a>1&&console.log("drilling down to z%d-%d-%d",e,r,n);let u=e,c=r,p=n,f;for(;!f&&u>0;)u--,c=c>>1,p=p>>1,f=this.tiles[nu(u,c,p)];return!f||!f.source?null:(a>1&&(console.log("found parent tile z%d-%d-%d",u,c,p),console.time("drilling down")),this.splitTile(f.source,u,c,p,e,r,n),a>1&&console.timeEnd("drilling down"),this.tiles[l]?is(this.tiles[l],o):null)}};function nu(t,e,r){return((1<<t)*r+e)*32+t}function h0(t,e){for(let r in e)t[r]=e[r];return t}function ou(t,e){return new iu(t,e)}function Gi(t,e){return e?t.properties[e]:t.id}function au(t,e){if(t==null)return!0;if(t.type==="Feature")return Gi(t,e)!=null;if(t.type==="FeatureCollection"){let r=new Set;for(let n of t.features){let i=Gi(n,e);if(i==null||r.has(i))return!1;r.add(i)}return!0}return!1}function su(t,e){let r=new Map;if(t!=null)if(t.type==="Feature")r.set(Gi(t,e),t);else for(let n of t.features)r.set(Gi(n,e),n);return r}function jy(t,e,r){var n,i,o,a;if(e.removeAll&&t.clear(),e.remove)for(let s of e.remove)t.delete(s);if(e.add)for(let s of e.add){let l=Gi(s,r);l!=null&&t.set(l,s)}if(e.update)for(let s of e.update){let l=t.get(s.id);if(l==null)continue;let u=s.newGeometry||s.removeAllProperties,c=!s.removeAllProperties&&(((n=s.removeProperties)==null?void 0:n.length)>0||((i=s.addOrUpdateProperties)==null?void 0:i.length)>0);if((u||c)&&(l=$t({},l),t.set(s.id,l),c&&(l.properties=$t({},l.properties))),s.newGeometry&&(l.geometry=s.newGeometry),s.removeAllProperties)l.properties={};else if(((o=s.removeProperties)==null?void 0:o.length)>0)for(let p of s.removeProperties)Object.prototype.hasOwnProperty.call(l.properties,p)&&delete l.properties[p];if(((a=s.addOrUpdateProperties)==null?void 0:a.length)>0)for(let{key:p,value:f}of s.addOrUpdateProperties)l.properties[p]=f}}var os=class extends Xr{constructor(){super(...arguments);this._dataUpdateable=new Map}async loadVectorTile(r,n){let i=r.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");let o=this._geoJSONIndex.getTile(i.z,i.x,i.y);if(!o)return null;let a=new Ka(o.features),s=(0,Wy.default)(a);return(s.byteOffset!==0||s.byteLength!==s.buffer.byteLength)&&(s=new Uint8Array(s)),{vectorTile:a,rawData:s.buffer}}async loadData(r){var i;(i=this._pendingRequest)==null||i.abort();let n=r&&r.request&&r.request.collectResourceTiming?new Wr(r.request):!1;this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(r,this._pendingRequest),this._geoJSONIndex=r.cluster?new zi(d0(r)).load((await this._pendingData).features):ou(await this._pendingData,r.geojsonVtOptions),this.loaded={};let o={};if(n){let a=n.finish();a&&(o.resourceTiming={},o.resourceTiming[r.source]=JSON.parse(JSON.stringify(a)))}return o}catch(o){if(delete this._pendingRequest,zc(o))return{abandoned:!0};throw o}}async getData(){return this._pendingData}reloadTile(r){let n=this.loaded,i=r.uid;return n&&n[i]?super.reloadTile(r):this.loadTile(r)}async loadAndProcessGeoJSON(r,n){let i=await this.loadGeoJSON(r,n);if(delete this._pendingRequest,typeof i!="object")throw new Error("Input data given to '".concat(r.source,"' is not a valid GeoJSON object."));if((0,qy.default)(i,!0),r.filter){let o=er(r.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(o.result==="error")throw new Error(o.value.map(s=>"".concat(s.key,": ").concat(s.message)).join(", "));i={type:"FeatureCollection",features:i.features.filter(s=>o.value.evaluate({zoom:0},s))}}return i}async loadGeoJSON(r,n){let{promoteId:i}=r;if(r.request){let o=await Wc(r.request,n);return this._dataUpdateable=au(o.data,i)?su(o.data,i):void 0,o.data}if(typeof r.data=="string")try{let o=JSON.parse(r.data);return this._dataUpdateable=au(o,i)?su(o,i):void 0,o}catch(o){throw new Error("Input data given to '".concat(r.source,"' is not a valid GeoJSON object."))}if(!r.dataDiff)throw new Error("Input data given to '".concat(r.source,"' is not a valid GeoJSON object."));if(!this._dataUpdateable)throw new Error("Cannot update existing geojson data in ".concat(r.source));return jy(this._dataUpdateable,r.dataDiff,i),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}async removeSource(r){this._pendingRequest&&this._pendingRequest.abort()}getClusterExpansionZoom(r){return this._geoJSONIndex.getClusterExpansionZoom(r.clusterId)}getClusterChildren(r){return this._geoJSONIndex.getChildren(r.clusterId)}getClusterLeaves(r){return this._geoJSONIndex.getLeaves(r.clusterId,r.limit,r.offset)}};function d0({superclusterOptions:t,clusterProperties:e}){if(!e||!t)return t;let r={},n={},i={accumulated:null,zoom:0},o={properties:null},a=Object.keys(e);for(let s of a){let[l,u]=e[s],c=er(u),p=er(typeof l=="string"?[l,["accumulated"],["get",s]]:l);r[s]=c.value,n[s]=p.value}return t.map=s=>{o.properties=s;let l={};for(let u of a)l[u]=r[u].evaluate(i,o);return l},t.reduce=(s,l)=>{o.properties=l;for(let u of a)i.accumulated=s[u],s[u]=n[u].evaluate(i,o)},t}var as=class{constructor(e){this.self=e,this.actor=new Eo(e),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(r,n)=>{if(this.externalWorkerSourceTypes[r])throw new Error('Worker source with name "'.concat(r,'" already registered.'));this.externalWorkerSourceTypes[r]=n},this.self.addProtocol=Gc,this.self.removeProtocol=Nc,this.self.registerRTLTextPlugin=r=>{we.setMethods(r)},this.actor.registerMessageHandler("LDT",(r,n)=>this._getDEMWorkerSource(r,n.source).loadTile(n)),this.actor.registerMessageHandler("RDT",async(r,n)=>{this._getDEMWorkerSource(r,n.source).removeTile(n)}),this.actor.registerMessageHandler("GCEZ",async(r,n)=>this._getWorkerSource(r,n.type,n.source).getClusterExpansionZoom(n)),this.actor.registerMessageHandler("GCC",async(r,n)=>this._getWorkerSource(r,n.type,n.source).getClusterChildren(n)),this.actor.registerMessageHandler("GCL",async(r,n)=>this._getWorkerSource(r,n.type,n.source).getClusterLeaves(n)),this.actor.registerMessageHandler("LD",(r,n)=>this._getWorkerSource(r,n.type,n.source).loadData(n)),this.actor.registerMessageHandler("GD",(r,n)=>this._getWorkerSource(r,n.type,n.source).getData()),this.actor.registerMessageHandler("LT",(r,n)=>this._getWorkerSource(r,n.type,n.source).loadTile(n)),this.actor.registerMessageHandler("RT",(r,n)=>this._getWorkerSource(r,n.type,n.source).reloadTile(n)),this.actor.registerMessageHandler("AT",(r,n)=>this._getWorkerSource(r,n.type,n.source).abortTile(n)),this.actor.registerMessageHandler("RMT",(r,n)=>this._getWorkerSource(r,n.type,n.source).removeTile(n)),this.actor.registerMessageHandler("RS",async(r,n)=>{if(!this.workerSources[r]||!this.workerSources[r][n.type]||!this.workerSources[r][n.type][n.source])return;let i=this.workerSources[r][n.type][n.source];delete this.workerSources[r][n.type][n.source],i.removeSource!==void 0&&i.removeSource(n)}),this.actor.registerMessageHandler("RM",async r=>{delete this.layerIndexes[r],delete this.availableImages[r],delete this.workerSources[r],delete this.demWorkerSources[r]}),this.actor.registerMessageHandler("SR",async(r,n)=>{this.referrer=n}),this.actor.registerMessageHandler("SRPS",(r,n)=>this._syncRTLPluginState(r,n)),this.actor.registerMessageHandler("IS",async(r,n)=>{this.self.importScripts(n)}),this.actor.registerMessageHandler("SI",(r,n)=>this._setImages(r,n)),this.actor.registerMessageHandler("UL",async(r,n)=>{this._getLayerIndex(r).update(n.layers,n.removedIds)}),this.actor.registerMessageHandler("SL",async(r,n)=>{this._getLayerIndex(r).replace(n)})}async _setImages(e,r){this.availableImages[e]=r;for(let n in this.workerSources[e]){let i=this.workerSources[e][n];for(let o in i)i[o].availableImages=r}}async _syncRTLPluginState(e,r){return await we.syncState(r,this.self.importScripts)}_getAvailableImages(e){let r=this.availableImages[e];return r||(r=[]),r}_getLayerIndex(e){let r=this.layerIndexes[e];return r||(r=this.layerIndexes[e]=new Na),r}_getWorkerSource(e,r,n){if(this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][r]||(this.workerSources[e][r]={}),!this.workerSources[e][r][n]){let i={sendAsync:(o,a)=>(o.targetMapId=e,this.actor.sendAsync(o,a))};switch(r){case"vector":this.workerSources[e][r][n]=new Xr(i,this._getLayerIndex(e),this._getAvailableImages(e));break;case"geojson":this.workerSources[e][r][n]=new os(i,this._getLayerIndex(e),this._getAvailableImages(e));break;default:this.workerSources[e][r][n]=new this.externalWorkerSourceTypes[r](i,this._getLayerIndex(e),this._getAvailableImages(e));break}}return this.workerSources[e][r][n]}_getDEMWorkerSource(e,r){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][r]||(this.demWorkerSources[e][r]=new Ja),this.demWorkerSources[e][r]}};at(self)&&(self.worker=new as(self));})();
/*! Bundled license information:

ieee754/index.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)
*/
`,H4e=()=>URL.createObjectURL(new Blob([W4e],{type:"text/javascript"}));function X4e(){return new Worker(H4e())}var q4e="maplibre_preloaded_worker_pool",ZH=class WH{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<WH.workerCount;)this.workers.push(X4e());return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(r=>{r.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[q4e]}numActive(){return Object.keys(this.active).length}},Y4e=Math.floor(Dr.hardwareConcurrency/2);ZH.workerCount=y1e(globalThis)?Math.max(Math.min(Y4e,3),1):1;var zE;function HH(){return zE||(zE=new ZH),zE}var XH=class{constructor(e,r){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=r;let n=this.workerPool.acquire(r);for(let i=0;i<n.length;i++){let a=n[i],o=new Z4e(a,r);o.name="Worker ".concat(i),this.actors.push(o)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,r){let n=[];for(let i of this.actors)n.push(i.sendAsync({type:e,data:r}));return Promise.all(n)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(r=>{r.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,r){for(let n of this.actors)n.registerMessageHandler(e,r)}},Hx;function J4e(){return Hx||(Hx=new XH(HH(),WC),Hx.registerMessageHandler("GR",(t,e,r)=>KA(e,r))),Hx}C();function K4e(t,e){let r=Xe.create();return Xe.translate(r,r,[1,1,0]),Xe.scale(r,r,[t.width*.5,t.height*.5,1]),t.calculatePosMatrix?Xe.multiply(r,r,t.calculatePosMatrix(e.toUnwrapped())):r}function Q4e(t,e,r){if(t)for(let n of t){let i=e[n];if(i&&i.source===r&&i.type==="fill-extrusion")return!0}else for(let n in e){let i=e[n];if(i.source===r&&i.type==="fill-extrusion")return!0}return!1}function eAe(t,e,r,n,i,a,o){var s;let l=Q4e((s=i?.layers)!=null?s:null,e,t.id),u=a.maxPitchScaleFactor(),c=t.tilesIn(n,u,l);c.sort(qH);let h=[];for(let p of c)h.push({wrappedTileID:p.tileID.wrapped().key,queryResults:p.tile.queryRenderedFeatures(e,r,t._state,p.queryGeometry,p.cameraQueryGeometry,p.scale,i,a,u,K4e(t.transform,p.tileID),o?(m,y)=>o(p.tileID,m,y):void 0)});let d=nAe(h);return iAe(d,t)}function tAe(t,e,r,n,i,a,o){let s={},l=a.queryRenderedSymbols(n),u=[];for(let c of Object.keys(l).map(Number))u.push(o[c]);u.sort(qH);for(let c of u){let h=c.featureIndex.lookupSymbolFeatures(l[c.bucketInstanceId],e,c.bucketIndex,c.sourceLayerIndex,i.filter,i.layers,i.availableImages,t);for(let d in h){let p=s[d]=s[d]||[],m=h[d];m.sort((y,v)=>{let _=c.featureSortOrder;if(_){let w=_.indexOf(y.featureIndex);return _.indexOf(v.featureIndex)-w}else return v.featureIndex-y.featureIndex});for(let y of m)p.push(y)}}return aAe(s,t,r)}function rAe(t,e){let r=t.getRenderableIds().map(a=>t.getTileByID(a)),n=[],i={};for(let a=0;a<r.length;a++){let o=r[a],s=o.tileID.canonical.key;i[s]||(i[s]=!0,o.querySourceFeatures(n,e))}return n}function qH(t,e){let r=t.tileID,n=e.tileID;return r.overscaledZ-n.overscaledZ||r.canonical.y-n.canonical.y||r.wrap-n.wrap||r.canonical.x-n.canonical.x}function nAe(t){let e={},r={};for(let n of t){let i=n.queryResults,a=n.wrappedTileID,o=r[a]=r[a]||{};for(let s in i){let l=i[s],u=o[s]=o[s]||{},c=e[s]=e[s]||[];for(let h of l)u[h.featureIndex]||(u[h.featureIndex]=!0,c.push(h))}}return e}function iAe(t,e){for(let r in t)for(let n of t[r])YH(n,e);return t}function aAe(t,e,r){for(let n in t)for(let i of t[n]){let a=e[n],o=r[a.source];YH(i,o)}return t}function YH(t,e){let r=t.feature,n=e.getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=n}C();C();C();C();async function JH(t,e,r){let n=t;if(t.url?n=(await QA(e.transformRequest(t.url,"Source"),r)).data:await Dr.frameAsync(r),!n)return null;let i=r_(zt(n,t),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in n&&n.vector_layers&&(i.vectorLayerIds=n.vector_layers.map(a=>a.id)),i}C();C();C();var mu=63710088e-1,ar=class Uy{constructor(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid LngLat object: (".concat(e,", ").concat(r,")"));if(this.lng=+e,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Uy(Mp(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}distanceTo(e){let r=Math.PI/180,n=this.lat*r,i=e.lat*r,a=Math.sin(n)*Math.sin(i)+Math.cos(n)*Math.cos(i)*Math.cos((e.lng-this.lng)*r);return mu*Math.acos(Math.min(a,1))}static convert(e){if(e instanceof Uy)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Uy(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Uy(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}},Vc=class wh{constructor(e,r){e&&(r?this.setSouthWest(e).setNorthEast(r):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof ar?new ar(e.lng,e.lat):ar.convert(e),this}setSouthWest(e){return this._sw=e instanceof ar?new ar(e.lng,e.lat):ar.convert(e),this}extend(e){let r=this._sw,n=this._ne,i,a;if(e instanceof ar)i=e,a=e;else if(e instanceof wh){if(i=e._sw,a=e._ne,!i||!a)return this}else{if(Array.isArray(e))if(e.length===4||e.every(Array.isArray)){let o=e;return this.extend(wh.convert(o))}else{let o=e;return this.extend(ar.convert(o))}else if(e&&("lng"in e||"lon"in e)&&"lat"in e)return this.extend(ar.convert(e));return this}return!r&&!n?(this._sw=new ar(i.lng,i.lat),this._ne=new ar(a.lng,a.lat)):(r.lng=Math.min(i.lng,r.lng),r.lat=Math.min(i.lat,r.lat),n.lng=Math.max(a.lng,n.lng),n.lat=Math.max(a.lat,n.lat)),this}getCenter(){return new ar((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new ar(this.getWest(),this.getNorth())}getSouthEast(){return new ar(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return"LngLatBounds(".concat(this._sw.toString(),", ").concat(this._ne.toString(),")")}isEmpty(){return!(this._sw&&this._ne)}contains(e){let{lng:r,lat:n}=ar.convert(e),i=this._sw.lat<=n&&n<=this._ne.lat,a=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(a=this._sw.lng>=r&&r>=this._ne.lng),i&&a}static convert(e){return e instanceof wh||!e?e:new wh(e)}static fromLngLat(e,r=0){let n=360*r/40075017,i=n/Math.cos(Math.PI/180*e.lat);return new wh(new ar(e.lng-i,e.lat-n),new ar(e.lng+i,e.lat+n))}adjustAntiMeridian(){let e=new ar(this._sw.lng,this._sw.lat),r=new ar(this._ne.lng,this._ne.lat);return e.lng>r.lng?new wh(e,new ar(r.lng+360,r.lat)):new wh(e,r)}};C();var KH=2*Math.PI*mu;function QH(t){return KH*Math.cos(t*Math.PI/180)}function Ng(t){return(180+t)/360}function jp(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Dp(t,e){return t/QH(e)}function oAe(t){return t*360-180}function AM(t){let e=180-t*360;return 360/Math.PI*Math.atan(Math.exp(e*Math.PI/180))-90}function SM(t,e){return t*QH(AM(e))}function sAe(t){return 1/Math.cos(t*Math.PI/180)}var Mn=class eX{constructor(e,r,n=0){this.x=+e,this.y=+r,this.z=+n}static fromLngLat(e,r=0){let n=ar.convert(e);return new eX(Ng(n.lng),jp(n.lat),Dp(r,n.lat))}toLngLat(){return new ar(oAe(this.x),AM(this.y))}toAltitude(){return SM(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/KH*sAe(AM(this.y))}},tX=class{constructor(t,e,r){this.bounds=Vc.convert(this.validateBounds(t)),this.minzoom=e||0,this.maxzoom=r||24}validateBounds(t){return!Array.isArray(t)||t.length!==4?[-180,-90,180,90]:[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]}contains(t){let e=Math.pow(2,t.z),r={minX:Math.floor(Ng(this.bounds.getWest())*e),minY:Math.floor(jp(this.bounds.getNorth())*e),maxX:Math.ceil(Ng(this.bounds.getEast())*e),maxY:Math.ceil(jp(this.bounds.getSouth())*e)};return t.x>=r.minX&&t.x<r.maxX&&t.y>=r.minY&&t.y<r.maxY}},lAe=class extends Xo{constructor(e,r,n,i){if(super(),this.id=e,this.dispatcher=n,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,zt(this,r_(r,["url","scheme","tileSize","promoteId"])),this._options=zt({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(i)}async load(){this._loaded=!1,this.fire(new ht("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let e=await JH(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(zt(this,e),e.bounds&&(this.tileBounds=new tX(e.bounds,this.minzoom,this.maxzoom)),this.fire(new ht("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new ht("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new Jt(e))}}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return zt({},this._options)}async loadTile(e){let r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),n={request:this.map._requestManager.transformRequest(r,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};n.request.collectResourceTiming=this._collectResourceTiming;let i="RT";if(!e.actor||e.state==="expired")e.actor=this.dispatcher.getActor(),i="LT";else if(e.state==="loading")return new Promise((a,o)=>{e.reloadPromise={resolve:a,reject:o}});e.abortController=new AbortController;try{let a=await e.actor.sendAsync({type:i,data:n},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,a)}catch(a){if(delete e.abortController,e.aborted)return;if(a&&a.status!==404)throw a;this._afterTileLoadWorkerResponse(e,null)}}_afterTileLoadWorkerResponse(e,r){if(r&&r.resourceTiming&&(e.resourceTiming=r.resourceTiming),r&&this.map._refreshExpiredTiles&&e.setExpiryData(r),e.loadVectorData(r,this.map.painter),e.reloadPromise){let n=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(n.resolve).catch(n.reject)}}async abortTile(e){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&await e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}})}async unloadTile(e){e.unloadVectorData(),e.actor&&await e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})}hasTransition(){return!1}};C();var rX=class extends Xo{constructor(t,e,r,n){super(),this.id=t,this.dispatcher=r,this.setEventedParent(n),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=zt({type:"raster"},e),zt(this,r_(e,["url","scheme","tileSize"]))}async load(t=!1){this._loaded=!1,this.fire(new ht("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let e=await JH(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,e&&(zt(this,e),e.bounds&&(this.tileBounds=new tX(e.bounds,this.minzoom,this.maxzoom)),this.fire(new ht("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new ht("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:t})))}catch(e){this._tileJSONRequest=null,this.fire(new Jt(e))}}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load(!0)}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}serialize(){return zt({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}async loadTile(t){let e=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{let r=await Au.getImage(this.map._requestManager.transformRequest(e,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted){t.state="unloaded";return}if(r&&r.data){this.map._refreshExpiredTiles&&(r.cacheControl||r.expires)&&t.setExpiryData({cacheControl:r.cacheControl,expires:r.expires});let n=this.map.painter.context,i=n.gl,a=r.data;t.texture=this.map.painter.getTileTexture(a.width),t.texture?t.texture.update(a,{useMipmap:!0}):(t.texture=new ki(n,a,i.RGBA,{useMipmap:!0}),t.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE,i.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(r){if(delete t.abortController,t.aborted)t.state="unloaded";else if(r)throw t.state="errored",r}}async abortTile(t){t.abortController&&(t.abortController.abort(),delete t.abortController)}async unloadTile(t){t.texture&&this.map.painter.saveTileTexture(t.texture)}hasTransition(){return!1}};C();C();C();function uAe(t,e,r){e=Math.pow(2,r)-e-1;var n=RF(t*256,e*256,r),i=RF((t+1)*256,(e+1)*256,r);return n[0]+","+n[1]+","+i[0]+","+i[1]}function RF(t,e,r){var n=2*Math.PI*6378137/256/Math.pow(2,r),i=t*n-2*Math.PI*6378137/2,a=e*n-2*Math.PI*6378137/2;return[i,a]}var cAe=Zt(xr(),1);C();function hAe(t,e,r){return!(t<A5||t>YA||r<0||r>=Math.pow(2,t)||e<0||e>=Math.pow(2,t))}function dAe(t,e){let{x:r,y:n}=Mn.fromLngLat(e);return!(t<A5||t>YA||n<0||n>=1||r<0||r>=1)}var E3=class{constructor(e,r,n){if(!hAe(e,r,n))throw new Error("x=".concat(r,", y=").concat(n,", z=").concat(e," outside of bounds. 0<=x<").concat(Math.pow(2,e),", 0<=y<").concat(Math.pow(2,e)," ").concat(A5,"<=z<=").concat(YA," "));this.z=e,this.x=r,this.y=n,this.key=ag(0,e,e,r,n)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,r,n){let i=uAe(this.x,this.y,this.z),a=pAe(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(n==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,a).replace(/{bbox-epsg-3857}/g,i)}isChildOf(e){let r=this.z-e.z;return r>0&&e.x===this.x>>r&&e.y===this.y>>r}getTilePoint(e){let r=Math.pow(2,this.z);return new cAe.default((e.x*r-this.x)*8192,(e.y*r-this.y)*8192)}toString(){return"".concat(this.z,"/").concat(this.x,"/").concat(this.y)}},D4=class{constructor(t,e){this.wrap=t,this.canonical=e,this.key=ag(t,e.z,e.z,e.x,e.y)}},Ga=class ul{constructor(e,r,n,i,a){if(this.terrainRttPosMatrix32f=null,e<n)throw new Error("overscaledZ should be >= z; overscaledZ = ".concat(e,"; z = ").concat(n));this.overscaledZ=e,this.wrap=r,this.canonical=new E3(n,+i,+a),this.key=ag(r,e,n,i,a)}clone(){return new ul(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error("targetZ > this.overscaledZ; targetZ = ".concat(e,"; overscaledZ = ").concat(this.overscaledZ));let r=this.canonical.z-e;return e>this.canonical.z?new ul(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ul(e,this.wrap,e,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(e,r){if(e>this.overscaledZ)throw new Error("targetZ > this.overscaledZ; targetZ = ".concat(e,"; overscaledZ = ").concat(this.overscaledZ));let n=this.canonical.z-e;return e>this.canonical.z?ag(this.wrap*+r,e,this.canonical.z,this.canonical.x,this.canonical.y):ag(this.wrap*+r,e,e,this.canonical.x>>n,this.canonical.y>>n)}isChildOf(e){if(e.wrap!==this.wrap)return!1;let r=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>r&&e.canonical.y===this.canonical.y>>r}children(e){if(this.overscaledZ>=e)return[new ul(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let r=this.canonical.z+1,n=this.canonical.x*2,i=this.canonical.y*2;return[new ul(r,this.wrap,r,n,i),new ul(r,this.wrap,r,n+1,i),new ul(r,this.wrap,r,n,i+1),new ul(r,this.wrap,r,n+1,i+1)]}isLessThan(e){return this.wrap<e.wrap?!0:this.wrap>e.wrap?!1:this.overscaledZ<e.overscaledZ?!0:this.overscaledZ>e.overscaledZ?!1:this.canonical.x<e.canonical.x?!0:this.canonical.x>e.canonical.x?!1:this.canonical.y<e.canonical.y}wrapped(){return new ul(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new ul(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new D4(this.wrap,this.canonical)}toString(){return"".concat(this.overscaledZ,"/").concat(this.canonical.x,"/").concat(this.canonical.y)}getTilePoint(e){return this.canonical.getTilePoint(new Mn(e.x-this.wrap,e.y))}};function ag(t,e,r,n,i){t*=2,t<0&&(t=t*-1-1);let a=1<<r;return(a*a*t+a*i+n).toString(36)+r.toString(36)+e.toString(36)}function pAe(t,e,r){let n="",i;for(let a=t;a>0;a--)i=1<<a-1,n+=(e&i?1:0)+(r&i?2:0);return n}Mt("CanonicalTileID",E3);Mt("OverscaledTileID",Ga,{omit:["terrainRttPosMatrix32f"]});var fAe=class extends rX{constructor(e,r,n,i){super(e,r,n,i),this.type="raster-dem",this.maxzoom=22,this._options=zt({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox",this.redFactor=r.redFactor,this.greenFactor=r.greenFactor,this.blueFactor=r.blueFactor,this.baseShift=r.baseShift}async loadTile(e){let r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),n=this.map._requestManager.transformRequest(r,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{let i=await Au.getImage(n,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted){e.state="unloaded";return}if(i&&i.data){let a=i.data;this.map._refreshExpiredTiles&&(i.cacheControl||i.expires)&&e.setExpiryData({cacheControl:i.cacheControl,expires:i.expires});let o=Lc(a)&&TG()?a:await this.readImageNow(a),s={type:this.type,uid:e.uid,source:this.id,rawImageData:o,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();let l=await e.actor.sendAsync({type:"LDT",data:s});e.dem=l,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(i){if(delete e.abortController,e.aborted)e.state="unloaded";else if(i)throw e.state="errored",i}}async readImageNow(e){if(typeof VideoFrame<"u"&&age()){let r=e.width+2,n=e.height+2;try{return new ti({width:r,height:n},await b1e(e,-1,-1,r,n))}catch{}}return Dr.getImageData(e,1)}_getNeighboringTiles(e){let r=e.canonical,n=Math.pow(2,r.z),i=(r.x-1+n)%n,a=r.x===0?e.wrap-1:e.wrap,o=(r.x+1+n)%n,s=r.x+1===n?e.wrap+1:e.wrap,l={};return l[new Ga(e.overscaledZ,a,r.z,i,r.y).key]={backfilled:!1},l[new Ga(e.overscaledZ,s,r.z,o,r.y).key]={backfilled:!1},r.y>0&&(l[new Ga(e.overscaledZ,a,r.z,i,r.y-1).key]={backfilled:!1},l[new Ga(e.overscaledZ,e.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},l[new Ga(e.overscaledZ,s,r.z,o,r.y-1).key]={backfilled:!1}),r.y+1<n&&(l[new Ga(e.overscaledZ,a,r.z,i,r.y+1).key]={backfilled:!1},l[new Ga(e.overscaledZ,e.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},l[new Ga(e.overscaledZ,s,r.z,o,r.y+1).key]={backfilled:!1}),l}async unloadTile(e){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&await e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}})}};C();var mAe=class extends Xo{constructor(e,r,n,i){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=n.getActor(),this.setEventedParent(i),this._data=r.data,this._options=zt({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId,r.clusterMaxZoom!==void 0&&this.maxzoom<=r.clusterMaxZoom&&Ui('The maxzoom value "'.concat(this.maxzoom,'" is expected to be greater than the clusterMaxZoom value "').concat(r.clusterMaxZoom,'".')),this.workerOptions=zt({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(r.buffer!==void 0?r.buffer:128),tolerance:this._pixelsToTileUnits(r.tolerance!==void 0?r.tolerance:.375),extent:8192,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(r.clusterMaxZoom),minPoints:Math.max(2,r.clusterMinPoints||2),extent:8192,radius:this._pixelsToTileUnits(r.clusterRadius||50),log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(8192/this.tileSize)}_getClusterMaxZoom(e){let r=e?Math.round(e):this.maxzoom-1;return Number.isInteger(e)||e===void 0||Ui(`Integer expected for option 'clusterMaxZoom': provided value "`.concat(e,'" rounded to "').concat(r,'"')),r}async load(){await this._updateWorkerData()}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}async getData(){let e=zt({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})}getCoordinatesFromGeometry(e){return e.type==="GeometryCollection"?e.geometries.map(r=>r.coordinates).flat(1/0):e.coordinates.flat(1/0)}async getBounds(){let e=new Vc,r=await this.getData(),n;switch(r.type){case"FeatureCollection":n=r.features.map(i=>this.getCoordinatesFromGeometry(i.geometry)).flat(1/0);break;case"Feature":n=this.getCoordinatesFromGeometry(r.geometry);break;default:n=this.getCoordinatesFromGeometry(r);break}if(n.length==0)return e;for(let i=0;i<n.length-1;i+=2)e.extend([n[i],n[i+1]]);return e}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(e.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,r,n){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:r,offset:n}})}async _updateWorkerData(e){let r=zt({type:this.type},this.workerOptions);e?r.dataDiff=e:typeof this._data=="string"?(r.request=this.map._requestManager.transformRequest(Dr.resolveURL(this._data),"Source"),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new ht("dataloading",{dataType:"source"}));try{let n=await this.actor.sendAsync({type:"LD",data:r});if(this._pendingLoads--,this._removed||n.abandoned){this.fire(new ht("dataabort",{dataType:"source"}));return}let i=null;n.resourceTiming&&n.resourceTiming[this.id]&&(i=n.resourceTiming[this.id].slice(0));let a={dataType:"source"};this._collectResourceTiming&&i&&i.length>0&&zt(a,{resourceTiming:i}),this.fire(new ht("data",lt(ae({},a),{sourceDataType:"metadata"}))),this.fire(new ht("data",lt(ae({},a),{sourceDataType:"content"})))}catch(n){if(this._pendingLoads--,this._removed){this.fire(new ht("dataabort",{dataType:"source"}));return}this.fire(new Jt(n))}}loaded(){return this._pendingLoads===0}async loadTile(e){let r=e.actor?"RT":"LT";e.actor=this.actor;let n={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};e.abortController=new AbortController;let i=await this.actor.sendAsync({type:r,data:n},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(i,this.map.painter,r==="RT")}async abortTile(e){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0}async unloadTile(e){e.unloadVectorData(),await this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return zt({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}};C();C();C();var Xx=Zt(xr(),1),Eu=class EM{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(e){return this.minX=Math.min(this.minX,e.x),this.minY=Math.min(this.minY,e.y),this.maxX=Math.max(this.maxX,e.x),this.maxY=Math.max(this.maxY,e.y),this}expandBy(e){return this.minX-=e,this.minY-=e,this.maxX+=e,this.maxY+=e,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(e){return this.expandBy(-e)}map(e){let r=new EM;return r.extend(e(new Xx.default(this.minX,this.minY))),r.extend(e(new Xx.default(this.maxX,this.minY))),r.extend(e(new Xx.default(this.minX,this.maxY))),r.extend(e(new Xx.default(this.maxX,this.maxY))),r}static fromPoints(e){let r=new EM;for(let n of e)r.extend(n);return r}contains(e){return e.x>=this.minX&&e.x<=this.maxX&&e.y>=this.minY&&e.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(e){return!this.empty()&&!e.empty()&&e.minX>=this.minX&&e.maxX<=this.maxX&&e.minY>=this.minY&&e.maxY<=this.maxY}intersects(e){return!this.empty()&&!e.empty()&&e.minX<=this.maxX&&e.maxX>=this.minX&&e.minY<=this.maxY&&e.maxY>=this.minY}},c_=class extends Xo{constructor(t,e,r,n){super(),this.flippedWindingOrder=!1,this.id=t,this.dispatcher=r,this.coordinates=e.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(n),this.options=e}async load(t){this._loaded=!1,this.fire(new ht("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{let e=await Au.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,e&&e.data&&(this.image=e.data,t&&(this.coordinates=t),this._finishLoading())}catch(e){this._request=null,this._loaded=!0,this.fire(new Jt(e))}}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new ht("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;let e=t.map(Mn.fromLngLat);return this.tileID=gAe(e),this.terrainTileRanges=this._getOverlappingTileRanges(e),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=e.map(r=>this.tileID.getTilePoint(r)._round()),this.flippedWindingOrder=yAe(this.tileCoords),this.fire(new ht("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;let t=this.map.painter.context,e=t.gl;this.texture||(this.texture=new ki(t,this.image,e.RGBA),this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE));let r=!1;for(let n in this.tiles){let i=this.tiles[n];i.state!=="loaded"&&(i.state="loaded",i.texture=this.texture,r=!0)}r&&this.fire(new ht("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}async loadTile(t){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(t){let{minX:e,minY:r,maxX:n,maxY:i}=Eu.fromPoints(t),a={};for(let o=0;o<=YA;o++){let s=Math.pow(2,o),l=Math.floor(e*s),u=Math.floor(r*s),c=Math.floor(n*s),h=Math.floor(i*s);a[o]={minTileX:l,minTileY:u,maxTileX:c,maxTileY:h}}return a}};function gAe(t){let e=Eu.fromPoints(t),r=e.width(),n=e.height(),i=Math.max(r,n),a=Math.max(0,Math.floor(-Math.log(i)/Math.LN2)),o=Math.pow(2,a);return new E3(a,Math.floor((e.minX+e.maxX)/2*o),Math.floor((e.minY+e.maxY)/2*o))}function yAe(t){let e=t[1].x-t[0].x,r=t[1].y-t[0].y,n=t[2].x-t[0].x,i=t[2].y-t[0].y;return e*i-r*n<0}var vAe=class extends c_{constructor(e,r,n,i){super(e,r,n,i),this.roundZoom=!0,this.type="video",this.options=r}async load(){this._loaded=!1;let e=this.options;this.urls=[];for(let r of e.urls)this.urls.push(this.map._requestManager.transformRequest(r,"Source").url);try{let r=await B1e(this.urls);if(this._loaded=!0,!r)return;this.video=r,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(r){this.fire(new Jt(r))}}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){let r=this.video.seekable;e<r.start(0)||e>r.end(0)?this.fire(new Jt(new it("sources.".concat(this.id),null,"Playback for this video can be set only between the ".concat(r.start(0)," and ").concat(r.end(0),"-second mark.")))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;let e=this.map.painter.context,r=e.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new ki(e,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let n=!1;for(let i in this.tiles){let a=this.tiles[i];a.state!=="loaded"&&(a.state="loaded",a.texture=this.texture,n=!0)}n&&this.fire(new ht("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}};C();var _Ae=class extends c_{constructor(e,r,n,i){super(e,r,n,i),r.coordinates?(!Array.isArray(r.coordinates)||r.coordinates.length!==4||r.coordinates.some(a=>!Array.isArray(a)||a.length!==2||a.some(o=>typeof o!="number")))&&this.fire(new Jt(new it("sources.".concat(e),null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new Jt(new it("sources.".concat(e),null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new Jt(new it("sources.".concat(e),null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas!="string"&&!(r.canvas instanceof HTMLCanvasElement)&&this.fire(new Jt(new it("sources.".concat(e),null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new Jt(new it("sources.".concat(e),null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate!==void 0?r.animate:!0}async load(){if(this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()){this.fire(new Jt(new Error("Canvas dimensions cannot be less than or equal to zero.")));return}this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading()}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;let r=this.map.painter.context,n=r.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ki(r,this.canvas,n.RGBA,{premultiply:!0});let i=!1;for(let a in this.tiles){let o=this.tiles[a];o.state!=="loaded"&&(o.state="loaded",o.texture=this.texture,i=!0)}i&&this.fire(new ht("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(let e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}},xAe={},bAe=(t,e,r,n)=>{let i=wAe(e.type),a=new i(t,e,r,n);if(a.id!==t)throw new Error("Expected Source id to be ".concat(t," instead of ").concat(a.id));return a},wAe=t=>{switch(t){case"geojson":return mAe;case"image":return c_;case"raster":return rX;case"raster-dem":return fAe;case"vector":return lAe;case"video":return vAe;case"canvas":return _Ae}return xAe[t]};C();C();function AAe(t,e){let r={};if(!e)return r;for(let n of t){let i=n.layerIds.map(a=>e.getLayer(a)).filter(Boolean);if(i.length!==0){n.layers=i,n.stateDependentLayerIds&&(n.stateDependentLayers=n.stateDependentLayerIds.map(a=>i.filter(o=>o.id===a)[0]));for(let a of i)r[a.id]=n}}return r}C();C();var SAe=class{constructor(e){this._stringToNumber={},this._numberToString=[];for(let r=0;r<e.length;r++){let n=e[r];this._stringToNumber[n]=r,this._numberToString[r]=n}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error("Out of bounds. Index requested n=".concat(e," can't be >= this._numberToString.length ").concat(this._numberToString.length));return this._numberToString[e]}},EAe=Zt(XA(),1),IAe=Zt(yG(),1);C();var nX=class{constructor(e,r,n,i,a){this.type="Feature",this._vectorTileFeature=e,e._z=r,e._x=n,e._y=i,this.properties=e.properties,this.id=a}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){let e={geometry:this.geometry};for(let r in this)r==="_geometry"||r==="_vectorTileFeature"||(e[r]=this[r]);return e}},CAe=class{constructor(e,r){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new aM(8192,16,0),this.grid3D=new aM(8192,16,0),this.featureIndexArray=new yH,this.promoteId=r}insert(e,r,n,i,a,o){let s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,i,a);let l=o?this.grid3D:this.grid;for(let u=0;u<r.length;u++){let c=r[u],h=[1/0,1/0,-1/0,-1/0];for(let d=0;d<c.length;d++){let p=c[d];h[0]=Math.min(h[0],p.x),h[1]=Math.min(h[1],p.y),h[2]=Math.max(h[2],p.x),h[3]=Math.max(h[3],p.y)}h[0]<8192&&h[1]<8192&&h[2]>=0&&h[3]>=0&&l.insert(s,h[0],h[1],h[2],h[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new EAe.default.VectorTile(new IAe.default(this.rawTileData)).layers,this.sourceLayerCoder=new SAe(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,r,n,i){this.loadVTLayers();let a=e.params,o=8192/e.tileSize/e.scale,s=m1(a.filter),l=e.queryGeometry,u=e.queryPadding*o,c=Eu.fromPoints(l),h=this.grid.query(c.minX-u,c.minY-u,c.maxX+u,c.maxY+u),d=Eu.fromPoints(e.cameraQueryGeometry).expandBy(u),p=this.grid3D.query(d.minX,d.minY,d.maxX,d.maxY,(v,_,w,b)=>x2e(e.cameraQueryGeometry,v-u,_-u,w+u,b+u));for(let v of p)h.push(v);h.sort(MAe);let m={},y;for(let v=0;v<h.length;v++){let _=h[v];if(_===y)continue;y=_;let w=this.featureIndexArray.get(_),b=null;this.loadMatchingFeature(m,w.bucketIndex,w.sourceLayerIndex,w.featureIndex,s,a.layers,a.availableImages,r,n,i,(A,E,M)=>(b||(b=Jp(A)),E.queryIntersectsFeature({queryGeometry:l,feature:A,featureState:M,geometry:b,zoom:this.z,transform:e.transform,pixelsToTileUnits:o,pixelPosMatrix:e.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:e.getElevation})))}return m}loadMatchingFeature(e,r,n,i,a,o,s,l,u,c,h){let d=this.bucketLayerIDs[r];if(o&&!d.some(v=>o.has(v)))return;let p=this.sourceLayerCoder.decode(n),m=this.vtLayers[p].feature(i);if(a.needGeometry){let v=Kp(m,!0);if(!a.filter(new Fi(this.tileID.overscaledZ),v,this.tileID.canonical))return}else if(!a.filter(new Fi(this.tileID.overscaledZ),m))return;let y=this.getId(m,p);for(let v=0;v<d.length;v++){let _=d[v];if(o&&!o.has(_))continue;let w=l[_];if(!w)continue;let b={};y&&c&&(b=c.getState(w.sourceLayer||"_geojsonTileLayer",y));let A=zt({},u[_]);A.paint=LF(A.paint,w.paint,m,b,s),A.layout=LF(A.layout,w.layout,m,b,s);let E=!h||h(m,w,b);if(!E)continue;let M=new nX(m,this.z,this.x,this.y,y);M.layer=A;let P=e[_];P===void 0&&(P=e[_]=[]),P.push({featureIndex:i,feature:M,intersectionZ:E})}}lookupSymbolFeatures(e,r,n,i,a,o,s,l){let u={};this.loadVTLayers();let c=m1(a);for(let h of e)this.loadMatchingFeature(u,n,i,h,c,o,s,l,r);return u}hasLayer(e){for(let r of this.bucketLayerIDs)for(let n of r)if(e===n)return!0;return!1}getId(e,r){var n;let i=e.id;if(this.promoteId){let a=typeof this.promoteId=="string"?this.promoteId:this.promoteId[r];i=e.properties[a],typeof i=="boolean"&&(i=Number(i)),i===void 0&&(n=e.properties)!=null&&n.cluster&&this.promoteId&&(i=Number(e.properties.cluster_id))}return i}};Mt("FeatureIndex",CAe,{omit:["rawTileData","sourceLayerCoder"]});function LF(t,e,r,n,i){return w5(t,(a,o)=>{let s=e instanceof g3?e.get(o):null;return s&&s.evaluate?s.evaluate(r,n,i):s})}function MAe(t,e){return e-t}C();C();var IM="RTLPluginLoaded",TAe=class extends Xo{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=J4e()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(r=>{throw this.status="error",r})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}async setRTLTextPlugin(e,r=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=Dr.resolveURL(e),!this.url)throw new Error("requested url ".concat(e," is invalid"));if(this.status==="unavailable")if(r)this.status="deferred",this._syncState(this.status);else return this._requestImport();else if(this.status==="requested")return this._requestImport()}async _requestImport(){await this._syncState("loading"),this.status="loaded",this.fire(new ht(IM))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}},FE=null;function CM(){return FE||(FE=new TAe),FE}var PAe=3e4,iX=class{constructor(e,r){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=OZ(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){let r=e+this.timeAdded;r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,r,n){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",!e){this.collisionBoxArray=new sH;return}e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=AAe(e.buckets,r?.style),this.hasSymbolBuckets=!1;for(let i in this.buckets){let a=this.buckets[i];if(a instanceof Lg)if(this.hasSymbolBuckets=!0,n)a.justReloaded=!0;else break}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(let i in this.buckets){let a=this.buckets[i];if(a instanceof Lg&&a.hasRTLText){this.hasRTLText=!0,CM().lazyLoad();break}}this.queryPadding=0;for(let i in this.buckets){let a=this.buckets[i];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(i).queryRadius(a))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}unloadVectorData(){for(let e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(let n in this.buckets){let i=this.buckets[n];i.uploadPending()&&i.upload(e)}let r=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ki(e,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ki(e,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,r,n,i,a,o,s,l,u,c,h){return!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData?{}:this.latestFeatureIndex.query({queryGeometry:i,cameraQueryGeometry:a,scale:o,tileSize:this.tileSize,pixelPosMatrix:c,transform:l,params:s,queryPadding:this.queryPadding*u,getElevation:h},e,r,n)}querySourceFeatures(e,r){let n=this.latestFeatureIndex;if(!n||!n.rawTileData)return;let i=n.loadVTLayers(),a=r&&r.sourceLayer?r.sourceLayer:"",o=i._geojsonTileLayer||i[a];if(!o)return;let s=m1(r&&r.filter),{z:l,x:u,y:c}=this.tileID.canonical,h={z:l,x:u,y:c};for(let d=0;d<o.length;d++){let p=o.feature(d);if(s.needGeometry){let v=Kp(p,!0);if(!s.filter(new Fi(this.tileID.overscaledZ),v,this.tileID.canonical))continue}else if(!s.filter(new Fi(this.tileID.overscaledZ),p))continue;let m=n.getId(p,a),y=new nX(p,l,u,c,m);y.tile=h,e.push(y)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){let r=this.expirationTime;if(e.cacheControl){let n=g1e(e.cacheControl);n["max-age"]&&(this.expirationTime=Date.now()+n["max-age"]*1e3)}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){let n=Date.now(),i=!1;if(this.expirationTime>n)i=!1;else if(!r)i=!0;else if(this.expirationTime<r)i=!0;else{let a=this.expirationTime-r;a?this.expirationTime=n+Math.max(a,PAe):i=!0}i?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,r){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;let n=this.latestFeatureIndex.loadVTLayers();for(let i in this.buckets){if(!r.style.hasLayer(i))continue;let a=this.buckets[i],o=a.layers[0].sourceLayer||"_geojsonTileLayer",s=n[o],l=e[o];if(!s||!l||Object.keys(l).length===0)continue;a.update(l,s,this.imageAtlas&&this.imageAtlas.patternPositions||{});let u=r&&r.style&&r.style.getLayer(i);u&&(this.queryPadding=Math.max(this.queryPadding,u.queryRadius(a)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Dr.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Dr.now()+e}setDependencies(e,r){let n={};for(let i of r)n[i]=!0;this.dependencies[e]=n}hasDependency(e,r){for(let n of e){let i=this.dependencies[n];if(i){for(let a of r)if(i[a])return!0}}return!1}};C();var DAe=class{constructor(e,r){this.max=e,this.onRemove=r,this.reset()}reset(){for(let e in this.data)for(let r of this.data[e])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(e,r,n){let i=e.wrapped().key;this.data[i]===void 0&&(this.data[i]=[]);let a={value:r,timeout:void 0};if(n!==void 0&&(a.timeout=setTimeout(()=>{this.remove(e,a)},n)),this.data[i].push(a),this.order.push(i),this.order.length>this.max){let o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){let r=this.data[e].shift();return r.timeout&&clearTimeout(r.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),r.value}getByKey(e){let r=this.data[e];return r?r[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,r){if(!this.has(e))return this;let n=e.wrapped().key,i=r===void 0?0:this.data[n].indexOf(r),a=this.data[n][i];return this.data[n].splice(i,1),a.timeout&&clearTimeout(a.timeout),this.data[n].length===0&&delete this.data[n],this.onRemove(a.value),this.order.splice(this.order.indexOf(n),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){let r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(e){let r=[];for(let n in this.data)for(let i of this.data[n])e(i.value)||r.push(i);for(let n of r)this.remove(n.value.tileID,n)}},NF=Zt(xr(),1);C();var kAe=class{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,r,n){let i=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][i]=this.stateChanges[e][i]||{},zt(this.stateChanges[e][i],n),this.deletedStates[e]===null){this.deletedStates[e]={};for(let a in this.state[e])a!==i&&(this.deletedStates[e][a]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][i]===null){this.deletedStates[e][i]={};for(let a in this.state[e][i])n[a]||(this.deletedStates[e][i][a]=null)}else for(let a in n)this.deletedStates[e]&&this.deletedStates[e][i]&&this.deletedStates[e][i][a]===null&&delete this.deletedStates[e][i][a]}removeFeatureState(e,r,n){if(this.deletedStates[e]===null)return;let i=String(r);if(this.deletedStates[e]=this.deletedStates[e]||{},n&&r!==void 0)this.deletedStates[e][i]!==null&&(this.deletedStates[e][i]=this.deletedStates[e][i]||{},this.deletedStates[e][i][n]=null);else if(r!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][i]){this.deletedStates[e][i]={};for(n in this.stateChanges[e][i])this.deletedStates[e][i][n]=null}else this.deletedStates[e][i]=null;else this.deletedStates[e]=null}getState(e,r){let n=String(r),i=this.state[e]||{},a=this.stateChanges[e]||{},o=zt({},i[n],a[n]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){let s=this.deletedStates[e][r];if(s===null)return{};for(let l in s)delete o[l]}return o}initializeTileState(e,r){e.setFeatureState(this.state,r)}coalesceChanges(e,r){let n={};for(let i in this.stateChanges){this.state[i]=this.state[i]||{};let a={};for(let o in this.stateChanges[i])this.state[i][o]||(this.state[i][o]={}),zt(this.state[i][o],this.stateChanges[i][o]),a[o]=this.state[i][o];n[i]=a}for(let i in this.deletedStates){this.state[i]=this.state[i]||{};let a={};if(this.deletedStates[i]===null)for(let o in this.state[i])a[o]={},this.state[i][o]={};else for(let o in this.deletedStates[i]){if(this.deletedStates[i][o]===null)this.state[i][o]={};else for(let s of Object.keys(this.deletedStates[i][o]))delete this.state[i][o][s];a[o]=this.state[i][o]}n[i]=n[i]||{},zt(n[i],a)}if(this.stateChanges={},this.deletedStates={},Object.keys(n).length!==0)for(let i in e)e[i].setFeatureState(n,r)}};C();C();var OAe=Zt(xr(),1),og=89.25;function BAe(t,e,r){let n=1/(1<<r.z);return new Mn(t/8192*n+r.x*n,e/8192*n+r.y*n)}function xu(t,e){let r=on(e.lat,-Cu,Cu);return new OAe.default(Ng(e.lng)*t,jp(r)*t)}function A1(t,e){return new Mn(e.x/t,e.y/t).toLngLat()}function Jb(t){return t.cameraToCenterDistance*Math.min(Math.tan(Zn(90-t.pitch))*.85,Math.tan(Zn(og-t.pitch)))}function RE(t,e){let r=t.canonical,n=e/mo(r.z),i=r.x+Math.pow(2,r.z)*t.wrap,a=Xe.identity(new Float64Array(16));return Xe.translate(a,a,[i*n,r.y*n,0]),Xe.scale(a,a,[n/8192,n/8192,1]),a}function MM(t,e,r,n,i){let a=Mn.fromLngLat(t,e),o=Dp(1,t.lat),s=i*o,l=s*Math.cos(Zn(r)),u=Math.sqrt(s*s-l*l),c=u*Math.sin(Zn(-n)),h=u*Math.cos(Zn(-n));return new Mn(a.x+c,a.y+h,a.z+l)}C();function zAe(t,e,r){let n=e.intersectsFrustum(t);if(!r||n===0)return n;let i=e.intersectsPlane(r);return i===0?0:n===2&&i===2?2:1}function $F(t,e,r){let n=0,i=(r-e)/10;for(let a=0;a<10;a++){let o=e+(a+.5)/10*(r-e);n+=i*Math.pow(Math.cos(o),t)}return n}function TM(t,e){return function(r,n,i,a,o){let s=2*((t-1)/go(Math.cos(Zn(og-o))/Math.cos(Zn(og)))-1),l=Math.acos(i/a),u=2*$F(s-1,0,Zn(o/2)),c=Math.min(Zn(og),l+Zn(o/2)),h=Math.min(c,l-Zn(o/2)),d=$F(s-1,h,c),p=Math.atan(n/i),m=Math.hypot(n,i),y=r;return y=y+go(a/m/Math.max(.5,Math.cos(Zn(o/2)))),y+=s*go(Math.cos(p))/2,y-=go(Math.max(1,d/u/e))/2,y}}var FAe=9.314,RAe=3,LAe=TM(FAe,RAe);function I3(t,e){let r=(e.roundZoom?Math.round:Math.floor)(t.zoom+go(t.tileSize/e.tileSize));return Math.max(0,r)}function C3(t,e){let r=t.getCameraFrustum(),n=t.getClippingPlane(),i=t.screenPointToMercatorCoordinate(t.getCameraPoint()),a=Mn.fromLngLat(t.center,t.elevation);i.z=a.z+Math.cos(t.pitchInRadians)*t.cameraToCenterDistance/t.worldSize;let o=t.getCoveringTilesDetailsProvider(),s=o.allowVariableZoom(t,e),l=I3(t,e),u=e.minzoom||0,c=e.maxzoom!==void 0?e.maxzoom:t.maxZoom,h=Math.min(Math.max(0,l),c),d=Math.pow(2,h),p=[d*i.x,d*i.y,0],m=[d*a.x,d*a.y,0],y=Math.hypot(a.x-i.x,a.y-i.y),v=Math.abs(a.z-i.z),_=Math.hypot(y,v),w=E=>({zoom:0,x:0,y:0,wrap:E,fullyVisible:!1}),b=[],A=[];if(t.renderWorldCopies&&o.allowWorldCopies())for(let E=1;E<=3;E++)b.push(w(-E)),b.push(w(E));for(b.push(w(0));b.length>0;){let E=b.pop(),M=E.x,P=E.y,k=E.fullyVisible,D={x:M,y:P,z:E.zoom},O=o.getTileBoundingVolume(D,E.wrap,t.elevation,e);if(!k){let T=zAe(r,O,n);if(T===0)continue;k=T===2}let B=o.distanceToTile2d(i.x,i.y,D,O),L=l;s&&(L=(e.calculateTileZoom||LAe)(t.zoom+go(t.tileSize/e.tileSize),B,v,_,t.fov)),L=(e.roundZoom?Math.round:Math.floor)(L),L=Math.max(0,L);let R=Math.min(L,c);if(E.wrap=o.getWrap(a,D,E.wrap),E.zoom>=R){if(E.zoom<u)continue;let T=h-E.zoom,N=p[0]-.5-(M<<T),$=p[1]-.5-(P<<T),V=e.reparseOverscaled?Math.max(E.zoom,L):E.zoom;A.push({tileID:new Ga(E.zoom===c?V:E.zoom,E.wrap,E.zoom,M,P),distanceSq:No.sqrLen([m[0]-.5-M,m[1]-.5-P]),tileDistanceToCamera:Math.sqrt(N*N+$*$)});continue}for(let T=0;T<4;T++){let N=(M<<1)+T%2,$=(P<<1)+(T>>1),V=E.zoom+1;b.push({zoom:V,x:N,y:$,wrap:E.wrap,fullyVisible:k})}}return A.sort((E,M)=>E.distanceSq-M.distanceSq).map(E=>E.tileID)}C();var UF=Zt(xr(),1),NAe=Eu.fromPoints([new UF.default(0,0),new UF.default(8192,8192)]),S1=class jy extends Xo{constructor(e,r,n){super(),this.id=e,this.dispatcher=n,this.on("data",i=>this._dataHandler(i)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=bAe(e,r,n,this),this._tiles={},this._cache=new DAe(0,i=>this._unloadTile(i)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new kAe,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if((this.used!==void 0||this.usedForTerrain!==void 0)&&!this.used&&!this.usedForTerrain)return!0;if(!this._updated)return!1;for(let e in this._tiles){let r=this._tiles[e];if(r.state!=="loaded"&&r.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;let e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}async _loadTile(e,r,n){try{await this._source.loadTile(e),this._tileLoaded(e,r,n)}catch(i){e.state="errored",i.status!==404?this._source.fire(new Jt(i,{tile:e})):this.update(this.transform,this.terrain)}}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new ht("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(let r in this._tiles){let n=this._tiles[r];n.upload(e),n.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(jF).map(e=>e.key)}getRenderableIds(e){let r=[];for(let n in this._tiles)this._isIdRenderable(n,e)&&r.push(this._tiles[n]);return e?r.sort((n,i)=>{let a=n.tileID,o=i.tileID,s=new NF.default(a.canonical.x,a.canonical.y)._rotate(-this.transform.bearingInRadians),l=new NF.default(o.canonical.x,o.canonical.y)._rotate(-this.transform.bearingInRadians);return a.overscaledZ-o.overscaledZ||l.y-s.y||l.x-s.x}).map(n=>n.tileID.key):r.map(n=>n.tileID).sort(jF).map(n=>n.key)}hasRenderableParent(e){let r=this.findLoadedParent(e,0);return r?this._isIdRenderable(r.tileID.key):!1}_isIdRenderable(e,r){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(r||!this._tiles[e].holdingForFade())}reload(e){if(this._paused){this._shouldReloadOnResume=!0;return}this._cache.reset();for(let r in this._tiles)e?this._reloadTile(r,"expired"):this._tiles[r].state!=="errored"&&this._reloadTile(r,"reloading")}async _reloadTile(e,r){let n=this._tiles[e];n&&(n.state!=="loading"&&(n.state=r),await this._loadTile(n,e,r))}_tileLoaded(e,r,n){e.timeAdded=Dr.now(),n==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new ht("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){let r=this.getRenderableIds();for(let i=0;i<r.length;i++){let a=r[i];if(e.neighboringTiles&&e.neighboringTiles[a]){let o=this.getTileByID(a);n(e,o),n(o,e)}}function n(i,a){i.needsHillshadePrepare=!0,i.needsTerrainPrepare=!0;let o=a.tileID.canonical.x-i.tileID.canonical.x,s=a.tileID.canonical.y-i.tileID.canonical.y,l=Math.pow(2,i.tileID.canonical.z),u=a.tileID.key;o===0&&s===0||Math.abs(s)>1||(Math.abs(o)>1&&(Math.abs(o+l)===1?o+=l:Math.abs(o-l)===1&&(o-=l)),!(!a.dem||!i.dem)&&(i.dem.backfillBorder(a.dem,o,s),i.neighboringTiles&&i.neighboringTiles[u]&&(i.neighboringTiles[u].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,r,n,i){for(let a in this._tiles){let o=this._tiles[a];if(i[a]||!o.hasData()||o.tileID.overscaledZ<=r||o.tileID.overscaledZ>n)continue;let s=o.tileID;for(;o&&o.tileID.overscaledZ>r+1;){let u=o.tileID.scaledTo(o.tileID.overscaledZ-1);o=this._tiles[u.key],o&&o.hasData()&&(s=u)}let l=s;for(;l.overscaledZ>r;)if(l=l.scaledTo(l.overscaledZ-1),e[l.key]||e[l.canonical.key]){i[s.key]=s;break}}}findLoadedParent(e,r){if(e.key in this._loadedParentTiles){let n=this._loadedParentTiles[e.key];return n&&n.tileID.overscaledZ>=r?n:null}for(let n=e.overscaledZ-1;n>=r;n--){let i=e.scaledTo(n),a=this._getLoadedTile(i);if(a)return a}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){let r=this._tiles[e.key];return r&&r.hasData()?r:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){let r=Math.ceil(e.width/this._source.tileSize)+1,n=Math.ceil(e.height/this._source.tileSize)+1,i=r*n,a=this._maxTileCacheZoomLevels===null?s1.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels,o=Math.floor(i*a),s=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,o):o;this._cache.setMaxSize(s)}handleWrapJump(e){let r=this._prevLng===void 0?e:this._prevLng,n=(e-r)/360,i=Math.round(n);if(this._prevLng=e,i){let a={};for(let o in this._tiles){let s=this._tiles[o];s.tileID=s.tileID.unwrapTo(s.tileID.wrap+i),a[s.tileID.key]=s}this._tiles=a;for(let o in this._timers)clearTimeout(this._timers[o]),delete this._timers[o];for(let o in this._tiles){let s=this._tiles[o];this._setTileReloadTimer(o,s)}}}_updateCoveredAndRetainedTiles(e,r,n,i,a,o){let s={},l={},u=Object.keys(e),c=Dr.now();for(let h of u){let d=e[h],p=this._tiles[h];if(!p||p.fadeEndTime!==0&&p.fadeEndTime<=c)continue;let m=this.findLoadedParent(d,r),y=this.findLoadedSibling(d),v=m||y||null;v&&(this._addTile(v.tileID),s[v.tileID.key]=v.tileID),l[h]=d}this._retainLoadedChildren(l,i,n,e);for(let h in s)e[h]||(this._coveredTiles[h]=!0,e[h]=s[h]);if(o){let h={},d={};for(let p of a)this._tiles[p.key].hasData()?h[p.key]=p:d[p.key]=p;for(let p in d){let m=d[p].children(this._source.maxzoom);this._tiles[m[0].key]&&this._tiles[m[1].key]&&this._tiles[m[2].key]&&this._tiles[m[3].key]&&(h[m[0].key]=e[m[0].key]=m[0],h[m[1].key]=e[m[1].key]=m[1],h[m[2].key]=e[m[2].key]=m[2],h[m[3].key]=e[m[3].key]=m[3],delete d[p])}for(let p in d){let m=d[p],y=this.findLoadedParent(m,this._source.minzoom),v=this.findLoadedSibling(m),_=y||v||null;if(_){h[_.tileID.key]=e[_.tileID.key]=_.tileID;for(let w in h)h[w].isChildOf(_.tileID)&&delete h[w]}}for(let p in this._tiles)h[p]||(this._coveredTiles[p]=!0)}}update(e,r){if(!this._sourceLoaded||this._paused)return;this.transform=e,this.terrain=r,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={};let n;!this.used&&!this.usedForTerrain?n=[]:this._source.tileID?n=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(c=>new Ga(c.canonical.z,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y)):(n=C3(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this.usedForTerrain?!1:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:r,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(n=n.filter(c=>this._source.hasTile(c))));let i=I3(e,this._source),a=Math.max(i-jy.maxOverzooming,this._source.minzoom),o=Math.max(i+jy.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){let c={};for(let h of n)if(h.canonical.z>this._source.minzoom){let d=h.scaledTo(h.canonical.z-1);c[d.key]=d;let p=h.scaledTo(Math.max(this._source.minzoom,Math.min(h.canonical.z,5)));c[p.key]=p}n=n.concat(Object.values(c))}let s=n.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,s&&this.fire(new ht("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));let l=this._updateRetainedTiles(n,i);VF(this._source.type)&&this._updateCoveredAndRetainedTiles(l,a,o,i,n,r);for(let c in l)this._tiles[c].clearFadeHold();let u=c1e(this._tiles,l);for(let c of u){let h=this._tiles[c];h.hasSymbolBuckets&&!h.holdingForFade()?h.setHoldDuration(this.map._fadeDuration):(!h.hasSymbolBuckets||h.symbolFadeFinished())&&this._removeTile(c)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(let e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,r){var n;let i={},a={},o=Math.max(r-jy.maxOverzooming,this._source.minzoom),s=Math.max(r+jy.maxUnderzooming,this._source.minzoom),l={};for(let u of e){let c=this._addTile(u);i[u.key]=u,!c.hasData()&&r<this._source.maxzoom&&(l[u.key]=u)}this._retainLoadedChildren(l,r,s,i);for(let u of e){let c=this._tiles[u.key];if(c.hasData())continue;if(r+1>this._source.maxzoom){let d=u.children(this._source.maxzoom)[0],p=this.getTile(d);if(p&&p.hasData()){i[d.key]=d;continue}}else{let d=u.children(this._source.maxzoom);if(i[d[0].key]&&i[d[1].key]&&i[d[2].key]&&i[d[3].key])continue}let h=c.wasRequested();for(let d=u.overscaledZ-1;d>=o;--d){let p=u.scaledTo(d);if(a[p.key])break;if(a[p.key]=!0,c=this.getTile(p),!c&&h&&(c=this._addTile(p)),c){let m=c.hasData();if((m||!((n=this.map)!=null&&n.cancelPendingTileRequestsWhileZooming)||h)&&(i[p.key]=p),h=c.wasRequested(),m)break}}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(let e in this._tiles){let r=[],n,i=this._tiles[e].tileID;for(;i.overscaledZ>0;){if(i.key in this._loadedParentTiles){n=this._loadedParentTiles[i.key];break}r.push(i.key);let a=i.scaledTo(i.overscaledZ-1);if(n=this._getLoadedTile(a),n)break;i=a}for(let a of r)this._loadedParentTiles[a]=n}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(let e in this._tiles){let r=this._tiles[e].tileID,n=this._getLoadedTile(r);this._loadedSiblingTiles[r.key]=n}}_addTile(e){let r=this._tiles[e.key];if(r)return r;r=this._cache.getAndRemove(e),r&&(this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)));let n=r;return r||(r=new iX(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(r,e.key,r.state)),r.uses++,this._tiles[e.key]=r,n||this._source.fire(new ht("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r}_setTileReloadTimer(e,r){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);let n=r.getExpiryTimeout();n&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},n))}refreshTiles(e){for(let r in this._tiles)!this._isIdRenderable(r)&&this._tiles[r].state!="errored"||e.some(n=>n.equals(this._tiles[r].tileID.canonical))&&this._reloadTile(r,"expired")}_removeTile(e){let r=this._tiles[e];r&&(r.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),!(r.uses>0)&&(r.hasData()&&r.state!=="reloading"?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}_dataHandler(e){let r=e.sourceDataType;e.dataType==="source"&&r==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&r==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(let e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,r,n){let i=[],a=this.transform;if(!a)return i;let o=a.getCoveringTilesDetailsProvider().allowWorldCopies(),s=n?a.getCameraQueryGeometry(e):e,l=p=>a.screenPointToMercatorCoordinate(p,this.terrain),u=this.transformBbox(e,l,!o),c=this.transformBbox(s,l,!o),h=this.getIds(),d=Eu.fromPoints(c);for(let p=0;p<h.length;p++){let m=this._tiles[h[p]];if(m.holdingForFade())continue;let y=o?[m.tileID]:[m.tileID.unwrapTo(-1),m.tileID.unwrapTo(0)],v=Math.pow(2,a.zoom-m.tileID.overscaledZ),_=r*m.queryPadding*8192/m.tileSize/v;for(let w of y){let b=d.map(A=>w.getTilePoint(new Mn(A.x,A.y)));if(b.expandBy(_),b.intersects(NAe)){let A=u.map(M=>w.getTilePoint(M)),E=c.map(M=>w.getTilePoint(M));i.push({tile:m,tileID:o?w:w.unwrapTo(0),queryGeometry:A,cameraQueryGeometry:E,scale:v})}}}return i}transformBbox(e,r,n){let i=e.map(r);if(n){let a=Eu.fromPoints(e);a.shrinkBy(Math.min(a.width(),a.height())*.001);let o=a.map(r);Eu.fromPoints(i).covers(o)||(i=i.map(s=>s.x>.5?new Mn(s.x-1,s.y,s.z):s))}return i}getVisibleCoordinates(e){let r=this.getRenderableIds(e).map(n=>this._tiles[n].tileID);return this.transform&&this.transform.populateCache(r),r}hasTransition(){if(this._source.hasTransition())return!0;if(VF(this._source.type)){let e=Dr.now();for(let r in this._tiles)if(this._tiles[r].fadeEndTime>=e)return!0}return!1}setFeatureState(e,r,n){e=e||"_geojsonTileLayer",this._state.updateState(e,r,n)}removeFeatureState(e,r,n){e=e||"_geojsonTileLayer",this._state.removeFeatureState(e,r,n)}getFeatureState(e,r){return e=e||"_geojsonTileLayer",this._state.getState(e,r)}setDependencies(e,r,n){let i=this._tiles[e];i&&i.setDependencies(r,n)}reloadTilesForDependencies(e,r){for(let n in this._tiles)this._tiles[n].hasDependency(e,r)&&this._reloadTile(n,"reloading");this._cache.filter(n=>!n.hasDependency(e,r))}};S1.maxOverzooming=10;S1.maxUnderzooming=3;function jF(t,e){let r=Math.abs(t.wrap*2)-+(t.wrap<0),n=Math.abs(e.wrap*2)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||n-r||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function VF(t){return t==="raster"||t==="image"||t==="video"}C();C();C();var Wl=Zt(xr(),1);C();var mh=Zt(xr(),1);function $Ae(t,e,r,n,i){let a=[];for(let o=0;o<t.length;o++){let s=t[o],l;for(let u=0;u<s.length-1;u++){let c=s[u],h=s[u+1];c.x<e&&h.x<e||(c.x<e?c=new mh.default(e,c.y+(h.y-c.y)*((e-c.x)/(h.x-c.x)))._round():h.x<e&&(h=new mh.default(e,c.y+(h.y-c.y)*((e-c.x)/(h.x-c.x)))._round()),!(c.y<r&&h.y<r)&&(c.y<r?c=new mh.default(c.x+(h.x-c.x)*((r-c.y)/(h.y-c.y)),r)._round():h.y<r&&(h=new mh.default(c.x+(h.x-c.x)*((r-c.y)/(h.y-c.y)),r)._round()),!(c.x>=n&&h.x>=n)&&(c.x>=n?c=new mh.default(n,c.y+(h.y-c.y)*((n-c.x)/(h.x-c.x)))._round():h.x>=n&&(h=new mh.default(n,c.y+(h.y-c.y)*((n-c.x)/(h.x-c.x)))._round()),!(c.y>=i&&h.y>=i)&&(c.y>=i?c=new mh.default(c.x+(h.x-c.x)*((i-c.y)/(h.y-c.y)),i)._round():h.y>=i&&(h=new mh.default(c.x+(h.x-c.x)*((i-c.y)/(h.y-c.y)),i)._round()),(!l||!c.equals(l[l.length-1]))&&(l=[c],a.push(l)),l.push(h)))))}}return a}C();var UAe=class{constructor(e,r){this.reset(e,r)}reset(e,r){this.points=e||[],this._distances=[0];for(let n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(r||0,this.length*.5),this.paddedLength=this.length-this.padding*2}lerp(e){if(this.points.length===1)return this.points[0];e=on(e,0,1);let r=1,n=this._distances[r],i=e*this.paddedLength+this.padding;for(;n<i&&r<this._distances.length;)n=this._distances[++r];let a=r-1,o=this._distances[a],s=n-o,l=s>0?(i-o)/s:0;return this.points[a].mult(1-l).add(this.points[r].mult(l))}};C();function qx(t,e){let r=!0;return t==="always"||(t==="never"||e==="never")&&(r=!1),r}var GF=class{constructor(e,r,n){let i=this.boxCells=[],a=this.circleCells=[];this.xCellCount=Math.ceil(e/n),this.yCellCount=Math.ceil(r/n);for(let o=0;o<this.xCellCount*this.yCellCount;o++)i.push([]),a.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=r,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/r,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,r,n,i,a){this._forEachCell(r,n,i,a,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(a)}insertCircle(e,r,n,i){this._forEachCell(r-i,n-i,r+i,n+i,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(r),this.circles.push(n),this.circles.push(i)}_insertBoxCell(e,r,n,i,a,o){this.boxCells[a].push(o)}_insertCircleCell(e,r,n,i,a,o){this.circleCells[a].push(o)}_query(e,r,n,i,a,o,s){if(n<0||e>this.width||i<0||r>this.height)return[];let l=[];if(e<=0&&r<=0&&this.width<=n&&this.height<=i){if(a)return[{key:null,x1:e,y1:r,x2:n,y2:i}];for(let u=0;u<this.boxKeys.length;u++)l.push({key:this.boxKeys[u],x1:this.bboxes[u*4],y1:this.bboxes[u*4+1],x2:this.bboxes[u*4+2],y2:this.bboxes[u*4+3]});for(let u=0;u<this.circleKeys.length;u++){let c=this.circles[u*3],h=this.circles[u*3+1],d=this.circles[u*3+2];l.push({key:this.circleKeys[u],x1:c-d,y1:h-d,x2:c+d,y2:h+d})}}else{let u={hitTest:a,overlapMode:o,seenUids:{box:{},circle:{}}};this._forEachCell(e,r,n,i,this._queryCell,l,u,s)}return l}query(e,r,n,i){return this._query(e,r,n,i,!1,null)}hitTest(e,r,n,i,a,o){return this._query(e,r,n,i,!0,a,o).length>0}hitTestCircle(e,r,n,i,a){let o=e-n,s=e+n,l=r-n,u=r+n;if(s<0||o>this.width||u<0||l>this.height)return!1;let c=[],h={hitTest:!0,overlapMode:i,circle:{x:e,y:r,radius:n},seenUids:{box:{},circle:{}}};return this._forEachCell(o,l,s,u,this._queryCellCircle,c,h,a),c.length>0}_queryCell(e,r,n,i,a,o,s,l){let{seenUids:u,hitTest:c,overlapMode:h}=s,d=this.boxCells[a];if(d!==null){let m=this.bboxes;for(let y of d)if(!u.box[y]){u.box[y]=!0;let v=y*4,_=this.boxKeys[y];if(e<=m[v+2]&&r<=m[v+3]&&n>=m[v+0]&&i>=m[v+1]&&(!l||l(_))&&(!c||!qx(h,_.overlapMode))&&(o.push({key:_,x1:m[v],y1:m[v+1],x2:m[v+2],y2:m[v+3]}),c))return!0}}let p=this.circleCells[a];if(p!==null){let m=this.circles;for(let y of p)if(!u.circle[y]){u.circle[y]=!0;let v=y*3,_=this.circleKeys[y];if(this._circleAndRectCollide(m[v],m[v+1],m[v+2],e,r,n,i)&&(!l||l(_))&&(!c||!qx(h,_.overlapMode))){let w=m[v],b=m[v+1],A=m[v+2];if(o.push({key:_,x1:w-A,y1:b-A,x2:w+A,y2:b+A}),c)return!0}}}return!1}_queryCellCircle(e,r,n,i,a,o,s,l){let{circle:u,seenUids:c,overlapMode:h}=s,d=this.boxCells[a];if(d!==null){let m=this.bboxes;for(let y of d)if(!c.box[y]){c.box[y]=!0;let v=y*4,_=this.boxKeys[y];if(this._circleAndRectCollide(u.x,u.y,u.radius,m[v+0],m[v+1],m[v+2],m[v+3])&&(!l||l(_))&&!qx(h,_.overlapMode))return o.push(!0),!0}}let p=this.circleCells[a];if(p!==null){let m=this.circles;for(let y of p)if(!c.circle[y]){c.circle[y]=!0;let v=y*3,_=this.circleKeys[y];if(this._circlesCollide(m[v],m[v+1],m[v+2],u.x,u.y,u.radius)&&(!l||l(_))&&!qx(h,_.overlapMode))return o.push(!0),!0}}}_forEachCell(e,r,n,i,a,o,s,l){let u=this._convertToXCellCoord(e),c=this._convertToYCellCoord(r),h=this._convertToXCellCoord(n),d=this._convertToYCellCoord(i);for(let p=u;p<=h;p++)for(let m=c;m<=d;m++){let y=this.xCellCount*m+p;if(a.call(this,e,r,n,i,y,o,s,l))return}}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,r,n,i,a,o){let s=i-e,l=a-r,u=n+o;return u*u>s*s+l*l}_circleAndRectCollide(e,r,n,i,a,o,s){let l=(o-i)/2,u=Math.abs(e-(i+l));if(u>l+n)return!1;let c=(s-a)/2,h=Math.abs(r-(a+c));if(h>c+n)return!1;if(u<=l||h<=c)return!0;let d=u-l,p=h-c;return d*d+p*p<=n*n}};C();var E1=Zt(xr(),1);function Ak(t,e,r){let n=Xe.create();if(!t){let{vecSouth:i,vecEast:a}=Sk(e),o=a1.create();o[0]=a[0],o[1]=a[1],o[2]=i[0],o[3]=i[1],a1.invert(o,o),n[0]=o[0],n[1]=o[1],n[4]=o[2],n[5]=o[3]}return Xe.scale(n,n,[1/r,1/r,1]),n}function jAe(t,e,r,n){if(t){let i=Xe.create();if(!e){let{vecSouth:a,vecEast:o}=Sk(r);i[0]=o[0],i[1]=o[1],i[4]=a[0],i[5]=a[1]}return Xe.scale(i,i,[n,n,1]),i}else return r.pixelsToClipSpaceMatrix}function Sk(t){let e=Math.cos(t.rollInRadians),r=Math.sin(t.rollInRadians),n=Math.cos(t.pitchInRadians),i=Math.cos(t.bearingInRadians),a=Math.sin(t.bearingInRadians),o=No.create();o[0]=-i*n*r-a*e,o[1]=-a*n*r+i*e;let s=No.length(o);s<1e-9?No.zero(o):No.scale(o,o,1/s);let l=No.create();l[0]=i*n*e-a*r,l[1]=a*n*e+i*r;let u=No.length(l);return u<1e-9?No.zero(l):No.scale(l,l,1/u),{vecEast:l,vecSouth:o}}function Ek(t,e,r,n){let i;n?(i=[t,e,n(t,e),1],Pi.transformMat4(i,i,r)):(i=[t,e,0,1],Ik(i,i,r));let a=i[3];return{point:new E1.default(i[0]/a,i[1]/a),signedDistanceFromCamera:a,isOccluded:!1}}function aX(t,e){return .5+.5*(t/e)}function VAe(t,e){return t.x>=-e[0]&&t.x<=e[0]&&t.y>=-e[1]&&t.y<=e[1]}function GAe(t,e,r,n,i,a,o,s,l,u,c,h,d){let p=r?t.textSizeData:t.iconSizeData,m=S3(p,e.transform.zoom),y=[256/e.width*2+1,256/e.height*2+1],v=r?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;v.clear();let _=t.lineVertexArray,w=r?t.text.placedSymbolArray:t.icon.placedSymbolArray,b=e.transform.width/e.transform.height,A=!1;for(let E=0;E<w.length;E++){let M=w.get(E);if(M.hidden||M.writingMode===2&&!A){sg(M.numGlyphs,v);continue}A=!1;let P=new E1.default(M.anchorX,M.anchorY),k={getElevation:d,pitchedLabelPlaneMatrix:n,lineVertexArray:_,pitchWithMap:a,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:P,unwrappedTileID:l,width:u,height:c,translation:h},D=lX(M.anchorX,M.anchorY,k);if(!VAe(D.point,y)){sg(M.numGlyphs,v);continue}let O=D.signedDistanceFromCamera,B=aX(e.transform.cameraToCenterDistance,O),L=wk(p,m,M),R=a?L*e.transform.getPitchedTextCorrection(M.anchorX,M.anchorY,l)/B:L*B,T=WF({projectionContext:k,pitchedLabelPlaneMatrixInverse:i,symbol:M,fontSize:R,flip:!1,keepUpright:o,glyphOffsetArray:t.glyphOffsetArray,dynamicLayoutVertexArray:v,aspectRatio:b,rotateToLine:s});A=T.useVertical,(T.notEnoughRoom||A||T.needsFlipping&&WF({projectionContext:k,pitchedLabelPlaneMatrixInverse:i,symbol:M,fontSize:R,flip:!0,keepUpright:o,glyphOffsetArray:t.glyphOffsetArray,dynamicLayoutVertexArray:v,aspectRatio:b,rotateToLine:s}).notEnoughRoom)&&sg(M.numGlyphs,v)}r?t.text.dynamicLayoutVertexBuffer.updateData(v):t.icon.dynamicLayoutVertexBuffer.updateData(v)}function oX(t,e,r,n,i,a,o,s){let l=a.glyphStartIndex+a.numGlyphs,u=a.lineStartIndex,c=a.lineStartIndex+a.lineLength,h=e.getoffsetX(a.glyphStartIndex),d=e.getoffsetX(l-1),p=k4(t*h,r,n,i,a.segment,u,c,s,o);if(!p)return null;let m=k4(t*d,r,n,i,a.segment,u,c,s,o);return!m||s.projectionCache.anyProjectionOccluded?null:{first:p,last:m}}function ZF(t,e,r,n){if(t===1){let i=Math.abs(r.y-e.y),a=Math.abs(r.x-e.x)*n;if(i>a)return{useVertical:!0}}return(t===2?e.y<r.y:e.x>r.x)?{needsFlipping:!0}:null}function WF(t){let{projectionContext:e,pitchedLabelPlaneMatrixInverse:r,symbol:n,fontSize:i,flip:a,keepUpright:o,glyphOffsetArray:s,dynamicLayoutVertexArray:l,aspectRatio:u,rotateToLine:c}=t,h=i/24,d=n.lineOffsetX*h,p=n.lineOffsetY*h,m;if(n.numGlyphs>1){let y=n.glyphStartIndex+n.numGlyphs,v=n.lineStartIndex,_=n.lineStartIndex+n.lineLength,w=oX(h,s,d,p,a,n,c,e);if(!w)return{notEnoughRoom:!0};let b=Yx(w.first.point.x,w.first.point.y,e,r),A=Yx(w.last.point.x,w.last.point.y,e,r);if(o&&!a){let E=ZF(n.writingMode,b,A,u);if(E)return E}m=[w.first];for(let E=n.glyphStartIndex+1;E<y-1;E++){let M=k4(h*s.getoffsetX(E),d,p,a,n.segment,v,_,e,c);if(!M)return{notEnoughRoom:!0};m.push(M)}m.push(w.last)}else{if(o&&!a){let v=Vp(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,_=n.lineStartIndex+n.segment+1,w=new E1.default(e.lineVertexArray.getx(_),e.lineVertexArray.gety(_)),b=Vp(w.x,w.y,e),A=b.signedDistanceFromCamera>0?b.point:sX(e.tileAnchorPoint,w,v,1,e),E=Yx(v.x,v.y,e,r),M=Yx(A.x,A.y,e,r),P=ZF(n.writingMode,E,M,u);if(P)return P}let y=k4(h*s.getoffsetX(n.glyphStartIndex),d,p,a,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,e,c);if(!y||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};m=[y]}for(let y of m)w1(l,y.point,y.angle);return{}}function sX(t,e,r,n,i){let a=t.add(t.sub(e)._unit()),o=Vp(a.x,a.y,i).point,s=r.sub(o);return r.add(s._mult(n/s.mag()))}function PM(t,e,r){let n=e.projectionCache;if(n.projections[t])return n.projections[t];let i=new E1.default(e.lineVertexArray.getx(t),e.lineVertexArray.gety(t)),a=Vp(i.x,i.y,e);if(a.signedDistanceFromCamera>0)return n.projections[t]=a.point,n.anyProjectionOccluded=n.anyProjectionOccluded||a.isOccluded,a.point;let o=t-r.direction,s=r.distanceFromAnchor===0?e.tileAnchorPoint:new E1.default(e.lineVertexArray.getx(o),e.lineVertexArray.gety(o)),l=r.absOffsetX-r.distanceFromAnchor+1;return sX(s,i,r.previousVertex,l,e)}function Vp(t,e,r){let n=t+r.translation[0],i=e+r.translation[1],a;return r.pitchWithMap?(a=Ek(n,i,r.pitchedLabelPlaneMatrix,r.getElevation),a.isOccluded=!1):(a=r.transform.projectTileCoordinates(n,i,r.unwrappedTileID,r.getElevation),a.point.x=(a.point.x*.5+.5)*r.width,a.point.y=(-a.point.y*.5+.5)*r.height),a}function Yx(t,e,r,n){if(r.pitchWithMap){let i=[t,e,0,1];return Pi.transformMat4(i,i,n),r.transform.projectTileCoordinates(i[0]/i[3],i[1]/i[3],r.unwrappedTileID,r.getElevation).point}else return{x:t/r.width*2-1,y:e/r.height*2-1}}function lX(t,e,r){return r.transform.projectTileCoordinates(t,e,r.unwrappedTileID,r.getElevation)}function DM(t,e,r){return t._unit()._perp()._mult(e*r)}function ZAe(t,e,r,n,i,a,o,s,l){if(s.projectionCache.offsets[t])return s.projectionCache.offsets[t];let u=r.add(e);if(t+l.direction<n||t+l.direction>=i)return s.projectionCache.offsets[t]=u,u;let c=PM(t+l.direction,s,l),h=DM(c.sub(r),o,l.direction),d=r.add(h),p=c.add(h);return s.projectionCache.offsets[t]=f1e(a,u,d,p)||u,s.projectionCache.offsets[t]}function k4(t,e,r,n,i,a,o,s,l){let u=n?t-e:t+e,c=u>0?1:-1,h=0;n&&(c*=-1,h=Math.PI),c<0&&(h+=Math.PI);let d=c>0?a+i:a+i+1,p;s.projectionCache.cachedAnchorPoint?p=s.projectionCache.cachedAnchorPoint:(p=Vp(s.tileAnchorPoint.x,s.tileAnchorPoint.y,s).point,s.projectionCache.cachedAnchorPoint=p);let m=p,y=p,v,_,w=0,b=0,A=Math.abs(u),E=[],M;do{if(d+=c,d<a||d>=o)return null;w+=b,y=m,_=v;let O={absOffsetX:A,direction:c,distanceFromAnchor:w,previousVertex:y};if(m=PM(d,s,O),r===0)E.push(y),M=m.sub(y);else{let B,L=m.sub(y);if(L.mag()===0){let R=PM(d+c,s,O);B=DM(R.sub(m),r,c)}else B=DM(L,r,c);_||(_=y.add(B)),v=ZAe(d,B,m,a,o,_,r,s,O),E.push(_),M=v.sub(_)}b=M.mag()}while(w+b<=A);let P=(A-w)/b,k=M._mult(P)._add(_||y),D=h+Math.atan2(m.y-y.y,m.x-y.x);return E.push(k),{point:k,angle:l?D:0,path:E}}var WAe=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function sg(t,e){for(let r=0;r<t;r++){let n=e.length;e.resize(n+4),e.float32.set(WAe,n*3)}}function Ik(t,e,r){let n=e[0],i=e[1];return t[0]=r[0]*n+r[4]*i+r[12],t[1]=r[1]*n+r[5]*i+r[13],t[3]=r[3]*n+r[7]*i+r[15],t}function HAe(t,e){let r=Xe.create();return Xe.invert(r,e.pitchedLabelPlaneMatrix),t.map(n=>{let i=Ek(n.x,n.y,r,e.getElevation),a=e.transform.projectTileCoordinates(i.point.x,i.point.y,e.unwrappedTileID,e.getElevation);return a.point.x=(a.point.x*.5+.5)*e.width,a.point.y=(-a.point.y*.5+.5)*e.height,a})}function XAe(t){let e=0,r=0,n=0,i=0;for(let a=0;a<t.length;a++)t[a].isOccluded?(n=a+1,i=0):(i++,i>r&&(r=i,e=n));return t.slice(e,e+r)}var Sn=100,qAe=class{constructor(e,r=new GF(e.width+2*Sn,e.height+2*Sn,25),n=new GF(e.width+2*Sn,e.height+2*Sn,25)){this.transform=e,this.grid=r,this.ignoredGrid=n,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+Sn,this.screenBottomBoundary=e.height+Sn,this.gridRightBoundary=e.width+2*Sn,this.gridBottomBoundary=e.height+2*Sn,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,r,n,i,a,o,s,l,u,c,h,d){let p=e.anchorPointX+l[0],m=e.anchorPointY+l[1],y=this.projectAndGetPerspectiveRatio(p,m,a,c,d),v=n*y.perspectiveRatio,_;if(!o&&!s){let k=y.x+(h?h.x*v:0),D=y.y+(h?h.y*v:0);_={allPointsOccluded:!1,box:[k+e.x1*v,D+e.y1*v,k+e.x2*v,D+e.y2*v]}}else _=this._projectCollisionBox(e,v,i,a,o,s,l,y,c,h,d);let[w,b,A,E]=_.box,M=o?_.allPointsOccluded:y.isOccluded,P=M;return P||(P=y.perspectiveRatio<this.perspectiveRatioCutoff),P||(P=!this.isInsideGrid(w,b,A,E)),P||r!=="always"&&this.grid.hitTest(w,b,A,E,r,u)?{box:[w,b,A,E],placeable:!1,offscreen:!1,occluded:M}:{box:[w,b,A,E],placeable:!0,offscreen:this.isOffscreen(w,b,A,E),occluded:M}}placeCollisionCircles(e,r,n,i,a,o,s,l,u,c,h,d,p,m){let y=[],v=new Wl.default(r.anchorX,r.anchorY),_=this.getPerspectiveRatio(v.x,v.y,o,m),w=(u?a*this.transform.getPitchedTextCorrection(r.anchorX,r.anchorY,o)/_:a*_)/$H,b={projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},A=r.lineOffsetX*w,E=r.lineOffsetY*w,M={getElevation:m,pitchedLabelPlaneMatrix:s,lineVertexArray:n,pitchWithMap:u,projectionCache:b,transform:this.transform,tileAnchorPoint:v,unwrappedTileID:o,width:this.transform.width,height:this.transform.height,translation:p},P=oX(w,i,A,E,!1,r,!1,M),k=!1,D=!1,O=!0;if(P){let B=h*.5*_+d,L=new Wl.default(-Sn,-Sn),R=new Wl.default(this.screenRightBoundary,this.screenBottomBoundary),T=new UAe,N=P.first,$=P.last,V=[];for(let ie=N.path.length-1;ie>=1;ie--)V.push(N.path[ie]);for(let ie=1;ie<$.path.length;ie++)V.push($.path[ie]);let G=B*2.5;if(u){let ie=this.projectPathToScreenSpace(V,M);ie.some(me=>me.signedDistanceFromCamera<=0)?V=[]:V=ie.map(me=>me.point)}let ee=[];if(V.length>0){let ie=V[0].clone(),me=V[0].clone();for(let Me=1;Me<V.length;Me++)ie.x=Math.min(ie.x,V[Me].x),ie.y=Math.min(ie.y,V[Me].y),me.x=Math.max(me.x,V[Me].x),me.y=Math.max(me.y,V[Me].y);ie.x>=L.x&&me.x<=R.x&&ie.y>=L.y&&me.y<=R.y?ee=[V]:me.x<L.x||ie.x>R.x||me.y<L.y||ie.y>R.y?ee=[]:ee=$Ae([V],L.x,L.y,R.x,R.y)}for(let ie of ee){T.reset(ie,B*.25);let me=0;T.length<=.5*B?me=1:me=Math.ceil(T.paddedLength/G)+1;for(let Me=0;Me<me;Me++){let Ae=Me/Math.max(me-1,1),le=T.lerp(Ae),_e=le.x+Sn,Le=le.y+Sn;y.push(_e,Le,B,0);let Se=_e-B,Ue=Le-B,Y=_e+B,we=Le+B;if(O=O&&this.isOffscreen(Se,Ue,Y,we),D=D||this.isInsideGrid(Se,Ue,Y,we),e!=="always"&&this.grid.hitTestCircle(_e,Le,B,e,c)&&(k=!0,!l))return{circles:[],offscreen:!1,collisionDetected:k}}}}return{circles:!l&&k||!D||_<this.perspectiveRatioCutoff?[]:y,offscreen:O,collisionDetected:k}}projectPathToScreenSpace(e,r){let n=HAe(e,r);return XAe(n)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};let r=[],n=new Eu;for(let h of e){let d=new Wl.default(h.x+Sn,h.y+Sn);n.extend(d),r.push(d)}let{minX:i,minY:a,maxX:o,maxY:s}=n,l=this.grid.query(i,a,o,s).concat(this.ignoredGrid.query(i,a,o,s)),u={},c={};for(let h of l){let d=h.key;if(u[d.bucketInstanceId]===void 0&&(u[d.bucketInstanceId]={}),u[d.bucketInstanceId][d.featureIndex])continue;let p=[new Wl.default(h.x1,h.y1),new Wl.default(h.x2,h.y1),new Wl.default(h.x2,h.y2),new Wl.default(h.x1,h.y2)];bH(r,p)&&(u[d.bucketInstanceId][d.featureIndex]=!0,c[d.bucketInstanceId]===void 0&&(c[d.bucketInstanceId]=[]),c[d.bucketInstanceId].push(d.featureIndex))}return c}insertCollisionBox(e,r,n,i,a,o){let s=n?this.ignoredGrid:this.grid,l={bucketInstanceId:i,featureIndex:a,collisionGroupID:o,overlapMode:r};s.insert(l,e[0],e[1],e[2],e[3])}insertCollisionCircles(e,r,n,i,a,o){let s=n?this.ignoredGrid:this.grid,l={bucketInstanceId:i,featureIndex:a,collisionGroupID:o,overlapMode:r};for(let u=0;u<e.length;u+=4)s.insertCircle(l,e[u],e[u+1],e[u+2])}projectAndGetPerspectiveRatio(e,r,n,i,a){if(a){let o;i?(o=[e,r,i(e,r),1],Pi.transformMat4(o,o,a)):(o=[e,r,0,1],Ik(o,o,a));let s=o[3];return{x:(o[0]/s+1)/2*this.transform.width+Sn,y:(-o[1]/s+1)/2*this.transform.height+Sn,perspectiveRatio:.5+.5*(this.transform.cameraToCenterDistance/s),isOccluded:!1,signedDistanceFromCamera:s}}else{let o=this.transform.projectTileCoordinates(e,r,n,i);return{x:(o.point.x+1)/2*this.transform.width+Sn,y:(-o.point.y+1)/2*this.transform.height+Sn,perspectiveRatio:.5+.5*(this.transform.cameraToCenterDistance/o.signedDistanceFromCamera),isOccluded:o.isOccluded,signedDistanceFromCamera:o.signedDistanceFromCamera}}}getPerspectiveRatio(e,r,n,i){let a=this.transform.projectTileCoordinates(e,r,n,i);return .5+.5*(this.transform.cameraToCenterDistance/a.signedDistanceFromCamera)}isOffscreen(e,r,n,i){return n<Sn||e>=this.screenRightBoundary||i<Sn||r>this.screenBottomBoundary}isInsideGrid(e,r,n,i){return n>=0&&e<this.gridRightBoundary&&i>=0&&r<this.gridBottomBoundary}getViewportMatrix(){let e=Xe.identity([]);return Xe.translate(e,e,[-Sn,-Sn,0]),e}_projectCollisionBox(e,r,n,i,a,o,s,l,u,c,h){let d=1,p=0,m=0,y=1,v=e.anchorPointX+s[0],_=e.anchorPointY+s[1];if(o&&!a){let T=this.projectAndGetPerspectiveRatio(v+1,_,i,u,h),N=T.x-l.x,$=T.y-l.y,V=Math.atan($/N)+(N<0?Math.PI:0),G=Math.sin(V),ee=Math.cos(V);d=ee,p=G,m=-G,y=ee}else if(!o&&a){let T=Sk(this.transform);d=T.vecEast[0],p=T.vecEast[1],m=T.vecSouth[0],y=T.vecSouth[1]}let w=l.x,b=l.y,A=r;if(a){w=v,b=_;let T=this.transform.zoom-n.overscaledZ;if(A=Math.pow(2,-T),A*=this.transform.getPitchedTextCorrection(v,_,i),!c){let N=l.signedDistanceFromCamera/this.transform.cameraToCenterDistance,$=on(.5+.5*N,0,4);A*=$}}c&&(w+=d*c.x*A+m*c.y*A,b+=p*c.x*A+y*c.y*A);let E=e.x1*A,M=e.x2*A,P=(E+M)/2,k=e.y1*A,D=e.y2*A,O=(k+D)/2,B=[{offsetX:E,offsetY:k},{offsetX:P,offsetY:k},{offsetX:M,offsetY:k},{offsetX:M,offsetY:O},{offsetX:M,offsetY:D},{offsetX:P,offsetY:D},{offsetX:E,offsetY:D},{offsetX:E,offsetY:O}],L=[];for(let{offsetX:T,offsetY:N}of B)L.push(new Wl.default(w+d*T+m*N,b+p*T+y*N));let R=!1;if(a){let T=L.map(N=>this.projectAndGetPerspectiveRatio(N.x,N.y,i,u,h));R=T.some(N=>!N.isOccluded),L=T.map(N=>new Wl.default(N.x,N.y))}else R=!0;return{box:u1e(L),allPointsOccluded:!R}}};C();C();var YAe=Zt(xr(),1),JAe=class uX extends YAe.default{constructor(e,r,n,i){super(e,r),this.angle=n,i!==void 0&&(this.segment=i)}clone(){return new uX(this.x,this.y,this.angle,this.segment)}};Mt("Anchor",JAe);C();C();C();Zt(xr(),1);C();Zt(xr(),1);C();C();Zt(xr(),1);Zt(fG(),1);C();var kM=(t=>(t[t.center=1]="center",t[t.left=2]="left",t[t.right=3]="right",t[t.top=4]="top",t[t.bottom=5]="bottom",t[t["top-left"]=6]="top-left",t[t["top-right"]=7]="top-right",t[t["bottom-left"]=8]="bottom-left",t[t["bottom-right"]=9]="bottom-right",t))(kM||{});function KAe(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}var cX=Zt(xr(),1),HF=class{constructor(e,r,n,i){e?this.opacity=Math.max(0,Math.min(1,e.opacity+(e.placed?r:-r))):this.opacity=i&&n?1:0,this.placed=n}isHidden(){return this.opacity===0&&!this.placed}},sy=class{constructor(e,r,n,i,a){this.text=new HF(e?e.text:null,r,n,a),this.icon=new HF(e?e.icon:null,r,i,a)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}},XF=class{constructor(e,r,n){this.text=e,this.icon=r,this.skipFade=n}},QAe=class{constructor(e,r,n,i,a){this.bucketInstanceId=e,this.featureIndex=r,this.sourceLayerIndex=n,this.bucketIndex=i,this.tileID=a}},e3e=class{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){let r=++this.maxGroupID;this.collisionGroups[e]={ID:r,predicate:n=>n.collisionGroupID===r}}return this.collisionGroups[e]}};function qF(t,e,r,n,i){let{horizontalAlign:a,verticalAlign:o}=VH(t),s=-(a-.5)*e,l=-(o-.5)*r;return new cX.default(s+n[0]*i,l+n[1]*i)}var t3e=class{constructor(e,r,n,i,a){this.transform=e.clone(),this.terrain=r,this.collisionIndex=new qAe(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=n,this.retainedQueryData={},this.collisionGroups=new e3e(i),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=a,a&&(a.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){let r=this.terrain;return r?(n,i)=>r.getElevation(e,n,i):null}getBucketParts(e,r,n,i){let a=n.getBucket(r),o=n.latestFeatureIndex;if(!a||!o||r.id!==a.layerIds[0])return;let s=n.collisionBoxArray,l=a.layers[0].layout,u=a.layers[0].paint,c=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),h=n.tileSize/8192,d=n.tileID.toUnwrapped(),p=l.get("text-rotation-alignment")==="map",m=xs(n,1,this.transform.zoom),y=cd(this.collisionIndex.transform,n,u.get("text-translate"),u.get("text-translate-anchor")),v=cd(this.collisionIndex.transform,n,u.get("icon-translate"),u.get("icon-translate-anchor")),_=Ak(p,this.transform,m);this.retainedQueryData[a.bucketInstanceId]=new QAe(a.bucketInstanceId,o,a.sourceLayerIndex,a.index,n.tileID);let w={bucket:a,layout:l,translationText:y,translationIcon:v,unwrappedTileID:d,pitchedLabelPlaneMatrix:_,scale:c,textPixelRatio:h,holdingForFade:n.holdingForFade(),collisionBoxArray:s,partiallyEvaluatedTextSize:S3(a.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(a.sourceID)};if(i)for(let b of a.sortKeyRanges){let{sortKey:A,symbolInstanceStart:E,symbolInstanceEnd:M}=b;e.push({sortKey:A,symbolInstanceStart:E,symbolInstanceEnd:M,parameters:w})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:a.symbolInstances.length,parameters:w})}attemptAnchorPlacement(e,r,n,i,a,o,s,l,u,c,h,d,p,m,y,v,_,w,b,A){let E=kM[e.textAnchor],M=[e.textOffset0,e.textOffset1],P=qF(E,n,i,M,a),k=this.collisionIndex.placeCollisionBox(r,d,l,u,c,s,o,v,h.predicate,b,P,A);if(!(w&&!this.collisionIndex.placeCollisionBox(w,d,l,u,c,s,o,_,h.predicate,b,P,A).placeable)&&k.placeable){let D;if(this.prevPlacement&&this.prevPlacement.variableOffsets[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID].text&&(D=this.prevPlacement.variableOffsets[p.crossTileID].anchor),p.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[p.crossTileID]={textOffset:M,width:n,height:i,anchor:E,textBoxScale:a,prevAnchor:D},this.markUsedJustification(m,E,p,y),m.allowVerticalPlacement&&(this.markUsedOrientation(m,y,p),this.placedOrientations[p.crossTileID]=y),{shift:P,placedGlyphBoxes:k}}}placeLayerBucketPart(e,r,n){let{bucket:i,layout:a,translationText:o,translationIcon:s,unwrappedTileID:l,pitchedLabelPlaneMatrix:u,textPixelRatio:c,holdingForFade:h,collisionBoxArray:d,partiallyEvaluatedTextSize:p,collisionGroup:m}=e.parameters,y=a.get("text-optional"),v=a.get("icon-optional"),_=P4(a,"text-overlap","text-allow-overlap"),w=_==="always",b=P4(a,"icon-overlap","icon-allow-overlap"),A=b==="always",E=a.get("text-rotation-alignment")==="map",M=a.get("text-pitch-alignment")==="map",P=a.get("icon-text-fit")!=="none",k=a.get("symbol-z-order")==="viewport-y",D=w&&(A||!i.hasIconData()||v),O=A&&(w||!i.hasTextData()||y);!i.collisionArrays&&d&&i.deserializeCollisionBoxes(d);let B=this.retainedQueryData[i.bucketInstanceId].tileID,L=this._getTerrainElevationFunc(B),R=this.transform.getFastPathSimpleProjectionMatrix(B),T=(N,$,V)=>{var G,ee;if(r[N.crossTileID])return;if(h){this.placements[N.crossTileID]=new XF(!1,!1,!1);return}let ie=!1,me=!1,Me=!0,Ae=null,le={box:null,placeable:!1,offscreen:null,occluded:!1},_e={placeable:!1},Le=null,Se=null,Ue=null,Y=0,we=0,q=0;$.textFeatureIndex?Y=$.textFeatureIndex:N.useRuntimeCollisionCircles&&(Y=N.featureIndex),$.verticalTextFeatureIndex&&(we=$.verticalTextFeatureIndex);let oe=$.textBox;if(oe){let st=fe=>{let Fe=1;if(i.allowVerticalPlacement&&!fe&&this.prevPlacement){let Ve=this.prevPlacement.placedOrientations[N.crossTileID];Ve&&(this.placedOrientations[N.crossTileID]=Ve,Fe=Ve,this.markUsedOrientation(i,Fe,N))}return Fe},Ke=(fe,Fe)=>{if(i.allowVerticalPlacement&&N.numVerticalGlyphVertices>0&&$.verticalTextBox){for(let Ve of i.writingModes)if(Ve===2?(le=Fe(),_e=le):le=fe(),le&&le.placeable)break}else le=fe()},J=N.textAnchorOffsetStartIndex,Z=N.textAnchorOffsetEndIndex;if(Z===J){let fe=(Fe,Ve)=>{let ze=this.collisionIndex.placeCollisionBox(Fe,_,c,B,l,M,E,o,m.predicate,L,void 0,R);return ze&&ze.placeable&&(this.markUsedOrientation(i,Ve,N),this.placedOrientations[N.crossTileID]=Ve),ze};Ke(()=>fe(oe,1),()=>{let Fe=$.verticalTextBox;return i.allowVerticalPlacement&&N.numVerticalGlyphVertices>0&&Fe?fe(Fe,2):{box:null,offscreen:null}}),st(le&&le.placeable)}else{let fe=kM[(ee=(G=this.prevPlacement)==null?void 0:G.variableOffsets[N.crossTileID])==null?void 0:ee.anchor],Fe=(ze,Tt,ft)=>{let St=ze.x2-ze.x1,nr=ze.y2-ze.y1,He=N.textBoxScale,Ge=P&&b==="never"?Tt:null,je=null,tt=_==="never"?1:2,Ze="never";fe&&tt++;for(let At=0;At<tt;At++){for(let vt=J;vt<Z;vt++){let Kt=i.textAnchorOffsets.get(vt);if(fe&&Kt.textAnchor!==fe)continue;let he=this.attemptAnchorPlacement(Kt,ze,St,nr,He,E,M,c,B,l,m,Ze,N,i,ft,o,s,Ge,L);if(he&&(je=he.placedGlyphBoxes,je&&je.placeable))return ie=!0,Ae=he.shift,je}fe?fe=null:Ze=_}return n&&!je&&(je={box:this.collisionIndex.placeCollisionBox(oe,"always",c,B,l,M,E,o,m.predicate,L,void 0,R).box,offscreen:!1,placeable:!1,occluded:!1}),je};Ke(()=>Fe(oe,$.iconBox,1),()=>{let ze=$.verticalTextBox,Tt=le&&le.placeable;return i.allowVerticalPlacement&&!Tt&&N.numVerticalGlyphVertices>0&&ze?Fe(ze,$.verticalIconBox,2):{box:null,occluded:!0,offscreen:null}}),le&&(ie=le.placeable,Me=le.offscreen);let Ve=st(le&&le.placeable);if(!ie&&this.prevPlacement){let ze=this.prevPlacement.variableOffsets[N.crossTileID];ze&&(this.variableOffsets[N.crossTileID]=ze,this.markUsedJustification(i,ze.anchor,N,Ve))}}}if(Le=le,ie=Le&&Le.placeable,Me=Le&&Le.offscreen,N.useRuntimeCollisionCircles){let st=i.text.placedSymbolArray.get(N.centerJustifiedTextSymbolIndex),Ke=wk(i.textSizeData,p,st),J=a.get("text-padding"),Z=N.collisionCircleDiameter;Se=this.collisionIndex.placeCollisionCircles(_,st,i.lineVertexArray,i.glyphOffsetArray,Ke,l,u,n,M,m.predicate,Z,J,o,L),Se.circles.length&&Se.collisionDetected&&!n&&Ui("Collisions detected, but collision boxes are not shown"),ie=w||Se.circles.length>0&&!Se.collisionDetected,Me=Me&&Se.offscreen}if($.iconFeatureIndex&&(q=$.iconFeatureIndex),$.iconBox){let st=Ke=>this.collisionIndex.placeCollisionBox(Ke,b,c,B,l,M,E,s,m.predicate,L,P&&Ae?Ae:void 0,R);_e&&_e.placeable&&$.verticalIconBox?(Ue=st($.verticalIconBox),me=Ue.placeable):(Ue=st($.iconBox),me=Ue.placeable),Me=Me&&Ue.offscreen}let ce=y||N.numHorizontalGlyphVertices===0&&N.numVerticalGlyphVertices===0,X=v||N.numIconVertices===0;!ce&&!X?me=ie=me&&ie:X?ce||(me=me&&ie):ie=me&&ie;let ke=ie&&Le.placeable,Ce=me&&Ue.placeable;if(ke&&(_e&&_e.placeable&&we?this.collisionIndex.insertCollisionBox(Le.box,_,a.get("text-ignore-placement"),i.bucketInstanceId,we,m.ID):this.collisionIndex.insertCollisionBox(Le.box,_,a.get("text-ignore-placement"),i.bucketInstanceId,Y,m.ID)),Ce&&this.collisionIndex.insertCollisionBox(Ue.box,b,a.get("icon-ignore-placement"),i.bucketInstanceId,q,m.ID),Se&&ie&&this.collisionIndex.insertCollisionCircles(Se.circles,_,a.get("text-ignore-placement"),i.bucketInstanceId,Y,m.ID),n&&this.storeCollisionData(i.bucketInstanceId,V,$,Le,Ue,Se),N.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(i.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");let Ee=(ie||D)&&!(Le!=null&&Le.occluded),Ne=(me||O)&&!(Ue!=null&&Ue.occluded);this.placements[N.crossTileID]=new XF(Ee,Ne,Me||i.justReloaded),r[N.crossTileID]=!0};if(k){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");let N=i.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let $=N.length-1;$>=0;--$){let V=N[$];T(i.symbolInstances.get(V),i.collisionArrays[V],V)}}else for(let N=e.symbolInstanceStart;N<e.symbolInstanceEnd;N++)T(i.symbolInstances.get(N),i.collisionArrays[N],N);i.justReloaded=!1}storeCollisionData(e,r,n,i,a,o){if(n.textBox||n.iconBox){let s;this.collisionBoxArrays.has(e)?s=this.collisionBoxArrays.get(e):(s=new Map,this.collisionBoxArrays.set(e,s));let l;s.has(r)?l=s.get(r):(l={text:null,icon:null},s.set(r,l)),n.textBox&&(l.text=i.box),n.iconBox&&(l.icon=a.box)}if(o){let s=this.collisionCircleArrays[e];s===void 0&&(s=this.collisionCircleArrays[e]=[]);for(let l=0;l<o.circles.length;l+=4)s.push(o.circles[l+0]-Sn),s.push(o.circles[l+1]-Sn),s.push(o.circles[l+2]),s.push(o.collisionDetected?1:0)}}markUsedJustification(e,r,n,i){let a={left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex},o;i===2?o=n.verticalPlacedTextSymbolIndex:o=a[KAe(r)];let s=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];for(let l of s)l>=0&&(o>=0&&l!==o?e.text.placedSymbolArray.get(l).crossTileID=0:e.text.placedSymbolArray.get(l).crossTileID=n.crossTileID)}markUsedOrientation(e,r,n){let i=r===1||r===3?r:0,a=r===2?r:0,o=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];for(let s of o)e.text.placedSymbolArray.get(s).placedOrientation=i;n.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=a)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;let r=this.prevPlacement,n=!1;this.prevZoomAdjustment=r?r.zoomAdjustment(this.transform.zoom):0;let i=r?r.symbolFadeChange(e):1,a=r?r.opacities:{},o=r?r.variableOffsets:{},s=r?r.placedOrientations:{};for(let l in this.placements){let u=this.placements[l],c=a[l];c?(this.opacities[l]=new sy(c,i,u.text,u.icon),n=n||u.text!==c.text.placed||u.icon!==c.icon.placed):(this.opacities[l]=new sy(null,i,u.text,u.icon,u.skipFade),n=n||u.text||u.icon)}for(let l in a){let u=a[l];if(!this.opacities[l]){let c=new sy(u,i,!1,!1);c.isHidden()||(this.opacities[l]=c,n=n||u.text.placed||u.icon.placed)}}for(let l in o)!this.variableOffsets[l]&&this.opacities[l]&&!this.opacities[l].isHidden()&&(this.variableOffsets[l]=o[l]);for(let l in s)!this.placedOrientations[l]&&this.opacities[l]&&!this.opacities[l].isHidden()&&(this.placedOrientations[l]=s[l]);if(r&&r.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");n?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=r?r.lastPlacementChangeTime:e)}updateLayerOpacities(e,r){let n={};for(let i of r){let a=i.getBucket(e);a&&i.latestFeatureIndex&&e.id===a.layerIds[0]&&this.updateBucketOpacities(a,i.tileID,n,i.collisionBoxArray)}}updateBucketOpacities(e,r,n,i){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();let a=e.layers[0],o=a.layout,s=new sy(null,0,!1,!1,!0),l=o.get("text-allow-overlap"),u=o.get("icon-allow-overlap"),c=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),h=o.get("text-rotation-alignment")==="map",d=o.get("text-pitch-alignment")==="map",p=o.get("icon-text-fit")!=="none",m=new sy(null,0,l&&(u||!e.hasIconData()||o.get("icon-optional")),u&&(l||!e.hasTextData()||o.get("text-optional")),!0);!e.collisionArrays&&i&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(i);let y=(_,w,b)=>{for(let A=0;A<w/4;A++)_.opacityVertexArray.emplaceBack(b);_.hasVisibleVertices=_.hasVisibleVertices||b!==ly},v=this.collisionBoxArrays.get(e.bucketInstanceId);for(let _=0;_<e.symbolInstances.length;_++){let w=e.symbolInstances.get(_),{numHorizontalGlyphVertices:b,numVerticalGlyphVertices:A,crossTileID:E}=w,M=n[E],P=this.opacities[E];M?P=s:P||(P=m,this.opacities[E]=P),n[E]=!0;let k=b>0||A>0,D=w.numIconVertices>0,O=this.placedOrientations[w.crossTileID],B=O===2,L=O===1||O===3;if(k){let T=JF(P.text),N=B?ly:T;y(e.text,b,N);let $=L?ly:T;y(e.text,A,$);let V=P.text.isHidden();[w.rightJustifiedTextSymbolIndex,w.centerJustifiedTextSymbolIndex,w.leftJustifiedTextSymbolIndex].forEach(ie=>{ie>=0&&(e.text.placedSymbolArray.get(ie).hidden=V||B?1:0)}),w.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(w.verticalPlacedTextSymbolIndex).hidden=V||L?1:0);let G=this.variableOffsets[w.crossTileID];G&&this.markUsedJustification(e,G.anchor,w,O);let ee=this.placedOrientations[w.crossTileID];ee&&(this.markUsedJustification(e,"left",w,ee),this.markUsedOrientation(e,ee,w))}if(D){let T=JF(P.icon),N=!(p&&w.verticalPlacedIconSymbolIndex&&B);if(w.placedIconSymbolIndex>=0){let $=N?T:ly;y(e.icon,w.numIconVertices,$),e.icon.placedSymbolArray.get(w.placedIconSymbolIndex).hidden=P.icon.isHidden()}if(w.verticalPlacedIconSymbolIndex>=0){let $=N?ly:T;y(e.icon,w.numVerticalIconVertices,$),e.icon.placedSymbolArray.get(w.verticalPlacedIconSymbolIndex).hidden=P.icon.isHidden()}}let R=v&&v.has(_)?v.get(_):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){let T=e.collisionArrays[_];if(T){let N=new cX.default(0,0);if(T.textBox||T.verticalTextBox){let $=!0;if(c){let V=this.variableOffsets[E];V?(N=qF(V.anchor,V.width,V.height,V.textOffset,V.textBoxScale),h&&N._rotate(d?-this.transform.bearingInRadians:this.transform.bearingInRadians)):$=!1}if(T.textBox||T.verticalTextBox){let V;T.textBox&&(V=B),T.verticalTextBox&&(V=L),YF(e.textCollisionBox.collisionVertexArray,P.text.placed,!$||V,R.text,N.x,N.y)}}if(T.iconBox||T.verticalIconBox){let $=!!(!L&&T.verticalIconBox),V;T.iconBox&&(V=$),T.verticalIconBox&&(V=!$),YF(e.iconCollisionBox.collisionVertexArray,P.icon.placed,V,R.icon,p?N.x:0,p?N.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error("bucket.text.opacityVertexArray.length (= ".concat(e.text.opacityVertexArray.length,") !== bucket.text.layoutVertexArray.length (= ").concat(e.text.layoutVertexArray.length,") / 4"));if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error("bucket.icon.opacityVertexArray.length (= ".concat(e.icon.opacityVertexArray.length,") !== bucket.icon.layoutVertexArray.length (= ").concat(e.icon.layoutVertexArray.length,") / 4"));e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,r){let n=this.zoomAtLastRecencyCheck===r?1-this.zoomAdjustment(r):1;return this.zoomAtLastRecencyCheck=r,this.commitTime+this.fadeDuration*n>e}setStale(){this.stale=!0}};function YF(t,e,r,n,i,a){(!n||n.length===0)&&(n=[0,0,0,0]);let o=n[0]-Sn,s=n[1]-Sn,l=n[2]-Sn,u=n[3]-Sn;t.emplaceBack(e?1:0,r?1:0,i||0,a||0,o,s),t.emplaceBack(e?1:0,r?1:0,i||0,a||0,l,s),t.emplaceBack(e?1:0,r?1:0,i||0,a||0,l,u),t.emplaceBack(e?1:0,r?1:0,i||0,a||0,o,u)}var r3e=Math.pow(2,25),n3e=Math.pow(2,24),i3e=Math.pow(2,17),a3e=Math.pow(2,16),o3e=Math.pow(2,9),s3e=Math.pow(2,8),l3e=Math.pow(2,1);function JF(t){if(t.opacity===0&&!t.placed)return 0;if(t.opacity===1&&t.placed)return 4294967295;let e=t.placed?1:0,r=Math.floor(t.opacity*127);return r*r3e+e*n3e+r*i3e+e*a3e+r*o3e+e*s3e+r*l3e+e}var ly=0,u3e=class{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,r,n,i,a){let o=this._bucketParts;for(;this._currentTileIndex<e.length;){let s=e[this._currentTileIndex];if(r.getBucketParts(o,i,s,this._sortAcrossTiles),this._currentTileIndex++,a())return!0}for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,o.sort((s,l)=>s.sortKey-l.sortKey));this._currentPartIndex<o.length;){let s=o[this._currentPartIndex];if(r.placeLayerBucketPart(s,this._seenCrossTileIDs,n),this._currentPartIndex++,a())return!0}return!1}},c3e=class{constructor(t,e,r,n,i,a,o,s){this.placement=new t3e(t,e,a,o,s),this._currentPlacementIndex=r.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=i,this._done=!1}isDone(){return this._done}continuePlacement(t,e,r){let n=Dr.now(),i=()=>this._forceFullPlacement?!1:Dr.now()-n>2;for(;this._currentPlacementIndex>=0;){let a=t[this._currentPlacementIndex],o=e[a],s=this.placement.collisionIndex.transform.zoom;if(o.type==="symbol"&&(!o.minzoom||o.minzoom<=s)&&(!o.maxzoom||o.maxzoom>s)){if(this._inProgressLayer||(this._inProgressLayer=new u3e(o)),this._inProgressLayer.continuePlacement(r[o.source],this.placement,this._showCollisionBoxes,o,i))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}};C();C();var KF=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],LE=1,uy=8,h3e=class hX{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[r,n]=new Uint8Array(e,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");let i=n>>4;if(i!==LE)throw new Error("Got v".concat(i," data when expected v").concat(LE,"."));let a=KF[n&15];if(!a)throw new Error("Unrecognized array type.");let[o]=new Uint16Array(e,2,1),[s]=new Uint32Array(e,4,1);return new hX(s,o,a,e)}constructor(e,r=64,n=Float64Array,i){if(isNaN(e)||e<0)throw new Error("Unpexpected numItems value: ".concat(e,"."));this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=n,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;let a=KF.indexOf(this.ArrayType),o=e*2*this.ArrayType.BYTES_PER_ELEMENT,s=e*this.IndexArrayType.BYTES_PER_ELEMENT,l=(8-s%8)%8;if(a<0)throw new Error("Unexpected typed array class: ".concat(n,"."));i&&i instanceof ArrayBuffer?(this.data=i,this.ids=new this.IndexArrayType(this.data,uy,e),this.coords=new this.ArrayType(this.data,uy+s+l,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(uy+o+s+l),this.ids=new this.IndexArrayType(this.data,uy,e),this.coords=new this.ArrayType(this.data,uy+s+l,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(LE<<4)+a]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){let n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=e,this.coords[this._pos++]=r,n}finish(){let e=this._pos>>1;if(e!==this.numItems)throw new Error("Added ".concat(e," items when expected ").concat(this.numItems,"."));return OM(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,n,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:a,coords:o,nodeSize:s}=this,l=[0,a.length-1,0],u=[];for(;l.length;){let c=l.pop()||0,h=l.pop()||0,d=l.pop()||0;if(h-d<=s){for(let v=d;v<=h;v++){let _=o[2*v],w=o[2*v+1];_>=e&&_<=n&&w>=r&&w<=i&&u.push(a[v])}continue}let p=d+h>>1,m=o[2*p],y=o[2*p+1];m>=e&&m<=n&&y>=r&&y<=i&&u.push(a[p]),(c===0?e<=m:r<=y)&&(l.push(d),l.push(p-1),l.push(1-c)),(c===0?n>=m:i>=y)&&(l.push(p+1),l.push(h),l.push(1-c))}return u}within(e,r,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:i,coords:a,nodeSize:o}=this,s=[0,i.length-1,0],l=[],u=n*n;for(;s.length;){let c=s.pop()||0,h=s.pop()||0,d=s.pop()||0;if(h-d<=o){for(let v=d;v<=h;v++)QF(a[2*v],a[2*v+1],e,r)<=u&&l.push(i[v]);continue}let p=d+h>>1,m=a[2*p],y=a[2*p+1];QF(m,y,e,r)<=u&&l.push(i[p]),(c===0?e-n<=m:r-n<=y)&&(s.push(d),s.push(p-1),s.push(1-c)),(c===0?e+n>=m:r+n>=y)&&(s.push(p+1),s.push(h),s.push(1-c))}return l}};function OM(t,e,r,n,i,a){if(i-n<=r)return;let o=n+i>>1;dX(t,e,o,n,i,a),OM(t,e,r,n,o-1,1-a),OM(t,e,r,o+1,i,1-a)}function dX(t,e,r,n,i,a){for(;i>n;){if(i-n>600){let u=i-n+1,c=r-n+1,h=Math.log(u),d=.5*Math.exp(2*h/3),p=.5*Math.sqrt(h*d*(u-d)/u)*(c-u/2<0?-1:1),m=Math.max(n,Math.floor(r-c*d/u+p)),y=Math.min(i,Math.floor(r+(u-c)*d/u+p));dX(t,e,r,m,y,a)}let o=e[2*r+a],s=n,l=i;for(cy(t,e,n,r),e[2*i+a]>o&&cy(t,e,n,i);s<l;){for(cy(t,e,s,l),s++,l--;e[2*s+a]<o;)s++;for(;e[2*l+a]>o;)l--}e[2*n+a]===o?cy(t,e,n,l):(l++,cy(t,e,l,i)),l<=r&&(n=l+1),r<=l&&(i=l-1)}}function cy(t,e,r,n){NE(t,r,n),NE(e,2*r,2*n),NE(e,2*r+1,2*n+1)}function NE(t,e,r){let n=t[e];t[e]=t[r],t[r]=n}function QF(t,e,r,n){let i=t-r,a=e-n;return i*i+a*a}var hy=512/8192/2,d3e=128,p3e=class{constructor(e,r,n){this.tileID=e,this.bucketInstanceId=n,this._symbolsByKey={};let i=new Map;for(let a=0;a<r.length;a++){let o=r.get(a),s=o.key,l=i.get(s);l?l.push(o):i.set(s,[o])}for(let[a,o]of i){let s=o.map(c=>({x:Math.floor(c.anchorX*hy),y:Math.floor(c.anchorY*hy)})),l=o.map(c=>c.crossTileID),u={positions:s,crossTileIDs:l};if(u.positions.length>d3e){let c=new h3e(u.positions.length,16,Uint16Array);for(let{x:h,y:d}of u.positions)c.add(h,d);c.finish(),delete u.positions,u.index=c}this._symbolsByKey[a]=u}}getScaledCoordinates(e,r){let{x:n,y:i,z:a}=this.tileID.canonical,{x:o,y:s,z:l}=r.canonical,u=l-a,c=hy/Math.pow(2,u),h=(o*8192+e.anchorX)*c,d=(s*8192+e.anchorY)*c,p=n*8192*hy,m=i*8192*hy;return{x:Math.floor(h-p),y:Math.floor(d-m)}}findMatches(e,r,n){let i=this.tileID.canonical.z<r.canonical.z?1:Math.pow(2,this.tileID.canonical.z-r.canonical.z);for(let a=0;a<e.length;a++){let o=e.get(a);if(o.crossTileID)continue;let s=this._symbolsByKey[o.key];if(!s)continue;let l=this.getScaledCoordinates(o,r);if(s.index){let u=s.index.range(l.x-i,l.y-i,l.x+i,l.y+i).sort();for(let c of u){let h=s.crossTileIDs[c];if(!n[h]){n[h]=!0,o.crossTileID=h;break}}}else if(s.positions)for(let u=0;u<s.positions.length;u++){let c=s.positions[u],h=s.crossTileIDs[u];if(Math.abs(c.x-l.x)<=i&&Math.abs(c.y-l.y)<=i&&!n[h]){n[h]=!0,o.crossTileID=h;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}},f3e=class{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}},m3e=class{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){let r=Math.round((e-this.lng)/360);if(r!==0)for(let n in this.indexes){let i=this.indexes[n],a={};for(let o in i){let s=i[o];s.tileID=s.tileID.unwrapTo(s.tileID.wrap+r),a[s.tileID.key]=s}this.indexes[n]=a}this.lng=e}addBucket(e,r,n){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===r.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let a=0;a<r.symbolInstances.length;a++){let o=r.symbolInstances.get(a);o.crossTileID=0}this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});let i=this.usedCrossTileIDs[e.overscaledZ];for(let a in this.indexes){let o=this.indexes[a];if(Number(a)>e.overscaledZ)for(let s in o){let l=o[s];l.tileID.isChildOf(e)&&l.findMatches(r.symbolInstances,e,i)}else{let s=e.scaledTo(Number(a)),l=o[s.key];l&&l.findMatches(r.symbolInstances,e,i)}}for(let a=0;a<r.symbolInstances.length;a++){let o=r.symbolInstances.get(a);o.crossTileID||(o.crossTileID=n.generate(),i[o.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new p3e(e,r.symbolInstances,r.bucketInstanceId),!0}removeBucketCrossTileIDs(e,r){for(let n of r.getCrossTileIDsLists())for(let i of n)delete this.usedCrossTileIDs[e][i]}removeStaleBuckets(e){let r=!1;for(let n in this.indexes){let i=this.indexes[n];for(let a in i)e[i[a].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,i[a]),delete i[a],r=!0)}return r}},pX=class{constructor(){this.layerIndexes={},this.crossTileIDs=new f3e,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,r,n){let i=this.layerIndexes[e.id];i===void 0&&(i=this.layerIndexes[e.id]=new m3e);let a=!1,o={};i.handleWrapJump(n);for(let s of r){let l=s.getBucket(e);!l||e.id!==l.layerIds[0]||(l.bucketInstanceId||(l.bucketInstanceId=++this.maxBucketInstanceId),i.addBucket(s.tileID,l,this.crossTileIDs)&&(a=!0),o[l.bucketInstanceId]=!0)}return i.removeStaleBuckets(o)&&(a=!0),a}pruneUnusedLayers(e){let r={};e.forEach(n=>{r[n]=!0});for(let n in this.layerIndexes)r[n]||delete this.layerIndexes[n]}};C();C();C();C();var g3e=`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`;C();var y3e=`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`;C();var v3e=`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`;C();var _3e="in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}";C();var x3e=`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`;C();var b3e="uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}";C();var w3e=`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`;C();var A3e=`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`;C();var e8="void main() {fragColor=vec4(1.0);}";C();var S3e="in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}";C();var E3e=`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`;C();var I3e=`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`;C();var C3e=`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`;C();var M3e="uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}";C();var T3e="in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}";C();var P3e="in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}";C();var D3e="in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}";C();var k3e="in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}";C();var O3e=`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(textureSize(u_elevation_stops,0)[0]);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int num_elevation_stops=textureSize(u_elevation_stops,0)[0];int r=(num_elevation_stops-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(textureSize(u_color_stops,0)[0]);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`;C();var B3e="uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}";C();var z3e="uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}";C();var F3e="in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}";C();var R3e=`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`;C();var L3e=`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`;C();var N3e=`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`;C();var $3e=`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`;C();var U3e=`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`;C();var j3e=`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`;C();var V3e=`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`;C();var G3e=`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`;C();var Z3e=`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`;C();var W3e=`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`;C();var H3e=`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`;C();var X3e=`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`;C();var q3e=`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`;C();var Y3e=`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`;C();var J3e="uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}";C();var K3e=`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;switch(u_method){case BASIC:
basic_hillshade(deriv);break;case COMBINED:
combined_hillshade(deriv);break;case IGOR:
igor_hillshade(deriv);break;case MULTIDIRECTIONAL:
multidirectional_hillshade(deriv);break;case STANDARD:
default:
standard_hillshade(deriv);break;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`;C();var Q3e="uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}";C();var eSe=`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`;C();var tSe=`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`;C();var rSe=`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`;C();var nSe=`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`;C();var iSe=`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`;C();var aSe=`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`;C();var oSe=`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`;C();var sSe=`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`;C();var lSe=`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`;C();var uSe=`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`;C();var cSe=`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`;C();var hSe=`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`;C();var dSe=`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`;C();var pSe=`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`;C();var fSe=`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`;C();var mSe=`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`;C();var gSe="in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}";C();var ySe="precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}";C();var vSe="uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}";C();var _Se="in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}";C();var xSe="in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}";C();var bSe="in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}";C();var wSe="in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}";C();var ASe="in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}";C();var SSe="float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}";C();var ESe=`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`;C();var ISe=`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`;C();var CSe="in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}";C();var MSe="uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}";C();var TSe="in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}",bu={prelude:Hr(g3e,y3e),projectionMercator:Hr("",SSe),projectionGlobe:Hr("",ESe),background:Hr(v3e,_3e),backgroundPattern:Hr(x3e,b3e),circle:Hr(w3e,A3e),clippingMask:Hr(e8,S3e),heatmap:Hr(E3e,I3e),heatmapTexture:Hr(C3e,M3e),collisionBox:Hr(T3e,P3e),collisionCircle:Hr(D3e,k3e),colorRelief:Hr(O3e,B3e),debug:Hr(z3e,F3e),depth:Hr(e8,R3e),fill:Hr(L3e,N3e),fillOutline:Hr($3e,U3e),fillOutlinePattern:Hr(j3e,V3e),fillPattern:Hr(G3e,Z3e),fillExtrusion:Hr(W3e,H3e),fillExtrusionPattern:Hr(X3e,q3e),hillshadePrepare:Hr(Y3e,J3e),hillshade:Hr(K3e,Q3e),line:Hr(eSe,tSe),lineGradient:Hr(rSe,nSe),linePattern:Hr(iSe,aSe),lineSDF:Hr(oSe,sSe),raster:Hr(lSe,uSe),symbolIcon:Hr(cSe,hSe),symbolSDF:Hr(dSe,pSe),symbolTextAndIcon:Hr(fSe,mSe),terrain:Hr(vSe,_Se),terrainDepth:Hr(gSe,xSe),terrainCoords:Hr(ySe,bSe),projectionErrorMeasurement:Hr(ASe,wSe),atmosphere:Hr(ISe,CSe),sky:Hr(MSe,TSe)};function Hr(t,e){let r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,n=e.match(/in ([\w]+) ([\w]+)/g),i=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=a?a.concat(i):i,s={};return t=t.replace(r,(l,u,c,h,d)=>(s[d]=!0,u==="define"?`
#ifndef HAS_UNIFORM_u_`.concat(d,`
in `).concat(c," ").concat(h," ").concat(d,`;
#else
uniform `).concat(c," ").concat(h," u_").concat(d,`;
#endif
`):`
#ifdef HAS_UNIFORM_u_`.concat(d,`
    `).concat(c," ").concat(h," ").concat(d," = u_").concat(d,`;
#endif
`))),e=e.replace(r,(l,u,c,h,d)=>{let p=h==="float"?"vec2":"vec4",m=d.match(/color/)?"color":p;return s[d]?u==="define"?`
#ifndef HAS_UNIFORM_u_`.concat(d,`
uniform lowp float u_`).concat(d,`_t;
in `).concat(c," ").concat(p," a_").concat(d,`;
out `).concat(c," ").concat(h," ").concat(d,`;
#else
uniform `).concat(c," ").concat(h," u_").concat(d,`;
#endif
`):m==="vec4"?`
#ifndef HAS_UNIFORM_u_`.concat(d,`
    `).concat(d," = a_").concat(d,`;
#else
    `).concat(c," ").concat(h," ").concat(d," = u_").concat(d,`;
#endif
`):`
#ifndef HAS_UNIFORM_u_`.concat(d,`
    `).concat(d," = unpack_mix_").concat(m,"(a_").concat(d,", u_").concat(d,`_t);
#else
    `).concat(c," ").concat(h," ").concat(d," = u_").concat(d,`;
#endif
`):u==="define"?`
#ifndef HAS_UNIFORM_u_`.concat(d,`
uniform lowp float u_`).concat(d,`_t;
in `).concat(c," ").concat(p," a_").concat(d,`;
#else
uniform `).concat(c," ").concat(h," u_").concat(d,`;
#endif
`):m==="vec4"?`
#ifndef HAS_UNIFORM_u_`.concat(d,`
    `).concat(c," ").concat(h," ").concat(d," = a_").concat(d,`;
#else
    `).concat(c," ").concat(h," ").concat(d," = u_").concat(d,`;
#endif
`):`
#ifndef HAS_UNIFORM_u_`.concat(d,`
    `).concat(c," ").concat(h," ").concat(d," = unpack_mix_").concat(m,"(a_").concat(d,", u_").concat(d,`_t);
#else
    `).concat(c," ").concat(h," ").concat(d," = u_").concat(d,`;
#endif
`)}),{fragmentSource:t,vertexSource:e,staticAttributes:n,staticUniforms:o}}function PSe(t){return t.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}function DSe(t){return t.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}C();var v0=class{constructor(e,r,n){this.vertexBuffer=e,this.indexBuffer=r,this.segments=n}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}};C();var Kh=Si([{name:"a_pos",type:"Int16",components:2}]),fX="#define PROJECTION_MERCATOR",mX="mercator",BM=class{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return mX}get shaderDefine(){return fX}get shaderPreludeCode(){return bu.projectionMercator}get vertexShaderPreludeCode(){return bu.projectionMercator.vertexSource}get subdivisionGranularity(){return _k.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(t){}getMeshFromTileID(t,e,r,n,i){if(this._cachedMesh)return this._cachedMesh;let a=new kc;a.emplaceBack(0,0),a.emplaceBack(8192,0),a.emplaceBack(0,8192),a.emplaceBack(8192,8192);let o=t.createVertexBuffer(a,Kh.members),s=Hn.simpleSegment(0,0,4,2),l=new Vl;l.emplaceBack(1,0,2),l.emplaceBack(1,2,3);let u=t.createIndexBuffer(l);return this._cachedMesh=new v0(o,u,s),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(t){}};C();var ts=Zt(xr(),1);C();var $d=Zt(xr(),1);C();var kSe=Zt(xr(),1),t8=class gX{constructor(e=0,r=0,n=0,i=0){if(isNaN(e)||e<0||isNaN(r)||r<0||isNaN(n)||n<0||isNaN(i)||i<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=r,this.left=n,this.right=i}interpolate(e,r,n){return r.top!=null&&e.top!=null&&(this.top=di.number(e.top,r.top,n)),r.bottom!=null&&e.bottom!=null&&(this.bottom=di.number(e.bottom,r.bottom,n)),r.left!=null&&e.left!=null&&(this.left=di.number(e.left,r.left,n)),r.right!=null&&e.right!=null&&(this.right=di.number(e.right,r.right,n)),this}getCenter(e,r){let n=on((this.left+e-this.right)/2,0,e),i=on((this.top+r-this.bottom)/2,0,r);return new kSe.default(n,i)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new gX(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}};function O4(t,e){if(!t.renderWorldCopies||t.lngRange)return;let r=e.lng-t.center.lng;e.lng+=r>180?-360:r<-180?360:0}function r8(t){return Math.max(0,Math.floor(t))}var Ck=class{constructor(t,e,r,n,i,a){this._callbacks=t,this._tileSize=512,this._renderWorldCopies=a===void 0?!0:!!a,this._minZoom=e||0,this._maxZoom=r||22,this._minPitch=n??0,this._maxPitch=i??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new ar(0,0),this._elevation=0,this._zoom=0,this._tileZoom=r8(this._zoom),this._scale=mo(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new t8,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(t,e,r){this._latRange=t.latRange,this._lngRange=t.lngRange,this._width=t.width,this._height=t.height,this._center=t.center,this._elevation=t.elevation,this._minElevationForCurrentTile=t.minElevationForCurrentTile,this._zoom=t.zoom,this._tileZoom=r8(this._zoom),this._scale=mo(this._zoom),this._bearingInRadians=t.bearingInRadians,this._fovInRadians=t.fovInRadians,this._pitchInRadians=t.pitchInRadians,this._rollInRadians=t.rollInRadians,this._unmodified=t.unmodified,this._edgeInsets=new t8(t.padding.top,t.padding.bottom,t.padding.left,t.padding.right),this._minZoom=t.minZoom,this._maxZoom=t.maxZoom,this._minPitch=t.minPitch,this._maxPitch=t.maxPitch,this._renderWorldCopies=t.renderWorldCopies,this._cameraToCenterDistance=t.cameraToCenterDistance,this._nearZ=t.nearZ,this._farZ=t.farZ,this._autoCalculateNearFarZ=!r&&t.autoCalculateNearFarZ,e&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(t){this._minElevationForCurrentTile=t}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(t){this._minZoom!==t&&(this._minZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(t){this._minPitch!==t&&(this._minPitch=t,this.setPitch(Math.max(this.pitch,t)))}get maxPitch(){return this._maxPitch}setMaxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.setPitch(Math.min(this.pitch,t)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new $d.default(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(t){let e=Mp(t,-180,180)*Math.PI/180;this._bearingInRadians!==e&&(this._unmodified=!1,this._bearingInRadians=e,this._calcMatrices(),this._rotationMatrix=a1.create(),a1.rotate(this._rotationMatrix,this._rotationMatrix,-this._bearingInRadians))}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(t){let e=on(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==e&&(this._unmodified=!1,this._pitchInRadians=e,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(t){let e=t/180*Math.PI;this._rollInRadians!==e&&(this._unmodified=!1,this._rollInRadians=e,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return Lm(this._fovInRadians)}setFov(t){t=on(t,.1,150),this.fov!==t&&(this._unmodified=!1,this._fovInRadians=Zn(t),this._calcMatrices())}get zoom(){return this._zoom}setZoom(t){let e=this.getConstrained(this._center,t).zoom;this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this._tileZoom=Math.max(0,Math.floor(e)),this._scale=mo(e),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(t,e){this._autoCalculateNearFarZ=!1,this._nearZ=t,this._farZ=e,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,e,r){this._unmodified=!1,this._edgeInsets.interpolate(t,e,r),this._constrain(),this._calcMatrices()}resize(t,e,r=!0){this._width=t,this._height=e,r&&this._constrain(),this._calcMatrices()}getMaxBounds(){return!this._latRange||this._latRange.length!==2||!this._lngRange||this._lngRange.length!==2?null:new Vc([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]])}setMaxBounds(t){t?(this._lngRange=[t.getWest(),t.getEast()],this._latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-Cu,Cu])}getConstrained(t,e){return this._callbacks.getConstrained(t,e)}getCameraQueryGeometry(t,e){if(e.length===1)return[e[0],t];{let{minX:r,minY:n,maxX:i,maxY:a}=Eu.fromPoints(e).extend(t);return[new $d.default(r,n),new $d.default(i,n),new $d.default(i,a),new $d.default(r,a),new $d.default(r,n)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;let t=this._unmodified,{center:e,zoom:r}=this.getConstrained(this.center,this.zoom);this.setCenter(e),this.setZoom(r),this._unmodified=t,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let t=Xe.identity(new Float64Array(16));Xe.scale(t,t,[this._width/2,-this._height/2,1]),Xe.translate(t,t,[1,-1,0]),this._clipSpaceToPixelsMatrix=t,t=Xe.identity(new Float64Array(16)),Xe.scale(t,t,[1,-1,1]),Xe.translate(t,t,[-1,-1,0]),Xe.scale(t,t,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=t;let e=this.fovInRadians/2;this._cameraToCenterDistance=.5/Math.tan(e)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(t,e,r,n){let i=r!==void 0?r:this.bearing,a=n=n!==void 0?n:this.pitch,o=Mn.fromLngLat(t,e),s=-Math.cos(Zn(a)),l=Math.sin(Zn(a)),u=l*Math.sin(Zn(i)),c=-l*Math.cos(Zn(i)),h=this.elevation,d=e-h,p;s*d>=0||Math.abs(s)<.1?(p=1e4,h=e+p*s):p=-d/s;let m=SM(1,o.y),y,v,_=0,w=10;do{if(_+=1,_>w)break;v=p/m;let E=u*v,M=c*v;y=new Mn(o.x+E,o.y+M),m=1/y.meterInMercatorCoordinateUnits()}while(Math.abs(p-v*m)>1e-12);let b=y.toLngLat(),A=go(this.height/2/Math.tan(this.fovInRadians/2)/v/this.tileSize);return{center:b,elevation:h,zoom:A}}recalculateZoomAndCenter(t){if(this.elevation-t===0)return;let e=Dp(1,this.center.lat)*this.worldSize,r=this.cameraToCenterDistance/e,n=Mn.fromLngLat(this.center,this.elevation),i=MM(this.center,this.elevation,this.pitch,this.bearing,r);this._elevation=t;let a=this.calculateCenterFromCameraLngLatAlt(i.toLngLat(),SM(i.z,n.y),this.bearing,this.pitch);this._elevation=a.elevation,this._center=a.center,this.setZoom(a.zoom)}getCameraPoint(){let t=this.pitchInRadians,e=Math.tan(t)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new $d.default(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){let t=Dp(1,this.center.lat)*this.worldSize,e=this.cameraToCenterDistance/t;return MM(this.center,this.elevation,this.pitch,this.bearing,e).toLngLat()}getMercatorTileCoordinates(t){if(!t)return[0,0,1,1];let e=t.canonical.z>=0?1<<t.canonical.z:Math.pow(2,t.canonical.z);return[t.canonical.x/e,t.canonical.y/e,1/e/8192,1/e/8192]}};C();C();var yX=class vX{constructor(e,r){this.min=e,this.max=r,this.center=Qe.scale([],Qe.add([],this.min,this.max),.5)}quadrant(e){let r=[e%2===0,e<2],n=Qe.clone(this.min),i=Qe.clone(this.max);for(let a=0;a<r.length;a++)n[a]=r[a]?this.min[a]:this.center[a],i[a]=r[a]?this.center[a]:this.max[a];return i[2]=this.max[2],new vX(n,i)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let r=!0;for(let n=0;n<e.planes.length;n++){let i=this.intersectsPlane(e.planes[n]);if(i===0)return 0;i===1&&(r=!1)}return r?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let r=e[3],n=e[3];for(let i=0;i<3;i++)e[i]>0?(r+=e[i]*this.min[i],n+=e[i]*this.max[i]):(n+=e[i]*this.min[i],r+=e[i]*this.max[i]);return r>=0?2:n<0?0:1}},OSe=class{distanceToTile2d(e,r,n,i){let a=i.distanceX([e,r]),o=i.distanceY([e,r]);return Math.hypot(a,o)}getWrap(e,r,n){return n}getTileBoundingVolume(e,r,n,i){var a,o;let s=0,l=0;if(i!=null&&i.terrain){let c=new Ga(e.z,r,e.z,e.x,e.y),h=i.terrain.getMinMaxElevation(c);s=(a=h.minElevation)!=null?a:Math.min(0,n),l=(o=h.maxElevation)!=null?o:Math.max(0,n)}let u=1<<e.z;return new yX([r+e.x/u,e.y/u,s],[r+(e.x+1)/u,(e.y+1)/u,l])}allowVariableZoom(e,r){let n=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,i=on(78.5-n/2,0,60);return!!r.terrain||e.pitch>i}allowWorldCopies(){return!0}prepareNextFrame(){}};C();var _X=class xX{constructor(e,r,n){this.points=e,this.planes=r,this.aabb=n}static fromInvProjectionMatrix(e,r=1,n=0,i,a){let o=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]],s=a?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],l=Math.pow(2,n),u=o.map(p=>BSe(p,e,r,l));i&&zSe(u,s[0],i,a);let c=s.map(p=>{let m=Qe.sub([],u[p[0]],u[p[1]]),y=Qe.sub([],u[p[2]],u[p[1]]),v=Qe.normalize([],Qe.cross([],m,y)),_=-Qe.dot(v,u[p[1]]);return v.concat(_)}),h=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],d=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(let p of u)for(let m=0;m<3;m++)h[m]=Math.min(h[m],p[m]),d[m]=Math.max(d[m],p[m]);return new xX(u,c,new yX(h,d))}};function BSe(t,e,r,n){let i=Pi.transformMat4([],t,e),a=1/i[3]/r*n;return Pi.mul(i,i,[a,a,1/i[3],a])}function zSe(t,e,r,n){let i=n?4:0,a=n?0:4,o=0,s=[],l=[];for(let h=0;h<4;h++){let d=Qe.sub([],t[h+a],t[h+i]),p=Qe.length(d);Qe.scale(d,d,1/p),s.push(p),l.push(d)}for(let h=0;h<4;h++){let d=l1e(t[h+i],l[h],r);d!==null&&d>=0?o=Math.max(o,d):o=Math.max(o,s[h])}let u=FSe(t,e),c=RSe(r,u);if(c!==null){let h=c/Qe.dot(l[0],u);o=Math.min(o,h)}for(let h=0;h<4;h++){let d=Math.min(o,s[h]),p=[t[h+i][0]+l[h][0]*d,t[h+i][1]+l[h][1]*d,t[h+i][2]+l[h][2]*d,1];t[h+a]=p}}function FSe(t,e){let r=Qe.sub([],t[e[0]],t[e[1]]),n=Qe.sub([],t[e[2]],t[e[1]]),i=[0,0,0,0];return Qe.normalize(i,Qe.cross([],r,n)),i[3]=-Qe.dot(i,t[e[0]]),i}function RSe(t,e){let r=Qe.len(t),n=Pi.scale([],t,1/r),i=Qe.sub([],e,Qe.scale([],n,Qe.dot(e,n))),a=Qe.len(i);if(a>0){let o=Math.sqrt(1-n[3]*n[3]),s=Qe.scale([],n,-n[3]),l=Qe.add([],s,Qe.scale([],i,o/a));return VC(e,l)}else return null}var B4=class bX{constructor(e,r,n,i,a){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Ck({calcMatrices:()=>{this._calcMatrices()},getConstrained:(o,s)=>this.getConstrained(o,s)},e,r,n,i,a),this._coveringTilesDetailsProvider=new OSe}get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,n){return this._helper.interpolatePadding(e,r,n)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r,n=!0){this._helper.resize(e,r,n)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,r){}clone(){let e=new bX;return e.apply(this),e}apply(e,r,n){this._helper.apply(e,r,n)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){let r=[new D4(0,e)];if(this._helper._renderWorldCopies){let n=this.screenPointToMercatorCoordinate(new ts.default(0,0)),i=this.screenPointToMercatorCoordinate(new ts.default(this._helper._width,0)),a=this.screenPointToMercatorCoordinate(new ts.default(this._helper._width,this._helper._height)),o=this.screenPointToMercatorCoordinate(new ts.default(0,this._helper._height)),s=Math.floor(Math.min(n.x,i.x,a.x,o.x)),l=Math.floor(Math.max(n.x,i.x,a.x,o.x)),u=1;for(let c=s-u;c<=l+u;c++)c!==0&&r.push(new D4(c,e))}return r}getCameraFrustum(){return _X.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){let r=this.screenPointToLocation(this.centerPoint,e),n=e?e.getElevationForLngLatZoom(r,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(n)}setLocationAtPoint(e,r){let n=Dp(this.elevation,this.center.lat),i=this.screenPointToMercatorCoordinateAtZ(r,n),a=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,n),o=Mn.fromLngLat(e),s=new Mn(o.x-(i.x-a.x),o.y-(i.y-a.y));this.setCenter(s?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,r){return r?this.coordinatePoint(Mn.fromLngLat(e),r.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(Mn.fromLngLat(e))}screenPointToLocation(e,r){var n;return(n=this.screenPointToMercatorCoordinate(e,r))==null?void 0:n.toLngLat()}screenPointToMercatorCoordinate(e,r){if(r){let n=r.pointCoordinate(e);if(n!=null)return n}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,r){let n=r||0,i=[e.x,e.y,0,1],a=[e.x,e.y,1,1];Pi.transformMat4(i,i,this._pixelMatrixInverse),Pi.transformMat4(a,a,this._pixelMatrixInverse);let o=i[3],s=a[3],l=i[0]/o,u=a[0]/s,c=i[1]/o,h=a[1]/s,d=i[2]/o,p=a[2]/s,m=d===p?0:(n-d)/(p-d);return new Mn(di.number(l,u,m)/this.worldSize,di.number(c,h,m)/this.worldSize,n)}coordinatePoint(e,r=0,n=this._pixelMatrix){let i=[e.x*this.worldSize,e.y*this.worldSize,r,1];return Pi.transformMat4(i,i,n),new ts.default(i[0]/i[3],i[1]/i[3])}getBounds(){let e=Math.max(0,this._helper._height/2-Jb(this));return new Vc().extend(this.screenPointToLocation(new ts.default(0,e))).extend(this.screenPointToLocation(new ts.default(this._helper._width,e))).extend(this.screenPointToLocation(new ts.default(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new ts.default(0,this._helper._height)))}isPointOnMapSurface(e,r){return r?r.pointCoordinate(e)!=null:e.y>this.height/2-Jb(this)}calculatePosMatrix(e,r=!1,n){var i;let a=(i=e.key)!=null?i:ag(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),o=r?this._alignedPosMatrixCache:this._posMatrixCache;if(o.has(a)){let u=o.get(a);return n?u.f32:u.f64}let s=RE(e,this.worldSize);Xe.multiply(s,r?this._alignedProjMatrix:this._viewProjMatrix,s);let l={f64:s,f32:new Float32Array(s)};return o.set(a,l),n?l.f32:l.f64}calculateFogMatrix(e){let r=e.key,n=this._fogMatrixCacheF32;if(n.has(r))return n.get(r);let i=RE(e,this.worldSize);return Xe.multiply(i,this._fogMatrix,i),n.set(r,new Float32Array(i)),n.get(r)}getConstrained(e,r){r=on(+r,this.minZoom,this.maxZoom);let n={center:new ar(e.lng,e.lat),zoom:r},i=this._helper._lngRange;if(!this._helper._renderWorldCopies&&i===null){let b=179.9999999999;i=[-b,b]}let a=this.tileSize*mo(n.zoom),o=0,s=a,l=0,u=a,c=0,h=0,{x:d,y:p}=this.size;if(this._helper._latRange){let b=this._helper._latRange;o=jp(b[1])*a,s=jp(b[0])*a,s-o<p&&(c=p/(s-o))}i&&(l=Mp(Ng(i[0])*a,0,a),u=Mp(Ng(i[1])*a,0,a),u<l&&(u+=a),u-l<d&&(h=d/(u-l)));let{x:m,y}=xu(a,e),v,_,w=Math.max(h||0,c||0);if(w){let b=new ts.default(h?(u+l)/2:m,c?(s+o)/2:y);return n.center=A1(a,b).wrap(),n.zoom+=go(w),n}if(this._helper._latRange){let b=p/2;y-b<o&&(_=o+b),y+b>s&&(_=s-b)}if(i){let b=(l+u)/2,A=m;this._helper._renderWorldCopies&&(A=Mp(m,b-a/2,b+a/2));let E=d/2;A-E<l&&(v=l+E),A+E>u&&(v=u-E)}if(v!==void 0||_!==void 0){let b=new ts.default(v??m,_??y);n.center=A1(a,b).wrap()}return n}calculateCenterFromCameraLngLatAlt(e,r,n,i){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,n,i)}_calculateNearFarZIfNeeded(e,r,n){if(!this._helper.autoCalculateNearFarZ)return;let i=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),a=e-i*this._helper._pixelPerMeter/Math.cos(r),o=i<0?a:e,s=Math.PI/2+this.pitchInRadians,l=Zn(this.fov)*(Math.abs(Math.cos(Zn(this.roll)))*this.height+Math.abs(Math.sin(Zn(this.roll)))*this.width)/this.height*(.5+n.y/this.height),u=Math.sin(l)*o/Math.sin(on(Math.PI-s-l,.01,Math.PI-.01)),c=Jb(this),h=Math.atan(c/this._helper.cameraToCenterDistance),d=Zn(90-og),p=h>d?2*h*(.5+n.y/(c*2)):d,m=Math.sin(p)*o/Math.sin(on(Math.PI-s-p,.01,Math.PI-.01)),y=Math.min(u,m);this._helper._farZ=(Math.cos(Math.PI/2-r)*y+o)*1.01,this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;let e=this.centerOffset,r=xu(this.worldSize,this.center),n=r.x,i=r.y;this._helper._pixelPerMeter=Dp(1,this.center.lat)*this.worldSize;let a=Zn(Math.min(this.pitch,og)),o=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(a));this._calculateNearFarZIfNeeded(o,a,e);let s;s=new Float64Array(16),Xe.perspective(s,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),Xe.invert(this._invProjMatrix,s),s[8]=-e.x*2/this._helper._width,s[9]=e.y*2/this._helper._height,this._projectionMatrix=Xe.clone(s),Xe.scale(s,s,[1,-1,1]),Xe.translate(s,s,[0,0,-this._helper.cameraToCenterDistance]),Xe.rotateZ(s,s,-this.rollInRadians),Xe.rotateX(s,s,this.pitchInRadians),Xe.rotateZ(s,s,-this.bearingInRadians),Xe.translate(s,s,[-n,-i,0]),this._mercatorMatrix=Xe.scale([],s,[this.worldSize,this.worldSize,this.worldSize]),Xe.scale(s,s,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=Xe.multiply(new Float64Array(16),this.clipSpaceToPixelsMatrix,s),Xe.translate(s,s,[0,0,-this.elevation]),this._viewProjMatrix=s,this._invViewProjMatrix=Xe.invert([],s);let l=[0,0,-1,1];Pi.transformMat4(l,l,this._invViewProjMatrix),this._cameraPosition=[l[0]/l[3],l[1]/l[3],l[2]/l[3]],this._fogMatrix=new Float64Array(16),Xe.perspective(this._fogMatrix,this.fovInRadians,this.width/this.height,o,this._helper._farZ),this._fogMatrix[8]=-e.x*2/this.width,this._fogMatrix[9]=e.y*2/this.height,Xe.scale(this._fogMatrix,this._fogMatrix,[1,-1,1]),Xe.translate(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),Xe.rotateZ(this._fogMatrix,this._fogMatrix,-this.rollInRadians),Xe.rotateX(this._fogMatrix,this._fogMatrix,this.pitchInRadians),Xe.rotateZ(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),Xe.translate(this._fogMatrix,this._fogMatrix,[-n,-i,0]),Xe.scale(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),Xe.translate(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=Xe.multiply(new Float64Array(16),this.clipSpaceToPixelsMatrix,s);let u=this._helper._width%2/2,c=this._helper._height%2/2,h=Math.cos(this.bearingInRadians),d=Math.sin(-this.bearingInRadians),p=n-Math.round(n)+h*u+d*c,m=i-Math.round(i)+h*c+d*u,y=new Float64Array(s);if(Xe.translate(y,y,[p>.5?p-1:p,m>.5?m-1:m,0]),this._alignedProjMatrix=y,s=Xe.invert(new Float64Array(16),this._pixelMatrix),!s)throw new Error("failed to invert matrix");this._pixelMatrixInverse=s,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;let e=this.screenPointToMercatorCoordinate(new ts.default(0,0)),r=[e.x*this.worldSize,e.y*this.worldSize,0,1];return Pi.transformMat4(r,r,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){let e=Dp(1,this.center.lat)*this.worldSize,r=this._helper.cameraToCenterDistance/e;return MM(this.center,this.elevation,this.pitch,this.bearing,r).toLngLat()}lngLatToCameraDepth(e,r){let n=Mn.fromLngLat(e),i=[n.x*this.worldSize,n.y*this.worldSize,r,1];return Pi.transformMat4(i,i,this._viewProjMatrix),i[2]/i[3]}getProjectionData(e){let{overscaledTileID:r,aligned:n,applyTerrainMatrix:i}=e,a=this._helper.getMercatorTileCoordinates(r),o=r?this.calculatePosMatrix(r,n,!0):null,s;return r&&r.terrainRttPosMatrix32f&&i?s=r.terrainRttPosMatrix32f:o?s=o:s=DZ(),{mainMatrix:s,tileMercatorCoords:a,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:s}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,r,n){return 1}transformLightDirection(e){return Qe.clone(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,r,n,i){let a=this.calculatePosMatrix(n),o;i?(o=[e,r,i(e,r),1],Pi.transformMat4(o,o,a)):(o=[e,r,0,1],Ik(o,o,a));let s=o[3];return{point:new ts.default(o[0]/s,o[1]/s),signedDistanceFromCamera:s,isOccluded:!1}}populateCache(e){for(let r of e)this.calculatePosMatrix(r)}getMatrixForModel(e,r){let n=Mn.fromLngLat(e,r),i=n.meterInMercatorCoordinateUnits(),a=Lf();return Xe.translate(a,a,[n.x,n.y,n.z]),Xe.rotateZ(a,a,Math.PI),Xe.rotateX(a,a,Math.PI/2),Xe.scale(a,a,[-i,i,i]),a}getProjectionDataForCustomLayer(e=!0){let r=new Ga(0,0,0,0,0),n=this.getProjectionData({overscaledTileID:r,applyGlobeMatrix:e}),i=RE(r,this.worldSize);Xe.multiply(i,this._viewProjMatrix,i),n.tileMercatorCoords=[0,0,1,1];let a=[8192,8192,this.worldSize/this._helper.pixelsPerMeter],o=Wh();return Xe.scale(o,i,a),n.fallbackMatrix=o,n.mainMatrix=o,n}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}};C();C();var Jx=Zt(xr(),1);function wX(){Ui("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function AX(t){if(t.useSlerp)if(t.k<1){let e=Sz(t.startEulerAngles.roll,t.startEulerAngles.pitch,t.startEulerAngles.bearing),r=Sz(t.endEulerAngles.roll,t.endEulerAngles.pitch,t.endEulerAngles.bearing),n=new Float64Array(4);qA.slerp(n,e,r,t.k);let i=w1e(n);t.tr.setRoll(i.roll),t.tr.setPitch(i.pitch),t.tr.setBearing(i.bearing)}else t.tr.setRoll(t.endEulerAngles.roll),t.tr.setPitch(t.endEulerAngles.pitch),t.tr.setBearing(t.endEulerAngles.bearing);else t.tr.setRoll(di.number(t.startEulerAngles.roll,t.endEulerAngles.roll,t.k)),t.tr.setPitch(di.number(t.startEulerAngles.pitch,t.endEulerAngles.pitch,t.k)),t.tr.setBearing(di.number(t.startEulerAngles.bearing,t.endEulerAngles.bearing,t.k))}function SX(t,e,r,n,i){let a=i.padding,o=xu(i.worldSize,r.getNorthWest()),s=xu(i.worldSize,r.getNorthEast()),l=xu(i.worldSize,r.getSouthEast()),u=xu(i.worldSize,r.getSouthWest()),c=Zn(-n),h=o.rotate(c),d=s.rotate(c),p=l.rotate(c),m=u.rotate(c),y=new Jx.default(Math.max(h.x,d.x,m.x,p.x),Math.max(h.y,d.y,m.y,p.y)),v=new Jx.default(Math.min(h.x,d.x,m.x,p.x),Math.min(h.y,d.y,m.y,p.y)),_=y.sub(v),w=i.width-(a.left+a.right+e.left+e.right),b=i.height-(a.top+a.bottom+e.top+e.bottom),A=w/_.x,E=b/_.y;if(E<0||A<0){wX();return}let M=Math.min(go(i.scale*Math.min(A,E)),t.maxZoom),P=Jx.default.convert(t.offset),k=(e.left-e.right)/2,D=(e.top-e.bottom)/2,O=new Jx.default(k,D).rotate(Zn(n)),B=P.add(O).mult(i.scale/mo(M));return{center:A1(i.worldSize,o.add(l).div(2).sub(B)),zoom:M,bearing:n}}var z4=class{get useGlobeControls(){return!1}handlePanInertia(e,r){return{easingOffset:e,easingCenter:r.center}}handleMapControlsRollPitchBearingZoom(e,r){e.bearingDelta&&r.setBearing(r.bearing+e.bearingDelta),e.pitchDelta&&r.setPitch(r.pitch+e.pitchDelta),e.rollDelta&&r.setRoll(r.roll+e.rollDelta),e.zoomDelta&&r.setZoom(r.zoom+e.zoomDelta)}handleMapControlsPan(e,r,n){e.around.distSqr(r.centerPoint)<.01||r.setLocationAtPoint(n,e.around)}cameraForBoxAndBearing(e,r,n,i,a){return SX(e,r,n,i,a)}handleJumpToCenterZoom(e,r){let n=typeof r.zoom<"u"?+r.zoom:e.zoom;e.zoom!==n&&e.setZoom(+r.zoom),r.center!==void 0&&e.setCenter(ar.convert(r.center))}handleEaseTo(e,r){let n=e.zoom,i=e.padding,a={roll:e.roll,pitch:e.pitch,bearing:e.bearing},o=r.roll===void 0?e.roll:r.roll,s=r.pitch===void 0?e.pitch:r.pitch,l=r.bearing===void 0?e.bearing:r.bearing,u={roll:o,pitch:s,bearing:l},c=typeof r.zoom<"u",h=!e.isPaddingEqual(r.padding),d=!1,p=c?+r.zoom:e.zoom,m=e.centerPoint.add(r.offsetAsPoint),y=e.screenPointToLocation(m),{center:v,zoom:_}=e.getConstrained(ar.convert(r.center||y),p??n);O4(e,v);let w=xu(e.worldSize,y),b=xu(e.worldSize,v).sub(w),A=mo(_-n);return d=_!==n,{easeFunc:E=>{if(d&&e.setZoom(di.number(n,_,E)),zZ(a,u)||AX({startEulerAngles:a,endEulerAngles:u,tr:e,k:E,useSlerp:a.roll!=u.roll}),h&&(e.interpolatePadding(i,r.padding,E),m=e.centerPoint.add(r.offsetAsPoint)),r.around)e.setLocationAtPoint(r.around,r.aroundPoint);else{let M=mo(e.zoom-n),P=_>n?Math.min(2,A):Math.max(.5,A),k=Math.pow(P,1-E),D=A1(e.worldSize,w.add(b.mult(E*k)).mult(M));e.setLocationAtPoint(e.renderWorldCopies?D.wrap():D,m)}},isZooming:d,elevationCenter:v}}handleFlyTo(e,r){let n=typeof r.zoom<"u",i=e.zoom,a=e.getConstrained(ar.convert(r.center||r.locationAtOffset),n?+r.zoom:i),o=a.center,s=a.zoom;O4(e,o);let l=xu(e.worldSize,r.locationAtOffset),u=xu(e.worldSize,o).sub(l),c=u.mag(),h=mo(s-i),d=typeof r.minZoom<"u",p;if(d){let m=Math.min(+r.minZoom,i,s),y=e.getConstrained(o,m).zoom;p=mo(y-i)}return{easeFunc:(m,y,v,_)=>{e.setZoom(m===1?s:i+go(y));let w=m===1?o:A1(e.worldSize,l.add(u.mult(v)).mult(y));e.setLocationAtPoint(e.renderWorldCopies?w.wrap():w,_)},scaleOfZoom:h,targetCenter:o,scaleOfMinZoom:p,pixelPathLength:c}}};C();C();C();C();var LSe=0,EX=1,NSe=771,ri=class{constructor(e,r,n){this.blendFunction=e,this.blendColor=r,this.mask=n}};ri.Replace=[EX,LSe];ri.disabled=new ri(ri.Replace,Gt.transparent,[!1,!1,!1,!1]);ri.unblended=new ri(ri.Replace,Gt.transparent,[!0,!0,!0,!0]);ri.alphaBlended=new ri([EX,NSe],Gt.transparent,[!0,!0,!0,!0]);C();var Xr=class{constructor(t,e,r){this.enable=t,this.mode=e,this.frontFace=r}};Xr.disabled=new Xr(!1,1029,2305);Xr.backCCW=new Xr(!0,1029,2305);Xr.frontCCW=new Xr(!0,1028,2305);C();var wr=class{constructor(e,r,n){this.func=e,this.mask=r,this.range=n}};wr.ReadOnly=!1;wr.ReadWrite=!0;wr.disabled=new wr(519,wr.ReadOnly,[0,1]);C();var Jr=class{constructor(e,r,n,i,a,o){this.test=e,this.ref=r,this.mask=n,this.fail=i,this.depthFail=a,this.pass=o}};Jr.disabled=new Jr({func:519,mask:0},0,0,7680,7680,7680);C();var $Se=(t,e)=>({u_input:new dt(t,e.u_input),u_output_expected:new dt(t,e.u_output_expected)}),USe=(t,e)=>({u_input:t,u_output_expected:e});C();var $E=new WeakMap;function Nc(t){var e;if($E.has(t))return $E.get(t);{let r=(e=t.getParameter(t.VERSION))==null?void 0:e.startsWith("WebGL 2.0");return $E.set(t,r),r}}var jSe=class IX{constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;let r=e.context,n=r.gl;this._texFormat=n.RGBA,this._texType=n.UNSIGNED_BYTE;let i=new kc;i.emplaceBack(-1,-1),i.emplaceBack(2,-1),i.emplaceBack(-1,2);let a=new Vl;a.emplaceBack(0,1,2),this._fullscreenTriangle=new v0(r.createVertexBuffer(i,Kh.members),r.createIndexBuffer(a),Hn.simpleSegment(0,0,i.length,a.length)),this._resultBuffer=new Uint8Array(4),r.activeTexture.set(n.TEXTURE1);let o=n.createTexture();n.bindTexture(n.TEXTURE_2D,o),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texImage2D(n.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=r.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(o),Nc(n)&&(this._pbo=n.createBuffer(),n.bindBuffer(n.PIXEL_PACK_BUFFER,this._pbo),n.bufferData(n.PIXEL_PACK_BUFFER,4,n.STREAM_READ),n.bindBuffer(n.PIXEL_PACK_BUFFER,null))}get awaitingQuery(){return!!this._readbackQueue}destroy(){let e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,r){let n=this._updateCount;return this._readbackQueue?n>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():n>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,r),this._updateCount++,this._measuredError}_bindFramebuffer(){let e=this._cachedRenderContext.context,r=e.gl;e.activeTexture.set(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,r){let n=this._cachedRenderContext.context,i=n.gl;if(this._bindFramebuffer(),n.viewport.set([0,0,this._texWidth,this._texHeight]),n.clear({color:Gt.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(n,i.TRIANGLES,wr.disabled,Jr.disabled,ri.unblended,Xr.disabled,USe(e,r),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Nc(i)){i.bindBuffer(i.PIXEL_PACK_BUFFER,this._pbo),i.readBuffer(i.COLOR_ATTACHMENT0),i.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),i.bindBuffer(i.PIXEL_PACK_BUFFER,null);let a=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);i.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:a}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){let e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Nc(e)){let r=e.clientWaitSync(this._readbackQueue.sync,0,0);if(r===e.WAIT_FAILED){Ui("WebGL2 clientWaitSync failed."),this._readbackQueue=null,this._lastReadbackFrame=this._updateCount;return}if(r===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=IX._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let r=0;return r+=e[0]/256,r+=e[1]/65536,r+=e[2]/16777216,e[3]<127&&(r=-r),r/128}};C();var Kx=8192/128;function VSe(t,e){let r=GSe(e,"16bit"),n=kc.deserialize({arrayBuffer:r.vertices,length:r.vertices.byteLength/2/2}),i=Vl.deserialize({arrayBuffer:r.indices,length:r.indices.byteLength/2/3});return new v0(t.createVertexBuffer(n,Kh.members),t.createIndexBuffer(i),Hn.simpleSegment(0,0,n.length,i.length))}function GSe(t,e){let r=t.granularity!==void 0?Math.max(t.granularity,1):1,n=r+(t.generateBorders?2:0),i=r+(t.extendToNorthPole||t.generateBorders?1:0)+(t.extendToSouthPole||t.generateBorders?1:0),a=n+1,o=i+1,s=t.generateBorders?-1:0,l=t.generateBorders||t.extendToNorthPole?-1:0,u=r+(t.generateBorders?1:0),c=r+(t.generateBorders||t.extendToSouthPole?1:0),h=a*o,d=n*i*6,p=a*o>65536;if(p&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");let m=p||e==="32bit",y=new Int16Array(h*2),v=0;for(let b=l;b<=c;b++)for(let A=s;A<=u;A++){let E=A/r*8192;A===-1&&(E=-Kx),A===r+1&&(E=8192+Kx);let M=b/r*8192;b===-1&&(M=t.extendToNorthPole?Vh:-Kx),b===r+1&&(M=t.extendToSouthPole?op:8192+Kx),y[v++]=E,y[v++]=M}let _=m?new Uint32Array(d):new Uint16Array(d),w=0;for(let b=0;b<i;b++)for(let A=0;A<n;A++){let E=A+b*a,M=A+1+b*a,P=A+(b+1)*a,k=A+1+(b+1)*a;_[w++]=E,_[w++]=P,_[w++]=M,_[w++]=M,_[w++]=P,_[w++]=k}return{vertices:y.buffer.slice(0),indices:_.buffer.slice(0),uses32bitIndices:m}}var ZSe="#define GLOBE",WSe="globe",n8={errorTransitionTimeSeconds:.5},UE=new _k({fill:new Oc(128,2),line:new Oc(512,0),tile:new Oc(128,32),stencil:new Oc(128,1),circle:3}),CX=class{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return WSe}get shaderDefine(){return ZSe}get shaderPreludeCode(){return bu.projectionGlobe}get vertexShaderPreludeCode(){return bu.projectionMercator.vertexSource}get subdivisionGranularity(){return UE}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new jSe(e));let r=jp(this._errorQueryLatitudeDegrees),n=2*Math.atan(Math.exp(Math.PI-r*Math.PI*2))-Math.PI*.5,i=this._errorMeasurement.updateErrorLoop(r,n),a=Dr.now();i!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=i,this._errorMeasurementLastChangeTime=a);let o=(a-this._errorMeasurementLastChangeTime)/1e3,s=Math.min(Math.max(o/n8.errorTransitionTimeSeconds,0),1),l=-this._errorMeasurementLastValue;this._errorCorrectionUsable=rg(this._errorCorrectionPreviousValue,l,kZ(s))}_getMeshKey(e){return"".concat(e.granularity.toString(36),"_").concat(e.generateBorders?"b":"").concat(e.extendToNorthPole?"n":"").concat(e.extendToSouthPole?"s":"")}getMeshFromTileID(e,r,n,i,a){let o=(a==="stencil"?UE.stencil:UE.tile).getGranularityForZoomLevel(r.z),s=r.y===0&&i,l=r.y===(1<<r.z)-1&&i;return this._getMesh(e,{granularity:o,generateBorders:n,extendToNorthPole:s,extendToSouthPole:l})}_getMesh(e,r){let n=this._getMeshKey(r);if(n in this._tileMeshCache)return this._tileMeshCache[n];let i=VSe(e,r);return this._tileMeshCache[n]=i,i}recalculate(e){}hasTransition(){let e=Dr.now(),r=!1;return r=r||(e-this._errorMeasurementLastChangeTime)/1e3<n8.errorTransitionTimeSeconds+.2,r=r||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,r}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}},HSe=new Oa({type:new It(Oe.projection.type)}),i8=class extends Xo{constructor(e){super(),this._transitionable=new m3(HSe),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new Fi(0)),this._mercatorProjection=new BM,this._verticalPerspectiveProjection=new CX}get transitionState(){let e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof qp){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,r,n,i,a){return this.currentProjection.getMeshFromTileID(e,r,n,i,a)}setProjection(e){this._transitionable.setValue("type",e?.type||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}};C();C();var Hl=Zt(xr(),1);C();function MX(t){let e=M3(t.worldSize,t.center.lat);return 2*Math.PI*e}function XSe(t,e,r){let n=Va(e),i=Va(r),a=Qe.dot(n,i),o=Math.acos(a),s=MX(t);return o/(2*Math.PI)*s}function qSe(t,e){let r=Tg(t*Math.PI*2+Math.PI,Math.PI*2),n=2*Math.atan(Math.exp(Math.PI-e*Math.PI*2))-Math.PI*.5;return[r,n]}function YSe(t,e){let r=Math.cos(e),n=new Float64Array(3);return n[0]=Math.sin(t)*r,n[1]=Math.sin(e),n[2]=Math.cos(t)*r,n}function Ah(t,e,r,n,i){let a=1/(1<<i),o=t/8192*a+r*a,s=e/8192*a+n*a,l=Tg(o*Math.PI*2+Math.PI,Math.PI*2),u=2*Math.atan(Math.exp(Math.PI-s*Math.PI*2))-Math.PI*.5,c=Math.cos(u),h=new Float64Array(3);return h[0]=Math.sin(l)*c,h[1]=Math.sin(u),h[2]=Math.cos(l)*c,h}function Va(t){return YSe(t.lng*Math.PI/180,t.lat*Math.PI/180)}function M3(t,e){return t/(2*Math.PI)/Math.cos(e*Math.PI/180)}function a8(t){let e=Math.asin(t[1])/Math.PI*180,r=Math.sqrt(t[0]*t[0]+t[2]*t[2]);if(r>1e-6){let n=t[0]/r,i=t[2]/r,a=Math.acos(i),o=(n>0?a:-a)/Math.PI*180;return new ar(Mp(o,-180,180),e)}else return new ar(0,e)}function JSe(t){let e=Li();e[0]=t[0]*-t[3],e[1]=t[1]*-t[3],e[2]=t[2]*-t[3];let r=Math.sqrt(1-t[3]*t[3]);return{center:e,radius:r}}function KSe(t,e,r){let n=Li();Qe.sub(n,r,t);let i=Li();return Qe.scaleAndAdd(i,t,n,e/Qe.len(n)),i}function F4(t){return Math.cos(t*Math.PI/180)}function ma(t,e){let r=F4(t),n=F4(e);return go(n/r)}function QSe(t,e){return 360/MX({worldSize:t,center:{lat:e}})}function o8(t,e){let r=t.rotate(e.bearingInRadians),n=e.zoom+ma(e.center.lat,0),i=rg(1/F4(e.center.lat),1/F4(Math.min(Math.abs(e.center.lat),60)),Vb(n,7,3,0,1)),a=QSe(e.worldSize,e.center.lat);return new ar(e.center.lng-r.x*a*i,on(e.center.lat+r.y*a,-Cu,Cu))}function jE(t){let e=.5*t,r=Math.sin(e),n=Math.cos(e);return Math.log(r+n)-Math.log(n-r)}function s8(t,e,r,n){let i=t.lat+r*n;if(Math.abs(r)>1){let a=t.lat+r,o=(Math.sign(a)!==Math.sign(t.lat)?-Math.abs(t.lat):Math.abs(t.lat))*Math.PI/180,s=Math.abs(t.lat+r)*Math.PI/180,l=jE(o+n*(s-o)),u=jE(o),c=jE(s),h=(l-u)/(c-u),d=t.lng+e*h;return new ar(d,i)}else{let a=t.lng+e*n;return new ar(a,i)}}C();C();var eEe=class{constructor(t){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=t}swapBuffers(){if(!this._hadAnyChanges)return;let t=this._cachePrevious;this._cachePrevious=this._cache,this._cache=t,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(t,e,r,n){let i="".concat(t.z,"_").concat(t.x,"_").concat(t.y,"_").concat(n!=null&&n.terrain?"t":""),a=this._cache.get(i);if(a)return a;let o=this._cachePrevious.get(i);if(o)return this._cache.set(i,o),o;let s=this._boundingVolumeFactory(t,e,r,n);return this._cache.set(i,s),this._hadAnyChanges=!0,s}};C();var VE=class zM{constructor(e,r,n,i){this.min=n,this.max=i,this.points=e,this.planes=r}static fromAabb(e,r){let n=[];for(let i=0;i<8;i++)n.push([(i>>0&1)===1?r[0]:e[0],(i>>1&1)===1?r[1]:e[1],(i>>2&1)===1?r[2]:e[2]]);return new zM(n,[[-1,0,0,r[0]],[1,0,0,-e[0]],[0,-1,0,r[1]],[0,1,0,-e[1]],[0,0,-1,r[2]],[0,0,1,-e[2]]],e,r)}static fromCenterSizeAngles(e,r,n){let i=qA.fromEuler([],n[0],n[1],n[2]),a=Qe.transformQuat([],[r[0],0,0],i),o=Qe.transformQuat([],[0,r[1],0],i),s=Qe.transformQuat([],[0,0,r[2]],i),l=[...e],u=[...e];for(let h=0;h<8;h++)for(let d=0;d<3;d++){let p=e[d]+a[d]*((h>>0&1)===1?1:-1)+o[d]*((h>>1&1)===1?1:-1)+s[d]*((h>>2&1)===1?1:-1);l[d]=Math.min(l[d],p),u[d]=Math.max(u[d],p)}let c=[];for(let h=0;h<8;h++){let d=[...e];Qe.add(d,d,Qe.scale([],a,(h>>0&1)===1?1:-1)),Qe.add(d,d,Qe.scale([],o,(h>>1&1)===1?1:-1)),Qe.add(d,d,Qe.scale([],s,(h>>2&1)===1?1:-1)),c.push(d)}return new zM(c,[[...a,-Qe.dot(a,c[0])],[...o,-Qe.dot(o,c[0])],[...s,-Qe.dot(s,c[0])],[-a[0],-a[1],-a[2],-Qe.dot(a,c[7])],[-o[0],-o[1],-o[2],-Qe.dot(o,c[7])],[-s[0],-s[1],-s[2],-Qe.dot(s,c[7])]],l,u)}intersectsFrustum(e){let r=!0,n=this.points.length,i=this.planes.length,a=e.planes.length,o=e.points.length;for(let s=0;s<a;s++){let l=e.planes[s],u=0;for(let c=0;c<n;c++){let h=this.points[c];l[0]*h[0]+l[1]*h[1]+l[2]*h[2]+l[3]>=0&&u++}if(u===0)return 0;u<n&&(r=!1)}if(r)return 2;for(let s=0;s<i;s++){let l=this.planes[s],u=0;for(let c=0;c<o;c++){let h=e.points[c];l[0]*h[0]+l[1]*h[1]+l[2]*h[2]+l[3]>=0&&u++}if(u===0)return 0}return 1}intersectsPlane(e){let r=this.points.length,n=0;for(let i=0;i<r;i++){let a=this.points[i];e[0]*a[0]+e[1]*a[1]+e[2]*a[2]+e[3]>=0&&n++}return n===r?2:n===0?0:1}};function Kb(t,e,r){let n=t-e;return n<0?-n:Math.max(0,n-r)}function GE(t,e,r,n,i){let a=t-r,o;return a<0?o=Math.min(-a,1+a-i):a>1?o=Math.min(Math.max(a-i,0),1-a):o=0,Math.max(o,Kb(e,n,i))}var tEe=class{constructor(){this._boundingVolumeCache=new eEe(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(e,r,n,i){let a=1<<n.z,o=1/a,s=n.x/a,l=n.y/a,u=1,c=.5*u,h=2*u;return h=Math.min(h,GE(e,r,s,l,o)),h=Math.min(h,GE(e,r,s+c,-l-o,o)),h=Math.min(h,GE(e,r,s+c,u+u-l-o,o)),h}getWrap(e,r,n){let i=1<<r.z,a=1/i,o=r.x/i,s=Kb(e.x,o,a),l=Kb(e.x,o-1,a),u=Kb(e.x,o+1,a),c=Math.min(s,l,u);return c===u?1:c===l?-1:0}allowVariableZoom(e,r){return I3(e,r)>4}allowWorldCopies(){return!1}getTileBoundingVolume(e,r,n,i){return this._boundingVolumeCache.getTileBoundingVolume(e,r,n,i)}_computeTileBoundingVolume(e,r,n,i){var a,o;let s=0,l=0;if(i!=null&&i.terrain){let u=new Ga(e.z,r,e.z,e.x,e.y),c=i.terrain.getMinMaxElevation(u);s=(a=c.minElevation)!=null?a:Math.min(0,n),l=(o=c.maxElevation)!=null?o:Math.max(0,n)}if(s/=mu,l/=mu,s+=1,l+=1,e.z<=0)return VE.fromAabb([-l,-l,-l],[l,l,l]);if(e.z===1)return VE.fromAabb([e.x===0?-l:0,e.y===0?0:-l,-l],[e.x===0?0:l,e.y===0?l:0,l]);{let u=[Ah(0,0,e.x,e.y,e.z),Ah(8192,0,e.x,e.y,e.z),Ah(8192,8192,e.x,e.y,e.z),Ah(0,8192,e.x,e.y,e.z)],c=[];for(let B of u)c.push(Qe.scale([],B,l));if(l!==s)for(let B of u)c.push(Qe.scale([],B,s));e.y===0&&c.push([0,1,0]),e.y===(1<<e.z)-1&&c.push([0,-1,0]);let h=[1,1,1],d=[-1,-1,-1];for(let B of c)for(let L=0;L<3;L++)h[L]=Math.min(h[L],B[L]),d[L]=Math.max(d[L],B[L]);let p=Ah(8192/2,8192/2,e.x,e.y,e.z),m=Qe.cross([],[0,1,0],p);Qe.normalize(m,m);let y=Qe.cross([],p,m);Qe.normalize(y,y);let v=Qe.cross([],u[2],u[1]);Qe.normalize(v,v);let _=Qe.cross([],u[0],u[3]);Qe.normalize(_,_),c.push(Qe.scale([],p,l)),e.y>=(1<<e.z)/2&&c.push(Qe.scale([],Ah(8192/2,0,e.x,e.y,e.z),l)),e.y<(1<<e.z)/2&&c.push(Qe.scale([],Ah(8192/2,8192,e.x,e.y,e.z),l));let w=l8(p,c),b=l8(y,c),A=[-p[0],-p[1],-p[2],w.max],E=[p[0],p[1],p[2],-w.min],M=[-y[0],-y[1],-y[2],b.max],P=[y[0],y[1],y[2],-b.min],k=[...v,0],D=[..._,0],O=[];return e.y===0?O.push(Ds(D,k,A),Ds(D,k,E)):O.push(Ds(M,k,A),Ds(M,k,E),Ds(M,D,A),Ds(M,D,E)),e.y===(1<<e.z)-1?O.push(Ds(D,k,A),Ds(D,k,E)):O.push(Ds(P,k,A),Ds(P,k,E),Ds(P,D,A),Ds(P,D,E)),new VE(O,[A,E,M,P,k,D],h,d)}}};function l8(t,e){let r=1/0,n=-1/0;for(let i of e){let a=Qe.dot(t,i);r=Math.min(r,a),n=Math.max(n,a)}return{min:r,max:n}}var TX=class PX{constructor(){this._cachedClippingPlane=ny(),this._projectionMatrix=Lf(),this._globeViewProjMatrix32f=DZ(),this._globeViewProjMatrixNoCorrection=Lf(),this._globeViewProjMatrixNoCorrectionInverted=Lf(),this._globeProjMatrixInverted=Lf(),this._cameraPosition=Li(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Ck({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,r)=>this.getConstrained(e,r)}),this._coveringTilesDetailsProvider=new tEe}get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,n){return this._helper.interpolatePadding(e,r,n)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r){this._helper.resize(e,r)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}clone(){let e=new PX;return e.apply(this),e}apply(e,r){this._globeLatitudeErrorCorrectionRadians=r||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){let e=Li();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){let{overscaledTileID:r,applyGlobeMatrix:n}=e,i=this._helper.getMercatorTileCoordinates(r);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:i,clippingPlane:this._cachedClippingPlane,projectionTransition:n?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){let r=this.pitchInRadians,n=this.cameraToCenterDistance/e,i=1,a=Math.sin(r)*n,o=Math.cos(r)*n+i,s=Math.sqrt(a*a+o*o),l=i/s*i,u=-a,c=o,h=Math.sqrt(u*u+c*c);u/=h,c/=h;let d=[0,u,c];Qe.rotateZ(d,d,[0,0,0],-this.bearingInRadians),Qe.rotateX(d,d,[0,0,0],-1*this.center.lat*Math.PI/180),Qe.rotateY(d,d,[0,0,0],this.center.lng*Math.PI/180);let p=1/Qe.length(d);return Qe.scale(d,d,p),[...d,-l*p]}isLocationOccluded(e){return!this.isSurfacePointVisible(Va(e))}transformLightDirection(e){let r=this._helper._center.lng*Math.PI/180,n=this._helper._center.lat*Math.PI/180,i=Math.cos(n),a=[Math.sin(r)*i,Math.sin(n),Math.cos(r)*i],o=[a[2],0,-a[0]],s=[0,0,0];Qe.cross(s,o,a),Qe.normalize(o,o),Qe.normalize(s,s);let l=[o[0]*e[0]+s[0]*e[1]+a[0]*e[2],o[1]*e[0]+s[1]*e[1]+a[1]*e[2],o[2]*e[0]+s[2]*e[1]+a[2]*e[2]],u=[0,0,0];return Qe.normalize(u,l),u}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,r,n){let i=BAe(e,r,n.canonical),a=qSe(i.x,i.y);return this.getCircleRadiusCorrection()/Math.cos(a[1])}projectTileCoordinates(e,r,n,i){let a=n.canonical,o=Ah(e,r,a.x,a.y,a.z),s=1+(i?i(e,r):0)/mu,l=[o[0]*s,o[1]*s,o[2]*s,1];Pi.transformMat4(l,l,this._globeViewProjMatrixNoCorrection);let u=this._cachedClippingPlane,c=u[0]*o[0]+u[1]*o[1]+u[2]*o[2]+u[3]<0;return{point:new Hl.default(l[0]/l[3],l[1]/l[3]),signedDistanceFromCamera:l[3],isOccluded:c}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;let e=M3(this.worldSize,this.center.lat),r=Wh(),n=Wh();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+e*2),Xe.perspective(r,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);let i=this.centerOffset;r[8]=-i.x*2/this._helper._width,r[9]=i.y*2/this._helper._height,this._projectionMatrix=Xe.clone(r),this._globeProjMatrixInverted=Wh(),Xe.invert(this._globeProjMatrixInverted,r),Xe.translate(r,r,[0,0,-this.cameraToCenterDistance]),Xe.rotateZ(r,r,this.rollInRadians),Xe.rotateX(r,r,-this.pitchInRadians),Xe.rotateZ(r,r,this.bearingInRadians),Xe.translate(r,r,[0,0,-e]);let a=Li();a[0]=e,a[1]=e,a[2]=e,Xe.rotateX(n,r,this.center.lat*Math.PI/180),Xe.rotateY(n,n,-this.center.lng*Math.PI/180),Xe.scale(n,n,a),this._globeViewProjMatrixNoCorrection=n,Xe.rotateX(r,r,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),Xe.rotateY(r,r,-this.center.lng*Math.PI/180),Xe.scale(r,r,a),this._globeViewProjMatrix32f=new Float32Array(r),this._globeViewProjMatrixNoCorrectionInverted=Wh(),Xe.invert(this._globeViewProjMatrixNoCorrectionInverted,n);let o=Li();this._cameraPosition=Li(),this._cameraPosition[2]=this.cameraToCenterDistance/e,Qe.rotateZ(this._cameraPosition,this._cameraPosition,o,-this.rollInRadians),Qe.rotateX(this._cameraPosition,this._cameraPosition,o,this.pitchInRadians),Qe.rotateZ(this._cameraPosition,this._cameraPosition,o,-this.bearingInRadians),Qe.add(this._cameraPosition,this._cameraPosition,[0,0,1]),Qe.rotateX(this._cameraPosition,this._cameraPosition,o,-this.center.lat*Math.PI/180),Qe.rotateY(this._cameraPosition,this._cameraPosition,o,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);let s=Xe.clone(this._globeViewProjMatrixNoCorrectionInverted);Xe.scale(s,s,[1,1,-1]),this._cachedFrustum=_X.fromInvProjectionMatrix(s,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(e){Ui("calculateFogMatrix is not supported on globe projection.");let r=Wh();return Xe.identity(r),r}getVisibleUnwrappedCoordinates(e){return[new D4(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&Ui("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,r){if(!this._globeViewProjMatrixNoCorrection)return 1;let n=Va(e);Qe.scale(n,n,1+r/mu);let i=ny();return Pi.transformMat4(i,[n[0],n[1],n[2],1],this._globeViewProjMatrixNoCorrection),i[2]/i[3]}populateCache(e){}getBounds(){let e=this.width*.5,r=this.height*.5,n=[new Hl.default(0,0),new Hl.default(e,0),new Hl.default(this.width,0),new Hl.default(this.width,r),new Hl.default(this.width,this.height),new Hl.default(e,this.height),new Hl.default(0,this.height),new Hl.default(0,r)],i=[];for(let h of n)i.push(this.unprojectScreenPoint(h));let a=0,o=0,s=0,l=0,u=this.center;for(let h of i){let d=os(u.lng,h.lng),p=os(u.lat,h.lat);d<o&&(o=d),d>a&&(a=d),p<l&&(l=p),p>s&&(s=p)}let c=[u.lng+o,u.lat+l,u.lng+a,u.lat+s];return this.isSurfacePointOnScreen([0,1,0])&&(c[3]=90,c[0]=-180,c[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(c[1]=-90,c[0]=-180,c[2]=180),new Vc(c)}getConstrained(e,r){let n=on(e.lat,-Cu,Cu),i=on(+r,this.minZoom+ma(0,n),this.maxZoom);return{center:new ar(e.lng,n),zoom:i}}calculateCenterFromCameraLngLatAlt(e,r,n,i){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,n,i)}setLocationAtPoint(e,r){let n=this.unprojectScreenPoint(r),i=Va(n),a=Va(e),o=Li();Qe.zero(o);let s=Li();Qe.rotateY(s,i,o,-this.center.lng*Math.PI/180),Qe.rotateX(s,s,o,this.center.lat*Math.PI/180);let l=a[0]*a[0]+a[2]*a[2],u=s[0]*s[0];if(l<u)return;let c=Math.sqrt(l-u),h=-c,d=Tx(a[0],a[2],s[0],c),p=Tx(a[0],a[2],s[0],h),m=Li();Qe.rotateY(m,a,o,-d);let y=Tx(m[1],m[2],s[1],s[2]),v=Li();Qe.rotateY(v,a,o,-p);let _=Tx(v[1],v[2],s[1],s[2]),w=Math.PI*.5,b=y>=-w&&y<=w,A=_>=-w&&_<=w,E,M;if(b&&A){let O=this.center.lng*Math.PI/180,B=this.center.lat*Math.PI/180,L=Px(d,O),R=Px(y,B),T=Px(p,O),N=Px(_,B);L+R<T+N?(E=d,M=y):(E=p,M=_)}else if(b)E=d,M=y;else if(A)E=p,M=_;else return;let P=E/Math.PI*180,k=M/Math.PI*180,D=this.center.lat;this.setCenter(new ar(P,on(k,-90,90))),this.setZoom(this.zoom+ma(D,this.center.lat))}locationToScreenPoint(e,r){let n=Va(e);if(r){let i=r.getElevationForLngLatZoom(e,this._helper._tileZoom);Qe.scale(n,n,1+i/mu)}return this._projectSurfacePointToScreen(n)}_projectSurfacePointToScreen(e){let r=ny();return Pi.transformMat4(r,[...e,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],new Hl.default((r[0]*.5+.5)*this.width,(-r[1]*.5+.5)*this.height)}screenPointToMercatorCoordinate(e,r){if(r){let n=r.pointCoordinate(e);if(n)return n}return Mn.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,r){var n;return(n=this.screenPointToMercatorCoordinate(e,r))==null?void 0:n.toLngLat()}isPointOnMapSurface(e,r){let n=this._cameraPosition,i=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(n,i)}getRayDirectionFromPixel(e){let r=ny();r[0]=e.x/this.width*2-1,r[1]=(e.y/this.height*2-1)*-1,r[2]=1,r[3]=1,Pi.transformMat4(r,r,this._globeViewProjMatrixNoCorrectionInverted),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3];let n=Li();n[0]=r[0]-this._cameraPosition[0],n[1]=r[1]-this._cameraPosition[1],n[2]=r[2]-this._cameraPosition[2];let i=Li();return Qe.normalize(i,n),i}isSurfacePointVisible(e){let r=this._cachedClippingPlane;return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;let r=ny();return Pi.transformMat4(r,[...e,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3],r[0]>-1&&r[0]<1&&r[1]>-1&&r[1]<1&&r[2]>-1&&r[2]<1}rayPlanetIntersection(e,r){let n=Qe.dot(e,r),i=1,a=Li(),o=Li();Qe.scale(o,r,n),Qe.sub(a,e,o);let s=i-Qe.dot(a,a);if(s<0)return null;let l=Qe.dot(e,e)-i,u=-n+(n<0?1:-1)*Math.sqrt(s),c=l/u,h=u,d=Math.min(c,h),p=Math.max(c,h);return{tMin:d,tMax:p}}unprojectScreenPoint(e){let r=this._cameraPosition,n=this.getRayDirectionFromPixel(e),i=this.rayPlanetIntersection(r,n);if(i){let d=Li();Qe.add(d,r,[n[0]*i.tMin,n[1]*i.tMin,n[2]*i.tMin]);let p=Li();return Qe.normalize(p,d),a8(p)}let a=this._cachedClippingPlane,o=a[0]*n[0]+a[1]*n[1]+a[2]*n[2],s=-VC(a,r)/o,l=2,u=Li();if(s>0)Qe.add(u,r,[n[0]*s,n[1]*s,n[2]*s]);else{let d=Li();Qe.add(d,r,[n[0]*l,n[1]*l,n[2]*l]);let p=VC(this._cachedClippingPlane,d);Qe.sub(u,d,[this._cachedClippingPlane[0]*p,this._cachedClippingPlane[1]*p,this._cachedClippingPlane[2]*p])}let c=JSe(a),h=KSe(c.center,c.radius,u);return a8(h)}getMatrixForModel(e,r){let n=ar.convert(e),i=1/mu,a=Lf();return Xe.rotateY(a,a,n.lng/180*Math.PI),Xe.rotateX(a,a,-n.lat/180*Math.PI),Xe.translate(a,a,[0,0,1+r/mu]),Xe.rotateX(a,a,Math.PI*.5),Xe.scale(a,a,[i,i,i]),a}getProjectionDataForCustomLayer(e=!0){let r=this.getProjectionData({overscaledTileID:new Ga(0,0,0,0,0),applyGlobeMatrix:e});return r.tileMercatorCoords=[0,0,1,1],r}getFastPathSimpleProjectionMatrix(e){}},u8=class DX{constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Ck({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,r)=>this.getConstrained(e,r)}),this._globeness=1,this._mercatorTransform=new B4,this._verticalPerspectiveTransform=new TX}get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,n){return this._helper.interpolatePadding(e,r,n)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r,n=!0){this._helper.resize(e,r,n)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,r){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=r,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}clone(){let e=new DX;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){let r=this._mercatorTransform.getProjectionData(e),n=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?n.mainMatrix:r.mainMatrix,clippingPlane:n.clippingPlane,tileMercatorCoords:n.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:r.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return rg(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return rg(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,r,n){let i=this._mercatorTransform.getPitchedTextCorrection(e,r,n),a=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,r,n);return rg(i,a,this._globeness)}projectTileCoordinates(e,r,n,i){return this.currentTransform.projectTileCoordinates(e,r,n,i)}_calcMatrices(){!this._helper._width||!this._helper._height||(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,r){return this.currentTransform.lngLatToCameraDepth(e,r)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,r){return this.currentTransform.getConstrained(e,r)}calculateCenterFromCameraLngLatAlt(e,r,n,i){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,n,i)}setLocationAtPoint(e,r){if(!this.isGlobeRendering){this._mercatorTransform.setLocationAtPoint(e,r),this.apply(this._mercatorTransform);return}this._verticalPerspectiveTransform.setLocationAtPoint(e,r),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,r){return this.currentTransform.locationToScreenPoint(e,r)}screenPointToMercatorCoordinate(e,r){return this.currentTransform.screenPointToMercatorCoordinate(e,r)}screenPointToLocation(e,r){return this.currentTransform.screenPointToLocation(e,r)}isPointOnMapSurface(e,r){return this.currentTransform.isPointOnMapSurface(e,r)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,r){return this.currentTransform.getMatrixForModel(e,r)}getProjectionDataForCustomLayer(e=!0){let r=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return r;let n=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return n.fallbackMatrix=r.mainMatrix,n}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}};C();C();var ZE=Zt(xr(),1),kX=class hc{get useGlobeControls(){return!0}handlePanInertia(e,r){let n=o8(e,r);return Math.abs(n.lng-r.center.lng)>180&&(n.lng=r.center.lng+179.5*Math.sign(n.lng-r.center.lng)),{easingCenter:n,easingOffset:new ZE.default(0,0)}}handleMapControlsRollPitchBearingZoom(e,r){let n=e.around,i=r.screenPointToLocation(n);e.bearingDelta&&r.setBearing(r.bearing+e.bearingDelta),e.pitchDelta&&r.setPitch(r.pitch+e.pitchDelta),e.rollDelta&&r.setRoll(r.roll+e.rollDelta);let a=r.zoom;e.zoomDelta&&r.setZoom(r.zoom+e.zoomDelta);let o=r.zoom-a;if(o===0)return;let s=.3,l=.5,u=45,c=85,h=.25,d=.75,p=.35,m=.9,y=.5,v=.25,_=os(r.center.lng,i.lng),w=_/(Math.abs(_/180)+1),b=os(r.center.lat,i.lat),A=r.getRayDirectionFromPixel(n),E=r.cameraPosition,M=Qe.dot(E,A)*-1,P=Li();Qe.add(P,E,[A[0]*M,A[1]*M,A[2]*M]);let k=Qe.length(P)-1,D=Math.exp(-Math.max(k-s,0)*l),O=M3(r.worldSize,r.center.lat)/Math.min(r.width,r.height),B=Vb(O,m,y,1,v),L=(1-mo(-o))*Math.min(D,B),R=r.center.lat,T=r.zoom,N=new ar(r.center.lng+w*L,on(r.center.lat+b*L,-Cu,Cu));r.setLocationAtPoint(i,n);let $=r.center,V=Vb(Math.abs(_),u,c,0,1),G=Vb(O,d,p,0,1),ee=Math.pow(Math.max(V,G),h),ie=os($.lng,N.lng),me=os($.lat,N.lat);r.setCenter(new ar($.lng+ie*ee,$.lat+me*ee).wrap()),r.setZoom(T+ma(R,r.center.lat))}handleMapControlsPan(e,r,n){if(!e.panDelta)return;let i=r.center.lat,a=r.zoom;r.setCenter(o8(e.panDelta,r).wrap()),r.setZoom(a+ma(i,r.center.lat))}cameraForBoxAndBearing(e,r,n,i,a){let o=SX(e,r,n,i,a),s=r.left/a.width*2-1,l=(a.width-r.right)/a.width*2-1,u=r.top/a.height*-2+1,c=(a.height-r.bottom)/a.height*-2+1,h=os(n.getWest(),n.getEast())<0,d=h?n.getEast():n.getWest(),p=h?n.getWest():n.getEast(),m=Math.max(n.getNorth(),n.getSouth()),y=Math.min(n.getNorth(),n.getSouth()),v=d+os(d,p)*.5,_=m+os(m,y)*.5,w=a.clone();w.setCenter(o.center),w.setBearing(o.bearing),w.setPitch(0),w.setRoll(0),w.setZoom(o.zoom);let b=w.modelViewProjectionMatrix,A=[Va(n.getNorthWest()),Va(n.getNorthEast()),Va(n.getSouthWest()),Va(n.getSouthEast()),Va(new ar(p,_)),Va(new ar(d,_)),Va(new ar(v,m)),Va(new ar(v,y))],E=Va(o.center),M=Number.POSITIVE_INFINITY;for(let P of A)s<0&&(M=hc.getLesserNonNegativeNonNull(M,hc.solveVectorScale(P,E,b,"x",s))),l>0&&(M=hc.getLesserNonNegativeNonNull(M,hc.solveVectorScale(P,E,b,"x",l))),u>0&&(M=hc.getLesserNonNegativeNonNull(M,hc.solveVectorScale(P,E,b,"y",u))),c<0&&(M=hc.getLesserNonNegativeNonNull(M,hc.solveVectorScale(P,E,b,"y",c)));if(!Number.isFinite(M)||M===0){wX();return}return o.zoom=w.zoom+go(M),o}handleJumpToCenterZoom(e,r){let n=e.center.lat,i=e.getConstrained(r.center?ar.convert(r.center):e.center,e.zoom).center;e.setCenter(i.wrap());let a=typeof r.zoom<"u"?+r.zoom:e.zoom+ma(n,i.lat);e.zoom!==a&&e.setZoom(a)}handleEaseTo(e,r){let n=e.zoom,i=e.center,a=e.padding,o={roll:e.roll,pitch:e.pitch,bearing:e.bearing},s=r.roll===void 0?e.roll:r.roll,l=r.pitch===void 0?e.pitch:r.pitch,u=r.bearing===void 0?e.bearing:r.bearing,c={roll:s,pitch:l,bearing:u},h=typeof r.zoom<"u",d=!e.isPaddingEqual(r.padding),p=!1,m=r.center?ar.convert(r.center):i,y=e.getConstrained(m,n).center;O4(e,y);let v=e.clone();v.setCenter(y),v.setZoom(h?+r.zoom:n+ma(i.lat,m.lat)),v.setBearing(r.bearing);let _=new ZE.default(on(e.centerPoint.x+r.offsetAsPoint.x,0,e.width),on(e.centerPoint.y+r.offsetAsPoint.y,0,e.height));v.setLocationAtPoint(y,_);let w=(r.offset&&r.offsetAsPoint.mag())>0?v.center:y,b=h?+r.zoom:n+ma(i.lat,w.lat),A=n+ma(i.lat,0),E=b+ma(w.lat,0),M=os(i.lng,w.lng),P=os(i.lat,w.lat),k=mo(E-A);return p=b!==n,{easeFunc:D=>{if(zZ(o,c)||AX({startEulerAngles:o,endEulerAngles:c,tr:e,k:D,useSlerp:o.roll!=c.roll}),d&&e.interpolatePadding(a,r.padding,D),r.around)Ui("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(r.around,r.aroundPoint);else{let O=E>A?Math.min(2,k):Math.max(.5,k),B=Math.pow(O,1-D),L=D*B,R=s8(i,M,P,L);e.setCenter(R.wrap())}if(p){let O=di.number(A,E,D)+ma(0,e.center.lat);e.setZoom(O)}},isZooming:p,elevationCenter:w}}handleFlyTo(e,r){let n=typeof r.zoom<"u",i=e.center,a=e.zoom,o=e.padding,s=!e.isPaddingEqual(r.padding),l=e.getConstrained(ar.convert(r.center||r.locationAtOffset),a).center,u=n?+r.zoom:e.zoom+ma(e.center.lat,l.lat),c=e.clone();c.setCenter(l),c.setZoom(u),c.setBearing(r.bearing);let h=new ZE.default(on(e.centerPoint.x+r.offsetAsPoint.x,0,e.width),on(e.centerPoint.y+r.offsetAsPoint.y,0,e.height));c.setLocationAtPoint(l,h);let d=c.center;O4(e,d);let p=XSe(e,i,d),m=a+ma(i.lat,0),y=u+ma(d.lat,0),v=mo(y-m),_=typeof r.minZoom=="number",w;if(_){let E=+r.minZoom+ma(d.lat,0),M=Math.min(E,m,y)+ma(0,d.lat),P=e.getConstrained(d,M).zoom+ma(d.lat,0);w=mo(P-m)}let b=os(i.lng,d.lng),A=os(i.lat,d.lat);return{easeFunc:(E,M,P,k)=>{let D=s8(i,b,A,P);s&&e.interpolatePadding(o,r.padding,E);let O=E===1?d:D;e.setCenter(O.wrap());let B=m+go(M);e.setZoom(E===1?u:B+ma(0,O.lat))},scaleOfZoom:v,targetCenter:d,scaleOfMinZoom:w,pixelPathLength:p}}static solveVectorScale(e,r,n,i,a){let o=a,s=i==="x"?[n[0],n[4],n[8],n[12]]:[n[1],n[5],n[9],n[13]],l=[n[3],n[7],n[11],n[15]],u=e[0]*s[0]+e[1]*s[1]+e[2]*s[2],c=e[0]*l[0]+e[1]*l[1]+e[2]*l[2],h=r[0]*s[0]+r[1]*s[1]+r[2]*s[2],d=r[0]*l[0]+r[1]*l[1]+r[2]*l[2],p=(h+s[3]-o*d-o*l[3])/(h-u-o*d+o*c);return h+o*c===u+o*d||l[3]*(u-h)+s[3]*(d-c)+u*d===h*c?null:p}static getLesserNonNegativeNonNull(e,r){return r!==null&&r>=0&&r<e?r:e}},c8=class{constructor(e){this._globe=e,this._mercatorCameraHelper=new z4,this._verticalPerspectiveCameraHelper=new kX}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,r){return this.currentHelper.handlePanInertia(e,r)}handleMapControlsRollPitchBearingZoom(e,r){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,r)}handleMapControlsPan(e,r,n){this.currentHelper.handleMapControlsPan(e,r,n)}cameraForBoxAndBearing(e,r,n,i,a){return this.currentHelper.cameraForBoxAndBearing(e,r,n,i,a)}handleJumpToCenterZoom(e,r){this.currentHelper.handleJumpToCenterZoom(e,r)}handleEaseTo(e,r){return this.currentHelper.handleEaseTo(e,r)}handleFlyTo(e,r){return this.currentHelper.handleFlyTo(e,r)}};function rEe(t){if(Array.isArray(t)){let e=new i8({type:t});return{projection:e,transform:new u8,cameraHelper:new c8(e)}}switch(t){case"mercator":return{projection:new BM,transform:new B4,cameraHelper:new z4};case"globe":{let e=new i8({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:e,transform:new u8,cameraHelper:new c8(e)}}case"vertical-perspective":return{projection:new CX,transform:new TX,cameraHelper:new kX};default:return Ui("Unknown projection name: ".concat(t,". Falling back to mercator projection.")),{projection:new BM,transform:new B4,cameraHelper:new z4}}}var Qx=(t,e)=>p3(t,e&&e.filter(r=>r.identifier!=="source.canvas")),nEe=cbe(),h8=class extends Xo{constructor(e,r={}){super(),this._rtlPluginLoaded=()=>{for(let n in this.sourceCaches){let i=this.sourceCaches[n].getSource().type;(i==="vector"||i==="geojson")&&this.sourceCaches[n].reload()}},this.map=e,this.dispatcher=new XH(HH(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(n,i)=>this.getGlyphs(n,i)),this.dispatcher.registerMessageHandler("GI",(n,i)=>this.getImages(n,i)),this.imageManager=new B4e,this.imageManager.setEventedParent(this),this.glyphManager=new R4e(e._requestManager,r.localIdeographFontFamily),this.lineAtlas=new j4e(256,512),this.crossTileSymbolIndex=new pX,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new oM,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",S5()),CM().on(IM,this._rtlPluginLoaded),this.on("data",n=>{if(n.dataType!=="source"||n.sourceDataType!=="metadata")return;let i=this.sourceCaches[n.sourceId];if(!i)return;let a=i.getSource();if(!(!a||!a.vectorLayerIds))for(let o in this._layers){let s=this._layers[o];s.source===a.id&&this._validateLayer(s)}})}setGlobalStateProperty(e,r){var n,i,a;this._checkLoaded();let o=r===null?(a=(i=(n=this.stylesheet.state)==null?void 0:n[e])==null?void 0:i.default)!=null?a:null:r;if(uu(o,this._globalState[e]))return this;this._globalState[e]=o;let s=this._findGlobalStateAffectedSources([e]);for(let l in this.sourceCaches)s.has(l)&&(this._reloadSource(l),this._changed=!0)}getGlobalState(){return this._globalState}setGlobalState(e){this._checkLoaded();let r=[];for(let i in e)!uu(this._globalState[i],e[i].default)&&(r.push(i),this._globalState[i]=e[i].default);let n=this._findGlobalStateAffectedSources(r);for(let i in this.sourceCaches)n.has(i)&&(this._reloadSource(i),this._changed=!0)}_findGlobalStateAffectedSources(e){if(e.length===0)return new Set;let r=new Set;for(let n in this._layers){let i=this._layers[n],a=i.getLayoutAffectingGlobalStateRefs();for(let o of e)a.has(o)&&r.add(i.source)}return r}loadURL(e,r={},n){this.fire(new ht("dataloading",{dataType:"style"})),r.validate=typeof r.validate=="boolean"?r.validate:!0;let i=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;let a=this._loadStyleRequest;QA(i,this._loadStyleRequest).then(o=>{this._loadStyleRequest=null,this._load(o.data,r,n)}).catch(o=>{this._loadStyleRequest=null,o&&!a.signal.aborted&&this.fire(new Jt(o))})}loadJSON(e,r={},n){this.fire(new ht("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,Dr.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,r.validate=r.validate!==!1,this._load(e,r,n)}).catch(()=>{})}loadEmpty(){this.fire(new ht("dataloading",{dataType:"style"})),this._load(nEe,{validate:!1})}_load(e,r,n){var i,a,o;let s=r.transformStyle?r.transformStyle(n,e):e;if(!(r.validate&&Qx(this,Ni(s)))){this._loaded=!0,this.stylesheet=s;for(let l in s.sources)this.addSource(l,s.sources[l],{validate:!1});s.sprite?this._loadSprite(s.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(s.glyphs),this._createLayers(),this.light=new N4e(this.stylesheet.light),this._setProjectionInternal(((i=this.stylesheet.projection)==null?void 0:i.type)||"mercator"),this.sky=new U4e(this.stylesheet.sky),this.map.setTerrain((a=this.stylesheet.terrain)!=null?a:null),this.setGlobalState((o=this.stylesheet.state)!=null?o:null),this.fire(new ht("data",{dataType:"style"})),this.fire(new ht("style.load"))}}_createLayers(){let e=Iz(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(r=>r.id),this._layers={},this._serializedLayers=null;for(let r of e){let n=OE(r);n.setEventedParent(this,{layer:{id:r.id}}),this._layers[r.id]=n}}_loadSprite(e,r=!1,n=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController;let i;k4e(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(a=>{if(this._spriteRequest=null,a)for(let o in a){this._spritesImagesIds[o]=[];let s=this._spritesImagesIds[o]?this._spritesImagesIds[o].filter(l=>!(l in a)):[];for(let l of s)this.imageManager.removeImage(l),this._changedImages[l]=!0;for(let l in a[o]){let u=o==="default"?l:"".concat(o,":").concat(l);this._spritesImagesIds[o].push(u),u in this.imageManager.images?this.imageManager.updateImage(u,a[o][l],!1):this.imageManager.addImage(u,a[o][l]),r&&(this._changedImages[u]=!0)}}}).catch(a=>{this._spriteRequest=null,i=a,this.fire(new Jt(i))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),r&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new ht("data",{dataType:"style"})),n&&n(i)})}_unloadSprite(){for(let e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new ht("data",{dataType:"style"}))}_validateLayer(e){let r=this.sourceCaches[e.source];if(!r)return;let n=e.sourceLayer;if(!n)return;let i=r.getSource();(i.type==="geojson"||i.vectorLayerIds&&i.vectorLayerIds.indexOf(n)===-1)&&this.fire(new Jt(new Error('Source layer "'.concat(n,'" ')+'does not exist on source "'.concat(i.id,'" ')+'as specified by style layer "'.concat(e.id,'".'))))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(let e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,r=!1){let n=this._serializedAllLayers();if(!e||e.length===0)return Object.values(r?$o(n):n);let i=[];for(let a of e)if(n[a]){let o=r?$o(n[a]):n[a];i.push(o)}return i}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};let r=Object.keys(this._layers);for(let n of r){let i=this._layers[n];i.type!=="custom"&&(e[n]=i.serialize())}return e}hasTransitions(){var e,r,n;if((e=this.light)!=null&&e.hasTransition()||(r=this.sky)!=null&&r.hasTransition()||(n=this.projection)!=null&&n.hasTransition())return!0;for(let i in this.sourceCaches)if(this.sourceCaches[i].hasTransition())return!0;for(let i in this._layers)if(this._layers[i].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;let r=this._changed;if(r){let i=Object.keys(this._updatedLayers),a=Object.keys(this._removedLayers);(i.length||a.length)&&this._updateWorkerLayers(i,a);for(let o in this._updatedSources){let s=this._updatedSources[o];if(s==="reload")this._reloadSource(o);else if(s==="clear")this._clearSource(o);else throw new Error("Invalid action ".concat(s))}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(let o in this._updatedPaintProps)this._layers[o].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}let n={};for(let i in this.sourceCaches){let a=this.sourceCaches[i];n[i]=a.used,a.used=!1}for(let i of this._order){let a=this._layers[i];a.recalculate(e,this._availableImages),!a.isHidden(e.zoom)&&a.source&&(this.sourceCaches[a.source].used=!0)}for(let i in n){let a=this.sourceCaches[i];!!n[i]!=!!a.used&&a.fire(new ht("data",{sourceDataType:"visibility",dataType:"source",sourceId:i}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,r&&this.fire(new ht("data",{dataType:"style"}))}_updateTilesForChangedImages(){let e=Object.keys(this._changedImages);if(e.length){for(let r in this.sourceCaches)this.sourceCaches[r].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(let e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,r){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:r})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,r={}){var n;this._checkLoaded();let i=this.serialize();if(e=r.transformStyle?r.transformStyle(i,e):e,((n=r.validate)!=null?n:!0)&&Qx(this,Ni(e)))return!1;e=$o(e),e.layers=Iz(e.layers);let a=T_e(i,e),o=this._getOperationsToPerform(a);if(o.unimplemented.length>0)throw new Error("Unimplemented: ".concat(o.unimplemented.join(", "),"."));if(o.operations.length===0)return!1;for(let s of o.operations)s();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){let r=[],n=[];for(let i of e)switch(i.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":r.push(()=>this.addLayer.apply(this,i.args));break;case"removeLayer":r.push(()=>this.removeLayer.apply(this,i.args));break;case"setPaintProperty":r.push(()=>this.setPaintProperty.apply(this,i.args));break;case"setLayoutProperty":r.push(()=>this.setLayoutProperty.apply(this,i.args));break;case"setFilter":r.push(()=>this.setFilter.apply(this,i.args));break;case"addSource":r.push(()=>this.addSource.apply(this,i.args));break;case"removeSource":r.push(()=>this.removeSource.apply(this,i.args));break;case"setLayerZoomRange":r.push(()=>this.setLayerZoomRange.apply(this,i.args));break;case"setLight":r.push(()=>this.setLight.apply(this,i.args));break;case"setGeoJSONSourceData":r.push(()=>this.setGeoJSONSourceData.apply(this,i.args));break;case"setGlyphs":r.push(()=>this.setGlyphs.apply(this,i.args));break;case"setSprite":r.push(()=>this.setSprite.apply(this,i.args));break;case"setTerrain":r.push(()=>this.map.setTerrain.apply(this,i.args));break;case"setSky":r.push(()=>this.setSky.apply(this,i.args));break;case"setProjection":this.setProjection.apply(this,i.args);break;case"setGlobalState":r.push(()=>this.setGlobalState.apply(this,i.args));break;case"setTransition":r.push(()=>{});break;default:n.push(i.command);break}return{operations:r,unimplemented:n}}addImage(e,r){if(this.getImage(e))return this.fire(new Jt(new Error('An image named "'.concat(e,'" already exists.'))));this.imageManager.addImage(e,r),this._afterImageUpdated(e)}updateImage(e,r){this.imageManager.updateImage(e,r)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new Jt(new Error('An image named "'.concat(e,'" does not exist.'))));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new ht("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,r,n={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error('Source "'.concat(e,'" already exists.'));if(!r.type)throw new Error("The type property must be defined, but only the following properties were given: ".concat(Object.keys(r).join(", "),"."));if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(Ni.source,"sources.".concat(e),r,null,n))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);let i=this.sourceCaches[e]=new S1(e,r,this.dispatcher);i.style=this,i.setEventedParent(this,()=>({isSourceLoaded:i.loaded(),source:i.serialize(),sourceId:e})),i.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(let n in this._layers)if(this._layers[n].source===e)return this.fire(new Jt(new Error('Source "'.concat(e,'" cannot be removed while layer "').concat(n,'" is using it.'))));let r=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],r.fire(new ht("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),r.setEventedParent(null),r.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,r){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID=".concat(e));let n=this.sourceCaches[e].getSource();if(n.type!=="geojson")throw new Error("geojsonSource.type is ".concat(n.type,", which is !== 'geojson"));n.setData(r),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,r,n={}){this._checkLoaded();let i=e.id;if(this.getLayer(i)){this.fire(new Jt(new Error('Layer "'.concat(i,'" already exists on this map.'))));return}let a;if(e.type==="custom"){if(Qx(this,T4e(e)))return;a=OE(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(i,e.source),e=$o(e),e=zt(e,{source:i})),this._validate(Ni.layer,"layers.".concat(i),e,{arrayIndex:-1},n))return;a=OE(e),this._validateLayer(a),a.setEventedParent(this,{layer:{id:i}})}let o=r?this._order.indexOf(r):this._order.length;if(r&&o===-1){this.fire(new Jt(new Error('Cannot add layer "'.concat(i,'" before non-existing layer "').concat(r,'".'))));return}if(this._order.splice(o,0,i),this._layerOrderChanged=!0,this._layers[i]=a,this._removedLayers[i]&&a.source&&a.type!=="custom"){let s=this._removedLayers[i];delete this._removedLayers[i],s.type!==a.type?this._updatedSources[a.source]="clear":(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause())}this._updateLayer(a),a.onAdd&&a.onAdd(this.map)}moveLayer(e,r){if(this._checkLoaded(),this._changed=!0,!this._layers[e]){this.fire(new Jt(new Error("The layer '".concat(e,"' does not exist in the map's style and cannot be moved."))));return}if(e===r)return;let n=this._order.indexOf(e);this._order.splice(n,1);let i=r?this._order.indexOf(r):this._order.length;if(r&&i===-1){this.fire(new Jt(new Error('Cannot move layer "'.concat(e,'" before non-existing layer "').concat(r,'".'))));return}this._order.splice(i,0,e),this._layerOrderChanged=!0}removeLayer(e){this._checkLoaded();let r=this._layers[e];if(!r){this.fire(new Jt(new Error('Cannot remove non-existing layer "'.concat(e,'".'))));return}r.setEventedParent(null);let n=this._order.indexOf(e);this._order.splice(n,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=r,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],r.onRemove&&r.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,r,n){this._checkLoaded();let i=this.getLayer(e);if(!i){this.fire(new Jt(new Error('Cannot set the zoom range of non-existing layer "'.concat(e,'".'))));return}i.minzoom===r&&i.maxzoom===n||(r!=null&&(i.minzoom=r),n!=null&&(i.maxzoom=n),this._updateLayer(i))}setFilter(e,r,n={}){this._checkLoaded();let i=this.getLayer(e);if(!i){this.fire(new Jt(new Error('Cannot filter non-existing layer "'.concat(e,'".'))));return}if(!uu(i.filter,r)){if(r==null){i.setFilter(void 0),this._updateLayer(i);return}this._validate(Ni.filter,"layers.".concat(i.id,".filter"),r,null,n)||(i.setFilter($o(r)),this._updateLayer(i))}}getFilter(e){return $o(this.getLayer(e).filter)}setLayoutProperty(e,r,n,i={}){this._checkLoaded();let a=this.getLayer(e);if(!a){this.fire(new Jt(new Error('Cannot style non-existing layer "'.concat(e,'".'))));return}uu(a.getLayoutProperty(r),n)||(a.setLayoutProperty(r,n,i),this._updateLayer(a))}getLayoutProperty(e,r){let n=this.getLayer(e);if(!n){this.fire(new Jt(new Error('Cannot get style of non-existing layer "'.concat(e,'".'))));return}return n.getLayoutProperty(r)}setPaintProperty(e,r,n,i={}){this._checkLoaded();let a=this.getLayer(e);if(!a){this.fire(new Jt(new Error('Cannot style non-existing layer "'.concat(e,'".'))));return}uu(a.getPaintProperty(r),n)||(a.setPaintProperty(r,n,i)&&this._updateLayer(a),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null)}getPaintProperty(e,r){return this.getLayer(e).getPaintProperty(r)}setFeatureState(e,r){this._checkLoaded();let n=e.source,i=e.sourceLayer,a=this.sourceCaches[n];if(a===void 0){this.fire(new Jt(new Error("The source '".concat(n,"' does not exist in the map's style."))));return}let o=a.getSource().type;if(o==="geojson"&&i){this.fire(new Jt(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));return}if(o==="vector"&&!i){this.fire(new Jt(new Error("The sourceLayer parameter must be provided for vector source types.")));return}e.id===void 0&&this.fire(new Jt(new Error("The feature id parameter must be provided."))),a.setFeatureState(i,e.id,r)}removeFeatureState(e,r){this._checkLoaded();let n=e.source,i=this.sourceCaches[n];if(i===void 0){this.fire(new Jt(new Error("The source '".concat(n,"' does not exist in the map's style."))));return}let a=i.getSource().type,o=a==="vector"?e.sourceLayer:void 0;if(a==="vector"&&!o){this.fire(new Jt(new Error("The sourceLayer parameter must be provided for vector source types.")));return}if(r&&typeof e.id!="string"&&typeof e.id!="number"){this.fire(new Jt(new Error("A feature id is required to remove its specific state property.")));return}i.removeFeatureState(o,e.id,r)}getFeatureState(e){this._checkLoaded();let r=e.source,n=e.sourceLayer,i=this.sourceCaches[r];if(i===void 0){this.fire(new Jt(new Error("The source '".concat(r,"' does not exist in the map's style."))));return}if(i.getSource().type==="vector"&&!n){this.fire(new Jt(new Error("The sourceLayer parameter must be provided for vector source types.")));return}return e.id===void 0&&this.fire(new Jt(new Error("The feature id parameter must be provided."))),i.getFeatureState(n,e.id)}getTransition(){return zt({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;let e=w5(this.sourceCaches,a=>a.serialize()),r=this._serializeByIds(this._order,!0),n=this.map.getTerrain()||void 0,i=this.stylesheet;return BZ({version:i.version,name:i.name,metadata:i.metadata,light:i.light,sky:i.sky,center:i.center,zoom:i.zoom,bearing:i.bearing,pitch:i.pitch,sprite:i.sprite,glyphs:i.glyphs,transition:i.transition,projection:i.projection,sources:e,layers:r,terrain:n},a=>a!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){let r=o=>this._layers[o].type==="fill-extrusion",n={},i=[];for(let o=this._order.length-1;o>=0;o--){let s=this._order[o];if(r(s)){n[s]=o;for(let l of e){let u=l[s];if(u)for(let c of u)i.push(c)}}}i.sort((o,s)=>s.intersectionZ-o.intersectionZ);let a=[];for(let o=this._order.length-1;o>=0;o--){let s=this._order[o];if(r(s))for(let l=i.length-1;l>=0;l--){let u=i[l].feature;if(n[u.layer.id]<o)break;a.push(u),i.pop()}else for(let l of e){let u=l[s];if(u)for(let c of u)a.push(c.feature)}}return a}queryRenderedFeatures(e,r,n){r&&r.filter&&this._validate(Ni.filter,"queryRenderedFeatures.filter",r.filter,null,r);let i={};if(r&&r.layers){if(!(Array.isArray(r.layers)||r.layers instanceof Set))return this.fire(new Jt(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(let u of r.layers){let c=this._layers[u];if(!c)return this.fire(new Jt(new Error("The layer '".concat(u,"' does not exist in the map's style and cannot be queried for features.")))),[];i[c.source]=!0}}let a=[];r.availableImages=this._availableImages;let o=this._serializedAllLayers(),s=r.layers instanceof Set?r.layers:Array.isArray(r.layers)?new Set(r.layers):null,l=lt(ae({},r),{layers:s});for(let u in this.sourceCaches)r.layers&&!i[u]||a.push(eAe(this.sourceCaches[u],this._layers,o,e,l,n,this.map.terrain?(c,h,d)=>this.map.terrain.getElevation(c,h,d):void 0));return this.placement&&a.push(tAe(this._layers,o,this.sourceCaches,e,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(a)}querySourceFeatures(e,r){r&&r.filter&&this._validate(Ni.filter,"querySourceFeatures.filter",r.filter,null,r);let n=this.sourceCaches[e];return n?rAe(n,r):[]}getLight(){return this.light.getLight()}setLight(e,r={}){this._checkLoaded();let n=this.light.getLight(),i=!1;for(let o in e)if(!uu(e[o],n[o])){i=!0;break}if(!i)return;let a={now:Dr.now(),transition:zt({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,r),this.light.updateTransitions(a)}getProjection(){var e;return(e=this.stylesheet)==null?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)==null?void 0:e.sky}setSky(e,r={}){this._checkLoaded();let n=this.getSky(),i=!1;if(!e&&!n)return;if(e&&!n)i=!0;else if(!e&&n)i=!0;else for(let o in e)if(!uu(e[o],n[o])){i=!0;break}if(!i)return;let a={now:Dr.now(),transition:zt({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,r),this.sky.updateTransitions(a)}_setProjectionInternal(e){let r=rEe(e);this.projection=r.projection,this.map.migrateProjection(r.transform,r.cameraHelper);for(let n in this.sourceCaches)this.sourceCaches[n].reload()}_validate(e,r,n,i,a={}){return a&&a.validate===!1?!1:Qx(this,e.call(Ni,zt({key:r,style:this.serialize(),value:n,styleSpec:Oe},i)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),CM().off(IM,this._rtlPluginLoaded);for(let r in this._layers)this._layers[r].setEventedParent(null);for(let r in this.sourceCaches){let n=this.sourceCaches[r];n.setEventedParent(null),n.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(let r in this.sourceCaches)this.sourceCaches[r].update(e,this.map.terrain)}_generateCollisionBoxes(){for(let e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,r,n,i,a=!1){let o=!1,s=!1,l={};for(let u of this._order){let c=this._layers[u];if(c.type!=="symbol")continue;if(!l[c.source]){let d=this.sourceCaches[c.source];l[c.source]=d.getRenderableIds(!0).map(p=>d.getTileByID(p)).sort((p,m)=>m.tileID.overscaledZ-p.tileID.overscaledZ||(p.tileID.isLessThan(m.tileID)?-1:1))}let h=this.crossTileSymbolIndex.addLayer(c,l[c.source],e.center.lng);o=o||h}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),a=a||this._layerOrderChanged||n===0,(a||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Dr.now(),e.zoom))&&(this.pauseablePlacement=new c3e(e,this.map.terrain,this._order,a,r,n,i,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Dr.now()),s=!0),o&&this.pauseablePlacement.placement.setStale()),s||o)for(let u of this._order){let c=this._layers[u];c.type==="symbol"&&this.placement.updateLayerOpacities(c,l[c.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Dr.now())}_releaseSymbolFadeTiles(){for(let e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}async getImages(e,r){let n=await this.imageManager.getImages(r.icons);this._updateTilesForChangedImages();let i=this.sourceCaches[r.source];return i&&i.setDependencies(r.tileID.key,r.type,r.icons),n}async getGlyphs(e,r){let n=await this.glyphManager.getGlyphs(r.stacks),i=this.sourceCaches[r.source];return i&&i.setDependencies(r.tileID.key,r.type,[""]),n}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,r={}){this._checkLoaded(),!(e&&this._validate(Ni.glyphs,"glyphs",e,null,r))&&(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,r,n={},i){this._checkLoaded();let a=[{id:e,url:r}],o=[...Yb(this.stylesheet.sprite),...a];this._validate(Ni.sprite,"sprite",o,null,n)||(this.stylesheet.sprite=o,this._loadSprite(a,!0,i))}removeSprite(e){this._checkLoaded();let r=Yb(this.stylesheet.sprite);if(!r.find(n=>n.id===e)){this.fire(new Jt(new Error('Sprite "'.concat(e,`" doesn't exists on this map.`))));return}if(this._spritesImagesIds[e])for(let n of this._spritesImagesIds[e])this.imageManager.removeImage(n),this._changedImages[n]=!0;r.splice(r.findIndex(n=>n.id===e),1),this.stylesheet.sprite=r.length>0?r:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new ht("data",{dataType:"style"}))}getSprite(){return Yb(this.stylesheet.sprite)}setSprite(e,r={},n){this._checkLoaded(),!(e&&this._validate(Ni.sprite,"sprite",e,null,r))&&(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,n):(this._unloadSprite(),n&&n(null)))}};C();C();var iEe=Si([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);C();C();var aEe=class{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,r,n,i,a,o,s,l,u){this.context=e;let c=this.boundPaintVertexBuffers.length!==i.length;for(let h=0;!c&&h<i.length;h++)this.boundPaintVertexBuffers[h]!==i[h]&&(c=!0);!this.vao||this.boundProgram!==r||this.boundLayoutVertexBuffer!==n||c||this.boundIndexBuffer!==a||this.boundVertexOffset!==o||this.boundDynamicVertexBuffer!==s||this.boundDynamicVertexBuffer2!==l||this.boundDynamicVertexBuffer3!==u?this.freshBind(r,n,i,a,o,s,l,u):(e.bindVertexArray.set(this.vao),s&&s.bind(),a&&a.dynamicDraw&&a.bind(),l&&l.bind(),u&&u.bind())}freshBind(e,r,n,i,a,o,s,l){let u=e.numAttributes,c=this.context,h=c.gl;this.vao&&this.destroy(),this.vao=c.createVertexArray(),c.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=r,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=i,this.boundVertexOffset=a,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=s,this.boundDynamicVertexBuffer3=l,r.enableAttributes(h,e);for(let d of n)d.enableAttributes(h,e);o&&o.enableAttributes(h,e),s&&s.enableAttributes(h,e),l&&l.enableAttributes(h,e),r.bind(),r.setVertexAttribPointers(h,e,a);for(let d of n)d.bind(),d.setVertexAttribPointers(h,e,a);o&&(o.bind(),o.setVertexAttribPointers(h,e,a)),i&&i.bind(),s&&(s.bind(),s.setVertexAttribPointers(h,e,a)),l&&(l.bind(),l.setVertexAttribPointers(h,e,a)),c.currentNumAttributes=u}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}};C();var oEe=(t,e)=>({u_depth:new lr(t,e.u_depth),u_terrain:new lr(t,e.u_terrain),u_terrain_dim:new dt(t,e.u_terrain_dim),u_terrain_matrix:new bs(t,e.u_terrain_matrix),u_terrain_unpack:new hd(t,e.u_terrain_unpack),u_terrain_exaggeration:new dt(t,e.u_terrain_exaggeration)}),sEe=(t,e)=>({u_texture:new lr(t,e.u_texture),u_ele_delta:new dt(t,e.u_ele_delta),u_fog_matrix:new bs(t,e.u_fog_matrix),u_fog_color:new dd(t,e.u_fog_color),u_fog_ground_blend:new dt(t,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new dt(t,e.u_fog_ground_blend_opacity),u_horizon_color:new dd(t,e.u_horizon_color),u_horizon_fog_blend:new dt(t,e.u_horizon_fog_blend),u_is_globe_mode:new dt(t,e.u_is_globe_mode)}),lEe=(t,e)=>({u_ele_delta:new dt(t,e.u_ele_delta)}),uEe=(t,e)=>({u_texture:new lr(t,e.u_texture),u_terrain_coords_id:new dt(t,e.u_terrain_coords_id),u_ele_delta:new dt(t,e.u_ele_delta)}),cEe=(t,e,r,n,i)=>({u_texture:0,u_ele_delta:t,u_fog_matrix:e,u_fog_color:r?r.properties.get("fog-color"):Gt.white,u_fog_ground_blend:r?r.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:i?0:r?r.calculateFogBlendOpacity(n):0,u_horizon_color:r?r.properties.get("horizon-color"):Gt.white,u_horizon_fog_blend:r?r.properties.get("horizon-fog-blend"):1,u_is_globe_mode:i?1:0}),hEe=t=>({u_ele_delta:t}),dEe=(t,e)=>({u_terrain_coords_id:t/255,u_texture:0,u_ele_delta:e});C();var pEe=(t,e)=>({u_projection_matrix:new bs(t,e.u_projection_matrix),u_projection_tile_mercator_coords:new hd(t,e.u_projection_tile_mercator_coords),u_projection_clipping_plane:new hd(t,e.u_projection_clipping_plane),u_projection_transition:new dt(t,e.u_projection_transition),u_projection_fallback_matrix:new bs(t,e.u_projection_fallback_matrix)}),fEe={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function eb(t){let e=[];for(let r=0;r<t.length;r++){if(t[r]===null)continue;let n=t[r].split(" ");e.push(n.pop())}return e}var mEe=class{constructor(t,e,r,n,i,a,o,s,l=[]){let u=t.gl;this.program=u.createProgram();let c=eb(e.staticAttributes),h=r?r.getBinderAttributes():[],d=c.concat(h),p=bu.prelude.staticUniforms?eb(bu.prelude.staticUniforms):[],m=o.staticUniforms?eb(o.staticUniforms):[],y=e.staticUniforms?eb(e.staticUniforms):[],v=r?r.getBinderUniforms():[],_=p.concat(m).concat(y).concat(v),w=[];for(let D of _)w.indexOf(D)<0&&w.push(D);let b=r?r.defines():[];Nc(u)&&b.unshift("#version 300 es"),i&&b.push("#define OVERDRAW_INSPECTOR;"),a&&b.push("#define TERRAIN3D;"),s&&b.push(s),l&&b.push(...l);let A=b.concat(bu.prelude.fragmentSource,o.fragmentSource,e.fragmentSource).join(`
`),E=b.concat(bu.prelude.vertexSource,o.vertexSource,e.vertexSource).join(`
`);Nc(u)||(A=DSe(A),E=PSe(E));let M=u.createShader(u.FRAGMENT_SHADER);if(u.isContextLost()){this.failedToCreate=!0;return}if(u.shaderSource(M,A),u.compileShader(M),!u.getShaderParameter(M,u.COMPILE_STATUS))throw new Error("Could not compile fragment shader: ".concat(u.getShaderInfoLog(M)));u.attachShader(this.program,M);let P=u.createShader(u.VERTEX_SHADER);if(u.isContextLost()){this.failedToCreate=!0;return}if(u.shaderSource(P,E),u.compileShader(P),!u.getShaderParameter(P,u.COMPILE_STATUS))throw new Error("Could not compile vertex shader: ".concat(u.getShaderInfoLog(P)));u.attachShader(this.program,P),this.attributes={};let k={};this.numAttributes=d.length;for(let D=0;D<this.numAttributes;D++)d[D]&&(u.bindAttribLocation(this.program,D,d[D]),this.attributes[d[D]]=D);if(u.linkProgram(this.program),!u.getProgramParameter(this.program,u.LINK_STATUS))throw new Error("Program failed to link: ".concat(u.getProgramInfoLog(this.program)));u.deleteShader(P),u.deleteShader(M);for(let D=0;D<w.length;D++){let O=w[D];if(O&&!k[O]){let B=u.getUniformLocation(this.program,O);B&&(k[O]=B)}}this.fixedUniforms=n(t,k),this.terrainUniforms=oEe(t,k),this.projectionUniforms=pEe(t,k),this.binderUniforms=r?r.getUniforms(t,k):[]}draw(t,e,r,n,i,a,o,s,l,u,c,h,d,p,m,y,v,_,w){let b=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(r),t.setStencilMode(n),t.setColorMode(i),t.setCullFace(a),s){t.activeTexture.set(b.TEXTURE2),b.bindTexture(b.TEXTURE_2D,s.depthTexture),t.activeTexture.set(b.TEXTURE3),b.bindTexture(b.TEXTURE_2D,s.texture);for(let E in this.terrainUniforms)this.terrainUniforms[E].set(s[E])}if(l)for(let E in l){let M=fEe[E];this.projectionUniforms[M].set(l[E])}if(o)for(let E in this.fixedUniforms)this.fixedUniforms[E].set(o[E]);y&&y.setUniforms(t,this.binderUniforms,p,{zoom:m});let A=0;switch(e){case b.LINES:A=2;break;case b.TRIANGLES:A=3;break;case b.LINE_STRIP:A=1;break}for(let E of d.get()){let M=E.vaos||(E.vaos={});(M[u]||(M[u]=new aEe)).bind(t,this,c,y?y.getPaintVertexBuffers():[],h,E.vertexOffset,v,_,w),b.drawElements(e,E.primitiveLength*A,b.UNSIGNED_SHORT,E.primitiveOffset*A*2)}}};C();C();C();function OX(t,e,r){let n=1/xs(r,1,e.transform.tileZoom),i=Math.pow(2,r.tileID.overscaledZ),a=r.tileSize*Math.pow(2,e.transform.tileZoom)/i,o=a*(r.tileID.canonical.x+r.tileID.wrap*i),s=a*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[n,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[o>>16,s>>16],u_pixel_coord_lower:[o&65535,s&65535]}}function gEe(t,e,r,n){let i=r.imageManager.getPattern(t.from.toString()),a=r.imageManager.getPattern(t.to.toString()),{width:o,height:s}=r.imageManager.getPixelSize(),l=Math.pow(2,n.tileID.overscaledZ),u=n.tileSize*Math.pow(2,r.transform.tileZoom)/l,c=u*(n.tileID.canonical.x+n.tileID.wrap*l),h=u*n.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:i.tl,u_pattern_br_a:i.br,u_pattern_tl_b:a.tl,u_pattern_br_b:a.br,u_texsize:[o,s],u_mix:e.t,u_pattern_size_a:i.displaySize,u_pattern_size_b:a.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/xs(n,1,r.transform.tileZoom),u_pixel_coord_upper:[c>>16,h>>16],u_pixel_coord_lower:[c&65535,h&65535]}}var yEe=(t,e)=>({u_lightpos:new fs(t,e.u_lightpos),u_lightpos_globe:new fs(t,e.u_lightpos_globe),u_lightintensity:new dt(t,e.u_lightintensity),u_lightcolor:new fs(t,e.u_lightcolor),u_vertical_gradient:new dt(t,e.u_vertical_gradient),u_opacity:new dt(t,e.u_opacity),u_fill_translate:new tr(t,e.u_fill_translate)}),vEe=(t,e)=>({u_lightpos:new fs(t,e.u_lightpos),u_lightpos_globe:new fs(t,e.u_lightpos_globe),u_lightintensity:new dt(t,e.u_lightintensity),u_lightcolor:new fs(t,e.u_lightcolor),u_vertical_gradient:new dt(t,e.u_vertical_gradient),u_height_factor:new dt(t,e.u_height_factor),u_opacity:new dt(t,e.u_opacity),u_fill_translate:new tr(t,e.u_fill_translate),u_image:new lr(t,e.u_image),u_texsize:new tr(t,e.u_texsize),u_pixel_coord_upper:new tr(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new tr(t,e.u_pixel_coord_lower),u_scale:new fs(t,e.u_scale),u_fade:new dt(t,e.u_fade)}),BX=(t,e,r,n)=>{let i=t.style.light,a=i.properties.get("position"),o=[a.x,a.y,a.z],s=o1.create();i.properties.get("anchor")==="viewport"&&o1.fromRotation(s,t.transform.bearingInRadians),Qe.transformMat3(o,o,s);let l=t.transform.transformLightDirection(o),u=i.properties.get("color");return{u_lightpos:o,u_lightpos_globe:l,u_lightintensity:i.properties.get("intensity"),u_lightcolor:[u.r,u.g,u.b],u_vertical_gradient:+e,u_opacity:r,u_fill_translate:n}},_Ee=(t,e,r,n,i,a,o)=>zt(BX(t,e,r,n),OX(a,t,o),{u_height_factor:-Math.pow(2,i.overscaledZ)/o.tileSize/8});C();var xEe=(t,e)=>({u_fill_translate:new tr(t,e.u_fill_translate)}),bEe=(t,e)=>({u_image:new lr(t,e.u_image),u_texsize:new tr(t,e.u_texsize),u_pixel_coord_upper:new tr(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new tr(t,e.u_pixel_coord_lower),u_scale:new fs(t,e.u_scale),u_fade:new dt(t,e.u_fade),u_fill_translate:new tr(t,e.u_fill_translate)}),wEe=(t,e)=>({u_world:new tr(t,e.u_world),u_fill_translate:new tr(t,e.u_fill_translate)}),AEe=(t,e)=>({u_world:new tr(t,e.u_world),u_image:new lr(t,e.u_image),u_texsize:new tr(t,e.u_texsize),u_pixel_coord_upper:new tr(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new tr(t,e.u_pixel_coord_lower),u_scale:new fs(t,e.u_scale),u_fade:new dt(t,e.u_fade),u_fill_translate:new tr(t,e.u_fill_translate)}),zX=(t,e,r,n)=>zt(OX(e,t,r),{u_fill_translate:n}),SEe=t=>({u_fill_translate:t}),EEe=(t,e)=>({u_world:t,u_fill_translate:e}),IEe=(t,e,r,n,i)=>zt(zX(t,e,r,i),{u_world:n});C();var CEe=(t,e)=>({u_camera_to_center_distance:new dt(t,e.u_camera_to_center_distance),u_scale_with_map:new lr(t,e.u_scale_with_map),u_pitch_with_map:new lr(t,e.u_pitch_with_map),u_extrude_scale:new tr(t,e.u_extrude_scale),u_device_pixel_ratio:new dt(t,e.u_device_pixel_ratio),u_globe_extrude_scale:new dt(t,e.u_globe_extrude_scale),u_translate:new tr(t,e.u_translate)}),MEe=(t,e,r,n,i)=>{let a=t.transform,o,s,l=0;if(r.paint.get("circle-pitch-alignment")==="map"){let u=xs(e,1,a.zoom);o=!0,s=[u,u],l=u/(8192*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*i}else o=!1,s=a.pixelsToGLUnits;return{u_camera_to_center_distance:a.cameraToCenterDistance,u_scale_with_map:+(r.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+o,u_device_pixel_ratio:t.pixelRatio,u_extrude_scale:s,u_globe_extrude_scale:l,u_translate:n}};C();var TEe=(t,e)=>({u_pixel_extrude_scale:new tr(t,e.u_pixel_extrude_scale)}),PEe=(t,e)=>({u_viewport_size:new tr(t,e.u_viewport_size)}),DEe=t=>({u_pixel_extrude_scale:[1/t.width,1/t.height]}),kEe=t=>({u_viewport_size:[t.width,t.height]});C();var OEe=(t,e)=>({u_color:new dd(t,e.u_color),u_overlay:new lr(t,e.u_overlay),u_overlay_scale:new dt(t,e.u_overlay_scale)}),d8=(t,e=1)=>({u_color:t,u_overlay:0,u_overlay_scale:e});C();var BEe=(t,e)=>({u_extrude_scale:new dt(t,e.u_extrude_scale),u_intensity:new dt(t,e.u_intensity),u_globe_extrude_scale:new dt(t,e.u_globe_extrude_scale)}),zEe=(t,e)=>({u_matrix:new bs(t,e.u_matrix),u_world:new tr(t,e.u_world),u_image:new lr(t,e.u_image),u_color_ramp:new lr(t,e.u_color_ramp),u_opacity:new dt(t,e.u_opacity)}),FX=(t,e,r,n)=>{let i=xs(t,1,e)/(8192*Math.pow(2,t.tileID.overscaledZ))*2*Math.PI*n;return{u_extrude_scale:xs(t,1,e),u_intensity:r,u_globe_extrude_scale:i}},RX=(t,e,r,n)=>{let i=Xe.create();Xe.ortho(i,0,t.width,t.height,0,0,1);let a=t.context.gl;return{u_matrix:i,u_world:[a.drawingBufferWidth,a.drawingBufferHeight],u_image:r,u_color_ramp:n,u_opacity:e.paint.get("heatmap-opacity")}};C();var FEe=(t,e)=>({u_image:new lr(t,e.u_image),u_latrange:new tr(t,e.u_latrange),u_exaggeration:new dt(t,e.u_exaggeration),u_altitudes:new rF(t,e.u_altitudes),u_azimuths:new rF(t,e.u_azimuths),u_accent:new dd(t,e.u_accent),u_method:new lr(t,e.u_method),u_shadows:new tF(t,e.u_shadows),u_highlights:new tF(t,e.u_highlights)}),REe=(t,e)=>({u_matrix:new bs(t,e.u_matrix),u_image:new lr(t,e.u_image),u_dimension:new tr(t,e.u_dimension),u_zoom:new dt(t,e.u_zoom),u_unpack:new hd(t,e.u_unpack)}),LEe=(t,e,r)=>{let n=r.paint.get("hillshade-accent-color"),i;switch(r.paint.get("hillshade-method")){case"basic":i=4;break;case"combined":i=1;break;case"igor":i=2;break;case"multidirectional":i=3;break;case"standard":default:i=0;break}let a=r.getIlluminationProperties();for(let o=0;o<a.directionRadians.length;o++)r.paint.get("hillshade-illumination-anchor")==="viewport"&&(a.directionRadians[o]+=t.transform.bearingInRadians);return{u_image:0,u_latrange:$Ee(t,e.tileID),u_exaggeration:r.paint.get("hillshade-exaggeration"),u_altitudes:a.altitudeRadians,u_azimuths:a.directionRadians,u_accent:n,u_method:i,u_highlights:a.highlightColor,u_shadows:a.shadowColor}},NEe=(t,e)=>{let r=e.stride,n=Xe.create();return Xe.ortho(n,0,8192,-8192,0,0,1),Xe.translate(n,n,[0,-8192,0]),{u_matrix:n,u_image:1,u_dimension:[r,r],u_zoom:t.overscaledZ,u_unpack:e.getUnpackVector()}};function $Ee(t,e){let r=Math.pow(2,e.canonical.z),n=e.canonical.y;return[new Mn(0,n/r).toLngLat().lat,new Mn(0,(n+1)/r).toLngLat().lat]}C();var UEe=(t,e)=>({u_image:new lr(t,e.u_image),u_unpack:new hd(t,e.u_unpack),u_dimension:new tr(t,e.u_dimension),u_elevation_stops:new lr(t,e.u_elevation_stops),u_color_stops:new lr(t,e.u_color_stops),u_opacity:new dt(t,e.u_opacity)}),jEe=(t,e)=>({u_image:0,u_unpack:e.getUnpackVector(),u_dimension:[e.stride,e.stride],u_elevation_stops:1,u_color_stops:4,u_opacity:t.paint.get("color-relief-opacity")});C();var VEe=(t,e)=>({u_translation:new tr(t,e.u_translation),u_ratio:new dt(t,e.u_ratio),u_device_pixel_ratio:new dt(t,e.u_device_pixel_ratio),u_units_to_pixels:new tr(t,e.u_units_to_pixels)}),GEe=(t,e)=>({u_translation:new tr(t,e.u_translation),u_ratio:new dt(t,e.u_ratio),u_device_pixel_ratio:new dt(t,e.u_device_pixel_ratio),u_units_to_pixels:new tr(t,e.u_units_to_pixels),u_image:new lr(t,e.u_image),u_image_height:new dt(t,e.u_image_height)}),ZEe=(t,e)=>({u_translation:new tr(t,e.u_translation),u_texsize:new tr(t,e.u_texsize),u_ratio:new dt(t,e.u_ratio),u_device_pixel_ratio:new dt(t,e.u_device_pixel_ratio),u_image:new lr(t,e.u_image),u_units_to_pixels:new tr(t,e.u_units_to_pixels),u_scale:new fs(t,e.u_scale),u_fade:new dt(t,e.u_fade)}),WEe=(t,e)=>({u_translation:new tr(t,e.u_translation),u_ratio:new dt(t,e.u_ratio),u_device_pixel_ratio:new dt(t,e.u_device_pixel_ratio),u_units_to_pixels:new tr(t,e.u_units_to_pixels),u_patternscale_a:new tr(t,e.u_patternscale_a),u_patternscale_b:new tr(t,e.u_patternscale_b),u_sdfgamma:new dt(t,e.u_sdfgamma),u_image:new lr(t,e.u_image),u_tex_y_a:new dt(t,e.u_tex_y_a),u_tex_y_b:new dt(t,e.u_tex_y_b),u_mix:new dt(t,e.u_mix)}),Mk=(t,e,r,n)=>{let i=t.transform;return{u_translation:NX(t,e,r),u_ratio:n/xs(e,1,i.zoom),u_device_pixel_ratio:t.pixelRatio,u_units_to_pixels:[1/i.pixelsToGLUnits[0],1/i.pixelsToGLUnits[1]]}},HEe=(t,e,r,n,i)=>zt(Mk(t,e,r,n),{u_image:0,u_image_height:i}),XEe=(t,e,r,n,i)=>{let a=t.transform,o=LX(e,a);return{u_translation:NX(t,e,r),u_texsize:e.imageAtlasTexture.size,u_ratio:n/xs(e,1,a.zoom),u_device_pixel_ratio:t.pixelRatio,u_image:0,u_scale:[o,i.fromScale,i.toScale],u_fade:i.t,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}},qEe=(t,e,r,n,i,a)=>{let o=t.transform,s=t.lineAtlas,l=LX(e,o),u=r.layout.get("line-cap")==="round",c=s.getDash(i.from,u),h=s.getDash(i.to,u),d=c.width*a.fromScale,p=h.width*a.toScale;return zt(Mk(t,e,r,n),{u_patternscale_a:[l/d,-c.height/2],u_patternscale_b:[l/p,-h.height/2],u_sdfgamma:s.width/(Math.min(d,p)*256*t.pixelRatio)/2,u_image:0,u_tex_y_a:c.y,u_tex_y_b:h.y,u_mix:a.t})};function LX(t,e){return 1/xs(t,1,e.tileZoom)}function NX(t,e,r){return cd(t.transform,e,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}C();var YEe=(t,e)=>({u_tl_parent:new tr(t,e.u_tl_parent),u_scale_parent:new dt(t,e.u_scale_parent),u_buffer_scale:new dt(t,e.u_buffer_scale),u_fade_t:new dt(t,e.u_fade_t),u_opacity:new dt(t,e.u_opacity),u_image0:new lr(t,e.u_image0),u_image1:new lr(t,e.u_image1),u_brightness_low:new dt(t,e.u_brightness_low),u_brightness_high:new dt(t,e.u_brightness_high),u_saturation_factor:new dt(t,e.u_saturation_factor),u_contrast_factor:new dt(t,e.u_contrast_factor),u_spin_weights:new fs(t,e.u_spin_weights),u_coords_top:new hd(t,e.u_coords_top),u_coords_bottom:new hd(t,e.u_coords_bottom)}),JEe=(t,e,r,n,i)=>({u_tl_parent:t,u_scale_parent:e,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*n.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:n.paint.get("raster-brightness-min"),u_brightness_high:n.paint.get("raster-brightness-max"),u_saturation_factor:eIe(n.paint.get("raster-saturation")),u_contrast_factor:QEe(n.paint.get("raster-contrast")),u_spin_weights:KEe(n.paint.get("raster-hue-rotate")),u_coords_top:[i[0].x,i[0].y,i[1].x,i[1].y],u_coords_bottom:[i[3].x,i[3].y,i[2].x,i[2].y]});function KEe(t){t*=Math.PI/180;let e=Math.sin(t),r=Math.cos(t);return[(2*r+1)/3,(-Math.sqrt(3)*e-r+1)/3,(Math.sqrt(3)*e-r+1)/3]}function QEe(t){return t>0?1/(1-t):1+t}function eIe(t){return t>0?1-1/(1.001-t):-t}C();var tIe=(t,e)=>({u_is_size_zoom_constant:new lr(t,e.u_is_size_zoom_constant),u_is_size_feature_constant:new lr(t,e.u_is_size_feature_constant),u_size_t:new dt(t,e.u_size_t),u_size:new dt(t,e.u_size),u_camera_to_center_distance:new dt(t,e.u_camera_to_center_distance),u_pitch:new dt(t,e.u_pitch),u_rotate_symbol:new lr(t,e.u_rotate_symbol),u_aspect_ratio:new dt(t,e.u_aspect_ratio),u_fade_change:new dt(t,e.u_fade_change),u_label_plane_matrix:new bs(t,e.u_label_plane_matrix),u_coord_matrix:new bs(t,e.u_coord_matrix),u_is_text:new lr(t,e.u_is_text),u_pitch_with_map:new lr(t,e.u_pitch_with_map),u_is_along_line:new lr(t,e.u_is_along_line),u_is_variable_anchor:new lr(t,e.u_is_variable_anchor),u_texsize:new tr(t,e.u_texsize),u_texture:new lr(t,e.u_texture),u_translation:new tr(t,e.u_translation),u_pitched_scale:new dt(t,e.u_pitched_scale)}),rIe=(t,e)=>({u_is_size_zoom_constant:new lr(t,e.u_is_size_zoom_constant),u_is_size_feature_constant:new lr(t,e.u_is_size_feature_constant),u_size_t:new dt(t,e.u_size_t),u_size:new dt(t,e.u_size),u_camera_to_center_distance:new dt(t,e.u_camera_to_center_distance),u_pitch:new dt(t,e.u_pitch),u_rotate_symbol:new lr(t,e.u_rotate_symbol),u_aspect_ratio:new dt(t,e.u_aspect_ratio),u_fade_change:new dt(t,e.u_fade_change),u_label_plane_matrix:new bs(t,e.u_label_plane_matrix),u_coord_matrix:new bs(t,e.u_coord_matrix),u_is_text:new lr(t,e.u_is_text),u_pitch_with_map:new lr(t,e.u_pitch_with_map),u_is_along_line:new lr(t,e.u_is_along_line),u_is_variable_anchor:new lr(t,e.u_is_variable_anchor),u_texsize:new tr(t,e.u_texsize),u_texture:new lr(t,e.u_texture),u_gamma_scale:new dt(t,e.u_gamma_scale),u_device_pixel_ratio:new dt(t,e.u_device_pixel_ratio),u_is_halo:new lr(t,e.u_is_halo),u_translation:new tr(t,e.u_translation),u_pitched_scale:new dt(t,e.u_pitched_scale)}),nIe=(t,e)=>({u_is_size_zoom_constant:new lr(t,e.u_is_size_zoom_constant),u_is_size_feature_constant:new lr(t,e.u_is_size_feature_constant),u_size_t:new dt(t,e.u_size_t),u_size:new dt(t,e.u_size),u_camera_to_center_distance:new dt(t,e.u_camera_to_center_distance),u_pitch:new dt(t,e.u_pitch),u_rotate_symbol:new lr(t,e.u_rotate_symbol),u_aspect_ratio:new dt(t,e.u_aspect_ratio),u_fade_change:new dt(t,e.u_fade_change),u_label_plane_matrix:new bs(t,e.u_label_plane_matrix),u_coord_matrix:new bs(t,e.u_coord_matrix),u_is_text:new lr(t,e.u_is_text),u_pitch_with_map:new lr(t,e.u_pitch_with_map),u_is_along_line:new lr(t,e.u_is_along_line),u_is_variable_anchor:new lr(t,e.u_is_variable_anchor),u_texsize:new tr(t,e.u_texsize),u_texsize_icon:new tr(t,e.u_texsize_icon),u_texture:new lr(t,e.u_texture),u_texture_icon:new lr(t,e.u_texture_icon),u_gamma_scale:new dt(t,e.u_gamma_scale),u_device_pixel_ratio:new dt(t,e.u_device_pixel_ratio),u_is_halo:new lr(t,e.u_is_halo),u_translation:new tr(t,e.u_translation),u_pitched_scale:new dt(t,e.u_pitched_scale)}),$X=(t,e,r,n,i,a,o,s,l,u,c,h,d)=>{let p=o.transform;return{u_is_size_zoom_constant:+(t==="constant"||t==="source"),u_is_size_feature_constant:+(t==="constant"||t==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:p.cameraToCenterDistance,u_pitch:p.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:p.width/p.height,u_fade_change:o.options.fadeDuration?o.symbolFadeChange:1,u_label_plane_matrix:s,u_coord_matrix:l,u_is_text:+c,u_pitch_with_map:+n,u_is_along_line:i,u_is_variable_anchor:a,u_texsize:h,u_texture:0,u_translation:u,u_pitched_scale:d}},UX=(t,e,r,n,i,a,o,s,l,u,c,h,d,p)=>{let m=o.transform;return zt($X(t,e,r,n,i,a,o,s,l,u,c,h,p),{u_gamma_scale:n?Math.cos(m.pitch*Math.PI/180)*m.cameraToCenterDistance:1,u_device_pixel_ratio:o.pixelRatio,u_is_halo:1})},iIe=(t,e,r,n,i,a,o,s,l,u,c,h,d)=>zt(UX(t,e,r,n,i,a,o,s,l,u,!0,c,!0,d),{u_texsize_icon:h,u_texture_icon:1});C();var aIe=(t,e)=>({u_opacity:new dt(t,e.u_opacity),u_color:new dd(t,e.u_color)}),oIe=(t,e)=>({u_opacity:new dt(t,e.u_opacity),u_image:new lr(t,e.u_image),u_pattern_tl_a:new tr(t,e.u_pattern_tl_a),u_pattern_br_a:new tr(t,e.u_pattern_br_a),u_pattern_tl_b:new tr(t,e.u_pattern_tl_b),u_pattern_br_b:new tr(t,e.u_pattern_br_b),u_texsize:new tr(t,e.u_texsize),u_mix:new dt(t,e.u_mix),u_pattern_size_a:new tr(t,e.u_pattern_size_a),u_pattern_size_b:new tr(t,e.u_pattern_size_b),u_scale_a:new dt(t,e.u_scale_a),u_scale_b:new dt(t,e.u_scale_b),u_pixel_coord_upper:new tr(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new tr(t,e.u_pixel_coord_lower),u_tile_units_to_pixels:new dt(t,e.u_tile_units_to_pixels)}),sIe=(t,e)=>({u_opacity:t,u_color:e}),lIe=(t,e,r,n,i)=>zt(gEe(r,i,e,n),{u_opacity:t});C();var uIe=(t,e)=>({u_sun_pos:new fs(t,e.u_sun_pos),u_atmosphere_blend:new dt(t,e.u_atmosphere_blend),u_globe_position:new fs(t,e.u_globe_position),u_globe_radius:new dt(t,e.u_globe_radius),u_inv_proj_matrix:new bs(t,e.u_inv_proj_matrix)}),cIe=(t,e,r,n,i)=>({u_sun_pos:t,u_atmosphere_blend:e,u_globe_position:r,u_globe_radius:n,u_inv_proj_matrix:i});C();var hIe=(t,e)=>({u_sky_color:new dd(t,e.u_sky_color),u_horizon_color:new dd(t,e.u_horizon_color),u_horizon:new tr(t,e.u_horizon),u_horizon_normal:new tr(t,e.u_horizon_normal),u_sky_horizon_blend:new dt(t,e.u_sky_horizon_blend),u_sky_blend:new dt(t,e.u_sky_blend)}),dIe=(t,e,r)=>{let n=Math.cos(e.rollInRadians),i=Math.sin(e.rollInRadians),a=Jb(e),o=e.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:t.properties.get("sky-color"),u_horizon_color:t.properties.get("horizon-color"),u_horizon:[(e.width/2-a*i)*r,(e.height/2+a*n)*r],u_horizon_normal:[-i,n],u_sky_horizon_blend:t.properties.get("sky-horizon-blend")*e.height/2*r,u_sky_blend:o}},p8=(t,e)=>{},pIe={fillExtrusion:yEe,fillExtrusionPattern:vEe,fill:xEe,fillPattern:bEe,fillOutline:wEe,fillOutlinePattern:AEe,circle:CEe,collisionBox:TEe,collisionCircle:PEe,debug:OEe,depth:p8,clippingMask:p8,heatmap:BEe,heatmapTexture:zEe,hillshade:FEe,hillshadePrepare:REe,colorRelief:UEe,line:VEe,lineGradient:GEe,linePattern:ZEe,lineSDF:WEe,raster:YEe,symbolIcon:tIe,symbolSDF:rIe,symbolTextAndIcon:nIe,background:aIe,backgroundPattern:oIe,terrain:sEe,terrainDepth:lEe,terrainCoords:uEe,projectionErrorMeasurement:$Se,atmosphere:uIe,sky:hIe};C();C();var fIe=class{constructor(t,e,r){this.context=t;let n=t.gl;this.buffer=n.createBuffer(),this.dynamicDraw=!!r,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){let e=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){let t=this.context.gl;this.buffer&&(t.deleteBuffer(this.buffer),delete this.buffer)}};C();var mIe={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},gIe=class{constructor(e,r,n,i){this.length=r.length,this.attributes=n,this.itemSize=r.bytesPerElement,this.dynamicDraw=i,this.context=e;let a=e.gl;this.buffer=a.createBuffer(),e.bindVertexBuffer.set(this.buffer),a.bufferData(a.ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?a.DYNAMIC_DRAW:a.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error("Length of new data is ".concat(e.length,", which doesn't match current length of ").concat(this.length));let r=this.context.gl;this.bind(),r.bufferSubData(r.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,r){for(let n=0;n<this.attributes.length;n++){let i=this.attributes[n],a=r.attributes[i.name];a!==void 0&&e.enableVertexAttribArray(a)}}setVertexAttribPointers(e,r,n){for(let i=0;i<this.attributes.length;i++){let a=this.attributes[i],o=r.attributes[a.name];o!==void 0&&e.vertexAttribPointer(o,a.components,e[mIe[a.type]],!1,this.itemSize,a.offset+this.itemSize*(n||0))}}destroy(){let e=this.context.gl;this.buffer&&(e.deleteBuffer(this.buffer),delete this.buffer)}};C();C();var cn=class{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}},yIe=class extends cn{getDefault(){return Gt.transparent}set(e){let r=this.current;e.r===r.r&&e.g===r.g&&e.b===r.b&&e.a===r.a&&!this.dirty||(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}},vIe=class extends cn{getDefault(){return 1}set(e){e===this.current&&!this.dirty||(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}},_Ie=class extends cn{getDefault(){return 0}set(e){e===this.current&&!this.dirty||(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}},xIe=class extends cn{getDefault(){return[!0,!0,!0,!0]}set(t){let e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&!this.dirty||(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}},bIe=class extends cn{getDefault(){return!0}set(t){t===this.current&&!this.dirty||(this.gl.depthMask(t),this.current=t,this.dirty=!1)}},wIe=class extends cn{getDefault(){return 255}set(t){t===this.current&&!this.dirty||(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}},AIe=class extends cn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){let e=this.current;t.func===e.func&&t.ref===e.ref&&t.mask===e.mask&&!this.dirty||(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}},SIe=class extends cn{getDefault(){let t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){let e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&!this.dirty||(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}},EIe=class extends cn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;let e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}},IIe=class extends cn{getDefault(){return[0,1]}set(t){let e=this.current;t[0]===e[0]&&t[1]===e[1]&&!this.dirty||(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}},CIe=class extends cn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;let e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}},MIe=class extends cn{getDefault(){return this.gl.LESS}set(t){t===this.current&&!this.dirty||(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}},TIe=class extends cn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;let e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}},PIe=class extends cn{getDefault(){let e=this.gl;return[e.ONE,e.ZERO]}set(e){let r=this.current;e[0]===r[0]&&e[1]===r[1]&&!this.dirty||(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}},DIe=class extends cn{getDefault(){return Gt.transparent}set(e){let r=this.current;e.r===r.r&&e.g===r.g&&e.b===r.b&&e.a===r.a&&!this.dirty||(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}},kIe=class extends cn{getDefault(){return this.gl.FUNC_ADD}set(e){e===this.current&&!this.dirty||(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}},OIe=class extends cn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;e?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE),this.current=e,this.dirty=!1}},BIe=class extends cn{getDefault(){return this.gl.BACK}set(e){e===this.current&&!this.dirty||(this.gl.cullFace(e),this.current=e,this.dirty=!1)}},zIe=class extends cn{getDefault(){return this.gl.CCW}set(e){e===this.current&&!this.dirty||(this.gl.frontFace(e),this.current=e,this.dirty=!1)}},FIe=class extends cn{getDefault(){return null}set(e){e===this.current&&!this.dirty||(this.gl.useProgram(e),this.current=e,this.dirty=!1)}},RIe=class extends cn{getDefault(){return this.gl.TEXTURE0}set(e){e===this.current&&!this.dirty||(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}},LIe=class extends cn{getDefault(){let e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){let r=this.current;e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]&&!this.dirty||(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}},NIe=class extends cn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,e),this.current=e,this.dirty=!1}},$Ie=class extends cn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;r.bindRenderbuffer(r.RENDERBUFFER,e),this.current=e,this.dirty=!1}},UIe=class extends cn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;r.bindTexture(r.TEXTURE_2D,e),this.current=e,this.dirty=!1}},jIe=class extends cn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;r.bindBuffer(r.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}},VIe=class extends cn{getDefault(){return null}set(e){let r=this.gl;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}},GIe=class extends cn{getDefault(){return null}set(e){var r;if(e===this.current&&!this.dirty)return;let n=this.gl;Nc(n)?n.bindVertexArray(e):(r=n.getExtension("OES_vertex_array_object"))==null||r.bindVertexArrayOES(e),this.current=e,this.dirty=!1}},ZIe=class extends cn{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}},WIe=class extends cn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}},HIe=class extends cn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}},Tk=class extends cn{constructor(e,r){super(e),this.context=e,this.parent=r}getDefault(){return null}},XIe=class extends Tk{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}},qIe=class extends Tk{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,e),this.current=e,this.dirty=!1}},YIe=class extends Tk{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,e),this.current=e,this.dirty=!1}};C();var jX="Framebuffer is not complete";function JIe(t){return t.message===jX}function KIe(){return new Error(jX)}var QIe=class{constructor(e,r,n,i,a){this.context=e,this.width=r,this.height=n;let o=e.gl,s=this.framebuffer=o.createFramebuffer();if(this.colorAttachment=new XIe(e,s),i)this.depthAttachment=a?new YIe(e,s):new qIe(e,s);else if(a)throw new Error("Stencil cannot be set without depth");if(o.checkFramebufferStatus(o.FRAMEBUFFER)!==o.FRAMEBUFFER_COMPLETE)throw KIe()}destroy(){let e=this.context.gl,r=this.colorAttachment.get();if(r&&e.deleteTexture(r),this.depthAttachment){let n=this.depthAttachment.get();n&&e.deleteRenderbuffer(n)}e.deleteFramebuffer(this.framebuffer)}},eCe=class{constructor(e){var r,n;if(this.gl=e,this.clearColor=new yIe(this),this.clearDepth=new vIe(this),this.clearStencil=new _Ie(this),this.colorMask=new xIe(this),this.depthMask=new bIe(this),this.stencilMask=new wIe(this),this.stencilFunc=new AIe(this),this.stencilOp=new SIe(this),this.stencilTest=new EIe(this),this.depthRange=new IIe(this),this.depthTest=new CIe(this),this.depthFunc=new MIe(this),this.blend=new TIe(this),this.blendFunc=new PIe(this),this.blendColor=new DIe(this),this.blendEquation=new kIe(this),this.cullFace=new OIe(this),this.cullFaceSide=new BIe(this),this.frontFace=new zIe(this),this.program=new FIe(this),this.activeTexture=new RIe(this),this.viewport=new LIe(this),this.bindFramebuffer=new NIe(this),this.bindRenderbuffer=new $Ie(this),this.bindTexture=new UIe(this),this.bindVertexBuffer=new jIe(this),this.bindElementBuffer=new VIe(this),this.bindVertexArray=new GIe(this),this.pixelStoreUnpack=new ZIe(this),this.pixelStoreUnpackPremultiplyAlpha=new WIe(this),this.pixelStoreUnpackFlipY=new HIe(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),Nc(e)){this.HALF_FLOAT=e.HALF_FLOAT;let i=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(r=e.RGBA16F)!=null?r:i?.RGBA16F_EXT,this.RGB16F=(n=e.RGB16F)!=null?n:i?.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");let i=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=i?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,r){return new fIe(this,e,r)}createVertexBuffer(e,r,n){return new gIe(this,e,r,n)}createRenderbuffer(e,r,n){let i=this.gl,a=i.createRenderbuffer();return this.bindRenderbuffer.set(a),i.renderbufferStorage(i.RENDERBUFFER,e,r,n),this.bindRenderbuffer.set(null),a}createFramebuffer(e,r,n,i){return new QIe(this,e,r,n,i)}clear({color:e,depth:r,stencil:n}){let i=this.gl,a=0;e&&(a|=i.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),typeof r<"u"&&(a|=i.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),typeof n<"u"&&(a|=i.STENCIL_BUFFER_BIT,this.clearStencil.set(n),this.stencilMask.set(255)),i.clear(a)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func===this.gl.ALWAYS&&!e.mask?this.depthTest.set(!1):(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range))}setStencilMode(e){e.test.func===this.gl.ALWAYS&&!e.mask?this.stencilTest.set(!1):(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask}))}setColorMode(e){uu(e.blendFunction,ri.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return Nc(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))==null?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var r;return Nc(this.gl)?this.gl.deleteVertexArray(e):(r=this.gl.getExtension("OES_vertex_array_object"))==null?void 0:r.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}};C();var Pk=Zt(xr(),1);C();var tb;function f8(t,e,r,n,i){let a=t.context,o=t.transform,s=a.gl,l=t.useProgram("collisionBox"),u=[],c=0,h=0;for(let _=0;_<n.length;_++){let w=n[_],b=e.getTile(w).getBucket(r);if(!b)continue;let A=i?b.textCollisionBox:b.iconCollisionBox,E=b.collisionCircleArray;E.length>0&&(u.push({circleArray:E,circleOffset:h,coord:w}),c+=E.length/4,h=c),A&&l.draw(a,s.LINES,wr.disabled,Jr.disabled,t.colorModeForRenderPass(),Xr.disabled,DEe(t.transform),t.style.map.terrain&&t.style.map.terrain.getTerrainData(w),o.getProjectionData({overscaledTileID:w,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),r.id,A.layoutVertexBuffer,A.indexBuffer,A.segments,null,t.transform.zoom,null,null,A.collisionVertexBuffer)}if(!i||!u.length)return;let d=t.useProgram("collisionCircle"),p=new n2e;p.resize(c*4),p._trim();let m=0;for(let _ of u)for(let w=0;w<_.circleArray.length/4;w++){let b=w*4,A=_.circleArray[b+0],E=_.circleArray[b+1],M=_.circleArray[b+2],P=_.circleArray[b+3];p.emplace(m++,A,E,M,P,0),p.emplace(m++,A,E,M,P,1),p.emplace(m++,A,E,M,P,2),p.emplace(m++,A,E,M,P,3)}(!tb||tb.length<c*2)&&(tb=tCe(c));let y=a.createIndexBuffer(tb,!0),v=a.createVertexBuffer(p,Qwe.members,!0);for(let _ of u){let w=kEe(t.transform);d.draw(a,s.TRIANGLES,wr.disabled,Jr.disabled,t.colorModeForRenderPass(),Xr.disabled,w,t.style.map.terrain&&t.style.map.terrain.getTerrainData(_.coord),null,r.id,v,y,Hn.simpleSegment(0,_.circleOffset*2,_.circleArray.length,_.circleArray.length/2),null,t.transform.zoom,null,null,null)}v.destroy(),y.destroy()}function tCe(t){let e=t*2,r=new a2e;r.resize(e),r._trim();for(let n=0;n<e;n++){let i=n*6;r.uint16[i+0]=n*4+0,r.uint16[i+1]=n*4+1,r.uint16[i+2]=n*4+2,r.uint16[i+3]=n*4+2,r.uint16[i+4]=n*4+3,r.uint16[i+5]=n*4+0}return r}var rCe=Xe.identity(new Float32Array(16));function nCe(t,e,r,n,i,a){if(t.renderPass!=="translucent")return;let{isRenderingToTexture:o}=a,s=Jr.disabled,l=t.colorModeForRenderPass();(r._unevaluatedLayout.hasValue("text-variable-anchor")||r._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&aCe(n,t,r,e,r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),i),r.paint.get("icon-opacity").constantOr(1)!==0&&m8(t,e,r,n,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright"),s,l,o),r.paint.get("text-opacity").constantOr(1)!==0&&m8(t,e,r,n,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright"),s,l,o),e.map.showCollisionBoxes&&(f8(t,e,r,n,!0),f8(t,e,r,n,!1))}function iCe(t,e,r,n,i,a){let{horizontalAlign:o,verticalAlign:s}=VH(t),l=-(o-.5)*e,u=-(s-.5)*r;return new Pk.default((l/i+n[0])*a,(u/i+n[1])*a)}function aCe(t,e,r,n,i,a,o,s,l){let u=e.transform,c=e.style.map.terrain,h=i==="map",d=a==="map";for(let p of t){let m=n.getTile(p),y=m.getBucket(r);if(!y||!y.text||!y.text.segments.get().length)continue;let v=y.textSizeData,_=S3(v,u.zoom),w=xs(m,1,e.transform.zoom),b=Ak(h,e.transform,w),A=r.layout.get("icon-text-fit")!=="none"&&y.hasIconData();if(_){let E=Math.pow(2,u.zoom-m.tileID.overscaledZ),M=c?(k,D)=>c.getElevation(p,k,D):null,P=cd(u,m,o,s);sCe(y,h,d,l,u,b,E,_,A,P,p.toUnwrapped(),M)}}}function oCe(t,e,r,n,i,a){let o=e.tileAnchorPoint.add(new Pk.default(e.translation[0],e.translation[1]));if(e.pitchWithMap){let s=n.mult(a);r||(s=s.rotate(-i));let l=o.add(s);return Ek(l.x,l.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}else if(r){let s=Vp(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(t),l=Math.atan(s.y/s.x)+(s.x<0?Math.PI:0);return t.add(n.rotate(l))}else return t.add(n)}function sCe(t,e,r,n,i,a,o,s,l,u,c,h){let d=t.text.placedSymbolArray,p=t.text.dynamicLayoutVertexArray,m=t.icon.dynamicLayoutVertexArray,y={};p.clear();for(let v=0;v<d.length;v++){let _=d.get(v),w=t.allowVerticalPlacement&&!_.placedOrientation,b=!_.hidden&&_.crossTileID&&!w?n[_.crossTileID]:null;if(!b)sg(_.numGlyphs,p);else{let A=new Pk.default(_.anchorX,_.anchorY),E={getElevation:h,width:i.width,height:i.height,pitchedLabelPlaneMatrix:a,pitchWithMap:r,transform:i,tileAnchorPoint:A,translation:u,unwrappedTileID:c},M=r?lX(A.x,A.y,E):Vp(A.x,A.y,E),P=aX(i.cameraToCenterDistance,M.signedDistanceFromCamera),k=wk(t.textSizeData,s,_)*P/$H;r&&(k*=t.tilePixelRatio/o);let{width:D,height:O,anchor:B,textOffset:L,textBoxScale:R}=b,T=iCe(B,D,O,L,R,k),N=i.getPitchedTextCorrection(A.x+u[0],A.y+u[1],c),$=oCe(M.point,E,e,T,-i.bearingInRadians,N),V=t.allowVerticalPlacement&&_.placedOrientation===2?Math.PI/2:0;for(let G=0;G<_.numGlyphs;G++)w1(p,$,V);l&&_.associatedIconIndex>=0&&(y[_.associatedIconIndex]={shiftedAnchor:$,angle:V})}}if(l){m.clear();let v=t.icon.placedSymbolArray;for(let _=0;_<v.length;_++){let w=v.get(_);if(w.hidden)sg(w.numGlyphs,m);else{let b=y[_];if(!b)sg(w.numGlyphs,m);else for(let A=0;A<w.numGlyphs;A++)w1(m,b.shiftedAnchor,b.angle)}}t.icon.dynamicLayoutVertexBuffer.updateData(m)}t.text.dynamicLayoutVertexBuffer.updateData(p)}function lCe(t,e,r){return r.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}function m8(t,e,r,n,i,a,o,s,l,u,c,h,d){let p=t.context,m=p.gl,y=t.transform,v=s==="map",_=l==="map",w=s!=="viewport"&&r.layout.get("symbol-placement")!=="point",b=v&&!_&&!w,A=!r.layout.get("symbol-sort-key").isConstant(),E=!1,M=t.getDepthModeForSublayer(0,wr.ReadOnly),P=r._unevaluatedLayout.hasValue("text-variable-anchor")||r._unevaluatedLayout.hasValue("text-variable-anchor-offset"),k=[],D=y.getCircleRadiusCorrection();for(let O of n){let B=e.getTile(O),L=B.getBucket(r);if(!L)continue;let R=i?L.text:L.icon;if(!R||!R.segments.get().length||!R.hasVisibleVertices)continue;let T=R.programConfigurations.get(r.id),N=i||L.sdfIcons,$=i?L.textSizeData:L.iconSizeData,V=_||y.pitch!==0,G=t.useProgram(lCe(N,i,L),T),ee=S3($,y.zoom),ie=t.style.map.terrain&&t.style.map.terrain.getTerrainData(O),me,Me=[0,0],Ae,le,_e=null,Le;if(i){if(Ae=B.glyphAtlasTexture,le=m.LINEAR,me=B.glyphAtlasTexture.size,L.iconsInText){Me=B.imageAtlasTexture.size,_e=B.imageAtlasTexture;let J=$.kind==="composite"||$.kind==="camera";Le=V||t.options.rotating||t.options.zooming||J?m.LINEAR:m.NEAREST}}else{let J=r.layout.get("icon-size").constantOr(0)!==1||L.iconsNeedLinear;Ae=B.imageAtlasTexture,le=N||t.options.rotating||t.options.zooming||J||V?m.LINEAR:m.NEAREST,me=B.imageAtlasTexture.size}let Se=xs(B,1,t.transform.zoom),Ue=Ak(v,t.transform,Se),Y=Xe.create();Xe.invert(Y,Ue);let we=jAe(_,v,t.transform,Se),q=cd(y,B,a,o),oe=y.getProjectionData({overscaledTileID:O,applyGlobeMatrix:!d,applyTerrainMatrix:!0}),ce=P&&L.hasTextData(),X=r.layout.get("icon-text-fit")!=="none"&&ce&&L.hasIconData();if(w){let J=t.style.map.terrain?(fe,Fe)=>t.style.map.terrain.getElevation(O,fe,Fe):null,Z=r.layout.get("text-rotation-alignment")==="map";GAe(L,t,i,Ue,Y,_,u,Z,O.toUnwrapped(),y.width,y.height,q,J)}let ke=i&&P||X,Ce=_?Ue:t.transform.clipSpaceToPixelsMatrix,Ee=w||ke?rCe:Ce,Ne=N&&r.paint.get(i?"text-halo-width":"icon-halo-width").constantOr(1)!==0,st;N?L.iconsInText?st=iIe($.kind,ee,b,_,w,ke,t,Ee,we,q,me,Me,D):st=UX($.kind,ee,b,_,w,ke,t,Ee,we,q,i,me,!0,D):st=$X($.kind,ee,b,_,w,ke,t,Ee,we,q,i,me,D);let Ke={program:G,buffers:R,uniformValues:st,projectionData:oe,atlasTexture:Ae,atlasTextureIcon:_e,atlasInterpolation:le,atlasInterpolationIcon:Le,isSDF:N,hasHalo:Ne};if(A&&L.canOverlap){E=!0;let J=R.segments.get();for(let Z of J)k.push({segments:new Hn([Z]),sortKey:Z.sortKey,state:Ke,terrainData:ie})}else k.push({segments:R.segments,sortKey:0,state:Ke,terrainData:ie})}E&&k.sort((O,B)=>O.sortKey-B.sortKey);for(let O of k){let B=O.state;if(p.activeTexture.set(m.TEXTURE0),B.atlasTexture.bind(B.atlasInterpolation,m.CLAMP_TO_EDGE),B.atlasTextureIcon&&(p.activeTexture.set(m.TEXTURE1),B.atlasTextureIcon&&B.atlasTextureIcon.bind(B.atlasInterpolationIcon,m.CLAMP_TO_EDGE)),B.isSDF){let L=B.uniformValues;B.hasHalo&&(L.u_is_halo=1,g8(B.buffers,O.segments,r,t,B.program,M,c,h,L,B.projectionData,O.terrainData)),L.u_is_halo=0}g8(B.buffers,O.segments,r,t,B.program,M,c,h,B.uniformValues,B.projectionData,O.terrainData)}}function g8(t,e,r,n,i,a,o,s,l,u,c){let h=n.context,d=h.gl;i.draw(h,d.TRIANGLES,a,o,s,Xr.backCCW,l,c,u,r.id,t.layoutVertexBuffer,t.indexBuffer,e,r.paint,n.transform.zoom,t.programConfigurations.get(r.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}C();function uCe(t,e,r,n,i){if(t.renderPass!=="translucent")return;let{isRenderingToTexture:a}=i,o=r.paint.get("circle-opacity"),s=r.paint.get("circle-stroke-width"),l=r.paint.get("circle-stroke-opacity"),u=!r.layout.get("circle-sort-key").isConstant();if(o.constantOr(1)===0&&(s.constantOr(1)===0||l.constantOr(1)===0))return;let c=t.context,h=c.gl,d=t.transform,p=t.getDepthModeForSublayer(0,wr.ReadOnly),m=Jr.disabled,y=t.colorModeForRenderPass(),v=[],_=d.getCircleRadiusCorrection();for(let w=0;w<n.length;w++){let b=n[w],A=e.getTile(b),E=A.getBucket(r);if(!E)continue;let M=r.paint.get("circle-translate"),P=r.paint.get("circle-translate-anchor"),k=cd(d,A,M,P),D=E.programConfigurations.get(r.id),O=t.useProgram("circle",D),B=E.layoutVertexBuffer,L=E.indexBuffer,R=t.style.map.terrain&&t.style.map.terrain.getTerrainData(b),T=MEe(t,A,r,k,_),N=d.getProjectionData({overscaledTileID:b,applyGlobeMatrix:!a,applyTerrainMatrix:!0}),$={programConfiguration:D,program:O,layoutVertexBuffer:B,indexBuffer:L,uniformValues:T,terrainData:R,projectionData:N};if(u){let V=E.segments.get();for(let G of V)v.push({segments:new Hn([G]),sortKey:G.sortKey,state:$})}else v.push({segments:E.segments,sortKey:0,state:$})}u&&v.sort((w,b)=>w.sortKey-b.sortKey);for(let w of v){let{programConfiguration:b,program:A,layoutVertexBuffer:E,indexBuffer:M,uniformValues:P,terrainData:k,projectionData:D}=w.state,O=w.segments;A.draw(c,h.TRIANGLES,p,m,y,Xr.backCCW,P,k,D,r.id,E,M,O,r.paint,t.transform.zoom,b)}}C();function cCe(t,e,r,n,i){if(r.paint.get("heatmap-opacity")===0)return;let a=t.context,{isRenderingToTexture:o,isRenderingGlobe:s}=i;if(t.style.map.terrain){for(let l of n){let u=e.getTile(l);e.hasRenderableParent(l)||(t.renderPass==="offscreen"?pCe(t,u,r,l,s):t.renderPass==="translucent"&&fCe(t,r,l,o,s))}a.viewport.set([0,0,t.width,t.height])}else t.renderPass==="offscreen"?hCe(t,e,r,n):t.renderPass==="translucent"&&dCe(t,r)}function hCe(t,e,r,n){let i=t.context,a=i.gl,o=t.transform,s=Jr.disabled,l=new ri([a.ONE,a.ONE],Gt.transparent,[!0,!0,!0,!0]);mCe(i,t,r),i.clear({color:Gt.transparent});for(let u=0;u<n.length;u++){let c=n[u];if(e.hasRenderableParent(c))continue;let h=e.getTile(c),d=h.getBucket(r);if(!d)continue;let p=d.programConfigurations.get(r.id),m=t.useProgram("heatmap",p),y=o.getProjectionData({overscaledTileID:c,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),v=o.getCircleRadiusCorrection();m.draw(i,a.TRIANGLES,wr.disabled,s,l,Xr.backCCW,FX(h,o.zoom,r.paint.get("heatmap-intensity"),v),null,y,r.id,d.layoutVertexBuffer,d.indexBuffer,d.segments,r.paint,o.zoom,p)}i.viewport.set([0,0,t.width,t.height])}function dCe(t,e){let r=t.context,n=r.gl;r.setColorMode(t.colorModeForRenderPass());let i=e.heatmapFbos.get(v1);i&&(r.activeTexture.set(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,i.colorAttachment.get()),r.activeTexture.set(n.TEXTURE1),GX(r,e).bind(n.LINEAR,n.CLAMP_TO_EDGE),t.useProgram("heatmapTexture").draw(r,n.TRIANGLES,wr.disabled,Jr.disabled,t.colorModeForRenderPass(),Xr.disabled,RX(t,e,0,1),null,null,e.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,e.paint,t.transform.zoom))}function pCe(t,e,r,n,i){let a=t.context,o=a.gl,s=Jr.disabled,l=new ri([o.ONE,o.ONE],Gt.transparent,[!0,!0,!0,!0]),u=e.getBucket(r);if(!u)return;let c=n.key,h=r.heatmapFbos.get(c);h||(h=VX(a,e.tileSize,e.tileSize),r.heatmapFbos.set(c,h)),a.bindFramebuffer.set(h.framebuffer),a.viewport.set([0,0,e.tileSize,e.tileSize]),a.clear({color:Gt.transparent});let d=u.programConfigurations.get(r.id),p=t.useProgram("heatmap",d,!i),m=t.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),y=t.style.map.terrain.getTerrainData(n);p.draw(a,o.TRIANGLES,wr.disabled,s,l,Xr.disabled,FX(e,t.transform.zoom,r.paint.get("heatmap-intensity"),1),y,m,r.id,u.layoutVertexBuffer,u.indexBuffer,u.segments,r.paint,t.transform.zoom,d)}function fCe(t,e,r,n,i){let a=t.context,o=a.gl,s=t.transform;a.setColorMode(t.colorModeForRenderPass());let l=GX(a,e),u=r.key,c=e.heatmapFbos.get(u);if(!c)return;a.activeTexture.set(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,c.colorAttachment.get()),a.activeTexture.set(o.TEXTURE1),l.bind(o.LINEAR,o.CLAMP_TO_EDGE);let h=s.getProjectionData({overscaledTileID:r,applyTerrainMatrix:i,applyGlobeMatrix:!n});t.useProgram("heatmapTexture").draw(a,o.TRIANGLES,wr.disabled,Jr.disabled,t.colorModeForRenderPass(),Xr.disabled,RX(t,e,0,1),null,h,e.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments,e.paint,s.zoom),c.destroy(),e.heatmapFbos.delete(u)}function mCe(t,e,r){let n=t.gl;t.activeTexture.set(n.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);let i=r.heatmapFbos.get(v1);i?(n.bindTexture(n.TEXTURE_2D,i.colorAttachment.get()),t.bindFramebuffer.set(i.framebuffer)):(i=VX(t,e.width/4,e.height/4),r.heatmapFbos.set(v1,i))}function VX(t,e,r){var n,i;let a=t.gl,o=a.createTexture();a.bindTexture(a.TEXTURE_2D,o),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);let s=(n=t.HALF_FLOAT)!=null?n:a.UNSIGNED_BYTE,l=(i=t.RGBA16F)!=null?i:a.RGBA;a.texImage2D(a.TEXTURE_2D,0,l,e,r,0,a.RGBA,s,null);let u=t.createFramebuffer(e,r,!1,!1);return u.colorAttachment.set(o),u}function GX(t,e){return e.colorRampTexture||(e.colorRampTexture=new ki(t,e.colorRamp,t.gl.RGBA)),e.colorRampTexture}C();function gCe(t,e,r,n,i){if(t.renderPass!=="translucent")return;let{isRenderingToTexture:a}=i,o=r.paint.get("line-opacity"),s=r.paint.get("line-width");if(o.constantOr(1)===0||s.constantOr(1)===0)return;let l=t.getDepthModeForSublayer(0,wr.ReadOnly),u=t.colorModeForRenderPass(),c=r.paint.get("line-dasharray"),h=r.paint.get("line-pattern"),d=h.constantOr(1),p=r.paint.get("line-gradient"),m=r.getCrossfadeParameters(),y=d?"linePattern":c?"lineSDF":p?"lineGradient":"line",v=t.context,_=v.gl,w=t.transform,b=!0;for(let A of n){let E=e.getTile(A);if(d&&!E.patternsLoaded())continue;let M=E.getBucket(r);if(!M)continue;let P=M.programConfigurations.get(r.id),k=t.context.program.get(),D=t.useProgram(y,P),O=b||D.program!==k,B=t.style.map.terrain&&t.style.map.terrain.getTerrainData(A),L=h.constantOr(null);if(L&&E.imageAtlas){let V=E.imageAtlas,G=V.patternPositions[L.to.toString()],ee=V.patternPositions[L.from.toString()];G&&ee&&P.setConstantPatternPositions(G,ee)}let R=w.getProjectionData({overscaledTileID:A,applyGlobeMatrix:!a,applyTerrainMatrix:!0}),T=w.getPixelScale(),N=d?XEe(t,E,r,T,m):c?qEe(t,E,r,T,c,m):p?HEe(t,E,r,T,M.lineClipsArray.length):Mk(t,E,r,T);if(d)v.activeTexture.set(_.TEXTURE0),E.imageAtlasTexture.bind(_.LINEAR,_.CLAMP_TO_EDGE),P.updatePaintBuffers(m);else if(c&&(O||t.lineAtlas.dirty))v.activeTexture.set(_.TEXTURE0),t.lineAtlas.bind(v);else if(p){let V=M.gradients[r.id],G=V.texture;if(r.gradientVersion!==V.version){let ee=256;if(r.stepInterpolant){let ie=e.getSource().maxzoom,me=A.canonical.z===ie?Math.ceil(1<<t.transform.maxZoom-A.canonical.z):1,Me=M.maxLineLength/8192*1024*me;ee=on(p1e(Me),256,v.maxTextureSize)}V.gradient=MH({expression:r.gradientExpression(),evaluationKey:"lineProgress",resolution:ee,image:V.gradient||void 0,clips:M.lineClipsArray}),V.texture?V.texture.update(V.gradient):V.texture=new ki(v,V.gradient,_.RGBA),V.version=r.gradientVersion,G=V.texture}v.activeTexture.set(_.TEXTURE0),G.bind(r.stepInterpolant?_.NEAREST:_.LINEAR,_.CLAMP_TO_EDGE)}let $=t.stencilModeForClipping(A);D.draw(v,_.TRIANGLES,l,$,u,Xr.disabled,N,B,R,r.id,M.layoutVertexBuffer,M.indexBuffer,M.segments,r.paint,t.transform.zoom,P,M.layoutVertexBuffer2),b=!1}}C();C();function ZX(t,e,r,n,i){if(!r||!n||!n.imageAtlas)return;let a=n.imageAtlas.patternPositions,o=a[r.to.toString()],s=a[r.from.toString()];if(!o&&s&&(o=s),!s&&o&&(s=o),!o||!s){let l=i.getPaintProperty(e);o=a[l],s=a[l]}o&&s&&t.setConstantPatternPositions(o,s)}function yCe(t,e,r,n,i){let a=r.paint.get("fill-color"),o=r.paint.get("fill-opacity");if(o.constantOr(1)===0)return;let{isRenderingToTexture:s}=i,l=t.colorModeForRenderPass(),u=r.paint.get("fill-pattern"),c=t.opaquePassEnabledForLayer()&&!u.constantOr(1)&&a.constantOr(Gt.transparent).a===1&&o.constantOr(0)===1?"opaque":"translucent";if(t.renderPass===c){let h=t.getDepthModeForSublayer(1,t.renderPass==="opaque"?wr.ReadWrite:wr.ReadOnly);y8(t,e,r,n,h,l,!1,s)}if(t.renderPass==="translucent"&&r.paint.get("fill-antialias")){let h=t.getDepthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,wr.ReadOnly);y8(t,e,r,n,h,l,!0,s)}}function y8(t,e,r,n,i,a,o,s){let l=t.context.gl,u="fill-pattern",c=r.paint.get(u),h=c&&c.constantOr(1),d=r.getCrossfadeParameters(),p,m,y,v,_,w=t.transform,b=r.paint.get("fill-translate"),A=r.paint.get("fill-translate-anchor");o?(m=h&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",p=l.LINES):(m=h?"fillPattern":"fill",p=l.TRIANGLES);let E=c.constantOr(null);for(let M of n){let P=e.getTile(M);if(h&&!P.patternsLoaded())continue;let k=P.getBucket(r);if(!k)continue;let D=k.programConfigurations.get(r.id),O=t.useProgram(m,D),B=t.style.map.terrain&&t.style.map.terrain.getTerrainData(M);h&&(t.context.activeTexture.set(l.TEXTURE0),P.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),D.updatePaintBuffers(d)),ZX(D,u,E,P,r);let L=w.getProjectionData({overscaledTileID:M,applyGlobeMatrix:!s,applyTerrainMatrix:!0}),R=cd(w,P,b,A);if(!o)v=k.indexBuffer,_=k.segments,y=h?zX(t,d,P,R):SEe(R);else{v=k.indexBuffer2,_=k.segments2;let N=[l.drawingBufferWidth,l.drawingBufferHeight];y=m==="fillOutlinePattern"&&h?IEe(t,d,P,N,R):EEe(N,R)}let T=t.stencilModeForClipping(M);O.draw(t.context,p,i,T,a,Xr.backCCW,y,B,L,r.id,k.layoutVertexBuffer,v,_,r.paint,t.transform.zoom,D)}}C();function vCe(t,e,r,n,i){let a=r.paint.get("fill-extrusion-opacity");if(a===0)return;let{isRenderingToTexture:o}=i;if(t.renderPass==="translucent"){let s=new wr(t.context.gl.LEQUAL,wr.ReadWrite,t.depthRangeFor3D);if(a===1&&!r.paint.get("fill-extrusion-pattern").constantOr(1)){let l=t.colorModeForRenderPass();WE(t,e,r,n,s,Jr.disabled,l,o)}else WE(t,e,r,n,s,Jr.disabled,ri.disabled,o),WE(t,e,r,n,s,t.stencilModeFor3D(),t.colorModeForRenderPass(),o)}}function WE(t,e,r,n,i,a,o,s){let l=t.context,u=l.gl,c="fill-extrusion-pattern",h=r.paint.get(c),d=h.constantOr(1),p=r.getCrossfadeParameters(),m=r.paint.get("fill-extrusion-opacity"),y=h.constantOr(null),v=t.transform;for(let _ of n){let w=e.getTile(_),b=w.getBucket(r);if(!b)continue;let A=t.style.map.terrain&&t.style.map.terrain.getTerrainData(_),E=b.programConfigurations.get(r.id),M=t.useProgram(d?"fillExtrusionPattern":"fillExtrusion",E);d&&(t.context.activeTexture.set(u.TEXTURE0),w.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),E.updatePaintBuffers(p));let P=v.getProjectionData({overscaledTileID:_,applyGlobeMatrix:!s,applyTerrainMatrix:!0});ZX(E,c,y,w,r);let k=cd(v,w,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),D=r.paint.get("fill-extrusion-vertical-gradient"),O=d?_Ee(t,D,m,k,_,p,w):BX(t,D,m,k);M.draw(l,l.gl.TRIANGLES,i,a,o,Xr.backCCW,O,A,P,r.id,b.layoutVertexBuffer,b.indexBuffer,b.segments,r.paint,t.transform.zoom,E,t.style.map.terrain&&b.centroidVertexBuffer)}}C();function _Ce(t,e,r,n,i){if(t.renderPass!=="offscreen"&&t.renderPass!=="translucent")return;let{isRenderingToTexture:a}=i,o=t.context,s=t.style.projection.useSubdivision,l=t.getDepthModeForSublayer(0,wr.ReadOnly),u=t.colorModeForRenderPass();if(t.renderPass==="offscreen")xCe(t,e,n,r,l,Jr.disabled,u),o.viewport.set([0,0,t.width,t.height]);else if(t.renderPass==="translucent")if(s){let[c,h,d]=t.stencilConfigForOverlapTwoPass(n);HE(t,e,r,d,c,l,u,!1,a),HE(t,e,r,d,h,l,u,!0,a)}else{let[c,h]=t.getStencilConfigForOverlapAndUpdateStencilID(n);HE(t,e,r,h,c,l,u,!1,a)}}function HE(t,e,r,n,i,a,o,s,l){var u;let c=t.style.projection,h=t.context,d=t.transform,p=h.gl,m=["#define NUM_ILLUMINATION_SOURCES ".concat(r.paint.get("hillshade-highlight-color").values.length)],y=t.useProgram("hillshade",null,!1,m),v=!t.options.moving;for(let _ of n){let w=e.getTile(_),b=w.fbo;if(!b)continue;let A=c.getMeshFromTileID(h,_.canonical,s,!0,"raster"),E=(u=t.style.map.terrain)==null?void 0:u.getTerrainData(_);h.activeTexture.set(p.TEXTURE0),p.bindTexture(p.TEXTURE_2D,b.colorAttachment.get());let M=d.getProjectionData({overscaledTileID:_,aligned:v,applyGlobeMatrix:!l,applyTerrainMatrix:!0});y.draw(h,p.TRIANGLES,a,i[_.overscaledZ],o,Xr.backCCW,LEe(t,w,r),E,M,r.id,A.vertexBuffer,A.indexBuffer,A.segments)}}function xCe(t,e,r,n,i,a,o){let s=t.context,l=s.gl;for(let u of r){let c=e.getTile(u),h=c.dem;if(!h||!h.data||!c.needsHillshadePrepare)continue;let d=h.dim,p=h.stride,m=h.getPixels();if(s.activeTexture.set(l.TEXTURE1),s.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||t.getTileTexture(p),c.demTexture){let v=c.demTexture;v.update(m,{premultiply:!1}),v.bind(l.NEAREST,l.CLAMP_TO_EDGE)}else c.demTexture=new ki(s,m,l.RGBA,{premultiply:!1}),c.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);s.activeTexture.set(l.TEXTURE0);let y=c.fbo;if(!y){let v=new ki(s,{width:d,height:d,data:null},l.RGBA);v.bind(l.LINEAR,l.CLAMP_TO_EDGE),y=c.fbo=s.createFramebuffer(d,d,!0,!1),y.colorAttachment.set(v.texture)}s.bindFramebuffer.set(y.framebuffer),s.viewport.set([0,0,d,d]),t.useProgram("hillshadePrepare").draw(s,l.TRIANGLES,i,a,o,Xr.disabled,NEe(c.tileID,h),null,null,n.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments),c.needsHillshadePrepare=!1}}C();function bCe(t,e,r,n,i){if(t.renderPass!=="translucent"||!n.length)return;let{isRenderingToTexture:a}=i,o=t.style.projection.useSubdivision,s=t.getDepthModeForSublayer(0,wr.ReadOnly),l=t.colorModeForRenderPass();if(o){let[u,c,h]=t.stencilConfigForOverlapTwoPass(n);XE(t,e,r,h,u,s,l,!1,a),XE(t,e,r,h,c,s,l,!0,a)}else{let[u,c]=t.getStencilConfigForOverlapAndUpdateStencilID(n);XE(t,e,r,c,u,s,l,!1,a)}}function XE(t,e,r,n,i,a,o,s,l){var u;let c=t.style.projection,h=t.context,d=t.transform,p=h.gl,m=t.useProgram("colorRelief"),y=!t.options.moving,v=!0;for(let _ of n){let w=e.getTile(_),b=w.dem;if(v){let D=p.getParameter(p.MAX_TEXTURE_SIZE),{elevationTexture:O,colorTexture:B}=r.getColorRampTextures(h,D,b.getUnpackVector());h.activeTexture.set(p.TEXTURE1),O.bind(p.NEAREST,p.CLAMP_TO_EDGE),h.activeTexture.set(p.TEXTURE4),B.bind(p.LINEAR,p.CLAMP_TO_EDGE),v=!1}if(!b||!b.data)continue;let A=b.stride,E=b.getPixels();if(h.activeTexture.set(p.TEXTURE0),h.pixelStoreUnpackPremultiplyAlpha.set(!1),w.demTexture=w.demTexture||t.getTileTexture(A),w.demTexture){let D=w.demTexture;D.update(E,{premultiply:!1}),D.bind(p.LINEAR,p.CLAMP_TO_EDGE)}else w.demTexture=new ki(h,E,p.RGBA,{premultiply:!1}),w.demTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE);let M=c.getMeshFromTileID(h,_.canonical,s,!0,"raster"),P=(u=t.style.map.terrain)==null?void 0:u.getTerrainData(_),k=d.getProjectionData({overscaledTileID:_,aligned:y,applyGlobeMatrix:!l,applyTerrainMatrix:!0});m.draw(h,p.TRIANGLES,a,i[_.overscaledZ],o,Xr.backCCW,jEe(r,w.dem),P,k,r.id,M.vertexBuffer,M.indexBuffer,M.segments)}}C();var rb=Zt(xr(),1),qE=[new rb.default(0,0),new rb.default(8192,0),new rb.default(8192,8192),new rb.default(0,8192)];function wCe(t,e,r,n,i){if(t.renderPass!=="translucent"||r.paint.get("raster-opacity")===0||!n.length)return;let{isRenderingToTexture:a}=i,o=e.getSource(),s=t.style.projection.useSubdivision;if(o instanceof c_)nb(t,e,r,n,null,!1,!1,o.tileCoords,o.flippedWindingOrder,a);else if(s){let[l,u,c]=t.stencilConfigForOverlapTwoPass(n);nb(t,e,r,c,l,!1,!0,qE,!1,a),nb(t,e,r,c,u,!0,!0,qE,!1,a)}else{let[l,u]=t.getStencilConfigForOverlapAndUpdateStencilID(n);nb(t,e,r,u,l,!1,!0,qE,!1,a)}}function nb(t,e,r,n,i,a,o,s,l=!1,u=!1){let c=n[n.length-1].overscaledZ,h=t.context,d=h.gl,p=t.useProgram("raster"),m=t.transform,y=t.style.projection,v=t.colorModeForRenderPass(),_=!t.options.moving;for(let w of n){let b=t.getDepthModeForSublayer(w.overscaledZ-c,r.paint.get("raster-opacity")===1?wr.ReadWrite:wr.ReadOnly,d.LESS),A=e.getTile(w);A.registerFadeDuration(r.paint.get("raster-fade-duration"));let E=e.findLoadedParent(w,0),M=e.findLoadedSibling(w),P=ACe(A,E||M||null,e,r,t.transform,t.style.map.terrain),k,D,O=r.paint.get("raster-resampling")==="nearest"?d.NEAREST:d.LINEAR;h.activeTexture.set(d.TEXTURE0),A.texture.bind(O,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),h.activeTexture.set(d.TEXTURE1),E?(E.texture.bind(O,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),k=Math.pow(2,E.tileID.overscaledZ-A.tileID.overscaledZ),D=[A.tileID.canonical.x*k%1,A.tileID.canonical.y*k%1]):A.texture.bind(O,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),A.texture.useMipmap&&h.extTextureFilterAnisotropic&&t.transform.pitch>20&&d.texParameterf(d.TEXTURE_2D,h.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,h.extTextureFilterAnisotropicMax);let B=t.style.map.terrain&&t.style.map.terrain.getTerrainData(w),L=m.getProjectionData({overscaledTileID:w,aligned:_,applyGlobeMatrix:!u,applyTerrainMatrix:!0}),R=JEe(D||[0,0],k||1,P,r,s),T=y.getMeshFromTileID(h,w.canonical,a,o,"raster"),N=i?i[w.overscaledZ]:Jr.disabled;p.draw(h,d.TRIANGLES,b,N,v,l?Xr.frontCCW:Xr.backCCW,R,B,L,r.id,T.vertexBuffer,T.indexBuffer,T.segments)}}function ACe(t,e,r,n,i,a){let o=n.paint.get("raster-fade-duration");if(!a&&o>0){let s=Dr.now(),l=(s-t.timeAdded)/o,u=e?(s-e.timeAdded)/o:-1,c=r.getSource(),h=I3(i,{tileSize:c.tileSize,roundZoom:c.roundZoom}),d=!e||Math.abs(e.tileID.overscaledZ-h)>Math.abs(t.tileID.overscaledZ-h),p=d&&t.refreshedUponExpiration?1:on(d?l:1-u,0,1);return t.refreshedUponExpiration&&l>=1&&(t.refreshedUponExpiration=!1),e?{opacity:1,mix:1-p}:{opacity:p,mix:0}}else return{opacity:1,mix:0}}C();function SCe(t,e,r,n,i){let a=r.paint.get("background-color"),o=r.paint.get("background-opacity");if(o===0)return;let{isRenderingToTexture:s}=i,l=t.context,u=l.gl,c=t.style.projection,h=t.transform,d=h.tileSize,p=r.paint.get("background-pattern");if(t.isPatternMissing(p))return;let m=!p&&a.a===1&&o===1&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass!==m)return;let y=Jr.disabled,v=t.getDepthModeForSublayer(0,m==="opaque"?wr.ReadWrite:wr.ReadOnly),_=t.colorModeForRenderPass(),w=t.useProgram(p?"backgroundPattern":"background"),b=n||C3(h,{tileSize:d,terrain:t.style.map.terrain});p&&(l.activeTexture.set(u.TEXTURE0),t.imageManager.bind(t.context));let A=r.getCrossfadeParameters();for(let E of b){let M=h.getProjectionData({overscaledTileID:E,applyGlobeMatrix:!s,applyTerrainMatrix:!0}),P=p?lIe(o,t,p,{tileID:E,tileSize:d},A):sIe(o,a),k=t.style.map.terrain&&t.style.map.terrain.getTerrainData(E),D=c.getMeshFromTileID(l,E.canonical,!1,!0,"raster");w.draw(l,u.TRIANGLES,v,y,_,Xr.backCCW,P,k,M,r.id,D.vertexBuffer,D.indexBuffer,D.segments)}}C();var ECe=new Gt(1,0,0,1),ICe=new Gt(0,1,0,1),CCe=new Gt(0,0,1,1),MCe=new Gt(1,0,1,1),TCe=new Gt(0,1,1,1);function PCe(t){let e=t.transform.padding,r=3;v8(t,t.transform.height-(e.top||0),r,ECe),v8(t,e.bottom||0,r,ICe),_8(t,e.left||0,r,CCe),_8(t,t.transform.width-(e.right||0),r,MCe);let n=t.transform.centerPoint;DCe(t,n.x,t.transform.height-n.y,TCe)}function DCe(t,e,r,n){R4(t,e-2/2,r-20/2,2,20,n),R4(t,e-20/2,r-2/2,20,2,n)}function v8(t,e,r,n){R4(t,0,e+r/2,t.transform.width,r,n)}function _8(t,e,r,n){R4(t,e-r/2,0,r,t.transform.height,n)}function R4(t,e,r,n,i,a){let o=t.context,s=o.gl;s.enable(s.SCISSOR_TEST),s.scissor(e*t.pixelRatio,r*t.pixelRatio,n*t.pixelRatio,i*t.pixelRatio),o.clear({color:a}),s.disable(s.SCISSOR_TEST)}function kCe(t,e,r){for(let n=0;n<r.length;n++)OCe(t,e,r[n])}function OCe(t,e,r){let n=t.context,i=n.gl,a=t.useProgram("debug"),o=wr.disabled,s=Jr.disabled,l=t.colorModeForRenderPass(),u="$debug",c=t.style.map.terrain&&t.style.map.terrain.getTerrainData(r);n.activeTexture.set(i.TEXTURE0);let h=e.getTileByID(r.key).latestRawTileData,d=h&&h.byteLength||0,p=Math.floor(d/1024),m=e.getTile(r).tileSize,y=512/Math.min(m,512)*(r.overscaledZ/t.transform.zoom)*.5,v=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(v+=" => ".concat(r.overscaledZ));let _="".concat(v," ").concat(p,"kB");BCe(t,_);let w=t.transform.getProjectionData({overscaledTileID:r,applyGlobeMatrix:!0,applyTerrainMatrix:!0});a.draw(n,i.TRIANGLES,o,s,ri.alphaBlended,Xr.disabled,d8(Gt.transparent,y),null,w,u,t.debugBuffer,t.quadTriangleIndexBuffer,t.debugSegments),a.draw(n,i.LINE_STRIP,o,s,l,Xr.disabled,d8(Gt.red),c,w,u,t.debugBuffer,t.tileBorderIndexBuffer,t.debugSegments)}function BCe(t,e){t.initDebugOverlayCanvas();let r=t.debugOverlayCanvas,n=t.context.gl,i=t.debugOverlayCanvas.getContext("2d");i.clearRect(0,0,r.width,r.height),i.shadowColor="white",i.shadowBlur=2,i.lineWidth=1.5,i.strokeStyle="white",i.textBaseline="top",i.font="bold 36px Open Sans, sans-serif",i.fillText(e,5,5),i.strokeText(e,5,5),t.debugOverlayTexture.update(r),t.debugOverlayTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}function zCe(t,e){let r=null,n=Object.values(t._layers).flatMap(s=>s.source&&!s.isHidden(e)?[t.sourceCaches[s.source]]:[]),i=n.filter(s=>s.getSource().type==="vector"),a=n.filter(s=>s.getSource().type!=="vector"),o=s=>{(!r||r.getSource().maxzoom<s.getSource().maxzoom)&&(r=s)};return i.forEach(s=>o(s)),r||a.forEach(s=>o(s)),r}C();function FCe(t,e,r,n){let{isRenderingGlobe:i}=n,a=t.context,o=r.implementation,s=t.style.projection,l=t.transform,u=l.getProjectionDataForCustomLayer(i),c={farZ:l.farZ,nearZ:l.nearZ,fov:l.fov*Math.PI/180,modelViewProjectionMatrix:l.modelViewProjectionMatrix,projectionMatrix:l.projectionMatrix,shaderData:{variantName:s.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
`.concat(s.shaderPreludeCode.vertexSource),define:s.shaderDefine},defaultProjectionData:u},h=o.renderingMode?o.renderingMode:"2d";if(t.renderPass==="offscreen"){let d=o.prerender;d&&(t.setCustomLayerDefaults(),a.setColorMode(t.colorModeForRenderPass()),d.call(o,a.gl,c),a.setDirty(),t.setBaseState())}else if(t.renderPass==="translucent"){t.setCustomLayerDefaults(),a.setColorMode(t.colorModeForRenderPass()),a.setStencilMode(Jr.disabled);let d=h==="3d"?t.getDepthModeFor3D():t.getDepthModeForSublayer(0,wr.ReadOnly);a.setDepthMode(d),o.render(a.gl,c),a.setDirty(),t.setBaseState(),a.bindFramebuffer.set(null)}}C();function RCe(t,e){let r=t.context,n=r.gl,i=t.transform,a=ri.unblended,o=new wr(n.LEQUAL,wr.ReadWrite,[0,1]),s=e.sourceCache.getRenderableTiles(),l=t.useProgram("terrainDepth");r.bindFramebuffer.set(e.getFramebuffer("depth").framebuffer),r.viewport.set([0,0,t.width/devicePixelRatio,t.height/devicePixelRatio]),r.clear({color:Gt.transparent,depth:1});for(let u of s){let c=e.getTerrainMesh(u.tileID),h=e.getTerrainData(u.tileID),d=i.getProjectionData({overscaledTileID:u.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),p=hEe(e.getMeshFrameDelta(i.zoom));l.draw(r,n.TRIANGLES,o,Jr.disabled,a,Xr.backCCW,p,h,d,"terrain",c.vertexBuffer,c.indexBuffer,c.segments)}r.bindFramebuffer.set(null),r.viewport.set([0,0,t.width,t.height])}function LCe(t,e){let r=t.context,n=r.gl,i=t.transform,a=ri.unblended,o=new wr(n.LEQUAL,wr.ReadWrite,[0,1]),s=e.getCoordsTexture(),l=e.sourceCache.getRenderableTiles(),u=t.useProgram("terrainCoords");r.bindFramebuffer.set(e.getFramebuffer("coords").framebuffer),r.viewport.set([0,0,t.width/devicePixelRatio,t.height/devicePixelRatio]),r.clear({color:Gt.transparent,depth:1}),e.coordsIndex=[];for(let c of l){let h=e.getTerrainMesh(c.tileID),d=e.getTerrainData(c.tileID);r.activeTexture.set(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,s.texture);let p=dEe(255-e.coordsIndex.length,e.getMeshFrameDelta(i.zoom)),m=i.getProjectionData({overscaledTileID:c.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});u.draw(r,n.TRIANGLES,o,Jr.disabled,a,Xr.backCCW,p,d,m,"terrain",h.vertexBuffer,h.indexBuffer,h.segments),e.coordsIndex.push(c.tileID.key)}r.bindFramebuffer.set(null),r.viewport.set([0,0,t.width,t.height])}function x8(t,e,r,n){let{isRenderingGlobe:i}=n,a=t.context,o=a.gl,s=t.transform,l=t.colorModeForRenderPass(),u=t.getDepthModeFor3D(),c=t.useProgram("terrain");a.bindFramebuffer.set(null),a.viewport.set([0,0,t.width,t.height]);for(let h of r){let d=e.getTerrainMesh(h.tileID),p=t.renderToTexture.getTexture(h),m=e.getTerrainData(h.tileID);a.activeTexture.set(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,p.texture);let y=e.getMeshFrameDelta(s.zoom),v=s.calculateFogMatrix(h.tileID.toUnwrapped()),_=cEe(y,v,t.style.sky,s.pitch,i),w=s.getProjectionData({overscaledTileID:h.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});c.draw(a,o.TRIANGLES,u,Jr.disabled,l,Xr.backCCW,_,m,w,"terrain",d.vertexBuffer,d.indexBuffer,d.segments)}}C();function WX(t,e){if(!e.mesh){let r=new kc;r.emplaceBack(-1,-1),r.emplaceBack(1,-1),r.emplaceBack(1,1),r.emplaceBack(-1,1);let n=new Vl;n.emplaceBack(0,1,2),n.emplaceBack(0,2,3),e.mesh=new v0(t.createVertexBuffer(r,Kh.members),t.createIndexBuffer(n),Hn.simpleSegment(0,0,r.length,n.length))}return e.mesh}function NCe(t,e){let r=t.context,n=r.gl,i=dIe(e,t.style.map.transform,t.pixelRatio),a=new wr(n.LEQUAL,wr.ReadWrite,[0,1]),o=Jr.disabled,s=t.colorModeForRenderPass(),l=t.useProgram("sky"),u=WX(r,e);l.draw(r,n.TRIANGLES,a,o,s,Xr.disabled,i,null,void 0,"sky",u.vertexBuffer,u.indexBuffer,u.segments)}function $Ce(t,e){let r=t.properties.get("position"),n=[-r.x,-r.y,-r.z],i=Xe.identity(new Float64Array(16));return t.properties.get("anchor")==="map"&&(Xe.rotateZ(i,i,e.rollInRadians),Xe.rotateX(i,i,-e.pitchInRadians),Xe.rotateZ(i,i,e.bearingInRadians),Xe.rotateX(i,i,e.center.lat*Math.PI/180),Xe.rotateY(i,i,-e.center.lng*Math.PI/180)),Qe.transformMat4(n,n,i),n}function UCe(t,e,r){let n=t.context,i=n.gl,a=t.useProgram("atmosphere"),o=new wr(i.LEQUAL,wr.ReadOnly,[0,1]),s=t.transform,l=$Ce(r,t.transform),u=s.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),c=e.properties.get("atmosphere-blend")*u.projectionTransition;if(c===0)return;let h=M3(s.worldSize,s.center.lat),d=s.inverseProjectionMatrix,p=new Float64Array(4);p[3]=1,Pi.transformMat4(p,p,s.modelViewProjectionMatrix),p[0]/=p[3],p[1]/=p[3],p[2]/=p[3],p[3]=1,Pi.transformMat4(p,p,d),p[0]/=p[3],p[1]/=p[3],p[2]/=p[3],p[3]=1;let m=[p[0],p[1],p[2]],y=cIe(l,c,m,h,d),v=WX(n,e);a.draw(n,i.TRIANGLES,o,Jr.disabled,ri.alphaBlended,Xr.disabled,y,null,null,"atmosphere",v.vertexBuffer,v.indexBuffer,v.segments)}var jCe=class{constructor(e,r){this.context=new eCe(e),this.transform=r,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:Xe.identity(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=S1.maxUnderzooming+S1.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new pX}resize(e,r,n){if(this.width=Math.floor(e*n),this.height=Math.floor(r*n),this.pixelRatio=n,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(let i of this.style._order)this.style._layers[i].resize()}setup(){let e=this.context,r=new kc;r.emplaceBack(0,0),r.emplaceBack(8192,0),r.emplaceBack(0,8192),r.emplaceBack(8192,8192),this.tileExtentBuffer=e.createVertexBuffer(r,Kh.members),this.tileExtentSegments=Hn.simpleSegment(0,0,4,2);let n=new kc;n.emplaceBack(0,0),n.emplaceBack(8192,0),n.emplaceBack(0,8192),n.emplaceBack(8192,8192),this.debugBuffer=e.createVertexBuffer(n,Kh.members),this.debugSegments=Hn.simpleSegment(0,0,4,5);let i=new Xbe;i.emplaceBack(0,0,0,0),i.emplaceBack(8192,0,8192,0),i.emplaceBack(0,8192,0,8192),i.emplaceBack(8192,8192,8192,8192),this.rasterBoundsBuffer=e.createVertexBuffer(i,iEe.members),this.rasterBoundsSegments=Hn.simpleSegment(0,0,4,2);let a=new kc;a.emplaceBack(0,0),a.emplaceBack(8192,0),a.emplaceBack(0,8192),a.emplaceBack(8192,8192),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(a,Kh.members),this.rasterBoundsSegmentsPosOnly=Hn.simpleSegment(0,0,4,5);let o=new kc;o.emplaceBack(0,0),o.emplaceBack(1,0),o.emplaceBack(0,1),o.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(o,Kh.members),this.viewportSegments=Hn.simpleSegment(0,0,4,2);let s=new o2e;s.emplaceBack(0),s.emplaceBack(1),s.emplaceBack(3),s.emplaceBack(2),s.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(s);let l=new Vl;l.emplaceBack(1,0,2),l.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(l);let u=this.context.gl;this.stencilClearMode=new Jr({func:u.ALWAYS,mask:0},0,255,u.ZERO,u.ZERO,u.ZERO),this.tileExtentMesh=new v0(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){let e=this.context,r=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;let n=Xe.create();Xe.ortho(n,0,this.width,this.height,0,0,1),Xe.scale(n,n,[r.drawingBufferWidth,r.drawingBufferHeight,0]);let i={mainMatrix:n,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:n};this.useProgram("clippingMask",null,!0).draw(e,r.TRIANGLES,wr.disabled,this.stencilClearMode,ri.disabled,Xr.disabled,null,null,i,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,r,n){if(this.currentStencilSource===e.source||!e.isTileClipped()||!r||!r.length)return;this.currentStencilSource=e.source,this.nextStencilID+r.length>256&&this.clearStencil();let i=this.context;i.setColorMode(ri.disabled),i.setDepthMode(wr.disabled);let a={};for(let o of r)a[o.key]=this.nextStencilID++;this._renderTileMasks(a,r,n,!0),this._renderTileMasks(a,r,n,!1),this._tileClippingMaskIDs=a}_renderTileMasks(e,r,n,i){let a=this.context,o=a.gl,s=this.style.projection,l=this.transform,u=this.useProgram("clippingMask");for(let c of r){let h=e[c.key],d=this.style.map.terrain&&this.style.map.terrain.getTerrainData(c),p=s.getMeshFromTileID(this.context,c.canonical,i,!0,"stencil"),m=l.getProjectionData({overscaledTileID:c,applyGlobeMatrix:!n,applyTerrainMatrix:!0});u.draw(a,o.TRIANGLES,wr.disabled,new Jr({func:o.ALWAYS,mask:0},h,255,o.KEEP,o.KEEP,o.REPLACE),ri.disabled,n?Xr.disabled:Xr.backCCW,null,d,m,"$clipping",p.vertexBuffer,p.indexBuffer,p.segments)}}_renderTilesDepthBuffer(){let e=this.context,r=e.gl,n=this.style.projection,i=this.transform,a=this.useProgram("depth"),o=this.getDepthModeFor3D(),s=C3(i,{tileSize:i.tileSize});for(let l of s){let u=this.style.map.terrain&&this.style.map.terrain.getTerrainData(l),c=n.getMeshFromTileID(this.context,l.canonical,!0,!0,"raster"),h=i.getProjectionData({overscaledTileID:l,applyGlobeMatrix:!0,applyTerrainMatrix:!0});a.draw(e,r.TRIANGLES,o,Jr.disabled,ri.disabled,Xr.backCCW,null,u,h,"$clipping",c.vertexBuffer,c.indexBuffer,c.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();let e=this.nextStencilID++,r=this.context.gl;return new Jr({func:r.NOTEQUAL,mask:255},e,255,r.KEEP,r.KEEP,r.REPLACE)}stencilModeForClipping(e){let r=this.context.gl;return new Jr({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,r.KEEP,r.KEEP,r.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){let r=this.context.gl,n=e.sort((o,s)=>s.overscaledZ-o.overscaledZ),i=n[n.length-1].overscaledZ,a=n[0].overscaledZ-i+1;if(a>1){this.currentStencilSource=void 0,this.nextStencilID+a>256&&this.clearStencil();let o={};for(let s=0;s<a;s++)o[s+i]=new Jr({func:r.GEQUAL,mask:255},s+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=a,[o,n]}return[{[i]:Jr.disabled},n]}stencilConfigForOverlapTwoPass(e){let r=this.context.gl,n=e.sort((o,s)=>s.overscaledZ-o.overscaledZ),i=n[n.length-1].overscaledZ,a=n[0].overscaledZ-i+1;if(this.clearStencil(),a>1){let o={},s={};for(let l=0;l<a;l++)o[l+i]=new Jr({func:r.GREATER,mask:255},a+1+l,255,r.KEEP,r.KEEP,r.REPLACE),s[l+i]=new Jr({func:r.GREATER,mask:255},1+l,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID=a*2+1,[o,s,n]}else return this.nextStencilID=3,[{[i]:new Jr({func:r.GREATER,mask:255},2,255,r.KEEP,r.KEEP,r.REPLACE)},{[i]:new Jr({func:r.GREATER,mask:255},1,255,r.KEEP,r.KEEP,r.REPLACE)},n]}colorModeForRenderPass(){let e=this.context.gl;return this._showOverdrawInspector?new ri([e.CONSTANT_COLOR,e.ONE],new Gt(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ri.unblended:ri.alphaBlended}getDepthModeForSublayer(e,r,n){if(!this.opaquePassEnabledForLayer())return wr.disabled;let i=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new wr(n||this.context.gl.LEQUAL,r,[i,i])}getDepthModeFor3D(){return new wr(this.context.gl.LEQUAL,wr.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,r){var n,i;this.style=e,this.options=r,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(Dr.now()),this.imageManager.beginFrame();let a=this.style._order,o=this.style.sourceCaches,s={},l={},u={},c={isRenderingToTexture:!1,isRenderingGlobe:((n=e.projection)==null?void 0:n.transitionState)>0};for(let d in o){let p=o[d];p.used&&p.prepare(this.context),s[d]=p.getVisibleCoordinates(!1),l[d]=s[d].slice().reverse(),u[d]=p.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let d=0;d<a.length;d++){let p=a[d];if(this.style._layers[p].is3D()){this.opaquePassCutoff=d;break}}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(let d of a){let p=this.style._layers[d];if(!p.hasOffscreenPass()||p.isHidden(this.transform.zoom))continue;let m=l[p.source];p.type!=="custom"&&!m.length||this.renderLayer(this,o[p.source],p,m,c)}if((i=this.style.projection)==null||i.updateGPUdependent({context:this.context,useProgram:d=>this.useProgram(d)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?Gt.black:Gt.transparent,depth:1}),this.clearStencil(),this.style.sky&&NCe(this,this.style.sky),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=a.length-1;this.currentLayer>=0;this.currentLayer--){let d=this.style._layers[a[this.currentLayer]],p=o[d.source],m=s[d.source];this._renderTileClippingMasks(d,m,!1),this.renderLayer(this,p,d,m,c)}this.renderPass="translucent";let h=!1;for(this.currentLayer=0;this.currentLayer<a.length;this.currentLayer++){let d=this.style._layers[a[this.currentLayer]],p=o[d.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(d,c))continue;!this.opaquePassEnabledForLayer()&&!h&&(h=!0,c.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());let m=(d.type==="symbol"?u:l)[d.source];this._renderTileClippingMasks(d,s[d.source],!!this.renderToTexture),this.renderLayer(this,p,d,m,c)}if(c.isRenderingGlobe&&UCe(this,this.style.sky,this.style.light),this.options.showTileBoundaries){let d=zCe(this.style,this.transform.zoom);d&&kCe(this,d,d.getVisibleCoordinates())}this.options.showPadding&&PCe(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;let r=this.terrainFacilitator.matrix,n=this.transform.modelViewProjectionMatrix,i=this.terrainFacilitator.dirty;i||(i=e?!Xe.exactEquals(r,n):!Xe.equals(r,n)),i||(i=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),i&&(Xe.copy(r,n),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,RCe(this,this.style.map.terrain),LCe(this,this.style.map.terrain))}renderLayer(e,r,n,i,a){n.isHidden(this.transform.zoom)||n.type!=="background"&&n.type!=="custom"&&!(i||[]).length||(this.id=n.id,_4e(n)?nCe(e,r,n,i,this.style.placement.variableOffsets,a):C2e(n)?uCe(e,r,n,i,a):k2e(n)?cCe(e,r,n,i,a):Xwe(n)?gCe(e,r,n,i,a):vwe(n)?yCe(e,r,n,i,a):Pwe(n)?vCe(e,r,n,i,a):F2e(n)?_Ce(e,r,n,i,a):U2e(n)?bCe(e,r,n,i,a):C4e(n)?wCe(e,r,n,i,a):A4e(n)?SCe(e,r,n,i,a):P4e(n)&&FCe(e,r,n,a))}saveTileTexture(e){let r=this._tileTextures[e.size[0]];r?r.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){let r=this._tileTextures[e];return r&&r.length>0?r.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;let r=this.imageManager.getPattern(e.from.toString()),n=this.imageManager.getPattern(e.to.toString());return!r||!n}useProgram(e,r,n=!1,i=[]){this.cache=this.cache||{};let a=!!this.style.map.terrain,o=this.style.projection,s=n?bu.projectionMercator:o.shaderPreludeCode,l=n?fX:o.shaderDefine,u="/".concat(n?mX:o.shaderVariantName),c=r?r.cacheKey:"",h=this._showOverdrawInspector?"/overdraw":"",d=a?"/terrain":"",p=i?"/".concat(i.join("/")):"",m=e+c+u+h+d+p;return this.cache[m]||(this.cache[m]=new mEe(this.context,bu[e],r,pIe[e],this._showOverdrawInspector,a,s,l,i)),this.cache[m]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){let e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){if(this.debugOverlayCanvas==null){this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512;let e=this.context.gl;this.debugOverlayTexture=new ki(this.context,this.debugOverlayCanvas,e.RGBA)}}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){let{drawingBufferWidth:e,drawingBufferHeight:r}=this.context.gl;return this.width!==e||this.height!==r}};C();C();function Dk(t,e){let r=!1,n=null,i=null,a,o=()=>{n=null,r&&(t.apply(i,a),n=setTimeout(o,e),r=!1)};return(...s)=>(r=!0,i=this,a=s,n||o(),n)}var VCe=class{constructor(e){this._getCurrentHash=()=>{let r=window.location.hash.replace("#","");if(this._hashName){let n;return r.split("&").map(i=>i.split("=")).forEach(i=>{i[0]===this._hashName&&(n=i)}),(n&&n[1]||"").split("/")}return r.split("/")},this._onHashChange=()=>{let r=this._getCurrentHash();if(!this._isValidHash(r))return!1;let n=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(r[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:n,pitch:+(r[4]||0)}),!0},this._updateHashUnthrottled=()=>{let r=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,r)},this._removeHash=()=>{let r=this._getCurrentHash();if(r.length===0)return;let n=r.join("/"),i=n;i.split("&").length>0&&(i=i.split("&")[0]),this._hashName&&(i="".concat(this._hashName,"=").concat(n));let a=window.location.hash.replace(i,"");a.startsWith("#&")?a=a.slice(0,1)+a.slice(2):a==="#"&&(a="");let o=window.location.href.replace(/(#.+)?$/,a);o=o.replace("&&","&"),window.history.replaceState(window.history.state,null,o)},this._updateHash=Dk(this._updateHashUnthrottled,30*1e3/100),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){let r=this._map.getCenter(),n=Math.round(this._map.getZoom()*100)/100,i=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),a=Math.pow(10,i),o=Math.round(r.lng*a)/a,s=Math.round(r.lat*a)/a,l=this._map.getBearing(),u=this._map.getPitch(),c="";if(e?c+="/".concat(o,"/").concat(s,"/").concat(n):c+="".concat(n,"/").concat(s,"/").concat(o),(l||u)&&(c+="/".concat(Math.round(l*10)/10)),u&&(c+="/".concat(Math.round(u))),this._hashName){let h=this._hashName,d=!1,p=window.location.hash.slice(1).split("&").map(m=>{let y=m.split("=")[0];return y===h?(d=!0,"".concat(y,"=").concat(c)):m}).filter(m=>m);return d||p.push("".concat(h,"=").concat(c)),"#".concat(p.join("&"))}return"#".concat(c)}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new ar(+e[2],+e[1])}catch{return!1}let r=+e[0],n=+(e[3]||0),i=+(e[4]||0);return r>=this._map.getMinZoom()&&r<=this._map.getMaxZoom()&&n>=-180&&n<=180&&i>=this._map.getMinPitch()&&i<=this._map.getMaxPitch()}};C();C();var GCe=Zt(xr(),1),h_={linearity:.3,easing:b5(0,0,.3,1)},ZCe=zt({deceleration:2500,maxSpeed:1400},h_),WCe=zt({deceleration:20,maxSpeed:1400},h_),HCe=zt({deceleration:1e3,maxSpeed:360},h_),XCe=zt({deceleration:1e3,maxSpeed:90},h_),qCe=zt({deceleration:1e3,maxSpeed:360},h_),YCe=class{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Dr.now(),settings:e})}_drainInertiaBuffer(){let e=this._inertiaBuffer,r=Dr.now(),n=160;for(;e.length>0&&r-e[0].time>n;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;let r={zoom:0,bearing:0,pitch:0,roll:0,pan:new GCe.default(0,0),pinchAround:void 0,around:void 0};for(let{settings:a}of this._inertiaBuffer)r.zoom+=a.zoomDelta||0,r.bearing+=a.bearingDelta||0,r.pitch+=a.pitchDelta||0,r.roll+=a.rollDelta||0,a.panDelta&&r.pan._add(a.panDelta),a.around&&(r.around=a.around),a.pinchAround&&(r.pinchAround=a.pinchAround);let n=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,i={};if(r.pan.mag()){let a=py(r.pan.mag(),n,zt({},ZCe,e||{})),o=r.pan.mult(a.amount/r.pan.mag()),s=this._map.cameraHelper.handlePanInertia(o,this._map.transform);i.center=s.easingCenter,i.offset=s.easingOffset,dy(i,a)}if(r.zoom){let a=py(r.zoom,n,WCe);i.zoom=this._map.transform.zoom+a.amount,dy(i,a)}if(r.bearing){let a=py(r.bearing,n,HCe);i.bearing=this._map.transform.bearing+on(a.amount,-179,179),dy(i,a)}if(r.pitch){let a=py(r.pitch,n,XCe);i.pitch=this._map.transform.pitch+a.amount,dy(i,a)}if(r.roll){let a=py(r.roll,n,qCe);i.roll=this._map.transform.roll+on(a.amount,-179,179),dy(i,a)}if(i.zoom||i.bearing){let a=r.pinchAround===void 0?r.around:r.pinchAround;i.around=a?this._map.unproject(a):this._map.getCenter()}return this.clear(),zt(i,{noMoveStart:!0})}};function dy(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function py(t,e,r){let{maxSpeed:n,linearity:i,deceleration:a}=r,o=on(t*i/(e/1e3),-n,n),s=Math.abs(o)/(a*i);return{easing:r.easing,duration:s*1e3,amount:o*(s/2)}}C();C();var JCe=Zt(xr(),1),Us=class extends ht{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,n,i={}){n=n instanceof MouseEvent?n:new MouseEvent(e,n);let a=Fr.mousePos(r.getCanvas(),n),o=r.unproject(a);super(e,zt({point:a,lngLat:o,originalEvent:n},i)),this._defaultPrevented=!1,this.target=r}},ib=class extends ht{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,e,r){let n=t==="touchend"?r.changedTouches:r.touches,i=Fr.touchPos(e.getCanvasContainer(),n),a=i.map(l=>e.unproject(l)),o=i.reduce((l,u,c,h)=>l.add(u.div(h.length)),new JCe.default(0,0)),s=e.unproject(o);super(t,{points:i,point:o,lngLats:a,lngLat:s,originalEvent:r}),this._defaultPrevented=!1}},KCe=class extends ht{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,n){super(e,{originalEvent:n}),this._defaultPrevented=!1}},QCe=class{constructor(e,r){this._map=e,this._clickTolerance=r.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new KCe(e.type,this._map,e))}mousedown(e,r){return this._mousedownPos=r,this._firePreventable(new Us(e.type,this._map,e))}mouseup(e){this._map.fire(new Us(e.type,this._map,e))}click(e,r){this._mousedownPos&&this._mousedownPos.dist(r)>=this._clickTolerance||this._map.fire(new Us(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Us(e.type,this._map,e))}mouseover(e){this._map.fire(new Us(e.type,this._map,e))}mouseout(e){this._map.fire(new Us(e.type,this._map,e))}touchstart(e){return this._firePreventable(new ib(e.type,this._map,e))}touchmove(e){this._map.fire(new ib(e.type,this._map,e))}touchend(e){this._map.fire(new ib(e.type,this._map,e))}touchcancel(e){this._map.fire(new ib(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}},eMe=class{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Us(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Us("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Us(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}};C();C();var tMe=Zt(xr(),1),d_=class{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(tMe.default.convert(e),this._map.terrain)}},rMe=class{constructor(t,e){this._map=t,this._tr=new d_(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,e){this.isEnabled()&&t.shiftKey&&t.button===0&&(Fr.disableDrag(),this._startPos=this._lastPos=e,this._active=!0)}mousemoveWindow(t,e){if(!this._active)return;let r=e;if(this._lastPos.equals(r)||!this._box&&r.dist(this._startPos)<this._clickTolerance)return;let n=this._startPos;this._lastPos=r,this._box||(this._box=Fr.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));let i=Math.min(n.x,r.x),a=Math.max(n.x,r.x),o=Math.min(n.y,r.y),s=Math.max(n.y,r.y);Fr.setTransform(this._box,"translate(".concat(i,"px,").concat(o,"px)")),this._box.style.width="".concat(a-i,"px"),this._box.style.height="".concat(s-o,"px")}mouseupWindow(t,e){if(!this._active||t.button!==0)return;let r=this._startPos,n=e;if(this.reset(),Fr.suppressClick(),r.x===n.x&&r.y===n.y)this._fireEvent("boxzoomcancel",t);else return this._map.fire(new ht("boxzoomend",{originalEvent:t})),{cameraAnimation:i=>i.fitScreenCoordinates(r,n,this._tr.bearing,{linear:!0})}}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(Fr.remove(this._box),this._box=null),Fr.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,e){return this._map.fire(new ht(t,{originalEvent:e}))}};C();C();var nMe=Zt(xr(),1);C();function FM(t,e){if(t.length!==e.length)throw new Error("The number of touches and points are not equal - touches ".concat(t.length,", points ").concat(e.length));let r={};for(let n=0;n<t.length;n++)r[t[n].identifier]=e[n];return r}function iMe(t){let e=new nMe.default(0,0);for(let r of t)e._add(r);return e.div(t.length)}var HX=500,aMe=500,kk=30,oMe=class{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,e,r){(this.centroid||r.length>this.numTouches)&&(this.aborted=!0),!this.aborted&&(this.startTime===void 0&&(this.startTime=t.timeStamp),r.length===this.numTouches&&(this.centroid=iMe(e),this.touches=FM(r,e)))}touchmove(t,e,r){if(this.aborted||!this.centroid)return;let n=FM(r,e);for(let i in this.touches){let a=this.touches[i],o=n[i];(!o||o.dist(a)>kk)&&(this.aborted=!0)}}touchend(t,e,r){if((!this.centroid||t.timeStamp-this.startTime>aMe)&&(this.aborted=!0),r.length===0){let n=!this.aborted&&this.centroid;if(this.reset(),n)return n}}},RM=class{constructor(e){this.singleTap=new oMe(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,r,n){this.singleTap.touchstart(e,r,n)}touchmove(e,r,n){this.singleTap.touchmove(e,r,n)}touchend(e,r,n){let i=this.singleTap.touchend(e,r,n);if(i){let a=e.timeStamp-this.lastTime<HX,o=!this.lastTap||this.lastTap.dist(i)<kk;if((!a||!o)&&this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=i,this.count===this.numTaps)return this.reset(),i}}},sMe=class{constructor(e){this._tr=new d_(e),this._zoomIn=new RM({numTouches:1,numTaps:2}),this._zoomOut=new RM({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,r,n){this._zoomIn.touchstart(e,r,n),this._zoomOut.touchstart(e,r,n)}touchmove(e,r,n){this._zoomIn.touchmove(e,r,n),this._zoomOut.touchmove(e,r,n)}touchend(e,r,n){let i=this._zoomIn.touchend(e,r,n),a=this._zoomOut.touchend(e,r,n),o=this._tr;if(i)return this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:s=>s.easeTo({duration:300,zoom:o.zoom+1,around:o.unproject(i)},{originalEvent:e})};if(a)return this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:s=>s.easeTo({duration:300,zoom:o.zoom-1,around:o.unproject(a)},{originalEvent:e})}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}};C();var lMe=Zt(xr(),1);C();var T3=class{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){let e=this._moveFunction(...t);if(e.bearingDelta||e.pitchDelta||e.rollDelta||e.around||e.panDelta)return this._active=!0,e}dragStart(t,e){!this.isEnabled()||this._lastPoint||this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=Array.isArray(e)?e[0]:e,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,e){if(!this.isEnabled())return;let r=this._lastPoint;if(!r)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t)){this.reset(t);return}let n=Array.isArray(e)?e[0]:e;if(!(!this._moved&&n.dist(r)<this._clickTolerance))return this._moved=!0,this._lastPoint=n,this._move(r,n)}dragEnd(t){!this.isEnabled()||!this._lastPoint||this._moveStateManager.isValidEndEvent(t)&&(this._moved&&Fr.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}};C();var uMe=0,cMe=2,hMe={[uMe]:1,[cMe]:2};function dMe(t,e){let r=hMe[e];return t.buttons===void 0||(t.buttons&r)!==r}var P3=class{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){let r=Fr.mouseButton(e);this._eventButton=r}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!dMe(e,this._eventButton)}isValidEndEvent(e){return Fr.mouseButton(e)===this._eventButton}},Ok=0,Bk=2,D3=t=>{t.mousedown=t.dragStart,t.mousemoveWindow=t.dragMove,t.mouseup=t.dragEnd,t.contextmenu=e=>{e.preventDefault()}};function pMe({enable:t,clickTolerance:e}){let r=new P3({checkCorrectEvent:n=>Fr.mouseButton(n)===Ok&&!n.ctrlKey});return new T3({clickTolerance:e,move:(n,i)=>({around:i,panDelta:i.sub(n)}),activateOnStart:!0,moveStateManager:r,enable:t,assignEvents:D3})}function fMe({enable:t,clickTolerance:e,aroundCenter:r=!0,minPixelCenterThreshold:n=100,rotateDegreesPerPixelMoved:i=.8},a){let o=new P3({checkCorrectEvent:s=>Fr.mouseButton(s)===Ok&&s.ctrlKey||Fr.mouseButton(s)===Bk&&!s.ctrlKey});return new T3({clickTolerance:e,move:(s,l)=>{let u=a();if(r&&Math.abs(u.y-s.y)>n)return{bearingDelta:A1e(new lMe.default(s.x,l.y),l,u)};let c=(l.x-s.x)*i;return r&&l.y<u.y&&(c=-c),{bearingDelta:c}},moveStateManager:o,enable:t,assignEvents:D3})}function mMe({enable:t,clickTolerance:e,pitchDegreesPerPixelMoved:r=-.5}){let n=new P3({checkCorrectEvent:i=>Fr.mouseButton(i)===Ok&&i.ctrlKey||Fr.mouseButton(i)===Bk});return new T3({clickTolerance:e,move:(i,a)=>({pitchDelta:(a.y-i.y)*r}),moveStateManager:n,enable:t,assignEvents:D3})}function gMe({enable:t,clickTolerance:e,rollDegreesPerPixelMoved:r=.3},n){let i=new P3({checkCorrectEvent:a=>Fr.mouseButton(a)===Bk&&a.ctrlKey});return new T3({clickTolerance:e,move:(a,o)=>{let s=n(),l=(o.x-a.x)*r;return o.y<s.y&&(l=-l),{rollDelta:l}},moveStateManager:i,enable:t,assignEvents:D3})}C();var YE=Zt(xr(),1),yMe=class{constructor(t,e){this._clickTolerance=t.clickTolerance||1,this._map=e,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new YE.default(0,0)}_shouldBePrevented(t){let e=this._map.cooperativeGestures.isEnabled()?2:1;return t<e}touchstart(t,e,r){return this._calculateTransform(t,e,r)}touchmove(t,e,r){if(this._active){if(this._shouldBePrevented(r.length)){this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t);return}return t.preventDefault(),this._calculateTransform(t,e,r)}}touchend(t,e,r){this._calculateTransform(t,e,r),this._active&&this._shouldBePrevented(r.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,e,r){r.length>0&&(this._active=!0);let n=FM(r,e),i=new YE.default(0,0),a=new YE.default(0,0),o=0;for(let l in n){let u=n[l],c=this._touches[l];c&&(i._add(u),a._add(u.sub(c)),o++,n[l]=u)}if(this._touches=n,this._shouldBePrevented(o)||!a.mag())return;let s=a.div(o);return this._sum._add(s),this._sum.mag()<this._clickTolerance?void 0:{around:i.div(o),panDelta:s}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}};C();var zk=class{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,e,r){this._firstTwoTouches||r.length<2||(this._firstTwoTouches=[r[0].identifier,r[1].identifier],this._start([e[0],e[1]]))}touchmove(t,e,r){if(!this._firstTwoTouches)return;t.preventDefault();let[n,i]=this._firstTwoTouches,a=ab(r,e,n),o=ab(r,e,i);if(!a||!o)return;let s=this._aroundCenter?null:a.add(o).div(2);return this._move([a,o],s,t)}touchend(t,e,r){if(!this._firstTwoTouches)return;let[n,i]=this._firstTwoTouches,a=ab(r,e,n),o=ab(r,e,i);a&&o||(this._active&&Fr.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}};function ab(t,e,r){for(let n=0;n<t.length;n++)if(t[n].identifier===r)return e[n]}var vMe=.1;function b8(t,e){return Math.log(t/e)/Math.LN2}var _Me=class extends zk{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,e){let r=this._distance;if(this._distance=t[0].dist(t[1]),!(!this._active&&Math.abs(b8(this._distance,this._startDistance))<vMe))return this._active=!0,{zoomDelta:b8(this._distance,r),pinchAround:e}}},xMe=25;function w8(t,e){return t.angleWith(e)*180/Math.PI}var bMe=class extends zk{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,e,r){let n=this._vector;if(this._vector=t[0].sub(t[1]),!(!this._active&&this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:w8(this._vector,n),pinchAround:e}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());let e=Math.PI*this._minDiameter,r=xMe/e*360,n=w8(t,this._startVector);return Math.abs(n)<r}};function JE(t){return Math.abs(t.y)>Math.abs(t.x)}var wMe=100,AMe=class extends zk{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,e,r){super.touchstart(t,e,r),this._currentTouchCount=r.length}_start(t){this._lastPoints=t,JE(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,e,r){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;let n=t[0].sub(this._lastPoints[0]),i=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(n,i,r.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(n.y+i.y)/2*-.5}):void 0}gestureBeginsVertically(t,e,r){if(this._valid!==void 0)return this._valid;let n=2,i=t.mag()>=n,a=e.mag()>=n;if(!i&&!a)return;if(!i||!a)return this._firstMove===void 0&&(this._firstMove=r),r-this._firstMove<wMe?void 0:!1;let o=t.y>0==e.y>0;return JE(t)&&JE(e)&&o}};C();var SMe={panStep:100,bearingStep:15,pitchStep:10},EMe=class{constructor(t){this._tr=new d_(t);let e=SMe;this._panStep=e.panStep,this._bearingStep=e.bearingStep,this._pitchStep=e.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let e=0,r=0,n=0,i=0,a=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?r=-1:(t.preventDefault(),i=-1);break;case 39:t.shiftKey?r=1:(t.preventDefault(),i=1);break;case 38:t.shiftKey?n=1:(t.preventDefault(),a=-1);break;case 40:t.shiftKey?n=-1:(t.preventDefault(),a=1);break;default:return}return this._rotationDisabled&&(r=0,n=0),{cameraAnimation:o=>{let s=this._tr;o.easeTo({duration:300,easeId:"keyboardHandler",easing:IMe,zoom:e?Math.round(s.zoom)+e*(t.shiftKey?2:1):s.zoom,bearing:s.bearing+r*this._bearingStep,pitch:s.pitch+n*this._pitchStep,offset:[-i*this._panStep,-a*this._panStep],center:s.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}};function IMe(t){return t*(2-t)}C();var A8=4.000244140625,CMe=1/100,MMe=1/450,TMe=2,PMe=5,DMe=class{constructor(t,e){this._onTimeout=r=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)},this._map=t,this._tr=new d_(t),this._triggerRenderFrame=e,this._delta=0,this._defaultZoomRate=CMe,this._wheelZoomRate=MMe}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return this._map.cooperativeGestures.isEnabled()?!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t)):!1}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t)){this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);return}let e=t.deltaMode===WheelEvent.DOM_DELTA_LINE?t.deltaY*40:t.deltaY,r=Dr.now(),n=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,e!==0&&e%A8===0?this._type="wheel":e!==0&&Math.abs(e)<4?this._type="trackpad":n>400?(this._type=null,this._lastValue=e,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(n*e)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,e+=this._lastValue)),t.shiftKey&&e&&(e=e/4),this._type&&(this._lastWheelEvent=t,this._delta-=e,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let e=Fr.mousePos(this._map.getCanvas(),t),r=this._tr;this._aroundCenter?this._aroundPoint=r.transform.locationToScreenPoint(ar.convert(r.center)):this._aroundPoint=e,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;let t=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){let o=t.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=o),typeof this._targetZoom=="number"&&(this._targetZoom+=o)}if(this._delta!==0){let o=this._type==="wheel"&&Math.abs(this._delta)>A8?this._wheelZoomRate:this._defaultZoomRate,s=TMe/(1+Math.exp(-Math.abs(this._delta*o)));this._delta<0&&s!==0&&(s=1/s);let l=typeof this._targetZoom!="number"?t.scale:mo(this._targetZoom);this._targetZoom=t.getConstrained(t.getCameraLngLat(),go(l*s)).zoom,this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}let e=typeof this._targetZoom!="number"?t.zoom:this._targetZoom,r=this._startZoom,n=this._easing,i=!1,a;if(this._type==="wheel"&&r&&n){let o=Dr.now()-this._lastWheelEventTime,s=Math.min((o+PMe)/200,1),l=n(s);a=di.number(r,e,l),s<1?this._frameId||(this._frameId=!0):i=!0}else a=e,i=!0;return this._active=!0,i&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=a,{noInertia:!0,needsRenderFrame:!i,zoomDelta:a-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let e=GC;if(this._prevEase){let r=this._prevEase,n=(Dr.now()-r.start)/r.duration,i=r.easing(n+.01)-r.easing(n),a=.27/Math.sqrt(i*i+1e-4)*.01,o=Math.sqrt(.27*.27-a*a);e=b5(a,o,.25,1)}return this._prevEase={start:Dr.now(),duration:t,easing:e},e}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}};C();var kMe=class{constructor(t,e){this._clickZoom=t,this._tapZoom=e}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}};C();var OMe=class{constructor(e){this._tr=new d_(e),this.reset()}reset(){this._active=!1}dblclick(e,r){return e.preventDefault(),{cameraAnimation:n=>{n.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(r)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}};C();var BMe=class{constructor(){this._tap=new RM({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,r,n){if(!this._swipePoint)if(!this._tapTime)this._tap.touchstart(e,r,n);else{let i=r[0],a=e.timeStamp-this._tapTime<HX,o=this._tapPoint.dist(i)<kk;!a||!o?this.reset():n.length>0&&(this._swipePoint=i,this._swipeTouch=n[0].identifier)}}touchmove(e,r,n){if(!this._tapTime)this._tap.touchmove(e,r,n);else if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;let i=r[0],a=i.y-this._swipePoint.y;return this._swipePoint=i,e.preventDefault(),this._active=!0,{zoomDelta:a/128}}}touchend(e,r,n){if(this._tapTime)this._swipePoint&&n.length===0&&this.reset();else{let i=this._tap.touchend(e,r,n);i&&(this._tapTime=e.timeStamp,this._tapPoint=i)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}};C();var zMe=class{constructor(t,e,r){this._el=t,this._mousePan=e,this._touchPan=r}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}};C();var FMe=class{constructor(e,r,n,i){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=r,this._mousePitch=n,this._mouseRoll=i}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}};C();var RMe=class{constructor(t,e,r,n){this._el=t,this._touchZoom=e,this._touchRotate=r,this._tapDragZoom=n,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}};C();var LMe=class{constructor(e,r){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=r,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;let e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=Fr.create("div","maplibregl-cooperative-gesture-screen",e);let r=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(r=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));let n=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),i=document.createElement("div");i.className="maplibregl-desktop-message",i.textContent=r,this._container.appendChild(i);let a=document.createElement("div");a.className="maplibregl-mobile-message",a.textContent=n,this._container.appendChild(a),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(Fr.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,r){this._enabled&&(this._map.fire(new ht("cooperativegestureprevented",{gestureType:e,originalEvent:r})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}},NMe=Zt(xr(),1),ob=t=>t.zoom||t.drag||t.roll||t.pitch||t.rotate,$Me=class extends ht{};function KE(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta||t.rollDelta}var UMe=class{constructor(e,r){this.handleWindowEvent=i=>{this.handleEvent(i,"".concat(i.type,"Window"))},this.handleEvent=(i,a)=>{if(i.type==="blur"){this.stop(!0);return}this._updatingCamera=!0;let o=i.type==="renderFrame"?void 0:i,s={needsRenderFrame:!1},l={},u={};for(let{handlerName:d,handler:p,allowed:m}of this._handlers){if(!p.isEnabled())continue;let y;if(this._blockedByActive(u,m,d))p.reset();else if(p[a||i.type]){if(E1e(i,a||i.type)){let v=Fr.mousePos(this._map.getCanvas(),i);y=p[a||i.type](i,v)}else if(S1e(i,a||i.type)){let v=i.touches,_=this._getMapTouches(v),w=Fr.touchPos(this._map.getCanvas(),_);y=p[a||i.type](i,w,_)}else I1e(a||i.type)||(y=p[a||i.type](i));this.mergeHandlerResult(s,l,y,d,o),y&&y.needsRenderFrame&&this._triggerRenderFrame()}(y||p.isActive())&&(u[d]=p)}let c={};for(let d in this._previousActiveHandlers)u[d]||(c[d]=o);this._previousActiveHandlers=u,(Object.keys(c).length||KE(s))&&(this._changes.push([s,l,c]),this._triggerRenderFrame()),(Object.keys(u).length||KE(s))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:h}=s;h&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],h(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new YCe(e),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(r);let n=this._el;this._listeners=[[n,"touchstart",{passive:!0}],[n,"touchmove",{passive:!1}],[n,"touchend",void 0],[n,"touchcancel",void 0],[n,"mousedown",void 0],[n,"mousemove",void 0],[n,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[n,"mouseover",void 0],[n,"mouseout",void 0],[n,"dblclick",void 0],[n,"click",void 0],[n,"keydown",{capture:!1}],[n,"keyup",void 0],[n,"wheel",{passive:!1}],[n,"contextmenu",void 0],[window,"blur",void 0]];for(let[i,a,o]of this._listeners)Fr.addEventListener(i,a,i===document?this.handleWindowEvent:this.handleEvent,o)}destroy(){for(let[e,r,n]of this._listeners)Fr.removeEventListener(e,r,e===document?this.handleWindowEvent:this.handleEvent,n)}_addDefaultHandlers(e){let r=this._map,n=r.getCanvasContainer();this._add("mapEvent",new QCe(r,e));let i=r.boxZoom=new rMe(r,e);this._add("boxZoom",i),e.interactive&&e.boxZoom&&i.enable();let a=r.cooperativeGestures=new LMe(r,e.cooperativeGestures);this._add("cooperativeGestures",a),e.cooperativeGestures&&a.enable();let o=new sMe(r),s=new OMe(r);r.doubleClickZoom=new kMe(s,o),this._add("tapZoom",o),this._add("clickZoom",s),e.interactive&&e.doubleClickZoom&&r.doubleClickZoom.enable();let l=new BMe;this._add("tapDragZoom",l);let u=r.touchPitch=new AMe(r);this._add("touchPitch",u),e.interactive&&e.touchPitch&&r.touchPitch.enable(e.touchPitch);let c=()=>r.project(r.getCenter()),h=fMe(e,c),d=mMe(e),p=gMe(e,c);r.dragRotate=new FMe(e,h,d,p),this._add("mouseRotate",h,["mousePitch"]),this._add("mousePitch",d,["mouseRotate","mouseRoll"]),this._add("mouseRoll",p,["mousePitch"]),e.interactive&&e.dragRotate&&r.dragRotate.enable();let m=pMe(e),y=new yMe(e,r);r.dragPan=new zMe(n,m,y),this._add("mousePan",m),this._add("touchPan",y,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&r.dragPan.enable(e.dragPan);let v=new bMe,_=new _Me;r.touchZoomRotate=new RMe(n,_,v,l),this._add("touchRotate",v,["touchPan","touchZoom"]),this._add("touchZoom",_,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&r.touchZoomRotate.enable(e.touchZoomRotate);let w=r.scrollZoom=new DMe(r,()=>this._triggerRenderFrame());this._add("scrollZoom",w,["mousePan"]),e.interactive&&e.scrollZoom&&r.scrollZoom.enable(e.scrollZoom);let b=r.keyboard=new EMe(r);this._add("keyboard",b),e.interactive&&e.keyboard&&r.keyboard.enable(),this._add("blockableMapEvent",new eMe(r))}_add(e,r,n){this._handlers.push({handlerName:e,handler:r,allowed:n}),this._handlersById[e]=r}stop(e){if(!this._updatingCamera){for(let{handler:r}of this._handlers)r.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(let{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ob(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,r,n){for(let i in e)if(i!==n&&(!r||r.indexOf(i)<0))return!0;return!1}_getMapTouches(e){let r=[];for(let n of e){let i=n.target;this._el.contains(i)&&r.push(n)}return r}mergeHandlerResult(e,r,n,i,a){if(!n)return;zt(e,n);let o={handlerName:i,originalEvent:n.originalEvent||a};n.zoomDelta!==void 0&&(r.zoom=o),n.panDelta!==void 0&&(r.drag=o),n.rollDelta!==void 0&&(r.roll=o),n.pitchDelta!==void 0&&(r.pitch=o),n.bearingDelta!==void 0&&(r.rotate=o)}_applyChanges(){let e={},r={},n={};for(let[i,a,o]of this._changes)i.panDelta&&(e.panDelta=(e.panDelta||new NMe.default(0,0))._add(i.panDelta)),i.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+i.zoomDelta),i.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+i.bearingDelta),i.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+i.pitchDelta),i.rollDelta&&(e.rollDelta=(e.rollDelta||0)+i.rollDelta),i.around!==void 0&&(e.around=i.around),i.pinchAround!==void 0&&(e.pinchAround=i.pinchAround),i.noInertia&&(e.noInertia=i.noInertia),zt(r,a),zt(n,o);this._updateMapTransform(e,r,n),this._changes=[]}_updateMapTransform(e,r,n){let i=this._map,a=i._getTransformForUpdate(),o=i.terrain;if(!KE(e)&&!(o&&this._terrainMovement))return this._fireEvents(r,n,!0);i._stop(!0);let{panDelta:s,zoomDelta:l,bearingDelta:u,pitchDelta:c,rollDelta:h,around:d,pinchAround:p}=e;p!==void 0&&(d=p),d=d||i.transform.centerPoint,o&&!a.isPointOnMapSurface(d)&&(d=a.centerPoint);let m={panDelta:s,zoomDelta:l,rollDelta:h,pitchDelta:c,bearingDelta:u,around:d};this._map.cameraHelper.useGlobeControls&&!a.isPointOnMapSurface(d)&&(d=a.centerPoint);let y=d.distSqr(a.centerPoint)<.01?a.center:a.screenPointToLocation(s?d.sub(s):d);o?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(m,a),!this._terrainMovement&&(r.drag||r.zoom)?(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(m,a,y)):r.drag&&this._terrainMovement?a.setCenter(a.screenPointToLocation(a.centerPoint.sub(s))):this._map.cameraHelper.handleMapControlsPan(m,a,y)):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(m,a),this._map.cameraHelper.handleMapControlsPan(m,a,y)),i._applyUpdatedTransform(a),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(r,n,!0)}_fireEvents(e,r,n){let i=ob(this._eventsInProgress),a=ob(e),o={};for(let h in e){let{originalEvent:d}=e[h];this._eventsInProgress[h]||(o["".concat(h,"start")]=d),this._eventsInProgress[h]=e[h]}!i&&a&&this._fireEvent("movestart",a.originalEvent);for(let h in o)this._fireEvent(h,o[h]);a&&this._fireEvent("move",a.originalEvent);for(let h in e){let{originalEvent:d}=e[h];this._fireEvent(h,d)}let s={},l;for(let h in this._eventsInProgress){let{handlerName:d,originalEvent:p}=this._eventsInProgress[h];this._handlersById[d].isActive()||(delete this._eventsInProgress[h],l=r[d]||p,s["".concat(h,"end")]=l)}for(let h in s)this._fireEvent(h,s[h]);let u=ob(this._eventsInProgress),c=(i||a)&&!u;if(c&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;let h=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&h.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(h)}if(n&&c){this._updatingCamera=!0;let h=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),d=p=>p!==0&&-this._bearingSnap<p&&p<this._bearingSnap;h&&(h.essential||!Dr.prefersReducedMotion)?(d(h.bearing||this._map.getBearing())&&(h.bearing=0),h.freezeElevation=!0,this._map.easeTo(h,{originalEvent:l})):(this._map.fire(new ht("moveend",{originalEvent:l})),d(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(e,r){this._map.fire(new ht(e,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new $Me("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}};C();var fy=Zt(xr(),1),jMe=class extends Xo{constructor(e,r,n){super(),this._renderFrameCallback=()=>{let i=Math.min((Dr.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(i)),i<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=n.bearingSnap,this.cameraHelper=r,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,r){e.apply(this.transform),this.transform=e,this.cameraHelper=r}getCenter(){return new ar(this.transform.center.lng,this.transform.center.lat)}setCenter(e,r){return this.jumpTo({center:e},r)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,r){return this.jumpTo({elevation:e},r),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,r,n){return e=fy.default.convert(e).mult(-1),this.panTo(this.transform.center,zt({offset:e},r),n)}panTo(e,r,n){return this.easeTo(zt({center:e},r),n)}getZoom(){return this.transform.zoom}setZoom(e,r){return this.jumpTo({zoom:e},r),this}zoomTo(e,r,n){return this.easeTo(zt({zoom:e},r),n)}zoomIn(e,r){return this.zoomTo(this.getZoom()+1,e,r),this}zoomOut(e,r){return this.zoomTo(this.getZoom()-1,e,r),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,r){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new ht("movestart",r)).fire(new ht("move",r)).fire(new ht("moveend",r))),this}getBearing(){return this.transform.bearing}setBearing(e,r){return this.jumpTo({bearing:e},r),this}getPadding(){return this.transform.padding}setPadding(e,r){return this.jumpTo({padding:e},r),this}rotateTo(e,r,n){return this.easeTo(zt({bearing:e},r),n)}resetNorth(e,r){return this.rotateTo(0,zt({duration:1e3},e),r),this}resetNorthPitch(e,r){return this.easeTo(zt({bearing:0,pitch:0,roll:0,duration:1e3},e),r),this}snapToNorth(e,r){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,r):this}getPitch(){return this.transform.pitch}setPitch(e,r){return this.jumpTo({pitch:e},r),this}getRoll(){return this.transform.roll}setRoll(e,r){return this.jumpTo({roll:e},r),this}cameraForBounds(e,r){e=Vc.convert(e).adjustAntiMeridian();let n=r&&r.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),n,r)}_cameraForBoxAndBearing(e,r,n,i){let a={top:0,bottom:0,right:0,left:0};if(i=zt({padding:a,offset:[0,0],maxZoom:this.transform.maxZoom},i),typeof i.padding=="number"){let u=i.padding;i.padding={top:u,bottom:u,right:u,left:u}}let o=zt(a,i.padding);i.padding=o;let s=this.transform,l=new Vc(e,r);return this.cameraHelper.cameraForBoxAndBearing(i,o,l,n,s)}fitBounds(e,r,n){return this._fitInternal(this.cameraForBounds(e,r),r,n)}fitScreenCoordinates(e,r,n,i,a){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(fy.default.convert(e)),this.transform.screenPointToLocation(fy.default.convert(r)),n,i),i,a)}_fitInternal(e,r,n){return e?(r=zt(e,r),delete r.padding,r.linear?this.easeTo(r,n):this.flyTo(r,n)):this}jumpTo(e,r){this.stop();let n=this._getTransformForUpdate(),i=!1,a=!1,o=!1,s=n.zoom;this.cameraHelper.handleJumpToCenterZoom(n,e);let l=n.zoom!==s;return"elevation"in e&&n.elevation!==+e.elevation&&n.setElevation(+e.elevation),"bearing"in e&&n.bearing!==+e.bearing&&(i=!0,n.setBearing(+e.bearing)),"pitch"in e&&n.pitch!==+e.pitch&&(a=!0,n.setPitch(+e.pitch)),"roll"in e&&n.roll!==+e.roll&&(o=!0,n.setRoll(+e.roll)),e.padding!=null&&!n.isPaddingEqual(e.padding)&&n.setPadding(e.padding),this._applyUpdatedTransform(n),this.fire(new ht("movestart",r)).fire(new ht("move",r)),l&&this.fire(new ht("zoomstart",r)).fire(new ht("zoom",r)).fire(new ht("zoomend",r)),i&&this.fire(new ht("rotatestart",r)).fire(new ht("rotate",r)).fire(new ht("rotateend",r)),a&&this.fire(new ht("pitchstart",r)).fire(new ht("pitch",r)).fire(new ht("pitchend",r)),o&&this.fire(new ht("rollstart",r)).fire(new ht("roll",r)).fire(new ht("rollend",r)),this.fire(new ht("moveend",r))}calculateCameraOptionsFromTo(e,r,n,i=0){let a=Mn.fromLngLat(e,r),o=Mn.fromLngLat(n,i),s=o.x-a.x,l=o.y-a.y,u=o.z-a.z,c=Math.hypot(s,l,u);if(c===0)throw new Error("Can't calculate camera options with same From and To");let h=Math.hypot(s,l),d=go(this.transform.cameraToCenterDistance/c/this.transform.tileSize),p=Math.atan2(s,-l)*180/Math.PI,m=Math.acos(h/c)*180/Math.PI;return m=u<0?90-m:90+m,{center:o.toLngLat(),elevation:i,zoom:d,pitch:m,bearing:p}}calculateCameraOptionsFromCameraLngLatAltRotation(e,r,n,i,a){let o=this.transform.calculateCenterFromCameraLngLatAlt(e,r,n,i);return{center:o.center,elevation:o.elevation,zoom:o.zoom,bearing:n,pitch:i,roll:a}}easeTo(e,r){this._stop(!1,e.easeId),e=zt({offset:[0,0],duration:500,easing:GC},e),(e.animate===!1||!e.essential&&Dr.prefersReducedMotion)&&(e.duration=0);let n=this._getTransformForUpdate(),i=this.getBearing(),a=n.pitch,o=n.roll,s="bearing"in e?this._normalizeBearing(e.bearing,i):i,l="pitch"in e?+e.pitch:a,u="roll"in e?this._normalizeBearing(e.roll,o):o,c="padding"in e?e.padding:n.padding,h=fy.default.convert(e.offset),d,p;e.around&&(d=ar.convert(e.around),p=n.locationToScreenPoint(d));let m={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},y=this.cameraHelper.handleEaseTo(n,{bearing:s,pitch:l,roll:u,padding:c,around:d,aroundPoint:p,offsetAsPoint:h,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||i!==s,this._pitching=this._pitching||l!==a,this._rolling=this._rolling||u!==o,this._padding=!n.isPaddingEqual(c),this._zooming=this._zooming||y.isZooming,this._easeId=e.easeId,this._prepareEase(r,e.noMoveStart,m),this.terrain&&this._prepareElevation(y.elevationCenter),this._ease(v=>{y.easeFunc(v),this.terrain&&!e.freezeElevation&&this._updateElevation(v),this._applyUpdatedTransform(n),this._fireMoveEvents(r)},v=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r,v)},e),this}_prepareEase(e,r,n={}){this._moving=!0,!r&&!n.moving&&this.fire(new ht("movestart",e)),this._zooming&&!n.zooming&&this.fire(new ht("zoomstart",e)),this._rotating&&!n.rotating&&this.fire(new ht("rotatestart",e)),this._pitching&&!n.pitching&&this.fire(new ht("pitchstart",e)),this._rolling&&!n.rolling&&this.fire(new ht("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));let r=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&r!==this._elevationTarget){let n=this._elevationTarget-this._elevationStart,i=(r-(n*e+this._elevationStart))/(1-e);this._elevationStart+=e*(n-i),this._elevationTarget=r}this.transform.setElevation(di.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return!this.transformCameraUpdate&&!this.terrain?this.transform:(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState)}_elevateCameraIfInsideTerrain(e){return{}}_applyUpdatedTransform(e){let r=[];if(r.push(i=>this._elevateCameraIfInsideTerrain(i)),this.transformCameraUpdate&&r.push(i=>this.transformCameraUpdate(i)),!r.length)return;let n=e.clone();for(let i of r){let a=n.clone(),{center:o,zoom:s,roll:l,pitch:u,bearing:c,elevation:h}=i(a);o&&a.setCenter(o),h!==void 0&&a.setElevation(h),s!==void 0&&a.setZoom(s),l!==void 0&&a.setRoll(l),u!==void 0&&a.setPitch(u),c!==void 0&&a.setBearing(c),n.apply(a)}this.transform.apply(n)}_fireMoveEvents(e){this.fire(new ht("move",e)),this._zooming&&this.fire(new ht("zoom",e)),this._rotating&&this.fire(new ht("rotate",e)),this._pitching&&this.fire(new ht("pitch",e)),this._rolling&&this.fire(new ht("roll",e))}_afterEase(e,r){if(this._easeId&&r&&this._easeId===r)return;delete this._easeId;let n=this._zooming,i=this._rotating,a=this._pitching,o=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,n&&this.fire(new ht("zoomend",e)),i&&this.fire(new ht("rotateend",e)),a&&this.fire(new ht("pitchend",e)),o&&this.fire(new ht("rollend",e)),this.fire(new ht("moveend",e))}flyTo(e,r){if(!e.essential&&Dr.prefersReducedMotion){let R=r_(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(R,r)}this.stop(),e=zt({offset:[0,0],speed:1.2,curve:1.42,easing:GC},e);let n=this._getTransformForUpdate(),i=n.bearing,a=n.pitch,o=n.roll,s=n.padding,l="bearing"in e?this._normalizeBearing(e.bearing,i):i,u="pitch"in e?+e.pitch:a,c="roll"in e?this._normalizeBearing(e.roll,o):o,h="padding"in e?e.padding:n.padding,d=fy.default.convert(e.offset),p=n.centerPoint.add(d),m=n.screenPointToLocation(p),y=this.cameraHelper.handleFlyTo(n,{bearing:l,pitch:u,roll:c,padding:h,locationAtOffset:m,offsetAsPoint:d,center:e.center,minZoom:e.minZoom,zoom:e.zoom}),v=e.curve,_=Math.max(n.width,n.height),w=_/y.scaleOfZoom,b=y.pixelPathLength;if(typeof y.scaleOfMinZoom=="number"){let R=_/y.scaleOfMinZoom;v=Math.sqrt(R/b*2)}let A=v*v;function E(R){let T=(w*w-_*_+(R?-1:1)*A*A*b*b)/(2*(R?w:_)*A*b);return Math.log(Math.sqrt(T*T+1)-T)}function M(R){return(Math.exp(R)-Math.exp(-R))/2}function P(R){return(Math.exp(R)+Math.exp(-R))/2}function k(R){return M(R)/P(R)}let D=E(!1),O=function(R){return P(D)/P(D+v*R)},B=function(R){return _*((P(D)*k(D+v*R)-M(D))/A)/b},L=(E(!0)-D)/v;if(Math.abs(b)<2e-6||!isFinite(L)){if(Math.abs(_-w)<1e-6)return this.easeTo(e,r);let R=w<_?-1:1;L=Math.abs(Math.log(w/_))/v,B=()=>0,O=T=>Math.exp(R*v*T)}if("duration"in e)e.duration=+e.duration;else{let R="screenSpeed"in e?+e.screenSpeed/v:+e.speed;e.duration=1e3*L/R}return e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=i!==l,this._pitching=u!==a,this._rolling=c!==o,this._padding=!n.isPaddingEqual(h),this._prepareEase(r,!1),this.terrain&&this._prepareElevation(y.targetCenter),this._ease(R=>{let T=R*L,N=1/O(T),$=B(T);this._rotating&&n.setBearing(di.number(i,l,R)),this._pitching&&n.setPitch(di.number(a,u,R)),this._rolling&&n.setRoll(di.number(o,c,R)),this._padding&&(n.interpolatePadding(s,h,R),p=n.centerPoint.add(d)),y.easeFunc(R,N,$,p),this.terrain&&!e.freezeElevation&&this._updateElevation(R),this._applyUpdatedTransform(n),this._fireMoveEvents(r)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,r){var n;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){let i=this._onEaseEnd;delete this._onEaseEnd,i.call(this,r)}return e||(n=this.handlers)==null||n.stop(!1),this}_ease(e,r,n){n.animate===!1||n.duration===0?(e(1),r()):(this._easeStart=Dr.now(),this._easeOptions=n,this._onEaseFrame=e,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,r){e=Mp(e,-180,180);let n=Math.abs(e-r);return Math.abs(e-360-r)<n&&(e-=360),Math.abs(e+360-r)<n&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(ar.convert(e),this.transform.tileZoom):null}},gh=Zt(xr(),1);C();var XX={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'},VMe=class{constructor(e=XX){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=r=>{r&&(r.sourceDataType==="metadata"||r.sourceDataType==="visibility"||r.dataType==="style"||r.type==="terrain")&&this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):!this._container.classList.contains("maplibregl-compact")&&!this._container.classList.contains("maplibregl-attrib-empty")&&(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=Fr.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=Fr.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Fr.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){Fr.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,r){let n=this._map._getUIString("AttributionControl.".concat(r));e.title=n,e.setAttribute("aria-label",n)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(i=>typeof i!="string"?"":i)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){let i=this._map.style.stylesheet;this.styleOwner=i.owner,this.styleId=i.id}let r=this._map.style.sourceCaches;for(let i in r){let a=r[i];if(a.used||a.usedForTerrain){let o=a.getSource();o.attribution&&e.indexOf(o.attribution)<0&&e.push(o.attribution)}}e=e.filter(i=>String(i).trim()),e.sort((i,a)=>i.length-a.length),e=e.filter((i,a)=>{for(let o=a+1;o<e.length;o++)if(e[o].indexOf(i)>=0)return!1;return!0});let n=e.join(" | ");n!==this._attribHTML&&(this._attribHTML=n,e.length?(this._innerContainer.innerHTML=Fr.sanitize(n),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}};C();var GMe=class{constructor(e={}){this._updateCompact=()=>{let r=this._container.children;if(r.length){let n=r[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&n.classList.add("maplibregl-compact"):n.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=Fr.create("div","maplibregl-ctrl");let r=Fr.create("a","maplibregl-ctrl-logo");return r.target="_blank",r.rel="noopener nofollow",r.href="https://maplibre.org/",r.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),r.setAttribute("rel","noopener nofollow"),this._container.appendChild(r),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){Fr.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}};C();var ZMe=class{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){let r=++this._id;return this._queue.push({callback:e,id:r,cancelled:!1}),r}remove(e){let r=this._currentlyRunning,n=r?this._queue.concat(r):this._queue;for(let i of n)if(i.id===e){i.cancelled=!0;return}}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");let r=this._currentlyRunning=this._queue;this._queue=[];for(let n of r)if(!n.cancelled&&(n.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}};C();var LM=(t=>(t.create="create",t.load="load",t.fullLoad="fullLoad",t))(LM||{}),sb=null,my=[],WMe=60,QE=1e3/WMe,eI="loadTime",tI="fullLoadTime",gy={mark(t){performance.mark(t)},frame(t){let e=t;if(sb!=null){let r=e-sb;my.push(r)}sb=e},clearMetrics(){sb=null,my=[],performance.clearMeasures(eI),performance.clearMeasures(tI);for(let t in LM)performance.clearMarks(LM[t])},getPerformanceMetrics(){performance.measure(eI,"create","load"),performance.measure(tI,"create","fullLoad");let t=performance.getEntriesByName(eI)[0].duration,e=performance.getEntriesByName(tI)[0].duration,r=my.length,n=1/(my.reduce((o,s)=>o+s,0)/r/1e3),i=my.filter(o=>o>QE).reduce((o,s)=>o+(s-QE)/QE,0),a=i/(r+i)*100;return{loadTime:t,fullLoadTime:e,fps:n,percentDroppedFrames:a,totalFrames:r}}};C();C();var HMe=Si([{name:"a_pos3d",type:"Int16",components:3}]);C();var XMe=class extends Xo{constructor(e){super(),this._lastTilesetChange=Dr.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,r){this.sourceCache.update(e,r),this._renderableTilesKeys=[];let n={};for(let i of C3(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:r,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))n[i.key]=!0,this._renderableTilesKeys.push(i.key),this._tiles[i.key]||(i.terrainRttPosMatrix32f=new Float64Array(16),Xe.ortho(i.terrainRttPosMatrix32f,0,8192,8192,0,0,1),this._tiles[i.key]=new iX(i,this.tileSize),this._lastTilesetChange=Dr.now());for(let i in this._tiles)n[i]||delete this._tiles[i]}freeRtt(e){for(let r in this._tiles){let n=this._tiles[r];(!e||n.tileID.equals(e)||n.tileID.isChildOf(e)||e.isChildOf(n.tileID))&&(n.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,r){return r?this._getTerrainCoordsForTileRanges(e,r):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){let r={};for(let n of this._renderableTilesKeys){let i=this._tiles[n].tileID,a=e.clone(),o=Wh();if(i.canonical.equals(e.canonical))Xe.ortho(o,0,8192,8192,0,0,1);else if(i.canonical.isChildOf(e.canonical)){let s=i.canonical.z-e.canonical.z,l=i.canonical.x-(i.canonical.x>>s<<s),u=i.canonical.y-(i.canonical.y>>s<<s),c=8192>>s;Xe.ortho(o,0,c,c,0,0,1),Xe.translate(o,o,[-l*c,-u*c,0])}else if(e.canonical.isChildOf(i.canonical)){let s=e.canonical.z-i.canonical.z,l=e.canonical.x-(e.canonical.x>>s<<s),u=e.canonical.y-(e.canonical.y>>s<<s),c=8192>>s;Xe.ortho(o,0,8192,8192,0,0,1),Xe.translate(o,o,[l*c,u*c,0]),Xe.scale(o,o,[1/2**s,1/2**s,0])}else continue;a.terrainRttPosMatrix32f=new Float32Array(o),r[n]=a}return r}_getTerrainCoordsForTileRanges(e,r){let n={};for(let i of this._renderableTilesKeys){let a=this._tiles[i].tileID;if(!this._isWithinTileRanges(a,r))continue;let o=e.clone(),s=Wh();if(a.canonical.z===e.canonical.z){let l=e.canonical.x-a.canonical.x,u=e.canonical.y-a.canonical.y;Xe.ortho(s,0,8192,8192,0,0,1),Xe.translate(s,s,[l*8192,u*8192,0])}else if(a.canonical.z>e.canonical.z){let l=a.canonical.z-e.canonical.z,u=a.canonical.x-(a.canonical.x>>l<<l),c=a.canonical.y-(a.canonical.y>>l<<l),h=e.canonical.x-(a.canonical.x>>l),d=e.canonical.y-(a.canonical.y>>l),p=8192>>l;Xe.ortho(s,0,p,p,0,0,1),Xe.translate(s,s,[-u*p+h*8192,-c*p+d*8192,0])}else{let l=e.canonical.z-a.canonical.z,u=e.canonical.x-(e.canonical.x>>l<<l),c=e.canonical.y-(e.canonical.y>>l<<l),h=(e.canonical.x>>l)-a.canonical.x,d=(e.canonical.y>>l)-a.canonical.y,p=8192<<l;Xe.ortho(s,0,p,p,0,0,1),Xe.translate(s,s,[u*8192+h*p,c*8192+d*p,0])}o.terrainRttPosMatrix32f=new Float32Array(s),n[i]=o}return n}getSourceTile(e,r){let n=this.sourceCache._source,i=e.overscaledZ-this.deltaZoom;if(i>n.maxzoom&&(i=n.maxzoom),i<n.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(i).key);let a=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if(!(a&&a.dem)&&r)for(;i>=n.minzoom&&!(a&&a.dem);)a=this.sourceCache.getTileByID(e.scaledTo(i--).key);return a}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,r){return r[e.canonical.z]&&e.canonical.x>=r[e.canonical.z].minTileX&&e.canonical.x<=r[e.canonical.z].maxTileX&&e.canonical.y>=r[e.canonical.z].minTileY&&e.canonical.y<=r[e.canonical.z].maxTileY}},qMe=class{constructor(e,r,n){this._meshCache={},this.painter=e,this.sourceCache=new XMe(r),this.options=n,this.exaggeration=typeof n.exaggeration=="number"?n.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,r,n,i=8192){var a;if(!(r>=0&&r<i&&n>=0&&n<i))return 0;let o=this.getTerrainData(e),s=(a=o.tile)==null?void 0:a.dem;if(!s)return 0;let l=No.transformMat4([],[r/i*8192,n/i*8192],o.u_terrain_matrix),u=[l[0]*s.dim,l[1]*s.dim],c=Math.floor(u[0]),h=Math.floor(u[1]),d=u[0]-c,p=u[1]-h;return s.get(c,h)*(1-d)*(1-p)+s.get(c+1,h)*d*(1-p)+s.get(c,h+1)*(1-d)*p+s.get(c+1,h+1)*d*p}getElevationForLngLatZoom(e,r){if(!dAe(r,e.wrap()))return 0;let{tileID:n,mercatorX:i,mercatorY:a}=this._getOverscaledTileIDFromLngLatZoom(e,r);return this.getElevation(n,i%8192,a%8192,8192)}getElevation(e,r,n,i=8192){return this.getDEMElevation(e,r,n,i)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){let i=this.painter.context,a=new ti({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new ki(i,a,i.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new ki(i,new ti({width:1,height:1}),i.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(i.gl.NEAREST,i.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=Xe.identity([])}let r=this.sourceCache.getSourceTile(e,!0);if(r&&r.dem&&(!r.demTexture||r.needsTerrainPrepare)){let i=this.painter.context;r.demTexture=this.painter.getTileTexture(r.dem.stride),r.demTexture?r.demTexture.update(r.dem.getPixels(),{premultiply:!1}):r.demTexture=new ki(i,r.dem.getPixels(),i.gl.RGBA,{premultiply:!1}),r.demTexture.bind(i.gl.NEAREST,i.gl.CLAMP_TO_EDGE),r.needsTerrainPrepare=!1}let n=r&&r+r.tileID.key+e.key;if(n&&!this._demMatrixCache[n]){let i=this.sourceCache.sourceCache._source.maxzoom,a=e.canonical.z-r.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=i?a=e.canonical.z-i:Ui("cannot calculate elevation if elevation maxzoom > source.maxzoom"));let o=e.canonical.x-(e.canonical.x>>a<<a),s=e.canonical.y-(e.canonical.y>>a<<a),l=Xe.fromScaling(new Float64Array(16),[1/(8192<<a),1/(8192<<a),0]);Xe.translate(l,l,[o*8192,s*8192,0]),this._demMatrixCache[e.key]={matrix:l,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:r&&r.dem&&r.dem.dim||1,u_terrain_matrix:n?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:r&&r.dem&&r.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(r&&r.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:r}}getFramebuffer(e){let r=this.painter,n=r.width/devicePixelRatio,i=r.height/devicePixelRatio;return this._fbo&&(this._fbo.width!==n||this._fbo.height!==i)&&(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new ki(r.context,{width:n,height:i,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new ki(r.context,{width:n,height:i,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=r.context.createFramebuffer(n,i,!0,!1),this._fbo.depthAttachment.set(r.context.createRenderbuffer(r.context.gl.DEPTH_COMPONENT16,n,i))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){let e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;let r=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let a=0,o=0;a<this._coordsTextureSize;a++)for(let s=0;s<this._coordsTextureSize;s++,o+=4)r[o+0]=s&255,r[o+1]=a&255,r[o+2]=s>>8<<4|a>>8,r[o+3]=0;let n=new ti({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(r.buffer)),i=new ki(e,n,e.gl.RGBA,{premultiply:!1});return i.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=i,i}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);let r=new Uint8Array(4),n=this.painter.context,i=n.gl,a=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),o=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),s=Math.round(this.painter.height/devicePixelRatio);n.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),i.readPixels(a,s-o-1,1,1,i.RGBA,i.UNSIGNED_BYTE,r),n.bindFramebuffer.set(null);let l=r[0]+(r[2]>>4<<8),u=r[1]+((r[2]&15)<<8),c=this.coordsIndex[255-r[3]],h=c&&this.sourceCache.getTileByID(c);if(!h)return null;let d=this._coordsTextureSize,p=(1<<h.tileID.canonical.z)*d;return new Mn((h.tileID.canonical.x*d+l)/p+h.tileID.wrap,(h.tileID.canonical.y*d+u)/p,this.getElevation(h.tileID,l,u,d))}depthAtPoint(e){let r=new Uint8Array(4),n=this.painter.context,i=n.gl;return n.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),i.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,i.RGBA,i.UNSIGNED_BYTE,r),n.bindFramebuffer.set(null),(r[0]/(256*256*256)+r[1]/(256*256)+r[2]/256+r[3])/256}getTerrainMesh(e){var r;let n=((r=this.painter.style.projection)==null?void 0:r.transitionState)>0,i=n&&e.canonical.y===0,a=n&&e.canonical.y===(1<<e.canonical.z)-1,o="m_".concat(i?"n":"","_").concat(a?"s":"");if(this._meshCache[o])return this._meshCache[o];let s=this.painter.context,l=new Hbe,u=new Vl,c=this.meshSize,h=8192/c,d=c*c;for(let k=0;k<=c;k++)for(let D=0;D<=c;D++)l.emplaceBack(D*h,k*h,0);for(let k=0;k<d;k+=c+1)for(let D=0;D<c;D++)u.emplaceBack(D+k,c+D+k+1,c+D+k+2),u.emplaceBack(D+k,c+D+k+2,D+k+1);let p=l.length,m=0,y=p+(c+1),v=(c+1)*c,_=i?Vh:0,w=i?0:1,b=a?op:8192,A=a?0:1;for(let k=0;k<=c;k++)l.emplaceBack(k*h,_,w);for(let k=0;k<=c;k++)l.emplaceBack(k*h,b,A);for(let k=0;k<c;k++)u.emplaceBack(v+k,y+k,y+k+1),u.emplaceBack(v+k,y+k+1,v+k+1),u.emplaceBack(m+k,p+k+1,p+k),u.emplaceBack(m+k,m+k+1,p+k+1);let E=l.length,M=E+(c+1)*2;for(let k of[0,1])for(let D=0;D<=c;D++)for(let O of[0,1])l.emplaceBack(k*8192,D*h,O);for(let k=0;k<c*2;k+=2)u.emplaceBack(E+k,E+k+1,E+k+3),u.emplaceBack(E+k,E+k+3,E+k+2),u.emplaceBack(M+k,M+k+3,M+k+1),u.emplaceBack(M+k,M+k+2,M+k+3);let P=new v0(s.createVertexBuffer(l,HMe.members),s.createIndexBuffer(u),Hn.simpleSegment(0,0,l.length,u.length));return this._meshCache[o]=P,P}getMeshFrameDelta(e){return 2*Math.PI*mu/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,r){var n;let{tileID:i}=this._getOverscaledTileIDFromLngLatZoom(e,r);return(n=this.getMinMaxElevation(i).minElevation)!=null?n:0}getMinMaxElevation(e){let r=this.getTerrainData(e).tile,n={minElevation:null,maxElevation:null};return r&&r.dem&&(n.minElevation=r.dem.min*this.exaggeration,n.maxElevation=r.dem.max*this.exaggeration),n}_getOverscaledTileIDFromLngLatZoom(e,r){let n=Mn.fromLngLat(e.wrap()),i=(1<<r)*8192,a=n.x*i,o=n.y*i,s=Math.floor(a/8192),l=Math.floor(o/8192);return{tileID:new Ga(r,0,r,s,l),mercatorX:a,mercatorY:o}}};C();C();var YMe=class{constructor(e,r,n){this._context=e,this._size=r,this._tileSize=n,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(let e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){let r=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),n=new ki(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return n.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),r.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),r.colorAttachment.set(n.texture),{id:e,fbo:r,texture:n,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(r=>e.id!==r),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(let r of this._recentlyUsed)if(!this._objects[r].inUse)return this._objects[r];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");let e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(let e of this._objects)this.freeObject(e)}isFull(){return this._objects.length<this._size?!1:this._objects.some(e=>!e.inUse)===!1}},If={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0},JMe=class{constructor(e,r){this.painter=e,this.terrain=r,this.pool=new YMe(e.context,30,r.sourceCache.tileSize*r.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,r){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(n=>!e._layers[n].isHidden(r)),this._coordsAscending={};for(let n in e.sourceCaches){this._coordsAscending[n]={};let i=e.sourceCaches[n].getVisibleCoordinates(),a=e.sourceCaches[n].getSource(),o=a instanceof c_?a.terrainTileRanges:null;for(let s of i){let l=this.terrain.sourceCache.getTerrainCoords(s,o);for(let u in l)this._coordsAscending[n][u]||(this._coordsAscending[n][u]=[]),this._coordsAscending[n][u].push(l[u])}}this._coordsAscendingStr={};for(let n of e._order){let i=e._layers[n],a=i.source;if(If[i.type]&&!this._coordsAscendingStr[a]){this._coordsAscendingStr[a]={};for(let o in this._coordsAscending[a])this._coordsAscendingStr[a][o]=this._coordsAscending[a][o].map(s=>s.key).sort().join()}}for(let n of this._renderableTiles)for(let i in this._coordsAscendingStr){let a=this._coordsAscendingStr[i][n.tileID.key];a&&a!==n.rttCoords[i]&&(n.rtt=[])}}renderLayer(e,r){if(e.isHidden(this.painter.transform.zoom))return!1;let n=lt(ae({},r),{isRenderingToTexture:!0}),i=e.type,a=this.painter,o=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(If[i]&&((!this._prevType||!If[this._prevType])&&this._stacks.push([]),this._prevType=i,this._stacks[this._stacks.length-1].push(e.id),!o))return!0;if(If[this._prevType]||If[i]&&o){this._prevType=i;let s=this._stacks.length-1,l=this._stacks[s]||[];for(let u of this._renderableTiles){if(this.pool.isFull()&&(x8(this.painter,this.terrain,this._rttTiles,n),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(u),u.rtt[s]){let h=this.pool.getObjectForId(u.rtt[s].id);if(h.stamp===u.rtt[s].stamp){this.pool.useObject(h);continue}}let c=this.pool.getOrCreateFreeObject();this.pool.useObject(c),this.pool.stampObject(c),u.rtt[s]={id:c.id,stamp:c.stamp},a.context.bindFramebuffer.set(c.fbo.framebuffer),a.context.clear({color:Gt.transparent,stencil:0}),a.currentStencilSource=void 0;for(let h=0;h<l.length;h++){let d=a.style._layers[l[h]],p=d.source?this._coordsAscending[d.source][u.tileID.key]:[u.tileID];a.context.viewport.set([0,0,c.fbo.width,c.fbo.height]),a._renderTileClippingMasks(d,p,!0),a.renderLayer(a,a.style.sourceCaches[d.source],d,p,n),d.source&&(u.rttCoords[d.source]=this._coordsAscendingStr[d.source][u.tileID.key])}}return x8(this.painter,this.terrain,this._rttTiles,n),this._rttTiles=[],this.pool.freeAllObjects(),If[i]}return!1}};C();var KMe={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},QMe=rge.version,Qb=-2,qX=22,Sh=0,YX=60,lb=180,S8={hash:!1,interactive:!0,bearingSnap:7,attributionControl:XX,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:Qb,maxZoom:qX,minPitch:Sh,maxPitch:YX,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:s1.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},eTe=class extends jMe{constructor(e){var r,n;gy.mark("create");let i=lt(ae(ae({},S8),e),{canvasContextAttributes:ae(ae({},S8.canvasContextAttributes),e.canvasContextAttributes)});if(i.minZoom!=null&&i.maxZoom!=null&&i.minZoom>i.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(i.minPitch!=null&&i.maxPitch!=null&&i.minPitch>i.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(i.minPitch!=null&&i.minPitch<Sh)throw new Error("minPitch must be greater than or equal to ".concat(Sh));if(i.maxPitch!=null&&i.maxPitch>lb)throw new Error("maxPitch must be less than or equal to ".concat(lb));let a=new B4,o=new z4;if(i.minZoom!==void 0&&a.setMinZoom(i.minZoom),i.maxZoom!==void 0&&a.setMaxZoom(i.maxZoom),i.minPitch!==void 0&&a.setMinPitch(i.minPitch),i.maxPitch!==void 0&&a.setMaxPitch(i.maxPitch),i.renderWorldCopies!==void 0&&a.setRenderWorldCopies(i.renderWorldCopies),super(a,o,{bearingSnap:i.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new ZMe,this._controls=[],this._mapId=OZ(),this._contextLost=u=>{u.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new ht("webglcontextlost",{originalEvent:u}))},this._contextRestored=u=>{this._setupPainter(),this.resize(),this._update(),this.fire(new ht("webglcontextrestored",{originalEvent:u}))},this._onMapScroll=u=>{if(u.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=i.interactive,this._maxTileCacheSize=i.maxTileCacheSize,this._maxTileCacheZoomLevels=i.maxTileCacheZoomLevels,this._canvasContextAttributes=ae({},i.canvasContextAttributes),this._trackResize=i.trackResize===!0,this._bearingSnap=i.bearingSnap,this._centerClampedToGround=i.centerClampedToGround,this._refreshExpiredTiles=i.refreshExpiredTiles===!0,this._fadeDuration=i.fadeDuration,this._crossSourceCollisions=i.crossSourceCollisions===!0,this._collectResourceTiming=i.collectResourceTiming===!0,this._locale=ae(ae({},KMe),i.locale),this._clickTolerance=i.clickTolerance,this._overridePixelRatio=i.pixelRatio,this._maxCanvasSize=i.maxCanvasSize,this.transformCameraUpdate=i.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=i.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=Au.addThrottleControl(()=>this.isMoving()),this._requestManager=new F1e(i.transformRequest),typeof i.container=="string"){if(this._container=document.getElementById(i.container),!this._container)throw new Error("Container '".concat(i.container,"' not found."))}else if(i.container instanceof HTMLElement)this._container=i.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");if(i.maxBounds&&this.setMaxBounds(i.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let u=!1,c=Dk(h=>{this._trackResize&&!this._removed&&(this.resize(h),this.redraw())},50);this._resizeObserver=new ResizeObserver(h=>{if(!u){u=!0;return}c(h)}),this._resizeObserver.observe(this._container)}this.handlers=new UMe(this,i);let s=typeof i.hash=="string"&&i.hash||void 0;this._hash=i.hash&&new VCe(s).addTo(this),(!this._hash||!this._hash._onHashChange())&&(this.jumpTo({center:i.center,elevation:i.elevation,zoom:i.zoom,bearing:i.bearing,pitch:i.pitch,roll:i.roll}),i.bounds&&(this.resize(),this.fitBounds(i.bounds,zt({},i.fitBoundsOptions,{duration:0}))));let l=typeof i.style=="string"||((n=(r=i.style)==null?void 0:r.projection)==null?void 0:n.type)!=="globe";this.resize(null,l),this._localIdeographFontFamily=i.localIdeographFontFamily,this._validateStyle=i.validateStyle,i.style&&this.setStyle(i.style,{localIdeographFontFamily:i.localIdeographFontFamily}),i.attributionControl&&this.addControl(new VMe(typeof i.attributionControl=="boolean"?void 0:i.attributionControl)),i.maplibreLogo&&this.addControl(new GMe,i.logoPosition),this.on("style.load",()=>{if(l||this._resizeTransform(),this.transform.unmodified){let u=r_(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(u)}}),this.on("data",u=>{this._update(u.dataType==="style"),this.fire(new ht("".concat(u.dataType,"data"),u))}),this.on("dataloading",u=>{this.fire(new ht("".concat(u.dataType,"dataloading"),u))}),this.on("dataabort",u=>{this.fire(new ht("sourcedataabort",u))})}_getMapId(){return this._mapId}setGlobalStateProperty(e,r){return this.style.setGlobalStateProperty(e,r),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(e,r){if(r===void 0&&(e.getDefaultPosition?r=e.getDefaultPosition():r="top-right"),!e||!e.onAdd)return this.fire(new Jt(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));let n=e.onAdd(this);this._controls.push(e);let i=this._controlPositions[r];return r.indexOf("bottom")!==-1?i.insertBefore(n,i.firstChild):i.appendChild(n),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new Jt(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));let r=this._controls.indexOf(e);return r>-1&&this._controls.splice(r,1),e.onRemove(this),this}hasControl(e){return this._controls.indexOf(e)>-1}calculateCameraOptionsFromTo(e,r,n,i){return i==null&&this.terrain&&(i=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(e,r,n,i)}resize(e,r=!0){let[n,i]=this._containerDimensions(),a=this._getClampedPixelRatio(n,i);if(this._resizeCanvas(n,i,a),this.painter.resize(n,i,a),this.painter.overLimit()){let s=this.painter.context.gl;this._maxCanvasSize=[s.drawingBufferWidth,s.drawingBufferHeight];let l=this._getClampedPixelRatio(n,i);this._resizeCanvas(n,i,l),this.painter.resize(n,i,l)}this._resizeTransform(r);let o=!this._moving;return o&&(this.stop(),this.fire(new ht("movestart",e)).fire(new ht("move",e))),this.fire(new ht("resize",e)),o&&this.fire(new ht("moveend",e)),this}_resizeTransform(e=!0){var r;let[n,i]=this._containerDimensions();this.transform.resize(n,i,e),(r=this._requestedCameraState)==null||r.resize(n,i,e)}_getClampedPixelRatio(e,r){let{0:n,1:i}=this._maxCanvasSize,a=this.getPixelRatio(),o=e*a,s=r*a,l=o>n?n/o:1,u=s>i?i/s:1;return Math.min(l,u)*a}getPixelRatio(){var e;return(e=this._overridePixelRatio)!=null?e:devicePixelRatio}setPixelRatio(e){this._overridePixelRatio=e,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(e){return this.transform.setMaxBounds(Vc.convert(e)),this._update()}setMinZoom(e){if(e=e??Qb,e>=Qb&&e<=this.transform.maxZoom)return this.transform.setMinZoom(e),this._update(),this.getZoom()<e&&this.setZoom(e),this;throw new Error("minZoom must be between ".concat(Qb," and the current maxZoom, inclusive"))}getMinZoom(){return this.transform.minZoom}setMaxZoom(e){if(e=e??qX,e>=this.transform.minZoom)return this.transform.setMaxZoom(e),this._update(),this.getZoom()>e&&this.setZoom(e),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(e){if(e=e??Sh,e<Sh)throw new Error("minPitch must be greater than or equal to ".concat(Sh));if(e>=Sh&&e<=this.transform.maxPitch)return this.transform.setMinPitch(e),this._update(),this.getPitch()<e&&this.setPitch(e),this;throw new Error("minPitch must be between ".concat(Sh," and the current maxPitch, inclusive"))}getMinPitch(){return this.transform.minPitch}setMaxPitch(e){if(e=e??YX,e>lb)throw new Error("maxPitch must be less than or equal to ".concat(lb));if(e>=this.transform.minPitch)return this.transform.setMaxPitch(e),this._update(),this.getPitch()>e&&this.setPitch(e),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(e){return this.transform.setRenderWorldCopies(e),this._update()}project(e){return this.transform.locationToScreenPoint(ar.convert(e),this.style&&this.terrain)}unproject(e){return this.transform.screenPointToLocation(gh.default.convert(e),this.terrain)}isMoving(){var e;return this._moving||((e=this.handlers)==null?void 0:e.isMoving())}isZooming(){var e;return this._zooming||((e=this.handlers)==null?void 0:e.isZooming())}isRotating(){var e;return this._rotating||((e=this.handlers)==null?void 0:e.isRotating())}_createDelegatedListener(e,r,n){if(e==="mouseenter"||e==="mouseover"){let i=!1;return{layers:r,listener:n,delegates:{mousemove:a=>{let o=r.filter(l=>this.getLayer(l)),s=o.length!==0?this.queryRenderedFeatures(a.point,{layers:o}):[];s.length?i||(i=!0,n.call(this,new Us(e,this,a.originalEvent,{features:s}))):i=!1},mouseout:()=>{i=!1}}}}else if(e==="mouseleave"||e==="mouseout"){let i=!1;return{layers:r,listener:n,delegates:{mousemove:a=>{let o=r.filter(s=>this.getLayer(s));(o.length!==0?this.queryRenderedFeatures(a.point,{layers:o}):[]).length?i=!0:i&&(i=!1,n.call(this,new Us(e,this,a.originalEvent)))},mouseout:a=>{i&&(i=!1,n.call(this,new Us(e,this,a.originalEvent)))}}}}else{let i=a=>{let o=r.filter(l=>this.getLayer(l)),s=o.length!==0?this.queryRenderedFeatures(a.point,{layers:o}):[];s.length&&(a.features=s,n.call(this,a),delete a.features)};return{layers:r,listener:n,delegates:{[e]:i}}}}_saveDelegatedListener(e,r){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(r)}_removeDelegatedListener(e,r,n){if(!this._delegatedListeners||!this._delegatedListeners[e])return;let i=this._delegatedListeners[e];for(let a=0;a<i.length;a++){let o=i[a];if(o.listener===n&&o.layers.length===r.length&&o.layers.every(s=>r.includes(s))){for(let s in o.delegates)this.off(s,o.delegates[s]);i.splice(a,1);return}}}on(e,r,n){if(n===void 0)return super.on(e,r);let i=typeof r=="string"?[r]:r,a=this._createDelegatedListener(e,i,n);this._saveDelegatedListener(e,a);for(let o in a.delegates)this.on(o,a.delegates[o]);return{unsubscribe:()=>{this._removeDelegatedListener(e,i,n)}}}once(e,r,n){if(n===void 0)return super.once(e,r);let i=typeof r=="string"?[r]:r,a=this._createDelegatedListener(e,i,n);for(let o in a.delegates){let s=a.delegates[o];a.delegates[o]=(...l)=>{this._removeDelegatedListener(e,i,n),s(...l)}}this._saveDelegatedListener(e,a);for(let o in a.delegates)this.once(o,a.delegates[o]);return this}off(e,r,n){if(n===void 0)return super.off(e,r);let i=typeof r=="string"?[r]:r;return this._removeDelegatedListener(e,i,n),this}queryRenderedFeatures(e,r){if(!this.style)return[];let n,i=e instanceof gh.default||Array.isArray(e),a=i?e:[[0,0],[this.transform.width,this.transform.height]];if(r=r||(i?{}:e)||{},a instanceof gh.default||typeof a[0]=="number")n=[gh.default.convert(a)];else{let o=gh.default.convert(a[0]),s=gh.default.convert(a[1]);n=[o,new gh.default(s.x,o.y),s,new gh.default(o.x,s.y),o]}return this.style.queryRenderedFeatures(n,r,this.transform)}querySourceFeatures(e,r){return this.style.querySourceFeatures(e,r)}setStyle(e,r){return r=zt({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},r),r.diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&e?(this._diffStyle(e,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(e,r))}setTransformRequest(e){return this._requestManager.setTransformRequest(e),this}_getUIString(e){let r=this._locale[e];if(r==null)throw new Error("Missing UI string '".concat(e,"'"));return r}_updateStyle(e,r){var n,i;if(r.transformStyle&&this.style&&!this.style._loaded){this.style.once("style.load",()=>this._updateStyle(e,r));return}let a=this.style&&r.transformStyle?this.style.serialize():void 0;if(this.style&&(this.style.setEventedParent(null),this.style._remove(!e)),e)this.style=new h8(this,r||{});else return(i=(n=this.style)==null?void 0:n.projection)==null||i.destroy(),delete this.style,this;return this.style.setEventedParent(this,{style:this.style}),typeof e=="string"?this.style.loadURL(e,r,a):this.style.loadJSON(e,r,a),this}_lazyInitEmptyStyle(){this.style||(this.style=new h8(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(e,r){if(typeof e=="string"){let n=e,i=this._requestManager.transformRequest(n,"Style");QA(i,new AbortController).then(a=>{this._updateDiff(a.data,r)}).catch(a=>{a&&this.fire(new Jt(a))})}else typeof e=="object"&&this._updateDiff(e,r)}_updateDiff(e,r){try{this.style.setState(e,r)&&this._update(!0)}catch(n){Ui("Unable to perform style diff: ".concat(n.message||n.error||n,".  Rebuilding the style from scratch.")),this._updateStyle(e,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():Ui("There is no style added to the map.")}addSource(e,r){return this._lazyInitEmptyStyle(),this.style.addSource(e,r),this._update(!0)}isSourceLoaded(e){let r=this.style&&this.style.sourceCaches[e];if(r===void 0){this.fire(new Jt(new Error("There is no source with ID '".concat(e,"'"))));return}return r.loaded()}setTerrain(e){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),!e)this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this._centerClampedToGround&&this.transform.setElevation(0);else{let r=this.style.sourceCaches[e.source];if(!r)throw new Error("cannot load terrain, because there exists no source with ID: ".concat(e.source));this.terrain===null&&r.reload();for(let n in this.style._layers){let i=this.style._layers[n];i.type==="hillshade"&&i.source===e.source&&Ui("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),i.type==="color-relief"&&i.source===e.source&&Ui("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new qMe(this.painter,r,e),this.painter.renderToTexture=new JMe(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=n=>{var i;n.dataType==="style"?this.terrain.sourceCache.freeRtt():n.dataType==="source"&&n.tile&&(n.sourceId===e.source&&!this._elevationFreeze&&(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((i=n.source)==null?void 0:i.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(n.tile.tileID))},this.style.on("data",this._terrainDataCallback)}return this.fire(new ht("terrain",{terrain:e})),this}getTerrain(){var e,r;return(r=(e=this.terrain)==null?void 0:e.options)!=null?r:null}areTilesLoaded(){let e=this.style&&this.style.sourceCaches;for(let r in e){let n=e[r]._tiles;for(let i in n){let a=n[i];if(!(a.state==="loaded"||a.state==="errored"))return!1}}return!0}removeSource(e){return this.style.removeSource(e),this._update(!0)}getSource(e){return this.style.getSource(e)}setSourceTileLodParams(e,r,n){if(n){let i=this.getSource(n);if(!i)throw new Error('There is no source with ID "'.concat(n,'", cannot set LOD parameters'));i.calculateTileZoom=TM(Math.max(1,e),Math.max(1,r))}else for(let i in this.style.sourceCaches)this.style.sourceCaches[i].getSource().calculateTileZoom=TM(Math.max(1,e),Math.max(1,r));return this._update(!0),this}refreshTiles(e,r){let n=this.style.sourceCaches[e];if(!n)throw new Error('There is no source cache with ID "'.concat(e,'", cannot refresh tile'));r===void 0?n.reload(!0):n.refreshTiles(r.map(i=>new E3(i.z,i.x,i.y)))}addImage(e,r,n={}){let{pixelRatio:i=1,sdf:a=!1,stretchX:o,stretchY:s,content:l,textFitWidth:u,textFitHeight:c}=n;this._lazyInitEmptyStyle();let h=0;if(r instanceof HTMLImageElement||Lc(r)){let{width:d,height:p,data:m}=Dr.getImageData(r);this.style.addImage(e,{data:new ti({width:d,height:p},m),pixelRatio:i,stretchX:o,stretchY:s,content:l,textFitWidth:u,textFitHeight:c,sdf:a,version:h})}else{if(r.width===void 0||r.height===void 0)return this.fire(new Jt(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{let{width:d,height:p,data:m}=r,y=r;return this.style.addImage(e,{data:new ti({width:d,height:p},new Uint8Array(m)),pixelRatio:i,stretchX:o,stretchY:s,content:l,textFitWidth:u,textFitHeight:c,sdf:a,version:h,userImage:y}),y.onAdd&&y.onAdd(this,e),this}}}updateImage(e,r){let n=this.style.getImage(e);if(!n)return this.fire(new Jt(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));let i=r instanceof HTMLImageElement||Lc(r)?Dr.getImageData(r):r,{width:a,height:o,data:s}=i;if(a===void 0||o===void 0)return this.fire(new Jt(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(a!==n.data.width||o!==n.data.height)return this.fire(new Jt(new Error("The width and height of the updated image must be that same as the previous version of the image")));let l=!(r instanceof HTMLImageElement||Lc(r));return n.data.replace(s,l),this.style.updateImage(e,n),this}getImage(e){return this.style.getImage(e)}hasImage(e){return e?!!this.style.getImage(e):(this.fire(new Jt(new Error("Missing required image id"))),!1)}removeImage(e){this.style.removeImage(e)}loadImage(e){return Au.getImage(this._requestManager.transformRequest(e,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(e,r){return this._lazyInitEmptyStyle(),this.style.addLayer(e,r),this._update(!0)}moveLayer(e,r){return this.style.moveLayer(e,r),this._update(!0)}removeLayer(e){return this.style.removeLayer(e),this._update(!0)}getLayer(e){return this.style.getLayer(e)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(e,r,n){return this.style.setLayerZoomRange(e,r,n),this._update(!0)}setFilter(e,r,n={}){return this.style.setFilter(e,r,n),this._update(!0)}getFilter(e){return this.style.getFilter(e)}setPaintProperty(e,r,n,i={}){return this.style.setPaintProperty(e,r,n,i),this._update(!0)}getPaintProperty(e,r){return this.style.getPaintProperty(e,r)}setLayoutProperty(e,r,n,i={}){return this.style.setLayoutProperty(e,r,n,i),this._update(!0)}getLayoutProperty(e,r){return this.style.getLayoutProperty(e,r)}setGlyphs(e,r={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(e,r),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(e,r,n={}){return this._lazyInitEmptyStyle(),this.style.addSprite(e,r,n,i=>{i||this._update(!0)}),this}removeSprite(e){return this._lazyInitEmptyStyle(),this.style.removeSprite(e),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(e,r={}){return this._lazyInitEmptyStyle(),this.style.setSprite(e,r,n=>{n||this._update(!0)}),this}setLight(e,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(e,r),this._update(!0)}getLight(){return this.style.getLight()}setSky(e,r={}){return this._lazyInitEmptyStyle(),this.style.setSky(e,r),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(e,r){return this.style.setFeatureState(e,r),this._update()}removeFeatureState(e,r){return this.style.removeFeatureState(e,r),this._update()}getFeatureState(e){return this.style.getFeatureState(e)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let e=0,r=0;return this._container&&(e=this._container.clientWidth||400,r=this._container.clientHeight||300),[e,r]}_setupContainer(){let e=this._container;e.classList.add("maplibregl-map");let r=this._canvasContainer=Fr.create("div","maplibregl-canvas-container",e);this._interactive&&r.classList.add("maplibregl-interactive"),this._canvas=Fr.create("canvas","maplibregl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");let n=this._containerDimensions(),i=this._getClampedPixelRatio(n[0],n[1]);this._resizeCanvas(n[0],n[1],i);let a=this._controlContainer=Fr.create("div","maplibregl-control-container",e),o=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(s=>{o[s]=Fr.create("div","maplibregl-ctrl-".concat(s," "),a)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(e,r,n){this._canvas.width=Math.floor(n*e),this._canvas.height=Math.floor(n*r),this._canvas.style.width="".concat(e,"px"),this._canvas.style.height="".concat(r,"px")}_setupPainter(){let e=lt(ae({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0}),r=null;this._canvas.addEventListener("webglcontextcreationerror",i=>{r={requestedAttributes:e},i&&(r.statusMessage=i.statusMessage,r.type=i.type)},{once:!0});let n=null;if(this._canvasContextAttributes.contextType?n=this._canvas.getContext(this._canvasContextAttributes.contextType,e):n=this._canvas.getContext("webgl2",e)||this._canvas.getContext("webgl",e),!n){let i="Failed to initialize WebGL";throw r?(r.message=i,new Error(JSON.stringify(r))):new Error(i)}this.painter=new jCe(n,this.transform),E5.testSupport(n)}migrateProjection(e,r){super.migrateProjection(e,r),this.painter.transform=e,this.fire(new ht("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(e){return!this.style||!this.style._loaded?this:(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this)}_requestRenderFrame(e){return this._update(),this._renderTaskQueue.add(e)}_cancelRenderFrame(e){this._renderTaskQueue.remove(e)}_render(e){var r,n,i,a,o;let s=this._idleTriggered?this._fadeDuration:0,l=((r=this.style.projection)==null?void 0:r.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),this._removed)return;let u=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;let d=this.transform.zoom,p=Dr.now();this.style.zoomHistory.update(d,p);let m=new Fi(d,{now:p,fadeDuration:s,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition(),globalState:this.style.getGlobalState()}),y=m.crossFadingFactor();(y!==1||y!==this._crossFadingFactor)&&(u=!0,this._crossFadingFactor=y),this.style.update(m)}let c=((n=this.style.projection)==null?void 0:n.transitionState)>0!==l;(i=this.style.projection)==null||i.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((a=this.style.projection)==null?void 0:a.transitionState,(o=this.style.projection)==null?void 0:o.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||c)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):this._centerClampedToGround&&this.transform.setElevation(0),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,s,this._crossSourceCollisions,c),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:s,showPadding:this.showPadding}),this.fire(new ht("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,gy.mark("load"),this.fire(new ht("load"))),this.style&&(this.style.hasTransitions()||u)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();let h=this._sourcesDirty||this._styleDirty||this._placementDirty;return h||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new ht("idle")),this._loaded&&!this._fullyLoaded&&!h&&(this._fullyLoaded=!0,gy.mark("fullLoad")),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var e;this._hash&&this._hash.remove();for(let n of this._controls)n.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Au.removeThrottleControl(this._imageQueueHandle),(e=this._resizeObserver)==null||e.disconnect();let r=this.painter.context.gl.getExtension("WEBGL_lose_context");r!=null&&r.loseContext&&r.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),Fr.remove(this._canvasContainer),Fr.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),gy.clearMetrics(),this._removed=!0,this.fire(new ht("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,Dr.frame(this._frameRequest,e=>{gy.frame(e),this._frameRequest=null;try{this._render(e)}catch(r){if(!C1e(r)&&!JIe(r))throw r}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())}get showPadding(){return!!this._showPadding}set showPadding(e){this._showPadding!==e&&(this._showPadding=e,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())}get repaint(){return!!this._repaint}set repaint(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(e){this._vertices=e,this._update()}get version(){return QMe}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(e){return this._lazyInitEmptyStyle(),this.style.setProjection(e),this._update(!0)}};C();Zt(xr(),1);C();C();C();Zt(xr(),1);C();C();C();C();C();C();C();Zt(xr(),1);var E8=Zt(xr(),1);C();C();C();C();C();C();C();var Oo=63710088e-1,JX={centimeters:Oo*100,centimetres:Oo*100,degrees:Oo/111325,feet:Oo*3.28084,inches:Oo*39.37,kilometers:Oo/1e3,kilometres:Oo/1e3,meters:Oo,metres:Oo,miles:Oo/1609.344,millimeters:Oo*1e3,millimetres:Oo*1e3,nauticalmiles:Oo/1852,radians:1,yards:Oo*1.0936};function Gc(t,e,r){r===void 0&&(r={});var n={type:"Feature"};return(r.id===0||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=e||{},n.geometry=t,n}function lg(t,e,r){if(r===void 0&&(r={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!I8(t[0])||!I8(t[1]))throw new Error("coordinates must contain numbers");var n={type:"Point",coordinates:t};return Gc(n,e,r)}function rI(t,e,r){r===void 0&&(r={});for(var n=0,i=t;n<i.length;n++){var a=i[n];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<a[a.length-1].length;o++)if(a[a.length-1][o]!==a[0][o])throw new Error("First and last Position are not equivalent.")}var s={type:"Polygon",coordinates:t};return Gc(s,e,r)}function $g(t,e,r){if(r===void 0&&(r={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");var n={type:"LineString",coordinates:t};return Gc(n,e,r)}function L4(t,e){e===void 0&&(e={});var r={type:"FeatureCollection"};return e.id&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.features=t,r}function tTe(t,e,r){r===void 0&&(r={});var n={type:"MultiLineString",coordinates:t};return Gc(n,e,r)}function rTe(t,e,r){r===void 0&&(r={});var n={type:"MultiPolygon",coordinates:t};return Gc(n,e,r)}function nTe(t,e){e===void 0&&(e="kilometers");var r=JX[e];if(!r)throw new Error(e+" units is invalid");return t*r}function iTe(t,e){e===void 0&&(e="kilometers");var r=JX[e];if(!r)throw new Error(e+" units is invalid");return t/r}function NM(t){var e=t%(2*Math.PI);return e*180/Math.PI}function Dl(t){var e=t%360;return e*Math.PI/180}function I8(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function k3(t,e,r){if(t!==null)for(var n,i,a,o,s,l,u,c=0,h=0,d,p=t.type,m=p==="FeatureCollection",y=p==="Feature",v=m?t.features.length:1,_=0;_<v;_++){u=m?t.features[_].geometry:y?t.geometry:t,d=u?u.type==="GeometryCollection":!1,s=d?u.geometries.length:1;for(var w=0;w<s;w++){var b=0,A=0;if(o=d?u.geometries[w]:u,o!==null){l=o.coordinates;var E=o.type;switch(c=0,E){case null:break;case"Point":if(e(l,h,_,b,A)===!1)return!1;h++,b++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++){if(e(l[n],h,_,b,A)===!1)return!1;h++,E==="MultiPoint"&&b++}E==="LineString"&&b++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(i=0;i<l[n].length-c;i++){if(e(l[n][i],h,_,b,A)===!1)return!1;h++}E==="MultiLineString"&&b++,E==="Polygon"&&A++}E==="Polygon"&&b++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for(A=0,i=0;i<l[n].length;i++){for(a=0;a<l[n][i].length-c;a++){if(e(l[n][i][a],h,_,b,A)===!1)return!1;h++}A++}b++}break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(k3(o.geometries[n],e)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function C8(t,e){if(t.type==="Feature")e(t,0);else if(t.type==="FeatureCollection")for(var r=0;r<t.features.length&&e(t.features[r],r)!==!1;r++);}function aTe(t,e){var r,n,i,a,o,s,l,u,c,h,d=0,p=t.type==="FeatureCollection",m=t.type==="Feature",y=p?t.features.length:1;for(r=0;r<y;r++){for(s=p?t.features[r].geometry:m?t.geometry:t,u=p?t.features[r].properties:m?t.properties:{},c=p?t.features[r].bbox:m?t.bbox:void 0,h=p?t.features[r].id:m?t.id:void 0,l=s?s.type==="GeometryCollection":!1,o=l?s.geometries.length:1,i=0;i<o;i++){if(a=l?s.geometries[i]:s,a===null){if(e(null,d,u,c,h)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(a,d,u,c,h)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<a.geometries.length;n++)if(e(a.geometries[n],d,u,c,h)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}d++}}function Gp(t,e){aTe(t,function(r,n,i,a,o){var s=r===null?null:r.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return e(Gc(r,i,{bbox:a,id:o}),n,0)===!1?!1:void 0}var l;switch(s){case"MultiPoint":l="Point";break;case"MultiLineString":l="LineString";break;case"MultiPolygon":l="Polygon";break}for(var u=0;u<r.coordinates.length;u++){var c=r.coordinates[u],h={type:l,coordinates:c};if(e(Gc(h,i),n,u)===!1)return!1}})}function oTe(t,e){Gp(t,function(r,n,i){var a=0;if(r.geometry){var o=r.geometry.type;if(!(o==="Point"||o==="MultiPoint")){var s,l=0,u=0,c=0;if(k3(r,function(h,d,p,m,y){if(s===void 0||n>l||m>u||y>c){s=h,l=n,u=m,c=y,a=0;return}var v=$g([s,h],r.properties);if(e(v,n,i,y,a)===!1)return!1;a++,s=h})===!1)return!1}}})}function sTe(t,e,r){var n=r,i=!1;return oTe(t,function(a,o,s,l,u){i===!1&&r===void 0?n=a:n=e(n,a,o,s,l,u),i=!0}),n}function $M(t){var e=[1/0,1/0,-1/0,-1/0];return k3(t,function(r){e[0]>r[0]&&(e[0]=r[0]),e[1]>r[1]&&(e[1]=r[1]),e[2]<r[0]&&(e[2]=r[0]),e[3]<r[1]&&(e[3]=r[1])}),e}$M.default=$M;var p_=$M;function lTe(t){return p_(t)}C();C();C();C();C();var nI=class{constructor(){S(this,"type","interaction"),S(this,"hover",!1),S(this,"dirty",!1)}};C();C();var Fk=zi([Pa(["low","medium","high","always-visible"]),pt()]),KX=["","","low","medium","high","always-visible"],uTe=2,cTe=3,O3=5;function QX(t){return Math.min(O3,Math.max(uTe,t))}function Rk(t){if(typeof t=="number")return QX(t);let e=KX.indexOf(t);return e===-1?cTe:e}function ub(t){let e=QX(t);return KX[e]}C();C();C();var hTe=at.enum(Kme),dTe=t=>{let e=t[0];for(let r=1;r<t.length;r++){let n=t[r];if(n<=e)return!1;e=n}return!0},pTe=t=>{let e=t[0];for(let r=1;r<t.length;r++){let n=t[r];if(n>=e)return!1;e=n}return!0},fTe=t=>dTe(t)||pTe(t),mTe=at.object({on:at.literal("zoom-level"),input:at.tuple([at.number()]).rest(at.number()).refine(fTe,{message:"input array must be strictly increasing or decreasing"}),output:at.tuple([at.number()]).rest(at.number()),easing:hTe.default("linear")}).refine(t=>t.input.length===t.output.length,{message:"input and output must have the same length"});C();function N4(t){"@babel/helpers - typeof";return N4=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N4(t)}var gTe=/^\s+/,yTe=/\s+$/;function Vt(t,e){if(t=t||"",e=e||{},t instanceof Vt)return t;if(!(this instanceof Vt))return new Vt(t,e);var r=vTe(t);this._originalInput=t,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||r.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=r.ok}Vt.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(t.r*299+t.g*587+t.b*114)/1e3},getLuminance:function(){var t=this.toRgb(),e,r,n,i,a,o;return e=t.r/255,r=t.g/255,n=t.b/255,e<=.03928?i=e/12.92:i=Math.pow((e+.055)/1.055,2.4),r<=.03928?a=r/12.92:a=Math.pow((r+.055)/1.055,2.4),n<=.03928?o=n/12.92:o=Math.pow((n+.055)/1.055,2.4),.2126*i+.7152*a+.0722*o},setAlpha:function(t){return this._a=eq(t),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var t=T8(this._r,this._g,this._b);return{h:t.h*360,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=T8(this._r,this._g,this._b),e=Math.round(t.h*360),r=Math.round(t.s*100),n=Math.round(t.v*100);return this._a==1?"hsv("+e+", "+r+"%, "+n+"%)":"hsva("+e+", "+r+"%, "+n+"%, "+this._roundA+")"},toHsl:function(){var t=M8(this._r,this._g,this._b);return{h:t.h*360,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=M8(this._r,this._g,this._b),e=Math.round(t.h*360),r=Math.round(t.s*100),n=Math.round(t.l*100);return this._a==1?"hsl("+e+", "+r+"%, "+n+"%)":"hsla("+e+", "+r+"%, "+n+"%, "+this._roundA+")"},toHex:function(t){return P8(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(t){return wTe(this._r,this._g,this._b,this._a,t)},toHex8String:function(t){return"#"+this.toHex8(t)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(ci(this._r,255)*100)+"%",g:Math.round(ci(this._g,255)*100)+"%",b:Math.round(ci(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(ci(this._r,255)*100)+"%, "+Math.round(ci(this._g,255)*100)+"%, "+Math.round(ci(this._b,255)*100)+"%)":"rgba("+Math.round(ci(this._r,255)*100)+"%, "+Math.round(ci(this._g,255)*100)+"%, "+Math.round(ci(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:BTe[P8(this._r,this._g,this._b,!0)]||!1},toFilter:function(t){var e="#"+D8(this._r,this._g,this._b,this._a),r=e,n=this._gradientType?"GradientType = 1, ":"";if(t){var i=Vt(t);r="#"+D8(i._r,i._g,i._b,i._a)}return"progid:DXImageTransform.Microsoft.gradient("+n+"startColorstr="+e+",endColorstr="+r+")"},toString:function(t){var e=!!t;t=t||this._format;var r=!1,n=this._a<1&&this._a>=0,i=!e&&n&&(t==="hex"||t==="hex6"||t==="hex3"||t==="hex4"||t==="hex8"||t==="name");return i?t==="name"&&this._a===0?this.toName():this.toRgbString():(t==="rgb"&&(r=this.toRgbString()),t==="prgb"&&(r=this.toPercentageRgbString()),(t==="hex"||t==="hex6")&&(r=this.toHexString()),t==="hex3"&&(r=this.toHexString(!0)),t==="hex4"&&(r=this.toHex8String(!0)),t==="hex8"&&(r=this.toHex8String()),t==="name"&&(r=this.toName()),t==="hsl"&&(r=this.toHslString()),t==="hsv"&&(r=this.toHsvString()),r||this.toHexString())},clone:function(){return Vt(this.toString())},_applyModification:function(t,e){var r=t.apply(null,[this].concat([].slice.call(e)));return this._r=r._r,this._g=r._g,this._b=r._b,this.setAlpha(r._a),this},lighten:function(){return this._applyModification(ITe,arguments)},brighten:function(){return this._applyModification(CTe,arguments)},darken:function(){return this._applyModification(MTe,arguments)},desaturate:function(){return this._applyModification(ATe,arguments)},saturate:function(){return this._applyModification(STe,arguments)},greyscale:function(){return this._applyModification(ETe,arguments)},spin:function(){return this._applyModification(TTe,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(kTe,arguments)},complement:function(){return this._applyCombination(PTe,arguments)},monochromatic:function(){return this._applyCombination(OTe,arguments)},splitcomplement:function(){return this._applyCombination(DTe,arguments)},triad:function(){return this._applyCombination(k8,[3])},tetrad:function(){return this._applyCombination(k8,[4])}};Vt.fromRatio=function(t,e){if(N4(t)=="object"){var r={};for(var n in t)t.hasOwnProperty(n)&&(n==="a"?r[n]=t[n]:r[n]=Vy(t[n]));t=r}return Vt(t,e)};function vTe(t){var e={r:0,g:0,b:0},r=1,n=null,i=null,a=null,o=!1,s=!1;return typeof t=="string"&&(t=LTe(t)),N4(t)=="object"&&(ic(t.r)&&ic(t.g)&&ic(t.b)?(e=_Te(t.r,t.g,t.b),o=!0,s=String(t.r).substr(-1)==="%"?"prgb":"rgb"):ic(t.h)&&ic(t.s)&&ic(t.v)?(n=Vy(t.s),i=Vy(t.v),e=bTe(t.h,n,i),o=!0,s="hsv"):ic(t.h)&&ic(t.s)&&ic(t.l)&&(n=Vy(t.s),a=Vy(t.l),e=xTe(t.h,n,a),o=!0,s="hsl"),t.hasOwnProperty("a")&&(r=t.a)),r=eq(r),{ok:o,format:t.format||s,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:r}}function _Te(t,e,r){return{r:ci(t,255)*255,g:ci(e,255)*255,b:ci(r,255)*255}}function M8(t,e,r){t=ci(t,255),e=ci(e,255),r=ci(r,255);var n=Math.max(t,e,r),i=Math.min(t,e,r),a,o,s=(n+i)/2;if(n==i)a=o=0;else{var l=n-i;switch(o=s>.5?l/(2-n-i):l/(n+i),n){case t:a=(e-r)/l+(e<r?6:0);break;case e:a=(r-t)/l+2;break;case r:a=(t-e)/l+4;break}a/=6}return{h:a,s:o,l:s}}function xTe(t,e,r){var n,i,a;t=ci(t,360),e=ci(e,100),r=ci(r,100);function o(u,c,h){return h<0&&(h+=1),h>1&&(h-=1),h<1/6?u+(c-u)*6*h:h<1/2?c:h<2/3?u+(c-u)*(2/3-h)*6:u}if(e===0)n=i=a=r;else{var s=r<.5?r*(1+e):r+e-r*e,l=2*r-s;n=o(l,s,t+1/3),i=o(l,s,t),a=o(l,s,t-1/3)}return{r:n*255,g:i*255,b:a*255}}function T8(t,e,r){t=ci(t,255),e=ci(e,255),r=ci(r,255);var n=Math.max(t,e,r),i=Math.min(t,e,r),a,o,s=n,l=n-i;if(o=n===0?0:l/n,n==i)a=0;else{switch(n){case t:a=(e-r)/l+(e<r?6:0);break;case e:a=(r-t)/l+2;break;case r:a=(t-e)/l+4;break}a/=6}return{h:a,s:o,v:s}}function bTe(t,e,r){t=ci(t,360)*6,e=ci(e,100),r=ci(r,100);var n=Math.floor(t),i=t-n,a=r*(1-e),o=r*(1-i*e),s=r*(1-(1-i)*e),l=n%6,u=[r,o,a,a,s,r][l],c=[s,r,r,o,a,a][l],h=[a,a,s,r,r,o][l];return{r:u*255,g:c*255,b:h*255}}function P8(t,e,r,n){var i=[kl(Math.round(t).toString(16)),kl(Math.round(e).toString(16)),kl(Math.round(r).toString(16))];return n&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function wTe(t,e,r,n,i){var a=[kl(Math.round(t).toString(16)),kl(Math.round(e).toString(16)),kl(Math.round(r).toString(16)),kl(tq(n))];return i&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}function D8(t,e,r,n){var i=[kl(tq(n)),kl(Math.round(t).toString(16)),kl(Math.round(e).toString(16)),kl(Math.round(r).toString(16))];return i.join("")}Vt.equals=function(t,e){return!t||!e?!1:Vt(t).toRgbString()==Vt(e).toRgbString()};Vt.random=function(){return Vt.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function ATe(t,e){e=e===0?0:e||10;var r=Vt(t).toHsl();return r.s-=e/100,r.s=B3(r.s),Vt(r)}function STe(t,e){e=e===0?0:e||10;var r=Vt(t).toHsl();return r.s+=e/100,r.s=B3(r.s),Vt(r)}function ETe(t){return Vt(t).desaturate(100)}function ITe(t,e){e=e===0?0:e||10;var r=Vt(t).toHsl();return r.l+=e/100,r.l=B3(r.l),Vt(r)}function CTe(t,e){e=e===0?0:e||10;var r=Vt(t).toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(255*-(e/100)))),r.g=Math.max(0,Math.min(255,r.g-Math.round(255*-(e/100)))),r.b=Math.max(0,Math.min(255,r.b-Math.round(255*-(e/100)))),Vt(r)}function MTe(t,e){e=e===0?0:e||10;var r=Vt(t).toHsl();return r.l-=e/100,r.l=B3(r.l),Vt(r)}function TTe(t,e){var r=Vt(t).toHsl(),n=(r.h+e)%360;return r.h=n<0?360+n:n,Vt(r)}function PTe(t){var e=Vt(t).toHsl();return e.h=(e.h+180)%360,Vt(e)}function k8(t,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var r=Vt(t).toHsl(),n=[Vt(t)],i=360/e,a=1;a<e;a++)n.push(Vt({h:(r.h+a*i)%360,s:r.s,l:r.l}));return n}function DTe(t){var e=Vt(t).toHsl(),r=e.h;return[Vt(t),Vt({h:(r+72)%360,s:e.s,l:e.l}),Vt({h:(r+216)%360,s:e.s,l:e.l})]}function kTe(t,e,r){e=e||6,r=r||30;var n=Vt(t).toHsl(),i=360/r,a=[Vt(t)];for(n.h=(n.h-(i*e>>1)+720)%360;--e;)n.h=(n.h+i)%360,a.push(Vt(n));return a}function OTe(t,e){e=e||6;for(var r=Vt(t).toHsv(),n=r.h,i=r.s,a=r.v,o=[],s=1/e;e--;)o.push(Vt({h:n,s:i,v:a})),a=(a+s)%1;return o}Vt.mix=function(t,e,r){r=r===0?0:r||50;var n=Vt(t).toRgb(),i=Vt(e).toRgb(),a=r/100,o={r:(i.r-n.r)*a+n.r,g:(i.g-n.g)*a+n.g,b:(i.b-n.b)*a+n.b,a:(i.a-n.a)*a+n.a};return Vt(o)};Vt.readability=function(t,e){var r=Vt(t),n=Vt(e);return(Math.max(r.getLuminance(),n.getLuminance())+.05)/(Math.min(r.getLuminance(),n.getLuminance())+.05)};Vt.isReadable=function(t,e,r){var n=Vt.readability(t,e),i,a;switch(a=!1,i=NTe(r),i.level+i.size){case"AAsmall":case"AAAlarge":a=n>=4.5;break;case"AAlarge":a=n>=3;break;case"AAAsmall":a=n>=7;break}return a};Vt.mostReadable=function(t,e,r){var n=null,i=0,a,o,s,l;r=r||{},o=r.includeFallbackColors,s=r.level,l=r.size;for(var u=0;u<e.length;u++)a=Vt.readability(t,e[u]),a>i&&(i=a,n=Vt(e[u]));return Vt.isReadable(t,n,{level:s,size:l})||!o?n:(r.includeFallbackColors=!1,Vt.mostReadable(t,["#fff","#000"],r))};var UM=Vt.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},BTe=Vt.hexNames=zTe(UM);function zTe(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[t[r]]=r);return e}function eq(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function ci(t,e){FTe(t)&&(t="100%");var r=RTe(t);return t=Math.min(e,Math.max(0,parseFloat(t))),r&&(t=parseInt(t*e,10)/100),Math.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function B3(t){return Math.min(1,Math.max(0,t))}function rs(t){return parseInt(t,16)}function FTe(t){return typeof t=="string"&&t.indexOf(".")!=-1&&parseFloat(t)===1}function RTe(t){return typeof t=="string"&&t.indexOf("%")!=-1}function kl(t){return t.length==1?"0"+t:""+t}function Vy(t){return t<=1&&(t=t*100+"%"),t}function tq(t){return Math.round(parseFloat(t)*255).toString(16)}function O8(t){return rs(t)/255}var cl=(function(){var t="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",r="(?:"+e+")|(?:"+t+")",n="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?",i="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";return{CSS_UNIT:new RegExp(r),rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+i),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+i),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+i),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}})();function ic(t){return!!cl.CSS_UNIT.exec(t)}function LTe(t){t=t.replace(gTe,"").replace(yTe,"").toLowerCase();var e=!1;if(UM[t])t=UM[t],e=!0;else if(t=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var r;return(r=cl.rgb.exec(t))?{r:r[1],g:r[2],b:r[3]}:(r=cl.rgba.exec(t))?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=cl.hsl.exec(t))?{h:r[1],s:r[2],l:r[3]}:(r=cl.hsla.exec(t))?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=cl.hsv.exec(t))?{h:r[1],s:r[2],v:r[3]}:(r=cl.hsva.exec(t))?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=cl.hex8.exec(t))?{r:rs(r[1]),g:rs(r[2]),b:rs(r[3]),a:O8(r[4]),format:e?"name":"hex8"}:(r=cl.hex6.exec(t))?{r:rs(r[1]),g:rs(r[2]),b:rs(r[3]),format:e?"name":"hex"}:(r=cl.hex4.exec(t))?{r:rs(r[1]+""+r[1]),g:rs(r[2]+""+r[2]),b:rs(r[3]+""+r[3]),a:O8(r[4]+""+r[4]),format:e?"name":"hex8"}:(r=cl.hex3.exec(t))?{r:rs(r[1]+""+r[1]),g:rs(r[2]+""+r[2]),b:rs(r[3]+""+r[3]),format:e?"name":"hex"}:!1}function NTe(t){var e,r;return t=t||{level:"AA",size:"small"},e=(t.level||"AA").toUpperCase(),r=(t.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),r!=="small"&&r!=="large"&&(r="small"),{level:e,size:r}}var na={RIGHT:"right",LEFT:"left",TOP:"top",HIDDEN:"hidden",CENTER:"center"},Cf="low-priority",$4=Object.values(na),z3=[na.RIGHT,na.LEFT,na.TOP,na.HIDDEN],Lk=Nr({margin:pt().min(6).default(6),maxLines:pt().min(1).default(2),textSize:pt().min(0).default(11.5),maxWidth:pt().min(0).default(150),lineHeight:pt().min(0).default(1.2),color:mr().default("#333"),outlineColor:mr().default("white"),textColor:mr().optional(),textOutlineColor:mr().optional(),pinColor:mr().optional(),pinOutlineColor:mr().optional(),pinColorInactive:mr().optional(),pinOutlineColorInactive:mr().optional(),icon:mr().optional(),iconSize:pt().min(0).default(20),iconScale:zi([pt(),mTe]).default(1),iconPadding:pt().min(0).default(2),iconFit:Pa(["fill","contain","cover"]).default("cover"),iconOverflow:Pa(["visible","hidden"]).default("hidden"),iconVisible:zi([Lr(),pt()]).default(!0),opacity:pt().min(0).max(1).default(1)}),rq=Lk.transform(t=>{var e,r,n,i,a,o,s,l;return lt(ae({},t),{textColor:(e=t.textColor)!=null?e:t.color,textOutlineColor:(r=t.textOutlineColor)!=null?r:t.outlineColor,pinColor:(n=t.pinColor)!=null?n:t.color,pinOutlineColor:(i=t.pinOutlineColor)!=null?i:t.outlineColor,pinColorInactive:(o=t.pinColorInactive)!=null?o:Vt((a=t.pinColor)!=null?a:t.color).toRgbString(),pinOutlineColorInactive:(l=t.pinOutlineColorInactive)!=null?l:Vt((s=t.pinOutlineColor)!=null?s:t.outlineColor).toRgbString()})});_a(Lk.shape);var nq=t=>rq.parse(t),$Te=Nr({rank:Fk.optional(),appearance:rq.optional(),interactive:Lr().default(!1),textPlacement:zi([Pa($4),bo(Pa($4))]).default(z3)}),UTe=t=>{$Te.parse(t??{})},jTe=bo(pt()).min(2).max(3),VTe=mr(),GTe=(t,e,r)=>{jTe.parse(t),VTe.parse(e),UTe(r)},iq=["color","outlineColor","margin"],ZTe=[...iq,"maxLines","lineHeight","textSize","maxWidth","textColor","textOutlineColor"],WTe=[...iq,"icon","iconSize","iconScale","iconVisible","iconPadding","pinColor","pinOutlineColor","pinColorInactive","pinOutlineColorInactive"],HTe=(t,e)=>ZTe.some(r=>e[r]!=null&&t[r]!==e[r]),XTe=(t,e)=>WTe.some(r=>e[r]!=null&&t[r]!==e[r]),B8=4,qTe=6,aq=6.5,cb=aq/2,z8=[cb,cb,cb,cb],oq=class e2{constructor(e,r,n){S(this,"lines",0),S(this,"id"),S(this,"rank"),S(this,"type","label"),S(this,"initialRank"),S(this,"contextConfigured",!1),S(this,"fillText"),S(this,"newStyle",{}),S(this,"currentOpacity",0),S(this,"visibilityNeedsUpdate",!1),S(this,"activePlacement",na.RIGHT),S(this,"text"),S(this,"style",{top:0,left:0,textLabelVisible:!0,pinVisibility:1,textAlign:"left"}),S(this,"projection",new Je),S(this,"labelCacheId"),S(this,"_cache",{}),S(this,"appearance"),S(this,"options"),S(this,"visible",!0),S(this,"enabled",!0),S(this,"isOccluded",!1),S(this,"offscreen",!1),S(this,"canShow",!1),S(this,"activeBoundingBox",{x:0,y:0,w:0,h:0}),S(this,"dimensions",{width:0,height:0}),S(this,"currentStrategyIndex",-1),S(this,"totalPinSize",0),S(this,"iconScale",1),S(this,"iconPadding"),S(this,"dirty",!0),S(this,"textDirty",!0),S(this,"pinDirty",!0),S(this,"attachedDirty",!0),S(this,"collisionDirty",!0),S(this,"lastTextAlign"),S(this,"imageHash"),S(this,"pinSize",0),S(this,"iconVisible",!1),S(this,"dp"),S(this,"animate",!0),S(this,"onStrategySelected",l=>{var u;if(this.currentStrategyIndex===l)return;this.currentStrategyIndex=l;let c=this.strategies[l];if(this.activePlacement=(u=c?.name)!=null?u:this.activePlacement,c){c.onStrategySelected();let h=this.style;this.style=this.newStyle,this.newStyle=h}}),S(this,"packedMessage",{x:0,y:0,enabled:!1,rank:0,bboxes:[],shouldCollideWithScreenEdges:!1,lockedToStrategyIndex:-1});var i,a,o;if(this.id=(i=r.id)!=null?i:Wn(),this.options=r??{},this.text=e,this.dp=(l=1)=>l*n.pixelRatio,typeof r.rank=="string")this.rank=Rk(r.rank),this.initialRank=this.rank;else if(r.rank!=null&&r.rank>0)this.rank=r.rank,this.initialRank=r.rank;else{let l=Math.trunc(Oi.env.NODE_ENV==="test"?e2.testId:e2.testId*10)/10;e2.testId+=.001,this.rank=l,this.initialRank=l}this.options.textPlacement=(a=r.textPlacement)!=null?a:z3;let s=nq((o=r.appearance)!=null?o:{});this.appearance=s,this.iconPadding=s.iconPadding}get scaledPinSize(){return this.totalPinSize*this.iconScale}get scaledIconPadding(){return this.appearance.iconPadding*this.iconScale}calculatePinSize(){let e=this.dp();this.iconVisible&&typeof this.appearance.iconSize<"u"&&this.imageHash?this.pinSize=this.dp(this.appearance.iconSize):this.pinSize=this.dp(aq),this.totalPinSize=Math.ceil((this.pinSize+2.5)/e)}getNoTextBbox(e){let r=this.scaledPinSize/2+e;return[r,r,r,r]}getHiddenTextPlacementBbox(e){return this.iconVisible?this.getNoTextBbox(e):z8}getBoundingBoxForPlacement(e){let{width:r,height:n}=this.dimensions,{margin:i}=this.appearance,a=Math.max(qTe,i);if(this.text==="")return this.getNoTextBbox(a);let o=Math.max(this.scaledPinSize,n);switch(e){case na.RIGHT:return[o/2+a,o/2+a,this.scaledPinSize/2+a,this.scaledPinSize/2+r+a];case na.LEFT:return[o/2+a,o/2+a,this.scaledPinSize/2+r+a,this.scaledPinSize/2+a];case na.TOP:{let s=this.dp();return[n+this.scaledPinSize/2/s+a,this.scaledPinSize/2+a,r/2+a,r/2+a]}case na.CENTER:return[n/2+a,n/2+a,r/2+a,r/2+a];case na.HIDDEN:return this.getHiddenTextPlacementBbox(a);case Cf:return z8;default:return this.getNoTextBbox(a)}}getStrategyStyleForPlacement(e){let{width:r,height:n}=this.dimensions;switch(e){case na.TOP:this.newStyle.pinVisibility=1,this.newStyle.textAlign="center",this.newStyle.textLabelVisible=!0,this.newStyle.top=-n-this.scaledPinSize/2,this.newStyle.left=-r/2;return;case na.LEFT:this.newStyle.textAlign="right",this.newStyle.pinVisibility=1,this.newStyle.top=-n/2,this.newStyle.left=-r-this.scaledPinSize/2-B8,this.newStyle.textLabelVisible=!0;return;case na.RIGHT:this.newStyle.textAlign="left",this.newStyle.pinVisibility=1,this.newStyle.top=-n/2,this.newStyle.left=this.scaledPinSize/2+B8,this.newStyle.textLabelVisible=!0;return;case na.CENTER:this.newStyle.pinVisibility=0,this.newStyle.textAlign="center",this.newStyle.textLabelVisible=!0,this.newStyle.top=-n/2,this.newStyle.left=-r/2;return;case na.HIDDEN:this.newStyle.pinVisibility=this.iconVisible?1:.5,this.newStyle.textLabelVisible=!1,this.newStyle.top=0,this.newStyle.left=0;return;case Cf:default:this.newStyle.pinVisibility=.5,this.newStyle.textLabelVisible=!1,this.newStyle.top=0,this.newStyle.left=0;return}}get strategies(){let e=Array.isArray(this.options.textPlacement)?this.options.textPlacement:[this.options.textPlacement],r=[],n=!1;for(let i of e)this.options.rank==="always-visible"&&i===na.HIDDEN&&e.length>1||(r.push({name:i,getBoundingBox:()=>this.getBoundingBoxForPlacement(i),onStrategySelected:()=>this.getStrategyStyleForPlacement(i)}),i===na.HIDDEN&&(n=!0));return n&&r.push({name:Cf,getBoundingBox:()=>this.getBoundingBoxForPlacement(Cf),onStrategySelected:()=>this.getStrategyStyleForPlacement(Cf)}),r}recomputeCurrentStrategy(e=this.iconScale){let r=this.iconScale!==e;if(r||this.dirty){let n=this.pinDirty,i=this.strategies[this.currentStrategyIndex];if(this.iconScale=e,this.collisionDirty=!0,r&&!n&&this.calculatePinSize(),i){i.onStrategySelected();let a=this.style;this.style=this.newStyle,this.newStyle=a}this.dirty=!1}}toPackedMessage(e=!1){var r;let n=this.strategies[this.currentStrategyIndex],i=this.currentStrategyIndex!=null&&this.currentStrategyIndex!==-1&&this.text!==""&&n!=null&&n.name!==na.HIDDEN&&n.name!==Cf;if(this.visible&&e&&this.collisionDirty===!1&&i?this.packedMessage.lockedToStrategyIndex=this.currentStrategyIndex:this.packedMessage.lockedToStrategyIndex=-1,this.packedMessage.x=this.projection.x,this.packedMessage.y=this.projection.y,this.packedMessage.enabled=this.enabled,this.packedMessage.rank=this.rank,i&&this.currentStrategyIndex!==((r=this.packedMessage.bboxes[0])==null?void 0:r[4])){let a=this.packedMessage.bboxes.findIndex(o=>o[4]===this.currentStrategyIndex);if(a!==-1){let o=this.packedMessage.bboxes.splice(a,1)[0];this.packedMessage.bboxes.unshift(o)}}if(!this.collisionDirty)return this.packedMessage;this.packedMessage.bboxes=[];for(let a=0;a<this.strategies.length;a++){let o=this.strategies[a].getBoundingBox(),s=[o[0],o[1],o[2],o[3],a];i&&a===this.currentStrategyIndex?this.packedMessage.bboxes.unshift(s):this.packedMessage.bboxes.push(s)}return this.packedMessage.shouldCollideWithScreenEdges=!1,this.collisionDirty=!1,this.packedMessage}destroy(){}};S(oq,"testId",0);var YTe=oq,yp=YTe;C();var JTe=Zt(vG());C();var KTe="0.6",Qn={TOP:"top",BOTTOM:"bottom",LEFT:"left",RIGHT:"right",CENTER:"center",TOP_LEFT:"top-left",TOP_RIGHT:"top-right",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",HIDDEN:"hidden"},U4=Object.values(Qn),QTe=[Qn.CENTER,Qn.HIDDEN],e6e=Object.freeze({size:8,color:"#666"}),sq=Nr({rank:zi([Pa(["low","medium","high","always-visible"]),pt()]).optional(),interactive:zi([Lr(),$i("pointer-events-auto")]).optional(),id:mr().optional(),placement:zi([Pa(U4),bo(Pa(U4))]).optional(),dynamicResize:Lr().optional(),zIndex:pt().optional(),lowPriorityPin:Nr({size:pt().positive().optional(),color:mr().optional()}).optional()});function t6e(t,e,r){bo(pt()).min(2).max(3).parse(t),mr().parse(e),sq.parse(r)}var lq=class t2{constructor(e,r={}){S(this,"id"),S(this,"type","marker"),S(this,"rank",0),S(this,"initialRank",0),S(this,"activePlacement","center"),S(this,"pointerEvents","none"),S(this,"options",{rank:"low",interactive:!1,id:"",placement:QTe,dynamicResize:!1,occluderId:0,zIndex:void 0,verticalOffset:0,lowPriorityPin:ae({},e6e)}),S(this,"projection",new Je),S(this,"enabled",!0),S(this,"canShow",!1),S(this,"visible",!0),S(this,"isOccluded",!1),S(this,"offscreen",!1),S(this,"strategyIndex",-1),S(this,"activeBoundingBox",{x:0,y:0,w:0,h:0}),S(this,"dimensions",{width:0,height:0}),S(this,"markerContainer"),S(this,"containerEl"),S(this,"contentEl",null),S(this,"contentHtml",""),S(this,"style",{top:"0px",left:"0px"}),S(this,"dirty",!1),S(this,"attachedDirty",!0),S(this,"collisionDirty",!0),S(this,"visibilityNeedsUpdate","show"),S(this,"animation",null),S(this,"currentStrategyIndex",-1),S(this,"onStrategySelected",(s,l=!1)=>{var u;if(this.currentStrategyIndex===s&&!l)return;this.currentStrategyIndex=s;let c=this.strategies[s];if(this.activePlacement=(u=c?.name)!=null?u:"center",this.activePlacement===Qn.HIDDEN){this.markerContainer.setAttribute("data-placement",Qn.HIDDEN);let h=this.options.lowPriorityPin,d=h.size,p=h.color;this.markerContainer.style.setProperty("--mappedin-pin-size","".concat(d,"px")),this.markerContainer.style.setProperty("--pin-color",p),this.markerContainer.style.opacity=KTe,this.style.top=-d/2+"px",this.style.left=-d/2+"px"}else{this.markerContainer.setAttribute("data-placement",this.activePlacement),this.markerContainer.style.removeProperty("--mappedin-pin-size"),this.markerContainer.style.removeProperty("--pin-color"),this.markerContainer.style.opacity="1";let{width:h,height:d}=this.dimensions,p=-d/2+"px",m=-h/2+"px";switch(this.style.top=p,this.style.left=m,this.activePlacement){case Qn.TOP:{this.style.top=-d+"px";break}case Qn.BOTTOM:{this.style.top="0px";break}case Qn.LEFT:{this.style.left=-h+"px";break}case Qn.RIGHT:{this.style.left="0px";break}case Qn.TOP_LEFT:{this.style.top=-d+"px",this.style.left=-h+"px";break}case Qn.TOP_RIGHT:{this.style.top=-d+"px",this.style.left="0px";break}case Qn.BOTTOM_LEFT:{this.style.top="0px",this.style.left=-h+"px";break}case Qn.BOTTOM_RIGHT:{this.style.top="0px",this.style.left="0px";break}case Qn.CENTER:default:this.style.top=p,this.style.left=m}}this.markerContainer.style.top=this.style.top,this.markerContainer.style.left=this.style.left}),S(this,"packedMessage",{x:0,y:0,enabled:!1,rank:0,bboxes:[],lockedToStrategyIndex:-1,shouldCollideWithScreenEdges:!1});var n,i,a,o;if(this.id=r?.id||Wn(),this.options=(0,JTe.default)(this.options,r),this.options.placement=(n=r.placement)!=null?n:this.options.placement,typeof r.rank=="string")this.rank=Rk(r.rank);else if(r.rank!=null&&r.rank>0)this.rank=r.rank;else{let s=Math.trunc(Oi.env.NODE_ENV==="test"?t2.testId:t2.testId*10)/10;t2.testId+=.001,this.rank=s}typeof r.interactive=="string"&&(this.pointerEvents=r.interactive==="pointer-events-auto"?"auto":"none"),this.contentHtml=e,this.initialRank=this.rank,this.markerContainer=document.createElement("div"),this.markerContainer.className="mappedin-marker",this.markerContainer.style.opacity="0",this.markerContainer.innerHTML='<div class="mappedin-marker-content">'.concat(this.contentHtml,"</div>"),this.markerContainer.setAttribute("data-marker-id",this.id.toString()),this.containerEl=(i=this.markerContainer.firstElementChild)!=null?i:null,this.contentEl=(o=(a=this.markerContainer.firstElementChild)==null?void 0:a.firstElementChild)!=null?o:null}updateDimensionsIfZeroWidthHeight(e,r){this.dimensions.width===0&&this.dimensions.height===0&&this.updateDimensions(e,r)}updateDimensions(e,r){if(e!=null&&r!=null)this.dimensions={width:e,height:r};else{let{width:n,height:i}=this.markerContainer.getBoundingClientRect();this.dimensions={width:n,height:i}}Object.assign(this.markerContainer,{width:this.dimensions.width+"px",height:this.dimensions.height+"px"}),this.currentStrategyIndex=-1}get strategies(){let{width:e,height:r}=this.dimensions;if(e===0||r===0)return[];let n=Array.isArray(this.options.placement)?this.options.placement:[this.options.placement],i=[];for(let a of n)this.options.rank==="always-visible"&&a===Qn.HIDDEN&&n.length>1||i.push({name:a,getBoundingBox:()=>{let o=r/2,s=r/2,l=e/2,u=e/2;switch(a){case Qn.TOP:{o=r,s=0;break}case Qn.BOTTOM:{o=0,s=r;break}case Qn.LEFT:{l=e,u=0;break}case Qn.RIGHT:{l=0,u=e;break}case Qn.TOP_LEFT:{o=r,l=e,s=0,u=0;break}case Qn.TOP_RIGHT:{o=r,u=e,s=0,l=0;break}case Qn.BOTTOM_LEFT:{s=r,l=e,o=0,u=0;break}case Qn.BOTTOM_RIGHT:{s=r,u=e,o=0,l=0;break}case Qn.HIDDEN:let c=Math.max(2,4/2);return[this.options.lowPriorityPin.size/2+c,this.options.lowPriorityPin.size/2+c,this.options.lowPriorityPin.size/2+c,this.options.lowPriorityPin.size/2+c]}return[o+4,s+4,l+4,u+4]}});return i}toPackedMessage(e=!1){var r;this.packedMessage.x=this.projection.x,this.packedMessage.y=this.projection.y,this.packedMessage.enabled=this.enabled,this.packedMessage.rank=this.rank,this.packedMessage.shouldCollideWithScreenEdges=!0;let n=this.currentStrategyIndex!==-1&&this.currentStrategyIndex!==this.lowPriorityPinStrategyIndex;if(this.visible&&e&&n&&this.collisionDirty===!1?this.packedMessage.lockedToStrategyIndex=this.currentStrategyIndex:this.packedMessage.lockedToStrategyIndex=-1,n&&this.currentStrategyIndex!==((r=this.packedMessage.bboxes[0])==null?void 0:r[4])){let i=this.packedMessage.bboxes.findIndex(a=>a[4]===this.currentStrategyIndex);if(i!==-1){let a=this.packedMessage.bboxes.splice(i,1)[0];this.packedMessage.bboxes.unshift(a)}}if(!this.collisionDirty)return this.packedMessage;this.packedMessage.bboxes=[];for(let i=0;i<this.strategies.length;i++){let a=this.strategies[i];i===this.currentStrategyIndex&&n?this.packedMessage.bboxes.unshift([...a.getBoundingBox(),i]):this.packedMessage.bboxes.push([...a.getBoundingBox(),i])}return this.collisionDirty=!1,this.packedMessage}get lowPriorityPinStrategyIndex(){return this.options.rank==="always-visible"?-1:this.strategies.findIndex(e=>e.name===Qn.HIDDEN)}destroy(){}};S(lq,"testId",0);var Um=lq;C();var _0=class extends Yn{constructor(){super(...arguments),S(this,"type","geometry"),S(this,"userData",{entityId:"",type:"geometry"})}raycast(e,r){this.userData.type==="model"&&this.children[0]&&e.intersectObject(this.children[0],!0).forEach(n=>{r.push(n)})}},Cn=class{constructor(e,r){S(this,"id",Wn()),S(this,"components"),S(this,"parentId"),S(this,"entities2D",new Map),this.components=[e,r]}getComponent(e){return this.components.find(r=>r?.type===e)}get object3d(){return this.components[0].mesh}get parentObject3D(){var e;return(e=this.components[0].mesh)==null?void 0:e.parent}get type(){return this.components[0].type}attach(e){this.parentObject3D instanceof _o?e.object3d.userData.attachedEntityId=this.id:this.entities2D.set(e.id,e)}detach(e){this.parentObject3D instanceof _o&&(e.object3d.userData.parentEntityId=void 0),this.entities2D.delete(e.id)}removeAllEntities(){for(let e of this.entities2D.values())this.detach(e)}};C();var I1=class extends Yn{},Ug=class{constructor(e,r,n=0){S(this,"id"),S(this,"verticalOffset"),S(this,"occluderId"),S(this,"object3d",new I1),S(this,"components"),S(this,"disposed",!1),S(this,"worldPosition",new Q),this.id=e.id||Wn(),this.components=[e],this.verticalOffset=n,this.object3d=new I1,this.object3d.position.set(r.x,r.y,r.z+n),this.object3d.userData.entityId=this.id,this.object3d.userData.type=this.type,this.positionDirty=!0}get type(){return this.components[0].type}get parentObject3D(){return this.object3d.parent}get attachedTo(){return this.object3d.userData.attachedEntityId}getComponent(e){return this.components.find(r=>r?.type===e)}get position(){return this.positionDirty&&(this.object3d.matrixAutoUpdate=!0,this.object3d.getWorldPosition(this.worldPosition),this.positionDirty=!1,this.object3d.matrixAutoUpdate=!1),this.worldPosition}get positionDirty(){return this.object3d.userData.worldPositionDirty}set positionDirty(e){this.object3d.userData.worldPositionDirty=e}updatePosition(e){this.object3d.position.copy(e),this.positionDirty=!0}setAltitude(e){this.object3d.position.z=e,this.positionDirty=!0}};C();C();var r6e=class extends wi{constructor(e,r,n=!0){super(),S(this,"rendererState"),S(this,"convertTo3DMapPosition"),S(this,"textSet",new Set),S(this,"batchedTextMap",new Map),S(this,"useWorker",!0),S(this,"debugTextAreaMesh",new Map),n===!1&&(this.useWorker=!1,n6e(!1)),this.rendererState=e,this.convertTo3DMapPosition=r}remove(e){this.textSet.delete(e)}update(e){var r,n,i;let a,o,s,l=[];for(let u of this.rendererState.geometry3DIdsInScene)if(a=this.rendererState.geometry3DMap.get(u),a?.type==="text3d"){o=a.components[0],s=a.components[1];let c=(r=o.mesh)==null?void 0:r.parent;if(!c||!(c instanceof ui)||!(o instanceof r2))continue;if("textArea"in o.feature.properties&&o.mesh!=null&&o.polygonEntityId!=null&&o.textMesh==null&&o.mesh.parent!=null&&((i=(n=o.feature.properties)==null?void 0:n.textArea)==null?void 0:i.position)!=null){if(this.textSet.has(o.polygonEntityId))continue;this.textSet.add(o.polygonEntityId),this.batchedTextMap.has(c)||this.batchedTextMap.set(c,C1().then(({BatchedText:p})=>{let m=new p;return m.type="batchedtext",c.add(m),m}));let d=this.batchedTextMap.get(c);if(!d)throw new Error("batched text required");l.push(F8({entityId:u,textComponent:o,styleComponent:s,convertTo3DMapPosition:this.convertTo3DMapPosition,batchedMeshPromise:d,rendererState:this.rendererState,type:"text-area"}).then(()=>{this.publish("render")}))}else if(o.mesh!=null&&o.textMesh==null&&o.mesh.parent!=null){if(this.textSet.has(u.toString()))continue;this.textSet.add(u.toString()),this.batchedTextMap.has(c)||this.batchedTextMap.set(c,C1().then(({BatchedText:p})=>{let m=new p;return m.type="batchedtext",c.add(m),m}));let d=this.batchedTextMap.get(c);if(!d)throw new Error("batched text required");l.push(F8({entityId:u,textComponent:o,styleComponent:s,convertTo3DMapPosition:this.convertTo3DMapPosition,batchedMeshPromise:d,rendererState:this.rendererState,type:"point"}).then(()=>{this.publish("render")}))}let h=this.batchedTextMap.get(c);o.textMesh&&h&&o.polygonEntityId!=null&&Promise.all([h,Promise.resolve({meshComponent:o,styleComponent:s})]).then(([d,{meshComponent:p,styleComponent:m}])=>{let{textMesh:y}=p;if(d&&y){let v=uq(d,y);p.visible&&!v?d.add(y):!p.visible&&v&&d.remove(y)}m.flipToFaceCamera&&this.flipIfNeeded(p,e)})}return Promise.all(l)}flipIfNeeded(e,r){let n=e.textMesh;if(!n)return!1;let i=n.rotation.z,a=bz(i+r);a>Math.PI/2&&a<3*Math.PI/2&&(n.rotation.z=bz(i+Math.PI))}showTextAreaMesh(){let e,r;for(let n of this.rendererState.geometry3DIdsInScene)if(e=this.rendererState.geometry3DMap.get(n),e?.type==="text3d"&&(r=e.components[0],"textArea"in r.feature.properties)){let i=r.feature.properties.textArea;if(!i)continue;let a=new yd(i.maxWidth,i.maxHeight),o=new Er(a,new Go({color:"pink"})),{textMesh:s}=r;if(!s)continue;let l=this.convertTo3DMapPosition(i.position,yy);o.position.copy(l),o.position.z=s.position.z-.1,o.rotation.z=s.rotation.z,iI.identity(),iI.makeRotationAxis(new Q(0,0,1),s.userData.rotationZ),yy.set(i.maxWidth/2,0,0),yy.applyMatrix4(iI),o.position.x-=yy.x,o.position.y-=yy.y,this.rendererState.geometryScene.add(o),this.debugTextAreaMesh.set(n,o)}this.publish("render")}hideTextAreaMesh(){this.debugTextAreaMesh.forEach(e=>{this.rendererState.geometryScene.remove(e)}),this.debugTextAreaMesh.clear(),this.publish("render")}};function n6e(t){C1().then(({configureTroikaTextBuilder:e})=>{e({useWorker:t})})}var iI=new gr,yy=new Q,aI;function C1(){return aI||(aI=N1(()=>import("./text3d-643VYZAG-COLF9LO1.js"),__vite__mapDeps([0,1,2])).then(t=>t)),aI}async function F8({entityId:t,textComponent:e,styleComponent:r,convertTo3DMapPosition:n,batchedMeshPromise:i,rendererState:a,type:o="text-area"}){return Promise.all([C1(),Promise.resolve({entityId:t,meshComponent:e,styleComponent:r})]).then(([{createTroikaTextPoint:s,createTroikaTextArea:l},u])=>o==="text-area"?l(u.entityId,u.meshComponent,u.styleComponent,n):s(u.entityId,u.meshComponent,u.styleComponent,n)).catch(s=>{Be.warn("Trouble creating text: ",s)}).then(s=>{if(!(s!=null&&s.text))return;let l=[Promise.resolve(s.text),i,Promise.resolve()];if(e.polygonEntityId){let u=a.geometry3DMap.get(e.polygonEntityId);if(u?.type==="geometry"){let c=u.components[0],h=u.components[1];c.textMesh=s.text,s.text.position.z=h.altitude+h.height+i6e}}else l[2]=C1().then(({syncText:u})=>u(s.text));return Promise.all(l)}).then(s=>{if(!s)return;let[l,u]=s;u.add(l),e.batchedText||(e.batchedText=u)})}function uq(t,e){return t._members.has(e)}var i6e=.5,cq=Nr({visible:Lr(),color:mr(),flipToFaceCamera:Lr(),font:mr().optional(),fontSize:pt(),margin:zi([pt(),ld([pt(),pt(),pt(),pt()])]),outlineColor:mr(),outlineOpacity:pt(),outlineBlur:zi([pt(),mr()]),outlineWidth:pt(),outlineOffsetX:pt(),outlineOffsetY:pt(),strokeWidth:pt(),maxWidth:pt().optional(),maxHeight:pt().optional(),strokeOpacity:pt(),strokeColor:mr(),fillOpacity:pt(),hoverColor:mr().optional(),id:zi([mr(),pt()]),type:$i("text3d"),position:ld([pt(),pt(),pt()]),content:mr()}),hq=_a(cq.partial().omit({id:!0,type:!0}).shape),dq=_a(hq.omit({margin:!0,position:!0,maxWidth:!0,maxHeight:!0,content:!0}).shape),a6e=_a({appearance:hq.optional(),parentId:mr().optional()}),r2=class{constructor(e){S(this,"mesh",new _0),S(this,"textMesh"),S(this,"type","text3d"),S(this,"feature"),S(this,"parent"),S(this,"batchedText"),S(this,"polygonEntityId"),this.feature=e}get visible(){return this.batchedText&&this.textMesh?uq(this.batchedText,this.textMesh):this.textMesh?this.textMesh.visible:!1}set visible(e){this.batchedText&&this.textMesh?e?this.batchedText.addText(this.textMesh):this.batchedText.removeText(this.textMesh):this.textMesh&&(this.textMesh.visible=e),this.mesh.visible=e}};C();var Gy,pq=class{constructor(e){S(this,"type","outline"),S(this,"color"),S(this,"dirty",!0),S(this,"enabled",!0),K(this,Gy,!1),S(this,"edgeColors"),S(this,"edgeVisibility"),S(this,"geometry"),S(this,"ranges"),S(this,"topFaceVerticesIndices"),this.color=e}get currentOpacity(){return this.edgeColors&&this.ranges?this.edgeColors.array[this.ranges.start*4+3]:0}set visible(e){if(!this.edgeVisibility||!this.ranges||f(this,Gy)===e)return;ne(this,Gy,e);let r=this.edgeVisibility.array,n=e?1:0;for(let i=0;i<this.ranges.count;i++){let a=this.ranges.start+i;r[a]=n}this.edgeVisibility.needsUpdate=!0}get visible(){return f(this,Gy)}get currentColor(){return this.edgeColors&&this.ranges?[this.edgeColors.array[this.ranges.start*4],this.edgeColors.array[this.ranges.start*4+1],this.edgeColors.array[this.ranges.start*4+2]]:[0,0,0]}};Gy=new WeakMap;C();C();C();var o6e=class extends eg{constructor(e){let r=e,n=3,i=n*4;super(new Uint8Array(e*i),n,e,Ha,Fl),S(this,"_width"),S(this,"_height"),S(this,"_propertiesLength"),this._width=i,this._height=r,this._propertiesLength=n}setColor(e,r,n){let i=this.image.data,a=e*this._width;i[a]=Math.round(r.r*255),i[a+1]=Math.round(r.g*255),i[a+2]=Math.round(r.b*255),i[a+3]=0,i[a+4]=Math.round(n.r*255),i[a+5]=Math.round(n.g*255),i[a+6]=Math.round(n.b*255),i[a+7]=0,this.needsUpdate=!0}getColor(e){let r=this.image.data,n=e*this._width,i=new jt(r[n]/255,r[n+1]/255,r[n+2]/255),a=new jt(r[n+4]/255,r[n+5]/255,r[n+6]/255);return{color:i,topColor:a}}setTexture(e,r,n){let i=this.image.data,a=e*this._width;i[a+8]=r?255:0,i[a+9]=n?255:0,i[a+10]=0,i[a+11]=0,this.needsUpdate=!0}getTexture(e){let r=this.image.data,n=e*this._width,i=r[n+8]===255,a=r[n+9]===255;return{texture:i,topTexture:a}}};C();var s6e=`#define LAMBERT
varying vec3 vViewPosition;
varying vec4 vPosition;
varying vec2 vUv;
varying vec4 finalPosition;
varying float vVerticalOffset;
varying vec3 worldNormal;
varying float vBatchId;

#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
	
  // To mitigate visual defects on machines such as windows and iOS
	vBatchId = getIndirectIndex(gl_DrawID) + 0.5;
	vViewPosition = - mvPosition.xyz;
	worldNormal = normal;
	vUv = uv;
  vVerticalOffset = position.z;
}
`;C();var l6e=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
uniform float uGradientEnd;
uniform float uGradientIntensity;
uniform float uMinSideAlpha;
uniform float uMaxSideAlpha;
uniform float uGradientStart;
uniform highp sampler2D uPropertiesTexture;
uniform highp sampler2D uTopTexture;
uniform highp sampler2D uTexture;
uniform float uRepeatYFactor;
uniform bool uBlendTexture;
varying float vBatchId;

varying vec2 vUv;
varying float vVerticalOffset;
varying vec3 worldNormal;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

vec3 blendTextureColor(vec3 diffuseColor, vec4 texColor) {
	vec3 texturedColor = diffuseColor * texColor.rgb;
	return mix(diffuseColor, texturedColor, texColor.a);
}

void main() {
	#include <clipping_planes_fragment>

	// get the normalized world normal of vertex fragment
	vec3 surfaceNormal = normalize(worldNormal);

	// get angle relative to Z up
	float angle = degrees(acos(abs(dot(surfaceNormal, vec3(0.0, 0.0, 1.0)))));

	int idx = int(vBatchId) * 1;
	vec3 diffuse = vec3(texelFetch(uPropertiesTexture, ivec2(0, idx), 0).rgb);
	bool shouldShowTexture = texelFetch(uPropertiesTexture, ivec2(2, idx), 0).r > 0.99;

	if(shouldShowTexture) {
		vec4 tex2d = texture2D(uTexture, vec2(vUv.x, vUv.y * uRepeatYFactor));
		diffuse = uBlendTexture ? blendTextureColor(diffuse, tex2d) : tex2d.rgb;
	}

	// if this is a fragment facing upwards, use topColor. Avoid any sort of '==' comparison, due to floating point precision issue
	if(angle < 0.02) {
		bool shouldShowTopTexture = texelFetch(uPropertiesTexture, ivec2(2, idx), 0).g > 0.99;

		if(shouldShowTopTexture) {
			vec4 topTex2d = texture2D(uTopTexture, vUv);
			diffuse = uBlendTexture ? blendTextureColor(diffuse, topTex2d) : topTex2d.rgb;
		} else {
			diffuse = vec3(texelFetch(uPropertiesTexture, ivec2(1, idx), 0).rgb);
		}
	}

	vec4 diffuseColor = vec4(diffuse, opacity);

	// only for vertical surfaces
	if(angle > 89.0 && angle < 91.0) {

		// get the percentage of the z position from the ground, up
		float percentFromZeroZ = max((abs(vVerticalOffset) - uGradientStart) / uGradientEnd, 0.0);

		// gradient based on percentage
		float alpha = smoothstep(uMinSideAlpha, uMaxSideAlpha, percentFromZeroZ);

		// mix the shadow color with the diffuse color based on the alpha and opacity
		diffuseColor = vec4(mix(diffuseColor.rgb, diffuseColor.rgb * (1.0 - uGradientIntensity), 1.0 - alpha), opacity);
	}

	ReflectedLight reflectedLight = ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0), vec3(0.0));
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;

	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,u6e=-.05,c6e=1,jM=class extends PC{constructor(t,e,r=1){super(t),S(this,"propertiesTexture"),S(this,"texturesVisible",!1),S(this,"uniforms",{uGradientIntensity:{value:0},uGradientEnd:{value:0},uGradientStart:{value:0},uTopTexture:{value:void 0},uTexture:{value:void 0},uRepeatYFactor:{value:1},uBlendTexture:{value:!1}}),S(this,"colorSpace",Za),S(this,"showTextures",n=>{this.texturesVisible=!0;let i=!!this.uniforms.uTexture.value,a=!!this.uniforms.uTopTexture.value;(i||a)&&(this.propertiesTexture.setTexture(n,i,a),this.needsUpdate=!0)}),this.alphaTest=.01,this.propertiesTexture=new o6e(e),this.uniforms.uRepeatYFactor.value=r,this.onBeforeCompile=n=>{let i=this.uniforms.uGradientIntensity,a=this.uniforms.uGradientEnd,o=this.uniforms.uGradientStart,s=this.uniforms.uTopTexture,l=this.uniforms.uTexture,u=this.uniforms.uRepeatYFactor,c=this.uniforms.uBlendTexture;this.uniforms=n.uniforms,n.vertexShader=s6e,n.fragmentShader=l6e,Object.assign(this.uniforms,{uGradientIntensity:i,uGradientEnd:a,uGradientStart:o,uMinSideAlpha:{value:u6e},uMaxSideAlpha:{value:c6e},uPropertiesTexture:{value:this.propertiesTexture},uTopTexture:s,uTexture:l,uRepeatYFactor:u,uBlendTexture:c})}}get repeatYFactor(){return this.uniforms.uRepeatYFactor.value}set repeatYFactor(t){t!==this.uniforms.uRepeatYFactor.value&&(this.uniforms.uRepeatYFactor.value=t,this.needsUpdate=!0)}get texture(){return this.uniforms.uTexture.value}set texture(t){if(t==null){this.uniforms.uTexture.value=null;return}t.wrapS=Ml,t.wrapT=Ml,t.colorSpace=this.colorSpace,this.uniforms.uTexture.value=t}get topTexture(){return this.uniforms.uTopTexture.value}set topTexture(t){if(t==null){this.uniforms.uTopTexture.value=null;return}t.wrapS=Ml,t.wrapT=Ml,t.colorSpace=this.colorSpace,this.uniforms.uTopTexture.value=t}get blendTexture(){return this.uniforms.uBlendTexture.value}set blendTexture(t){t!==this.uniforms.uBlendTexture.value&&(this.uniforms.uBlendTexture.value=t,this.colorSpace=t?Op:Za,this.texture&&(this.texture.colorSpace=this.colorSpace),this.topTexture&&(this.topTexture.colorSpace=this.colorSpace),this.needsUpdate=!0)}setGradientShading(t,e,r){this.uniforms.uGradientStart.value=t,this.uniforms.uGradientEnd.value=e,this.uniforms.uGradientIntensity.value=r}getGradientShading(){return{start:this.uniforms.uGradientStart.value,end:this.uniforms.uGradientEnd.value,intensity:this.uniforms.uGradientIntensity.value}}setColor(t,e,r){this.propertiesTexture.setColor(t,e,r)}getColor(t){return this.propertiesTexture.getColor(t)}hideTextures(t){this.texturesVisible=!1;let e=!!this.uniforms.uTexture.value,r=!!this.uniforms.uTopTexture.value;(e||r)&&(this.propertiesTexture.setTexture(t,!1,!1),this.needsUpdate=!0)}removeSideTexture(t){if(this.texture){this.texture.dispose(),this.uniforms.uTexture.value=null;let e=!!this.uniforms.uTopTexture.value;this.propertiesTexture.setTexture(t,!1,e),this.needsUpdate=!0}}removeTopTexture(t){if(this.topTexture){this.topTexture.dispose(),this.uniforms.uTopTexture.value=null;let e=!!this.uniforms.uTexture.value;this.propertiesTexture.setTexture(t,e,!1),this.needsUpdate=!0}}dispose(){super.dispose(),this.propertiesTexture.dispose()}};C();var fq={top:0,bottom:0,left:0,right:0,type:"pixel"},vy={enabled:!1,thickness:0,size:0,offset:0,segments:3};function VM(t,e){var r,n,i,a,o;return{bevelEnabled:(r=t?.enabled)!=null?r:vy.enabled,bevelThickness:(n=t?.thickness)!=null?n:vy.thickness,bevelSize:(i=t?.size)!=null?i:t?.thickness||vy.size,bevelOffset:(a=t?.offset)!=null?a:vy.offset,bevelSegments:(o=t?.segments)!=null?o:vy.segments,depth:e}}var mq="mappedin",rd={GEOMETRY:0,IMAGE_MESH:1,ALWAYS_ON_TOP_PATHS:10,ALWAYS_ON_TOP_MODELS:11},R8=250;C();function h6e(t,e){var r,n,i;let a=0;for(let d of t)a+=((n=(r=d.components[0])==null?void 0:r.geometry)==null?void 0:n.attributes.position.count)||0;let o=new jt(e.color),s;s=new jM({color:o,side:e.side==="back"?xa:e.side==="front"?_s:po,opacity:(i=e.opacity)!=null?i:1,transparent:e.opacity!==void 0?e.opacity<1:!1,polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1},t.length);let l=new jk(t.length,a,0,s);l.renderOrder=rd.GEOMETRY;let u,c,h;for(let d of t)u=d.components[0],!(!(u instanceof Xa)||!u.geometry)&&(u.mesh=l,u.material=s,u.instanceIndex=l.addGeometry(u.geometry),l.addInstance(u.instanceIndex),l.userData.entities[u.instanceIndex]=d.id,s instanceof jM&&s.setColor(u.instanceIndex,o,e.topColor?new jt(e.topColor):o),c=l.getGeometryIdAt(u.instanceIndex),u.batchedProps&&(h=l.getGeometryRangeAt(c),h&&(u.batchedProps.range=h),u.batchedProps.geometryId=c));return l.perObjectFrustumCulled=!0,l.matrixAutoUpdate=!1,l}function Nk(t){return Vt(t).darken(30).toRgbString()}function d6e(t,e,r,n){if(e.length<1)return;t.boundingBox||t.computeBoundingBox();let i=t.boundingBox,a=t.getAttribute("position"),o=t.getAttribute("normal"),s=t.getAttribute("uv"),l,u;t.index?(l=t.index.count/3,u=function(b,A){return t.index.getX(b*3+A)}):(l=a.count/3,u=function(b,A){return b*3+A});let c=new gr;c.makeRotationFromQuaternion(new Iu().setFromEuler(new Vo(0,0,r/180*Math.PI)));let h=e.find(b=>b.face==="top"),d;h&&(d={min:n(h.bounds[1],h.bounds[0],0),max:n(h.bounds[3],h.bounds[2],i.max.z)});let p=e.find(b=>b.face==="side"),m;if(p&&(m={min:n(p.bounds[1],p.bounds[0],0),max:n(p.bounds[3],p.bounds[2],i.max.z)}),!(!m&&!d))for(let b=0;b<l;++b){let A=o.getX(u(b,0))+o.getX(u(b,1))+o.getX(u(b,2)),E=o.getY(u(b,0))+o.getY(u(b,1))+o.getY(u(b,2)),M=o.getZ(u(b,0))+o.getZ(u(b,1))+o.getZ(u(b,2)),P=Math.abs(A),k=Math.abs(E),D=Math.abs(M);var y,v;P<=k&&P<=D?(y="x",k<=D?v="y":v="z"):k<=P&&k<=D?(y="y",P<=D?v="x":v="z"):(y="z",P<=k?v="x":v="y"),y==="z"&&(y=v,v="z");let O,B,L,R,T,N;if(v==="z"||y==="z"){if(!p||!m)continue;O=p.repeat.u,B=p.repeat.v,L=p.offset.u,R=p.offset.v,T=p.rotation,N=m}else{if(!h||!d)continue;O=h.repeat.u,B=h.repeat.v,L=h.offset.u,R=h.offset.v,T=(360-r+h.rotation)%360,N=d}let{min:$,max:V}=N,G=new Yn;G.position.set($.x,$.y,0),G.updateMatrix(),G.updateMatrixWorld();let ee=$.clone().applyMatrix4(c),ie=V.clone().applyMatrix4(c),me=Math.abs(ie.x-ee.x),Me=Math.abs(ie.y-ee.y),Ae=new Q(me,Me,V.z).applyMatrix4(G.matrixWorld),le=Math.abs(Ae[y]-$[y]),_e=Math.abs(Ae[v]-$[v]),Le=T*Math.PI/180||0,Se=Math.cos(Le),Ue=Math.sin(Le),Y=G.matrixWorld.clone().invert(),we=new Iu().setFromEuler(new Vo(0,0,r/180*Math.PI));for(let q=0;q<3;q++){let oe=new Q(a.getX(u(b,q)),a.getY(u(b,q)),a.getZ(u(b,q))).applyMatrix4(Y);oe.applyQuaternion(we);let ce=oe.applyMatrix4(G.matrixWorld),X=ce.x,ke=ce.y,Ce=ce.z;var _,w;y==="x"?_=O*(X-$[y])/le+L:y==="y"?_=O*(ke-$[y])/le+L:_=O*(Ce-$[y])/le+L,v==="x"?w=B*(X-$[v])/_e+R:v==="y"?w=B*(ke-$[v])/_e+R:w=B*(Ce-$[v])/_e+R,_-=.5,w-=.5;let Ee=_*Se-w*Ue+.5,Ne=_*Ue+w*Se+.5;s.setX(u(b,q),Ee),s.setY(u(b,q),Ne)}}}C();var j4=class{constructor(){S(this,"type","focusable"),S(this,"focusMesh"),S(this,"dirty",!0)}};C();var M1=class{constructor(e,r){S(this,"type","texture"),S(this,"texture"),S(this,"topTexture"),S(this,"showTexture",!0),S(this,"showTopTexture",!0),S(this,"textureInstance"),S(this,"topTextureInstance"),S(this,"dirty",!0),this.texture=typeof e=="string"?{path:e}:e,this.topTexture=typeof r=="string"?{path:r}:r}};C();var p6e=class{constructor(){S(this,"type","border"),S(this,"dirty",!0),S(this,"needsRebuild",!1),S(this,"mesh")}set visible(e){this.mesh&&(this.mesh.visible=e)}get visible(){return this.mesh?this.mesh.visible:!1}};C();var gq=class{constructor(){S(this,"type","clippingPlane"),S(this,"dirty",!0),S(this,"needsRebuild",!1),S(this,"verticalOffset",1/0),S(this,"plane"),S(this,"holeFillMesh"),S(this,"topColor"),S(this,"topVisible",!0)}};function ja(t,e,r){if(e!==void 0){if(t.type==="model"||t.type==="path"||t.type==="marker"||t.type==="label"||t.type==="geometry"||t.type==="group-container"||t.type==="custom-geometry")return e===!0?(t instanceof Ug&&t.components[1]===void 0?(t.components[1]=new nI,t.components[1].dirty=!0):t instanceof Cn&&t.components[2]===void 0?(t.components[2]=new nI,t.components[2].dirty=!0):t instanceof ui&&t.components[0]===void 0&&(t.components[0]=new nI,t.components[0].dirty=!0),!0):(t instanceof Ug?t.components[1]=void 0:t instanceof Cn?t.components[2]=void 0:t instanceof ui&&(t.components[0]=void 0),!0);if(t.type==="geometry-group"){let n;for(let i of t.userData.entities3D.values())n=r.geometry3DMap.get(i),ja(n,e,r);return!0}}return!1}function f6e(t,e,r){if(!(!(r!=null&&r.color)&&!("topColor"in r))){if(r!==void 0&&t.type==="geometry-group"){let n;for(let i of t.userData.entities3D.values())n=e.geometry3DMap.get(i),n&&$k(n,r);return!0}return!1}}function m6e(t,e){e!==void 0&&t.type==="geometry"&&(t.components[1].shading=e,t.components[1].dirty=!0)}function g6e(t,e,r){if(r!==void 0&&t.type==="geometry-group"){for(let n of t.userData.entities3D.values()){let i=e.geometry3DMap.get(n);i&&m6e(i,r)}return!0}return!1}function y6e(t,e){e!==void 0&&t.type==="geometry"&&(e.showImage!==void 0&&(t.components[1].showImage=e.showImage),e.flipImageToFaceCamera!==void 0&&(t.components[1].flipImageToFaceCamera=e.flipImageToFaceCamera))}function GM(t,e,r){if(r!==void 0){if(t.type==="geometry"){let n=t.components[1];if(n.height!==r)return n.height=r,n.dirty=!0,t.components[3]&&(t.components[3].dirty=!0),t.components[5]&&(t.components[5].needsRebuild=!0,t.components[5].dirty=!0),!0}else if(t.type==="geometry-group"){for(let n of t.userData.entities3D.values()){let i=e.geometry3DMap.get(n);(i?.type==="geometry"||i?.type==="model")&&GM(i,e,r)}return!0}}return!1}function $k(t,e){if(e!==void 0){let r=!1;(t.type==="path"||t.type==="geometry")&&(e.initialColor!==void 0&&e.initialColor!==t.components[1].initialColor&&(t.components[1].initialColor=e.initialColor,r=!0),e.color!==void 0&&e.color!==t.components[1].color&&(t.components[1].color=e.color,r=!0,t.components[3]&&(t.components[3].color=Nk(e.color),t.components[3].dirty=!0)),"topColor"in e&&(t.components[1].topColor=e.topColor,r=!0),r&&(t.components[1].dirty=!0))}}function L8(t,e,r){e!==void 0&&(t.type==="label"||t.type==="marker"?t.updatePosition(r(e[1],e[0],e[2]||0)):t.type==="custom-geometry"&&t.components[0].position.copy(r(e[1],e[0],e[2]||0)))}function N8(t,e){var r;return e!==void 0&&(t.type==="marker"||t.type==="label"||t.type==="custom-geometry")&&t.parentObject3D!==e&&t.parentObject3D instanceof ui?((r=t.parentObject3D)==null||r.removeEntity(t),e.addEntity(t),!0):!1}function oI(t,e){e!==void 0&&(t.type==="marker"||t.type==="label")&&t.components[0].enabled!==e&&(t.components[0].enabled=e)}function v6e(t,e,r){if(e!==void 0&&t.type==="marker"){let n=t.components[0];if(e.contentHTML!==void 0)return n.containerEl.innerHTML=e.contentHTML,n.contentHtml=e.contentHTML,!0;if(vq(t,e.placement)&&(n.collisionDirty=!0),e.dynamicResize!==void 0)return n.options.dynamicResize=e.dynamicResize,!0;if(e.options!=null){try{sq.parse(e.options||{})}catch(i){return Be.error(i),!1}return e.options.interactive!=null&&(e.options.interactive==="pointer-events-auto"?(n.pointerEvents="auto",ja(t,!1,r)):(n.pointerEvents="none",ja(t,e.options.interactive,r))),yq(t,e.options.rank),!0}}return!1}function yq(t,e){return e!==void 0&&(t.type==="marker"||t.type==="label")?(t.components[0].rank=Rk(e),!0):!1}function _6e(t,e){var r;if(((r=e?.options)==null?void 0:r.appearance)==null)return;let n=e.options.appearance||{},i=n.opacity!=null&&n.opacity!==t.appearance.opacity,a=n.iconScale!=null&&n.iconScale!==t.appearance.iconScale&&typeof n.iconScale=="number"&&Number.isFinite(n.iconScale);i&&(n.opacity=YM(n.opacity)),a&&(n.iconScale=YM(n.iconScale)),kq(t.appearance,n),i&&t.canShow&&t.visibilityNeedsUpdate!=="hide"&&(t.visibilityNeedsUpdate="show")}function x6e(t,e,r){var n,i,a,o,s;if(e!==void 0&&t.type==="label"){let l=t.components[0];e.text!==void 0&&e.text!==l.text&&(l.text=e.text,l.textDirty=!0),HTe(l.appearance,((n=e.options)==null?void 0:n.appearance)||{})&&(l.textDirty=!0),XTe(l.appearance,((i=e.options)==null?void 0:i.appearance)||{})&&(l.pinDirty=!0),_6e(l,e),vq(t,(a=e.options)==null?void 0:a.textPlacement)&&(l.currentStrategyIndex=-1,l.collisionDirty=!0),ja(t,(o=e.options)==null?void 0:o.interactive,r),yq(t,(s=e.options)==null?void 0:s.rank)}}function vq(t,e){if(e!==void 0){if(t.type==="label"){let r=t.components[0];return r.options.textPlacement=e,!0}else if(t.type==="marker"){let r=t.components[0];return r.options.placement=e,!0}}return!1}function b6e(t,e){e!==void 0&&t.type==="geometry"&&(t.components[1].hoverColor=e,t.components[1].dirty=!0)}function w6e(t,e){if(e!==void 0){let r=t.components[2];if(t.type==="geometry"&&r!=null)return r.hover=e,r.dirty=!0,!0}return!1}function $8(t,e){e!==void 0&&t.type==="image"&&(t.components[1].flipImageToFaceCamera=e)}function A6e(t,e){e!==void 0&&t.type==="geometry"&&(t.components[1].enableImageCollisions=e)}function _c(t,e,r){if(r!==void 0)if(t.type==="model"||t.type==="path"||t.type==="geometry"||t.type==="custom-geometry"||t.type==="image"||t.type==="text3d"){r!==t.components[1].visible&&(t.components[1].visible=r,t.components[1].dirty=!0);let n=t.components[3];return n&&(n.dirty=!0),!0}else{if(t.type==="geometry-group")return t.setVisible(r),!0;if(t.type==="group-container"){if(t.visible!==r)return t.setVisible(r),r===!1&&t.traverse(n=>{if(n instanceof I1){let i=e.geometry2DMap.get(n.userData.entityId);if(i){let a=i.components[0];a instanceof yp&&(a.canShow=r)}}}),!0}else if(t.type==="label")return t.components[0].visible=r,!0}return!1}function n2(t,e,r){if(r!==void 0)if(t.type==="geometry-group"){for(let n of t.userData.entities3D.values()){let i=e.geometry3DMap.get(n);(i?.type==="geometry"||i?.type==="model")&&n2(i,e,r)}return!0}else if(t.type==="group-container"){if(t.opacity!==r){t.setOpacity(r);let n=1;return t.parent instanceof ui&&(n=t.parent.opacity),_q(t,e,n),!0}}else t instanceof Cn&&t.components[1].opacity!==r&&(t.components[1].opacity=r,t.components[1].dirty=!0);return!1}function _q(t,e,r=1){if(t.type==="group-container"&&"children"in t&&t.children.length>0){let n=r*t.opacity;t.userData.computedOpacity=n;for(let i of t.children)(i instanceof _o&&i.type==="geometry-group"||i instanceof ui&&i.type==="group-container")&&_q(i,e,n)}else if(t.type==="geometry-group")for(let n of t.userData.entities3D.values()){let i=e.geometry3DMap.get(n),a;(i?.type==="geometry"||i?.type==="model")&&(a=i.components[1],a.dirty=!0)}}function U8(t,e,r){let n=!1;if(r!==void 0){if(t.type==="geometry-group")for(let i of t.userData.entities3D.values()){let a=e.geometry3DMap.get(i);a&&xq(a,r)}return!0}return n}function xq(t,e){if(t.type==="geometry"&&(e?.texture!=null||e?.topTexture!=null)){let r=!1,n=t.components[6];if(n==null?(t.components[6]=new M1(e?.texture,e?.topTexture),r=!0):(e?.texture!=null&&n?.texture!==e?.texture&&(n.texture=typeof e.texture=="string"?{path:e.texture}:e.texture,r=!0,n.dirty=!0),e?.topTexture!=null&&n?.topTexture!==e?.topTexture&&(n.topTexture=typeof e.topTexture=="string"?{path:e.topTexture}:e.topTexture,r=!0,n.dirty=!0)),r&&t.components[0]instanceof Xa){let i=t.components[0];return i.detached===!1&&(i.shouldDetach=!0,i.dirty=!0),!0}}return!1}function S6e(t,e){if(e!==void 0&&t.type==="geometry"){let r=t.components[1];if(r.opacity!==e){r.opacity=e;let n=t.components[0],i=t.components[3];i&&(i.dirty=!0),n.detached===!1&&(n.shouldDetach=!0,n.dirty=!0),r.dirty=!0;let a=t.parentObject3D;return a?.type==="geometry-group"&&(a.userData.shadingDirty=!0),!0}}return!1}function Wf(t,e,r){if(r!==void 0)if(t.type==="geometry"||t.type==="path"||t.type==="custom-geometry"){let n=t.components[1];if(n.altitude!==r)return n.altitude=r,n.dirty=!0,t.components[3]&&(t.components[3].dirty=!0),t.components[5]&&(t.components[5].needsRebuild=!0,t.components[5].dirty=!0),!0}else{if(t.type==="group-container"&&t.altitude!==r)return t.setAltitude(r),!0;if(t.type==="geometry-group"){let n;for(let i of t.userData.entities3D.values())n=e.geometry3DMap.get(i),n&&Wf(n,e,r)}}return!1}function ZM(t,e,r){if(r!==void 0){if(t.type==="geometry-group")for(let n of t.userData.entities3D.values()){let i=e.geometry3DMap.get(n);i instanceof Cn&&ZM(i,e,r)}else if(t.type==="geometry"){let n=t.components[3],i=t.components[1];!n&&r===!0?t.components[3]=new pq(Nk(i.color)):n&&(n.enabled=r,n.dirty=!0)}return!0}return!1}function sI(t,e){if(e!==void 0){let r,n=4;if(t.type==="geometry"?(r=t.components[4],n=4):t.type==="group-container"&&(r=t.components[1],n=1),e===!0&&r==null)return t.components[n]=new j4,!0;if(e===!1&&r!=null)return t.components[n]=void 0,!0}return!1}function E6e(t,e){if(e!==void 0&&t.type==="geometry"){let r=t.components[1];if(r.renderOrder!==e){r.renderOrder=e;let n=t.components[0];return n.detached===!1&&(n.shouldDetach=!0,n.dirty=!0),n.imageMesh&&(n.imageMesh.renderOrder=e+1),r.dirty=!0,!0}}return!1}function WM(t,e,r){if(r!=null){if(t.type==="geometry"){let n=t.components[1];n.side!==r&&(n.side=r,n.dirty=!0)}else if(t.type==="geometry-group")for(let n of t.userData.entities3D.values()){let i=e.geometry3DMap.get(n);i instanceof Cn&&WM(i,e,r)}}}function I6e(t,e){if(e!==void 0&&t.type==="geometry"){let r=t.components[1],n;if(n=t.components[5],e.borderVisible!==r.borderVisible&&e.borderVisible!=null){if(e.borderVisible===!0){if(n==null){let i=new p6e;t.components[5]=i,n=t.components[5]}n.visible=!0,n.dirty=!0}else e.borderVisible===!1&&n!=null&&(n.visible=!1,n.dirty=!0);r.borderVisible=e.borderVisible}r.borderColor!==e.borderColor&&e.borderColor!=null&&(r.borderColor=e.borderColor,n&&(n.dirty=!0)),r.borderWidth!==e.borderWidth&&e.borderWidth!=null&&(r.borderWidth=e.borderWidth,n&&(n.needsRebuild=!0))}}function C6e(t,e,r){let{visible:n,color:i}=r;if(t.type!=="path")return;let a=t.components[0];n!=null&&_c(t,e,n),i!=null&&$k(t,{color:i}),Object.assign(a,bq(r)),iPe(r)||(a.materialDirty=!0,r.width!=null&&(a.dirty=!0))}function bq(t){return Vk(t,M6e)}var M6e=["animateArrowsOnPath","displayArrowsOnPath","width","accentColor","completeFraction","highlightCompleteFraction","highlightStartFraction","highlightEndFraction","highlightColor","highlightWidthMultiplier","dashed","visibleThroughGeometry"];function T6e(t){if(!(t instanceof Cn&&t.type==="text3d"))throw new Error("expect target is TextGeometry3D")}var P6e=["visible","color","strokeWidth","outlineOffsetX","outlineOffsetY","outlineWidth","outlineBlur","outlineOpacity","outlineColor","strokeWidth","strokeColor","strokeOpacity","maxWidth","maxHeight","font","hoverColor","fillOpacity","fontSize","flipToFaceCamera"];function D6e(t,e,r){_c(t,e,r.visible);let n=t.components[1],i=Vk(r,P6e);"margin"in r&&Be.warn("update to margin is not supported atm"),"content"in r&&Be.warn("content update is not supported atm");try{dq.parse(i)}catch(a){Be.error(a);return}Object.keys(i).length>0&&(Object.assign(n,i),n.dirty=!0)}var k6e=["color","material","opacity","verticalOffset","rotation","position","scale"];function O6e(t,e){let r=Vk(e,k6e),n=t.components[1],i=t.components[0];Object.keys(r).length>0&&(r.material&&(n.material=r.material),r.opacity!=null&&(n.opacity=r.opacity),r.verticalOffset!=null&&(n.verticalOffset=r.verticalOffset),r.color!=null&&(n.color=r.color),r.position!=null&&(i.feature.geometry.coordinates=r.position,i.positionDirty=!0),r.rotation!=null&&(n.rotation=r.rotation),r.scale!=null&&(n.scale=r.scale),r.visibleThroughGeometry!=null&&(i.visibleThroughGeometry=r.visibleThroughGeometry),n.dirty=!0)}function B6e(t,e){if(e!==void 0&&t.type==="model"){let r=t.components[7];r==null&&(t.components[7]=new gq,r=t.components[7]),r=t.components[7],e.clippingPlaneZOffset!=null&&r.verticalOffset!==e.clippingPlaneZOffset&&(r.verticalOffset=e.clippingPlaneZOffset,r.dirty=!0),e.clippingPlaneTopColor!=null&&r.topColor!==e.clippingPlaneTopColor&&(r.topColor=e.clippingPlaneTopColor,r.dirty=!0),e.clippingPlaneTopVisible!=null&&r.topVisible!==e.clippingPlaneTopVisible&&(r.topVisible=e.clippingPlaneTopVisible,r.dirty=!0)}}C();C();var wq=Zt(kme());function Aq(t){this.name="JSClipperError",this.message=t,this.stack=new Error().stack}Aq.prototype=Error.prototype;wq.default.Error=function(t){throw new Aq(t)};var Wa=wq.default,z6e="gray",lI=new Wa.ClipperOffset,ao=100;function HM(t,e,r){let{color:n=z6e,opacity:i=1,width:a=1,join:o="round",cap:s="round",height:l=.01,altitude:u=0}=r||{};Array.isArray(i)&&(i=0);let c=[],h=t.geometry.coordinates.every(_=>_[2]!=null);for(let _=0;_<t.geometry.coordinates.length-1;_++){let w=e(t.geometry.coordinates[_][1],t.geometry.coordinates[_][0],t.geometry.coordinates[_][2]),b=e(t.geometry.coordinates[_+1][1],t.geometry.coordinates[_+1][0],t.geometry.coordinates[_+1][2]);c.push([w,b])}let d=c[0][0].y;lI.AddPaths(c.map(_=>_.map(w=>({X:w.x*ao,Y:(h?w.z:w.y)*ao}))),o==="round"?Wa.JoinType.jsRound:o==="miter"?Wa.JoinType.jsMiter:Wa.JoinType.jsSquare,s==="round"?Wa.EndType.etOpenRound:s==="butt"?Wa.EndType.etOpenButt:Wa.EndType.etOpenSquare);let p=new Wa.PolyTree;lI.Execute(p,a/2*ao);let m=[],y={bevelEnabled:!1,depth:l};for(let _ of p.m_AllPolys){let w=new j1;if(_.IsHole())continue;let b=_.m_polygon;w.moveTo(b[0].X/ao,b[0].Y/ao),b.slice(1).forEach(A=>w.lineTo(A.X/ao,A.Y/ao)),w.lineTo(b[0].X/ao,b[0].Y/ao),w.holes=_.m_Childs.map(A=>{let E=new wg,M=A.m_polygon;return E.moveTo(M[0].X/ao,M[0].Y/ao),M.slice(1).forEach(P=>E.lineTo(P.X/ao,P.Y/ao)),E.lineTo(M[0].X/ao,M[0].Y/ao),E}),m.push(new EA(w,y))}let v=vd(m);return h&&(v.rotateX(Math.PI/2),v.translate(0,d+l/2,u||0)),v.userData={style:{color:n,opacity:i}},lI.Clear(),v}C();C();function Sq(t,e,r={}){let n={type:"Feature"};return(r.id===0||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=e||{},n.geometry=t,n}function F6e(t,e,r={}){if(t.length<2)throw new Error("coordinates must be an array of two or more positions");return Sq({type:"LineString",coordinates:t},e,r)}function R6e(t,e={}){let r={type:"FeatureCollection"};return e.id&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.features=t,r}function L6e(t,e,r={}){return Sq({type:"MultiLineString",coordinates:t},e,r)}C();function Uk(t){return t.type==="Feature"?t.geometry:t}function N6e(t,e={}){let r=Uk(t);switch(!e.properties&&t.type==="Feature"&&(e.properties=t.properties),r.type){case"Polygon":return $6e(r,e);case"MultiPolygon":return U6e(r,e);default:throw new Error("invalid poly")}}function $6e(t,e={}){let r=Uk(t).coordinates,n=e.properties?e.properties:t.type==="Feature"?t.properties:{};return Eq(r,n)}function U6e(t,e={}){let r=Uk(t).coordinates,n=e.properties?e.properties:t.type==="Feature"?t.properties:{},i=[];return r.forEach(a=>{i.push(Eq(a,n))}),R6e(i)}function Eq(t,e){return t.length>1?L6e(t,e):F6e(t[0],e)}var j8=N6e;C();function V8(t){t&&(t.map&&(t.map.dispose(),t.map=void 0),t.dispose())}function ya(t){for(;t.children.length>0;)ya(t.children[0]);"geometry"in t&&t.geometry&&t.geometry.dispose(),"material"in t&&Array.isArray(t.material)?t.material.forEach(function(e){V8(e)}):"material"in t&&typeof t.material<"u"&&V8(t.material),t.parent&&t.parent.remove(t)}C();function j6e(t){return t!=null&&t.geometry.type==="Polygon"&&t.geometry.coordinates[0].length>2}function V6e(t,e){let r=t[0]*e[0]+t[1]*e[1],n=Math.sqrt(t[0]*t[0]+t[1]*t[1]),i=Math.sqrt(e[0]*e[0]+e[1]*e[1]);if(n===0||i===0)return 0;let a=r/(n*i),o=Math.max(-1,Math.min(1,a));return Math.acos(o)*(180/Math.PI)}function G6e(t,e=5){if(t.length<3)return t;let r=t.length>3&&t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1],n=[],i=r?t.length-1:t.length;for(let a=0;a<i;a++){let o=r&&a===0?t[t.length-2]:t[a-1],s=t[a],l=r&&a===t.length-1?t[1]:t[a+1];if(o==null||l==null){n.push(s);continue}let u=[s[0]-o[0],s[1]-o[1]],c=[l[0]-s[0],l[1]-s[1]];V6e(u,c)>e&&n.push(s)}if(r&&n.length>0){let a=n[0],o=n[n.length-1];(a[0]!==o[0]||a[1]!==o[1])&&n.push([a[0],a[1]])}return n}function Z6e(t,e=5){return lt(ae({},t),{geometry:lt(ae({},t.geometry),{coordinates:t.geometry.coordinates.map(r=>G6e(r,e))})})}var W6e=.1,H6e=15,X6e=.25,q6e=class{constructor(t,e){S(this,"rendererState"),S(this,"dirty",!1),S(this,"convertTo3DMapPosition"),S(this,"colorToMaterialCache",{}),this.rendererState=t,this.convertTo3DMapPosition=e}update(){var t,e,r;let n,i,a,o;for(let s of this.rendererState.geometry3DIdsInScene)if(n=this.rendererState.geometry3DMap.get(s),n!=null&&(o=n.components[0],i=n.components[1],a=n.components[5],n.type==="geometry"&&o instanceof Xa&&a!=null)){if(a!=null&&a.dirty){if(a.mesh==null)try{if(!j6e(o.feature))continue;let l=this.buildBorder(o.feature,i,a);(t=o.mesh)==null||t.add(l)}catch(l){Be.error(l),a.dirty=!1}(e=a.mesh)==null||e.children.forEach(l=>{a&&l.material.color.set(i.borderColor)}),a.dirty=!1,a.visible=i.borderVisible}if(a!=null&&a.needsRebuild){ya(a.mesh);try{let l=this.buildBorder(o.feature,i,a);(r=o.mesh)==null||r.add(l)}catch(l){Be.error(l)}a.needsRebuild=!1,a.visible=i.borderVisible}}}buildBorder(t,e,r){var n,i,a;let o=j8(t),s=Z6e(t,H6e),l=j8(s),u=e.borderWidth/2,c=e.borderColor,h=HM(o,this.convertTo3DMapPosition,{width:u,height:u,color:c,cap:"square"}),d=h.clone();d.translate(0,0,e.height);let p;l.geometry.type==="LineString"?p=l.geometry.coordinates:p=l.geometry.coordinates.flat();let m=[];p.pop();for(let E of p||[])try{let M=HM({type:"Feature",geometry:{type:"LineString",coordinates:[[E[0],E[1],0],[E[0],E[1],e.height]]},properties:{}},this.convertTo3DMapPosition,{width:u,height:u,color:c,cap:"butt"});m.push(M)}catch(M){Be.warn(M)}let y=vd([h,d,...m]),v=(n=this.colorToMaterialCache[c])==null?void 0:n[0];v==null&&(v=new Go({color:c}));let _=(i=this.colorToMaterialCache[c])==null?void 0:i[1];_==null&&(_=new Go({color:c})),this.colorToMaterialCache[c]=[v,_];let w=new Yn,b=new Er(y,v),A=new Er(y,_);return w.add(b),w.add(A),A.material.depthWrite=!1,A.material.depthTest=!1,A.material.opacity=X6e,A.material.transparent=!0,w.position.z=(a=e.altitude)!=null?a:0,r.mesh=w,w}destroy(){for(let[t,[e,r]]of Object.entries(this.colorToMaterialCache))e.dispose(),r.dispose();this.colorToMaterialCache={}}},Uv="#ffffff",Y6e=.1,XM=.1,J6e="#333333",i2,a2,o2,ug=class{constructor(e={}){S(this,"type","style"),S(this,"initialColor",Uv),K(this,i2,Uv),S(this,"initialTopColor"),K(this,a2),K(this,o2),S(this,"dirty",!0),S(this,"visible",!0),S(this,"opacity",1),S(this,"width",Y6e),S(this,"height",XM),S(this,"initialHeight",XM),S(this,"altitude",0),S(this,"join","round"),S(this,"cap","round"),S(this,"showImage",!0),S(this,"flipImageToFaceCamera",!0),S(this,"enableImageCollisions",!1),S(this,"url"),S(this,"side","double"),S(this,"renderOrder",0),S(this,"shading"),S(this,"bevel"),S(this,"borderVisible",!1),S(this,"borderColor",J6e),S(this,"borderWidth"),this.color=e?.color!==void 0?e.color:this.color,this.initialColor=this.color,this.width=e?.width!==void 0?e.width:this.width,this.opacity=e?.opacity!==void 0?e.opacity:this.opacity,this.visible=e?.visible!==void 0?e.visible:this.visible,this.height=e?.height!==void 0?e.height:this.height,this.initialHeight=this.height,this.altitude=e?.altitude!==void 0?e.altitude:this.altitude,this.join=e?.join!==void 0?e.join:this.join,this.cap=e?.cap!==void 0?e.cap:this.cap,this.topColor=e?.topColor,this.initialTopColor=this.topColor,this.showImage=e?.showImage!==void 0?e.showImage:this.showImage,this.flipImageToFaceCamera=e?.flipImageToFaceCamera!==void 0?e.flipImageToFaceCamera:this.flipImageToFaceCamera,this.url=e?.url,this.side=e?.side!==void 0?e.side:this.side,this.renderOrder=e?.renderOrder!==void 0?e.renderOrder:this.renderOrder,this.shading=e?.shading,this.bevel=e?.bevel,this.borderVisible=e?.borderVisible!==void 0?e.borderVisible:this.borderVisible,this.borderColor=e?.borderColor!==void 0?e.borderColor:this.borderColor,this.borderWidth=e?.borderWidth!==void 0?e.borderWidth:W6e,this.enableImageCollisions=e?.enableImageCollisions!==void 0?e.enableImageCollisions:this.enableImageCollisions}set color(e){tg(e)?ne(this,i2,e):Be.warn('Failed to update color. Invalid color "'.concat(e,'".'))}get color(){return f(this,i2)}set topColor(e){e===void 0||tg(e)?ne(this,a2,e):Be.warn('Failed to update top color. Invalid color "'.concat(e,'".'))}get topColor(){return f(this,a2)}set hoverColor(e){tg(e)?ne(this,o2,e):Be.warn('Failed to update hover color. Invalid color "'.concat(e,'".'))}get hoverColor(){return f(this,o2)}};i2=new WeakMap,a2=new WeakMap,o2=new WeakMap;var jk=class extends wP{constructor(){super(...arguments),S(this,"type","entityBatchedMesh"),S(this,"userData",{entities:{}})}},s2,Hf,Xa=class{constructor(e){S(this,"mesh"),S(this,"imageMesh"),S(this,"textMesh"),S(this,"textEntityId"),S(this,"type","geometry"),S(this,"dirty",!0),S(this,"shouldDetach",!1),S(this,"detached",!1),S(this,"instanceIndex",-1),S(this,"geometry"),S(this,"batchedProps"),S(this,"material"),S(this,"feature"),S(this,"currentHeight",XM),S(this,"color",new jt),S(this,"topColor",new jt),S(this,"position",new Q),S(this,"altitude",0),K(this,s2,1),K(this,Hf),this.feature=e}get visible(){return this.mesh&&this.instanceIndex!==-1?this.mesh.getVisibleAt(this.instanceIndex):!1}set visible(e){this.mesh&&this.instanceIndex!==-1&&this.mesh.setVisibleAt(this.instanceIndex,e)}get renderOrder(){return this.mesh?this.mesh.renderOrder:0}set renderOrder(e){this.mesh&&(this.mesh.renderOrder=e)}setColor(e,r){this.color.set(e),this.topColor.set(r),this.material&&this.material.setColor(this.instanceIndex,this.color,this.topColor)}getColor(){var e;return(e=this.material)==null?void 0:e.getColor(this.instanceIndex)}get opacity(){return f(this,s2)}set opacity(e){if(this.material&&(this.material.opacity=e,this.material.transparent=e<1,this.material.needsUpdate=!0),this.imageMesh){let r=Array.isArray(this.imageMesh.material)?this.imageMesh.material:[this.imageMesh.material];for(let n of r)n.opacity=e,n.needsUpdate=!0}ne(this,s2,e)}get featureBbox(){return f(this,Hf)?f(this,Hf):(ne(this,Hf,lTe(this.feature)),f(this,Hf))}};s2=new WeakMap,Hf=new WeakMap;var _o=class extends Yn{constructor(e){super(),S(this,"visible",!0),S(this,"type","geometry-group"),S(this,"components",[]),S(this,"userData",{entityId:"",entities3D:new Set,dirty:!0,shadingDirty:!0}),this.userData.entityId=e}getComponent(){}setVisible(e){this.visible!==e&&(this.visible=e,this.dispatchEvent({type:"childremoved",child:this}))}removeEntity(){this.dispatchEvent({type:"childremoved",child:this})}getfirstChildEntityId(){let e;for(let r of this.children)if(!r.userData.detached){e=r;break}return e instanceof jk?Object.values(e.userData.entities)[0]:void 0}},ui=class l2 extends Yn{constructor(e){super(),S(this,"childrenIds",new Set),S(this,"children",[]),S(this,"type","group-container"),S(this,"userData",{entityId:"",entities2D:new Set,dirty:!0,occluderDirty:!1,opacity:1,computedOpacity:1,preloadGeometry:!1}),S(this,"components",[]),this.userData.entityId=e}getComponent(){}addOccluderFeature(e,r){this.userData.occluderFeature=e,this.userData.occluderId=r,this.userData.occluderDirty=!0}addEntity(e){e instanceof l2?(this.childrenIds.add(e.userData.entityId),this.add(e)):e instanceof Ug?(this.childrenIds.add(e.id),this.add(e.object3d),this.userData.entities2D.add(e.id),e.positionDirty=!0):e instanceof _o?(this.childrenIds.add(e.userData.entityId),this.add(e)):e instanceof Cn&&e.object3d&&(this.childrenIds.add(e.id),this.add(e.object3d)),this.dispatchEvent({type:"childadded",child:this})}removeEntity(e){e instanceof l2?(this.childrenIds.delete(e.userData.entityId),this.remove(e)):e instanceof Ug?(this.childrenIds.delete(e.id),this.userData.entities2D.delete(e.id),this.remove(e.object3d)):e instanceof _o?(this.childrenIds.delete(e.userData.entityId),this.remove(e)):e instanceof Cn&&e.object3d&&(this.childrenIds.delete(e.id),this.add(e.object3d)),this.dispatchEvent({type:"childremoved",child:this})}setVisible(e){this.visible!==e&&(this.visible=e,this.dispatchEvent({type:"childremoved",child:this}))}setAltitude(e){this.position.z!==e&&(this.position.z=e,this.dispatchEvent({type:"childremoved",child:this}),this.set2DGeometryChildrenPositionDirty())}set2DGeometryChildrenPositionDirty(){this.children.forEach(e=>{e instanceof I1?e.userData.worldPositionDirty=!0:e instanceof l2&&e.set2DGeometryChildrenPositionDirty()})}get altitude(){return this.position.z}setOpacity(e){this.userData.opacity=e}get opacity(){return this.userData.opacity}};C();function K6e(t){let e=t.min,r=t.max,n=new Q(e.x,e.y,e.z),i=new Q(r.x,e.y,e.z),a=new Q(e.x,r.y,e.z),o=new Q(r.x,r.y,e.z);return[n,i,a,o]}C();function Xf(t,e){let r;return typeof e=="string"||typeof e=="number"?(r=t.geometry2DMap.get(e),r==null&&(r=t.geometry3DMap.get(e))):typeof e?.id=="string"||typeof e?.id=="number"?(r=t.geometry2DMap.get(e.id),r==null&&(r=t.geometry3DMap.get(e.id))):r=e,r}function Q6e(t,e,r=[],n=new qn,i){(t.getSystems().renderSystem.threeDdirty||t.getSystems().renderSystem.twoDdirty)&&t.renderSync();let a=Xf(t.getInternalState(),e);return Iq(a,r,n,i),r}var hb=new Q;function Iq(t,e=[],r=new qn,n){if(t.visible){if(t.isMesh||t.isLine||t.isPoints){let i=t.geometry;if(i.isBufferGeometry){let a=i.attributes.position;for(let o=0;o<a.count;o++)hb.fromBufferAttribute(a,o),n!==void 0&&(hb.z=n),e.push(hb.clone()),r.expandByPoint(hb)}}for(let i of t.children)Iq(i,e,r,n)}}C();function u2(){return typeof window>"u"?1:Math.min(window.devicePixelRatio,2)}C();function ePe(t,e,r){let n,i,a,o=null,s=0;r||(r={});let l=function(){s=r.leading===!1?0:Date.now(),o=null,a=t.apply(n,i),o||(n=i=null)};return function(...u){let c=Date.now();!s&&r.leading===!1&&(s=c);let h=e-(c-s);return h<=0||h>e?(o&&(clearTimeout(o),o=null),s=c,a=t.apply(this,u),o||(n=u=null)):!o&&r.trailing!==!1&&(o=setTimeout(l,h)),a}}function qM(t,e,r=!1){let n=null,i=0;return function(...a){i++,i===1&&r===!0&&t(...a);let o=()=>{(!r||i>1)&&t(...a),n=null,i=0};clearTimeout(n),n=setTimeout(o,e)}}C();var tPe=(()=>{let t;return{getDeviceType(){if(t)return t;let{userAgent:e,platform:r,maxTouchPoints:n}=window.navigator,i=/(iphone|ipod|ipad)/i.test(e),a=r==="iPad"||r.indexOf("Mac")===0&&n>0&&!window.MSStream,o=/android/i.test(e);return t={isIpad:a,isMobile:o||i||a,isSafari12:/Version\/12.+Safari/.test(e),isFirefox:/Firefox/.test(e),isWindows:/windows/i.test(e)},t},_reset(){t=void 0}}})(),G8=tPe.getDeviceType,Cq=(()=>{let t,e,r;function n(){if(e!==void 0)return e;t||(t=document.createElement("canvas"));let a=t.getContext("webgl")||t.getContext("experimental-webgl");if(!a)return e;try{let o=G8().isFirefox?null:a.getExtension("WEBGL_debug_renderer_info");return e=o?a.getParameter(o.UNMASKED_RENDERER_WEBGL):a.getParameter(a.RENDERER),e}catch{let s=new Error("Failed getting device info");throw s.name="FailedGettingDeviceInfo",s}}function i(){var a,o;if(!G8().isWindows)return!1;if(r!==void 0)return r;let s=(o=(a=rPe())==null?void 0:a.toLowerCase())!=null?o:"";return r=s.includes("intel")&&(s.includes("uhd")||s.includes("iris")),r}return{getInfo:n,shouldDisableOffscreenCanvas:i,_setCanvas(a){t=a,e=void 0,r=void 0}}})(),rPe=Cq.getInfo,nPe=Cq.shouldDisableOffscreenCanvas;C();function Vk(t,e){let r={};for(let n=0;n<e.length;n++){let i=e[n];i in t&&(r[i]=t[i])}return r}function iPe(t){return Object.keys(t).length===0}C();var aPe=t=>e=>{if(!e.includes("mappedin")){let r={};for(let n in t){let i=t[n];e.includes("mappedin")||(t[n]=i)}return{url:e,headers:r}}return{url:e,headers:t}};function Mq(t,e,r,n){let i=t*(Math.PI/180),a=n/ud,o=t+a*180/Math.PI,s=r/ud/Math.cos(i),l=e+s*180/Math.PI;return{lat:o,lon:l}}function Tq(t,e,r,n){let i=r*(Math.PI/180),a=n*(Math.PI/180),o=t*(Math.PI/180),s=e*(Math.PI/180),l=i-o,u=a-s,c=ud*u*Math.cos(o),h=ud*l;return{x:c,y:h}}var Pq=(t,e,r,n=!1)=>{var i;let a=t instanceof ui&&t.userData.preloadGeometry,o=n||a&&!t.visible;if(t.children&&(t.visible||a))for(let s of t.children){if(s.visible&&s.type&&!o)if("entities3D"in s.userData&&(i=s.userData)!=null&&i.entities3D&&s instanceof _o){e.add(s.userData.entityId);for(let l of s.userData.entities3D.values())e.add(l)}else(s.type==="group-container"||s.type==="custom-geometry"||s instanceof _0)&&e.add(s.userData.entityId);s instanceof _o&&s.userData.dirty&&r.add(s.userData.entityId),Pq(s,e,r,o)}return e},Dq=(t,e)=>{var r;if(t.children&&t.visible&&!((r=t.userData)!=null&&r.hidden))for(let n of t.children)n.visible&&n instanceof I1&&e.add(n.userData.entityId),Dq(n,e);return e};function kq(t,e){for(let r in e)if(!(r==="__proto__"||r==="constructor"||r==="prototype")){if(e[r]==null){t[r]=void 0;continue}Array.isArray(e[r])?t[r]=e[r]:typeof e[r]=="object"&&typeof t[r]=="object"&&t[r]!==null&&!Array.isArray(t[r])?kq(t[r],e[r]):t[r]=e[r]}return t}function oPe(t,e,r){let n={translateX:t.x,translateY:t.y,translateZ:t.z,scale:t.meterInMercatorCoordinateUnits()},i=new gr,a=new Q(n.scale,-n.scale,n.scale),o=new gr().makeTranslation(n.translateX,n.translateY,n.translateZ).scale(a);return{id:mq,type:"custom",renderingMode:"3d",render:(s,l)=>{i.fromArray(l.defaultProjectionData.mainMatrix),e.projectionMatrix=i.multiply(o),r()}}}function sPe(t){return fetch(t,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({grant_type:"client_credentials"})})}async function lPe(t){let e=await sPe(t),{access_token:r}=await e.json();return{"x-mappedin-tiles-key":r}}function uPe(t,e=0){let r=3735928559^e,n=1103547991^e;for(let i=0,a;i<t.length;i++)a=t.charCodeAt(i),r=Math.imul(r^a,2654435761),n=Math.imul(n^a,1597334677);return r=Math.imul(r^r>>>16,2246822507)^Math.imul(n^n>>>13,3266489909),n=Math.imul(n^n>>>16,2246822507)^Math.imul(r^r>>>13,3266489909),4294967296*(2097151&n)+(r>>>0)}function Z8(t,e,r){let n=t*(Math.PI/180)/2,i=e/2;return r*Math.tan(n)/i}function cPe(t){return new Vc(new ar(t[0][0],t[0][1]),new ar(t[1][0],t[1][1])).getCenter().toArray()}function hPe(t,e){return t<e||e<=12}function Gk(t){let e=1;return t.type==="geometry-group"&&t.parent!=null&&t.parent instanceof ui?e=t.parent.userData.computedOpacity:(t.type==="geometry"||t.type==="custom-geometry"||t.type==="model")&&t.parentObject3D!=null&&t.parentObject3D instanceof _o&&t.parentObject3D.parent!=null&&t.parentObject3D.parent instanceof ui&&(e=t.parentObject3D.parent.userData.computedOpacity),e}function dPe(t,e,r=1e-10){if(t.length!==e.length)return!1;let n=Math.abs(t[0]-e[0])<r,i=Math.abs(t[1]-e[1])<r;if(t.length===3&&e.length===3){let a=Math.abs(t[2]-e[2])<r;return n&&i&&a}return n&&i}var pPe="maplibre-frustum-culling-hack";function fPe(){let t=new od(.01,.01,.01),e=new Go({opacity:0,depthWrite:!1,transparent:!0}),r=new Er(t,e);return r.position.copy(new Q(0,50,0)),r.frustumCulled=!1,r.name=pPe,r}var yh=new Q,W8=new Je;function uI(t,e,r=new kN){return t.traverse(n=>{if(n instanceof Er){let i=n.geometry.attributes.position;if(e.position.distanceTo(n.position)<e.near)return;for(let a=0;a<i.count;a++)yh.fromBufferAttribute(i,a),yh.applyMatrix4(n.matrixWorld),yh.applyMatrix4(e.matrixWorldInverse),yh.applyMatrix4(e.projectionMatrix),yh.z<1&&yh.z>0&&(W8.set(yh.x,yh.y),r.expandByPoint(W8))}}),r}function H8(t,e){let r=e.clientWidth,n=e.clientHeight;return new Je((t.x+1)*r/2,(1-t.y)*n/2)}function X8(t,e,r){let n=document.createElement("div");n.style.position="absolute",n.style.border="2px solid ".concat(e),n.style.pointerEvents="none";let i=H8(new Je(t.min.x,t.min.y),r),a=H8(new Je(t.max.x,t.max.y),r);n.style.left="".concat(i.x,"px"),n.style.top="".concat(a.y,"px");let o=Math.abs(a.x-i.x),s=Math.abs(a.y-i.y);return n.style.width="".concat(o,"px"),n.style.height="".concat(s,"px"),r.appendChild(n),n}function mPe(t,e){let r=0,n=0,i=t.clientWidth,a=t.clientHeight;if(e){let{left:o,top:s,right:l,bottom:u,type:c}=e,h=o??0,d=s??0,p=l??0,m=u??0;c==="portion"?(r=h*i,n=d*a,i=i-r-p*i,a=a-n-m*a):(r=h,n=d,i=i-r-p,a=a-n-m)}return[r,n,i,a].map(o=>Math.max(o,0))}function YM(t){return(t*100|0)/100}C();var JM=class{constructor(e){S(this,"type","text3dStyle"),S(this,"visible"),S(this,"altitude"),S(this,"color"),S(this,"dirty",!0),S(this,"maxWidth"),S(this,"maxHeight"),S(this,"hoverByPolygon"),S(this,"flipToFaceCamera",jv.flipToFaceCamera),S(this,"font"),S(this,"fillOpacity"),S(this,"fontSize"),S(this,"margin"),S(this,"outlineWidth"),S(this,"outlineBlur"),S(this,"outlineOffsetX"),S(this,"strokeColor"),S(this,"strokeOpacity"),S(this,"strokeWidth"),S(this,"hoverColor"),S(this,"outlineOffsetY"),S(this,"outlineColor"),S(this,"outlineOpacity"),e&&Object.assign(this,e)}getState(e=!1){let r={};for(let n in this)!e&&n==="dirty"||this[n]!==void 0&&(r[n]=this[n]);return r}},jv=Object.freeze({visible:!0,color:"black",flipToFaceCamera:!0,fillOpacity:1,font:void 0,fontSize:2,margin:[.2,1,.2,1.5],outlineColor:"black",outlineOpacity:1,outlineWidth:0,outlineOffsetX:0,outlineOffsetY:0,outlineBlur:0,strokeOpacity:1,strokeWidth:0,maxWidth:void 0,maxHeight:void 0,strokeColor:"black",hoverColor:void 0});C();C();var Oq=class{constructor(e){S(this,"type","modelStyle"),S(this,"dirty",!0),S(this,"visible",!0),S(this,"opacity",1),S(this,"verticalOffset",0),S(this,"interactive",!1),S(this,"color"),S(this,"material"),S(this,"rotation"),S(this,"scale"),S(this,"visibleThroughGeometry",!1),S(this,"clippingPlaneZOffset",1/0),S(this,"clippingPlaneTopColor"),S(this,"clippingPlaneTopVisible",!0),e&&Object.assign(this,e)}};C();var c2=[1,1,1],h2=[0,0,0],gPe=Ir((t,e)=>{C(),(function(r,n){typeof t=="object"&&typeof e<"u"?e.exports=n():typeof define=="function"&&define.amd?define(n):(r=r||self,r.TinyQueue=n())})(t,function(){var r=function(i,a){if(i===void 0&&(i=[]),a===void 0&&(a=n),this.data=i,this.length=this.data.length,this.compare=a,this.length>0)for(var o=(this.length>>1)-1;o>=0;o--)this._down(o)};r.prototype.push=function(i){this.data.push(i),this.length++,this._up(this.length-1)},r.prototype.pop=function(){if(this.length!==0){var i=this.data[0],a=this.data.pop();return this.length--,this.length>0&&(this.data[0]=a,this._down(0)),i}},r.prototype.peek=function(){return this.data[0]},r.prototype._up=function(i){for(var a=this,o=a.data,s=a.compare,l=o[i];i>0;){var u=i-1>>1,c=o[u];if(s(l,c)>=0)break;o[i]=c,i=u}o[i]=l},r.prototype._down=function(i){for(var a=this,o=a.data,s=a.compare,l=this.length>>1,u=o[i];i<l;){var c=(i<<1)+1,h=o[c],d=c+1;if(d<this.length&&s(o[d],h)<0&&(c=d,h=o[d]),s(h,u)>=0)break;o[i]=h,i=c}o[i]=u};function n(i,a){return i<a?-1:i>a?1:0}return r})}),yPe=Ir((t,e)=>{C();var r=gPe();r.default&&(r=r.default),e.exports=n,e.exports.default=n;function n(u,c,h){c=c||1;for(var d,p,m,y,v=0;v<u[0].length;v++){var _=u[0][v];(!v||_[0]<d)&&(d=_[0]),(!v||_[1]<p)&&(p=_[1]),(!v||_[0]>m)&&(m=_[0]),(!v||_[1]>y)&&(y=_[1])}var w=m-d,b=y-p,A=Math.min(w,b),E=A/2;if(A===0){var M=[d,p];return M.distance=0,M}for(var P=new r(void 0,i),k=d;k<m;k+=A)for(var D=p;D<y;D+=A)P.push(new a(k+E,D+E,E,u));var O=s(u),B=new a(d+w/2,p+b/2,0,u);B.d>O.d&&(O=B);for(var L=P.length;P.length;){var R=P.pop();R.d>O.d&&(O=R,h&&console.log("found best %d after %d probes",Math.round(1e4*R.d)/1e4,L)),!(R.max-O.d<=c)&&(E=R.h/2,P.push(new a(R.x-E,R.y-E,E,u)),P.push(new a(R.x+E,R.y-E,E,u)),P.push(new a(R.x-E,R.y+E,E,u)),P.push(new a(R.x+E,R.y+E,E,u)),L+=4)}h&&(console.log("num probes: "+L),console.log("best distance: "+O.d));var T=[O.x,O.y];return T.distance=O.d,T}function i(u,c){return c.max-u.max}function a(u,c,h,d){this.x=u,this.y=c,this.h=h,this.d=o(u,c,d),this.max=this.d+this.h*Math.SQRT2}function o(u,c,h){for(var d=!1,p=1/0,m=0;m<h.length;m++)for(var y=h[m],v=0,_=y.length,w=_-1;v<_;w=v++){var b=y[v],A=y[w];b[1]>c!=A[1]>c&&u<(A[0]-b[0])*(c-b[1])/(A[1]-b[1])+b[0]&&(d=!d),p=Math.min(p,l(u,c,b,A))}return p===0?0:(d?1:-1)*Math.sqrt(p)}function s(u){for(var c=0,h=0,d=0,p=u[0],m=0,y=p.length,v=y-1;m<y;v=m++){var _=p[m],w=p[v],b=_[0]*w[1]-w[0]*_[1];h+=(_[0]+w[0])*b,d+=(_[1]+w[1])*b,c+=b*3}return c===0?new a(p[0][0],p[0][1],0,u):new a(h/c,d/c,0,u)}function l(u,c,h,d){var p=h[0],m=h[1],y=d[0]-p,v=d[1]-m;if(y!==0||v!==0){var _=((u-p)*y+(c-m)*v)/(y*y+v*v);_>1?(p=d[0],m=d[1]):_>0&&(p+=y*_,m+=v*_)}return y=u-p,v=c-m,y*y+v*v}}),vPe=Ir((t,e)=>{C(),(function(r,n){typeof t=="object"&&typeof e<"u"?e.exports=n():typeof define=="function"&&define.amd?define(n):(r=r||self).RBush=n()})(t,function(){function r(w,b,A,E,M){(function P(k,D,O,B,L){for(;B>O;){if(B-O>600){var R=B-O+1,T=D-O+1,N=Math.log(R),$=.5*Math.exp(2*N/3),V=.5*Math.sqrt(N*$*(R-$)/R)*(T-R/2<0?-1:1),G=Math.max(O,Math.floor(D-T*$/R+V)),ee=Math.min(B,Math.floor(D+(R-T)*$/R+V));P(k,D,G,ee,L)}var ie=k[D],me=O,Me=B;for(n(k,O,D),L(k[B],ie)>0&&n(k,O,B);me<Me;){for(n(k,me,Me),me++,Me--;L(k[me],ie)<0;)me++;for(;L(k[Me],ie)>0;)Me--}L(k[O],ie)===0?n(k,O,Me):n(k,++Me,B),Me<=D&&(O=Me+1),D<=Me&&(B=Me-1)}})(w,b,A||0,E||w.length-1,M||i)}function n(w,b,A){var E=w[b];w[b]=w[A],w[A]=E}function i(w,b){return w<b?-1:w>b?1:0}var a=function(w){w===void 0&&(w=9),this._maxEntries=Math.max(4,w),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function o(w,b,A){if(!A)return b.indexOf(w);for(var E=0;E<b.length;E++)if(A(w,b[E]))return E;return-1}function s(w,b){l(w,0,w.children.length,b,w)}function l(w,b,A,E,M){M||(M=v(null)),M.minX=1/0,M.minY=1/0,M.maxX=-1/0,M.maxY=-1/0;for(var P=b;P<A;P++){var k=w.children[P];u(M,w.leaf?E(k):k)}return M}function u(w,b){return w.minX=Math.min(w.minX,b.minX),w.minY=Math.min(w.minY,b.minY),w.maxX=Math.max(w.maxX,b.maxX),w.maxY=Math.max(w.maxY,b.maxY),w}function c(w,b){return w.minX-b.minX}function h(w,b){return w.minY-b.minY}function d(w){return(w.maxX-w.minX)*(w.maxY-w.minY)}function p(w){return w.maxX-w.minX+(w.maxY-w.minY)}function m(w,b){return w.minX<=b.minX&&w.minY<=b.minY&&b.maxX<=w.maxX&&b.maxY<=w.maxY}function y(w,b){return b.minX<=w.maxX&&b.minY<=w.maxY&&b.maxX>=w.minX&&b.maxY>=w.minY}function v(w){return{children:w,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function _(w,b,A,E,M){for(var P=[b,A];P.length;)if(!((A=P.pop())-(b=P.pop())<=E)){var k=b+Math.ceil((A-b)/E/2)*E;r(w,k,b,A,M),P.push(b,k,k,A)}}return a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(w){var b=this.data,A=[];if(!y(w,b))return A;for(var E=this.toBBox,M=[];b;){for(var P=0;P<b.children.length;P++){var k=b.children[P],D=b.leaf?E(k):k;y(w,D)&&(b.leaf?A.push(k):m(w,D)?this._all(k,A):M.push(k))}b=M.pop()}return A},a.prototype.collides=function(w){var b=this.data;if(!y(w,b))return!1;for(var A=[];b;){for(var E=0;E<b.children.length;E++){var M=b.children[E],P=b.leaf?this.toBBox(M):M;if(y(w,P)){if(b.leaf||m(w,P))return!0;A.push(M)}}b=A.pop()}return!1},a.prototype.load=function(w){if(!w||!w.length)return this;if(w.length<this._minEntries){for(var b=0;b<w.length;b++)this.insert(w[b]);return this}var A=this._build(w.slice(),0,w.length-1,0);if(this.data.children.length)if(this.data.height===A.height)this._splitRoot(this.data,A);else{if(this.data.height<A.height){var E=this.data;this.data=A,A=E}this._insert(A,this.data.height-A.height-1,!0)}else this.data=A;return this},a.prototype.insert=function(w){return w&&this._insert(w,this.data.height-1),this},a.prototype.clear=function(){return this.data=v([]),this},a.prototype.remove=function(w,b){if(!w)return this;for(var A,E,M,P=this.data,k=this.toBBox(w),D=[],O=[];P||D.length;){if(P||(P=D.pop(),E=D[D.length-1],A=O.pop(),M=!0),P.leaf){var B=o(w,P.children,b);if(B!==-1)return P.children.splice(B,1),D.push(P),this._condense(D),this}M||P.leaf||!m(P,k)?E?(A++,P=E.children[A],M=!1):P=null:(D.push(P),O.push(A),A=0,E=P,P=P.children[0])}return this},a.prototype.toBBox=function(w){return w},a.prototype.compareMinX=function(w,b){return w.minX-b.minX},a.prototype.compareMinY=function(w,b){return w.minY-b.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(w){return this.data=w,this},a.prototype._all=function(w,b){for(var A=[];w;)w.leaf?b.push.apply(b,w.children):A.push.apply(A,w.children),w=A.pop();return b},a.prototype._build=function(w,b,A,E){var M,P=A-b+1,k=this._maxEntries;if(P<=k)return s(M=v(w.slice(b,A+1)),this.toBBox),M;E||(E=Math.ceil(Math.log(P)/Math.log(k)),k=Math.ceil(P/Math.pow(k,E-1))),(M=v([])).leaf=!1,M.height=E;var D=Math.ceil(P/k),O=D*Math.ceil(Math.sqrt(k));_(w,b,A,O,this.compareMinX);for(var B=b;B<=A;B+=O){var L=Math.min(B+O-1,A);_(w,B,L,D,this.compareMinY);for(var R=B;R<=L;R+=D){var T=Math.min(R+D-1,L);M.children.push(this._build(w,R,T,E-1))}}return s(M,this.toBBox),M},a.prototype._chooseSubtree=function(w,b,A,E){for(;E.push(b),!b.leaf&&E.length-1!==A;){for(var M=1/0,P=1/0,k=void 0,D=0;D<b.children.length;D++){var O=b.children[D],B=d(O),L=(R=w,T=O,(Math.max(T.maxX,R.maxX)-Math.min(T.minX,R.minX))*(Math.max(T.maxY,R.maxY)-Math.min(T.minY,R.minY))-B);L<P?(P=L,M=B<M?B:M,k=O):L===P&&B<M&&(M=B,k=O)}b=k||b.children[0]}var R,T;return b},a.prototype._insert=function(w,b,A){var E=A?w:this.toBBox(w),M=[],P=this._chooseSubtree(E,this.data,b,M);for(P.children.push(w),u(P,E);b>=0&&M[b].children.length>this._maxEntries;)this._split(M,b),b--;this._adjustParentBBoxes(E,M,b)},a.prototype._split=function(w,b){var A=w[b],E=A.children.length,M=this._minEntries;this._chooseSplitAxis(A,M,E);var P=this._chooseSplitIndex(A,M,E),k=v(A.children.splice(P,A.children.length-P));k.height=A.height,k.leaf=A.leaf,s(A,this.toBBox),s(k,this.toBBox),b?w[b-1].children.push(k):this._splitRoot(A,k)},a.prototype._splitRoot=function(w,b){this.data=v([w,b]),this.data.height=w.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(w,b,A){for(var E,M,P,k,D,O,B,L=1/0,R=1/0,T=b;T<=A-b;T++){var N=l(w,0,T,this.toBBox),$=l(w,T,A,this.toBBox),V=(M=N,P=$,k=void 0,D=void 0,O=void 0,B=void 0,k=Math.max(M.minX,P.minX),D=Math.max(M.minY,P.minY),O=Math.min(M.maxX,P.maxX),B=Math.min(M.maxY,P.maxY),Math.max(0,O-k)*Math.max(0,B-D)),G=d(N)+d($);V<L?(L=V,E=T,R=G<R?G:R):V===L&&G<R&&(R=G,E=T)}return E||A-b},a.prototype._chooseSplitAxis=function(w,b,A){var E=w.leaf?this.compareMinX:c,M=w.leaf?this.compareMinY:h;this._allDistMargin(w,b,A,E)<this._allDistMargin(w,b,A,M)&&w.children.sort(E)},a.prototype._allDistMargin=function(w,b,A,E){w.children.sort(E);for(var M=this.toBBox,P=l(w,0,b,M),k=l(w,A-b,A,M),D=p(P)+p(k),O=b;O<A-b;O++){var B=w.children[O];u(P,w.leaf?M(B):B),D+=p(P)}for(var L=A-b-1;L>=b;L--){var R=w.children[L];u(k,w.leaf?M(R):R),D+=p(k)}return D},a.prototype._adjustParentBBoxes=function(w,b,A){for(var E=A;E>=0;E--)u(b[E],w)},a.prototype._condense=function(w){for(var b=w.length-1,A=void 0;b>=0;b--)w[b].children.length===0?b>0?(A=w[b-1].children).splice(A.indexOf(w[b]),1):this.clear():s(w[b],this.toBBox)},a})}),Bq=Ir(t=>{C(),Object.defineProperty(t,"__esModule",{value:!0}),t.earthRadius=63710088e-1,t.factors={centimeters:t.earthRadius*100,centimetres:t.earthRadius*100,degrees:t.earthRadius/111325,feet:t.earthRadius*3.28084,inches:t.earthRadius*39.37,kilometers:t.earthRadius/1e3,kilometres:t.earthRadius/1e3,meters:t.earthRadius,metres:t.earthRadius,miles:t.earthRadius/1609.344,millimeters:t.earthRadius*1e3,millimetres:t.earthRadius*1e3,nauticalmiles:t.earthRadius/1852,radians:1,yards:t.earthRadius*1.0936},t.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/t.earthRadius,yards:1.0936133},t.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function e(B,L,R){R===void 0&&(R={});var T={type:"Feature"};return(R.id===0||R.id)&&(T.id=R.id),R.bbox&&(T.bbox=R.bbox),T.properties=L||{},T.geometry=B,T}t.feature=e;function r(B,L,R){switch(B){case"Point":return n(L).geometry;case"LineString":return s(L).geometry;case"Polygon":return a(L).geometry;case"MultiPoint":return h(L).geometry;case"MultiLineString":return c(L).geometry;case"MultiPolygon":return d(L).geometry;default:throw new Error(B+" is invalid")}}t.geometry=r;function n(B,L,R){if(R===void 0&&(R={}),!B)throw new Error("coordinates is required");if(!Array.isArray(B))throw new Error("coordinates must be an Array");if(B.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!P(B[0])||!P(B[1]))throw new Error("coordinates must contain numbers");var T={type:"Point",coordinates:B};return e(T,L,R)}t.point=n;function i(B,L,R){return R===void 0&&(R={}),u(B.map(function(T){return n(T,L)}),R)}t.points=i;function a(B,L,R){R===void 0&&(R={});for(var T=0,N=B;T<N.length;T++){var $=N[T];if($.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var V=0;V<$[$.length-1].length;V++)if($[$.length-1][V]!==$[0][V])throw new Error("First and last Position are not equivalent.")}var G={type:"Polygon",coordinates:B};return e(G,L,R)}t.polygon=a;function o(B,L,R){return R===void 0&&(R={}),u(B.map(function(T){return a(T,L)}),R)}t.polygons=o;function s(B,L,R){if(R===void 0&&(R={}),B.length<2)throw new Error("coordinates must be an array of two or more positions");var T={type:"LineString",coordinates:B};return e(T,L,R)}t.lineString=s;function l(B,L,R){return R===void 0&&(R={}),u(B.map(function(T){return s(T,L)}),R)}t.lineStrings=l;function u(B,L){L===void 0&&(L={});var R={type:"FeatureCollection"};return L.id&&(R.id=L.id),L.bbox&&(R.bbox=L.bbox),R.features=B,R}t.featureCollection=u;function c(B,L,R){R===void 0&&(R={});var T={type:"MultiLineString",coordinates:B};return e(T,L,R)}t.multiLineString=c;function h(B,L,R){R===void 0&&(R={});var T={type:"MultiPoint",coordinates:B};return e(T,L,R)}t.multiPoint=h;function d(B,L,R){R===void 0&&(R={});var T={type:"MultiPolygon",coordinates:B};return e(T,L,R)}t.multiPolygon=d;function p(B,L,R){R===void 0&&(R={});var T={type:"GeometryCollection",geometries:B};return e(T,L,R)}t.geometryCollection=p;function m(B,L){if(L===void 0&&(L=0),L&&!(L>=0))throw new Error("precision must be a positive number");var R=Math.pow(10,L||0);return Math.round(B*R)/R}t.round=m;function y(B,L){L===void 0&&(L="kilometers");var R=t.factors[L];if(!R)throw new Error(L+" units is invalid");return B*R}t.radiansToLength=y;function v(B,L){L===void 0&&(L="kilometers");var R=t.factors[L];if(!R)throw new Error(L+" units is invalid");return B/R}t.lengthToRadians=v;function _(B,L){return b(v(B,L))}t.lengthToDegrees=_;function w(B){var L=B%360;return L<0&&(L+=360),L}t.bearingToAzimuth=w;function b(B){var L=B%(2*Math.PI);return L*180/Math.PI}t.radiansToDegrees=b;function A(B){var L=B%360;return L*Math.PI/180}t.degreesToRadians=A;function E(B,L,R){if(L===void 0&&(L="kilometers"),R===void 0&&(R="kilometers"),!(B>=0))throw new Error("length must be a positive number");return y(v(B,L),R)}t.convertLength=E;function M(B,L,R){if(L===void 0&&(L="meters"),R===void 0&&(R="kilometers"),!(B>=0))throw new Error("area must be a positive number");var T=t.areaFactors[L];if(!T)throw new Error("invalid original units");var N=t.areaFactors[R];if(!N)throw new Error("invalid final units");return B/T*N}t.convertArea=M;function P(B){return!isNaN(B)&&B!==null&&!Array.isArray(B)}t.isNumber=P;function k(B){return!!B&&B.constructor===Object}t.isObject=k;function D(B){if(!B)throw new Error("bbox is required");if(!Array.isArray(B))throw new Error("bbox must be an Array");if(B.length!==4&&B.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");B.forEach(function(L){if(!P(L))throw new Error("bbox must only contain numbers")})}t.validateBBox=D;function O(B){if(!B)throw new Error("id is required");if(["string","number"].indexOf(typeof B)===-1)throw new Error("id must be a number or a string")}t.validateId=O}),zq=Ir(t=>{C(),Object.defineProperty(t,"__esModule",{value:!0});var e=Bq();function r(b,A,E){if(b!==null)for(var M,P,k,D,O,B,L,R=0,T=0,N,$=b.type,V=$==="FeatureCollection",G=$==="Feature",ee=V?b.features.length:1,ie=0;ie<ee;ie++){L=V?b.features[ie].geometry:G?b.geometry:b,N=L?L.type==="GeometryCollection":!1,O=N?L.geometries.length:1;for(var me=0;me<O;me++){var Me=0,Ae=0;if(D=N?L.geometries[me]:L,D!==null){B=D.coordinates;var le=D.type;switch(R=E&&(le==="Polygon"||le==="MultiPolygon")?1:0,le){case null:break;case"Point":if(A(B,T,ie,Me,Ae)===!1)return!1;T++,Me++;break;case"LineString":case"MultiPoint":for(M=0;M<B.length;M++){if(A(B[M],T,ie,Me,Ae)===!1)return!1;T++,le==="MultiPoint"&&Me++}le==="LineString"&&Me++;break;case"Polygon":case"MultiLineString":for(M=0;M<B.length;M++){for(P=0;P<B[M].length-R;P++){if(A(B[M][P],T,ie,Me,Ae)===!1)return!1;T++}le==="MultiLineString"&&Me++,le==="Polygon"&&Ae++}le==="Polygon"&&Me++;break;case"MultiPolygon":for(M=0;M<B.length;M++){for(Ae=0,P=0;P<B[M].length;P++){for(k=0;k<B[M][P].length-R;k++){if(A(B[M][P][k],T,ie,Me,Ae)===!1)return!1;T++}Ae++}Me++}break;case"GeometryCollection":for(M=0;M<D.geometries.length;M++)if(r(D.geometries[M],A,E)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function n(b,A,E,M){var P=E;return r(b,function(k,D,O,B,L){D===0&&E===void 0?P=k:P=A(P,k,D,O,B,L)},M),P}function i(b,A){var E;switch(b.type){case"FeatureCollection":for(E=0;E<b.features.length&&A(b.features[E].properties,E)!==!1;E++);break;case"Feature":A(b.properties,0);break}}function a(b,A,E){var M=E;return i(b,function(P,k){k===0&&E===void 0?M=P:M=A(M,P,k)}),M}function o(b,A){if(b.type==="Feature")A(b,0);else if(b.type==="FeatureCollection")for(var E=0;E<b.features.length&&A(b.features[E],E)!==!1;E++);}function s(b,A,E){var M=E;return o(b,function(P,k){k===0&&E===void 0?M=P:M=A(M,P,k)}),M}function l(b){var A=[];return r(b,function(E){A.push(E)}),A}function u(b,A){var E,M,P,k,D,O,B,L,R,T,N=0,$=b.type==="FeatureCollection",V=b.type==="Feature",G=$?b.features.length:1;for(E=0;E<G;E++){for(O=$?b.features[E].geometry:V?b.geometry:b,L=$?b.features[E].properties:V?b.properties:{},R=$?b.features[E].bbox:V?b.bbox:void 0,T=$?b.features[E].id:V?b.id:void 0,B=O?O.type==="GeometryCollection":!1,D=B?O.geometries.length:1,P=0;P<D;P++){if(k=B?O.geometries[P]:O,k===null){if(A(null,N,L,R,T)===!1)return!1;continue}switch(k.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(A(k,N,L,R,T)===!1)return!1;break}case"GeometryCollection":{for(M=0;M<k.geometries.length;M++)if(A(k.geometries[M],N,L,R,T)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}N++}}function c(b,A,E){var M=E;return u(b,function(P,k,D,O,B){k===0&&E===void 0?M=P:M=A(M,P,k,D,O,B)}),M}function h(b,A){u(b,function(E,M,P,k,D){var O=E===null?null:E.type;switch(O){case null:case"Point":case"LineString":case"Polygon":return A(e.feature(E,P,{bbox:k,id:D}),M,0)===!1?!1:void 0}var B;switch(O){case"MultiPoint":B="Point";break;case"MultiLineString":B="LineString";break;case"MultiPolygon":B="Polygon";break}for(var L=0;L<E.coordinates.length;L++){var R=E.coordinates[L],T={type:B,coordinates:R};if(A(e.feature(T,P),M,L)===!1)return!1}})}function d(b,A,E){var M=E;return h(b,function(P,k,D){k===0&&D===0&&E===void 0?M=P:M=A(M,P,k,D)}),M}function p(b,A){h(b,function(E,M,P){var k=0;if(E.geometry){var D=E.geometry.type;if(!(D==="Point"||D==="MultiPoint")){var O,B=0,L=0,R=0;if(r(E,function(T,N,$,V,G){if(O===void 0||M>B||V>L||G>R){O=T,B=M,L=V,R=G,k=0;return}var ee=e.lineString([O,T],E.properties);if(A(ee,M,P,G,k)===!1)return!1;k++,O=T})===!1)return!1}}})}function m(b,A,E){var M=E,P=!1;return p(b,function(k,D,O,B,L){P===!1&&E===void 0?M=k:M=A(M,k,D,O,B,L),P=!0}),M}function y(b,A){if(!b)throw new Error("geojson is required");h(b,function(E,M,P){if(E.geometry!==null){var k=E.geometry.type,D=E.geometry.coordinates;switch(k){case"LineString":if(A(E,M,P,0,0)===!1)return!1;break;case"Polygon":for(var O=0;O<D.length;O++)if(A(e.lineString(D[O],E.properties),M,P,O)===!1)return!1;break}}})}function v(b,A,E){var M=E;return y(b,function(P,k,D,O){k===0&&E===void 0?M=P:M=A(M,P,k,D,O)}),M}function _(b,A){if(A=A||{},!e.isObject(A))throw new Error("options is invalid");var E=A.featureIndex||0,M=A.multiFeatureIndex||0,P=A.geometryIndex||0,k=A.segmentIndex||0,D=A.properties,O;switch(b.type){case"FeatureCollection":E<0&&(E=b.features.length+E),D=D||b.features[E].properties,O=b.features[E].geometry;break;case"Feature":D=D||b.properties,O=b.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":O=b;break;default:throw new Error("geojson is invalid")}if(O===null)return null;var B=O.coordinates;switch(O.type){case"Point":case"MultiPoint":return null;case"LineString":return k<0&&(k=B.length+k-1),e.lineString([B[k],B[k+1]],D,A);case"Polygon":return P<0&&(P=B.length+P),k<0&&(k=B[P].length+k-1),e.lineString([B[P][k],B[P][k+1]],D,A);case"MultiLineString":return M<0&&(M=B.length+M),k<0&&(k=B[M].length+k-1),e.lineString([B[M][k],B[M][k+1]],D,A);case"MultiPolygon":return M<0&&(M=B.length+M),P<0&&(P=B[M].length+P),k<0&&(k=B[M][P].length-k-1),e.lineString([B[M][P][k],B[M][P][k+1]],D,A)}throw new Error("geojson is invalid")}function w(b,A){if(A=A||{},!e.isObject(A))throw new Error("options is invalid");var E=A.featureIndex||0,M=A.multiFeatureIndex||0,P=A.geometryIndex||0,k=A.coordIndex||0,D=A.properties,O;switch(b.type){case"FeatureCollection":E<0&&(E=b.features.length+E),D=D||b.features[E].properties,O=b.features[E].geometry;break;case"Feature":D=D||b.properties,O=b.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":O=b;break;default:throw new Error("geojson is invalid")}if(O===null)return null;var B=O.coordinates;switch(O.type){case"Point":return e.point(B,D,A);case"MultiPoint":return M<0&&(M=B.length+M),e.point(B[M],D,A);case"LineString":return k<0&&(k=B.length+k),e.point(B[k],D,A);case"Polygon":return P<0&&(P=B.length+P),k<0&&(k=B[P].length+k),e.point(B[P][k],D,A);case"MultiLineString":return M<0&&(M=B.length+M),k<0&&(k=B[M].length+k),e.point(B[M][k],D,A);case"MultiPolygon":return M<0&&(M=B.length+M),P<0&&(P=B[M].length+P),k<0&&(k=B[M][P].length-k),e.point(B[M][P][k],D,A)}throw new Error("geojson is invalid")}t.coordAll=l,t.coordEach=r,t.coordReduce=n,t.featureEach=o,t.featureReduce=s,t.findPoint=w,t.findSegment=_,t.flattenEach=h,t.flattenReduce=d,t.geomEach=u,t.geomReduce=c,t.lineEach=y,t.lineReduce=v,t.propEach=i,t.propReduce=a,t.segmentEach=p,t.segmentReduce=m}),_Pe=Ir(t=>{C(),Object.defineProperty(t,"__esModule",{value:!0});var e=zq();function r(n){var i=[1/0,1/0,-1/0,-1/0];return e.coordEach(n,function(a){i[0]>a[0]&&(i[0]=a[0]),i[1]>a[1]&&(i[1]=a[1]),i[2]<a[0]&&(i[2]=a[0]),i[3]<a[1]&&(i[3]=a[1])}),i}r.default=r,t.default=r}),xPe=Ir((t,e)=>{C();var r=vPe(),n=Bq(),i=zq(),a=_Pe().default,o=i.featureEach;i.coordEach,n.polygon;var s=n.featureCollection;function l(u){var c=new r(u);return c.insert=function(h){if(h.type!=="Feature")throw new Error("invalid feature");return h.bbox=h.bbox?h.bbox:a(h),r.prototype.insert.call(this,h)},c.load=function(h){var d=[];return Array.isArray(h)?h.forEach(function(p){if(p.type!=="Feature")throw new Error("invalid features");p.bbox=p.bbox?p.bbox:a(p),d.push(p)}):o(h,function(p){if(p.type!=="Feature")throw new Error("invalid features");p.bbox=p.bbox?p.bbox:a(p),d.push(p)}),r.prototype.load.call(this,d)},c.remove=function(h,d){if(h.type!=="Feature")throw new Error("invalid feature");return h.bbox=h.bbox?h.bbox:a(h),r.prototype.remove.call(this,h,d)},c.clear=function(){return r.prototype.clear.call(this)},c.search=function(h){var d=r.prototype.search.call(this,this.toBBox(h));return s(d)},c.collides=function(h){return r.prototype.collides.call(this,this.toBBox(h))},c.all=function(){var h=r.prototype.all.call(this);return s(h)},c.toJSON=function(){return r.prototype.toJSON.call(this)},c.fromJSON=function(h){return r.prototype.fromJSON.call(this,h)},c.toBBox=function(h){var d;if(h.bbox)d=h.bbox;else if(Array.isArray(h)&&h.length===4)d=h;else if(Array.isArray(h)&&h.length===6)d=[h[0],h[1],h[3],h[4]];else if(h.type==="Feature")d=a(h);else if(h.type==="FeatureCollection")d=a(h);else throw new Error("invalid geojson");return{minX:d[0],minY:d[1],maxX:d[2],maxY:d[3]}},c}e.exports=l,e.exports.default=l}),$u=Ir(t=>{C(),t.__esModule=!0,t.extend=a,t.indexOf=u,t.escapeExpression=c,t.isEmpty=h,t.createFrame=d,t.blockParams=p,t.appendContextPath=m;var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},r=/[&<>"'`=]/g,n=/[&<>"'`=]/;function i(y){return e[y]}function a(y){for(var v=1;v<arguments.length;v++)for(var _ in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],_)&&(y[_]=arguments[v][_]);return y}var o=Object.prototype.toString;t.toString=o;var s=function(y){return typeof y=="function"};s(/x/)&&(t.isFunction=s=function(y){return typeof y=="function"&&o.call(y)==="[object Function]"}),t.isFunction=s;var l=Array.isArray||function(y){return y&&typeof y=="object"?o.call(y)==="[object Array]":!1};t.isArray=l;function u(y,v){for(var _=0,w=y.length;_<w;_++)if(y[_]===v)return _;return-1}function c(y){if(typeof y!="string"){if(y&&y.toHTML)return y.toHTML();if(y==null)return"";if(!y)return y+"";y=""+y}return n.test(y)?y.replace(r,i):y}function h(y){return!y&&y!==0?!0:!!(l(y)&&y.length===0)}function d(y){var v=a({},y);return v._parent=y,v}function p(y,v){return y.path=v,y}function m(y,v){return(y?y+".":"")+v}}),Qp=Ir((t,e)=>{C(),t.__esModule=!0;var r=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];function n(i,a){var o=a&&a.loc,s=void 0,l=void 0,u=void 0,c=void 0;o&&(s=o.start.line,l=o.end.line,u=o.start.column,c=o.end.column,i+=" - "+s+":"+u);for(var h=Error.prototype.constructor.call(this,i),d=0;d<r.length;d++)this[r[d]]=h[r[d]];Error.captureStackTrace&&Error.captureStackTrace(this,n);try{o&&(this.lineNumber=s,this.endLineNumber=l,Object.defineProperty?(Object.defineProperty(this,"column",{value:u,enumerable:!0}),Object.defineProperty(this,"endColumn",{value:c,enumerable:!0})):(this.column=u,this.endColumn=c))}catch{}}n.prototype=new Error,t.default=n,e.exports=t.default}),bPe=Ir((t,e)=>{C(),t.__esModule=!0;var r=$u();t.default=function(n){n.registerHelper("blockHelperMissing",function(i,a){var o=a.inverse,s=a.fn;if(i===!0)return s(this);if(i===!1||i==null)return o(this);if(r.isArray(i))return i.length>0?(a.ids&&(a.ids=[a.name]),n.helpers.each(i,a)):o(this);if(a.data&&a.ids){var l=r.createFrame(a.data);l.contextPath=r.appendContextPath(a.data.contextPath,a.name),a={data:l}}return s(i,a)})},e.exports=t.default}),wPe=Ir((t,e)=>{C(),t.__esModule=!0;function r(o){return o&&o.__esModule?o:{default:o}}var n=$u(),i=Qp(),a=r(i);t.default=function(o){o.registerHelper("each",function(s,l){if(!l)throw new a.default("Must pass iterator to #each");var u=l.fn,c=l.inverse,h=0,d="",p=void 0,m=void 0;l.data&&l.ids&&(m=n.appendContextPath(l.data.contextPath,l.ids[0])+"."),n.isFunction(s)&&(s=s.call(this)),l.data&&(p=n.createFrame(l.data));function y(A,E,M){p&&(p.key=A,p.index=E,p.first=E===0,p.last=!!M,m&&(p.contextPath=m+A)),d=d+u(s[A],{data:p,blockParams:n.blockParams([s[A],A],[m+A,null])})}if(s&&typeof s=="object")if(n.isArray(s))for(var v=s.length;h<v;h++)h in s&&y(h,h,h===s.length-1);else if(typeof Symbol=="function"&&s[Symbol.iterator]){for(var _=[],w=s[Symbol.iterator](),b=w.next();!b.done;b=w.next())_.push(b.value);s=_;for(var v=s.length;h<v;h++)y(h,h,h===s.length-1)}else(function(){var A=void 0;Object.keys(s).forEach(function(E){A!==void 0&&y(A,h-1),A=E,h++}),A!==void 0&&y(A,h-1,!0)})();return h===0&&(d=c(this)),d})},e.exports=t.default}),APe=Ir((t,e)=>{C(),t.__esModule=!0;function r(a){return a&&a.__esModule?a:{default:a}}var n=Qp(),i=r(n);t.default=function(a){a.registerHelper("helperMissing",function(){if(arguments.length!==1)throw new i.default('Missing helper: "'+arguments[arguments.length-1].name+'"')})},e.exports=t.default}),SPe=Ir((t,e)=>{C(),t.__esModule=!0;function r(o){return o&&o.__esModule?o:{default:o}}var n=$u(),i=Qp(),a=r(i);t.default=function(o){o.registerHelper("if",function(s,l){if(arguments.length!=2)throw new a.default("#if requires exactly one argument");return n.isFunction(s)&&(s=s.call(this)),!l.hash.includeZero&&!s||n.isEmpty(s)?l.inverse(this):l.fn(this)}),o.registerHelper("unless",function(s,l){if(arguments.length!=2)throw new a.default("#unless requires exactly one argument");return o.helpers.if.call(this,s,{fn:l.inverse,inverse:l.fn,hash:l.hash})})},e.exports=t.default}),EPe=Ir((t,e)=>{C(),t.__esModule=!0,t.default=function(r){r.registerHelper("log",function(){for(var n=[void 0],i=arguments[arguments.length-1],a=0;a<arguments.length-1;a++)n.push(arguments[a]);var o=1;i.hash.level!=null?o=i.hash.level:i.data&&i.data.level!=null&&(o=i.data.level),n[0]=o,r.log.apply(r,n)})},e.exports=t.default}),IPe=Ir((t,e)=>{C(),t.__esModule=!0,t.default=function(r){r.registerHelper("lookup",function(n,i,a){return n&&a.lookupProperty(n,i)})},e.exports=t.default}),CPe=Ir((t,e)=>{C(),t.__esModule=!0;function r(o){return o&&o.__esModule?o:{default:o}}var n=$u(),i=Qp(),a=r(i);t.default=function(o){o.registerHelper("with",function(s,l){if(arguments.length!=2)throw new a.default("#with requires exactly one argument");n.isFunction(s)&&(s=s.call(this));var u=l.fn;if(n.isEmpty(s))return l.inverse(this);var c=l.data;return l.data&&l.ids&&(c=n.createFrame(l.data),c.contextPath=n.appendContextPath(l.data.contextPath,l.ids[0])),u(s,{data:c,blockParams:n.blockParams([s],[c&&c.contextPath])})})},e.exports=t.default}),Fq=Ir(t=>{C(),t.__esModule=!0,t.registerDefaultHelpers=v,t.moveHelperToHooks=_;function e(w){return w&&w.__esModule?w:{default:w}}var r=bPe(),n=e(r),i=wPe(),a=e(i),o=APe(),s=e(o),l=SPe(),u=e(l),c=EPe(),h=e(c),d=IPe(),p=e(d),m=CPe(),y=e(m);function v(w){n.default(w),a.default(w),s.default(w),u.default(w),h.default(w),p.default(w),y.default(w)}function _(w,b,A){w.helpers[b]&&(w.hooks[b]=w.helpers[b],A||delete w.helpers[b])}}),MPe=Ir((t,e)=>{C(),t.__esModule=!0;var r=$u();t.default=function(n){n.registerDecorator("inline",function(i,a,o,s){var l=i;return a.partials||(a.partials={},l=function(u,c){var h=o.partials;o.partials=r.extend({},h,a.partials);var d=i(u,c);return o.partials=h,d}),a.partials[s.args[0]]=s.fn,l})},e.exports=t.default}),TPe=Ir(t=>{C(),t.__esModule=!0,t.registerDefaultDecorators=i;function e(a){return a&&a.__esModule?a:{default:a}}var r=MPe(),n=e(r);function i(a){n.default(a)}}),Rq=Ir((t,e)=>{C(),t.__esModule=!0;var r=$u(),n={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(i){if(typeof i=="string"){var a=r.indexOf(n.methodMap,i.toLowerCase());a>=0?i=a:i=parseInt(i,10)}return i},log:function(i){if(i=n.lookupLevel(i),typeof console<"u"&&n.lookupLevel(n.level)<=i){var a=n.methodMap[i];console[a]||(a="log");for(var o=arguments.length,s=Array(o>1?o-1:0),l=1;l<o;l++)s[l-1]=arguments[l];console[a].apply(console,s)}}};t.default=n,e.exports=t.default}),PPe=Ir(t=>{C(),t.__esModule=!0,t.createNewLookupObject=r;var e=$u();function r(){for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];return e.extend.apply(void 0,[Object.create(null)].concat(i))}}),Lq=Ir(t=>{C(),t.__esModule=!0,t.createProtoAccessControl=o,t.resultIsAllowed=s,t.resetLoggedProperties=c;function e(h){return h&&h.__esModule?h:{default:h}}var r=PPe(),n=Rq(),i=e(n),a=Object.create(null);function o(h){var d=Object.create(null);d.constructor=!1,d.__defineGetter__=!1,d.__defineSetter__=!1,d.__lookupGetter__=!1;var p=Object.create(null);return p.__proto__=!1,{properties:{whitelist:r.createNewLookupObject(p,h.allowedProtoProperties),defaultValue:h.allowProtoPropertiesByDefault},methods:{whitelist:r.createNewLookupObject(d,h.allowedProtoMethods),defaultValue:h.allowProtoMethodsByDefault}}}function s(h,d,p){return l(typeof h=="function"?d.methods:d.properties,p)}function l(h,d){return h.whitelist[d]!==void 0?h.whitelist[d]===!0:h.defaultValue!==void 0?h.defaultValue:(u(d),!1)}function u(h){a[h]!==!0&&(a[h]=!0,i.default.log("error",'Handlebars: Access has been denied to resolve the property "'+h+`" because it is not an "own property" of its parent.
You can add a runtime option to disable the check or this warning:
See https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details`))}function c(){Object.keys(a).forEach(function(h){delete a[h]})}}),Nq=Ir(t=>{C(),t.__esModule=!0,t.HandlebarsEnvironment=y;function e(_){return _&&_.__esModule?_:{default:_}}var r=$u(),n=Qp(),i=e(n),a=Fq(),o=TPe(),s=Rq(),l=e(s),u=Lq(),c="4.7.8";t.VERSION=c;var h=8;t.COMPILER_REVISION=h;var d=7;t.LAST_COMPATIBLE_COMPILER_REVISION=d;var p={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"};t.REVISION_CHANGES=p;var m="[object Object]";function y(_,w,b){this.helpers=_||{},this.partials=w||{},this.decorators=b||{},a.registerDefaultHelpers(this),o.registerDefaultDecorators(this)}y.prototype={constructor:y,logger:l.default,log:l.default.log,registerHelper:function(_,w){if(r.toString.call(_)===m){if(w)throw new i.default("Arg not supported with multiple helpers");r.extend(this.helpers,_)}else this.helpers[_]=w},unregisterHelper:function(_){delete this.helpers[_]},registerPartial:function(_,w){if(r.toString.call(_)===m)r.extend(this.partials,_);else{if(typeof w>"u")throw new i.default('Attempting to register a partial called "'+_+'" as undefined');this.partials[_]=w}},unregisterPartial:function(_){delete this.partials[_]},registerDecorator:function(_,w){if(r.toString.call(_)===m){if(w)throw new i.default("Arg not supported with multiple decorators");r.extend(this.decorators,_)}else this.decorators[_]=w},unregisterDecorator:function(_){delete this.decorators[_]},resetLoggedPropertyAccesses:function(){u.resetLoggedProperties()}};var v=l.default.log;t.log=v,t.createFrame=r.createFrame,t.logger=l.default}),DPe=Ir((t,e)=>{C(),t.__esModule=!0;function r(n){this.string=n}r.prototype.toString=r.prototype.toHTML=function(){return""+this.string},t.default=r,e.exports=t.default}),kPe=Ir(t=>{C(),t.__esModule=!0,t.wrapHelper=e;function e(r,n){if(typeof r!="function")return r;var i=function(){var a=arguments[arguments.length-1];return arguments[arguments.length-1]=n(a),r.apply(this,arguments)};return i}}),OPe=Ir(t=>{C(),t.__esModule=!0,t.checkRevision=h,t.template=d,t.wrapProgram=p,t.resolvePartial=m,t.invokePartial=y,t.noop=v;function e(E){return E&&E.__esModule?E:{default:E}}function r(E){if(E&&E.__esModule)return E;var M={};if(E!=null)for(var P in E)Object.prototype.hasOwnProperty.call(E,P)&&(M[P]=E[P]);return M.default=E,M}var n=$u(),i=r(n),a=Qp(),o=e(a),s=Nq(),l=Fq(),u=kPe(),c=Lq();function h(E){var M=E&&E[0]||1,P=s.COMPILER_REVISION;if(!(M>=s.LAST_COMPATIBLE_COMPILER_REVISION&&M<=s.COMPILER_REVISION))if(M<s.LAST_COMPATIBLE_COMPILER_REVISION){var k=s.REVISION_CHANGES[P],D=s.REVISION_CHANGES[M];throw new o.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+k+") or downgrade your runtime to an older version ("+D+").")}else throw new o.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+E[1]+").")}function d(E,M){if(!M)throw new o.default("No environment passed to template");if(!E||!E.main)throw new o.default("Unknown template object: "+typeof E);E.main.decorator=E.main_d,M.VM.checkRevision(E.compiler);var P=E.compiler&&E.compiler[0]===7;function k(B,L,R){R.hash&&(L=i.extend({},L,R.hash),R.ids&&(R.ids[0]=!0)),B=M.VM.resolvePartial.call(this,B,L,R);var T=i.extend({},R,{hooks:this.hooks,protoAccessControl:this.protoAccessControl}),N=M.VM.invokePartial.call(this,B,L,T);if(N==null&&M.compile&&(R.partials[R.name]=M.compile(B,E.compilerOptions,M),N=R.partials[R.name](L,T)),N!=null){if(R.indent){for(var $=N.split(`
`),V=0,G=$.length;V<G&&!(!$[V]&&V+1===G);V++)$[V]=R.indent+$[V];N=$.join(`
`)}return N}else throw new o.default("The partial "+R.name+" could not be compiled when running in runtime-only mode")}var D={strict:function(B,L,R){if(!B||!(L in B))throw new o.default('"'+L+'" not defined in '+B,{loc:R});return D.lookupProperty(B,L)},lookupProperty:function(B,L){var R=B[L];if(R==null||Object.prototype.hasOwnProperty.call(B,L)||c.resultIsAllowed(R,D.protoAccessControl,L))return R},lookup:function(B,L){for(var R=B.length,T=0;T<R;T++){var N=B[T]&&D.lookupProperty(B[T],L);if(N!=null)return B[T][L]}},lambda:function(B,L){return typeof B=="function"?B.call(L):B},escapeExpression:i.escapeExpression,invokePartial:k,fn:function(B){var L=E[B];return L.decorator=E[B+"_d"],L},programs:[],program:function(B,L,R,T,N){var $=this.programs[B],V=this.fn(B);return L||N||T||R?$=p(this,B,V,L,R,T,N):$||($=this.programs[B]=p(this,B,V)),$},data:function(B,L){for(;B&&L--;)B=B._parent;return B},mergeIfNeeded:function(B,L){var R=B||L;return B&&L&&B!==L&&(R=i.extend({},L,B)),R},nullContext:Object.seal({}),noop:M.VM.noop,compilerInfo:E.compiler};function O(B){var L=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],R=L.data;O._setup(L),!L.partial&&E.useData&&(R=_(B,R));var T=void 0,N=E.useBlockParams?[]:void 0;E.useDepths&&(L.depths?T=B!=L.depths[0]?[B].concat(L.depths):L.depths:T=[B]);function $(V){return""+E.main(D,V,D.helpers,D.partials,R,N,T)}return $=w(E.main,$,D,L.depths||[],R,N),$(B,L)}return O.isTop=!0,O._setup=function(B){if(B.partial)D.protoAccessControl=B.protoAccessControl,D.helpers=B.helpers,D.partials=B.partials,D.decorators=B.decorators,D.hooks=B.hooks;else{var L=i.extend({},M.helpers,B.helpers);b(L,D),D.helpers=L,E.usePartial&&(D.partials=D.mergeIfNeeded(B.partials,M.partials)),(E.usePartial||E.useDecorators)&&(D.decorators=i.extend({},M.decorators,B.decorators)),D.hooks={},D.protoAccessControl=c.createProtoAccessControl(B);var R=B.allowCallsToHelperMissing||P;l.moveHelperToHooks(D,"helperMissing",R),l.moveHelperToHooks(D,"blockHelperMissing",R)}},O._child=function(B,L,R,T){if(E.useBlockParams&&!R)throw new o.default("must pass block params");if(E.useDepths&&!T)throw new o.default("must pass parent depths");return p(D,B,E[B],L,0,R,T)},O}function p(E,M,P,k,D,O,B){function L(R){var T=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],N=B;return B&&R!=B[0]&&!(R===E.nullContext&&B[0]===null)&&(N=[R].concat(B)),P(E,R,E.helpers,E.partials,T.data||k,O&&[T.blockParams].concat(O),N)}return L=w(P,L,E,B,k,O),L.program=M,L.depth=B?B.length:0,L.blockParams=D||0,L}function m(E,M,P){return E?!E.call&&!P.name&&(P.name=E,E=P.partials[E]):P.name==="@partial-block"?E=P.data["partial-block"]:E=P.partials[P.name],E}function y(E,M,P){var k=P.data&&P.data["partial-block"];P.partial=!0,P.ids&&(P.data.contextPath=P.ids[0]||P.data.contextPath);var D=void 0;if(P.fn&&P.fn!==v&&(function(){P.data=s.createFrame(P.data);var O=P.fn;D=P.data["partial-block"]=function(B){var L=arguments.length<=1||arguments[1]===void 0?{}:arguments[1];return L.data=s.createFrame(L.data),L.data["partial-block"]=k,O(B,L)},O.partials&&(P.partials=i.extend({},P.partials,O.partials))})(),E===void 0&&D&&(E=D),E===void 0)throw new o.default("The partial "+P.name+" could not be found");if(E instanceof Function)return E(M,P)}function v(){return""}function _(E,M){return(!M||!("root"in M))&&(M=M?s.createFrame(M):{},M.root=E),M}function w(E,M,P,k,D,O){if(E.decorator){var B={};M=E.decorator(M,B,P,k&&k[0],D,O,k),i.extend(M,B)}return M}function b(E,M){Object.keys(E).forEach(function(P){var k=E[P];E[P]=A(k,M)})}function A(E,M){var P=M.lookupProperty;return u.wrapHelper(E,function(k){return i.extend({lookupProperty:P},k)})}}),BPe=Ir((t,e)=>{C(),t.__esModule=!0,t.default=function(r){(function(){typeof globalThis!="object"&&(Object.prototype.__defineGetter__("__magic__",function(){return this}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__)})();var n=globalThis.Handlebars;r.noConflict=function(){return globalThis.Handlebars===r&&(globalThis.Handlebars=n),r}},e.exports=t.default}),zPe=Ir((t,e)=>{C(),t.__esModule=!0;function r(w){return w&&w.__esModule?w:{default:w}}function n(w){if(w&&w.__esModule)return w;var b={};if(w!=null)for(var A in w)Object.prototype.hasOwnProperty.call(w,A)&&(b[A]=w[A]);return b.default=w,b}var i=Nq(),a=n(i),o=DPe(),s=r(o),l=Qp(),u=r(l),c=$u(),h=n(c),d=OPe(),p=n(d),m=BPe(),y=r(m);function v(){var w=new a.HandlebarsEnvironment;return h.extend(w,a),w.SafeString=s.default,w.Exception=u.default,w.Utils=h,w.escapeExpression=h.escapeExpression,w.VM=p,w.template=function(b){return p.template(b,w)},w}var _=v();_.create=v,y.default(_),_.default=_,t.default=_,e.exports=t.default}),FPe=Ir((t,e)=>{C(),e.exports=zPe().default});C();C();C();C();C();C();var $q=t=>t!=null,RPe=(function(){let t=globalThis.fetch;return{fetch(...e){if(!$q(t))throw new Error("fetch is not available in your environment. Pass your own function into `setFetchFn` (node-fetch, etc)");return t?.(...e)},setFetch(e){t=e}}})(),LPe=RPe.fetch,Uq=["websdk","web","webv2","kiosk-v2","mobile","iossdk","androidsdk","reactnativesdk","gen7","bespoke","reactsdk"],jq=Uq[0],Vq="https://api-gateway.mappedin.com/track-analytics/a/",Gq="deny-watchposition",Zq="load-mapview",Wq="load-mapdata",Hq="change-language",Xq="query-directions",dc,hl,Gd,KM,d2,qq=class{constructor(){K(this,Gd),K(this,dc,Object.freeze({})),K(this,hl),S(this,"oneTimeEventsSent",new Set),S(this,"sendGetDirectionsEvent",jme((t,e,r)=>{let n={start:t,end:e,type:"location_to_location"};return r!==void 0&&(n.accessible=r),this.sendAnalyticEvent(Xq,n)},2500)),ne(this,hl,ot(this,Gd,d2).call(this,f(this,dc)))}init(t){this.reset(),this.updateStateWithOptions(t)}reset(){ne(this,dc,{}),ne(this,hl,ot(this,Gd,d2).call(this,{})),this.oneTimeEventsSent.clear()}updateStateWithOptions(t){return ne(this,dc,Object.freeze(Object.assign({},f(this,dc),t))),ne(this,hl,ot(this,Gd,d2).call(this,t)),ot(this,Gd,KM).call(this,f(this,hl)),f(this,hl)}updateState(t){let e=ae({},t);e.mapId&&(e.analyticsBaseUrl=QM(lt(ae({},f(this,hl)),{mapId:e.mapId}))),e.context&&(e.context=Kq(e.context)),e.baseUri&&(e.analyticsBaseUrl=QM({baseUri:e.baseUri,mapId:f(this,hl).mapId})),Object.assign(f(this,hl),e),this.handleStateUpdate(t),ot(this,Gd,KM).call(this,e)}handleStateUpdate(t){var e;(e=t.userPosition)!=null&&e.floorLevel?this.sendBlueDotEvents("found-floor"):t.userPosition&&this.sendBlueDotEvents("found-position")}get authReady(){let{key:t,secret:e,accessToken:r}=this.getState();return!!(t&&e)||!!r}getState(){return f(this,hl)}getContext(){return this.getState().context||f(this,dc).context||jq}getSessionId(){return this.getState().sessionId||f(this,dc).sessionId||Jq()}getDeviceId(){return this.getState().deviceId||f(this,dc).deviceId||Yq()}sendAnalyticEvent(t,e={}){let r=this.getState(),n=NPe(r.analyticsBaseUrl,t),i={"mi-context":this.getContext(),"mi-session":this.getSessionId(),"mi-device":this.getDeviceId()};if(r.logEvents&&Be.log("Analytics.track",n,i),!r.sendEvents)return Promise.resolve();if(!this.authReady)return Be.warn("Auth needs to be ready to send analytics.");let a=lt(ae({},e),{g:r.geolocationMode,sdk_version:r.version});return r.userPosition&&Object.assign(a,r.userPosition),i["Content-Type"]="application/json",r.accessToken?i.Authorization="Bearer ".concat(r.accessToken):r.noAuth||r.secret&&r.key&&(i["x-mappedin-key"]=btoa(r.key),i["x-mappedin-secret"]=btoa(r.secret)),LPe(n,{method:"POST",mode:"cors",headers:i,body:JSON.stringify(a)})}capture(t,e){if(UPe.includes(t))return Be.warn("".concat(t," event is sent internally.")),Promise.resolve();let r=$Pe.includes(t)?t.slice(1):t;return this.sendAnalyticEvent(r,e)}sendGetMapDataEvent(t){return this.sendAnalyticEvent(Wq,t)}sendChangeLanguageEvent(t){return this.sendAnalyticEvent(Hq,t)}sendWatchPositionDenied(){return this.sendAnalyticEvent(Gq)}sendMapViewLoadedEvent({firstRenderDuration:t,dimension:e,collisionWorkerDisabled:r,outdoorsWorkerDisabled:n}){return this.sendAnalyticEvent(Zq,{type:"3d",firstRenderDuration:t,width:e.width,height:e.height,devicePixelRatio:globalThis.devicePixelRatio||1,collisionWorkerDisabled:r,outdoorsWorkerDisabled:n})}sendBlueDotEvents(t){if(!((t==="found-floor"||t==="found-position")&&this.oneTimeEventsSent.has(t)))return this.oneTimeEventsSent.add(t),this.sendAnalyticEvent(t)}};dc=new WeakMap,hl=new WeakMap,Gd=new WeakSet,KM=function(t){t.sessionId&&Mg.getInstance().saveSessionData("id",t.sessionId),t.deviceId&&Mg.getInstance().saveLocalData("deviceId",t.deviceId)},d2=function(t){var e,r,n,i;let a=(e=t.baseUri)!=null?e:Vq;return{baseUri:a,analyticsBaseUrl:QM(lt(ae({},t),{baseUri:a})),version:((r=Oi?.env)==null?void 0:r.npm_package_version)||"v6",deviceId:t.deviceId||Yq(),accessToken:t.accessToken,mapId:t.mapId,sessionId:t.sessionId||Jq(),platformString:t.platformString||"",context:Kq(t.context)||jq,geolocationMode:!1,sendEvents:(n=t.sendEvents)!=null?n:!0,logEvents:(i=t.logEvents)!=null?i:!1,noAuth:t.noAuth||!1,key:t.key,secret:t.secret}};function QM({mapId:t,baseUri:e=Vq}){return"".concat(e).concat(t,"/")}function Yq(){return Mg.getInstance().loadLocalData("deviceId")}function Jq(){return Mg.getInstance().loadSessionData("id")}function NPe(t,e){return t+e}function Kq(t){return Uq.find(e=>e===t)}var $Pe=["$select-location","$select-category","$query-suggest","$query-search"],UPe=[Zq,Wq,Xq,Gq,Hq];new qq;var dl,jPe=class{constructor(t){K(this,dl),S(this,"capture"),S(this,"updateState"),ne(this,dl,t),this.capture=f(this,dl).capture.bind(f(this,dl)),this.updateState=f(this,dl).updateState.bind(f(this,dl))}getState(){let t=f(this,dl).getState(),{sessionId:e,deviceId:r}=t;return yu(t,["sessionId","deviceId"])}getContext(){return f(this,dl).getContext()}getSessionId(){return f(this,dl).getSessionId()}getDeviceId(){return f(this,dl).getDeviceId()}};dl=new WeakMap;C();C();var p2,f2,m2,VPe=class{constructor(t,e,{enabled:r=!1}={}){K(this,p2),S(this,"searchInstance"),K(this,f2),K(this,m2),S(this,"enabled",!1),ne(this,p2,t),ne(this,f2,e),ne(this,m2,()=>{var n;(n=this.searchInstance)==null||n.then(i=>i.populate())}),r&&this.enable()}async query(t,e={}){if(this.enabled||await this.enable(),!this.searchInstance)return Be.error("Search should be enabled by now"),{places:[],enterpriseLocations:[],enterpriseCategories:[]};try{return await(await this.searchInstance).search(t,e)}catch(r){return Be.error("Search.query failed due to",r),{places:[],enterpriseLocations:[],enterpriseCategories:[]}}}async suggest(t,e={}){if(this.enabled||await this.enable(),!this.searchInstance)return Be.error("Search should be enabled by now"),[];try{return await(await this.searchInstance).suggest(t,e)}catch(r){return Be.error("Search.suggest failed due to",r),[]}}async enable(){this.enabled||(this.enabled=!0,this.searchInstance||(this.searchInstance=N1(async()=>{const{InternalSearch:t}=await import("./internal-LMJ6JIND-DZyG3Ttv.js");return{InternalSearch:t}},__vite__mapDeps([3,1,2])).then(({InternalSearch:t})=>new t(f(this,p2)))),f(this,f2).on("language-change",f(this,m2)),await this.searchInstance)}};p2=new WeakMap,f2=new WeakMap,m2=new WeakMap;var Qq=new WeakMap,qf,li,GPe=class{constructor(t,{search:e}={}){K(this,qf),K(this,li),S(this,"Analytics"),S(this,"Search"),S(this,"Query"),S(this,"internal"),S(this,"on",(r,n)=>{f(this,qf).on(r,n)}),S(this,"off",(r,n)=>{f(this,qf).off(r,n)}),S(this,"__LEGACY_GET_DIRECTIONS_SYNC",(r,n,i)=>f(this,li).__LEGACY_GET_DIRECTIONS_SYNC(r,n,i)),S(this,"getDirections",(r,n,i)=>f(this,li).getDirections(r,n,i)),S(this,"__LEGACY_GET_DIRECTIONS_MULTI_DESTINATION_SYNC",(r,n,i)=>f(this,li).__LEGACY_GET_DIRECTIONS_MULTI_DESTINATION_SYNC(r,n,i)),S(this,"getDirectionsMultiDestination",(r,n,i)=>f(this,li).getDirectionsMultiDestination(r,n,i)),ne(this,qf,new wi),ne(this,li,t),Qq.set(this,t),this.Analytics=new jPe(t.Analytics),this.Query=t.Query,this.internal=t,this.Search=new VPe(this,t,{enabled:e?.enabled}),f(this,li).on("language-change",r=>{f(this,qf).publish("language-change",r)})}getEnv(){return f(this,li).getEnv()}getAccessToken(){var t;return(t=f(this,li).tokenManager)==null?void 0:t.getAccessToken().token}get mapName(){return f(this,li).mapName}get mapId(){var t;return(t=f(this,li).getMapDataOptions)==null?void 0:t.mapId}get mapCenter(){return f(this,li).mapCenter}get organizationId(){return f(this,li).organizationId}get outdoorViewToken(){return f(this,li).outdoorViewToken}getByType(t){return f(this,li).getByType(t)}getById(t,e){return f(this,li).getById(t,e)}getByExternalId(t,e){return f(this,li).getByExternalId(t,e)}getGeoJSON(t){return t.geoJSON}async changeLanguage(t){return f(this,li).changeLanguage(t)}get currentLanguage(){return f(this,li).currentLanguage}get naturalBearing(){var t;return(t=f(this,li).naturalBearing)!=null?t:0}getDistance(t,e){return f(this,li).getDistance(t,e)}toBinaryBundle({downloadLanguagePacks:t=!0}={}){return f(this,li).toBinaryBundle({downloadLanguagePacks:t})}toJSONBundle({downloadLanguagePacks:t=!0}={}){return f(this,li).toJSONBundle({downloadLanguagePacks:t})}};qf=new WeakMap,li=new WeakMap;var ZPe=GPe;function eT(t){let e=Qq.get(t);if(!e)throw new Error("MapDataInternal not found");return e}C();C();C();C();C();C();C();C();C();C();C();C();C();C();C();C();C();C();C();C();C();C();var cI={public:"public"};C();C();C();C();C();C();var ni={};So(ni,{HasPropertyKey:()=>WPe,IsArray:()=>el,IsAsyncIterator:()=>eY,IsBigInt:()=>Zk,IsBoolean:()=>f_,IsDate:()=>F3,IsFunction:()=>tY,IsIterator:()=>rY,IsNull:()=>nY,IsNumber:()=>pd,IsObject:()=>xi,IsRegExp:()=>Wk,IsString:()=>qi,IsSymbol:()=>iY,IsUint8Array:()=>x0,IsUndefined:()=>Ka});C();function WPe(t,e){return e in t}function eY(t){return xi(t)&&!el(t)&&!x0(t)&&Symbol.asyncIterator in t}function el(t){return Array.isArray(t)}function Zk(t){return typeof t=="bigint"}function f_(t){return typeof t=="boolean"}function F3(t){return t instanceof globalThis.Date}function tY(t){return typeof t=="function"}function rY(t){return xi(t)&&!el(t)&&!x0(t)&&Symbol.iterator in t}function nY(t){return t===null}function pd(t){return typeof t=="number"}function xi(t){return typeof t=="object"&&t!==null}function Wk(t){return t instanceof globalThis.RegExp}function qi(t){return typeof t=="string"}function iY(t){return typeof t=="symbol"}function x0(t){return t instanceof globalThis.Uint8Array}function Ka(t){return t===void 0}function HPe(t){return t.map(e=>V4(e))}function XPe(t){return new Date(t.getTime())}function qPe(t){return new Uint8Array(t)}function YPe(t){return new RegExp(t.source,t.flags)}function JPe(t){let e={};for(let r of Object.getOwnPropertyNames(t))e[r]=V4(t[r]);for(let r of Object.getOwnPropertySymbols(t))e[r]=V4(t[r]);return e}function V4(t){return el(t)?HPe(t):F3(t)?XPe(t):x0(t)?qPe(t):Wk(t)?YPe(t):xi(t)?JPe(t):t}function tl(t){return V4(t)}function KPe(t){return t.map(e=>Hk(e))}function Hk(t,e){return tl(t)}C();C();C();function aY(t){return un(t)&&Symbol.asyncIterator in t}function oY(t){return un(t)&&Symbol.iterator in t}function sY(t){return un(t)&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function lY(t){return t instanceof Promise}function bd(t){return t instanceof Date&&Number.isFinite(t.getTime())}function QPe(t){return t instanceof globalThis.Map}function eDe(t){return t instanceof globalThis.Set}function wd(t){return ArrayBuffer.isView(t)}function Xk(t){return t instanceof globalThis.Uint8Array}function Ar(t,e){return e in t}function un(t){return t!==null&&typeof t=="object"}function mn(t){return Array.isArray(t)&&!ArrayBuffer.isView(t)}function Cs(t){return t===void 0}function m_(t){return t===null}function b0(t){return typeof t=="boolean"}function cr(t){return typeof t=="number"}function uY(t){return Number.isInteger(t)}function js(t){return typeof t=="bigint"}function Ln(t){return typeof t=="string"}function R3(t){return typeof t=="function"}function g_(t){return typeof t=="symbol"}function Yc(t){return js(t)||b0(t)||m_(t)||cr(t)||Ln(t)||g_(t)||Cs(t)}var Bi;(function(t){t.InstanceMode="default",t.ExactOptionalPropertyTypes=!1,t.AllowArrayObject=!1,t.AllowNaN=!1,t.AllowNullVoid=!1;function e(o,s){return t.ExactOptionalPropertyTypes?s in o:o[s]!==void 0}t.IsExactOptionalProperty=e;function r(o){let s=un(o);return t.AllowArrayObject?s:s&&!mn(o)}t.IsObjectLike=r;function n(o){return r(o)&&!(o instanceof Date)&&!(o instanceof Uint8Array)}t.IsRecordLike=n;function i(o){return t.AllowNaN?cr(o):Number.isFinite(o)}t.IsNumberLike=i;function a(o){let s=Cs(o);return t.AllowNullVoid?s||o===null:s}t.IsVoidLike=a})(Bi||(Bi={}));C();function tDe(t){return globalThis.Object.freeze(t).map(e=>G4(e))}function rDe(t){let e={};for(let r of Object.getOwnPropertyNames(t))e[r]=G4(t[r]);for(let r of Object.getOwnPropertySymbols(t))e[r]=G4(t[r]);return globalThis.Object.freeze(e)}function G4(t){return el(t)?tDe(t):F3(t)||x0(t)||Wk(t)?t:xi(t)?rDe(t):t}function $t(t,e){let r=e!==void 0?ae(ae({},e),t):t;switch(Bi.InstanceMode){case"freeze":return G4(r);case"clone":return tl(r);default:return r}}C();var Un=class extends Error{constructor(t){super(t)}};C();C();C();var Uo=Symbol.for("TypeBox.Transform"),y_=Symbol.for("TypeBox.Readonly"),Ad=Symbol.for("TypeBox.Optional"),jg=Symbol.for("TypeBox.Hint"),xt=Symbol.for("TypeBox.Kind");function nDe(t){return xi(t)&&t[y_]==="Readonly"}function w0(t){return xi(t)&&t[Ad]==="Optional"}function cY(t){return Qr(t,"Any")}function v_(t){return Qr(t,"Array")}function qk(t){return Qr(t,"AsyncIterator")}function hY(t){return Qr(t,"BigInt")}function dY(t){return Qr(t,"Boolean")}function Yk(t){return Qr(t,"Constructor")}function iDe(t){return Qr(t,"Date")}function Jk(t){return Qr(t,"Function")}function L3(t){return Qr(t,"Integer")}function Gl(t){return Qr(t,"Intersect")}function Kk(t){return Qr(t,"Iterator")}function Qr(t,e){return xi(t)&&xt in t&&t[xt]===e}function __(t){return Qr(t,"Literal")}function ef(t){return Qr(t,"MappedKey")}function Ms(t){return Qr(t,"MappedResult")}function x_(t){return Qr(t,"Never")}function aDe(t){return Qr(t,"Not")}function oDe(t){return Qr(t,"Null")}function N3(t){return Qr(t,"Number")}function Uu(t){return Qr(t,"Object")}function $3(t){return Qr(t,"Promise")}function pY(t){return Qr(t,"Record")}function fY(t){return Qr(t,"Ref")}function mY(t){return Qr(t,"RegExp")}function Qk(t){return Qr(t,"String")}function sDe(t){return Qr(t,"Symbol")}function tf(t){return Qr(t,"TemplateLiteral")}function lDe(t){return Qr(t,"This")}function eO(t){return xi(t)&&Uo in t}function A0(t){return Qr(t,"Tuple")}function uDe(t){return Qr(t,"Undefined")}function Ba(t){return Qr(t,"Union")}function cDe(t){return Qr(t,"Uint8Array")}function hDe(t){return Qr(t,"Unknown")}function dDe(t){return Qr(t,"Unsafe")}function pDe(t){return Qr(t,"Void")}function S0(t){return xi(t)&&xt in t&&qi(t[xt])}function Vg(t){return cY(t)||v_(t)||dY(t)||hY(t)||qk(t)||Yk(t)||iDe(t)||Jk(t)||L3(t)||Gl(t)||Kk(t)||__(t)||ef(t)||Ms(t)||x_(t)||aDe(t)||oDe(t)||N3(t)||Uu(t)||$3(t)||pY(t)||fY(t)||mY(t)||Qk(t)||sDe(t)||tf(t)||lDe(t)||A0(t)||uDe(t)||Ba(t)||cDe(t)||hDe(t)||dDe(t)||pDe(t)||S0(t)}var ue={};So(ue,{IsAny:()=>_Y,IsArray:()=>xY,IsAsyncIterator:()=>bY,IsBigInt:()=>wY,IsBoolean:()=>AY,IsConstructor:()=>SY,IsDate:()=>EY,IsFunction:()=>IY,IsInteger:()=>CY,IsIntersect:()=>MY,IsIterator:()=>TY,IsKind:()=>QY,IsKindOf:()=>qr,IsLiteral:()=>b_,IsLiteralBoolean:()=>xDe,IsLiteralNumber:()=>DY,IsLiteralString:()=>PY,IsLiteralValue:()=>kY,IsMappedKey:()=>OY,IsMappedResult:()=>BY,IsNever:()=>zY,IsNot:()=>FY,IsNull:()=>RY,IsNumber:()=>LY,IsObject:()=>NY,IsOptional:()=>_De,IsPromise:()=>$Y,IsProperties:()=>nO,IsReadonly:()=>vDe,IsRecord:()=>UY,IsRecursive:()=>bDe,IsRef:()=>jY,IsRegExp:()=>VY,IsSchema:()=>xn,IsString:()=>GY,IsSymbol:()=>ZY,IsTemplateLiteral:()=>WY,IsThis:()=>HY,IsTransform:()=>bi,IsTuple:()=>XY,IsUint8Array:()=>qY,IsUndefined:()=>U3,IsUnion:()=>iO,IsUnionLiteral:()=>wDe,IsUnknown:()=>YY,IsUnsafe:()=>JY,IsVoid:()=>KY,TypeGuardUnknownTypeError:()=>fDe});C();var fDe=class extends Un{},mDe=["Any","Array","AsyncIterator","BigInt","Boolean","Constructor","Date","Enum","Function","Integer","Intersect","Iterator","Literal","MappedKey","MappedResult","Not","Null","Number","Object","Promise","Record","Ref","RegExp","String","Symbol","TemplateLiteral","This","Tuple","Undefined","Union","Uint8Array","Unknown","Void"];function gY(t){try{return new RegExp(t),!0}catch{return!1}}function tO(t){if(!qi(t))return!1;for(let e=0;e<t.length;e++){let r=t.charCodeAt(e);if(r>=7&&r<=13||r===27||r===127)return!1}return!0}function yY(t){return rO(t)||xn(t)}function _y(t){return Ka(t)||Zk(t)}function Fn(t){return Ka(t)||pd(t)}function rO(t){return Ka(t)||f_(t)}function wn(t){return Ka(t)||qi(t)}function gDe(t){return Ka(t)||qi(t)&&tO(t)&&gY(t)}function yDe(t){return Ka(t)||qi(t)&&tO(t)}function vY(t){return Ka(t)||xn(t)}function vDe(t){return xi(t)&&t[y_]==="Readonly"}function _De(t){return xi(t)&&t[Ad]==="Optional"}function _Y(t){return qr(t,"Any")&&wn(t.$id)}function xY(t){return qr(t,"Array")&&t.type==="array"&&wn(t.$id)&&xn(t.items)&&Fn(t.minItems)&&Fn(t.maxItems)&&rO(t.uniqueItems)&&vY(t.contains)&&Fn(t.minContains)&&Fn(t.maxContains)}function bY(t){return qr(t,"AsyncIterator")&&t.type==="AsyncIterator"&&wn(t.$id)&&xn(t.items)}function wY(t){return qr(t,"BigInt")&&t.type==="bigint"&&wn(t.$id)&&_y(t.exclusiveMaximum)&&_y(t.exclusiveMinimum)&&_y(t.maximum)&&_y(t.minimum)&&_y(t.multipleOf)}function AY(t){return qr(t,"Boolean")&&t.type==="boolean"&&wn(t.$id)}function SY(t){return qr(t,"Constructor")&&t.type==="Constructor"&&wn(t.$id)&&el(t.parameters)&&t.parameters.every(e=>xn(e))&&xn(t.returns)}function EY(t){return qr(t,"Date")&&t.type==="Date"&&wn(t.$id)&&Fn(t.exclusiveMaximumTimestamp)&&Fn(t.exclusiveMinimumTimestamp)&&Fn(t.maximumTimestamp)&&Fn(t.minimumTimestamp)&&Fn(t.multipleOfTimestamp)}function IY(t){return qr(t,"Function")&&t.type==="Function"&&wn(t.$id)&&el(t.parameters)&&t.parameters.every(e=>xn(e))&&xn(t.returns)}function CY(t){return qr(t,"Integer")&&t.type==="integer"&&wn(t.$id)&&Fn(t.exclusiveMaximum)&&Fn(t.exclusiveMinimum)&&Fn(t.maximum)&&Fn(t.minimum)&&Fn(t.multipleOf)}function nO(t){return xi(t)&&Object.entries(t).every(([e,r])=>tO(e)&&xn(r))}function MY(t){return qr(t,"Intersect")&&!(qi(t.type)&&t.type!=="object")&&el(t.allOf)&&t.allOf.every(e=>xn(e)&&!bi(e))&&wn(t.type)&&(rO(t.unevaluatedProperties)||vY(t.unevaluatedProperties))&&wn(t.$id)}function TY(t){return qr(t,"Iterator")&&t.type==="Iterator"&&wn(t.$id)&&xn(t.items)}function qr(t,e){return xi(t)&&xt in t&&t[xt]===e}function PY(t){return b_(t)&&qi(t.const)}function DY(t){return b_(t)&&pd(t.const)}function xDe(t){return b_(t)&&f_(t.const)}function b_(t){return qr(t,"Literal")&&wn(t.$id)&&kY(t.const)}function kY(t){return f_(t)||pd(t)||qi(t)}function OY(t){return qr(t,"MappedKey")&&el(t.keys)&&t.keys.every(e=>pd(e)||qi(e))}function BY(t){return qr(t,"MappedResult")&&nO(t.properties)}function zY(t){return qr(t,"Never")&&xi(t.not)&&Object.getOwnPropertyNames(t.not).length===0}function FY(t){return qr(t,"Not")&&xn(t.not)}function RY(t){return qr(t,"Null")&&t.type==="null"&&wn(t.$id)}function LY(t){return qr(t,"Number")&&t.type==="number"&&wn(t.$id)&&Fn(t.exclusiveMaximum)&&Fn(t.exclusiveMinimum)&&Fn(t.maximum)&&Fn(t.minimum)&&Fn(t.multipleOf)}function NY(t){return qr(t,"Object")&&t.type==="object"&&wn(t.$id)&&nO(t.properties)&&yY(t.additionalProperties)&&Fn(t.minProperties)&&Fn(t.maxProperties)}function $Y(t){return qr(t,"Promise")&&t.type==="Promise"&&wn(t.$id)&&xn(t.item)}function UY(t){return qr(t,"Record")&&t.type==="object"&&wn(t.$id)&&yY(t.additionalProperties)&&xi(t.patternProperties)&&(e=>{let r=Object.getOwnPropertyNames(e.patternProperties);return r.length===1&&gY(r[0])&&xi(e.patternProperties)&&xn(e.patternProperties[r[0]])})(t)}function bDe(t){return xi(t)&&jg in t&&t[jg]==="Recursive"}function jY(t){return qr(t,"Ref")&&wn(t.$id)&&qi(t.$ref)}function VY(t){return qr(t,"RegExp")&&wn(t.$id)&&qi(t.source)&&qi(t.flags)&&Fn(t.maxLength)&&Fn(t.minLength)}function GY(t){return qr(t,"String")&&t.type==="string"&&wn(t.$id)&&Fn(t.minLength)&&Fn(t.maxLength)&&gDe(t.pattern)&&yDe(t.format)}function ZY(t){return qr(t,"Symbol")&&t.type==="symbol"&&wn(t.$id)}function WY(t){return qr(t,"TemplateLiteral")&&t.type==="string"&&qi(t.pattern)&&t.pattern[0]==="^"&&t.pattern[t.pattern.length-1]==="$"}function HY(t){return qr(t,"This")&&wn(t.$id)&&qi(t.$ref)}function bi(t){return xi(t)&&Uo in t}function XY(t){return qr(t,"Tuple")&&t.type==="array"&&wn(t.$id)&&pd(t.minItems)&&pd(t.maxItems)&&t.minItems===t.maxItems&&(Ka(t.items)&&Ka(t.additionalItems)&&t.minItems===0||el(t.items)&&t.items.every(e=>xn(e)))}function U3(t){return qr(t,"Undefined")&&t.type==="undefined"&&wn(t.$id)}function wDe(t){return iO(t)&&t.anyOf.every(e=>PY(e)||DY(e))}function iO(t){return qr(t,"Union")&&wn(t.$id)&&xi(t)&&el(t.anyOf)&&t.anyOf.every(e=>xn(e))}function qY(t){return qr(t,"Uint8Array")&&t.type==="Uint8Array"&&wn(t.$id)&&Fn(t.minByteLength)&&Fn(t.maxByteLength)}function YY(t){return qr(t,"Unknown")&&wn(t.$id)}function JY(t){return qr(t,"Unsafe")}function KY(t){return qr(t,"Void")&&t.type==="void"&&wn(t.$id)}function QY(t){return xi(t)&&xt in t&&qi(t[xt])&&!mDe.includes(t[xt])}function xn(t){return xi(t)&&(_Y(t)||xY(t)||AY(t)||wY(t)||bY(t)||SY(t)||EY(t)||IY(t)||CY(t)||MY(t)||TY(t)||b_(t)||OY(t)||BY(t)||zY(t)||FY(t)||RY(t)||LY(t)||NY(t)||$Y(t)||UY(t)||jY(t)||VY(t)||GY(t)||ZY(t)||WY(t)||HY(t)||XY(t)||U3(t)||iO(t)||qY(t)||YY(t)||JY(t)||KY(t)||QY(t))}C();var ADe="(true|false)",g2="(0|[1-9][0-9]*)",eJ="(.*)",SDe="(?!.*)",Gg="^".concat(g2,"$"),Zg="^".concat(eJ,"$"),EDe="^".concat(SDe,"$");C();var Zc={};So(Zc,{Clear:()=>CDe,Delete:()=>MDe,Entries:()=>IDe,Get:()=>DDe,Has:()=>TDe,Set:()=>PDe});C();var E0=new Map;function IDe(){return new Map(E0)}function CDe(){return E0.clear()}function MDe(t){return E0.delete(t)}function TDe(t){return E0.has(t)}function PDe(t,e){E0.set(t,e)}function DDe(t){return E0.get(t)}var Ws={};So(Ws,{Clear:()=>ODe,Delete:()=>BDe,Entries:()=>kDe,Get:()=>RDe,Has:()=>zDe,Set:()=>FDe});C();var I0=new Map;function kDe(){return new Map(I0)}function ODe(){return I0.clear()}function BDe(t){return I0.delete(t)}function zDe(t){return I0.has(t)}function FDe(t,e){I0.set(t,e)}function RDe(t){return I0.get(t)}C();function LDe(t,e){return t.includes(e)}function NDe(t){return[...new Set(t)]}function $De(t,e){return t.filter(r=>e.includes(r))}function UDe(t,e){return t.reduce((r,n)=>$De(r,n),e)}function jDe(t){return t.length===1?t[0]:t.length>1?UDe(t.slice(1),t[0]):[]}function VDe(t){let e=[];for(let r of t)e.push(...r);return e}C();function T1(t){return $t({[xt]:"Any"},t)}C();function tJ(t,e){return $t({[xt]:"Array",type:"array",items:t},e)}C();function rJ(t,e){return $t({[xt]:"AsyncIterator",type:"AsyncIterator",items:t},e)}C();C();C();function GDe(t,e){let r=t,{[e]:n}=r;return yu(r,[O9(e)])}function qs(t,e){return e.reduce((r,n)=>GDe(r,n),t)}C();function to(t){return $t({[xt]:"Never",not:{}},t)}C();C();function za(t){return $t({[xt]:"MappedResult",properties:t})}C();C();function nJ(t,e,r){return $t({[xt]:"Constructor",type:"Constructor",parameters:t,returns:e},r)}C();function j3(t,e,r){return $t({[xt]:"Function",type:"Function",parameters:t,returns:e},r)}C();C();C();C();function tT(t,e){return $t({[xt]:"Union",anyOf:t},e)}function ZDe(t){return t.some(e=>w0(e))}function q8(t){return t.map(e=>w0(e)?WDe(e):e)}function WDe(t){return qs(t,[Ad])}function HDe(t,e){return ZDe(t)?nf(tT(q8(t),e)):tT(q8(t),e)}function C0(t,e){return t.length===0?to(e):t.length===1?$t(t[0],e):HDe(t,e)}C();function Eo(t,e){return t.length===0?to(e):t.length===1?$t(t[0],e):tT(t,e)}C();C();C();var Y8=class extends Un{};function XDe(t){return t.replace(/\\\$/g,"$").replace(/\\\*/g,"*").replace(/\\\^/g,"^").replace(/\\\|/g,"|").replace(/\\\(/g,"(").replace(/\\\)/g,")")}function aO(t,e,r){return t[e]===r&&t.charCodeAt(e-1)!==92}function Bc(t,e){return aO(t,e,"(")}function P1(t,e){return aO(t,e,")")}function iJ(t,e){return aO(t,e,"|")}function qDe(t){if(!(Bc(t,0)&&P1(t,t.length-1)))return!1;let e=0;for(let r=0;r<t.length;r++)if(Bc(t,r)&&(e+=1),P1(t,r)&&(e-=1),e===0&&r!==t.length-1)return!1;return!0}function YDe(t){return t.slice(1,t.length-1)}function JDe(t){let e=0;for(let r=0;r<t.length;r++)if(Bc(t,r)&&(e+=1),P1(t,r)&&(e-=1),iJ(t,r)&&e===0)return!0;return!1}function KDe(t){for(let e=0;e<t.length;e++)if(Bc(t,e))return!0;return!1}function QDe(t){let[e,r]=[0,0],n=[];for(let a=0;a<t.length;a++)if(Bc(t,a)&&(e+=1),P1(t,a)&&(e-=1),iJ(t,a)&&e===0){let o=t.slice(r,a);o.length>0&&n.push(Wg(o)),r=a+1}let i=t.slice(r);return i.length>0&&n.push(Wg(i)),n.length===0?{type:"const",const:""}:n.length===1?n[0]:{type:"or",expr:n}}function e5e(t){function e(i,a){if(!Bc(i,a))throw new Y8("TemplateLiteralParser: Index must point to open parens");let o=0;for(let s=a;s<i.length;s++)if(Bc(i,s)&&(o+=1),P1(i,s)&&(o-=1),o===0)return[a,s];throw new Y8("TemplateLiteralParser: Unclosed group parens in expression")}function r(i,a){for(let o=a;o<i.length;o++)if(Bc(i,o))return[a,o];return[a,i.length]}let n=[];for(let i=0;i<t.length;i++)if(Bc(t,i)){let[a,o]=e(t,i),s=t.slice(a,o+1);n.push(Wg(s)),i=o}else{let[a,o]=r(t,i),s=t.slice(a,o);s.length>0&&n.push(Wg(s)),i=o-1}return n.length===0?{type:"const",const:""}:n.length===1?n[0]:{type:"and",expr:n}}function Wg(t){return qDe(t)?Wg(YDe(t)):JDe(t)?QDe(t):KDe(t)?e5e(t):{type:"const",const:XDe(t)}}function oO(t){return Wg(t.slice(1,t.length-1))}var t5e=class extends Un{};function r5e(t){return t.type==="or"&&t.expr.length===2&&t.expr[0].type==="const"&&t.expr[0].const==="0"&&t.expr[1].type==="const"&&t.expr[1].const==="[1-9][0-9]*"}function n5e(t){return t.type==="or"&&t.expr.length===2&&t.expr[0].type==="const"&&t.expr[0].const==="true"&&t.expr[1].type==="const"&&t.expr[1].const==="false"}function i5e(t){return t.type==="const"&&t.const===".*"}function D1(t){return r5e(t)||i5e(t)?!1:n5e(t)?!0:t.type==="and"?t.expr.every(e=>D1(e)):t.type==="or"?t.expr.every(e=>D1(e)):t.type==="const"?!0:(()=>{throw new t5e("Unknown expression type")})()}function aJ(t){let e=oO(t.pattern);return D1(e)}C();var a5e=class extends Un{};function*oJ(t){if(t.length===1)return yield*ut(t[0]);for(let e of t[0])for(let r of oJ(t.slice(1)))yield"".concat(e).concat(r)}function*o5e(t){return yield*ut(oJ(t.expr.map(e=>[...V3(e)])))}function*s5e(t){for(let e of t.expr)yield*ut(V3(e))}function*l5e(t){return yield t.const}function*V3(t){return t.type==="and"?yield*ut(o5e(t)):t.type==="or"?yield*ut(s5e(t)):t.type==="const"?yield*ut(l5e(t)):(()=>{throw new a5e("Unknown expression")})()}function sO(t){let e=oO(t.pattern);return D1(e)?[...V3(e)]:[]}C();C();function Vi(t,e){return $t({[xt]:"Literal",const:t,type:typeof t},e)}C();function sJ(t){return $t({[xt]:"Boolean",type:"boolean"},t)}C();function lO(t){return $t({[xt]:"BigInt",type:"bigint"},t)}C();function M0(t){return $t({[xt]:"Number",type:"number"},t)}C();function fd(t){return $t({[xt]:"String",type:"string"},t)}function*u5e(t){let e=t.trim().replace(/"|'/g,"");return e==="boolean"?yield sJ():e==="number"?yield M0():e==="bigint"?yield lO():e==="string"?yield fd():yield(()=>{let r=e.split("|").map(n=>Vi(n.trim()));return r.length===0?to():r.length===1?r[0]:C0(r)})()}function*c5e(t){if(t[1]!=="{"){let e=Vi("$"),r=rT(t.slice(1));return yield*ut([e,...r])}for(let e=2;e<t.length;e++)if(t[e]==="}"){let r=u5e(t.slice(2,e)),n=rT(t.slice(e+1));return yield*ut([...r,...n])}yield Vi(t)}function*rT(t){for(let e=0;e<t.length;e++)if(t[e]==="$"){let r=Vi(t.slice(0,e)),n=c5e(t.slice(e));return yield*ut([r,...n])}yield Vi(t)}function h5e(t){return[...rT(t)]}C();var d5e=class extends Un{};function p5e(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function lJ(t,e){return tf(t)?t.pattern.slice(1,t.pattern.length-1):Ba(t)?"(".concat(t.anyOf.map(r=>lJ(r,e)).join("|"),")"):N3(t)||L3(t)||hY(t)?"".concat(e).concat(g2):Qk(t)?"".concat(e).concat(eJ):__(t)?"".concat(e).concat(p5e(t.const.toString())):dY(t)?"".concat(e).concat(ADe):(()=>{throw new d5e("Unexpected Kind '".concat(t[xt],"'"))})()}function J8(t){return"^".concat(t.map(e=>lJ(e,"")).join(""),"$")}C();function Z4(t){let e=sO(t).map(r=>Vi(r));return C0(e)}C();function uJ(t,e){let r=qi(t)?J8(h5e(t)):J8(t);return $t({[xt]:"TemplateLiteral",type:"string",pattern:r},e)}function f5e(t){return sO(t).map(e=>e.toString())}function m5e(t){let e=[];for(let r of t)e.push(...Sd(r));return e}function g5e(t){return[t.toString()]}function Sd(t){return[...new Set(tf(t)?f5e(t):Ba(t)?m5e(t.anyOf):__(t)?g5e(t.const):N3(t)?["[number]"]:L3(t)?["[number]"]:[])]}C();function y5e(t,e,r){let n={};for(let i of Object.getOwnPropertyNames(e))n[i]=cO(t,Sd(e[i]),r);return n}function v5e(t,e,r){return y5e(t,e.properties,r)}function _5e(t,e,r){let n=v5e(t,e,r);return za(n)}function cJ(t,e){return t.map(r=>hJ(r,e))}function x5e(t){return t.filter(e=>!x_(e))}function b5e(t,e){return mJ(x5e(cJ(t,e)))}function w5e(t){return t.some(e=>x_(e))?[]:t}function A5e(t,e){return C0(w5e(cJ(t,e)))}function S5e(t,e){return e in t?t[e]:e==="[number]"?C0(t):to()}function E5e(t,e){return e==="[number]"?t:to()}function I5e(t,e){return e in t?t[e]:to()}function hJ(t,e){var r;return Gl(t)?b5e(t.allOf,e):Ba(t)?A5e(t.anyOf,e):A0(t)?S5e((r=t.items)!=null?r:[],e):v_(t)?E5e(t.items,e):Uu(t)?I5e(t.properties,e):to()}function uO(t,e){return e.map(r=>hJ(t,r))}function K8(t,e){return C0(uO(t,e))}function cO(t,e,r){return Ms(e)?_5e(t,e,r):ef(e)?P5e(t,e,r):$t(Vg(e)?K8(t,Sd(e)):K8(t,e),r)}function C5e(t,e,r){return{[e]:cO(t,[e],tl(r))}}function M5e(t,e,r){return e.reduce((n,i)=>ae(ae({},n),C5e(t,i,r)),{})}function T5e(t,e,r){return M5e(t,e.keys,r)}function P5e(t,e,r){let n=T5e(t,e,r);return za(n)}C();function dJ(t,e){return $t({[xt]:"Iterator",type:"Iterator",items:t},e)}C();function D5e(t){let e=[];for(let r in t)w0(t[r])||e.push(r);return e}function k5e(t,e){let r=D5e(t),n=r.length>0?{[xt]:"Object",type:"object",properties:t,required:r}:{[xt]:"Object",type:"object",properties:t};return $t(n,e)}var ba=k5e;C();function pJ(t,e){return $t({[xt]:"Promise",type:"Promise",item:t},e)}C();C();function O5e(t){return $t(qs(t,[y_]))}function B5e(t){return $t(lt(ae({},t),{[y_]:"Readonly"}))}function z5e(t,e){return e===!1?O5e(t):B5e(t)}function rf(t,e){let r=e??!0;return Ms(t)?L5e(t,r):z5e(t,r)}function F5e(t,e){let r={};for(let n of globalThis.Object.getOwnPropertyNames(t))r[n]=rf(t[n],e);return r}function R5e(t,e){return F5e(t.properties,e)}function L5e(t,e){let r=R5e(t,e);return za(r)}C();function w_(t,e){return $t(t.length>0?{[xt]:"Tuple",type:"array",items:t,additionalItems:!1,minItems:t.length,maxItems:t.length}:{[xt]:"Tuple",type:"array",minItems:t.length,maxItems:t.length},e)}function fJ(t,e){return t in e?Ns(t,e[t]):za(e)}function N5e(t){return{[t]:Vi(t)}}function $5e(t){let e={};for(let r of t)e[r]=Vi(r);return e}function U5e(t,e){return LDe(e,t)?N5e(t):$5e(e)}function j5e(t,e){let r=U5e(t,e);return fJ(t,r)}function xy(t,e){return e.map(r=>Ns(t,r))}function V5e(t,e){let r={};for(let n of globalThis.Object.getOwnPropertyNames(e))r[n]=Ns(t,e[n]);return r}function Ns(t,e){var r;let n=ae({},e);return w0(e)?nf(Ns(t,qs(e,[Ad]))):nDe(e)?rf(Ns(t,qs(e,[y_]))):Ms(e)?fJ(t,e.properties):ef(e)?j5e(t,e.keys):Yk(e)?nJ(xy(t,e.parameters),Ns(t,e.returns),n):Jk(e)?j3(xy(t,e.parameters),Ns(t,e.returns),n):qk(e)?rJ(Ns(t,e.items),n):Kk(e)?dJ(Ns(t,e.items),n):Gl(e)?af(xy(t,e.allOf),n):Ba(e)?Eo(xy(t,e.anyOf),n):A0(e)?w_(xy(t,(r=e.items)!=null?r:[]),n):Uu(e)?ba(V5e(t,e.properties),n):v_(e)?tJ(Ns(t,e.items),n):$3(e)?pJ(Ns(t,e.item),n):e}function G5e(t,e){let r={};for(let n of t)r[n]=Ns(n,e);return r}function Z5e(t,e,r){let n=Vg(t)?Sd(t):t,i=e({[xt]:"MappedKey",keys:n}),a=G5e(n,i);return ba(a,r)}C();function W5e(t){return $t(qs(t,[Ad]))}function H5e(t){return $t(lt(ae({},t),{[Ad]:"Optional"}))}function X5e(t,e){return e===!1?W5e(t):H5e(t)}function nf(t,e){let r=e??!0;return Ms(t)?J5e(t,r):X5e(t,r)}function q5e(t,e){let r={};for(let n of globalThis.Object.getOwnPropertyNames(t))r[n]=nf(t[n],e);return r}function Y5e(t,e){return q5e(t.properties,e)}function J5e(t,e){let r=Y5e(t,e);return za(r)}C();function nT(t,e={}){let r=t.every(i=>Uu(i)),n=Vg(e.unevaluatedProperties)?{unevaluatedProperties:e.unevaluatedProperties}:{};return $t(e.unevaluatedProperties===!1||Vg(e.unevaluatedProperties)||r?lt(ae({},n),{[xt]:"Intersect",type:"object",allOf:t}):lt(ae({},n),{[xt]:"Intersect",allOf:t}),e)}function K5e(t){return t.every(e=>w0(e))}function Q5e(t){return qs(t,[Ad])}function Q8(t){return t.map(e=>w0(e)?Q5e(e):e)}function eke(t,e){return K5e(t)?nf(nT(Q8(t),e)):nT(Q8(t),e)}function mJ(t,e={}){if(t.length===0)return to(e);if(t.length===1)return $t(t[0],e);if(t.some(r=>eO(r)))throw new Error("Cannot intersect transform types");return eke(t,e)}C();function af(t,e){if(t.length===0)return to(e);if(t.length===1)return $t(t[0],e);if(t.some(r=>eO(r)))throw new Error("Cannot intersect transform types");return nT(t,e)}function gJ(t){return t.map(e=>hO(e))}function tke(t){return af(gJ(t))}function rke(t){return Eo(gJ(t))}function nke(t){return hO(t)}function hO(t){return Gl(t)?tke(t.allOf):Ba(t)?rke(t.anyOf):$3(t)?nke(t.item):t}function ike(t,e){return $t(hO(t),e)}C();C();C();C();function yJ(t){let e=[];for(let r of t)e.push(ju(r));return e}function ake(t){let e=yJ(t);return VDe(e)}function oke(t){let e=yJ(t);return jDe(e)}function ske(t){return t.map((e,r)=>r.toString())}function lke(t){return["[number]"]}function uke(t){return globalThis.Object.getOwnPropertyNames(t)}function cke(t){return iT?globalThis.Object.getOwnPropertyNames(t).map(e=>e[0]==="^"&&e[e.length-1]==="$"?e.slice(1,e.length-1):e):[]}function ju(t){var e;return Gl(t)?ake(t.allOf):Ba(t)?oke(t.anyOf):A0(t)?ske((e=t.items)!=null?e:[]):v_(t)?lke(t.items):Uu(t)?uke(t.properties):pY(t)?cke(t.patternProperties):[]}var iT=!1;function Hg(t){iT=!0;let e=ju(t);iT=!1;let r=e.map(n=>"(".concat(n,")"));return"^(".concat(r.join("|"),")$")}function hke(t){return t.map(e=>e==="[number]"?M0():Vi(e))}function vJ(t,e){if(Ms(t))return fke(t,e);{let r=ju(t),n=hke(r),i=C0(n);return $t(i,e)}}function dke(t,e){let r={};for(let n of globalThis.Object.getOwnPropertyNames(t))r[n]=vJ(t[n],tl(e));return r}function pke(t,e){return dke(t.properties,e)}function fke(t,e){let r=pke(t,e);return za(r)}C();function G3(t){let e=ju(t),r=uO(t,e);return e.map((n,i)=>[e[i],r[i]])}function mke(t){let e=[];for(let r of t)e.push(...ju(r));return NDe(e)}function gke(t){return t.filter(e=>!x_(e))}function yke(t,e){let r=[];for(let n of t)r.push(...uO(n,[e]));return gke(r)}function vke(t,e){let r={};for(let n of e)r[n]=mJ(yke(t,n));return r}function _ke(t,e){let r=mke(t),n=vke(t,r);return ba(n,e)}C();C();function _J(t){return $t({[xt]:"Date",type:"Date"},t)}C();function xJ(t){return $t({[xt]:"Null",type:"null"},t)}C();function bJ(t){return $t({[xt]:"Symbol",type:"symbol"},t)}C();function wJ(t){return $t({[xt]:"Undefined",type:"undefined"},t)}C();function AJ(t){return $t({[xt]:"Uint8Array",type:"Uint8Array"},t)}C();function A_(t){return $t({[xt]:"Unknown"},t)}function xke(t){return t.map(e=>dO(e,!1))}function bke(t){let e={};for(let r of globalThis.Object.getOwnPropertyNames(t))e[r]=rf(dO(t[r],!1));return e}function db(t,e){return e===!0?t:rf(t)}function dO(t,e){return eY(t)||rY(t)?db(T1(),e):el(t)?rf(w_(xke(t))):x0(t)?AJ():F3(t)?_J():xi(t)?db(ba(bke(t)),e):tY(t)?db(j3([],A_()),e):Ka(t)?wJ():nY(t)?xJ():iY(t)?bJ():Zk(t)?lO():pd(t)||f_(t)||qi(t)?Vi(t):ba({})}function wke(t,e){return $t(dO(t,!0),e)}C();function Ake(t,e){return w_(t.parameters,e)}C();function S_(t,e){return t.map(r=>Vu(r,e))}function Ske(t,e){let r={};for(let n of globalThis.Object.getOwnPropertyNames(t))r[n]=Vu(t[n],e);return r}function Eke(t,e){return t.parameters=S_(t.parameters,e),t.returns=Vu(t.returns,e),t}function Ike(t,e){return t.parameters=S_(t.parameters,e),t.returns=Vu(t.returns,e),t}function Cke(t,e){return t.allOf=S_(t.allOf,e),t}function Mke(t,e){return t.anyOf=S_(t.anyOf,e),t}function Tke(t,e){return Ka(t.items)||(t.items=S_(t.items,e)),t}function Pke(t,e){return t.items=Vu(t.items,e),t}function Dke(t,e){return t.properties=Ske(t.properties,e),t}function kke(t,e){return t.item=Vu(t.item,e),t}function Oke(t,e){return t.items=Vu(t.items,e),t}function Bke(t,e){return t.items=Vu(t.items,e),t}function zke(t,e){let r=e.find(i=>i.$id===t.$ref);if(r===void 0)throw Error("Unable to dereference schema with $id ".concat(t.$ref));let n=qs(r,["$id"]);return Vu(n,e)}function Fke(t,e){return Yk(t)?Eke(t,e):Jk(t)?Ike(t,e):Gl(t)?Cke(t,e):Ba(t)?Mke(t,e):A0(t)?Tke(t,e):v_(t)?Pke(t,e):Uu(t)?Dke(t,e):$3(t)?kke(t,e):qk(t)?Oke(t,e):Kk(t)?Bke(t,e):fY(t)?zke(t,e):t}function Vu(t,e){return Fke(Hk(t),KPe(e))}C();function Rke(t,e){if(Ka(t))throw new Error("Enum undefined or empty");let r=globalThis.Object.getOwnPropertyNames(t).filter(i=>isNaN(i)).map(i=>t[i]),n=[...new Set(r)].map(i=>Vi(i));return Eo(n,lt(ae({},e),{[jg]:"Enum"}))}C();C();C();var Lke=class extends Un{},We;(function(t){t[t.Union=0]="Union",t[t.True=1]="True",t[t.False=2]="False"})(We||(We={}));function Ys(t){return t===We.False?t:We.True}function T0(t){throw new Lke(t)}function Yi(t){return ue.IsNever(t)||ue.IsIntersect(t)||ue.IsUnion(t)||ue.IsUnknown(t)||ue.IsAny(t)}function Ji(t,e){return ue.IsNever(e)?IJ():ue.IsIntersect(e)?Z3(t,e):ue.IsUnion(e)?fO(t,e):ue.IsUnknown(e)?PJ():ue.IsAny(e)?pO():T0("StructuralRight")}function pO(t,e){return We.True}function Nke(t,e){return ue.IsIntersect(e)?Z3(t,e):ue.IsUnion(e)&&e.anyOf.some(r=>ue.IsAny(r)||ue.IsUnknown(r))?We.True:ue.IsUnion(e)?We.Union:ue.IsUnknown(e)||ue.IsAny(e)?We.True:We.Union}function $ke(t,e){return ue.IsUnknown(t)?We.False:ue.IsAny(t)?We.Union:ue.IsNever(t)?We.True:We.False}function Uke(t,e){return ue.IsObject(e)&&W3(e)?We.True:Yi(e)?Ji(t,e):ue.IsArray(e)?Ys(Nn(t.items,e.items)):We.False}function jke(t,e){return Yi(e)?Ji(t,e):ue.IsAsyncIterator(e)?Ys(Nn(t.items,e.items)):We.False}function Vke(t,e){return Yi(e)?Ji(t,e):ue.IsObject(e)?ro(t,e):ue.IsRecord(e)?rl(t,e):ue.IsBigInt(e)?We.True:We.False}function SJ(t,e){return ue.IsLiteralBoolean(t)||ue.IsBoolean(t)?We.True:We.False}function Gke(t,e){return Yi(e)?Ji(t,e):ue.IsObject(e)?ro(t,e):ue.IsRecord(e)?rl(t,e):ue.IsBoolean(e)?We.True:We.False}function Zke(t,e){return Yi(e)?Ji(t,e):ue.IsObject(e)?ro(t,e):ue.IsConstructor(e)?t.parameters.length>e.parameters.length?We.False:t.parameters.every((r,n)=>Ys(Nn(e.parameters[n],r))===We.True)?Ys(Nn(t.returns,e.returns)):We.False:We.False}function Wke(t,e){return Yi(e)?Ji(t,e):ue.IsObject(e)?ro(t,e):ue.IsRecord(e)?rl(t,e):ue.IsDate(e)?We.True:We.False}function Hke(t,e){return Yi(e)?Ji(t,e):ue.IsObject(e)?ro(t,e):ue.IsFunction(e)?t.parameters.length>e.parameters.length?We.False:t.parameters.every((r,n)=>Ys(Nn(e.parameters[n],r))===We.True)?Ys(Nn(t.returns,e.returns)):We.False:We.False}function EJ(t,e){return ue.IsLiteral(t)&&ni.IsNumber(t.const)||ue.IsNumber(t)||ue.IsInteger(t)?We.True:We.False}function Xke(t,e){return ue.IsInteger(e)||ue.IsNumber(e)?We.True:Yi(e)?Ji(t,e):ue.IsObject(e)?ro(t,e):ue.IsRecord(e)?rl(t,e):We.False}function Z3(t,e){return e.allOf.every(r=>Nn(t,r)===We.True)?We.True:We.False}function qke(t,e){return t.allOf.some(r=>Nn(r,e)===We.True)?We.True:We.False}function Yke(t,e){return Yi(e)?Ji(t,e):ue.IsIterator(e)?Ys(Nn(t.items,e.items)):We.False}function Jke(t,e){return ue.IsLiteral(e)&&e.const===t.const?We.True:Yi(e)?Ji(t,e):ue.IsObject(e)?ro(t,e):ue.IsRecord(e)?rl(t,e):ue.IsString(e)?TJ(t):ue.IsNumber(e)?CJ(t):ue.IsInteger(e)?EJ(t):ue.IsBoolean(e)?SJ(t):We.False}function IJ(t,e){return We.False}function Kke(t,e){return We.True}function eR(t){let[e,r]=[t,0];for(;ue.IsNot(e);)e=e.not,r+=1;return r%2===0?e:A_()}function Qke(t,e){return ue.IsNot(t)?Nn(eR(t),e):ue.IsNot(e)?Nn(t,eR(e)):T0("Invalid fallthrough for Not")}function eOe(t,e){return Yi(e)?Ji(t,e):ue.IsObject(e)?ro(t,e):ue.IsRecord(e)?rl(t,e):ue.IsNull(e)?We.True:We.False}function CJ(t,e){return ue.IsLiteralNumber(t)||ue.IsNumber(t)||ue.IsInteger(t)?We.True:We.False}function tOe(t,e){return Yi(e)?Ji(t,e):ue.IsObject(e)?ro(t,e):ue.IsRecord(e)?rl(t,e):ue.IsInteger(e)||ue.IsNumber(e)?We.True:We.False}function Zo(t,e){return Object.getOwnPropertyNames(t.properties).length===e}function tR(t){return W3(t)}function rR(t){return Zo(t,0)||Zo(t,1)&&"description"in t.properties&&ue.IsUnion(t.properties.description)&&t.properties.description.anyOf.length===2&&(ue.IsString(t.properties.description.anyOf[0])&&ue.IsUndefined(t.properties.description.anyOf[1])||ue.IsString(t.properties.description.anyOf[1])&&ue.IsUndefined(t.properties.description.anyOf[0]))}function hI(t){return Zo(t,0)}function nR(t){return Zo(t,0)}function rOe(t){return Zo(t,0)}function nOe(t){return Zo(t,0)}function iOe(t){return W3(t)}function aOe(t){let e=M0();return Zo(t,0)||Zo(t,1)&&"length"in t.properties&&Ys(Nn(t.properties.length,e))===We.True}function oOe(t){return Zo(t,0)}function W3(t){let e=M0();return Zo(t,0)||Zo(t,1)&&"length"in t.properties&&Ys(Nn(t.properties.length,e))===We.True}function sOe(t){let e=j3([T1()],T1());return Zo(t,0)||Zo(t,1)&&"then"in t.properties&&Ys(Nn(t.properties.then,e))===We.True}function MJ(t,e){return Nn(t,e)===We.False||ue.IsOptional(t)&&!ue.IsOptional(e)?We.False:We.True}function ro(t,e){return ue.IsUnknown(t)?We.False:ue.IsAny(t)?We.Union:ue.IsNever(t)||ue.IsLiteralString(t)&&tR(e)||ue.IsLiteralNumber(t)&&hI(e)||ue.IsLiteralBoolean(t)&&nR(e)||ue.IsSymbol(t)&&rR(e)||ue.IsBigInt(t)&&rOe(e)||ue.IsString(t)&&tR(e)||ue.IsSymbol(t)&&rR(e)||ue.IsNumber(t)&&hI(e)||ue.IsInteger(t)&&hI(e)||ue.IsBoolean(t)&&nR(e)||ue.IsUint8Array(t)&&iOe(e)||ue.IsDate(t)&&nOe(e)||ue.IsConstructor(t)&&oOe(e)||ue.IsFunction(t)&&aOe(e)?We.True:ue.IsRecord(t)&&ue.IsString(aT(t))?e[jg]==="Record"?We.True:We.False:ue.IsRecord(t)&&ue.IsNumber(aT(t))&&Zo(e,0)?We.True:We.False}function lOe(t,e){return Yi(e)?Ji(t,e):ue.IsRecord(e)?rl(t,e):ue.IsObject(e)?(()=>{for(let r of Object.getOwnPropertyNames(e.properties)){if(!(r in t.properties)&&!ue.IsOptional(e.properties[r]))return We.False;if(ue.IsOptional(e.properties[r]))return We.True;if(MJ(t.properties[r],e.properties[r])===We.False)return We.False}return We.True})():We.False}function uOe(t,e){return Yi(e)?Ji(t,e):ue.IsObject(e)&&sOe(e)?We.True:ue.IsPromise(e)?Ys(Nn(t.item,e.item)):We.False}function aT(t){return Gg in t.patternProperties?M0():Zg in t.patternProperties?fd():T0("Unknown record key pattern")}function oT(t){return Gg in t.patternProperties?t.patternProperties[Gg]:Zg in t.patternProperties?t.patternProperties[Zg]:T0("Unable to get record value schema")}function rl(t,e){let[r,n]=[aT(e),oT(e)];return ue.IsLiteralString(t)&&ue.IsNumber(r)&&Ys(Nn(t,n))===We.True?We.True:ue.IsUint8Array(t)&&ue.IsNumber(r)||ue.IsString(t)&&ue.IsNumber(r)||ue.IsArray(t)&&ue.IsNumber(r)?Nn(t,n):ue.IsObject(t)?(()=>{for(let i of Object.getOwnPropertyNames(t.properties))if(MJ(n,t.properties[i])===We.False)return We.False;return We.True})():We.False}function cOe(t,e){return Yi(e)?Ji(t,e):ue.IsObject(e)?ro(t,e):ue.IsRecord(e)?Nn(oT(t),oT(e)):We.False}function hOe(t,e){let r=ue.IsRegExp(t)?fd():t,n=ue.IsRegExp(e)?fd():e;return Nn(r,n)}function TJ(t,e){return ue.IsLiteral(t)&&ni.IsString(t.const)||ue.IsString(t)?We.True:We.False}function dOe(t,e){return Yi(e)?Ji(t,e):ue.IsObject(e)?ro(t,e):ue.IsRecord(e)?rl(t,e):ue.IsString(e)?We.True:We.False}function pOe(t,e){return Yi(e)?Ji(t,e):ue.IsObject(e)?ro(t,e):ue.IsRecord(e)?rl(t,e):ue.IsSymbol(e)?We.True:We.False}function fOe(t,e){return ue.IsTemplateLiteral(t)?Nn(Z4(t),e):ue.IsTemplateLiteral(e)?Nn(t,Z4(e)):T0("Invalid fallthrough for TemplateLiteral")}function mOe(t,e){return ue.IsArray(e)&&t.items!==void 0&&t.items.every(r=>Nn(r,e.items)===We.True)}function gOe(t,e){return ue.IsNever(t)?We.True:ue.IsUnknown(t)?We.False:ue.IsAny(t)?We.Union:We.False}function yOe(t,e){return Yi(e)?Ji(t,e):ue.IsObject(e)&&W3(e)||ue.IsArray(e)&&mOe(t,e)?We.True:ue.IsTuple(e)?ni.IsUndefined(t.items)&&!ni.IsUndefined(e.items)||!ni.IsUndefined(t.items)&&ni.IsUndefined(e.items)?We.False:ni.IsUndefined(t.items)&&!ni.IsUndefined(e.items)||t.items.every((r,n)=>Nn(r,e.items[n])===We.True)?We.True:We.False:We.False}function vOe(t,e){return Yi(e)?Ji(t,e):ue.IsObject(e)?ro(t,e):ue.IsRecord(e)?rl(t,e):ue.IsUint8Array(e)?We.True:We.False}function _Oe(t,e){return Yi(e)?Ji(t,e):ue.IsObject(e)?ro(t,e):ue.IsRecord(e)?rl(t,e):ue.IsVoid(e)?wOe(t):ue.IsUndefined(e)?We.True:We.False}function fO(t,e){return e.anyOf.some(r=>Nn(t,r)===We.True)?We.True:We.False}function xOe(t,e){return t.anyOf.every(r=>Nn(r,e)===We.True)?We.True:We.False}function PJ(t,e){return We.True}function bOe(t,e){return ue.IsNever(e)?IJ():ue.IsIntersect(e)?Z3(t,e):ue.IsUnion(e)?fO(t,e):ue.IsAny(e)?pO():ue.IsString(e)?TJ(t):ue.IsNumber(e)?CJ(t):ue.IsInteger(e)?EJ(t):ue.IsBoolean(e)?SJ(t):ue.IsArray(e)?$ke(t):ue.IsTuple(e)?gOe(t):ue.IsObject(e)?ro(t,e):ue.IsUnknown(e)?We.True:We.False}function wOe(t,e){return ue.IsUndefined(t)||ue.IsUndefined(t)?We.True:We.False}function AOe(t,e){return ue.IsIntersect(e)?Z3(t,e):ue.IsUnion(e)?fO(t,e):ue.IsUnknown(e)?PJ():ue.IsAny(e)?pO():ue.IsObject(e)?ro(t,e):ue.IsVoid(e)?We.True:We.False}function Nn(t,e){return ue.IsTemplateLiteral(t)||ue.IsTemplateLiteral(e)?fOe(t,e):ue.IsRegExp(t)||ue.IsRegExp(e)?hOe(t,e):ue.IsNot(t)||ue.IsNot(e)?Qke(t,e):ue.IsAny(t)?Nke(t,e):ue.IsArray(t)?Uke(t,e):ue.IsBigInt(t)?Vke(t,e):ue.IsBoolean(t)?Gke(t,e):ue.IsAsyncIterator(t)?jke(t,e):ue.IsConstructor(t)?Zke(t,e):ue.IsDate(t)?Wke(t,e):ue.IsFunction(t)?Hke(t,e):ue.IsInteger(t)?Xke(t,e):ue.IsIntersect(t)?qke(t,e):ue.IsIterator(t)?Yke(t,e):ue.IsLiteral(t)?Jke(t,e):ue.IsNever(t)?Kke():ue.IsNull(t)?eOe(t,e):ue.IsNumber(t)?tOe(t,e):ue.IsObject(t)?lOe(t,e):ue.IsRecord(t)?cOe(t,e):ue.IsString(t)?dOe(t,e):ue.IsSymbol(t)?pOe(t,e):ue.IsTuple(t)?yOe(t,e):ue.IsPromise(t)?uOe(t,e):ue.IsUint8Array(t)?vOe(t,e):ue.IsUndefined(t)?_Oe(t,e):ue.IsUnion(t)?xOe(t,e):ue.IsUnknown(t)?bOe(t,e):ue.IsVoid(t)?AOe(t,e):T0("Unknown left type operand '".concat(t[xt],"'"))}function E_(t,e){return Nn(t,e)}C();C();C();function SOe(t,e,r,n,i){let a={};for(let o of globalThis.Object.getOwnPropertyNames(t))a[o]=mO(t[o],e,r,n,tl(i));return a}function EOe(t,e,r,n,i){return SOe(t.properties,e,r,n,i)}function IOe(t,e,r,n,i){let a=EOe(t,e,r,n,i);return za(a)}function COe(t,e,r,n){let i=E_(t,e);return i===We.Union?Eo([r,n]):i===We.True?r:n}function mO(t,e,r,n,i){return Ms(t)?IOe(t,e,r,n,i):ef(t)?$t(DOe(t,e,r,n,i)):$t(COe(t,e,r,n),i)}function MOe(t,e,r,n,i){return{[t]:mO(Vi(t),e,r,n,tl(i))}}function TOe(t,e,r,n,i){return t.reduce((a,o)=>ae(ae({},a),MOe(o,e,r,n,i)),{})}function POe(t,e,r,n,i){return TOe(t.keys,e,r,n,i)}function DOe(t,e,r,n,i){let a=POe(t,e,r,n,i);return za(a)}C();function kOe(t){return t.allOf.every(e=>P0(e))}function OOe(t){return t.anyOf.some(e=>P0(e))}function BOe(t){return!P0(t.not)}function P0(t){return t[xt]==="Intersect"?kOe(t):t[xt]==="Union"?OOe(t):t[xt]==="Not"?BOe(t):t[xt]==="Undefined"}C();function zOe(t,e){return gO(Z4(t),e)}function FOe(t,e){let r=t.filter(n=>E_(n,e)===We.False);return r.length===1?r[0]:Eo(r)}function gO(t,e,r={}){return tf(t)?$t(zOe(t,e),r):Ms(t)?$t(NOe(t,e),r):$t(Ba(t)?FOe(t.anyOf,e):E_(t,e)!==We.False?to():t,r)}function ROe(t,e){let r={};for(let n of globalThis.Object.getOwnPropertyNames(t))r[n]=gO(t[n],e);return r}function LOe(t,e){return ROe(t.properties,e)}function NOe(t,e){let r=LOe(t,e);return za(r)}C();C();C();function $Oe(t,e){return yO(Z4(t),e)}function UOe(t,e){let r=t.filter(n=>E_(n,e)!==We.False);return r.length===1?r[0]:Eo(r)}function yO(t,e,r){return tf(t)?$t($Oe(t,e),r):Ms(t)?$t(GOe(t,e),r):$t(Ba(t)?UOe(t.anyOf,e):E_(t,e)!==We.False?t:to(),r)}function jOe(t,e){let r={};for(let n of globalThis.Object.getOwnPropertyNames(t))r[n]=yO(t[n],e);return r}function VOe(t,e){return jOe(t.properties,e)}function GOe(t,e){let r=VOe(t,e);return za(r)}C();function ZOe(t,e){return $t(t.returns,e)}C();function WOe(t){return $t({[xt]:"Integer",type:"integer"},t)}C();C();C();function HOe(t,e,r){return{[t]:D0(Vi(t),e,tl(r))}}function XOe(t,e,r){return t.reduce((n,i)=>ae(ae({},n),HOe(i,e,r)),{})}function qOe(t,e,r){return XOe(t.keys,e,r)}function YOe(t,e,r){let n=qOe(t,e,r);return za(n)}function JOe(t){let[e,r]=[t.slice(0,1),t.slice(1)];return[e.toLowerCase(),r].join("")}function KOe(t){let[e,r]=[t.slice(0,1),t.slice(1)];return[e.toUpperCase(),r].join("")}function QOe(t){return t.toUpperCase()}function eBe(t){return t.toLowerCase()}function tBe(t,e,r){let n=oO(t.pattern);if(!D1(n))return lt(ae({},t),{pattern:DJ(t.pattern,e)});let i=[...V3(n)].map(s=>Vi(s)),a=kJ(i,e),o=Eo(a);return uJ([o],r)}function DJ(t,e){return typeof t=="string"?e==="Uncapitalize"?JOe(t):e==="Capitalize"?KOe(t):e==="Uppercase"?QOe(t):e==="Lowercase"?eBe(t):t:t.toString()}function kJ(t,e){return t.map(r=>D0(r,e))}function D0(t,e,r={}){return ef(t)?YOe(t,e,r):tf(t)?tBe(t,e,r):Ba(t)?Eo(kJ(t.anyOf,e),r):__(t)?Vi(DJ(t.const,e),r):$t(t,r)}function rBe(t,e={}){return D0(t,"Capitalize",e)}C();function nBe(t,e={}){return D0(t,"Lowercase",e)}C();function iBe(t,e={}){return D0(t,"Uncapitalize",e)}C();function aBe(t,e={}){return D0(t,"Uppercase",e)}C();function oBe(t,e){return $t({[xt]:"Not",not:t},e)}C();C();C();function sBe(t,e,r){let n={};for(let i of globalThis.Object.getOwnPropertyNames(t))n[i]=_O(t[i],e,tl(r));return n}function lBe(t,e,r){return sBe(t.properties,e,r)}function uBe(t,e,r){let n=lBe(t,e,r);return za(n)}function cBe(t,e){return t.map(r=>vO(r,e))}function hBe(t,e){return t.map(r=>vO(r,e))}function dBe(t,e){let r=t,{[e]:n}=r;return yu(r,[O9(e)])}function pBe(t,e){return e.reduce((r,n)=>dBe(r,n),t)}function fBe(t,e){let r=qs(t,[Uo,"$id","required","properties"]),n=pBe(t.properties,e);return ba(n,r)}function vO(t,e){return Gl(t)?af(cBe(t.allOf,e)):Ba(t)?Eo(hBe(t.anyOf,e)):Uu(t)?fBe(t,e):ba({})}function _O(t,e,r){if(ef(e))return vBe(t,e,r);if(Ms(t))return uBe(t,e,r);let n=Vg(e)?Sd(e):e;return $t(ae(ae({},vO(t,n)),r))}function mBe(t,e,r){return{[e]:_O(t,[e],tl(r))}}function gBe(t,e,r){return e.reduce((n,i)=>ae(ae({},n),mBe(t,i,r)),{})}function yBe(t,e,r){return gBe(t,e.keys,r)}function vBe(t,e,r){let n=yBe(t,e,r);return za(n)}C();function _Be(t,e){return w_(t.parameters,e)}C();C();function iR(t){return t.map(e=>OJ(e))}function xBe(t){let e={};for(let r of globalThis.Object.getOwnPropertyNames(t))e[r]=nf(t[r]);return e}function bBe(t){let e=qs(t,[Uo,"$id","required","properties"]),r=xBe(t.properties);return ba(r,e)}function OJ(t){return Gl(t)?af(iR(t.allOf)):Ba(t)?Eo(iR(t.anyOf)):Uu(t)?bBe(t):ba({})}function BJ(t,e){return Ms(t)?SBe(t,e):$t(ae(ae({},OJ(t)),e))}function wBe(t,e){let r={};for(let n of globalThis.Object.getOwnPropertyNames(t))r[n]=BJ(t[n],tl(e));return r}function ABe(t,e){return wBe(t.properties,e)}function SBe(t,e){let r=ABe(t,e);return za(r)}C();C();C();function EBe(t,e,r){let n={};for(let i of globalThis.Object.getOwnPropertyNames(t))n[i]=bO(t[i],e,tl(r));return n}function IBe(t,e,r){return EBe(t.properties,e,r)}function CBe(t,e,r){let n=IBe(t,e,r);return za(n)}function MBe(t,e){return t.map(r=>xO(r,e))}function TBe(t,e){return t.map(r=>xO(r,e))}function PBe(t,e){let r={};for(let n of e)n in t&&(r[n]=t[n]);return r}function DBe(t,e){let r=qs(t,[Uo,"$id","required","properties"]),n=PBe(t.properties,e);return ba(n,r)}function xO(t,e){return Gl(t)?af(MBe(t.allOf,e)):Ba(t)?Eo(TBe(t.anyOf,e)):Uu(t)?DBe(t,e):ba({})}function bO(t,e,r){if(ef(e))return zBe(t,e,r);if(Ms(t))return CBe(t,e,r);let n=Vg(e)?Sd(e):e;return $t(ae(ae({},xO(t,n)),r))}function kBe(t,e,r){return{[e]:bO(t,[e],tl(r))}}function OBe(t,e,r){return e.reduce((n,i)=>ae(ae({},n),kBe(t,i,r)),{})}function BBe(t,e,r){return OBe(t,e.keys,r)}function zBe(t,e,r){let n=BBe(t,e,r);return za(n)}C();function FBe(t){return rf(nf(t))}C();function of(t,e,r){return $t({[xt]:"Record",type:"object",patternProperties:{[t]:e}},r)}function wO(t,e,r){let n={};for(let i of t)n[i]=e;return ba(n,lt(ae({},r),{[jg]:"Record"}))}function RBe(t,e,r){return aJ(t)?wO(Sd(t),e,r):of(t.pattern,e,r)}function LBe(t,e,r){return wO(Sd(Eo(t)),e,r)}function NBe(t,e,r){return wO([t.toString()],e,r)}function $Be(t,e,r){return of(t.source,e,r)}function UBe(t,e,r){let n=Ka(t.pattern)?Zg:t.pattern;return of(n,e,r)}function jBe(t,e,r){return of(Zg,e,r)}function VBe(t,e,r){return of(EDe,e,r)}function GBe(t,e,r){return of(Gg,e,r)}function ZBe(t,e,r){return of(Gg,e,r)}function WBe(t,e,r={}){return Ba(t)?LBe(t.anyOf,e,r):tf(t)?RBe(t,e,r):__(t)?NBe(t.const,e,r):L3(t)?GBe(t,e,r):N3(t)?ZBe(t,e,r):mY(t)?$Be(t,e,r):Qk(t)?UBe(t,e,r):cY(t)?jBe(t,e,r):x_(t)?VBe(t,e,r):to(r)}C();var HBe=0;function XBe(t,e={}){Ka(e.$id)&&(e.$id="T".concat(HBe++));let r=Hk(t({[xt]:"This",$ref:"".concat(e.$id)}));return r.$id=e.$id,$t(ae({[jg]:"Recursive"},r),e)}C();function qBe(t,e){if(qi(t))return $t({[xt]:"Ref",$ref:t},e);if(Ka(t.$id))throw new Error("Reference target type must specify an $id");return $t({[xt]:"Ref",$ref:t.$id},e)}C();function YBe(t,e){let r=qi(t)?new globalThis.RegExp(t):t;return $t({[xt]:"RegExp",type:"RegExp",source:r.source,flags:r.flags},e)}C();C();function aR(t){return t.map(e=>zJ(e))}function JBe(t){let e={};for(let r of globalThis.Object.getOwnPropertyNames(t))e[r]=qs(t[r],[Ad]);return e}function KBe(t){let e=qs(t,[Uo,"$id","required","properties"]),r=JBe(t.properties);return ba(r,e)}function zJ(t){return Gl(t)?af(aR(t.allOf)):Ba(t)?Eo(aR(t.anyOf)):Uu(t)?KBe(t):ba({})}function FJ(t,e){return Ms(t)?t7e(t,e):$t(ae(ae({},zJ(t)),e))}function QBe(t,e){let r={};for(let n of globalThis.Object.getOwnPropertyNames(t))r[n]=FJ(t[n],e);return r}function e7e(t,e){return QBe(t.properties,e)}function t7e(t,e){let r=e7e(t,e);return za(r)}C();function r7e(t){var e;return Gl(t)?t.allOf:Ba(t)?t.anyOf:A0(t)?(e=t.items)!=null?e:[]:[]}function n7e(t){return r7e(t)}C();function i7e(t,e){return $t(t.returns,e)}C();function a7e(t){return JSON.parse(JSON.stringify(t))}C();var o7e=class{constructor(t){this.schema=t}Decode(t){return new s7e(this.schema,t)}},s7e=class{constructor(t,e){this.schema=t,this.decode=e}EncodeTransform(t,e){let r={Encode:n=>e[Uo].Encode(t(n)),Decode:n=>this.decode(e[Uo].Decode(n))};return lt(ae({},e),{[Uo]:r})}EncodeSchema(t,e){let r={Decode:this.decode,Encode:t};return lt(ae({},e),{[Uo]:r})}Encode(t){return eO(this.schema)?this.EncodeTransform(t,this.schema):this.EncodeSchema(t,this.schema)}};function l7e(t){return new o7e(t)}C();function RJ(t={}){var e;return $t({[xt]:(e=t[xt])!=null?e:"Unsafe"},t)}C();function u7e(t){return $t({[xt]:"Void",type:"void"},t)}C();var LJ={};So(LJ,{Any:()=>T1,Array:()=>tJ,AsyncIterator:()=>rJ,Awaited:()=>ike,BigInt:()=>lO,Boolean:()=>sJ,Capitalize:()=>rBe,Composite:()=>_ke,Const:()=>wke,Constructor:()=>nJ,ConstructorParameters:()=>Ake,Date:()=>_J,Deref:()=>Vu,Enum:()=>Rke,Exclude:()=>gO,Extends:()=>mO,Extract:()=>yO,Function:()=>j3,Index:()=>cO,InstanceType:()=>ZOe,Integer:()=>WOe,Intersect:()=>af,Iterator:()=>dJ,KeyOf:()=>vJ,Literal:()=>Vi,Lowercase:()=>nBe,Mapped:()=>Z5e,Never:()=>to,Not:()=>oBe,Null:()=>xJ,Number:()=>M0,Object:()=>ba,Omit:()=>_O,Optional:()=>nf,Parameters:()=>_Be,Partial:()=>BJ,Pick:()=>bO,Promise:()=>pJ,Readonly:()=>rf,ReadonlyOptional:()=>FBe,Record:()=>WBe,Recursive:()=>XBe,Ref:()=>qBe,RegExp:()=>YBe,Required:()=>FJ,Rest:()=>n7e,ReturnType:()=>i7e,Strict:()=>a7e,String:()=>fd,Symbol:()=>bJ,TemplateLiteral:()=>uJ,Transform:()=>l7e,Tuple:()=>w_,Uint8Array:()=>AJ,Uncapitalize:()=>iBe,Undefined:()=>wJ,Union:()=>Eo,Unknown:()=>A_,Unsafe:()=>RJ,Uppercase:()=>aBe,Void:()=>u7e});C();var U=LJ;C();var W4=U.Object({externalId:U.String({description:"An identifier that can be used to link this entity to data outside of the MVF."}),name:U.String({description:"The name of the entity."}),shortName:U.String({description:"A short name for the entity."}),description:U.String({description:"A description of the entity."}),icon:U.String({format:"uri",description:"A URL to an icon for the entity."})},{$id:"BaseDetails",description:"Additional information about a given entity."}),NJ=U.Partial(W4,{$id:"Details",description:"Additional information about a given entity."}),k0=U.Object({details:U.Optional(U.Ref(NJ))},{$id:"WithDetails"}),AO=t=>{let e=[...t].sort(),r=U.Pick(W4,t),n=U.Omit(W4,t);return U.Object({details:U.Intersect([r,U.Partial(n)])},{$id:"WithRequiredDetails_".concat(e.join("_"))})},c7e=[W4,NJ];C();var H4=U.Number({$id:"Longitude",minimum:-180,maximum:180,description:"A WGS 84-compatible longitude coordinate value."}),X4=U.Number({$id:"Latitude",minimum:-90,maximum:90,description:"A WGS 84-compatible latitude coordinate value."}),O0=U.Tuple([U.Ref(H4),U.Ref(X4)],{$id:"Position",minItems:2,maxItems:2,description:"A valid WGS 84 position consisting of a longitude value, followed by a latitude value."}),Jc=U.Object({type:U.Literal("Point"),coordinates:U.Ref(O0)},{$id:"Point",description:"An RFC-7946 compatible GeoJSON Point geometry."}),$J=U.Object({type:U.Literal("MultiPoint"),coordinates:U.Array(U.Ref(O0))},{$id:"MultiPoint",description:"An RFC-7946 compatible GeoJSON MultiPoint geometry."}),UJ=U.Object({type:U.Literal("LineString"),coordinates:U.Array(U.Ref(O0),{minItems:2,description:"At least two positions are required."})},{$id:"LineString",description:"An RFC-7946 compatible GeoJSON LineString geometry."}),jJ=U.Object({type:U.Literal("MultiLineString"),coordinates:U.Array(U.Array(U.Ref(O0),{minItems:2}))},{$id:"MultiLineString",description:"An RFC-7946 compatible GeoJSON MultiLineString geometry."}),VJ=U.Array(U.Ref(O0),{$id:"LinearRing",minItems:4,description:"A linear ring is a building block of a polygon or multi-polygon."}),SO=U.Array(U.Ref(VJ),{$id:"LinearRings",minItems:1,description:"A collection of linear rings, at least one of which is the exterior ring of a polygon."}),EO=U.Object({type:U.Literal("Polygon"),coordinates:U.Ref(SO)},{$id:"Polygon",description:"An RFC-7946 compatible GeoJSON Polygon geometry."}),IO=U.Object({type:U.Literal("MultiPolygon"),coordinates:U.Array(U.Ref(SO))},{$id:"MultiPolygon",description:"An RFC-7946 compatible GeoJSON MultiPolygon geometry."}),Kc=(t,e,r)=>U.Object({type:U.Literal("Feature"),geometry:t,properties:e},r),sf=(t,e,r)=>U.Object({type:U.Literal("FeatureCollection"),features:U.Array(t,r)},e),h7e=[H4,X4,O0,Jc,$J,UJ,jJ,VJ,SO,EO,IO];C();var qo=(t,e)=>U.Unsafe(U.String({$id:e,pattern:"^".concat(t,"_[A-Za-z0-9-]+$")})),Qc=qo("g","GeometryId"),la=qo("f","FloorId"),d7e=[Qc,la];C();C();C();var GJ=class{constructor(t){S(this,"_value"),this._value=t}[Symbol.iterator](){return this}next(){if(this._value==null)return{done:!0,value:void 0};let t=this._value;return this._value=null,{done:!1,value:t}}},ZJ=class{constructor(t){S(this,"_tag","Some"),S(this,"_value"),this._value=t}get value(){return this._value}isSome(){return!0}isSomeAnd(t){return t(this.value)}isNone(){return!1}equals(t){return t.isSome()&&t.value===this.value}expect(t){return this.value}unwrap(){return this.value}unwrapOr(t){return this.value}unwrapOrElse(t){return this.value}inspect(t){return t(this.value),this}inspectNone(t){return this}map(t){return oR(t(this.value))}mapAsync(t){return t(this.value).then(e=>oR(e))}mapOr(t,e){return this.map(t).unwrapOr(e)}mapOrAsync(t,e){return this.mapAsync(t).then(r=>r.unwrapOr(e))}mapOrElse(t,e){return this.map(t).unwrapOrElse(e)}mapOrElseAsync(t,e){return this.mapAsync(t).then(r=>r.unwrapOrElse(e))}and(t){return t}andThen(t){return t(this.value)}andThenAsync(t){return t(this.value)}filter(t){return t(this.value)?this:vp()}or(t){return this}orElse(t){return this}xor(t){return t.isSome()?vp():this}toString(){return"Some(".concat(this.value,")")}okOr(t){return pr(this.value)}okOrElse(t){return pr(this.value)}iter(){return new GJ(this.value)}[Symbol.iterator](){return this.iter()}zip(t){return t.isSome()?k1([this.value,t.value]):vp()}zipWith(t,e){return t.isSome()?k1(e(this.value,t.value)):vp()}get[Symbol.toStringTag](){return"Some"}},WJ=class{constructor(){S(this,"_tag","None")}get value(){return null}isSome(){return!1}isSomeAnd(t){return!1}isNone(){return!0}equals(t){return t.isNone()}expect(t){throw new Error(t)}unwrap(){throw new Error("Tried to unwrap a None value!")}unwrapOr(t){return t}unwrapOrElse(t){return t()}inspect(t){return this}inspectNone(t){return t(),this}map(t){return this}mapAsync(t){return Promise.resolve(this)}mapOr(t,e){return e}mapOrAsync(t,e){return Promise.resolve(e)}mapOrElse(t,e){return e()}mapOrElseAsync(t,e){return e()}and(t){return this}andThen(t){return this}andThenAsync(t){return Promise.resolve(this)}filter(t){return this}or(t){return t}orElse(t){return t()}xor(t){return t}toString(){return"None"}okOr(t){return hr(t)}okOrElse(t){return hr(t())}iter(){return new GJ(null)}[Symbol.iterator](){return this.iter()}zip(t){return this}zipWith(t,e){return this}get[Symbol.toStringTag](){return"None"}},k1=t=>new ZJ(t),vp=()=>new WJ,oR=t=>t instanceof ZJ||t instanceof WJ?t:t==null?vp():k1(t),HJ=class{constructor(t){S(this,"_value"),this._value=t}[Symbol.iterator](){return this}next(){if(this._value==null)return{done:!0,value:void 0};let t=this._value;return this._value=null,{done:!1,value:t}}},p7e=class{constructor(t){S(this,"_tag","Ok"),S(this,"_value"),this._value=t}get value(){return this._value}get error(){return null}isOk(){return!0}isOkAnd(t){return t(this.value)}isErr(){return!1}isErrAnd(t){return!1}ok(){return k1(this.value)}err(){return vp()}expect(t){return this.value}expectErr(t){throw new Error(t)}unwrap(){return this.value}unwrapOr(t){return this.value}unwrapOrElse(t){return this.value}inspect(t){return t(this.value),this}inspectErr(){return this}map(t){return pr(t(this.value))}async mapAsync(t){return t(this.value).then(pr)}mapOr(t,e){return t(this.value)}async mapOrAsync(t,e){return t(this.value)}mapOrElse(t,e){return t(this.value)}async mapOrElseAsync(t,e){return t(this.value)}mapErr(t){return this}iter(){return new HJ(this.value)}[Symbol.iterator](){return this.iter()}and(t){return t}andThen(t){return t(this.value)}or(t){return this}orElse(t){return this}async andThenAsync(t){return t(this.value)}toString(){return"Ok(".concat(this.value,")")}get[Symbol.toStringTag](){return"Ok"}},f7e=class XJ{constructor(e){S(this,"_tag","Err"),S(this,"_error"),this._error=e}get value(){return null}get error(){return this._error}isOk(){return!1}isOkAnd(e){return!1}isErr(){return!0}isErrAnd(e){return e(this.error)}ok(){return vp()}err(){return k1(this.error)}expect(e){throw new Error(e)}expectErr(e){return this.error}unwrap(){throw this.error}unwrapOr(e){return e}unwrapOrElse(e){return e()}inspect(){return this}inspectErr(e){return e(this.error),this}map(e){return this}iter(){return new HJ(null)}[Symbol.iterator](){return this.iter()}async mapAsync(e){return this}mapOr(e,r){return r}async mapOrAsync(e,r){return r}mapOrElse(e,r){return r()}async mapOrElseAsync(e,r){return r()}mapErr(e){return new XJ(e(this.error))}and(e){return this}andThen(e){return this}async andThenAsync(e){return this}or(e){return e}orElse(e){return e(this.error)}toString(){return"Err(".concat(this.error,")")}get[Symbol.toStringTag](){return"Err"}},pr=t=>new p7e(t),hr=t=>new f7e(t);C();var Wc;(function(t){t.GeometryMissingError="GeometryMissingError",t.FloorMissingError="FloorMissingError",t.UnknownFloorError="UnknownFloorError",t.UnknownGeometryError="UnknownGeometryError",t.DuplicateIdError="DuplicateIdError"})(Wc||(Wc={}));C();C();C();C();var m7e=class extends Un{constructor(t){super("Duplicate type kind '".concat(t,"' detected"))}},qJ=class extends Un{constructor(t){super("Duplicate string format '".concat(t,"' detected"))}},sT;(function(t){function e(n,i){if(Ws.Has(n))throw new m7e(n);return Ws.Set(n,i),(a={})=>RJ(lt(ae({},a),{[xt]:n}))}t.Type=e;function r(n,i){if(Zc.Has(n))throw new qJ(n);return Zc.Set(n,i),n}t.Format=r})(sT||(sT={}));C();function g7e(t){switch(t.errorType){case Re.ArrayContains:return"Expected array to contain at least one matching value";case Re.ArrayMaxContains:return"Expected array to contain no more than ".concat(t.schema.maxContains," matching values");case Re.ArrayMinContains:return"Expected array to contain at least ".concat(t.schema.minContains," matching values");case Re.ArrayMaxItems:return"Expected array length to be less or equal to ".concat(t.schema.maxItems);case Re.ArrayMinItems:return"Expected array length to be greater or equal to ".concat(t.schema.minItems);case Re.ArrayUniqueItems:return"Expected array elements to be unique";case Re.Array:return"Expected array";case Re.AsyncIterator:return"Expected AsyncIterator";case Re.BigIntExclusiveMaximum:return"Expected bigint to be less than ".concat(t.schema.exclusiveMaximum);case Re.BigIntExclusiveMinimum:return"Expected bigint to be greater than ".concat(t.schema.exclusiveMinimum);case Re.BigIntMaximum:return"Expected bigint to be less or equal to ".concat(t.schema.maximum);case Re.BigIntMinimum:return"Expected bigint to be greater or equal to ".concat(t.schema.minimum);case Re.BigIntMultipleOf:return"Expected bigint to be a multiple of ".concat(t.schema.multipleOf);case Re.BigInt:return"Expected bigint";case Re.Boolean:return"Expected boolean";case Re.DateExclusiveMinimumTimestamp:return"Expected Date timestamp to be greater than ".concat(t.schema.exclusiveMinimumTimestamp);case Re.DateExclusiveMaximumTimestamp:return"Expected Date timestamp to be less than ".concat(t.schema.exclusiveMaximumTimestamp);case Re.DateMinimumTimestamp:return"Expected Date timestamp to be greater or equal to ".concat(t.schema.minimumTimestamp);case Re.DateMaximumTimestamp:return"Expected Date timestamp to be less or equal to ".concat(t.schema.maximumTimestamp);case Re.DateMultipleOfTimestamp:return"Expected Date timestamp to be a multiple of ".concat(t.schema.multipleOfTimestamp);case Re.Date:return"Expected Date";case Re.Function:return"Expected function";case Re.IntegerExclusiveMaximum:return"Expected integer to be less than ".concat(t.schema.exclusiveMaximum);case Re.IntegerExclusiveMinimum:return"Expected integer to be greater than ".concat(t.schema.exclusiveMinimum);case Re.IntegerMaximum:return"Expected integer to be less or equal to ".concat(t.schema.maximum);case Re.IntegerMinimum:return"Expected integer to be greater or equal to ".concat(t.schema.minimum);case Re.IntegerMultipleOf:return"Expected integer to be a multiple of ".concat(t.schema.multipleOf);case Re.Integer:return"Expected integer";case Re.IntersectUnevaluatedProperties:return"Unexpected property";case Re.Intersect:return"Expected all values to match";case Re.Iterator:return"Expected Iterator";case Re.Literal:return"Expected ".concat(typeof t.schema.const=="string"?"'".concat(t.schema.const,"'"):t.schema.const);case Re.Never:return"Never";case Re.Not:return"Value should not match";case Re.Null:return"Expected null";case Re.NumberExclusiveMaximum:return"Expected number to be less than ".concat(t.schema.exclusiveMaximum);case Re.NumberExclusiveMinimum:return"Expected number to be greater than ".concat(t.schema.exclusiveMinimum);case Re.NumberMaximum:return"Expected number to be less or equal to ".concat(t.schema.maximum);case Re.NumberMinimum:return"Expected number to be greater or equal to ".concat(t.schema.minimum);case Re.NumberMultipleOf:return"Expected number to be a multiple of ".concat(t.schema.multipleOf);case Re.Number:return"Expected number";case Re.Object:return"Expected object";case Re.ObjectAdditionalProperties:return"Unexpected property";case Re.ObjectMaxProperties:return"Expected object to have no more than ".concat(t.schema.maxProperties," properties");case Re.ObjectMinProperties:return"Expected object to have at least ".concat(t.schema.minProperties," properties");case Re.ObjectRequiredProperty:return"Expected required property";case Re.Promise:return"Expected Promise";case Re.RegExp:return"Expected string to match regular expression";case Re.StringFormatUnknown:return"Unknown format '".concat(t.schema.format,"'");case Re.StringFormat:return"Expected string to match '".concat(t.schema.format,"' format");case Re.StringMaxLength:return"Expected string length less or equal to ".concat(t.schema.maxLength);case Re.StringMinLength:return"Expected string length greater or equal to ".concat(t.schema.minLength);case Re.StringPattern:return"Expected string to match '".concat(t.schema.pattern,"'");case Re.String:return"Expected string";case Re.Symbol:return"Expected symbol";case Re.TupleLength:return"Expected tuple to have ".concat(t.schema.maxItems||0," elements");case Re.Tuple:return"Expected tuple";case Re.Uint8ArrayMaxByteLength:return"Expected byte length less or equal to ".concat(t.schema.maxByteLength);case Re.Uint8ArrayMinByteLength:return"Expected byte length greater or equal to ".concat(t.schema.minByteLength);case Re.Uint8Array:return"Expected Uint8Array";case Re.Undefined:return"Expected undefined";case Re.Union:return"Expected union value";case Re.Void:return"Expected void";case Re.Kind:return"Expected kind '".concat(t.schema[xt],"'");default:return"Unknown error type"}}var y7e=g7e;function v7e(){return y7e}C();var _7e=class extends Un{constructor(t){super("Unable to dereference schema with $id '".concat(t.$ref,"'")),this.schema=t}};function x7e(t,e){let r=e.find(n=>n.$id===t.$ref);if(r===void 0)throw new _7e(t);return Ei(r,e)}function B0(t,e){return!Ln(t.$id)||e.some(r=>r.$id===t.$id)||e.push(t),e}function Ei(t,e){return t[xt]==="This"||t[xt]==="Ref"?x7e(t,e):t}C();var b7e=class extends Un{constructor(t){super("Unable to hash value"),this.value=t}},ws;(function(t){t[t.Undefined=0]="Undefined",t[t.Null=1]="Null",t[t.Boolean=2]="Boolean",t[t.Number=3]="Number",t[t.String=4]="String",t[t.Object=5]="Object",t[t.Array=6]="Array",t[t.Date=7]="Date",t[t.Uint8Array=8]="Uint8Array",t[t.Symbol=9]="Symbol",t[t.BigInt=10]="BigInt"})(ws||(ws={}));var jm=BigInt("14695981039346656037"),[w7e,A7e]=[BigInt("1099511628211"),BigInt("18446744073709551616")],S7e=Array.from({length:256}).map((t,e)=>BigInt(e)),YJ=new Float64Array(1),JJ=new DataView(YJ.buffer),KJ=new Uint8Array(YJ.buffer);function*E7e(t){let e=t===0?1:Math.ceil(Math.floor(Math.log2(t)+1)/8);for(let r=0;r<e;r++)yield t>>8*(e-1-r)&255}function I7e(t){Qa(ws.Array);for(let e of t)Xg(e)}function C7e(t){Qa(ws.Boolean),Qa(t?1:0)}function M7e(t){Qa(ws.BigInt),JJ.setBigInt64(0,t);for(let e of KJ)Qa(e)}function T7e(t){Qa(ws.Date),Xg(t.getTime())}function P7e(t){Qa(ws.Null)}function D7e(t){Qa(ws.Number),JJ.setFloat64(0,t);for(let e of KJ)Qa(e)}function k7e(t){Qa(ws.Object);for(let e of globalThis.Object.getOwnPropertyNames(t).sort())Xg(e),Xg(t[e])}function O7e(t){Qa(ws.String);for(let e=0;e<t.length;e++)for(let r of E7e(t.charCodeAt(e)))Qa(r)}function B7e(t){Qa(ws.Symbol),Xg(t.description)}function z7e(t){Qa(ws.Uint8Array);for(let e=0;e<t.length;e++)Qa(t[e])}function F7e(t){return Qa(ws.Undefined)}function Xg(t){if(mn(t))return I7e(t);if(b0(t))return C7e(t);if(js(t))return M7e(t);if(bd(t))return T7e(t);if(m_(t))return P7e();if(cr(t))return D7e(t);if(un(t))return k7e(t);if(Ln(t))return O7e(t);if(g_(t))return B7e(t);if(Xk(t))return z7e(t);if(Cs(t))return F7e();throw new b7e(t)}function Qa(t){jm=jm^S7e[t],jm=jm*w7e%A7e}function H3(t){return jm=BigInt("14695981039346656037"),Xg(t),jm}C();var R7e=class extends Un{constructor(t){super("Unknown type"),this.schema=t}};function L7e(t){return t[xt]==="Any"||t[xt]==="Unknown"}function Gr(t){return t!==void 0}function N7e(t,e,r){return!0}function $7e(t,e,r){if(!mn(r)||Gr(t.minItems)&&!(r.length>=t.minItems)||Gr(t.maxItems)&&!(r.length<=t.maxItems)||!r.every(a=>Da(t.items,e,a))||t.uniqueItems===!0&&!(function(){let a=new Set;for(let o of r){let s=H3(o);if(a.has(s))return!1;a.add(s)}return!0})())return!1;if(!(Gr(t.contains)||cr(t.minContains)||cr(t.maxContains)))return!0;let n=Gr(t.contains)?t.contains:to(),i=r.reduce((a,o)=>Da(n,e,o)?a+1:a,0);return!(i===0||cr(t.minContains)&&i<t.minContains||cr(t.maxContains)&&i>t.maxContains)}function U7e(t,e,r){return aY(r)}function j7e(t,e,r){return!(!js(r)||Gr(t.exclusiveMaximum)&&!(r<t.exclusiveMaximum)||Gr(t.exclusiveMinimum)&&!(r>t.exclusiveMinimum)||Gr(t.maximum)&&!(r<=t.maximum)||Gr(t.minimum)&&!(r>=t.minimum)||Gr(t.multipleOf)&&r%t.multipleOf!==BigInt(0))}function V7e(t,e,r){return b0(r)}function G7e(t,e,r){return Da(t.returns,e,r.prototype)}function Z7e(t,e,r){return!(!bd(r)||Gr(t.exclusiveMaximumTimestamp)&&!(r.getTime()<t.exclusiveMaximumTimestamp)||Gr(t.exclusiveMinimumTimestamp)&&!(r.getTime()>t.exclusiveMinimumTimestamp)||Gr(t.maximumTimestamp)&&!(r.getTime()<=t.maximumTimestamp)||Gr(t.minimumTimestamp)&&!(r.getTime()>=t.minimumTimestamp)||Gr(t.multipleOfTimestamp)&&r.getTime()%t.multipleOfTimestamp!==0)}function W7e(t,e,r){return R3(r)}function H7e(t,e,r){return!(!uY(r)||Gr(t.exclusiveMaximum)&&!(r<t.exclusiveMaximum)||Gr(t.exclusiveMinimum)&&!(r>t.exclusiveMinimum)||Gr(t.maximum)&&!(r<=t.maximum)||Gr(t.minimum)&&!(r>=t.minimum)||Gr(t.multipleOf)&&r%t.multipleOf!==0)}function X7e(t,e,r){let n=t.allOf.every(i=>Da(i,e,r));if(t.unevaluatedProperties===!1){let i=new RegExp(Hg(t)),a=Object.getOwnPropertyNames(r).every(o=>i.test(o));return n&&a}else if(xn(t.unevaluatedProperties)){let i=new RegExp(Hg(t)),a=Object.getOwnPropertyNames(r).every(o=>i.test(o)||Da(t.unevaluatedProperties,e,r[o]));return n&&a}else return n}function q7e(t,e,r){return oY(r)}function Y7e(t,e,r){return r===t.const}function J7e(t,e,r){return!1}function K7e(t,e,r){return!Da(t.not,e,r)}function Q7e(t,e,r){return m_(r)}function eze(t,e,r){return!(!Bi.IsNumberLike(r)||Gr(t.exclusiveMaximum)&&!(r<t.exclusiveMaximum)||Gr(t.exclusiveMinimum)&&!(r>t.exclusiveMinimum)||Gr(t.minimum)&&!(r>=t.minimum)||Gr(t.maximum)&&!(r<=t.maximum)||Gr(t.multipleOf)&&r%t.multipleOf!==0)}function tze(t,e,r){if(!Bi.IsObjectLike(r)||Gr(t.minProperties)&&!(Object.getOwnPropertyNames(r).length>=t.minProperties)||Gr(t.maxProperties)&&!(Object.getOwnPropertyNames(r).length<=t.maxProperties))return!1;let n=Object.getOwnPropertyNames(t.properties);for(let i of n){let a=t.properties[i];if(t.required&&t.required.includes(i)){if(!Da(a,e,r[i])||(P0(a)||L7e(a))&&!(i in r))return!1}else if(Bi.IsExactOptionalProperty(r,i)&&!Da(a,e,r[i]))return!1}if(t.additionalProperties===!1){let i=Object.getOwnPropertyNames(r);return t.required&&t.required.length===n.length&&i.length===n.length?!0:i.every(a=>n.includes(a))}else return typeof t.additionalProperties=="object"?Object.getOwnPropertyNames(r).every(i=>n.includes(i)||Da(t.additionalProperties,e,r[i])):!0}function rze(t,e,r){return lY(r)}function nze(t,e,r){if(!Bi.IsRecordLike(r)||Gr(t.minProperties)&&!(Object.getOwnPropertyNames(r).length>=t.minProperties)||Gr(t.maxProperties)&&!(Object.getOwnPropertyNames(r).length<=t.maxProperties))return!1;let[n,i]=Object.entries(t.patternProperties)[0],a=new RegExp(n),o=Object.entries(r).every(([u,c])=>a.test(u)?Da(i,e,c):!0),s=typeof t.additionalProperties=="object"?Object.entries(r).every(([u,c])=>a.test(u)?!0:Da(t.additionalProperties,e,c)):!0,l=t.additionalProperties===!1?Object.getOwnPropertyNames(r).every(u=>a.test(u)):!0;return o&&s&&l}function ize(t,e,r){return Da(Ei(t,e),e,r)}function aze(t,e,r){let n=new RegExp(t.source,t.flags);return Gr(t.minLength)&&!(r.length>=t.minLength)||Gr(t.maxLength)&&!(r.length<=t.maxLength)?!1:n.test(r)}function oze(t,e,r){return!Ln(r)||Gr(t.minLength)&&!(r.length>=t.minLength)||Gr(t.maxLength)&&!(r.length<=t.maxLength)||Gr(t.pattern)&&!new RegExp(t.pattern).test(r)?!1:Gr(t.format)?Zc.Has(t.format)?Zc.Get(t.format)(r):!1:!0}function sze(t,e,r){return g_(r)}function lze(t,e,r){return Ln(r)&&new RegExp(t.pattern).test(r)}function uze(t,e,r){return Da(Ei(t,e),e,r)}function cze(t,e,r){if(!mn(r)||t.items===void 0&&r.length!==0||r.length!==t.maxItems)return!1;if(!t.items)return!0;for(let n=0;n<t.items.length;n++)if(!Da(t.items[n],e,r[n]))return!1;return!0}function hze(t,e,r){return Cs(r)}function dze(t,e,r){return t.anyOf.some(n=>Da(n,e,r))}function pze(t,e,r){return!(!Xk(r)||Gr(t.maxByteLength)&&!(r.length<=t.maxByteLength)||Gr(t.minByteLength)&&!(r.length>=t.minByteLength))}function fze(t,e,r){return!0}function mze(t,e,r){return Bi.IsVoidLike(r)}function gze(t,e,r){return Ws.Has(t[xt])?Ws.Get(t[xt])(t,r):!1}function Da(t,e,r){let n=Gr(t.$id)?[...e,t]:e,i=t;switch(i[xt]){case"Any":return N7e();case"Array":return $7e(i,n,r);case"AsyncIterator":return U7e(i,n,r);case"BigInt":return j7e(i,n,r);case"Boolean":return V7e(i,n,r);case"Constructor":return G7e(i,n,r);case"Date":return Z7e(i,n,r);case"Function":return W7e(i,n,r);case"Integer":return H7e(i,n,r);case"Intersect":return X7e(i,n,r);case"Iterator":return q7e(i,n,r);case"Literal":return Y7e(i,n,r);case"Never":return J7e();case"Not":return K7e(i,n,r);case"Null":return Q7e(i,n,r);case"Number":return eze(i,n,r);case"Object":return tze(i,n,r);case"Promise":return rze(i,n,r);case"Record":return nze(i,n,r);case"Ref":return ize(i,n,r);case"RegExp":return aze(i,n,r);case"String":return oze(i,n,r);case"Symbol":return sze(i,n,r);case"TemplateLiteral":return lze(i,n,r);case"This":return uze(i,n,r);case"Tuple":return cze(i,n,r);case"Undefined":return hze(i,n,r);case"Union":return dze(i,n,r);case"Uint8Array":return pze(i,n,r);case"Unknown":return fze();case"Void":return mze(i,n,r);default:if(!Ws.Has(i[xt]))throw new R7e(i);return gze(i,n,r)}}function $n(...t){return t.length===3?Da(t[0],t[1],t[2]):Da(t[0],[],t[1])}var Re;(function(t){t[t.ArrayContains=0]="ArrayContains",t[t.ArrayMaxContains=1]="ArrayMaxContains",t[t.ArrayMaxItems=2]="ArrayMaxItems",t[t.ArrayMinContains=3]="ArrayMinContains",t[t.ArrayMinItems=4]="ArrayMinItems",t[t.ArrayUniqueItems=5]="ArrayUniqueItems",t[t.Array=6]="Array",t[t.AsyncIterator=7]="AsyncIterator",t[t.BigIntExclusiveMaximum=8]="BigIntExclusiveMaximum",t[t.BigIntExclusiveMinimum=9]="BigIntExclusiveMinimum",t[t.BigIntMaximum=10]="BigIntMaximum",t[t.BigIntMinimum=11]="BigIntMinimum",t[t.BigIntMultipleOf=12]="BigIntMultipleOf",t[t.BigInt=13]="BigInt",t[t.Boolean=14]="Boolean",t[t.DateExclusiveMaximumTimestamp=15]="DateExclusiveMaximumTimestamp",t[t.DateExclusiveMinimumTimestamp=16]="DateExclusiveMinimumTimestamp",t[t.DateMaximumTimestamp=17]="DateMaximumTimestamp",t[t.DateMinimumTimestamp=18]="DateMinimumTimestamp",t[t.DateMultipleOfTimestamp=19]="DateMultipleOfTimestamp",t[t.Date=20]="Date",t[t.Function=21]="Function",t[t.IntegerExclusiveMaximum=22]="IntegerExclusiveMaximum",t[t.IntegerExclusiveMinimum=23]="IntegerExclusiveMinimum",t[t.IntegerMaximum=24]="IntegerMaximum",t[t.IntegerMinimum=25]="IntegerMinimum",t[t.IntegerMultipleOf=26]="IntegerMultipleOf",t[t.Integer=27]="Integer",t[t.IntersectUnevaluatedProperties=28]="IntersectUnevaluatedProperties",t[t.Intersect=29]="Intersect",t[t.Iterator=30]="Iterator",t[t.Kind=31]="Kind",t[t.Literal=32]="Literal",t[t.Never=33]="Never",t[t.Not=34]="Not",t[t.Null=35]="Null",t[t.NumberExclusiveMaximum=36]="NumberExclusiveMaximum",t[t.NumberExclusiveMinimum=37]="NumberExclusiveMinimum",t[t.NumberMaximum=38]="NumberMaximum",t[t.NumberMinimum=39]="NumberMinimum",t[t.NumberMultipleOf=40]="NumberMultipleOf",t[t.Number=41]="Number",t[t.ObjectAdditionalProperties=42]="ObjectAdditionalProperties",t[t.ObjectMaxProperties=43]="ObjectMaxProperties",t[t.ObjectMinProperties=44]="ObjectMinProperties",t[t.ObjectRequiredProperty=45]="ObjectRequiredProperty",t[t.Object=46]="Object",t[t.Promise=47]="Promise",t[t.RegExp=48]="RegExp",t[t.StringFormatUnknown=49]="StringFormatUnknown",t[t.StringFormat=50]="StringFormat",t[t.StringMaxLength=51]="StringMaxLength",t[t.StringMinLength=52]="StringMinLength",t[t.StringPattern=53]="StringPattern",t[t.String=54]="String",t[t.Symbol=55]="Symbol",t[t.TupleLength=56]="TupleLength",t[t.Tuple=57]="Tuple",t[t.Uint8ArrayMaxByteLength=58]="Uint8ArrayMaxByteLength",t[t.Uint8ArrayMinByteLength=59]="Uint8ArrayMinByteLength",t[t.Uint8Array=60]="Uint8Array",t[t.Undefined=61]="Undefined",t[t.Union=62]="Union",t[t.Void=63]="Void"})(Re||(Re={}));var yze=class extends Un{constructor(t){super("Unknown type"),this.schema=t}};function Ac(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}function jr(t){return t!==void 0}var z0=class{constructor(t){this.iterator=t}[Symbol.iterator](){return this.iterator}First(){let t=this.iterator.next();return t.done?void 0:t.value}};function kt(t,e,r,n,i=[]){return{type:t,schema:e,path:r,value:n,message:v7e()({errorType:t,path:r,schema:e,value:n,errors:i}),errors:i}}function*vze(t,e,r,n){}function*_ze(t,e,r,n){if(!mn(n))return yield kt(Re.Array,t,r,n);jr(t.minItems)&&!(n.length>=t.minItems)&&(yield kt(Re.ArrayMinItems,t,r,n)),jr(t.maxItems)&&!(n.length<=t.maxItems)&&(yield kt(Re.ArrayMaxItems,t,r,n));for(let o=0;o<n.length;o++)yield*ut(ka(t.items,e,"".concat(r,"/").concat(o),n[o]));if(t.uniqueItems===!0&&!(function(){let o=new Set;for(let s of n){let l=H3(s);if(o.has(l))return!1;o.add(l)}return!0})()&&(yield kt(Re.ArrayUniqueItems,t,r,n)),!(jr(t.contains)||jr(t.minContains)||jr(t.maxContains)))return;let i=jr(t.contains)?t.contains:to(),a=n.reduce((o,s,l)=>ka(i,e,"".concat(r).concat(l),s).next().done===!0?o+1:o,0);a===0&&(yield kt(Re.ArrayContains,t,r,n)),cr(t.minContains)&&a<t.minContains&&(yield kt(Re.ArrayMinContains,t,r,n)),cr(t.maxContains)&&a>t.maxContains&&(yield kt(Re.ArrayMaxContains,t,r,n))}function*xze(t,e,r,n){aY(n)||(yield kt(Re.AsyncIterator,t,r,n))}function*bze(t,e,r,n){if(!js(n))return yield kt(Re.BigInt,t,r,n);jr(t.exclusiveMaximum)&&!(n<t.exclusiveMaximum)&&(yield kt(Re.BigIntExclusiveMaximum,t,r,n)),jr(t.exclusiveMinimum)&&!(n>t.exclusiveMinimum)&&(yield kt(Re.BigIntExclusiveMinimum,t,r,n)),jr(t.maximum)&&!(n<=t.maximum)&&(yield kt(Re.BigIntMaximum,t,r,n)),jr(t.minimum)&&!(n>=t.minimum)&&(yield kt(Re.BigIntMinimum,t,r,n)),jr(t.multipleOf)&&n%t.multipleOf!==BigInt(0)&&(yield kt(Re.BigIntMultipleOf,t,r,n))}function*wze(t,e,r,n){b0(n)||(yield kt(Re.Boolean,t,r,n))}function*Aze(t,e,r,n){yield*ut(ka(t.returns,e,r,n.prototype))}function*Sze(t,e,r,n){if(!bd(n))return yield kt(Re.Date,t,r,n);jr(t.exclusiveMaximumTimestamp)&&!(n.getTime()<t.exclusiveMaximumTimestamp)&&(yield kt(Re.DateExclusiveMaximumTimestamp,t,r,n)),jr(t.exclusiveMinimumTimestamp)&&!(n.getTime()>t.exclusiveMinimumTimestamp)&&(yield kt(Re.DateExclusiveMinimumTimestamp,t,r,n)),jr(t.maximumTimestamp)&&!(n.getTime()<=t.maximumTimestamp)&&(yield kt(Re.DateMaximumTimestamp,t,r,n)),jr(t.minimumTimestamp)&&!(n.getTime()>=t.minimumTimestamp)&&(yield kt(Re.DateMinimumTimestamp,t,r,n)),jr(t.multipleOfTimestamp)&&n.getTime()%t.multipleOfTimestamp!==0&&(yield kt(Re.DateMultipleOfTimestamp,t,r,n))}function*Eze(t,e,r,n){R3(n)||(yield kt(Re.Function,t,r,n))}function*Ize(t,e,r,n){if(!uY(n))return yield kt(Re.Integer,t,r,n);jr(t.exclusiveMaximum)&&!(n<t.exclusiveMaximum)&&(yield kt(Re.IntegerExclusiveMaximum,t,r,n)),jr(t.exclusiveMinimum)&&!(n>t.exclusiveMinimum)&&(yield kt(Re.IntegerExclusiveMinimum,t,r,n)),jr(t.maximum)&&!(n<=t.maximum)&&(yield kt(Re.IntegerMaximum,t,r,n)),jr(t.minimum)&&!(n>=t.minimum)&&(yield kt(Re.IntegerMinimum,t,r,n)),jr(t.multipleOf)&&n%t.multipleOf!==0&&(yield kt(Re.IntegerMultipleOf,t,r,n))}function*Cze(t,e,r,n){let i=!1;for(let a of t.allOf)for(let o of ka(a,e,r,n))i=!0,yield o;if(i)return yield kt(Re.Intersect,t,r,n);if(t.unevaluatedProperties===!1){let a=new RegExp(Hg(t));for(let o of Object.getOwnPropertyNames(n))a.test(o)||(yield kt(Re.IntersectUnevaluatedProperties,t,"".concat(r,"/").concat(o),n))}if(typeof t.unevaluatedProperties=="object"){let a=new RegExp(Hg(t));for(let o of Object.getOwnPropertyNames(n))if(!a.test(o)){let s=ka(t.unevaluatedProperties,e,"".concat(r,"/").concat(o),n[o]).next();s.done||(yield s.value)}}}function*Mze(t,e,r,n){oY(n)||(yield kt(Re.Iterator,t,r,n))}function*Tze(t,e,r,n){n!==t.const&&(yield kt(Re.Literal,t,r,n))}function*Pze(t,e,r,n){yield kt(Re.Never,t,r,n)}function*Dze(t,e,r,n){ka(t.not,e,r,n).next().done===!0&&(yield kt(Re.Not,t,r,n))}function*kze(t,e,r,n){m_(n)||(yield kt(Re.Null,t,r,n))}function*Oze(t,e,r,n){if(!Bi.IsNumberLike(n))return yield kt(Re.Number,t,r,n);jr(t.exclusiveMaximum)&&!(n<t.exclusiveMaximum)&&(yield kt(Re.NumberExclusiveMaximum,t,r,n)),jr(t.exclusiveMinimum)&&!(n>t.exclusiveMinimum)&&(yield kt(Re.NumberExclusiveMinimum,t,r,n)),jr(t.maximum)&&!(n<=t.maximum)&&(yield kt(Re.NumberMaximum,t,r,n)),jr(t.minimum)&&!(n>=t.minimum)&&(yield kt(Re.NumberMinimum,t,r,n)),jr(t.multipleOf)&&n%t.multipleOf!==0&&(yield kt(Re.NumberMultipleOf,t,r,n))}function*Bze(t,e,r,n){if(!Bi.IsObjectLike(n))return yield kt(Re.Object,t,r,n);jr(t.minProperties)&&!(Object.getOwnPropertyNames(n).length>=t.minProperties)&&(yield kt(Re.ObjectMinProperties,t,r,n)),jr(t.maxProperties)&&!(Object.getOwnPropertyNames(n).length<=t.maxProperties)&&(yield kt(Re.ObjectMaxProperties,t,r,n));let i=Array.isArray(t.required)?t.required:[],a=Object.getOwnPropertyNames(t.properties),o=Object.getOwnPropertyNames(n);for(let s of i)o.includes(s)||(yield kt(Re.ObjectRequiredProperty,t.properties[s],"".concat(r,"/").concat(Ac(s)),void 0));if(t.additionalProperties===!1)for(let s of o)a.includes(s)||(yield kt(Re.ObjectAdditionalProperties,t,"".concat(r,"/").concat(Ac(s)),n[s]));if(typeof t.additionalProperties=="object")for(let s of o)a.includes(s)||(yield*ut(ka(t.additionalProperties,e,"".concat(r,"/").concat(Ac(s)),n[s])));for(let s of a){let l=t.properties[s];t.required&&t.required.includes(s)?(yield*ut(ka(l,e,"".concat(r,"/").concat(Ac(s)),n[s])),P0(t)&&!(s in n)&&(yield kt(Re.ObjectRequiredProperty,l,"".concat(r,"/").concat(Ac(s)),void 0))):Bi.IsExactOptionalProperty(n,s)&&(yield*ut(ka(l,e,"".concat(r,"/").concat(Ac(s)),n[s])))}}function*zze(t,e,r,n){lY(n)||(yield kt(Re.Promise,t,r,n))}function*Fze(t,e,r,n){if(!Bi.IsRecordLike(n))return yield kt(Re.Object,t,r,n);jr(t.minProperties)&&!(Object.getOwnPropertyNames(n).length>=t.minProperties)&&(yield kt(Re.ObjectMinProperties,t,r,n)),jr(t.maxProperties)&&!(Object.getOwnPropertyNames(n).length<=t.maxProperties)&&(yield kt(Re.ObjectMaxProperties,t,r,n));let[i,a]=Object.entries(t.patternProperties)[0],o=new RegExp(i);for(let[s,l]of Object.entries(n))o.test(s)&&(yield*ut(ka(a,e,"".concat(r,"/").concat(Ac(s)),l)));if(typeof t.additionalProperties=="object")for(let[s,l]of Object.entries(n))o.test(s)||(yield*ut(ka(t.additionalProperties,e,"".concat(r,"/").concat(Ac(s)),l)));if(t.additionalProperties===!1){for(let[s,l]of Object.entries(n))if(!o.test(s))return yield kt(Re.ObjectAdditionalProperties,t,"".concat(r,"/").concat(Ac(s)),l)}}function*Rze(t,e,r,n){yield*ut(ka(Ei(t,e),e,r,n))}function*Lze(t,e,r,n){if(!Ln(n))return yield kt(Re.String,t,r,n);if(jr(t.minLength)&&!(n.length>=t.minLength)&&(yield kt(Re.StringMinLength,t,r,n)),jr(t.maxLength)&&!(n.length<=t.maxLength)&&(yield kt(Re.StringMaxLength,t,r,n)),!new RegExp(t.source,t.flags).test(n))return yield kt(Re.RegExp,t,r,n)}function*Nze(t,e,r,n){if(!Ln(n))return yield kt(Re.String,t,r,n);jr(t.minLength)&&!(n.length>=t.minLength)&&(yield kt(Re.StringMinLength,t,r,n)),jr(t.maxLength)&&!(n.length<=t.maxLength)&&(yield kt(Re.StringMaxLength,t,r,n)),Ln(t.pattern)&&(new RegExp(t.pattern).test(n)||(yield kt(Re.StringPattern,t,r,n))),Ln(t.format)&&(Zc.Has(t.format)?Zc.Get(t.format)(n)||(yield kt(Re.StringFormat,t,r,n)):yield kt(Re.StringFormatUnknown,t,r,n))}function*$ze(t,e,r,n){g_(n)||(yield kt(Re.Symbol,t,r,n))}function*Uze(t,e,r,n){if(!Ln(n))return yield kt(Re.String,t,r,n);new RegExp(t.pattern).test(n)||(yield kt(Re.StringPattern,t,r,n))}function*jze(t,e,r,n){yield*ut(ka(Ei(t,e),e,r,n))}function*Vze(t,e,r,n){if(!mn(n))return yield kt(Re.Tuple,t,r,n);if(t.items===void 0&&n.length!==0)return yield kt(Re.TupleLength,t,r,n);if(n.length!==t.maxItems)return yield kt(Re.TupleLength,t,r,n);if(t.items)for(let i=0;i<t.items.length;i++)yield*ut(ka(t.items[i],e,"".concat(r,"/").concat(i),n[i]))}function*Gze(t,e,r,n){Cs(n)||(yield kt(Re.Undefined,t,r,n))}function*Zze(t,e,r,n){if($n(t,e,n))return;let i=t.anyOf.map(a=>new z0(ka(a,e,r,n)));yield kt(Re.Union,t,r,n,i)}function*Wze(t,e,r,n){if(!Xk(n))return yield kt(Re.Uint8Array,t,r,n);jr(t.maxByteLength)&&!(n.length<=t.maxByteLength)&&(yield kt(Re.Uint8ArrayMaxByteLength,t,r,n)),jr(t.minByteLength)&&!(n.length>=t.minByteLength)&&(yield kt(Re.Uint8ArrayMinByteLength,t,r,n))}function*Hze(t,e,r,n){}function*Xze(t,e,r,n){Bi.IsVoidLike(n)||(yield kt(Re.Void,t,r,n))}function*qze(t,e,r,n){Ws.Get(t[xt])(t,n)||(yield kt(Re.Kind,t,r,n))}function*ka(t,e,r,n){let i=jr(t.$id)?[...e,t]:e,a=t;switch(a[xt]){case"Any":return yield*ut(vze());case"Array":return yield*ut(_ze(a,i,r,n));case"AsyncIterator":return yield*ut(xze(a,i,r,n));case"BigInt":return yield*ut(bze(a,i,r,n));case"Boolean":return yield*ut(wze(a,i,r,n));case"Constructor":return yield*ut(Aze(a,i,r,n));case"Date":return yield*ut(Sze(a,i,r,n));case"Function":return yield*ut(Eze(a,i,r,n));case"Integer":return yield*ut(Ize(a,i,r,n));case"Intersect":return yield*ut(Cze(a,i,r,n));case"Iterator":return yield*ut(Mze(a,i,r,n));case"Literal":return yield*ut(Tze(a,i,r,n));case"Never":return yield*ut(Pze(a,i,r,n));case"Not":return yield*ut(Dze(a,i,r,n));case"Null":return yield*ut(kze(a,i,r,n));case"Number":return yield*ut(Oze(a,i,r,n));case"Object":return yield*ut(Bze(a,i,r,n));case"Promise":return yield*ut(zze(a,i,r,n));case"Record":return yield*ut(Fze(a,i,r,n));case"Ref":return yield*ut(Rze(a,i,r,n));case"RegExp":return yield*ut(Lze(a,i,r,n));case"String":return yield*ut(Nze(a,i,r,n));case"Symbol":return yield*ut($ze(a,i,r,n));case"TemplateLiteral":return yield*ut(Uze(a,i,r,n));case"This":return yield*ut(jze(a,i,r,n));case"Tuple":return yield*ut(Vze(a,i,r,n));case"Undefined":return yield*ut(Gze(a,i,r,n));case"Union":return yield*ut(Zze(a,i,r,n));case"Uint8Array":return yield*ut(Wze(a,i,r,n));case"Unknown":return yield*ut(Hze());case"Void":return yield*ut(Xze(a,i,r,n));default:if(!Ws.Has(a[xt]))throw new yze(t);return yield*ut(qze(a,i,r,n))}}function I_(...t){let e=t.length===3?ka(t[0],t[1],"",t[2]):ka(t[0],[],"",t[1]);return new z0(e)}C();C();var Yze=function(t,e,r,n,i){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,r),r},QJ=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},lT,q4,eK,Jze=class extends Un{constructor(t){let e=t.First();super(e===void 0?"Invalid Value":e.message),lT.add(this),q4.set(this,void 0),Yze(this,q4,t),this.error=e}Errors(){return new z0(QJ(this,lT,"m",eK).call(this))}};q4=new WeakMap,lT=new WeakSet,eK=function*(){this.error&&(yield this.error),yield*ut(QJ(this,q4,"f"))};function sR(t,e,r){if(!$n(t,e,r))throw new Jze(I_(t,e,r))}function tK(...t){return t.length===3?sR(t[0],t[1],t[2]):sR(t[0],[],t[1])}C();C();C();function Kze(t){let e={};for(let r of Object.getOwnPropertyNames(t))e[r]=ii(t[r]);for(let r of Object.getOwnPropertySymbols(t))e[r]=ii(t[r]);return e}function Qze(t){return t.map(e=>ii(e))}function eFe(t){return t.slice()}function tFe(t){return new Map(ii([...t.entries()]))}function rFe(t){return new Set(ii([...t.entries()]))}function nFe(t){return new Date(t.toISOString())}function ii(t){if(mn(t))return Qze(t);if(bd(t))return nFe(t);if(wd(t))return eFe(t);if(QPe(t))return tFe(t);if(eDe(t))return rFe(t);if(un(t))return Kze(t);if(Yc(t))return t;throw new Error("ValueClone: Unable to clone value")}var Ll=class extends Un{constructor(t,e){super(e),this.schema=t}};function Kr(t){return R3(t)?t():ii(t)}function iFe(t,e){return Ar(t,"default")?Kr(t.default):{}}function aFe(t,e){if(t.uniqueItems===!0&&!Ar(t,"default"))throw new Ll(t,"Array with the uniqueItems constraint requires a default value");if("contains"in t&&!Ar(t,"default"))throw new Ll(t,"Array with the contains constraint requires a default value");return"default"in t?Kr(t.default):t.minItems!==void 0?Array.from({length:t.minItems}).map(r=>As(t.items,e)):[]}function oFe(t,e){return Ar(t,"default")?Kr(t.default):(function(){return xne(this,null,function*(){})})()}function sFe(t,e){return Ar(t,"default")?Kr(t.default):BigInt(0)}function lFe(t,e){return Ar(t,"default")?Kr(t.default):!1}function uFe(t,e){if(Ar(t,"default"))return Kr(t.default);{let r=As(t.returns,e);return typeof r=="object"&&!Array.isArray(r)?class{constructor(){for(let[n,i]of Object.entries(r)){let a=this;a[n]=i}}}:class{}}}function cFe(t,e){return Ar(t,"default")?Kr(t.default):t.minimumTimestamp!==void 0?new Date(t.minimumTimestamp):new Date}function hFe(t,e){return Ar(t,"default")?Kr(t.default):()=>As(t.returns,e)}function dFe(t,e){return Ar(t,"default")?Kr(t.default):t.minimum!==void 0?t.minimum:0}function pFe(t,e){if(Ar(t,"default"))return Kr(t.default);{let r=t.allOf.reduce((n,i)=>{let a=As(i,e);return typeof a=="object"?ae(ae({},n),a):a},{});if(!$n(t,e,r))throw new Ll(t,"Intersect produced invalid value. Consider using a default value.");return r}}function fFe(t,e){return Ar(t,"default")?Kr(t.default):(function*(){})()}function mFe(t,e){return Ar(t,"default")?Kr(t.default):t.const}function gFe(t,e){if(Ar(t,"default"))return Kr(t.default);throw new Ll(t,"Never types cannot be created. Consider using a default value.")}function yFe(t,e){if(Ar(t,"default"))return Kr(t.default);throw new Ll(t,"Not types must have a default value")}function vFe(t,e){return Ar(t,"default")?Kr(t.default):null}function _Fe(t,e){return Ar(t,"default")?Kr(t.default):t.minimum!==void 0?t.minimum:0}function xFe(t,e){if(Ar(t,"default"))return Kr(t.default);{let r=new Set(t.required),n={};for(let[i,a]of Object.entries(t.properties))r.has(i)&&(n[i]=As(a,e));return n}}function bFe(t,e){return Ar(t,"default")?Kr(t.default):Promise.resolve(As(t.item,e))}function wFe(t,e){let[r,n]=Object.entries(t.patternProperties)[0];if(Ar(t,"default"))return Kr(t.default);if(r===Zg||r===Gg)return{};{let i=r.slice(1,r.length-1).split("|"),a={};for(let o of i)a[o]=As(n,e);return a}}function AFe(t,e){return Ar(t,"default")?Kr(t.default):As(Ei(t,e),e)}function SFe(t,e){if(Ar(t,"default"))return Kr(t.default);throw new Ll(t,"RegExp types cannot be created. Consider using a default value.")}function EFe(t,e){if(t.pattern!==void 0){if(Ar(t,"default"))return Kr(t.default);throw new Ll(t,"String types with patterns must specify a default value")}else if(t.format!==void 0){if(Ar(t,"default"))return Kr(t.default);throw new Ll(t,"String types with formats must specify a default value")}else return Ar(t,"default")?Kr(t.default):t.minLength!==void 0?Array.from({length:t.minLength}).map(()=>" ").join(""):""}function IFe(t,e){return Ar(t,"default")?Kr(t.default):"value"in t?Symbol.for(t.value):Symbol()}function CFe(t,e){if(Ar(t,"default"))return Kr(t.default);if(!aJ(t))throw new Ll(t,"Can only create template literals that produce a finite variants. Consider using a default value.");return sO(t)[0]}function MFe(t,e){if(rK++>FFe)throw new Ll(t,"Cannot create recursive type as it appears possibly infinite. Consider using a default.");return Ar(t,"default")?Kr(t.default):As(Ei(t,e),e)}function TFe(t,e){return Ar(t,"default")?Kr(t.default):t.items===void 0?[]:Array.from({length:t.minItems}).map((r,n)=>As(t.items[n],e))}function PFe(t,e){if(Ar(t,"default"))return Kr(t.default)}function DFe(t,e){if(Ar(t,"default"))return Kr(t.default);if(t.anyOf.length===0)throw new Error("ValueCreate.Union: Cannot create Union with zero variants");return As(t.anyOf[0],e)}function kFe(t,e){return Ar(t,"default")?Kr(t.default):t.minByteLength!==void 0?new Uint8Array(t.minByteLength):new Uint8Array(0)}function OFe(t,e){return Ar(t,"default")?Kr(t.default):{}}function BFe(t,e){if(Ar(t,"default"))return Kr(t.default)}function zFe(t,e){if(Ar(t,"default"))return Kr(t.default);throw new Error("User defined types must specify a default value")}function As(t,e){let r=B0(t,e),n=t;switch(n[xt]){case"Any":return iFe(n);case"Array":return aFe(n,r);case"AsyncIterator":return oFe(n);case"BigInt":return sFe(n);case"Boolean":return lFe(n);case"Constructor":return uFe(n,r);case"Date":return cFe(n);case"Function":return hFe(n,r);case"Integer":return dFe(n);case"Intersect":return pFe(n,r);case"Iterator":return fFe(n);case"Literal":return mFe(n);case"Never":return gFe(n);case"Not":return yFe(n);case"Null":return vFe(n);case"Number":return _Fe(n);case"Object":return xFe(n,r);case"Promise":return bFe(n,r);case"Record":return wFe(n,r);case"Ref":return AFe(n,r);case"RegExp":return SFe(n);case"String":return EFe(n);case"Symbol":return IFe(n);case"TemplateLiteral":return CFe(n);case"This":return MFe(n,r);case"Tuple":return TFe(n,r);case"Undefined":return PFe(n);case"Union":return DFe(n,r);case"Uint8Array":return kFe(n);case"Unknown":return OFe(n);case"Void":return BFe(n);default:if(!Ws.Has(n[xt]))throw new Ll(n,"Unknown type");return zFe(n)}}var FFe=512,rK=0;function Tu(...t){return rK=0,t.length===2?As(t[0],t[1]):As(t[0],[])}var nK=class extends Un{constructor(t,e){super(e),this.schema=t}};function RFe(t,e,r){if(t[xt]==="Object"&&typeof r=="object"&&!m_(r)){let n=t,i=Object.getOwnPropertyNames(r),a=Object.entries(n.properties),[o,s]=[1/a.length,a.length];return a.reduce((l,[u,c])=>{let h=c[xt]==="Literal"&&c.const===r[u]?s:0,d=$n(c,e,r[u])?o:0,p=i.includes(u)?o:0;return l+(h+d+p)},0)}else return $n(t,e,r)?1:0}function LFe(t,e,r){let n=t.anyOf.map(o=>Ei(o,e)),[i,a]=[n[0],0];for(let o of n){let s=RFe(o,e,r);s>a&&(i=o,a=s)}return i}function NFe(t,e,r){if("default"in t)return typeof r=="function"?t.default:ii(t.default);{let n=LFe(t,e,r);return iK(n,e,r)}}function $Fe(t,e,r){return $n(t,e,r)?ii(r):Tu(t,e)}function UFe(t,e,r){return $n(t,e,r)?r:Tu(t,e)}function jFe(t,e,r){if($n(t,e,r))return ii(r);let n=mn(r)?ii(r):Tu(t,e),i=cr(t.minItems)&&n.length<t.minItems?[...n,...Array.from({length:t.minItems-n.length},()=>null)]:n,a=(cr(t.maxItems)&&i.length>t.maxItems?i.slice(0,t.maxItems):i).map(s=>Pu(t.items,e,s));if(t.uniqueItems!==!0)return a;let o=[...new Set(a)];if(!$n(t,e,o))throw new nK(t,"Array cast produced invalid data due to uniqueItems constraint");return o}function VFe(t,e,r){if($n(t,e,r))return Tu(t,e);let n=new Set(t.returns.required||[]),i=function(){};for(let[a,o]of Object.entries(t.returns.properties))!n.has(a)&&r.prototype[a]===void 0||(i.prototype[a]=Pu(o,e,r.prototype[a]));return i}function GFe(t,e,r){let n=Tu(t,e),i=un(n)&&un(r)?ae(ae({},n),r):r;return $n(t,e,i)?i:Tu(t,e)}function ZFe(t,e,r){throw new nK(t,"Never types cannot be cast")}function WFe(t,e,r){if($n(t,e,r))return r;if(r===null||typeof r!="object")return Tu(t,e);let n=new Set(t.required||[]),i={};for(let[a,o]of Object.entries(t.properties))!n.has(a)&&r[a]===void 0||(i[a]=Pu(o,e,r[a]));if(typeof t.additionalProperties=="object"){let a=Object.getOwnPropertyNames(t.properties);for(let o of Object.getOwnPropertyNames(r))a.includes(o)||(i[o]=Pu(t.additionalProperties,e,r[o]))}return i}function HFe(t,e,r){if($n(t,e,r))return ii(r);if(r===null||typeof r!="object"||Array.isArray(r)||r instanceof Date)return Tu(t,e);let n=Object.getOwnPropertyNames(t.patternProperties)[0],i=t.patternProperties[n],a={};for(let[o,s]of Object.entries(r))a[o]=Pu(i,e,s);return a}function XFe(t,e,r){return Pu(Ei(t,e),e,r)}function qFe(t,e,r){return Pu(Ei(t,e),e,r)}function YFe(t,e,r){return $n(t,e,r)?ii(r):mn(r)?t.items===void 0?[]:t.items.map((n,i)=>Pu(n,e,r[i])):Tu(t,e)}function JFe(t,e,r){return $n(t,e,r)?ii(r):NFe(t,e,r)}function Pu(t,e,r){let n=Ln(t.$id)?[...e,t]:e,i=t;switch(t[xt]){case"Array":return jFe(i,n,r);case"Constructor":return VFe(i,n,r);case"Intersect":return GFe(i,n,r);case"Never":return ZFe(i);case"Object":return WFe(i,n,r);case"Record":return HFe(i,n,r);case"Ref":return XFe(i,n,r);case"This":return qFe(i,n,r);case"Tuple":return YFe(i,n,r);case"Union":return JFe(i,n,r);case"Date":case"Symbol":case"Uint8Array":return $Fe(t,e,r);default:return UFe(i,n,r)}}function iK(...t){return t.length===3?Pu(t[0],t[1],t[2]):Pu(t[0],[],t[1])}C();function KFe(t){return S0(t)&&t[xt]!=="Unsafe"}function QFe(t,e,r){return mn(r)?r.map(n=>Ss(t.items,e,n)):r}function e8e(t,e,r){let n=t.unevaluatedProperties,i=t.allOf.map(o=>Ss(o,e,ii(r))).reduce((o,s)=>un(s)?ae(ae({},o),s):s,{});if(!un(r)||!un(i)||!S0(n))return i;let a=ju(t);for(let o of Object.getOwnPropertyNames(r))a.includes(o)||$n(n,e,r[o])&&(i[o]=Ss(n,e,r[o]));return i}function t8e(t,e,r){if(!un(r)||mn(r))return r;let n=t.additionalProperties;for(let i of Object.getOwnPropertyNames(r)){if(Ar(t.properties,i)){r[i]=Ss(t.properties[i],e,r[i]);continue}if(S0(n)&&$n(n,e,r[i])){r[i]=Ss(n,e,r[i]);continue}delete r[i]}return r}function r8e(t,e,r){if(!un(r))return r;let n=t.additionalProperties,i=Object.getOwnPropertyNames(r),[a,o]=Object.entries(t.patternProperties)[0],s=new RegExp(a);for(let l of i){if(s.test(l)){r[l]=Ss(o,e,r[l]);continue}if(S0(n)&&$n(n,e,r[l])){r[l]=Ss(n,e,r[l]);continue}delete r[l]}return r}function n8e(t,e,r){return Ss(Ei(t,e),e,r)}function i8e(t,e,r){return Ss(Ei(t,e),e,r)}function a8e(t,e,r){if(!mn(r))return r;if(Cs(t.items))return[];let n=Math.min(r.length,t.items.length);for(let i=0;i<n;i++)r[i]=Ss(t.items[i],e,r[i]);return r.length>n?r.slice(0,n):r}function o8e(t,e,r){for(let n of t.anyOf)if(KFe(n)&&$n(n,e,r))return Ss(n,e,r);return r}function Ss(t,e,r){let n=Ln(t.$id)?[...e,t]:e,i=t;switch(i[xt]){case"Array":return QFe(i,n,r);case"Intersect":return e8e(i,n,r);case"Object":return t8e(i,n,r);case"Record":return r8e(i,n,r);case"Ref":return n8e(i,n,r);case"This":return i8e(i,n,r);case"Tuple":return a8e(i,n,r);case"Union":return o8e(i,n,r);default:return r}}function aK(...t){return t.length===3?Ss(t[0],t[1],t[2]):Ss(t[0],[],t[1])}C();function X3(t){return Ln(t)&&!isNaN(t)&&!isNaN(parseFloat(t))}function s8e(t){return js(t)||b0(t)||cr(t)}function C_(t){return t===!0||cr(t)&&t===1||js(t)&&t===BigInt("1")||Ln(t)&&(t.toLowerCase()==="true"||t==="1")}function M_(t){return t===!1||cr(t)&&(t===0||Object.is(t,-0))||js(t)&&t===BigInt("0")||Ln(t)&&(t.toLowerCase()==="false"||t==="0"||t==="-0")}function l8e(t){return Ln(t)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test(t)}function u8e(t){return Ln(t)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test(t)}function c8e(t){return Ln(t)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test(t)}function h8e(t){return Ln(t)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test(t)}function d8e(t){return Ln(t)&&/^\d\d\d\d-[0-1]\d-[0-3]\d$/i.test(t)}function p8e(t,e){let r=sK(t);return r===e?r:t}function f8e(t,e){let r=lK(t);return r===e?r:t}function m8e(t,e){let r=oK(t);return r===e?r:t}function g8e(t,e){return Ln(t.const)?p8e(e,t.const):cr(t.const)?f8e(e,t.const):b0(t.const)?m8e(e,t.const):e}function oK(t){return C_(t)?!0:M_(t)?!1:t}function y8e(t){let e=r=>r.split(".")[0];return X3(t)?BigInt(e(t)):cr(t)?BigInt(Math.trunc(t)):M_(t)?BigInt(0):C_(t)?BigInt(1):t}function sK(t){return s8e(t)?t.toString():g_(t)&&t.description!==void 0?t.description.toString():t}function lK(t){return X3(t)?parseFloat(t):C_(t)?1:M_(t)?0:t}function v8e(t){return X3(t)?parseInt(t):cr(t)?t|0:C_(t)?1:M_(t)?0:t}function _8e(t){return Ln(t)&&t.toLowerCase()==="null"?null:t}function x8e(t){return Ln(t)&&t==="undefined"?void 0:t}function b8e(t){return bd(t)?t:cr(t)?new Date(t):C_(t)?new Date(1):M_(t)?new Date(0):X3(t)?new Date(parseInt(t)):u8e(t)?new Date("1970-01-01T".concat(t,".000Z")):l8e(t)?new Date("1970-01-01T".concat(t)):h8e(t)?new Date("".concat(t,".000Z")):c8e(t)?new Date(t):d8e(t)?new Date("".concat(t,"T00:00:00.000Z")):t}function w8e(t,e,r){return(mn(r)?r:[r]).map(n=>Du(t.items,e,n))}function A8e(t,e,r){return y8e(r)}function S8e(t,e,r){return oK(r)}function E8e(t,e,r){return b8e(r)}function I8e(t,e,r){return v8e(r)}function C8e(t,e,r){return t.allOf.reduce((n,i)=>Du(i,e,n),r)}function M8e(t,e,r){return g8e(t,r)}function T8e(t,e,r){return _8e(r)}function P8e(t,e,r){return lK(r)}function D8e(t,e,r){if(!un(r))return r;for(let n of Object.getOwnPropertyNames(t.properties))Ar(r,n)&&(r[n]=Du(t.properties[n],e,r[n]));return r}function k8e(t,e,r){if(!un(r))return r;let n=Object.getOwnPropertyNames(t.patternProperties)[0],i=t.patternProperties[n];for(let[a,o]of Object.entries(r))r[a]=Du(i,e,o);return r}function O8e(t,e,r){return Du(Ei(t,e),e,r)}function B8e(t,e,r){return sK(r)}function z8e(t,e,r){return Ln(r)||cr(r)?Symbol(r):r}function F8e(t,e,r){return Du(Ei(t,e),e,r)}function R8e(t,e,r){return mn(r)&&!Cs(t.items)?r.map((n,i)=>i<t.items.length?Du(t.items[i],e,n):n):r}function L8e(t,e,r){return x8e(r)}function N8e(t,e,r){for(let n of t.anyOf){let i=Du(n,e,ii(r));if($n(n,e,i))return i}return r}function Du(t,e,r){let n=B0(t,e),i=t;switch(t[xt]){case"Array":return w8e(i,n,r);case"BigInt":return A8e(i,n,r);case"Boolean":return S8e(i,n,r);case"Date":return E8e(i,n,r);case"Integer":return I8e(i,n,r);case"Intersect":return C8e(i,n,r);case"Literal":return M8e(i,n,r);case"Null":return T8e(i,n,r);case"Number":return P8e(i,n,r);case"Object":return D8e(i,n,r);case"Record":return k8e(i,n,r);case"Ref":return O8e(i,n,r);case"String":return B8e(i,n,r);case"Symbol":return z8e(i,n,r);case"This":return F8e(i,n,r);case"Tuple":return R8e(i,n,r);case"Undefined":return L8e(i,n,r);case"Union":return N8e(i,n,r);default:return r}}function uK(...t){return t.length===3?Du(t[0],t[1],t[2]):Du(t[0],[],t[1])}C();C();var cK=class extends Un{constructor(t,e,r){super("Unable to decode value as it does not match the expected schema"),this.schema=t,this.value=e,this.error=r}},CO=class extends Un{constructor(t,e,r,n){super(n instanceof Error?n.message:"Unknown error"),this.schema=t,this.path=e,this.value=r,this.error=n}};function vi(t,e,r){try{return bi(t)?t[Uo].Decode(r):r}catch(n){throw new CO(t,e,r,n)}}function $8e(t,e,r,n){return mn(n)?vi(t,r,n.map((i,a)=>Gu(t.items,e,"".concat(r,"/").concat(a),i))):vi(t,r,n)}function U8e(t,e,r,n){if(!un(n)||Yc(n))return vi(t,r,n);let i=G3(t),a=i.map(c=>c[0]),o=ae({},n);for(let[c,h]of i)c in o&&(o[c]=Gu(h,e,"".concat(r,"/").concat(c),o[c]));if(!bi(t.unevaluatedProperties))return vi(t,r,o);let s=Object.getOwnPropertyNames(o),l=t.unevaluatedProperties,u=ae({},o);for(let c of s)a.includes(c)||(u[c]=vi(l,"".concat(r,"/").concat(c),u[c]));return vi(t,r,u)}function j8e(t,e,r,n){return vi(t,r,Gu(t.not,e,r,n))}function V8e(t,e,r,n){if(!un(n))return vi(t,r,n);let i=ju(t),a=ae({},n);for(let u of i)Ar(a,u)&&(Cs(a[u])&&(!U3(t.properties[u])||Bi.IsExactOptionalProperty(a,u))||(a[u]=Gu(t.properties[u],e,"".concat(r,"/").concat(u),a[u])));if(!xn(t.additionalProperties))return vi(t,r,a);let o=Object.getOwnPropertyNames(a),s=t.additionalProperties,l=ae({},a);for(let u of o)i.includes(u)||(l[u]=vi(s,"".concat(r,"/").concat(u),l[u]));return vi(t,r,l)}function G8e(t,e,r,n){if(!un(n))return vi(t,r,n);let i=Object.getOwnPropertyNames(t.patternProperties)[0],a=new RegExp(i),o=ae({},n);for(let c of Object.getOwnPropertyNames(n))a.test(c)&&(o[c]=Gu(t.patternProperties[i],e,"".concat(r,"/").concat(c),o[c]));if(!xn(t.additionalProperties))return vi(t,r,o);let s=Object.getOwnPropertyNames(o),l=t.additionalProperties,u=ae({},o);for(let c of s)a.test(c)||(u[c]=vi(l,"".concat(r,"/").concat(c),u[c]));return vi(t,r,u)}function Z8e(t,e,r,n){let i=Ei(t,e);return vi(t,r,Gu(i,e,r,n))}function W8e(t,e,r,n){let i=Ei(t,e);return vi(t,r,Gu(i,e,r,n))}function H8e(t,e,r,n){return mn(n)&&mn(t.items)?vi(t,r,t.items.map((i,a)=>Gu(i,e,"".concat(r,"/").concat(a),n[a]))):vi(t,r,n)}function X8e(t,e,r,n){for(let i of t.anyOf){if(!$n(i,e,n))continue;let a=Gu(i,e,r,n);return vi(t,r,a)}return vi(t,r,n)}function Gu(t,e,r,n){let i=B0(t,e),a=t;switch(t[xt]){case"Array":return $8e(a,i,r,n);case"Intersect":return U8e(a,i,r,n);case"Not":return j8e(a,i,r,n);case"Object":return V8e(a,i,r,n);case"Record":return G8e(a,i,r,n);case"Ref":return Z8e(a,i,r,n);case"Symbol":return vi(a,r,n);case"This":return W8e(a,i,r,n);case"Tuple":return H8e(a,i,r,n);case"Union":return X8e(a,i,r,n);default:return vi(a,r,n)}}function MO(t,e,r){return Gu(t,e,"",r)}C();var hK=class extends Un{constructor(t,e,r){super("The encoded value does not match the expected schema"),this.schema=t,this.value=e,this.error=r}},TO=class extends Un{constructor(t,e,r,n){super("".concat(n instanceof Error?n.message:"Unknown error")),this.schema=t,this.path=e,this.value=r,this.error=n}};function qa(t,e,r){try{return bi(t)?t[Uo].Encode(r):r}catch(n){throw new TO(t,e,r,n)}}function q8e(t,e,r,n){let i=qa(t,r,n);return mn(i)?i.map((a,o)=>ku(t.items,e,"".concat(r,"/").concat(o),a)):i}function Y8e(t,e,r,n){let i=qa(t,r,n);if(!un(n)||Yc(n))return i;let a=G3(t),o=a.map(h=>h[0]),s=ae({},i);for(let[h,d]of a)h in s&&(s[h]=ku(d,e,"".concat(r,"/").concat(h),s[h]));if(!bi(t.unevaluatedProperties))return s;let l=Object.getOwnPropertyNames(s),u=t.unevaluatedProperties,c=ae({},s);for(let h of l)o.includes(h)||(c[h]=qa(u,"".concat(r,"/").concat(h),c[h]));return c}function J8e(t,e,r,n){return qa(t.not,r,qa(t,r,n))}function K8e(t,e,r,n){let i=qa(t,r,n);if(!un(i))return i;let a=ju(t),o=ae({},i);for(let c of a)Ar(o,c)&&(Cs(o[c])&&(!U3(t.properties[c])||Bi.IsExactOptionalProperty(o,c))||(o[c]=ku(t.properties[c],e,"".concat(r,"/").concat(c),o[c])));if(!xn(t.additionalProperties))return o;let s=Object.getOwnPropertyNames(o),l=t.additionalProperties,u=ae({},o);for(let c of s)a.includes(c)||(u[c]=qa(l,"".concat(r,"/").concat(c),u[c]));return u}function Q8e(t,e,r,n){let i=qa(t,r,n);if(!un(n))return i;let a=Object.getOwnPropertyNames(t.patternProperties)[0],o=new RegExp(a),s=ae({},i);for(let h of Object.getOwnPropertyNames(n))o.test(h)&&(s[h]=ku(t.patternProperties[a],e,"".concat(r,"/").concat(h),s[h]));if(!xn(t.additionalProperties))return s;let l=Object.getOwnPropertyNames(s),u=t.additionalProperties,c=ae({},s);for(let h of l)o.test(h)||(c[h]=qa(u,"".concat(r,"/").concat(h),c[h]));return c}function eRe(t,e,r,n){let i=Ei(t,e),a=ku(i,e,r,n);return qa(t,r,a)}function tRe(t,e,r,n){let i=Ei(t,e),a=ku(i,e,r,n);return qa(t,r,a)}function rRe(t,e,r,n){let i=qa(t,r,n);return mn(t.items)?t.items.map((a,o)=>ku(a,e,"".concat(r,"/").concat(o),i[o])):[]}function nRe(t,e,r,n){for(let i of t.anyOf){if(!$n(i,e,n))continue;let a=ku(i,e,r,n);return qa(t,r,a)}for(let i of t.anyOf){let a=ku(i,e,r,n);if($n(t,e,a))return qa(t,r,a)}return qa(t,r,n)}function ku(t,e,r,n){let i=B0(t,e),a=t;switch(t[xt]){case"Array":return q8e(a,i,r,n);case"Intersect":return Y8e(a,i,r,n);case"Not":return J8e(a,i,r,n);case"Object":return K8e(a,i,r,n);case"Record":return Q8e(a,i,r,n);case"Ref":return eRe(a,i,r,n);case"This":return tRe(a,i,r,n);case"Tuple":return rRe(a,i,r,n);case"Union":return nRe(a,i,r,n);default:return qa(a,r,n)}}function dK(t,e,r){return ku(t,e,"",r)}C();function iRe(t,e){return bi(t)||wa(t.items,e)}function aRe(t,e){return bi(t)||wa(t.items,e)}function oRe(t,e){return bi(t)||wa(t.returns,e)||t.parameters.some(r=>wa(r,e))}function sRe(t,e){return bi(t)||wa(t.returns,e)||t.parameters.some(r=>wa(r,e))}function lRe(t,e){return bi(t)||bi(t.unevaluatedProperties)||t.allOf.some(r=>wa(r,e))}function uRe(t,e){return bi(t)||wa(t.items,e)}function cRe(t,e){return bi(t)||wa(t.not,e)}function hRe(t,e){return bi(t)||Object.values(t.properties).some(r=>wa(r,e))||xn(t.additionalProperties)&&wa(t.additionalProperties,e)}function dRe(t,e){return bi(t)||wa(t.item,e)}function pRe(t,e){let r=Object.getOwnPropertyNames(t.patternProperties)[0],n=t.patternProperties[r];return bi(t)||wa(n,e)||xn(t.additionalProperties)&&bi(t.additionalProperties)}function fRe(t,e){return bi(t)?!0:wa(Ei(t,e),e)}function mRe(t,e){return bi(t)?!0:wa(Ei(t,e),e)}function gRe(t,e){return bi(t)||!Cs(t.items)&&t.items.some(r=>wa(r,e))}function yRe(t,e){return bi(t)||t.anyOf.some(r=>wa(r,e))}function wa(t,e){let r=B0(t,e),n=t;if(t.$id&&uT.has(t.$id))return!1;switch(t.$id&&uT.add(t.$id),t[xt]){case"Array":return iRe(n,r);case"AsyncIterator":return aRe(n,r);case"Constructor":return oRe(n,r);case"Function":return sRe(n,r);case"Intersect":return lRe(n,r);case"Iterator":return uRe(n,r);case"Not":return cRe(n,r);case"Object":return hRe(n,r);case"Promise":return dRe(n,r);case"Record":return pRe(n,r);case"Ref":return fRe(n,r);case"This":return mRe(n,r);case"Tuple":return gRe(n,r);case"Union":return yRe(n,r);default:return bi(t)}}var uT=new Set;function T_(t,e){return uT.clear(),wa(t,e)}function vRe(...t){let[e,r,n]=t.length===3?[t[0],t[1],t[2]]:[t[0],[],t[1]];if(!$n(e,r,n))throw new cK(e,n,I_(e,r,n).First());return T_(e,r)?MO(e,r,n):n}C();function eh(t,e){let r=Ar(t,"default")?t.default:void 0,n=R3(r)?r():ii(r);return Cs(e)?n:un(e)&&un(n)?Object.assign(n,e):e}function cT(t){return S0(t)&&"default"in t}function _Re(t,e,r){let n=eh(t,r);if(!mn(n))return n;for(let i=0;i<n.length;i++)n[i]=vs(t.items,e,n[i]);return n}function xRe(t,e,r){return bd(r)?r:eh(t,r)}function bRe(t,e,r){let n=eh(t,r);return t.allOf.reduce((i,a)=>{let o=vs(a,e,n);return un(o)?ae(ae({},i),o):o},{})}function wRe(t,e,r){let n=eh(t,r);if(!un(n))return n;let i=Object.getOwnPropertyNames(t.properties);for(let a of i){let o=vs(t.properties[a],e,n[a]);Cs(o)||(n[a]=vs(t.properties[a],e,n[a]))}if(!cT(t.additionalProperties))return n;for(let a of Object.getOwnPropertyNames(n))i.includes(a)||(n[a]=vs(t.additionalProperties,e,n[a]));return n}function ARe(t,e,r){let n=eh(t,r);if(!un(n))return n;let i=t.additionalProperties,[a,o]=Object.entries(t.patternProperties)[0],s=new RegExp(a);for(let l of Object.getOwnPropertyNames(n))s.test(l)&&cT(o)&&(n[l]=vs(o,e,n[l]));if(!cT(i))return n;for(let l of Object.getOwnPropertyNames(n))s.test(l)||(n[l]=vs(i,e,n[l]));return n}function SRe(t,e,r){return vs(Ei(t,e),e,eh(t,r))}function ERe(t,e,r){return vs(Ei(t,e),e,r)}function IRe(t,e,r){let n=eh(t,r);if(!mn(n)||Cs(t.items))return n;let[i,a]=[t.items,Math.max(t.items.length,n.length)];for(let o=0;o<a;o++)o<i.length&&(n[o]=vs(i[o],e,n[o]));return n}function CRe(t,e,r){let n=eh(t,r);for(let i of t.anyOf){let a=vs(i,e,ii(n));if($n(i,e,a))return a}return n}function vs(t,e,r){let n=B0(t,e),i=t;switch(i[xt]){case"Array":return _Re(i,n,r);case"Date":return xRe(i,n,r);case"Intersect":return bRe(i,n,r);case"Object":return wRe(i,n,r);case"Record":return ARe(i,n,r);case"Ref":return SRe(i,n,r);case"This":return ERe(i,n,r);case"Tuple":return IRe(i,n,r);case"Union":return CRe(i,n,r);default:return eh(i,r)}}function pK(...t){return t.length===3?vs(t[0],t[1],t[2]):vs(t[0],[],t[1])}C();C();var nd={};So(nd,{Delete:()=>TRe,Format:()=>P_,Get:()=>DRe,Has:()=>PRe,Set:()=>MRe,ValuePointerRootDeleteError:()=>mK,ValuePointerRootSetError:()=>fK});C();var fK=class extends Un{constructor(t,e,r){super("Cannot set root value"),this.value=t,this.path=e,this.update=r}},mK=class extends Un{constructor(t,e){super("Cannot delete root value"),this.value=t,this.path=e}};function lR(t){return t.indexOf("~")===-1?t:t.replace(/~1/g,"/").replace(/~0/g,"~")}function*P_(t){if(t==="")return;let[e,r]=[0,0];for(let n=0;n<t.length;n++)t.charAt(n)==="/"?(n===0||(r=n,yield lR(t.slice(e,r))),e=n+1):r=n;yield lR(t.slice(e))}function MRe(t,e,r){if(e==="")throw new fK(t,e,r);let[n,i,a]=[null,t,""];for(let o of P_(e))i[o]===void 0&&(i[o]={}),n=i,i=i[o],a=o;n[a]=r}function TRe(t,e){if(e==="")throw new mK(t,e);let[r,n,i]=[null,t,""];for(let a of P_(e)){if(n[a]===void 0||n[a]===null)return;r=n,n=n[a],i=a}if(Array.isArray(r)){let a=parseInt(i);r.splice(a,1)}else delete r[i]}function PRe(t,e){if(e==="")return!0;let[r,n,i]=[null,t,""];for(let a of P_(e)){if(n[a]===void 0)return!1;r=n,n=n[a],i=a}return Object.getOwnPropertyNames(r).includes(i)}function DRe(t,e){if(e==="")return t;let r=t;for(let n of P_(e)){if(r[n]===void 0)return;r=r[n]}return r}C();function kRe(t,e){if(!un(e))return!1;let r=[...Object.keys(t),...Object.getOwnPropertySymbols(t)],n=[...Object.keys(e),...Object.getOwnPropertySymbols(e)];return r.length!==n.length?!1:r.every(i=>D_(t[i],e[i]))}function ORe(t,e){return bd(e)&&t.getTime()===e.getTime()}function BRe(t,e){return!mn(e)||t.length!==e.length?!1:t.every((r,n)=>D_(r,e[n]))}function zRe(t,e){return!wd(e)||t.length!==e.length||Object.getPrototypeOf(t).constructor.name!==Object.getPrototypeOf(e).constructor.name?!1:t.every((r,n)=>D_(r,e[n]))}function FRe(t,e){return t===e}function D_(t,e){if(bd(t))return ORe(t,e);if(wd(t))return zRe(t,e);if(mn(t))return BRe(t,e);if(un(t))return kRe(t,e);if(Yc(t))return FRe(t,e);throw new Error("ValueEquals: Unable to compare value")}var RRe=ba({type:Vi("insert"),path:fd(),value:A_()}),LRe=ba({type:Vi("update"),path:fd(),value:A_()}),NRe=ba({type:Vi("delete"),path:fd()}),$Re=Eo([RRe,LRe,NRe]),gK=class extends Un{constructor(t,e){super(e),this.value=t}};function q3(t,e){return{type:"update",path:t,value:e}}function yK(t,e){return{type:"insert",path:t,value:e}}function vK(t){return{type:"delete",path:t}}function uR(t){if(globalThis.Object.getOwnPropertySymbols(t).length>0)throw new gK(t,"Cannot diff objects with symbols")}function*URe(t,e,r){if(uR(e),uR(r),!sY(r))return yield q3(t,r);let n=globalThis.Object.getOwnPropertyNames(e),i=globalThis.Object.getOwnPropertyNames(r);for(let a of i)Ar(e,a)||(yield yK("".concat(t,"/").concat(a),r[a]));for(let a of n)Ar(r,a)&&(D_(e,r)||(yield*ut(Y3("".concat(t,"/").concat(a),e[a],r[a]))));for(let a of n)Ar(r,a)||(yield vK("".concat(t,"/").concat(a)))}function*jRe(t,e,r){if(!mn(r))return yield q3(t,r);for(let n=0;n<Math.min(e.length,r.length);n++)yield*ut(Y3("".concat(t,"/").concat(n),e[n],r[n]));for(let n=0;n<r.length;n++)n<e.length||(yield yK("".concat(t,"/").concat(n),r[n]));for(let n=e.length-1;n>=0;n--)n<r.length||(yield vK("".concat(t,"/").concat(n)))}function*VRe(t,e,r){if(!wd(r)||e.length!==r.length||globalThis.Object.getPrototypeOf(e).constructor.name!==globalThis.Object.getPrototypeOf(r).constructor.name)return yield q3(t,r);for(let n=0;n<Math.min(e.length,r.length);n++)yield*ut(Y3("".concat(t,"/").concat(n),e[n],r[n]))}function*GRe(t,e,r){e!==r&&(yield q3(t,r))}function*Y3(t,e,r){if(sY(e))return yield*ut(URe(t,e,r));if(mn(e))return yield*ut(jRe(t,e,r));if(wd(e))return yield*ut(VRe(t,e,r));if(Yc(e))return yield*ut(GRe(t,e,r));throw new gK(e,"Unable to diff value")}function ZRe(t,e){return[...Y3("",t,e)]}function WRe(t){return t.length>0&&t[0].path===""&&t[0].type==="update"}function HRe(t){return t.length===0}function XRe(t,e){if(WRe(e))return ii(e[0].value);if(HRe(e))return ii(t);let r=ii(t);for(let n of e)switch(n.type){case"insert":{nd.Set(r,n.path,n.value);break}case"update":{nd.Set(r,n.path,n.value);break}case"delete":{nd.Delete(r,n.path);break}}return r}C();function qRe(...t){let[e,r,n]=t.length===3?[t[0],t[1],t[2]]:[t[0],[],t[1]],i=T_(e,r)?dK(e,r,n):n;if(!$n(e,r,i))throw new hK(e,i,I_(e,r,i).First());return i}C();var cR=class extends Un{constructor(t){super(t)}};function YRe(t,e,r,n){if(!un(r))nd.Set(t,e,ii(n));else{let i=Object.getOwnPropertyNames(r),a=Object.getOwnPropertyNames(n);for(let o of i)a.includes(o)||delete r[o];for(let o of a)i.includes(o)||(r[o]=null);for(let o of a)PO(t,"".concat(e,"/").concat(o),r[o],n[o])}}function JRe(t,e,r,n){if(!mn(r))nd.Set(t,e,ii(n));else{for(let i=0;i<n.length;i++)PO(t,"".concat(e,"/").concat(i),r[i],n[i]);r.splice(n.length)}}function KRe(t,e,r,n){if(wd(r)&&r.length===n.length)for(let i=0;i<r.length;i++)r[i]=n[i];else nd.Set(t,e,ii(n))}function QRe(t,e,r,n){r!==n&&nd.Set(t,e,n)}function PO(t,e,r,n){if(mn(n))return JRe(t,e,r,n);if(wd(n))return KRe(t,e,r,n);if(un(n))return YRe(t,e,r,n);if(Yc(n))return QRe(t,e,r,n)}function hR(t){return wd(t)||Yc(t)}function eLe(t,e){return un(t)&&mn(e)||mn(t)&&un(e)}function tLe(t,e){if(hR(t)||hR(e))throw new cR("Only object and array types can be mutated at the root level");if(eLe(t,e))throw new cR("Cannot assign due type mismatch of assignable values");PO(t,"",t,e)}C();var rLe=[(t,e,r)=>ii(r),(t,e,r)=>pK(t,e,r),(t,e,r)=>aK(t,e,r),(t,e,r)=>uK(t,e,r),(t,e,r)=>(tK(t,e,r),r),(t,e,r)=>T_(t,e)?MO(t,e,r):r];function dR(t,e,r){return rLe.reduce((n,i)=>i(t,e,n),r)}function nLe(...t){return t.length===3?dR(t[0],t[1],t[2]):dR(t[0],[],t[1])}C();var qg={};So(qg,{Assert:()=>tK,Cast:()=>iK,Check:()=>$n,Clean:()=>aK,Clone:()=>ii,Convert:()=>uK,Create:()=>Tu,Decode:()=>vRe,Default:()=>pK,Diff:()=>ZRe,Edit:()=>$Re,Encode:()=>qRe,Equal:()=>D_,Errors:()=>I_,Hash:()=>H3,Mutate:()=>tLe,Parse:()=>nLe,Patch:()=>XRe,ValueErrorIterator:()=>z0});C();C();var pR={},iLe=function(t,e,r,n,i){var a=new Worker(pR[e]||(pR[e]=URL.createObjectURL(new Blob([t+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return a.onmessage=function(o){var s=o.data,l=s.$e$;if(l){var u=new Error(l[0]);u.code=l[1],u.stack=l[2],i(u,null)}else i(null,s)},a.postMessage(r,n),a},Rn=Uint8Array,yo=Uint16Array,k_=Int32Array,F0=new Rn([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),R0=new Rn([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),O1=new Rn([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),_K=function(t,e){for(var r=new yo(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var i=new k_(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)i[a]=a-r[n]<<5|n;return{b:r,r:i}},xK=_K(F0,2),DO=xK.b,Y4=xK.r;DO[28]=258,Y4[258]=28;var bK=_K(R0,0),wK=bK.b,hT=bK.r,B1=new yo(32768);for(pn=0;pn<32768;++pn)ac=(pn&43690)>>1|(pn&21845)<<1,ac=(ac&52428)>>2|(ac&13107)<<2,ac=(ac&61680)>>4|(ac&3855)<<4,B1[pn]=((ac&65280)>>8|(ac&255)<<8)>>1;var ac,pn,Hs=function(t,e,r){for(var n=t.length,i=0,a=new yo(e);i<n;++i)t[i]&&++a[t[i]-1];var o=new yo(e);for(i=1;i<e;++i)o[i]=o[i-1]+a[i-1]<<1;var s;if(r){s=new yo(1<<e);var l=15-e;for(i=0;i<n;++i)if(t[i])for(var u=i<<4|t[i],c=e-t[i],h=o[t[i]-1]++<<c,d=h|(1<<c)-1;h<=d;++h)s[B1[h]>>l]=u}else for(s=new yo(n),i=0;i<n;++i)t[i]&&(s[i]=B1[o[t[i]-1]++]>>15-t[i]);return s},Hc=new Rn(288);for(pn=0;pn<144;++pn)Hc[pn]=8;var pn;for(pn=144;pn<256;++pn)Hc[pn]=9;var pn;for(pn=256;pn<280;++pn)Hc[pn]=7;var pn;for(pn=280;pn<288;++pn)Hc[pn]=8;var pn,Yg=new Rn(32);for(pn=0;pn<32;++pn)Yg[pn]=5;var pn,AK=Hs(Hc,9,0),SK=Hs(Hc,9,1),EK=Hs(Yg,5,0),IK=Hs(Yg,5,1),y2=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},ks=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},v2=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},O_=function(t){return(t+7)/8|0},Ed=function(t,e,r){return(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length),new Rn(t.subarray(e,r))},CK={UnexpectedEOF:0,InvalidBlockType:1,InvalidLengthLiteral:2,InvalidDistance:3,StreamFinished:4,NoStreamHandler:5,InvalidHeader:6,NoCallback:7,InvalidUTF8:8,ExtraFieldTooLong:9,InvalidDate:10,FilenameTooLong:11,StreamFinishing:12,InvalidZipData:13,UnknownCompressionMethod:14},MK=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],fi=function(t,e,r){var n=new Error(e||MK[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,fi),!r)throw n;return n},TK=function(t,e,r,n){var i=t.length,a=n?n.length:0;if(!i||e.f&&!e.l)return r||new Rn(0);var o=!r,s=o||e.i!=2,l=e.i;o&&(r=new Rn(i*3));var u=function(q){var oe=r.length;if(q>oe){var ce=new Rn(Math.max(oe*2,q));ce.set(r),r=ce}},c=e.f||0,h=e.p||0,d=e.b||0,p=e.l,m=e.d,y=e.m,v=e.n,_=i*8;do{if(!p){c=ks(t,h,1);var w=ks(t,h+1,3);if(h+=3,w)if(w==1)p=SK,m=IK,y=9,v=5;else if(w==2){var b=ks(t,h,31)+257,A=ks(t,h+10,15)+4,E=b+ks(t,h+5,31)+1;h+=14;for(var M=new Rn(E),P=new Rn(19),k=0;k<A;++k)P[O1[k]]=ks(t,h+k*3,7);h+=A*3;for(var D=y2(P),O=(1<<D)-1,B=Hs(P,D,1),k=0;k<E;){var L=B[ks(t,h,O)];h+=L&15;var R=L>>4;if(R<16)M[k++]=R;else{var T=0,N=0;for(R==16?(N=3+ks(t,h,3),h+=2,T=M[k-1]):R==17?(N=3+ks(t,h,7),h+=3):R==18&&(N=11+ks(t,h,127),h+=7);N--;)M[k++]=T}}var $=M.subarray(0,b),V=M.subarray(b);y=y2($),v=y2(V),p=Hs($,y,1),m=Hs(V,v,1)}else fi(1);else{var R=O_(h)+4,G=t[R-4]|t[R-3]<<8,ee=R+G;if(ee>i){l&&fi(0);break}s&&u(d+G),r.set(t.subarray(R,ee),d),e.b=d+=G,e.p=h=ee*8,e.f=c;continue}if(h>_){l&&fi(0);break}}s&&u(d+131072);for(var ie=(1<<y)-1,me=(1<<v)-1,Me=h;;Me=h){var T=p[v2(t,h)&ie],Ae=T>>4;if(h+=T&15,h>_){l&&fi(0);break}if(T||fi(2),Ae<256)r[d++]=Ae;else if(Ae==256){Me=h,p=null;break}else{var le=Ae-254;if(Ae>264){var k=Ae-257,_e=F0[k];le=ks(t,h,(1<<_e)-1)+DO[k],h+=_e}var Le=m[v2(t,h)&me],Se=Le>>4;Le||fi(3),h+=Le&15;var V=wK[Se];if(Se>3){var _e=R0[Se];V+=v2(t,h)&(1<<_e)-1,h+=_e}if(h>_){l&&fi(0);break}s&&u(d+131072);var Ue=d+le;if(d<V){var Y=a-V,we=Math.min(V,Ue);for(Y+d<0&&fi(3);d<we;++d)r[d]=n[Y+d]}for(;d<Ue;++d)r[d]=r[d-V]}}e.l=p,e.p=Me,e.b=d,e.f=c,p&&(c=1,e.m=y,e.d=m,e.n=v)}while(!c);return d!=r.length&&o?Ed(r,0,d):r.subarray(0,d)},Yl=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},Yf=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},_2=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var i=r.length,a=r.slice();if(!i)return{t:OO,l:0};if(i==1){var o=new Rn(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(E,M){return E.f-M.f}),r.push({s:-1,f:25001});var s=r[0],l=r[1],u=0,c=1,h=2;for(r[0]={s:-1,f:s.f+l.f,l:s,r:l};c!=i-1;)s=r[r[u].f<r[h].f?u++:h++],l=r[u!=c&&r[u].f<r[h].f?u++:h++],r[c++]={s:-1,f:s.f+l.f,l:s,r:l};for(var d=a[0].s,n=1;n<i;++n)a[n].s>d&&(d=a[n].s);var p=new yo(d+1),m=J4(r[c-1],p,0);if(m>e){var n=0,y=0,v=m-e,_=1<<v;for(a.sort(function(M,P){return p[P.s]-p[M.s]||M.f-P.f});n<i;++n){var w=a[n].s;if(p[w]>e)y+=_-(1<<m-p[w]),p[w]=e;else break}for(y>>=v;y>0;){var b=a[n].s;p[b]<e?y-=1<<e-p[b]++-1:++n}for(;n>=0&&y;--n){var A=a[n].s;p[A]==e&&(--p[A],++y)}m=e}return{t:new Rn(p),l:m}},J4=function(t,e,r){return t.s==-1?Math.max(J4(t.l,e,r+1),J4(t.r,e,r+1)):e[t.s]=r},dT=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new yo(++e),n=0,i=t[0],a=1,o=function(l){r[n++]=l},s=1;s<=e;++s)if(t[s]==i&&s!=e)++a;else{if(!i&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(i),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(i);a=1,i=t[s]}return{c:r.subarray(0,n),n:e}},Jf=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},kO=function(t,e,r){var n=r.length,i=O_(e+2);t[i]=n&255,t[i+1]=n>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var a=0;a<n;++a)t[i+a+4]=r[a];return(i+4+n)*8},pT=function(t,e,r,n,i,a,o,s,l,u,c){Yl(e,c++,r),++i[256];for(var h=_2(i,15),d=h.t,p=h.l,m=_2(a,15),y=m.t,v=m.l,_=dT(d),w=_.c,b=_.n,A=dT(y),E=A.c,M=A.n,P=new yo(19),k=0;k<w.length;++k)++P[w[k]&31];for(var k=0;k<E.length;++k)++P[E[k]&31];for(var D=_2(P,7),O=D.t,B=D.l,L=19;L>4&&!O[O1[L-1]];--L);var R=u+5<<3,T=Jf(i,Hc)+Jf(a,Yg)+o,N=Jf(i,d)+Jf(a,y)+o+14+3*L+Jf(P,O)+2*P[16]+3*P[17]+7*P[18];if(l>=0&&R<=T&&R<=N)return kO(e,c,t.subarray(l,l+u));var $,V,G,ee;if(Yl(e,c,1+(N<T)),c+=2,N<T){$=Hs(d,p,0),V=d,G=Hs(y,v,0),ee=y;var ie=Hs(O,B,0);Yl(e,c,b-257),Yl(e,c+5,M-1),Yl(e,c+10,L-4),c+=14;for(var k=0;k<L;++k)Yl(e,c+3*k,O[O1[k]]);c+=3*L;for(var me=[w,E],Me=0;Me<2;++Me)for(var Ae=me[Me],k=0;k<Ae.length;++k){var le=Ae[k]&31;Yl(e,c,ie[le]),c+=O[le],le>15&&(Yl(e,c,Ae[k]>>5&127),c+=Ae[k]>>12)}}else $=AK,V=Hc,G=EK,ee=Yg;for(var k=0;k<s;++k){var _e=n[k];if(_e>255){var le=_e>>18&31;Yf(e,c,$[le+257]),c+=V[le+257],le>7&&(Yl(e,c,_e>>23&31),c+=F0[le]);var Le=_e&31;Yf(e,c,G[Le]),c+=ee[Le],Le>3&&(Yf(e,c,_e>>5&8191),c+=R0[Le])}else Yf(e,c,$[_e]),c+=V[_e]}return Yf(e,c,$[256]),c+V[256]},PK=new k_([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),OO=new Rn(0),DK=function(t,e,r,n,i,a){var o=a.z||t.length,s=new Rn(n+o+5*(1+Math.ceil(o/7e3))+i),l=s.subarray(n,s.length-i),u=a.l,c=(a.r||0)&7;if(e){c&&(l[0]=a.r>>3);for(var h=PK[e-1],d=h>>13,p=h&8191,m=(1<<r)-1,y=a.p||new yo(32768),v=a.h||new yo(m+1),_=Math.ceil(r/3),w=2*_,b=function(X){return(t[X]^t[X+1]<<_^t[X+2]<<w)&m},A=new k_(25e3),E=new yo(288),M=new yo(32),P=0,k=0,D=a.i||0,O=0,B=a.w||0,L=0;D+2<o;++D){var R=b(D),T=D&32767,N=v[R];if(y[T]=N,v[R]=T,B<=D){var $=o-D;if((P>7e3||O>24576)&&($>423||!u)){c=pT(t,l,0,A,E,M,k,O,L,D-L,c),O=P=k=0,L=D;for(var V=0;V<286;++V)E[V]=0;for(var V=0;V<30;++V)M[V]=0}var G=2,ee=0,ie=p,me=T-N&32767;if($>2&&R==b(D-me))for(var Me=Math.min(d,$)-1,Ae=Math.min(32767,D),le=Math.min(258,$);me<=Ae&&--ie&&T!=N;){if(t[D+G]==t[D+G-me]){for(var _e=0;_e<le&&t[D+_e]==t[D+_e-me];++_e);if(_e>G){if(G=_e,ee=me,_e>Me)break;for(var Le=Math.min(me,_e-2),Se=0,V=0;V<Le;++V){var Ue=D-me+V&32767,Y=y[Ue],we=Ue-Y&32767;we>Se&&(Se=we,N=Ue)}}}T=N,N=y[T],me+=T-N&32767}if(ee){A[O++]=268435456|Y4[G]<<18|hT[ee];var q=Y4[G]&31,oe=hT[ee]&31;k+=F0[q]+R0[oe],++E[257+q],++M[oe],B=D+G,++P}else A[O++]=t[D],++E[t[D]]}}for(D=Math.max(D,B);D<o;++D)A[O++]=t[D],++E[t[D]];c=pT(t,l,u,A,E,M,k,O,L,D-L,c),u||(a.r=c&7|l[c/8|0]<<3,c-=7,a.h=v,a.p=y,a.i=D,a.w=B)}else{for(var D=a.w||0;D<o+u;D+=65535){var ce=D+65535;ce>=o&&(l[c/8|0]=u,ce=o),c=kO(l,c+1,t.subarray(D,ce))}a.i=o}return Ed(s,0,n+O_(c)+i)},aLe=(function(){for(var t=new Int32Array(256),e=0;e<256;++e){for(var r=e,n=9;--n;)r=(r&1&&-306674912)^r>>>1;t[e]=r}return t})(),kK=function(){var t=-1;return{p:function(e){for(var r=t,n=0;n<e.length;++n)r=aLe[r&255^e[n]]^r>>>8;t=r},d:function(){return~t}}},OK=function(t,e,r,n,i){if(!i&&(i={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),o=new Rn(a.length+t.length);o.set(a),o.set(t,a.length),t=o,i.w=a.length}return DK(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,i)},J3=function(t,e){var r={};for(var n in t)r[n]=t[n];for(var n in e)r[n]=e[n];return r},fR=function(t,e,r){for(var n=t(),i=t.toString(),a=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/\s+/g,"").split(","),o=0;o<n.length;++o){var s=n[o],l=a[o];if(typeof s=="function"){e+=";"+l+"=";var u=s.toString();if(s.prototype)if(u.indexOf("[native code]")!=-1){var c=u.indexOf(" ",8)+1;e+=u.slice(c,u.indexOf("(",c))}else{e+=u;for(var h in s.prototype)e+=";"+l+".prototype."+h+"="+s.prototype[h].toString()}else e+=u}else r[l]=s}return e},pb=[],oLe=function(t){var e=[];for(var r in t)t[r].buffer&&e.push((t[r]=new t[r].constructor(t[r])).buffer);return e},sLe=function(t,e,r,n){if(!pb[r]){for(var i="",a={},o=t.length-1,s=0;s<o;++s)i=fR(t[s],i,a);pb[r]={c:fR(t[o],i,a),e:a}}var l=J3({},pb[r].e);return iLe(pb[r].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",r,l,oLe(l),n)},lLe=function(){return[Rn,yo,k_,F0,R0,O1,DO,wK,SK,IK,B1,MK,Hs,y2,ks,v2,O_,Ed,fi,TK,eS,K3,BK]},uLe=function(){return[Rn,yo,k_,F0,R0,O1,Y4,hT,AK,Hc,EK,Yg,B1,PK,OO,Hs,Yl,Yf,_2,J4,dT,Jf,kO,pT,O_,Ed,DK,OK,Q3,K3]},K3=function(t){return postMessage(t,[t.buffer])},BK=function(t){return t&&{out:t.size&&new Rn(t.size),dictionary:t.dictionary}},zK=function(t,e,r,n,i,a){var o=sLe(r,n,i,function(s,l){o.terminate(),a(s,l)});return o.postMessage([t,e],e.consume?[t.buffer]:[]),function(){o.terminate()}},Cl=function(t,e){return t[e]|t[e+1]<<8},Ta=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},dI=function(t,e){return Ta(t,e)+Ta(t,e+4)*4294967296},Ca=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8};function cLe(t,e,r){return r||(r=e,e={}),typeof r!="function"&&fi(7),zK(t,e,[uLe],function(n){return K3(Q3(n.data[0],n.data[1]))},0,r)}function Q3(t,e){return OK(t,e||{},0,0)}function hLe(t,e,r){return r||(r=e,e={}),typeof r!="function"&&fi(7),zK(t,e,[lLe],function(n){return K3(eS(n.data[0],BK(n.data[1])))},1,r)}function eS(t,e){return TK(t,{i:2},e&&e.out,e&&e.dictionary)}var BO=function(t,e,r,n){for(var i in t){var a=t[i],o=e+i,s=n;Array.isArray(a)&&(s=J3(n,a[1]),a=a[0]),a instanceof Rn?r[o]=[a,s]:(r[o+="/"]=[new Rn(0),s],BO(a,o,r,n))}},mR=typeof TextEncoder<"u"&&new TextEncoder,fT=typeof TextDecoder<"u"&&new TextDecoder,dLe=0;try{fT.decode(OO,{stream:!0}),dLe=1}catch{}var pLe=function(t){for(var e="",r=0;;){var n=t[r++],i=(n>127)+(n>223)+(n>239);if(r+i>t.length)return{s:e,r:Ed(t,r-1)};i?i==3?(n=((n&15)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,e+=String.fromCharCode(55296|n>>10,56320|n&1023)):i&1?e+=String.fromCharCode((n&31)<<6|t[r++]&63):e+=String.fromCharCode((n&15)<<12|(t[r++]&63)<<6|t[r++]&63):e+=String.fromCharCode(n)}};function z1(t,e){var r;if(mR)return mR.encode(t);for(var n=t.length,i=new Rn(t.length+(t.length>>1)),a=0,o=function(c){i[a++]=c},r=0;r<n;++r){if(a+5>i.length){var s=new Rn(a+8+(n-r<<1));s.set(i),i=s}var l=t.charCodeAt(r);l<128||e?o(l):l<2048?(o(192|l>>6),o(128|l&63)):l>55295&&l<57344?(l=65536+(l&1047552)|t.charCodeAt(++r)&1023,o(240|l>>18),o(128|l>>12&63),o(128|l>>6&63),o(128|l&63)):(o(224|l>>12),o(128|l>>6&63),o(128|l&63))}return Ed(i,0,a)}function FK(t,e){if(e){for(var r="",n=0;n<t.length;n+=16384)r+=String.fromCharCode.apply(null,t.subarray(n,n+16384));return r}else{if(fT)return fT.decode(t);var i=pLe(t),a=i.s,r=i.r;return r.length&&fi(8),a}}var RK=function(t,e){return e+30+Cl(t,e+26)+Cl(t,e+28)},LK=function(t,e,r){var n=Cl(t,e+28),i=FK(t.subarray(e+46,e+46+n),!(Cl(t,e+8)&2048)),a=e+46+n,o=Ta(t,e+20),s=r&&o==4294967295?fLe(t,a):[o,Ta(t,e+24),Ta(t,e+42)],l=s[0],u=s[1],c=s[2];return[Cl(t,e+10),l,u,i,a+Cl(t,e+30)+Cl(t,e+32),c]},fLe=function(t,e){for(;Cl(t,e)!=1;e+=4+Cl(t,e+2));return[dI(t,e+12),dI(t,e+4),dI(t,e+20)]},F1=function(t){var e=0;if(t)for(var r in t){var n=t[r].length;n>65535&&fi(9),e+=n+4}return e},K4=function(t,e,r,n,i,a,o,s){var l=n.length,u=r.extra,c=s&&s.length,h=F1(u);Ca(t,e,o!=null?33639248:67324752),e+=4,o!=null&&(t[e++]=20,t[e++]=r.os),t[e]=20,e+=2,t[e++]=r.flag<<1|(a<0&&8),t[e++]=i&&8,t[e++]=r.compression&255,t[e++]=r.compression>>8;var d=new Date(r.mtime==null?Date.now():r.mtime),p=d.getFullYear()-1980;if((p<0||p>119)&&fi(10),Ca(t,e,p<<25|d.getMonth()+1<<21|d.getDate()<<16|d.getHours()<<11|d.getMinutes()<<5|d.getSeconds()>>1),e+=4,a!=-1&&(Ca(t,e,r.crc),Ca(t,e+4,a<0?-a-2:a),Ca(t,e+8,r.size)),Ca(t,e+12,l),Ca(t,e+14,h),e+=16,o!=null&&(Ca(t,e,c),Ca(t,e+6,r.attrs),Ca(t,e+10,o),e+=14),t.set(n,e),e+=l,h)for(var m in u){var y=u[m],v=y.length;Ca(t,e,+m),Ca(t,e+2,v),t.set(y,e+4),e+=4+v}return c&&(t.set(s,e),e+=c),e},NK=function(t,e,r,n,i){Ca(t,e,101010256),Ca(t,e+8,r),Ca(t,e+10,r),Ca(t,e+12,n),Ca(t,e+16,i)};function mLe(t,e,r){r||(r=e,e={}),typeof r!="function"&&fi(7);var n={};BO(t,"",n,e);var i=Object.keys(n),a=i.length,o=0,s=0,l=a,u=new Array(a),c=[],h=function(){for(var v=0;v<c.length;++v)c[v]()},d=function(v,_){Q4(function(){r(v,_)})};Q4(function(){d=r});var p=function(){var v=new Rn(s+22),_=o,w=s-o;s=0;for(var b=0;b<l;++b){var A=u[b];try{var E=A.c.length;K4(v,s,A,A.f,A.u,E);var M=30+A.f.length+F1(A.extra),P=s+M;v.set(A.c,P),K4(v,o,A,A.f,A.u,E,s,A.m),o+=16+M+(A.m?A.m.length:0),s=P+E}catch(k){return d(k,null)}}NK(v,o,u.length,w,_),d(null,v)};a||p();for(var m=function(v){var _=i[v],w=n[_],b=w[0],A=w[1],E=kK(),M=b.length;E.p(b);var P=z1(_),k=P.length,D=A.comment,O=D&&z1(D),B=O&&O.length,L=F1(A.extra),R=A.level==0?0:8,T=function(N,$){if(N)h(),d(N,null);else{var V=$.length;u[v]=J3(A,{size:M,crc:E.d(),c:$,f:P,m:O,u:k!=_.length||O&&D.length!=B,compression:R}),o+=30+k+L+V,s+=76+2*(k+L)+(B||0)+V,--a||p()}};if(k>65535&&T(fi(11,0,1),null),!R)T(null,b);else if(M<16e4)try{T(null,Q3(b,A))}catch(N){T(N,null)}else c.push(cLe(b,A,T))},y=0;y<l;++y)m(y);return h}function gLe(t,e){e||(e={});var r={},n=[];BO(t,"",r,e);var i=0,a=0;for(var o in r){var s=r[o],l=s[0],u=s[1],c=u.level==0?0:8,h=z1(o),d=h.length,p=u.comment,m=p&&z1(p),y=m&&m.length,v=F1(u.extra);d>65535&&fi(11);var _=c?Q3(l,u):l,w=_.length,b=kK();b.p(l),n.push(J3(u,{size:l.length,crc:b.d(),c:_,f:h,m,u:d!=o.length||m&&p.length!=y,o:i,compression:c})),i+=30+d+v+w,a+=76+2*(d+v)+(y||0)+w}for(var A=new Rn(a+22),E=i,M=a-i,P=0;P<n.length;++P){var h=n[P];K4(A,h.o,h,h.f,h.u,h.c.length);var k=30+h.f.length+F1(h.extra);A.set(h.c,h.o+k),K4(A,i,h,h.f,h.u,h.c.length,h.o,h.m),i+=16+k+(h.m?h.m.length:0)}return NK(A,i,n.length,M,E),A}var Q4=typeof queueMicrotask=="function"?queueMicrotask:typeof setTimeout=="function"?setTimeout:function(t){t()};function yLe(t,e,r){r||(r=e,e={}),typeof r!="function"&&fi(7);var n=[],i=function(){for(var v=0;v<n.length;++v)n[v]()},a={},o=function(v,_){Q4(function(){r(v,_)})};Q4(function(){o=r});for(var s=t.length-22;Ta(t,s)!=101010256;--s)if(!s||t.length-s>65558)return o(fi(13,0,1),null),i;var l=Cl(t,s+8);if(l){var u=l,c=Ta(t,s+16),h=c==4294967295||u==65535;if(h){var d=Ta(t,s-12);h=Ta(t,d)==101075792,h&&(u=l=Ta(t,d+32),c=Ta(t,d+48))}for(var p=e&&e.filter,m=function(v){var _=LK(t,c,h),w=_[0],b=_[1],A=_[2],E=_[3],M=_[4],P=_[5],k=RK(t,P);c=M;var D=function(B,L){B?(i(),o(B,null)):(L&&(a[E]=L),--l||o(null,a))};if(!p||p({name:E,size:b,originalSize:A,compression:w}))if(!w)D(null,Ed(t,k,k+b));else if(w==8){var O=t.subarray(k,k+b);if(A<524288||b>.8*A)try{D(null,eS(O,{out:new Rn(A)}))}catch(B){D(B,null)}else n.push(hLe(O,{size:A},D))}else D(fi(14,"unknown compression type "+w,1),null);else D(null,null)},y=0;y<u;++y)m(y)}else o(null,{});return i}function vLe(t,e){for(var r={},n=t.length-22;Ta(t,n)!=101010256;--n)(!n||t.length-n>65558)&&fi(13);var i=Cl(t,n+8);if(!i)return{};var a=Ta(t,n+16),o=a==4294967295||i==65535;if(o){var s=Ta(t,n-12);o=Ta(t,s)==101075792,o&&(i=Ta(t,s+32),a=Ta(t,s+48))}for(var l=e&&e.filter,u=0;u<i;++u){var c=LK(t,a,o),h=c[0],d=c[1],p=c[2],m=c[3],y=c[4],v=c[5],_=RK(t,v);a=y,(!l||l({name:m,size:d,originalSize:p,compression:h}))&&(h?h==8?r[m]=eS(t.subarray(_,_+d),{out:new Rn(p)}):fi(14,"unknown compression type "+h):r[m]=Ed(t,_,_+d))}return r}C();var _Le=t=>{if(t!=null)return t.trim()===""?void 0:t},xLe=t=>t!=null,x2=(t,e,r=0)=>{var n;if(ue.IsNull(t))return"null";if(ue.IsUndefined(t))return"undefined";if(ue.IsString(t))return"<string>";if(ue.IsNumber(t))return"<number>";if(ue.IsBoolean(t))return"<boolean>";if(ue.IsLiteral(t))return typeof t.const=="string"?"'".concat(t.const,"'"):"".concat(t.const);if(ue.IsRef(t)){let i=e.find(a=>a.$id===t.$ref);return i==null?t.$ref:x2(i,e,r)}if(ue.IsArray(t))return"".concat(x2(t.items,e,r+1),"[]");if(ue.IsUnion(t)&&(!(t.anyOf.length>5)||t.$id==null)){let i="".concat(t.anyOf.map(a=>x2(a,e,r+1)).filter(xLe).join(" | "));return r>0?"(".concat(i,")"):i}return(n=t.$id)!=null?n:""},bLe=(t,e,r)=>{var n;let i=e.message;ue.IsUnion(e.schema)&&(i="Expected one of: ".concat(x2(e.schema,r)));let a="#/definitions/".concat(t).concat((n=_Le(e.path))!=null?n:"");return"".concat(a,": ").concat(i)},$K=(t,e,r)=>{let n=e.First();if(n!=null)return bLe(t,n,r)},Jg;(function(t){t.Archive="Archive",t.Validate="Validate",t.Encode="Encode",t.Unknown="Unknown"})(Jg||(Jg={}));var tS=class extends Error{constructor(t,e){super(e),S(this,"name"),S(this,"kind"),this.name="CompressError",this.kind=t}},wLe=t=>new tS(Jg.Archive,t.message),ALe=t=>{let e=Object.values(CK);return t instanceof Error&&"code"in t&&typeof t.code=="number"&&e.includes(t.code)},SLe=(t,e,r)=>{var n;return new tS(Jg.Validate,(n=$K(t,e,r))!=null?n:"Unknown validate error")},ELe=t=>new tS(Jg.Encode,t.message),ILe=t=>new tS(Jg.Unknown,t instanceof Error?t.message:String(t)),fb=(t,e,r)=>e instanceof TO?ELe(e):e instanceof z0?SLe(t,e,r):ALe(e)?wLe(e):ILe(e);C();var Kg;(function(t){t.Unarchive="Unarchive",t.Validate="Validate",t.Decode="Decode",t.Unknown="Unknown"})(Kg||(Kg={}));var rS=class extends Error{constructor(t,e){super(e),S(this,"name"),S(this,"kind"),this.name="DecompressError",this.kind=t}},CLe=t=>new rS(Kg.Unarchive,t.message),MLe=t=>{let e=Object.values(CK);return t instanceof Error&&"code"in t&&typeof t.code=="number"&&e.includes(t.code)},TLe=(t,e,r)=>{var n;return new rS(Kg.Validate,(n=$K(t,e,r))!=null?n:"Unknown validate error")},PLe=t=>new rS(Kg.Decode,t.message),DLe=t=>new rS(Kg.Unknown,t instanceof Error?t.message:String(t)),mb=(t,e,r)=>e instanceof CO?PLe(e):e instanceof z0?TLe(t,e,r):MLe(e)?CLe(e):DLe(e),UK=function*(t,e=""){if(t!=null){if(Array.isArray(t)){for(let r=0;r<t.length;r++)yield[e+"[".concat(r,"]"),t[r]];return}if("features"in t){for(let r=0;r<t.features.length;r++)yield[e===""?"features[".concat(r,"]"):"".concat(e,".features[").concat(r,"]"),t.features[r]];return}for(let[r,n]of Object.entries(t)){let i=e===""?r:"".concat(e,".").concat(r);yield*ut(UK(n,i))}}},kLe=(t,e)=>t===""?e:e.startsWith("[")?"".concat(t).concat(e):"".concat(t,".").concat(e),ms=(t,e,r)=>{let n=new Set;for(let[i,a]of UK(t)){let o=e(a);if(n.has(o))return hr({kind:Wc.DuplicateIdError,properties:{id:o,path:kLe(r,i)}});n.add(o)}return pr(!0)},OLe=t=>t.floors==null?hr({kind:Wc.FloorMissingError,properties:null}):ms(t.floors.features,e=>e.properties.id,"floors"),jK=U.Intersect([U.Object({id:U.Ref(la),elevation:U.Integer({description:"An ordinal representing the elevation of this map relative to other maps in the stack."}),subtitle:U.Optional(U.String({description:"The subtitle of the floor."})),maxHeight:U.Optional(U.Number({description:"The maximum height of the floor in meters. This includes the thickness of the floor itself, up to the tallest point on any wall. If the floor does not have a consistent height (eg, one room on the floor has a vaulted ceiling, the rest do not), this value represents the highest point anywhere on the floor. Must be a positive number, or undefined.",minimum:0}))}),k0],{$id:"FloorProperties"}),VK=Kc(U.Union([U.Ref(EO),U.Ref(IO),U.Null()]),U.Ref(jK),{$id:"FloorFeature"}),GK=sf(U.Ref(VK),{$id:"FloorCollection"}),BLe=U.Object({floors:U.Ref(GK)}),zLe={name:"core:floors",intoBundle:function*(t){t.floors!=null&&(yield{path:"floors.geojson",contents:t.floors})},fromBundle:(t,e,r)=>{if(t==="floors.geojson")return{floors:r(e)}},integrityCheck:OLe,schema:BLe,references:[jK,VK,GK]};C();C();var Wo=t=>U.Unsafe(t);C();var Xi=t=>Object.keys(t);C();C();var FLe=t=>{var e,r;return new Map((r=(e=t.floors)==null?void 0:e.features.map(n=>[n.properties.id,n]))!=null?r:[])},B_=t=>{let e=FLe(t);return r=>{let n=e.get(r);return n==null?hr({kind:Wc.UnknownFloorError,properties:{floorId:r}}):pr(n)}},RLe=t=>{if(t.floors==null)return hr({kind:Wc.FloorMissingError,properties:null});if(t.geometry==null)return hr({kind:Wc.GeometryMissingError,properties:null});let e=ms(t.geometry,n=>n.properties.id,"geometry");if(e.isErr())return e;let r=B_(t);for(let n of Xi(t.geometry)){let i=r(n);if(i.isErr())return i}return pr(!0)},ZK=U.Intersect([U.Object({id:U.Ref(Qc)}),k0],{$id:"GeometryProperties"}),WK=Kc(U.Union([U.Ref(Jc),U.Ref($J),U.Ref(UJ),U.Ref(jJ),U.Ref(EO),U.Ref(IO)]),U.Ref(ZK),{$id:"GeometryFeature"}),HK=sf(U.Ref(WK),{$id:"GeometryCollection"}),LLe=U.Object({geometry:Wo(U.Record(la,U.Ref(HK),{additionalProperties:!1}))},{$id:"GeometrySchema"}),NLe=/^geometry\/(.*)\.geojson$/,$Le={name:"core:geometry",schema:LLe,intoBundle:function*(t){if(t.geometry!=null)for(let e of Xi(t.geometry))yield{path:"geometry/".concat(e,".geojson"),contents:t.geometry[e]}},fromBundle:(t,e,r)=>{var n;let i=(n=t.match(NLe))==null?void 0:n[1];if(i)return{geometry:{[i]:r(e)}}},references:[ZK,WK,HK],integrityCheck:RLe};C();var zO=U.Object({type:U.Literal("file"),name:U.String({description:"The name of the file."})},{$id:"ManifestFile"}),XK=U.Recursive(t=>U.Object({type:U.Literal("folder"),name:U.String({description:"The name of the folder."}),children:U.Array(U.Union([t,U.Ref(zO)]),{minItems:1,description:"The children of the folder."})}),{$id:"ManifestFolder"}),qK=U.Object({name:U.String({description:"The name of the map."}),version:U.Literal("3.0.0",{description:"The version of the manifest."}),orgId:U.Optional(U.String({description:"The identifier of the organization that the map this MVF is for belongs to."})),mapId:U.Optional(U.String({description:"The identifier of the map that this MVF is for."})),contents:U.Array(U.Union([U.Ref(XK),U.Ref(zO)]),{minItems:1,description:"The contents of the MVF bundle."}),time:U.String({format:"date-time",description:"An ISO 8601 date-time string, including timezone offset."}),tzid:U.Optional(U.Unsafe(U.String({description:"A valid IANA timezone identifier.",pattern:"^[A-Za-z0-9_-]+/[A-Za-z0-9_-]+$"}))),naturalBearing:U.Optional(U.Number({minimum:0,maximum:360,description:'The angle, in degrees, the map is considered to be "naturally oriented" as, rather than facing directly north. 90 degrees means East is "up"'})),defaultFloor:U.Optional(U.Ref(la,{description:"The default floor ID of the map."})),language:U.Optional(U.String({description:"The language code of the map."}))},{$id:"ManifestProperties"}),YK=sf(Kc(Jc,U.Ref(qK)),{$id:"ManifestCollection"},{minItems:1,maxItems:1}),ULe=U.Object({manifest:U.Ref(YK)}),jLe={name:"core:manifest",intoBundle:function*(t){t.manifest!=null&&(yield{path:"manifest.geojson",contents:t.manifest})},fromBundle:(t,e,r)=>{if(t==="manifest.geojson")return{manifest:r(e)}},schema:ULe,references:[zO,XK,qK,YK]};C();C();C();C();var VLe=class extends Un{constructor(t){super("Unable to dereference schema with $id '".concat(t.$ref,"'")),S(this,"schema"),this.schema=t}};function GLe(t,e){let r=e.find(n=>n.$id===t.$ref);if(r===void 0)throw new VLe(t);return z_(r,e)}function JK(t,e){return!ni.IsString(t.$id)||e.some(r=>r.$id===t.$id)||e.push(t),e}function z_(t,e){return t[xt]==="This"||t[xt]==="Ref"?GLe(t,e):t}C();function ZLe(t,e,r){let n=t.get(e);if(n!==void 0)return n;let i=T_(e,r);return t.set(e,i),i}function KK(){let t=new WeakMap;return{HasTransform:(e,r)=>ZLe(t,e,r)}}function _i(t,e,r){try{return ue.IsTransform(t)?t[Uo].Decode(r):r}catch(n){throw new CO(t,e,r,n)}}function WLe(t,e,r,n,i){return ni.IsArray(n)?_i(t,r,n.map((a,o)=>Zu(t.items,e,"".concat(r,"/").concat(o),a,i))):_i(t,r,n)}function HLe(t,e,r,n,i){if(!ni.IsObject(n)||Yc(n))return _i(t,r,n);let a=G3(t),o=a.map(h=>h[0]),s=ae({},n);for(let[h,d]of a)h in s&&(s[h]=Zu(d,e,"".concat(r,"/").concat(h),s[h],i));if(!ue.IsTransform(t.unevaluatedProperties))return _i(t,r,s);let l=Object.getOwnPropertyNames(s),u=t.unevaluatedProperties,c=ae({},s);for(let h of l)o.includes(h)||(c[h]=_i(u,"".concat(r,"/").concat(h),c[h]));return _i(t,r,c)}function XLe(t,e,r,n,i){return _i(t,r,Zu(t.not,e,r,n,i))}function qLe(t,e,r,n,i){if(!ni.IsObject(n))return _i(t,r,n);let a=ju(t),o=ae({},n);for(let c of a)ni.HasPropertyKey(o,c)&&(ni.IsUndefined(o[c])&&(!ue.IsUndefined(t.properties[c])||Bi.IsExactOptionalProperty(o,c))||(o[c]=Zu(t.properties[c],e,"".concat(r,"/").concat(c),o[c],i)));if(!ue.IsSchema(t.additionalProperties))return _i(t,r,o);let s=Object.getOwnPropertyNames(o),l=t.additionalProperties,u=ae({},o);for(let c of s)a.includes(c)||(u[c]=_i(l,"".concat(r,"/").concat(c),u[c]));return _i(t,r,u)}function YLe(t,e,r,n,i){if(!ni.IsObject(n))return _i(t,r,n);let a=Object.getOwnPropertyNames(t.patternProperties)[0],o=new RegExp(a),s=ae({},n);for(let h of Object.getOwnPropertyNames(n))o.test(h)&&(s[h]=Zu(t.patternProperties[a],e,"".concat(r,"/").concat(h),s[h],i));if(!ue.IsSchema(t.additionalProperties))return _i(t,r,s);let l=Object.getOwnPropertyNames(s),u=t.additionalProperties,c=ae({},s);for(let h of l)o.test(h)||(c[h]=_i(u,"".concat(r,"/").concat(h),c[h]));return _i(t,r,c)}function JLe(t,e,r,n,i){let a=z_(t,e);return _i(t,r,Zu(a,e,r,n,i))}function KLe(t,e,r,n,i){let a=z_(t,e);return _i(t,r,Zu(a,e,r,n,i))}function QLe(t,e,r,n,i){return ni.IsArray(n)&&ni.IsArray(t.items)?_i(t,r,t.items.map((a,o)=>Zu(a,e,"".concat(r,"/").concat(o),n[o],i))):_i(t,r,n)}function e9e(t,e,r,n,i){for(let a of t.anyOf){if(!qg.Check(a,e,n))continue;let o=Zu(a,e,r,n,i);return _i(t,r,o)}return _i(t,r,n)}function Zu(t,e,r,n,i){if(!i.HasTransform(t,e))return n;let a=JK(t,e),o=t;switch(t[xt]){case"Array":return WLe(o,a,r,n,i);case"Intersect":return HLe(o,a,r,n,i);case"Not":return XLe(o,a,r,n,i);case"Object":return qLe(o,a,r,n,i);case"Record":return YLe(o,a,r,n,i);case"Ref":return JLe(o,a,r,n,i);case"Symbol":return _i(o,r,n);case"This":return KLe(o,a,r,n,i);case"Tuple":return QLe(o,a,r,n,i);case"Union":return e9e(o,a,r,n,i);default:return _i(o,r,n)}}function t9e(t,e,r){let n=KK();return Zu(t,e,"",r,n)}C();function Ya(t,e,r){try{return ue.IsTransform(t)?t[Uo].Encode(r):r}catch(n){throw new TO(t,e,r,n)}}function r9e(t,e,r,n,i){let a=Ya(t,r,n);return ni.IsArray(a)?a.map((o,s)=>Ou(t.items,e,"".concat(r,"/").concat(s),o,i)):a}function n9e(t,e,r,n,i){let a=Ya(t,r,n);if(!ni.IsObject(n)||Yc(n))return a;let o=G3(t),s=o.map(d=>d[0]),l=ae({},a);for(let[d,p]of o)d in l&&(l[d]=Ou(p,e,"".concat(r,"/").concat(d),l[d],i));if(!ue.IsTransform(t.unevaluatedProperties))return l;let u=Object.getOwnPropertyNames(l),c=t.unevaluatedProperties,h=ae({},l);for(let d of u)s.includes(d)||(h[d]=Ya(c,"".concat(r,"/").concat(d),h[d]));return h}function i9e(t,e,r,n){return Ya(t.not,r,Ya(t,r,n))}function a9e(t,e,r,n,i){let a=Ya(t,r,n);if(!ni.IsObject(a))return a;let o=ju(t),s=ae({},a);for(let h of o)ni.HasPropertyKey(s,h)&&(ni.IsUndefined(s[h])&&(!ue.IsUndefined(t.properties[h])||Bi.IsExactOptionalProperty(s,h))||(s[h]=Ou(t.properties[h],e,"".concat(r,"/").concat(h),s[h],i)));if(!ue.IsSchema(t.additionalProperties))return s;let l=Object.getOwnPropertyNames(s),u=t.additionalProperties,c=ae({},s);for(let h of l)o.includes(h)||(c[h]=Ya(u,"".concat(r,"/").concat(h),c[h]));return c}function o9e(t,e,r,n,i){let a=Ya(t,r,n);if(!ni.IsObject(n))return a;let o=Object.getOwnPropertyNames(t.patternProperties)[0],s=new RegExp(o),l=ae({},a);for(let d of Object.getOwnPropertyNames(n))s.test(d)&&(l[d]=Ou(t.patternProperties[o],e,"".concat(r,"/").concat(d),l[d],i));if(!ue.IsSchema(t.additionalProperties))return l;let u=Object.getOwnPropertyNames(l),c=t.additionalProperties,h=ae({},l);for(let d of u)s.test(d)||(h[d]=Ya(c,"".concat(r,"/").concat(d),h[d]));return h}function s9e(t,e,r,n,i){let a=z_(t,e),o=Ou(a,e,r,n,i);return Ya(t,r,o)}function l9e(t,e,r,n,i){let a=z_(t,e),o=Ou(a,e,r,n,i);return Ya(t,r,o)}function u9e(t,e,r,n,i){let a=Ya(t,r,n);return ni.IsArray(t.items)?t.items.map((o,s)=>Ou(o,e,"".concat(r,"/").concat(s),a[s],i)):[]}function c9e(t,e,r,n,i){for(let a of t.anyOf){if(!qg.Check(a,e,n))continue;let o=Ou(a,e,r,n,i);return Ya(t,r,o)}for(let a of t.anyOf){let o=Ou(a,e,r,n,i);if(qg.Check(t,e,o))return Ya(t,r,o)}return Ya(t,r,n)}function Ou(t,e,r,n,i){if(!i.HasTransform(t,e))return n;let a=JK(t,e),o=t;switch(t[xt]){case"Array":return r9e(o,a,r,n,i);case"Intersect":return n9e(o,a,r,n,i);case"Not":return i9e(o,a,r,n);case"Object":return a9e(o,a,r,n,i);case"Record":return o9e(o,a,r,n,i);case"Ref":return s9e(o,a,r,n,i);case"This":return l9e(o,a,r,n,i);case"Tuple":return u9e(o,a,r,n,i);case"Union":return c9e(o,a,r,n,i);default:return Ya(o,r,n)}}function h9e(t,e,r){let n=KK();return Ou(t,e,"",r,n)}C();var d9e=class{constructor(t,e,r,n){this.schema=t,this.references=e,this.checkFunc=r,this.code=n,this.hasTransform=T_(t,e)}Code(){return this.code}Errors(t){return I_(this.schema,this.references,t)}Check(t){return this.checkFunc(t)}Decode(t){if(!this.checkFunc(t))throw new cK(this.schema,t,this.Errors(t).First());return this.hasTransform?MO(this.schema,this.references,t):t}Encode(t){let e=this.hasTransform?dK(this.schema,this.references,t):t;if(!this.checkFunc(e))throw new hK(this.schema,t,this.Errors(t).First());return e}},Cc;(function(t){function e(a){return a===36}t.DollarSign=e;function r(a){return a===95}t.IsUnderscore=r;function n(a){return a>=65&&a<=90||a>=97&&a<=122}t.IsAlpha=n;function i(a){return a>=48&&a<=57}t.IsNumeric=i})(Cc||(Cc={}));var eA;(function(t){function e(a){return a.length===0?!1:Cc.IsNumeric(a.charCodeAt(0))}function r(a){if(e(a))return!1;for(let o=0;o<a.length;o++){let s=a.charCodeAt(o);if(!(Cc.IsAlpha(s)||Cc.IsNumeric(s)||Cc.DollarSign(s)||Cc.IsUnderscore(s)))return!1}return!0}function n(a){return a.replace(/'/g,"\\'")}function i(a,o){return r(o)?"".concat(a,".").concat(o):"".concat(a,"['").concat(n(o),"']")}t.Encode=i})(eA||(eA={}));var mT;(function(t){function e(r){let n=[];for(let i=0;i<r.length;i++){let a=r.charCodeAt(i);Cc.IsNumeric(a)||Cc.IsAlpha(a)?n.push(r.charAt(i)):n.push("_".concat(a,"_"))}return n.join("").replace(/__/g,"_")}t.Encode=e})(mT||(mT={}));var gT;(function(t){function e(r){return r.replace(/'/g,"\\'")}t.Escape=e})(gT||(gT={}));var p9e=class extends Un{constructor(t){super("Unknown type"),this.schema=t}},gR=class extends Un{constructor(t){super("Preflight validation check failed to guard for the given schema"),this.schema=t}},sp;(function(t){function e(o,s,l){return Bi.ExactOptionalPropertyTypes?"('".concat(s,"' in ").concat(o," ? ").concat(l," : true)"):"(".concat(eA.Encode(o,s)," !== undefined ? ").concat(l," : true)")}t.IsExactOptionalProperty=e;function r(o){return Bi.AllowArrayObject?"(typeof ".concat(o," === 'object' && ").concat(o," !== null)"):"(typeof ".concat(o," === 'object' && ").concat(o," !== null && !Array.isArray(").concat(o,"))")}t.IsObjectLike=r;function n(o){return Bi.AllowArrayObject?"(typeof ".concat(o," === 'object' && ").concat(o," !== null && !(").concat(o," instanceof Date) && !(").concat(o," instanceof Uint8Array))"):"(typeof ".concat(o," === 'object' && ").concat(o," !== null && !Array.isArray(").concat(o,") && !(").concat(o," instanceof Date) && !(").concat(o," instanceof Uint8Array))")}t.IsRecordLike=n;function i(o){return Bi.AllowNaN?"typeof ".concat(o," === 'number'"):"Number.isFinite(".concat(o,")")}t.IsNumberLike=i;function a(o){return Bi.AllowNullVoid?"(".concat(o," === undefined || ").concat(o," === null)"):"".concat(o," === undefined")}t.IsVoidLike=a})(sp||(sp={}));var yT;(function(t){function e(Y){return Y[xt]==="Any"||Y[xt]==="Unknown"}function*r(Y,we,q){yield"true"}function*n(Y,we,q){yield"Array.isArray(".concat(q,")");let[oe,ce]=[le("value","any"),le("acc","number")];cr(Y.maxItems)&&(yield"".concat(q,".length <= ").concat(Y.maxItems)),cr(Y.minItems)&&(yield"".concat(q,".length >= ").concat(Y.minItems));let X=ie(Y.items,we,"value");if(yield"".concat(q,".every((").concat(oe,") => ").concat(X,")"),xn(Y.contains)||cr(Y.minContains)||cr(Y.maxContains)){let ke=xn(Y.contains)?Y.contains:to(),Ce=ie(ke,we,"value"),Ee=cr(Y.minContains)?["(count >= ".concat(Y.minContains,")")]:[],Ne=cr(Y.maxContains)?["(count <= ".concat(Y.maxContains,")")]:[],st="const count = value.reduce((".concat(ce,", ").concat(oe,") => ").concat(Ce," ? acc + 1 : acc, 0)"),Ke=["(count > 0)",...Ee,...Ne].join(" && ");yield"((".concat(oe,") => { ").concat(st,"; return ").concat(Ke,"})(").concat(q,")")}if(Y.uniqueItems===!0){let ke="const set = new Set(); for(const element of value) { ".concat("const hashed = hash(element); if(set.has(hashed)) { return false } else { set.add(hashed) } } return true"," }");yield"((".concat(oe,") => { ").concat(ke," )(").concat(q,")")}}function*i(Y,we,q){yield"(typeof value === 'object' && Symbol.asyncIterator in ".concat(q,")")}function*a(Y,we,q){yield"(typeof ".concat(q," === 'bigint')"),js(Y.exclusiveMaximum)&&(yield"".concat(q," < BigInt(").concat(Y.exclusiveMaximum,")")),js(Y.exclusiveMinimum)&&(yield"".concat(q," > BigInt(").concat(Y.exclusiveMinimum,")")),js(Y.maximum)&&(yield"".concat(q," <= BigInt(").concat(Y.maximum,")")),js(Y.minimum)&&(yield"".concat(q," >= BigInt(").concat(Y.minimum,")")),js(Y.multipleOf)&&(yield"(".concat(q," % BigInt(").concat(Y.multipleOf,")) === 0"))}function*o(Y,we,q){yield"(typeof ".concat(q," === 'boolean')")}function*s(Y,we,q){yield*ut(G(Y.returns,we,"".concat(q,".prototype")))}function*l(Y,we,q){yield"(".concat(q," instanceof Date) && Number.isFinite(").concat(q,".getTime())"),cr(Y.exclusiveMaximumTimestamp)&&(yield"".concat(q,".getTime() < ").concat(Y.exclusiveMaximumTimestamp)),cr(Y.exclusiveMinimumTimestamp)&&(yield"".concat(q,".getTime() > ").concat(Y.exclusiveMinimumTimestamp)),cr(Y.maximumTimestamp)&&(yield"".concat(q,".getTime() <= ").concat(Y.maximumTimestamp)),cr(Y.minimumTimestamp)&&(yield"".concat(q,".getTime() >= ").concat(Y.minimumTimestamp)),cr(Y.multipleOfTimestamp)&&(yield"(".concat(q,".getTime() % ").concat(Y.multipleOfTimestamp,") === 0"))}function*u(Y,we,q){yield"(typeof ".concat(q," === 'function')")}function*c(Y,we,q){yield"Number.isInteger(".concat(q,")"),cr(Y.exclusiveMaximum)&&(yield"".concat(q," < ").concat(Y.exclusiveMaximum)),cr(Y.exclusiveMinimum)&&(yield"".concat(q," > ").concat(Y.exclusiveMinimum)),cr(Y.maximum)&&(yield"".concat(q," <= ").concat(Y.maximum)),cr(Y.minimum)&&(yield"".concat(q," >= ").concat(Y.minimum)),cr(Y.multipleOf)&&(yield"(".concat(q," % ").concat(Y.multipleOf,") === 0"))}function*h(Y,we,q){let oe=Y.allOf.map(ce=>ie(ce,we,q)).join(" && ");if(Y.unevaluatedProperties===!1){let ce=Me("".concat(new RegExp(Hg(Y)),";")),X="Object.getOwnPropertyNames(".concat(q,").every(key => ").concat(ce,".test(key))");yield"(".concat(oe," && ").concat(X,")")}else if(xn(Y.unevaluatedProperties)){let ce=Me("".concat(new RegExp(Hg(Y)),";")),X="Object.getOwnPropertyNames(".concat(q,").every(key => ").concat(ce,".test(key) || ").concat(ie(Y.unevaluatedProperties,we,"".concat(q,"[key]")),")");yield"(".concat(oe," && ").concat(X,")")}else yield"(".concat(oe,")")}function*d(Y,we,q){yield"(typeof value === 'object' && Symbol.iterator in ".concat(q,")")}function*p(Y,we,q){typeof Y.const=="number"||typeof Y.const=="boolean"?yield"(".concat(q," === ").concat(Y.const,")"):yield"(".concat(q," === '").concat(gT.Escape(Y.const),"')")}function*m(Y,we,q){yield"false"}function*y(Y,we,q){let oe=ie(Y.not,we,q);yield"(!".concat(oe,")")}function*v(Y,we,q){yield"(".concat(q," === null)")}function*_(Y,we,q){yield sp.IsNumberLike(q),cr(Y.exclusiveMaximum)&&(yield"".concat(q," < ").concat(Y.exclusiveMaximum)),cr(Y.exclusiveMinimum)&&(yield"".concat(q," > ").concat(Y.exclusiveMinimum)),cr(Y.maximum)&&(yield"".concat(q," <= ").concat(Y.maximum)),cr(Y.minimum)&&(yield"".concat(q," >= ").concat(Y.minimum)),cr(Y.multipleOf)&&(yield"(".concat(q," % ").concat(Y.multipleOf,") === 0"))}function*w(Y,we,q){yield sp.IsObjectLike(q),cr(Y.minProperties)&&(yield"Object.getOwnPropertyNames(".concat(q,").length >= ").concat(Y.minProperties)),cr(Y.maxProperties)&&(yield"Object.getOwnPropertyNames(".concat(q,").length <= ").concat(Y.maxProperties));let oe=Object.getOwnPropertyNames(Y.properties);for(let ce of oe){let X=eA.Encode(q,ce),ke=Y.properties[ce];if(Y.required&&Y.required.includes(ce))yield*ut(G(ke,we,X)),(P0(ke)||e(ke))&&(yield"('".concat(ce,"' in ").concat(q,")"));else{let Ce=ie(ke,we,X);yield sp.IsExactOptionalProperty(q,ce,Ce)}}if(Y.additionalProperties===!1)if(Y.required&&Y.required.length===oe.length)yield"Object.getOwnPropertyNames(".concat(q,").length === ").concat(oe.length);else{let ce="[".concat(oe.map(X=>"'".concat(X,"'")).join(", "),"]");yield"Object.getOwnPropertyNames(".concat(q,").every(key => ").concat(ce,".includes(key))")}if(typeof Y.additionalProperties=="object"){let ce=ie(Y.additionalProperties,we,"".concat(q,"[key]")),X="[".concat(oe.map(ke=>"'".concat(ke,"'")).join(", "),"]");yield"(Object.getOwnPropertyNames(".concat(q,").every(key => ").concat(X,".includes(key) || ").concat(ce,"))")}}function*b(Y,we,q){yield"(typeof value === 'object' && typeof ".concat(q,".then === 'function')")}function*A(Y,we,q){yield sp.IsRecordLike(q),cr(Y.minProperties)&&(yield"Object.getOwnPropertyNames(".concat(q,").length >= ").concat(Y.minProperties)),cr(Y.maxProperties)&&(yield"Object.getOwnPropertyNames(".concat(q,").length <= ").concat(Y.maxProperties));let[oe,ce]=Object.entries(Y.patternProperties)[0],X=Me("".concat(new RegExp(oe))),ke=ie(ce,we,"value"),Ce=xn(Y.additionalProperties)?ie(Y.additionalProperties,we,q):Y.additionalProperties===!1?"false":"true",Ee="(".concat(X,".test(key) ? ").concat(ke," : ").concat(Ce,")");yield"(Object.entries(".concat(q,").every(([key, value]) => ").concat(Ee,"))")}function*E(Y,we,q){let oe=Ei(Y,we);if(ee.functions.has(Y.$ref))return yield"".concat(me(Y.$ref),"(").concat(q,")");yield*ut(G(oe,we,q))}function*M(Y,we,q){let oe=Me("".concat(new RegExp(Y.source,Y.flags),";"));yield"(typeof ".concat(q," === 'string')"),cr(Y.maxLength)&&(yield"".concat(q,".length <= ").concat(Y.maxLength)),cr(Y.minLength)&&(yield"".concat(q,".length >= ").concat(Y.minLength)),yield"".concat(oe,".test(").concat(q,")")}function*P(Y,we,q){if(yield"(typeof ".concat(q," === 'string')"),cr(Y.maxLength)&&(yield"".concat(q,".length <= ").concat(Y.maxLength)),cr(Y.minLength)&&(yield"".concat(q,".length >= ").concat(Y.minLength)),Y.pattern!==void 0){let oe=Me("".concat(new RegExp(Y.pattern),";"));yield"".concat(oe,".test(").concat(q,")")}Y.format!==void 0&&(yield"format('".concat(Y.format,"', ").concat(q,")"))}function*k(Y,we,q){yield"(typeof ".concat(q," === 'symbol')")}function*D(Y,we,q){yield"(typeof ".concat(q," === 'string')");let oe=Me("".concat(new RegExp(Y.pattern),";"));yield"".concat(oe,".test(").concat(q,")")}function*O(Y,we,q){yield"".concat(me(Y.$ref),"(").concat(q,")")}function*B(Y,we,q){if(yield"Array.isArray(".concat(q,")"),Y.items===void 0)return yield"".concat(q,".length === 0");yield"(".concat(q,".length === ").concat(Y.maxItems,")");for(let oe=0;oe<Y.items.length;oe++){let ce=ie(Y.items[oe],we,"".concat(q,"[").concat(oe,"]"));yield"".concat(ce)}}function*L(Y,we,q){yield"".concat(q," === undefined")}function*R(Y,we,q){let oe=Y.anyOf.map(ce=>ie(ce,we,q));yield"(".concat(oe.join(" || "),")")}function*T(Y,we,q){yield"".concat(q," instanceof Uint8Array"),cr(Y.maxByteLength)&&(yield"(".concat(q,".length <= ").concat(Y.maxByteLength,")")),cr(Y.minByteLength)&&(yield"(".concat(q,".length >= ").concat(Y.minByteLength,")"))}function*N(Y,we,q){yield"true"}function*$(Y,we,q){yield sp.IsVoidLike(q)}function*V(Y,we,q){let oe=ee.instances.size;ee.instances.set(oe,Y),yield"kind('".concat(Y[xt],"', ").concat(oe,", ").concat(q,")")}function*G(Y,we,q,oe=!0){let ce=Ln(Y.$id)?[...we,Y]:we,X=Y;if(oe&&Ln(Y.$id)){let ke=me(Y.$id);if(ee.functions.has(ke))return yield"".concat(ke,"(").concat(q,")");{let Ce=Ae(ke,Y,we,"value",!1);return ee.functions.set(ke,Ce),yield"".concat(ke,"(").concat(q,")")}}switch(X[xt]){case"Any":return yield*ut(r());case"Array":return yield*ut(n(X,ce,q));case"AsyncIterator":return yield*ut(i(X,ce,q));case"BigInt":return yield*ut(a(X,ce,q));case"Boolean":return yield*ut(o(X,ce,q));case"Constructor":return yield*ut(s(X,ce,q));case"Date":return yield*ut(l(X,ce,q));case"Function":return yield*ut(u(X,ce,q));case"Integer":return yield*ut(c(X,ce,q));case"Intersect":return yield*ut(h(X,ce,q));case"Iterator":return yield*ut(d(X,ce,q));case"Literal":return yield*ut(p(X,ce,q));case"Never":return yield*ut(m());case"Not":return yield*ut(y(X,ce,q));case"Null":return yield*ut(v(X,ce,q));case"Number":return yield*ut(_(X,ce,q));case"Object":return yield*ut(w(X,ce,q));case"Promise":return yield*ut(b(X,ce,q));case"Record":return yield*ut(A(X,ce,q));case"Ref":return yield*ut(E(X,ce,q));case"RegExp":return yield*ut(M(X,ce,q));case"String":return yield*ut(P(X,ce,q));case"Symbol":return yield*ut(k(X,ce,q));case"TemplateLiteral":return yield*ut(D(X,ce,q));case"This":return yield*ut(O(X,ce,q));case"Tuple":return yield*ut(B(X,ce,q));case"Undefined":return yield*ut(L(X,ce,q));case"Union":return yield*ut(R(X,ce,q));case"Uint8Array":return yield*ut(T(X,ce,q));case"Unknown":return yield*ut(N());case"Void":return yield*ut($(X,ce,q));default:if(!Ws.Has(X[xt]))throw new p9e(Y);return yield*ut(V(X,ce,q))}}let ee={language:"javascript",functions:new Map,variables:new Map,instances:new Map};function ie(Y,we,q,oe=!0){return"(".concat([...G(Y,we,q,oe)].join(" && "),")")}function me(Y){return"check_".concat(mT.Encode(Y))}function Me(Y){let we="local_".concat(ee.variables.size);return ee.variables.set(we,"const ".concat(we," = ").concat(Y)),we}function Ae(Y,we,q,oe,ce=!0){let[X,ke]=[`
`,st=>"".padStart(st," ")],Ce=le("value","any"),Ee=_e("boolean"),Ne=[...G(we,q,oe,ce)].map(st=>"".concat(ke(4)).concat(st)).join(" &&".concat(X));return"function ".concat(Y,"(").concat(Ce,")").concat(Ee," {").concat(X).concat(ke(2),"return (").concat(X).concat(Ne).concat(X).concat(ke(2),`)
}`)}function le(Y,we){let q=ee.language==="typescript"?": ".concat(we):"";return"".concat(Y).concat(q)}function _e(Y){return ee.language==="typescript"?": ".concat(Y):""}function Le(Y,we,q){let oe=Ae("check",Y,we,"value"),ce=le("value","any"),X=_e("boolean"),ke=[...ee.functions.values()],Ce=[...ee.variables.values()],Ee=Ln(Y.$id)?"return function check(".concat(ce,")").concat(X,` {
  return `).concat(me(Y.$id),`(value)
}`):"return ".concat(oe);return[...Ce,...ke,Ee].join(`
`)}function Se(...Y){let we={language:"javascript"},[q,oe,ce]=Y.length===2&&mn(Y[1])?[Y[0],Y[1],we]:Y.length===2&&!mn(Y[1])?[Y[0],[],Y[1]]:Y.length===3?[Y[0],Y[1],Y[2]]:Y.length===1?[Y[0],[],we]:[null,[],we];if(ee.language=ce.language,ee.variables.clear(),ee.functions.clear(),ee.instances.clear(),!xn(q))throw new gR(q);for(let X of oe)if(!xn(X))throw new gR(X);return Le(q,oe)}t.Code=Se;function Ue(Y,we=[]){let q=Se(Y,we,{language:"javascript"}),oe=globalThis.Function("kind","format","hash",q),ce=new Map(ee.instances);function X(Ne,st,Ke){if(!Ws.Has(Ne)||!ce.has(st))return!1;let J=Ws.Get(Ne),Z=ce.get(st);return J(Z,Ke)}function ke(Ne,st){return Zc.Has(Ne)?Zc.Get(Ne)(st):!1}function Ce(Ne){return H3(Ne)}let Ee=oe(X,ke,Ce);return new d9e(Y,we,Ee,q)}t.Compile=Ue})(yT||(yT={}));C();C();C();var f9e=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,m9e=[0,31,28,31,30,31,30,31,31,30,31,30,31],g9e=t=>t%4===0&&(t%100!==0||t%400===0),QK=t=>{let e=f9e.exec(t);if(!e)return!1;let r=+e[1],n=+e[2],i=+e[3];return n>=1&&n<=12&&i>=1&&i<=(n===2&&g9e(r)?29:m9e[n])};C();var y9e=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i,eQ=t=>{let e=y9e.exec(t);if(!e)return!1;let r=+e[1],n=+e[2],i=+e[3],a=e[4],o=e[5]==="-"?-1:1,s=+(e[6]||0),l=+(e[7]||0);if(s>23||l>59||!a)return!1;if(r<=23&&n<=59&&i<60)return!0;let u=n-l*o,c=r-s*o-(u<0?1:0);return(c===23||c===-1)&&(u===59||u===-1)&&i<61},v9e=/t|\s/i,_9e=t=>{let e=t.split(v9e);return e.length===2&&QK(e[0])&&eQ(e[1])};C();var x9e=/\/|:/,b9e=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,w9e=t=>x9e.test(t)&&b9e.test(t),A9e=[["date",QK],["time",eQ],["date-time",_9e],["uri",w9e]],S9e=()=>{for(let[t,e]of A9e)try{sT.Format(t,e)}catch(r){if(r instanceof qJ)continue;throw r}};C();var tQ=U.Record(U.String(),U.Unknown(),{$id:"Extra"}),F_=U.Object({extra:U.Optional(U.Ref(tQ))}),E9e=[tQ];C();C();C();C();C();C();var aa=t=>Object.entries(t),I9e=t=>{var e;let r=new Map;for(let[n,i]of aa((e=t.geometry)!=null?e:{}))r.set(n,new Map(i?.features.map(a=>[a.properties.id,a])));return r},th=t=>{let e=I9e(t);return(r,n)=>{let i=e.get(r);if(i==null)return hr({kind:Wc.UnknownFloorError,properties:{floorId:r}});let a=i.get(n);return a==null?hr({kind:Wc.UnknownGeometryError,properties:{floorId:r,geometryId:n}}):pr(a)}};C();var L0=U.Object({geometryId:U.Ref(Qc)},{$id:"WithGeometryId"}),FO=U.Object({geometryIds:U.Array(U.Ref(Qc))},{$id:"WithGeometryIds"}),C9e=[L0,FO];C();C();C();var M9e=t=>t instanceof Error?t:new Error(String(t)),nS=t=>(...e)=>{try{return pr(t(...e))}catch(r){return hr(M9e(r))}},rQ=nS((t,e)=>{let r={};for(let n of e)for(let i of n.intoBundle(t))r[i.path]=z1(JSON.stringify(i.contents));return r}),yR=async(t,e,r)=>rQ(t,e).andThenAsync(n=>new Promise(i=>{mLe(n,lt(ae({},r),{consume:!0}),(a,o)=>{i(a?hr(a):pr(o))})})),T9e=nS(gLe),vR=(t,e,r)=>rQ(t,e).andThen(n=>T9e(n,r));C();C();function vT(t,e,r=[]){let n=ae({},t);for(let[i,a]of Object.entries(e))if(a!==void 0)if(i in n){let o=i;if(Array.isArray(a)&&a.length>0){let s=P9e(a[0],r);if(s){let l=n[o];if(!Array.isArray(l))throw new Error("Expected array at ".concat(i,", got ").concat(typeof l));let u=new Map(a.map(h=>[_R(h,s),h])),c=l.map(h=>{let d=u.get(_R(h,s));return d?vT(h,d,r):h});n[o]=c}else n[o]=a}else{let s=n[o];typeof s=="object"&&s!==null&&typeof a=="object"&&a!==null?Object.keys(a).length===0?n[o]=a:n[o]=vT(s,a,r):n[i]=a}}else n[i]=a;return n}function P9e(t,e){function r(n){if(typeof n!="object"||n===null)return null;for(let i of e)if(i in n&&typeof n[i]<"u")return[i];if(Array.isArray(n))return null;for(let[i,a]of Object.entries(n)){let o=r(a);if(o)return[i,...o]}return null}return r(t)}function _R(t,e){return e.reduce((r,n)=>{if(r&&typeof r=="object")return r[n]},t)}var D9e=t=>t,k9e=t=>JSON.parse(FK(t)),nQ=(t,e)=>e.some(r=>r.fromBundle(t.name,new Uint8Array,D9e)!==void 0),iQ=nS((t,e)=>{let r={};for(let n of Object.keys(t)){let i=t[n];for(let a of e){let o=a.fromBundle(n,i,k9e);if(o){r=vT(r,o,[]);break}}}return r}),xR=async(t,e)=>new Promise(r=>yLe(t,{filter:n=>nQ(n,e)},(n,i)=>{r(n?hr(n):pr(i))})).then(r=>r.andThen(n=>iQ(n,e))),O9e=nS(vLe),bR=(t,e)=>O9e(t,{filter:r=>nQ(r,e)}).andThen(r=>iQ(r,e));C();var B9e=t=>typeof t=="object"&&t!=null&&"$ref"in t&&typeof t.$ref=="string",z9e=t=>{if(t.length<2)return!1;let e=t.filter(B9e);if(e.length!==t.length)return!1;let r=e[0].$ref;return e.slice(1).every(n=>n.$ref===r)},_T=t=>typeof t=="object"&&t!=null&&"allOf"in t&&Array.isArray(t.allOf)&&z9e(t.allOf)?t.allOf[0]:typeof t=="object"&&t!=null&&!Array.isArray(t)?Object.fromEntries(Object.entries(t).map(([e,r])=>[e,_T(r)])):Array.isArray(t)?t.map(_T):t;C();var xT=t=>typeof t=="object"&&t!=null&&"$ref"in t?lt(ae({},t),{$ref:"#/definitions/".concat(t.$ref)}):typeof t=="object"&&t!=null&&!Array.isArray(t)?Object.fromEntries(Object.entries(t).map(([e,r])=>[e,xT(r)])):Array.isArray(t)?t.map(xT):t,cg;(function(t){t.InvalidTypeboxSchema="InvalidTypeboxSchema",t.MissingReferenceId="MissingReferenceId",t.DuplicateReferenceId="DuplicateReferenceId",t.TypeboxError="TypeboxError",t.UnknownError="UnknownError"})(cg||(cg={}));var F9e=t=>({next(){for(let e of t){let r=e.next();if(!r.done)return r}return{done:!0,value:void 0}},[Symbol.iterator](){return this}}),R9e=(...t)=>{let e=new Map;for(let r of F9e(t)){if(!r.$id)continue;let n=e.get(r.$id);if(n!=null&&n!==r)return hr({kind:cg.DuplicateReferenceId,message:"Failed to register a reference for a schema with an $id that has already been used",schema:r});e.set(r.$id,r)}return pr(e)},Sa,Zy,Os,$a,L9e=class aQ{constructor(e,r,n,i){K(this,Sa),K(this,Zy),K(this,Os,[]),K(this,$a),ne(this,Sa,e),ne(this,Zy,r),ne(this,Os,n),ne(this,$a,i),this.is=this.is.bind(this),this.parse=this.parse.bind(this),this.verify=this.verify.bind(this),this.jsonSchema=this.jsonSchema.bind(this),this.compress=this.compress.bind(this),this.decompress=this.decompress.bind(this)}static create(e,r="CoreMVF",n=!1){let i=U.Composite(e.extensions.map(o=>o.schema),{$id:r});if(!ue.IsSchema(i))return hr({kind:cg.InvalidTypeboxSchema,message:"Attempting to merge schemas produced an invalid schema",schema:i});let a=R9e(h7e.values(),d7e.values(),c7e.values(),E9e.values(),U9e.values(),C9e.values(),e.extensions.flatMap(o=>{var s;return(s=o.references)!=null?s:[]}).values());if(!a.isOk())return a;try{S9e();let o=n?null:yT.Compile(i,[...a.value.values()]);return pr(new aQ(i,o,e.extensions,a.value))}catch(o){return o instanceof Un?hr({kind:cg.TypeboxError,message:o.message,original:o}):hr({kind:cg.UnknownError,message:"An unknown error occurred while compiling the schema",original:o})}}is(e){var r,n;return(n=(r=f(this,Zy))==null?void 0:r.Check(e))!=null?n:qg.Check(f(this,Sa),[...f(this,$a).values()],e)}parse(e){var r,n;return this.is(e)?pr(e):hr((n=(r=f(this,Zy))==null?void 0:r.Errors(e))!=null?n:qg.Errors(f(this,Sa),[...f(this,$a).values()],e))}decode(e){try{return pr(t9e(f(this,Sa),[...f(this,$a).values()],e))}catch(r){return hr(r)}}encode(e){try{return pr(h9e(f(this,Sa),[...f(this,$a).values()],e))}catch(r){return hr(r)}}verify(e){for(let r of f(this,Os))if(r.integrityCheck){let n=r.integrityCheck(e);if(n.isErr())return hr(n.error)}return pr(!0)}jsonSchema(){var e;let r=JSON.parse(JSON.stringify([f(this,Sa),...f(this,$a).values()])),n=_T(xT({$id:"#/definitions/".concat((e=f(this,Sa).$id)!=null?e:"CoreMVF"),$schema:"http://json-schema.org/draft-07/schema#",references:r}));return JSON.stringify(n,null,2)}async compress(e){return this.encode(e).andThen(r=>this.parse(r)).andThenAsync(r=>yR(r,f(this,Os))).then(r=>r.mapErr(n=>{var i;return fb((i=f(this,Sa).$id)!=null?i:"CoreMVF",n,[...f(this,$a).values()])}))}async compressUnsafe(e){return this.encode(e).andThenAsync(r=>yR(r,f(this,Os))).then(r=>r.mapErr(n=>{var i;return fb((i=f(this,Sa).$id)!=null?i:"CoreMVF",n,[...f(this,$a).values()])}))}compressSync(e){return this.encode(e).andThen(r=>this.parse(r)).andThen(r=>vR(r,f(this,Os))).mapErr(r=>{var n;return fb((n=f(this,Sa).$id)!=null?n:"CoreMVF",r,[...f(this,$a).values()])})}compressUnsafeSync(e){return this.encode(e).andThen(r=>vR(r,f(this,Os))).mapErr(r=>{var n;return fb((n=f(this,Sa).$id)!=null?n:"CoreMVF",r,[...f(this,$a).values()])})}async decompress(e){return xR(e,f(this,Os)).then(r=>r.andThen(n=>this.parse(n)).andThen(n=>this.decode(n)).mapErr(n=>{var i;return mb((i=f(this,Sa).$id)!=null?i:"CoreMVF",n,[...f(this,$a).values()])}))}async decompressUnsafe(e){return xR(e,f(this,Os)).then(r=>r.andThen(n=>this.decode(n)).mapErr(n=>{var i;return mb((i=f(this,Sa).$id)!=null?i:"CoreMVF",n,[...f(this,$a).values()])}))}decompressSync(e){return bR(e,f(this,Os)).andThen(r=>this.parse(r)).andThen(r=>this.decode(r)).mapErr(r=>{var n;return mb((n=f(this,Sa).$id)!=null?n:"CoreMVF",r,[...f(this,$a).values()])})}decompressUnsafeSync(e){return bR(e,f(this,Os)).andThen(r=>this.decode(r)).mapErr(r=>{var n;return mb((n=f(this,Sa).$id)!=null?n:"CoreMVF",r,[...f(this,$a).values()])})}};Sa=new WeakMap,Zy=new WeakMap,Os=new WeakMap,$a=new WeakMap;var N9e=L9e,Wy,$9e=class{constructor(){K(this,Wy,[]),this.extend=this.extend.bind(this)}extend(t){return f(this,Wy).push(t),this}extendOptional(t){let e=lt(ae({},t),{schema:U.Partial(t.schema)});return f(this,Wy).push(e),this}build(t){return N9e.create(this,void 0,t?.cspSafe)}get extensions(){return f(this,Wy)}};Wy=new WeakMap;C();C();C();C();var iS=U.Object({geometryId:U.Ref(Qc),floorId:U.Ref(la)},{$id:"GeometryAnchor"});U.Object({geometryAnchor:U.Ref(iS)});var oQ=(t,e)=>U.Object({geometryAnchors:U.Array(U.Ref(iS),t)},e),U9e=[iS];C();C();C();var j9e=(t,e)=>U.Unsafe(U.Transform(U.String(e)).Decode(r=>t.includes(r)?r:"unknown").Encode(r=>r)),lf=(t,e)=>{let r=j9e(t,e),n=[...t,"unknown"],i=Object.freeze(Object.fromEntries([...t,"unknown"].map(a=>[a,a])));return{schema:r,values:n,record:i}},V9e=()=>new $9e().extend(zLe).extend($Le).extend(jLe);C();var G9e=t=>{if(t==="space"||t==="obstruction"||t==="entrance")return{}},Z9e=/\.json|\.geojson$/,gb=(t,e,r)=>{let n=t[e];if(typeof n!="object"||Object.keys(n).length===0)return G9e(e);let i={};for(let[a,o]of Object.entries(n)){let s=a.replace(Z9e,"");i[s]=JSON.parse(r(o))}return i},W9e=["floorstack.json","styles.json","shapes.json","mapstack.json","floor.geojson","tileset.json","location.json","category.json","navigationFlags.json","annotation-symbols.json"],H9e=W9e,X9e=["annotation","textAreas","enterprise","floorImages","shapeInstances","modelInstances","window","area","facade"],q9e=X9e,Y9e=t=>{let e=new TextDecoder("utf-8"),r=e.decode.bind(e),n={"manifest.geojson":JSON.parse(r(t["manifest.geojson"])),"mapstack.geojson":JSON.parse(r(t["mapstack.geojson"])),"map.geojson":JSON.parse(r(t["map.geojson"])),"node.geojson":JSON.parse(r(t["node.geojson"])),"connection.json":JSON.parse(r(t["connection.json"])),space:gb(t,"space",r),obstruction:gb(t,"obstruction",r),entrance:gb(t,"entrance",r)};for(let i of H9e)t[i]&&(n[i]=JSON.parse(r(t[i])));for(let i of q9e)t[i]&&(n[i]=gb(t,i,r));return n};C();C();C();C();C();var tA;(function(t){t.AnnotationNonPointGeometryError="AnnotationNonPointGeometryError",t.AnnotationUnknownSymbolError="AnnotationUnknownSymbolError"})(tA||(tA={}));var J9e=t=>{var e;if(t.annotations==null)return pr(!0);let r=ms(t.annotations,a=>a.id,"annotations");if(r.isErr())return r;let n=th(t),i=new Set(Xi((e=t.annotationSymbols)!=null?e:{}));for(let a of Xi(t.annotations)){let o=t.annotations[a];if(o!=null)for(let s of o){if(!i.has(s.symbolKey))return hr({kind:tA.AnnotationUnknownSymbolError,properties:{annotationId:s.id,symbolKey:s.symbolKey}});let l=n(a,s.geometryId);if(l.isErr())return l;if(l.value.geometry.type!=="Point")return hr({kind:tA.AnnotationNonPointGeometryError,properties:{annotationId:s.id,floorId:a,geometryId:s.geometryId}})}}return pr(!0)},sQ=qo("a","AnnotationId"),bT=U.Intersect([L0,U.Object({id:U.Ref(sQ,{description:"The unique identifier for the annotation."}),externalId:U.Optional(U.String({description:"The external identifier for the annotation."})),symbolKey:U.String({description:"The symbol identifier for the annotation."})})],{$id:"AnnotationProperties"}),lQ=U.Object({url:U.String({format:"uri",description:"The URL for the symbol."}),name:U.String({description:"The name of the symbol."})},{$id:"AnnotationSymbol"}),K9e=U.Object({annotations:Wo(U.Record(la,U.Array(U.Ref(bT)),{additionalProperties:!1})),annotationSymbols:Wo(U.Record(U.Index(bT,["symbolKey"]),U.Ref(lQ)))},{$id:"AnnotationsSchema"}),Q9e=/^annotations\/(.*)\.json$/,eNe={name:"ext:mvf-annotations",schema:K9e,intoBundle:function*(t){if(t.annotations!=null)for(let e of Xi(t.annotations))yield{path:"annotations/".concat(e,".json"),contents:t.annotations[e]};t.annotationSymbols!=null&&(yield{path:"annotation-symbols.json",contents:t.annotationSymbols})},fromBundle:(t,e,r)=>{var n;if(t==="annotation-symbols.json")return{annotationSymbols:r(e)};let i=(n=t.match(Q9e))==null?void 0:n[1];if(i)return{annotations:{[i]:r(e)}}},references:[sQ,bT,lQ],integrityCheck:J9e};C();C();C();var Qg=qo("lcat","LocationCategoryId"),uQ=U.Intersect([U.Object({id:U.Ref(Qg),parent:U.Optional(U.Ref(Qg))}),AO(["name"]),F_],{$id:"LocationCategory"}),tNe=[Qg,uQ];C();C();var Vm;(function(t){t.UnknownCategoryError="UnknownCategoryError",t.UnknownParentCategoryError="UnknownParentCategoryError",t.UnknownParentLocationError="UnknownParentLocationError"})(Vm||(Vm={}));var rNe=t=>{var e,r,n,i,a,o,s,l,u;if(t.locationCategories==null&&t.locations==null)return pr(!0);if(t.locationCategories!=null){let p=ms(t.locationCategories,m=>m.id,"locationCategories");if(p.isErr())return p}if(t.locations!=null){let p=ms(t.locations,m=>m.id,"locations");if(p.isErr())return p}if(t.locationInstances!=null){let p=ms(t.locationInstances,m=>m.id,"locationInstances");if(p.isErr())return p}let c=new Set((r=(e=t.locationCategories)==null?void 0:e.map(p=>p.id))!=null?r:[]);for(let p of(n=t.locationCategories)!=null?n:[])if(p.parent!=null&&!c.has(p.parent))return hr({kind:Vm.UnknownParentCategoryError,properties:{categoryId:p.id,parentCategoryId:p.parent}});let h=th(t);for(let p of(i=t.locations)!=null?i:[]){for(let m of p.categories)if(!c.has(m))return hr({kind:Vm.UnknownCategoryError,properties:{locationId:p.id,categoryId:m}});for(let m of p.geometryAnchors){let y=h(m.floorId,m.geometryId);if(y.isErr())return y}}let d=new Set((o=(a=t.locations)==null?void 0:a.map(p=>p.id))!=null?o:[]);for(let p of(s=t.locationInstances)!=null?s:[]){if(!d.has(p.parentId))return hr({kind:Vm.UnknownParentLocationError,properties:{locationInstanceId:p.id,parentLocationId:p.parentId}});for(let m of(l=p.categories)!=null?l:[])if(!c.has(m))return hr({kind:Vm.UnknownCategoryError,properties:{locationId:p.id,categoryId:m}});for(let m of(u=p.geometryAnchors)!=null?u:[]){let y=h(m.floorId,m.geometryId);if(y.isErr())return y}}return pr(!0)};C();var N0=qo("loc","LocationId"),RO=qo("loci","LocationInstanceId"),cQ=U.Object({name:U.String(),url:U.String({format:"uri"})},{$id:"LocationSocial"}),hQ=U.Object({url:U.String({format:"uri"})},{$id:"LocationImage"}),wT=U.Object({label:U.String(),url:U.String({format:"uri"})},{$id:"LocationLink"}),AT=U.String({pattern:"^[0-2][0-9]:[0-6][0-9](:[0-6][0-9])?$",$id:"OpeningHoursTime"}),dQ=U.Union([U.Literal("Sunday"),U.Literal("Monday"),U.Literal("Tuesday"),U.Literal("Wednesday"),U.Literal("Thursday"),U.Literal("Friday"),U.Literal("Saturday")],{$id:"OpeningHoursDay"}),nNe="PublicHolidays",ST=U.Union([dQ,U.Literal(nNe)],{$id:"OpeningHoursDayOrPublicHoliday"}),LO=U.Object({"@type":U.Optional(U.Literal("OpeningHoursSpecification",{description:"The type of opening hours"})),opens:U.Optional(U.Ref(AT,{description:"The time the opening hours start"})),closes:U.Optional(U.Ref(AT,{description:"The time the opening hours end"})),dayOfWeek:U.Optional(U.Union([U.Ref(ST),U.Array(U.Ref(ST))],{description:"The days of the week the opening hours apply to"})),validFrom:U.Optional(U.String({format:"date",description:"The date the opening hours start, in ISO 8601 format"})),validThrough:U.Optional(U.String({format:"date",description:"The date the opening hours end, in ISO 8601 format"}))},{$id:"OpeningHoursSpecification"}),NO=U.Intersect([U.Object({id:U.Ref(N0),categories:U.Array(U.Ref(Qg)),logo:U.Optional(U.String({format:"uri"})),phone:U.Optional(U.String()),social:U.Array(U.Ref(cQ)),images:U.Array(U.Ref(hQ)),links:U.Array(U.Ref(wT)),website:U.Optional(U.Ref(wT)),openingHours:U.Optional(U.Array(U.Ref(LO)))}),AO(["name"]),oQ(),F_],{$id:"Location"}),pQ=U.Intersect([U.Object({id:U.Ref(RO),parentId:U.Ref(N0)}),U.Partial(U.Omit(NO,["id","parentId","details"])),k0],{$id:"LocationInstance",description:"A location instance is a particular instance of an location that has some properties different from the parent."}),fQ=[N0,RO,cQ,hQ,wT,AT,dQ,ST,LO,NO,pQ],iNe=U.Object({locations:U.Array(U.Ref(NO)),locationCategories:U.Array(U.Ref(uQ)),locationInstances:U.Optional(U.Array(U.Ref(pQ)))},{$id:"LocationsExtensionSchema"}),wR="locations.json",AR="location-categories.json",SR="location-instances.json",aNe={name:"ext:locations",schema:iNe,intoBundle:function*(t){t.locations!=null&&(yield{path:wR,contents:t.locations}),t.locationCategories!=null&&(yield{path:AR,contents:t.locationCategories}),t.locationInstances!=null&&(yield{path:SR,contents:t.locationInstances})},fromBundle:(t,e,r)=>{if(t===wR)return{locations:r(e)};if(t===AR)return{locationCategories:r(e)};if(t===SR)return{locationInstances:r(e)}},references:[...tNe,...fQ],integrityCheck:rNe};C();C();var ou;(function(t){t.EnterpriseLocationWithUnknownLocationError="EnterpriseLocationWithUnknownLocationError",t.EnterpriseCategoryWithUnknownLocationCategoryError="EnterpriseCategoryWithUnknownLocationCategoryError",t.InstanceWithUnknownLocationInstanceError="InstanceWithUnknownLocationInstanceError",t.InstanceWithUnknownEnterpriseLocationError="InstanceWithUnknownEnterpriseLocationError",t.EnterpriseLocationWithUnknownSibling="EnterpriseLocationWithUnknownSibling",t.EnterpriseLocationInstanceWithUnknownSibling="EnterpriseLocationInstanceWithUnknownSibling",t.EnterpriseVenueWithUnknownTopLocationError="EnterpriseVenueWithUnknownTopLocationError",t.EnterpriseLocationWithInvalidPrimaryCategory="EnterpriseLocationWithInvalidPrimaryCategory"})(ou||(ou={}));var oNe=t=>{var e,r,n,i,a,o,s,l,u,c,h,d,p,m,y,v,_,w,b,A;if(t.cms==null)return pr(!0);let E=t.cms,M=ms(t.cms.categories,$=>$.id,"cms.categories");if(M.isErr())return M;let P=new Set((r=(e=t.locationCategories)==null?void 0:e.map($=>$.id))!=null?r:[]);for(let $ of(n=E.categories)!=null?n:[])if(!P.has($.categoryId))return hr({kind:ou.EnterpriseCategoryWithUnknownLocationCategoryError,properties:{enterpriseCategoryId:$.id,locationCategoryId:$.categoryId}});let k=ms(t.cms.locations,$=>$.id,"cms.locations");if(k.isErr())return k;let D=new Map((a=(i=t.locations)==null?void 0:i.map($=>[$.id,$]))!=null?a:[]);for(let $ of(o=E.locations)!=null?o:[]){if(!D.has($.locationId))return hr({kind:ou.EnterpriseLocationWithUnknownLocationError,properties:{enterpriseLocationId:$.id,locationId:$.locationId}});for(let V of(s=$.siblingGroups)!=null?s:[])for(let G of(l=V.siblings)!=null?l:[])if(!D.has(G))return hr({kind:ou.EnterpriseLocationWithUnknownSibling,properties:{enterpriseLocationId:$.id,siblingLocationId:G,label:V.label}});if($.primaryCategory!=null){let V=D.get($.locationId);if(V!=null&&!V.categories.includes($.primaryCategory))return hr({kind:ou.EnterpriseLocationWithInvalidPrimaryCategory,properties:{enterpriseLocationId:$.id,locationId:$.locationId,primaryCategory:$.primaryCategory}})}}if(((u=E.venue)==null?void 0:u.topLocations)!=null){for(let $ of E.venue.topLocations)if(!D.has($))return hr({kind:ou.EnterpriseVenueWithUnknownTopLocationError,properties:{locationId:$}})}let O=new Set((h=(c=t.cms.locations)==null?void 0:c.map($=>$.id))!=null?h:[]),B=ms(t.cms.locationInstances,$=>$.id,"cms.locationInstances");if(B.isErr())return B;let L=new Set((p=(d=t.locationInstances)==null?void 0:d.map($=>$.id))!=null?p:[]);for(let $ of(m=E.locationInstances)!=null?m:[]){if(!O.has($.parentId))return hr({kind:ou.InstanceWithUnknownEnterpriseLocationError,properties:{enterpriseLocationInstanceId:$.id,enterpriseLocationId:$.parentId}});if(!L.has($.locationInstanceId))return hr({kind:ou.InstanceWithUnknownLocationInstanceError,properties:{enterpriseLocationInstanceId:$.id,locationInstanceId:$.locationInstanceId}});for(let V of(y=$.siblingGroups)!=null?y:[])for(let G of(v=V.siblings)!=null?v:[])if(!D.has(G))return hr({kind:ou.EnterpriseLocationInstanceWithUnknownSibling,properties:{enterpriseLocationInstanceId:$.id,siblingLocationId:G,label:V.label}})}let R=B_(t),T=th(t),N=ms(t.cms.floorText,$=>$.properties.id,"cms.floorText");if(N.isErr())return N;for(let[$,V]of aa((_=E.floorText)!=null?_:{})){let G=R($);if(G.isErr())return G;for(let ee of V.features){if(!("geometryId"in ee.properties))continue;let ie=T($,ee.properties.geometryId);if(ie.isErr())return ie}}for(let[$,V]of aa((w=E.textures)!=null?w:{})){let G=R($);if(G.isErr())return G;for(let ee of V){let ie=T($,ee.geometryId);if(ie.isErr())return ie}}for(let[$,V]of aa((b=E.layers)!=null?b:{})){let G=R($);if(G.isErr())return G;for(let ee of Xi(V??{})){let ie=T($,ee);if(ie.isErr())return ie}}for(let[$,V]of aa((A=E.textAreas)!=null?A:{})){let G=R($);if(G.isErr())return G;for(let ee of V.features)if("geometryId"in ee.properties){let ie=T($,ee.properties.geometryId);if(ie.isErr())return ie}}return pr(!0)};C();C();var $O=qo("el","EnterpriseLocationId"),mQ=qo("ec","EnterpriseCategoryId"),gQ=qo("eli","EnterpriseLocationInstanceId"),yQ=qo("ev","EnterpriseVenueId"),vQ=qo("eft","EnterpriseFloorTextId"),sNe=[$O,mQ,gQ,yQ,vQ],_Q=U.Object({id:U.Ref(mQ),categoryId:U.Ref(Qg),color:U.Optional(U.String()),sortOrder:U.Number(),iconFromDefaultList:U.Optional(U.Union([U.String(),U.Null()])),picture:U.Optional(U.String({format:"uri",description:"The category's picture"}))},{$id:"EnterpriseCategory"}),xQ=U.Object({categories:U.Optional(U.Array(U.Ref(_Q)))},{$id:"EnterpriseCategoriesSchema"}),lNe=[_Q,xQ];C();var uNe=lf(["left","center","right"]),cNe=uNe.schema,UO=U.Object({id:U.Ref(vQ),text:U.String(),visible:U.Boolean({default:!0}),fontSize:U.Number({default:12,exclusiveMinimum:0}),fontFamily:U.String({default:"Droid Sans"}),color:U.String({default:"black"}),rotation:U.Number({minimum:0,maximum:360}),align:cNe},{$id:"FloorTextCommonProperties"}),jO=U.Intersect([U.Ref(UO),L0],{$id:"AnchoredFloorTextProperties"}),VO=U.Intersect([U.Ref(UO),U.Object({verticalOffset:U.Number()})],{$id:"FloatingFloorTextProperties"}),bQ=U.Union([U.Ref(jO),U.Ref(VO)],{$id:"FloorTextProperties"}),wQ=Kc(Jc,U.Ref(bQ),{$id:"FloorTextFeature"}),hNe=Kc(Jc,U.Ref(jO),{$id:"AnchoredFloorTextFeature"}),dNe=Kc(Jc,U.Ref(VO),{$id:"FloatingFloorTextFeature"}),AQ=sf(U.Ref(wQ),{$id:"EnterpriseFloorTextFeatureCollection"}),SQ=U.Record(la,U.Ref(AQ),{$id:"EnterpriseFloorTextCollectionsByFloor",additionalProperties:!1}),EQ=U.Object({floorText:U.Optional(U.Ref(SQ))},{$id:"EnterpriseFloorTextSchema"}),pNe=[UO,jO,VO,bQ,wQ,hNe,dNe,AQ,SQ,EQ];C();var IQ=Wo(U.Record(Qc,U.String({minLength:1}),{additionalProperties:!1,$id:"EnterpriseLayers"})),CQ=Wo(U.Record(la,U.Ref(IQ),{additionalProperties:!1,$id:"EnterpriseLayersByFloor"})),MQ=U.Object({layers:U.Optional(U.Ref(CQ))},{$id:"EnterpriseLayersSchema"}),fNe=[IQ,CQ,MQ];C();C();C();var mNe=lf(["closed-temporarily","new","pop-up","coming-soon","relocated"]),gNe=mNe.schema,TQ=U.Object({type:gNe,start:U.Optional(U.String({format:"date",description:"The start date of the state"})),end:U.Optional(U.String({format:"date",description:"The end date of the state"}))},{$id:"LocationState",description:"The state of a location. Start and end dates are optional."}),PQ=U.Object({label:U.String(),siblings:U.Array(U.Ref(N0))},{$id:"SiblingGroup"}),ET=U.Object({name:U.String(),code:U.String()},{$id:"Language"}),yNe=[TQ,PQ,ET],GO=U.Object({id:U.Ref($O),locationId:U.Ref(N0),cmsId:U.String(),type:U.String(),sortOrder:U.Number(),tags:U.Optional(U.Array(U.String())),picture:U.Optional(U.String({format:"uri",description:"The picture of the location"})),states:U.Optional(U.Array(U.Ref(TQ),{description:"The location's state. No more than one state should be active at a time, and all but at most one should have dates set"})),siblingGroups:U.Optional(U.Array(U.Ref(PQ))),gallery:U.Optional(U.Array(U.Object({caption:U.Optional(U.String()),image:U.String({format:"uri"}),embeddedUrl:U.Optional(U.String({format:"uri",description:"The URL to link from the image"}))},{description:"The location's image gallery"}),{description:"The location's image gallery"})),showFloatingLabelWhenImagePresent:U.Optional(U.Boolean({description:"Whether to show the flat label when an image is present"})),amenity:U.Optional(U.String({description:"The location's amenity type. Only set if the location is an amenity"})),showLogo:U.Optional(U.Boolean({description:"Whether to show the logo of the location"})),primaryCategory:U.Optional(U.Ref(Qg))},{$id:"EnterpriseLocation"}),DQ=U.Object({locations:U.Optional(U.Array(U.Ref(GO)))},{$id:"EnterpriseLocationsSchema"}),vNe=[GO,DQ],kQ=U.Intersect([U.Object({id:U.Ref(gQ),parentId:U.Ref($O),locationInstanceId:U.Ref(RO)}),U.Partial(U.Omit(GO,["id","parentId","locationId"]))],{$id:"EnterpriseLocationInstance",description:"A locationInstance is a particular instance of an Enterprise Location that has some properties different from the parent."}),OQ=U.Object({locationInstances:U.Optional(U.Array(U.Ref(kQ)))},{$id:"EnterpriseLocationInstancesSchema"}),_Ne=[kQ,OQ];C();var xNe=lf(["near","center"],{$id:"EnterpriseTextAreaAlignment"}),BQ=xNe.schema,ZO=U.Object({maxWidth:U.Number({exclusiveMinimum:0,description:"The maximum width of the label, in meters."}),maxHeight:U.Number({exclusiveMinimum:0,description:"The maximum height of the label, in meters."}),align:U.Ref(BQ),rotation:U.Number({minimum:0,maximum:360,description:"Rotation in degrees, about the center of the image. North is 0, east is 90."})},{$id:"EnterpriseBaseTextAreaProperties"}),zQ=U.Intersect([U.Ref(ZO),L0],{$id:"EnterpriseAnchoredTextAreaProperties"}),FQ=U.Intersect([U.Ref(ZO),U.Object({verticalOffset:U.Number({minimum:0,description:"How high to position the image, in meters, relative to the ground plane."})})],{$id:"EnterpriseFloatingTextAreaProperties"}),RQ=U.Union([zQ,FQ],{$id:"EnterpriseTextAreaProperties"}),LQ=Kc(U.Ref(Jc),RQ,{$id:"EnterpriseTextAreaFeature"}),NQ=sf(U.Ref(LQ),{$id:"EnterpriseTextAreaCollection"}),$Q=U.Record(la,U.Ref(NQ),{$id:"EnterpriseTextAreasByFloor",additionalProperties:!1}),bNe=U.Object({textAreas:U.Optional(U.Ref($Q))},{$id:"EnterpriseTextAreasSchema"}),wNe=[BQ,ZO,zQ,FQ,RQ,LQ,NQ,$Q];C();var IT=U.Object({u:U.Number(),v:U.Number()},{$id:"EnterpriseTextureUV"}),ANe=lf(["top","side"],{$id:"EnterpriseTextureFace"}),UQ=ANe.schema,SNe=lf(["inside","outside","both"],{$id:"EnterpriseTextureSurface"}),jQ=SNe.schema,VQ=U.Tuple([H4,X4,H4,X4],{$id:"EnterpriseTextureBounds"}),GQ=U.Intersect([U.Object({repeat:U.Ref(IT),offset:U.Ref(IT),rotation:U.Number({minimum:0,maximum:360}),path:U.String({format:"uri"}),face:U.Ref(UQ),surface:U.Ref(jQ),bounds:U.Ref(VQ)},{$id:"EnterpriseTextureProperties"}),L0],{$id:"EnterpriseTexture"}),ZQ=U.Array(U.Ref(GQ),{$id:"EnterpriseTextures"}),WQ=U.Record(la,U.Ref(ZQ),{$id:"EnterpriseTexturesByFloor",additionalProperties:!1}),HQ=U.Object({textures:U.Optional(U.Ref(WQ))},{$id:"EnterpriseTexturesSchema"}),ENe=[GQ,ZQ,HQ,IT,UQ,jQ,VQ,WQ];C();var XQ=U.Intersect([U.Object({id:U.Ref(yQ),slug:U.String(),defaultLanguage:U.Ref(ET),languages:U.Array(U.Ref(ET)),countrycode:U.Optional(U.String()),logo:U.Optional(U.String({format:"uri"})),mappedinWebUrl:U.Optional(U.String({format:"uri"})),topLocations:U.Optional(U.Array(U.Ref(N0))),operationHours:U.Optional(U.Array(U.Ref(LO))),coverImage:U.Optional(U.String({format:"uri"}))}),AO(["name"]),F_],{$id:"EnterpriseVenue"}),qQ=U.Object({venue:U.Optional(U.Ref(XQ))},{$id:"EnterpriseVenueSchema"}),INe=[XQ,qQ],YQ=U.Intersect([qQ,DQ,OQ,xQ,HQ,EQ,MQ,bNe],{$id:"CMSProperties"}),ER=U.Object({cms:U.Optional(U.Ref(YQ))},{$id:"CMSExtensionSchema"}),CNe=/^cms\/(?:([^/]+)\/)?([^/]+)\.(?:json|geojson)$/,MNe={name:"ext:cms",schema:ER,intoBundle:function*(t){var e,r,n,i,a,o;if(t.cms==null)return;let s=t.cms;for(let l of Xi(s))switch(l){case"floorText":for(let u of Xi((e=s.floorText)!=null?e:{}))yield{path:"cms/floorText/".concat(u,".geojson"),contents:((r=s.floorText)!=null?r:{})[u]};continue;case"textures":for(let u of Xi((n=s.textures)!=null?n:{}))yield{path:"cms/textures/".concat(u,".json"),contents:((i=s.textures)!=null?i:{})[u]};continue;case"textAreas":for(let u of Xi((a=s.textAreas)!=null?a:{}))yield{path:"cms/textAreas/".concat(u,".geojson"),contents:((o=s.textAreas)!=null?o:{})[u]};continue;default:yield{path:"cms/".concat(l,".json"),contents:s[l]};continue}},fromBundle:(t,e,r)=>{let n=t.match(CNe);if(!n)return;let[,i,a]=n,o=r(e);switch(i){case"floorText":case"textures":case"textAreas":return{cms:{[i]:{[a]:o}}};default:return{cms:{[a]:o}}}},references:[YQ,ER,...INe,...vNe,..._Ne,...lNe,...ENe,...fNe,...pNe,...wNe,...sNe,...yNe,...fQ],integrityCheck:oNe};C();C();C();C();var zc;(function(t){t.NavigationFlagMissingDeclaration="NavigationFlagMissingDeclaration",t.NavigationFlagDuplicateBit="NavigationFlagDuplicateBit",t.NavigationFlagIncorrectFlagsLength="NavigationFlagIncorrectFlagsLength",t.NavigationFlagValueTooBig="NavigationFlagValueTooBig"})(zc||(zc={}));var TNe=t=>{let{navigationFlags:e}=t;if(!e||Object.keys(e).length===0)return pr(!0);let r=Object.entries(e).map(([a,o])=>ae({key:a},o)).sort((a,o)=>a.index!==o.index?a.index-o.index:a.bit-o.bit),n=0,i=-1;for(let a of r){if(a.bit===i)return hr({kind:zc.NavigationFlagDuplicateBit,properties:{index:a.index,bit:a.bit,path:"navigationFlags.".concat(a.key)}});if(a.index!=n){if(i!=31)return hr({kind:zc.NavigationFlagMissingDeclaration,properties:{index:n,bit:i+1,path:"navigationFlags"}});if(a.index!=n+1||a.bit!=0)return hr({kind:zc.NavigationFlagMissingDeclaration,properties:{index:n+1,bit:0,path:"navigationFlags"}});n=a.index,i=0}else{if(a.bit!==i+1)return hr({kind:zc.NavigationFlagMissingDeclaration,properties:{index:a.index,bit:i+1,path:"navigationFlags"}});i=a.bit}}return pr(!0)};C();function R1(t,e){return e&&(t.flags[e.index]&1<<e.bit)!==0}C();var IR=2**32-1,JQ=t=>{var e;let r=Object.keys((e=t.navigationFlags)!=null?e:{}).length;if(r===0)return{index:-1,flag:0};let n=Math.floor(r/32),i=r%32;return{index:n,flag:2**i-1}},CT=(t,e,r)=>{if(e.index==-1&&t.length===0)return pr(!0);let n=e.flag>0||e.index===-1?e.index+1:e.index;if(t.length!==n)return hr({kind:zc.NavigationFlagIncorrectFlagsLength,properties:{expected:n,actual:t.length,path:r}});for(let i=0;i<t.length;i++){let a=t[i];if(i<e.index){if(a>IR)return hr({kind:zc.NavigationFlagValueTooBig,properties:{index:i,flagValue:a,expectedMaxFlagValue:IR,path:r}});continue}else if(a>e.flag)return hr({kind:zc.NavigationFlagValueTooBig,properties:{index:i,flagValue:a,expectedMaxFlagValue:e.flag,path:r}})}return pr(!0)},PNe=U.Object({index:U.Integer({description:"The index of the flag in a flags array.",minimum:0}),bit:U.Integer({description:"The bit position of the flag in a flag's bitfield.",minimum:0,maximum:31})},{$id:"NavigationFlagDeclarationCore"}),KQ=U.Intersect([PNe,k0],{$id:"NavigationFlagDeclaration",description:'A NavigationFlagDeclaration describes the relationship between a "key" that a developer might use to wayfind using that flag, and the index and bit position in an object\'s `flags` array.'}),CR={accessible:"accessible",outdoors:"outdoors"},QQ=U.Record(U.String(),KQ,{$id:"NavigationFlagDeclarations",description:"Any well known and custom flags present in the MVF"}),DNe=U.Object({navigationFlags:U.Ref(QQ)},{$id:"NavigationFlagsSchema"}),WO=U.Array(U.Integer({minimum:0,maximum:Math.pow(2,32)-1}),{$id:"Flags"}),eee=U.Object({flags:U.Ref(WO)},{$id:"WithFlags"}),e0=U.Intersect([iS,eee],{$id:"FlaggedGeometryAnchor"}),kNe=U.Object({geometryAnchor:e0},{$id:"WithFlaggedGeometryAnchor"}),ONe=U.Object({geometryAnchors:U.Array(e0)},{$id:"WithFlaggedGeometryAnchors"}),BNe={name:"ext:mvf-navigation-flags",schema:DNe,intoBundle:function*(t){t.navigationFlags!=null&&(yield{path:"navigationFlags.json",contents:t.navigationFlags})},fromBundle:(t,e,r)=>t!=="navigationFlags.json"?void 0:{navigationFlags:r(e)},references:[KQ,QQ,WO,e0,kNe,ONe],integrityCheck:TNe};C();var zNe=t=>{if(t.connections==null)return pr(!0);let e=ms(t.connections,i=>i.id,"connections");if(e.isErr())return e;let r=th(t),n=JQ(t);for(let[i,a]of t.connections.entries()){for(let[o,s]of a.entrances.entries()){let l=r(s.floorId,s.geometryId);if(l.isErr())return l;let u=CT(s.flags,n,"connections[".concat(i,"].entrances[").concat(o,"]"));if(u.isErr())return u}for(let[o,s]of a.exits.entries()){let l=r(s.floorId,s.geometryId);if(l.isErr())return l;let u=CT(s.flags,n,"connections[".concat(i,"].exits[").concat(o,"]"));if(u.isErr())return u}}return pr(!0)},tee=qo("c","ConnectionId"),{schema:FNe,record:RNe}=lf(["elevator","escalator","travelator","stairs","door","ramp","ladder"],{$id:"ConnectionType"}),ree=FNe,nee=RNe,iee=U.Intersect([U.Object({id:U.Ref(tee,{description:"The unique identifier for the connection."}),entrances:U.Array(U.Ref(e0)),exits:U.Array(U.Ref(e0)),entryCost:U.Number({description:"The cost to enter the connection.",minimum:0}),floorCostMultiplier:U.Number({description:"The cost multiplier for each floor transitioned.",minimum:1}),type:U.Ref(ree,{description:"The type of connection."})}),k0,F_],{$id:"ConnectionsProperties"}),aee=U.Array(U.Ref(iee),{$id:"ConnectionsCollection"}),LNe=U.Object({connections:U.Ref(aee)},{$id:"ConnectionsExtensionSchema"}),MR="connections.json",NNe={name:"ext:connections",schema:LNe,intoBundle:function*(t){t.connections!=null&&(yield{path:MR,contents:t.connections})},fromBundle:(t,e,r)=>{if(t===MR)return{connections:r(e)}},references:[iee,aee,ree,tee,e0,WO],integrityCheck:zNe};C();C();var $Ne=t=>{if(t.defaultStyle==null)return pr(!0);let e=th(t);for(let r of Object.values(t.defaultStyle))if(r!=null)for(let n of r.geometryAnchors){let i=e(n.floorId,n.geometryId);if(i.isErr())return i}return pr(!0)},oee=U.Intersect([oQ(),F_,U.Object({altitude:U.Number({description:"How far off the bottom of the floor the objects with this style should be drawn, in meters."}),color:U.String({pattern:"^#[0-9a-fA-F]{6}$",description:"Color should be represented with a hash (#), followed by 6 hexadecimal digits. ex: #RRGGBB"}),height:U.Number({minimum:0,description:"The height of the objects belonging to this layer, in meters."}),opacity:U.Number({minimum:0,maximum:1,description:"The opacity of the objects belonging to this layer, from 0 to 1."}),buffer:U.Number({description:"The buffer amount to apply to the geometry, in meters. This can be used to inflate line string geometry for walls, but might also be applicable as a way to grow or shrink polygon geometry for aesthetic purposes. Can be negative."}),hidden:U.Optional(U.Boolean({description:"Whether or not the objects with this style should be hidden."}))})],{$id:"DefaultStyle"}),see=U.Record(U.String(),U.Ref(oee),{$id:"DefaultStyleCollection",additionalProperties:!1}),UNe=U.Object({defaultStyle:U.Ref(see)},{$id:"DefaultStyleSchema"}),jNe={name:"ext:mvf-default-style",schema:UNe,intoBundle:function*(t){t.defaultStyle!=null&&(yield{path:"default-style.json",contents:t.defaultStyle})},fromBundle:(t,e,r)=>{if(t==="default-style.json")return{defaultStyle:r(e)}},references:[oee,see],integrityCheck:$Ne};C();C();C();C();var MT;(function(t){t.InvalidDefaultFloorError="InvalidDefaultFloorError"})(MT||(MT={}));var VNe=t=>{if(t.floorStacks==null)return pr(!0);let e=ms(t.floorStacks,n=>n.id,"floorStacks");if(e.isErr())return e;let r=B_(t);for(let n of t.floorStacks){for(let i of n.floors){let a=r(i);if(a.isErr())return a}if(n.defaultFloor!=null&&!n.floors.includes(n.defaultFloor))return hr({kind:MT.InvalidDefaultFloorError,properties:{floorStackId:n.id,floorId:n.defaultFloor}})}return pr(!0)},aS=qo("fs","FloorStackId"),lee=U.Intersect([U.Object({id:U.Ref(aS,{description:"The unique identifier for the floor stack."}),floors:U.Array(U.Ref(la),{uniqueItems:!0,minItems:1,description:"The floors that are part of this floor stack."}),defaultFloor:U.Optional(U.Ref(la,{description:"The default floor for the floor stack."}))}),k0],{$id:"FloorStacksProperties"}),uee=U.Array(U.Ref(lee),{$id:"FloorStackCollection"}),GNe=U.Object({floorStacks:U.Ref(uee)},{$id:"FloorStackExtensionSchema"}),TR="floor-stacks.json",ZNe={name:"ext:floor-stacks",schema:GNe,intoBundle:function*(t){t.floorStacks!=null&&(yield{path:TR,contents:t.floorStacks})},fromBundle:(t,e,r)=>{if(t===TR)return{floorStacks:r(e)}},references:[aS,lee,uee],integrityCheck:VNe};C();C();var rA;(function(t){t.MissingFloorStackError="MissingFloorStackError",t.UnknownFloorStackError="UnknownFloorStackError"})(rA||(rA={}));var WNe=t=>{if(t.facade==null)return pr(!0);if(t.floorStacks==null)return hr({kind:rA.MissingFloorStackError,properties:null});let e=new Set(t.floorStacks.map(i=>i.id)),r=th(t),n=B_(t);for(let[i,a]of aa(t.facade)){if(a==null)continue;let o=n(i);if(o.isErr())return o;for(let s of a){let{floorStackId:l,geometryIds:u}=s;if(!e.has(l))return hr({kind:rA.UnknownFloorStackError,properties:{floorStackId:l}});for(let c of u){let h=r(i,c);if(h.isErr())return h}}}return pr(!0)},cee=U.Intersect([U.Object({floorStackId:U.Ref(aS)}),FO],{$id:"Facade"}),HNe=U.Object({facade:Wo(U.Record(la,U.Array(U.Ref(cee)),{additionalProperties:!1}))},{$id:"FacadeExtensionSchema"}),XNe=/^facade\/(.*)\.json$/,qNe={name:"ext:facade",schema:HNe,intoBundle:function*(t){if(t.facade!=null)for(let e of Xi(t.facade))yield{path:"facade/".concat(e,".json"),contents:t.facade[e]}},fromBundle:(t,e,r)=>{var n;let i=(n=t.match(XNe))==null?void 0:n[1];if(i)return{facade:{[i]:r(e)}}},references:[aS,cee],integrityCheck:WNe};C();C();var YNe=t=>{if(t.floorImages==null)return pr(!0);let e=th(t);for(let[r,n]of aa(t.floorImages))if(n!=null)for(let i of n.features){if(!("geometryId"in i.properties))continue;let a=i.properties.geometryId,o=e(r,a);if(o.isErr())return o}return pr(!0)},HO=U.Object({path:U.String({format:"uri",description:"The path to the image. This will be a remote URL."}),width:U.Number({minimum:0,description:"The width of the image when represented on the map, in meters."}),height:U.Number({minimum:0,description:"The height of the image when represented on the map, in meters."}),rotation:U.Number({minimum:0,maximum:360,description:"Rotation in degrees, about the center of the image. North is 0, east is 90."})},{$id:"BaseFloorImageProperties"}),hee=U.Intersect([U.Ref(HO),L0],{$id:"AnchoredFloorImageProperties"}),dee=U.Intersect([U.Ref(HO),U.Object({verticalOffset:U.Number({minimum:0,description:"How high to position the image, in meters, relative to the ground plane."})})],{$id:"FloatingFloorImageProperties"}),pee=U.Union([hee,dee],{$id:"FloorImageProperties"}),fee=Kc(U.Ref(Jc),pee,{$id:"FloorImageFeature"}),mee=sf(U.Ref(fee),{$id:"FloorImageCollection"}),JNe=U.Object({floorImages:Wo(U.Record(la,U.Ref(mee),{additionalProperties:!1}))},{$id:"FloorImagesExtensionSchema"}),KNe=/^floorImages\/(.*)\.geojson$/,QNe={name:"ext:floor-images",schema:JNe,intoBundle:function*(t){if(t.floorImages!=null)for(let e of Xi(t.floorImages))yield{path:"floorImages/".concat(e,".geojson"),contents:t.floorImages[e]}},fromBundle:(t,e,r)=>{var n;let i=(n=t.match(KNe))==null?void 0:n[1];if(i)return{floorImages:{[i]:r(e)}}},references:[HO,hee,dee,pee,fee,mee],integrityCheck:YNe};C();C();var e$e=t=>{if(t.kinds==null)return pr(!0);let e=th(t);for(let[r,n]of aa(t.kinds))if(n!=null)for(let i of Xi(n)){let a=e(r,i);if(a.isErr())return a}return pr(!0)},{schema:t$e}=lf(["room","hallway","wall","object","poi","area","window"],{$id:"Kind"}),gee=t$e,yee=Wo(U.Record(Qc,U.Ref(gee),{additionalProperties:!1,$id:"GeometryKinds"})),r$e=U.Object({kinds:Wo(U.Record(la,U.Ref(yee),{additionalProperties:!1}))},{$id:"KindsExtensionSchema"}),n$e=/^kinds\/(.*)\.json$/,i$e={name:"ext:kinds",schema:r$e,intoBundle:function*(t){if(t.kinds!=null)for(let e of Xi(t.kinds))yield{path:"kinds/".concat(e,".json"),contents:t.kinds[e]}},fromBundle:(t,e,r)=>{var n;let i=(n=t.match(n$e))==null?void 0:n[1];if(i)return{kinds:{[i]:r(e)}}},references:[gee,yee],integrityCheck:e$e};C();C();C();var nA;(function(t){t.UnknownNeighbor="UnknownNeighbor",t.SelfReference="SelfReference"})(nA||(nA={}));var a$e=t=>{if(t.nodes==null)return pr(!0);let e=ms(t.nodes,i=>i.properties.id,"nodes");if(e.isErr())return e;let r=th(t),n=JQ(t);for(let[i,a]of aa(t.nodes)){if(a==null)continue;let o=new Set(a.features.map(s=>s.properties.id));for(let[s,l]of a.features.entries()){for(let u of l.properties.geometryIds){let c=r(i,u);if(c.isErr())return c}for(let[u,c]of l.properties.neighbors.entries()){if(!o.has(c.id))return hr({kind:nA.UnknownNeighbor,properties:{floorId:i,nodeId:l.properties.id,neighborId:c.id}});if(c.id===l.properties.id)return hr({kind:nA.SelfReference,properties:{floorId:i,nodeId:l.properties.id}});let h=CT(c.flags,n,'nodes["'.concat(i,'"].features[').concat(s,"].properties.neighbors[").concat(u,"]"));if(h.isErr())return h}}}return pr(!0)},XO=qo("n","NodeId"),vee=U.Intersect([U.Object({id:U.Ref(XO,{description:"The unique identifier for the node."}),extraCost:U.Number({minimum:0,description:"The extra cost to traverse to the node, above the straight-line distance."})}),eee],{$id:"NodeNeighbor"}),_ee=U.Intersect([U.Object({id:U.Ref(XO,{description:"The unique identifier for the node."}),neighbors:U.Array(U.Ref(vee),{description:"The neighbors of the node."})}),FO],{$id:"NodeProperties"}),xee=Kc(U.Ref(Jc),_ee,{$id:"NodeFeature"}),bee=sf(U.Ref(xee),{$id:"NodeCollection"}),o$e=U.Object({nodes:Wo(U.Record(la,U.Ref(bee),{additionalProperties:!1}))},{$id:"NodesExtensionSchema"}),s$e=/^nodes\/(.*)\.(geo)?json$/,l$e={name:"ext:nodes",schema:o$e,intoBundle:function*(t){if(t.nodes!=null)for(let e of Xi(t.nodes))yield{path:"nodes/".concat(e,".geojson"),contents:t.nodes[e]}},fromBundle:(t,e,r)=>{var n;let i=(n=t.match(s$e))==null?void 0:n[1];if(i)return{nodes:{[i]:r(e)}}},references:[XO,vee,_ee,xee,bee],integrityCheck:a$e};C();C();C();var TT;(function(t){t.FloorInFloorStackError="FloorInFloorStackError"})(TT||(TT={}));var u$e=t=>{if(t.outdoors==null)return pr(!0);let e=B_(t);for(let r of t.outdoors.floors){let n=e(r);if(n.isErr())return n;if(t.floorStacks!=null){for(let i of t.floorStacks)if(i.floors.includes(r))return hr({kind:TT.FloorInFloorStackError,properties:{floorId:r,floorStackId:i.id}})}}return pr(!0)},wee=U.Object({floors:U.Array(U.Ref(la),{uniqueItems:!0,description:"A list of floor IDs that should be considered to contain outdoor features."})},{$id:"Outdoors"}),c$e=U.Object({outdoors:U.Ref(wee)},{$id:"OutdoorsExtensionSchema"}),PR="outdoors.json",h$e={name:"ext:outdoors",schema:c$e,intoBundle:function*(t){t.outdoors!=null&&(yield{path:PR,contents:t.outdoors})},fromBundle:(t,e,r)=>{if(t===PR)return{outdoors:r(e)}},references:[wee],integrityCheck:u$e};C();C();C();var PT;(function(t){t.TilesetDuplicateKeyError="TilesetDuplicateKeyError"})(PT||(PT={}));var d$e=t=>{if(t.tileset==null)return pr(!0);let e=new Set;if(e.add(t.tileset.default.key),t.tileset.others)for(let r of t.tileset.others){if(e.has(r.key))return hr({kind:PT.TilesetDuplicateKeyError,properties:{key:r.key}});e.add(r.key)}return pr(!0)},DT=U.Object({key:U.String({minLength:1,description:"Unique identifier for the tileset style."}),name:U.String({minLength:1,description:"Display name of the tileset style."}),url:U.String({format:"uri",description:"URL of the tileset style."})},{$id:"TilesetStyle",description:"A tileset style definition."}),Aee=U.Object({default:U.Ref(DT,{description:"The default tileset style, which should be used."}),others:U.Optional(U.Array(U.Ref(DT,{description:"Additional tileset styles that can be used."})))},{$id:"TilesetCollection"}),p$e=U.Object({tileset:U.Ref(Aee)},{$id:"TilesetExtensionSchema"}),f$e={name:"ext:mvf-tileset",schema:p$e,intoBundle:function*(t){t.tileset!=null&&(yield{path:"tileset.json",contents:t.tileset})},fromBundle:(t,e,r)=>{if(t==="tileset.json")return{tileset:r(e)}},references:[DT,Aee],integrityCheck:d$e};C();var See=U.Object({},{$id:"WalkableProperties"}),Eee=U.Object({},{$id:"NonWalkableProperties"}),Iee=Wo(U.Record(Qc,U.Ref(See),{$id:"WalkableGeometries",additionalProperties:!1})),Cee=Wo(U.Record(Qc,U.Ref(Eee),{$id:"NonWalkableGeometries",additionalProperties:!1})),m$e=U.Object({walkable:Wo(U.Record(la,U.Ref(Iee),{additionalProperties:!1})),nonwalkable:Wo(U.Record(la,U.Ref(Cee),{additionalProperties:!1}))},{$id:"TraversabilitySchema"}),g$e=/^walkable\/(.*)\.json$/,y$e=/^nonwalkable\/(.*)\.json$/,v$e={name:"ext:mvf-traversability",schema:m$e,intoBundle:function*(t){if(t.walkable!=null)for(let e of Xi(t.walkable))yield{path:"walkable/".concat(e,".json"),contents:t.walkable[e]};if(t.nonwalkable!=null)for(let e of Xi(t.nonwalkable))yield{path:"nonwalkable/".concat(e,".json"),contents:t.nonwalkable[e]}},fromBundle:(t,e,r)=>{var n,i;let a=(n=t.match(g$e))==null?void 0:n[1];if(a!=null)return{walkable:{[a]:r(e)}};let o=(i=t.match(y$e))==null?void 0:i[1];if(o!=null)return{nonwalkable:{[o]:r(e)}}},references:[See,Eee,Iee,Cee]};C();C();function DR(t){return t.replace(/^g_/,"s_")}function kT(t){return t.replace(/^g_/,"o_")}function _$e(t){return t.replace(/^g_/,"w_")}function x$e(t){return t.replace(/^loci_/,"eli_")}function yb(t){return t.replace(/^loc_/,"el_")}function pI(t){return t.replace(/^lcat_/,"ec_")}function b$e(t){return t.replace(/^g_/,"ar_")}function w$e(t){return t.replace(/^n_/,"s_")}function A$e(t,e,r){switch(t.geometry.type){case"MultiPoint":case"MultiLineString":case"MultiPolygon":{let n=[],i=0,a=t.geometry.type.replace("Multi","");for(let o of t.geometry.coordinates)n.push(lt(ae({},t),{geometry:{type:a,coordinates:o},properties:lt(ae({},t.properties),{id:"".concat(e,"-").concat(i++),kind:r})}));return n}default:return[lt(ae({},t),{properties:lt(ae({},t.properties),{id:e,kind:r})})]}}function Mf(t,e,r,n){let i=new Map;for(let{feature:a,floorId:o}of t){let s=a.properties.id,l=n.get(s);if(e.has(s)){let u=A$e(a,r(s),l),c=u.map(d=>d.properties.id),h=c.map(d=>({geometryId:d,floorId:o}));i.set(s,{ids:c,features:u,anchors:h})}}return i}function S$e(t){var e,r;let n={space:new Map,obstruction:new Map,area:new Map,window:new Map,object:new Map};if(!t.geometry)return n;let i=E$e(t),a=aa(t.geometry).flatMap(([h,d])=>{var p;return((p=d?.features)!=null?p:[]).map(m=>({feature:m,floorId:h}))}).flat(),o=new Set(Object.values((e=t.walkable)!=null?e:{}).filter(h=>h!==void 0).flatMap(Xi)),s=new Set(Object.values((r=t.nonwalkable)!=null?r:{}).filter(h=>h!==void 0).flatMap(Xi)),l=new Set(Array.from(i.entries()).filter(([h,d])=>d==="area").map(([h])=>h)),u=new Set(Array.from(i.entries()).filter(([h,d])=>d==="object").map(([h])=>h)),c=new Set(Array.from(i.entries()).filter(([h,d])=>d==="window").map(([h])=>h));return o.size>0&&(n.space=Mf(a,o,DR,i)),s.size>0&&(n.obstruction=Mf(a,s,kT,i)),l.size>0&&(n.area=Mf(a,l,b$e,i)),u.size>0&&(n.object=Mf(a,u,kT,i)),c.size>0&&(n.window=Mf(a,c,_$e,i)),o.size===0&&s.size===0&&l.size===0&&(n.space=Mf(a,new Set(a.map(h=>h.feature.properties.id)),DR,i)),n}function E$e(t){var e,r,n;let i=new Map(Object.values((e=t.kinds)!=null?e:{}).filter(a=>a!==void 0).flatMap(aa));for(let a of(n=(r=t.connections)==null?void 0:r.filter(o=>o.type!=="door"))!=null?n:[]){for(let o of a.entrances)i.set(o.geometryId,"connection.".concat(a.type));for(let o of a.exits)i.set(o.geometryId,"connection.".concat(a.type))}return i}function I$e(t){if(!t||t.length===0)return[];let e=Math.max(...t.map(r=>r.length));return t.reduce((r,n)=>r.map((i,a)=>{var o;return i|((o=n[a])!=null?o:0)}),Array(e).fill(0))}function C$e(t){var e;let{nodesByGeometryId:r,incomingEdgesByNodeId:n,nodesById:i}=M$e(t),a=S$e(t),o=T$e(t),s=(e=t.navigationFlags)!=null?e:{};return{geometryMaps:a,nodesByGeometryId:r,geometryFeatureById:o,navigationFlags:s,incomingEdgesByNodeId:n,nodesById:i}}function M$e(t){var e,r,n;let i=new Map,a=new Map,o=new Map;for(let s of Object.values((e=t.nodes)!=null?e:{}))for(let l of(r=s?.features)!=null?r:[]){if(o.set(l.properties.id,l),l.properties.geometryIds.length>0)for(let u of l.properties.geometryIds){let c=(n=i.get(u))!=null?n:[];c.push(l.properties.id),i.set(u,c)}if(l.properties.neighbors.length>0)for(let u of l.properties.neighbors){let c=a.get(u.id);c!=null?c.push(u):a.set(u.id,[u])}}return{nodesByGeometryId:i,incomingEdgesByNodeId:a,nodesById:o}}function T$e(t){var e,r;let n=new Map;for(let i of Object.values((e=t.geometry)!=null?e:{}))for(let a of(r=i?.features)!=null?r:[])n.set(a.properties.id,a);return n}C();function P$e(t,e){if(!t.annotations||!t.annotationSymbols||!t.geometry)return{};let r={};for(let[n,i]of aa(t.annotations)){if(!i||i.length===0||!t.geometry[n]||t.geometry[n].features.length===0)continue;let a=new Map(t.geometry[n].features.map(s=>[s.properties.id,s])),o={type:"FeatureCollection",features:[]};for(let s of i){let l=a.get(s.geometryId);if(!l||l.geometry.type!=="Point")continue;let u={id:s.id,externalId:s.externalId,symbolId:s.symbolKey};o.features.push({type:"Feature",geometry:l.geometry,properties:u})}r[n]=o}return{annotation:r}}C();function D$e(t,{nodesByGeometryId:e}){var r,n,i,a,o,s,l;let u={"connection.json":[],entrance:{}},c=(r=t.navigationFlags)==null?void 0:r[CR.accessible],h=(n=t.navigationFlags)==null?void 0:n[CR.outdoors],d=new Map(Object.values((i=t.geometry)!=null?i:{}).flatMap(p=>{var m;return(m=p?.features)!=null?m:[]}).map(p=>[p.properties.id,p]));for(let p of(a=t.connections)!=null?a:[]){if(Mee(p,d)&&!k$e(p)){let w=O$e(p,d,e,h);for(let[b,A]of w)u.entrance[b]||(u.entrance[b]={type:"FeatureCollection",features:[]}),u.entrance[b].features.push(A);continue}let m=c!=null&&p.entrances.some(w=>R1(w,c))&&p.exits.some(w=>R1(w,c)),y=Array.from(new Set([...p.entrances.map(w=>e.get(w.geometryId)),...p.exits.map(w=>e.get(w.geometryId))].flat().filter(w=>w!=null))),v=I$e([...p.entrances.map(w=>w.flags),...p.exits.map(w=>w.flags)]),_={id:p.id,externalId:(s=(o=p.details)==null?void 0:o.externalId)!=null?s:"",type:p.type,accessible:m,nodes:y,flags:v};(l=p.details)!=null&&l.name&&(_.details={name:p.details.name}),p.extra&&(_.extra=p.extra),u["connection.json"].push(_)}return u}function Mee(t,e){return t.type==nee.door&&t.entrances.every(r=>{let n=e.get(r.geometryId);return n?.geometry.type==="LineString"})}function k$e(t){return t.entrances.length===0||t.exits.length===0?!1:new Set([...t.entrances.map(e=>e.floorId),...t.exits.map(e=>e.floorId)]).size>=2}function O$e(t,e,r,n){var i,a;if(t.type!==nee.door)return[];let o=[];for(let s of t.entrances){let l=e.get(s.geometryId);if(l?.geometry.type==="LineString"){let u={type:"Feature",geometry:l.geometry,properties:{id:t.id,externalId:(a=(i=t.details)==null?void 0:i.externalId)!=null?a:"",isExterior:B$e(t,n)}},c=t.details;c&&(u.properties.details={name:c.name,description:c.description},c.icon&&(u.properties.details.images=[{url:c.icon,altText:"".concat(c.name," icon")}]));let h=r.get(s.geometryId);h&&h.length>0&&(u.properties.node=h[0]),o.push([s.floorId,u])}}return o}function B$e(t,e){return t.entrances.some(r=>R1(r,e))||t.exits.some(r=>R1(r,e))}C();function z$e(t,{geometryMaps:e,nodesByGeometryId:r}){var n,i,a,o,s,l,u,c,h,d,p,m,y,v,_,w,b,A,E,M,P,k,D,O,B,L,R,T,N,$,V,G,ee,ie,me,Me,Ae,le,_e,Le,Se,Ue,Y,we,q,oe,ce,X;let ke={categories:[],locations:[],locationInstances:[],layers:[],venue:{slug:"",name:"",externalId:"",defaultLanguage:{name:"English",code:"en"},languages:[]}},Ce=(n=t.manifest)==null?void 0:n.features[0];Ce&&(ke.venue.defaultFloor=Ce.properties.defaultFloor,ke.venue.tzid=Ce.properties.tzid,ke.venue.name=Ce.properties.name,ke.venue.defaultLanguage={name:(i=Ce.properties.language)!=null?i:"English",code:(a=Ce.properties.language)!=null?a:"en"});let Ee=(o=t.cms)==null?void 0:o.venue;Ee&&(ke.venue=lt(ae({},ke.venue),{slug:Ee.slug,name:(u=(l=(s=Ee.details)==null?void 0:s.name)!=null?l:ke.venue.name)!=null?u:Ce.properties.name,externalId:(h=(c=Ee.details)==null?void 0:c.externalId)!=null?h:"",defaultLanguage:Ee.defaultLanguage,languages:(d=Ee.languages)!=null?d:[],countrycode:Ee.countrycode,coverImage:Ee.coverImage,logo:Ee.logo,icon:(p=Ee.details)==null?void 0:p.icon,extra:Ee.extra,mappedinWebUrl:Ee.mappedinWebUrl,operationHours:Ee.operationHours,topLocations:Ee.topLocations}));let Ne=new Map,st=(m=t.locations)!=null?m:[],Ke=(v=(y=t.cms)==null?void 0:y.locations)!=null?v:[],J=(w=(_=t.cms)==null?void 0:_.categories)!=null?w:[],Z=new Map((J??[]).map(He=>[He.categoryId,He]));if(st.length>0){let He=new Map(Ke.map(Ge=>[Ge.locationId,Ge]));for(let Ge of st){let je=(b=He.get(Ge.id))!=null?b:{};if(Ge){let tt=Ge.details,Ze={id:je?.cmsId!==void 0?"el_".concat(je?.cmsId):yb(Ge.id),name:tt.name,externalId:(A=tt.externalId)!=null?A:"",type:(E=je.type)!=null?E:"location",sortOrder:(M=je.sortOrder)!=null?M:0,amenity:je.amenity,description:tt.description,extra:Ge.extra,links:Ge.links,operationHours:Ge.openingHours,gallery:je.gallery,logo:Ge.logo,shortName:tt.shortName,picture:je.picture,showFloatingLabelWhenImagePresent:je.showFloatingLabelWhenImagePresent,showLogo:je.showLogo,siblingGroups:je.siblingGroups,states:je.states,tags:je.tags,spaces:[],nodes:[],polygons:[]};if(Ge.phone&&(Ze.phone={number:Ge.phone}),je.primaryCategory){let vt=Z.get(je.primaryCategory);vt&&(Ze.primaryCategory=vt.id)}let At=kR(Ge.social);Ge.website&&(At.website=Ge.website.url),Ze.social=At;for(let vt of Ge.geometryAnchors){let Kt=e.space.get(vt.geometryId),he=e.obstruction.get(vt.geometryId),ct=Kt??he;if(ct){let qe=new Set(ct.features.filter(mt=>mt.geometry.type==="Polygon").map(mt=>mt.properties.id));for(let mt of ct.anchors)Kt!=null&&ct===Kt&&Ze.spaces.push({floor:mt.floorId,id:mt.geometryId}),qe.has(mt.geometryId)&&Ze.polygons.push({map:mt.floorId,id:mt.geometryId})}let De=r.get(vt.geometryId);for(let qe of De??[])Ze.nodes.push({map:vt.floorId,id:qe})}ke.locations.push(Ze);for(let vt of Ge.categories)Ne.set(vt,[...(P=Ne.get(vt))!=null?P:[],Ge.id])}}}let fe=(D=(k=t.cms)==null?void 0:k.locationInstances)!=null?D:[],Fe=t.locationInstances;if(Fe){let He=new Map(fe.map(je=>[je.locationInstanceId,je])),Ge=[];for(let je of Fe){let tt=(O=He.get(je.id))!=null?O:{};if(je){let Ze={id:x$e(je.id),parent:(B=tt.parentId)!=null?B:yb(je.parentId),name:(L=je.details)==null?void 0:L.name,externalId:(R=je.details)==null?void 0:R.externalId,type:tt.type,sortOrder:tt.sortOrder,amenity:tt.amenity,description:(T=je.details)==null?void 0:T.description,extra:je.extra,links:je.links,operationHours:je.openingHours,gallery:tt.gallery,picture:tt.picture,showFloatingLabelWhenImagePresent:tt.showFloatingLabelWhenImagePresent,showLogo:tt.showLogo,siblingGroups:tt.siblingGroups,states:tt.states,tags:tt.tags,logo:je.logo,shortName:(N=je.details)==null?void 0:N.shortName};je.phone&&(Ze.phone={number:je.phone});let At=kR(($=je.social)!=null?$:[]);if(je.website&&(At.website=je.website.url),Object.keys(At).length>0&&(Ze.social=At),(V=je.geometryAnchors)!=null&&V.length){let vt=je.geometryAnchors.flatMap(Kt=>{var he,ct;return(ct=(he=e.space.get(Kt.geometryId))==null?void 0:he.anchors)!=null?ct:[]});vt.length>0&&(Ze.spaces=vt.map(Kt=>({floor:Kt.floorId,id:Kt.geometryId})))}if(je.geometryAnchors){Ze.spaces=[],Ze.polygons=[],Ze.nodes=[];for(let vt of je.geometryAnchors){let Kt=e.space.get(vt.geometryId);if(Kt){let ct=new Set(Kt.features.filter(De=>De.geometry.type==="Polygon").map(De=>De.properties.id));for(let De of Kt.anchors)Ze.spaces.push({floor:De.floorId,id:De.geometryId}),ct.has(De.geometryId)&&Ze.polygons.push({map:De.floorId,id:De.geometryId})}let he=r.get(vt.geometryId);for(let ct of he??[])Ze.nodes.push({map:vt.floorId,id:ct})}}Ge.push(Ze)}}Ge.length>0&&(ke.locationInstances=Ge)}let Ve=t.locationCategories;if(Ve){let He=[],Ge=new Map(Ve.map(At=>[At.id,At])),je=new Map((J??[]).map(At=>[At.categoryId,At])),tt=new Map;for(let At of Ve){let vt=Ge.get(At.parent);if(vt){let Kt=(G=tt.get(vt.id))!=null?G:[];Kt.push(At.id),tt.set(vt.id,Kt)}}for(let At of Ve){let vt=je.get(At.id);if(At){let Kt=((ee=tt.get(At.id))!=null?ee:[]).map(pI),he={id:pI(At.id),name:At.details.name,externalId:(ie=At.details.externalId)!=null?ie:"",sortOrder:(me=vt?.sortOrder)!=null?me:0,children:Kt,locations:((Me=Ne.get(At.id))!=null?Me:[]).map(yb),icon:At.details.icon,picture:vt?.picture,color:vt?.color,extra:At.extra,iconFromDefaultList:vt?.iconFromDefaultList};He.push(he)}}ke.categories=He;let Ze={};for(let At of st)Ze[yb(At.id)]=At.categories.map(pI).filter(vt=>vt!==void 0);ke.categoryPriorities=Ze}let ze={};for(let[He,Ge]of Object.entries((Ae=t.defaultStyle)!=null?Ae:{}))if(Ge.buffer){let je=Ge.geometryAnchors.flatMap(tt=>{var Ze,At;return(At=(Ze=e.space.get(tt.geometryId))==null?void 0:Ze.anchors)!=null?At:[]});ze[He]={edgeOffset:Ge.buffer,geometryAnchors:je}}Object.keys(ze).length>0&&(ke.enterpriseStyles=ze);let Tt=new Map;for(let He of Object.values((_e=(le=t.cms)==null?void 0:le.layers)!=null?_e:{}))if(He)for(let[Ge,je]of aa(He)){if(typeof je!="string")continue;let tt=(Le=Tt.get(je))!=null?Le:{name:je,id:"ely_".concat(je),spaces:[]};tt.spaces.push(...(Ue=(Se=e.space.get(Ge))==null?void 0:Se.anchors.map(Ze=>({floorId:Ze.floorId,spaceId:Ze.geometryId})))!=null?Ue:[]),Tt.set(je,tt)}Tt.size>0&&(ke.layers=Array.from(Tt.values()));let ft=[];for(let He of Object.values((we=(Y=t.cms)==null?void 0:Y.textures)!=null?we:{}))for(let Ge of He){let je=(q=e.space.get(Ge.geometryId))==null?void 0:q.anchors;!je||je.length<1||Ge.face==="unknown"||Ge.surface==="unknown"||ft.push({repeat:Ge.repeat,offset:Ge.offset,rotation:Ge.rotation,path:Ge.path,face:Ge.face,surface:Ge.surface,bounds:Ge.bounds,geometryAnchors:je})}ft.length>0&&(ke.textures=ft);let St={};for(let[He,Ge]of Object.entries((ce=(oe=t.cms)==null?void 0:oe.floorText)!=null?ce:{})){let je={type:"FeatureCollection",features:[]};for(let tt of Ge.features){if(tt.properties.align==="unknown")continue;let Ze={align:tt.properties.align,color:tt.properties.color,fontFamily:tt.properties.fontFamily,fontSize:tt.properties.fontSize,rotation:tt.properties.rotation,text:tt.properties.text,visible:tt.properties.visible};"geometryId"in tt.properties?Ze.geometryId=tt.properties.geometryId:Ze.verticalOffset=tt.properties.verticalOffset,je.features.push({type:"Feature",geometry:tt.geometry,properties:Ze})}je.features.length>0&&(St[He]=je)}Object.keys(St).length>0&&(ke.floorText=St);let nr={enterprise:ke};if((X=t.cms)!=null&&X.textAreas){let He={};for(let[Ge,je]of aa(t.cms.textAreas)){let tt={type:"FeatureCollection",features:[]};for(let Ze of je.features){if(Ze.properties.align==="unknown")continue;let At={align:Ze.properties.align,maxWidth:Ze.properties.maxWidth,maxHeight:Ze.properties.maxHeight,rotation:Ze.properties.rotation};"geometryId"in Ze.properties?At.anchorId=Ze.properties.geometryId:At.verticalOffset=Ze.properties.verticalOffset;let vt={type:"Feature",geometry:Ze.geometry,properties:At};tt.features.push(vt)}He[Ge]=tt}nr.textAreas=He}return nr}var F$e=["facebook","instagram","twitter"];function kR(t){let e={};for(let{name:r,url:n}of t){let i=r.toLowerCase();F$e.includes(i)&&(e[i]=n)}return e}C();var R$e=t=>"fc_".concat(t.slice(3));function L$e(t,{geometryMaps:e}){if(!t.facade)return{};let r={},n={};for(let[i,a]of aa(t.facade))if(a)for(let o of Object.values(a)){let{floorStackId:s,geometryIds:l}=o,u=R$e(s);n[s]!=null||(n[s]={id:u,spaces:[]}),n[s].spaces.push(...l.map(c=>{var h,d;return{floorId:i,spaceId:(d=(h=e.space.get(c))==null?void 0:h.ids[0])!=null?d:""}}))}return Object.keys(n).length>0&&(r.facade=n),r}C();function N$e(t,e={}){var r,n,i,a,o,s,l,u,c,h,d,p;let m={type:"FeatureCollection",features:[]},y=[];for(let v of t.floors.features)y.push({id:v.properties.id,externalId:(n=(r=v.properties.details)==null?void 0:r.externalId)!=null?n:"",elevation:v.properties.elevation,name:(a=(i=v.properties.details)==null?void 0:i.name)!=null?a:"",shortName:(s=(o=v.properties.details)==null?void 0:o.shortName)!=null?s:"",subtitle:v.properties.subtitle,maxHeight:v.properties.maxHeight}),m.features.push({type:"Feature",geometry:v.geometry,properties:{id:v.properties.id,externalId:(u=(l=v.properties.details)==null?void 0:l.externalId)!=null?u:"",elevation:v.properties.elevation,name:(h=(c=v.properties.details)==null?void 0:c.name)!=null?h:"",shortName:(p=(d=v.properties.details)==null?void 0:d.shortName)!=null?p:"",subtitle:v.properties.subtitle,maxHeight:v.properties.maxHeight}});return{"floor.geojson":m,"map.geojson":y}}C();function $$e(t,{geometryMaps:e}){var r,n,i,a,o;let s={},l={};for(let[u,c]of aa((r=t.floorImages)!=null?r:{})){let h={features:[],type:"FeatureCollection"};for(let d of(n=c?.features)!=null?n:[])if("verticalOffset"in d.properties)h.features.push(d);else{let p=d.properties,{geometryId:m}=p,y=yu(p,["geometryId"]),v=(o=(i=e.space.get(m))==null?void 0:i.ids[0])!=null?o:(a=e.obstruction.get(m))==null?void 0:a.ids[0];if(!v)continue;let _={geometry:d.geometry,properties:lt(ae({},y),{anchorId:v}),type:d.type};h.features.push(_)}l[u]=h}return Object.keys(l).length>0&&(s.floorImages=l),s}C();function U$e(t,e={}){var r,n,i,a,o,s,l;let u=[];for(let c of(r=t?.floorStacks)!=null?r:[]){let h={id:c.id,floors:c.floors,maps:c.floors,externalId:(i=(n=c.details)==null?void 0:n.externalId)!=null?i:"",name:(o=(a=c.details)==null?void 0:a.name)!=null?o:"",shortName:(l=(s=c.details)==null?void 0:s.shortName)!=null?l:"",type:"Building"};c.defaultFloor&&(h.defaultFloor=c.defaultFloor),u.push(h)}if(t.outdoors&&t.outdoors.floors.length>0){let c={id:"outdoors",floors:t.outdoors.floors,maps:t.outdoors.floors,type:"Outdoor",name:"Outdoors",externalId:"outdoors"};u.push(c)}return{"floorstack.json":u,"mapstack.geojson":u}}C();C();var j$e=Zt(yPe(),1),V$e=t=>{let e=t.geometry.coordinates[0],r=0;for(let n=0;n<e.length-1;n++)r+=e[n][0]*e[n+1][1]-e[n+1][0]*e[n][1];return Math.abs(r/2)},G$e=(t,e)=>{let[r,n]=t,i=e.geometry.coordinates[0],a=!1;for(let o=0,s=i.length-1;o<i.length;s=o++){let[l,u]=i[o],[c,h]=i[s];u>n!=h>n&&r<(c-l)*(n-u)/(h-u)+l&&(a=!a)}return a},Z$e=t=>{let e=t.geometry.coordinates[0],r=0,n=0;for(let i=0;i<e.length-1;i++)r+=e[i][0],n+=e[i][1];return{geometry:{coordinates:[r/(e.length-1),n/(e.length-1)]}}},W$e=t=>{let e=V$e(t),r=Number.isFinite(e)?Math.max(e,1):1;return Math.sqrt(r)*1e-6},qO=t=>{try{let e=Z$e(t).geometry.coordinates;if(!G$e(e,t)){let r=(0,j$e.default)(t.geometry.coordinates,W$e(t));return pr([r[0],r[1]])}return pr(e)}catch{return hr(new Error("Unable to calculate center of polygon"))}};function YO(t){var e;return((e=t?.geometry)==null?void 0:e.type)==="Polygon"}function H$e(t,{geometryMaps:e,nodesByGeometryId:r,nodesById:n}){var i,a,o,s,l,u,c,h,d,p;let m=J$e(t.defaultStyle),y={},v={},_={},w={};for(let A of Xi(t.geometry)){let E=t.geometry[A];if(!E)continue;let M=[],P=[],k=[],D=[];for(let O of E.features){let B=O.properties.id,L=m.has(B),R=(i=r.get(B))!=null?i:[];for(let T of(o=(a=e.space.get(B))==null?void 0:a.features)!=null?o:[])M.push(OR(T,R));for(let T of(l=(s=e.obstruction.get(B))==null?void 0:s.features)!=null?l:[])if(P.push(X$e(T,L)),e.object.has(B)){let N=(u=r.get(B))!=null?u:[],$=N.map(V=>n.get(V)).filter(V=>V!=null);for(let V of $){let G=OR({geometry:V.geometry,properties:{id:w$e(V.properties.id),kind:"desk-entrance",details:{externalId:kT(B)}}},N);M.push(G)}}for(let T of(h=(c=e.area.get(B))==null?void 0:c.features)!=null?h:[])k.push(q$e(T,R));for(let T of(p=(d=e.window.get(B))==null?void 0:d.features)!=null?p:[])D.push(Y$e(T))}M.length>0&&(y[A]={type:"FeatureCollection",features:M.filter(O=>O!==null)}),P.length>0&&(v[A]={type:"FeatureCollection",features:P.filter(O=>O!==null)}),k.length>0&&(_[A]={type:"FeatureCollection",features:k.filter(O=>O!==null)}),D.length>0&&(w[A]={type:"FeatureCollection",features:D.filter(O=>O!==null)})}let b={space:y,obstruction:v};return Object.keys(_).length>0&&(b.area=_),Object.keys(w).length>0&&(b.window=w),b}function OR(t,e){var r,n;switch(t.geometry.type){case"MultiPoint":case"MultiLineString":case"MultiPolygon":return null}let i={type:"Feature",geometry:t.geometry,properties:{destinationNodes:e,id:t.properties.id,externalId:(n=(r=t.properties.details)==null?void 0:r.externalId)!=null?n:"",kind:t.properties.kind}};return t.properties.details&&(i.properties.details={name:t.properties.details.name,description:t.properties.details.description,images:t.properties.details.icon?[{url:t.properties.details.icon,altText:t.properties.details.name?"".concat(t.properties.details.name," icon"):"icon"}]:void 0}),YO(i)&&(i.properties.center=qO(i).unwrapOr(void 0)),i}function X$e(t,e){var r,n;switch(t.geometry.type){case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"Point":return null}let i=t.properties,a={type:"Feature",geometry:t.geometry,properties:{id:i.id,externalId:(n=(r=i.details)==null?void 0:r.externalId)!=null?n:"",entrances:[],kind:i.kind,footprintComponent:e}};return YO(a)&&(a.properties.center=qO(a).unwrapOr(void 0)),i.details&&(a.properties.details={name:i.details.name,description:i.details.description,images:i.details.icon?[{url:i.details.icon,altText:i.details.name?"".concat(i.details.name," icon"):"icon"}]:void 0}),a}function q$e(t,e){var r,n;if(t.geometry.type!=="Polygon")return null;let i=t.properties,a={type:"Feature",geometry:t.geometry,properties:{id:i.id,externalId:(n=(r=i.details)==null?void 0:r.externalId)!=null?n:"",destinationNodes:e}};return YO(a)&&(a.properties.center=qO(a).unwrapOr(void 0)),i.details&&(a.properties.details={name:i.details.name,description:i.details.description,images:i.details.icon?[{url:i.details.icon,altText:i.details.name?"".concat(i.details.name," icon"):"icon"}]:void 0}),a}function Y$e(t){return t.geometry.type!=="LineString"?null:{type:"Feature",geometry:t.geometry,properties:{id:t.properties.id}}}function J$e(t){var e,r;return new Set(((r=(e=t?.ExteriorWalls)==null?void 0:e.geometryAnchors)!=null?r:[]).map(n=>n.geometryId))}C();function K$e(t,{geometryMaps:e,geometryFeatureById:r}){var n,i,a,o,s,l,u,c,h,d,p,m,y;if(!t.locationCategories&&!t.locations)return{};let v={};if((n=t.locationCategories)!=null&&n.length){let _=[];for(let w of t.locationCategories){let b={id:w.id,name:w.details.name,icon:(i=w.details.icon)!=null?i:""};w.parent&&(b.parent=w.parent),_.push(b)}v["category.json"]=_}if((a=t.locations)!=null&&a.length){let _=Q$e(t,{geometryFeatureById:r}),w=[];for(let b of t.locations){let A={id:b.id,name:b.details.name,categories:b.categories,spaces:[],obstructions:[],areas:[],annotations:[],connections:[],entrances:[],links:b.links,openingHoursSpecification:(o=b.openingHours)!=null?o:[],pictures:b.images,social:b.social,description:b.details.description,externalId:b.details.externalId,icon:b.details.icon,logo:b.logo,phone:b.phone,website:b.website};w.push(A);for(let{geometryId:E,floorId:M}of b.geometryAnchors)A.spaces.push(...(l=(s=e.space.get(E))==null?void 0:s.ids.map(P=>({id:P,floor:M})))!=null?l:[]),A.obstructions.push(...(c=(u=e.obstruction.get(E))==null?void 0:u.ids.map(P=>({id:P,floor:M})))!=null?c:[]),A.areas.push(...(d=(h=e.area.get(E))==null?void 0:h.ids.map(P=>({id:P,floor:M})))!=null?d:[]),A.entrances.push(...(p=_.entrancesByGeometryId.get(E))!=null?p:[]),A.connections.push(...(m=_.connectionsByGeometryId.get(E))!=null?m:[]),A.annotations.push(...(y=_.annotationsByGeometryId.get(E))!=null?y:[])}v["location.json"]=w}return v}function Q$e(t,{geometryFeatureById:e}){var r,n,i;let a={annotationsByGeometryId:new Map,connectionsByGeometryId:new Map,entrancesByGeometryId:new Map};if(t.annotations)for(let[o,s]of aa(t.annotations))for(let l of s??[]){let u=l.geometryId,c=l.id,h=(r=a.annotationsByGeometryId.get(u))!=null?r:[];h.push({floor:o,id:c}),a.annotationsByGeometryId.set(u,h)}if(t.connections)for(let o of t.connections){let s=Mee(o,e),l=Array.from(new Map([...o.entrances,...o.exits].map(u=>["".concat(u.geometryId,"_").concat(u.floorId),u])).values());for(let u of l){let c=u.geometryId;if(s){let h=(n=a.entrancesByGeometryId.get(c))!=null?n:[];h.push({floor:u.floorId,id:o.id}),a.entrancesByGeometryId.set(c,h)}else{let h=(i=a.connectionsByGeometryId.get(c))!=null?i:[];h.push(o.id),a.connectionsByGeometryId.set(c,h)}}}return a}C();function eUe(t,e){let r={features:[],type:"FeatureCollection"},n={"manifest.geojson":r},i=t.manifest;if(i.features.length>0){let a=i.features[0],o=a.properties,s={type:"Feature",geometry:a.geometry,properties:{folder_struct:[],version:"2.0.0",time:o.time,name:o.name,naturalBearing:o.naturalBearing,tzid:o.tzid,map:o.mapId,org_id:o.orgId,language:o.language}};r.features.push(s)}return n}C();function tUe(t,{geometryMaps:e,navigationFlags:r,incomingEdgesByNodeId:n}){var i,a,o,s,l,u;let c={"node.geojson":{type:"FeatureCollection",features:[]}},h=c["node.geojson"].features,d=rUe(t),p=nUe(t),m=iUe(t,p,d);for(let[y,v]of aa((i=t.nodes)!=null?i:{}))for(let _ of(a=v?.features)!=null?a:[]){let w=(o=e.space.get(_.properties.geometryIds[0]))==null?void 0:o.features[0],b=w?.geometry.type==="Point"&&(s=w?.properties.details)!=null&&s.externalId?w.properties.details.externalId:"",A=(l=n.get(_.properties.id))!=null?l:[],E=Object.keys(r??{}),M=[];for(let k of A)for(let D of E)R1(k,r[D])&&M.push(r[D]);let P={type:"Feature",geometry:_.geometry,properties:{id:_.properties.id,floor:y,space:_.properties.geometryIds.map(k=>{var D;return(D=e.space.get(k))==null?void 0:D.ids}).flat().filter(k=>k!==void 0),neighbors:[..._.properties.neighbors.map(k=>({id:k.id,weight:k.extraCost})),...(u=m.get(_.properties.id))!=null?u:[]],map:y,externalId:b,flags:M.length>0?aUe(M):void 0}};h.push(P)}return c}function rUe(t){var e,r;let n=new Map;for(let i of(r=(e=t.floors)==null?void 0:e.features)!=null?r:[])n.set(i.properties.id,i.properties.elevation);return n}function nUe(t){var e,r,n;let i=new Map;for(let a of Object.values((e=t.nodes)!=null?e:{}))for(let o of(r=a?.features)!=null?r:[])if(o.properties.geometryIds.length!==0)for(let s of o.properties.geometryIds){let l=(n=i.get(s))!=null?n:[];l.includes(o.properties.id)||(l.push(o.properties.id),i.set(s,l))}return i}function iUe(t,e,r){var n,i,a,o,s;let l=new Map;for(let u of(n=t.connections)!=null?n:[]){let c=u.exits.map(h=>{var d;return lt(ae({},h),{nodes:(d=e.get(h.geometryId))!=null?d:[]})});for(let h of u.entrances){let d=(i=e.get(h.geometryId))!=null?i:[];for(let p of d)for(let m of c){let y=Math.abs(((a=r.get(h.floorId))!=null?a:0)-((o=r.get(m.floorId))!=null?o:0))*u.floorCostMultiplier,v=(s=l.get(p))!=null?s:[];v.push(...m.nodes.filter(_=>_!==p).map(_=>({id:_,weight:y+u.entryCost}))),l.set(p,v)}}}return l}function aUe(t){if(t==null||t.length===0)return;let e=new Array(Math.max(...t.map(r=>r.index))+1).fill(0);for(let r of t)e[r.index]|=1<<r.bit;return e}C();function oUe(t,e){let r={};for(let n of t){let i=e.get(n);i&&(r[i]!=null||(r[i]=[]),r[i].push(n))}return r}function sUe(t,{geometryMaps:e}){var r,n,i;if(!t.defaultStyle)return{};let a={},o={};a["styles.json"]=o;let s=[...Array.from(e.space.values()).map(u=>u.features),...Array.from(e.obstruction.values()).map(u=>u.features)],l=new Map(s.flatMap(u=>u.map(c=>[c.properties.id,c.geometry.type])));for(let[u,c]of aa(t.defaultStyle)){let h=oUe(c.geometryAnchors.flatMap(d=>{var p,m,y,v;return[...(m=(p=e.space.get(d.geometryId))==null?void 0:p.ids)!=null?m:[],...(v=(y=e.obstruction.get(d.geometryId))==null?void 0:y.ids)!=null?v:[]]}),l);if(h.Point&&h.Point.length>0){let d={points:Array.from(h.Point.values()),showImage:((r=c.extra)==null?void 0:r.showImage)!==void 0?((n=c.extra)==null?void 0:n.showImage)===!0:c.opacity!==0};o["".concat(u,".Point")]=d}if(h.LineString&&h.LineString.length>0){let d={lineStrings:Array.from(h.LineString.values()),altitude:c.altitude,color:c.color,height:c.height,opacity:c.opacity,width:c.buffer};o["".concat(u,".LineString")]=d}if(h.Polygon&&h.Polygon.length>0){let d={polygons:Array.from(h.Polygon.values()),altitude:c.altitude,color:c.color,height:c.height,opacity:c.opacity};((i=c.extra)==null?void 0:i.showImage)!==void 0&&(d.showImage=c.extra.showImage===!0),o["".concat(u,".Polygon")]=d}}return a}var lUe=V9e().extendOptional(BNe).extendOptional(l$e).extendOptional(NNe).extendOptional(i$e).extendOptional(v$e).extendOptional(jNe).extendOptional(ZNe).extendOptional(h$e).extendOptional(f$e).extendOptional(QNe).extendOptional(qNe).extendOptional(eNe).extendOptional(aNe).extendOptional(MNe).build({cspSafe:!0}).expect("Invalid parser, this should never happen. Likely a bug in the MVFv2 library, or one of the extensions.");function uUe(t){let e=C$e(t),r=N$e(t,e),n=H$e(t,e),i=tUe(t,e),a=D$e(t,e),o=sUe(t,e),s=U$e(t,e),l=$$e(t,e),u=L$e(t,e),c=P$e(t),h=K$e(t,e),d=z$e(t,e),p=eUe(t);return ae(ae(ae(ae(ae(ae(ae(ae(ae(ae(ae(ae(ae(ae(ae({},t.tileset?{"tileset.json":t.tileset}:{}),t.navigationFlags?{"navigationFlags.json":t.navigationFlags}:{}),t.annotationSymbols?{"annotation-symbols.json":t.annotationSymbols}:{}),r),n),i),a),o),s),l),u),c),h),d),p)}function cUe(t){let e=lUe.decompressUnsafeSync(t);return e.isOk()?pr(uUe(e.value)):hr(e.error)}C();function JO(t){return t.endsWith("/")?t:"".concat(t,"/")}C();var KO="https://app.mappedin.com/",hUe="https://auth.mappedin.com/",Tee=Object.freeze({baseUri:"https://app.mappedin.com/",baseAuthUri:"https://app.mappedin.com/",analyticsBaseUri:"https://api-gateway.mappedin.com/track-analytics/a/",tileServerUri:"https://tiles-cdn.mappedin.com/styles/mappedin/style.json"}),dUe=Object.freeze(lt(ae({},Tee),{baseUri:"https://api-gateway.mappedin.com/",baseAuthUri:"https://auth.mappedin.com/"})),pUe=Object.freeze({baseUri:"https://api-gateway.eu.mappedin.com/",baseAuthUri:"https://auth.eu.mappedin.com/",analyticsBaseUri:"https://api-gateway.eu.mappedin.com/track-analytics/a/",tileServerUri:"https://tiles-cdn.eu.mappedin.com/styles/mappedin/style.json"}),fUe=Object.freeze({baseUri:"https://api-gateway-staging.mappedin.net/",baseAuthUri:"https://auth-staging.mappedin.net/",analyticsBaseUri:"https://api-gateway-staging.mappedin.net/track-analytics/a/",tileServerUri:"https://tiles-cdn.mappedin.com/styles/mappedin/style.json"}),mUe=Object.freeze({baseUri:"https://app-staging.mappedin.net/",baseAuthUri:"https://app-staging.mappedin.net/",analyticsBaseUri:"https://api-gateway-staging.mappedin.net/track-analytics/a/",tileServerUri:"https://tiles-cdn.mappedin.com/styles/mappedin/style.json"}),gUe={eu:pUe,us:Tee,"us-enterprise":dUe,"us-staging-enterprise":fUe,"us-staging-self-serve":mUe};function yUe(t){return gUe[t]}C();C();var vUe=t=>{let e=Date.now();return t-e},Pee=(t,e)=>vUe(t)<=e*60*1e3,Dee=60,_Ue=Dee*60*1e3,BR="accessTokens";async function xUe(t,e=!1){let r="".concat(t.key),n=Mg.getInstance(),i=n?.loadSessionData(BR)||{},a=Math.floor(Date.now()/1e3);if(i[r]&&!Pee(i[r].expiresTimestamp*1e3,Dee))return i[r];let o=e?await bUe(t,a):await wUe(t,a),s=lt(ae({},i),{[r]:o});return n?.saveSessionData(BR,s),o}async function bUe(t,e){var r;let n;t.customAuthUri?n=t.customAuthUri:n="".concat((r=t.baseAuthUri)!=null?r:hUe,"oauth2/token");let i;try{i=await Wu()(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({grant_type:"client_credentials",client_id:t.key,client_secret:t.secret})})}catch(o){let s=o instanceof Error?o.message:String(o);throw new Error("Failed to fetch enterprise access token from ".concat(n,": ").concat(s))}if(!i.ok)throw new Error("".concat(i.status," ").concat(i.statusText,": ").concat(await i.text()));let a=await i.json();return{accessToken:a.access_token,expiresTimestamp:e+a.expires_in}}async function wUe(t,e){let r;t.customAuthUri?r=t.customAuthUri:r="".concat(t.baseAuthUri?JO(t.baseAuthUri):KO,"api/v1/api-key/token");let n;try{n=await Wu()(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:t.key,secret:t.secret})})}catch(a){let o=a instanceof Error?a.message:String(a);throw new Error("Failed to fetch access token from ".concat(r,": ").concat(o))}if(!n.ok)throw new Error("".concat(n.status," ").concat(n.statusText,": ").concat(await n.text()));let i=await n.json();return{accessToken:i.access_token,expiresTimestamp:e+i.expires_in}}C();var kee=60,AUe=kee*60*1e3,zR="miSasTokens";async function SUe(t,e){let r="".concat(e,"__").concat(t.mapId),n=Mg.getInstance(),i=n?.loadSessionData(zR)||{};if(i[r]&&!Pee(i[r].expires,kee))return i[r];let a=await EUe(t,e),o=lt(ae({},i),{[r]:{token:a.token,expires:new Date(a.expires).getTime()}});return n?.saveSessionData(zR,o),a}async function EUe(t,e){let r="".concat(t.baseUri?JO(t.baseUri):KO,"api/v1/venue/").concat(t.mapId,"/sas-token"),n=await Wu()(r,{method:"GET",headers:{Authorization:"Bearer ".concat(e)}});if(!n.ok)throw new Error("".concat(n.status," ").concat(n.statusText,": ").concat(await n.text()));let i=await n.json();return{token:i.token,expires:new Date(i.expires).getTime()}}C();var ds=Uint8Array,hg=Uint16Array,Oee=Uint32Array,Bee=new ds([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),zee=new ds([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),IUe=new ds([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Fee=function(t,e){for(var r=new hg(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var i=new Oee(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)i[a]=a-r[n]<<5|n;return[r,i]},Ree=Fee(Bee,2),Lee=Ree[0],CUe=Ree[1];Lee[28]=258,CUe[258]=28;var MUe=Fee(zee,0),TUe=MUe[0],Nee=new hg(32768);for(fn=0;fn<32768;++fn)oc=(fn&43690)>>>1|(fn&21845)<<1,oc=(oc&52428)>>>2|(oc&13107)<<2,oc=(oc&61680)>>>4|(oc&3855)<<4,Nee[fn]=((oc&65280)>>>8|(oc&255)<<8)>>>1;var oc,fn,Vv=function(t,e,r){for(var n=t.length,i=0,a=new hg(e);i<n;++i)t[i]&&++a[t[i]-1];var o=new hg(e);for(i=0;i<e;++i)o[i]=o[i-1]+a[i-1]<<1;var s;{s=new hg(1<<e);var l=15-e;for(i=0;i<n;++i)if(t[i])for(var u=i<<4|t[i],c=e-t[i],h=o[t[i]-1]++<<c,d=h|(1<<c)-1;h<=d;++h)s[Nee[h]>>>l]=u}return s},R_=new ds(288);for(fn=0;fn<144;++fn)R_[fn]=8;var fn;for(fn=144;fn<256;++fn)R_[fn]=9;var fn;for(fn=256;fn<280;++fn)R_[fn]=7;var fn;for(fn=280;fn<288;++fn)R_[fn]=8;var fn,$ee=new ds(32);for(fn=0;fn<32;++fn)$ee[fn]=5;var fn,PUe=Vv(R_,9),DUe=Vv($ee,5),fI=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},sl=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},mI=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},kUe=function(t){return(t+7)/8|0},QO=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new(t.BYTES_PER_ELEMENT==2?hg:t.BYTES_PER_ELEMENT==4?Oee:ds)(r-e);return n.set(t.subarray(e,r)),n},OUe=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],wl=function(t,e,r){var n=new Error(e||OUe[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,wl),!r)throw n;return n},BUe=function(t,e,r){var n=t.length;if(!n||r&&r.f&&!r.l)return e||new ds(0);var i=!e||r,a=!r||r.i;r||(r={}),e||(e=new ds(n*3));var o=function(Le){var Se=e.length;if(Le>Se){var Ue=new ds(Math.max(Se*2,Le));Ue.set(e),e=Ue}},s=r.f||0,l=r.p||0,u=r.b||0,c=r.l,h=r.d,d=r.m,p=r.n,m=n*8;do{if(!c){s=sl(t,l,1);var y=sl(t,l+1,3);if(l+=3,y)if(y==1)c=PUe,h=DUe,d=9,p=5;else if(y==2){var v=sl(t,l,31)+257,_=sl(t,l+10,15)+4,w=v+sl(t,l+5,31)+1;l+=14;for(var b=new ds(w),A=new ds(19),E=0;E<_;++E)A[IUe[E]]=sl(t,l+E*3,7);l+=_*3;for(var M=fI(A),P=(1<<M)-1,k=Vv(A,M),E=0;E<w;){var D=k[sl(t,l,P)];l+=D&15;var O=D>>>4;if(O<16)b[E++]=O;else{var B=0,L=0;for(O==16?(L=3+sl(t,l,3),l+=2,B=b[E-1]):O==17?(L=3+sl(t,l,7),l+=3):O==18&&(L=11+sl(t,l,127),l+=7);L--;)b[E++]=B}}var R=b.subarray(0,v),T=b.subarray(v);d=fI(R),p=fI(T),c=Vv(R,d),h=Vv(T,p)}else wl(1);else{var O=kUe(l)+4,N=t[O-4]|t[O-3]<<8,$=O+N;if($>n){a&&wl(0);break}i&&o(u+N),e.set(t.subarray(O,$),u),r.b=u+=N,r.p=l=$*8,r.f=s;continue}if(l>m){a&&wl(0);break}}i&&o(u+131072);for(var V=(1<<d)-1,G=(1<<p)-1,ee=l;;ee=l){var B=c[mI(t,l)&V],ie=B>>>4;if(l+=B&15,l>m){a&&wl(0);break}if(B||wl(2),ie<256)e[u++]=ie;else if(ie==256){ee=l,c=null;break}else{var me=ie-254;if(ie>264){var E=ie-257,Me=Bee[E];me=sl(t,l,(1<<Me)-1)+Lee[E],l+=Me}var Ae=h[mI(t,l)&G],le=Ae>>>4;Ae||wl(3),l+=Ae&15;var T=TUe[le];if(le>3){var Me=zee[le];T+=mI(t,l)&(1<<Me)-1,l+=Me}if(l>m){a&&wl(0);break}i&&o(u+131072);for(var _e=u+me;u<_e;u+=4)e[u]=e[u-T],e[u+1]=e[u+1-T],e[u+2]=e[u+2-T],e[u+3]=e[u+3-T];u=_e}}r.l=c,r.p=ee,r.b=u,r.f=s,c&&(s=1,r.m=d,r.d=h,r.n=p)}while(!s);return u==e.length?e:QO(e,0,u)},zUe=new ds(0),gu=function(t,e){return t[e]|t[e+1]<<8},Sl=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},gI=function(t,e){return Sl(t,e)+Sl(t,e+4)*4294967296};function FUe(t,e){return BUe(t,e)}var OT=typeof TextDecoder<"u"&&new TextDecoder,RUe=0;try{OT.decode(zUe,{stream:!0}),RUe=1}catch{}var LUe=function(t){for(var e="",r=0;;){var n=t[r++],i=(n>127)+(n>223)+(n>239);if(r+i>t.length)return[e,QO(t,r-1)];i?i==3?(n=((n&15)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,e+=String.fromCharCode(55296|n>>10,56320|n&1023)):i&1?e+=String.fromCharCode((n&31)<<6|t[r++]&63):e+=String.fromCharCode((n&15)<<12|(t[r++]&63)<<6|t[r++]&63):e+=String.fromCharCode(n)}};function NUe(t,e){if(e){for(var r="",n=0;n<t.length;n+=16384)r+=String.fromCharCode.apply(null,t.subarray(n,n+16384));return r}else{if(OT)return OT.decode(t);var i=LUe(t),a=i[0],o=i[1];return o.length&&wl(8),a}}var $Ue=function(t,e){return e+30+gu(t,e+26)+gu(t,e+28)},UUe=function(t,e,r){var n=gu(t,e+28),i=NUe(t.subarray(e+46,e+46+n),!(gu(t,e+8)&2048)),a=e+46+n,o=Sl(t,e+20),s=r&&o==4294967295?jUe(t,a):[o,Sl(t,e+24),Sl(t,e+42)],l=s[0],u=s[1],c=s[2];return[gu(t,e+10),l,u,i,a+gu(t,e+30)+gu(t,e+32),c]},jUe=function(t,e){for(;gu(t,e)!=1;e+=4+gu(t,e+2));return[gI(t,e+12),gI(t,e+4),gI(t,e+20)]};function Uee(t,e){for(var r={},n=t.length-22;Sl(t,n)!=101010256;--n)(!n||t.length-n>65558)&&wl(13);var i=gu(t,n+8);if(!i)return{};var a=Sl(t,n+16),o=a==4294967295||i==65535;if(o){var s=Sl(t,n-12);o=Sl(t,s)==101075792,o&&(i=Sl(t,s+32),a=Sl(t,s+48))}for(var l=e,u=0;u<i;++u){var c=UUe(t,a,o),h=c[0],d=c[1],p=c[2],m=c[3],y=c[4],v=c[5],_=$Ue(t,v);a=y,(!l||l({name:m,size:d,originalSize:p,compression:h}))&&(h?h==8?r[m]=FUe(t.subarray(_,_+d),new ds(p)):wl(14,"unknown compression type "+h):r[m]=QO(t,_,_+d))}return r}var FR=globalThis.fetch,RR,VUe=(RR=Oi?.env)==null?void 0:RR.npm_package_version;function Wu(){if(FR==null)throw new Error("fetch is not available in your environment. Pass your own function into `setFetchFn` (node-fetch, etc)");return FR}var BT={supplementaryUrl:"https://api-gateway.mappedin.com/analytics/",headers:{},accessToken:"",clientId:"",noAuth:!1,includeHidden:!0,clientSecret:"",apiGateway:"",authorization:"",perspective:"Website",language:"",venue:""};function GUe(t){var e;let r=ae(ae({},BT),t);return r.headers=lt(ae({},r.headers),{"mappedin-sdk-version":VUe}),r.things=[],"platformString"in t&&(r.headers=lt(ae({},r.headers),{"mappedin-platform-version":t.platformString})),r.noAuth||(r.accessToken?r.authorization="Bearer ".concat(r.accessToken):r.clientId&&r.clientSecret&&(r.authorization="Basic ".concat(globalThis.btoa("".concat(r.clientId,":").concat(r.clientSecret))))),r.language=(e=r.language)==null?void 0:e.toLowerCase(),r}function ZUe(t,e,r=!1){t.language,t.clientId,t.clientSecret;let{headers:n}=t;n["Content-Type"]=n["Content-Type"]||"text/json",t.accessToken?n.Authorization="Bearer ".concat(t.accessToken):t.noAuth||t.clientId&&t.clientSecret&&(n["x-mappedin-key"]=btoa(t.clientId),n["x-mappedin-secret"]=btoa(t.clientSecret));let i={method:"GET",headers:n};return t.secure&&(e+="&withcdntoken"),{req:i,url:e}}async function WUe(t,e,r=!1){let n=ZUe(t,e,r),i=await Wu()(n.url,n.req);if(!i.ok)throw new Error("".concat(i.status," ").concat(i.statusText));return i.json()}var HUe=t=>{let e=t!=null&&typeof t=="object"&&"perspectives"in t&&t.perspectives!=null&&typeof t.perspectives=="object"?t.perspectives:null;if(e==null||Object.keys(e).length===0)return Be.warn("No perspectives available in response!"),null;let r={};for(let[n,i]of Object.entries(e)){let a="url"in i&&typeof i.url=="string"?i.url:null,o="locale_packs"in i&&typeof i.locale_packs=="object"?i.locale_packs:null;if(a==null||o==null){Be.warn("Perspective ".concat(n," is missing url or locale_packs!"));continue}r[n]={url:a,locale_packs:o}}return r};async function XUe(t,e="exports/mvf/1/bundle"){var r,n;let i=GUe(ae(ae({baseUri:"https://api-gateway.mappedin.com/"},BT),t)),a="".concat(i.baseUri+e,"?venue=").concat(i.venue,"&version=").concat((r=i.version)!=null?r:"2.0.0");i.headers["Content-Type"]="application/zip";let o=await WUe(i,a),s=o.url,l=o.locale_packs,u=(n=i.perspective)!=null?n:BT.perspective,c=HUe(o);if(u!=null&&u!==""&&c!=null){let h=c[u];h==null?Be.warn("Perspective ".concat(u," not found in response! Loading default perspective instead.")):(Be.log('Loading perspective "'.concat(u,'"')),s=h.url,l=h.locale_packs)}return{url:s,localePacks:l,updated_at:o.updated_at}}var Tf=(function(){let t;return()=>(t||(t=new TextDecoder),t)})();async function LR(t,{signal:e}){let r=await(await Wu()(t,{signal:e})).arrayBuffer();return new Uint8Array(r)}async function jee(t){let e=Uee(t),r={};if(e["enterprise/"]!=null){r.enterprise={};let n=e["enterprise/locations.json"];n&&(r.enterprise.locations=JSON.parse(Tf().decode(n)));let i=e["enterprise/locationInstances.json"];i&&(r.enterprise.locationInstances=JSON.parse(Tf().decode(i)));let a=e["enterprise/categories.json"];a&&(r.enterprise.categories=JSON.parse(Tf().decode(a)))}return e["floorstack.json"]&&(r["floorstack.json"]=JSON.parse(Tf().decode(e["floorstack.json"]))),e["floor.geojson"]&&(r["floor.geojson"]=JSON.parse(Tf().decode(e["floor.geojson"]))),e["manifest.json"]&&(r["manifest.geojson"]=JSON.parse(Tf().decode(e["manifest.json"]))),r}async function qUe(t,{signal:e}){try{let r=await(await Wu()(t,{signal:e})).arrayBuffer();if(e.aborted)return;let n=new Uint8Array(r);return await jee(n)}catch(r){let n=new Error("downloadLanguagePack failed");throw n.cause=r,n}}function YUe(t){let{mvfVersion:e,useDraftData:r}=t;if(e==="3.0.0")return r?"exports/mvf3-draft/1/bundle":"exports/mvf3/1/bundle";if(e==null||e==="2.0.0")return r?"exports/mvf2-draft/1/bundle":"exports/mvf2/1/bundle";if(e==="2.0.0-c")return r?"exports/mvf2c-draft/1/bundle":"exports/mvf2c/1/bundle";throw new Error("Unsupported MVF version: ".concat(e))}async function JUe(t){return new Promise(async(e,r)=>{try{let n=YUe(t),{url:i,localePacks:a}=await XUe(t,n),o=await Wu()(i).then(l=>l.arrayBuffer()),s=new Uint8Array(o);e({compressed:s,localePacks:a})}catch(n){r(n)}})}async function KUe(t,e){return new Promise(async(r,n)=>{try{let{url:i}=await QUe(t,e),a=await Wu()(i).then(s=>s.arrayBuffer()),o=new Uint8Array(a);r(o)}catch(i){n(i)}})}async function QUe(t,e){let r=new URL("".concat(t.baseUri?JO(t.baseUri):KO,"api/v1/venue/").concat(t.mapId,"/mvf"));t.viewId&&r.searchParams.set("configId",t.viewId),t.mvfVersion&&r.searchParams.set("version",t.mvfVersion);let n=await Wu()(r.toString(),{headers:{Authorization:"Bearer ".concat(e)}});if(!n.ok)throw new Error("".concat(n.status," ").concat(n.statusText));return n.json()}function eje(t){if(t==null||typeof t!="object")return!1;let e=["connection.json","manifest.geojson","floor.geojson"in t?"floor.geojson":"map.geojson","node.geojson","floorstack.json"in t?"floorstack.json":"mapstack.json"in t?"mapstack.json":"mapstack.geojson"];"styles.json"in t&&e.push("styles.json"),"shapes.json"in t&&e.push("shapes.json"),"navigationFlags.json"in t&&e.push("navigationFlags.json"),"annotation-symbols.json"in t&&e.push("annotation-symbols.json");for(let r of e)if(t[r]==null||t[r][Symbol.toStringTag]!=="Uint8Array")return!1;return!0}async function tje(t){return new Promise(async(e,r)=>{try{if(t==null||typeof t!="object")throw new Error("Error parsing data! Unzipping failed.");if(t[Symbol.toStringTag]!=="Uint8Array")throw new Error("Unexpected file type! Unzipping failed.");let n=Uee(t);if(!eje(n))throw new Error("MVF is missing some expect static files. Unzipping failed.");let i={},a=Object.keys(n);for(let o of a){if(n[o].length===0)continue;let s=o.split("/");if(s.length<0)throw new Error("Encounted a file with no name! Unzipping failed.");if(s.length>2)throw new Error("Encountered unexpected nesting in MVF! Unzipping failed.");if(s.length===1){i[s[0]]=n[o];continue}if(s[0]==="image"){Be.warn("MVF unzipping encountered an image. Ignoring as this case has not been implemented.");continue}else i[s[0]]==null&&(i[s[0]]={}),i[s[0]][s[1]]=n[o]}e(i)}catch(n){r(n)}})}function Vee(){let t="us",e={};function r(){return rje(yUe(t),e)}return{updateByUserOption(n){var i,a;n.environment&&(t=n.environment),n.baseUri&&(e.baseUri=n.baseUri),n.baseAuthUri&&(e.baseAuthUri=n.baseAuthUri),(i=n.analytics)!=null&&i.baseUri&&(e.analyticsBaseUri=(a=n.analytics)==null?void 0:a.baseUri)},updateTileServerBaseUrl(n){e.tileServerUri=n},updateEnvironment(n){t=n},setEnterprise(n){(t==="us"||t==="us-enterprise")&&(t=n?"us-enterprise":"us")},getBaseUri(){return r().baseUri},getBaseAuthUri(){return r().baseAuthUri},getAnalyticsBaseUri(){return r().analyticsBaseUri},getTileServerUri(){return r().tileServerUri},reset(){t="us",e={}},__getState:r}}function rje(t,e){return ae(ae({},t),e)}var nje=t=>{var e,r;let n=Object.values((r=(e=t["floorstack.json"])!=null?e:t["mapstack.json"])!=null?r:{});return n.length===1?[]:n.filter(i=>i.type!=="Outdoor").map(i=>i.id.replace("fs_","").replace("ms_",""))},NR=async t=>{let e=performance.now(),r=cUe(t);return Be.log("Parsed MVFv3 in ".concat(performance.now()-e,"ms")),r.inspectErr(n=>{throw Be.error(n),new Error("MVFv3 parsing failed!")}),r.unwrap()};async function ije(t,e="2.0.0"){switch(e){case"2.0.0":case"2.0.0-c":try{let r=performance.now(),n=await tje(t),i=Y9e(n);return Be.log("Parsed MVFv2 in ".concat(performance.now()-r,"ms")),i}catch{return Be.error("MVFv2 parsing failed! Trying MVFv3."),NR(t)}case"3.0.0":return NR(t);default:throw new Error("Unsupported MVF version: ".concat(e))}}C();C();C();function Zp(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return t.geometry.coordinates;if(t.type==="Point")return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function md(t){if(Array.isArray(t))return t;if(t.type==="Feature"){if(t.geometry!==null)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function oS(t){return t.type==="Feature"?t.geometry:t}function aje(t,e){return t.type==="FeatureCollection"?"FeatureCollection":t.type==="GeometryCollection"?"GeometryCollection":t.type==="Feature"&&t.geometry!==null?t.geometry.type:t.type}function oje(t,e,r){r===void 0&&(r={});for(var n=Zp(t),i=md(e),a=0;a<i.length-1;a++){var o=!1;if(r.ignoreEndVertices&&(a===0&&(o="start"),a===i.length-2&&(o="end"),a===0&&a+1===i.length-1&&(o="both")),sje(i[a],i[a+1],n,o,typeof r.epsilon>"u"?null:r.epsilon))return!0}return!1}function sje(t,e,r,n,i){var a=r[0],o=r[1],s=t[0],l=t[1],u=e[0],c=e[1],h=r[0]-s,d=r[1]-l,p=u-s,m=c-l,y=h*m-d*p;if(i!==null){if(Math.abs(y)>i)return!1}else if(y!==0)return!1;if(n){if(n==="start")return Math.abs(p)>=Math.abs(m)?p>0?s<a&&a<=u:u<=a&&a<s:m>0?l<o&&o<=c:c<=o&&o<l;if(n==="end")return Math.abs(p)>=Math.abs(m)?p>0?s<=a&&a<u:u<a&&a<=s:m>0?l<=o&&o<c:c<o&&o<=l;if(n==="both")return Math.abs(p)>=Math.abs(m)?p>0?s<a&&a<u:u<a&&a<s:m>0?l<o&&o<c:c<o&&o<l}else return Math.abs(p)>=Math.abs(m)?p>0?s<=a&&a<=u:u<=a&&a<=s:m>0?l<=o&&o<=c:c<=o&&o<=l;return!1}var lje=oje;C();function uje(t,e){e===void 0&&(e={});var r=p_(t),n=(r[0]+r[2])/2,i=(r[1]+r[3])/2;return lg([n,i],e.properties,e)}var eB=uje;C();C();function cje(t,e,r){r===void 0&&(r={});var n=Zp(t),i=Zp(e),a=Dl(i[1]-n[1]),o=Dl(i[0]-n[0]),s=Dl(n[1]),l=Dl(i[1]),u=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(o/2),2)*Math.cos(s)*Math.cos(l);return nTe(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),r.units)}var Kf=cje;function $R(t,e){return e===void 0&&(e={}),sTe(t,function(r,n){var i=n.geometry.coordinates;return r+Kf(i[0],i[1],e)},0)}C();C();C();function Gee(t,e,r){if(r===void 0&&(r={}),r.final===!0)return hje(t,e);var n=Zp(t),i=Zp(e),a=Dl(n[0]),o=Dl(i[0]),s=Dl(n[1]),l=Dl(i[1]),u=Math.sin(o-a)*Math.cos(l),c=Math.cos(s)*Math.sin(l)-Math.sin(s)*Math.cos(l)*Math.cos(o-a);return NM(Math.atan2(u,c))}function hje(t,e){var r=Gee(e,t);return r=(r+180)%360,r}C();function iA(t,e,r,n){n===void 0&&(n={});var i=Zp(t),a=Dl(i[0]),o=Dl(i[1]),s=Dl(r),l=iTe(e,n.units),u=Math.asin(Math.sin(o)*Math.cos(l)+Math.cos(o)*Math.sin(l)*Math.cos(s)),c=a+Math.atan2(Math.sin(s)*Math.sin(l)*Math.cos(o),Math.cos(l)-Math.sin(o)*Math.sin(u)),h=NM(c),d=NM(u);return lg([h,d],n.properties)}C();C();function dje(t){if(!t)throw new Error("geojson is required");var e=[];return Gp(t,function(r){pje(r,e)}),L4(e)}function pje(t,e){var r=[],n=t.geometry;if(n!==null){switch(n.type){case"Polygon":r=md(n);break;case"LineString":r=[md(n)]}r.forEach(function(i){var a=fje(i,t.properties);a.forEach(function(o){o.id=e.length,e.push(o)})})}}function fje(t,e){var r=[];return t.reduce(function(n,i){var a=$g([n,i],e);return a.bbox=mje(n,i),r.push(a),i}),r}function mje(t,e){var r=t[0],n=t[1],i=e[0],a=e[1],o=r<i?r:i,s=n<a?n:a,l=r>i?r:i,u=n>a?n:a;return[o,s,l,u]}var UR=dje,gje=Zt(xPe(),1);function yje(t,e){var r={},n=[];if(t.type==="LineString"&&(t=Gc(t)),e.type==="LineString"&&(e=Gc(e)),t.type==="Feature"&&e.type==="Feature"&&t.geometry!==null&&e.geometry!==null&&t.geometry.type==="LineString"&&e.geometry.type==="LineString"&&t.geometry.coordinates.length===2&&e.geometry.coordinates.length===2){var i=jR(t,e);return i&&n.push(i),L4(n)}var a=(0,gje.default)();return a.load(UR(e)),C8(UR(t),function(o){C8(a.search(o),function(s){var l=jR(o,s);if(l){var u=md(l).join(",");r[u]||(r[u]=!0,n.push(l))}})}),L4(n)}function jR(t,e){var r=md(t),n=md(e);if(r.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(n.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var i=r[0][0],a=r[0][1],o=r[1][0],s=r[1][1],l=n[0][0],u=n[0][1],c=n[1][0],h=n[1][1],d=(h-u)*(o-i)-(c-l)*(s-a),p=(c-l)*(a-u)-(h-u)*(i-l),m=(o-i)*(a-u)-(s-a)*(i-l);if(d===0)return null;var y=p/d,v=m/d;if(y>=0&&y<=1&&v>=0&&v<=1){var _=i+y*(o-i),w=a+y*(s-a);return lg([_,w])}return null}var sS=yje;function vje(t,e,r){r===void 0&&(r={});var n=lg([1/0,1/0],{dist:1/0}),i=0;return Gp(t,function(a){for(var o=md(a),s=0;s<o.length-1;s++){var l=lg(o[s]);l.properties.dist=Kf(e,l,r);var u=lg(o[s+1]);u.properties.dist=Kf(e,u,r);var c=Kf(l,u,r),h=Math.max(l.properties.dist,u.properties.dist),d=Gee(l,u),p=iA(e,h,d+90,r),m=iA(e,h,d-90,r),y=sS($g([p.geometry.coordinates,m.geometry.coordinates]),$g([l.geometry.coordinates,u.geometry.coordinates])),v=null;y.features.length>0&&(v=y.features[0],v.properties.dist=Kf(e,v,r),v.properties.location=i+Kf(l,v,r)),l.properties.dist<n.properties.dist&&(n=l,n.properties.index=s,n.properties.location=i),u.properties.dist<n.properties.dist&&(n=u,n.properties.index=s+1,n.properties.location=i+c),v&&v.properties.dist<n.properties.dist&&(n=v,n.properties.index=s),i+=c}}),n}var zT=vje;function _je(t,e,r){var n=md(r);if(aje(r)!=="LineString")throw new Error("line must be a LineString");var i=zT(r,t),a=zT(r,e),o;i.properties.index<=a.properties.index?o=[i,a]:o=[a,i];for(var s=[o[0].geometry.coordinates],l=o[0].properties.index+1;l<o[1].properties.index+1;l++)s.push(n[l]);return s.push(o[1].geometry.coordinates),$g(s,r.properties)}var VR=_je,xje=1e-7;function yI(t){return{type:"Point",coordinates:t}}function bje(t,e){let{coordinates:r}=e.geometry,{coordinates:n}=t.geometry,i=r.map(a=>zT(t,yI(a)));return n.reduce((a,o)=>{let s=VR(yI(o),i[0],t),l=VR(yI(o),i[1],t),u=$R(s)<$R(l)?s:l;return u.properties=lt(ae({},t.properties),{entrances:[]}),a.concat([u])},[])}function wje(t,e){return e.reduce((r,n)=>{let i={epsilon:xje},a=r.obstructions.findIndex(s=>lje(eB(n),s,i)),o=r.obstructions[a];if(o){let[s,l]=bje(o,n);r.entrances.push(n),r.obstructions.splice(a,1,s,l)}return r},{obstructions:[t],entrances:[]})}C();C();C();var Id=class{constructor(t){S(this,"id"),this.id=t}};C();C();var Zee=class b2{constructor(e,r,n){S(this,"__type",b2.__type),S(this,"id",Wn()),S(this,"latitude"),S(this,"longitude"),S(this,"floorId"),S(this,"verticalOffset");var i;if(typeof e=="object")this.latitude=e.latitude,this.longitude=e.longitude,this.floorId=e.floorId,this.verticalOffset=(i=e.verticalOffset)!=null?i:0;else{if(r==null)throw new Error("Coordinate longitude is required.");this.latitude=e,this.longitude=r,this.floorId=n,this.verticalOffset=0}}static is(e){return e.__type===b2.__type}get anchorTarget(){return this}get focusTarget(){return this}isEqual(e){return this.latitude===e.latitude&&this.longitude===e.longitude&&this.floorId===e.floorId}toJSON(){return{__type:b2.__type,latitude:this.latitude,longitude:this.longitude,floorId:this.floorId,verticalOffset:this.verticalOffset}}toGeoJSON(){var e;return{type:"Point",coordinates:[this.longitude,this.latitude,(e=this.verticalOffset)!=null?e:0]}}destroy(){}};S(Zee,"__type","coordinate");var Aje=Zee,Rr=Aje;function GR(t){var e,r,n,i,a,o;let s=((r=(e=t.enterprise)==null?void 0:e.locations)==null?void 0:r.reduce((c,h)=>(c[h.id]=h,c),{}))||{};for(let c of((n=t.enterprise)==null?void 0:n.locationInstances)||[])s[c.id]=c;let l={};for(let c of t["floorstack.json"]||[])l[c.id]=c;let u={};for(let c of((i=t["floor.geojson"])==null?void 0:i.features)||[])c.properties&&c.properties.id&&(u[c.properties.id]=c.properties);return{type:"downloaded",data:t,optimized:{"enterprise-location":s,"enterprise-category":((o=(a=t.enterprise)==null?void 0:a.categories)==null?void 0:o.reduce((c,h)=>(c[h.id]=h,c),{}))||{},"floor-stack":l,floor:u}}}function Sje(t){return/^https?:\/\/cdn\.mappedin\.com/.test(t)}function Eje(t){let e=t.split("?")[1];return!!(e!=null&&e.includes("sv="))}function rh(t,e){var r;let n=((r=t?.properties)==null?void 0:r.id)||"unknown";if(t.geometry==null)return Be.error('Cannot get the center coordinate for "'.concat(n,'" because it has no geometry.')),new Rr({latitude:0,longitude:0,floorId:e});try{if(t.geometry.type==="LineString"){let[[i,a],[o,s]]=t.geometry.coordinates,l=(i+o)/2,u=(a+s)/2;return new Rr({latitude:u,longitude:l,floorId:e})}else if(t.geometry.type==="Point"){let[i,a]=t.geometry.coordinates;return new Rr({latitude:a,longitude:i,floorId:e})}else if(t.geometry.type==="Polygon"){let i=t;if(i.properties.center!=null){let[a,o]=i.properties.center;return new Rr({latitude:o,longitude:a,floorId:e})}}}catch{}try{let[i,a]=eB(t).geometry.coordinates;return new Rr({latitude:a,longitude:i,floorId:e})}catch(i){return Be.error('Failed to get center coordinate for "'.concat(n,'" ').concat(i instanceof Error?i.stack:"")),new Rr({latitude:0,longitude:0,floorId:e})}}function Ije(t,e){return e&&(t.flags[e.index]&1<<e.bit)!==0}var Bs,Ea,Qf,Eh,Wee=class w2 extends Id{constructor(e,r){super(r.mvfData.properties.id),S(this,"__type",w2.__type),K(this,Bs),K(this,Ea,{}),K(this,Qf),K(this,Eh),ne(this,Bs,e),ne(this,Qf,r.floorId),ne(this,Eh,r.mvfData)}static is(e){return e.__type===w2.__type}get locations(){return f(this,Ea).locations?f(this,Ea).locations:(f(this,Ea).locations=(f(this,Bs).locationIdsByNodeId[this.id]||[]).map(e=>f(this,Bs).getById("enterprise-location",e)).filter(Boolean),f(this,Ea).locations)}get space(){var e;return f(this,Bs).getById("space",(e=f(this,Bs).spaceIdsByNodeId[this.id])==null?void 0:e[0])}get object(){var e;return f(this,Bs).getById("object",(e=f(this,Bs).objectIdsByNodeId[this.id])==null?void 0:e[0])}get floor(){let e=f(this,Bs).getById("floor",f(this,Qf));if(e==null)throw new Error("Floor ".concat(f(this,Qf)," not found!"));return e}get coordinate(){return f(this,Ea).coordinate==null&&(f(this,Ea).coordinate=rh(f(this,Eh),f(this,Qf))),f(this,Ea).coordinate}get externalId(){var e;return(e=f(this,Eh).properties.externalId)!=null?e:""}get neighbors(){if(f(this,Ea).neighbors==null){let e=f(this,Eh).properties.neighbors.map(r=>{let n=f(this,Bs).getById("node",r.id);if(n==null)throw new Error("Node ".concat(r.id," not found!"));return n});f(this,Ea).neighbors=e}return f(this,Ea).neighbors}get navigationFlags(){if(f(this,Ea).navigationFlags==null){let e=[],r=f(this,Eh).properties.flags;if(r!=null&&r.length>0)for(let[n,i]of Object.entries(f(this,Bs).navigationFlags))r.length>i.index&&r[i.index]!=null&&Ije({flags:r},i)&&e.push(n);f(this,Ea).navigationFlags=Object.freeze(e)}return f(this,Ea).navigationFlags}get geoJSON(){return lt(ae({},f(this,Eh)),{properties:null})}get focusTarget(){return this.coordinate}get anchorTarget(){return this.coordinate}toJSON(){return{__type:w2.__type,id:this.id,floor:this.floor.id,coordinate:this.coordinate.toJSON(),neighbors:this.neighbors.map(e=>e.id)}}destroy(){for(let e of Object.keys(f(this,Ea)))delete f(this,Ea)[e]}};Bs=new WeakMap,Ea=new WeakMap,Qf=new WeakMap,Eh=new WeakMap,S(Wee,"__type","node");var Cje=Wee,t0=Cje;C();C();C();C();var A2,Ih,Hee=class S2 extends Id{constructor(e){super(String(Wn())),S(this,"__type",S2.__type),K(this,A2,{}),K(this,Ih),ne(this,Ih,e.mvfData)}static is(e){return e.__type===S2.__type}get url(){return f(this,Ih).url}get name(){if("displayName"in f(this,Ih))return f(this,Ih).displayName;if("label"in f(this,Ih))return f(this,Ih).label}toJSON(){return{__type:S2.__type,id:this.id,url:this.url,name:this.name}}destroy(){for(let e of globalThis.Object.keys(f(this,A2)))delete f(this,A2)[e]}};A2=new WeakMap,Ih=new WeakMap,S(Hee,"__type","hyperlink");var Mje=Hee,FT=Mje;C();C();function RT(t){return typeof t=="string"?t:t.id}function Xee(t){return Array.isArray(t)&&Number.isFinite(t[0])&&Number.isFinite(t[1])}var vI=8,$0=t=>typeof t=="number"?t.toFixed(vI):Xee(t)?t[1].toFixed(vI)+"-"+t[0].toFixed(vI):t.map(e=>$0(e)).join("-"),Tje=/^https:\/\/cdn\.mappedin\.com\/category-symbols\/.+$/,Pje=/^https:\/\/cdn-staging\.mappedin\.net\/category-symbols\/.+$/,Dje=t=>Tje.test(t)||Pje.test(t),kje=/^https:\/\/cdn\.mappedin\.com\/[^/]+\/[^/]+\.[a-zA-Z0-9]+$/,Oje=/^https:\/\/cdn-staging\.mappedin\.net\/[^/]+\/[^/]+\.[a-zA-Z0-9]+$/,Bje=t=>Dje(t)?!1:kje.test(t)||Oje.test(t),qee=t=>{var e;if(!Bje(t))return null;let r="";t.startsWith("https://")?(r="https://",t=t.slice(8)):t.startsWith("http://")&&(r="http://",t=t.slice(7));let[n,i,a]=t.split("/"),o=(e=a.split(".").pop())!=null?e:"";return{origin:r+n,mapId:i,fileName:a,fileType:o}};function Yee(t){return t.reduce((e,r,n)=>n===0?e:e+Cp(t[n-1].toGeoJSON().coordinates,r.toGeoJSON().coordinates),0)}function lS(t){return t!=null&&typeof t=="object"&&"__type"in t&&t.__type!==null&&typeof t.__type=="string"}function Jee(t){return t!=null&&typeof t=="object"&&"name"in t&&t.name!=null&&typeof t.name=="string"&&t.name!==""}function zje(t){return lS(t)&&Jee(t)}var E2,Zd,em,Kee=class I2 extends Id{constructor(e){super(String(Wn())),S(this,"__type",I2.__type),K(this,E2,{}),K(this,Zd),K(this,em),ne(this,Zd,e.mvfData),ne(this,em,e.mapData)}static is(e){return e.__type===I2.__type}get url(){let e=f(this,Zd).url;if(f(this,em).tokenManager==null)return e;let r=qee(f(this,Zd).url);if(r==null)return e;let n=r.mapId;try{if(f(this,em).tokenManager.isEnterpriseMode())return e;let i=f(this,em).tokenManager.getSasToken(n).token;if(i==null||i==="")throw new Error("SAS token empty!");return"".concat(e,"?").concat(i)}catch(i){return r.fileType!=="svg"&&Be.error("Error getting SAS token for image",{error:i,url:e}),e}}get name(){return f(this,Zd).altText}get altText(){return f(this,Zd).altText}toJSON(){return{__type:I2.__type,id:this.id,url:this.url,name:this.name}}destroy(){for(let e of globalThis.Object.keys(f(this,E2)))delete f(this,E2)[e]}};E2=new WeakMap,Zd=new WeakMap,em=new WeakMap,S(Kee,"__type","image");var Fje=Kee,aA=Fje;C();var tm,uS=class{constructor(t,e){S(this,"id"),K(this,tm),this.id=t}get geoJSONBoundingBox(){return f(this,tm)?f(this,tm):"bbox"in this.geoJSON.geometry&&this.geoJSON.geometry.bbox?this.geoJSON.geometry.bbox:(ne(this,tm,p_(this.geoJSON)),f(this,tm))}get geoJSON(){return{properties:null,type:"Feature",geometry:{type:"Polygon",coordinates:[[]]}}}};tm=new WeakMap;var Hy,Ch,Mh,uf=class extends uS{constructor(t,e){super(e.properties.id,t),K(this,Hy),K(this,Ch),K(this,Mh,{}),ne(this,Hy,t),ne(this,Ch,e)}get externalId(){var t;return(t=f(this,Ch).properties.externalId)!=null?t:""}get name(){var t,e,r,n;let i=(e=(t=f(this,Ch).properties.details)==null?void 0:t.name)!=null?e:"";return i===""&&(i=(n=(r=this.locationProfiles.find(a=>a.name&&a.name.length>0))==null?void 0:r.name)!=null?n:""),i}get icon(){var t;return(t=this.locationProfiles.find(e=>e.icon!=null&&e.icon.url!=null&&e.icon.url.length>0))==null?void 0:t.icon}get description(){var t,e,r,n;let i=(e=(t=f(this,Ch).properties.details)==null?void 0:t.description)!=null?e:"";return i===""&&(i=(n=(r=this.locationProfiles.find(a=>a.description&&a.description.length>0))==null?void 0:r.description)!=null?n:""),i}get images(){var t,e,r,n,i;if(f(this,Mh).images!=null)return f(this,Mh).images;let a=(r=(e=(t=f(this,Ch).properties.details)==null?void 0:t.images)==null?void 0:e.map(o=>new aA({mvfData:o,mapData:f(this,Hy)})))!=null?r:[];return(a==null||a.length===0)&&(a=(i=(n=this.locationProfiles.find(o=>o.images.length>0))==null?void 0:n.images)!=null?i:[]),f(this,Mh).images=a,a}get links(){var t,e,r,n,i;if(f(this,Mh).links!=null)return f(this,Mh).links;let a=(r=(e=(t=f(this,Ch).properties.details)==null?void 0:t.links)==null?void 0:e.map(o=>new FT({mvfData:o})))!=null?r:[];return(a==null||a.length===0)&&(a=(i=(n=this.locationProfiles.find(o=>o.links.length>0))==null?void 0:n.links)!=null?i:[]),f(this,Mh).links=a,a}get locationProfiles(){var t;return(t=f(this,Hy).locationProfilesByAttachedFeatureId[this.id])!=null?t:[]}};Hy=new WeakMap,Ch=new WeakMap,Mh=new WeakMap;var C2,rm,Xy,qy,Qee=class M2 extends uf{constructor(e,r){super(e,r.mvfData),S(this,"__type",M2.__type),K(this,C2),K(this,rm),K(this,Xy,{}),K(this,qy),ne(this,C2,e),ne(this,rm,r.floorId),ne(this,qy,r.mvfData)}static is(e){return e.__type===M2.__type}get center(){return f(this,Xy).center==null&&(f(this,Xy).center=rh(f(this,qy),f(this,rm))),f(this,Xy).center}get floor(){let e=f(this,C2).getById("floor",f(this,rm));if(e==null)throw new Error("Floor ".concat(f(this,rm)," not found!"));return e}get geoJSON(){return lt(ae({},f(this,qy)),{properties:null})}get focusTarget(){return this}get anchorTarget(){return this.center}toJSON(){return{__type:M2.__type,id:this.id,name:this.name,floor:this.floor.id}}destroy(){}};C2=new WeakMap,rm=new WeakMap,Xy=new WeakMap,qy=new WeakMap,S(Qee,"__type","area");var Rje=Qee,r0=Rje;C();var nm,Th,im,am,ete=class T2 extends uf{constructor(e,r){super(e,r.mvfData),S(this,"__type",T2.__type),K(this,nm),K(this,Th),K(this,im),K(this,am),ne(this,Th,{}),ne(this,am,r.mvfData),ne(this,nm,e),ne(this,im,r.floorId)}static is(e){return e.__type===T2.__type}get floor(){let e=f(this,nm).getById("floor",f(this,im));if(e==null)throw new Error("Floor ".concat(f(this,im)," not found!"));return e}get center(){return f(this,Th).center==null&&(f(this,Th).center=rh(f(this,am),f(this,im))),f(this,Th).center}get isExterior(){var e;if(f(this,am).properties.isExterior)return!0;let r=f(this,nm).obstructionIdByEntranceId[this.id],n=f(this,nm).getMVFFeatureById("obstruction",r);return(e=n?.properties.footprintComponent)!=null?e:!1}get geoJSON(){return lt(ae({},f(this,am)),{properties:null})}get focusTarget(){return this.center}get anchorTarget(){return this.center}toJSON(){return{__type:T2.__type,id:this.id,name:this.name,floor:this.floor.id,center:this.center.toJSON()}}destroy(){for(let e of Object.keys(f(this,Th)))delete f(this,Th)[e]}};nm=new WeakMap,Th=new WeakMap,im=new WeakMap,am=new WeakMap,S(ete,"__type","door");var Lje=ete,Cd=Lje;C();var Ph,om,Ia,Wd,tte=class P2 extends uf{constructor(e,r){super(e,r.mvfData),S(this,"__type",P2.__type),K(this,Ph),K(this,om),K(this,Ia,{}),K(this,Wd),ne(this,Ph,e),ne(this,om,r.floorId),ne(this,Wd,r.mvfData)}static is(e){return e.__type===P2.__type}get type(){return Uje(f(this,Wd).properties.kind)}get locations(){if(f(this,Ia).locations)return f(this,Ia).locations;f(this,Ia).locations=[];let e=f(this,Ph).mvfLocationsByGeometryId[f(this,Wd).properties.id];if(e?.length>0)for(let r of e){let n=f(this,Ph).getById("enterprise-location",r.id);n&&f(this,Ia).locations.push(n)}return f(this,Ia).locations}get floor(){let e=f(this,Ph).getById("floor",f(this,om));if(e==null)throw new Error("Floor ".concat(f(this,om)," not found!"));return e}get doors(){var e,r;if(f(this,Ia).doors)return f(this,Ia).doors;f(this,Ia).doors=[];let n=(r=(e=f(this,Ph).entranceNodeIdsBySpaceId)==null?void 0:e[this.id])!=null?r:[];for(let i of n){let a=f(this,Ph).doorsByNodeId[i];a&&f(this,Ia).doors.push(a)}return f(this,Ia).doors}get center(){return f(this,Ia).center==null&&(f(this,Ia).center=rh(f(this,Wd),f(this,om))),f(this,Ia).center}get geoJSON(){return lt(ae({},f(this,Wd)),{properties:null})}get focusTarget(){return this.geoJSON.geometry.type==="Polygon"?this:this.center}get anchorTarget(){return this.center}toJSON(){return{__type:P2.__type,id:this.id,name:this.name,type:this.type,floor:this.floor.id,center:this.center.toJSON()}}destroy(){for(let e of Object.keys(f(this,Ia)))delete f(this,Ia)[e]}};Ph=new WeakMap,om=new WeakMap,Ia=new WeakMap,Wd=new WeakMap,S(tte,"__type","space");var Nje=tte,$je=["room","hallway","exterior","void","gate"];function Uje(t){if(t==null||t==="default")return"room";let e=t.toLowerCase();return $je.includes(e)?e:"room"}var Xs=Nje;C();var _l,An,ss,Yy,D2,rte=class k2 extends uS{constructor(e,r){super(r.mvfData.properties.id,e),K(this,Yy),S(this,"__type",k2.__type),K(this,_l),K(this,An,{}),K(this,ss),ne(this,_l,e),ne(this,ss,r.mvfData)}static is(e){return e.__type===k2.__type}get focusTarget(){return this}get name(){var e;if(!("name"in f(this,ss).properties))return(e=f(this,ss).properties.externalId)!=null?e:"";let r=ot(this,Yy,D2).call(this,"name");return typeof r=="string"?r:""}get shortName(){var e;if(!("shortName"in f(this,ss).properties))return(e=f(this,ss).properties.externalId)!=null?e:"";let r=ot(this,Yy,D2).call(this,"shortName");return typeof r=="string"?r:""}get subtitle(){let e=ot(this,Yy,D2).call(this,"subtitle");return typeof e=="string"?e:""}get externalId(){var e;return(e=f(this,ss).properties.externalId)!=null?e:""}get elevation(){return f(this,ss).properties.elevation}get maxHeight(){return f(this,ss).properties.maxHeight}get spaces(){if(f(this,An).spaces==null){let e=f(this,_l).spaces.filter(r=>r.floor.id===this.id);f(this,An).spaces=e}return f(this,An).spaces}get geoJSON(){var e;return{type:"Feature",properties:null,geometry:(e=f(this,ss).geometry)!=null?e:{type:"Polygon",coordinates:[]}}}get objects(){if(f(this,An).objects==null){let e=f(this,_l).objects.filter(r=>r.floor.id===this.id);f(this,An).objects=e}return f(this,An).objects}get connections(){if(f(this,An).connections==null){let e=f(this,_l).connections.filter(r=>r.floors.includes(this));f(this,An).connections=e}return f(this,An).connections}get doors(){if(f(this,An).doors==null){let e=f(this,_l).doors.filter(r=>r.floor.id===this.id);f(this,An).doors=e}return f(this,An).doors}get annotations(){if(f(this,An).annotations==null){let e=f(this,_l).annotations.filter(r=>r.floor.id===this.id);f(this,An).annotations=e}return f(this,An).annotations}get pois(){if(f(this,An).pois==null){let e=f(this,_l).pointsOfInterest.filter(r=>r.floor.id===this.id);f(this,An).pois=e}return f(this,An).pois}get floorStack(){if(f(this,An).floorStack==null){let e=f(this,_l).floorStacks.find(r=>r.floors.includes(this));f(this,An).floorStack=e}return f(this,An).floorStack}get center(){return f(this,An).center==null&&(f(this,An).center=rh(f(this,ss),this.id)),f(this,An).center}toJSON(){return{__type:k2.__type,id:this.id,name:this.name,shortName:this.shortName,subtitle:this.subtitle,elevation:this.elevation,maxHeight:this.maxHeight,spaces:this.spaces.map(e=>e.id),objects:this.objects.map(e=>e.id),connections:this.connections.map(e=>e.id),doors:this.doors.map(e=>e.id),annotations:this.annotations.map(e=>e.id),pois:this.pois.map(e=>e.id)}}destroy(){for(let e of globalThis.Object.keys(f(this,An)))delete f(this,An)[e]}};_l=new WeakMap,An=new WeakMap,ss=new WeakMap,Yy=new WeakSet,D2=function(t){let e=f(this,ss).properties[t];return f(this,_l).getPropTranslation(this.__type,t,this.id,e)},S(rte,"__type","floor");var jje=rte,Fc=jje;C();C();C();function oA(t){let e;if(Xs.is(t)||Cd.is(t)||Wp.is(t)||r0.is(t)||Nl.is(t))e=t.center;else if(cf.is(t)||L_.is(t))e=t.coordinate;else if(Rr.is(t))e=t;else if(t0.is(t))e=t.coordinate;else if(L1.is(t))e=t.coordinates[0];else return;return e}C();C();var Vje=3.333333333,vb={debug:!1,pitch:45,bearing:0,antialiasing:{enabled:!0},shadingAndOutlines:!0,outdoorView:{layersHiddenByGeometry:["building","building-top"]},imagePlacementOptions:{mode:"default"},flipImagesToFaceCamera:!0,multiFloorView:{enabled:!0,floorGap:"auto"},disableUpdateStateValidation:!1},n0="ExteriorWalls",cS="Walls",Gje=0,tB="InteriorDoors",rB="ExteriorDoors",Ma="GeometryLayer",i0="LabelsLayer",kp="MarkersLayer",nB="FootprintLayer",sA="OcclusionLayer",lA="AreasLayer",iB="ImagesLayer",Gv="FacadesLayer",a0="PathsLayer",Zje=["https://mappedin.auth0.com","https://mappedin-staging.auth0.com","https://staging.mappedin.com","https://mappedin-staging.auth0.com/userinfo","https://mappedin.com","https://mappedin.auth0.com/userinfo"],Wje=new Set(["outdoorView","bearing","pitch","zoomLevel","screenOffsets","debug","initialFloor","shadingAndOutlines","wallTopColor","style","multiFloorView","occlusion","imagePlacementOptions","flipImagesToFaceCamera","injectStyles","useStandaloneCamera","preloadFloors"]),Hje=new Set(["style","enabled","layersHiddenByGeometry","lowDpi"]);function Xje(t){var e,r;(e=t.outdoorView)!=null&&e.enabled&&!((r=t.outdoorView)!=null&&r.token)&&Be.error("Enable outdoor view requires a token. Provide token in `options.outdoorView.token`")}function qje(t,e){var r,n,i,a,o,s,l;let u=((r=t?.outdoorView)==null?void 0:r.token)||e.outdoorViewToken,c=lt(ae(ae({},vb),t),{outdoorView:ae({enabled:((n=t?.outdoorView)==null?void 0:n.enabled)===void 0?!!u:(i=t?.outdoorView)==null?void 0:i.enabled,layersHiddenByGeometry:(a=vb.outdoorView)==null?void 0:a.layersHiddenByGeometry},t?.outdoorView),bearing:(s=(o=t?.bearing)!=null?o:e.naturalBearing)!=null?s:0,imagePlacementOptions:ae(ae({},vb.imagePlacementOptions),t?.imagePlacementOptions),multiFloorView:ae(ae({},vb.multiFloorView),t?.multiFloorView),disableUpdateStateValidation:(l=t?.disableUpdateStateValidation)!=null?l:!1});return u&&c.outdoorView&&(c.outdoorView.token=u),c}function Yje(t){let e={remove_watermark:!1};if(t)try{let r=_G(t);Object.assign(e,r.capabilities)}catch(r){Be.error("Error decoding capabilities from token",r)}return e}function Jje(t){let e=Object.fromEntries(Object.entries(t).filter(([r])=>Wje.has(r)));return e.outdoorView&&(e.outdoorView=Object.fromEntries(Object.entries(e.outdoorView).filter(([r])=>Hje.has(r)))),e}var Hd,pl,Dh,nte=class O2 extends uf{constructor(e,r){let n=Object.values(r.mvfDataByFloorId)[0];super(e,n),S(this,"__type",O2.__type),K(this,Hd),K(this,pl),K(this,Dh),ne(this,pl,{}),ne(this,Hd,e),ne(this,Dh,r.mvfDataByFloorId)}static is(e){return e.__type===O2.__type}get accessible(){var e;return(e=Object.values(f(this,Dh))[0].properties.accessible)!=null?e:!1}get type(){var e,r;return(r=(e=Object.values(f(this,Dh))[0].properties.kind)==null?void 0:e.split(".")[1])!=null?r:"unknown"}get extra(){return Object.values(f(this,Dh))[0].properties.extra}get coordinates(){return f(this,pl).coordinates==null&&(f(this,pl).coordinates=Object.entries(f(this,Dh)).map(([e,r])=>rh(r,e))),f(this,pl).coordinates}get nodes(){return Object.values(f(this,Dh))[0].properties.nodes.map(e=>f(this,Hd).getById("node",e))}get floors(){return this.coordinates.map(e=>e.floorId?f(this,Hd).getById("floor",e.floorId):void 0).filter($q)}get locationProfiles(){var e,r,n,i,a;if(f(this,pl).locationProfiles!=null)return f(this,pl).locationProfiles;let o=super.locationProfiles;if(o==null||o.length===0){let s=[(r=(e=this.coordinates[0])==null?void 0:e.longitude)!=null?r:0,(i=(n=this.coordinates[0])==null?void 0:n.latitude)!=null?i:0],l=$0(s),u=(a=f(this,Hd).mvfConnectionIdsByLatLon[l])!=null?a:[];for(let c of u){let h=f(this,Hd).locationProfilesByAttachedFeatureId[c];if(h!=null){o=h;break}}}return f(this,pl).locationProfiles=o??[],o}get focusTarget(){return this.coordinates}toJSON(){return{__type:O2.__type,id:this.id,name:this.name,type:this.type,externalId:this.externalId,coordinates:this.coordinates.map(e=>e.toJSON()),floors:this.floors.map(e=>e.id),extra:this.extra}}destroy(){for(let e of Object.keys(f(this,pl)))delete f(this,pl)[e]}};Hd=new WeakMap,pl=new WeakMap,Dh=new WeakMap,S(nte,"__type","connection");var Kje=nte,Md=Kje;C();var sm,lm,zs,Xd,ite=class B2 extends uf{constructor(e,r){super(e,r.mvfData),S(this,"__type",B2.__type),K(this,sm),K(this,lm),K(this,zs,{}),K(this,Xd),ne(this,sm,e),ne(this,lm,r.floorId),ne(this,Xd,r.mvfData)}static is(e){return e.__type===B2.__type}get type(){let e=f(this,Xd).properties.kind;return e==null&&(e="object"),e==="Desks"&&(e="desk"),e.toLowerCase()}get locations(){if(f(this,zs).locations)return f(this,zs).locations;f(this,zs).locations=[];let e=f(this,sm).mvfLocationsByGeometryId[f(this,Xd).properties.id];if(e?.length>0)for(let r of e){let n=f(this,sm).getById("enterprise-location",r.id);n&&f(this,zs).locations.push(n)}return f(this,zs).locations}get floor(){let e=f(this,sm).getById("floor",f(this,lm));if(e==null)throw new Error("Floor ".concat(f(this,lm)," not found!"));return e}get center(){return f(this,zs).center==null&&(f(this,zs).center=rh(f(this,Xd),f(this,lm))),f(this,zs).center}get geoJSON(){return lt(ae({},f(this,Xd)),{properties:null})}get anchorTarget(){return this.center}get focusTarget(){return this.geoJSON.geometry.type==="Polygon"?this:this.center}toJSON(){return{__type:B2.__type,id:this.id,name:this.name,type:this.type,floor:this.floor.id,center:this.center.toJSON()}}destroy(){for(let e of globalThis.Object.keys(f(this,zs)))f(this,zs)[e]=null}};sm=new WeakMap,lm=new WeakMap,zs=new WeakMap,Xd=new WeakMap,S(ite,"__type","object");var Qje=ite,Wp=Qje;C();var z2,um,qd,Jy,ate=class F2 extends uf{constructor(e,r){super(e,r.mvfData),S(this,"__type",F2.__type),K(this,z2),K(this,um),K(this,qd,{}),K(this,Jy),ne(this,z2,e),ne(this,Jy,r.mvfData),ne(this,um,r.floorId)}static is(e){return e.__type===F2.__type}get floor(){let e=f(this,z2).getById("floor",f(this,um));if(e==null)throw new Error("Floor ".concat(f(this,um)," not found!"));return e}get coordinate(){return f(this,qd).coordinate==null&&(f(this,qd).coordinate=rh(f(this,Jy),f(this,um))),f(this,qd).coordinate}get geoJSON(){return lt(ae({},f(this,Jy)),{properties:null})}get focusTarget(){return this.coordinate}get anchorTarget(){return this.coordinate}toJSON(){return{__type:F2.__type,id:this.id,name:this.name,floor:this.floor.id,coordinate:this.coordinate.toJSON()}}destroy(){for(let e in f(this,qd))f(this,qd)[e]=null}};z2=new WeakMap,um=new WeakMap,qd=new WeakMap,Jy=new WeakMap,S(ate,"__type","point-of-interest");var eVe=ate,cf=eVe;C();var Ky,cm,Jl,Gm,hm,R2,LT,ote=class L2 extends uf{constructor(e,r){var n;super(e,r.mvfData),K(this,R2),S(this,"__type",L2.__type),K(this,Ky),K(this,cm),K(this,Jl,{}),K(this,Gm),K(this,hm),ne(this,Ky,e),ne(this,cm,r.floorId),ne(this,Gm,r.mvfData),ne(this,hm,(n=r.symbol)!=null?n:{url:"",name:""})}static is(e){return e.__type===L2.__type}get group(){return ot(this,R2,LT).call(this).group}get type(){return ot(this,R2,LT).call(this).type}get coordinate(){return f(this,Jl).coordinate==null&&(f(this,Jl).coordinate=rh(f(this,Gm),f(this,cm))),f(this,Jl).coordinate}get floor(){let e=f(this,Ky).getById("floor",f(this,cm));if(e==null)throw new Error("Floor ".concat(f(this,cm)," not found!"));return e}get name(){return super.name||f(this,hm).name||""}get icon(){return f(this,Jl).icon==null&&(f(this,Jl).icon=super.icon||new aA({mvfData:{url:f(this,hm).url,altText:f(this,hm).name},mapData:f(this,Ky)})),f(this,Jl).icon}get geoJSON(){return lt(ae({},f(this,Gm)),{properties:null})}get focusTarget(){return this.coordinate}get anchorTarget(){return this.coordinate}toJSON(){return{__type:L2.__type,id:this.id,group:this.group,type:this.type,coordinate:this.coordinate.toJSON()}}destroy(){for(let e of Object.keys(f(this,Jl)))delete f(this,Jl)[e]}};Ky=new WeakMap,cm=new WeakMap,Jl=new WeakMap,Gm=new WeakMap,hm=new WeakMap,R2=new WeakSet,LT=function(){let[t,e]=f(this,Gm).properties.symbolId.split("--");return{group:t,type:e}},S(ote,"__type","annotation");var tVe=ote,L_=tVe;C();var lp,fl,su,Qy,N2,NT,ste=class $2 extends uS{constructor(e,r){super(r.mvfData.id,e),K(this,N2),S(this,"__type",$2.__type),K(this,lp),K(this,fl,{}),K(this,su),K(this,Qy),ne(this,lp,e),ne(this,su,r.mvfData),ne(this,Qy,r.facadeId)}static is(e){return e.__type===$2.__type}get type(){return f(this,su).type}get name(){let e=ot(this,N2,NT).call(this,"name");return typeof e=="string"?e:""}get shortName(){let e=ot(this,N2,NT).call(this,"shortName");return typeof e=="string"?e:""}get externalId(){var e;return(e=f(this,su).externalId)!=null?e:""}get floors(){var e,r;if(f(this,fl).floors==null){let n=((r=(e=f(this,su).floors)!=null?e:f(this,su).maps)!=null?r:[]).reduce((i,a)=>{let o=f(this,lp).floorsById[a];return o&&i.push(o),i},[]);n.length===0&&Be.error("Floor stack ".concat(this.id," has no floors")),f(this,fl).floors=n.sort((i,a)=>i.elevation-a.elevation)}return f(this,fl).floors}get defaultFloor(){if(f(this,fl).defaultFloor!=null)return f(this,fl).defaultFloor;let e=f(this,su).defaultFloor?f(this,lp).getById("floor",f(this,su).defaultFloor):void 0;return f(this,fl).defaultFloor=e||this.floors.reduce((r,n)=>Math.abs(n.elevation)<Math.abs(r.elevation)?n:r),f(this,fl).defaultFloor}get facade(){return f(this,Qy)?f(this,lp).facadesById[f(this,Qy)]:void 0}toJSON(){return{__type:$2.__type,id:this.id,name:this.name,shortName:this.shortName,type:this.type,floors:this.floors.map(e=>e.id)}}destroy(){for(let e of globalThis.Object.keys(f(this,fl)))delete f(this,fl)[e]}};lp=new WeakMap,fl=new WeakMap,su=new WeakMap,Qy=new WeakMap,N2=new WeakSet,NT=function(t){return f(this,lp).getPropTranslation(this.__type,t,this.id,f(this,su)[t])},S(ste,"__type","floor-stack");var rVe=ste,nVe=rVe;C();var ev,dm,tv,pc,lte=class U2 extends uS{constructor(e,r){super(r.mvfData.id,e),S(this,"__type",U2.__type),K(this,ev),K(this,dm),K(this,tv),K(this,pc,{}),ne(this,ev,r.mvfData),ne(this,dm,e),ne(this,tv,r.floorStackId)}static is(e){return e.__type===U2.__type}get floorStack(){return f(this,dm).getById("floor-stack",f(this,tv))}get spaces(){if(!f(this,pc).spaces){f(this,pc).spaces=[];for(let e of f(this,ev).spaces){let r=f(this,dm).getById("space",e.spaceId);r&&f(this,pc).spaces.push(r)}}return f(this,pc).spaces}get center(){if(!f(this,pc).center){let e={type:"FeatureCollection",features:[]};for(let n of this.spaces){let i=f(this,dm).mvfSpacesById[n.id];i&&e.features.push(i)}if(e.features.length===0)throw new ho("No geometry found for facade!");let r=eB(e);f(this,pc).center=new Rr({latitude:r.geometry.coordinates[1],longitude:r.geometry.coordinates[0],floorId:f(this,ev).spaces[0].floorId})}return f(this,pc).center}get focusTarget(){return this.spaces}get anchorTarget(){return this.center}toJSON(){return{id:this.id,__type:U2.__type,floorStackId:f(this,tv),floorStack:this.floorStack,spaces:this.spaces}}};ev=new WeakMap,dm=new WeakMap,tv=new WeakMap,pc=new WeakMap,S(lte,"__type","facade");var iVe=lte,Nl=iVe;C();var aVe=new Set(["wall","area"]),oVe=new Set(["void","desk-entrance"]),sVe=(t,e)=>{var r,n,i,a,o,s,l,u,c,h,d;let p={},m={},y={},v={},_={},w={};for(let b of t["location.json"]||[]){let A=new sB(e,{mvfData:b});if(p[b.id]=A,b.externalId&&(v[b.externalId]==null&&(v[b.externalId]=[]),v[b.externalId].push(A)),b.categories)for(let M of b.categories)_[M]==null&&(_[M]=[]),_[M].push(A);let E=[...(n=(r=b.obstructions)==null?void 0:r.map(M=>M.id))!=null?n:[],...(a=(i=b.spaces)==null?void 0:i.map(M=>M.id))!=null?a:[],...(s=(o=b.annotations)==null?void 0:o.map(M=>M.id))!=null?s:[],...(l=b.connections)!=null?l:[],...(c=(u=b.entrances)==null?void 0:u.map(M=>M.id))!=null?c:[],...(d=(h=b.areas)==null?void 0:h.map(M=>M.id))!=null?d:[]];for(let M of E)M&&(w[M]==null&&(w[M]=[]),w[M].push(A))}for(let b of t["category.json"]||[]){let A=new PGe(e,{mvfData:b});m[b.id]=A,b.parent&&(y[b.parent]==null&&(y[b.parent]=[]),y[b.parent].push(A))}return{locationCategoriesByParentId:y,locationProfilesById:p,locationCategoriesById:m,locationProfilesByExternalId:v,locationProfilesByCategoryId:_,locationProfilesByAttachedFeatureId:w}},lVe=(t,e,r)=>{var n;let i={},a={},o={},s={},l={},u={},c={},h={},d={},p={},m={},y=globalThis.Object.keys(t.space);for(let v of y){let _=t.space[v];if(_!=null){for(let w of _.features)if(m[w.properties.id]=v,u[w.properties.id]=w,w.properties.kind==="desk-entrance"&&(l[w.properties.externalId]==null&&(l[w.properties.externalId]=[]),l[w.properties.externalId].push(...w.properties.destinationNodes)),!SVe(w)){if((n=w.properties.kind)!=null&&n.includes("connection")){let b=$0(w.geometry.coordinates);d[b]==null&&(d[b]=[]),d[b].push(w.properties.id);continue}if(w.properties.kind==="poi"||w.geometry.type==="Point"&&w.properties.kind==null){let b=new cf(r,{floorId:v,mvfData:w});o[w.properties.id]=b,h[v]||(h[v]=[]),h[v].push(w),w.properties.externalId&&(s[w.properties.externalId]==null&&(s[w.properties.externalId]=[]),s[w.properties.externalId].push(b))}else if(w.geometry.type==="Point")Be.warn("Encountered a point space with an unknown kind!",w.properties.kind);else{let b=new Xs(r,{floorId:v,mvfData:w});i[w.properties.id]=b,w.properties.externalId&&(a[w.properties.externalId]==null&&(a[w.properties.externalId]=[]),a[w.properties.externalId].push(b)),c[v]||(c[v]=[]),c[v].push(w)}}}}for(let v in d){let _=d[v],w={};for(let A of _){let E=m[A],M=u[A],P=e?.["n_"+M.properties.id.split("s_")[1]];w[E]=lt(ae({},M),{properties:lt(ae({},M.properties),{accessible:P?.accessible===!0})})}let b=new Md(r,{mvfDataByFloorId:w});p[b.id]=b}return{spacesById:i,spacesByExternalId:a,poisById:o,poisByExternalId:s,connectionsById:p,objectEntranceNodeIdsByObstructionId:l,mvfSpacesById:u,connectionIdsByLatLon:d,mvfSpacesByFloorId:c,mvfPoisByFloorId:h}},uVe=(t,e)=>{var r,n;let i={},a={},o={},s={};for(let l of t["node.geojson"].features){o[l.properties.id]=l;let u=new t0(e,{mvfData:l,floorId:(r=l.properties.floor)!=null?r:l.properties.map});i[l.properties.id]=u,l.properties.externalId&&(a[l.properties.externalId]==null&&(a[l.properties.externalId]=[]),a[l.properties.externalId].push(u));let c=(n=l.properties.floor)!=null?n:l.properties.map;s[c]||(s[c]=[]),s[c].push(l)}return{nodesById:i,nodesByExternalId:a,mvfNodesById:o,mvfNodesByFloorId:s}},cVe=(t,e)=>{var r,n;let i={},a={},o={},s={},l=globalThis.Object.keys(t.obstruction);for(let u of l){let c=t.obstruction[u];if(c!=null)for(let h of c.features){o[h.properties.id]=h;for(let p of h.properties.entrances)s[p]=h.properties.id;if(aVe.has((n=(r=h.properties.kind)==null?void 0:r.toLowerCase())!=null?n:""))continue;let d=new Wp(e,{floorId:u,mvfData:h});i[h.properties.id]=d,h.properties.externalId&&(a[h.properties.externalId]==null&&(a[h.properties.externalId]=[]),a[h.properties.externalId].push(d))}}return{objectsById:i,objectsByExternalId:a,mvfObstructionById:o,obstructionIdByEntranceId:s}},hVe=(t,e)=>{let r={},n={},i={};if("floor.geojson"in t&&t["floor.geojson"]!=null)for(let a of t["floor.geojson"].features){i[a.properties.id]=a.properties;let o=new Fc(e,{mvfData:a});r[a.properties.id]=o,a.properties.externalId&&(n[a.properties.externalId]==null&&(n[a.properties.externalId]=[]),n[a.properties.externalId].push(o))}else for(let a of t["map.geojson"]){i[a.id]=a;let o=new Fc(e,{mvfData:{properties:a}});r[a.id]=o}return{floorsById:r,floorsByExternalId:n,mvfFloorsById:i}},dVe=(t,e)=>{var r;let n={},i={},a={},o={},s={},l=t["floorstack.json"]||t["mapstack.json"]||t["mapstack.geojson"];if(l!=null)for(let u of l){let c=(r=t.facade)==null?void 0:r[u.id],h=new nVe(e,{mvfData:u,facadeId:c?.id});if(n[u.id]=h,u.externalId&&(i[u.externalId]==null&&(i[u.externalId]=[]),i[u.externalId].push(h)),a[u.id]=u,c){let d=new Nl(e,{mvfData:c,floorStackId:u.id});o[c.id]=d;for(let p of c.spaces)s[p.spaceId]=d}}return{floorStacksById:n,floorStacksByExternalId:i,mvfFloorStacksById:a,facadesById:o,facadesBySpaceId:s}},pVe=(t,e)=>{let r={},n={},i=t["connection.json"].reduce((a,o)=>{o.nodes.forEach(l=>a[l]=o),r[o.id]=o;let s=e?.[o.nodes[0]];if(s!=null){let l=$0(s.geometry.coordinates);n[l]==null&&(n[l]=[]),n[l].push(o.id)}return a},{});return{mvfConnectionsById:r,mvfConnectionsByNodeId:i,mvfConnectionIdsByLatLon:n}},fVe=(t,e)=>{let r={},n={},i={},a={},o={},s=globalThis.Object.keys(t.entrance);for(let l of s){let u=t.entrance[l];if(u!=null)for(let c of u.features){a[c.properties.id]=c;let h=new Cd(e,{floorId:l,mvfData:c});c.properties.node&&(i[c.properties.node]=h),r[c.properties.id]=h,c.properties.externalId&&(n[c.properties.externalId]==null&&(n[c.properties.externalId]=[]),n[c.properties.externalId].push(h)),o[l]||(o[l]=[]),o[l].push(c)}}return{doorsById:r,doorsByExternalId:n,doorsByNodeId:i,mvfEntrancesById:a,mvfEntrancesByFloorId:o}},mVe=(t,e,r)=>{var n;if(t.textAreas!=null)for(let i in t.textAreas){let a=(n=t.textAreas[i])==null?void 0:n.features;if(a!=null){for(let o of a)if("anchorId"in o.properties){let s=o?.properties,l=e[s.anchorId]||r[s.anchorId];if(l!=null&&s!=null){let u=l.properties;u.textArea=s,u.textArea&&(u.textArea.position=o.geometry.coordinates)}}}}},gVe=(t,e,r)=>{var n;if(t.floorImages!=null)for(let i in t.floorImages){let a=(n=t.floorImages[i])==null?void 0:n.features;if(a!=null){for(let o of a)if("anchorId"in o.properties){let s=o?.properties,l=e[s.anchorId]||r[s.anchorId];if(l!=null&&s!=null){let u=l.properties;u.image=s,u.image&&(u.image.position=o.geometry.coordinates)}}}}},yVe=(t,e)=>{var r,n;if(((r=t.enterprise)==null?void 0:r.enterpriseStyles)==null)return;let i=(n=t.enterprise)==null?void 0:n.enterpriseStyles;for(let a in i){let o=i[a];o.geometryAnchors.forEach(s=>{let l=e[s.geometryId];if(l!=null){let u=l.properties;u.style={styleId:a,edgeOffset:o.edgeOffset}}})}},vVe=(t,e,r)=>{if(!(t.enterprise==null||t.enterprise.textures==null))for(let n of t.enterprise.textures)for(let i of n.geometryAnchors){let a=e[i.geometryId]||r[i.geometryId];if(a!=null){let o=a.properties;o.textures==null&&(o.textures=[]),o.textures.push(n)}}},_Ve=(t,e)=>{let r={},n={},i={};if(t.annotation==null)return{annotationsById:r,mvfAnnotationsById:n,mvfAnnotationsByFloorId:i};let a=t["annotation-symbols.json"]||{},o=globalThis.Object.keys(t.annotation);for(let s of o){let l=t.annotation[s];if(l!=null)for(let u of l.features){n[u.properties.id]=u;let c=new L_(e,{floorId:s,mvfData:u,symbol:a[u.properties.symbolId]});r[u.properties.id]=c,i[s]||(i[s]=[]),i[s].push(u)}}return{annotationsById:r,mvfAnnotationsById:n,mvfAnnotationsByFloorId:i}},xVe=(t,e)=>{let r={},n={},i={};if(t.area==null)return{areasById:r,areasByExternalId:n,mvfAreasById:i};let a=globalThis.Object.keys(t.area);for(let o of a){let s=t.area[o];if(s!=null)for(let l of s.features){i[l.properties.id]=l;let u=new r0(e,{floorId:o,mvfData:l});r[l.properties.id]=u,l.properties.externalId&&(n[l.properties.externalId]==null&&(n[l.properties.externalId]=[]),n[l.properties.externalId].push(u))}}return{areasById:r,areasByExternalId:n,mvfAreasById:i}},bVe=(t,e)=>{var r;let n={},i={},a={},o={};for(let s in t){let l=t[s];if(l==null)continue;let u=(r=l.properties.destinationNodes)!=null?r:[];if(u.length<1)continue;let c=[];for(let h of u)e[h]!=null&&c.push(h),i[h]==null&&(i[h]=[]),i[h].push(l.properties.id),l.properties.kind==="desk-entrance"&&(a[h]==null&&(a[h]=[]),a[h].push(l.properties.externalId));c.length>0&&(n[s]=c),o[s]=u}return{entranceNodeIdsBySpaceId:n,spaceIdsByNodeId:i,objectIdsByNodeId:a,destinationNodesIdsBySpaceId:o}},wVe=(t,e)=>{var r,n,i,a,o,s,l,u,c,h,d,p,m;let y={},v={},_={},w={},b=((n=(r=t.enterprise)==null?void 0:r.locations)!=null?n:[]).reduce((R,T)=>(R[T.id]=T,R),{}),A={},E={},M={},P={},k={},D={},O=((i=t.enterprise)==null?void 0:i.venue)||{},B={};for(let R of(o=(a=t.enterprise)==null?void 0:a.categories)!=null?o:[]){let T=new TVe(e,{mvfData:R});A[R.id]=T,R.externalId&&(E[R.externalId]==null&&(E[R.externalId]=[]),E[R.externalId].push(T)),M[R.id]=R,R.locations.forEach(N=>{k[N]==null&&(k[N]=[]),k[N].push(R.id)})}let L={};for(let R of(l=(s=t.enterprise)==null?void 0:s.locationInstances)!=null?l:[]){let T=b[R.parent],N=Object.keys(T),$={};for(let G of N)$[G]=void 0;let V=ae(lt(ae({},$),{polygons:[],nodes:[]}),R);L[V.parent]==null&&(L[V.parent]=[]),L[V.parent].push(new L1(e,{mvfData:V,categoryIds:((c=(u=t.enterprise)==null?void 0:u.categoryPriorities)==null?void 0:c[V.id])||k[V.id],parentId:R.parent})),B[V.id]=R}for(let R of(d=(h=t.enterprise)==null?void 0:h.locations)!=null?d:[]){let T=new L1(e,{mvfData:R,categoryIds:((m=(p=t.enterprise)==null?void 0:p.categoryPriorities)==null?void 0:m[R.id])||k[R.id],locationInstances:L[R.id]});_[R.id]=T,R.externalId&&(w[R.externalId]==null&&(w[R.externalId]=[]),w[R.externalId].push(T)),R.nodes.forEach(N=>{D[N.id]==null&&(D[N.id]=[]),D[N.id].push(R.id)});for(let N of R.polygons)P[N.id]==null&&(P[N.id]=[]),P[N.id].push(R)}if(e.enterpriseMode===!0){for(let R in e.mvfConnectionsById){let T={},N=e.mvfConnectionsById[R];for(let $ of e.mvfConnectionsById[R].nodes){let V=e.nodesById[$];V!=null&&(T[V.floor.id]={type:"Feature",geometry:{type:"Point",coordinates:[V.coordinate.longitude,V.coordinate.latitude]},properties:{id:R,externalId:N.externalId,kind:"enterprise."+N.type,destinationNodes:[],flags:N.flags,type:N.type,nodes:N.nodes,accessible:N.accessible,extra:N.extra,details:N.details}})}Object.keys(T).length>0&&(y[R]=new Md(e,{mvfDataByFloorId:T}),N.externalId&&(v[N.externalId]==null&&(v[N.externalId]=[]),v[N.externalId].push(y[R])))}e.connectionsById=y}return{connectionsByExternalId:v,locationIdsByNodeId:D,mvfLocationsByGeometryId:P,mvfLocationsById:b,mvfCategoriesById:M,locationsById:_,locationsByExternalId:w,locationInstancesById:B,categoriesById:A,categoriesByExternalId:E,venue:O}},AVe=(t,e)=>{let{nodesById:r,nodesByExternalId:n,mvfNodesById:i,mvfNodesByFloorId:a}=uVe(t,e),{mvfConnectionsById:o,mvfConnectionsByNodeId:s,mvfConnectionIdsByLatLon:l}=pVe(t,i),{spacesById:u,spacesByExternalId:c,poisById:h,poisByExternalId:d,mvfSpacesById:p,objectEntranceNodeIdsByObstructionId:m,connectionsById:y,connectionIdsByLatLon:v,mvfSpacesByFloorId:_,mvfPoisByFloorId:w}=lVe(t,s,e),{objectsById:b,objectsByExternalId:A,mvfObstructionById:E,obstructionIdByEntranceId:M}=cVe(t,e),{floorsById:P,floorsByExternalId:k,mvfFloorsById:D}=hVe(t,e),{floorStacksById:O,floorStacksByExternalId:B,mvfFloorStacksById:L,facadesById:R,facadesBySpaceId:T}=dVe(t,e),{doorsById:N,doorsByExternalId:$,doorsByNodeId:V,mvfEntrancesById:G,mvfEntrancesByFloorId:ee}=fVe(t,e),{annotationsById:ie,mvfAnnotationsById:me,mvfAnnotationsByFloorId:Me}=_Ve(t,e),{areasById:Ae,areasByExternalId:le,mvfAreasById:_e}=xVe(t,e);gVe(t,p,E),mVe(t,p,E),yVe(t,p),vVe(t,p,E);let{locationCategoriesByParentId:Le,locationProfilesById:Se,locationCategoriesById:Ue,locationProfilesByExternalId:Y,locationProfilesByCategoryId:we,locationProfilesByAttachedFeatureId:q}=sVe(t,e),{entranceNodeIdsBySpaceId:oe,spaceIdsByNodeId:ce,objectIdsByNodeId:X,destinationNodesIdsBySpaceId:ke}=bVe(p,V);return{spacesById:u,spacesByExternalId:c,nodesById:r,nodesByExternalId:n,objectsById:b,objectsByExternalId:A,floorsById:P,floorsByExternalId:k,floorStacksById:O,floorStacksByExternalId:B,facadesById:R,facadesBySpaceId:T,connectionsById:y,doorsById:N,doorsByExternalId:$,doorsByNodeId:V,poisById:h,poisByExternalId:d,annotationsById:ie,areasById:Ae,areasByExternalId:le,objectEntranceNodeIdsByObstructionId:m,obstructionIdByEntranceId:M,connectionIdsByLatLon:v,locationProfilesById:Se,locationCategoriesById:Ue,locationProfilesByExternalId:Y,locationProfilesByCategoryId:we,locationCategoriesByParentId:Le,mvfSpacesById:p,mvfNodesById:i,mvfObstructionById:E,mvfFloorsById:D,mvfFloorStacksById:L,mvfConnectionsById:o,mvfConnectionsByNodeId:s,mvfEntrancesById:G,mvfAnnotationsById:me,mvfNodesByFloorId:a,mvfSpacesByFloorId:_,mvfPoisByFloorId:w,mvfAreasById:_e,mvfEntrancesByFloorId:ee,mvfAnnotationsByFloorId:Me,locationProfilesByAttachedFeatureId:q,mvfConnectionIdsByLatLon:l,entranceNodeIdsBySpaceId:oe,spaceIdsByNodeId:ce,objectIdsByNodeId:X,destinationNodesIdsBySpaceId:ke}};function SVe(t){var e;return!["Polygon","MultiPolygon"].includes(t.geometry.type)&&"kind"in t.properties&&t.properties.kind==null||oVe.has((e=t.properties.kind)!=null?e:"")}C();var EVe=new Set(["polygons"]),Fs,tn,ha,j2,ute=class V2 extends Id{constructor(e,r){super(r.mvfData.externalId),S(this,"__type",V2.__type),S(this,"description"),S(this,"name",""),S(this,"amenity"),S(this,"externalId",""),S(this,"extra"),S(this,"gallery"),S(this,"instances"),S(this,"logo"),S(this,"operationHours"),S(this,"phone"),S(this,"picture"),S(this,"shortName"),S(this,"showFloatingLabelWhenImagePresent"),S(this,"showLogo"),S(this,"siblingGroups"),S(this,"social"),S(this,"sortOrder",-1),S(this,"states"),S(this,"tags"),S(this,"type",""),S(this,"hidden",!1),S(this,"primaryCategory"),K(this,Fs),K(this,tn,{}),K(this,ha),K(this,j2),ne(this,Fs,e),ne(this,ha,r.mvfData),ne(this,j2,r.categoryIds||[]),this.instances=r.locationInstances||[];for(let n in r.mvfData)!EVe.has(n)&&!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),n)&&Object.defineProperty(this,n,{enumerable:!0,get(){if(r.parentId){let i=f(this,Fs).locationsById[r.parentId];return f(this,ha)[n]!=null?f(this,Fs).getPropTranslation(this.__type,n,f(this,ha).id,f(this,ha)[n]):f(this,Fs).getPropTranslation(this.__type,n,f(this,ha).id,i[n])}return f(this,Fs).getPropTranslation(this.__type,n,f(this,ha).id,f(this,ha)[n])}})}static is(e){return e.__type===V2.__type}get focusTarget(){return this.spaces}get categories(){return f(this,tn).categories?f(this,tn).categories:(f(this,tn).categories=(f(this,j2).map(e=>f(this,Fs).getById("enterprise-category",e))||[]).filter(Boolean),f(this,tn).categories)}get coordinates(){if(f(this,tn).coordinates)return f(this,tn).coordinates;f(this,tn).coordinates=[];for(let e=0;e<this.nodes.length;e++)f(this,tn).coordinates.push(this.nodes[e].coordinate);return f(this,tn).coordinates}get nodes(){if(f(this,tn).nodes)return f(this,tn).nodes;f(this,tn).nodes=[];for(let e=0;e<f(this,ha).nodes.length;e++){let r=f(this,Fs).getById("node",f(this,ha).nodes[e].id);r&&f(this,tn).nodes.push(r)}return f(this,tn).nodes}get points(){if(f(this,tn).points)return f(this,tn).points;f(this,tn).points=[];for(let e=0;e<f(this,ha).spaces.length;e++){let r=f(this,Fs).getById("point-of-interest",f(this,ha).spaces[e].id);r&&f(this,tn).points.push(r)}return f(this,tn).points}get spaces(){if(f(this,tn).spaces)return f(this,tn).spaces;f(this,tn).spaces=[];let e=Array.isArray(f(this,ha).spaces)?f(this,ha).spaces:f(this,ha).polygons;for(let r=0;r<e.length;r++){let n=f(this,Fs).getById("space",e[r].id);n&&f(this,tn).spaces.push(n)}return f(this,tn).spaces}get objects(){if(f(this,tn).objects)return f(this,tn).objects;f(this,tn).objects=[];for(let e=0;e<f(this,ha).polygons.length;e++){let r=f(this,Fs).getById("object",f(this,ha).polygons[e].id);r&&f(this,tn).objects.push(r)}return f(this,tn).objects}toJSON(){return{__type:V2.__type,id:this.id,name:this.name}}destroy(){for(let e of Object.keys(f(this,tn)))delete f(this,tn)[e]}};Fs=new WeakMap,tn=new WeakMap,ha=new WeakMap,j2=new WeakMap,S(ute,"__type","enterprise-location");var IVe=ute,L1=IVe;C();var CVe=new Set,pm,Bo,fc,cte=class G2 extends Id{constructor(e,r){super(r.mvfData.externalId),S(this,"__type",G2.__type),S(this,"name",""),S(this,"color"),S(this,"externalId",""),S(this,"extra"),S(this,"icon"),S(this,"iconFromDefaultList"),S(this,"sortOrder",-1),S(this,"picture"),K(this,pm),K(this,Bo,{}),K(this,fc),ne(this,pm,e),ne(this,fc,r.mvfData);for(let n in r.mvfData)!CVe.has(n)&&!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),n)&&Object.defineProperty(this,n,{get(){return f(this,pm).getPropTranslation(this.__type,n,f(this,fc).id,f(this,fc)[n])}})}static is(e){return e.__type===G2.__type}get children(){if(f(this,Bo).children)return f(this,Bo).children;f(this,Bo).children=[];for(let e=0;e<f(this,fc).children.length;e++){let r=f(this,pm).getById("enterprise-category",f(this,fc).children[e]);r&&f(this,Bo).children.push(r)}return f(this,Bo).children}get locations(){if(f(this,Bo).locations)return f(this,Bo).locations;f(this,Bo).locations=[];for(let e=0;e<f(this,fc).locations.length;e++){let r=f(this,pm).getById("enterprise-location",f(this,fc).locations[e]);r&&f(this,Bo).locations.push(r)}return f(this,Bo).locations}toJSON(){return{__type:G2.__type,id:this.id,name:this.name}}destroy(){for(let e of Object.keys(f(this,Bo)))delete f(this,Bo)[e]}};pm=new WeakMap,Bo=new WeakMap,fc=new WeakMap,S(cte,"__type","enterprise-category");var MVe=cte,TVe=MVe;C();var PVe=new Set,Z2,rv,hte=class W2 extends Id{constructor(e,r){super(r.mvfData.externalId),S(this,"__type",W2.__type),S(this,"countrycode"),S(this,"coverImage"),S(this,"externalId",""),S(this,"defaultLanguage",{code:"en",name:"English"}),S(this,"defaultFloor"),S(this,"extra"),S(this,"icon"),S(this,"languages",[]),S(this,"links",[]),S(this,"logo"),S(this,"mappedinWebUrl"),S(this,"operationHours"),S(this,"slug",""),S(this,"topLocations"),S(this,"tzid"),K(this,Z2,{}),K(this,rv),ne(this,rv,r.mvfData);for(let n in r.mvfData)!PVe.has(n)&&!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),n)&&(this[n]=r.mvfData[n])}static is(e){return e.__type===W2.__type}get name(){var e;return(e=f(this,rv).name)!=null?e:""}get defaultMap(){var e,r;return(r=(e=f(this,rv).defaultMap)!=null?e:this.defaultFloor)!=null?r:""}toJSON(){return{__type:W2.__type,id:this.id,name:this.name}}destroy(){for(let e of Object.keys(f(this,Z2)))delete f(this,Z2)[e]}};Z2=new WeakMap,rv=new WeakMap,S(hte,"__type","enterprise-venue");var DVe=hte,kVe=DVe;C();C();function $T(t,e,r=[]){let n=ae({},t);for(let[i,a]of Object.entries(e))if(a!==void 0)if(i in n){let o=i;if(Array.isArray(a)&&a.length>0){let s=OVe(a[0],r);if(s){let l=n[o];if(!Array.isArray(l))throw new Error("Expected array at ".concat(i,", got ").concat(typeof l));let u=new Map(a.map(h=>[ZR(h,s),h])),c=l.map(h=>{let d=u.get(ZR(h,s));return d?$T(h,d,r):h});n[o]=c}else n[o]=a}else{let s=n[o];typeof s=="object"&&s!==null&&typeof a=="object"&&a!==null?Object.keys(a).length===0?n[o]=a:n[o]=$T(s,a,r):n[i]=a}}else n[i]=a;return n}function OVe(t,e){function r(n){if(typeof n!="object"||n===null)return null;for(let i of e)if(i in n&&typeof n[i]<"u")return[i];if(Array.isArray(n))return null;for(let[i,a]of Object.entries(n)){let o=r(a);if(o)return[i,...o]}return null}return r(t)}function ZR(t,e){return e.reduce((r,n)=>{if(r&&typeof r=="object")return r[n]},t)}C();C();C();C();C();var BVe=(t=>(t.Departure="Departure",t.TakeConnection="TakeConnection",t.ExitConnection="ExitConnection",t.Turn="Turn",t.Arrival="Arrival",t))(BVe||{}),zVe=(t=>(t.Straight="Straight",t.Right="Right",t.SlightRight="SlightRight",t.Left="Left",t.SlightLeft="SlightLeft",t.Back="Back",t))(zVe||{}),FVe=(t=>(t.stairs="stairs",t.elevator="elevator",t.escalator="escalator",t.door="door",t.ramp="ramp",t.slide="slide",t.portal="portal",t.security="security",t.shuttle="shuttle",t.ladder="ladder",t))(FVe||{}),RVe=(t=>(t.Exterior="exterior-walls",t.Interior="interior-walls",t))(RVe||{}),LVe=(t=>(t.Interior="interior-doors",t.Exterior="exterior-doors",t))(LVe||{});function Sc(t){return t.verticalOffset===0?[t.longitude,t.latitude]:[t.longitude,t.latitude,t.verticalOffset]}function NVe(t){return new Map(t.map(e=>{let{properties:r}=e,{id:n}=r;return[n,e]}))}var WR=(t,e)=>{let r=NVe(e),n={entrances:{type:"FeatureCollection",features:[]},walls:{type:"Feature",properties:{id:t[0].properties.id},geometry:{type:"MultiLineString",coordinates:[]}}};for(let i of t){let a=[i.geometry.coordinates],o=(i.properties.entrances||[]).reduce((s,l)=>(r.has(l)&&s.push(r.get(l)),s),[]);if(o.length){let{entrances:s,obstructions:l}=wje(i,o);a=l.map(u=>u.geometry.coordinates),n.entrances.features.push(...s)}n.walls.geometry.coordinates.push(...a)}return n};function $Ve(t,e){return((e-t+Math.PI)%(Math.PI*2)+Math.PI*2)%(Math.PI*2)-Math.PI}function UVe(t,e){let r="Left";return t<=-Math.PI/4?r="Right":t<=-e?r="SlightRight":t<=e?r="Straight":t<=Math.PI/4?r="SlightLeft":r="Left",r}function jVe(t){let e={};for(let r in t){let n=t[r];if(n!=null){if(n.id=r,"polygons"in n)for(let i of n.polygons)e[i]=n;else if("lineStrings"in n)for(let i of n.lineStrings)e[i]=n;else if("points"in n)for(let i of n.points)e[i]=n}}return e}function HR(t,e){return t.reduce((r,n)=>{let i=e[n.properties.id];if(i==null)return r;if("textures"in n.properties&&Array.isArray(n.properties.textures)&&n.properties.textures.length>0){let a=lt(ae({},i),{id:i.id+"-textures"});r.set(a,[n])}else r.has(i)||r.set(i,[]),r.get(i).push(n);return r},new Map)}function by(t,e={}){var r,n,i,a,o,s,l;let u=lt(ae({},t),{flipImageToFaceCamera:(r=e?.flipImagesToFaceCamera)!=null?r:!0}),c=(i=(n=e?.style)==null?void 0:n.shading)!=null?i:e?.shadingAndOutlines;if(c===!0?u.shading={start:.1,end:.15,intensity:.4}:typeof c=="object"&&(u.shading={start:c.start,end:c.end,intensity:c.intensity}),u.outline=(o=(a=e?.style)==null?void 0:a.outlines)!=null?o:e?.shadingAndOutlines,"lineStrings"in t){let h=(l=(s=e?.style)==null?void 0:s.wallTopColor)!=null?l:e?.wallTopColor;h!=null&&(u.topColor=h)}return u}var VVe=(t,e)=>{var r;let n=((r=e.currentMap)==null?void 0:r.currentFloor).layers.get(Ma);switch(t){case"interior-walls":return n?.layers.get(cS);case"exterior-walls":return n?.layers.get(n0);case"interior-doors":return n?.layers.get(tB);case"exterior-doors":return n?.layers.get(rB);default:return typeof t=="string"?t:t?.id}};function XR(t){return new Promise(e=>{t.onComplete(e),t.onStop(e)})}function dte(t){return t.bbox?t.bbox:p_(t)}function GVe(t,e){return[Math.min(t[0],e[0]),Math.min(t[1],e[1]),Math.max(t[2],e[2]),Math.max(t[3],e[3])]}function UT(t,e,r){return t.floorId&&e.has(t.floorId)?e.get(t.floorId):r}function aB(t){if(Xs.is(t)||Wp.is(t))return t.id}function ZVe(t,e,r){var n,i;let a=t.coordinates.length===2&&t.coordinates[0].floorId!==t.coordinates[1].floorId,o=!0;if(a&&t.coordinates[0].floorId!=null&&t.coordinates[1].floorId!=null){let s=e?.getById("floor",t.coordinates[0].floorId),l=e?.getById("floor",t.coordinates[1].floorId);if(s&&l){let u=r.getState(s),c=r.getState(l);u!=null&&c!=null&&(o=u.visible&&c.visible&&u.altitude!==c.altitude)}}else{let s=t.coordinates[0].floorId!=null?e?.getById("floor",t.coordinates[0].floorId):void 0;o=s&&(i=(n=r.getState(s))==null?void 0:n.visible)!=null?i:!0}return o}function WVe(t,e){let r=t.properties.path.split("/"),n=r[r.length-1].split(".")[0],i=atob(n);return"img_"+wG(i).toString()+"-"+e}function o0(t="auto",e){return t==="auto"?e?Math.round(e*Vje):10:t}function HVe(t,e="auto"){if(!t.length)return new Map;let r=t.sort((s,l)=>s.elevation-l.elevation),n=r.findIndex(s=>s.elevation>=0);n===-1&&(n=r.length);let i=0,a=new Map;for(let s=n;s<r.length;s+=1){let l=r[s],u=r[s+1],c=l.elevation,h=u?u.elevation:void 0,d=h!==void 0?Math.max(0,h-c-1):0,p=s===n?c:0,m=o0(e,l.maxHeight)*(1+d+p),y=i;a.set(l.elevation,{altitude:y,effectiveHeight:m}),i+=m}let o=s=>-s-1;i=0;for(let s=n-1;s>=0;s-=1){let l=r[s],u=r[s-1],c=o(l.elevation),h=u?o(u.elevation):void 0,d=h!==void 0?Math.max(0,h-c-1):0,p=s===n-1?c:0,m=o0(e,l.maxHeight)*(1+d+p),y=-(i+m);a.set(l.elevation,{altitude:y,effectiveHeight:m}),i+=m}return a}function pte(t,e){let r=e(t.center);return{center:new Rr({latitude:r[1],longitude:r[0]}),radius:t.radius}}var qR=Math.PI*.1,zo,ls,Rs,kh,fm,nv,xc,fte,Pf,YR,XVe=class{constructor(t,e,r,n,i){K(this,xc),S(this,"id"),K(this,zo,{}),K(this,ls),K(this,Rs),S(this,"departure"),S(this,"destination"),K(this,kh),K(this,fm),K(this,nv);var a;this.id=(a=i?.id)!=null?a:Wn(),ne(this,ls,e),ne(this,Rs,t.features),this.departure=r,this.destination=n}get path(){return f(this,Rs).map(t=>f(this,ls).getById("node",t.properties.id)).filter(Boolean)}get coordinates(){return f(this,zo).coordinates?f(this,zo).coordinates:(f(this,zo).coordinates=f(this,Rs).map(t=>new Rr(t.geometry.coordinates[1],t.geometry.coordinates[0],t.properties.groupBy)),f(this,zo).coordinates)}get distance(){return f(this,zo).distance?f(this,zo).distance:(f(this,zo).distance=f(this,Rs).reduce((t,e)=>t+(e.properties.distance||0),0),f(this,zo).distance)}get instructions(){if(f(this,Rs).length<2)return[];if(f(this,zo).instructions)return f(this,zo).instructions;let t=[],e=0;for(let r=0;r<f(this,Rs).length;r++){let n=f(this,Rs)[r],i=f(this,Rs)[r-1],a=f(this,Rs)[r+1],o=new Rr(n.geometry.coordinates[1],n.geometry.coordinates[0],n.properties.groupBy),s=ot(this,xc,fte).call(this,{prevDirection:i,direction:n,nextDirection:a});e+=i?.properties.distance||0;for(let l of s)l&&(t.push({action:l,distance:e,coordinate:o,node:f(this,ls).getById("node",n.properties.id)}),e=0)}return f(this,zo).instructions=t,f(this,zo).instructions}toJSON(){return{id:this.id,directions:f(this,Rs),__type:"directions",from:this.departure,to:this.destination}}};zo=new WeakMap,ls=new WeakMap,Rs=new WeakMap,kh=new WeakMap,fm=new WeakMap,nv=new WeakMap,xc=new WeakSet,fte=function(t){var e,r;let{prevDirection:n,direction:i,nextDirection:a}=t,o=n&&f(this,ls).getById("floor",n.properties.groupBy),s=f(this,ls).getById("floor",i.properties.groupBy),l=a&&f(this,ls).getById("floor",a.properties.groupBy),u=[];n||u.push({type:"Departure"});let c=f(this,ls).getMVFFeatureByNodeId("connection",i.properties.id),h=c?f(this,ls).getById("connection",c.id):void 0,d=c&&c.nodes.length>1,p=f(this,ls).enterpriseMode&&(!i.properties.destination||!(c!=null&&c.nodes.includes(i.properties.destination))||!(c!=null&&c.nodes.includes(i.properties.id)));if(c&&!(!d||p))if(!f(this,kh)||f(this,kh)==="exit")u.push(ot(this,xc,Pf).call(this,"TakeConnection",s,l,h,c)),ne(this,kh,"take"),ne(this,fm,h),ne(this,nv,c);else{let m=f(this,ls).getMVFFeatureByNodeId("connection",(e=n?.properties.id)!=null?e:""),y=f(this,ls).getById("connection",(r=m?.id)!=null?r:"");u.push(ot(this,xc,Pf).call(this,"ExitConnection",s,o,y,m)),ne(this,kh,"exit"),ne(this,fm,h),ne(this,nv,c)}else f(this,kh)==="take"?(u.push(ot(this,xc,Pf).call(this,"ExitConnection",s,o,f(this,fm),f(this,nv))),ne(this,kh,"exit"),ne(this,fm,h)):l&&s?.id!==l.id?u.push(ot(this,xc,Pf).call(this,"TakeConnection",s,l,h)):o&&o.id!==s?.id?u.push(ot(this,xc,Pf).call(this,"ExitConnection",s,o,h)):u.push(ot(this,xc,YR).call(this,n,i));return a||u.push({type:"Arrival"}),u},Pf=function(t,e,r,n,i){var a,o;let s="none",l=e?e.elevation:0;if(l!=null&&r?.elevation!=null){let c=l-r.elevation;c>0?s="down":c<0&&(s="up")}let u=(o=(a=n?.type)!=null?a:i?.type)!=null?o:"stairs";return{type:t,fromFloor:e,toFloor:r,direction:s,connection:n,connectionType:u}},YR=function(t,e){let r=e.properties.edges;if(!r||r.filter(i=>i.destination.properties.id!==t?.properties.id&&i.destination.properties.id!==e.properties.destination).length===0)return null;let n=t?-$Ve(t.properties.angle,e.properties.angle):0;return Math.abs(n)>=qR?{type:"Turn",bearing:UVe(n,qR),referencePosition:"At"}:null};C();C();C();C();C();C();C();var jT=class{constructor({origin:t,destination:e,distance:r=0,angle:n=0,pathWeight:i=0,multiplicativeDistanceWeightScaling:a=!0}){if(S(this,"origin"),S(this,"destination"),S(this,"distance"),S(this,"angle"),S(this,"weight"),this.origin=t,this.destination=e,this.distance=r,this.angle=n,this.weight=i||0,a?t.properties.floor===e.properties.floor&&(this.weight=(this.weight>=0?this.distance*this.weight:0)+this.distance):t.properties.map===e.properties.map&&(this.weight=this.weight>=0?this.distance+this.weight:0),isNaN(this.angle))throw new Error("Invalid angle: Expected a numeric value, but received NaN.")}};C();C();C();function s0(t,e,r){if(r===void 0&&(r={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var n=Zp(t),i=oS(e),a=i.type,o=e.bbox,s=i.coordinates;if(o&&qVe(n,o)===!1)return!1;a==="Polygon"&&(s=[s]);for(var l=!1,u=0;u<s.length&&!l;u++)if(JR(n,s[u][0],r.ignoreBoundary)){for(var c=!1,h=1;h<s[u].length&&!c;)JR(n,s[u][h],!r.ignoreBoundary)&&(c=!0),h++;c||(l=!0)}return l}function JR(t,e,r){var n=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var i=0,a=e.length-1;i<e.length;a=i++){var o=e[i][0],s=e[i][1],l=e[a][0],u=e[a][1],c=t[1]*(o-l)+s*(l-t[0])+u*(t[0]-o)===0&&(o-t[0])*(l-t[0])<=0&&(s-t[1])*(u-t[1])<=0;if(c)return!r;var h=s>t[1]!=u>t[1]&&t[0]<(l-o)*(t[1]-s)/(u-s)+o;h&&(n=!n)}return n}function qVe(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}C();C();function dg([t,e],[r,n]){let i=e-n,a=t-r;return(Math.atan2(a,i)+Math.PI*3)%(Math.PI*2)}C();C();function _I(t,e,r,n){let[i,a]=t,[o,s]=e,[l,u]=r,[c,h]=n;if(a===s&&i===o||u===h&&l===c)return null;let d=(c-l)*(s-a)-(h-u)*(o-i);if(d===0)return null;let p=((h-u)*(i-l)-(c-l)*(a-u))/d,m=((s-a)*(i-l)-(o-i)*(a-u))/d;if(p<0||p>1||m<0||m>1)return null;let y=a+p*(s-a);return[i+p*(o-i),y]}C();function KR(t,e,r,n){let i=iA(t,r/1e3,n),a=iA(e,r/1e3,n);return[i.geometry.coordinates,a.geometry.coordinates]}C();function QR(t){let e=t*(180/Math.PI);return e=e%360,e>180?e-=360:e<-180&&(e+=360),Object.is(e,-0)?0:e}var eL=111e3;function mte(t,e,r=[],n=0){let i=!0,a=t.geometry.coordinates,o=e.geometry.coordinates,s=QR(dg(a,o)-Math.PI/2),l=QR(dg(a,o)+Math.PI/2),u=n/eL,c=n/(eL*Math.cos(a[1]*Math.PI/180)),h=Math.min(a[1],o[1])-u,d=Math.max(a[1],o[1])+u,p=Math.min(a[0],o[0])-c,m=Math.max(a[0],o[0])+c;for(let y of r)if(!(Math.max(y[0][1],y[1][1])<h||Math.min(y[0][1],y[1][1])>d||Math.max(y[0][0],y[1][0])<p||Math.min(y[0][0],y[1][0])>m)){if(n>0){let v=KR(a,o,n,s),_=KR(a,o,n,l);if(_I(v[0],v[1],y[0],y[1])||_I(_[0],_[1],y[0],y[1]))return i=!1,!1}else if(_I(a,o,y[0],y[1]))return i=!1,!1}return i}var gte=.4,mm,Kl,VT,yte,vte,_te,xte,bte,wte,GT,YVe=class{constructor({nodes:t,groupBy:e,multiplicativeDistanceWeightScaling:r}){K(this,Kl),S(this,"edges",{}),S(this,"nodesById"),S(this,"nodesByGroup",new Map),K(this,mm),S(this,"hasLineOfSight",(i,a,o=[],s=gte)=>mte({geometry:{type:"Point",coordinates:i}},{geometry:{type:"Point",coordinates:a}},o,s)===!0),K(this,GT,(i,a)=>{let o=0;for(let s of a)(!s[f(this,mm)]||s[f(this,mm)]===i.properties[f(this,mm)])&&s0(i.geometry.coordinates,s.geometry.geometry)&&(o+=Math.max(0,s.cost));return o}),ne(this,mm,e);let{features:n}=t;this.nodesById=ot(this,Kl,yte).call(this,n),ot(this,Kl,vte).call(this),ot(this,Kl,_te).call(this,n,e,{multiplicativeDistanceWeightScaling:r})}getShortestEuclideanDistance(t,e){return e.reduce((r,n)=>{let i=Ume(t.geometry.coordinates,n.geometry.coordinates);return Math.min(r,i)},Number.MAX_VALUE)}dijkstraFindWithinTravelDistance(t,e,r,n,i,a){var o;let s=this.nodesById[t];if(!s)return[];let l=[],u={},c={},h=new Set,d=[];for(l.push({node:s,distance:0}),u[s.properties.id]=null,c[s.properties.id]=0;l.length>0;){l.sort((v,_)=>v.distance-_.distance);let p=l.shift();if(!p)break;let m=p.node,y=p.distance;if(!h.has(m.properties.id)){if(h.add(m.properties.id),d.length>=a)break;m.properties.id!=null&&r.includes((o=m.properties.id)==null?void 0:o.toString())&&(i?this.hasLineOfSight(s.geometry.coordinates,m.geometry.coordinates,n)&&d.push({feature:m,distance:y}):d.push({feature:m,distance:y}));for(let v of this.edges[m.properties.id]){let _=v.destination,w=y+v.distance,b=c[m.properties.id]+v.weight;w>e||h.has(_.properties.id)||c[_.properties.id]!==void 0&&b>=c[_.properties.id]||(c[_.properties.id]=b,u[_.properties.id]=v,l.push({node:_,distance:w}))}}}return d.sort((p,m)=>p.distance-m.distance)}aStar({originIds:t,destinationNodeIds:e,disabledConnectionNodeIds:r,zones:n,overrideEdgeWeights:i,disabledNodeIds:a}){var o;let s=ot(this,Kl,VT).call(this,t),l=ot(this,Kl,VT).call(this,e);if(s.length===0||l.length===0)return[];let{frontier:u,cameFrom:c,costSoFar:h}=ot(this,Kl,xte).call(this,s,l);for(;u.length>0;){let d=u.shift();if(!d)break;if(ot(this,Kl,bte).call(this,d.origin,l))return ot(this,Kl,wte).call(this,c,d.origin.properties.id);for(let p of this.edges[d.origin.properties.id]){let m=(o=i?.get(p))!=null?o:p.weight;if(r!=null&&r.has(p.origin.properties.id)&&p.destination.properties.map!==p.origin.properties.map||a!=null&&a.has(p.origin.properties.id))continue;let y=h[d.origin.properties.id]+m+f(this,GT).call(this,p.destination,n);if(y!==1/0&&(h[p.destination.properties.id]==null||y<h[p.destination.properties.id])){let v=y+this.getShortestEuclideanDistance(p.destination,l);h[p.destination.properties.id]=y,c[p.destination.properties.id]=p,u.push({origin:p.destination,priority:v})}}u.sort((p,m)=>p.priority-m.priority)}return[]}};mm=new WeakMap,Kl=new WeakSet,VT=function(t){return t.map(e=>this.nodesById[e]).filter(Boolean)},yte=function(t){return t.reduce((e,r)=>(e[r.properties.id]=r,e),{})},vte=function(){for(let t in this.nodesById)this.nodesById.hasOwnProperty(t)&&(this.nodesById[t].properties.neighbors=this.nodesById[t].properties.neighbors.filter(({id:e})=>!!this.nodesById[e]))},_te=function(t,e,r){t.forEach(n=>{let i=e==="default"?e:n.properties[e];this.nodesByGroup.has(i)||this.nodesByGroup.set(i,[]),this.nodesByGroup.get(i).push(n),this.edges[n.properties.id]=n.properties.neighbors.map(({id:a,weight:o})=>{let s=this.nodesById[a],l=Cp(n.geometry.coordinates,s.geometry.coordinates),u=dg(n.geometry.coordinates,s.geometry.coordinates);return new jT({origin:n,destination:s,pathWeight:o,distance:l,angle:u,multiplicativeDistanceWeightScaling:r?.multiplicativeDistanceWeightScaling})})})},xte=function(t,e){let r=[],n={},i={};return t.forEach(a=>{let o=this.getShortestEuclideanDistance(a,e);r.push({origin:a,priority:o}),n[a.properties.id]=null,i[a.properties.id]=0}),r.sort((a,o)=>a.priority-o.priority),{frontier:r,cameFrom:n,costSoFar:i}},bte=function(t,e){return e.some(r=>r.properties.id===t.properties.id)},wte=function(t,e){let r=[],n=t[e];for(;n;)r.push(n),n=t[n.origin.properties.id];return r.reverse()},GT=new WeakMap;C();function tL(t,e,r){if(t==null||t[e]==null)return!1;let n=1<<r;return(t[e]&n)!==0}var JVe=class{constructor({nodes:t,geojsonCollection:e,groupBy:r="default",multiplicativeDistanceWeightScaling:n,flagDeclarations:i}){S(this,"groupBy"),S(this,"graph"),S(this,"geometryEdgesByMapId",new Map),S(this,"flagDeclarations",{}),S(this,"disabledNodeIds"),S(this,"generatePath",o=>{let{destination:s}=o[o.length-1],l={type:"FeatureCollection",features:[]};for(let c=0;c<o.length;c++){let{origin:h,destination:d}=o[c],p={id:h.properties.id,angle:o[c].angle,distance:o[c].distance,destination:d.properties.id,edges:this.graph.edges[h.properties.id]};this.groupBy!=="default"&&(p.groupBy=h.properties[this.groupBy]),l.features.push({type:"Feature",geometry:{type:"Point",coordinates:[h.geometry.coordinates[0],h.geometry.coordinates[1]]},properties:p})}let u={id:s.properties.id,edges:this.graph.edges[s.properties.id]};return this.groupBy!=="default"&&(u.groupBy=s.properties[this.groupBy]),l.features.push({type:"Feature",geometry:{type:"Point",coordinates:[s.geometry.coordinates[0],s.geometry.coordinates[1]]},properties:u}),l}),S(this,"findNearestNodesOnGraph",(o,s,l,u,c=!1,h=1/0)=>{var d;return this.graph.dijkstraFindWithinTravelDistance(o,s,u,(d=this.geometryEdgesByMapId.get(l))!=null?d:[],c,h)}),S(this,"hasLineOfSight",(o,s,l,u)=>this.graph.hasLineOfSight(o,s,this.geometryEdgesByMapId.get(l),u)),S(this,"getDistance",(o,s)=>Cp(o,s)),S(this,"getAngle",(o,s)=>dg(o,s)),this.groupBy=r,this.graph=new YVe({nodes:t,groupBy:this.groupBy,multiplicativeDistanceWeightScaling:n});let a=e?.features||[];this.flagDeclarations=i??{},this.disabledNodeIds=this.getDisabledNodeIds(),a.forEach(o=>{let s=null;if(o.geometry.type==="LineString"?s=o.geometry.coordinates:o.geometry.type==="Polygon"&&(s=o.geometry.coordinates.flat()),s){let l=this.groupBy==="default"?this.groupBy:o.properties[this.groupBy];this.geometryEdgesByMapId.has(l)||this.geometryEdgesByMapId.set(l,[]),s.forEach((u,c)=>{this.geometryEdgesByMapId.get(l).push([u,s[c+1]||s[0]])})}})}getDisabledNodeIds(){let t=new Set;if(cI.public in this.flagDeclarations)for(let e in this.graph.nodesById)tL(this.graph.nodesById[e].properties.flags,this.flagDeclarations[cI.public].index,this.flagDeclarations[cI.public].bit)||t.add(e);return t}getDirections({zones:t,originIds:e,destinationNodeIds:r,disabledConnectionNodeIds:n,simplify:i,multiplicativeDistanceWeightScaling:a,overrideEdgeWeights:o}){var s,l;let u=(s=i?.enabled)!=null?s:!0,c=t??[],h=this.graph.aStar({originIds:e,destinationNodeIds:r,zones:c,disabledConnectionNodeIds:new Set(n),overrideEdgeWeights:o,disabledNodeIds:this.disabledNodeIds});return h.length===0?{type:"FeatureCollection",features:[]}:(u&&(h=this.simplifyAllSteps(h,(l=i?.bufferRadius)!=null?l:gte,a)),this.generatePath(h))}simplifyAllSteps(t,e,r){var n,i;let a=[],o=[t[0]];for(let c=1;c<t.length;c++)if(this.groupBy!=="default"&&t[c].origin.properties[this.groupBy]!==t[c-1].origin.properties[this.groupBy]){let h=t[c-1].origin.properties[this.groupBy],d=(n=this.geometryEdgesByMapId.get(h))!=null?n:[];a.push(...this.simplifySteps(o,d,e,r)),o=[t[c]]}else o.push(t[c]);let s=t[t.length-1],l=this.groupBy==="default"?this.groupBy:s.origin.properties[this.groupBy],u=(i=this.geometryEdgesByMapId.get(l))!=null?i:[];return a.push(...this.simplifySteps(o,u,e,r)),a}simplifySteps(t,e,r,n){var i,a,o,s;if(t.length<3)return t;let l=[t[0]],u=1;for(let c=u+2;c<t.length;c++)if("outdoors"in this.flagDeclarations&&tL((s=(o=(a=(i=t[u])==null?void 0:i.origin)==null?void 0:a.properties)==null?void 0:o.flags)!=null?s:[],this.flagDeclarations.outdoors.index,this.flagDeclarations.outdoors.bit)||t[u].origin.properties.preventSmoothing||!mte(t[u].origin,t[c].origin,e,r)){let h=c-1;l.push(new jT(lt(ae({},t[u]),{destination:t[h].origin,distance:Cp(t[u].origin.geometry.coordinates,t[h].origin.geometry.coordinates),angle:dg(t[u].origin.geometry.coordinates,t[h].origin.geometry.coordinates)}))),u=h}return l.push(new jT(lt(ae({},t[u]),{destination:t[t.length-1].origin,distance:Cp(t[u].origin.geometry.coordinates,t[t.length-1].origin.geometry.coordinates),angle:dg(t[u].origin.geometry.coordinates,t[t.length-1].origin.geometry.coordinates),multiplicativeDistanceWeightScaling:n})),t[t.length-1]),l}};C();var KVe={lineOfSight:!0,mode:"absolute-distance",maxResults:1};function Ate(t){return lt(ae({},KVe),{lineOfSight:!t})}var Gn=new WeakMap;function H2(t,e,r){var n;let i=Ate(r),a=e.Query.__LEGACY_NEAREST_SYNC(t,e.getByType("node"),i),o=(n=a?.[0])==null?void 0:n.feature.id;return o?[o]:[]}async function X2(t,e,r){var n;let i=Ate(r),a=await e.Query.nearest(t,e.getByType("node"),i),o=(n=a?.[0])==null?void 0:n.feature.id;return o?[o]:[]}function QVe(t,e,r){let n=[];for(let i of t.navigationTarget){let a=uA(i,e,r);n.push(...a)}return n}async function eGe(t,e,r){let n=[];for(let i of t.navigationTarget){let a=await cA(i,e,r);n.push(...a)}return n}function Ste(t,e){let r=e?.getMVFFeatureById("entrance",t.id),n=r?.properties.node;return n?[n]:[]}function Ete(t,e){var r;let n=e?.getMVFFeatureById("area",t.id);return(r=n?.properties.destinationNodes)!=null?r:[]}function Ite(t,e){var r,n;let i=e?.getMVFFeatureById("space",t.id);if(i==null)return[];let a=(r=e.entranceNodeIdsBySpaceId)==null?void 0:r[t.id];return a&&a.length>0?a:(n=i.properties.destinationNodes)!=null?n:[]}function tGe(t,e,r){let n=[];for(let i of t.coordinates){let a=H2(i,e,r);a.length>0&&n.push(a[0])}return n}async function rGe(t,e,r){let n=[];for(let i of t.coordinates){let a=await X2(i,e,r);a.length>0&&n.push(a[0])}return n}function Cte(t,e){var r;return(r=e?.objectEntranceNodeIdsByObstructionId[t.id])!=null?r:[]}function Mte(t,e){return t.spaces.flatMap(r=>{var n,i;return(i=(n=e?.getMVFFeatureById("space",r.id))==null?void 0:n.properties.destinationNodes)!=null?i:[]}).filter(r=>typeof r=="string")}function Tte(t){return t.nodes.map(e=>e.id)}function uA(t,e,r){if(Gn.has(t))return Gn.get(t);if(sB.is(t)){let n=QVe(t,e,r);return Gn.set(t,n),n}else if(L_.is(t)){let n=H2(t,e,r);return Gn.set(t,n),n}else if(Rr.is(t)){let n=H2(t,e,r);return Gn.set(t,n),n}else{if(cf.is(t))return H2(t,e,r);if(Cd.is(t)){let n=Ste(t,e);return Gn.set(t,n),n}else if(r0.is(t)){let n=Ete(t,e);return Gn.set(t,n),n}else if(Xs.is(t)){let n=Ite(t,e);return Gn.set(t,n),n}else if(Md.is(t)){let n=tGe(t,e,r);return Gn.set(t,n),n}else if(Wp.is(t)){let n=Cte(t,e);return Gn.set(t,n),n}else if(Nl.is(t)){let n=Mte(t,e);return Gn.set(t,n),n}else if(L1.is(t)){let n=Tte(t);return Gn.set(t,n),n}else if(t0.is(t)){let n=[t.id];return Gn.set(t,n),n}else return[]}}async function cA(t,e,r){if(Gn.has(t))return Gn.get(t);if(sB.is(t)){let n=await eGe(t,e,r);return Gn.set(t,n),n}else if(L_.is(t)){let n=await X2(t,e,r);return Gn.set(t,n),n}else if(Rr.is(t)){let n=await X2(t,e,r);return Gn.set(t,n),n}else if(cf.is(t)){let n=await X2(t,e,r);return Gn.set(t,n),n}else if(Cd.is(t)){let n=Ste(t,e);return Gn.set(t,n),n}else if(r0.is(t)){let n=Ete(t,e);return Gn.set(t,n),n}else if(Xs.is(t)){let n=Ite(t,e);return Gn.set(t,n),n}else if(Md.is(t)){let n=await rGe(t,e,r);return Gn.set(t,n),n}else if(Wp.is(t)){let n=Cte(t,e);return Gn.set(t,n),n}else{if(Nl.is(t))return Mte(t,e);if(L1.is(t)){let n=Tte(t);return Gn.set(t,n),n}else if(t0.is(t)){let n=[t.id];return Gn.set(t,n),n}else return[]}}function nGe(t,e,r){var n,i;let a=(n=t.features[0])==null?void 0:n.properties.id,o=e[0];if(e.length>1){for(let s of e)if(((i=r.get(s))!=null?i:[]).includes(a)){o=s;break}}return o}function iGe(t,e,r){var n,i;let a=(n=t.features[t.features.length-1])==null?void 0:n.properties.id,o=e[0];if(e.length>1){for(let s of e)if(((i=r.get(s))!=null?i:[]).includes(a)){o=s;break}}return o}var q2,ZT,aGe=class{constructor({nodes:t,geojsonCollection:e,connections:r,groupBy:n,multiplicativeDistanceWeightScaling:i,flagDeclarations:a}){S(this,"navigator"),S(this,"connections"),S(this,"getDirections",async(o,s,l,u)=>{let c=new Map,h=new Map;for(let y of o)c.set(y,await cA(y,u,u.enterpriseMode));for(let y of s)h.set(y,await cA(y,u,u.enterpriseMode));let{originIds:d,destinationNodeIds:p,featureToNodeIdsMap:m}=this.processTargets(c,h,u);return f(this,q2).call(this,o,s,d,p,l,u,m)}),S(this,"getDirectionsSync",(o,s,l,u)=>{let c=new Map(o.map(y=>[y,uA(y,u,u.enterpriseMode)])),h=new Map(s.map(y=>[y,uA(y,u,u.enterpriseMode)])),{originIds:d,destinationNodeIds:p,featureToNodeIdsMap:m}=this.processTargets(c,h,u);return f(this,q2).call(this,o,s,d,p,l,u,m)}),K(this,q2,(o,s,l,u,c,h,d)=>{let p=this.getDisabledConnectionNodeIds(c.accessible).filter(A=>!l.includes(A)&&!u.includes(A)),m=new Map,y=ae({},c.connectionIdWeightMap);for(let A of c.excludedConnections)y[A.id]=1/0;for(let A in y){let E=h.getById("connection",A);E&&f(this,ZT).call(this,E,y[A],m)}let v=this.navigator.getDirections({zones:c.zones.map(A=>{var E;return{geometry:A.geometry,cost:A.cost,map:(E=A.floor)==null?void 0:E.id}}),originIds:l,destinationNodeIds:u,disabledConnectionNodeIds:p,simplify:{enabled:c.smoothing.enabled,bufferRadius:c.smoothing.radius},overrideEdgeWeights:m,multiplicativeDistanceWeightScaling:!h.enterpriseMode});this.addCoordinateDirections(v,o,s);let _=nGe(v,o,d),w=iGe(v,s,d),b=new XVe(v,h,_,w);if(!(b.distance===0&&new Set([...l,...u]).size===l.length+u.length))return b}),S(this,"getDisabledConnectionNodeIds",o=>o===!1?[]:this.connections.reduce((s,l)=>l.accessible?s:s.concat(l.nodes),[])),K(this,ZT,(o,s,l)=>{if(o.nodes.length<2)return;let u=new Set(o.nodes.map(c=>c.id));for(let c of o.nodes){let h=this.navigator.graph.edges[c.id];if(h)for(let d of h)u.has(d.destination.properties.id)&&l.set(d,s)}}),S(this,"addCoordinateDirections",(o,[s],[l])=>{if(o.features.length){if(Rr.is(s)){let u=this.createDirectionFeature(s,this.navigator.getAngle([s.longitude,s.latitude],o.features[0].geometry.coordinates),this.navigator.getDistance([s.longitude,s.latitude],o.features[0].geometry.coordinates));o.features.splice(0,0,u)}if(Rr.is(l)){let u=this.createDirectionFeature(l,0,0),c=o.features[o.features.length-1];c.properties.distance=this.navigator.getDistance(c.geometry.coordinates,[l.longitude,l.latitude]),c.properties.angle=this.navigator.getAngle(c.geometry.coordinates,[l.longitude,l.latitude]),o.features.push(u)}}}),S(this,"createDirectionFeature",(o,s,l)=>({type:"Feature",geometry:{type:"Point",coordinates:[o.longitude,o.latitude]},properties:{groupBy:o.floorId,id:o.id,angle:s,distance:l,edges:[]}})),this.navigator=new JVe({nodes:t,geojsonCollection:this.createCollection(e),groupBy:n,multiplicativeDistanceWeightScaling:i,flagDeclarations:a}),this.connections=r}processTargets(t,e,r){let n=[],i=[],a=new Map,o=new Set,s=new Set;for(let[l,u]of t){a.has(l)||a.set(l,[]);let c=a.get(l);Xs.is(l)&&o.add(l.id);for(let h of u)c.push(h),n.push(h)}for(let[l,u]of e){a.has(l)||a.set(l,[]);let c=a.get(l);Xs.is(l)&&s.add(l.id);for(let h of u)c.push(h),i.push(h)}if(o.size===0&&s.size===0)return{originIds:n,destinationNodeIds:i,featureToNodeIdsMap:a};for(let l of n){let u=r.spaceIdsByNodeId[l]||[];for(let c of u)if(s.has(c)){i.push(l);break}}for(let l of i){let u=r.spaceIdsByNodeId[l]||[];for(let c of u)if(o.has(c)){n.push(l);break}}return{originIds:n,destinationNodeIds:i,featureToNodeIdsMap:a}}createCollection(t){return{type:"FeatureCollection",features:Object.entries(t).reduce((e,[r,n])=>e.concat(n.features.map(i=>(i.properties.map=r,i))),[])}}};q2=new WeakMap,ZT=new WeakMap;C();C();C();C();C();C();function oGe(t){let e=+this._x.call(null,t),r=+this._y.call(null,t);return Pte(this.cover(e,r),e,r,t)}function Pte(t,e,r,n){if(isNaN(e)||isNaN(r))return t;var i,a=t._root,o={data:n},s=t._x0,l=t._y0,u=t._x1,c=t._y1,h,d,p,m,y,v,_,w;if(!a)return t._root=o,t;for(;a.length;)if((y=e>=(h=(s+u)/2))?s=h:u=h,(v=r>=(d=(l+c)/2))?l=d:c=d,i=a,!(a=a[_=v<<1|y]))return i[_]=o,t;if(p=+t._x.call(null,a.data),m=+t._y.call(null,a.data),e===p&&r===m)return o.next=a,i?i[_]=o:t._root=o,t;do i=i?i[_]=new Array(4):t._root=new Array(4),(y=e>=(h=(s+u)/2))?s=h:u=h,(v=r>=(d=(l+c)/2))?l=d:c=d;while((_=v<<1|y)===(w=(m>=d)<<1|p>=h));return i[w]=a,i[_]=o,t}function sGe(t){var e,r,n=t.length,i,a,o=new Array(n),s=new Array(n),l=1/0,u=1/0,c=-1/0,h=-1/0;for(r=0;r<n;++r)isNaN(i=+this._x.call(null,e=t[r]))||isNaN(a=+this._y.call(null,e))||(o[r]=i,s[r]=a,i<l&&(l=i),i>c&&(c=i),a<u&&(u=a),a>h&&(h=a));if(l>c||u>h)return this;for(this.cover(l,u).cover(c,h),r=0;r<n;++r)Pte(this,o[r],s[r],t[r]);return this}C();function lGe(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,n=this._y0,i=this._x1,a=this._y1;if(isNaN(r))i=(r=Math.floor(t))+1,a=(n=Math.floor(e))+1;else{for(var o=i-r||1,s=this._root,l,u;r>t||t>=i||n>e||e>=a;)switch(u=(e<n)<<1|t<r,l=new Array(4),l[u]=s,s=l,o*=2,u){case 0:i=r+o,a=n+o;break;case 1:r=i-o,a=n+o;break;case 2:i=r+o,n=a-o;break;case 3:r=i-o,n=a-o;break}this._root&&this._root.length&&(this._root=s)}return this._x0=r,this._y0=n,this._x1=i,this._y1=a,this}C();function uGe(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}C();function cGe(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}C();C();function fo(t,e,r,n,i){this.node=t,this.x0=e,this.y0=r,this.x1=n,this.y1=i}function hGe(t,e,r){var n,i=this._x0,a=this._y0,o,s,l,u,c=this._x1,h=this._y1,d=[],p=this._root,m,y;for(p&&d.push(new fo(p,i,a,c,h)),r==null?r=1/0:(i=t-r,a=e-r,c=t+r,h=e+r,r*=r);m=d.pop();)if(!(!(p=m.node)||(o=m.x0)>c||(s=m.y0)>h||(l=m.x1)<i||(u=m.y1)<a))if(p.length){var v=(o+l)/2,_=(s+u)/2;d.push(new fo(p[3],v,_,l,u),new fo(p[2],o,_,v,u),new fo(p[1],v,s,l,_),new fo(p[0],o,s,v,_)),(y=(e>=_)<<1|t>=v)&&(m=d[d.length-1],d[d.length-1]=d[d.length-1-y],d[d.length-1-y]=m)}else{var w=t-+this._x.call(null,p.data),b=e-+this._y.call(null,p.data),A=w*w+b*b;if(A<r){var E=Math.sqrt(r=A);i=t-E,a=e-E,c=t+E,h=e+E,n=p.data}}return n}C();function dGe(t){if(isNaN(c=+this._x.call(null,t))||isNaN(h=+this._y.call(null,t)))return this;var e,r=this._root,n,i,a,o=this._x0,s=this._y0,l=this._x1,u=this._y1,c,h,d,p,m,y,v,_;if(!r)return this;if(r.length)for(;;){if((m=c>=(d=(o+l)/2))?o=d:l=d,(y=h>=(p=(s+u)/2))?s=p:u=p,e=r,!(r=r[v=y<<1|m]))return this;if(!r.length)break;(e[v+1&3]||e[v+2&3]||e[v+3&3])&&(n=e,_=v)}for(;r.data!==t;)if(i=r,!(r=r.next))return this;return(a=r.next)&&delete r.next,i?(a?i.next=a:delete i.next,this):e?(a?e[v]=a:delete e[v],(r=e[0]||e[1]||e[2]||e[3])&&r===(e[3]||e[2]||e[1]||e[0])&&!r.length&&(n?n[_]=r:this._root=r),this):(this._root=a,this)}function pGe(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this}C();function fGe(){return this._root}C();function mGe(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}C();function gGe(t){var e=[],r,n=this._root,i,a,o,s,l;for(n&&e.push(new fo(n,this._x0,this._y0,this._x1,this._y1));r=e.pop();)if(!t(n=r.node,a=r.x0,o=r.y0,s=r.x1,l=r.y1)&&n.length){var u=(a+s)/2,c=(o+l)/2;(i=n[3])&&e.push(new fo(i,u,c,s,l)),(i=n[2])&&e.push(new fo(i,a,c,u,l)),(i=n[1])&&e.push(new fo(i,u,o,s,c)),(i=n[0])&&e.push(new fo(i,a,o,u,c))}return this}C();function yGe(t){var e=[],r=[],n;for(this._root&&e.push(new fo(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var i=n.node;if(i.length){var a,o=n.x0,s=n.y0,l=n.x1,u=n.y1,c=(o+l)/2,h=(s+u)/2;(a=i[0])&&e.push(new fo(a,o,s,c,h)),(a=i[1])&&e.push(new fo(a,c,s,l,h)),(a=i[2])&&e.push(new fo(a,o,h,c,u)),(a=i[3])&&e.push(new fo(a,c,h,l,u))}r.push(n)}for(;n=r.pop();)t(n.node,n.x0,n.y0,n.x1,n.y1);return this}C();function vGe(t){return t[0]}function _Ge(t){return arguments.length?(this._x=t,this):this._x}C();function xGe(t){return t[1]}function bGe(t){return arguments.length?(this._y=t,this):this._y}function Dte(t,e,r){var n=new oB(e??vGe,r??xGe,NaN,NaN,NaN,NaN);return t==null?n:n.addAll(t)}function oB(t,e,r,n,i,a){this._x=t,this._y=e,this._x0=r,this._y0=n,this._x1=i,this._y1=a,this._root=void 0}function rL(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var Io=Dte.prototype=oB.prototype;Io.copy=function(){var t=new oB(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,r,n;if(!e)return t;if(!e.length)return t._root=rL(e),t;for(r=[{source:e,target:t._root=new Array(4)}];e=r.pop();)for(var i=0;i<4;++i)(n=e.source[i])&&(n.length?r.push({source:n,target:e.target[i]=new Array(4)}):e.target[i]=rL(n));return t};Io.add=oGe;Io.addAll=sGe;Io.cover=lGe;Io.data=uGe;Io.extent=cGe;Io.find=hGe;Io.remove=dGe;Io.removeAll=pGe;Io.root=fGe;Io.size=mGe;Io.visit=gGe;Io.visitAfter=yGe;Io.x=_Ge;Io.y=bGe;C();function kte(t,e,r,n=0,i=0,a=0,o=0){if(r===void 0){r=t.root();let l=t.extent();if(l&&([[n,i],[a,o]]=l,e(r,n,i,a,o)))return!0;if(!r)return!1}let s=[[n,i,(a+n)/2,(o+i)/2],[(a+n)/2,i,a,(o+i)/2],[n,(o+i)/2,(a+n)/2,o],[(a+n)/2,(o+i)/2,a,o]];for(let l=0;l<4;l++){let u=r[l];if(u){let[c,h,d,p]=s[l];e(u,c,h,d,p)||kte(t,e,u,c,h,d,p)}}return!1}var nL=1e3,wGe=.1,AGe=5,SGe=1.5,Ql,Y2,WT,Ote,ns,Zm,EGe=class{constructor(t,e){K(this,WT),K(this,Ql,{}),K(this,Y2,new Map),S(this,"getMaxSearchRadiusForFloorId",(r,n)=>{var i;let a=(i=f(this,Y2).get(f(this,ns).mapName))==null?void 0:i.get(n);if(a)return a;let o=this.getNodeTreeByTypeAndFloorId(r,f(this,ns).mapName,n);if(typeof o.extent=="function")if(o.extent()){let[[s,l],[u,c]]=o.extent(),h=u-s,d=c-l;a=Math.max(h,d)}else a=nL;else a=nL;return f(this,Y2).set(f(this,ns).mapName,new Map([[n,a]])),a}),K(this,ns),K(this,Zm),ne(this,ns,t),ne(this,Zm,e)}searchWithIncludedIds(t,e,r,n,i,a,o=!1,s=1/0){let l=this.getNodeTreeByTypeAndFloorId(e,r,n),u=new Set,c=[],h=AGe,d=Math.max(a,this.getMaxSearchRadiusForFloorId(e,n));for(;c.length<s&&h<=d;){let p=ot(this,WT,Ote).call(this,t,l,i,h,a,u);p.sort((m,y)=>m.distance-y.distance);for(let m of p){if(c.length>=s)break;o?f(this,ns).directions.navigator.hasLineOfSight(t,m.node.geometry.coordinates,n,wGe)&&c.push(m):c.push(m)}h=h*SGe}return c}getNodeTreeByTypeAndFloorId(t,e,r){var n,i;if(f(this,Ql)[t]||(f(this,Ql)[t]={}),(n=f(this,Ql)[t][e])!=null&&n[r])return f(this,Ql)[t][e][r];f(this,Ql)[t][e]||(f(this,Ql)[t][e]={}),f(this,Ql)[t][e][r]=Dte();let a=f(this,Ql)[t][e][r];a.x(s=>f(this,Zm).call(this,s.geometry.coordinates).x),a.y(s=>f(this,Zm).call(this,s.geometry.coordinates).y);let o=[];switch(t){case"space":o=f(this,ns).mvfSpacesByFloorId[r].flatMap(s=>s.properties.destinationNodes).map(s=>{let l=f(this,ns).mvfNodesById[s];return l?lt(ae({},l),{properties:{id:l.properties.id,parentId:l.properties.space[0]}}):null});break;case"node":o=((i=f(this,ns).mvfNodesByFloorId[r])==null?void 0:i.filter(s=>s.properties.neighbors.length>0))||[];break;case"point-of-interest":o=f(this,ns).mvfPoisByFloorId[r]||[];break;case"door":o=f(this,ns).mvfEntrancesByFloorId[r]||[];break;case"annotation":o=f(this,ns).mvfAnnotationsByFloorId[r]||[];break}return o?.length>0&&a.addAll(o),a}};Ql=new WeakMap,Y2=new WeakMap,WT=new WeakSet,Ote=function(t,e,r,n,i,a){let{x:o,y:s}=f(this,Zm).call(this,t),l=o-n,u=o+n,c=s-n,h=s+n,d=[];return kte(e,(p,m,y,v,_)=>{let w=m>=u||y>=h||v<l||_<c;if("data"in p){let b=p.data,A=b.properties.parentId||b.properties.id;if(r.includes(A)&&!a.has(A)){a.add(A);let E=Cp(t,b.geometry.coordinates);E<=i&&d.push({node:b,distance:E})}}return w}),d},ns=new WeakMap,Zm=new WeakMap;var gm=50,iL=111319.9,HT=1,XT=!1,aL=at.object({limit:at.enum(["same-floor","same-elevation"]).optional(),mode:at.enum(["travel-distance","absolute-distance"]).optional(),lineOfSight:at.boolean().optional().or(at.literal("auto")),maxDistance:at.number().optional(),maxResults:at.number().optional()}),oL={lineOfSight:XT,mode:"travel-distance",maxDistance:gm,limit:"same-floor",maxResults:HT},Hi,J2,qT,K2,YT,iv,JT,KT,IGe=class{constructor(t){K(this,K2),K(this,Hi),K(this,J2),K(this,qT,([e,r])=>{let[n,i]=[f(this,Hi).mapCenter.longitude,f(this,Hi).mapCenter.latitude],a=iL,o=iL*Math.cos(r*Math.PI/180),s=(e-n)*o,l=(r-i)*a;return{x:s,y:l}}),S(this,"__LEGACY_NEAREST_SYNC",(e,r,n)=>{let i=ae(ae({},oL),n);try{aL.parse(i)}catch(c){Be.error(c);return}let a=oA(e);if(!a)return;let o=ot(this,K2,YT).call(this,a,i),s=[],l={},u=[];for(let c of r){let h=uA(c,f(this,Hi),f(this,Hi).enterpriseMode);if(h)for(let d of h)l[d]||(l[d]=[]),l[d].push(c),u.push(d)}return n?.mode==="absolute-distance"?s=f(this,iv).call(this,a,o,r,i):s=f(this,KT).call(this,e,o,u,l,i),s.sort((c,h)=>c.distance-h.distance)}),K(this,iv,(e,r,n,i)=>{var a,o;let s=[],l=new Set(n.map(u=>u.__type));for(let u of r)for(let c of l){let h=f(this,J2).searchWithIncludedIds([e.longitude,e.latitude],c,f(this,Hi).mapName,u,n.filter(d=>d.__type===c).map(d=>d.id),(a=i?.maxDistance)!=null?a:gm,i?.lineOfSight==="auto"?XT:i?.lineOfSight,(o=i?.maxResults)!=null?o:1);if(h)for(let d of h)s.push({distance:d.distance,feature:f(this,Hi).getById(c,d.node.properties.parentId)||f(this,Hi).getById(c,d.node.properties.id)})}return s}),K(this,JT,async(e,r,n,i,a)=>{var o,s,l,u;let c=[];for(let h of r){let d,p=0;if(!t0.is(e)){let m=f(this,iv).call(this,e.anchorTarget,[h],f(this,Hi).getByType("node").filter(y=>y.floor.id===h),{limit:"same-floor",lineOfSight:(o=a?.lineOfSight)!=null?o:!0,mode:"absolute-distance",maxDistance:(s=a?.maxDistance)!=null?s:gm,maxResults:1});m.length>0&&(d=m[0].feature,p=m[0].distance)}if(d){let m=new Set,y=f(this,Hi).directions.navigator.findNearestNodesOnGraph(d.id,((l=a?.maxDistance)!=null?l:gm)-p,h,n,!1,(u=a?.maxResults)!=null?u:HT);for(let v of y)for(let _ of i[v.feature.properties.id])m.has(_.id)||(c.push({distance:v.distance+p,feature:_}),m.add(_.id))}}return c}),K(this,KT,(e,r,n,i,a)=>{var o,s,l,u,c;let h=[];for(let d of r){let p;if(t0.is(e)||(p=(l=this.__LEGACY_NEAREST_SYNC(e,f(this,Hi).getByType("node"),{lineOfSight:(o=a?.lineOfSight)!=null?o:!0,mode:"absolute-distance",maxDistance:(s=a?.maxDistance)!=null?s:gm,maxResults:1}))==null?void 0:l[0].feature),p){let m=f(this,Hi).directions.navigator.findNearestNodesOnGraph(p.id,(u=a?.maxDistance)!=null?u:gm,d,n,a?.lineOfSight==="auto"?XT:a?.lineOfSight,(c=a?.maxResults)!=null?c:HT);for(let y of m)for(let v of i[y.feature.properties.id])h.push({distance:y.distance,feature:v})}}return h}),ne(this,Hi,t),ne(this,J2,new EGe(f(this,Hi),f(this,qT)))}async nearest(t,e,r){let n=ae(ae({},oL),r);try{aL.parse(n)}catch(c){Be.error(c);return}let i=oA(t);if(!i)return;let a=ot(this,K2,YT).call(this,i,n),o=[],s={},l=[],u=[];if(r?.mode==="absolute-distance")o=f(this,iv).call(this,i,a,e,n);else{for(let c of e)u.push(cA(c,f(this,Hi),f(this,Hi).enterpriseMode).then(h=>{if(h)for(let d of h)s[d]||(s[d]=[]),s[d].push(c),l.push(d)}));await Promise.all(u),o=await f(this,JT).call(this,t,a,l,s,n)}return o.sort((c,h)=>c.distance-h.distance)}};Hi=new WeakMap,J2=new WeakMap,qT=new WeakMap,K2=new WeakSet,YT=function(t,e){let r=t.floorId?[t.floorId]:[];if(t.floorId==null)for(let n of f(this,Hi).getByType("floor-stack")){let i=n.defaultFloor;i&&r.push(i.id)}else if(e?.limit==="same-elevation"){let n=f(this,Hi).floorsById[t.floorId];if(n){let i=n?.elevation;i&&(r=f(this,Hi).getByType("floor-stack").map(a=>{var o;return(o=a.floors.find(s=>s.elevation===i))==null?void 0:o.id}).filter(Boolean))}}return r},iv=new WeakMap,JT=new WeakMap,KT=new WeakMap;C();C();var Q2,CGe=class{constructor(t){K(this,Q2),ne(this,Q2,t||[])}get raw(){return f(this,Q2)}};Q2=new WeakMap;var Ua,Rt,jn,Bte=class ew extends Id{constructor(e,r){super(r.mvfData.id),S(this,"__type",ew.__type),S(this,"id","loc_"),S(this,"name",""),S(this,"externalId"),S(this,"description"),S(this,"logo"),S(this,"phone"),S(this,"social",[]),S(this,"images",[]),S(this,"links",[]),S(this,"website"),S(this,"icon"),K(this,Ua),K(this,Rt,{}),K(this,jn),ne(this,Ua,e),ne(this,jn,r.mvfData);for(let n in r.mvfData)n==="links"?this.links=r.mvfData.links.map(i=>new FT({mvfData:i})):n==="pictures"?this.images=r.mvfData.pictures.map(i=>{var a;return i.url?new aA({mvfData:lt(ae({},i),{url:(a=i.url)!=null?a:""}),mapData:f(this,Ua)}):void 0}).filter(i=>i!=null):n==="website"?r.mvfData.website&&(this.website=new FT({mvfData:r.mvfData.website})):n==="icon"?r.mvfData.icon&&(this.icon=new aA({mvfData:{url:r.mvfData.icon},mapData:f(this,Ua)})):Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),n)||Object.defineProperty(this,n,{enumerable:!0,get(){return f(this,jn)[n]}})}static is(e){return e.__type===ew.__type}get spaces(){if(f(this,Rt).spaces)return f(this,Rt).spaces;if(f(this,jn).spaces==null)return f(this,Rt).spaces=[],f(this,Rt).spaces;f(this,Rt).spaces=[];for(let e=0;e<f(this,jn).spaces.length;e++){let r=f(this,Ua).getById("space",f(this,jn).spaces[e].id);r&&f(this,Rt).spaces.push(r)}return f(this,Rt).spaces}get points(){if(f(this,Rt).points)return f(this,Rt).points;if(f(this,jn).spaces==null)return f(this,Rt).points=[],f(this,Rt).points;f(this,Rt).points=[];for(let e=0;e<f(this,jn).spaces.length;e++){let r=f(this,Ua).getById("point-of-interest",f(this,jn).spaces[e].id);r&&f(this,Rt).points.push(r)}return f(this,Rt).points}get doors(){if(f(this,Rt).doors)return f(this,Rt).doors;if(f(this,jn).entrances==null)return f(this,Rt).doors=[],f(this,Rt).doors;f(this,Rt).doors=[];for(let e=0;e<f(this,jn).entrances.length;e++){let r=f(this,Ua).getById("door",f(this,jn).entrances[e].id);r&&f(this,Rt).doors.push(r)}return f(this,Rt).doors}get connections(){var e;if(f(this,Rt).connections)return f(this,Rt).connections;if(f(this,jn).connections==null)return f(this,Rt).connections=[],f(this,Rt).connections;let r=new Set;for(let n=0;n<f(this,jn).connections.length;n++){let i=f(this,jn).connections[n],a=f(this,Ua).mvfConnectionsById[i],o=(a==null?[]:a.nodes).map(s=>f(this,Ua).getById("node",s)).filter(Boolean);for(let s of o){if(s==null)continue;let l=$0([s.coordinate.longitude,s.coordinate.latitude]),u=((e=f(this,Ua).connectionSpaceIdsByLatLon[l])!=null?e:[]).map(c=>f(this,Ua).connectionsById[c]).filter(c=>c!=null);for(let c of u)r.add(c)}}return f(this,Rt).connections=Array.from(r),f(this,Rt).connections}get annotations(){if(f(this,Rt).annotations)return f(this,Rt).annotations;if(f(this,jn).annotations==null)return f(this,Rt).annotations=[],f(this,Rt).annotations;f(this,Rt).annotations=[];for(let e=0;e<f(this,jn).annotations.length;e++){let r=f(this,Ua).getById("annotation",f(this,jn).annotations[e].id);r&&f(this,Rt).annotations.push(r)}return f(this,Rt).annotations}get categories(){return f(this,Rt).categories?f(this,Rt).categories:f(this,jn).categories==null?(f(this,Rt).categories=[],f(this,Rt).categories):(f(this,Rt).categories=f(this,jn).categories.map(e=>f(this,Ua).getById("location-category",e)).filter(e=>e!=null),f(this,Rt).categories)}get mapObjects(){return f(this,Rt).mapObjects?f(this,Rt).mapObjects:f(this,jn).obstructions==null?(f(this,Rt).mapObjects=[],f(this,Rt).mapObjects):(f(this,Rt).mapObjects=f(this,jn).obstructions.map(e=>f(this,Ua).getById("object",e.id)).filter(e=>e!=null),f(this,Rt).mapObjects)}get areas(){return f(this,Rt).areas?f(this,Rt).areas:f(this,jn).areas==null?(f(this,Rt).areas=[],f(this,Rt).areas):(f(this,Rt).areas=f(this,jn).areas.map(e=>f(this,Ua).getById("area",e.id)).filter(e=>e!=null),f(this,Rt).areas)}get focusTarget(){if(f(this,Rt).focusTarget)return f(this,Rt).focusTarget;let e=[];for(let r of this.spaces)e.push(r);for(let r of this.connections)e.push(...r.coordinates);for(let r of this.doors)e.push(r.focusTarget);for(let r of this.mapObjects)e.push(r.focusTarget);for(let r of this.annotations)e.push(r.focusTarget);for(let r of this.points)e.push(r.focusTarget);for(let r of this.areas)e.push(r.focusTarget);return f(this,Rt).focusTarget=e,e}get openingHours(){var e;return f(this,Rt).openingHours?f(this,Rt).openingHours:(f(this,Rt).openingHours=new CGe((e=f(this,jn).openingHoursSpecification)!=null?e:[]),f(this,Rt).openingHours)}get navigationTarget(){if(f(this,Rt).navigationTarget)return f(this,Rt).navigationTarget;let e=[];for(let r of this.spaces)e.push(r);for(let r of this.connections)e.push(...r.coordinates);for(let r of this.doors)e.push(r.focusTarget);for(let r of this.mapObjects)e.push(r.focusTarget);for(let r of this.annotations)e.push(r.focusTarget);for(let r of this.points)e.push(r.focusTarget);return f(this,Rt).navigationTarget=e,e}toJSON(){return{__type:ew.__type,id:this.id,name:this.name}}};Ua=new WeakMap,Rt=new WeakMap,jn=new WeakMap,S(Bte,"__type","location-profile");var MGe=Bte,sB=MGe;C();var Yd,is,ym,zte=class tw extends Id{constructor(e,r){super(r.mvfData.id),S(this,"__type",tw.__type),S(this,"id","cat_"),S(this,"name",""),S(this,"icon",""),K(this,Yd),K(this,is,{}),K(this,ym),ne(this,Yd,e),ne(this,ym,r.mvfData);for(let n in r.mvfData)Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),n)||Object.defineProperty(this,n,{enumerable:!0,get(){return f(this,ym)[n]}})}static is(e){return e.__type===tw.__type}get parent(){return f(this,is).parent?f(this,is).parent:(f(this,is).parent=f(this,ym).parent?f(this,Yd).getById("location-category",f(this,ym).parent):void 0,f(this,is).parent)}get children(){return f(this,is).children?f(this,is).children:(f(this,is).children=f(this,Yd).locationCategoriesByParentId[this.id]||[],f(this,is).children)}get locationProfiles(){if(f(this,is).locationProfiles)return f(this,is).locationProfiles;let e=[];for(let r of f(this,Yd).locationProfilesByCategoryId[this.id]||[]){let n=f(this,Yd).getById("location-profile",r.id);n&&e.push(n)}return f(this,is).locationProfiles=e,e}toJSON(){return{__type:tw.__type,id:this.id,name:this.name}}};Yd=new WeakMap,is=new WeakMap,ym=new WeakMap,S(zte,"__type","location-category");var TGe=zte,PGe=TGe,rr,QT,Fte,av,ov,DGe=class extends wi{constructor(t,e){var r,n,i,a,o,s;super(),K(this,QT),S(this,"Analytics"),K(this,rr,{}),S(this,"Query"),S(this,"mvf"),S(this,"outdoorViewToken"),S(this,"objectEntranceNodeIdsByObstructionId"),S(this,"obstructionIdByEntranceId"),S(this,"venue"),S(this,"tokenManager"),S(this,"directions"),S(this,"enterpriseMode",!1),S(this,"nodesById"),S(this,"spacesById"),S(this,"floorsById"),S(this,"floorStacksById"),S(this,"facadesById"),S(this,"facadesBySpaceId"),S(this,"connectionsById"),S(this,"objectsById"),S(this,"doorsById"),S(this,"pointsOfInterestById"),S(this,"annotationsById"),S(this,"areasById"),S(this,"locationProfilesById"),S(this,"locationCategoriesById"),S(this,"locationProfilesByExternalId"),S(this,"locationProfilesByCategoryId"),S(this,"locationCategoriesByParentId"),S(this,"doorsByNodeId"),S(this,"mvfAnnotationsById"),S(this,"mvfConnectionsById"),S(this,"mvfConnectionsByNodeId"),S(this,"mvfConnectionIdsByLatLon"),S(this,"mvfEntrancesById"),S(this,"mvfNodesById"),S(this,"mvfObstructionById"),S(this,"mvfSpacesById"),S(this,"mvfFloorsById"),S(this,"mvfFloorStacksById"),S(this,"mvfAreasById"),S(this,"spacesByExternalId"),S(this,"nodesByExternalId"),S(this,"objectsByExternalId"),S(this,"poisByExternalId"),S(this,"floorsByExternalId"),S(this,"floorStacksByExternalId"),S(this,"doorsByExternalId"),S(this,"areasByExternalId"),S(this,"connectionSpaceIdsByLatLon",{}),S(this,"locationProfilesByAttachedFeatureId",{}),S(this,"entranceNodeIdsBySpaceId",{}),S(this,"locationsById",{}),S(this,"categoriesById",{}),S(this,"mvfLocationsByGeometryId",{}),S(this,"locationIdsByNodeId",{}),S(this,"spaceIdsByNodeId",{}),S(this,"objectIdsByNodeId",{}),S(this,"connectionsByExternalId",{}),S(this,"locationsByExternalId",{}),S(this,"categoriesByExternalId",{}),S(this,"destinationNodesIdsBySpaceId",{}),S(this,"mvfNodesByFloorId"),S(this,"mvfSpacesByFloorId"),S(this,"mvfPoisByFloorId"),S(this,"mvfEntrancesByFloorId"),S(this,"mvfAnnotationsByFloorId"),S(this,"localePacksUrls"),S(this,"currentLanguage"),S(this,"languagePacks",{}),S(this,"tilesets",{}),S(this,"navigationFlags"),S(this,"binaryBundle"),S(this,"envControl"),S(this,"getMapDataOptions"),K(this,av,new Rr(0,0,"initializing")),S(this,"propTranslationCache",new Map),K(this,ov),S(this,"__LEGACY_GET_DIRECTIONS_MULTI_DESTINATION_SYNC",(c,h,d)=>this.__LEGACY_GET_DIRECTIONS_SYNC(c,h,lt(ae({},d),{multiDestination:!0}))),S(this,"__LEGACY_GET_DIRECTIONS_SYNC",(c,h,d)=>{let{accessible:p=!1,multiDestination:m=!1}=d||{},y=sL(this.enterpriseMode,d),v=d?.zones||[],_={accessible:p,zones:v,smoothing:y,excludedConnections:d?.excludedConnections||[],connectionIdWeightMap:d?.connectionIdWeightMap||{}};if(m&&Array.isArray(h)){let w=Array.isArray(c)?c:[c],b=[];for(let A of h){let E=Array.isArray(A)?A:[A],M=this.directions.getDirectionsSync(w,E,_,this);if(!M){Be.error("getDirections failed due to missing directions for one of the segments");return}w=E,b.push(M)}return b}else{let w=Array.isArray(c)?c:[c],b=Array.isArray(h)?h:[h];if(Array.isArray(b[0])){Be.error("getDirections does not support multi-destination without multisegment option");return}w[0].id&&b[0].id&&this.Analytics.sendGetDirectionsEvent(w[0].id,b[0].id,p);try{return this.directions.getDirectionsSync(w,b,_,this)}catch(A){Be.error("Unable to get directions",A);return}}}),S(this,"getDirections",async(c,h,d)=>{let{accessible:p=!1}=d||{},m=sL(this.enterpriseMode,d),y=d?.zones||[],v={accessible:p,zones:y,smoothing:m,excludedConnections:d?.excludedConnections||[],connectionIdWeightMap:d?.connectionIdWeightMap||{}},_=Array.isArray(c)?c:[c],w=Array.isArray(h)?h:[h];if(Array.isArray(w[0])){Be.error("getDirections does not support multi-destination without multisegment option");return}_[0].id&&w[0].id&&this.Analytics.sendGetDirectionsEvent(_[0].id,w[0].id,p);try{return this.directions.getDirections(_,w,v,this)}catch(b){Be.error("Unable to get directions",b);return}}),S(this,"getDirectionsMultiDestination",async(c,h,d)=>Promise.resolve(this.__LEGACY_GET_DIRECTIONS_MULTI_DESTINATION_SYNC(c,h,d))),S(this,"transformImageRequest",async c=>{var h;if(this.enterpriseMode||!this.getMapDataOptions)return{url:c};if(!Sje(c))return{url:c};if(Eje(c))return{url:c};let d=qee(c);if(!d)return{url:c};try{let p=await((h=this.tokenManager)==null?void 0:h.getSasTokensAsync()),m=p?.[d.mapId];if(m==null)throw new Error("SAS token not found");let[y]=c.split("?");return{url:"".concat(y,"?").concat(m.token)}}catch(p){return Be.error("Failed to append SAS token to image request. Requests for private images may fail.",p),{url:c}}});let l=(r=e?.env)!=null?r:Vee();if(this.envControl=l,this.binaryBundle=e?.binaryBundle,this.Analytics=new qq,this.localePacksUrls=(n=e?.localePacksUrls)!=null?n:{},this.mvf=t,this.outdoorViewToken=e?.outdoorViewToken,this.getMapDataOptions=e?.getMapDataOptions,((i=t["tileset.json"])==null?void 0:i.default)!=null&&(this.tilesets[t["tileset.json"].default.key]=t["tileset.json"].default,l.updateTileServerBaseUrl(t["tileset.json"].default.url),t["tileset.json"].others!=null))for(let c of t["tileset.json"].others)this.tilesets[c.key]=c;this.navigationFlags=(a=t["navigationFlags.json"])!=null?a:{},this.enterpriseMode=(o=e?.enterprise)!=null?o:!1,this.tokenManager=e?.tokenManager;let u=AVe(t,this);if(this.nodesById=u.nodesById,this.spacesById=u.spacesById,this.floorsById=u.floorsById,this.floorStacksById=u.floorStacksById,this.facadesById=u.facadesById,this.facadesBySpaceId=u.facadesBySpaceId,this.connectionsById=u.connectionsById,this.objectsById=u.objectsById,this.doorsById=u.doorsById,this.pointsOfInterestById=u.poisById,this.annotationsById=u.annotationsById,this.areasById=u.areasById,this.locationProfilesById=u.locationProfilesById,this.locationCategoriesById=u.locationCategoriesById,this.locationProfilesByCategoryId=u.locationProfilesByCategoryId,this.locationCategoriesByParentId=u.locationCategoriesByParentId,this.spacesByExternalId=u.spacesByExternalId,this.nodesByExternalId=u.nodesByExternalId,this.objectsByExternalId=u.objectsByExternalId,this.floorsByExternalId=u.floorsByExternalId,this.locationProfilesByExternalId=u.locationProfilesByExternalId,this.floorStacksByExternalId=u.floorStacksByExternalId,this.poisByExternalId=u.poisByExternalId,this.doorsByExternalId=u.doorsByExternalId,this.areasByExternalId=u.areasByExternalId,this.mvfAnnotationsById=u.mvfAnnotationsById,this.mvfConnectionsById=u.mvfConnectionsById,this.mvfConnectionsByNodeId=u.mvfConnectionsByNodeId,this.mvfConnectionIdsByLatLon=u.mvfConnectionIdsByLatLon,this.mvfEntrancesById=u.mvfEntrancesById,this.mvfNodesById=u.mvfNodesById,this.mvfObstructionById=u.mvfObstructionById,this.mvfSpacesById=u.mvfSpacesById,this.mvfFloorsById=u.mvfFloorsById,this.mvfFloorStacksById=u.mvfFloorStacksById,this.mvfNodesByFloorId=u.mvfNodesByFloorId,this.mvfSpacesByFloorId=u.mvfSpacesByFloorId,this.mvfPoisByFloorId=u.mvfPoisByFloorId,this.mvfEntrancesByFloorId=u.mvfEntrancesByFloorId,this.mvfAnnotationsByFloorId=u.mvfAnnotationsByFloorId,this.mvfAreasById=u.mvfAreasById,this.doorsByNodeId=u.doorsByNodeId,this.objectEntranceNodeIdsByObstructionId=u.objectEntranceNodeIdsByObstructionId,this.obstructionIdByEntranceId=u.obstructionIdByEntranceId,this.connectionSpaceIdsByLatLon=u.connectionIdsByLatLon,this.locationProfilesByAttachedFeatureId=u.locationProfilesByAttachedFeatureId,this.entranceNodeIdsBySpaceId=u.entranceNodeIdsBySpaceId,this.spaceIdsByNodeId=u.spaceIdsByNodeId,this.objectIdsByNodeId=u.objectIdsByNodeId,this.destinationNodesIdsBySpaceId=u.destinationNodesIdsBySpaceId,this.enterpriseMode||aYe()){let c=wVe(t,this);if(this.locationsById=c.locationsById,this.categoriesById=c.categoriesById,this.mvfLocationsByGeometryId=c.mvfLocationsByGeometryId,this.locationIdsByNodeId=c.locationIdsByNodeId,this.connectionsByExternalId=c.connectionsByExternalId,this.locationsByExternalId=c.locationsByExternalId,this.categoriesByExternalId=c.categoriesByExternalId,c.venue.name!=null){this.venue=new kVe(this,{mvfData:c.venue});let h={};for(let d in c.mvfLocationsById)h[d]=c.mvfLocationsById[d];for(let d in c.locationInstancesById)h[d]=c.locationInstancesById[d];this.languagePacks[this.venue.defaultLanguage.code]={type:"initial",optimized:{"enterprise-location":h,"enterprise-category":c.mvfCategoriesById,"floor-stack":u.mvfFloorStacksById,floor:u.mvfFloorsById}},(s=e?.languagePacks)==null||s.forEach(({language:d,localePack:p})=>{this.languagePacks[d.code]=GR(p)}),this.currentLanguage=this.venue.defaultLanguage}}this.directions=new aGe({nodes:t["node.geojson"],geojsonCollection:this.enterpriseMode&&t.enterprise?t.space:t.obstruction,connections:t["connection.json"],groupBy:"map",multiplicativeDistanceWeightScaling:!this.enterpriseMode,flagDeclarations:t["navigationFlags.json"]}),this.Query=new IGe(this)}getEnv(){let t=this;return{get baseUri(){return t.envControl.getBaseUri()},get baseAuthUri(){return t.envControl.getBaseAuthUri()},get analyticsBaseUri(){return t.envControl.getAnalyticsBaseUri()},get tileServerUri(){return t.envControl.getTileServerUri()}}}get mapName(){return this.mvf["manifest.geojson"].features[0].properties.name}get organizationId(){var t;return(t=this.mvf["manifest.geojson"].features[0].properties.org_id)!=null?t:""}get mapCenter(){return f(this,av).floorId==="initializing"&&ne(this,av,new Rr(this.mvf["manifest.geojson"].features[0].geometry.coordinates[1],this.mvf["manifest.geojson"].features[0].geometry.coordinates[0])),f(this,av)}get naturalBearing(){var t;return(t=this.mvf["manifest.geojson"].features[0].properties.naturalBearing)!=null?t:0}get spaces(){return f(this,rr).spaces==null&&(f(this,rr).spaces=globalThis.Object.values(this.spacesById)),f(this,rr).spaces}get objects(){return f(this,rr).objects==null&&(f(this,rr).objects=globalThis.Object.values(this.objectsById)),f(this,rr).objects}get connections(){return f(this,rr).connections==null&&(f(this,rr).connections=globalThis.Object.values(this.connectionsById)),f(this,rr).connections}get floors(){return f(this,rr).floors==null&&(f(this,rr).floors=globalThis.Object.values(this.floorsById)),f(this,rr).floors}get floorStacks(){return f(this,rr).floorStacks==null&&(f(this,rr).floorStacks=globalThis.Object.values(this.floorStacksById)),f(this,rr).floorStacks}get facades(){return f(this,rr).facades==null&&(f(this,rr).facades=globalThis.Object.values(this.facadesById)),f(this,rr).facades}get doors(){return f(this,rr).doors==null&&(f(this,rr).doors=globalThis.Object.values(this.doorsById)),f(this,rr).doors}get pointsOfInterest(){return f(this,rr).pointsOfInterest==null&&(f(this,rr).pointsOfInterest=globalThis.Object.values(this.pointsOfInterestById)),f(this,rr).pointsOfInterest}get annotations(){return f(this,rr).annotations==null&&(f(this,rr).annotations=globalThis.Object.values(this.annotationsById)),f(this,rr).annotations}get areas(){return f(this,rr).areas==null&&(f(this,rr).areas=globalThis.Object.values(this.areasById)),f(this,rr).areas}get nodes(){return f(this,rr).nodes==null&&(f(this,rr).nodes=globalThis.Object.values(this.nodesById)),f(this,rr).nodes}get locations(){return f(this,rr).locations==null&&(f(this,rr).locations=globalThis.Object.values(this.locationsById)),globalThis.Object.values(this.locationsById)}get categories(){return f(this,rr).categories==null&&(f(this,rr).categories=globalThis.Object.values(this.categoriesById)),globalThis.Object.values(this.categoriesById)}get locationProfiles(){return f(this,rr).locationProfiles==null&&(f(this,rr).locationProfiles=globalThis.Object.values(this.locationProfilesById)),f(this,rr).locationProfiles}get locationCategories(){return f(this,rr).locationCategories==null&&(f(this,rr).locationCategories=globalThis.Object.values(this.locationCategoriesById)),f(this,rr).locationCategories}get mvfFloors(){return f(this,rr).mvfFloors==null&&(f(this,rr).mvfFloors=globalThis.Object.values(this.mvfFloorsById)),f(this,rr).mvfFloors}get mvfFloorStacks(){return f(this,rr).mvfFloorStacks==null&&(f(this,rr).mvfFloorStacks=globalThis.Object.values(this.mvfFloorStacksById)),f(this,rr).mvfFloorStacks}getByType(t){switch(t){case"location-profile":return this.locationProfiles;case"location-category":return this.locationCategories;case"area":return this.areas;case"node":return this.nodes;case"space":return this.spaces;case"door":return this.doors;case"floor":return this.floors;case"floor-stack":return this.floorStacks;case"connection":return this.connections;case"object":return this.objects;case"point-of-interest":return this.pointsOfInterest;case"annotation":return this.annotations;case"enterprise-location":return this.locations;case"enterprise-category":return this.categories;case"enterprise-venue":return this.venue;case"facade":return this.facades;default:return[]}}getAllOfTypes(t,e){let r=t instanceof Set?t:new Set(t);return e!=null&&Array.isArray(e)?e.filter(n=>r.has(n.__type)):Array.from(r).flatMap(n=>this.getByType(n))}getById(t,e){let r={"location-profile":this.locationProfilesById,"location-category":this.locationCategoriesById,space:this.spacesById,floor:this.floorsById,"floor-stack":this.floorStacksById,facade:this.facadesById,node:this.nodesById,door:this.doorsById,connection:this.connectionsById,"mvf-connection":a=>ot(this,QT,Fte).call(this,this.mvfConnectionsById[a]),object:this.objectsById,"point-of-interest":this.pointsOfInterestById,annotation:this.annotationsById,area:this.areasById,"enterprise-location":this.locationsById,"enterprise-category":this.categoriesById},n=a=>{let o=r[a];if(o!=null)return typeof o=="function"?o(e):o[e]};return t==="unknown"?(()=>{for(let a of Object.keys(r)){let o=n(a);if(o!=null)return o}})():n(t)}getByExternalId(t,e){var r,n,i,a,o,s,l,u,c,h,d,p;switch(t){case"location-profile":return(r=this.locationProfilesByExternalId[e])!=null?r:[];case"location-category":return[];case"space":return(n=this.spacesByExternalId[e])!=null?n:[];case"floor":return(i=this.floorsByExternalId[e])!=null?i:[];case"floor-stack":return(a=this.floorStacksByExternalId[e])!=null?a:[];case"node":return(o=this.nodesByExternalId[e])!=null?o:[];case"door":return(s=this.doorsByExternalId[e])!=null?s:[];case"connection":return(l=this.connectionsByExternalId[e])!=null?l:[];case"object":return(u=this.objectsByExternalId[e])!=null?u:[];case"point-of-interest":return(c=this.poisByExternalId[e])!=null?c:[];case"area":return(h=this.areasByExternalId[e])!=null?h:[];case"enterprise-location":return(d=this.locationsByExternalId[e])!=null?d:[];case"enterprise-category":return(p=this.categoriesByExternalId[e])!=null?p:[];default:return[]}}getMapDataById(t){var e,r,n,i,a,o,s,l,u,c;return(c=(u=(l=(s=(o=(a=(i=(n=(r=(e=this.spacesById[t])!=null?e:this.floorsById[t])!=null?r:this.floorStacksById[t])!=null?n:this.facadesById[t])!=null?i:this.nodesById[t])!=null?a:this.doorsById[t])!=null?o:this.connectionsById[t])!=null?s:this.objectsById[t])!=null?l:this.pointsOfInterestById[t])!=null?u:this.annotationsById[t])!=null?c:this.areasById[t]}getMVFFeatureById(t,e){switch(t){case"space":return this.mvfSpacesById[e];case"node":return this.mvfNodesById[e];case"obstruction":return this.mvfObstructionById[e];case"floor":return this.mvfFloorsById[e];case"floor-stack":return this.mvfFloorStacksById[e];case"connection":return this.mvfConnectionsById[e];case"entrance":return this.mvfEntrancesById[e];case"annotation":return this.mvfAnnotationsById[e];case"area":return this.mvfAreasById[e];default:throw new Error("Unknown MVF feature type: ".concat(t))}}getMVFFeatureByNodeId(t,e){switch(t){case"connection":return this.mvfConnectionsByNodeId[e];default:throw new Error("Unsupported MVF feature type: ".concat(t))}}getMVFFeatureByType(t){switch(t){case"floor-stack":return this.mvfFloorStacks;case"floor":return this.mvfFloors;default:throw new Error("Unsupported MVF feature type: ".concat(t))}}getPropTranslation(t,e,r,n){var i,a;if(!this.currentLanguage)return n;let{code:o}=this.currentLanguage,s=(a=(i=this.languagePacks[o])==null?void 0:i.optimized)==null?void 0:a[t];if(s){let l=s[r];if(l!=null&&l[e]!==void 0){let u=l[e];if(u!=null&&typeof u=="object"){if(typeof n=="object"&&typeof u=="object"&&!Array.isArray(u)){let c=wG(o+t+r+e.toString());if(this.propTranslationCache.has(c))return this.propTranslationCache.get(c);let h=$T(n,u,["id"]);return this.propTranslationCache.set(c,h),h}return u}return u}}return n}findPreferredLanguage(t){if(!this.venue)return;let e=tYe(this.venue,t);return t?.languageCode!=null&&t.languageCode.toLowerCase()!==e.code.toLowerCase()&&Be.warn('Language code "'.concat(t.languageCode,'" could not be found in the venue. Using "').concat(e.code,'" instead.')),e}async changeLanguage(t){var e;let r=t.toLowerCase();if(!r){Be.error("Language code must be defined.");return}if(!this.currentLanguage||!this.venue){Be.error("Changing the language is not supported for this map.");return}let n=this.currentLanguage.code,i=(e=this.venue)==null?void 0:e.languages.find(({code:o})=>o.toLowerCase()===r.toLowerCase());if(!i){Be.warn('Language code "'.concat(r,'" could not be found in the venue.'));return}if(n===i.code)return;let a=this.languagePacks[i.code];if(!a){let o=this.localePacksUrls[i.code];if(!o){Be.error('Locale pack URL not found for language code "'.concat(i.code,'".'));return}f(this,ov)&&f(this,ov).abort();let s=new AbortController;ne(this,ov,s);let l;try{l=await qUe(o,{signal:s.signal})}catch(u){Be.error('Failed to download language pack for language code "'.concat(i.code,'".'),u);return}if(!l||s.signal.aborted)return;a=GR(l),this.languagePacks[i.code]=a}this.Analytics.sendChangeLanguageEvent({fromLanguage:this.currentLanguage.code}),this.currentLanguage=i,this.publish("language-change",this.currentLanguage)}getDistance(t,e){let r=oA(t),n=oA(e);return Cp([r.longitude,r.latitude],[n.longitude,n.latitude])}async toJSONBundle({downloadLanguagePacks:t=!0}={}){var e;let r=[];if(t&&this.enterpriseMode){let n=new AbortController;for(let i of((e=this.venue)==null?void 0:e.languages)||[])try{if(this.localePacksUrls[i.code]){let a=await LR(this.localePacksUrls[i.code],{signal:n.signal}),o=await jee(a);o&&r.push({language:{code:i.code,name:i.name},localePack:o})}}catch(a){Be.warn("failed downloading language pack",a)}}return{type:"json",options:{enterprise:this.enterpriseMode},languagePacks:r,main:this.mvf}}async toBinaryBundle({downloadLanguagePacks:t=!0}={}){var e;if(!this.binaryBundle){Be.error("binary bundle not found");return}let r=[];if(t&&this.enterpriseMode){let n=new AbortController;for(let i of((e=this.venue)==null?void 0:e.languages)||[])try{if(this.localePacksUrls[i.code]){let a=await LR(this.localePacksUrls[i.code],{signal:n.signal});a&&r.push({language:{code:i.code,name:i.name},localePack:a})}}catch(a){Be.warn("failed downloading language pack",a)}}return{type:"binary",options:{enterprise:this.enterpriseMode},languagePacks:r,main:this.binaryBundle}}destroy(){for(let t of globalThis.Object.keys(f(this,rr)))f(this,rr)[t]=null;this.propTranslationCache.clear()}};rr=new WeakMap,QT=new WeakSet,Fte=function(t){var e;let r=(e=t?.nodes)==null?void 0:e[0],n=this.getById("node",r);if(n==null)return;let i=$0([n.coordinate.longitude,n.coordinate.latitude]),a=this.connectionSpaceIdsByLatLon[i];return a?.map(o=>this.connectionsById[o]).find(o=>o!=null)},av=new WeakMap,ov=new WeakMap;var sL=(t,e)=>{var r;let n=!t,i=e?.smoothing,a=i!=null?typeof i=="object"?(r=i.enabled)!=null?r:n:i:n,o=typeof i=="object"?i.radius:void 0;return{enabled:a,radius:o??.75}};C();C();C();globalThis.MappedinDebug||(globalThis.MappedinDebug={});globalThis.MappedinDebug.__idleCallbackInteractionState={isInteracting:!1,interactionCheckers:[],pendingCallbacks:[],registerInteractionChecker:function(t){this.interactionCheckers.push(t)},unregisterInteractionChecker:function(t){let e;for(let r=this.interactionCheckers.length-1;r>=0;r--)if(e=this.interactionCheckers[r],e===t){this.interactionCheckers.splice(r,1);break}},checkInteraction:function(){let t=!1;for(let e=0;e<this.interactionCheckers.length;e++)if(t=this.interactionCheckers[e](),t)return!0;return!1},addPendingCallback:function(t,e){this.pendingCallbacks.push({callback:t,timeoutId:e}),this.scheduleDeferredCheck()},scheduleDeferredCheck:function(){var t=this;this.checkTimeoutId||(this.checkTimeoutId=setTimeout(function e(){if(t.checkInteraction())t.checkTimeoutId=setTimeout(e,16);else{t.checkTimeoutId=null;var r=t.pendingCallbacks.slice();t.pendingCallbacks=[];let n;for(let i=0;i<r.length;i++)if(n=r[i],n&&n.callback)try{n.callback()}catch{}}},16))},removePendingCallback:function(t){let e;for(let r=this.pendingCallbacks.length-1;r>=0;r--)if(e=this.pendingCallbacks[r],e.timeoutId===t){this.pendingCallbacks.splice(r,1);break}}};globalThis.requestIdleCallback=globalThis.requestIdleCallback||function(t){var e,r,n=performance.now(),i,a=!1,o=function(){if(!a){a=!0;try{t({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(performance.now()-n))}})}catch{}}};return(r=(e=globalThis.MappedinDebug)==null?void 0:e.__idleCallbackInteractionState)!=null&&r.checkInteraction()?(i=Date.now()+Math.random(),globalThis.MappedinDebug.__idleCallbackInteractionState.addPendingCallback(o,i),i):(i=setTimeout(o,0),i)};globalThis.cancelIdleCallback=globalThis.cancelIdleCallback||function(t){var e,r;clearTimeout(t),(r=(e=globalThis.MappedinDebug)==null?void 0:e.__idleCallbackInteractionState)==null||r.removePendingCallback(t)};C();C();(function(){typeof globalThis!="object"&&(Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__)})();var kGe="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAkGBwgHBgkICAgKCgkLDhcPDg0NDhwUFREXIh4jIyEeICAlKjUtJScyKCAgLj8vMjc5PDw8JC1CRkE6RjU7PDn/2wBDAQoKCg4MDhsPDxs5JiAmOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTn/wgARCAIABAADAREAAhEBAxEB/8QAGwABAAMBAQEBAAAAAAAAAAAAAAECAwQFBgf/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAP3EAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAIAAAJAFAAAAAAAAAAAAAAAAAAAAAAAAABAgAAEgCgAAAAAAAAAAAAAAAAAAAABERLSM1zM4zXMzjMoUIqCCSSS8XNC9mpoaVomharWTQAAAAAAAAAAAAAAAAEREtIoZrnGZkucUKFStQQSTFixdNDStF0TWrmiWqbJoAAAAAAAAAAAAAIgiWkZy4HNLzHLXKcxzpzmFYmRkUKFSCCSSxcuampsbR0HSdK9R1R1HTZvWll0mlAAAAAAAAAAAIiKLnLjHNLynLXKcycxzmNYmJmUKFSCAWLFy5qamxvHQvSdJ0nVHUdFm1aparWKAjNWSKAAAAARBEtYzlyXnjmOSuM4U4q4jjOM5a5k5zAyMjOqFCCCCSSS5c0jU1NzoOk6pew7TtjuO1e0646jezWr2WSaUAAAAAECIqtZco55eY464zhTirhOI5Dks5jAwMTIzqhUqQASWLFzSNTY3Og6V646zsO2O47V7DrjqNzWy9nlZ1c0LlrLEk0EQQVipRczIyMU5q5F4U8+vOPOrgThOOuU5jAxMjMzKpUggigJiSSxY0XQ1Njc6TqjtO49CX0D0T0Y7l7E6JdzU1NEvViSalBAWIqVKLSMjIxOauM4U86vPPOrz04TjrkOYwMTIzKJQqQQCKmBJJYutzQ1Njc6TrOyO475fRPRPQjuXsToXWPn6kkkEkhCkEAgggqVMjlrzzzDy7PMPPrhOQ5jBMqoVIIIAAIAJAAJJJLFzWN16TsO49CPTPUl9Q9A6o1LFiSSSSQpCwQQCCCpVMjlrzzyzy7PMPPrhOM5kwM6zKlQQAAQASAASCxY0NI3XpOw7j0I9M9SX0z0DqjU+UqpQqVIBFgEyixJYuWLFDkrzE8o8yvOONOasipBAAAAAAAAAAABJJY2OiO1fQPUj1T0pewuVKlCCqQsBIUSSSSWLlyTM5K808pPLrzziTnrEqQQAAAAAAAAAAASSWNjojtX0D1I9VfSOuND4uzMzqhQqVIALEli5c1jUuQc1vnp5pwJzVmQQAAAAAAAAAAAAAASSaHTHevpHoHTFjMyM6zKlSpABJJcsaGkamhU5q88804E5qzIIAAAAAAAAAAAAAAJJNDpjvX0j0Dqix8dVDMolSpAqCYElixc0XU0IMjlTlrIqAAAAAAAAAAAAAAAAAWNTqjqXYGZkZpUoQQRSFIsSXLroaGhBkcqctZFQAAAAAAAAAAAAAAAACxqdUdS7EngWQCAAQASACSSSwKlSCAAAAAAAAAAAAAAAAAACSSxYFSCCAACCQACSSSwKlSCAAAAAAAAAAAAAAAAAACSSxYGIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAJAJAJBAAIAIABAAAAAAAAAAAAAAAAAAAABIAJAJAJBAAIAIABAAAAJABAAAAAAAAAJBILEli5Y0LlzQ0Lly5csWLAkgFSChUoUMyhmUMyhQqVKkEEAEAAAAAAAAAkEgsSWLljQuXNDQuXLlyxYsCSAVIKFShQzKGZQzKFCpUqQe+ZmZkUKFCpUEEAAkksWLFzQ0NTU2NzY3Og3NzoNzc2NjU1NS5csSAQVKmZmZGRiYmBgYHOYGBgYGBiZGRkUMypUqQCAASSWLFi5oaGpqbG5sbnQbm50G5ubGxqampcuWJAIIKGZmZGRiYmBgYHOYGBgYGR+jmBzmBzmJiZGZQoQQSSWLmhqbGxudB0nSdJ1HSdR1HSdJ0G5qamhcsWJJJBIIIBUqVKFDIyMDA5jmOU5TlOY5TmOc5znMTEyMyhQggFixc0NTY2NzoOk6TpOo6TqOo6TpOg3NTU0LlixJJIJBAIKkFChQyMjAwOY5jlOU5jnP00yMTnOc5zAwMjMoVIJJLmhqbmx0HQdBubmxqXLkkgAAAAAAAAAAAAAEEFTMzMTEwOc5znMDAyMyhUgkkuaGpsbnQdB0G5ubGpcuSSAAAAAAAAAAAAAAQQVKGZ1gAEEEEFSCACSSxJJJIAAAAAAAAAAAAAAAAAAAAAAABBBBBUggAkkksSSSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQCCpBUqQVIKggAkFiSSxYksSSSSAAAAAAAAAAAAAAAAAAQCCpBUqQVIKggAkFiSSxYksSWBIAAKFiQAAAAAAAAACCpUoUMzIyMzMzMyhQoVKkEEAgkEkklixYuXNDQ0NTQ1NC5cuWJAAAAAAAAAAIKlShQzMjIzMzMzKFChUqQQQCCQSSSWLFyxoXNDQ1NDU0LljUkkAAAAAAAAAAggggEEAgAAAAAAAAAAAAAEkgkkkkkAAAAAAAAAAgggggEAgAAAAAEgEAAAAAAEkgkkuAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADyyCCCCCCCCAQASCSQWJJJJLEkkkkkgkkEgkAEgAAEAAgEAggEEEEEEEFSCCCCCCAQASCSQWJJJJLEkkkkkgkkEgEgEgAAEAAgEAggEEEEEH5AQQQQVBBAIAAJBIJJJLEkkkkliSSSSSQSSCQSAAAQAQQCCCCCCCCCpBBBBBUEEEAgAAkEgkkksSSSSSWJJJJJJBJIJBIAABABBAIIIIIIIIKg/LCAQCACAAAACQCQSCQSASSASCQCQAAAAAAQCAQAQCAQAQQCACAAAACQCQSCQSASSASCQCQAAAAAAQCAQAQCAQfPgAAAAAAAAAAAAAAkAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAgAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH/xAApEAAABQUBAQACAwACAwAAAAABAgQFFQMGERQWEhNAUAAgMGCAkKCw/9oACAEBAAECAP8AwTZznOf3mc5/YZE41xVivFyM6i7C8C8C8zMzMzMyDyDyDyDwV4K7ldSuZV5VgVwqZ/SCca4qxXmcjOouwvAvEzMzMzMzMyDyDyDwV4K7ldSuRVwKgrgf88TDWMrO4VHOo61Hao7ndzvB3k7yZ5M8i8i8zMzMzMyDyDyDyV5K8keSPJHmm8U3em70nam603Mi8qotUDfk5GqZUdfUc6jrUdqjvUeDvB3kzyZ5M8i8i8zMzMzMzMg8g8leSvJHkjyR5pvFN4pu9N2pOtNzIvKqLWA39PX+/saplJlh1tRfVcKrlVdKrrVdqrvVdzu53Y7sZ2M6mdRdRdBdJSUk5SUB0B0B1K6kdSOxHam7Unek70nei7UXWi6UXKk40l9NaRWWuB8/75E41zKjraq+q41nOq6VXas7VXeq71Hc7ud2O7GdRdRdZQXSUlJSUlAdCugOpXUjqR2I7U3em70nek70nai60XSk5UnGkvItIrKoCsC0FwLgXAuBbube3ubm7uiuFcZcZaZYdZUWVl1dwruVdzrulZ0qulVzqOR3EzgZeZcZcK0Vm3t7W1tbW1tgrBYC0q0q4q8jgRxpuVJzoulB0oOlBzoOVBworqa0iwi0i0q4FwLQWAr2trZ2trb3RWiuFcZaZadbUW1l1ZwruVd0rulZ0qulVzqOR3E7gZeZeK4VorNzb29ra2tsFe2CwFpVxVxV5HAjjTcqTnRdKDpQdKDnQcqDhRXU1pFhVm/ISUnKSkrLSsrKyspJyUhvitOtrLq69Q4qHGu41nGqvqLjrDKhUDW+nv1nP+Oc+vYVArFUEVEWUl1FfQcU7imckzinX0VxFoLgXyMlJykrLS0tLS0rKSclI74rjraq6uvUuKhxruNdxqr6i46wysVA1vp79Zz/AI5z6A4VArFUEVkWUl1FfQcU7imcUzinX0VxFoLZKTlJWVlpaXl5eWlpWUB0BzBxkDr669SvUr666stqqz1xqes/j5AxahFFJXRWp1yZemX0F5HCQkpOUlZaWlpeXl5aWB2lQdAcwcZE7hWcFLgpXqF1ZbVVnUDU9Z/HyBi1CV6SuitTrky9MvoLyL5AXEXEXIXIXKSkpKSkpIHIHIHIrkVxK4yJnCsvrra6uqpPVE354GJVpKaCtOtoryuEiZxM5C5C5C5SUnJSclJSQOQORXIrkVxBxM4VV9dbXV1VJ6om/PAxKtFTQVp1tFeRwkRWitFYKvb2tra2draBUCsFgLCrSrQWitOsqqT1RN+jAxKtJTTWFWitMtMtFYKzb29ra2tnaBUCsFZVhVpVoLRWnWVFJ6om/RgYlWkpprAW73v36zn++c+gOFQKv1GoJv04GCp9Rq/T36zn++c+gOFT7fUagm/TgYKn1+3/AKEeMefHjx8/n8vl8vn8/Hjx5xj9bjHnx48fP5/L5fL5/Px48ecY/wAvOPxceQIFIKIJgSAiBAVuK2FaitINAM4MwMwMsJCQkJCQkJCwosws4tAtItQtgtot4oRSCm+Hy8ecfi48gQKQUQTAkBECArcVsK1FaQaAZwZgZgZYSEhISEhISFhRZhZxaBaRahbBbRbxQikFN8BpfMWgWozWLaLcKAUWpq62vr/DX19YEoJARAhBvK2laytRGgjORlIyEYiMJLfJbxLdJbhLbJbRLaJbJbZLbAWxzHMcxzHMcxzHMDbBrYNbJraNbRrbPbh7dPbx7fOwHYjsZ2UzMZoM0maxbRbhQCi1NXW19fX19fW1QSAiBCDeVtK1laiNBGYjKRkIxEYSW+S3iW6S3CW2S2iW0S2S2yW2AtgLY5jmOY5jmOY5gbYNbJrZNbRraPbZ7cPbp7ePb52A7EdjOymZjW4e3D26e3j2+ZgMwmYhYxY4SEhISEBjKxlYiMJGAjAS3iW9TtynblO26dtUrap2zTtmnbNO2SW2S3isRWYGkG0EAItTW1/h8Phr6+rp6AtwtQs5mI9vntw9tHtk9s1LZqWzUto9tnts9uHt09vHt8zAZhMxCxixwkJCQkIDGVjKxEYSMBGAlvEt6nblO3Kdt0rap21TtmnbNO2SWyS2yW8ViKzA1A2ggBFqa2v8Ph8NfW1dPRFuFqMzGYjW+e3D20e2T2zUtk9tHto1tCzHYj2+e3T24e3D24a3DW4Nuc5znOc4FuBbhbcLbhLcJblO3CW4S3iMRGcrYVECcKYB+cJBoCjM2maDsZ7fPbp7cPbh7cNbhrcG3Oc5znOcC3C24W3C24S3CW5TtwluEt4jERnK2FRAnCmAfnCQaAoxb/7ePl8NbU09PT1NYKHy8Y/ZePl8NbU09PT1NYKHy8Y/4Z6+g1tjb3d+Rk5SVlZWVlZSTkd8Fu3s/b6es/pvX0Gtsbe7vyMnKSkrKysrKSciC8Fu3s/YKnrP9gqAb8X0NQawqBVCrMrMqMoGuNUTiYf4ICT5/L4/H4fD4fH4hSCmBAAP4AgctUtYqgqoqsqsqoFIVwqAb8X0NQawqBVCrMrMqMoGuNUTiYf4ICT5/L4/H4fD4fH4hSCmBAAP4AgctUtYqgqkqsqsqsFIV/Hn8XHj5/H4a+traurq6mpqampqampqampqampqampqampqamrq62tr/D4/Lx5/Fx4+fx+Gvra2rq6upqampqampqamrq6upqampqampqamrq6utra/w+Py/wCgEzNTc5OTs7PT09PT8/Pz09PT07Ozk3Ng9TMxLy0rKSclJSMhIb+9vbu9u7u7u7u7u729vb2/vyEjJSUnKSstLzEzNTc5OTs7Oz09PT8/Pz09PT07Ozk5NzUzMS8tKyknJSUjISG/v727vbu7u7u7u7u9u729v78hIyUlJykrLS8x0nR9H0fR9H0XRdF0XRdD0PQ9F0XRdF0XRdF0fR9H0nSdJ0vS9L0vTdN03TdP0/T9P0/T9P0/T9P0/T9R0/T9P0/T9P0/TdN03S9L0vS9J0nSdJ0fR9H0XRdF0PRdD0PQ9D0PRdF0XRdF0XR9H0fSdJ0nS9L0vS9N03TdN0/T9P0/T9P0/T9P0/T9P1HT9P0/T9P0/T9N03TdL0vS9L0vSS8tLy0tLS0rKysrKysrKysrKystLS0vLS8vLy8vMTExMTExMzMzMTMzMzM1NTUzMzMzMzMzMzExMTExMS8vLy8vLy8tKy0tKysrKysrKysrKysrLS0tLy0vLy8vLzExMTExMTMzMzEzMzMzNTU1MzMzMzMzMzMxMTExMTEvLy8vnOc5znOc5znOc5znOc5znOc59ZznPr169evXr169evXr169evXr16znOfWc5znOc5znOc5znOc5znOc5znOc59ZznPr169evXr169evXr169evXr16znOfWc5z/9YD//xAArEAEAAgIDAQABBAICAQUAAAAAAVICYgNRYQRBEEBQUzFCIDARYICQoLD/2gAIAQEAAz8A/wDgmhCEI/nYQj+RhjH5ccflxw44YMe0dtmzZs2bNmzZs2bIsjtiwlxy45/Ljn8se0fwuPbjj8uOPy44YQxR2izZs2bNmzZs2bNkWR2xYS45cc/lhP5Y9/wEQwj8sIRD1s2bNmzZs2bNmzZs2bNmzZs2bNmzZs2bNmyLMZYZMZ/KJ/dRDCPywhjCI/LZs2bNmzZs2bNmzZs2bNmzZs2bNmzZs2bNkWYywlhP5RP/ABj9hDGGMIh69bNmzZs2bNmzZsmybJsmybJsmybJsmybJsmybJs2bNmzZs2bNmzZ7+mMsZYyj9hDGGMIj9NmzZs2bNmzZs2bJsmybJsmybJs2TZNk2TZNk2bJs2bNmzZs2bNmzZ6iWMsXr16hiwYMGDBgwYo/T169/T162bNmzZs2TZNk2T2ntPae09pSlKUpSlPae09p7T2mybJsmzZs2bNmz17+nr16hiwYOPtx9uPtx9sO2DBih69evXr1s2bNmzZsmybJsmye09p7T2lKUpSlKU9p7T2ntNk2TZNmzZs2bNmz17+vr1s2bNmzZs2bNmzZs2evXr169bNmye09p7SlKUp/wC6UpSlKe09p7etmzZs9evWzZs2bNmzZs2bNmzZs2bPXr1s9bNmye09p7SlKUp/7pSlKUp7T29bPWz169evWzZs2bNmzZs2bNmzZs2bNmzZs2evU9plM/vJhMJ7T29bNnrZ62bNmzZs2bNmzZs2bNmzZs2bNnr39J7TKZ/eTCYT3+nr162bNnrZs2bJsntNk2TZPabNmzZs2etnr39JlM/wUwmP09etmzZs2bNk2TZNk2TZNk2bNmzZs2bNnv6TKZ/gphMfp69etk9p7T2ntKUpSlKUp7T2nt69e/pMpn+GmH/j9PXr1Pae09pSySlklKU9p7T29evf0mUz/DTCY/T16lP/AHSlKU/xUpSlP/dKUpT/ABUpT/8AQllKWTJl0y6ZdMumXTLpl0y6ZJSn+QlKWTJl0y6ZdMumXTLpl0y6ZJSn/sn9xKWXTLpn0z6Z9M+mXTLplVlVlVlVlVlVlVlVlVlVlRlVlVlRlVlVlVlVlVlVlVl0z6Z9M4/DPpn0z6ZdMkp/byll0y6Z9M+mfTPpn0y6ZVZVZVZVZVZVZVZVZUZVZUZVZVZVZVZVZVZVZVZVZVZdM+mfTOPwz6Z9M+mTJlVlVlVl0yZ9M2fTPpn0z6Z9M+mbPpn0z6Z9M2fTPpl0yqyqyqyqyqyomiaJomiaJomiaJomjRo0aNGjRo0aNGjRNE0TRNE0TRNE0TRNE0ZVZVZVZVZVZVZM+mbPpn0z6Z9M+mfTNn0z6Z9M+mfTPpl0y6ZVZVZVTVlVlRNE0TRlRNE0TRNE0TRo0aNGjRo0aNGjRomiaJomiaJomiaJomqaJqyq0TRNE0TRNE0TVNE1TVNU1TRNE1TVNU0TRNE0TRNGjRo0aNGjRhWHFHTgh88Pmj8Pnj/V89HBRwf1w4f64cNMXFSHFTFxUxcVIcP9cOGkOCkPno+ej55/D55cEuKemHUIo0aNGjRo0TRNE0TRNE0TVNE0TVNE1TVNE1TRNU0TRNE0TRNGjRo0aNGjRhWHFHThh88Pnj8Pnq+ejgo4P64cP9cOKkOKkOKmLipi4aYuH+uHBSHBSHz0fPR88/h88uCXFNWHUIo0aNGjRo4ZcU9MOoRRFGjRo0aNGjRo0aNGjRo0RRhVxR04IcGP4cGP+jij/GEMI/xjCP3+M/5xhxT/AJwhwT/o4Mv9XBk4p6YdQiiKNGjRo0aNGjRo0aNGjRoijGsOKOnBi4Mfw4I/0cUf4whhH+MYR+/xn/OMOKf84Q4J/wBHBP8Ar/zxrDCsOKkOKjhq4auGrhq4auGjipDjpDGsI/k8awwrDipDio4aOGrhq4auGrho4qQ46QxrCP8A0bHcMLQ47w4rw4buCzgs4O3A4HA4XA4HA4HA4O3BZwWcN3Fdx3hhaGNoR/Dx3DC0OO8OK8OG7gs4LODtwOBwOFwOBwOBwODtwWcFnDdxXcd4YWhjaEf88UftoQh4y6ZuRyuVzOZzeudz+uf1z+uf1z+uf1z+uf1zuf1z+uf1z+uf1z+udzR25nM5o7c3rlcrlZsniOkSj9tCEPGXTNyuVy+uZzOb1z+uf1z+uf1z+uf1z+uf1z+udz+uf1z+uf1z+uf1z+ueO3O5nM5vXK5XKzZPEdMUftoYsemHTDpx9OPpxVcVXDVw1cNXDVw0cNHDRw0cNHDRw0cNHDRw0cNHDRw0cNHDRw0cNHDVw1cNXFVxVcVXFVx9OPph0w6Yo/bQxY9MOnH04+nH04quKrhq4auGrhq4aOGjho4aOGjho4aOGkOGkOGkOGjho4aOGjho4aOGjhq4auGriq4quKriq4+nH0w6Ydf+wHgcLhcLicTjYdww7hh3DDuGPcMe4Y9ww7hh3DDuGHcONxuJxOFwuBwOB8753z2fPZ89nz3fNd893zXfPd893z3fP/Y+e757uC75/wCyHz/2Q+f+yHBd893z3fPd893z3fPd893zXfNd893z2fPZ8/b5+3zvncDgcLhcLicTjYdww7hh3DDuGHcMe4Ydww7hh3DDuGHcONxuJxOFwuBwPnfO+d89nz2fPZ893zXfPd813z3fPd893z/2Pnu+e7gu+f8Ash8/9kPn/shwXcF3z3fPd893z3fPd893zXfNd893z2fPZ8/b5+3zvncDdu3bt03bt26bpum6bpum6bt27du3bt26bt26bpum6bpum6bpum6bt03TdN26bpum6bpum7dN03TdN03TdN03TdN03Tdum7dum7dN27dum6bpum6bpum6bpum7du3bt03bpu3bpum6bpum6bpum6bpu3TdN03bpum6bpum6bt03TdN03TdN03TdN03TdN03TduysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysmzKzKzKybMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrJT+2lKUpSlKUpSlKUpSlKUpSlKUpSlKUpSlKUpSn9tKUpSlKUpSlKUpSlKUpSlKUpSlKUpSlKUpT/wDrA//EAB0RAAMBAAMBAQEAAAAAAAAAAAABERIwQFAgkMD/2gAIAQIBAT8A/COlKioqKioqKi+zSoqKioqL59Ro0aKyvpVlZWaNFXiVGkaNFZWV9CsrNGjRpFXepo0V8c69Zo0u1pGilfVnJWaNF+NFXNUaNFfmU0aReamkaNPzNM19VlZWaKysrK/XrKzTNGjRWaKyv+u0/8QAHREBAQACAQUAAAAAAAAAAAAAEQBAUCAQITCQwP/aAAgBAwEBPwD1NkRER07eYiIiNMRERGARERGgIiNAREZRERoCIjiYBERqiIwiI1REcCIiIiIjbkREREREfXZ//9k=";C();C();var OGe=!1;function BGe(){return OGe}var zGe=class{constructor(t){S(this,"backgroundAlpha",1),S(this,"backgroundColor",new jt),S(this,"width",0),S(this,"height",0),S(this,"options",{}),S(this,"renderer"),S(this,"enabledLayers",new Set([0,1])),S(this,"handleWebGLContextCreationError",o=>{var s,l;(l=(s=this.options).onWebGLContextCreationError)==null||l.call(s,o)}),S(this,"handleWebGLContextLost",o=>{var s,l;(l=(s=this.options).onWebGLContextLost)==null||l.call(s,o)}),S(this,"handleWebGLContextRestored",o=>{var s,l;(l=(s=this.options).onWebGLContextRestored)==null||l.call(s,o)});var e,r,n,i,a;try{this.options=t,BGe()?(this.renderer={setSize:()=>{},state:{reset:()=>{}},properties:{get:()=>{}},getSize:()=>({width:window.innerWidth,height:innerHeight}),getDrawingBufferSize:()=>({width:window.innerWidth,height:innerHeight}),getClearAlpha:()=>1,getClearColor:()=>new jt,autoUpdate:!0,shadowMap:{autoUpdate:!0},getContext:()=>({getContextAttributes(){return{alpha:!0,antialias:!1,depth:!0,stencil:!1}}}),readRenderTargetPixelsAsync:()=>Promise.resolve([]),setRenderTarget:()=>{},setClearColor:()=>{},clear:()=>{},render:()=>{},clearStencil:()=>{},clearDepth:()=>{},domElement:document.createElement("canvas"),capabilities:{isWebGL2:!0}},this.renderer.domElement.style.width="1920px",Object.defineProperty(this.renderer.domElement,"clientWidth",{value:1920}),this.renderer.domElement.style.height="1080px",Object.defineProperty(this.renderer.domElement,"clientHeight",{value:1080})):(this.renderer=new nhe({canvas:t.canvas,alpha:t.alpha||!1,stencil:!0,antialias:typeof t.antialias=="boolean"?t.antialias:!0,powerPreference:"high-performance",preserveDrawingBuffer:!0}),this.renderer.localClippingEnabled=!0),this.backgroundColor=new jt((e=t.backgroundColor)!=null?e:"#ffffff"),this.backgroundAlpha=(r=t.backgroundAlpha)!=null?r:1}catch(o){Be.error(o),t.onWebGLRendererError&&t.onWebGLRendererError(o)}(n=this.domElement())==null||n.addEventListener("webglcontextlost",this.handleWebGLContextLost),(i=this.domElement())==null||i.addEventListener("webglcontextrestored",this.handleWebGLContextRestored),(a=this.domElement())==null||a.addEventListener("webglcontextcreationerror",this.handleWebGLContextCreationError)}destroy(){var t,e,r,n,i;this.renderer&&((e=(t=this.renderer).dispose)==null||e.call(t)),(r=this.domElement())==null||r.removeEventListener("webglcontextlost",this.handleWebGLContextLost),(n=this.domElement())==null||n.removeEventListener("webglcontextrestored",this.handleWebGLContextRestored),(i=this.domElement())==null||i.removeEventListener("webglcontextcreationerror",this.handleWebGLContextCreationError)}render(t,e){if(this.renderer){this.renderer.state.reset(),e.layers.disableAll();for(let r of this.enabledLayers.values())e.layers.enable(r);this.renderer.clearStencil(),this.renderer.autoClear=!1,this.renderer.setRenderTarget(null),this.renderer.render(t,e),this.renderer.clearDepth(),e.layers.disableAll(),e.layers.enable(rd.ALWAYS_ON_TOP_PATHS),this.renderer.render(t,e),this.renderer.state.reset()}}clear(){this.renderer&&(this.renderer.setClearColor(this.backgroundColor,this.backgroundAlpha),this.renderer.clear())}setBufferSize(t,e){Oi.env.NODE_ENV==="test"||!this.renderer||(this.width=t,this.height=e,this.renderer.setSize(t,e,!1))}setBackgroundColor(t,e){this.backgroundColor=t,this.backgroundAlpha=e}domElement(){var t;return(t=this.renderer)==null?void 0:t.domElement}};C();C();var FGe=`"use strict";(()=>{var Ya=Object.defineProperty,fl=Object.defineProperties;var pl=Object.getOwnPropertyDescriptors;var qa=Object.getOwnPropertySymbols;var gl=Object.prototype.hasOwnProperty,vl=Object.prototype.propertyIsEnumerable;var Mr=(e,r,n)=>r in e?Ya(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n,m=(e,r)=>{for(var n in r||(r={}))gl.call(r,n)&&Mr(e,n,r[n]);if(qa)for(var n of qa(r))vl.call(r,n)&&Mr(e,n,r[n]);return e},z=(e,r)=>fl(e,pl(r));var _e=(e,r)=>{for(var n in r)Ya(e,n,{get:r[n],enumerable:!0})};var M=(e,r,n)=>Mr(e,typeof r!="symbol"?r+"":r,n);function Qa(e,r){return r.x+r.w<e.x+e.w&&r.x>e.x&&r.y>e.y&&r.y+r.h<e.y+e.h}function Ha(e,r){let[n,i]=r;return n>=e.x&&n<=e.x+e.w&&i>=e.y&&i<=e.y+e.h}function eu(e,r){let n=r.x,i=r.y,t=r.x+r.w,o=r.y+r.h,u=e.x,l=e.y,c=e.x+e.w,a=e.y+e.h;return n<c&&u<t&&i<a&&l<o}function ue(e,r){for(let n=0;n<r.length;n++)e.push(r[n])}var E=class{constructor(r,n,i,t,o){M(this,"x");M(this,"y");M(this,"w");M(this,"h");M(this,"userData");this.userData=typeof o>"u"?null:o,this.x=r,this.y=n,this.w=i,this.h=t}contains(r){return r===this?!1:Qa(this,r)}intersects(r){return eu(this,r)}intersectsPoint(r){return Ha(this,r)}draw(r){r.fillStyle="rgba(123,222,26, 0.8)",r.fillRect(this.x,this.y,this.w,this.h)}};var Me=class e{constructor(r,n){M(this,"topLeft");M(this,"topRight");M(this,"bottomLeft");M(this,"bottomRight");M(this,"divided",!1);M(this,"boundary");M(this,"capacity",16);M(this,"objects",[]);M(this,"parent");this.parent=n,this.boundary=r}getSize(){return this.divided?this.objects.length+this.topLeft.getSize()+this.topRight.getSize()+this.bottomLeft.getSize()+this.bottomRight.getSize():this.objects.length}subdivide(){let{x:r,y:n,w:i,h:t}=this.boundary;this.topLeft=new e(new E(r,n,i/2,t/2),this),this.topRight=new e(new E(r+i/2,n,i/2,t/2),this),this.bottomLeft=new e(new E(r,n+t/2,i/2,t/2),this),this.bottomRight=new e(new E(r+i/2,n+t/2,i/2,t/2),this),this.divided=!0}queryRect(r){let n=[];if(this.boundary.intersects(r))n.push(...this.objects);else return[];return this.divided&&(ue(n,this.topLeft.queryRect(r)),ue(n,this.topRight.queryRect(r)),ue(n,this.bottomLeft.queryRect(r)),ue(n,this.bottomRight.queryRect(r))),n}queryPoint(r){let n=[];if(this.boundary.intersectsPoint(r))n.push(...this.objects);else return[];return this.divided&&(ue(n,this.topLeft.queryPoint(r)),ue(n,this.topRight.queryPoint(r)),ue(n,this.bottomLeft.queryPoint(r)),ue(n,this.bottomRight.queryPoint(r))),n}insert(r){return(this.parent?!this.boundary.contains(r):!this.boundary.intersects(r))?!1:this.objects.length<this.capacity?(this.objects.push(r),!0):(this.divided||this.subdivide(),(this.topLeft.insert(r)||this.topRight.insert(r)||this.bottomLeft.insert(r)||this.bottomRight.insert(r))===!1&&this.objects.push(r),!0)}drawObjects(r){this.objects.forEach(n=>n.draw(r)),this.divided&&(this.topLeft.drawObjects(r),this.topRight.drawObjects(r),this.bottomLeft.drawObjects(r),this.bottomRight.drawObjects(r))}draw(r){r.rect(this.boundary.x,this.boundary.y,this.boundary.w,this.boundary.h),this.divided&&(this.topLeft.draw(r),this.topRight.draw(r),this.bottomLeft.draw(r),this.bottomRight.draw(r)),r.strokeStyle="black",r.lineWidth=4,r.stroke()}};var Fe={};_e(Fe,{$brand:()=>Pt,$input:()=>lo,$output:()=>co,NEVER:()=>Br,TimePrecision:()=>fo,ZodAny:()=>Oc,ZodArray:()=>Zc,ZodBase64:()=>Ua,ZodBase64URL:()=>Na,ZodBigInt:()=>Ot,ZodBigIntFormat:()=>Ta,ZodBoolean:()=>jt,ZodCIDRv4:()=>Oa,ZodCIDRv6:()=>Pa,ZodCUID:()=>xa,ZodCUID2:()=>ka,ZodCatch:()=>Qc,ZodCodec:()=>Ba,ZodCustom:()=>Ar,ZodCustomStringFormat:()=>wt,ZodDate:()=>Dr,ZodDefault:()=>Kc,ZodDiscriminatedUnion:()=>Dc,ZodE164:()=>Za,ZodEmail:()=>ba,ZodEmoji:()=>_a,ZodEnum:()=>zt,ZodError:()=>Bd,ZodFile:()=>Jc,ZodFirstPartyTypeKind:()=>Ka,ZodFunction:()=>ul,ZodGUID:()=>Or,ZodIPv4:()=>Sa,ZodIPv6:()=>ja,ZodISODate:()=>wr,ZodISODateTime:()=>Ir,ZodISODuration:()=>jr,ZodISOTime:()=>Sr,ZodIntersection:()=>Tc,ZodIssueCode:()=>rf,ZodJWT:()=>Da,ZodKSUID:()=>wa,ZodLazy:()=>il,ZodLiteral:()=>Fc,ZodMap:()=>Cc,ZodNaN:()=>el,ZodNanoID:()=>ya,ZodNever:()=>Uc,ZodNonOptional:()=>Ja,ZodNull:()=>Sc,ZodNullable:()=>Bc,ZodNumber:()=>St,ZodNumberFormat:()=>Ve,ZodObject:()=>Er,ZodOptional:()=>Fa,ZodPipe:()=>Ma,ZodPrefault:()=>Wc,ZodPromise:()=>al,ZodReadonly:()=>tl,ZodRealError:()=>X,ZodRecord:()=>La,ZodSet:()=>Vc,ZodString:()=>It,ZodStringFormat:()=>A,ZodSuccess:()=>Yc,ZodSymbol:()=>Ic,ZodTemplateLiteral:()=>nl,ZodTransform:()=>Mc,ZodTuple:()=>Ac,ZodType:()=>U,ZodULID:()=>za,ZodURL:()=>Zr,ZodUUID:()=>de,ZodUndefined:()=>wc,ZodUnion:()=>Aa,ZodUnknown:()=>Pc,ZodVoid:()=>Nc,ZodXID:()=>Ia,_ZodString:()=>$a,_default:()=>Gc,_function:()=>Xm,any:()=>Om,array:()=>Tr,base64:()=>mm,base64url:()=>fm,bigint:()=>zm,boolean:()=>zc,catch:()=>Hc,check:()=>qm,cidrv4:()=>sm,cidrv6:()=>dm,clone:()=>K,codec:()=>Km,coerce:()=>Rr,config:()=>L,core:()=>ae,cuid:()=>nm,cuid2:()=>im,custom:()=>Ym,date:()=>Um,decode:()=>la,decodeAsync:()=>da,discriminatedUnion:()=>Em,e164:()=>pm,email:()=>Gd,emoji:()=>tm,encode:()=>ca,encodeAsync:()=>sa,endsWith:()=>vt,enum:()=>Ca,file:()=>Fm,flattenError:()=>He,float32:()=>_m,float64:()=>ym,formatError:()=>et,function:()=>Xm,getErrorMap:()=>of,globalRegistry:()=>oe,gt:()=>le,gte:()=>W,guid:()=>Wd,hash:()=>bm,hex:()=>$m,hostname:()=>hm,httpUrl:()=>em,includes:()=>pt,instanceof:()=>Qm,int:()=>ha,int32:()=>xm,int64:()=>Im,intersection:()=>Ec,ipv4:()=>cm,ipv6:()=>lm,iso:()=>kt,json:()=>ef,jwt:()=>gm,keyof:()=>Nm,ksuid:()=>um,lazy:()=>ol,length:()=>Re,literal:()=>Vm,locales:()=>ze,looseObject:()=>Tm,lowercase:()=>mt,lt:()=>ce,lte:()=>H,map:()=>Rm,maxLength:()=>Ae,maxSize:()=>Ee,mime:()=>ht,minLength:()=>$e,minSize:()=>we,multipleOf:()=>Ie,nan:()=>Bm,nanoid:()=>rm,nativeEnum:()=>Cm,negative:()=>Fo,never:()=>Ea,nonnegative:()=>Mo,nonoptional:()=>qc,nonpositive:()=>Jo,normalize:()=>$t,null:()=>jc,nullable:()=>Ur,nullish:()=>Jm,number:()=>kc,object:()=>Zm,optional:()=>Pr,overwrite:()=>se,parse:()=>ia,parseAsync:()=>oa,partialRecord:()=>Am,pipe:()=>Nr,positive:()=>Vo,prefault:()=>Xc,preprocess:()=>tf,prettifyError:()=>rn,promise:()=>Wm,property:()=>Bo,readonly:()=>rl,record:()=>Lc,refine:()=>cl,regex:()=>dt,regexes:()=>Q,registry:()=>ir,safeDecode:()=>fa,safeDecodeAsync:()=>ga,safeEncode:()=>ma,safeEncodeAsync:()=>pa,safeParse:()=>aa,safeParseAsync:()=>ua,set:()=>Lm,setErrorMap:()=>nf,size:()=>st,startsWith:()=>gt,strictObject:()=>Dm,string:()=>va,stringFormat:()=>vm,stringbool:()=>Hm,success:()=>Mm,superRefine:()=>ll,symbol:()=>Sm,templateLiteral:()=>Gm,toJSONSchema:()=>Qo,toLowerCase:()=>_t,toUpperCase:()=>yt,transform:()=>Va,treeifyError:()=>tn,trim:()=>bt,tuple:()=>Rc,uint32:()=>km,uint64:()=>wm,ulid:()=>om,undefined:()=>jm,union:()=>Ra,unknown:()=>Ce,uppercase:()=>ft,url:()=>Hd,util:()=>_,uuid:()=>Xd,uuidv4:()=>qd,uuidv6:()=>Yd,uuidv7:()=>Qd,void:()=>Pm,xid:()=>am});var ae={};_e(ae,{$ZodAny:()=>Ui,$ZodArray:()=>Ei,$ZodAsyncError:()=>te,$ZodBase64:()=>yi,$ZodBase64URL:()=>xi,$ZodBigInt:()=>Qt,$ZodBigIntFormat:()=>Si,$ZodBoolean:()=>it,$ZodCIDRv4:()=>$i,$ZodCIDRv6:()=>bi,$ZodCUID:()=>ui,$ZodCUID2:()=>ci,$ZodCatch:()=>Hi,$ZodCheck:()=>R,$ZodCheckBigIntFormat:()=>An,$ZodCheckEndsWith:()=>Xn,$ZodCheckGreaterThan:()=>Bt,$ZodCheckIncludes:()=>Gn,$ZodCheckLengthEquals:()=>Jn,$ZodCheckLessThan:()=>Mt,$ZodCheckLowerCase:()=>Bn,$ZodCheckMaxLength:()=>Vn,$ZodCheckMaxSize:()=>Rn,$ZodCheckMimeType:()=>Yn,$ZodCheckMinLength:()=>Fn,$ZodCheckMinSize:()=>Ln,$ZodCheckMultipleOf:()=>Tn,$ZodCheckNumberFormat:()=>En,$ZodCheckOverwrite:()=>Qn,$ZodCheckProperty:()=>qn,$ZodCheckRegex:()=>Mn,$ZodCheckSizeEquals:()=>Cn,$ZodCheckStartsWith:()=>Wn,$ZodCheckStringFormat:()=>De,$ZodCheckUpperCase:()=>Kn,$ZodCodec:()=>ot,$ZodCustom:()=>uo,$ZodCustomStringFormat:()=>Ii,$ZodDate:()=>Ti,$ZodDefault:()=>Xi,$ZodDiscriminatedUnion:()=>Ri,$ZodE164:()=>ki,$ZodEmail:()=>ni,$ZodEmoji:()=>oi,$ZodEncodeError:()=>me,$ZodEnum:()=>Ji,$ZodError:()=>Qe,$ZodFile:()=>Bi,$ZodFunction:()=>io,$ZodGUID:()=>ti,$ZodIPv4:()=>vi,$ZodIPv6:()=>hi,$ZodISODate:()=>fi,$ZodISODateTime:()=>mi,$ZodISODuration:()=>gi,$ZodISOTime:()=>pi,$ZodIntersection:()=>Li,$ZodJWT:()=>zi,$ZodKSUID:()=>di,$ZodLazy:()=>ao,$ZodLiteral:()=>Mi,$ZodMap:()=>Vi,$ZodNaN:()=>eo,$ZodNanoID:()=>ai,$ZodNever:()=>Zi,$ZodNonOptional:()=>Yi,$ZodNull:()=>Pi,$ZodNullable:()=>Wi,$ZodNumber:()=>Yt,$ZodNumberFormat:()=>wi,$ZodObject:()=>wu,$ZodObjectJIT:()=>Ai,$ZodOptional:()=>Gi,$ZodPipe:()=>to,$ZodPrefault:()=>qi,$ZodPromise:()=>oo,$ZodReadonly:()=>ro,$ZodRealError:()=>G,$ZodRecord:()=>Ci,$ZodRegistry:()=>Te,$ZodSet:()=>Fi,$ZodString:()=>ke,$ZodStringFormat:()=>T,$ZodSuccess:()=>Qi,$ZodSymbol:()=>ji,$ZodTemplateLiteral:()=>no,$ZodTransform:()=>Ki,$ZodTuple:()=>er,$ZodType:()=>O,$ZodULID:()=>li,$ZodURL:()=>ii,$ZodUUID:()=>ri,$ZodUndefined:()=>Oi,$ZodUnion:()=>Ht,$ZodUnknown:()=>Ni,$ZodVoid:()=>Di,$ZodXID:()=>si,$brand:()=>Pt,$constructor:()=>d,$input:()=>lo,$output:()=>co,Doc:()=>nt,JSONSchema:()=>Ho,JSONSchemaGenerator:()=>xt,NEVER:()=>Br,TimePrecision:()=>fo,_any:()=>Do,_array:()=>Ko,_base64:()=>yr,_base64url:()=>xr,_bigint:()=>So,_boolean:()=>Io,_catch:()=>Rd,_check:()=>_c,_cidrv4:()=>br,_cidrv6:()=>_r,_coercedBigint:()=>jo,_coercedBoolean:()=>wo,_coercedDate:()=>Lo,_coercedNumber:()=>bo,_coercedString:()=>mo,_cuid:()=>mr,_cuid2:()=>fr,_custom:()=>Wo,_date:()=>Ro,_decode:()=>Et,_decodeAsync:()=>Rt,_default:()=>Td,_discriminatedUnion:()=>kd,_e164:()=>kr,_email:()=>or,_emoji:()=>sr,_encode:()=>Tt,_encodeAsync:()=>At,_endsWith:()=>vt,_enum:()=>Od,_file:()=>Go,_float32:()=>yo,_float64:()=>xo,_gt:()=>le,_gte:()=>W,_guid:()=>ct,_includes:()=>pt,_int:()=>_o,_int32:()=>ko,_int64:()=>Oo,_intersection:()=>zd,_ipv4:()=>hr,_ipv6:()=>$r,_isoDate:()=>go,_isoDateTime:()=>po,_isoDuration:()=>ho,_isoTime:()=>vo,_jwt:()=>zr,_ksuid:()=>vr,_lazy:()=>Fd,_length:()=>Re,_literal:()=>Ud,_lowercase:()=>mt,_lt:()=>ce,_lte:()=>H,_map:()=>Sd,_max:()=>H,_maxLength:()=>Ae,_maxSize:()=>Ee,_mime:()=>ht,_min:()=>W,_minLength:()=>$e,_minSize:()=>we,_multipleOf:()=>Ie,_nan:()=>Co,_nanoid:()=>dr,_nativeEnum:()=>Pd,_negative:()=>Fo,_never:()=>Eo,_nonnegative:()=>Mo,_nonoptional:()=>Ed,_nonpositive:()=>Jo,_normalize:()=>$t,_null:()=>Zo,_nullable:()=>Dd,_number:()=>$o,_optional:()=>Zd,_overwrite:()=>se,_parse:()=>Pe,_parseAsync:()=>Ue,_pipe:()=>Ld,_positive:()=>Vo,_promise:()=>Jd,_property:()=>Bo,_readonly:()=>Cd,_record:()=>wd,_refine:()=>Xo,_regex:()=>dt,_safeDecode:()=>Ct,_safeDecodeAsync:()=>Ft,_safeEncode:()=>Lt,_safeEncodeAsync:()=>Vt,_safeParse:()=>Ne,_safeParseAsync:()=>Ze,_set:()=>jd,_size:()=>st,_startsWith:()=>gt,_string:()=>so,_stringFormat:()=>Le,_stringbool:()=>Yo,_success:()=>Ad,_superRefine:()=>qo,_symbol:()=>Uo,_templateLiteral:()=>Vd,_toLowerCase:()=>_t,_toUpperCase:()=>yt,_transform:()=>Nd,_trim:()=>bt,_tuple:()=>Id,_uint32:()=>zo,_uint64:()=>Po,_ulid:()=>pr,_undefined:()=>No,_union:()=>xd,_unknown:()=>To,_uppercase:()=>ft,_url:()=>lt,_uuid:()=>ar,_uuidv4:()=>ur,_uuidv6:()=>cr,_uuidv7:()=>lr,_void:()=>Ao,_xid:()=>gr,clone:()=>K,config:()=>L,decode:()=>Ml,decodeAsync:()=>Kl,encode:()=>Jl,encodeAsync:()=>Bl,flattenError:()=>He,formatError:()=>et,globalConfig:()=>Be,globalRegistry:()=>oe,isValidBase64:()=>_i,isValidBase64URL:()=>xu,isValidJWT:()=>ku,locales:()=>ze,parse:()=>Zt,parseAsync:()=>Dt,prettifyError:()=>rn,regexes:()=>Q,registry:()=>ir,safeDecode:()=>Wl,safeDecodeAsync:()=>ql,safeEncode:()=>Gl,safeEncodeAsync:()=>Xl,safeParse:()=>nn,safeParseAsync:()=>on,toDotPath:()=>ou,toJSONSchema:()=>Qo,treeifyError:()=>tn,util:()=>_,version:()=>Hn});var Br=Object.freeze({status:"aborted"});function d(e,r,n){var l;function i(c,a){var v,f;var s;Object.defineProperty(c,"_zod",{value:(v=c._zod)!=null?v:{},enumerable:!1}),(f=(s=c._zod).traits)!=null||(s.traits=new Set),c._zod.traits.add(e),r(c,a);for(let h in u.prototype)h in c||Object.defineProperty(c,h,{value:u.prototype[h].bind(c)});c._zod.constr=u,c._zod.def=a}let t=(l=n==null?void 0:n.Parent)!=null?l:Object;class o extends t{}Object.defineProperty(o,"name",{value:e});function u(c){var v;var a;let s=n!=null&&n.Parent?new o:this;i(s,c),(v=(a=s._zod).deferred)!=null||(a.deferred=[]);for(let f of s._zod.deferred)f();return s}return Object.defineProperty(u,"init",{value:i}),Object.defineProperty(u,Symbol.hasInstance,{value:c=>{var a,s;return n!=null&&n.Parent&&c instanceof n.Parent?!0:(s=(a=c==null?void 0:c._zod)==null?void 0:a.traits)==null?void 0:s.has(e)}}),Object.defineProperty(u,"name",{value:e}),u}var Pt=Symbol("zod_brand"),te=class extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}},me=class extends Error{constructor(r){super("Encountered unidirectional transform during encode: ".concat(r)),this.name="ZodEncodeError"}},Be={};function L(e){return e&&Object.assign(Be,e),Be}var _={};_e(_,{BIGINT_FORMAT_RANGES:()=>en,Class:()=>Gr,NUMBER_FORMAT_RANGES:()=>Hr,aborted:()=>he,allowsEval:()=>Xr,assert:()=>yl,assertEqual:()=>hl,assertIs:()=>bl,assertNever:()=>_l,assertNotEqual:()=>$l,assignProp:()=>pe,base64ToUint8Array:()=>ru,base64urlToUint8Array:()=>Rl,cached:()=>je,captureStackTrace:()=>Nt,cleanEnum:()=>Al,cleanRegex:()=>We,clone:()=>K,cloneDef:()=>kl,createTransparentProxy:()=>Ol,defineLazy:()=>Z,esc:()=>Ut,escapeRegex:()=>ie,extend:()=>Nl,finalizeIssue:()=>Y,floatSafeRemainder:()=>Wr,getElementAtPath:()=>zl,getEnumValues:()=>Ge,getLengthableOrigin:()=>Ye,getParsedType:()=>jl,getSizableOrigin:()=>qe,hexToUint8Array:()=>Cl,isObject:()=>ye,isPlainObject:()=>ve,issue:()=>Oe,joinValues:()=>p,jsonStringifyReplacer:()=>Se,merge:()=>Dl,mergeDefs:()=>ge,normalizeParams:()=>y,nullish:()=>fe,numKeys:()=>Sl,objectClone:()=>xl,omit:()=>Ul,optionalKeys:()=>Qr,partial:()=>Tl,pick:()=>Pl,prefixIssues:()=>q,primitiveTypes:()=>Yr,promiseAllObject:()=>Il,propertyKeyTypes:()=>Xe,randomString:()=>wl,required:()=>El,safeExtend:()=>Zl,shallowClone:()=>qr,stringifyPrimitive:()=>b,uint8ArrayToBase64:()=>nu,uint8ArrayToBase64url:()=>Ll,uint8ArrayToHex:()=>Vl,unwrapMessage:()=>Ke});function hl(e){return e}function $l(e){return e}function bl(e){}function _l(e){throw new Error}function yl(e){}function Ge(e){let r=Object.values(e).filter(i=>typeof i=="number");return Object.entries(e).filter(([i,t])=>r.indexOf(+i)===-1).map(([i,t])=>t)}function p(e,r="|"){return e.map(n=>b(n)).join(r)}function Se(e,r){return typeof r=="bigint"?r.toString():r}function je(e){return{get value(){{let n=e();return Object.defineProperty(this,"value",{value:n}),n}throw new Error("cached value already set")}}}function fe(e){return e==null}function We(e){let r=e.startsWith("^")?1:0,n=e.endsWith("$")?e.length-1:e.length;return e.slice(r,n)}function Wr(e,r){let n=(e.toString().split(".")[1]||"").length,i=r.toString(),t=(i.split(".")[1]||"").length;if(t===0&&/\\d?e-\\d?/.test(i)){let c=i.match(/\\d?e-(\\d?)/);c!=null&&c[1]&&(t=Number.parseInt(c[1]))}let o=n>t?n:t,u=Number.parseInt(e.toFixed(o).replace(".","")),l=Number.parseInt(r.toFixed(o).replace(".",""));return u%l/10**o}var tu=Symbol("evaluating");function Z(e,r,n){let i;Object.defineProperty(e,r,{get(){if(i!==tu)return i===void 0&&(i=tu,i=n()),i},set(t){Object.defineProperty(e,r,{value:t})},configurable:!0})}function xl(e){return Object.create(Object.getPrototypeOf(e),Object.getOwnPropertyDescriptors(e))}function pe(e,r,n){Object.defineProperty(e,r,{value:n,writable:!0,enumerable:!0,configurable:!0})}function ge(...e){let r={};for(let n of e){let i=Object.getOwnPropertyDescriptors(n);Object.assign(r,i)}return Object.defineProperties({},r)}function kl(e){return ge(e._zod.def)}function zl(e,r){return r?r.reduce((n,i)=>n==null?void 0:n[i],e):e}function Il(e){let r=Object.keys(e),n=r.map(i=>e[i]);return Promise.all(n).then(i=>{let t={};for(let o=0;o<r.length;o++)t[r[o]]=i[o];return t})}function wl(e=10){let r="abcdefghijklmnopqrstuvwxyz",n="";for(let i=0;i<e;i++)n+=r[Math.floor(Math.random()*r.length)];return n}function Ut(e){return JSON.stringify(e)}var Nt="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function ye(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}var Xr=je(()=>{var e;if(typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)!=null&&e.includes("Cloudflare")))return!1;try{let r=Function;return new r(""),!0}catch(r){return!1}});function ve(e){if(ye(e)===!1)return!1;let r=e.constructor;if(r===void 0)return!0;let n=r.prototype;return!(ye(n)===!1||Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")===!1)}function qr(e){return ve(e)?m({},e):Array.isArray(e)?[...e]:e}function Sl(e){let r=0;for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&r++;return r}var jl=e=>{let r=typeof e;switch(r){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(e)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":return Array.isArray(e)?"array":e===null?"null":e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?"promise":typeof Map<"u"&&e instanceof Map?"map":typeof Set<"u"&&e instanceof Set?"set":typeof Date<"u"&&e instanceof Date?"date":typeof File<"u"&&e instanceof File?"file":"object";default:throw new Error("Unknown data type: ".concat(r))}},Xe=new Set(["string","number","symbol"]),Yr=new Set(["string","number","bigint","boolean","symbol","undefined"]);function ie(e){return e.replace(/[.*+?^\${}()|[\\]\\\\]/g,"\\\\$&")}function K(e,r,n){let i=new e._zod.constr(r!=null?r:e._zod.def);return(!r||n!=null&&n.parent)&&(i._zod.parent=e),i}function y(e){let r=e;if(!r)return{};if(typeof r=="string")return{error:()=>r};if((r==null?void 0:r.message)!==void 0){if((r==null?void 0:r.error)!==void 0)throw new Error("Cannot specify both \`message\` and \`error\` params");r.error=r.message}return delete r.message,typeof r.error=="string"?z(m({},r),{error:()=>r.error}):r}function Ol(e){let r;return new Proxy({},{get(n,i,t){return r!=null||(r=e()),Reflect.get(r,i,t)},set(n,i,t,o){return r!=null||(r=e()),Reflect.set(r,i,t,o)},has(n,i){return r!=null||(r=e()),Reflect.has(r,i)},deleteProperty(n,i){return r!=null||(r=e()),Reflect.deleteProperty(r,i)},ownKeys(n){return r!=null||(r=e()),Reflect.ownKeys(r)},getOwnPropertyDescriptor(n,i){return r!=null||(r=e()),Reflect.getOwnPropertyDescriptor(r,i)},defineProperty(n,i,t){return r!=null||(r=e()),Reflect.defineProperty(r,i,t)}})}function b(e){return typeof e=="bigint"?e.toString()+"n":typeof e=="string"?'"'.concat(e,'"'):"".concat(e)}function Qr(e){return Object.keys(e).filter(r=>e[r]._zod.optin==="optional"&&e[r]._zod.optout==="optional")}var Hr={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},en={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function Pl(e,r){let n=e._zod.def,i=ge(e._zod.def,{get shape(){let t={};for(let o in r){if(!(o in n.shape))throw new Error('Unrecognized key: "'.concat(o,'"'));r[o]&&(t[o]=n.shape[o])}return pe(this,"shape",t),t},checks:[]});return K(e,i)}function Ul(e,r){let n=e._zod.def,i=ge(e._zod.def,{get shape(){let t=m({},e._zod.def.shape);for(let o in r){if(!(o in n.shape))throw new Error('Unrecognized key: "'.concat(o,'"'));r[o]&&delete t[o]}return pe(this,"shape",t),t},checks:[]});return K(e,i)}function Nl(e,r){if(!ve(r))throw new Error("Invalid input to extend: expected a plain object");let n=e._zod.def.checks;if(n&&n.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use \`.safeExtend()\` instead.");let t=ge(e._zod.def,{get shape(){let o=m(m({},e._zod.def.shape),r);return pe(this,"shape",o),o},checks:[]});return K(e,t)}function Zl(e,r){if(!ve(r))throw new Error("Invalid input to safeExtend: expected a plain object");let n=z(m({},e._zod.def),{get shape(){let i=m(m({},e._zod.def.shape),r);return pe(this,"shape",i),i},checks:e._zod.def.checks});return K(e,n)}function Dl(e,r){let n=ge(e._zod.def,{get shape(){let i=m(m({},e._zod.def.shape),r._zod.def.shape);return pe(this,"shape",i),i},get catchall(){return r._zod.def.catchall},checks:[]});return K(e,n)}function Tl(e,r,n){let i=ge(r._zod.def,{get shape(){let t=r._zod.def.shape,o=m({},t);if(n)for(let u in n){if(!(u in t))throw new Error('Unrecognized key: "'.concat(u,'"'));n[u]&&(o[u]=e?new e({type:"optional",innerType:t[u]}):t[u])}else for(let u in t)o[u]=e?new e({type:"optional",innerType:t[u]}):t[u];return pe(this,"shape",o),o},checks:[]});return K(r,i)}function El(e,r,n){let i=ge(r._zod.def,{get shape(){let t=r._zod.def.shape,o=m({},t);if(n)for(let u in n){if(!(u in o))throw new Error('Unrecognized key: "'.concat(u,'"'));n[u]&&(o[u]=new e({type:"nonoptional",innerType:t[u]}))}else for(let u in t)o[u]=new e({type:"nonoptional",innerType:t[u]});return pe(this,"shape",o),o},checks:[]});return K(r,i)}function he(e,r=0){var n;if(e.aborted===!0)return!0;for(let i=r;i<e.issues.length;i++)if(((n=e.issues[i])==null?void 0:n.continue)!==!0)return!0;return!1}function q(e,r){return r.map(n=>{var t;var i;return(t=(i=n).path)!=null||(i.path=[]),n.path.unshift(e),n})}function Ke(e){return typeof e=="string"?e:e==null?void 0:e.message}function Y(e,r,n){var t,o,u,l,c,a,s,v,f,h,x;let i=z(m({},e),{path:(t=e.path)!=null?t:[]});if(!e.message){let S=(x=(h=(v=(a=Ke((l=(u=(o=e.inst)==null?void 0:o._zod.def)==null?void 0:u.error)==null?void 0:l.call(u,e)))!=null?a:Ke((c=r==null?void 0:r.error)==null?void 0:c.call(r,e)))!=null?v:Ke((s=n.customError)==null?void 0:s.call(n,e)))!=null?h:Ke((f=n.localeError)==null?void 0:f.call(n,e)))!=null?x:"Invalid input";i.message=S}return delete i.inst,delete i.continue,r!=null&&r.reportInput||delete i.input,i}function qe(e){return e instanceof Set?"set":e instanceof Map?"map":e instanceof File?"file":"unknown"}function Ye(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function Oe(...e){let[r,n,i]=e;return typeof r=="string"?{message:r,code:"custom",input:n,inst:i}:m({},r)}function Al(e){return Object.entries(e).filter(([r,n])=>Number.isNaN(Number.parseInt(r,10))).map(r=>r[1])}function ru(e){let r=atob(e),n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}function nu(e){let r="";for(let n=0;n<e.length;n++)r+=String.fromCharCode(e[n]);return btoa(r)}function Rl(e){let r=e.replace(/-/g,"+").replace(/_/g,"/"),n="=".repeat((4-r.length%4)%4);return ru(r+n)}function Ll(e){return nu(e).replace(/\\+/g,"-").replace(/\\//g,"_").replace(/=/g,"")}function Cl(e){let r=e.replace(/^0x/,"");if(r.length%2!==0)throw new Error("Invalid hex string length");let n=new Uint8Array(r.length/2);for(let i=0;i<r.length;i+=2)n[i/2]=Number.parseInt(r.slice(i,i+2),16);return n}function Vl(e){return Array.from(e).map(r=>r.toString(16).padStart(2,"0")).join("")}var Gr=class{constructor(...r){}};var iu=(e,r)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:r,enumerable:!1}),e.message=JSON.stringify(r,Se,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},Qe=d("$ZodError",iu),G=d("$ZodError",iu,{Parent:Error});function He(e,r=n=>n.message){let n={},i=[];for(let t of e.issues)t.path.length>0?(n[t.path[0]]=n[t.path[0]]||[],n[t.path[0]].push(r(t))):i.push(r(t));return{formErrors:i,fieldErrors:n}}function et(e,r=n=>n.message){let n={_errors:[]},i=t=>{for(let o of t.issues)if(o.code==="invalid_union"&&o.errors.length)o.errors.map(u=>i({issues:u}));else if(o.code==="invalid_key")i({issues:o.issues});else if(o.code==="invalid_element")i({issues:o.issues});else if(o.path.length===0)n._errors.push(r(o));else{let u=n,l=0;for(;l<o.path.length;){let c=o.path[l];l===o.path.length-1?(u[c]=u[c]||{_errors:[]},u[c]._errors.push(r(o))):u[c]=u[c]||{_errors:[]},u=u[c],l++}}};return i(e),n}function tn(e,r=n=>n.message){let n={errors:[]},i=(t,o=[])=>{var c,a,s,v;var u,l;for(let f of t.issues)if(f.code==="invalid_union"&&f.errors.length)f.errors.map(h=>i({issues:h},f.path));else if(f.code==="invalid_key")i({issues:f.issues},f.path);else if(f.code==="invalid_element")i({issues:f.issues},f.path);else{let h=[...o,...f.path];if(h.length===0){n.errors.push(r(f));continue}let x=n,S=0;for(;S<h.length;){let I=h[S],C=S===h.length-1;typeof I=="string"?((c=x.properties)!=null||(x.properties={}),(a=(u=x.properties)[I])!=null||(u[I]={errors:[]}),x=x.properties[I]):((s=x.items)!=null||(x.items=[]),(v=(l=x.items)[I])!=null||(l[I]={errors:[]}),x=x.items[I]),C&&x.errors.push(r(f)),S++}}};return i(e),n}function ou(e){let r=[],n=e.map(i=>typeof i=="object"?i.key:i);for(let i of n)typeof i=="number"?r.push("[".concat(i,"]")):typeof i=="symbol"?r.push("[".concat(JSON.stringify(String(i)),"]")):/[^\\w$]/.test(i)?r.push("[".concat(JSON.stringify(i),"]")):(r.length&&r.push("."),r.push(i));return r.join("")}function rn(e){var i;let r=[],n=[...e.issues].sort((t,o)=>{var u,l;return((u=t.path)!=null?u:[]).length-((l=o.path)!=null?l:[]).length});for(let t of n)r.push("\\u2716 ".concat(t.message)),(i=t.path)!=null&&i.length&&r.push("  \\u2192 at ".concat(ou(t.path)));return r.join("\\n")}var Pe=e=>(r,n,i,t)=>{var l;let o=i?Object.assign(i,{async:!1}):{async:!1},u=r._zod.run({value:n,issues:[]},o);if(u instanceof Promise)throw new te;if(u.issues.length){let c=new((l=t==null?void 0:t.Err)!=null?l:e)(u.issues.map(a=>Y(a,o,L())));throw Nt(c,t==null?void 0:t.callee),c}return u.value},Zt=Pe(G),Ue=e=>async(r,n,i,t)=>{var l;let o=i?Object.assign(i,{async:!0}):{async:!0},u=r._zod.run({value:n,issues:[]},o);if(u instanceof Promise&&(u=await u),u.issues.length){let c=new((l=t==null?void 0:t.Err)!=null?l:e)(u.issues.map(a=>Y(a,o,L())));throw Nt(c,t==null?void 0:t.callee),c}return u.value},Dt=Ue(G),Ne=e=>(r,n,i)=>{let t=i?z(m({},i),{async:!1}):{async:!1},o=r._zod.run({value:n,issues:[]},t);if(o instanceof Promise)throw new te;return o.issues.length?{success:!1,error:new(e!=null?e:Qe)(o.issues.map(u=>Y(u,t,L())))}:{success:!0,data:o.value}},nn=Ne(G),Ze=e=>async(r,n,i)=>{let t=i?Object.assign(i,{async:!0}):{async:!0},o=r._zod.run({value:n,issues:[]},t);return o instanceof Promise&&(o=await o),o.issues.length?{success:!1,error:new e(o.issues.map(u=>Y(u,t,L())))}:{success:!0,data:o.value}},on=Ze(G),Tt=e=>(r,n,i)=>{let t=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Pe(e)(r,n,t)},Jl=Tt(G),Et=e=>(r,n,i)=>Pe(e)(r,n,i),Ml=Et(G),At=e=>async(r,n,i)=>{let t=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Ue(e)(r,n,t)},Bl=At(G),Rt=e=>async(r,n,i)=>Ue(e)(r,n,i),Kl=Rt(G),Lt=e=>(r,n,i)=>{let t=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Ne(e)(r,n,t)},Gl=Lt(G),Ct=e=>(r,n,i)=>Ne(e)(r,n,i),Wl=Ct(G),Vt=e=>async(r,n,i)=>{let t=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Ze(e)(r,n,t)},Xl=Vt(G),Ft=e=>async(r,n,i)=>Ze(e)(r,n,i),ql=Ft(G);var Q={};_e(Q,{base64:()=>_n,base64url:()=>Jt,bigint:()=>Sn,boolean:()=>Pn,browserEmail:()=>is,cidrv4:()=>$n,cidrv6:()=>bn,cuid:()=>an,cuid2:()=>un,date:()=>kn,datetime:()=>In,domain:()=>as,duration:()=>mn,e164:()=>xn,email:()=>pn,emoji:()=>gn,extendedDuration:()=>Yl,guid:()=>fn,hex:()=>us,hostname:()=>yn,html5Email:()=>ts,idnEmail:()=>ns,integer:()=>jn,ipv4:()=>vn,ipv6:()=>hn,ksuid:()=>sn,lowercase:()=>Zn,md5_base64:()=>ls,md5_base64url:()=>ss,md5_hex:()=>cs,nanoid:()=>dn,null:()=>Un,number:()=>On,rfc5322Email:()=>rs,sha1_base64:()=>ms,sha1_base64url:()=>fs,sha1_hex:()=>ds,sha256_base64:()=>gs,sha256_base64url:()=>vs,sha256_hex:()=>ps,sha384_base64:()=>$s,sha384_base64url:()=>bs,sha384_hex:()=>hs,sha512_base64:()=>ys,sha512_base64url:()=>xs,sha512_hex:()=>_s,string:()=>wn,time:()=>zn,ulid:()=>cn,undefined:()=>Nn,unicodeEmail:()=>au,uppercase:()=>Dn,uuid:()=>xe,uuid4:()=>Ql,uuid6:()=>Hl,uuid7:()=>es,xid:()=>ln});var an=/^[cC][^\\s-]{8,}$/,un=/^[0-9a-z]+$/,cn=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,ln=/^[0-9a-vA-V]{20}$/,sn=/^[A-Za-z0-9]{27}$/,dn=/^[a-zA-Z0-9_-]{21}$/,mn=/^P(?:(\\d+W)|(?!.*W)(?=\\d|T\\d)(\\d+Y)?(\\d+M)?(\\d+D)?(T(?=\\d)(\\d+H)?(\\d+M)?(\\d+([.,]\\d+)?S)?)?)$/,Yl=/^[-+]?P(?!$)(?:(?:[-+]?\\d+Y)|(?:[-+]?\\d+[.,]\\d+Y$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:(?:[-+]?\\d+W)|(?:[-+]?\\d+[.,]\\d+W$))?(?:(?:[-+]?\\d+D)|(?:[-+]?\\d+[.,]\\d+D$))?(?:T(?=[\\d+-])(?:(?:[-+]?\\d+H)|(?:[-+]?\\d+[.,]\\d+H$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:[-+]?\\d+(?:[.,]\\d+)?S)?)??$/,fn=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,xe=e=>e?new RegExp("^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-".concat(e,"[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$")):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,Ql=xe(4),Hl=xe(6),es=xe(7),pn=/^(?!\\.)(?!.*\\.\\.)([A-Za-z0-9_'+\\-\\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\\-]*\\.)+[A-Za-z]{2,}$/,ts=/^[a-zA-Z0-9.!#$%&'*+/=?^_\`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,rs=/^(([^<>()\\[\\]\\\\.,;:\\s@"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@"]+)*)|(".+"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/,au=new RegExp('^[^\\\\s@"]{1,64}@[^\\\\s@]{1,255}$',"u"),ns=au,is=/^[a-zA-Z0-9.!#$%&'*+/=?^_\`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,os="^(\\\\p{Extended_Pictographic}|\\\\p{Emoji_Component})+$";function gn(){return new RegExp(os,"u")}var vn=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,hn=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,$n=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\/([0-9]|[1-2][0-9]|3[0-2])$/,bn=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,_n=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Jt=/^[A-Za-z0-9_-]*$/,yn=/^(?=.{1,253}\\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\\.?$/,as=/^([a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\\.)+[a-zA-Z]{2,}$/,xn=/^\\+(?:[0-9]){6,14}[0-9]$/,uu="(?:(?:\\\\d\\\\d[2468][048]|\\\\d\\\\d[13579][26]|\\\\d\\\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\\\d|30)|(?:02)-(?:0[1-9]|1\\\\d|2[0-8])))",kn=new RegExp("^".concat(uu,"$"));function cu(e){let r="(?:[01]\\\\d|2[0-3]):[0-5]\\\\d";return typeof e.precision=="number"?e.precision===-1?"".concat(r):e.precision===0?"".concat(r,":[0-5]\\\\d"):"".concat(r,":[0-5]\\\\d\\\\.\\\\d{").concat(e.precision,"}"):"".concat(r,"(?::[0-5]\\\\d(?:\\\\.\\\\d+)?)?")}function zn(e){return new RegExp("^".concat(cu(e),"$"))}function In(e){let r=cu({precision:e.precision}),n=["Z"];e.local&&n.push(""),e.offset&&n.push("([+-](?:[01]\\\\d|2[0-3]):[0-5]\\\\d)");let i="".concat(r,"(?:").concat(n.join("|"),")");return new RegExp("^".concat(uu,"T(?:").concat(i,")$"))}var wn=e=>{var n,i;let r=e?"[\\\\s\\\\S]{".concat((n=e==null?void 0:e.minimum)!=null?n:0,",").concat((i=e==null?void 0:e.maximum)!=null?i:"","}"):"[\\\\s\\\\S]*";return new RegExp("^".concat(r,"$"))},Sn=/^-?\\d+n?$/,jn=/^-?\\d+$/,On=/^-?\\d+(?:\\.\\d+)?/,Pn=/^(?:true|false)$/i,Un=/^null$/i;var Nn=/^undefined$/i;var Zn=/^[^A-Z]*$/,Dn=/^[^a-z]*$/,us=/^[0-9a-fA-F]*$/;function tt(e,r){return new RegExp("^[A-Za-z0-9+/]{".concat(e,"}").concat(r,"$"))}function rt(e){return new RegExp("^[A-Za-z0-9_-]{".concat(e,"}$"))}var cs=/^[0-9a-fA-F]{32}$/,ls=tt(22,"=="),ss=rt(22),ds=/^[0-9a-fA-F]{40}$/,ms=tt(27,"="),fs=rt(27),ps=/^[0-9a-fA-F]{64}$/,gs=tt(43,"="),vs=rt(43),hs=/^[0-9a-fA-F]{96}$/,$s=tt(64,""),bs=rt(64),_s=/^[0-9a-fA-F]{128}$/,ys=tt(86,"=="),xs=rt(86);var R=d("$ZodCheck",(e,r)=>{var i,t;var n;(i=e._zod)!=null||(e._zod={}),e._zod.def=r,(t=(n=e._zod).onattach)!=null||(n.onattach=[])}),su={number:"number",bigint:"bigint",object:"date"},Mt=d("$ZodCheckLessThan",(e,r)=>{R.init(e,r);let n=su[typeof r.value];e._zod.onattach.push(i=>{var u;let t=i._zod.bag,o=(u=r.inclusive?t.maximum:t.exclusiveMaximum)!=null?u:Number.POSITIVE_INFINITY;r.value<o&&(r.inclusive?t.maximum=r.value:t.exclusiveMaximum=r.value)}),e._zod.check=i=>{(r.inclusive?i.value<=r.value:i.value<r.value)||i.issues.push({origin:n,code:"too_big",maximum:r.value,input:i.value,inclusive:r.inclusive,inst:e,continue:!r.abort})}}),Bt=d("$ZodCheckGreaterThan",(e,r)=>{R.init(e,r);let n=su[typeof r.value];e._zod.onattach.push(i=>{var u;let t=i._zod.bag,o=(u=r.inclusive?t.minimum:t.exclusiveMinimum)!=null?u:Number.NEGATIVE_INFINITY;r.value>o&&(r.inclusive?t.minimum=r.value:t.exclusiveMinimum=r.value)}),e._zod.check=i=>{(r.inclusive?i.value>=r.value:i.value>r.value)||i.issues.push({origin:n,code:"too_small",minimum:r.value,input:i.value,inclusive:r.inclusive,inst:e,continue:!r.abort})}}),Tn=d("$ZodCheckMultipleOf",(e,r)=>{R.init(e,r),e._zod.onattach.push(n=>{var t;var i;(t=(i=n._zod.bag).multipleOf)!=null||(i.multipleOf=r.value)}),e._zod.check=n=>{if(typeof n.value!=typeof r.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof n.value=="bigint"?n.value%r.value===BigInt(0):Wr(n.value,r.value)===0)||n.issues.push({origin:typeof n.value,code:"not_multiple_of",divisor:r.value,input:n.value,inst:e,continue:!r.abort})}}),En=d("$ZodCheckNumberFormat",(e,r)=>{var u;R.init(e,r),r.format=r.format||"float64";let n=(u=r.format)==null?void 0:u.includes("int"),i=n?"int":"number",[t,o]=Hr[r.format];e._zod.onattach.push(l=>{let c=l._zod.bag;c.format=r.format,c.minimum=t,c.maximum=o,n&&(c.pattern=jn)}),e._zod.check=l=>{let c=l.value;if(n){if(!Number.isInteger(c)){l.issues.push({expected:i,format:r.format,code:"invalid_type",continue:!1,input:c,inst:e});return}if(!Number.isSafeInteger(c)){c>0?l.issues.push({input:c,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:i,continue:!r.abort}):l.issues.push({input:c,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:i,continue:!r.abort});return}}c<t&&l.issues.push({origin:"number",input:c,code:"too_small",minimum:t,inclusive:!0,inst:e,continue:!r.abort}),c>o&&l.issues.push({origin:"number",input:c,code:"too_big",maximum:o,inst:e})}}),An=d("$ZodCheckBigIntFormat",(e,r)=>{R.init(e,r);let[n,i]=en[r.format];e._zod.onattach.push(t=>{let o=t._zod.bag;o.format=r.format,o.minimum=n,o.maximum=i}),e._zod.check=t=>{let o=t.value;o<n&&t.issues.push({origin:"bigint",input:o,code:"too_small",minimum:n,inclusive:!0,inst:e,continue:!r.abort}),o>i&&t.issues.push({origin:"bigint",input:o,code:"too_big",maximum:i,inst:e})}}),Rn=d("$ZodCheckMaxSize",(e,r)=>{var i;var n;R.init(e,r),(i=(n=e._zod.def).when)!=null||(n.when=t=>{let o=t.value;return!fe(o)&&o.size!==void 0}),e._zod.onattach.push(t=>{var u;let o=(u=t._zod.bag.maximum)!=null?u:Number.POSITIVE_INFINITY;r.maximum<o&&(t._zod.bag.maximum=r.maximum)}),e._zod.check=t=>{let o=t.value;o.size<=r.maximum||t.issues.push({origin:qe(o),code:"too_big",maximum:r.maximum,inclusive:!0,input:o,inst:e,continue:!r.abort})}}),Ln=d("$ZodCheckMinSize",(e,r)=>{var i;var n;R.init(e,r),(i=(n=e._zod.def).when)!=null||(n.when=t=>{let o=t.value;return!fe(o)&&o.size!==void 0}),e._zod.onattach.push(t=>{var u;let o=(u=t._zod.bag.minimum)!=null?u:Number.NEGATIVE_INFINITY;r.minimum>o&&(t._zod.bag.minimum=r.minimum)}),e._zod.check=t=>{let o=t.value;o.size>=r.minimum||t.issues.push({origin:qe(o),code:"too_small",minimum:r.minimum,inclusive:!0,input:o,inst:e,continue:!r.abort})}}),Cn=d("$ZodCheckSizeEquals",(e,r)=>{var i;var n;R.init(e,r),(i=(n=e._zod.def).when)!=null||(n.when=t=>{let o=t.value;return!fe(o)&&o.size!==void 0}),e._zod.onattach.push(t=>{let o=t._zod.bag;o.minimum=r.size,o.maximum=r.size,o.size=r.size}),e._zod.check=t=>{let o=t.value,u=o.size;if(u===r.size)return;let l=u>r.size;t.issues.push(z(m({origin:qe(o)},l?{code:"too_big",maximum:r.size}:{code:"too_small",minimum:r.size}),{inclusive:!0,exact:!0,input:t.value,inst:e,continue:!r.abort}))}}),Vn=d("$ZodCheckMaxLength",(e,r)=>{var i;var n;R.init(e,r),(i=(n=e._zod.def).when)!=null||(n.when=t=>{let o=t.value;return!fe(o)&&o.length!==void 0}),e._zod.onattach.push(t=>{var u;let o=(u=t._zod.bag.maximum)!=null?u:Number.POSITIVE_INFINITY;r.maximum<o&&(t._zod.bag.maximum=r.maximum)}),e._zod.check=t=>{let o=t.value;if(o.length<=r.maximum)return;let l=Ye(o);t.issues.push({origin:l,code:"too_big",maximum:r.maximum,inclusive:!0,input:o,inst:e,continue:!r.abort})}}),Fn=d("$ZodCheckMinLength",(e,r)=>{var i;var n;R.init(e,r),(i=(n=e._zod.def).when)!=null||(n.when=t=>{let o=t.value;return!fe(o)&&o.length!==void 0}),e._zod.onattach.push(t=>{var u;let o=(u=t._zod.bag.minimum)!=null?u:Number.NEGATIVE_INFINITY;r.minimum>o&&(t._zod.bag.minimum=r.minimum)}),e._zod.check=t=>{let o=t.value;if(o.length>=r.minimum)return;let l=Ye(o);t.issues.push({origin:l,code:"too_small",minimum:r.minimum,inclusive:!0,input:o,inst:e,continue:!r.abort})}}),Jn=d("$ZodCheckLengthEquals",(e,r)=>{var i;var n;R.init(e,r),(i=(n=e._zod.def).when)!=null||(n.when=t=>{let o=t.value;return!fe(o)&&o.length!==void 0}),e._zod.onattach.push(t=>{let o=t._zod.bag;o.minimum=r.length,o.maximum=r.length,o.length=r.length}),e._zod.check=t=>{let o=t.value,u=o.length;if(u===r.length)return;let l=Ye(o),c=u>r.length;t.issues.push(z(m({origin:l},c?{code:"too_big",maximum:r.length}:{code:"too_small",minimum:r.length}),{inclusive:!0,exact:!0,input:t.value,inst:e,continue:!r.abort}))}}),De=d("$ZodCheckStringFormat",(e,r)=>{var t,o;var n,i;R.init(e,r),e._zod.onattach.push(u=>{var c;let l=u._zod.bag;l.format=r.format,r.pattern&&((c=l.patterns)!=null||(l.patterns=new Set),l.patterns.add(r.pattern))}),r.pattern?(t=(n=e._zod).check)!=null||(n.check=u=>{r.pattern.lastIndex=0,!r.pattern.test(u.value)&&u.issues.push(z(m({origin:"string",code:"invalid_format",format:r.format,input:u.value},r.pattern?{pattern:r.pattern.toString()}:{}),{inst:e,continue:!r.abort}))}):(o=(i=e._zod).check)!=null||(i.check=()=>{})}),Mn=d("$ZodCheckRegex",(e,r)=>{De.init(e,r),e._zod.check=n=>{r.pattern.lastIndex=0,!r.pattern.test(n.value)&&n.issues.push({origin:"string",code:"invalid_format",format:"regex",input:n.value,pattern:r.pattern.toString(),inst:e,continue:!r.abort})}}),Bn=d("$ZodCheckLowerCase",(e,r)=>{var n;(n=r.pattern)!=null||(r.pattern=Zn),De.init(e,r)}),Kn=d("$ZodCheckUpperCase",(e,r)=>{var n;(n=r.pattern)!=null||(r.pattern=Dn),De.init(e,r)}),Gn=d("$ZodCheckIncludes",(e,r)=>{R.init(e,r);let n=ie(r.includes),i=new RegExp(typeof r.position=="number"?"^.{".concat(r.position,"}").concat(n):n);r.pattern=i,e._zod.onattach.push(t=>{var u;let o=t._zod.bag;(u=o.patterns)!=null||(o.patterns=new Set),o.patterns.add(i)}),e._zod.check=t=>{t.value.includes(r.includes,r.position)||t.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:r.includes,input:t.value,inst:e,continue:!r.abort})}}),Wn=d("$ZodCheckStartsWith",(e,r)=>{var i;R.init(e,r);let n=new RegExp("^".concat(ie(r.prefix),".*"));(i=r.pattern)!=null||(r.pattern=n),e._zod.onattach.push(t=>{var u;let o=t._zod.bag;(u=o.patterns)!=null||(o.patterns=new Set),o.patterns.add(n)}),e._zod.check=t=>{t.value.startsWith(r.prefix)||t.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:r.prefix,input:t.value,inst:e,continue:!r.abort})}}),Xn=d("$ZodCheckEndsWith",(e,r)=>{var i;R.init(e,r);let n=new RegExp(".*".concat(ie(r.suffix),"$"));(i=r.pattern)!=null||(r.pattern=n),e._zod.onattach.push(t=>{var u;let o=t._zod.bag;(u=o.patterns)!=null||(o.patterns=new Set),o.patterns.add(n)}),e._zod.check=t=>{t.value.endsWith(r.suffix)||t.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:r.suffix,input:t.value,inst:e,continue:!r.abort})}});function lu(e,r,n){e.issues.length&&r.issues.push(...q(n,e.issues))}var qn=d("$ZodCheckProperty",(e,r)=>{R.init(e,r),e._zod.check=n=>{let i=r.schema._zod.run({value:n.value[r.property],issues:[]},{});if(i instanceof Promise)return i.then(t=>lu(t,n,r.property));lu(i,n,r.property)}}),Yn=d("$ZodCheckMimeType",(e,r)=>{R.init(e,r);let n=new Set(r.mime);e._zod.onattach.push(i=>{i._zod.bag.mime=r.mime}),e._zod.check=i=>{n.has(i.value.type)||i.issues.push({code:"invalid_value",values:r.mime,input:i.value.type,inst:e,continue:!r.abort})}}),Qn=d("$ZodCheckOverwrite",(e,r)=>{R.init(e,r),e._zod.check=n=>{n.value=r.tx(n.value)}});var nt=class{constructor(r=[]){this.content=[],this.indent=0,this&&(this.args=r)}indented(r){this.indent+=1,r(this),this.indent-=1}write(r){if(typeof r=="function"){r(this,{execution:"sync"}),r(this,{execution:"async"});return}let i=r.split("\\n").filter(u=>u),t=Math.min(...i.map(u=>u.length-u.trimStart().length)),o=i.map(u=>u.slice(t)).map(u=>" ".repeat(this.indent*2)+u);for(let u of o)this.content.push(u)}compile(){var o;let r=Function,n=this==null?void 0:this.args,t=[...((o=this==null?void 0:this.content)!=null?o:[""]).map(u=>"  ".concat(u))];return new r(...n,t.join("\\n"))}};var Hn={major:4,minor:1,patch:12};var O=d("$ZodType",(e,r)=>{var t,o,u;var n;e!=null||(e={}),e._zod.def=r,e._zod.bag=e._zod.bag||{},e._zod.version=Hn;let i=[...(t=e._zod.def.checks)!=null?t:[]];e._zod.traits.has("$ZodCheck")&&i.unshift(e);for(let l of i)for(let c of l._zod.onattach)c(e);if(i.length===0)(o=(n=e._zod).deferred)!=null||(n.deferred=[]),(u=e._zod.deferred)==null||u.push(()=>{e._zod.run=e._zod.parse});else{let l=(a,s,v)=>{let f=he(a),h;for(let x of s){if(x._zod.def.when){if(!x._zod.def.when(a))continue}else if(f)continue;let S=a.issues.length,I=x._zod.check(a);if(I instanceof Promise&&(v==null?void 0:v.async)===!1)throw new te;if(h||I instanceof Promise)h=(h!=null?h:Promise.resolve()).then(async()=>{await I,a.issues.length!==S&&(f||(f=he(a,S)))});else{if(a.issues.length===S)continue;f||(f=he(a,S))}}return h?h.then(()=>a):a},c=(a,s,v)=>{if(he(a))return a.aborted=!0,a;let f=l(s,i,v);if(f instanceof Promise){if(v.async===!1)throw new te;return f.then(h=>e._zod.parse(h,v))}return e._zod.parse(f,v)};e._zod.run=(a,s)=>{if(s.skipChecks)return e._zod.parse(a,s);if(s.direction==="backward"){let f=e._zod.parse({value:a.value,issues:[]},z(m({},s),{skipChecks:!0}));return f instanceof Promise?f.then(h=>c(h,a,s)):c(f,a,s)}let v=e._zod.parse(a,s);if(v instanceof Promise){if(s.async===!1)throw new te;return v.then(f=>l(f,i,s))}return l(v,i,s)}}e["~standard"]={validate:l=>{var c;try{let a=nn(e,l);return a.success?{value:a.data}:{issues:(c=a.error)==null?void 0:c.issues}}catch(a){return on(e,l).then(s=>{var v;return s.success?{value:s.data}:{issues:(v=s.error)==null?void 0:v.issues}})}},vendor:"zod",version:1}}),ke=d("$ZodString",(e,r)=>{var n,i,t;O.init(e,r),e._zod.pattern=(t=[...(i=(n=e==null?void 0:e._zod.bag)==null?void 0:n.patterns)!=null?i:[]].pop())!=null?t:wn(e._zod.bag),e._zod.parse=(o,u)=>{if(r.coerce)try{o.value=String(o.value)}catch(l){}return typeof o.value=="string"||o.issues.push({expected:"string",code:"invalid_type",input:o.value,inst:e}),o}}),T=d("$ZodStringFormat",(e,r)=>{De.init(e,r),ke.init(e,r)}),ti=d("$ZodGUID",(e,r)=>{var n;(n=r.pattern)!=null||(r.pattern=fn),T.init(e,r)}),ri=d("$ZodUUID",(e,r)=>{var n,i;if(r.version){let o={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[r.version];if(o===void 0)throw new Error('Invalid UUID version: "'.concat(r.version,'"'));(n=r.pattern)!=null||(r.pattern=xe(o))}else(i=r.pattern)!=null||(r.pattern=xe());T.init(e,r)}),ni=d("$ZodEmail",(e,r)=>{var n;(n=r.pattern)!=null||(r.pattern=pn),T.init(e,r)}),ii=d("$ZodURL",(e,r)=>{T.init(e,r),e._zod.check=n=>{try{let i=n.value.trim(),t=new URL(i);r.hostname&&(r.hostname.lastIndex=0,r.hostname.test(t.hostname)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:yn.source,input:n.value,inst:e,continue:!r.abort})),r.protocol&&(r.protocol.lastIndex=0,r.protocol.test(t.protocol.endsWith(":")?t.protocol.slice(0,-1):t.protocol)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:r.protocol.source,input:n.value,inst:e,continue:!r.abort})),r.normalize?n.value=t.href:n.value=i;return}catch(i){n.issues.push({code:"invalid_format",format:"url",input:n.value,inst:e,continue:!r.abort})}}}),oi=d("$ZodEmoji",(e,r)=>{var n;(n=r.pattern)!=null||(r.pattern=gn()),T.init(e,r)}),ai=d("$ZodNanoID",(e,r)=>{var n;(n=r.pattern)!=null||(r.pattern=dn),T.init(e,r)}),ui=d("$ZodCUID",(e,r)=>{var n;(n=r.pattern)!=null||(r.pattern=an),T.init(e,r)}),ci=d("$ZodCUID2",(e,r)=>{var n;(n=r.pattern)!=null||(r.pattern=un),T.init(e,r)}),li=d("$ZodULID",(e,r)=>{var n;(n=r.pattern)!=null||(r.pattern=cn),T.init(e,r)}),si=d("$ZodXID",(e,r)=>{var n;(n=r.pattern)!=null||(r.pattern=ln),T.init(e,r)}),di=d("$ZodKSUID",(e,r)=>{var n;(n=r.pattern)!=null||(r.pattern=sn),T.init(e,r)}),mi=d("$ZodISODateTime",(e,r)=>{var n;(n=r.pattern)!=null||(r.pattern=In(r)),T.init(e,r)}),fi=d("$ZodISODate",(e,r)=>{var n;(n=r.pattern)!=null||(r.pattern=kn),T.init(e,r)}),pi=d("$ZodISOTime",(e,r)=>{var n;(n=r.pattern)!=null||(r.pattern=zn(r)),T.init(e,r)}),gi=d("$ZodISODuration",(e,r)=>{var n;(n=r.pattern)!=null||(r.pattern=mn),T.init(e,r)}),vi=d("$ZodIPv4",(e,r)=>{var n;(n=r.pattern)!=null||(r.pattern=vn),T.init(e,r),e._zod.onattach.push(i=>{let t=i._zod.bag;t.format="ipv4"})}),hi=d("$ZodIPv6",(e,r)=>{var n;(n=r.pattern)!=null||(r.pattern=hn),T.init(e,r),e._zod.onattach.push(i=>{let t=i._zod.bag;t.format="ipv6"}),e._zod.check=i=>{try{new URL("http://[".concat(i.value,"]"))}catch(t){i.issues.push({code:"invalid_format",format:"ipv6",input:i.value,inst:e,continue:!r.abort})}}}),$i=d("$ZodCIDRv4",(e,r)=>{var n;(n=r.pattern)!=null||(r.pattern=$n),T.init(e,r)}),bi=d("$ZodCIDRv6",(e,r)=>{var n;(n=r.pattern)!=null||(r.pattern=bn),T.init(e,r),e._zod.check=i=>{let t=i.value.split("/");try{if(t.length!==2)throw new Error;let[o,u]=t;if(!u)throw new Error;let l=Number(u);if("".concat(l)!==u)throw new Error;if(l<0||l>128)throw new Error;new URL("http://[".concat(o,"]"))}catch(o){i.issues.push({code:"invalid_format",format:"cidrv6",input:i.value,inst:e,continue:!r.abort})}}});function _i(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch(r){return!1}}var yi=d("$ZodBase64",(e,r)=>{var n;(n=r.pattern)!=null||(r.pattern=_n),T.init(e,r),e._zod.onattach.push(i=>{i._zod.bag.contentEncoding="base64"}),e._zod.check=i=>{_i(i.value)||i.issues.push({code:"invalid_format",format:"base64",input:i.value,inst:e,continue:!r.abort})}});function xu(e){if(!Jt.test(e))return!1;let r=e.replace(/[-_]/g,i=>i==="-"?"+":"/"),n=r.padEnd(Math.ceil(r.length/4)*4,"=");return _i(n)}var xi=d("$ZodBase64URL",(e,r)=>{var n;(n=r.pattern)!=null||(r.pattern=Jt),T.init(e,r),e._zod.onattach.push(i=>{i._zod.bag.contentEncoding="base64url"}),e._zod.check=i=>{xu(i.value)||i.issues.push({code:"invalid_format",format:"base64url",input:i.value,inst:e,continue:!r.abort})}}),ki=d("$ZodE164",(e,r)=>{var n;(n=r.pattern)!=null||(r.pattern=xn),T.init(e,r)});function ku(e,r=null){try{let n=e.split(".");if(n.length!==3)return!1;let[i]=n;if(!i)return!1;let t=JSON.parse(atob(i));return!("typ"in t&&(t==null?void 0:t.typ)!=="JWT"||!t.alg||r&&(!("alg"in t)||t.alg!==r))}catch(n){return!1}}var zi=d("$ZodJWT",(e,r)=>{T.init(e,r),e._zod.check=n=>{ku(n.value,r.alg)||n.issues.push({code:"invalid_format",format:"jwt",input:n.value,inst:e,continue:!r.abort})}}),Ii=d("$ZodCustomStringFormat",(e,r)=>{T.init(e,r),e._zod.check=n=>{r.fn(n.value)||n.issues.push({code:"invalid_format",format:r.format,input:n.value,inst:e,continue:!r.abort})}}),Yt=d("$ZodNumber",(e,r)=>{var n;O.init(e,r),e._zod.pattern=(n=e._zod.bag.pattern)!=null?n:On,e._zod.parse=(i,t)=>{if(r.coerce)try{i.value=Number(i.value)}catch(l){}let o=i.value;if(typeof o=="number"&&!Number.isNaN(o)&&Number.isFinite(o))return i;let u=typeof o=="number"?Number.isNaN(o)?"NaN":Number.isFinite(o)?void 0:"Infinity":void 0;return i.issues.push(m({expected:"number",code:"invalid_type",input:o,inst:e},u?{received:u}:{})),i}}),wi=d("$ZodNumber",(e,r)=>{En.init(e,r),Yt.init(e,r)}),it=d("$ZodBoolean",(e,r)=>{O.init(e,r),e._zod.pattern=Pn,e._zod.parse=(n,i)=>{if(r.coerce)try{n.value=!!n.value}catch(o){}let t=n.value;return typeof t=="boolean"||n.issues.push({expected:"boolean",code:"invalid_type",input:t,inst:e}),n}}),Qt=d("$ZodBigInt",(e,r)=>{O.init(e,r),e._zod.pattern=Sn,e._zod.parse=(n,i)=>{if(r.coerce)try{n.value=BigInt(n.value)}catch(t){}return typeof n.value=="bigint"||n.issues.push({expected:"bigint",code:"invalid_type",input:n.value,inst:e}),n}}),Si=d("$ZodBigInt",(e,r)=>{An.init(e,r),Qt.init(e,r)}),ji=d("$ZodSymbol",(e,r)=>{O.init(e,r),e._zod.parse=(n,i)=>{let t=n.value;return typeof t=="symbol"||n.issues.push({expected:"symbol",code:"invalid_type",input:t,inst:e}),n}}),Oi=d("$ZodUndefined",(e,r)=>{O.init(e,r),e._zod.pattern=Nn,e._zod.values=new Set([void 0]),e._zod.optin="optional",e._zod.optout="optional",e._zod.parse=(n,i)=>{let t=n.value;return typeof t>"u"||n.issues.push({expected:"undefined",code:"invalid_type",input:t,inst:e}),n}}),Pi=d("$ZodNull",(e,r)=>{O.init(e,r),e._zod.pattern=Un,e._zod.values=new Set([null]),e._zod.parse=(n,i)=>{let t=n.value;return t===null||n.issues.push({expected:"null",code:"invalid_type",input:t,inst:e}),n}}),Ui=d("$ZodAny",(e,r)=>{O.init(e,r),e._zod.parse=n=>n}),Ni=d("$ZodUnknown",(e,r)=>{O.init(e,r),e._zod.parse=n=>n}),Zi=d("$ZodNever",(e,r)=>{O.init(e,r),e._zod.parse=(n,i)=>(n.issues.push({expected:"never",code:"invalid_type",input:n.value,inst:e}),n)}),Di=d("$ZodVoid",(e,r)=>{O.init(e,r),e._zod.parse=(n,i)=>{let t=n.value;return typeof t>"u"||n.issues.push({expected:"void",code:"invalid_type",input:t,inst:e}),n}}),Ti=d("$ZodDate",(e,r)=>{O.init(e,r),e._zod.parse=(n,i)=>{if(r.coerce)try{n.value=new Date(n.value)}catch(l){}let t=n.value,o=t instanceof Date;return o&&!Number.isNaN(t.getTime())||n.issues.push(z(m({expected:"date",code:"invalid_type",input:t},o?{received:"Invalid Date"}:{}),{inst:e})),n}});function mu(e,r,n){e.issues.length&&r.issues.push(...q(n,e.issues)),r.value[n]=e.value}var Ei=d("$ZodArray",(e,r)=>{O.init(e,r),e._zod.parse=(n,i)=>{let t=n.value;if(!Array.isArray(t))return n.issues.push({expected:"array",code:"invalid_type",input:t,inst:e}),n;n.value=Array(t.length);let o=[];for(let u=0;u<t.length;u++){let l=t[u],c=r.element._zod.run({value:l,issues:[]},i);c instanceof Promise?o.push(c.then(a=>mu(a,n,u))):mu(c,n,u)}return o.length?Promise.all(o).then(()=>n):n}});function qt(e,r,n,i){e.issues.length&&r.issues.push(...q(n,e.issues)),e.value===void 0?n in i&&(r.value[n]=void 0):r.value[n]=e.value}function zu(e){var i,t,o,u;let r=Object.keys(e.shape);for(let l of r)if(!((u=(o=(t=(i=e.shape)==null?void 0:i[l])==null?void 0:t._zod)==null?void 0:o.traits)!=null&&u.has("$ZodType")))throw new Error('Invalid element at key "'.concat(l,'": expected a Zod schema'));let n=Qr(e.shape);return z(m({},e),{keys:r,keySet:new Set(r),numKeys:r.length,optionalKeys:new Set(n)})}function Iu(e,r,n,i,t,o){let u=[],l=t.keySet,c=t.catchall._zod,a=c.def.type;for(let s of Object.keys(r)){if(l.has(s))continue;if(a==="never"){u.push(s);continue}let v=c.run({value:r[s],issues:[]},i);v instanceof Promise?e.push(v.then(f=>qt(f,n,s,r))):qt(v,n,s,r)}return u.length&&n.issues.push({code:"unrecognized_keys",keys:u,input:r,inst:o}),e.length?Promise.all(e).then(()=>n):n}var wu=d("$ZodObject",(e,r)=>{O.init(e,r);let n=Object.getOwnPropertyDescriptor(r,"shape");if(!(n!=null&&n.get)){let l=r.shape;Object.defineProperty(r,"shape",{get:()=>{let c=m({},l);return Object.defineProperty(r,"shape",{value:c}),c}})}let i=je(()=>zu(r));Z(e._zod,"propValues",()=>{var a;let l=r.shape,c={};for(let s in l){let v=l[s]._zod;if(v.values){(a=c[s])!=null||(c[s]=new Set);for(let f of v.values)c[s].add(f)}}return c});let t=ye,o=r.catchall,u;e._zod.parse=(l,c)=>{u!=null||(u=i.value);let a=l.value;if(!t(a))return l.issues.push({expected:"object",code:"invalid_type",input:a,inst:e}),l;l.value={};let s=[],v=u.shape;for(let f of u.keys){let x=v[f]._zod.run({value:a[f],issues:[]},c);x instanceof Promise?s.push(x.then(S=>qt(S,l,f,a))):qt(x,l,f,a)}return o?Iu(s,a,l,c,i.value,e):s.length?Promise.all(s).then(()=>l):l}}),Ai=d("$ZodObjectJIT",(e,r)=>{wu.init(e,r);let n=e._zod.parse,i=je(()=>zu(r)),t=f=>{let h=new nt(["shape","payload","ctx"]),x=i.value,S=g=>{let $=Ut(g);return"shape[".concat($,"]._zod.run({ value: input[").concat($,"], issues: [] }, ctx)")};h.write("const input = payload.value;");let I=Object.create(null),C=0;for(let g of x.keys)I[g]="key_".concat(C++);h.write("const newResult = {};");for(let g of x.keys){let $=I[g],k=Ut(g);h.write("const ".concat($," = ").concat(S(g),";")),h.write("\\n        if (".concat($,".issues.length) {\\n          payload.issues = payload.issues.concat(").concat($,".issues.map(iss => ({\\n            ...iss,\\n            path: iss.path ? [").concat(k,", ...iss.path] : [").concat(k,"]\\n          })));\\n        }\\n        \\n        \\n        if (").concat($,".value === undefined) {\\n          if (").concat(k," in input) {\\n            newResult[").concat(k,"] = undefined;\\n          }\\n        } else {\\n          newResult[").concat(k,"] = ").concat($,".value;\\n        }\\n        \\n      "))}h.write("payload.value = newResult;"),h.write("return payload;");let j=h.compile();return(g,$)=>j(f,g,$)},o,u=ye,l=!Be.jitless,a=l&&Xr.value,s=r.catchall,v;e._zod.parse=(f,h)=>{v!=null||(v=i.value);let x=f.value;return u(x)?l&&a&&(h==null?void 0:h.async)===!1&&h.jitless!==!0?(o||(o=t(r.shape)),f=o(f,h),s?Iu([],x,f,h,v,e):f):n(f,h):(f.issues.push({expected:"object",code:"invalid_type",input:x,inst:e}),f)}});function fu(e,r,n,i){for(let o of e)if(o.issues.length===0)return r.value=o.value,r;let t=e.filter(o=>!he(o));return t.length===1?(r.value=t[0].value,t[0]):(r.issues.push({code:"invalid_union",input:r.value,inst:n,errors:e.map(o=>o.issues.map(u=>Y(u,i,L())))}),r)}var Ht=d("$ZodUnion",(e,r)=>{O.init(e,r),Z(e._zod,"optin",()=>r.options.some(t=>t._zod.optin==="optional")?"optional":void 0),Z(e._zod,"optout",()=>r.options.some(t=>t._zod.optout==="optional")?"optional":void 0),Z(e._zod,"values",()=>{if(r.options.every(t=>t._zod.values))return new Set(r.options.flatMap(t=>Array.from(t._zod.values)))}),Z(e._zod,"pattern",()=>{if(r.options.every(t=>t._zod.pattern)){let t=r.options.map(o=>o._zod.pattern);return new RegExp("^(".concat(t.map(o=>We(o.source)).join("|"),")$"))}});let n=r.options.length===1,i=r.options[0]._zod.run;e._zod.parse=(t,o)=>{if(n)return i(t,o);let u=!1,l=[];for(let c of r.options){let a=c._zod.run({value:t.value,issues:[]},o);if(a instanceof Promise)l.push(a),u=!0;else{if(a.issues.length===0)return a;l.push(a)}}return u?Promise.all(l).then(c=>fu(c,t,e,o)):fu(l,t,e,o)}}),Ri=d("$ZodDiscriminatedUnion",(e,r)=>{Ht.init(e,r);let n=e._zod.parse;Z(e._zod,"propValues",()=>{let t={};for(let o of r.options){let u=o._zod.propValues;if(!u||Object.keys(u).length===0)throw new Error('Invalid discriminated union option at index "'.concat(r.options.indexOf(o),'"'));for(let[l,c]of Object.entries(u)){t[l]||(t[l]=new Set);for(let a of c)t[l].add(a)}}return t});let i=je(()=>{var u;let t=r.options,o=new Map;for(let l of t){let c=(u=l._zod.propValues)==null?void 0:u[r.discriminator];if(!c||c.size===0)throw new Error('Invalid discriminated union option at index "'.concat(r.options.indexOf(l),'"'));for(let a of c){if(o.has(a))throw new Error('Duplicate discriminator value "'.concat(String(a),'"'));o.set(a,l)}}return o});e._zod.parse=(t,o)=>{let u=t.value;if(!ye(u))return t.issues.push({code:"invalid_type",expected:"object",input:u,inst:e}),t;let l=i.value.get(u==null?void 0:u[r.discriminator]);return l?l._zod.run(t,o):r.unionFallback?n(t,o):(t.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",discriminator:r.discriminator,input:u,path:[r.discriminator],inst:e}),t)}}),Li=d("$ZodIntersection",(e,r)=>{O.init(e,r),e._zod.parse=(n,i)=>{let t=n.value,o=r.left._zod.run({value:t,issues:[]},i),u=r.right._zod.run({value:t,issues:[]},i);return o instanceof Promise||u instanceof Promise?Promise.all([o,u]).then(([c,a])=>pu(n,c,a)):pu(n,o,u)}});function ei(e,r){if(e===r)return{valid:!0,data:e};if(e instanceof Date&&r instanceof Date&&+e==+r)return{valid:!0,data:e};if(ve(e)&&ve(r)){let n=Object.keys(r),i=Object.keys(e).filter(o=>n.indexOf(o)!==-1),t=m(m({},e),r);for(let o of i){let u=ei(e[o],r[o]);if(!u.valid)return{valid:!1,mergeErrorPath:[o,...u.mergeErrorPath]};t[o]=u.data}return{valid:!0,data:t}}if(Array.isArray(e)&&Array.isArray(r)){if(e.length!==r.length)return{valid:!1,mergeErrorPath:[]};let n=[];for(let i=0;i<e.length;i++){let t=e[i],o=r[i],u=ei(t,o);if(!u.valid)return{valid:!1,mergeErrorPath:[i,...u.mergeErrorPath]};n.push(u.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function pu(e,r,n){if(r.issues.length&&e.issues.push(...r.issues),n.issues.length&&e.issues.push(...n.issues),he(e))return e;let i=ei(r.value,n.value);if(!i.valid)throw new Error("Unmergable intersection. Error path: "+"".concat(JSON.stringify(i.mergeErrorPath)));return e.value=i.data,e}var er=d("$ZodTuple",(e,r)=>{O.init(e,r);let n=r.items,i=n.length-[...n].reverse().findIndex(t=>t._zod.optin!=="optional");e._zod.parse=(t,o)=>{let u=t.value;if(!Array.isArray(u))return t.issues.push({input:u,inst:e,expected:"tuple",code:"invalid_type"}),t;t.value=[];let l=[];if(!r.rest){let a=u.length>n.length,s=u.length<i-1;if(a||s)return t.issues.push(z(m({},a?{code:"too_big",maximum:n.length}:{code:"too_small",minimum:n.length}),{input:u,inst:e,origin:"array"})),t}let c=-1;for(let a of n){if(c++,c>=u.length&&c>=i)continue;let s=a._zod.run({value:u[c],issues:[]},o);s instanceof Promise?l.push(s.then(v=>Kt(v,t,c))):Kt(s,t,c)}if(r.rest){let a=u.slice(n.length);for(let s of a){c++;let v=r.rest._zod.run({value:s,issues:[]},o);v instanceof Promise?l.push(v.then(f=>Kt(f,t,c))):Kt(v,t,c)}}return l.length?Promise.all(l).then(()=>t):t}});function Kt(e,r,n){e.issues.length&&r.issues.push(...q(n,e.issues)),r.value[n]=e.value}var Ci=d("$ZodRecord",(e,r)=>{O.init(e,r),e._zod.parse=(n,i)=>{let t=n.value;if(!ve(t))return n.issues.push({expected:"record",code:"invalid_type",input:t,inst:e}),n;let o=[];if(r.keyType._zod.values){let u=r.keyType._zod.values;n.value={};for(let c of u)if(typeof c=="string"||typeof c=="number"||typeof c=="symbol"){let a=r.valueType._zod.run({value:t[c],issues:[]},i);a instanceof Promise?o.push(a.then(s=>{s.issues.length&&n.issues.push(...q(c,s.issues)),n.value[c]=s.value})):(a.issues.length&&n.issues.push(...q(c,a.issues)),n.value[c]=a.value)}let l;for(let c in t)u.has(c)||(l=l!=null?l:[],l.push(c));l&&l.length>0&&n.issues.push({code:"unrecognized_keys",input:t,inst:e,keys:l})}else{n.value={};for(let u of Reflect.ownKeys(t)){if(u==="__proto__")continue;let l=r.keyType._zod.run({value:u,issues:[]},i);if(l instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(l.issues.length){n.issues.push({code:"invalid_key",origin:"record",issues:l.issues.map(a=>Y(a,i,L())),input:u,path:[u],inst:e}),n.value[l.value]=l.value;continue}let c=r.valueType._zod.run({value:t[u],issues:[]},i);c instanceof Promise?o.push(c.then(a=>{a.issues.length&&n.issues.push(...q(u,a.issues)),n.value[l.value]=a.value})):(c.issues.length&&n.issues.push(...q(u,c.issues)),n.value[l.value]=c.value)}}return o.length?Promise.all(o).then(()=>n):n}}),Vi=d("$ZodMap",(e,r)=>{O.init(e,r),e._zod.parse=(n,i)=>{let t=n.value;if(!(t instanceof Map))return n.issues.push({expected:"map",code:"invalid_type",input:t,inst:e}),n;let o=[];n.value=new Map;for(let[u,l]of t){let c=r.keyType._zod.run({value:u,issues:[]},i),a=r.valueType._zod.run({value:l,issues:[]},i);c instanceof Promise||a instanceof Promise?o.push(Promise.all([c,a]).then(([s,v])=>{gu(s,v,n,u,t,e,i)})):gu(c,a,n,u,t,e,i)}return o.length?Promise.all(o).then(()=>n):n}});function gu(e,r,n,i,t,o,u){e.issues.length&&(Xe.has(typeof i)?n.issues.push(...q(i,e.issues)):n.issues.push({code:"invalid_key",origin:"map",input:t,inst:o,issues:e.issues.map(l=>Y(l,u,L()))})),r.issues.length&&(Xe.has(typeof i)?n.issues.push(...q(i,r.issues)):n.issues.push({origin:"map",code:"invalid_element",input:t,inst:o,key:i,issues:r.issues.map(l=>Y(l,u,L()))})),n.value.set(e.value,r.value)}var Fi=d("$ZodSet",(e,r)=>{O.init(e,r),e._zod.parse=(n,i)=>{let t=n.value;if(!(t instanceof Set))return n.issues.push({input:t,inst:e,expected:"set",code:"invalid_type"}),n;let o=[];n.value=new Set;for(let u of t){let l=r.valueType._zod.run({value:u,issues:[]},i);l instanceof Promise?o.push(l.then(c=>vu(c,n))):vu(l,n)}return o.length?Promise.all(o).then(()=>n):n}});function vu(e,r){e.issues.length&&r.issues.push(...e.issues),r.value.add(e.value)}var Ji=d("$ZodEnum",(e,r)=>{O.init(e,r);let n=Ge(r.entries),i=new Set(n);e._zod.values=i,e._zod.pattern=new RegExp("^(".concat(n.filter(t=>Xe.has(typeof t)).map(t=>typeof t=="string"?ie(t):t.toString()).join("|"),")$")),e._zod.parse=(t,o)=>{let u=t.value;return i.has(u)||t.issues.push({code:"invalid_value",values:n,input:u,inst:e}),t}}),Mi=d("$ZodLiteral",(e,r)=>{if(O.init(e,r),r.values.length===0)throw new Error("Cannot create literal schema with no valid values");e._zod.values=new Set(r.values),e._zod.pattern=new RegExp("^(".concat(r.values.map(n=>typeof n=="string"?ie(n):n?ie(n.toString()):String(n)).join("|"),")$")),e._zod.parse=(n,i)=>{let t=n.value;return e._zod.values.has(t)||n.issues.push({code:"invalid_value",values:r.values,input:t,inst:e}),n}}),Bi=d("$ZodFile",(e,r)=>{O.init(e,r),e._zod.parse=(n,i)=>{let t=n.value;return t instanceof File||n.issues.push({expected:"file",code:"invalid_type",input:t,inst:e}),n}}),Ki=d("$ZodTransform",(e,r)=>{O.init(e,r),e._zod.parse=(n,i)=>{if(i.direction==="backward")throw new me(e.constructor.name);let t=r.transform(n.value,n);if(i.async)return(t instanceof Promise?t:Promise.resolve(t)).then(u=>(n.value=u,n));if(t instanceof Promise)throw new te;return n.value=t,n}});function hu(e,r){return e.issues.length&&r===void 0?{issues:[],value:void 0}:e}var Gi=d("$ZodOptional",(e,r)=>{O.init(e,r),e._zod.optin="optional",e._zod.optout="optional",Z(e._zod,"values",()=>r.innerType._zod.values?new Set([...r.innerType._zod.values,void 0]):void 0),Z(e._zod,"pattern",()=>{let n=r.innerType._zod.pattern;return n?new RegExp("^(".concat(We(n.source),")?$")):void 0}),e._zod.parse=(n,i)=>{if(r.innerType._zod.optin==="optional"){let t=r.innerType._zod.run(n,i);return t instanceof Promise?t.then(o=>hu(o,n.value)):hu(t,n.value)}return n.value===void 0?n:r.innerType._zod.run(n,i)}}),Wi=d("$ZodNullable",(e,r)=>{O.init(e,r),Z(e._zod,"optin",()=>r.innerType._zod.optin),Z(e._zod,"optout",()=>r.innerType._zod.optout),Z(e._zod,"pattern",()=>{let n=r.innerType._zod.pattern;return n?new RegExp("^(".concat(We(n.source),"|null)$")):void 0}),Z(e._zod,"values",()=>r.innerType._zod.values?new Set([...r.innerType._zod.values,null]):void 0),e._zod.parse=(n,i)=>n.value===null?n:r.innerType._zod.run(n,i)}),Xi=d("$ZodDefault",(e,r)=>{O.init(e,r),e._zod.optin="optional",Z(e._zod,"values",()=>r.innerType._zod.values),e._zod.parse=(n,i)=>{if(i.direction==="backward")return r.innerType._zod.run(n,i);if(n.value===void 0)return n.value=r.defaultValue,n;let t=r.innerType._zod.run(n,i);return t instanceof Promise?t.then(o=>$u(o,r)):$u(t,r)}});function $u(e,r){return e.value===void 0&&(e.value=r.defaultValue),e}var qi=d("$ZodPrefault",(e,r)=>{O.init(e,r),e._zod.optin="optional",Z(e._zod,"values",()=>r.innerType._zod.values),e._zod.parse=(n,i)=>(i.direction==="backward"||n.value===void 0&&(n.value=r.defaultValue),r.innerType._zod.run(n,i))}),Yi=d("$ZodNonOptional",(e,r)=>{O.init(e,r),Z(e._zod,"values",()=>{let n=r.innerType._zod.values;return n?new Set([...n].filter(i=>i!==void 0)):void 0}),e._zod.parse=(n,i)=>{let t=r.innerType._zod.run(n,i);return t instanceof Promise?t.then(o=>bu(o,e)):bu(t,e)}});function bu(e,r){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:r}),e}var Qi=d("$ZodSuccess",(e,r)=>{O.init(e,r),e._zod.parse=(n,i)=>{if(i.direction==="backward")throw new me("ZodSuccess");let t=r.innerType._zod.run(n,i);return t instanceof Promise?t.then(o=>(n.value=o.issues.length===0,n)):(n.value=t.issues.length===0,n)}}),Hi=d("$ZodCatch",(e,r)=>{O.init(e,r),Z(e._zod,"optin",()=>r.innerType._zod.optin),Z(e._zod,"optout",()=>r.innerType._zod.optout),Z(e._zod,"values",()=>r.innerType._zod.values),e._zod.parse=(n,i)=>{if(i.direction==="backward")return r.innerType._zod.run(n,i);let t=r.innerType._zod.run(n,i);return t instanceof Promise?t.then(o=>(n.value=o.value,o.issues.length&&(n.value=r.catchValue(z(m({},n),{error:{issues:o.issues.map(u=>Y(u,i,L()))},input:n.value})),n.issues=[]),n)):(n.value=t.value,t.issues.length&&(n.value=r.catchValue(z(m({},n),{error:{issues:t.issues.map(o=>Y(o,i,L()))},input:n.value})),n.issues=[]),n)}}),eo=d("$ZodNaN",(e,r)=>{O.init(e,r),e._zod.parse=(n,i)=>((typeof n.value!="number"||!Number.isNaN(n.value))&&n.issues.push({input:n.value,inst:e,expected:"nan",code:"invalid_type"}),n)}),to=d("$ZodPipe",(e,r)=>{O.init(e,r),Z(e._zod,"values",()=>r.in._zod.values),Z(e._zod,"optin",()=>r.in._zod.optin),Z(e._zod,"optout",()=>r.out._zod.optout),Z(e._zod,"propValues",()=>r.in._zod.propValues),e._zod.parse=(n,i)=>{if(i.direction==="backward"){let o=r.out._zod.run(n,i);return o instanceof Promise?o.then(u=>Gt(u,r.in,i)):Gt(o,r.in,i)}let t=r.in._zod.run(n,i);return t instanceof Promise?t.then(o=>Gt(o,r.out,i)):Gt(t,r.out,i)}});function Gt(e,r,n){return e.issues.length?(e.aborted=!0,e):r._zod.run({value:e.value,issues:e.issues},n)}var ot=d("$ZodCodec",(e,r)=>{O.init(e,r),Z(e._zod,"values",()=>r.in._zod.values),Z(e._zod,"optin",()=>r.in._zod.optin),Z(e._zod,"optout",()=>r.out._zod.optout),Z(e._zod,"propValues",()=>r.in._zod.propValues),e._zod.parse=(n,i)=>{if((i.direction||"forward")==="forward"){let o=r.in._zod.run(n,i);return o instanceof Promise?o.then(u=>Wt(u,r,i)):Wt(o,r,i)}else{let o=r.out._zod.run(n,i);return o instanceof Promise?o.then(u=>Wt(u,r,i)):Wt(o,r,i)}}});function Wt(e,r,n){if(e.issues.length)return e.aborted=!0,e;if((n.direction||"forward")==="forward"){let t=r.transform(e.value,e);return t instanceof Promise?t.then(o=>Xt(e,o,r.out,n)):Xt(e,t,r.out,n)}else{let t=r.reverseTransform(e.value,e);return t instanceof Promise?t.then(o=>Xt(e,o,r.in,n)):Xt(e,t,r.in,n)}}function Xt(e,r,n,i){return e.issues.length?(e.aborted=!0,e):n._zod.run({value:r,issues:e.issues},i)}var ro=d("$ZodReadonly",(e,r)=>{O.init(e,r),Z(e._zod,"propValues",()=>r.innerType._zod.propValues),Z(e._zod,"values",()=>r.innerType._zod.values),Z(e._zod,"optin",()=>r.innerType._zod.optin),Z(e._zod,"optout",()=>r.innerType._zod.optout),e._zod.parse=(n,i)=>{if(i.direction==="backward")return r.innerType._zod.run(n,i);let t=r.innerType._zod.run(n,i);return t instanceof Promise?t.then(_u):_u(t)}});function _u(e){return e.value=Object.freeze(e.value),e}var no=d("$ZodTemplateLiteral",(e,r)=>{O.init(e,r);let n=[];for(let i of r.parts)if(typeof i=="object"&&i!==null){if(!i._zod.pattern)throw new Error("Invalid template literal part, no pattern found: ".concat([...i._zod.traits].shift()));let t=i._zod.pattern instanceof RegExp?i._zod.pattern.source:i._zod.pattern;if(!t)throw new Error("Invalid template literal part: ".concat(i._zod.traits));let o=t.startsWith("^")?1:0,u=t.endsWith("$")?t.length-1:t.length;n.push(t.slice(o,u))}else if(i===null||Yr.has(typeof i))n.push(ie("".concat(i)));else throw new Error("Invalid template literal part: ".concat(i));e._zod.pattern=new RegExp("^".concat(n.join(""),"$")),e._zod.parse=(i,t)=>{var o;return typeof i.value!="string"?(i.issues.push({input:i.value,inst:e,expected:"template_literal",code:"invalid_type"}),i):(e._zod.pattern.lastIndex=0,e._zod.pattern.test(i.value)||i.issues.push({input:i.value,inst:e,code:"invalid_format",format:(o=r.format)!=null?o:"template_literal",pattern:e._zod.pattern.source}),i)}}),io=d("$ZodFunction",(e,r)=>(O.init(e,r),e._def=r,e._zod.def=r,e.implement=n=>{if(typeof n!="function")throw new Error("implement() must be called with a function");return function(...i){let t=e._def.input?Zt(e._def.input,i):i,o=Reflect.apply(n,this,t);return e._def.output?Zt(e._def.output,o):o}},e.implementAsync=n=>{if(typeof n!="function")throw new Error("implementAsync() must be called with a function");return async function(...i){let t=e._def.input?await Dt(e._def.input,i):i,o=await Reflect.apply(n,this,t);return e._def.output?await Dt(e._def.output,o):o}},e._zod.parse=(n,i)=>typeof n.value!="function"?(n.issues.push({code:"invalid_type",expected:"function",input:n.value,inst:e}),n):(e._def.output&&e._def.output._zod.def.type==="promise"?n.value=e.implementAsync(n.value):n.value=e.implement(n.value),n),e.input=(...n)=>{let i=e.constructor;return Array.isArray(n[0])?new i({type:"function",input:new er({type:"tuple",items:n[0],rest:n[1]}),output:e._def.output}):new i({type:"function",input:n[0],output:e._def.output})},e.output=n=>{let i=e.constructor;return new i({type:"function",input:e._def.input,output:n})},e)),oo=d("$ZodPromise",(e,r)=>{O.init(e,r),e._zod.parse=(n,i)=>Promise.resolve(n.value).then(t=>r.innerType._zod.run({value:t,issues:[]},i))}),ao=d("$ZodLazy",(e,r)=>{O.init(e,r),Z(e._zod,"innerType",()=>r.getter()),Z(e._zod,"pattern",()=>e._zod.innerType._zod.pattern),Z(e._zod,"propValues",()=>e._zod.innerType._zod.propValues),Z(e._zod,"optin",()=>{var n;return(n=e._zod.innerType._zod.optin)!=null?n:void 0}),Z(e._zod,"optout",()=>{var n;return(n=e._zod.innerType._zod.optout)!=null?n:void 0}),e._zod.parse=(n,i)=>e._zod.innerType._zod.run(n,i)}),uo=d("$ZodCustom",(e,r)=>{R.init(e,r),O.init(e,r),e._zod.parse=(n,i)=>n,e._zod.check=n=>{let i=n.value,t=r.fn(i);if(t instanceof Promise)return t.then(o=>yu(o,n,i,e));yu(t,n,i,e)}});function yu(e,r,n,i){var t;if(!e){let o={code:"custom",input:n,inst:i,path:[...(t=i._zod.def.path)!=null?t:[]],continue:!i._zod.def.abort};i._zod.def.params&&(o.params=i._zod.def.params),r.issues.push(Oe(o))}}var ze={};_e(ze,{ar:()=>Su,az:()=>ju,be:()=>Pu,bg:()=>Uu,ca:()=>Nu,cs:()=>Zu,da:()=>Du,de:()=>Tu,en:()=>tr,eo:()=>Eu,es:()=>Au,fa:()=>Ru,fi:()=>Lu,fr:()=>Cu,frCA:()=>Vu,he:()=>Fu,hu:()=>Ju,id:()=>Mu,is:()=>Bu,it:()=>Ku,ja:()=>Gu,ka:()=>Wu,kh:()=>Xu,km:()=>rr,ko:()=>qu,lt:()=>Qu,mk:()=>Hu,ms:()=>ec,nl:()=>tc,no:()=>rc,ota:()=>nc,pl:()=>oc,ps:()=>ic,pt:()=>ac,ru:()=>cc,sl:()=>lc,sv:()=>sc,ta:()=>dc,th:()=>mc,tr:()=>fc,ua:()=>pc,uk:()=>nr,ur:()=>gc,vi:()=>vc,yo:()=>bc,zhCN:()=>hc,zhTW:()=>$c});var zs=()=>{let e={string:{unit:"\\u062D\\u0631\\u0641",verb:"\\u0623\\u0646 \\u064A\\u062D\\u0648\\u064A"},file:{unit:"\\u0628\\u0627\\u064A\\u062A",verb:"\\u0623\\u0646 \\u064A\\u062D\\u0648\\u064A"},array:{unit:"\\u0639\\u0646\\u0635\\u0631",verb:"\\u0623\\u0646 \\u064A\\u062D\\u0648\\u064A"},set:{unit:"\\u0639\\u0646\\u0635\\u0631",verb:"\\u0623\\u0646 \\u064A\\u062D\\u0648\\u064A"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"number";case"object":{if(Array.isArray(t))return"array";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"\\u0645\\u062F\\u062E\\u0644",email:"\\u0628\\u0631\\u064A\\u062F \\u0625\\u0644\\u0643\\u062A\\u0631\\u0648\\u0646\\u064A",url:"\\u0631\\u0627\\u0628\\u0637",emoji:"\\u0625\\u064A\\u0645\\u0648\\u062C\\u064A",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"\\u062A\\u0627\\u0631\\u064A\\u062E \\u0648\\u0648\\u0642\\u062A \\u0628\\u0645\\u0639\\u064A\\u0627\\u0631 ISO",date:"\\u062A\\u0627\\u0631\\u064A\\u062E \\u0628\\u0645\\u0639\\u064A\\u0627\\u0631 ISO",time:"\\u0648\\u0642\\u062A \\u0628\\u0645\\u0639\\u064A\\u0627\\u0631 ISO",duration:"\\u0645\\u062F\\u0629 \\u0628\\u0645\\u0639\\u064A\\u0627\\u0631 ISO",ipv4:"\\u0639\\u0646\\u0648\\u0627\\u0646 IPv4",ipv6:"\\u0639\\u0646\\u0648\\u0627\\u0646 IPv6",cidrv4:"\\u0645\\u062F\\u0649 \\u0639\\u0646\\u0627\\u0648\\u064A\\u0646 \\u0628\\u0635\\u064A\\u063A\\u0629 IPv4",cidrv6:"\\u0645\\u062F\\u0649 \\u0639\\u0646\\u0627\\u0648\\u064A\\u0646 \\u0628\\u0635\\u064A\\u063A\\u0629 IPv6",base64:"\\u0646\\u064E\\u0635 \\u0628\\u062A\\u0631\\u0645\\u064A\\u0632 base64-encoded",base64url:"\\u0646\\u064E\\u0635 \\u0628\\u062A\\u0631\\u0645\\u064A\\u0632 base64url-encoded",json_string:"\\u0646\\u064E\\u0635 \\u0639\\u0644\\u0649 \\u0647\\u064A\\u0626\\u0629 JSON",e164:"\\u0631\\u0642\\u0645 \\u0647\\u0627\\u062A\\u0641 \\u0628\\u0645\\u0639\\u064A\\u0627\\u0631 E.164",jwt:"JWT",template_literal:"\\u0645\\u062F\\u062E\\u0644"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"\\u0645\\u062F\\u062E\\u0644\\u0627\\u062A \\u063A\\u064A\\u0631 \\u0645\\u0642\\u0628\\u0648\\u0644\\u0629: \\u064A\\u0641\\u062A\\u0631\\u0636 \\u0625\\u062F\\u062E\\u0627\\u0644 ".concat(t.expected,"\\u060C \\u0648\\u0644\\u0643\\u0646 \\u062A\\u0645 \\u0625\\u062F\\u062E\\u0627\\u0644 ").concat(n(t.input));case"invalid_value":return t.values.length===1?"\\u0645\\u062F\\u062E\\u0644\\u0627\\u062A \\u063A\\u064A\\u0631 \\u0645\\u0642\\u0628\\u0648\\u0644\\u0629: \\u064A\\u0641\\u062A\\u0631\\u0636 \\u0625\\u062F\\u062E\\u0627\\u0644 ".concat(b(t.values[0])):"\\u0627\\u062E\\u062A\\u064A\\u0627\\u0631 \\u063A\\u064A\\u0631 \\u0645\\u0642\\u0628\\u0648\\u0644: \\u064A\\u062A\\u0648\\u0642\\u0639 \\u0627\\u0646\\u062A\\u0642\\u0627\\u0621 \\u0623\\u062D\\u062F \\u0647\\u0630\\u0647 \\u0627\\u0644\\u062E\\u064A\\u0627\\u0631\\u0627\\u062A: ".concat(p(t.values,"|"));case"too_big":{let a=t.inclusive?"<=":"<",s=r(t.origin);return s?" \\u0623\\u0643\\u0628\\u0631 \\u0645\\u0646 \\u0627\\u0644\\u0644\\u0627\\u0632\\u0645: \\u064A\\u0641\\u062A\\u0631\\u0636 \\u0623\\u0646 \\u062A\\u0643\\u0648\\u0646 ".concat((o=t.origin)!=null?o:"\\u0627\\u0644\\u0642\\u064A\\u0645\\u0629"," ").concat(a," ").concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"\\u0639\\u0646\\u0635\\u0631"):"\\u0623\\u0643\\u0628\\u0631 \\u0645\\u0646 \\u0627\\u0644\\u0644\\u0627\\u0632\\u0645: \\u064A\\u0641\\u062A\\u0631\\u0636 \\u0623\\u0646 \\u062A\\u0643\\u0648\\u0646 ".concat((l=t.origin)!=null?l:"\\u0627\\u0644\\u0642\\u064A\\u0645\\u0629"," ").concat(a," ").concat(t.maximum.toString())}case"too_small":{let a=t.inclusive?">=":">",s=r(t.origin);return s?"\\u0623\\u0635\\u063A\\u0631 \\u0645\\u0646 \\u0627\\u0644\\u0644\\u0627\\u0632\\u0645: \\u064A\\u0641\\u062A\\u0631\\u0636 \\u0644\\u0640 ".concat(t.origin," \\u0623\\u0646 \\u064A\\u0643\\u0648\\u0646 ").concat(a," ").concat(t.minimum.toString()," ").concat(s.unit):"\\u0623\\u0635\\u063A\\u0631 \\u0645\\u0646 \\u0627\\u0644\\u0644\\u0627\\u0632\\u0645: \\u064A\\u0641\\u062A\\u0631\\u0636 \\u0644\\u0640 ".concat(t.origin," \\u0623\\u0646 \\u064A\\u0643\\u0648\\u0646 ").concat(a," ").concat(t.minimum.toString())}case"invalid_format":{let a=t;return a.format==="starts_with"?'\\u0646\\u064E\\u0635 \\u063A\\u064A\\u0631 \\u0645\\u0642\\u0628\\u0648\\u0644: \\u064A\\u062C\\u0628 \\u0623\\u0646 \\u064A\\u0628\\u062F\\u0623 \\u0628\\u0640 "'.concat(t.prefix,'"'):a.format==="ends_with"?'\\u0646\\u064E\\u0635 \\u063A\\u064A\\u0631 \\u0645\\u0642\\u0628\\u0648\\u0644: \\u064A\\u062C\\u0628 \\u0623\\u0646 \\u064A\\u0646\\u062A\\u0647\\u064A \\u0628\\u0640 "'.concat(a.suffix,'"'):a.format==="includes"?'\\u0646\\u064E\\u0635 \\u063A\\u064A\\u0631 \\u0645\\u0642\\u0628\\u0648\\u0644: \\u064A\\u062C\\u0628 \\u0623\\u0646 \\u064A\\u062A\\u0636\\u0645\\u0651\\u064E\\u0646 "'.concat(a.includes,'"'):a.format==="regex"?"\\u0646\\u064E\\u0635 \\u063A\\u064A\\u0631 \\u0645\\u0642\\u0628\\u0648\\u0644: \\u064A\\u062C\\u0628 \\u0623\\u0646 \\u064A\\u0637\\u0627\\u0628\\u0642 \\u0627\\u0644\\u0646\\u0645\\u0637 ".concat(a.pattern):"".concat((c=i[a.format])!=null?c:t.format," \\u063A\\u064A\\u0631 \\u0645\\u0642\\u0628\\u0648\\u0644")}case"not_multiple_of":return"\\u0631\\u0642\\u0645 \\u063A\\u064A\\u0631 \\u0645\\u0642\\u0628\\u0648\\u0644: \\u064A\\u062C\\u0628 \\u0623\\u0646 \\u064A\\u0643\\u0648\\u0646 \\u0645\\u0646 \\u0645\\u0636\\u0627\\u0639\\u0641\\u0627\\u062A ".concat(t.divisor);case"unrecognized_keys":return"\\u0645\\u0639\\u0631\\u0641".concat(t.keys.length>1?"\\u0627\\u062A":""," \\u063A\\u0631\\u064A\\u0628").concat(t.keys.length>1?"\\u0629":"",": ").concat(p(t.keys,"\\u060C "));case"invalid_key":return"\\u0645\\u0639\\u0631\\u0641 \\u063A\\u064A\\u0631 \\u0645\\u0642\\u0628\\u0648\\u0644 \\u0641\\u064A ".concat(t.origin);case"invalid_union":return"\\u0645\\u062F\\u062E\\u0644 \\u063A\\u064A\\u0631 \\u0645\\u0642\\u0628\\u0648\\u0644";case"invalid_element":return"\\u0645\\u062F\\u062E\\u0644 \\u063A\\u064A\\u0631 \\u0645\\u0642\\u0628\\u0648\\u0644 \\u0641\\u064A ".concat(t.origin);default:return"\\u0645\\u062F\\u062E\\u0644 \\u063A\\u064A\\u0631 \\u0645\\u0642\\u0628\\u0648\\u0644"}}};function Su(){return{localeError:zs()}}var Is=()=>{let e={string:{unit:"simvol",verb:"olmal\\u0131d\\u0131r"},file:{unit:"bayt",verb:"olmal\\u0131d\\u0131r"},array:{unit:"element",verb:"olmal\\u0131d\\u0131r"},set:{unit:"element",verb:"olmal\\u0131d\\u0131r"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"number";case"object":{if(Array.isArray(t))return"array";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"Yanl\\u0131\\u015F d\\u0259y\\u0259r: g\\xF6zl\\u0259nil\\u0259n ".concat(t.expected,", daxil olan ").concat(n(t.input));case"invalid_value":return t.values.length===1?"Yanl\\u0131\\u015F d\\u0259y\\u0259r: g\\xF6zl\\u0259nil\\u0259n ".concat(b(t.values[0])):"Yanl\\u0131\\u015F se\\xE7im: a\\u015Fa\\u011F\\u0131dak\\u0131lardan biri olmal\\u0131d\\u0131r: ".concat(p(t.values,"|"));case"too_big":{let a=t.inclusive?"<=":"<",s=r(t.origin);return s?"\\xC7ox b\\xF6y\\xFCk: g\\xF6zl\\u0259nil\\u0259n ".concat((o=t.origin)!=null?o:"d\\u0259y\\u0259r"," ").concat(a).concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"element"):"\\xC7ox b\\xF6y\\xFCk: g\\xF6zl\\u0259nil\\u0259n ".concat((l=t.origin)!=null?l:"d\\u0259y\\u0259r"," ").concat(a).concat(t.maximum.toString())}case"too_small":{let a=t.inclusive?">=":">",s=r(t.origin);return s?"\\xC7ox ki\\xE7ik: g\\xF6zl\\u0259nil\\u0259n ".concat(t.origin," ").concat(a).concat(t.minimum.toString()," ").concat(s.unit):"\\xC7ox ki\\xE7ik: g\\xF6zl\\u0259nil\\u0259n ".concat(t.origin," ").concat(a).concat(t.minimum.toString())}case"invalid_format":{let a=t;return a.format==="starts_with"?'Yanl\\u0131\\u015F m\\u0259tn: "'.concat(a.prefix,'" il\\u0259 ba\\u015Flamal\\u0131d\\u0131r'):a.format==="ends_with"?'Yanl\\u0131\\u015F m\\u0259tn: "'.concat(a.suffix,'" il\\u0259 bitm\\u0259lidir'):a.format==="includes"?'Yanl\\u0131\\u015F m\\u0259tn: "'.concat(a.includes,'" daxil olmal\\u0131d\\u0131r'):a.format==="regex"?"Yanl\\u0131\\u015F m\\u0259tn: ".concat(a.pattern," \\u015Fablonuna uy\\u011Fun olmal\\u0131d\\u0131r"):"Yanl\\u0131\\u015F ".concat((c=i[a.format])!=null?c:t.format)}case"not_multiple_of":return"Yanl\\u0131\\u015F \\u0259d\\u0259d: ".concat(t.divisor," il\\u0259 b\\xF6l\\xFCn\\u0259 bil\\u0259n olmal\\u0131d\\u0131r");case"unrecognized_keys":return"Tan\\u0131nmayan a\\xE7ar".concat(t.keys.length>1?"lar":"",": ").concat(p(t.keys,", "));case"invalid_key":return"".concat(t.origin," daxilind\\u0259 yanl\\u0131\\u015F a\\xE7ar");case"invalid_union":return"Yanl\\u0131\\u015F d\\u0259y\\u0259r";case"invalid_element":return"".concat(t.origin," daxilind\\u0259 yanl\\u0131\\u015F d\\u0259y\\u0259r");default:return"Yanl\\u0131\\u015F d\\u0259y\\u0259r"}}};function ju(){return{localeError:Is()}}function Ou(e,r,n,i){let t=Math.abs(e),o=t%10,u=t%100;return u>=11&&u<=19?i:o===1?r:o>=2&&o<=4?n:i}var ws=()=>{let e={string:{unit:{one:"\\u0441\\u0456\\u043C\\u0432\\u0430\\u043B",few:"\\u0441\\u0456\\u043C\\u0432\\u0430\\u043B\\u044B",many:"\\u0441\\u0456\\u043C\\u0432\\u0430\\u043B\\u0430\\u045E"},verb:"\\u043C\\u0435\\u0446\\u044C"},array:{unit:{one:"\\u044D\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442",few:"\\u044D\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442\\u044B",many:"\\u044D\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442\\u0430\\u045E"},verb:"\\u043C\\u0435\\u0446\\u044C"},set:{unit:{one:"\\u044D\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442",few:"\\u044D\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442\\u044B",many:"\\u044D\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442\\u0430\\u045E"},verb:"\\u043C\\u0435\\u0446\\u044C"},file:{unit:{one:"\\u0431\\u0430\\u0439\\u0442",few:"\\u0431\\u0430\\u0439\\u0442\\u044B",many:"\\u0431\\u0430\\u0439\\u0442\\u0430\\u045E"},verb:"\\u043C\\u0435\\u0446\\u044C"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"\\u043B\\u0456\\u043A";case"object":{if(Array.isArray(t))return"\\u043C\\u0430\\u0441\\u0456\\u045E";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"\\u0443\\u0432\\u043E\\u0434",email:"email \\u0430\\u0434\\u0440\\u0430\\u0441",url:"URL",emoji:"\\u044D\\u043C\\u043E\\u0434\\u0437\\u0456",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO \\u0434\\u0430\\u0442\\u0430 \\u0456 \\u0447\\u0430\\u0441",date:"ISO \\u0434\\u0430\\u0442\\u0430",time:"ISO \\u0447\\u0430\\u0441",duration:"ISO \\u043F\\u0440\\u0430\\u0446\\u044F\\u0433\\u043B\\u0430\\u0441\\u0446\\u044C",ipv4:"IPv4 \\u0430\\u0434\\u0440\\u0430\\u0441",ipv6:"IPv6 \\u0430\\u0434\\u0440\\u0430\\u0441",cidrv4:"IPv4 \\u0434\\u044B\\u044F\\u043F\\u0430\\u0437\\u043E\\u043D",cidrv6:"IPv6 \\u0434\\u044B\\u044F\\u043F\\u0430\\u0437\\u043E\\u043D",base64:"\\u0440\\u0430\\u0434\\u043E\\u043A \\u0443 \\u0444\\u0430\\u0440\\u043C\\u0430\\u0446\\u0435 base64",base64url:"\\u0440\\u0430\\u0434\\u043E\\u043A \\u0443 \\u0444\\u0430\\u0440\\u043C\\u0430\\u0446\\u0435 base64url",json_string:"JSON \\u0440\\u0430\\u0434\\u043E\\u043A",e164:"\\u043D\\u0443\\u043C\\u0430\\u0440 E.164",jwt:"JWT",template_literal:"\\u0443\\u0432\\u043E\\u0434"};return t=>{var o,u,l;switch(t.code){case"invalid_type":return"\\u041D\\u044F\\u043F\\u0440\\u0430\\u0432\\u0456\\u043B\\u044C\\u043D\\u044B \\u045E\\u0432\\u043E\\u0434: \\u0447\\u0430\\u043A\\u0430\\u045E\\u0441\\u044F ".concat(t.expected,", \\u0430\\u0442\\u0440\\u044B\\u043C\\u0430\\u043D\\u0430 ").concat(n(t.input));case"invalid_value":return t.values.length===1?"\\u041D\\u044F\\u043F\\u0440\\u0430\\u0432\\u0456\\u043B\\u044C\\u043D\\u044B \\u045E\\u0432\\u043E\\u0434: \\u0447\\u0430\\u043A\\u0430\\u043B\\u0430\\u0441\\u044F ".concat(b(t.values[0])):"\\u041D\\u044F\\u043F\\u0440\\u0430\\u0432\\u0456\\u043B\\u044C\\u043D\\u044B \\u0432\\u0430\\u0440\\u044B\\u044F\\u043D\\u0442: \\u0447\\u0430\\u043A\\u0430\\u045E\\u0441\\u044F \\u0430\\u0434\\u0437\\u0456\\u043D \\u0437 ".concat(p(t.values,"|"));case"too_big":{let c=t.inclusive?"<=":"<",a=r(t.origin);if(a){let s=Number(t.maximum),v=Ou(s,a.unit.one,a.unit.few,a.unit.many);return"\\u0417\\u0430\\u043D\\u0430\\u0434\\u0442\\u0430 \\u0432\\u044F\\u043B\\u0456\\u043A\\u0456: \\u0447\\u0430\\u043A\\u0430\\u043B\\u0430\\u0441\\u044F, \\u0448\\u0442\\u043E ".concat((o=t.origin)!=null?o:"\\u0437\\u043D\\u0430\\u0447\\u044D\\u043D\\u043D\\u0435"," \\u043F\\u0430\\u0432\\u0456\\u043D\\u043D\\u0430 ").concat(a.verb," ").concat(c).concat(t.maximum.toString()," ").concat(v)}return"\\u0417\\u0430\\u043D\\u0430\\u0434\\u0442\\u0430 \\u0432\\u044F\\u043B\\u0456\\u043A\\u0456: \\u0447\\u0430\\u043A\\u0430\\u043B\\u0430\\u0441\\u044F, \\u0448\\u0442\\u043E ".concat((u=t.origin)!=null?u:"\\u0437\\u043D\\u0430\\u0447\\u044D\\u043D\\u043D\\u0435"," \\u043F\\u0430\\u0432\\u0456\\u043D\\u043D\\u0430 \\u0431\\u044B\\u0446\\u044C ").concat(c).concat(t.maximum.toString())}case"too_small":{let c=t.inclusive?">=":">",a=r(t.origin);if(a){let s=Number(t.minimum),v=Ou(s,a.unit.one,a.unit.few,a.unit.many);return"\\u0417\\u0430\\u043D\\u0430\\u0434\\u0442\\u0430 \\u043C\\u0430\\u043B\\u044B: \\u0447\\u0430\\u043A\\u0430\\u043B\\u0430\\u0441\\u044F, \\u0448\\u0442\\u043E ".concat(t.origin," \\u043F\\u0430\\u0432\\u0456\\u043D\\u043D\\u0430 ").concat(a.verb," ").concat(c).concat(t.minimum.toString()," ").concat(v)}return"\\u0417\\u0430\\u043D\\u0430\\u0434\\u0442\\u0430 \\u043C\\u0430\\u043B\\u044B: \\u0447\\u0430\\u043A\\u0430\\u043B\\u0430\\u0441\\u044F, \\u0448\\u0442\\u043E ".concat(t.origin," \\u043F\\u0430\\u0432\\u0456\\u043D\\u043D\\u0430 \\u0431\\u044B\\u0446\\u044C ").concat(c).concat(t.minimum.toString())}case"invalid_format":{let c=t;return c.format==="starts_with"?'\\u041D\\u044F\\u043F\\u0440\\u0430\\u0432\\u0456\\u043B\\u044C\\u043D\\u044B \\u0440\\u0430\\u0434\\u043E\\u043A: \\u043F\\u0430\\u0432\\u0456\\u043D\\u0435\\u043D \\u043F\\u0430\\u0447\\u044B\\u043D\\u0430\\u0446\\u0446\\u0430 \\u0437 "'.concat(c.prefix,'"'):c.format==="ends_with"?'\\u041D\\u044F\\u043F\\u0440\\u0430\\u0432\\u0456\\u043B\\u044C\\u043D\\u044B \\u0440\\u0430\\u0434\\u043E\\u043A: \\u043F\\u0430\\u0432\\u0456\\u043D\\u0435\\u043D \\u0437\\u0430\\u043A\\u0430\\u043D\\u0447\\u0432\\u0430\\u0446\\u0446\\u0430 \\u043D\\u0430 "'.concat(c.suffix,'"'):c.format==="includes"?'\\u041D\\u044F\\u043F\\u0440\\u0430\\u0432\\u0456\\u043B\\u044C\\u043D\\u044B \\u0440\\u0430\\u0434\\u043E\\u043A: \\u043F\\u0430\\u0432\\u0456\\u043D\\u0435\\u043D \\u0437\\u043C\\u044F\\u0448\\u0447\\u0430\\u0446\\u044C "'.concat(c.includes,'"'):c.format==="regex"?"\\u041D\\u044F\\u043F\\u0440\\u0430\\u0432\\u0456\\u043B\\u044C\\u043D\\u044B \\u0440\\u0430\\u0434\\u043E\\u043A: \\u043F\\u0430\\u0432\\u0456\\u043D\\u0435\\u043D \\u0430\\u0434\\u043F\\u0430\\u0432\\u044F\\u0434\\u0430\\u0446\\u044C \\u0448\\u0430\\u0431\\u043B\\u043E\\u043D\\u0443 ".concat(c.pattern):"\\u041D\\u044F\\u043F\\u0440\\u0430\\u0432\\u0456\\u043B\\u044C\\u043D\\u044B ".concat((l=i[c.format])!=null?l:t.format)}case"not_multiple_of":return"\\u041D\\u044F\\u043F\\u0440\\u0430\\u0432\\u0456\\u043B\\u044C\\u043D\\u044B \\u043B\\u0456\\u043A: \\u043F\\u0430\\u0432\\u0456\\u043D\\u0435\\u043D \\u0431\\u044B\\u0446\\u044C \\u043A\\u0440\\u0430\\u0442\\u043D\\u044B\\u043C ".concat(t.divisor);case"unrecognized_keys":return"\\u041D\\u0435\\u0440\\u0430\\u0441\\u043F\\u0430\\u0437\\u043D\\u0430\\u043D\\u044B ".concat(t.keys.length>1?"\\u043A\\u043B\\u044E\\u0447\\u044B":"\\u043A\\u043B\\u044E\\u0447",": ").concat(p(t.keys,", "));case"invalid_key":return"\\u041D\\u044F\\u043F\\u0440\\u0430\\u0432\\u0456\\u043B\\u044C\\u043D\\u044B \\u043A\\u043B\\u044E\\u0447 \\u0443 ".concat(t.origin);case"invalid_union":return"\\u041D\\u044F\\u043F\\u0440\\u0430\\u0432\\u0456\\u043B\\u044C\\u043D\\u044B \\u045E\\u0432\\u043E\\u0434";case"invalid_element":return"\\u041D\\u044F\\u043F\\u0440\\u0430\\u0432\\u0456\\u043B\\u044C\\u043D\\u0430\\u0435 \\u0437\\u043D\\u0430\\u0447\\u044D\\u043D\\u043D\\u0435 \\u045E ".concat(t.origin);default:return"\\u041D\\u044F\\u043F\\u0440\\u0430\\u0432\\u0456\\u043B\\u044C\\u043D\\u044B \\u045E\\u0432\\u043E\\u0434"}}};function Pu(){return{localeError:ws()}}var Ss=e=>{let r=typeof e;switch(r){case"number":return Number.isNaN(e)?"NaN":"\\u0447\\u0438\\u0441\\u043B\\u043E";case"object":{if(Array.isArray(e))return"\\u043C\\u0430\\u0441\\u0438\\u0432";if(e===null)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}}return r},js=()=>{let e={string:{unit:"\\u0441\\u0438\\u043C\\u0432\\u043E\\u043B\\u0430",verb:"\\u0434\\u0430 \\u0441\\u044A\\u0434\\u044A\\u0440\\u0436\\u0430"},file:{unit:"\\u0431\\u0430\\u0439\\u0442\\u0430",verb:"\\u0434\\u0430 \\u0441\\u044A\\u0434\\u044A\\u0440\\u0436\\u0430"},array:{unit:"\\u0435\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442\\u0430",verb:"\\u0434\\u0430 \\u0441\\u044A\\u0434\\u044A\\u0440\\u0436\\u0430"},set:{unit:"\\u0435\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442\\u0430",verb:"\\u0434\\u0430 \\u0441\\u044A\\u0434\\u044A\\u0440\\u0436\\u0430"}};function r(i){var t;return(t=e[i])!=null?t:null}let n={regex:"\\u0432\\u0445\\u043E\\u0434",email:"\\u0438\\u043C\\u0435\\u0439\\u043B \\u0430\\u0434\\u0440\\u0435\\u0441",url:"URL",emoji:"\\u0435\\u043C\\u043E\\u0434\\u0436\\u0438",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO \\u0432\\u0440\\u0435\\u043C\\u0435",date:"ISO \\u0434\\u0430\\u0442\\u0430",time:"ISO \\u0432\\u0440\\u0435\\u043C\\u0435",duration:"ISO \\u043F\\u0440\\u043E\\u0434\\u044A\\u043B\\u0436\\u0438\\u0442\\u0435\\u043B\\u043D\\u043E\\u0441\\u0442",ipv4:"IPv4 \\u0430\\u0434\\u0440\\u0435\\u0441",ipv6:"IPv6 \\u0430\\u0434\\u0440\\u0435\\u0441",cidrv4:"IPv4 \\u0434\\u0438\\u0430\\u043F\\u0430\\u0437\\u043E\\u043D",cidrv6:"IPv6 \\u0434\\u0438\\u0430\\u043F\\u0430\\u0437\\u043E\\u043D",base64:"base64-\\u043A\\u043E\\u0434\\u0438\\u0440\\u0430\\u043D \\u043D\\u0438\\u0437",base64url:"base64url-\\u043A\\u043E\\u0434\\u0438\\u0440\\u0430\\u043D \\u043D\\u0438\\u0437",json_string:"JSON \\u043D\\u0438\\u0437",e164:"E.164 \\u043D\\u043E\\u043C\\u0435\\u0440",jwt:"JWT",template_literal:"\\u0432\\u0445\\u043E\\u0434"};return i=>{var t,o,u,l;switch(i.code){case"invalid_type":return"\\u041D\\u0435\\u0432\\u0430\\u043B\\u0438\\u0434\\u0435\\u043D \\u0432\\u0445\\u043E\\u0434: \\u043E\\u0447\\u0430\\u043A\\u0432\\u0430\\u043D ".concat(i.expected,", \\u043F\\u043E\\u043B\\u0443\\u0447\\u0435\\u043D ").concat(Ss(i.input));case"invalid_value":return i.values.length===1?"\\u041D\\u0435\\u0432\\u0430\\u043B\\u0438\\u0434\\u0435\\u043D \\u0432\\u0445\\u043E\\u0434: \\u043E\\u0447\\u0430\\u043A\\u0432\\u0430\\u043D ".concat(b(i.values[0])):"\\u041D\\u0435\\u0432\\u0430\\u043B\\u0438\\u0434\\u043D\\u0430 \\u043E\\u043F\\u0446\\u0438\\u044F: \\u043E\\u0447\\u0430\\u043A\\u0432\\u0430\\u043D\\u043E \\u0435\\u0434\\u043D\\u043E \\u043E\\u0442 ".concat(p(i.values,"|"));case"too_big":{let c=i.inclusive?"<=":"<",a=r(i.origin);return a?"\\u0422\\u0432\\u044A\\u0440\\u0434\\u0435 \\u0433\\u043E\\u043B\\u044F\\u043C\\u043E: \\u043E\\u0447\\u0430\\u043A\\u0432\\u0430 \\u0441\\u0435 ".concat((t=i.origin)!=null?t:"\\u0441\\u0442\\u043E\\u0439\\u043D\\u043E\\u0441\\u0442"," \\u0434\\u0430 \\u0441\\u044A\\u0434\\u044A\\u0440\\u0436\\u0430 ").concat(c).concat(i.maximum.toString()," ").concat((o=a.unit)!=null?o:"\\u0435\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442\\u0430"):"\\u0422\\u0432\\u044A\\u0440\\u0434\\u0435 \\u0433\\u043E\\u043B\\u044F\\u043C\\u043E: \\u043E\\u0447\\u0430\\u043A\\u0432\\u0430 \\u0441\\u0435 ".concat((u=i.origin)!=null?u:"\\u0441\\u0442\\u043E\\u0439\\u043D\\u043E\\u0441\\u0442"," \\u0434\\u0430 \\u0431\\u044A\\u0434\\u0435 ").concat(c).concat(i.maximum.toString())}case"too_small":{let c=i.inclusive?">=":">",a=r(i.origin);return a?"\\u0422\\u0432\\u044A\\u0440\\u0434\\u0435 \\u043C\\u0430\\u043B\\u043A\\u043E: \\u043E\\u0447\\u0430\\u043A\\u0432\\u0430 \\u0441\\u0435 ".concat(i.origin," \\u0434\\u0430 \\u0441\\u044A\\u0434\\u044A\\u0440\\u0436\\u0430 ").concat(c).concat(i.minimum.toString()," ").concat(a.unit):"\\u0422\\u0432\\u044A\\u0440\\u0434\\u0435 \\u043C\\u0430\\u043B\\u043A\\u043E: \\u043E\\u0447\\u0430\\u043A\\u0432\\u0430 \\u0441\\u0435 ".concat(i.origin," \\u0434\\u0430 \\u0431\\u044A\\u0434\\u0435 ").concat(c).concat(i.minimum.toString())}case"invalid_format":{let c=i;if(c.format==="starts_with")return'\\u041D\\u0435\\u0432\\u0430\\u043B\\u0438\\u0434\\u0435\\u043D \\u043D\\u0438\\u0437: \\u0442\\u0440\\u044F\\u0431\\u0432\\u0430 \\u0434\\u0430 \\u0437\\u0430\\u043F\\u043E\\u0447\\u0432\\u0430 \\u0441 "'.concat(c.prefix,'"');if(c.format==="ends_with")return'\\u041D\\u0435\\u0432\\u0430\\u043B\\u0438\\u0434\\u0435\\u043D \\u043D\\u0438\\u0437: \\u0442\\u0440\\u044F\\u0431\\u0432\\u0430 \\u0434\\u0430 \\u0437\\u0430\\u0432\\u044A\\u0440\\u0448\\u0432\\u0430 \\u0441 "'.concat(c.suffix,'"');if(c.format==="includes")return'\\u041D\\u0435\\u0432\\u0430\\u043B\\u0438\\u0434\\u0435\\u043D \\u043D\\u0438\\u0437: \\u0442\\u0440\\u044F\\u0431\\u0432\\u0430 \\u0434\\u0430 \\u0432\\u043A\\u043B\\u044E\\u0447\\u0432\\u0430 "'.concat(c.includes,'"');if(c.format==="regex")return"\\u041D\\u0435\\u0432\\u0430\\u043B\\u0438\\u0434\\u0435\\u043D \\u043D\\u0438\\u0437: \\u0442\\u0440\\u044F\\u0431\\u0432\\u0430 \\u0434\\u0430 \\u0441\\u044A\\u0432\\u043F\\u0430\\u0434\\u0430 \\u0441 ".concat(c.pattern);let a="\\u041D\\u0435\\u0432\\u0430\\u043B\\u0438\\u0434\\u0435\\u043D";return c.format==="emoji"&&(a="\\u041D\\u0435\\u0432\\u0430\\u043B\\u0438\\u0434\\u043D\\u043E"),c.format==="datetime"&&(a="\\u041D\\u0435\\u0432\\u0430\\u043B\\u0438\\u0434\\u043D\\u043E"),c.format==="date"&&(a="\\u041D\\u0435\\u0432\\u0430\\u043B\\u0438\\u0434\\u043D\\u0430"),c.format==="time"&&(a="\\u041D\\u0435\\u0432\\u0430\\u043B\\u0438\\u0434\\u043D\\u043E"),c.format==="duration"&&(a="\\u041D\\u0435\\u0432\\u0430\\u043B\\u0438\\u0434\\u043D\\u0430"),"".concat(a," ").concat((l=n[c.format])!=null?l:i.format)}case"not_multiple_of":return"\\u041D\\u0435\\u0432\\u0430\\u043B\\u0438\\u0434\\u043D\\u043E \\u0447\\u0438\\u0441\\u043B\\u043E: \\u0442\\u0440\\u044F\\u0431\\u0432\\u0430 \\u0434\\u0430 \\u0431\\u044A\\u0434\\u0435 \\u043A\\u0440\\u0430\\u0442\\u043D\\u043E \\u043D\\u0430 ".concat(i.divisor);case"unrecognized_keys":return"\\u041D\\u0435\\u0440\\u0430\\u0437\\u043F\\u043E\\u0437\\u043D\\u0430\\u0442".concat(i.keys.length>1?"\\u0438":""," \\u043A\\u043B\\u044E\\u0447").concat(i.keys.length>1?"\\u043E\\u0432\\u0435":"",": ").concat(p(i.keys,", "));case"invalid_key":return"\\u041D\\u0435\\u0432\\u0430\\u043B\\u0438\\u0434\\u0435\\u043D \\u043A\\u043B\\u044E\\u0447 \\u0432 ".concat(i.origin);case"invalid_union":return"\\u041D\\u0435\\u0432\\u0430\\u043B\\u0438\\u0434\\u0435\\u043D \\u0432\\u0445\\u043E\\u0434";case"invalid_element":return"\\u041D\\u0435\\u0432\\u0430\\u043B\\u0438\\u0434\\u043D\\u0430 \\u0441\\u0442\\u043E\\u0439\\u043D\\u043E\\u0441\\u0442 \\u0432 ".concat(i.origin);default:return"\\u041D\\u0435\\u0432\\u0430\\u043B\\u0438\\u0434\\u0435\\u043D \\u0432\\u0445\\u043E\\u0434"}}};function Uu(){return{localeError:js()}}var Os=()=>{let e={string:{unit:"car\\xE0cters",verb:"contenir"},file:{unit:"bytes",verb:"contenir"},array:{unit:"elements",verb:"contenir"},set:{unit:"elements",verb:"contenir"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"number";case"object":{if(Array.isArray(t))return"array";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"entrada",email:"adre\\xE7a electr\\xF2nica",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"data i hora ISO",date:"data ISO",time:"hora ISO",duration:"durada ISO",ipv4:"adre\\xE7a IPv4",ipv6:"adre\\xE7a IPv6",cidrv4:"rang IPv4",cidrv6:"rang IPv6",base64:"cadena codificada en base64",base64url:"cadena codificada en base64url",json_string:"cadena JSON",e164:"n\\xFAmero E.164",jwt:"JWT",template_literal:"entrada"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"Tipus inv\\xE0lid: s'esperava ".concat(t.expected,", s'ha rebut ").concat(n(t.input));case"invalid_value":return t.values.length===1?"Valor inv\\xE0lid: s'esperava ".concat(b(t.values[0])):"Opci\\xF3 inv\\xE0lida: s'esperava una de ".concat(p(t.values," o "));case"too_big":{let a=t.inclusive?"com a m\\xE0xim":"menys de",s=r(t.origin);return s?"Massa gran: s'esperava que ".concat((o=t.origin)!=null?o:"el valor"," contingu\\xE9s ").concat(a," ").concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"elements"):"Massa gran: s'esperava que ".concat((l=t.origin)!=null?l:"el valor"," fos ").concat(a," ").concat(t.maximum.toString())}case"too_small":{let a=t.inclusive?"com a m\\xEDnim":"m\\xE9s de",s=r(t.origin);return s?"Massa petit: s'esperava que ".concat(t.origin," contingu\\xE9s ").concat(a," ").concat(t.minimum.toString()," ").concat(s.unit):"Massa petit: s'esperava que ".concat(t.origin," fos ").concat(a," ").concat(t.minimum.toString())}case"invalid_format":{let a=t;return a.format==="starts_with"?'Format inv\\xE0lid: ha de comen\\xE7ar amb "'.concat(a.prefix,'"'):a.format==="ends_with"?"Format inv\\xE0lid: ha d'acabar amb \\"".concat(a.suffix,'"'):a.format==="includes"?"Format inv\\xE0lid: ha d'incloure \\"".concat(a.includes,'"'):a.format==="regex"?"Format inv\\xE0lid: ha de coincidir amb el patr\\xF3 ".concat(a.pattern):"Format inv\\xE0lid per a ".concat((c=i[a.format])!=null?c:t.format)}case"not_multiple_of":return"N\\xFAmero inv\\xE0lid: ha de ser m\\xFAltiple de ".concat(t.divisor);case"unrecognized_keys":return"Clau".concat(t.keys.length>1?"s":""," no reconeguda").concat(t.keys.length>1?"s":"",": ").concat(p(t.keys,", "));case"invalid_key":return"Clau inv\\xE0lida a ".concat(t.origin);case"invalid_union":return"Entrada inv\\xE0lida";case"invalid_element":return"Element inv\\xE0lid a ".concat(t.origin);default:return"Entrada inv\\xE0lida"}}};function Nu(){return{localeError:Os()}}var Ps=()=>{let e={string:{unit:"znak\\u016F",verb:"m\\xEDt"},file:{unit:"bajt\\u016F",verb:"m\\xEDt"},array:{unit:"prvk\\u016F",verb:"m\\xEDt"},set:{unit:"prvk\\u016F",verb:"m\\xEDt"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"\\u010D\\xEDslo";case"string":return"\\u0159et\\u011Bzec";case"boolean":return"boolean";case"bigint":return"bigint";case"function":return"funkce";case"symbol":return"symbol";case"undefined":return"undefined";case"object":{if(Array.isArray(t))return"pole";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"regul\\xE1rn\\xED v\\xFDraz",email:"e-mailov\\xE1 adresa",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"datum a \\u010Das ve form\\xE1tu ISO",date:"datum ve form\\xE1tu ISO",time:"\\u010Das ve form\\xE1tu ISO",duration:"doba trv\\xE1n\\xED ISO",ipv4:"IPv4 adresa",ipv6:"IPv6 adresa",cidrv4:"rozsah IPv4",cidrv6:"rozsah IPv6",base64:"\\u0159et\\u011Bzec zak\\xF3dovan\\xFD ve form\\xE1tu base64",base64url:"\\u0159et\\u011Bzec zak\\xF3dovan\\xFD ve form\\xE1tu base64url",json_string:"\\u0159et\\u011Bzec ve form\\xE1tu JSON",e164:"\\u010D\\xEDslo E.164",jwt:"JWT",template_literal:"vstup"};return t=>{var o,u,l,c,a,s,v;switch(t.code){case"invalid_type":return"Neplatn\\xFD vstup: o\\u010Dek\\xE1v\\xE1no ".concat(t.expected,", obdr\\u017Eeno ").concat(n(t.input));case"invalid_value":return t.values.length===1?"Neplatn\\xFD vstup: o\\u010Dek\\xE1v\\xE1no ".concat(b(t.values[0])):"Neplatn\\xE1 mo\\u017Enost: o\\u010Dek\\xE1v\\xE1na jedna z hodnot ".concat(p(t.values,"|"));case"too_big":{let f=t.inclusive?"<=":"<",h=r(t.origin);return h?"Hodnota je p\\u0159\\xEDli\\u0161 velk\\xE1: ".concat((o=t.origin)!=null?o:"hodnota"," mus\\xED m\\xEDt ").concat(f).concat(t.maximum.toString()," ").concat((u=h.unit)!=null?u:"prvk\\u016F"):"Hodnota je p\\u0159\\xEDli\\u0161 velk\\xE1: ".concat((l=t.origin)!=null?l:"hodnota"," mus\\xED b\\xFDt ").concat(f).concat(t.maximum.toString())}case"too_small":{let f=t.inclusive?">=":">",h=r(t.origin);return h?"Hodnota je p\\u0159\\xEDli\\u0161 mal\\xE1: ".concat((c=t.origin)!=null?c:"hodnota"," mus\\xED m\\xEDt ").concat(f).concat(t.minimum.toString()," ").concat((a=h.unit)!=null?a:"prvk\\u016F"):"Hodnota je p\\u0159\\xEDli\\u0161 mal\\xE1: ".concat((s=t.origin)!=null?s:"hodnota"," mus\\xED b\\xFDt ").concat(f).concat(t.minimum.toString())}case"invalid_format":{let f=t;return f.format==="starts_with"?'Neplatn\\xFD \\u0159et\\u011Bzec: mus\\xED za\\u010D\\xEDnat na "'.concat(f.prefix,'"'):f.format==="ends_with"?'Neplatn\\xFD \\u0159et\\u011Bzec: mus\\xED kon\\u010Dit na "'.concat(f.suffix,'"'):f.format==="includes"?'Neplatn\\xFD \\u0159et\\u011Bzec: mus\\xED obsahovat "'.concat(f.includes,'"'):f.format==="regex"?"Neplatn\\xFD \\u0159et\\u011Bzec: mus\\xED odpov\\xEDdat vzoru ".concat(f.pattern):"Neplatn\\xFD form\\xE1t ".concat((v=i[f.format])!=null?v:t.format)}case"not_multiple_of":return"Neplatn\\xE9 \\u010D\\xEDslo: mus\\xED b\\xFDt n\\xE1sobkem ".concat(t.divisor);case"unrecognized_keys":return"Nezn\\xE1m\\xE9 kl\\xED\\u010De: ".concat(p(t.keys,", "));case"invalid_key":return"Neplatn\\xFD kl\\xED\\u010D v ".concat(t.origin);case"invalid_union":return"Neplatn\\xFD vstup";case"invalid_element":return"Neplatn\\xE1 hodnota v ".concat(t.origin);default:return"Neplatn\\xFD vstup"}}};function Zu(){return{localeError:Ps()}}var Us=()=>{let e={string:{unit:"tegn",verb:"havde"},file:{unit:"bytes",verb:"havde"},array:{unit:"elementer",verb:"indeholdt"},set:{unit:"elementer",verb:"indeholdt"}},r={string:"streng",number:"tal",boolean:"boolean",array:"liste",object:"objekt",set:"s\\xE6t",file:"fil"};function n(u){var l;return(l=e[u])!=null?l:null}function i(u){var l;return(l=r[u])!=null?l:u}let t=u=>{let l=typeof u;switch(l){case"number":return Number.isNaN(u)?"NaN":"tal";case"object":return Array.isArray(u)?"liste":u===null?"null":Object.getPrototypeOf(u)!==Object.prototype&&u.constructor?u.constructor.name:"objekt"}return l},o={regex:"input",email:"e-mailadresse",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO dato- og klokkesl\\xE6t",date:"ISO-dato",time:"ISO-klokkesl\\xE6t",duration:"ISO-varighed",ipv4:"IPv4-omr\\xE5de",ipv6:"IPv6-omr\\xE5de",cidrv4:"IPv4-spektrum",cidrv6:"IPv6-spektrum",base64:"base64-kodet streng",base64url:"base64url-kodet streng",json_string:"JSON-streng",e164:"E.164-nummer",jwt:"JWT",template_literal:"input"};return u=>{var l,c;switch(u.code){case"invalid_type":return"Ugyldigt input: forventede ".concat(i(u.expected),", fik ").concat(i(t(u.input)));case"invalid_value":return u.values.length===1?"Ugyldig v\\xE6rdi: forventede ".concat(b(u.values[0])):"Ugyldigt valg: forventede en af f\\xF8lgende ".concat(p(u.values,"|"));case"too_big":{let a=u.inclusive?"<=":"<",s=n(u.origin),v=i(u.origin);return s?"For stor: forventede ".concat(v!=null?v:"value"," ").concat(s.verb," ").concat(a," ").concat(u.maximum.toString()," ").concat((l=s.unit)!=null?l:"elementer"):"For stor: forventede ".concat(v!=null?v:"value"," havde ").concat(a," ").concat(u.maximum.toString())}case"too_small":{let a=u.inclusive?">=":">",s=n(u.origin),v=i(u.origin);return s?"For lille: forventede ".concat(v," ").concat(s.verb," ").concat(a," ").concat(u.minimum.toString()," ").concat(s.unit):"For lille: forventede ".concat(v," havde ").concat(a," ").concat(u.minimum.toString())}case"invalid_format":{let a=u;return a.format==="starts_with"?'Ugyldig streng: skal starte med "'.concat(a.prefix,'"'):a.format==="ends_with"?'Ugyldig streng: skal ende med "'.concat(a.suffix,'"'):a.format==="includes"?'Ugyldig streng: skal indeholde "'.concat(a.includes,'"'):a.format==="regex"?"Ugyldig streng: skal matche m\\xF8nsteret ".concat(a.pattern):"Ugyldig ".concat((c=o[a.format])!=null?c:u.format)}case"not_multiple_of":return"Ugyldigt tal: skal v\\xE6re deleligt med ".concat(u.divisor);case"unrecognized_keys":return"".concat(u.keys.length>1?"Ukendte n\\xF8gler":"Ukendt n\\xF8gle",": ").concat(p(u.keys,", "));case"invalid_key":return"Ugyldig n\\xF8gle i ".concat(u.origin);case"invalid_union":return"Ugyldigt input: matcher ingen af de tilladte typer";case"invalid_element":return"Ugyldig v\\xE6rdi i ".concat(u.origin);default:return"Ugyldigt input"}}};function Du(){return{localeError:Us()}}var Ns=()=>{let e={string:{unit:"Zeichen",verb:"zu haben"},file:{unit:"Bytes",verb:"zu haben"},array:{unit:"Elemente",verb:"zu haben"},set:{unit:"Elemente",verb:"zu haben"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"Zahl";case"object":{if(Array.isArray(t))return"Array";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"Eingabe",email:"E-Mail-Adresse",url:"URL",emoji:"Emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO-Datum und -Uhrzeit",date:"ISO-Datum",time:"ISO-Uhrzeit",duration:"ISO-Dauer",ipv4:"IPv4-Adresse",ipv6:"IPv6-Adresse",cidrv4:"IPv4-Bereich",cidrv6:"IPv6-Bereich",base64:"Base64-codierter String",base64url:"Base64-URL-codierter String",json_string:"JSON-String",e164:"E.164-Nummer",jwt:"JWT",template_literal:"Eingabe"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"Ung\\xFCltige Eingabe: erwartet ".concat(t.expected,", erhalten ").concat(n(t.input));case"invalid_value":return t.values.length===1?"Ung\\xFCltige Eingabe: erwartet ".concat(b(t.values[0])):"Ung\\xFCltige Option: erwartet eine von ".concat(p(t.values,"|"));case"too_big":{let a=t.inclusive?"<=":"<",s=r(t.origin);return s?"Zu gro\\xDF: erwartet, dass ".concat((o=t.origin)!=null?o:"Wert"," ").concat(a).concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"Elemente"," hat"):"Zu gro\\xDF: erwartet, dass ".concat((l=t.origin)!=null?l:"Wert"," ").concat(a).concat(t.maximum.toString()," ist")}case"too_small":{let a=t.inclusive?">=":">",s=r(t.origin);return s?"Zu klein: erwartet, dass ".concat(t.origin," ").concat(a).concat(t.minimum.toString()," ").concat(s.unit," hat"):"Zu klein: erwartet, dass ".concat(t.origin," ").concat(a).concat(t.minimum.toString()," ist")}case"invalid_format":{let a=t;return a.format==="starts_with"?'Ung\\xFCltiger String: muss mit "'.concat(a.prefix,'" beginnen'):a.format==="ends_with"?'Ung\\xFCltiger String: muss mit "'.concat(a.suffix,'" enden'):a.format==="includes"?'Ung\\xFCltiger String: muss "'.concat(a.includes,'" enthalten'):a.format==="regex"?"Ung\\xFCltiger String: muss dem Muster ".concat(a.pattern," entsprechen"):"Ung\\xFCltig: ".concat((c=i[a.format])!=null?c:t.format)}case"not_multiple_of":return"Ung\\xFCltige Zahl: muss ein Vielfaches von ".concat(t.divisor," sein");case"unrecognized_keys":return"".concat(t.keys.length>1?"Unbekannte Schl\\xFCssel":"Unbekannter Schl\\xFCssel",": ").concat(p(t.keys,", "));case"invalid_key":return"Ung\\xFCltiger Schl\\xFCssel in ".concat(t.origin);case"invalid_union":return"Ung\\xFCltige Eingabe";case"invalid_element":return"Ung\\xFCltiger Wert in ".concat(t.origin);default:return"Ung\\xFCltige Eingabe"}}};function Tu(){return{localeError:Ns()}}var Zs=e=>{let r=typeof e;switch(r){case"number":return Number.isNaN(e)?"NaN":"number";case"object":{if(Array.isArray(e))return"array";if(e===null)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}}return r},Ds=()=>{let e={string:{unit:"characters",verb:"to have"},file:{unit:"bytes",verb:"to have"},array:{unit:"items",verb:"to have"},set:{unit:"items",verb:"to have"}};function r(i){var t;return(t=e[i])!=null?t:null}let n={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"};return i=>{var t,o,u,l;switch(i.code){case"invalid_type":return"Invalid input: expected ".concat(i.expected,", received ").concat(Zs(i.input));case"invalid_value":return i.values.length===1?"Invalid input: expected ".concat(b(i.values[0])):"Invalid option: expected one of ".concat(p(i.values,"|"));case"too_big":{let c=i.inclusive?"<=":"<",a=r(i.origin);return a?"Too big: expected ".concat((t=i.origin)!=null?t:"value"," to have ").concat(c).concat(i.maximum.toString()," ").concat((o=a.unit)!=null?o:"elements"):"Too big: expected ".concat((u=i.origin)!=null?u:"value"," to be ").concat(c).concat(i.maximum.toString())}case"too_small":{let c=i.inclusive?">=":">",a=r(i.origin);return a?"Too small: expected ".concat(i.origin," to have ").concat(c).concat(i.minimum.toString()," ").concat(a.unit):"Too small: expected ".concat(i.origin," to be ").concat(c).concat(i.minimum.toString())}case"invalid_format":{let c=i;return c.format==="starts_with"?'Invalid string: must start with "'.concat(c.prefix,'"'):c.format==="ends_with"?'Invalid string: must end with "'.concat(c.suffix,'"'):c.format==="includes"?'Invalid string: must include "'.concat(c.includes,'"'):c.format==="regex"?"Invalid string: must match pattern ".concat(c.pattern):"Invalid ".concat((l=n[c.format])!=null?l:i.format)}case"not_multiple_of":return"Invalid number: must be a multiple of ".concat(i.divisor);case"unrecognized_keys":return"Unrecognized key".concat(i.keys.length>1?"s":"",": ").concat(p(i.keys,", "));case"invalid_key":return"Invalid key in ".concat(i.origin);case"invalid_union":return"Invalid input";case"invalid_element":return"Invalid value in ".concat(i.origin);default:return"Invalid input"}}};function tr(){return{localeError:Ds()}}var Ts=e=>{let r=typeof e;switch(r){case"number":return Number.isNaN(e)?"NaN":"nombro";case"object":{if(Array.isArray(e))return"tabelo";if(e===null)return"senvalora";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}}return r},Es=()=>{let e={string:{unit:"karaktrojn",verb:"havi"},file:{unit:"bajtojn",verb:"havi"},array:{unit:"elementojn",verb:"havi"},set:{unit:"elementojn",verb:"havi"}};function r(i){var t;return(t=e[i])!=null?t:null}let n={regex:"enigo",email:"retadreso",url:"URL",emoji:"emo\\u011Dio",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO-datotempo",date:"ISO-dato",time:"ISO-tempo",duration:"ISO-da\\u016Dro",ipv4:"IPv4-adreso",ipv6:"IPv6-adreso",cidrv4:"IPv4-rango",cidrv6:"IPv6-rango",base64:"64-ume kodita karaktraro",base64url:"URL-64-ume kodita karaktraro",json_string:"JSON-karaktraro",e164:"E.164-nombro",jwt:"JWT",template_literal:"enigo"};return i=>{var t,o,u,l;switch(i.code){case"invalid_type":return"Nevalida enigo: atendi\\u011Dis ".concat(i.expected,", ricevi\\u011Dis ").concat(Ts(i.input));case"invalid_value":return i.values.length===1?"Nevalida enigo: atendi\\u011Dis ".concat(b(i.values[0])):"Nevalida opcio: atendi\\u011Dis unu el ".concat(p(i.values,"|"));case"too_big":{let c=i.inclusive?"<=":"<",a=r(i.origin);return a?"Tro granda: atendi\\u011Dis ke ".concat((t=i.origin)!=null?t:"valoro"," havu ").concat(c).concat(i.maximum.toString()," ").concat((o=a.unit)!=null?o:"elementojn"):"Tro granda: atendi\\u011Dis ke ".concat((u=i.origin)!=null?u:"valoro"," havu ").concat(c).concat(i.maximum.toString())}case"too_small":{let c=i.inclusive?">=":">",a=r(i.origin);return a?"Tro malgranda: atendi\\u011Dis ke ".concat(i.origin," havu ").concat(c).concat(i.minimum.toString()," ").concat(a.unit):"Tro malgranda: atendi\\u011Dis ke ".concat(i.origin," estu ").concat(c).concat(i.minimum.toString())}case"invalid_format":{let c=i;return c.format==="starts_with"?'Nevalida karaktraro: devas komenci\\u011Di per "'.concat(c.prefix,'"'):c.format==="ends_with"?'Nevalida karaktraro: devas fini\\u011Di per "'.concat(c.suffix,'"'):c.format==="includes"?'Nevalida karaktraro: devas inkluzivi "'.concat(c.includes,'"'):c.format==="regex"?"Nevalida karaktraro: devas kongrui kun la modelo ".concat(c.pattern):"Nevalida ".concat((l=n[c.format])!=null?l:i.format)}case"not_multiple_of":return"Nevalida nombro: devas esti oblo de ".concat(i.divisor);case"unrecognized_keys":return"Nekonata".concat(i.keys.length>1?"j":""," \\u015Dlosilo").concat(i.keys.length>1?"j":"",": ").concat(p(i.keys,", "));case"invalid_key":return"Nevalida \\u015Dlosilo en ".concat(i.origin);case"invalid_union":return"Nevalida enigo";case"invalid_element":return"Nevalida valoro en ".concat(i.origin);default:return"Nevalida enigo"}}};function Eu(){return{localeError:Es()}}var As=()=>{let e={string:{unit:"caracteres",verb:"tener"},file:{unit:"bytes",verb:"tener"},array:{unit:"elementos",verb:"tener"},set:{unit:"elementos",verb:"tener"}},r={string:"texto",number:"n\\xFAmero",boolean:"booleano",array:"arreglo",object:"objeto",set:"conjunto",file:"archivo",date:"fecha",bigint:"n\\xFAmero grande",symbol:"s\\xEDmbolo",undefined:"indefinido",null:"nulo",function:"funci\\xF3n",map:"mapa",record:"registro",tuple:"tupla",enum:"enumeraci\\xF3n",union:"uni\\xF3n",literal:"literal",promise:"promesa",void:"vac\\xEDo",never:"nunca",unknown:"desconocido",any:"cualquiera"};function n(u){var l;return(l=e[u])!=null?l:null}function i(u){var l;return(l=r[u])!=null?l:u}let t=u=>{let l=typeof u;switch(l){case"number":return Number.isNaN(u)?"NaN":"number";case"object":return Array.isArray(u)?"array":u===null?"null":Object.getPrototypeOf(u)!==Object.prototype?u.constructor.name:"object"}return l},o={regex:"entrada",email:"direcci\\xF3n de correo electr\\xF3nico",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"fecha y hora ISO",date:"fecha ISO",time:"hora ISO",duration:"duraci\\xF3n ISO",ipv4:"direcci\\xF3n IPv4",ipv6:"direcci\\xF3n IPv6",cidrv4:"rango IPv4",cidrv6:"rango IPv6",base64:"cadena codificada en base64",base64url:"URL codificada en base64",json_string:"cadena JSON",e164:"n\\xFAmero E.164",jwt:"JWT",template_literal:"entrada"};return u=>{var l,c;switch(u.code){case"invalid_type":return"Entrada inv\\xE1lida: se esperaba ".concat(i(u.expected),", recibido ").concat(i(t(u.input)));case"invalid_value":return u.values.length===1?"Entrada inv\\xE1lida: se esperaba ".concat(b(u.values[0])):"Opci\\xF3n inv\\xE1lida: se esperaba una de ".concat(p(u.values,"|"));case"too_big":{let a=u.inclusive?"<=":"<",s=n(u.origin),v=i(u.origin);return s?"Demasiado grande: se esperaba que ".concat(v!=null?v:"valor"," tuviera ").concat(a).concat(u.maximum.toString()," ").concat((l=s.unit)!=null?l:"elementos"):"Demasiado grande: se esperaba que ".concat(v!=null?v:"valor"," fuera ").concat(a).concat(u.maximum.toString())}case"too_small":{let a=u.inclusive?">=":">",s=n(u.origin),v=i(u.origin);return s?"Demasiado peque\\xF1o: se esperaba que ".concat(v," tuviera ").concat(a).concat(u.minimum.toString()," ").concat(s.unit):"Demasiado peque\\xF1o: se esperaba que ".concat(v," fuera ").concat(a).concat(u.minimum.toString())}case"invalid_format":{let a=u;return a.format==="starts_with"?'Cadena inv\\xE1lida: debe comenzar con "'.concat(a.prefix,'"'):a.format==="ends_with"?'Cadena inv\\xE1lida: debe terminar en "'.concat(a.suffix,'"'):a.format==="includes"?'Cadena inv\\xE1lida: debe incluir "'.concat(a.includes,'"'):a.format==="regex"?"Cadena inv\\xE1lida: debe coincidir con el patr\\xF3n ".concat(a.pattern):"Inv\\xE1lido ".concat((c=o[a.format])!=null?c:u.format)}case"not_multiple_of":return"N\\xFAmero inv\\xE1lido: debe ser m\\xFAltiplo de ".concat(u.divisor);case"unrecognized_keys":return"Llave".concat(u.keys.length>1?"s":""," desconocida").concat(u.keys.length>1?"s":"",": ").concat(p(u.keys,", "));case"invalid_key":return"Llave inv\\xE1lida en ".concat(i(u.origin));case"invalid_union":return"Entrada inv\\xE1lida";case"invalid_element":return"Valor inv\\xE1lido en ".concat(i(u.origin));default:return"Entrada inv\\xE1lida"}}};function Au(){return{localeError:As()}}var Rs=()=>{let e={string:{unit:"\\u06A9\\u0627\\u0631\\u0627\\u06A9\\u062A\\u0631",verb:"\\u062F\\u0627\\u0634\\u062A\\u0647 \\u0628\\u0627\\u0634\\u062F"},file:{unit:"\\u0628\\u0627\\u06CC\\u062A",verb:"\\u062F\\u0627\\u0634\\u062A\\u0647 \\u0628\\u0627\\u0634\\u062F"},array:{unit:"\\u0622\\u06CC\\u062A\\u0645",verb:"\\u062F\\u0627\\u0634\\u062A\\u0647 \\u0628\\u0627\\u0634\\u062F"},set:{unit:"\\u0622\\u06CC\\u062A\\u0645",verb:"\\u062F\\u0627\\u0634\\u062A\\u0647 \\u0628\\u0627\\u0634\\u062F"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"\\u0639\\u062F\\u062F";case"object":{if(Array.isArray(t))return"\\u0622\\u0631\\u0627\\u06CC\\u0647";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"\\u0648\\u0631\\u0648\\u062F\\u06CC",email:"\\u0622\\u062F\\u0631\\u0633 \\u0627\\u06CC\\u0645\\u06CC\\u0644",url:"URL",emoji:"\\u0627\\u06CC\\u0645\\u0648\\u062C\\u06CC",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"\\u062A\\u0627\\u0631\\u06CC\\u062E \\u0648 \\u0632\\u0645\\u0627\\u0646 \\u0627\\u06CC\\u0632\\u0648",date:"\\u062A\\u0627\\u0631\\u06CC\\u062E \\u0627\\u06CC\\u0632\\u0648",time:"\\u0632\\u0645\\u0627\\u0646 \\u0627\\u06CC\\u0632\\u0648",duration:"\\u0645\\u062F\\u062A \\u0632\\u0645\\u0627\\u0646 \\u0627\\u06CC\\u0632\\u0648",ipv4:"IPv4 \\u0622\\u062F\\u0631\\u0633",ipv6:"IPv6 \\u0622\\u062F\\u0631\\u0633",cidrv4:"IPv4 \\u062F\\u0627\\u0645\\u0646\\u0647",cidrv6:"IPv6 \\u062F\\u0627\\u0645\\u0646\\u0647",base64:"base64-encoded \\u0631\\u0634\\u062A\\u0647",base64url:"base64url-encoded \\u0631\\u0634\\u062A\\u0647",json_string:"JSON \\u0631\\u0634\\u062A\\u0647",e164:"E.164 \\u0639\\u062F\\u062F",jwt:"JWT",template_literal:"\\u0648\\u0631\\u0648\\u062F\\u06CC"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"\\u0648\\u0631\\u0648\\u062F\\u06CC \\u0646\\u0627\\u0645\\u0639\\u062A\\u0628\\u0631: \\u0645\\u06CC\\u200C\\u0628\\u0627\\u06CC\\u0633\\u062A ".concat(t.expected," \\u0645\\u06CC\\u200C\\u0628\\u0648\\u062F\\u060C ").concat(n(t.input)," \\u062F\\u0631\\u06CC\\u0627\\u0641\\u062A \\u0634\\u062F");case"invalid_value":return t.values.length===1?"\\u0648\\u0631\\u0648\\u062F\\u06CC \\u0646\\u0627\\u0645\\u0639\\u062A\\u0628\\u0631: \\u0645\\u06CC\\u200C\\u0628\\u0627\\u06CC\\u0633\\u062A ".concat(b(t.values[0])," \\u0645\\u06CC\\u200C\\u0628\\u0648\\u062F"):"\\u06AF\\u0632\\u06CC\\u0646\\u0647 \\u0646\\u0627\\u0645\\u0639\\u062A\\u0628\\u0631: \\u0645\\u06CC\\u200C\\u0628\\u0627\\u06CC\\u0633\\u062A \\u06CC\\u06A9\\u06CC \\u0627\\u0632 ".concat(p(t.values,"|")," \\u0645\\u06CC\\u200C\\u0628\\u0648\\u062F");case"too_big":{let a=t.inclusive?"<=":"<",s=r(t.origin);return s?"\\u062E\\u06CC\\u0644\\u06CC \\u0628\\u0632\\u0631\\u06AF: ".concat((o=t.origin)!=null?o:"\\u0645\\u0642\\u062F\\u0627\\u0631"," \\u0628\\u0627\\u06CC\\u062F ").concat(a).concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"\\u0639\\u0646\\u0635\\u0631"," \\u0628\\u0627\\u0634\\u062F"):"\\u062E\\u06CC\\u0644\\u06CC \\u0628\\u0632\\u0631\\u06AF: ".concat((l=t.origin)!=null?l:"\\u0645\\u0642\\u062F\\u0627\\u0631"," \\u0628\\u0627\\u06CC\\u062F ").concat(a).concat(t.maximum.toString()," \\u0628\\u0627\\u0634\\u062F")}case"too_small":{let a=t.inclusive?">=":">",s=r(t.origin);return s?"\\u062E\\u06CC\\u0644\\u06CC \\u06A9\\u0648\\u0686\\u06A9: ".concat(t.origin," \\u0628\\u0627\\u06CC\\u062F ").concat(a).concat(t.minimum.toString()," ").concat(s.unit," \\u0628\\u0627\\u0634\\u062F"):"\\u062E\\u06CC\\u0644\\u06CC \\u06A9\\u0648\\u0686\\u06A9: ".concat(t.origin," \\u0628\\u0627\\u06CC\\u062F ").concat(a).concat(t.minimum.toString()," \\u0628\\u0627\\u0634\\u062F")}case"invalid_format":{let a=t;return a.format==="starts_with"?'\\u0631\\u0634\\u062A\\u0647 \\u0646\\u0627\\u0645\\u0639\\u062A\\u0628\\u0631: \\u0628\\u0627\\u06CC\\u062F \\u0628\\u0627 "'.concat(a.prefix,'" \\u0634\\u0631\\u0648\\u0639 \\u0634\\u0648\\u062F'):a.format==="ends_with"?'\\u0631\\u0634\\u062A\\u0647 \\u0646\\u0627\\u0645\\u0639\\u062A\\u0628\\u0631: \\u0628\\u0627\\u06CC\\u062F \\u0628\\u0627 "'.concat(a.suffix,'" \\u062A\\u0645\\u0627\\u0645 \\u0634\\u0648\\u062F'):a.format==="includes"?'\\u0631\\u0634\\u062A\\u0647 \\u0646\\u0627\\u0645\\u0639\\u062A\\u0628\\u0631: \\u0628\\u0627\\u06CC\\u062F \\u0634\\u0627\\u0645\\u0644 "'.concat(a.includes,'" \\u0628\\u0627\\u0634\\u062F'):a.format==="regex"?"\\u0631\\u0634\\u062A\\u0647 \\u0646\\u0627\\u0645\\u0639\\u062A\\u0628\\u0631: \\u0628\\u0627\\u06CC\\u062F \\u0628\\u0627 \\u0627\\u0644\\u06AF\\u0648\\u06CC ".concat(a.pattern," \\u0645\\u0637\\u0627\\u0628\\u0642\\u062A \\u062F\\u0627\\u0634\\u062A\\u0647 \\u0628\\u0627\\u0634\\u062F"):"".concat((c=i[a.format])!=null?c:t.format," \\u0646\\u0627\\u0645\\u0639\\u062A\\u0628\\u0631")}case"not_multiple_of":return"\\u0639\\u062F\\u062F \\u0646\\u0627\\u0645\\u0639\\u062A\\u0628\\u0631: \\u0628\\u0627\\u06CC\\u062F \\u0645\\u0636\\u0631\\u0628 ".concat(t.divisor," \\u0628\\u0627\\u0634\\u062F");case"unrecognized_keys":return"\\u06A9\\u0644\\u06CC\\u062F".concat(t.keys.length>1?"\\u0647\\u0627\\u06CC":""," \\u0646\\u0627\\u0634\\u0646\\u0627\\u0633: ").concat(p(t.keys,", "));case"invalid_key":return"\\u06A9\\u0644\\u06CC\\u062F \\u0646\\u0627\\u0634\\u0646\\u0627\\u0633 \\u062F\\u0631 ".concat(t.origin);case"invalid_union":return"\\u0648\\u0631\\u0648\\u062F\\u06CC \\u0646\\u0627\\u0645\\u0639\\u062A\\u0628\\u0631";case"invalid_element":return"\\u0645\\u0642\\u062F\\u0627\\u0631 \\u0646\\u0627\\u0645\\u0639\\u062A\\u0628\\u0631 \\u062F\\u0631 ".concat(t.origin);default:return"\\u0648\\u0631\\u0648\\u062F\\u06CC \\u0646\\u0627\\u0645\\u0639\\u062A\\u0628\\u0631"}}};function Ru(){return{localeError:Rs()}}var Ls=()=>{let e={string:{unit:"merkki\\xE4",subject:"merkkijonon"},file:{unit:"tavua",subject:"tiedoston"},array:{unit:"alkiota",subject:"listan"},set:{unit:"alkiota",subject:"joukon"},number:{unit:"",subject:"luvun"},bigint:{unit:"",subject:"suuren kokonaisluvun"},int:{unit:"",subject:"kokonaisluvun"},date:{unit:"",subject:"p\\xE4iv\\xE4m\\xE4\\xE4r\\xE4n"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"number";case"object":{if(Array.isArray(t))return"array";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"s\\xE4\\xE4nn\\xF6llinen lauseke",email:"s\\xE4hk\\xF6postiosoite",url:"URL-osoite",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO-aikaleima",date:"ISO-p\\xE4iv\\xE4m\\xE4\\xE4r\\xE4",time:"ISO-aika",duration:"ISO-kesto",ipv4:"IPv4-osoite",ipv6:"IPv6-osoite",cidrv4:"IPv4-alue",cidrv6:"IPv6-alue",base64:"base64-koodattu merkkijono",base64url:"base64url-koodattu merkkijono",json_string:"JSON-merkkijono",e164:"E.164-luku",jwt:"JWT",template_literal:"templaattimerkkijono"};return t=>{var o;switch(t.code){case"invalid_type":return"Virheellinen tyyppi: odotettiin ".concat(t.expected,", oli ").concat(n(t.input));case"invalid_value":return t.values.length===1?"Virheellinen sy\\xF6te: t\\xE4ytyy olla ".concat(b(t.values[0])):"Virheellinen valinta: t\\xE4ytyy olla yksi seuraavista: ".concat(p(t.values,"|"));case"too_big":{let u=t.inclusive?"<=":"<",l=r(t.origin);return l?"Liian suuri: ".concat(l.subject," t\\xE4ytyy olla ").concat(u).concat(t.maximum.toString()," ").concat(l.unit).trim():"Liian suuri: arvon t\\xE4ytyy olla ".concat(u).concat(t.maximum.toString())}case"too_small":{let u=t.inclusive?">=":">",l=r(t.origin);return l?"Liian pieni: ".concat(l.subject," t\\xE4ytyy olla ").concat(u).concat(t.minimum.toString()," ").concat(l.unit).trim():"Liian pieni: arvon t\\xE4ytyy olla ".concat(u).concat(t.minimum.toString())}case"invalid_format":{let u=t;return u.format==="starts_with"?'Virheellinen sy\\xF6te: t\\xE4ytyy alkaa "'.concat(u.prefix,'"'):u.format==="ends_with"?'Virheellinen sy\\xF6te: t\\xE4ytyy loppua "'.concat(u.suffix,'"'):u.format==="includes"?'Virheellinen sy\\xF6te: t\\xE4ytyy sis\\xE4lt\\xE4\\xE4 "'.concat(u.includes,'"'):u.format==="regex"?"Virheellinen sy\\xF6te: t\\xE4ytyy vastata s\\xE4\\xE4nn\\xF6llist\\xE4 lauseketta ".concat(u.pattern):"Virheellinen ".concat((o=i[u.format])!=null?o:t.format)}case"not_multiple_of":return"Virheellinen luku: t\\xE4ytyy olla luvun ".concat(t.divisor," monikerta");case"unrecognized_keys":return"".concat(t.keys.length>1?"Tuntemattomat avaimet":"Tuntematon avain",": ").concat(p(t.keys,", "));case"invalid_key":return"Virheellinen avain tietueessa";case"invalid_union":return"Virheellinen unioni";case"invalid_element":return"Virheellinen arvo joukossa";default:return"Virheellinen sy\\xF6te"}}};function Lu(){return{localeError:Ls()}}var Cs=()=>{let e={string:{unit:"caract\\xE8res",verb:"avoir"},file:{unit:"octets",verb:"avoir"},array:{unit:"\\xE9l\\xE9ments",verb:"avoir"},set:{unit:"\\xE9l\\xE9ments",verb:"avoir"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"nombre";case"object":{if(Array.isArray(t))return"tableau";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"entr\\xE9e",email:"adresse e-mail",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"date et heure ISO",date:"date ISO",time:"heure ISO",duration:"dur\\xE9e ISO",ipv4:"adresse IPv4",ipv6:"adresse IPv6",cidrv4:"plage IPv4",cidrv6:"plage IPv6",base64:"cha\\xEEne encod\\xE9e en base64",base64url:"cha\\xEEne encod\\xE9e en base64url",json_string:"cha\\xEEne JSON",e164:"num\\xE9ro E.164",jwt:"JWT",template_literal:"entr\\xE9e"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"Entr\\xE9e invalide : ".concat(t.expected," attendu, ").concat(n(t.input)," re\\xE7u");case"invalid_value":return t.values.length===1?"Entr\\xE9e invalide : ".concat(b(t.values[0])," attendu"):"Option invalide : une valeur parmi ".concat(p(t.values,"|")," attendue");case"too_big":{let a=t.inclusive?"<=":"<",s=r(t.origin);return s?"Trop grand : ".concat((o=t.origin)!=null?o:"valeur"," doit ").concat(s.verb," ").concat(a).concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"\\xE9l\\xE9ment(s)"):"Trop grand : ".concat((l=t.origin)!=null?l:"valeur"," doit \\xEAtre ").concat(a).concat(t.maximum.toString())}case"too_small":{let a=t.inclusive?">=":">",s=r(t.origin);return s?"Trop petit : ".concat(t.origin," doit ").concat(s.verb," ").concat(a).concat(t.minimum.toString()," ").concat(s.unit):"Trop petit : ".concat(t.origin," doit \\xEAtre ").concat(a).concat(t.minimum.toString())}case"invalid_format":{let a=t;return a.format==="starts_with"?'Cha\\xEEne invalide : doit commencer par "'.concat(a.prefix,'"'):a.format==="ends_with"?'Cha\\xEEne invalide : doit se terminer par "'.concat(a.suffix,'"'):a.format==="includes"?'Cha\\xEEne invalide : doit inclure "'.concat(a.includes,'"'):a.format==="regex"?"Cha\\xEEne invalide : doit correspondre au mod\\xE8le ".concat(a.pattern):"".concat((c=i[a.format])!=null?c:t.format," invalide")}case"not_multiple_of":return"Nombre invalide : doit \\xEAtre un multiple de ".concat(t.divisor);case"unrecognized_keys":return"Cl\\xE9".concat(t.keys.length>1?"s":""," non reconnue").concat(t.keys.length>1?"s":""," : ").concat(p(t.keys,", "));case"invalid_key":return"Cl\\xE9 invalide dans ".concat(t.origin);case"invalid_union":return"Entr\\xE9e invalide";case"invalid_element":return"Valeur invalide dans ".concat(t.origin);default:return"Entr\\xE9e invalide"}}};function Cu(){return{localeError:Cs()}}var Vs=()=>{let e={string:{unit:"caract\\xE8res",verb:"avoir"},file:{unit:"octets",verb:"avoir"},array:{unit:"\\xE9l\\xE9ments",verb:"avoir"},set:{unit:"\\xE9l\\xE9ments",verb:"avoir"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"number";case"object":{if(Array.isArray(t))return"array";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"entr\\xE9e",email:"adresse courriel",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"date-heure ISO",date:"date ISO",time:"heure ISO",duration:"dur\\xE9e ISO",ipv4:"adresse IPv4",ipv6:"adresse IPv6",cidrv4:"plage IPv4",cidrv6:"plage IPv6",base64:"cha\\xEEne encod\\xE9e en base64",base64url:"cha\\xEEne encod\\xE9e en base64url",json_string:"cha\\xEEne JSON",e164:"num\\xE9ro E.164",jwt:"JWT",template_literal:"entr\\xE9e"};return t=>{var o,u,l;switch(t.code){case"invalid_type":return"Entr\\xE9e invalide : attendu ".concat(t.expected,", re\\xE7u ").concat(n(t.input));case"invalid_value":return t.values.length===1?"Entr\\xE9e invalide : attendu ".concat(b(t.values[0])):"Option invalide : attendu l'une des valeurs suivantes ".concat(p(t.values,"|"));case"too_big":{let c=t.inclusive?"\\u2264":"<",a=r(t.origin);return a?"Trop grand : attendu que ".concat((o=t.origin)!=null?o:"la valeur"," ait ").concat(c).concat(t.maximum.toString()," ").concat(a.unit):"Trop grand : attendu que ".concat((u=t.origin)!=null?u:"la valeur"," soit ").concat(c).concat(t.maximum.toString())}case"too_small":{let c=t.inclusive?"\\u2265":">",a=r(t.origin);return a?"Trop petit : attendu que ".concat(t.origin," ait ").concat(c).concat(t.minimum.toString()," ").concat(a.unit):"Trop petit : attendu que ".concat(t.origin," soit ").concat(c).concat(t.minimum.toString())}case"invalid_format":{let c=t;return c.format==="starts_with"?'Cha\\xEEne invalide : doit commencer par "'.concat(c.prefix,'"'):c.format==="ends_with"?'Cha\\xEEne invalide : doit se terminer par "'.concat(c.suffix,'"'):c.format==="includes"?'Cha\\xEEne invalide : doit inclure "'.concat(c.includes,'"'):c.format==="regex"?"Cha\\xEEne invalide : doit correspondre au motif ".concat(c.pattern):"".concat((l=i[c.format])!=null?l:t.format," invalide")}case"not_multiple_of":return"Nombre invalide : doit \\xEAtre un multiple de ".concat(t.divisor);case"unrecognized_keys":return"Cl\\xE9".concat(t.keys.length>1?"s":""," non reconnue").concat(t.keys.length>1?"s":""," : ").concat(p(t.keys,", "));case"invalid_key":return"Cl\\xE9 invalide dans ".concat(t.origin);case"invalid_union":return"Entr\\xE9e invalide";case"invalid_element":return"Valeur invalide dans ".concat(t.origin);default:return"Entr\\xE9e invalide"}}};function Vu(){return{localeError:Vs()}}var Fs=()=>{let e={string:{unit:"\\u05D0\\u05D5\\u05EA\\u05D9\\u05D5\\u05EA",verb:"\\u05DC\\u05DB\\u05DC\\u05D5\\u05DC"},file:{unit:"\\u05D1\\u05D9\\u05D9\\u05D8\\u05D9\\u05DD",verb:"\\u05DC\\u05DB\\u05DC\\u05D5\\u05DC"},array:{unit:"\\u05E4\\u05E8\\u05D9\\u05D8\\u05D9\\u05DD",verb:"\\u05DC\\u05DB\\u05DC\\u05D5\\u05DC"},set:{unit:"\\u05E4\\u05E8\\u05D9\\u05D8\\u05D9\\u05DD",verb:"\\u05DC\\u05DB\\u05DC\\u05D5\\u05DC"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"number";case"object":{if(Array.isArray(t))return"array";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"\\u05E7\\u05DC\\u05D8",email:"\\u05DB\\u05EA\\u05D5\\u05D1\\u05EA \\u05D0\\u05D9\\u05DE\\u05D9\\u05D9\\u05DC",url:"\\u05DB\\u05EA\\u05D5\\u05D1\\u05EA \\u05E8\\u05E9\\u05EA",emoji:"\\u05D0\\u05D9\\u05DE\\u05D5\\u05D2'\\u05D9",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"\\u05EA\\u05D0\\u05E8\\u05D9\\u05DA \\u05D5\\u05D6\\u05DE\\u05DF ISO",date:"\\u05EA\\u05D0\\u05E8\\u05D9\\u05DA ISO",time:"\\u05D6\\u05DE\\u05DF ISO",duration:"\\u05DE\\u05E9\\u05DA \\u05D6\\u05DE\\u05DF ISO",ipv4:"\\u05DB\\u05EA\\u05D5\\u05D1\\u05EA IPv4",ipv6:"\\u05DB\\u05EA\\u05D5\\u05D1\\u05EA IPv6",cidrv4:"\\u05D8\\u05D5\\u05D5\\u05D7 IPv4",cidrv6:"\\u05D8\\u05D5\\u05D5\\u05D7 IPv6",base64:"\\u05DE\\u05D7\\u05E8\\u05D5\\u05D6\\u05EA \\u05D1\\u05D1\\u05E1\\u05D9\\u05E1 64",base64url:"\\u05DE\\u05D7\\u05E8\\u05D5\\u05D6\\u05EA \\u05D1\\u05D1\\u05E1\\u05D9\\u05E1 64 \\u05DC\\u05DB\\u05EA\\u05D5\\u05D1\\u05D5\\u05EA \\u05E8\\u05E9\\u05EA",json_string:"\\u05DE\\u05D7\\u05E8\\u05D5\\u05D6\\u05EA JSON",e164:"\\u05DE\\u05E1\\u05E4\\u05E8 E.164",jwt:"JWT",template_literal:"\\u05E7\\u05DC\\u05D8"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"\\u05E7\\u05DC\\u05D8 \\u05DC\\u05D0 \\u05EA\\u05E7\\u05D9\\u05DF: \\u05E6\\u05E8\\u05D9\\u05DA ".concat(t.expected,", \\u05D4\\u05EA\\u05E7\\u05D1\\u05DC ").concat(n(t.input));case"invalid_value":return t.values.length===1?"\\u05E7\\u05DC\\u05D8 \\u05DC\\u05D0 \\u05EA\\u05E7\\u05D9\\u05DF: \\u05E6\\u05E8\\u05D9\\u05DA ".concat(b(t.values[0])):"\\u05E7\\u05DC\\u05D8 \\u05DC\\u05D0 \\u05EA\\u05E7\\u05D9\\u05DF: \\u05E6\\u05E8\\u05D9\\u05DA \\u05D0\\u05D7\\u05EA \\u05DE\\u05D4\\u05D0\\u05E4\\u05E9\\u05E8\\u05D5\\u05D9\\u05D5\\u05EA  ".concat(p(t.values,"|"));case"too_big":{let a=t.inclusive?"<=":"<",s=r(t.origin);return s?"\\u05D2\\u05D3\\u05D5\\u05DC \\u05DE\\u05D3\\u05D9: ".concat((o=t.origin)!=null?o:"value"," \\u05E6\\u05E8\\u05D9\\u05DA \\u05DC\\u05D4\\u05D9\\u05D5\\u05EA ").concat(a).concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"elements"):"\\u05D2\\u05D3\\u05D5\\u05DC \\u05DE\\u05D3\\u05D9: ".concat((l=t.origin)!=null?l:"value"," \\u05E6\\u05E8\\u05D9\\u05DA \\u05DC\\u05D4\\u05D9\\u05D5\\u05EA ").concat(a).concat(t.maximum.toString())}case"too_small":{let a=t.inclusive?">=":">",s=r(t.origin);return s?"\\u05E7\\u05D8\\u05DF \\u05DE\\u05D3\\u05D9: ".concat(t.origin," \\u05E6\\u05E8\\u05D9\\u05DA \\u05DC\\u05D4\\u05D9\\u05D5\\u05EA ").concat(a).concat(t.minimum.toString()," ").concat(s.unit):"\\u05E7\\u05D8\\u05DF \\u05DE\\u05D3\\u05D9: ".concat(t.origin," \\u05E6\\u05E8\\u05D9\\u05DA \\u05DC\\u05D4\\u05D9\\u05D5\\u05EA ").concat(a).concat(t.minimum.toString())}case"invalid_format":{let a=t;return a.format==="starts_with"?'\\u05DE\\u05D7\\u05E8\\u05D5\\u05D6\\u05EA \\u05DC\\u05D0 \\u05EA\\u05E7\\u05D9\\u05E0\\u05D4: \\u05D7\\u05D9\\u05D9\\u05D1\\u05EA \\u05DC\\u05D4\\u05EA\\u05D7\\u05D9\\u05DC \\u05D1"'.concat(a.prefix,'"'):a.format==="ends_with"?'\\u05DE\\u05D7\\u05E8\\u05D5\\u05D6\\u05EA \\u05DC\\u05D0 \\u05EA\\u05E7\\u05D9\\u05E0\\u05D4: \\u05D7\\u05D9\\u05D9\\u05D1\\u05EA \\u05DC\\u05D4\\u05E1\\u05EA\\u05D9\\u05D9\\u05DD \\u05D1 "'.concat(a.suffix,'"'):a.format==="includes"?'\\u05DE\\u05D7\\u05E8\\u05D5\\u05D6\\u05EA \\u05DC\\u05D0 \\u05EA\\u05E7\\u05D9\\u05E0\\u05D4: \\u05D7\\u05D9\\u05D9\\u05D1\\u05EA \\u05DC\\u05DB\\u05DC\\u05D5\\u05DC "'.concat(a.includes,'"'):a.format==="regex"?"\\u05DE\\u05D7\\u05E8\\u05D5\\u05D6\\u05EA \\u05DC\\u05D0 \\u05EA\\u05E7\\u05D9\\u05E0\\u05D4: \\u05D7\\u05D9\\u05D9\\u05D1\\u05EA \\u05DC\\u05D4\\u05EA\\u05D0\\u05D9\\u05DD \\u05DC\\u05EA\\u05D1\\u05E0\\u05D9\\u05EA ".concat(a.pattern):"".concat((c=i[a.format])!=null?c:t.format," \\u05DC\\u05D0 \\u05EA\\u05E7\\u05D9\\u05DF")}case"not_multiple_of":return"\\u05DE\\u05E1\\u05E4\\u05E8 \\u05DC\\u05D0 \\u05EA\\u05E7\\u05D9\\u05DF: \\u05D7\\u05D9\\u05D9\\u05D1 \\u05DC\\u05D4\\u05D9\\u05D5\\u05EA \\u05DE\\u05DB\\u05E4\\u05DC\\u05D4 \\u05E9\\u05DC ".concat(t.divisor);case"unrecognized_keys":return"\\u05DE\\u05E4\\u05EA\\u05D7".concat(t.keys.length>1?"\\u05D5\\u05EA":""," \\u05DC\\u05D0 \\u05DE\\u05D6\\u05D5\\u05D4").concat(t.keys.length>1?"\\u05D9\\u05DD":"\\u05D4",": ").concat(p(t.keys,", "));case"invalid_key":return"\\u05DE\\u05E4\\u05EA\\u05D7 \\u05DC\\u05D0 \\u05EA\\u05E7\\u05D9\\u05DF \\u05D1".concat(t.origin);case"invalid_union":return"\\u05E7\\u05DC\\u05D8 \\u05DC\\u05D0 \\u05EA\\u05E7\\u05D9\\u05DF";case"invalid_element":return"\\u05E2\\u05E8\\u05DA \\u05DC\\u05D0 \\u05EA\\u05E7\\u05D9\\u05DF \\u05D1".concat(t.origin);default:return"\\u05E7\\u05DC\\u05D8 \\u05DC\\u05D0 \\u05EA\\u05E7\\u05D9\\u05DF"}}};function Fu(){return{localeError:Fs()}}var Js=()=>{let e={string:{unit:"karakter",verb:"legyen"},file:{unit:"byte",verb:"legyen"},array:{unit:"elem",verb:"legyen"},set:{unit:"elem",verb:"legyen"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"sz\\xE1m";case"object":{if(Array.isArray(t))return"t\\xF6mb";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"bemenet",email:"email c\\xEDm",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO id\\u0151b\\xE9lyeg",date:"ISO d\\xE1tum",time:"ISO id\\u0151",duration:"ISO id\\u0151intervallum",ipv4:"IPv4 c\\xEDm",ipv6:"IPv6 c\\xEDm",cidrv4:"IPv4 tartom\\xE1ny",cidrv6:"IPv6 tartom\\xE1ny",base64:"base64-k\\xF3dolt string",base64url:"base64url-k\\xF3dolt string",json_string:"JSON string",e164:"E.164 sz\\xE1m",jwt:"JWT",template_literal:"bemenet"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"\\xC9rv\\xE9nytelen bemenet: a v\\xE1rt \\xE9rt\\xE9k ".concat(t.expected,", a kapott \\xE9rt\\xE9k ").concat(n(t.input));case"invalid_value":return t.values.length===1?"\\xC9rv\\xE9nytelen bemenet: a v\\xE1rt \\xE9rt\\xE9k ".concat(b(t.values[0])):"\\xC9rv\\xE9nytelen opci\\xF3: valamelyik \\xE9rt\\xE9k v\\xE1rt ".concat(p(t.values,"|"));case"too_big":{let a=t.inclusive?"<=":"<",s=r(t.origin);return s?"T\\xFAl nagy: ".concat((o=t.origin)!=null?o:"\\xE9rt\\xE9k"," m\\xE9rete t\\xFAl nagy ").concat(a).concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"elem"):"T\\xFAl nagy: a bemeneti \\xE9rt\\xE9k ".concat((l=t.origin)!=null?l:"\\xE9rt\\xE9k"," t\\xFAl nagy: ").concat(a).concat(t.maximum.toString())}case"too_small":{let a=t.inclusive?">=":">",s=r(t.origin);return s?"T\\xFAl kicsi: a bemeneti \\xE9rt\\xE9k ".concat(t.origin," m\\xE9rete t\\xFAl kicsi ").concat(a).concat(t.minimum.toString()," ").concat(s.unit):"T\\xFAl kicsi: a bemeneti \\xE9rt\\xE9k ".concat(t.origin," t\\xFAl kicsi ").concat(a).concat(t.minimum.toString())}case"invalid_format":{let a=t;return a.format==="starts_with"?'\\xC9rv\\xE9nytelen string: "'.concat(a.prefix,'" \\xE9rt\\xE9kkel kell kezd\\u0151dnie'):a.format==="ends_with"?'\\xC9rv\\xE9nytelen string: "'.concat(a.suffix,'" \\xE9rt\\xE9kkel kell v\\xE9gz\\u0151dnie'):a.format==="includes"?'\\xC9rv\\xE9nytelen string: "'.concat(a.includes,'" \\xE9rt\\xE9ket kell tartalmaznia'):a.format==="regex"?"\\xC9rv\\xE9nytelen string: ".concat(a.pattern," mint\\xE1nak kell megfelelnie"):"\\xC9rv\\xE9nytelen ".concat((c=i[a.format])!=null?c:t.format)}case"not_multiple_of":return"\\xC9rv\\xE9nytelen sz\\xE1m: ".concat(t.divisor," t\\xF6bbsz\\xF6r\\xF6s\\xE9nek kell lennie");case"unrecognized_keys":return"Ismeretlen kulcs".concat(t.keys.length>1?"s":"",": ").concat(p(t.keys,", "));case"invalid_key":return"\\xC9rv\\xE9nytelen kulcs ".concat(t.origin);case"invalid_union":return"\\xC9rv\\xE9nytelen bemenet";case"invalid_element":return"\\xC9rv\\xE9nytelen \\xE9rt\\xE9k: ".concat(t.origin);default:return"\\xC9rv\\xE9nytelen bemenet"}}};function Ju(){return{localeError:Js()}}var Ms=()=>{let e={string:{unit:"karakter",verb:"memiliki"},file:{unit:"byte",verb:"memiliki"},array:{unit:"item",verb:"memiliki"},set:{unit:"item",verb:"memiliki"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"number";case"object":{if(Array.isArray(t))return"array";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"input",email:"alamat email",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"tanggal dan waktu format ISO",date:"tanggal format ISO",time:"jam format ISO",duration:"durasi format ISO",ipv4:"alamat IPv4",ipv6:"alamat IPv6",cidrv4:"rentang alamat IPv4",cidrv6:"rentang alamat IPv6",base64:"string dengan enkode base64",base64url:"string dengan enkode base64url",json_string:"string JSON",e164:"angka E.164",jwt:"JWT",template_literal:"input"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"Input tidak valid: diharapkan ".concat(t.expected,", diterima ").concat(n(t.input));case"invalid_value":return t.values.length===1?"Input tidak valid: diharapkan ".concat(b(t.values[0])):"Pilihan tidak valid: diharapkan salah satu dari ".concat(p(t.values,"|"));case"too_big":{let a=t.inclusive?"<=":"<",s=r(t.origin);return s?"Terlalu besar: diharapkan ".concat((o=t.origin)!=null?o:"value"," memiliki ").concat(a).concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"elemen"):"Terlalu besar: diharapkan ".concat((l=t.origin)!=null?l:"value"," menjadi ").concat(a).concat(t.maximum.toString())}case"too_small":{let a=t.inclusive?">=":">",s=r(t.origin);return s?"Terlalu kecil: diharapkan ".concat(t.origin," memiliki ").concat(a).concat(t.minimum.toString()," ").concat(s.unit):"Terlalu kecil: diharapkan ".concat(t.origin," menjadi ").concat(a).concat(t.minimum.toString())}case"invalid_format":{let a=t;return a.format==="starts_with"?'String tidak valid: harus dimulai dengan "'.concat(a.prefix,'"'):a.format==="ends_with"?'String tidak valid: harus berakhir dengan "'.concat(a.suffix,'"'):a.format==="includes"?'String tidak valid: harus menyertakan "'.concat(a.includes,'"'):a.format==="regex"?"String tidak valid: harus sesuai pola ".concat(a.pattern):"".concat((c=i[a.format])!=null?c:t.format," tidak valid")}case"not_multiple_of":return"Angka tidak valid: harus kelipatan dari ".concat(t.divisor);case"unrecognized_keys":return"Kunci tidak dikenali ".concat(t.keys.length>1?"s":"",": ").concat(p(t.keys,", "));case"invalid_key":return"Kunci tidak valid di ".concat(t.origin);case"invalid_union":return"Input tidak valid";case"invalid_element":return"Nilai tidak valid di ".concat(t.origin);default:return"Input tidak valid"}}};function Mu(){return{localeError:Ms()}}var Bs=e=>{let r=typeof e;switch(r){case"number":return Number.isNaN(e)?"NaN":"n\\xFAmer";case"object":{if(Array.isArray(e))return"fylki";if(e===null)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}}return r},Ks=()=>{let e={string:{unit:"stafi",verb:"a\\xF0 hafa"},file:{unit:"b\\xE6ti",verb:"a\\xF0 hafa"},array:{unit:"hluti",verb:"a\\xF0 hafa"},set:{unit:"hluti",verb:"a\\xF0 hafa"}};function r(i){var t;return(t=e[i])!=null?t:null}let n={regex:"gildi",email:"netfang",url:"vefsl\\xF3\\xF0",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO dagsetning og t\\xEDmi",date:"ISO dagsetning",time:"ISO t\\xEDmi",duration:"ISO t\\xEDmalengd",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded strengur",base64url:"base64url-encoded strengur",json_string:"JSON strengur",e164:"E.164 t\\xF6lugildi",jwt:"JWT",template_literal:"gildi"};return i=>{var t,o,u,l;switch(i.code){case"invalid_type":return"Rangt gildi: \\xDE\\xFA sl\\xF3st inn ".concat(Bs(i.input)," \\xFEar sem \\xE1 a\\xF0 vera ").concat(i.expected);case"invalid_value":return i.values.length===1?"Rangt gildi: gert r\\xE1\\xF0 fyrir ".concat(b(i.values[0])):"\\xD3gilt val: m\\xE1 vera eitt af eftirfarandi ".concat(p(i.values,"|"));case"too_big":{let c=i.inclusive?"<=":"<",a=r(i.origin);return a?"Of st\\xF3rt: gert er r\\xE1\\xF0 fyrir a\\xF0 ".concat((t=i.origin)!=null?t:"gildi"," hafi ").concat(c).concat(i.maximum.toString()," ").concat((o=a.unit)!=null?o:"hluti"):"Of st\\xF3rt: gert er r\\xE1\\xF0 fyrir a\\xF0 ".concat((u=i.origin)!=null?u:"gildi"," s\\xE9 ").concat(c).concat(i.maximum.toString())}case"too_small":{let c=i.inclusive?">=":">",a=r(i.origin);return a?"Of l\\xEDti\\xF0: gert er r\\xE1\\xF0 fyrir a\\xF0 ".concat(i.origin," hafi ").concat(c).concat(i.minimum.toString()," ").concat(a.unit):"Of l\\xEDti\\xF0: gert er r\\xE1\\xF0 fyrir a\\xF0 ".concat(i.origin," s\\xE9 ").concat(c).concat(i.minimum.toString())}case"invalid_format":{let c=i;return c.format==="starts_with"?'\\xD3gildur strengur: ver\\xF0ur a\\xF0 byrja \\xE1 "'.concat(c.prefix,'"'):c.format==="ends_with"?'\\xD3gildur strengur: ver\\xF0ur a\\xF0 enda \\xE1 "'.concat(c.suffix,'"'):c.format==="includes"?'\\xD3gildur strengur: ver\\xF0ur a\\xF0 innihalda "'.concat(c.includes,'"'):c.format==="regex"?"\\xD3gildur strengur: ver\\xF0ur a\\xF0 fylgja mynstri ".concat(c.pattern):"Rangt ".concat((l=n[c.format])!=null?l:i.format)}case"not_multiple_of":return"R\\xF6ng tala: ver\\xF0ur a\\xF0 vera margfeldi af ".concat(i.divisor);case"unrecognized_keys":return"\\xD3\\xFEekkt ".concat(i.keys.length>1?"ir lyklar":"ur lykill",": ").concat(p(i.keys,", "));case"invalid_key":return"Rangur lykill \\xED ".concat(i.origin);case"invalid_union":return"Rangt gildi";case"invalid_element":return"Rangt gildi \\xED ".concat(i.origin);default:return"Rangt gildi"}}};function Bu(){return{localeError:Ks()}}var Gs=()=>{let e={string:{unit:"caratteri",verb:"avere"},file:{unit:"byte",verb:"avere"},array:{unit:"elementi",verb:"avere"},set:{unit:"elementi",verb:"avere"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"numero";case"object":{if(Array.isArray(t))return"vettore";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"input",email:"indirizzo email",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"data e ora ISO",date:"data ISO",time:"ora ISO",duration:"durata ISO",ipv4:"indirizzo IPv4",ipv6:"indirizzo IPv6",cidrv4:"intervallo IPv4",cidrv6:"intervallo IPv6",base64:"stringa codificata in base64",base64url:"URL codificata in base64",json_string:"stringa JSON",e164:"numero E.164",jwt:"JWT",template_literal:"input"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"Input non valido: atteso ".concat(t.expected,", ricevuto ").concat(n(t.input));case"invalid_value":return t.values.length===1?"Input non valido: atteso ".concat(b(t.values[0])):"Opzione non valida: atteso uno tra ".concat(p(t.values,"|"));case"too_big":{let a=t.inclusive?"<=":"<",s=r(t.origin);return s?"Troppo grande: ".concat((o=t.origin)!=null?o:"valore"," deve avere ").concat(a).concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"elementi"):"Troppo grande: ".concat((l=t.origin)!=null?l:"valore"," deve essere ").concat(a).concat(t.maximum.toString())}case"too_small":{let a=t.inclusive?">=":">",s=r(t.origin);return s?"Troppo piccolo: ".concat(t.origin," deve avere ").concat(a).concat(t.minimum.toString()," ").concat(s.unit):"Troppo piccolo: ".concat(t.origin," deve essere ").concat(a).concat(t.minimum.toString())}case"invalid_format":{let a=t;return a.format==="starts_with"?'Stringa non valida: deve iniziare con "'.concat(a.prefix,'"'):a.format==="ends_with"?'Stringa non valida: deve terminare con "'.concat(a.suffix,'"'):a.format==="includes"?'Stringa non valida: deve includere "'.concat(a.includes,'"'):a.format==="regex"?"Stringa non valida: deve corrispondere al pattern ".concat(a.pattern):"Invalid ".concat((c=i[a.format])!=null?c:t.format)}case"not_multiple_of":return"Numero non valido: deve essere un multiplo di ".concat(t.divisor);case"unrecognized_keys":return"Chiav".concat(t.keys.length>1?"i":"e"," non riconosciut").concat(t.keys.length>1?"e":"a",": ").concat(p(t.keys,", "));case"invalid_key":return"Chiave non valida in ".concat(t.origin);case"invalid_union":return"Input non valido";case"invalid_element":return"Valore non valido in ".concat(t.origin);default:return"Input non valido"}}};function Ku(){return{localeError:Gs()}}var Ws=()=>{let e={string:{unit:"\\u6587\\u5B57",verb:"\\u3067\\u3042\\u308B"},file:{unit:"\\u30D0\\u30A4\\u30C8",verb:"\\u3067\\u3042\\u308B"},array:{unit:"\\u8981\\u7D20",verb:"\\u3067\\u3042\\u308B"},set:{unit:"\\u8981\\u7D20",verb:"\\u3067\\u3042\\u308B"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"\\u6570\\u5024";case"object":{if(Array.isArray(t))return"\\u914D\\u5217";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"\\u5165\\u529B\\u5024",email:"\\u30E1\\u30FC\\u30EB\\u30A2\\u30C9\\u30EC\\u30B9",url:"URL",emoji:"\\u7D75\\u6587\\u5B57",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO\\u65E5\\u6642",date:"ISO\\u65E5\\u4ED8",time:"ISO\\u6642\\u523B",duration:"ISO\\u671F\\u9593",ipv4:"IPv4\\u30A2\\u30C9\\u30EC\\u30B9",ipv6:"IPv6\\u30A2\\u30C9\\u30EC\\u30B9",cidrv4:"IPv4\\u7BC4\\u56F2",cidrv6:"IPv6\\u7BC4\\u56F2",base64:"base64\\u30A8\\u30F3\\u30B3\\u30FC\\u30C9\\u6587\\u5B57\\u5217",base64url:"base64url\\u30A8\\u30F3\\u30B3\\u30FC\\u30C9\\u6587\\u5B57\\u5217",json_string:"JSON\\u6587\\u5B57\\u5217",e164:"E.164\\u756A\\u53F7",jwt:"JWT",template_literal:"\\u5165\\u529B\\u5024"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"\\u7121\\u52B9\\u306A\\u5165\\u529B: ".concat(t.expected,"\\u304C\\u671F\\u5F85\\u3055\\u308C\\u307E\\u3057\\u305F\\u304C\\u3001").concat(n(t.input),"\\u304C\\u5165\\u529B\\u3055\\u308C\\u307E\\u3057\\u305F");case"invalid_value":return t.values.length===1?"\\u7121\\u52B9\\u306A\\u5165\\u529B: ".concat(b(t.values[0]),"\\u304C\\u671F\\u5F85\\u3055\\u308C\\u307E\\u3057\\u305F"):"\\u7121\\u52B9\\u306A\\u9078\\u629E: ".concat(p(t.values,"\\u3001"),"\\u306E\\u3044\\u305A\\u308C\\u304B\\u3067\\u3042\\u308B\\u5FC5\\u8981\\u304C\\u3042\\u308A\\u307E\\u3059");case"too_big":{let a=t.inclusive?"\\u4EE5\\u4E0B\\u3067\\u3042\\u308B":"\\u3088\\u308A\\u5C0F\\u3055\\u3044",s=r(t.origin);return s?"\\u5927\\u304D\\u3059\\u304E\\u308B\\u5024: ".concat((o=t.origin)!=null?o:"\\u5024","\\u306F").concat(t.maximum.toString()).concat((u=s.unit)!=null?u:"\\u8981\\u7D20").concat(a,"\\u5FC5\\u8981\\u304C\\u3042\\u308A\\u307E\\u3059"):"\\u5927\\u304D\\u3059\\u304E\\u308B\\u5024: ".concat((l=t.origin)!=null?l:"\\u5024","\\u306F").concat(t.maximum.toString()).concat(a,"\\u5FC5\\u8981\\u304C\\u3042\\u308A\\u307E\\u3059")}case"too_small":{let a=t.inclusive?"\\u4EE5\\u4E0A\\u3067\\u3042\\u308B":"\\u3088\\u308A\\u5927\\u304D\\u3044",s=r(t.origin);return s?"\\u5C0F\\u3055\\u3059\\u304E\\u308B\\u5024: ".concat(t.origin,"\\u306F").concat(t.minimum.toString()).concat(s.unit).concat(a,"\\u5FC5\\u8981\\u304C\\u3042\\u308A\\u307E\\u3059"):"\\u5C0F\\u3055\\u3059\\u304E\\u308B\\u5024: ".concat(t.origin,"\\u306F").concat(t.minimum.toString()).concat(a,"\\u5FC5\\u8981\\u304C\\u3042\\u308A\\u307E\\u3059")}case"invalid_format":{let a=t;return a.format==="starts_with"?'\\u7121\\u52B9\\u306A\\u6587\\u5B57\\u5217: "'.concat(a.prefix,'"\\u3067\\u59CB\\u307E\\u308B\\u5FC5\\u8981\\u304C\\u3042\\u308A\\u307E\\u3059'):a.format==="ends_with"?'\\u7121\\u52B9\\u306A\\u6587\\u5B57\\u5217: "'.concat(a.suffix,'"\\u3067\\u7D42\\u308F\\u308B\\u5FC5\\u8981\\u304C\\u3042\\u308A\\u307E\\u3059'):a.format==="includes"?'\\u7121\\u52B9\\u306A\\u6587\\u5B57\\u5217: "'.concat(a.includes,'"\\u3092\\u542B\\u3080\\u5FC5\\u8981\\u304C\\u3042\\u308A\\u307E\\u3059'):a.format==="regex"?"\\u7121\\u52B9\\u306A\\u6587\\u5B57\\u5217: \\u30D1\\u30BF\\u30FC\\u30F3".concat(a.pattern,"\\u306B\\u4E00\\u81F4\\u3059\\u308B\\u5FC5\\u8981\\u304C\\u3042\\u308A\\u307E\\u3059"):"\\u7121\\u52B9\\u306A".concat((c=i[a.format])!=null?c:t.format)}case"not_multiple_of":return"\\u7121\\u52B9\\u306A\\u6570\\u5024: ".concat(t.divisor,"\\u306E\\u500D\\u6570\\u3067\\u3042\\u308B\\u5FC5\\u8981\\u304C\\u3042\\u308A\\u307E\\u3059");case"unrecognized_keys":return"\\u8A8D\\u8B58\\u3055\\u308C\\u3066\\u3044\\u306A\\u3044\\u30AD\\u30FC".concat(t.keys.length>1?"\\u7FA4":"",": ").concat(p(t.keys,"\\u3001"));case"invalid_key":return"".concat(t.origin,"\\u5185\\u306E\\u7121\\u52B9\\u306A\\u30AD\\u30FC");case"invalid_union":return"\\u7121\\u52B9\\u306A\\u5165\\u529B";case"invalid_element":return"".concat(t.origin,"\\u5185\\u306E\\u7121\\u52B9\\u306A\\u5024");default:return"\\u7121\\u52B9\\u306A\\u5165\\u529B"}}};function Gu(){return{localeError:Ws()}}var Xs=e=>{var i;let r=typeof e;switch(r){case"number":return Number.isNaN(e)?"NaN":"\\u10E0\\u10D8\\u10EA\\u10EE\\u10D5\\u10D8";case"object":{if(Array.isArray(e))return"\\u10DB\\u10D0\\u10E1\\u10D8\\u10D5\\u10D8";if(e===null)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}}return(i={string:"\\u10E1\\u10E2\\u10E0\\u10D8\\u10DC\\u10D2\\u10D8",boolean:"\\u10D1\\u10E3\\u10DA\\u10D4\\u10D0\\u10DC\\u10D8",undefined:"undefined",bigint:"bigint",symbol:"symbol",function:"\\u10E4\\u10E3\\u10DC\\u10E5\\u10EA\\u10D8\\u10D0"}[r])!=null?i:r},qs=()=>{let e={string:{unit:"\\u10E1\\u10D8\\u10DB\\u10D1\\u10DD\\u10DA\\u10DD",verb:"\\u10E3\\u10DC\\u10D3\\u10D0 \\u10E8\\u10D4\\u10D8\\u10EA\\u10D0\\u10D5\\u10D3\\u10D4\\u10E1"},file:{unit:"\\u10D1\\u10D0\\u10D8\\u10E2\\u10D8",verb:"\\u10E3\\u10DC\\u10D3\\u10D0 \\u10E8\\u10D4\\u10D8\\u10EA\\u10D0\\u10D5\\u10D3\\u10D4\\u10E1"},array:{unit:"\\u10D4\\u10DA\\u10D4\\u10DB\\u10D4\\u10DC\\u10E2\\u10D8",verb:"\\u10E3\\u10DC\\u10D3\\u10D0 \\u10E8\\u10D4\\u10D8\\u10EA\\u10D0\\u10D5\\u10D3\\u10D4\\u10E1"},set:{unit:"\\u10D4\\u10DA\\u10D4\\u10DB\\u10D4\\u10DC\\u10E2\\u10D8",verb:"\\u10E3\\u10DC\\u10D3\\u10D0 \\u10E8\\u10D4\\u10D8\\u10EA\\u10D0\\u10D5\\u10D3\\u10D4\\u10E1"}};function r(i){var t;return(t=e[i])!=null?t:null}let n={regex:"\\u10E8\\u10D4\\u10E7\\u10D5\\u10D0\\u10DC\\u10D0",email:"\\u10D4\\u10DA-\\u10E4\\u10DD\\u10E1\\u10E2\\u10D8\\u10E1 \\u10DB\\u10D8\\u10E1\\u10D0\\u10DB\\u10D0\\u10E0\\u10D7\\u10D8",url:"URL",emoji:"\\u10D4\\u10DB\\u10DD\\u10EF\\u10D8",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"\\u10D7\\u10D0\\u10E0\\u10D8\\u10E6\\u10D8-\\u10D3\\u10E0\\u10DD",date:"\\u10D7\\u10D0\\u10E0\\u10D8\\u10E6\\u10D8",time:"\\u10D3\\u10E0\\u10DD",duration:"\\u10EE\\u10D0\\u10DC\\u10D2\\u10E0\\u10EB\\u10DA\\u10D8\\u10D5\\u10DD\\u10D1\\u10D0",ipv4:"IPv4 \\u10DB\\u10D8\\u10E1\\u10D0\\u10DB\\u10D0\\u10E0\\u10D7\\u10D8",ipv6:"IPv6 \\u10DB\\u10D8\\u10E1\\u10D0\\u10DB\\u10D0\\u10E0\\u10D7\\u10D8",cidrv4:"IPv4 \\u10D3\\u10D8\\u10D0\\u10DE\\u10D0\\u10D6\\u10DD\\u10DC\\u10D8",cidrv6:"IPv6 \\u10D3\\u10D8\\u10D0\\u10DE\\u10D0\\u10D6\\u10DD\\u10DC\\u10D8",base64:"base64-\\u10D9\\u10DD\\u10D3\\u10D8\\u10E0\\u10D4\\u10D1\\u10E3\\u10DA\\u10D8 \\u10E1\\u10E2\\u10E0\\u10D8\\u10DC\\u10D2\\u10D8",base64url:"base64url-\\u10D9\\u10DD\\u10D3\\u10D8\\u10E0\\u10D4\\u10D1\\u10E3\\u10DA\\u10D8 \\u10E1\\u10E2\\u10E0\\u10D8\\u10DC\\u10D2\\u10D8",json_string:"JSON \\u10E1\\u10E2\\u10E0\\u10D8\\u10DC\\u10D2\\u10D8",e164:"E.164 \\u10DC\\u10DD\\u10DB\\u10D4\\u10E0\\u10D8",jwt:"JWT",template_literal:"\\u10E8\\u10D4\\u10E7\\u10D5\\u10D0\\u10DC\\u10D0"};return i=>{var t,o,u;switch(i.code){case"invalid_type":return"\\u10D0\\u10E0\\u10D0\\u10E1\\u10EC\\u10DD\\u10E0\\u10D8 \\u10E8\\u10D4\\u10E7\\u10D5\\u10D0\\u10DC\\u10D0: \\u10DB\\u10DD\\u10E1\\u10D0\\u10DA\\u10DD\\u10D3\\u10DC\\u10D4\\u10DA\\u10D8 ".concat(i.expected,", \\u10DB\\u10D8\\u10E6\\u10D4\\u10D1\\u10E3\\u10DA\\u10D8 ").concat(Xs(i.input));case"invalid_value":return i.values.length===1?"\\u10D0\\u10E0\\u10D0\\u10E1\\u10EC\\u10DD\\u10E0\\u10D8 \\u10E8\\u10D4\\u10E7\\u10D5\\u10D0\\u10DC\\u10D0: \\u10DB\\u10DD\\u10E1\\u10D0\\u10DA\\u10DD\\u10D3\\u10DC\\u10D4\\u10DA\\u10D8 ".concat(b(i.values[0])):"\\u10D0\\u10E0\\u10D0\\u10E1\\u10EC\\u10DD\\u10E0\\u10D8 \\u10D5\\u10D0\\u10E0\\u10D8\\u10D0\\u10DC\\u10E2\\u10D8: \\u10DB\\u10DD\\u10E1\\u10D0\\u10DA\\u10DD\\u10D3\\u10DC\\u10D4\\u10DA\\u10D8\\u10D0 \\u10D4\\u10E0\\u10D7-\\u10D4\\u10E0\\u10D7\\u10D8 ".concat(p(i.values,"|"),"-\\u10D3\\u10D0\\u10DC");case"too_big":{let l=i.inclusive?"<=":"<",c=r(i.origin);return c?"\\u10D6\\u10D4\\u10D3\\u10DB\\u10D4\\u10E2\\u10D0\\u10D3 \\u10D3\\u10D8\\u10D3\\u10D8: \\u10DB\\u10DD\\u10E1\\u10D0\\u10DA\\u10DD\\u10D3\\u10DC\\u10D4\\u10DA\\u10D8 ".concat((t=i.origin)!=null?t:"\\u10DB\\u10DC\\u10D8\\u10E8\\u10D5\\u10DC\\u10D4\\u10DA\\u10DD\\u10D1\\u10D0"," ").concat(c.verb," ").concat(l).concat(i.maximum.toString()," ").concat(c.unit):"\\u10D6\\u10D4\\u10D3\\u10DB\\u10D4\\u10E2\\u10D0\\u10D3 \\u10D3\\u10D8\\u10D3\\u10D8: \\u10DB\\u10DD\\u10E1\\u10D0\\u10DA\\u10DD\\u10D3\\u10DC\\u10D4\\u10DA\\u10D8 ".concat((o=i.origin)!=null?o:"\\u10DB\\u10DC\\u10D8\\u10E8\\u10D5\\u10DC\\u10D4\\u10DA\\u10DD\\u10D1\\u10D0"," \\u10D8\\u10E7\\u10DD\\u10E1 ").concat(l).concat(i.maximum.toString())}case"too_small":{let l=i.inclusive?">=":">",c=r(i.origin);return c?"\\u10D6\\u10D4\\u10D3\\u10DB\\u10D4\\u10E2\\u10D0\\u10D3 \\u10DE\\u10D0\\u10E2\\u10D0\\u10E0\\u10D0: \\u10DB\\u10DD\\u10E1\\u10D0\\u10DA\\u10DD\\u10D3\\u10DC\\u10D4\\u10DA\\u10D8 ".concat(i.origin," ").concat(c.verb," ").concat(l).concat(i.minimum.toString()," ").concat(c.unit):"\\u10D6\\u10D4\\u10D3\\u10DB\\u10D4\\u10E2\\u10D0\\u10D3 \\u10DE\\u10D0\\u10E2\\u10D0\\u10E0\\u10D0: \\u10DB\\u10DD\\u10E1\\u10D0\\u10DA\\u10DD\\u10D3\\u10DC\\u10D4\\u10DA\\u10D8 ".concat(i.origin," \\u10D8\\u10E7\\u10DD\\u10E1 ").concat(l).concat(i.minimum.toString())}case"invalid_format":{let l=i;return l.format==="starts_with"?'\\u10D0\\u10E0\\u10D0\\u10E1\\u10EC\\u10DD\\u10E0\\u10D8 \\u10E1\\u10E2\\u10E0\\u10D8\\u10DC\\u10D2\\u10D8: \\u10E3\\u10DC\\u10D3\\u10D0 \\u10D8\\u10EC\\u10E7\\u10D4\\u10D1\\u10DD\\u10D3\\u10D4\\u10E1 "'.concat(l.prefix,'"-\\u10D8\\u10D7'):l.format==="ends_with"?'\\u10D0\\u10E0\\u10D0\\u10E1\\u10EC\\u10DD\\u10E0\\u10D8 \\u10E1\\u10E2\\u10E0\\u10D8\\u10DC\\u10D2\\u10D8: \\u10E3\\u10DC\\u10D3\\u10D0 \\u10DB\\u10D7\\u10D0\\u10D5\\u10E0\\u10D3\\u10D4\\u10D1\\u10DD\\u10D3\\u10D4\\u10E1 "'.concat(l.suffix,'"-\\u10D8\\u10D7'):l.format==="includes"?'\\u10D0\\u10E0\\u10D0\\u10E1\\u10EC\\u10DD\\u10E0\\u10D8 \\u10E1\\u10E2\\u10E0\\u10D8\\u10DC\\u10D2\\u10D8: \\u10E3\\u10DC\\u10D3\\u10D0 \\u10E8\\u10D4\\u10D8\\u10EA\\u10D0\\u10D5\\u10D3\\u10D4\\u10E1 "'.concat(l.includes,'"-\\u10E1'):l.format==="regex"?"\\u10D0\\u10E0\\u10D0\\u10E1\\u10EC\\u10DD\\u10E0\\u10D8 \\u10E1\\u10E2\\u10E0\\u10D8\\u10DC\\u10D2\\u10D8: \\u10E3\\u10DC\\u10D3\\u10D0 \\u10E8\\u10D4\\u10D4\\u10E1\\u10D0\\u10D1\\u10D0\\u10DB\\u10D4\\u10D1\\u10DD\\u10D3\\u10D4\\u10E1 \\u10E8\\u10D0\\u10D1\\u10DA\\u10DD\\u10DC\\u10E1 ".concat(l.pattern):"\\u10D0\\u10E0\\u10D0\\u10E1\\u10EC\\u10DD\\u10E0\\u10D8 ".concat((u=n[l.format])!=null?u:i.format)}case"not_multiple_of":return"\\u10D0\\u10E0\\u10D0\\u10E1\\u10EC\\u10DD\\u10E0\\u10D8 \\u10E0\\u10D8\\u10EA\\u10EE\\u10D5\\u10D8: \\u10E3\\u10DC\\u10D3\\u10D0 \\u10D8\\u10E7\\u10DD\\u10E1 ".concat(i.divisor,"-\\u10D8\\u10E1 \\u10EF\\u10D4\\u10E0\\u10D0\\u10D3\\u10D8");case"unrecognized_keys":return"\\u10E3\\u10EA\\u10DC\\u10DD\\u10D1\\u10D8 \\u10D2\\u10D0\\u10E1\\u10D0\\u10E6\\u10D4\\u10D1".concat(i.keys.length>1?"\\u10D4\\u10D1\\u10D8":"\\u10D8",": ").concat(p(i.keys,", "));case"invalid_key":return"\\u10D0\\u10E0\\u10D0\\u10E1\\u10EC\\u10DD\\u10E0\\u10D8 \\u10D2\\u10D0\\u10E1\\u10D0\\u10E6\\u10D4\\u10D1\\u10D8 ".concat(i.origin,"-\\u10E8\\u10D8");case"invalid_union":return"\\u10D0\\u10E0\\u10D0\\u10E1\\u10EC\\u10DD\\u10E0\\u10D8 \\u10E8\\u10D4\\u10E7\\u10D5\\u10D0\\u10DC\\u10D0";case"invalid_element":return"\\u10D0\\u10E0\\u10D0\\u10E1\\u10EC\\u10DD\\u10E0\\u10D8 \\u10DB\\u10DC\\u10D8\\u10E8\\u10D5\\u10DC\\u10D4\\u10DA\\u10DD\\u10D1\\u10D0 ".concat(i.origin,"-\\u10E8\\u10D8");default:return"\\u10D0\\u10E0\\u10D0\\u10E1\\u10EC\\u10DD\\u10E0\\u10D8 \\u10E8\\u10D4\\u10E7\\u10D5\\u10D0\\u10DC\\u10D0"}}};function Wu(){return{localeError:qs()}}var Ys=()=>{let e={string:{unit:"\\u178F\\u17BD\\u17A2\\u1780\\u17D2\\u179F\\u179A",verb:"\\u1782\\u17BD\\u179A\\u1798\\u17B6\\u1793"},file:{unit:"\\u1794\\u17C3",verb:"\\u1782\\u17BD\\u179A\\u1798\\u17B6\\u1793"},array:{unit:"\\u1792\\u17B6\\u178F\\u17BB",verb:"\\u1782\\u17BD\\u179A\\u1798\\u17B6\\u1793"},set:{unit:"\\u1792\\u17B6\\u178F\\u17BB",verb:"\\u1782\\u17BD\\u179A\\u1798\\u17B6\\u1793"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"\\u1798\\u17B7\\u1793\\u1798\\u17C2\\u1793\\u1787\\u17B6\\u179B\\u17C1\\u1781 (NaN)":"\\u179B\\u17C1\\u1781";case"object":{if(Array.isArray(t))return"\\u17A2\\u17B6\\u179A\\u17C1 (Array)";if(t===null)return"\\u1782\\u17D2\\u1798\\u17B6\\u1793\\u178F\\u1798\\u17D2\\u179B\\u17C3 (null)";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"\\u1791\\u17B7\\u1793\\u17D2\\u1793\\u1793\\u17D0\\u1799\\u1794\\u1789\\u17D2\\u1785\\u17BC\\u179B",email:"\\u17A2\\u17B6\\u179F\\u1799\\u178A\\u17D2\\u178B\\u17B6\\u1793\\u17A2\\u17CA\\u17B8\\u1798\\u17C2\\u179B",url:"URL",emoji:"\\u179F\\u1789\\u17D2\\u1789\\u17B6\\u17A2\\u17B6\\u179A\\u1798\\u17D2\\u1798\\u178E\\u17CD",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"\\u1780\\u17B6\\u179B\\u1794\\u179A\\u17B7\\u1785\\u17D2\\u1786\\u17C1\\u1791 \\u1793\\u17B7\\u1784\\u1798\\u17C9\\u17C4\\u1784 ISO",date:"\\u1780\\u17B6\\u179B\\u1794\\u179A\\u17B7\\u1785\\u17D2\\u1786\\u17C1\\u1791 ISO",time:"\\u1798\\u17C9\\u17C4\\u1784 ISO",duration:"\\u179A\\u1799\\u17C8\\u1796\\u17C1\\u179B ISO",ipv4:"\\u17A2\\u17B6\\u179F\\u1799\\u178A\\u17D2\\u178B\\u17B6\\u1793 IPv4",ipv6:"\\u17A2\\u17B6\\u179F\\u1799\\u178A\\u17D2\\u178B\\u17B6\\u1793 IPv6",cidrv4:"\\u178A\\u17C2\\u1793\\u17A2\\u17B6\\u179F\\u1799\\u178A\\u17D2\\u178B\\u17B6\\u1793 IPv4",cidrv6:"\\u178A\\u17C2\\u1793\\u17A2\\u17B6\\u179F\\u1799\\u178A\\u17D2\\u178B\\u17B6\\u1793 IPv6",base64:"\\u1781\\u17D2\\u179F\\u17C2\\u17A2\\u1780\\u17D2\\u179F\\u179A\\u17A2\\u17CA\\u17B7\\u1780\\u17BC\\u178A base64",base64url:"\\u1781\\u17D2\\u179F\\u17C2\\u17A2\\u1780\\u17D2\\u179F\\u179A\\u17A2\\u17CA\\u17B7\\u1780\\u17BC\\u178A base64url",json_string:"\\u1781\\u17D2\\u179F\\u17C2\\u17A2\\u1780\\u17D2\\u179F\\u179A JSON",e164:"\\u179B\\u17C1\\u1781 E.164",jwt:"JWT",template_literal:"\\u1791\\u17B7\\u1793\\u17D2\\u1793\\u1793\\u17D0\\u1799\\u1794\\u1789\\u17D2\\u1785\\u17BC\\u179B"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"\\u1791\\u17B7\\u1793\\u17D2\\u1793\\u1793\\u17D0\\u1799\\u1794\\u1789\\u17D2\\u1785\\u17BC\\u179B\\u1798\\u17B7\\u1793\\u178F\\u17D2\\u179A\\u17B9\\u1798\\u178F\\u17D2\\u179A\\u17BC\\u179C\\u17D6 \\u178F\\u17D2\\u179A\\u17BC\\u179C\\u1780\\u17B6\\u179A ".concat(t.expected," \\u1794\\u17C9\\u17BB\\u1793\\u17D2\\u178F\\u17C2\\u1791\\u1791\\u17BD\\u179B\\u1794\\u17B6\\u1793 ").concat(n(t.input));case"invalid_value":return t.values.length===1?"\\u1791\\u17B7\\u1793\\u17D2\\u1793\\u1793\\u17D0\\u1799\\u1794\\u1789\\u17D2\\u1785\\u17BC\\u179B\\u1798\\u17B7\\u1793\\u178F\\u17D2\\u179A\\u17B9\\u1798\\u178F\\u17D2\\u179A\\u17BC\\u179C\\u17D6 \\u178F\\u17D2\\u179A\\u17BC\\u179C\\u1780\\u17B6\\u179A ".concat(b(t.values[0])):"\\u1787\\u1798\\u17D2\\u179A\\u17BE\\u179F\\u1798\\u17B7\\u1793\\u178F\\u17D2\\u179A\\u17B9\\u1798\\u178F\\u17D2\\u179A\\u17BC\\u179C\\u17D6 \\u178F\\u17D2\\u179A\\u17BC\\u179C\\u1787\\u17B6\\u1798\\u17BD\\u1799\\u1780\\u17D2\\u1793\\u17BB\\u1784\\u1785\\u17C6\\u178E\\u17C4\\u1798 ".concat(p(t.values,"|"));case"too_big":{let a=t.inclusive?"<=":"<",s=r(t.origin);return s?"\\u1792\\u17C6\\u1796\\u17C1\\u1780\\u17D6 \\u178F\\u17D2\\u179A\\u17BC\\u179C\\u1780\\u17B6\\u179A ".concat((o=t.origin)!=null?o:"\\u178F\\u1798\\u17D2\\u179B\\u17C3"," ").concat(a," ").concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"\\u1792\\u17B6\\u178F\\u17BB"):"\\u1792\\u17C6\\u1796\\u17C1\\u1780\\u17D6 \\u178F\\u17D2\\u179A\\u17BC\\u179C\\u1780\\u17B6\\u179A ".concat((l=t.origin)!=null?l:"\\u178F\\u1798\\u17D2\\u179B\\u17C3"," ").concat(a," ").concat(t.maximum.toString())}case"too_small":{let a=t.inclusive?">=":">",s=r(t.origin);return s?"\\u178F\\u17BC\\u1785\\u1796\\u17C1\\u1780\\u17D6 \\u178F\\u17D2\\u179A\\u17BC\\u179C\\u1780\\u17B6\\u179A ".concat(t.origin," ").concat(a," ").concat(t.minimum.toString()," ").concat(s.unit):"\\u178F\\u17BC\\u1785\\u1796\\u17C1\\u1780\\u17D6 \\u178F\\u17D2\\u179A\\u17BC\\u179C\\u1780\\u17B6\\u179A ".concat(t.origin," ").concat(a," ").concat(t.minimum.toString())}case"invalid_format":{let a=t;return a.format==="starts_with"?'\\u1781\\u17D2\\u179F\\u17C2\\u17A2\\u1780\\u17D2\\u179F\\u179A\\u1798\\u17B7\\u1793\\u178F\\u17D2\\u179A\\u17B9\\u1798\\u178F\\u17D2\\u179A\\u17BC\\u179C\\u17D6 \\u178F\\u17D2\\u179A\\u17BC\\u179C\\u1785\\u17B6\\u1794\\u17CB\\u1795\\u17D2\\u178F\\u17BE\\u1798\\u178A\\u17C4\\u1799 "'.concat(a.prefix,'"'):a.format==="ends_with"?'\\u1781\\u17D2\\u179F\\u17C2\\u17A2\\u1780\\u17D2\\u179F\\u179A\\u1798\\u17B7\\u1793\\u178F\\u17D2\\u179A\\u17B9\\u1798\\u178F\\u17D2\\u179A\\u17BC\\u179C\\u17D6 \\u178F\\u17D2\\u179A\\u17BC\\u179C\\u1794\\u1789\\u17D2\\u1785\\u1794\\u17CB\\u178A\\u17C4\\u1799 "'.concat(a.suffix,'"'):a.format==="includes"?'\\u1781\\u17D2\\u179F\\u17C2\\u17A2\\u1780\\u17D2\\u179F\\u179A\\u1798\\u17B7\\u1793\\u178F\\u17D2\\u179A\\u17B9\\u1798\\u178F\\u17D2\\u179A\\u17BC\\u179C\\u17D6 \\u178F\\u17D2\\u179A\\u17BC\\u179C\\u1798\\u17B6\\u1793 "'.concat(a.includes,'"'):a.format==="regex"?"\\u1781\\u17D2\\u179F\\u17C2\\u17A2\\u1780\\u17D2\\u179F\\u179A\\u1798\\u17B7\\u1793\\u178F\\u17D2\\u179A\\u17B9\\u1798\\u178F\\u17D2\\u179A\\u17BC\\u179C\\u17D6 \\u178F\\u17D2\\u179A\\u17BC\\u179C\\u178F\\u17C2\\u1795\\u17D2\\u1782\\u17BC\\u1795\\u17D2\\u1782\\u1784\\u1793\\u17B9\\u1784\\u1791\\u1798\\u17D2\\u179A\\u1784\\u17CB\\u178A\\u17C2\\u179B\\u1794\\u17B6\\u1793\\u1780\\u17C6\\u178E\\u178F\\u17CB ".concat(a.pattern):"\\u1798\\u17B7\\u1793\\u178F\\u17D2\\u179A\\u17B9\\u1798\\u178F\\u17D2\\u179A\\u17BC\\u179C\\u17D6 ".concat((c=i[a.format])!=null?c:t.format)}case"not_multiple_of":return"\\u179B\\u17C1\\u1781\\u1798\\u17B7\\u1793\\u178F\\u17D2\\u179A\\u17B9\\u1798\\u178F\\u17D2\\u179A\\u17BC\\u179C\\u17D6 \\u178F\\u17D2\\u179A\\u17BC\\u179C\\u178F\\u17C2\\u1787\\u17B6\\u1796\\u17A0\\u17BB\\u1782\\u17BB\\u178E\\u1793\\u17C3 ".concat(t.divisor);case"unrecognized_keys":return"\\u179A\\u1780\\u1783\\u17BE\\u1789\\u179F\\u17C4\\u1798\\u17B7\\u1793\\u179F\\u17D2\\u1782\\u17B6\\u179B\\u17CB\\u17D6 ".concat(p(t.keys,", "));case"invalid_key":return"\\u179F\\u17C4\\u1798\\u17B7\\u1793\\u178F\\u17D2\\u179A\\u17B9\\u1798\\u178F\\u17D2\\u179A\\u17BC\\u179C\\u1793\\u17C5\\u1780\\u17D2\\u1793\\u17BB\\u1784 ".concat(t.origin);case"invalid_union":return"\\u1791\\u17B7\\u1793\\u17D2\\u1793\\u1793\\u17D0\\u1799\\u1798\\u17B7\\u1793\\u178F\\u17D2\\u179A\\u17B9\\u1798\\u178F\\u17D2\\u179A\\u17BC\\u179C";case"invalid_element":return"\\u1791\\u17B7\\u1793\\u17D2\\u1793\\u1793\\u17D0\\u1799\\u1798\\u17B7\\u1793\\u178F\\u17D2\\u179A\\u17B9\\u1798\\u178F\\u17D2\\u179A\\u17BC\\u179C\\u1793\\u17C5\\u1780\\u17D2\\u1793\\u17BB\\u1784 ".concat(t.origin);default:return"\\u1791\\u17B7\\u1793\\u17D2\\u1793\\u1793\\u17D0\\u1799\\u1798\\u17B7\\u1793\\u178F\\u17D2\\u179A\\u17B9\\u1798\\u178F\\u17D2\\u179A\\u17BC\\u179C"}}};function rr(){return{localeError:Ys()}}function Xu(){return rr()}var Qs=()=>{let e={string:{unit:"\\uBB38\\uC790",verb:"to have"},file:{unit:"\\uBC14\\uC774\\uD2B8",verb:"to have"},array:{unit:"\\uAC1C",verb:"to have"},set:{unit:"\\uAC1C",verb:"to have"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"number";case"object":{if(Array.isArray(t))return"array";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"\\uC785\\uB825",email:"\\uC774\\uBA54\\uC77C \\uC8FC\\uC18C",url:"URL",emoji:"\\uC774\\uBAA8\\uC9C0",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO \\uB0A0\\uC9DC\\uC2DC\\uAC04",date:"ISO \\uB0A0\\uC9DC",time:"ISO \\uC2DC\\uAC04",duration:"ISO \\uAE30\\uAC04",ipv4:"IPv4 \\uC8FC\\uC18C",ipv6:"IPv6 \\uC8FC\\uC18C",cidrv4:"IPv4 \\uBC94\\uC704",cidrv6:"IPv6 \\uBC94\\uC704",base64:"base64 \\uC778\\uCF54\\uB529 \\uBB38\\uC790\\uC5F4",base64url:"base64url \\uC778\\uCF54\\uB529 \\uBB38\\uC790\\uC5F4",json_string:"JSON \\uBB38\\uC790\\uC5F4",e164:"E.164 \\uBC88\\uD638",jwt:"JWT",template_literal:"\\uC785\\uB825"};return t=>{var o,u,l,c,a,s,v;switch(t.code){case"invalid_type":return"\\uC798\\uBABB\\uB41C \\uC785\\uB825: \\uC608\\uC0C1 \\uD0C0\\uC785\\uC740 ".concat(t.expected,", \\uBC1B\\uC740 \\uD0C0\\uC785\\uC740 ").concat(n(t.input),"\\uC785\\uB2C8\\uB2E4");case"invalid_value":return t.values.length===1?"\\uC798\\uBABB\\uB41C \\uC785\\uB825: \\uAC12\\uC740 ".concat(b(t.values[0])," \\uC774\\uC5B4\\uC57C \\uD569\\uB2C8\\uB2E4"):"\\uC798\\uBABB\\uB41C \\uC635\\uC158: ".concat(p(t.values,"\\uB610\\uB294 ")," \\uC911 \\uD558\\uB098\\uC5EC\\uC57C \\uD569\\uB2C8\\uB2E4");case"too_big":{let f=t.inclusive?"\\uC774\\uD558":"\\uBBF8\\uB9CC",h=f==="\\uBBF8\\uB9CC"?"\\uC774\\uC5B4\\uC57C \\uD569\\uB2C8\\uB2E4":"\\uC5EC\\uC57C \\uD569\\uB2C8\\uB2E4",x=r(t.origin),S=(o=x==null?void 0:x.unit)!=null?o:"\\uC694\\uC18C";return x?"".concat((u=t.origin)!=null?u:"\\uAC12","\\uC774 \\uB108\\uBB34 \\uD07D\\uB2C8\\uB2E4: ").concat(t.maximum.toString()).concat(S," ").concat(f).concat(h):"".concat((l=t.origin)!=null?l:"\\uAC12","\\uC774 \\uB108\\uBB34 \\uD07D\\uB2C8\\uB2E4: ").concat(t.maximum.toString()," ").concat(f).concat(h)}case"too_small":{let f=t.inclusive?"\\uC774\\uC0C1":"\\uCD08\\uACFC",h=f==="\\uC774\\uC0C1"?"\\uC774\\uC5B4\\uC57C \\uD569\\uB2C8\\uB2E4":"\\uC5EC\\uC57C \\uD569\\uB2C8\\uB2E4",x=r(t.origin),S=(c=x==null?void 0:x.unit)!=null?c:"\\uC694\\uC18C";return x?"".concat((a=t.origin)!=null?a:"\\uAC12","\\uC774 \\uB108\\uBB34 \\uC791\\uC2B5\\uB2C8\\uB2E4: ").concat(t.minimum.toString()).concat(S," ").concat(f).concat(h):"".concat((s=t.origin)!=null?s:"\\uAC12","\\uC774 \\uB108\\uBB34 \\uC791\\uC2B5\\uB2C8\\uB2E4: ").concat(t.minimum.toString()," ").concat(f).concat(h)}case"invalid_format":{let f=t;return f.format==="starts_with"?'\\uC798\\uBABB\\uB41C \\uBB38\\uC790\\uC5F4: "'.concat(f.prefix,'"(\\uC73C)\\uB85C \\uC2DC\\uC791\\uD574\\uC57C \\uD569\\uB2C8\\uB2E4'):f.format==="ends_with"?'\\uC798\\uBABB\\uB41C \\uBB38\\uC790\\uC5F4: "'.concat(f.suffix,'"(\\uC73C)\\uB85C \\uB05D\\uB098\\uC57C \\uD569\\uB2C8\\uB2E4'):f.format==="includes"?'\\uC798\\uBABB\\uB41C \\uBB38\\uC790\\uC5F4: "'.concat(f.includes,'"\\uC744(\\uB97C) \\uD3EC\\uD568\\uD574\\uC57C \\uD569\\uB2C8\\uB2E4'):f.format==="regex"?"\\uC798\\uBABB\\uB41C \\uBB38\\uC790\\uC5F4: \\uC815\\uADDC\\uC2DD ".concat(f.pattern," \\uD328\\uD134\\uACFC \\uC77C\\uCE58\\uD574\\uC57C \\uD569\\uB2C8\\uB2E4"):"\\uC798\\uBABB\\uB41C ".concat((v=i[f.format])!=null?v:t.format)}case"not_multiple_of":return"\\uC798\\uBABB\\uB41C \\uC22B\\uC790: ".concat(t.divisor,"\\uC758 \\uBC30\\uC218\\uC5EC\\uC57C \\uD569\\uB2C8\\uB2E4");case"unrecognized_keys":return"\\uC778\\uC2DD\\uD560 \\uC218 \\uC5C6\\uB294 \\uD0A4: ".concat(p(t.keys,", "));case"invalid_key":return"\\uC798\\uBABB\\uB41C \\uD0A4: ".concat(t.origin);case"invalid_union":return"\\uC798\\uBABB\\uB41C \\uC785\\uB825";case"invalid_element":return"\\uC798\\uBABB\\uB41C \\uAC12: ".concat(t.origin);default:return"\\uC798\\uBABB\\uB41C \\uC785\\uB825"}}};function qu(){return{localeError:Qs()}}var Hs=e=>ut(typeof e,e),ut=(e,r=void 0)=>{switch(e){case"number":return Number.isNaN(r)?"NaN":"skai\\u010Dius";case"bigint":return"sveikasis skai\\u010Dius";case"string":return"eilut\\u0117";case"boolean":return"login\\u0117 reik\\u0161m\\u0117";case"undefined":case"void":return"neapibr\\u0117\\u017Eta reik\\u0161m\\u0117";case"function":return"funkcija";case"symbol":return"simbolis";case"object":return r===void 0?"ne\\u017Einomas objektas":r===null?"nulin\\u0117 reik\\u0161m\\u0117":Array.isArray(r)?"masyvas":Object.getPrototypeOf(r)!==Object.prototype&&r.constructor?r.constructor.name:"objektas";case"null":return"nulin\\u0117 reik\\u0161m\\u0117"}return e},at=e=>e.charAt(0).toUpperCase()+e.slice(1);function Yu(e){let r=Math.abs(e),n=r%10,i=r%100;return i>=11&&i<=19||n===0?"many":n===1?"one":"few"}var ed=()=>{let e={string:{unit:{one:"simbolis",few:"simboliai",many:"simboli\\u0173"},verb:{smaller:{inclusive:"turi b\\u016Bti ne ilgesn\\u0117 kaip",notInclusive:"turi b\\u016Bti trumpesn\\u0117 kaip"},bigger:{inclusive:"turi b\\u016Bti ne trumpesn\\u0117 kaip",notInclusive:"turi b\\u016Bti ilgesn\\u0117 kaip"}}},file:{unit:{one:"baitas",few:"baitai",many:"bait\\u0173"},verb:{smaller:{inclusive:"turi b\\u016Bti ne didesnis kaip",notInclusive:"turi b\\u016Bti ma\\u017Eesnis kaip"},bigger:{inclusive:"turi b\\u016Bti ne ma\\u017Eesnis kaip",notInclusive:"turi b\\u016Bti didesnis kaip"}}},array:{unit:{one:"element\\u0105",few:"elementus",many:"element\\u0173"},verb:{smaller:{inclusive:"turi tur\\u0117ti ne daugiau kaip",notInclusive:"turi tur\\u0117ti ma\\u017Eiau kaip"},bigger:{inclusive:"turi tur\\u0117ti ne ma\\u017Eiau kaip",notInclusive:"turi tur\\u0117ti daugiau kaip"}}},set:{unit:{one:"element\\u0105",few:"elementus",many:"element\\u0173"},verb:{smaller:{inclusive:"turi tur\\u0117ti ne daugiau kaip",notInclusive:"turi tur\\u0117ti ma\\u017Eiau kaip"},bigger:{inclusive:"turi tur\\u0117ti ne ma\\u017Eiau kaip",notInclusive:"turi tur\\u0117ti daugiau kaip"}}}};function r(i,t,o,u){var c;let l=(c=e[i])!=null?c:null;return l===null?l:{unit:l.unit[t],verb:l.verb[u][o?"inclusive":"notInclusive"]}}let n={regex:"\\u012Fvestis",email:"el. pa\\u0161to adresas",url:"URL",emoji:"jaustukas",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO data ir laikas",date:"ISO data",time:"ISO laikas",duration:"ISO trukm\\u0117",ipv4:"IPv4 adresas",ipv6:"IPv6 adresas",cidrv4:"IPv4 tinklo prefiksas (CIDR)",cidrv6:"IPv6 tinklo prefiksas (CIDR)",base64:"base64 u\\u017Ekoduota eilut\\u0117",base64url:"base64url u\\u017Ekoduota eilut\\u0117",json_string:"JSON eilut\\u0117",e164:"E.164 numeris",jwt:"JWT",template_literal:"\\u012Fvestis"};return i=>{var t,o,u,l,c,a,s,v,f,h;switch(i.code){case"invalid_type":return"Gautas tipas ".concat(Hs(i.input),", o tik\\u0117tasi - ").concat(ut(i.expected));case"invalid_value":return i.values.length===1?"Privalo b\\u016Bti ".concat(b(i.values[0])):"Privalo b\\u016Bti vienas i\\u0161 ".concat(p(i.values,"|")," pasirinkim\\u0173");case"too_big":{let x=ut(i.origin),S=r(i.origin,Yu(Number(i.maximum)),(t=i.inclusive)!=null?t:!1,"smaller");if(S!=null&&S.verb)return"".concat(at((o=x!=null?x:i.origin)!=null?o:"reik\\u0161m\\u0117")," ").concat(S.verb," ").concat(i.maximum.toString()," ").concat((u=S.unit)!=null?u:"element\\u0173");let I=i.inclusive?"ne didesnis kaip":"ma\\u017Eesnis kaip";return"".concat(at((l=x!=null?x:i.origin)!=null?l:"reik\\u0161m\\u0117")," turi b\\u016Bti ").concat(I," ").concat(i.maximum.toString()," ").concat(S==null?void 0:S.unit)}case"too_small":{let x=ut(i.origin),S=r(i.origin,Yu(Number(i.minimum)),(c=i.inclusive)!=null?c:!1,"bigger");if(S!=null&&S.verb)return"".concat(at((a=x!=null?x:i.origin)!=null?a:"reik\\u0161m\\u0117")," ").concat(S.verb," ").concat(i.minimum.toString()," ").concat((s=S.unit)!=null?s:"element\\u0173");let I=i.inclusive?"ne ma\\u017Eesnis kaip":"didesnis kaip";return"".concat(at((v=x!=null?x:i.origin)!=null?v:"reik\\u0161m\\u0117")," turi b\\u016Bti ").concat(I," ").concat(i.minimum.toString()," ").concat(S==null?void 0:S.unit)}case"invalid_format":{let x=i;return x.format==="starts_with"?'Eilut\\u0117 privalo prasid\\u0117ti "'.concat(x.prefix,'"'):x.format==="ends_with"?'Eilut\\u0117 privalo pasibaigti "'.concat(x.suffix,'"'):x.format==="includes"?'Eilut\\u0117 privalo \\u012Ftraukti "'.concat(x.includes,'"'):x.format==="regex"?"Eilut\\u0117 privalo atitikti ".concat(x.pattern):"Neteisingas ".concat((f=n[x.format])!=null?f:i.format)}case"not_multiple_of":return"Skai\\u010Dius privalo b\\u016Bti ".concat(i.divisor," kartotinis.");case"unrecognized_keys":return"Neatpa\\u017Eint".concat(i.keys.length>1?"i":"as"," rakt").concat(i.keys.length>1?"ai":"as",": ").concat(p(i.keys,", "));case"invalid_key":return"Rastas klaidingas raktas";case"invalid_union":return"Klaidinga \\u012Fvestis";case"invalid_element":{let x=ut(i.origin);return"".concat(at((h=x!=null?x:i.origin)!=null?h:"reik\\u0161m\\u0117")," turi klaiding\\u0105 \\u012Fvest\\u012F")}default:return"Klaidinga \\u012Fvestis"}}};function Qu(){return{localeError:ed()}}var td=()=>{let e={string:{unit:"\\u0437\\u043D\\u0430\\u0446\\u0438",verb:"\\u0434\\u0430 \\u0438\\u043C\\u0430\\u0430\\u0442"},file:{unit:"\\u0431\\u0430\\u0458\\u0442\\u0438",verb:"\\u0434\\u0430 \\u0438\\u043C\\u0430\\u0430\\u0442"},array:{unit:"\\u0441\\u0442\\u0430\\u0432\\u043A\\u0438",verb:"\\u0434\\u0430 \\u0438\\u043C\\u0430\\u0430\\u0442"},set:{unit:"\\u0441\\u0442\\u0430\\u0432\\u043A\\u0438",verb:"\\u0434\\u0430 \\u0438\\u043C\\u0430\\u0430\\u0442"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"\\u0431\\u0440\\u043E\\u0458";case"object":{if(Array.isArray(t))return"\\u043D\\u0438\\u0437\\u0430";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"\\u0432\\u043D\\u0435\\u0441",email:"\\u0430\\u0434\\u0440\\u0435\\u0441\\u0430 \\u043D\\u0430 \\u0435-\\u043F\\u043E\\u0448\\u0442\\u0430",url:"URL",emoji:"\\u0435\\u043C\\u043E\\u045F\\u0438",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO \\u0434\\u0430\\u0442\\u0443\\u043C \\u0438 \\u0432\\u0440\\u0435\\u043C\\u0435",date:"ISO \\u0434\\u0430\\u0442\\u0443\\u043C",time:"ISO \\u0432\\u0440\\u0435\\u043C\\u0435",duration:"ISO \\u0432\\u0440\\u0435\\u043C\\u0435\\u0442\\u0440\\u0430\\u0435\\u045A\\u0435",ipv4:"IPv4 \\u0430\\u0434\\u0440\\u0435\\u0441\\u0430",ipv6:"IPv6 \\u0430\\u0434\\u0440\\u0435\\u0441\\u0430",cidrv4:"IPv4 \\u043E\\u043F\\u0441\\u0435\\u0433",cidrv6:"IPv6 \\u043E\\u043F\\u0441\\u0435\\u0433",base64:"base64-\\u0435\\u043D\\u043A\\u043E\\u0434\\u0438\\u0440\\u0430\\u043D\\u0430 \\u043D\\u0438\\u0437\\u0430",base64url:"base64url-\\u0435\\u043D\\u043A\\u043E\\u0434\\u0438\\u0440\\u0430\\u043D\\u0430 \\u043D\\u0438\\u0437\\u0430",json_string:"JSON \\u043D\\u0438\\u0437\\u0430",e164:"E.164 \\u0431\\u0440\\u043E\\u0458",jwt:"JWT",template_literal:"\\u0432\\u043D\\u0435\\u0441"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"\\u0413\\u0440\\u0435\\u0448\\u0435\\u043D \\u0432\\u043D\\u0435\\u0441: \\u0441\\u0435 \\u043E\\u0447\\u0435\\u043A\\u0443\\u0432\\u0430 ".concat(t.expected,", \\u043F\\u0440\\u0438\\u043C\\u0435\\u043D\\u043E ").concat(n(t.input));case"invalid_value":return t.values.length===1?"Invalid input: expected ".concat(b(t.values[0])):"\\u0413\\u0440\\u0435\\u0448\\u0430\\u043D\\u0430 \\u043E\\u043F\\u0446\\u0438\\u0458\\u0430: \\u0441\\u0435 \\u043E\\u0447\\u0435\\u043A\\u0443\\u0432\\u0430 \\u0435\\u0434\\u043D\\u0430 ".concat(p(t.values,"|"));case"too_big":{let a=t.inclusive?"<=":"<",s=r(t.origin);return s?"\\u041F\\u0440\\u0435\\u043C\\u043D\\u043E\\u0433\\u0443 \\u0433\\u043E\\u043B\\u0435\\u043C: \\u0441\\u0435 \\u043E\\u0447\\u0435\\u043A\\u0443\\u0432\\u0430 ".concat((o=t.origin)!=null?o:"\\u0432\\u0440\\u0435\\u0434\\u043D\\u043E\\u0441\\u0442\\u0430"," \\u0434\\u0430 \\u0438\\u043C\\u0430 ").concat(a).concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"\\u0435\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442\\u0438"):"\\u041F\\u0440\\u0435\\u043C\\u043D\\u043E\\u0433\\u0443 \\u0433\\u043E\\u043B\\u0435\\u043C: \\u0441\\u0435 \\u043E\\u0447\\u0435\\u043A\\u0443\\u0432\\u0430 ".concat((l=t.origin)!=null?l:"\\u0432\\u0440\\u0435\\u0434\\u043D\\u043E\\u0441\\u0442\\u0430"," \\u0434\\u0430 \\u0431\\u0438\\u0434\\u0435 ").concat(a).concat(t.maximum.toString())}case"too_small":{let a=t.inclusive?">=":">",s=r(t.origin);return s?"\\u041F\\u0440\\u0435\\u043C\\u043D\\u043E\\u0433\\u0443 \\u043C\\u0430\\u043B: \\u0441\\u0435 \\u043E\\u0447\\u0435\\u043A\\u0443\\u0432\\u0430 ".concat(t.origin," \\u0434\\u0430 \\u0438\\u043C\\u0430 ").concat(a).concat(t.minimum.toString()," ").concat(s.unit):"\\u041F\\u0440\\u0435\\u043C\\u043D\\u043E\\u0433\\u0443 \\u043C\\u0430\\u043B: \\u0441\\u0435 \\u043E\\u0447\\u0435\\u043A\\u0443\\u0432\\u0430 ".concat(t.origin," \\u0434\\u0430 \\u0431\\u0438\\u0434\\u0435 ").concat(a).concat(t.minimum.toString())}case"invalid_format":{let a=t;return a.format==="starts_with"?'\\u041D\\u0435\\u0432\\u0430\\u0436\\u0435\\u0447\\u043A\\u0430 \\u043D\\u0438\\u0437\\u0430: \\u043C\\u043E\\u0440\\u0430 \\u0434\\u0430 \\u0437\\u0430\\u043F\\u043E\\u0447\\u043D\\u0443\\u0432\\u0430 \\u0441\\u043E "'.concat(a.prefix,'"'):a.format==="ends_with"?'\\u041D\\u0435\\u0432\\u0430\\u0436\\u0435\\u0447\\u043A\\u0430 \\u043D\\u0438\\u0437\\u0430: \\u043C\\u043E\\u0440\\u0430 \\u0434\\u0430 \\u0437\\u0430\\u0432\\u0440\\u0448\\u0443\\u0432\\u0430 \\u0441\\u043E "'.concat(a.suffix,'"'):a.format==="includes"?'\\u041D\\u0435\\u0432\\u0430\\u0436\\u0435\\u0447\\u043A\\u0430 \\u043D\\u0438\\u0437\\u0430: \\u043C\\u043E\\u0440\\u0430 \\u0434\\u0430 \\u0432\\u043A\\u043B\\u0443\\u0447\\u0443\\u0432\\u0430 "'.concat(a.includes,'"'):a.format==="regex"?"\\u041D\\u0435\\u0432\\u0430\\u0436\\u0435\\u0447\\u043A\\u0430 \\u043D\\u0438\\u0437\\u0430: \\u043C\\u043E\\u0440\\u0430 \\u0434\\u0430 \\u043E\\u0434\\u0433\\u043E\\u0430\\u0440\\u0430 \\u043D\\u0430 \\u043F\\u0430\\u0442\\u0435\\u0440\\u043D\\u043E\\u0442 ".concat(a.pattern):"Invalid ".concat((c=i[a.format])!=null?c:t.format)}case"not_multiple_of":return"\\u0413\\u0440\\u0435\\u0448\\u0435\\u043D \\u0431\\u0440\\u043E\\u0458: \\u043C\\u043E\\u0440\\u0430 \\u0434\\u0430 \\u0431\\u0438\\u0434\\u0435 \\u0434\\u0435\\u043B\\u0438\\u0432 \\u0441\\u043E ".concat(t.divisor);case"unrecognized_keys":return"".concat(t.keys.length>1?"\\u041D\\u0435\\u043F\\u0440\\u0435\\u043F\\u043E\\u0437\\u043D\\u0430\\u0435\\u043D\\u0438 \\u043A\\u043B\\u0443\\u0447\\u0435\\u0432\\u0438":"\\u041D\\u0435\\u043F\\u0440\\u0435\\u043F\\u043E\\u0437\\u043D\\u0430\\u0435\\u043D \\u043A\\u043B\\u0443\\u0447",": ").concat(p(t.keys,", "));case"invalid_key":return"\\u0413\\u0440\\u0435\\u0448\\u0435\\u043D \\u043A\\u043B\\u0443\\u0447 \\u0432\\u043E ".concat(t.origin);case"invalid_union":return"\\u0413\\u0440\\u0435\\u0448\\u0435\\u043D \\u0432\\u043D\\u0435\\u0441";case"invalid_element":return"\\u0413\\u0440\\u0435\\u0448\\u043D\\u0430 \\u0432\\u0440\\u0435\\u0434\\u043D\\u043E\\u0441\\u0442 \\u0432\\u043E ".concat(t.origin);default:return"\\u0413\\u0440\\u0435\\u0448\\u0435\\u043D \\u0432\\u043D\\u0435\\u0441"}}};function Hu(){return{localeError:td()}}var rd=()=>{let e={string:{unit:"aksara",verb:"mempunyai"},file:{unit:"bait",verb:"mempunyai"},array:{unit:"elemen",verb:"mempunyai"},set:{unit:"elemen",verb:"mempunyai"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"nombor";case"object":{if(Array.isArray(t))return"array";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"input",email:"alamat e-mel",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"tarikh masa ISO",date:"tarikh ISO",time:"masa ISO",duration:"tempoh ISO",ipv4:"alamat IPv4",ipv6:"alamat IPv6",cidrv4:"julat IPv4",cidrv6:"julat IPv6",base64:"string dikodkan base64",base64url:"string dikodkan base64url",json_string:"string JSON",e164:"nombor E.164",jwt:"JWT",template_literal:"input"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"Input tidak sah: dijangka ".concat(t.expected,", diterima ").concat(n(t.input));case"invalid_value":return t.values.length===1?"Input tidak sah: dijangka ".concat(b(t.values[0])):"Pilihan tidak sah: dijangka salah satu daripada ".concat(p(t.values,"|"));case"too_big":{let a=t.inclusive?"<=":"<",s=r(t.origin);return s?"Terlalu besar: dijangka ".concat((o=t.origin)!=null?o:"nilai"," ").concat(s.verb," ").concat(a).concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"elemen"):"Terlalu besar: dijangka ".concat((l=t.origin)!=null?l:"nilai"," adalah ").concat(a).concat(t.maximum.toString())}case"too_small":{let a=t.inclusive?">=":">",s=r(t.origin);return s?"Terlalu kecil: dijangka ".concat(t.origin," ").concat(s.verb," ").concat(a).concat(t.minimum.toString()," ").concat(s.unit):"Terlalu kecil: dijangka ".concat(t.origin," adalah ").concat(a).concat(t.minimum.toString())}case"invalid_format":{let a=t;return a.format==="starts_with"?'String tidak sah: mesti bermula dengan "'.concat(a.prefix,'"'):a.format==="ends_with"?'String tidak sah: mesti berakhir dengan "'.concat(a.suffix,'"'):a.format==="includes"?'String tidak sah: mesti mengandungi "'.concat(a.includes,'"'):a.format==="regex"?"String tidak sah: mesti sepadan dengan corak ".concat(a.pattern):"".concat((c=i[a.format])!=null?c:t.format," tidak sah")}case"not_multiple_of":return"Nombor tidak sah: perlu gandaan ".concat(t.divisor);case"unrecognized_keys":return"Kunci tidak dikenali: ".concat(p(t.keys,", "));case"invalid_key":return"Kunci tidak sah dalam ".concat(t.origin);case"invalid_union":return"Input tidak sah";case"invalid_element":return"Nilai tidak sah dalam ".concat(t.origin);default:return"Input tidak sah"}}};function ec(){return{localeError:rd()}}var nd=()=>{let e={string:{unit:"tekens"},file:{unit:"bytes"},array:{unit:"elementen"},set:{unit:"elementen"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"getal";case"object":{if(Array.isArray(t))return"array";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"invoer",email:"emailadres",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datum en tijd",date:"ISO datum",time:"ISO tijd",duration:"ISO duur",ipv4:"IPv4-adres",ipv6:"IPv6-adres",cidrv4:"IPv4-bereik",cidrv6:"IPv6-bereik",base64:"base64-gecodeerde tekst",base64url:"base64 URL-gecodeerde tekst",json_string:"JSON string",e164:"E.164-nummer",jwt:"JWT",template_literal:"invoer"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"Ongeldige invoer: verwacht ".concat(t.expected,", ontving ").concat(n(t.input));case"invalid_value":return t.values.length===1?"Ongeldige invoer: verwacht ".concat(b(t.values[0])):"Ongeldige optie: verwacht \\xE9\\xE9n van ".concat(p(t.values,"|"));case"too_big":{let a=t.inclusive?"<=":"<",s=r(t.origin);return s?"Te lang: verwacht dat ".concat((o=t.origin)!=null?o:"waarde"," ").concat(a).concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"elementen"," bevat"):"Te lang: verwacht dat ".concat((l=t.origin)!=null?l:"waarde"," ").concat(a).concat(t.maximum.toString()," is")}case"too_small":{let a=t.inclusive?">=":">",s=r(t.origin);return s?"Te kort: verwacht dat ".concat(t.origin," ").concat(a).concat(t.minimum.toString()," ").concat(s.unit," bevat"):"Te kort: verwacht dat ".concat(t.origin," ").concat(a).concat(t.minimum.toString()," is")}case"invalid_format":{let a=t;return a.format==="starts_with"?'Ongeldige tekst: moet met "'.concat(a.prefix,'" beginnen'):a.format==="ends_with"?'Ongeldige tekst: moet op "'.concat(a.suffix,'" eindigen'):a.format==="includes"?'Ongeldige tekst: moet "'.concat(a.includes,'" bevatten'):a.format==="regex"?"Ongeldige tekst: moet overeenkomen met patroon ".concat(a.pattern):"Ongeldig: ".concat((c=i[a.format])!=null?c:t.format)}case"not_multiple_of":return"Ongeldig getal: moet een veelvoud van ".concat(t.divisor," zijn");case"unrecognized_keys":return"Onbekende key".concat(t.keys.length>1?"s":"",": ").concat(p(t.keys,", "));case"invalid_key":return"Ongeldige key in ".concat(t.origin);case"invalid_union":return"Ongeldige invoer";case"invalid_element":return"Ongeldige waarde in ".concat(t.origin);default:return"Ongeldige invoer"}}};function tc(){return{localeError:nd()}}var id=()=>{let e={string:{unit:"tegn",verb:"\\xE5 ha"},file:{unit:"bytes",verb:"\\xE5 ha"},array:{unit:"elementer",verb:"\\xE5 inneholde"},set:{unit:"elementer",verb:"\\xE5 inneholde"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"tall";case"object":{if(Array.isArray(t))return"liste";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"input",email:"e-postadresse",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO dato- og klokkeslett",date:"ISO-dato",time:"ISO-klokkeslett",duration:"ISO-varighet",ipv4:"IPv4-omr\\xE5de",ipv6:"IPv6-omr\\xE5de",cidrv4:"IPv4-spekter",cidrv6:"IPv6-spekter",base64:"base64-enkodet streng",base64url:"base64url-enkodet streng",json_string:"JSON-streng",e164:"E.164-nummer",jwt:"JWT",template_literal:"input"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"Ugyldig input: forventet ".concat(t.expected,", fikk ").concat(n(t.input));case"invalid_value":return t.values.length===1?"Ugyldig verdi: forventet ".concat(b(t.values[0])):"Ugyldig valg: forventet en av ".concat(p(t.values,"|"));case"too_big":{let a=t.inclusive?"<=":"<",s=r(t.origin);return s?"For stor(t): forventet ".concat((o=t.origin)!=null?o:"value"," til \\xE5 ha ").concat(a).concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"elementer"):"For stor(t): forventet ".concat((l=t.origin)!=null?l:"value"," til \\xE5 ha ").concat(a).concat(t.maximum.toString())}case"too_small":{let a=t.inclusive?">=":">",s=r(t.origin);return s?"For lite(n): forventet ".concat(t.origin," til \\xE5 ha ").concat(a).concat(t.minimum.toString()," ").concat(s.unit):"For lite(n): forventet ".concat(t.origin," til \\xE5 ha ").concat(a).concat(t.minimum.toString())}case"invalid_format":{let a=t;return a.format==="starts_with"?'Ugyldig streng: m\\xE5 starte med "'.concat(a.prefix,'"'):a.format==="ends_with"?'Ugyldig streng: m\\xE5 ende med "'.concat(a.suffix,'"'):a.format==="includes"?'Ugyldig streng: m\\xE5 inneholde "'.concat(a.includes,'"'):a.format==="regex"?"Ugyldig streng: m\\xE5 matche m\\xF8nsteret ".concat(a.pattern):"Ugyldig ".concat((c=i[a.format])!=null?c:t.format)}case"not_multiple_of":return"Ugyldig tall: m\\xE5 v\\xE6re et multiplum av ".concat(t.divisor);case"unrecognized_keys":return"".concat(t.keys.length>1?"Ukjente n\\xF8kler":"Ukjent n\\xF8kkel",": ").concat(p(t.keys,", "));case"invalid_key":return"Ugyldig n\\xF8kkel i ".concat(t.origin);case"invalid_union":return"Ugyldig input";case"invalid_element":return"Ugyldig verdi i ".concat(t.origin);default:return"Ugyldig input"}}};function rc(){return{localeError:id()}}var od=()=>{let e={string:{unit:"harf",verb:"olmal\\u0131d\\u0131r"},file:{unit:"bayt",verb:"olmal\\u0131d\\u0131r"},array:{unit:"unsur",verb:"olmal\\u0131d\\u0131r"},set:{unit:"unsur",verb:"olmal\\u0131d\\u0131r"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"numara";case"object":{if(Array.isArray(t))return"saf";if(t===null)return"gayb";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"giren",email:"epostag\\xE2h",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO heng\\xE2m\\u0131",date:"ISO tarihi",time:"ISO zaman\\u0131",duration:"ISO m\\xFCddeti",ipv4:"IPv4 ni\\u015F\\xE2n\\u0131",ipv6:"IPv6 ni\\u015F\\xE2n\\u0131",cidrv4:"IPv4 menzili",cidrv6:"IPv6 menzili",base64:"base64-\\u015Fifreli metin",base64url:"base64url-\\u015Fifreli metin",json_string:"JSON metin",e164:"E.164 say\\u0131s\\u0131",jwt:"JWT",template_literal:"giren"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"F\\xE2sit giren: umulan ".concat(t.expected,", al\\u0131nan ").concat(n(t.input));case"invalid_value":return t.values.length===1?"F\\xE2sit giren: umulan ".concat(b(t.values[0])):"F\\xE2sit tercih: m\\xFBteberler ".concat(p(t.values,"|"));case"too_big":{let a=t.inclusive?"<=":"<",s=r(t.origin);return s?"Fazla b\\xFCy\\xFCk: ".concat((o=t.origin)!=null?o:"value",", ").concat(a).concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"elements"," sahip olmal\\u0131yd\\u0131."):"Fazla b\\xFCy\\xFCk: ".concat((l=t.origin)!=null?l:"value",", ").concat(a).concat(t.maximum.toString()," olmal\\u0131yd\\u0131.")}case"too_small":{let a=t.inclusive?">=":">",s=r(t.origin);return s?"Fazla k\\xFC\\xE7\\xFCk: ".concat(t.origin,", ").concat(a).concat(t.minimum.toString()," ").concat(s.unit," sahip olmal\\u0131yd\\u0131."):"Fazla k\\xFC\\xE7\\xFCk: ".concat(t.origin,", ").concat(a).concat(t.minimum.toString()," olmal\\u0131yd\\u0131.")}case"invalid_format":{let a=t;return a.format==="starts_with"?'F\\xE2sit metin: "'.concat(a.prefix,'" ile ba\\u015Flamal\\u0131.'):a.format==="ends_with"?'F\\xE2sit metin: "'.concat(a.suffix,'" ile bitmeli.'):a.format==="includes"?'F\\xE2sit metin: "'.concat(a.includes,'" ihtiv\\xE2 etmeli.'):a.format==="regex"?"F\\xE2sit metin: ".concat(a.pattern," nak\\u015F\\u0131na uymal\\u0131."):"F\\xE2sit ".concat((c=i[a.format])!=null?c:t.format)}case"not_multiple_of":return"F\\xE2sit say\\u0131: ".concat(t.divisor," kat\\u0131 olmal\\u0131yd\\u0131.");case"unrecognized_keys":return"Tan\\u0131nmayan anahtar ".concat(t.keys.length>1?"s":"",": ").concat(p(t.keys,", "));case"invalid_key":return"".concat(t.origin," i\\xE7in tan\\u0131nmayan anahtar var.");case"invalid_union":return"Giren tan\\u0131namad\\u0131.";case"invalid_element":return"".concat(t.origin," i\\xE7in tan\\u0131nmayan k\\u0131ymet var.");default:return"K\\u0131ymet tan\\u0131namad\\u0131."}}};function nc(){return{localeError:od()}}var ad=()=>{let e={string:{unit:"\\u062A\\u0648\\u06A9\\u064A",verb:"\\u0648\\u0644\\u0631\\u064A"},file:{unit:"\\u0628\\u0627\\u06CC\\u067C\\u0633",verb:"\\u0648\\u0644\\u0631\\u064A"},array:{unit:"\\u062A\\u0648\\u06A9\\u064A",verb:"\\u0648\\u0644\\u0631\\u064A"},set:{unit:"\\u062A\\u0648\\u06A9\\u064A",verb:"\\u0648\\u0644\\u0631\\u064A"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"\\u0639\\u062F\\u062F";case"object":{if(Array.isArray(t))return"\\u0627\\u0631\\u06D0";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"\\u0648\\u0631\\u0648\\u062F\\u064A",email:"\\u0628\\u0631\\u06CC\\u069A\\u0646\\u0627\\u0644\\u06CC\\u06A9",url:"\\u06CC\\u0648 \\u0622\\u0631 \\u0627\\u0644",emoji:"\\u0627\\u06CC\\u0645\\u0648\\u062C\\u064A",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"\\u0646\\u06CC\\u067C\\u0647 \\u0627\\u0648 \\u0648\\u062E\\u062A",date:"\\u0646\\u06D0\\u067C\\u0647",time:"\\u0648\\u062E\\u062A",duration:"\\u0645\\u0648\\u062F\\u0647",ipv4:"\\u062F IPv4 \\u067E\\u062A\\u0647",ipv6:"\\u062F IPv6 \\u067E\\u062A\\u0647",cidrv4:"\\u062F IPv4 \\u0633\\u0627\\u062D\\u0647",cidrv6:"\\u062F IPv6 \\u0633\\u0627\\u062D\\u0647",base64:"base64-encoded \\u0645\\u062A\\u0646",base64url:"base64url-encoded \\u0645\\u062A\\u0646",json_string:"JSON \\u0645\\u062A\\u0646",e164:"\\u062F E.164 \\u0634\\u0645\\u06D0\\u0631\\u0647",jwt:"JWT",template_literal:"\\u0648\\u0631\\u0648\\u062F\\u064A"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"\\u0646\\u0627\\u0633\\u0645 \\u0648\\u0631\\u0648\\u062F\\u064A: \\u0628\\u0627\\u06CC\\u062F ".concat(t.expected," \\u0648\\u0627\\u06CC, \\u0645\\u06AB\\u0631 ").concat(n(t.input)," \\u062A\\u0631\\u0644\\u0627\\u0633\\u0647 \\u0634\\u0648");case"invalid_value":return t.values.length===1?"\\u0646\\u0627\\u0633\\u0645 \\u0648\\u0631\\u0648\\u062F\\u064A: \\u0628\\u0627\\u06CC\\u062F ".concat(b(t.values[0])," \\u0648\\u0627\\u06CC"):"\\u0646\\u0627\\u0633\\u0645 \\u0627\\u0646\\u062A\\u062E\\u0627\\u0628: \\u0628\\u0627\\u06CC\\u062F \\u06CC\\u0648 \\u0644\\u0647 ".concat(p(t.values,"|")," \\u0685\\u062E\\u0647 \\u0648\\u0627\\u06CC");case"too_big":{let a=t.inclusive?"<=":"<",s=r(t.origin);return s?"\\u0689\\u06CC\\u0631 \\u0644\\u0648\\u06CC: ".concat((o=t.origin)!=null?o:"\\u0627\\u0631\\u0632\\u069A\\u062A"," \\u0628\\u0627\\u06CC\\u062F ").concat(a).concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"\\u0639\\u0646\\u0635\\u0631\\u0648\\u0646\\u0647"," \\u0648\\u0644\\u0631\\u064A"):"\\u0689\\u06CC\\u0631 \\u0644\\u0648\\u06CC: ".concat((l=t.origin)!=null?l:"\\u0627\\u0631\\u0632\\u069A\\u062A"," \\u0628\\u0627\\u06CC\\u062F ").concat(a).concat(t.maximum.toString()," \\u0648\\u064A")}case"too_small":{let a=t.inclusive?">=":">",s=r(t.origin);return s?"\\u0689\\u06CC\\u0631 \\u06A9\\u0648\\u0686\\u0646\\u06CC: ".concat(t.origin," \\u0628\\u0627\\u06CC\\u062F ").concat(a).concat(t.minimum.toString()," ").concat(s.unit," \\u0648\\u0644\\u0631\\u064A"):"\\u0689\\u06CC\\u0631 \\u06A9\\u0648\\u0686\\u0646\\u06CC: ".concat(t.origin," \\u0628\\u0627\\u06CC\\u062F ").concat(a).concat(t.minimum.toString()," \\u0648\\u064A")}case"invalid_format":{let a=t;return a.format==="starts_with"?'\\u0646\\u0627\\u0633\\u0645 \\u0645\\u062A\\u0646: \\u0628\\u0627\\u06CC\\u062F \\u062F "'.concat(a.prefix,'" \\u0633\\u0631\\u0647 \\u067E\\u06CC\\u0644 \\u0634\\u064A'):a.format==="ends_with"?'\\u0646\\u0627\\u0633\\u0645 \\u0645\\u062A\\u0646: \\u0628\\u0627\\u06CC\\u062F \\u062F "'.concat(a.suffix,'" \\u0633\\u0631\\u0647 \\u067E\\u0627\\u06CC \\u062A\\u0647 \\u0648\\u0631\\u0633\\u064A\\u0696\\u064A'):a.format==="includes"?'\\u0646\\u0627\\u0633\\u0645 \\u0645\\u062A\\u0646: \\u0628\\u0627\\u06CC\\u062F "'.concat(a.includes,'" \\u0648\\u0644\\u0631\\u064A'):a.format==="regex"?"\\u0646\\u0627\\u0633\\u0645 \\u0645\\u062A\\u0646: \\u0628\\u0627\\u06CC\\u062F \\u062F ".concat(a.pattern," \\u0633\\u0631\\u0647 \\u0645\\u0637\\u0627\\u0628\\u0642\\u062A \\u0648\\u0644\\u0631\\u064A"):"".concat((c=i[a.format])!=null?c:t.format," \\u0646\\u0627\\u0633\\u0645 \\u062F\\u06CC")}case"not_multiple_of":return"\\u0646\\u0627\\u0633\\u0645 \\u0639\\u062F\\u062F: \\u0628\\u0627\\u06CC\\u062F \\u062F ".concat(t.divisor," \\u0645\\u0636\\u0631\\u0628 \\u0648\\u064A");case"unrecognized_keys":return"\\u0646\\u0627\\u0633\\u0645 ".concat(t.keys.length>1?"\\u06A9\\u0644\\u06CC\\u0689\\u0648\\u0646\\u0647":"\\u06A9\\u0644\\u06CC\\u0689",": ").concat(p(t.keys,", "));case"invalid_key":return"\\u0646\\u0627\\u0633\\u0645 \\u06A9\\u0644\\u06CC\\u0689 \\u067E\\u0647 ".concat(t.origin," \\u06A9\\u06D0");case"invalid_union":return"\\u0646\\u0627\\u0633\\u0645\\u0647 \\u0648\\u0631\\u0648\\u062F\\u064A";case"invalid_element":return"\\u0646\\u0627\\u0633\\u0645 \\u0639\\u0646\\u0635\\u0631 \\u067E\\u0647 ".concat(t.origin," \\u06A9\\u06D0");default:return"\\u0646\\u0627\\u0633\\u0645\\u0647 \\u0648\\u0631\\u0648\\u062F\\u064A"}}};function ic(){return{localeError:ad()}}var ud=()=>{let e={string:{unit:"znak\\xF3w",verb:"mie\\u0107"},file:{unit:"bajt\\xF3w",verb:"mie\\u0107"},array:{unit:"element\\xF3w",verb:"mie\\u0107"},set:{unit:"element\\xF3w",verb:"mie\\u0107"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"liczba";case"object":{if(Array.isArray(t))return"tablica";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"wyra\\u017Cenie",email:"adres email",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"data i godzina w formacie ISO",date:"data w formacie ISO",time:"godzina w formacie ISO",duration:"czas trwania ISO",ipv4:"adres IPv4",ipv6:"adres IPv6",cidrv4:"zakres IPv4",cidrv6:"zakres IPv6",base64:"ci\\u0105g znak\\xF3w zakodowany w formacie base64",base64url:"ci\\u0105g znak\\xF3w zakodowany w formacie base64url",json_string:"ci\\u0105g znak\\xF3w w formacie JSON",e164:"liczba E.164",jwt:"JWT",template_literal:"wej\\u015Bcie"};return t=>{var o,u,l,c,a,s,v;switch(t.code){case"invalid_type":return"Nieprawid\\u0142owe dane wej\\u015Bciowe: oczekiwano ".concat(t.expected,", otrzymano ").concat(n(t.input));case"invalid_value":return t.values.length===1?"Nieprawid\\u0142owe dane wej\\u015Bciowe: oczekiwano ".concat(b(t.values[0])):"Nieprawid\\u0142owa opcja: oczekiwano jednej z warto\\u015Bci ".concat(p(t.values,"|"));case"too_big":{let f=t.inclusive?"<=":"<",h=r(t.origin);return h?"Za du\\u017Ca warto\\u015B\\u0107: oczekiwano, \\u017Ce ".concat((o=t.origin)!=null?o:"warto\\u015B\\u0107"," b\\u0119dzie mie\\u0107 ").concat(f).concat(t.maximum.toString()," ").concat((u=h.unit)!=null?u:"element\\xF3w"):"Zbyt du\\u017C(y/a/e): oczekiwano, \\u017Ce ".concat((l=t.origin)!=null?l:"warto\\u015B\\u0107"," b\\u0119dzie wynosi\\u0107 ").concat(f).concat(t.maximum.toString())}case"too_small":{let f=t.inclusive?">=":">",h=r(t.origin);return h?"Za ma\\u0142a warto\\u015B\\u0107: oczekiwano, \\u017Ce ".concat((c=t.origin)!=null?c:"warto\\u015B\\u0107"," b\\u0119dzie mie\\u0107 ").concat(f).concat(t.minimum.toString()," ").concat((a=h.unit)!=null?a:"element\\xF3w"):"Zbyt ma\\u0142(y/a/e): oczekiwano, \\u017Ce ".concat((s=t.origin)!=null?s:"warto\\u015B\\u0107"," b\\u0119dzie wynosi\\u0107 ").concat(f).concat(t.minimum.toString())}case"invalid_format":{let f=t;return f.format==="starts_with"?'Nieprawid\\u0142owy ci\\u0105g znak\\xF3w: musi zaczyna\\u0107 si\\u0119 od "'.concat(f.prefix,'"'):f.format==="ends_with"?'Nieprawid\\u0142owy ci\\u0105g znak\\xF3w: musi ko\\u0144czy\\u0107 si\\u0119 na "'.concat(f.suffix,'"'):f.format==="includes"?'Nieprawid\\u0142owy ci\\u0105g znak\\xF3w: musi zawiera\\u0107 "'.concat(f.includes,'"'):f.format==="regex"?"Nieprawid\\u0142owy ci\\u0105g znak\\xF3w: musi odpowiada\\u0107 wzorcowi ".concat(f.pattern):"Nieprawid\\u0142ow(y/a/e) ".concat((v=i[f.format])!=null?v:t.format)}case"not_multiple_of":return"Nieprawid\\u0142owa liczba: musi by\\u0107 wielokrotno\\u015Bci\\u0105 ".concat(t.divisor);case"unrecognized_keys":return"Nierozpoznane klucze".concat(t.keys.length>1?"s":"",": ").concat(p(t.keys,", "));case"invalid_key":return"Nieprawid\\u0142owy klucz w ".concat(t.origin);case"invalid_union":return"Nieprawid\\u0142owe dane wej\\u015Bciowe";case"invalid_element":return"Nieprawid\\u0142owa warto\\u015B\\u0107 w ".concat(t.origin);default:return"Nieprawid\\u0142owe dane wej\\u015Bciowe"}}};function oc(){return{localeError:ud()}}var cd=()=>{let e={string:{unit:"caracteres",verb:"ter"},file:{unit:"bytes",verb:"ter"},array:{unit:"itens",verb:"ter"},set:{unit:"itens",verb:"ter"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"n\\xFAmero";case"object":{if(Array.isArray(t))return"array";if(t===null)return"nulo";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"padr\\xE3o",email:"endere\\xE7o de e-mail",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"data e hora ISO",date:"data ISO",time:"hora ISO",duration:"dura\\xE7\\xE3o ISO",ipv4:"endere\\xE7o IPv4",ipv6:"endere\\xE7o IPv6",cidrv4:"faixa de IPv4",cidrv6:"faixa de IPv6",base64:"texto codificado em base64",base64url:"URL codificada em base64",json_string:"texto JSON",e164:"n\\xFAmero E.164",jwt:"JWT",template_literal:"entrada"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"Tipo inv\\xE1lido: esperado ".concat(t.expected,", recebido ").concat(n(t.input));case"invalid_value":return t.values.length===1?"Entrada inv\\xE1lida: esperado ".concat(b(t.values[0])):"Op\\xE7\\xE3o inv\\xE1lida: esperada uma das ".concat(p(t.values,"|"));case"too_big":{let a=t.inclusive?"<=":"<",s=r(t.origin);return s?"Muito grande: esperado que ".concat((o=t.origin)!=null?o:"valor"," tivesse ").concat(a).concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"elementos"):"Muito grande: esperado que ".concat((l=t.origin)!=null?l:"valor"," fosse ").concat(a).concat(t.maximum.toString())}case"too_small":{let a=t.inclusive?">=":">",s=r(t.origin);return s?"Muito pequeno: esperado que ".concat(t.origin," tivesse ").concat(a).concat(t.minimum.toString()," ").concat(s.unit):"Muito pequeno: esperado que ".concat(t.origin," fosse ").concat(a).concat(t.minimum.toString())}case"invalid_format":{let a=t;return a.format==="starts_with"?'Texto inv\\xE1lido: deve come\\xE7ar com "'.concat(a.prefix,'"'):a.format==="ends_with"?'Texto inv\\xE1lido: deve terminar com "'.concat(a.suffix,'"'):a.format==="includes"?'Texto inv\\xE1lido: deve incluir "'.concat(a.includes,'"'):a.format==="regex"?"Texto inv\\xE1lido: deve corresponder ao padr\\xE3o ".concat(a.pattern):"".concat((c=i[a.format])!=null?c:t.format," inv\\xE1lido")}case"not_multiple_of":return"N\\xFAmero inv\\xE1lido: deve ser m\\xFAltiplo de ".concat(t.divisor);case"unrecognized_keys":return"Chave".concat(t.keys.length>1?"s":""," desconhecida").concat(t.keys.length>1?"s":"",": ").concat(p(t.keys,", "));case"invalid_key":return"Chave inv\\xE1lida em ".concat(t.origin);case"invalid_union":return"Entrada inv\\xE1lida";case"invalid_element":return"Valor inv\\xE1lido em ".concat(t.origin);default:return"Campo inv\\xE1lido"}}};function ac(){return{localeError:cd()}}function uc(e,r,n,i){let t=Math.abs(e),o=t%10,u=t%100;return u>=11&&u<=19?i:o===1?r:o>=2&&o<=4?n:i}var ld=()=>{let e={string:{unit:{one:"\\u0441\\u0438\\u043C\\u0432\\u043E\\u043B",few:"\\u0441\\u0438\\u043C\\u0432\\u043E\\u043B\\u0430",many:"\\u0441\\u0438\\u043C\\u0432\\u043E\\u043B\\u043E\\u0432"},verb:"\\u0438\\u043C\\u0435\\u0442\\u044C"},file:{unit:{one:"\\u0431\\u0430\\u0439\\u0442",few:"\\u0431\\u0430\\u0439\\u0442\\u0430",many:"\\u0431\\u0430\\u0439\\u0442"},verb:"\\u0438\\u043C\\u0435\\u0442\\u044C"},array:{unit:{one:"\\u044D\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442",few:"\\u044D\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442\\u0430",many:"\\u044D\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442\\u043E\\u0432"},verb:"\\u0438\\u043C\\u0435\\u0442\\u044C"},set:{unit:{one:"\\u044D\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442",few:"\\u044D\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442\\u0430",many:"\\u044D\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442\\u043E\\u0432"},verb:"\\u0438\\u043C\\u0435\\u0442\\u044C"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"\\u0447\\u0438\\u0441\\u043B\\u043E";case"object":{if(Array.isArray(t))return"\\u043C\\u0430\\u0441\\u0441\\u0438\\u0432";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"\\u0432\\u0432\\u043E\\u0434",email:"email \\u0430\\u0434\\u0440\\u0435\\u0441",url:"URL",emoji:"\\u044D\\u043C\\u043E\\u0434\\u0437\\u0438",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO \\u0434\\u0430\\u0442\\u0430 \\u0438 \\u0432\\u0440\\u0435\\u043C\\u044F",date:"ISO \\u0434\\u0430\\u0442\\u0430",time:"ISO \\u0432\\u0440\\u0435\\u043C\\u044F",duration:"ISO \\u0434\\u043B\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u043E\\u0441\\u0442\\u044C",ipv4:"IPv4 \\u0430\\u0434\\u0440\\u0435\\u0441",ipv6:"IPv6 \\u0430\\u0434\\u0440\\u0435\\u0441",cidrv4:"IPv4 \\u0434\\u0438\\u0430\\u043F\\u0430\\u0437\\u043E\\u043D",cidrv6:"IPv6 \\u0434\\u0438\\u0430\\u043F\\u0430\\u0437\\u043E\\u043D",base64:"\\u0441\\u0442\\u0440\\u043E\\u043A\\u0430 \\u0432 \\u0444\\u043E\\u0440\\u043C\\u0430\\u0442\\u0435 base64",base64url:"\\u0441\\u0442\\u0440\\u043E\\u043A\\u0430 \\u0432 \\u0444\\u043E\\u0440\\u043C\\u0430\\u0442\\u0435 base64url",json_string:"JSON \\u0441\\u0442\\u0440\\u043E\\u043A\\u0430",e164:"\\u043D\\u043E\\u043C\\u0435\\u0440 E.164",jwt:"JWT",template_literal:"\\u0432\\u0432\\u043E\\u0434"};return t=>{var o,u,l;switch(t.code){case"invalid_type":return"\\u041D\\u0435\\u0432\\u0435\\u0440\\u043D\\u044B\\u0439 \\u0432\\u0432\\u043E\\u0434: \\u043E\\u0436\\u0438\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C ".concat(t.expected,", \\u043F\\u043E\\u043B\\u0443\\u0447\\u0435\\u043D\\u043E ").concat(n(t.input));case"invalid_value":return t.values.length===1?"\\u041D\\u0435\\u0432\\u0435\\u0440\\u043D\\u044B\\u0439 \\u0432\\u0432\\u043E\\u0434: \\u043E\\u0436\\u0438\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C ".concat(b(t.values[0])):"\\u041D\\u0435\\u0432\\u0435\\u0440\\u043D\\u044B\\u0439 \\u0432\\u0430\\u0440\\u0438\\u0430\\u043D\\u0442: \\u043E\\u0436\\u0438\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u043E\\u0434\\u043D\\u043E \\u0438\\u0437 ".concat(p(t.values,"|"));case"too_big":{let c=t.inclusive?"<=":"<",a=r(t.origin);if(a){let s=Number(t.maximum),v=uc(s,a.unit.one,a.unit.few,a.unit.many);return"\\u0421\\u043B\\u0438\\u0448\\u043A\\u043E\\u043C \\u0431\\u043E\\u043B\\u044C\\u0448\\u043E\\u0435 \\u0437\\u043D\\u0430\\u0447\\u0435\\u043D\\u0438\\u0435: \\u043E\\u0436\\u0438\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C, \\u0447\\u0442\\u043E ".concat((o=t.origin)!=null?o:"\\u0437\\u043D\\u0430\\u0447\\u0435\\u043D\\u0438\\u0435"," \\u0431\\u0443\\u0434\\u0435\\u0442 \\u0438\\u043C\\u0435\\u0442\\u044C ").concat(c).concat(t.maximum.toString()," ").concat(v)}return"\\u0421\\u043B\\u0438\\u0448\\u043A\\u043E\\u043C \\u0431\\u043E\\u043B\\u044C\\u0448\\u043E\\u0435 \\u0437\\u043D\\u0430\\u0447\\u0435\\u043D\\u0438\\u0435: \\u043E\\u0436\\u0438\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C, \\u0447\\u0442\\u043E ".concat((u=t.origin)!=null?u:"\\u0437\\u043D\\u0430\\u0447\\u0435\\u043D\\u0438\\u0435"," \\u0431\\u0443\\u0434\\u0435\\u0442 ").concat(c).concat(t.maximum.toString())}case"too_small":{let c=t.inclusive?">=":">",a=r(t.origin);if(a){let s=Number(t.minimum),v=uc(s,a.unit.one,a.unit.few,a.unit.many);return"\\u0421\\u043B\\u0438\\u0448\\u043A\\u043E\\u043C \\u043C\\u0430\\u043B\\u0435\\u043D\\u044C\\u043A\\u043E\\u0435 \\u0437\\u043D\\u0430\\u0447\\u0435\\u043D\\u0438\\u0435: \\u043E\\u0436\\u0438\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C, \\u0447\\u0442\\u043E ".concat(t.origin," \\u0431\\u0443\\u0434\\u0435\\u0442 \\u0438\\u043C\\u0435\\u0442\\u044C ").concat(c).concat(t.minimum.toString()," ").concat(v)}return"\\u0421\\u043B\\u0438\\u0448\\u043A\\u043E\\u043C \\u043C\\u0430\\u043B\\u0435\\u043D\\u044C\\u043A\\u043E\\u0435 \\u0437\\u043D\\u0430\\u0447\\u0435\\u043D\\u0438\\u0435: \\u043E\\u0436\\u0438\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C, \\u0447\\u0442\\u043E ".concat(t.origin," \\u0431\\u0443\\u0434\\u0435\\u0442 ").concat(c).concat(t.minimum.toString())}case"invalid_format":{let c=t;return c.format==="starts_with"?'\\u041D\\u0435\\u0432\\u0435\\u0440\\u043D\\u0430\\u044F \\u0441\\u0442\\u0440\\u043E\\u043A\\u0430: \\u0434\\u043E\\u043B\\u0436\\u043D\\u0430 \\u043D\\u0430\\u0447\\u0438\\u043D\\u0430\\u0442\\u044C\\u0441\\u044F \\u0441 "'.concat(c.prefix,'"'):c.format==="ends_with"?'\\u041D\\u0435\\u0432\\u0435\\u0440\\u043D\\u0430\\u044F \\u0441\\u0442\\u0440\\u043E\\u043A\\u0430: \\u0434\\u043E\\u043B\\u0436\\u043D\\u0430 \\u0437\\u0430\\u043A\\u0430\\u043D\\u0447\\u0438\\u0432\\u0430\\u0442\\u044C\\u0441\\u044F \\u043D\\u0430 "'.concat(c.suffix,'"'):c.format==="includes"?'\\u041D\\u0435\\u0432\\u0435\\u0440\\u043D\\u0430\\u044F \\u0441\\u0442\\u0440\\u043E\\u043A\\u0430: \\u0434\\u043E\\u043B\\u0436\\u043D\\u0430 \\u0441\\u043E\\u0434\\u0435\\u0440\\u0436\\u0430\\u0442\\u044C "'.concat(c.includes,'"'):c.format==="regex"?"\\u041D\\u0435\\u0432\\u0435\\u0440\\u043D\\u0430\\u044F \\u0441\\u0442\\u0440\\u043E\\u043A\\u0430: \\u0434\\u043E\\u043B\\u0436\\u043D\\u0430 \\u0441\\u043E\\u043E\\u0442\\u0432\\u0435\\u0442\\u0441\\u0442\\u0432\\u043E\\u0432\\u0430\\u0442\\u044C \\u0448\\u0430\\u0431\\u043B\\u043E\\u043D\\u0443 ".concat(c.pattern):"\\u041D\\u0435\\u0432\\u0435\\u0440\\u043D\\u044B\\u0439 ".concat((l=i[c.format])!=null?l:t.format)}case"not_multiple_of":return"\\u041D\\u0435\\u0432\\u0435\\u0440\\u043D\\u043E\\u0435 \\u0447\\u0438\\u0441\\u043B\\u043E: \\u0434\\u043E\\u043B\\u0436\\u043D\\u043E \\u0431\\u044B\\u0442\\u044C \\u043A\\u0440\\u0430\\u0442\\u043D\\u044B\\u043C ".concat(t.divisor);case"unrecognized_keys":return"\\u041D\\u0435\\u0440\\u0430\\u0441\\u043F\\u043E\\u0437\\u043D\\u0430\\u043D\\u043D".concat(t.keys.length>1?"\\u044B\\u0435":"\\u044B\\u0439"," \\u043A\\u043B\\u044E\\u0447").concat(t.keys.length>1?"\\u0438":"",": ").concat(p(t.keys,", "));case"invalid_key":return"\\u041D\\u0435\\u0432\\u0435\\u0440\\u043D\\u044B\\u0439 \\u043A\\u043B\\u044E\\u0447 \\u0432 ".concat(t.origin);case"invalid_union":return"\\u041D\\u0435\\u0432\\u0435\\u0440\\u043D\\u044B\\u0435 \\u0432\\u0445\\u043E\\u0434\\u043D\\u044B\\u0435 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435";case"invalid_element":return"\\u041D\\u0435\\u0432\\u0435\\u0440\\u043D\\u043E\\u0435 \\u0437\\u043D\\u0430\\u0447\\u0435\\u043D\\u0438\\u0435 \\u0432 ".concat(t.origin);default:return"\\u041D\\u0435\\u0432\\u0435\\u0440\\u043D\\u044B\\u0435 \\u0432\\u0445\\u043E\\u0434\\u043D\\u044B\\u0435 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435"}}};function cc(){return{localeError:ld()}}var sd=()=>{let e={string:{unit:"znakov",verb:"imeti"},file:{unit:"bajtov",verb:"imeti"},array:{unit:"elementov",verb:"imeti"},set:{unit:"elementov",verb:"imeti"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"\\u0161tevilo";case"object":{if(Array.isArray(t))return"tabela";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"vnos",email:"e-po\\u0161tni naslov",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datum in \\u010Das",date:"ISO datum",time:"ISO \\u010Das",duration:"ISO trajanje",ipv4:"IPv4 naslov",ipv6:"IPv6 naslov",cidrv4:"obseg IPv4",cidrv6:"obseg IPv6",base64:"base64 kodiran niz",base64url:"base64url kodiran niz",json_string:"JSON niz",e164:"E.164 \\u0161tevilka",jwt:"JWT",template_literal:"vnos"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"Neveljaven vnos: pri\\u010Dakovano ".concat(t.expected,", prejeto ").concat(n(t.input));case"invalid_value":return t.values.length===1?"Neveljaven vnos: pri\\u010Dakovano ".concat(b(t.values[0])):"Neveljavna mo\\u017Enost: pri\\u010Dakovano eno izmed ".concat(p(t.values,"|"));case"too_big":{let a=t.inclusive?"<=":"<",s=r(t.origin);return s?"Preveliko: pri\\u010Dakovano, da bo ".concat((o=t.origin)!=null?o:"vrednost"," imelo ").concat(a).concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"elementov"):"Preveliko: pri\\u010Dakovano, da bo ".concat((l=t.origin)!=null?l:"vrednost"," ").concat(a).concat(t.maximum.toString())}case"too_small":{let a=t.inclusive?">=":">",s=r(t.origin);return s?"Premajhno: pri\\u010Dakovano, da bo ".concat(t.origin," imelo ").concat(a).concat(t.minimum.toString()," ").concat(s.unit):"Premajhno: pri\\u010Dakovano, da bo ".concat(t.origin," ").concat(a).concat(t.minimum.toString())}case"invalid_format":{let a=t;return a.format==="starts_with"?'Neveljaven niz: mora se za\\u010Deti z "'.concat(a.prefix,'"'):a.format==="ends_with"?'Neveljaven niz: mora se kon\\u010Dati z "'.concat(a.suffix,'"'):a.format==="includes"?'Neveljaven niz: mora vsebovati "'.concat(a.includes,'"'):a.format==="regex"?"Neveljaven niz: mora ustrezati vzorcu ".concat(a.pattern):"Neveljaven ".concat((c=i[a.format])!=null?c:t.format)}case"not_multiple_of":return"Neveljavno \\u0161tevilo: mora biti ve\\u010Dkratnik ".concat(t.divisor);case"unrecognized_keys":return"Neprepoznan".concat(t.keys.length>1?"i klju\\u010Di":" klju\\u010D",": ").concat(p(t.keys,", "));case"invalid_key":return"Neveljaven klju\\u010D v ".concat(t.origin);case"invalid_union":return"Neveljaven vnos";case"invalid_element":return"Neveljavna vrednost v ".concat(t.origin);default:return"Neveljaven vnos"}}};function lc(){return{localeError:sd()}}var dd=()=>{let e={string:{unit:"tecken",verb:"att ha"},file:{unit:"bytes",verb:"att ha"},array:{unit:"objekt",verb:"att inneh\\xE5lla"},set:{unit:"objekt",verb:"att inneh\\xE5lla"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"antal";case"object":{if(Array.isArray(t))return"lista";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"regulj\\xE4rt uttryck",email:"e-postadress",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO-datum och tid",date:"ISO-datum",time:"ISO-tid",duration:"ISO-varaktighet",ipv4:"IPv4-intervall",ipv6:"IPv6-intervall",cidrv4:"IPv4-spektrum",cidrv6:"IPv6-spektrum",base64:"base64-kodad str\\xE4ng",base64url:"base64url-kodad str\\xE4ng",json_string:"JSON-str\\xE4ng",e164:"E.164-nummer",jwt:"JWT",template_literal:"mall-literal"};return t=>{var o,u,l,c,a,s,v,f;switch(t.code){case"invalid_type":return"Ogiltig inmatning: f\\xF6rv\\xE4ntat ".concat(t.expected,", fick ").concat(n(t.input));case"invalid_value":return t.values.length===1?"Ogiltig inmatning: f\\xF6rv\\xE4ntat ".concat(b(t.values[0])):"Ogiltigt val: f\\xF6rv\\xE4ntade en av ".concat(p(t.values,"|"));case"too_big":{let h=t.inclusive?"<=":"<",x=r(t.origin);return x?"F\\xF6r stor(t): f\\xF6rv\\xE4ntade ".concat((o=t.origin)!=null?o:"v\\xE4rdet"," att ha ").concat(h).concat(t.maximum.toString()," ").concat((u=x.unit)!=null?u:"element"):"F\\xF6r stor(t): f\\xF6rv\\xE4ntat ".concat((l=t.origin)!=null?l:"v\\xE4rdet"," att ha ").concat(h).concat(t.maximum.toString())}case"too_small":{let h=t.inclusive?">=":">",x=r(t.origin);return x?"F\\xF6r lite(t): f\\xF6rv\\xE4ntade ".concat((c=t.origin)!=null?c:"v\\xE4rdet"," att ha ").concat(h).concat(t.minimum.toString()," ").concat(x.unit):"F\\xF6r lite(t): f\\xF6rv\\xE4ntade ".concat((a=t.origin)!=null?a:"v\\xE4rdet"," att ha ").concat(h).concat(t.minimum.toString())}case"invalid_format":{let h=t;return h.format==="starts_with"?'Ogiltig str\\xE4ng: m\\xE5ste b\\xF6rja med "'.concat(h.prefix,'"'):h.format==="ends_with"?'Ogiltig str\\xE4ng: m\\xE5ste sluta med "'.concat(h.suffix,'"'):h.format==="includes"?'Ogiltig str\\xE4ng: m\\xE5ste inneh\\xE5lla "'.concat(h.includes,'"'):h.format==="regex"?'Ogiltig str\\xE4ng: m\\xE5ste matcha m\\xF6nstret "'.concat(h.pattern,'"'):"Ogiltig(t) ".concat((s=i[h.format])!=null?s:t.format)}case"not_multiple_of":return"Ogiltigt tal: m\\xE5ste vara en multipel av ".concat(t.divisor);case"unrecognized_keys":return"".concat(t.keys.length>1?"Ok\\xE4nda nycklar":"Ok\\xE4nd nyckel",": ").concat(p(t.keys,", "));case"invalid_key":return"Ogiltig nyckel i ".concat((v=t.origin)!=null?v:"v\\xE4rdet");case"invalid_union":return"Ogiltig input";case"invalid_element":return"Ogiltigt v\\xE4rde i ".concat((f=t.origin)!=null?f:"v\\xE4rdet");default:return"Ogiltig input"}}};function sc(){return{localeError:dd()}}var md=()=>{let e={string:{unit:"\\u0B8E\\u0BB4\\u0BC1\\u0BA4\\u0BCD\\u0BA4\\u0BC1\\u0B95\\u0BCD\\u0B95\\u0BB3\\u0BCD",verb:"\\u0B95\\u0BCA\\u0BA3\\u0BCD\\u0B9F\\u0BBF\\u0BB0\\u0BC1\\u0B95\\u0BCD\\u0B95 \\u0BB5\\u0BC7\\u0BA3\\u0BCD\\u0B9F\\u0BC1\\u0BAE\\u0BCD"},file:{unit:"\\u0BAA\\u0BC8\\u0B9F\\u0BCD\\u0B9F\\u0BC1\\u0B95\\u0BB3\\u0BCD",verb:"\\u0B95\\u0BCA\\u0BA3\\u0BCD\\u0B9F\\u0BBF\\u0BB0\\u0BC1\\u0B95\\u0BCD\\u0B95 \\u0BB5\\u0BC7\\u0BA3\\u0BCD\\u0B9F\\u0BC1\\u0BAE\\u0BCD"},array:{unit:"\\u0B89\\u0BB1\\u0BC1\\u0BAA\\u0BCD\\u0BAA\\u0BC1\\u0B95\\u0BB3\\u0BCD",verb:"\\u0B95\\u0BCA\\u0BA3\\u0BCD\\u0B9F\\u0BBF\\u0BB0\\u0BC1\\u0B95\\u0BCD\\u0B95 \\u0BB5\\u0BC7\\u0BA3\\u0BCD\\u0B9F\\u0BC1\\u0BAE\\u0BCD"},set:{unit:"\\u0B89\\u0BB1\\u0BC1\\u0BAA\\u0BCD\\u0BAA\\u0BC1\\u0B95\\u0BB3\\u0BCD",verb:"\\u0B95\\u0BCA\\u0BA3\\u0BCD\\u0B9F\\u0BBF\\u0BB0\\u0BC1\\u0B95\\u0BCD\\u0B95 \\u0BB5\\u0BC7\\u0BA3\\u0BCD\\u0B9F\\u0BC1\\u0BAE\\u0BCD"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"\\u0B8E\\u0BA3\\u0BCD \\u0B85\\u0BB2\\u0BCD\\u0BB2\\u0BBE\\u0BA4\\u0BA4\\u0BC1":"\\u0B8E\\u0BA3\\u0BCD";case"object":{if(Array.isArray(t))return"\\u0B85\\u0BA3\\u0BBF";if(t===null)return"\\u0BB5\\u0BC6\\u0BB1\\u0BC1\\u0BAE\\u0BC8";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"\\u0B89\\u0BB3\\u0BCD\\u0BB3\\u0BC0\\u0B9F\\u0BC1",email:"\\u0BAE\\u0BBF\\u0BA9\\u0BCD\\u0BA9\\u0B9E\\u0BCD\\u0B9A\\u0BB2\\u0BCD \\u0BAE\\u0BC1\\u0B95\\u0BB5\\u0BB0\\u0BBF",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO \\u0BA4\\u0BC7\\u0BA4\\u0BBF \\u0BA8\\u0BC7\\u0BB0\\u0BAE\\u0BCD",date:"ISO \\u0BA4\\u0BC7\\u0BA4\\u0BBF",time:"ISO \\u0BA8\\u0BC7\\u0BB0\\u0BAE\\u0BCD",duration:"ISO \\u0B95\\u0BBE\\u0BB2 \\u0B85\\u0BB3\\u0BB5\\u0BC1",ipv4:"IPv4 \\u0BAE\\u0BC1\\u0B95\\u0BB5\\u0BB0\\u0BBF",ipv6:"IPv6 \\u0BAE\\u0BC1\\u0B95\\u0BB5\\u0BB0\\u0BBF",cidrv4:"IPv4 \\u0BB5\\u0BB0\\u0BAE\\u0BCD\\u0BAA\\u0BC1",cidrv6:"IPv6 \\u0BB5\\u0BB0\\u0BAE\\u0BCD\\u0BAA\\u0BC1",base64:"base64-encoded \\u0B9A\\u0BB0\\u0BAE\\u0BCD",base64url:"base64url-encoded \\u0B9A\\u0BB0\\u0BAE\\u0BCD",json_string:"JSON \\u0B9A\\u0BB0\\u0BAE\\u0BCD",e164:"E.164 \\u0B8E\\u0BA3\\u0BCD",jwt:"JWT",template_literal:"input"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"\\u0BA4\\u0BB5\\u0BB1\\u0BBE\\u0BA9 \\u0B89\\u0BB3\\u0BCD\\u0BB3\\u0BC0\\u0B9F\\u0BC1: \\u0B8E\\u0BA4\\u0BBF\\u0BB0\\u0BCD\\u0BAA\\u0BBE\\u0BB0\\u0BCD\\u0B95\\u0BCD\\u0B95\\u0BAA\\u0BCD\\u0BAA\\u0B9F\\u0BCD\\u0B9F\\u0BA4\\u0BC1 ".concat(t.expected,", \\u0BAA\\u0BC6\\u0BB1\\u0BAA\\u0BCD\\u0BAA\\u0B9F\\u0BCD\\u0B9F\\u0BA4\\u0BC1 ").concat(n(t.input));case"invalid_value":return t.values.length===1?"\\u0BA4\\u0BB5\\u0BB1\\u0BBE\\u0BA9 \\u0B89\\u0BB3\\u0BCD\\u0BB3\\u0BC0\\u0B9F\\u0BC1: \\u0B8E\\u0BA4\\u0BBF\\u0BB0\\u0BCD\\u0BAA\\u0BBE\\u0BB0\\u0BCD\\u0B95\\u0BCD\\u0B95\\u0BAA\\u0BCD\\u0BAA\\u0B9F\\u0BCD\\u0B9F\\u0BA4\\u0BC1 ".concat(b(t.values[0])):"\\u0BA4\\u0BB5\\u0BB1\\u0BBE\\u0BA9 \\u0BB5\\u0BBF\\u0BB0\\u0BC1\\u0BAA\\u0BCD\\u0BAA\\u0BAE\\u0BCD: \\u0B8E\\u0BA4\\u0BBF\\u0BB0\\u0BCD\\u0BAA\\u0BBE\\u0BB0\\u0BCD\\u0B95\\u0BCD\\u0B95\\u0BAA\\u0BCD\\u0BAA\\u0B9F\\u0BCD\\u0B9F\\u0BA4\\u0BC1 ".concat(p(t.values,"|")," \\u0B87\\u0BB2\\u0BCD \\u0B92\\u0BA9\\u0BCD\\u0BB1\\u0BC1");case"too_big":{let a=t.inclusive?"<=":"<",s=r(t.origin);return s?"\\u0BAE\\u0BBF\\u0B95 \\u0BAA\\u0BC6\\u0BB0\\u0BBF\\u0BAF\\u0BA4\\u0BC1: \\u0B8E\\u0BA4\\u0BBF\\u0BB0\\u0BCD\\u0BAA\\u0BBE\\u0BB0\\u0BCD\\u0B95\\u0BCD\\u0B95\\u0BAA\\u0BCD\\u0BAA\\u0B9F\\u0BCD\\u0B9F\\u0BA4\\u0BC1 ".concat((o=t.origin)!=null?o:"\\u0BAE\\u0BA4\\u0BBF\\u0BAA\\u0BCD\\u0BAA\\u0BC1"," ").concat(a).concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"\\u0B89\\u0BB1\\u0BC1\\u0BAA\\u0BCD\\u0BAA\\u0BC1\\u0B95\\u0BB3\\u0BCD"," \\u0B86\\u0B95 \\u0B87\\u0BB0\\u0BC1\\u0B95\\u0BCD\\u0B95 \\u0BB5\\u0BC7\\u0BA3\\u0BCD\\u0B9F\\u0BC1\\u0BAE\\u0BCD"):"\\u0BAE\\u0BBF\\u0B95 \\u0BAA\\u0BC6\\u0BB0\\u0BBF\\u0BAF\\u0BA4\\u0BC1: \\u0B8E\\u0BA4\\u0BBF\\u0BB0\\u0BCD\\u0BAA\\u0BBE\\u0BB0\\u0BCD\\u0B95\\u0BCD\\u0B95\\u0BAA\\u0BCD\\u0BAA\\u0B9F\\u0BCD\\u0B9F\\u0BA4\\u0BC1 ".concat((l=t.origin)!=null?l:"\\u0BAE\\u0BA4\\u0BBF\\u0BAA\\u0BCD\\u0BAA\\u0BC1"," ").concat(a).concat(t.maximum.toString()," \\u0B86\\u0B95 \\u0B87\\u0BB0\\u0BC1\\u0B95\\u0BCD\\u0B95 \\u0BB5\\u0BC7\\u0BA3\\u0BCD\\u0B9F\\u0BC1\\u0BAE\\u0BCD")}case"too_small":{let a=t.inclusive?">=":">",s=r(t.origin);return s?"\\u0BAE\\u0BBF\\u0B95\\u0B9A\\u0BCD \\u0B9A\\u0BBF\\u0BB1\\u0BBF\\u0BAF\\u0BA4\\u0BC1: \\u0B8E\\u0BA4\\u0BBF\\u0BB0\\u0BCD\\u0BAA\\u0BBE\\u0BB0\\u0BCD\\u0B95\\u0BCD\\u0B95\\u0BAA\\u0BCD\\u0BAA\\u0B9F\\u0BCD\\u0B9F\\u0BA4\\u0BC1 ".concat(t.origin," ").concat(a).concat(t.minimum.toString()," ").concat(s.unit," \\u0B86\\u0B95 \\u0B87\\u0BB0\\u0BC1\\u0B95\\u0BCD\\u0B95 \\u0BB5\\u0BC7\\u0BA3\\u0BCD\\u0B9F\\u0BC1\\u0BAE\\u0BCD"):"\\u0BAE\\u0BBF\\u0B95\\u0B9A\\u0BCD \\u0B9A\\u0BBF\\u0BB1\\u0BBF\\u0BAF\\u0BA4\\u0BC1: \\u0B8E\\u0BA4\\u0BBF\\u0BB0\\u0BCD\\u0BAA\\u0BBE\\u0BB0\\u0BCD\\u0B95\\u0BCD\\u0B95\\u0BAA\\u0BCD\\u0BAA\\u0B9F\\u0BCD\\u0B9F\\u0BA4\\u0BC1 ".concat(t.origin," ").concat(a).concat(t.minimum.toString()," \\u0B86\\u0B95 \\u0B87\\u0BB0\\u0BC1\\u0B95\\u0BCD\\u0B95 \\u0BB5\\u0BC7\\u0BA3\\u0BCD\\u0B9F\\u0BC1\\u0BAE\\u0BCD")}case"invalid_format":{let a=t;return a.format==="starts_with"?'\\u0BA4\\u0BB5\\u0BB1\\u0BBE\\u0BA9 \\u0B9A\\u0BB0\\u0BAE\\u0BCD: "'.concat(a.prefix,'" \\u0B87\\u0BB2\\u0BCD \\u0BA4\\u0BCA\\u0B9F\\u0B99\\u0BCD\\u0B95 \\u0BB5\\u0BC7\\u0BA3\\u0BCD\\u0B9F\\u0BC1\\u0BAE\\u0BCD'):a.format==="ends_with"?'\\u0BA4\\u0BB5\\u0BB1\\u0BBE\\u0BA9 \\u0B9A\\u0BB0\\u0BAE\\u0BCD: "'.concat(a.suffix,'" \\u0B87\\u0BB2\\u0BCD \\u0BAE\\u0BC1\\u0B9F\\u0BBF\\u0BB5\\u0B9F\\u0BC8\\u0BAF \\u0BB5\\u0BC7\\u0BA3\\u0BCD\\u0B9F\\u0BC1\\u0BAE\\u0BCD'):a.format==="includes"?'\\u0BA4\\u0BB5\\u0BB1\\u0BBE\\u0BA9 \\u0B9A\\u0BB0\\u0BAE\\u0BCD: "'.concat(a.includes,'" \\u0B90 \\u0B89\\u0BB3\\u0BCD\\u0BB3\\u0B9F\\u0B95\\u0BCD\\u0B95 \\u0BB5\\u0BC7\\u0BA3\\u0BCD\\u0B9F\\u0BC1\\u0BAE\\u0BCD'):a.format==="regex"?"\\u0BA4\\u0BB5\\u0BB1\\u0BBE\\u0BA9 \\u0B9A\\u0BB0\\u0BAE\\u0BCD: ".concat(a.pattern," \\u0BAE\\u0BC1\\u0BB1\\u0BC8\\u0BAA\\u0BBE\\u0B9F\\u0BCD\\u0B9F\\u0BC1\\u0B9F\\u0BA9\\u0BCD \\u0BAA\\u0BCA\\u0BB0\\u0BC1\\u0BA8\\u0BCD\\u0BA4 \\u0BB5\\u0BC7\\u0BA3\\u0BCD\\u0B9F\\u0BC1\\u0BAE\\u0BCD"):"\\u0BA4\\u0BB5\\u0BB1\\u0BBE\\u0BA9 ".concat((c=i[a.format])!=null?c:t.format)}case"not_multiple_of":return"\\u0BA4\\u0BB5\\u0BB1\\u0BBE\\u0BA9 \\u0B8E\\u0BA3\\u0BCD: ".concat(t.divisor," \\u0B87\\u0BA9\\u0BCD \\u0BAA\\u0BB2\\u0BAE\\u0BBE\\u0B95 \\u0B87\\u0BB0\\u0BC1\\u0B95\\u0BCD\\u0B95 \\u0BB5\\u0BC7\\u0BA3\\u0BCD\\u0B9F\\u0BC1\\u0BAE\\u0BCD");case"unrecognized_keys":return"\\u0B85\\u0B9F\\u0BC8\\u0BAF\\u0BBE\\u0BB3\\u0BAE\\u0BCD \\u0BA4\\u0BC6\\u0BB0\\u0BBF\\u0BAF\\u0BBE\\u0BA4 \\u0BB5\\u0BBF\\u0B9A\\u0BC8".concat(t.keys.length>1?"\\u0B95\\u0BB3\\u0BCD":"",": ").concat(p(t.keys,", "));case"invalid_key":return"".concat(t.origin," \\u0B87\\u0BB2\\u0BCD \\u0BA4\\u0BB5\\u0BB1\\u0BBE\\u0BA9 \\u0BB5\\u0BBF\\u0B9A\\u0BC8");case"invalid_union":return"\\u0BA4\\u0BB5\\u0BB1\\u0BBE\\u0BA9 \\u0B89\\u0BB3\\u0BCD\\u0BB3\\u0BC0\\u0B9F\\u0BC1";case"invalid_element":return"".concat(t.origin," \\u0B87\\u0BB2\\u0BCD \\u0BA4\\u0BB5\\u0BB1\\u0BBE\\u0BA9 \\u0BAE\\u0BA4\\u0BBF\\u0BAA\\u0BCD\\u0BAA\\u0BC1");default:return"\\u0BA4\\u0BB5\\u0BB1\\u0BBE\\u0BA9 \\u0B89\\u0BB3\\u0BCD\\u0BB3\\u0BC0\\u0B9F\\u0BC1"}}};function dc(){return{localeError:md()}}var fd=()=>{let e={string:{unit:"\\u0E15\\u0E31\\u0E27\\u0E2D\\u0E31\\u0E01\\u0E29\\u0E23",verb:"\\u0E04\\u0E27\\u0E23\\u0E21\\u0E35"},file:{unit:"\\u0E44\\u0E1A\\u0E15\\u0E4C",verb:"\\u0E04\\u0E27\\u0E23\\u0E21\\u0E35"},array:{unit:"\\u0E23\\u0E32\\u0E22\\u0E01\\u0E32\\u0E23",verb:"\\u0E04\\u0E27\\u0E23\\u0E21\\u0E35"},set:{unit:"\\u0E23\\u0E32\\u0E22\\u0E01\\u0E32\\u0E23",verb:"\\u0E04\\u0E27\\u0E23\\u0E21\\u0E35"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"\\u0E44\\u0E21\\u0E48\\u0E43\\u0E0A\\u0E48\\u0E15\\u0E31\\u0E27\\u0E40\\u0E25\\u0E02 (NaN)":"\\u0E15\\u0E31\\u0E27\\u0E40\\u0E25\\u0E02";case"object":{if(Array.isArray(t))return"\\u0E2D\\u0E32\\u0E23\\u0E4C\\u0E40\\u0E23\\u0E22\\u0E4C (Array)";if(t===null)return"\\u0E44\\u0E21\\u0E48\\u0E21\\u0E35\\u0E04\\u0E48\\u0E32 (null)";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"\\u0E02\\u0E49\\u0E2D\\u0E21\\u0E39\\u0E25\\u0E17\\u0E35\\u0E48\\u0E1B\\u0E49\\u0E2D\\u0E19",email:"\\u0E17\\u0E35\\u0E48\\u0E2D\\u0E22\\u0E39\\u0E48\\u0E2D\\u0E35\\u0E40\\u0E21\\u0E25",url:"URL",emoji:"\\u0E2D\\u0E34\\u0E42\\u0E21\\u0E08\\u0E34",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"\\u0E27\\u0E31\\u0E19\\u0E17\\u0E35\\u0E48\\u0E40\\u0E27\\u0E25\\u0E32\\u0E41\\u0E1A\\u0E1A ISO",date:"\\u0E27\\u0E31\\u0E19\\u0E17\\u0E35\\u0E48\\u0E41\\u0E1A\\u0E1A ISO",time:"\\u0E40\\u0E27\\u0E25\\u0E32\\u0E41\\u0E1A\\u0E1A ISO",duration:"\\u0E0A\\u0E48\\u0E27\\u0E07\\u0E40\\u0E27\\u0E25\\u0E32\\u0E41\\u0E1A\\u0E1A ISO",ipv4:"\\u0E17\\u0E35\\u0E48\\u0E2D\\u0E22\\u0E39\\u0E48 IPv4",ipv6:"\\u0E17\\u0E35\\u0E48\\u0E2D\\u0E22\\u0E39\\u0E48 IPv6",cidrv4:"\\u0E0A\\u0E48\\u0E27\\u0E07 IP \\u0E41\\u0E1A\\u0E1A IPv4",cidrv6:"\\u0E0A\\u0E48\\u0E27\\u0E07 IP \\u0E41\\u0E1A\\u0E1A IPv6",base64:"\\u0E02\\u0E49\\u0E2D\\u0E04\\u0E27\\u0E32\\u0E21\\u0E41\\u0E1A\\u0E1A Base64",base64url:"\\u0E02\\u0E49\\u0E2D\\u0E04\\u0E27\\u0E32\\u0E21\\u0E41\\u0E1A\\u0E1A Base64 \\u0E2A\\u0E33\\u0E2B\\u0E23\\u0E31\\u0E1A URL",json_string:"\\u0E02\\u0E49\\u0E2D\\u0E04\\u0E27\\u0E32\\u0E21\\u0E41\\u0E1A\\u0E1A JSON",e164:"\\u0E40\\u0E1A\\u0E2D\\u0E23\\u0E4C\\u0E42\\u0E17\\u0E23\\u0E28\\u0E31\\u0E1E\\u0E17\\u0E4C\\u0E23\\u0E30\\u0E2B\\u0E27\\u0E48\\u0E32\\u0E07\\u0E1B\\u0E23\\u0E30\\u0E40\\u0E17\\u0E28 (E.164)",jwt:"\\u0E42\\u0E17\\u0E40\\u0E04\\u0E19 JWT",template_literal:"\\u0E02\\u0E49\\u0E2D\\u0E21\\u0E39\\u0E25\\u0E17\\u0E35\\u0E48\\u0E1B\\u0E49\\u0E2D\\u0E19"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"\\u0E1B\\u0E23\\u0E30\\u0E40\\u0E20\\u0E17\\u0E02\\u0E49\\u0E2D\\u0E21\\u0E39\\u0E25\\u0E44\\u0E21\\u0E48\\u0E16\\u0E39\\u0E01\\u0E15\\u0E49\\u0E2D\\u0E07: \\u0E04\\u0E27\\u0E23\\u0E40\\u0E1B\\u0E47\\u0E19 ".concat(t.expected," \\u0E41\\u0E15\\u0E48\\u0E44\\u0E14\\u0E49\\u0E23\\u0E31\\u0E1A ").concat(n(t.input));case"invalid_value":return t.values.length===1?"\\u0E04\\u0E48\\u0E32\\u0E44\\u0E21\\u0E48\\u0E16\\u0E39\\u0E01\\u0E15\\u0E49\\u0E2D\\u0E07: \\u0E04\\u0E27\\u0E23\\u0E40\\u0E1B\\u0E47\\u0E19 ".concat(b(t.values[0])):"\\u0E15\\u0E31\\u0E27\\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01\\u0E44\\u0E21\\u0E48\\u0E16\\u0E39\\u0E01\\u0E15\\u0E49\\u0E2D\\u0E07: \\u0E04\\u0E27\\u0E23\\u0E40\\u0E1B\\u0E47\\u0E19\\u0E2B\\u0E19\\u0E36\\u0E48\\u0E07\\u0E43\\u0E19 ".concat(p(t.values,"|"));case"too_big":{let a=t.inclusive?"\\u0E44\\u0E21\\u0E48\\u0E40\\u0E01\\u0E34\\u0E19":"\\u0E19\\u0E49\\u0E2D\\u0E22\\u0E01\\u0E27\\u0E48\\u0E32",s=r(t.origin);return s?"\\u0E40\\u0E01\\u0E34\\u0E19\\u0E01\\u0E33\\u0E2B\\u0E19\\u0E14: ".concat((o=t.origin)!=null?o:"\\u0E04\\u0E48\\u0E32"," \\u0E04\\u0E27\\u0E23\\u0E21\\u0E35").concat(a," ").concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"\\u0E23\\u0E32\\u0E22\\u0E01\\u0E32\\u0E23"):"\\u0E40\\u0E01\\u0E34\\u0E19\\u0E01\\u0E33\\u0E2B\\u0E19\\u0E14: ".concat((l=t.origin)!=null?l:"\\u0E04\\u0E48\\u0E32"," \\u0E04\\u0E27\\u0E23\\u0E21\\u0E35").concat(a," ").concat(t.maximum.toString())}case"too_small":{let a=t.inclusive?"\\u0E2D\\u0E22\\u0E48\\u0E32\\u0E07\\u0E19\\u0E49\\u0E2D\\u0E22":"\\u0E21\\u0E32\\u0E01\\u0E01\\u0E27\\u0E48\\u0E32",s=r(t.origin);return s?"\\u0E19\\u0E49\\u0E2D\\u0E22\\u0E01\\u0E27\\u0E48\\u0E32\\u0E01\\u0E33\\u0E2B\\u0E19\\u0E14: ".concat(t.origin," \\u0E04\\u0E27\\u0E23\\u0E21\\u0E35").concat(a," ").concat(t.minimum.toString()," ").concat(s.unit):"\\u0E19\\u0E49\\u0E2D\\u0E22\\u0E01\\u0E27\\u0E48\\u0E32\\u0E01\\u0E33\\u0E2B\\u0E19\\u0E14: ".concat(t.origin," \\u0E04\\u0E27\\u0E23\\u0E21\\u0E35").concat(a," ").concat(t.minimum.toString())}case"invalid_format":{let a=t;return a.format==="starts_with"?'\\u0E23\\u0E39\\u0E1B\\u0E41\\u0E1A\\u0E1A\\u0E44\\u0E21\\u0E48\\u0E16\\u0E39\\u0E01\\u0E15\\u0E49\\u0E2D\\u0E07: \\u0E02\\u0E49\\u0E2D\\u0E04\\u0E27\\u0E32\\u0E21\\u0E15\\u0E49\\u0E2D\\u0E07\\u0E02\\u0E36\\u0E49\\u0E19\\u0E15\\u0E49\\u0E19\\u0E14\\u0E49\\u0E27\\u0E22 "'.concat(a.prefix,'"'):a.format==="ends_with"?'\\u0E23\\u0E39\\u0E1B\\u0E41\\u0E1A\\u0E1A\\u0E44\\u0E21\\u0E48\\u0E16\\u0E39\\u0E01\\u0E15\\u0E49\\u0E2D\\u0E07: \\u0E02\\u0E49\\u0E2D\\u0E04\\u0E27\\u0E32\\u0E21\\u0E15\\u0E49\\u0E2D\\u0E07\\u0E25\\u0E07\\u0E17\\u0E49\\u0E32\\u0E22\\u0E14\\u0E49\\u0E27\\u0E22 "'.concat(a.suffix,'"'):a.format==="includes"?'\\u0E23\\u0E39\\u0E1B\\u0E41\\u0E1A\\u0E1A\\u0E44\\u0E21\\u0E48\\u0E16\\u0E39\\u0E01\\u0E15\\u0E49\\u0E2D\\u0E07: \\u0E02\\u0E49\\u0E2D\\u0E04\\u0E27\\u0E32\\u0E21\\u0E15\\u0E49\\u0E2D\\u0E07\\u0E21\\u0E35 "'.concat(a.includes,'" \\u0E2D\\u0E22\\u0E39\\u0E48\\u0E43\\u0E19\\u0E02\\u0E49\\u0E2D\\u0E04\\u0E27\\u0E32\\u0E21'):a.format==="regex"?"\\u0E23\\u0E39\\u0E1B\\u0E41\\u0E1A\\u0E1A\\u0E44\\u0E21\\u0E48\\u0E16\\u0E39\\u0E01\\u0E15\\u0E49\\u0E2D\\u0E07: \\u0E15\\u0E49\\u0E2D\\u0E07\\u0E15\\u0E23\\u0E07\\u0E01\\u0E31\\u0E1A\\u0E23\\u0E39\\u0E1B\\u0E41\\u0E1A\\u0E1A\\u0E17\\u0E35\\u0E48\\u0E01\\u0E33\\u0E2B\\u0E19\\u0E14 ".concat(a.pattern):"\\u0E23\\u0E39\\u0E1B\\u0E41\\u0E1A\\u0E1A\\u0E44\\u0E21\\u0E48\\u0E16\\u0E39\\u0E01\\u0E15\\u0E49\\u0E2D\\u0E07: ".concat((c=i[a.format])!=null?c:t.format)}case"not_multiple_of":return"\\u0E15\\u0E31\\u0E27\\u0E40\\u0E25\\u0E02\\u0E44\\u0E21\\u0E48\\u0E16\\u0E39\\u0E01\\u0E15\\u0E49\\u0E2D\\u0E07: \\u0E15\\u0E49\\u0E2D\\u0E07\\u0E40\\u0E1B\\u0E47\\u0E19\\u0E08\\u0E33\\u0E19\\u0E27\\u0E19\\u0E17\\u0E35\\u0E48\\u0E2B\\u0E32\\u0E23\\u0E14\\u0E49\\u0E27\\u0E22 ".concat(t.divisor," \\u0E44\\u0E14\\u0E49\\u0E25\\u0E07\\u0E15\\u0E31\\u0E27");case"unrecognized_keys":return"\\u0E1E\\u0E1A\\u0E04\\u0E35\\u0E22\\u0E4C\\u0E17\\u0E35\\u0E48\\u0E44\\u0E21\\u0E48\\u0E23\\u0E39\\u0E49\\u0E08\\u0E31\\u0E01: ".concat(p(t.keys,", "));case"invalid_key":return"\\u0E04\\u0E35\\u0E22\\u0E4C\\u0E44\\u0E21\\u0E48\\u0E16\\u0E39\\u0E01\\u0E15\\u0E49\\u0E2D\\u0E07\\u0E43\\u0E19 ".concat(t.origin);case"invalid_union":return"\\u0E02\\u0E49\\u0E2D\\u0E21\\u0E39\\u0E25\\u0E44\\u0E21\\u0E48\\u0E16\\u0E39\\u0E01\\u0E15\\u0E49\\u0E2D\\u0E07: \\u0E44\\u0E21\\u0E48\\u0E15\\u0E23\\u0E07\\u0E01\\u0E31\\u0E1A\\u0E23\\u0E39\\u0E1B\\u0E41\\u0E1A\\u0E1A\\u0E22\\u0E39\\u0E40\\u0E19\\u0E35\\u0E22\\u0E19\\u0E17\\u0E35\\u0E48\\u0E01\\u0E33\\u0E2B\\u0E19\\u0E14\\u0E44\\u0E27\\u0E49";case"invalid_element":return"\\u0E02\\u0E49\\u0E2D\\u0E21\\u0E39\\u0E25\\u0E44\\u0E21\\u0E48\\u0E16\\u0E39\\u0E01\\u0E15\\u0E49\\u0E2D\\u0E07\\u0E43\\u0E19 ".concat(t.origin);default:return"\\u0E02\\u0E49\\u0E2D\\u0E21\\u0E39\\u0E25\\u0E44\\u0E21\\u0E48\\u0E16\\u0E39\\u0E01\\u0E15\\u0E49\\u0E2D\\u0E07"}}};function mc(){return{localeError:fd()}}var pd=e=>{let r=typeof e;switch(r){case"number":return Number.isNaN(e)?"NaN":"number";case"object":{if(Array.isArray(e))return"array";if(e===null)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}}return r},gd=()=>{let e={string:{unit:"karakter",verb:"olmal\\u0131"},file:{unit:"bayt",verb:"olmal\\u0131"},array:{unit:"\\xF6\\u011Fe",verb:"olmal\\u0131"},set:{unit:"\\xF6\\u011Fe",verb:"olmal\\u0131"}};function r(i){var t;return(t=e[i])!=null?t:null}let n={regex:"girdi",email:"e-posta adresi",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO tarih ve saat",date:"ISO tarih",time:"ISO saat",duration:"ISO s\\xFCre",ipv4:"IPv4 adresi",ipv6:"IPv6 adresi",cidrv4:"IPv4 aral\\u0131\\u011F\\u0131",cidrv6:"IPv6 aral\\u0131\\u011F\\u0131",base64:"base64 ile \\u015Fifrelenmi\\u015F metin",base64url:"base64url ile \\u015Fifrelenmi\\u015F metin",json_string:"JSON dizesi",e164:"E.164 say\\u0131s\\u0131",jwt:"JWT",template_literal:"\\u015Eablon dizesi"};return i=>{var t,o,u,l;switch(i.code){case"invalid_type":return"Ge\\xE7ersiz de\\u011Fer: beklenen ".concat(i.expected,", al\\u0131nan ").concat(pd(i.input));case"invalid_value":return i.values.length===1?"Ge\\xE7ersiz de\\u011Fer: beklenen ".concat(b(i.values[0])):"Ge\\xE7ersiz se\\xE7enek: a\\u015Fa\\u011F\\u0131dakilerden biri olmal\\u0131: ".concat(p(i.values,"|"));case"too_big":{let c=i.inclusive?"<=":"<",a=r(i.origin);return a?"\\xC7ok b\\xFCy\\xFCk: beklenen ".concat((t=i.origin)!=null?t:"de\\u011Fer"," ").concat(c).concat(i.maximum.toString()," ").concat((o=a.unit)!=null?o:"\\xF6\\u011Fe"):"\\xC7ok b\\xFCy\\xFCk: beklenen ".concat((u=i.origin)!=null?u:"de\\u011Fer"," ").concat(c).concat(i.maximum.toString())}case"too_small":{let c=i.inclusive?">=":">",a=r(i.origin);return a?"\\xC7ok k\\xFC\\xE7\\xFCk: beklenen ".concat(i.origin," ").concat(c).concat(i.minimum.toString()," ").concat(a.unit):"\\xC7ok k\\xFC\\xE7\\xFCk: beklenen ".concat(i.origin," ").concat(c).concat(i.minimum.toString())}case"invalid_format":{let c=i;return c.format==="starts_with"?'Ge\\xE7ersiz metin: "'.concat(c.prefix,'" ile ba\\u015Flamal\\u0131'):c.format==="ends_with"?'Ge\\xE7ersiz metin: "'.concat(c.suffix,'" ile bitmeli'):c.format==="includes"?'Ge\\xE7ersiz metin: "'.concat(c.includes,'" i\\xE7ermeli'):c.format==="regex"?"Ge\\xE7ersiz metin: ".concat(c.pattern," desenine uymal\\u0131"):"Ge\\xE7ersiz ".concat((l=n[c.format])!=null?l:i.format)}case"not_multiple_of":return"Ge\\xE7ersiz say\\u0131: ".concat(i.divisor," ile tam b\\xF6l\\xFCnebilmeli");case"unrecognized_keys":return"Tan\\u0131nmayan anahtar".concat(i.keys.length>1?"lar":"",": ").concat(p(i.keys,", "));case"invalid_key":return"".concat(i.origin," i\\xE7inde ge\\xE7ersiz anahtar");case"invalid_union":return"Ge\\xE7ersiz de\\u011Fer";case"invalid_element":return"".concat(i.origin," i\\xE7inde ge\\xE7ersiz de\\u011Fer");default:return"Ge\\xE7ersiz de\\u011Fer"}}};function fc(){return{localeError:gd()}}var vd=()=>{let e={string:{unit:"\\u0441\\u0438\\u043C\\u0432\\u043E\\u043B\\u0456\\u0432",verb:"\\u043C\\u0430\\u0442\\u0438\\u043C\\u0435"},file:{unit:"\\u0431\\u0430\\u0439\\u0442\\u0456\\u0432",verb:"\\u043C\\u0430\\u0442\\u0438\\u043C\\u0435"},array:{unit:"\\u0435\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442\\u0456\\u0432",verb:"\\u043C\\u0430\\u0442\\u0438\\u043C\\u0435"},set:{unit:"\\u0435\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442\\u0456\\u0432",verb:"\\u043C\\u0430\\u0442\\u0438\\u043C\\u0435"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"\\u0447\\u0438\\u0441\\u043B\\u043E";case"object":{if(Array.isArray(t))return"\\u043C\\u0430\\u0441\\u0438\\u0432";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"\\u0432\\u0445\\u0456\\u0434\\u043D\\u0456 \\u0434\\u0430\\u043D\\u0456",email:"\\u0430\\u0434\\u0440\\u0435\\u0441\\u0430 \\u0435\\u043B\\u0435\\u043A\\u0442\\u0440\\u043E\\u043D\\u043D\\u043E\\u0457 \\u043F\\u043E\\u0448\\u0442\\u0438",url:"URL",emoji:"\\u0435\\u043C\\u043E\\u0434\\u0437\\u0456",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"\\u0434\\u0430\\u0442\\u0430 \\u0442\\u0430 \\u0447\\u0430\\u0441 ISO",date:"\\u0434\\u0430\\u0442\\u0430 ISO",time:"\\u0447\\u0430\\u0441 ISO",duration:"\\u0442\\u0440\\u0438\\u0432\\u0430\\u043B\\u0456\\u0441\\u0442\\u044C ISO",ipv4:"\\u0430\\u0434\\u0440\\u0435\\u0441\\u0430 IPv4",ipv6:"\\u0430\\u0434\\u0440\\u0435\\u0441\\u0430 IPv6",cidrv4:"\\u0434\\u0456\\u0430\\u043F\\u0430\\u0437\\u043E\\u043D IPv4",cidrv6:"\\u0434\\u0456\\u0430\\u043F\\u0430\\u0437\\u043E\\u043D IPv6",base64:"\\u0440\\u044F\\u0434\\u043E\\u043A \\u0443 \\u043A\\u043E\\u0434\\u0443\\u0432\\u0430\\u043D\\u043D\\u0456 base64",base64url:"\\u0440\\u044F\\u0434\\u043E\\u043A \\u0443 \\u043A\\u043E\\u0434\\u0443\\u0432\\u0430\\u043D\\u043D\\u0456 base64url",json_string:"\\u0440\\u044F\\u0434\\u043E\\u043A JSON",e164:"\\u043D\\u043E\\u043C\\u0435\\u0440 E.164",jwt:"JWT",template_literal:"\\u0432\\u0445\\u0456\\u0434\\u043D\\u0456 \\u0434\\u0430\\u043D\\u0456"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"\\u041D\\u0435\\u043F\\u0440\\u0430\\u0432\\u0438\\u043B\\u044C\\u043D\\u0456 \\u0432\\u0445\\u0456\\u0434\\u043D\\u0456 \\u0434\\u0430\\u043D\\u0456: \\u043E\\u0447\\u0456\\u043A\\u0443\\u0454\\u0442\\u044C\\u0441\\u044F ".concat(t.expected,", \\u043E\\u0442\\u0440\\u0438\\u043C\\u0430\\u043D\\u043E ").concat(n(t.input));case"invalid_value":return t.values.length===1?"\\u041D\\u0435\\u043F\\u0440\\u0430\\u0432\\u0438\\u043B\\u044C\\u043D\\u0456 \\u0432\\u0445\\u0456\\u0434\\u043D\\u0456 \\u0434\\u0430\\u043D\\u0456: \\u043E\\u0447\\u0456\\u043A\\u0443\\u0454\\u0442\\u044C\\u0441\\u044F ".concat(b(t.values[0])):"\\u041D\\u0435\\u043F\\u0440\\u0430\\u0432\\u0438\\u043B\\u044C\\u043D\\u0430 \\u043E\\u043F\\u0446\\u0456\\u044F: \\u043E\\u0447\\u0456\\u043A\\u0443\\u0454\\u0442\\u044C\\u0441\\u044F \\u043E\\u0434\\u043D\\u0435 \\u0437 ".concat(p(t.values,"|"));case"too_big":{let a=t.inclusive?"<=":"<",s=r(t.origin);return s?"\\u0417\\u0430\\u043D\\u0430\\u0434\\u0442\\u043E \\u0432\\u0435\\u043B\\u0438\\u043A\\u0435: \\u043E\\u0447\\u0456\\u043A\\u0443\\u0454\\u0442\\u044C\\u0441\\u044F, \\u0449\\u043E ".concat((o=t.origin)!=null?o:"\\u0437\\u043D\\u0430\\u0447\\u0435\\u043D\\u043D\\u044F"," ").concat(s.verb," ").concat(a).concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"\\u0435\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442\\u0456\\u0432"):"\\u0417\\u0430\\u043D\\u0430\\u0434\\u0442\\u043E \\u0432\\u0435\\u043B\\u0438\\u043A\\u0435: \\u043E\\u0447\\u0456\\u043A\\u0443\\u0454\\u0442\\u044C\\u0441\\u044F, \\u0449\\u043E ".concat((l=t.origin)!=null?l:"\\u0437\\u043D\\u0430\\u0447\\u0435\\u043D\\u043D\\u044F"," \\u0431\\u0443\\u0434\\u0435 ").concat(a).concat(t.maximum.toString())}case"too_small":{let a=t.inclusive?">=":">",s=r(t.origin);return s?"\\u0417\\u0430\\u043D\\u0430\\u0434\\u0442\\u043E \\u043C\\u0430\\u043B\\u0435: \\u043E\\u0447\\u0456\\u043A\\u0443\\u0454\\u0442\\u044C\\u0441\\u044F, \\u0449\\u043E ".concat(t.origin," ").concat(s.verb," ").concat(a).concat(t.minimum.toString()," ").concat(s.unit):"\\u0417\\u0430\\u043D\\u0430\\u0434\\u0442\\u043E \\u043C\\u0430\\u043B\\u0435: \\u043E\\u0447\\u0456\\u043A\\u0443\\u0454\\u0442\\u044C\\u0441\\u044F, \\u0449\\u043E ".concat(t.origin," \\u0431\\u0443\\u0434\\u0435 ").concat(a).concat(t.minimum.toString())}case"invalid_format":{let a=t;return a.format==="starts_with"?'\\u041D\\u0435\\u043F\\u0440\\u0430\\u0432\\u0438\\u043B\\u044C\\u043D\\u0438\\u0439 \\u0440\\u044F\\u0434\\u043E\\u043A: \\u043F\\u043E\\u0432\\u0438\\u043D\\u0435\\u043D \\u043F\\u043E\\u0447\\u0438\\u043D\\u0430\\u0442\\u0438\\u0441\\u044F \\u0437 "'.concat(a.prefix,'"'):a.format==="ends_with"?'\\u041D\\u0435\\u043F\\u0440\\u0430\\u0432\\u0438\\u043B\\u044C\\u043D\\u0438\\u0439 \\u0440\\u044F\\u0434\\u043E\\u043A: \\u043F\\u043E\\u0432\\u0438\\u043D\\u0435\\u043D \\u0437\\u0430\\u043A\\u0456\\u043D\\u0447\\u0443\\u0432\\u0430\\u0442\\u0438\\u0441\\u044F \\u043D\\u0430 "'.concat(a.suffix,'"'):a.format==="includes"?'\\u041D\\u0435\\u043F\\u0440\\u0430\\u0432\\u0438\\u043B\\u044C\\u043D\\u0438\\u0439 \\u0440\\u044F\\u0434\\u043E\\u043A: \\u043F\\u043E\\u0432\\u0438\\u043D\\u0435\\u043D \\u043C\\u0456\\u0441\\u0442\\u0438\\u0442\\u0438 "'.concat(a.includes,'"'):a.format==="regex"?"\\u041D\\u0435\\u043F\\u0440\\u0430\\u0432\\u0438\\u043B\\u044C\\u043D\\u0438\\u0439 \\u0440\\u044F\\u0434\\u043E\\u043A: \\u043F\\u043E\\u0432\\u0438\\u043D\\u0435\\u043D \\u0432\\u0456\\u0434\\u043F\\u043E\\u0432\\u0456\\u0434\\u0430\\u0442\\u0438 \\u0448\\u0430\\u0431\\u043B\\u043E\\u043D\\u0443 ".concat(a.pattern):"\\u041D\\u0435\\u043F\\u0440\\u0430\\u0432\\u0438\\u043B\\u044C\\u043D\\u0438\\u0439 ".concat((c=i[a.format])!=null?c:t.format)}case"not_multiple_of":return"\\u041D\\u0435\\u043F\\u0440\\u0430\\u0432\\u0438\\u043B\\u044C\\u043D\\u0435 \\u0447\\u0438\\u0441\\u043B\\u043E: \\u043F\\u043E\\u0432\\u0438\\u043D\\u043D\\u043E \\u0431\\u0443\\u0442\\u0438 \\u043A\\u0440\\u0430\\u0442\\u043D\\u0438\\u043C ".concat(t.divisor);case"unrecognized_keys":return"\\u041D\\u0435\\u0440\\u043E\\u0437\\u043F\\u0456\\u0437\\u043D\\u0430\\u043D\\u0438\\u0439 \\u043A\\u043B\\u044E\\u0447".concat(t.keys.length>1?"\\u0456":"",": ").concat(p(t.keys,", "));case"invalid_key":return"\\u041D\\u0435\\u043F\\u0440\\u0430\\u0432\\u0438\\u043B\\u044C\\u043D\\u0438\\u0439 \\u043A\\u043B\\u044E\\u0447 \\u0443 ".concat(t.origin);case"invalid_union":return"\\u041D\\u0435\\u043F\\u0440\\u0430\\u0432\\u0438\\u043B\\u044C\\u043D\\u0456 \\u0432\\u0445\\u0456\\u0434\\u043D\\u0456 \\u0434\\u0430\\u043D\\u0456";case"invalid_element":return"\\u041D\\u0435\\u043F\\u0440\\u0430\\u0432\\u0438\\u043B\\u044C\\u043D\\u0435 \\u0437\\u043D\\u0430\\u0447\\u0435\\u043D\\u043D\\u044F \\u0443 ".concat(t.origin);default:return"\\u041D\\u0435\\u043F\\u0440\\u0430\\u0432\\u0438\\u043B\\u044C\\u043D\\u0456 \\u0432\\u0445\\u0456\\u0434\\u043D\\u0456 \\u0434\\u0430\\u043D\\u0456"}}};function nr(){return{localeError:vd()}}function pc(){return nr()}var hd=()=>{let e={string:{unit:"\\u062D\\u0631\\u0648\\u0641",verb:"\\u06C1\\u0648\\u0646\\u0627"},file:{unit:"\\u0628\\u0627\\u0626\\u0679\\u0633",verb:"\\u06C1\\u0648\\u0646\\u0627"},array:{unit:"\\u0622\\u0626\\u0679\\u0645\\u0632",verb:"\\u06C1\\u0648\\u0646\\u0627"},set:{unit:"\\u0622\\u0626\\u0679\\u0645\\u0632",verb:"\\u06C1\\u0648\\u0646\\u0627"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"\\u0646\\u0645\\u0628\\u0631";case"object":{if(Array.isArray(t))return"\\u0622\\u0631\\u06D2";if(t===null)return"\\u0646\\u0644";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"\\u0627\\u0646 \\u067E\\u0679",email:"\\u0627\\u06CC \\u0645\\u06CC\\u0644 \\u0627\\u06CC\\u0688\\u0631\\u06CC\\u0633",url:"\\u06CC\\u0648 \\u0622\\u0631 \\u0627\\u06CC\\u0644",emoji:"\\u0627\\u06CC\\u0645\\u0648\\u062C\\u06CC",uuid:"\\u06CC\\u0648 \\u06CC\\u0648 \\u0622\\u0626\\u06CC \\u0688\\u06CC",uuidv4:"\\u06CC\\u0648 \\u06CC\\u0648 \\u0622\\u0626\\u06CC \\u0688\\u06CC \\u0648\\u06CC 4",uuidv6:"\\u06CC\\u0648 \\u06CC\\u0648 \\u0622\\u0626\\u06CC \\u0688\\u06CC \\u0648\\u06CC 6",nanoid:"\\u0646\\u06CC\\u0646\\u0648 \\u0622\\u0626\\u06CC \\u0688\\u06CC",guid:"\\u062C\\u06CC \\u06CC\\u0648 \\u0622\\u0626\\u06CC \\u0688\\u06CC",cuid:"\\u0633\\u06CC \\u06CC\\u0648 \\u0622\\u0626\\u06CC \\u0688\\u06CC",cuid2:"\\u0633\\u06CC \\u06CC\\u0648 \\u0622\\u0626\\u06CC \\u0688\\u06CC 2",ulid:"\\u06CC\\u0648 \\u0627\\u06CC\\u0644 \\u0622\\u0626\\u06CC \\u0688\\u06CC",xid:"\\u0627\\u06CC\\u06A9\\u0633 \\u0622\\u0626\\u06CC \\u0688\\u06CC",ksuid:"\\u06A9\\u06D2 \\u0627\\u06CC\\u0633 \\u06CC\\u0648 \\u0622\\u0626\\u06CC \\u0688\\u06CC",datetime:"\\u0622\\u0626\\u06CC \\u0627\\u06CC\\u0633 \\u0627\\u0648 \\u0688\\u06CC\\u0679 \\u0679\\u0627\\u0626\\u0645",date:"\\u0622\\u0626\\u06CC \\u0627\\u06CC\\u0633 \\u0627\\u0648 \\u062A\\u0627\\u0631\\u06CC\\u062E",time:"\\u0622\\u0626\\u06CC \\u0627\\u06CC\\u0633 \\u0627\\u0648 \\u0648\\u0642\\u062A",duration:"\\u0622\\u0626\\u06CC \\u0627\\u06CC\\u0633 \\u0627\\u0648 \\u0645\\u062F\\u062A",ipv4:"\\u0622\\u0626\\u06CC \\u067E\\u06CC \\u0648\\u06CC 4 \\u0627\\u06CC\\u0688\\u0631\\u06CC\\u0633",ipv6:"\\u0622\\u0626\\u06CC \\u067E\\u06CC \\u0648\\u06CC 6 \\u0627\\u06CC\\u0688\\u0631\\u06CC\\u0633",cidrv4:"\\u0622\\u0626\\u06CC \\u067E\\u06CC \\u0648\\u06CC 4 \\u0631\\u06CC\\u0646\\u062C",cidrv6:"\\u0622\\u0626\\u06CC \\u067E\\u06CC \\u0648\\u06CC 6 \\u0631\\u06CC\\u0646\\u062C",base64:"\\u0628\\u06CC\\u0633 64 \\u0627\\u0646 \\u06A9\\u0648\\u0688\\u0688 \\u0633\\u0679\\u0631\\u0646\\u06AF",base64url:"\\u0628\\u06CC\\u0633 64 \\u06CC\\u0648 \\u0622\\u0631 \\u0627\\u06CC\\u0644 \\u0627\\u0646 \\u06A9\\u0648\\u0688\\u0688 \\u0633\\u0679\\u0631\\u0646\\u06AF",json_string:"\\u062C\\u06D2 \\u0627\\u06CC\\u0633 \\u0627\\u0648 \\u0627\\u06CC\\u0646 \\u0633\\u0679\\u0631\\u0646\\u06AF",e164:"\\u0627\\u06CC 164 \\u0646\\u0645\\u0628\\u0631",jwt:"\\u062C\\u06D2 \\u0688\\u0628\\u0644\\u06CC\\u0648 \\u0679\\u06CC",template_literal:"\\u0627\\u0646 \\u067E\\u0679"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"\\u063A\\u0644\\u0637 \\u0627\\u0646 \\u067E\\u0679: ".concat(t.expected," \\u0645\\u062A\\u0648\\u0642\\u0639 \\u062A\\u06BE\\u0627\\u060C ").concat(n(t.input)," \\u0645\\u0648\\u0635\\u0648\\u0644 \\u06C1\\u0648\\u0627");case"invalid_value":return t.values.length===1?"\\u063A\\u0644\\u0637 \\u0627\\u0646 \\u067E\\u0679: ".concat(b(t.values[0])," \\u0645\\u062A\\u0648\\u0642\\u0639 \\u062A\\u06BE\\u0627"):"\\u063A\\u0644\\u0637 \\u0622\\u067E\\u0634\\u0646: ".concat(p(t.values,"|")," \\u0645\\u06CC\\u06BA \\u0633\\u06D2 \\u0627\\u06CC\\u06A9 \\u0645\\u062A\\u0648\\u0642\\u0639 \\u062A\\u06BE\\u0627");case"too_big":{let a=t.inclusive?"<=":"<",s=r(t.origin);return s?"\\u0628\\u06C1\\u062A \\u0628\\u0691\\u0627: ".concat((o=t.origin)!=null?o:"\\u0648\\u06CC\\u0644\\u06CC\\u0648"," \\u06A9\\u06D2 ").concat(a).concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"\\u0639\\u0646\\u0627\\u0635\\u0631"," \\u06C1\\u0648\\u0646\\u06D2 \\u0645\\u062A\\u0648\\u0642\\u0639 \\u062A\\u06BE\\u06D2"):"\\u0628\\u06C1\\u062A \\u0628\\u0691\\u0627: ".concat((l=t.origin)!=null?l:"\\u0648\\u06CC\\u0644\\u06CC\\u0648"," \\u06A9\\u0627 ").concat(a).concat(t.maximum.toString()," \\u06C1\\u0648\\u0646\\u0627 \\u0645\\u062A\\u0648\\u0642\\u0639 \\u062A\\u06BE\\u0627")}case"too_small":{let a=t.inclusive?">=":">",s=r(t.origin);return s?"\\u0628\\u06C1\\u062A \\u0686\\u06BE\\u0648\\u0679\\u0627: ".concat(t.origin," \\u06A9\\u06D2 ").concat(a).concat(t.minimum.toString()," ").concat(s.unit," \\u06C1\\u0648\\u0646\\u06D2 \\u0645\\u062A\\u0648\\u0642\\u0639 \\u062A\\u06BE\\u06D2"):"\\u0628\\u06C1\\u062A \\u0686\\u06BE\\u0648\\u0679\\u0627: ".concat(t.origin," \\u06A9\\u0627 ").concat(a).concat(t.minimum.toString()," \\u06C1\\u0648\\u0646\\u0627 \\u0645\\u062A\\u0648\\u0642\\u0639 \\u062A\\u06BE\\u0627")}case"invalid_format":{let a=t;return a.format==="starts_with"?'\\u063A\\u0644\\u0637 \\u0633\\u0679\\u0631\\u0646\\u06AF: "'.concat(a.prefix,'" \\u0633\\u06D2 \\u0634\\u0631\\u0648\\u0639 \\u06C1\\u0648\\u0646\\u0627 \\u0686\\u0627\\u06C1\\u06CC\\u06D2'):a.format==="ends_with"?'\\u063A\\u0644\\u0637 \\u0633\\u0679\\u0631\\u0646\\u06AF: "'.concat(a.suffix,'" \\u067E\\u0631 \\u062E\\u062A\\u0645 \\u06C1\\u0648\\u0646\\u0627 \\u0686\\u0627\\u06C1\\u06CC\\u06D2'):a.format==="includes"?'\\u063A\\u0644\\u0637 \\u0633\\u0679\\u0631\\u0646\\u06AF: "'.concat(a.includes,'" \\u0634\\u0627\\u0645\\u0644 \\u06C1\\u0648\\u0646\\u0627 \\u0686\\u0627\\u06C1\\u06CC\\u06D2'):a.format==="regex"?"\\u063A\\u0644\\u0637 \\u0633\\u0679\\u0631\\u0646\\u06AF: \\u067E\\u06CC\\u0679\\u0631\\u0646 ".concat(a.pattern," \\u0633\\u06D2 \\u0645\\u06CC\\u0686 \\u06C1\\u0648\\u0646\\u0627 \\u0686\\u0627\\u06C1\\u06CC\\u06D2"):"\\u063A\\u0644\\u0637 ".concat((c=i[a.format])!=null?c:t.format)}case"not_multiple_of":return"\\u063A\\u0644\\u0637 \\u0646\\u0645\\u0628\\u0631: ".concat(t.divisor," \\u06A9\\u0627 \\u0645\\u0636\\u0627\\u0639\\u0641 \\u06C1\\u0648\\u0646\\u0627 \\u0686\\u0627\\u06C1\\u06CC\\u06D2");case"unrecognized_keys":return"\\u063A\\u06CC\\u0631 \\u062A\\u0633\\u0644\\u06CC\\u0645 \\u0634\\u062F\\u06C1 \\u06A9\\u06CC".concat(t.keys.length>1?"\\u0632":"",": ").concat(p(t.keys,"\\u060C "));case"invalid_key":return"".concat(t.origin," \\u0645\\u06CC\\u06BA \\u063A\\u0644\\u0637 \\u06A9\\u06CC");case"invalid_union":return"\\u063A\\u0644\\u0637 \\u0627\\u0646 \\u067E\\u0679";case"invalid_element":return"".concat(t.origin," \\u0645\\u06CC\\u06BA \\u063A\\u0644\\u0637 \\u0648\\u06CC\\u0644\\u06CC\\u0648");default:return"\\u063A\\u0644\\u0637 \\u0627\\u0646 \\u067E\\u0679"}}};function gc(){return{localeError:hd()}}var $d=()=>{let e={string:{unit:"k\\xFD t\\u1EF1",verb:"c\\xF3"},file:{unit:"byte",verb:"c\\xF3"},array:{unit:"ph\\u1EA7n t\\u1EED",verb:"c\\xF3"},set:{unit:"ph\\u1EA7n t\\u1EED",verb:"c\\xF3"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"s\\u1ED1";case"object":{if(Array.isArray(t))return"m\\u1EA3ng";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"\\u0111\\u1EA7u v\\xE0o",email:"\\u0111\\u1ECBa ch\\u1EC9 email",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ng\\xE0y gi\\u1EDD ISO",date:"ng\\xE0y ISO",time:"gi\\u1EDD ISO",duration:"kho\\u1EA3ng th\\u1EDDi gian ISO",ipv4:"\\u0111\\u1ECBa ch\\u1EC9 IPv4",ipv6:"\\u0111\\u1ECBa ch\\u1EC9 IPv6",cidrv4:"d\\u1EA3i IPv4",cidrv6:"d\\u1EA3i IPv6",base64:"chu\\u1ED7i m\\xE3 h\\xF3a base64",base64url:"chu\\u1ED7i m\\xE3 h\\xF3a base64url",json_string:"chu\\u1ED7i JSON",e164:"s\\u1ED1 E.164",jwt:"JWT",template_literal:"\\u0111\\u1EA7u v\\xE0o"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"\\u0110\\u1EA7u v\\xE0o kh\\xF4ng h\\u1EE3p l\\u1EC7: mong \\u0111\\u1EE3i ".concat(t.expected,", nh\\u1EADn \\u0111\\u01B0\\u1EE3c ").concat(n(t.input));case"invalid_value":return t.values.length===1?"\\u0110\\u1EA7u v\\xE0o kh\\xF4ng h\\u1EE3p l\\u1EC7: mong \\u0111\\u1EE3i ".concat(b(t.values[0])):"T\\xF9y ch\\u1ECDn kh\\xF4ng h\\u1EE3p l\\u1EC7: mong \\u0111\\u1EE3i m\\u1ED9t trong c\\xE1c gi\\xE1 tr\\u1ECB ".concat(p(t.values,"|"));case"too_big":{let a=t.inclusive?"<=":"<",s=r(t.origin);return s?"Qu\\xE1 l\\u1EDBn: mong \\u0111\\u1EE3i ".concat((o=t.origin)!=null?o:"gi\\xE1 tr\\u1ECB"," ").concat(s.verb," ").concat(a).concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"ph\\u1EA7n t\\u1EED"):"Qu\\xE1 l\\u1EDBn: mong \\u0111\\u1EE3i ".concat((l=t.origin)!=null?l:"gi\\xE1 tr\\u1ECB"," ").concat(a).concat(t.maximum.toString())}case"too_small":{let a=t.inclusive?">=":">",s=r(t.origin);return s?"Qu\\xE1 nh\\u1ECF: mong \\u0111\\u1EE3i ".concat(t.origin," ").concat(s.verb," ").concat(a).concat(t.minimum.toString()," ").concat(s.unit):"Qu\\xE1 nh\\u1ECF: mong \\u0111\\u1EE3i ".concat(t.origin," ").concat(a).concat(t.minimum.toString())}case"invalid_format":{let a=t;return a.format==="starts_with"?'Chu\\u1ED7i kh\\xF4ng h\\u1EE3p l\\u1EC7: ph\\u1EA3i b\\u1EAFt \\u0111\\u1EA7u b\\u1EB1ng "'.concat(a.prefix,'"'):a.format==="ends_with"?'Chu\\u1ED7i kh\\xF4ng h\\u1EE3p l\\u1EC7: ph\\u1EA3i k\\u1EBFt th\\xFAc b\\u1EB1ng "'.concat(a.suffix,'"'):a.format==="includes"?'Chu\\u1ED7i kh\\xF4ng h\\u1EE3p l\\u1EC7: ph\\u1EA3i bao g\\u1ED3m "'.concat(a.includes,'"'):a.format==="regex"?"Chu\\u1ED7i kh\\xF4ng h\\u1EE3p l\\u1EC7: ph\\u1EA3i kh\\u1EDBp v\\u1EDBi m\\u1EABu ".concat(a.pattern):"".concat((c=i[a.format])!=null?c:t.format," kh\\xF4ng h\\u1EE3p l\\u1EC7")}case"not_multiple_of":return"S\\u1ED1 kh\\xF4ng h\\u1EE3p l\\u1EC7: ph\\u1EA3i l\\xE0 b\\u1ED9i s\\u1ED1 c\\u1EE7a ".concat(t.divisor);case"unrecognized_keys":return"Kh\\xF3a kh\\xF4ng \\u0111\\u01B0\\u1EE3c nh\\u1EADn d\\u1EA1ng: ".concat(p(t.keys,", "));case"invalid_key":return"Kh\\xF3a kh\\xF4ng h\\u1EE3p l\\u1EC7 trong ".concat(t.origin);case"invalid_union":return"\\u0110\\u1EA7u v\\xE0o kh\\xF4ng h\\u1EE3p l\\u1EC7";case"invalid_element":return"Gi\\xE1 tr\\u1ECB kh\\xF4ng h\\u1EE3p l\\u1EC7 trong ".concat(t.origin);default:return"\\u0110\\u1EA7u v\\xE0o kh\\xF4ng h\\u1EE3p l\\u1EC7"}}};function vc(){return{localeError:$d()}}var bd=()=>{let e={string:{unit:"\\u5B57\\u7B26",verb:"\\u5305\\u542B"},file:{unit:"\\u5B57\\u8282",verb:"\\u5305\\u542B"},array:{unit:"\\u9879",verb:"\\u5305\\u542B"},set:{unit:"\\u9879",verb:"\\u5305\\u542B"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"\\u975E\\u6570\\u5B57(NaN)":"\\u6570\\u5B57";case"object":{if(Array.isArray(t))return"\\u6570\\u7EC4";if(t===null)return"\\u7A7A\\u503C(null)";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"\\u8F93\\u5165",email:"\\u7535\\u5B50\\u90AE\\u4EF6",url:"URL",emoji:"\\u8868\\u60C5\\u7B26\\u53F7",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO\\u65E5\\u671F\\u65F6\\u95F4",date:"ISO\\u65E5\\u671F",time:"ISO\\u65F6\\u95F4",duration:"ISO\\u65F6\\u957F",ipv4:"IPv4\\u5730\\u5740",ipv6:"IPv6\\u5730\\u5740",cidrv4:"IPv4\\u7F51\\u6BB5",cidrv6:"IPv6\\u7F51\\u6BB5",base64:"base64\\u7F16\\u7801\\u5B57\\u7B26\\u4E32",base64url:"base64url\\u7F16\\u7801\\u5B57\\u7B26\\u4E32",json_string:"JSON\\u5B57\\u7B26\\u4E32",e164:"E.164\\u53F7\\u7801",jwt:"JWT",template_literal:"\\u8F93\\u5165"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"\\u65E0\\u6548\\u8F93\\u5165\\uFF1A\\u671F\\u671B ".concat(t.expected,"\\uFF0C\\u5B9E\\u9645\\u63A5\\u6536 ").concat(n(t.input));case"invalid_value":return t.values.length===1?"\\u65E0\\u6548\\u8F93\\u5165\\uFF1A\\u671F\\u671B ".concat(b(t.values[0])):"\\u65E0\\u6548\\u9009\\u9879\\uFF1A\\u671F\\u671B\\u4EE5\\u4E0B\\u4E4B\\u4E00 ".concat(p(t.values,"|"));case"too_big":{let a=t.inclusive?"<=":"<",s=r(t.origin);return s?"\\u6570\\u503C\\u8FC7\\u5927\\uFF1A\\u671F\\u671B ".concat((o=t.origin)!=null?o:"\\u503C"," ").concat(a).concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"\\u4E2A\\u5143\\u7D20"):"\\u6570\\u503C\\u8FC7\\u5927\\uFF1A\\u671F\\u671B ".concat((l=t.origin)!=null?l:"\\u503C"," ").concat(a).concat(t.maximum.toString())}case"too_small":{let a=t.inclusive?">=":">",s=r(t.origin);return s?"\\u6570\\u503C\\u8FC7\\u5C0F\\uFF1A\\u671F\\u671B ".concat(t.origin," ").concat(a).concat(t.minimum.toString()," ").concat(s.unit):"\\u6570\\u503C\\u8FC7\\u5C0F\\uFF1A\\u671F\\u671B ".concat(t.origin," ").concat(a).concat(t.minimum.toString())}case"invalid_format":{let a=t;return a.format==="starts_with"?'\\u65E0\\u6548\\u5B57\\u7B26\\u4E32\\uFF1A\\u5FC5\\u987B\\u4EE5 "'.concat(a.prefix,'" \\u5F00\\u5934'):a.format==="ends_with"?'\\u65E0\\u6548\\u5B57\\u7B26\\u4E32\\uFF1A\\u5FC5\\u987B\\u4EE5 "'.concat(a.suffix,'" \\u7ED3\\u5C3E'):a.format==="includes"?'\\u65E0\\u6548\\u5B57\\u7B26\\u4E32\\uFF1A\\u5FC5\\u987B\\u5305\\u542B "'.concat(a.includes,'"'):a.format==="regex"?"\\u65E0\\u6548\\u5B57\\u7B26\\u4E32\\uFF1A\\u5FC5\\u987B\\u6EE1\\u8DB3\\u6B63\\u5219\\u8868\\u8FBE\\u5F0F ".concat(a.pattern):"\\u65E0\\u6548".concat((c=i[a.format])!=null?c:t.format)}case"not_multiple_of":return"\\u65E0\\u6548\\u6570\\u5B57\\uFF1A\\u5FC5\\u987B\\u662F ".concat(t.divisor," \\u7684\\u500D\\u6570");case"unrecognized_keys":return"\\u51FA\\u73B0\\u672A\\u77E5\\u7684\\u952E(key): ".concat(p(t.keys,", "));case"invalid_key":return"".concat(t.origin," \\u4E2D\\u7684\\u952E(key)\\u65E0\\u6548");case"invalid_union":return"\\u65E0\\u6548\\u8F93\\u5165";case"invalid_element":return"".concat(t.origin," \\u4E2D\\u5305\\u542B\\u65E0\\u6548\\u503C(value)");default:return"\\u65E0\\u6548\\u8F93\\u5165"}}};function hc(){return{localeError:bd()}}var _d=()=>{let e={string:{unit:"\\u5B57\\u5143",verb:"\\u64C1\\u6709"},file:{unit:"\\u4F4D\\u5143\\u7D44",verb:"\\u64C1\\u6709"},array:{unit:"\\u9805\\u76EE",verb:"\\u64C1\\u6709"},set:{unit:"\\u9805\\u76EE",verb:"\\u64C1\\u6709"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"number";case"object":{if(Array.isArray(t))return"array";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"\\u8F38\\u5165",email:"\\u90F5\\u4EF6\\u5730\\u5740",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO \\u65E5\\u671F\\u6642\\u9593",date:"ISO \\u65E5\\u671F",time:"ISO \\u6642\\u9593",duration:"ISO \\u671F\\u9593",ipv4:"IPv4 \\u4F4D\\u5740",ipv6:"IPv6 \\u4F4D\\u5740",cidrv4:"IPv4 \\u7BC4\\u570D",cidrv6:"IPv6 \\u7BC4\\u570D",base64:"base64 \\u7DE8\\u78BC\\u5B57\\u4E32",base64url:"base64url \\u7DE8\\u78BC\\u5B57\\u4E32",json_string:"JSON \\u5B57\\u4E32",e164:"E.164 \\u6578\\u503C",jwt:"JWT",template_literal:"\\u8F38\\u5165"};return t=>{var o,u,l,c;switch(t.code){case"invalid_type":return"\\u7121\\u6548\\u7684\\u8F38\\u5165\\u503C\\uFF1A\\u9810\\u671F\\u70BA ".concat(t.expected,"\\uFF0C\\u4F46\\u6536\\u5230 ").concat(n(t.input));case"invalid_value":return t.values.length===1?"\\u7121\\u6548\\u7684\\u8F38\\u5165\\u503C\\uFF1A\\u9810\\u671F\\u70BA ".concat(b(t.values[0])):"\\u7121\\u6548\\u7684\\u9078\\u9805\\uFF1A\\u9810\\u671F\\u70BA\\u4EE5\\u4E0B\\u5176\\u4E2D\\u4E4B\\u4E00 ".concat(p(t.values,"|"));case"too_big":{let a=t.inclusive?"<=":"<",s=r(t.origin);return s?"\\u6578\\u503C\\u904E\\u5927\\uFF1A\\u9810\\u671F ".concat((o=t.origin)!=null?o:"\\u503C"," \\u61C9\\u70BA ").concat(a).concat(t.maximum.toString()," ").concat((u=s.unit)!=null?u:"\\u500B\\u5143\\u7D20"):"\\u6578\\u503C\\u904E\\u5927\\uFF1A\\u9810\\u671F ".concat((l=t.origin)!=null?l:"\\u503C"," \\u61C9\\u70BA ").concat(a).concat(t.maximum.toString())}case"too_small":{let a=t.inclusive?">=":">",s=r(t.origin);return s?"\\u6578\\u503C\\u904E\\u5C0F\\uFF1A\\u9810\\u671F ".concat(t.origin," \\u61C9\\u70BA ").concat(a).concat(t.minimum.toString()," ").concat(s.unit):"\\u6578\\u503C\\u904E\\u5C0F\\uFF1A\\u9810\\u671F ".concat(t.origin," \\u61C9\\u70BA ").concat(a).concat(t.minimum.toString())}case"invalid_format":{let a=t;return a.format==="starts_with"?'\\u7121\\u6548\\u7684\\u5B57\\u4E32\\uFF1A\\u5FC5\\u9808\\u4EE5 "'.concat(a.prefix,'" \\u958B\\u982D'):a.format==="ends_with"?'\\u7121\\u6548\\u7684\\u5B57\\u4E32\\uFF1A\\u5FC5\\u9808\\u4EE5 "'.concat(a.suffix,'" \\u7D50\\u5C3E'):a.format==="includes"?'\\u7121\\u6548\\u7684\\u5B57\\u4E32\\uFF1A\\u5FC5\\u9808\\u5305\\u542B "'.concat(a.includes,'"'):a.format==="regex"?"\\u7121\\u6548\\u7684\\u5B57\\u4E32\\uFF1A\\u5FC5\\u9808\\u7B26\\u5408\\u683C\\u5F0F ".concat(a.pattern):"\\u7121\\u6548\\u7684 ".concat((c=i[a.format])!=null?c:t.format)}case"not_multiple_of":return"\\u7121\\u6548\\u7684\\u6578\\u5B57\\uFF1A\\u5FC5\\u9808\\u70BA ".concat(t.divisor," \\u7684\\u500D\\u6578");case"unrecognized_keys":return"\\u7121\\u6CD5\\u8B58\\u5225\\u7684\\u9375\\u503C".concat(t.keys.length>1?"\\u5011":"","\\uFF1A").concat(p(t.keys,"\\u3001"));case"invalid_key":return"".concat(t.origin," \\u4E2D\\u6709\\u7121\\u6548\\u7684\\u9375\\u503C");case"invalid_union":return"\\u7121\\u6548\\u7684\\u8F38\\u5165\\u503C";case"invalid_element":return"".concat(t.origin," \\u4E2D\\u6709\\u7121\\u6548\\u7684\\u503C");default:return"\\u7121\\u6548\\u7684\\u8F38\\u5165\\u503C"}}};function $c(){return{localeError:_d()}}var yd=()=>{let e={string:{unit:"\\xE0mi",verb:"n\\xED"},file:{unit:"bytes",verb:"n\\xED"},array:{unit:"nkan",verb:"n\\xED"},set:{unit:"nkan",verb:"n\\xED"}};function r(t){var o;return(o=e[t])!=null?o:null}let n=t=>{let o=typeof t;switch(o){case"number":return Number.isNaN(t)?"NaN":"n\\u1ECD\\u0301mb\\xE0";case"object":{if(Array.isArray(t))return"akop\\u1ECD";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return o},i={regex:"\\u1EB9\\u0300r\\u1ECD \\xECb\\xE1w\\u1ECDl\\xE9",email:"\\xE0d\\xEDr\\u1EB9\\u0301s\\xEC \\xECm\\u1EB9\\u0301l\\xEC",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"\\xE0k\\xF3k\\xF2 ISO",date:"\\u1ECDj\\u1ECD\\u0301 ISO",time:"\\xE0k\\xF3k\\xF2 ISO",duration:"\\xE0k\\xF3k\\xF2 t\\xF3 p\\xE9 ISO",ipv4:"\\xE0d\\xEDr\\u1EB9\\u0301s\\xEC IPv4",ipv6:"\\xE0d\\xEDr\\u1EB9\\u0301s\\xEC IPv6",cidrv4:"\\xE0gb\\xE8gb\\xE8 IPv4",cidrv6:"\\xE0gb\\xE8gb\\xE8 IPv6",base64:"\\u1ECD\\u0300r\\u1ECD\\u0300 t\\xED a k\\u1ECD\\u0301 n\\xED base64",base64url:"\\u1ECD\\u0300r\\u1ECD\\u0300 base64url",json_string:"\\u1ECD\\u0300r\\u1ECD\\u0300 JSON",e164:"n\\u1ECD\\u0301mb\\xE0 E.164",jwt:"JWT",template_literal:"\\u1EB9\\u0300r\\u1ECD \\xECb\\xE1w\\u1ECDl\\xE9"};return t=>{var o,u;switch(t.code){case"invalid_type":return"\\xCCb\\xE1w\\u1ECDl\\xE9 a\\u1E63\\xEC\\u1E63e: a n\\xED l\\xE1ti fi ".concat(t.expected,", \\xE0m\\u1ECD\\u0300 a r\\xED ").concat(n(t.input));case"invalid_value":return t.values.length===1?"\\xCCb\\xE1w\\u1ECDl\\xE9 a\\u1E63\\xEC\\u1E63e: a n\\xED l\\xE1ti fi ".concat(b(t.values[0])):"\\xC0\\u1E63\\xE0y\\xE0n a\\u1E63\\xEC\\u1E63e: yan \\u1ECD\\u0300kan l\\xE1ra ".concat(p(t.values,"|"));case"too_big":{let l=t.inclusive?"<=":"<",c=r(t.origin);return c?"T\\xF3 p\\u1ECD\\u0300 j\\xF9: a n\\xED l\\xE1ti j\\u1EB9\\u0301 p\\xE9 ".concat((o=t.origin)!=null?o:"iye"," ").concat(c.verb," ").concat(l).concat(t.maximum," ").concat(c.unit):"T\\xF3 p\\u1ECD\\u0300 j\\xF9: a n\\xED l\\xE1ti j\\u1EB9\\u0301 ".concat(l).concat(t.maximum)}case"too_small":{let l=t.inclusive?">=":">",c=r(t.origin);return c?"K\\xE9r\\xE9 ju: a n\\xED l\\xE1ti j\\u1EB9\\u0301 p\\xE9 ".concat(t.origin," ").concat(c.verb," ").concat(l).concat(t.minimum," ").concat(c.unit):"K\\xE9r\\xE9 ju: a n\\xED l\\xE1ti j\\u1EB9\\u0301 ".concat(l).concat(t.minimum)}case"invalid_format":{let l=t;return l.format==="starts_with"?'\\u1ECC\\u0300r\\u1ECD\\u0300 a\\u1E63\\xEC\\u1E63e: gb\\u1ECD\\u0301d\\u1ECD\\u0300 b\\u1EB9\\u0300r\\u1EB9\\u0300 p\\u1EB9\\u0300l\\xFA "'.concat(l.prefix,'"'):l.format==="ends_with"?'\\u1ECC\\u0300r\\u1ECD\\u0300 a\\u1E63\\xEC\\u1E63e: gb\\u1ECD\\u0301d\\u1ECD\\u0300 par\\xED p\\u1EB9\\u0300l\\xFA "'.concat(l.suffix,'"'):l.format==="includes"?'\\u1ECC\\u0300r\\u1ECD\\u0300 a\\u1E63\\xEC\\u1E63e: gb\\u1ECD\\u0301d\\u1ECD\\u0300 n\\xED "'.concat(l.includes,'"'):l.format==="regex"?"\\u1ECC\\u0300r\\u1ECD\\u0300 a\\u1E63\\xEC\\u1E63e: gb\\u1ECD\\u0301d\\u1ECD\\u0300 b\\xE1 \\xE0p\\u1EB9\\u1EB9r\\u1EB9 mu ".concat(l.pattern):"A\\u1E63\\xEC\\u1E63e: ".concat((u=i[l.format])!=null?u:t.format)}case"not_multiple_of":return"N\\u1ECD\\u0301mb\\xE0 a\\u1E63\\xEC\\u1E63e: gb\\u1ECD\\u0301d\\u1ECD\\u0300 j\\u1EB9\\u0301 \\xE8y\\xE0 p\\xEDp\\xEDn ti ".concat(t.divisor);case"unrecognized_keys":return"B\\u1ECDt\\xECn\\xEC \\xE0\\xECm\\u1ECD\\u0300: ".concat(p(t.keys,", "));case"invalid_key":return"B\\u1ECDt\\xECn\\xEC a\\u1E63\\xEC\\u1E63e n\\xEDn\\xFA ".concat(t.origin);case"invalid_union":return"\\xCCb\\xE1w\\u1ECDl\\xE9 a\\u1E63\\xEC\\u1E63e";case"invalid_element":return"Iye a\\u1E63\\xEC\\u1E63e n\\xEDn\\xFA ".concat(t.origin);default:return"\\xCCb\\xE1w\\u1ECDl\\xE9 a\\u1E63\\xEC\\u1E63e"}}};function bc(){return{localeError:yd()}}var co=Symbol("ZodOutput"),lo=Symbol("ZodInput"),Te=class{constructor(){this._map=new WeakMap,this._idmap=new Map}add(r,...n){let i=n[0];if(this._map.set(r,i),i&&typeof i=="object"&&"id"in i){if(this._idmap.has(i.id))throw new Error("ID ".concat(i.id," already exists in the registry"));this._idmap.set(i.id,r)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(r){let n=this._map.get(r);return n&&typeof n=="object"&&"id"in n&&this._idmap.delete(n.id),this._map.delete(r),this}get(r){var i;let n=r._zod.parent;if(n){let t=m({},(i=this.get(n))!=null?i:{});delete t.id;let o=m(m({},t),this._map.get(r));return Object.keys(o).length?o:void 0}return this._map.get(r)}has(r){return this._map.has(r)}};function ir(){return new Te}var oe=ir();function so(e,r){return new e(m({type:"string"},y(r)))}function mo(e,r){return new e(m({type:"string",coerce:!0},y(r)))}function or(e,r){return new e(m({type:"string",format:"email",check:"string_format",abort:!1},y(r)))}function ct(e,r){return new e(m({type:"string",format:"guid",check:"string_format",abort:!1},y(r)))}function ar(e,r){return new e(m({type:"string",format:"uuid",check:"string_format",abort:!1},y(r)))}function ur(e,r){return new e(m({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4"},y(r)))}function cr(e,r){return new e(m({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6"},y(r)))}function lr(e,r){return new e(m({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7"},y(r)))}function lt(e,r){return new e(m({type:"string",format:"url",check:"string_format",abort:!1},y(r)))}function sr(e,r){return new e(m({type:"string",format:"emoji",check:"string_format",abort:!1},y(r)))}function dr(e,r){return new e(m({type:"string",format:"nanoid",check:"string_format",abort:!1},y(r)))}function mr(e,r){return new e(m({type:"string",format:"cuid",check:"string_format",abort:!1},y(r)))}function fr(e,r){return new e(m({type:"string",format:"cuid2",check:"string_format",abort:!1},y(r)))}function pr(e,r){return new e(m({type:"string",format:"ulid",check:"string_format",abort:!1},y(r)))}function gr(e,r){return new e(m({type:"string",format:"xid",check:"string_format",abort:!1},y(r)))}function vr(e,r){return new e(m({type:"string",format:"ksuid",check:"string_format",abort:!1},y(r)))}function hr(e,r){return new e(m({type:"string",format:"ipv4",check:"string_format",abort:!1},y(r)))}function $r(e,r){return new e(m({type:"string",format:"ipv6",check:"string_format",abort:!1},y(r)))}function br(e,r){return new e(m({type:"string",format:"cidrv4",check:"string_format",abort:!1},y(r)))}function _r(e,r){return new e(m({type:"string",format:"cidrv6",check:"string_format",abort:!1},y(r)))}function yr(e,r){return new e(m({type:"string",format:"base64",check:"string_format",abort:!1},y(r)))}function xr(e,r){return new e(m({type:"string",format:"base64url",check:"string_format",abort:!1},y(r)))}function kr(e,r){return new e(m({type:"string",format:"e164",check:"string_format",abort:!1},y(r)))}function zr(e,r){return new e(m({type:"string",format:"jwt",check:"string_format",abort:!1},y(r)))}var fo={Any:null,Minute:-1,Second:0,Millisecond:3,Microsecond:6};function po(e,r){return new e(m({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null},y(r)))}function go(e,r){return new e(m({type:"string",format:"date",check:"string_format"},y(r)))}function vo(e,r){return new e(m({type:"string",format:"time",check:"string_format",precision:null},y(r)))}function ho(e,r){return new e(m({type:"string",format:"duration",check:"string_format"},y(r)))}function $o(e,r){return new e(m({type:"number",checks:[]},y(r)))}function bo(e,r){return new e(m({type:"number",coerce:!0,checks:[]},y(r)))}function _o(e,r){return new e(m({type:"number",check:"number_format",abort:!1,format:"safeint"},y(r)))}function yo(e,r){return new e(m({type:"number",check:"number_format",abort:!1,format:"float32"},y(r)))}function xo(e,r){return new e(m({type:"number",check:"number_format",abort:!1,format:"float64"},y(r)))}function ko(e,r){return new e(m({type:"number",check:"number_format",abort:!1,format:"int32"},y(r)))}function zo(e,r){return new e(m({type:"number",check:"number_format",abort:!1,format:"uint32"},y(r)))}function Io(e,r){return new e(m({type:"boolean"},y(r)))}function wo(e,r){return new e(m({type:"boolean",coerce:!0},y(r)))}function So(e,r){return new e(m({type:"bigint"},y(r)))}function jo(e,r){return new e(m({type:"bigint",coerce:!0},y(r)))}function Oo(e,r){return new e(m({type:"bigint",check:"bigint_format",abort:!1,format:"int64"},y(r)))}function Po(e,r){return new e(m({type:"bigint",check:"bigint_format",abort:!1,format:"uint64"},y(r)))}function Uo(e,r){return new e(m({type:"symbol"},y(r)))}function No(e,r){return new e(m({type:"undefined"},y(r)))}function Zo(e,r){return new e(m({type:"null"},y(r)))}function Do(e){return new e({type:"any"})}function To(e){return new e({type:"unknown"})}function Eo(e,r){return new e(m({type:"never"},y(r)))}function Ao(e,r){return new e(m({type:"void"},y(r)))}function Ro(e,r){return new e(m({type:"date"},y(r)))}function Lo(e,r){return new e(m({type:"date",coerce:!0},y(r)))}function Co(e,r){return new e(m({type:"nan"},y(r)))}function ce(e,r){return new Mt(z(m({check:"less_than"},y(r)),{value:e,inclusive:!1}))}function H(e,r){return new Mt(z(m({check:"less_than"},y(r)),{value:e,inclusive:!0}))}function le(e,r){return new Bt(z(m({check:"greater_than"},y(r)),{value:e,inclusive:!1}))}function W(e,r){return new Bt(z(m({check:"greater_than"},y(r)),{value:e,inclusive:!0}))}function Vo(e){return le(0,e)}function Fo(e){return ce(0,e)}function Jo(e){return H(0,e)}function Mo(e){return W(0,e)}function Ie(e,r){return new Tn(z(m({check:"multiple_of"},y(r)),{value:e}))}function Ee(e,r){return new Rn(z(m({check:"max_size"},y(r)),{maximum:e}))}function we(e,r){return new Ln(z(m({check:"min_size"},y(r)),{minimum:e}))}function st(e,r){return new Cn(z(m({check:"size_equals"},y(r)),{size:e}))}function Ae(e,r){return new Vn(z(m({check:"max_length"},y(r)),{maximum:e}))}function $e(e,r){return new Fn(z(m({check:"min_length"},y(r)),{minimum:e}))}function Re(e,r){return new Jn(z(m({check:"length_equals"},y(r)),{length:e}))}function dt(e,r){return new Mn(z(m({check:"string_format",format:"regex"},y(r)),{pattern:e}))}function mt(e){return new Bn(m({check:"string_format",format:"lowercase"},y(e)))}function ft(e){return new Kn(m({check:"string_format",format:"uppercase"},y(e)))}function pt(e,r){return new Gn(z(m({check:"string_format",format:"includes"},y(r)),{includes:e}))}function gt(e,r){return new Wn(z(m({check:"string_format",format:"starts_with"},y(r)),{prefix:e}))}function vt(e,r){return new Xn(z(m({check:"string_format",format:"ends_with"},y(r)),{suffix:e}))}function Bo(e,r,n){return new qn(m({check:"property",property:e,schema:r},y(n)))}function ht(e,r){return new Yn(m({check:"mime_type",mime:e},y(r)))}function se(e){return new Qn({check:"overwrite",tx:e})}function $t(e){return se(r=>r.normalize(e))}function bt(){return se(e=>e.trim())}function _t(){return se(e=>e.toLowerCase())}function yt(){return se(e=>e.toUpperCase())}function Ko(e,r,n){return new e(m({type:"array",element:r},y(n)))}function xd(e,r,n){return new e(m({type:"union",options:r},y(n)))}function kd(e,r,n,i){return new e(m({type:"union",options:n,discriminator:r},y(i)))}function zd(e,r,n){return new e({type:"intersection",left:r,right:n})}function Id(e,r,n,i){let t=n instanceof O,o=t?i:n,u=t?n:null;return new e(m({type:"tuple",items:r,rest:u},y(o)))}function wd(e,r,n,i){return new e(m({type:"record",keyType:r,valueType:n},y(i)))}function Sd(e,r,n,i){return new e(m({type:"map",keyType:r,valueType:n},y(i)))}function jd(e,r,n){return new e(m({type:"set",valueType:r},y(n)))}function Od(e,r,n){let i=Array.isArray(r)?Object.fromEntries(r.map(t=>[t,t])):r;return new e(m({type:"enum",entries:i},y(n)))}function Pd(e,r,n){return new e(m({type:"enum",entries:r},y(n)))}function Ud(e,r,n){return new e(m({type:"literal",values:Array.isArray(r)?r:[r]},y(n)))}function Go(e,r){return new e(m({type:"file"},y(r)))}function Nd(e,r){return new e({type:"transform",transform:r})}function Zd(e,r){return new e({type:"optional",innerType:r})}function Dd(e,r){return new e({type:"nullable",innerType:r})}function Td(e,r,n){return new e({type:"default",innerType:r,get defaultValue(){return typeof n=="function"?n():qr(n)}})}function Ed(e,r,n){return new e(m({type:"nonoptional",innerType:r},y(n)))}function Ad(e,r){return new e({type:"success",innerType:r})}function Rd(e,r,n){return new e({type:"catch",innerType:r,catchValue:typeof n=="function"?n:()=>n})}function Ld(e,r,n){return new e({type:"pipe",in:r,out:n})}function Cd(e,r){return new e({type:"readonly",innerType:r})}function Vd(e,r,n){return new e(m({type:"template_literal",parts:r},y(n)))}function Fd(e,r){return new e({type:"lazy",getter:r})}function Jd(e,r){return new e({type:"promise",innerType:r})}function Wo(e,r,n){var o;let i=y(n);return(o=i.abort)!=null||(i.abort=!0),new e(m({type:"custom",check:"custom",fn:r},i))}function Xo(e,r,n){return new e(m({type:"custom",check:"custom",fn:r},y(n)))}function qo(e){let r=_c(n=>(n.addIssue=i=>{var t,o,u,l;if(typeof i=="string")n.issues.push(Oe(i,n.value,r._zod.def));else{let c=i;c.fatal&&(c.continue=!1),(t=c.code)!=null||(c.code="custom"),(o=c.input)!=null||(c.input=n.value),(u=c.inst)!=null||(c.inst=r),(l=c.continue)!=null||(c.continue=!r._zod.def.abort),n.issues.push(Oe(c))}},e(n.value,n)));return r}function _c(e,r){let n=new R(m({check:"custom"},y(r)));return n._zod.check=e,n}function Yo(e,r){var h,x,S,I,C;let n=y(r),i=(h=n.truthy)!=null?h:["true","1","yes","on","y","enabled"],t=(x=n.falsy)!=null?x:["false","0","no","off","n","disabled"];n.case!=="sensitive"&&(i=i.map(j=>typeof j=="string"?j.toLowerCase():j),t=t.map(j=>typeof j=="string"?j.toLowerCase():j));let o=new Set(i),u=new Set(t),l=(S=e.Codec)!=null?S:ot,c=(I=e.Boolean)!=null?I:it,a=(C=e.String)!=null?C:ke,s=new a({type:"string",error:n.error}),v=new c({type:"boolean",error:n.error}),f=new l({type:"pipe",in:s,out:v,transform:(j,g)=>{let $=j;return n.case!=="sensitive"&&($=$.toLowerCase()),o.has($)?!0:u.has($)?!1:(g.issues.push({code:"invalid_value",expected:"stringbool",values:[...o,...u],input:g.value,inst:f,continue:!1}),{})},reverseTransform:(j,g)=>j===!0?i[0]||"true":t[0]||"false",error:n.error});return f}function Le(e,r,n,i={}){let t=y(i),o=m(z(m({},y(i)),{check:"string_format",type:"string",format:r,fn:typeof n=="function"?n:l=>n.test(l)}),t);return n instanceof RegExp&&(o.pattern=n),new e(o)}var xt=class{constructor(r){var n,i,t,o,u;this.counter=0,this.metadataRegistry=(n=r==null?void 0:r.metadata)!=null?n:oe,this.target=(i=r==null?void 0:r.target)!=null?i:"draft-2020-12",this.unrepresentable=(t=r==null?void 0:r.unrepresentable)!=null?t:"throw",this.override=(o=r==null?void 0:r.override)!=null?o:()=>{},this.io=(u=r==null?void 0:r.io)!=null?u:"output",this.seen=new Map}process(r,n={path:[],schemaPath:[]}){var v,f,h,x,S;var i;let t=r._zod.def,o={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},u=this.seen.get(r);if(u)return u.count++,n.schemaPath.includes(r)&&(u.cycle=n.path),u.schema;let l={schema:{},count:1,cycle:void 0,path:n.path};this.seen.set(r,l);let c=(f=(v=r._zod).toJSONSchema)==null?void 0:f.call(v);if(c)l.schema=c;else{let I=z(m({},n),{schemaPath:[...n.schemaPath,r],path:n.path}),C=r._zod.parent;if(C)l.ref=C,this.process(C,I),this.seen.get(C).isParent=!0;else{let j=l.schema;switch(t.type){case"string":{let g=j;g.type="string";let{minimum:$,maximum:k,format:N,patterns:P,contentEncoding:w}=r._zod.bag;if(typeof $=="number"&&(g.minLength=$),typeof k=="number"&&(g.maxLength=k),N&&(g.format=(h=o[N])!=null?h:N,g.format===""&&delete g.format),w&&(g.contentEncoding=w),P&&P.size>0){let D=[...P];D.length===1?g.pattern=D[0].source:D.length>1&&(l.schema.allOf=[...D.map(B=>z(m({},this.target==="draft-7"||this.target==="draft-4"||this.target==="openapi-3.0"?{type:"string"}:{}),{pattern:B.source}))])}break}case"number":{let g=j,{minimum:$,maximum:k,format:N,multipleOf:P,exclusiveMaximum:w,exclusiveMinimum:D}=r._zod.bag;typeof N=="string"&&N.includes("int")?g.type="integer":g.type="number",typeof D=="number"&&(this.target==="draft-4"||this.target==="openapi-3.0"?(g.minimum=D,g.exclusiveMinimum=!0):g.exclusiveMinimum=D),typeof $=="number"&&(g.minimum=$,typeof D=="number"&&this.target!=="draft-4"&&(D>=$?delete g.minimum:delete g.exclusiveMinimum)),typeof w=="number"&&(this.target==="draft-4"||this.target==="openapi-3.0"?(g.maximum=w,g.exclusiveMaximum=!0):g.exclusiveMaximum=w),typeof k=="number"&&(g.maximum=k,typeof w=="number"&&this.target!=="draft-4"&&(w<=k?delete g.maximum:delete g.exclusiveMaximum)),typeof P=="number"&&(g.multipleOf=P);break}case"boolean":{let g=j;g.type="boolean";break}case"bigint":{if(this.unrepresentable==="throw")throw new Error("BigInt cannot be represented in JSON Schema");break}case"symbol":{if(this.unrepresentable==="throw")throw new Error("Symbols cannot be represented in JSON Schema");break}case"null":{this.target==="openapi-3.0"?(j.type="string",j.nullable=!0,j.enum=[null]):j.type="null";break}case"any":break;case"unknown":break;case"undefined":{if(this.unrepresentable==="throw")throw new Error("Undefined cannot be represented in JSON Schema");break}case"void":{if(this.unrepresentable==="throw")throw new Error("Void cannot be represented in JSON Schema");break}case"never":{j.not={};break}case"date":{if(this.unrepresentable==="throw")throw new Error("Date cannot be represented in JSON Schema");break}case"array":{let g=j,{minimum:$,maximum:k}=r._zod.bag;typeof $=="number"&&(g.minItems=$),typeof k=="number"&&(g.maxItems=k),g.type="array",g.items=this.process(t.element,z(m({},I),{path:[...I.path,"items"]}));break}case"object":{let g=j;g.type="object",g.properties={};let $=t.shape;for(let P in $)g.properties[P]=this.process($[P],z(m({},I),{path:[...I.path,"properties",P]}));let k=new Set(Object.keys($)),N=new Set([...k].filter(P=>{let w=t.shape[P]._zod;return this.io==="input"?w.optin===void 0:w.optout===void 0}));N.size>0&&(g.required=Array.from(N)),((x=t.catchall)==null?void 0:x._zod.def.type)==="never"?g.additionalProperties=!1:t.catchall?t.catchall&&(g.additionalProperties=this.process(t.catchall,z(m({},I),{path:[...I.path,"additionalProperties"]}))):this.io==="output"&&(g.additionalProperties=!1);break}case"union":{let g=j,$=t.options.map((k,N)=>this.process(k,z(m({},I),{path:[...I.path,"anyOf",N]})));g.anyOf=$;break}case"intersection":{let g=j,$=this.process(t.left,z(m({},I),{path:[...I.path,"allOf",0]})),k=this.process(t.right,z(m({},I),{path:[...I.path,"allOf",1]})),N=w=>"allOf"in w&&Object.keys(w).length===1,P=[...N($)?$.allOf:[$],...N(k)?k.allOf:[k]];g.allOf=P;break}case"tuple":{let g=j;g.type="array";let $=this.target==="draft-2020-12"?"prefixItems":"items",k=this.target==="draft-2020-12"||this.target==="openapi-3.0"?"items":"additionalItems",N=t.items.map((B,V)=>this.process(B,z(m({},I),{path:[...I.path,$,V]}))),P=t.rest?this.process(t.rest,z(m({},I),{path:[...I.path,k,...this.target==="openapi-3.0"?[t.items.length]:[]]})):null;this.target==="draft-2020-12"?(g.prefixItems=N,P&&(g.items=P)):this.target==="openapi-3.0"?(g.items={anyOf:N},P&&g.items.anyOf.push(P),g.minItems=N.length,P||(g.maxItems=N.length)):(g.items=N,P&&(g.additionalItems=P));let{minimum:w,maximum:D}=r._zod.bag;typeof w=="number"&&(g.minItems=w),typeof D=="number"&&(g.maxItems=D);break}case"record":{let g=j;g.type="object",(this.target==="draft-7"||this.target==="draft-2020-12")&&(g.propertyNames=this.process(t.keyType,z(m({},I),{path:[...I.path,"propertyNames"]}))),g.additionalProperties=this.process(t.valueType,z(m({},I),{path:[...I.path,"additionalProperties"]}));break}case"map":{if(this.unrepresentable==="throw")throw new Error("Map cannot be represented in JSON Schema");break}case"set":{if(this.unrepresentable==="throw")throw new Error("Set cannot be represented in JSON Schema");break}case"enum":{let g=j,$=Ge(t.entries);$.every(k=>typeof k=="number")&&(g.type="number"),$.every(k=>typeof k=="string")&&(g.type="string"),g.enum=$;break}case"literal":{let g=j,$=[];for(let k of t.values)if(k===void 0){if(this.unrepresentable==="throw")throw new Error("Literal \`undefined\` cannot be represented in JSON Schema")}else if(typeof k=="bigint"){if(this.unrepresentable==="throw")throw new Error("BigInt literals cannot be represented in JSON Schema");$.push(Number(k))}else $.push(k);if($.length!==0)if($.length===1){let k=$[0];g.type=k===null?"null":typeof k,this.target==="draft-4"||this.target==="openapi-3.0"?g.enum=[k]:g.const=k}else $.every(k=>typeof k=="number")&&(g.type="number"),$.every(k=>typeof k=="string")&&(g.type="string"),$.every(k=>typeof k=="boolean")&&(g.type="string"),$.every(k=>k===null)&&(g.type="null"),g.enum=$;break}case"file":{let g=j,$={type:"string",format:"binary",contentEncoding:"binary"},{minimum:k,maximum:N,mime:P}=r._zod.bag;k!==void 0&&($.minLength=k),N!==void 0&&($.maxLength=N),P?P.length===1?($.contentMediaType=P[0],Object.assign(g,$)):g.anyOf=P.map(w=>z(m({},$),{contentMediaType:w})):Object.assign(g,$);break}case"transform":{if(this.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema");break}case"nullable":{let g=this.process(t.innerType,I);this.target==="openapi-3.0"?(l.ref=t.innerType,j.nullable=!0):j.anyOf=[g,{type:"null"}];break}case"nonoptional":{this.process(t.innerType,I),l.ref=t.innerType;break}case"success":{let g=j;g.type="boolean";break}case"default":{this.process(t.innerType,I),l.ref=t.innerType,j.default=JSON.parse(JSON.stringify(t.defaultValue));break}case"prefault":{this.process(t.innerType,I),l.ref=t.innerType,this.io==="input"&&(j._prefault=JSON.parse(JSON.stringify(t.defaultValue)));break}case"catch":{this.process(t.innerType,I),l.ref=t.innerType;let g;try{g=t.catchValue(void 0)}catch($){throw new Error("Dynamic catch values are not supported in JSON Schema")}j.default=g;break}case"nan":{if(this.unrepresentable==="throw")throw new Error("NaN cannot be represented in JSON Schema");break}case"template_literal":{let g=j,$=r._zod.pattern;if(!$)throw new Error("Pattern not found in template literal");g.type="string",g.pattern=$.source;break}case"pipe":{let g=this.io==="input"?t.in._zod.def.type==="transform"?t.out:t.in:t.out;this.process(g,I),l.ref=g;break}case"readonly":{this.process(t.innerType,I),l.ref=t.innerType,j.readOnly=!0;break}case"promise":{this.process(t.innerType,I),l.ref=t.innerType;break}case"optional":{this.process(t.innerType,I),l.ref=t.innerType;break}case"lazy":{let g=r._zod.innerType;this.process(g,I),l.ref=g;break}case"custom":{if(this.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema");break}case"function":{if(this.unrepresentable==="throw")throw new Error("Function types cannot be represented in JSON Schema");break}default:}}}let a=this.metadataRegistry.get(r);return a&&Object.assign(l.schema,a),this.io==="input"&&J(r)&&(delete l.schema.examples,delete l.schema.default),this.io==="input"&&l.schema._prefault&&((S=(i=l.schema).default)!=null||(i.default=l.schema._prefault)),delete l.schema._prefault,this.seen.get(r).schema}emit(r,n){var s,v,f,h,x,S,I,C,j,g;let i={cycles:(s=n==null?void 0:n.cycles)!=null?s:"ref",reused:(v=n==null?void 0:n.reused)!=null?v:"inline",external:(f=n==null?void 0:n.external)!=null?f:void 0},t=this.seen.get(r);if(!t)throw new Error("Unprocessed schema. This is a bug in Zod.");let o=$=>{var D,B,V,re,F;let k=this.target==="draft-2020-12"?"$defs":"definitions";if(i.external){let ne=(D=i.external.registry.get($[0]))==null?void 0:D.id,Je=(B=i.external.uri)!=null?B:Vr=>Vr;if(ne)return{ref:Je(ne)};let ee=(re=(V=$[1].defId)!=null?V:$[1].schema.id)!=null?re:"schema".concat(this.counter++);return $[1].defId=ee,{defId:ee,ref:"".concat(Je("__shared"),"#/").concat(k,"/").concat(ee)}}if($[1]===t)return{ref:"#"};let P="".concat("#","/").concat(k,"/"),w=(F=$[1].schema.id)!=null?F:"__schema".concat(this.counter++);return{defId:w,ref:P+w}},u=$=>{if($[1].schema.$ref)return;let k=$[1],{ref:N,defId:P}=o($);k.def=m({},k.schema),P&&(k.defId=P);let w=k.schema;for(let D in w)delete w[D];w.$ref=N};if(i.cycles==="throw")for(let $ of this.seen.entries()){let k=$[1];if(k.cycle)throw new Error("Cycle detected: "+"#/".concat((h=k.cycle)==null?void 0:h.join("/"),"/<root>")+'\\n\\nSet the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.')}for(let $ of this.seen.entries()){let k=$[1];if(r===$[0]){u($);continue}if(i.external){let P=(x=i.external.registry.get($[0]))==null?void 0:x.id;if(r!==$[0]&&P){u($);continue}}if((S=this.metadataRegistry.get($[0]))==null?void 0:S.id){u($);continue}if(k.cycle){u($);continue}if(k.count>1&&i.reused==="ref"){u($);continue}}let l=($,k)=>{var B,V,re;let N=this.seen.get($),P=(B=N.def)!=null?B:N.schema,w=m({},P);if(N.ref===null)return;let D=N.ref;if(N.ref=null,D){l(D,k);let F=this.seen.get(D).schema;F.$ref&&(k.target==="draft-7"||k.target==="draft-4"||k.target==="openapi-3.0")?(P.allOf=(V=P.allOf)!=null?V:[],P.allOf.push(F)):(Object.assign(P,F),Object.assign(P,w))}N.isParent||this.override({zodSchema:$,jsonSchema:P,path:(re=N.path)!=null?re:[]})};for(let $ of[...this.seen.entries()].reverse())l($[0],{target:this.target});let c={};if(this.target==="draft-2020-12"?c.$schema="https://json-schema.org/draft/2020-12/schema":this.target==="draft-7"?c.$schema="http://json-schema.org/draft-07/schema#":this.target==="draft-4"?c.$schema="http://json-schema.org/draft-04/schema#":this.target==="openapi-3.0"||console.warn("Invalid target: ".concat(this.target)),(I=i.external)!=null&&I.uri){let $=(C=i.external.registry.get(r))==null?void 0:C.id;if(!$)throw new Error("Schema is missing an \`id\` property");c.$id=i.external.uri($)}Object.assign(c,t.def);let a=(g=(j=i.external)==null?void 0:j.defs)!=null?g:{};for(let $ of this.seen.entries()){let k=$[1];k.def&&k.defId&&(a[k.defId]=k.def)}i.external||Object.keys(a).length>0&&(this.target==="draft-2020-12"?c.$defs=a:c.definitions=a);try{return JSON.parse(JSON.stringify(c))}catch($){throw new Error("Error converting schema to JSON.")}}};function Qo(e,r){if(e instanceof Te){let i=new xt(r),t={};for(let l of e._idmap.entries()){let[c,a]=l;i.process(a)}let o={},u={registry:e,uri:r==null?void 0:r.uri,defs:t};for(let l of e._idmap.entries()){let[c,a]=l;o[c]=i.emit(a,z(m({},r),{external:u}))}if(Object.keys(t).length>0){let l=i.target==="draft-2020-12"?"$defs":"definitions";o.__shared={[l]:t}}return{schemas:o}}let n=new xt(r);return n.process(e),n.emit(e,r)}function J(e,r){let n=r!=null?r:{seen:new Set};if(n.seen.has(e))return!1;n.seen.add(e);let t=e._zod.def;switch(t.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":return!1;case"array":return J(t.element,n);case"object":{for(let o in t.shape)if(J(t.shape[o],n))return!0;return!1}case"union":{for(let o of t.options)if(J(o,n))return!0;return!1}case"intersection":return J(t.left,n)||J(t.right,n);case"tuple":{for(let o of t.items)if(J(o,n))return!0;return!!(t.rest&&J(t.rest,n))}case"record":return J(t.keyType,n)||J(t.valueType,n);case"map":return J(t.keyType,n)||J(t.valueType,n);case"set":return J(t.valueType,n);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":return J(t.innerType,n);case"lazy":return J(t.getter(),n);case"default":return J(t.innerType,n);case"prefault":return J(t.innerType,n);case"custom":return!1;case"transform":return!0;case"pipe":return J(t.in,n)||J(t.out,n);case"success":return!1;case"catch":return!1;case"function":return!1;default:}throw new Error("Unknown schema type: ".concat(t.type))}var Ho={};var kt={};_e(kt,{ZodISODate:()=>wr,ZodISODateTime:()=>Ir,ZodISODuration:()=>jr,ZodISOTime:()=>Sr,date:()=>ta,datetime:()=>ea,duration:()=>na,time:()=>ra});var Ir=d("ZodISODateTime",(e,r)=>{mi.init(e,r),A.init(e,r)});function ea(e){return po(Ir,e)}var wr=d("ZodISODate",(e,r)=>{fi.init(e,r),A.init(e,r)});function ta(e){return go(wr,e)}var Sr=d("ZodISOTime",(e,r)=>{pi.init(e,r),A.init(e,r)});function ra(e){return vo(Sr,e)}var jr=d("ZodISODuration",(e,r)=>{gi.init(e,r),A.init(e,r)});function na(e){return ho(jr,e)}var xc=(e,r)=>{Qe.init(e,r),e.name="ZodError",Object.defineProperties(e,{format:{value:n=>et(e,n)},flatten:{value:n=>He(e,n)},addIssue:{value:n=>{e.issues.push(n),e.message=JSON.stringify(e.issues,Se,2)}},addIssues:{value:n=>{e.issues.push(...n),e.message=JSON.stringify(e.issues,Se,2)}},isEmpty:{get(){return e.issues.length===0}}})},Bd=d("ZodError",xc),X=d("ZodError",xc,{Parent:Error});var ia=Pe(X),oa=Ue(X),aa=Ne(X),ua=Ze(X),ca=Tt(X),la=Et(X),sa=At(X),da=Rt(X),ma=Lt(X),fa=Ct(X),pa=Vt(X),ga=Ft(X);var U=d("ZodType",(e,r)=>(O.init(e,r),e.def=r,e.type=r.type,Object.defineProperty(e,"_def",{value:r}),e.check=(...n)=>{var i;return e.clone(_.mergeDefs(r,{checks:[...(i=r.checks)!=null?i:[],...n.map(t=>typeof t=="function"?{_zod:{check:t,def:{check:"custom"},onattach:[]}}:t)]}))},e.clone=(n,i)=>K(e,n,i),e.brand=()=>e,e.register=(n,i)=>(n.add(e,i),e),e.parse=(n,i)=>ia(e,n,i,{callee:e.parse}),e.safeParse=(n,i)=>aa(e,n,i),e.parseAsync=async(n,i)=>oa(e,n,i,{callee:e.parseAsync}),e.safeParseAsync=async(n,i)=>ua(e,n,i),e.spa=e.safeParseAsync,e.encode=(n,i)=>ca(e,n,i),e.decode=(n,i)=>la(e,n,i),e.encodeAsync=async(n,i)=>sa(e,n,i),e.decodeAsync=async(n,i)=>da(e,n,i),e.safeEncode=(n,i)=>ma(e,n,i),e.safeDecode=(n,i)=>fa(e,n,i),e.safeEncodeAsync=async(n,i)=>pa(e,n,i),e.safeDecodeAsync=async(n,i)=>ga(e,n,i),e.refine=(n,i)=>e.check(cl(n,i)),e.superRefine=n=>e.check(ll(n)),e.overwrite=n=>e.check(se(n)),e.optional=()=>Pr(e),e.nullable=()=>Ur(e),e.nullish=()=>Pr(Ur(e)),e.nonoptional=n=>qc(e,n),e.array=()=>Tr(e),e.or=n=>Ra([e,n]),e.and=n=>Ec(e,n),e.transform=n=>Nr(e,Va(n)),e.default=n=>Gc(e,n),e.prefault=n=>Xc(e,n),e.catch=n=>Hc(e,n),e.pipe=n=>Nr(e,n),e.readonly=()=>rl(e),e.describe=n=>{let i=e.clone();return oe.add(i,{description:n}),i},Object.defineProperty(e,"description",{get(){var n;return(n=oe.get(e))==null?void 0:n.description},configurable:!0}),e.meta=(...n)=>{if(n.length===0)return oe.get(e);let i=e.clone();return oe.add(i,n[0]),i},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),$a=d("_ZodString",(e,r)=>{var i,t,o;ke.init(e,r),U.init(e,r);let n=e._zod.bag;e.format=(i=n.format)!=null?i:null,e.minLength=(t=n.minimum)!=null?t:null,e.maxLength=(o=n.maximum)!=null?o:null,e.regex=(...u)=>e.check(dt(...u)),e.includes=(...u)=>e.check(pt(...u)),e.startsWith=(...u)=>e.check(gt(...u)),e.endsWith=(...u)=>e.check(vt(...u)),e.min=(...u)=>e.check($e(...u)),e.max=(...u)=>e.check(Ae(...u)),e.length=(...u)=>e.check(Re(...u)),e.nonempty=(...u)=>e.check($e(1,...u)),e.lowercase=u=>e.check(mt(u)),e.uppercase=u=>e.check(ft(u)),e.trim=()=>e.check(bt()),e.normalize=(...u)=>e.check($t(...u)),e.toLowerCase=()=>e.check(_t()),e.toUpperCase=()=>e.check(yt())}),It=d("ZodString",(e,r)=>{ke.init(e,r),$a.init(e,r),e.email=n=>e.check(or(ba,n)),e.url=n=>e.check(lt(Zr,n)),e.jwt=n=>e.check(zr(Da,n)),e.emoji=n=>e.check(sr(_a,n)),e.guid=n=>e.check(ct(Or,n)),e.uuid=n=>e.check(ar(de,n)),e.uuidv4=n=>e.check(ur(de,n)),e.uuidv6=n=>e.check(cr(de,n)),e.uuidv7=n=>e.check(lr(de,n)),e.nanoid=n=>e.check(dr(ya,n)),e.guid=n=>e.check(ct(Or,n)),e.cuid=n=>e.check(mr(xa,n)),e.cuid2=n=>e.check(fr(ka,n)),e.ulid=n=>e.check(pr(za,n)),e.base64=n=>e.check(yr(Ua,n)),e.base64url=n=>e.check(xr(Na,n)),e.xid=n=>e.check(gr(Ia,n)),e.ksuid=n=>e.check(vr(wa,n)),e.ipv4=n=>e.check(hr(Sa,n)),e.ipv6=n=>e.check($r(ja,n)),e.cidrv4=n=>e.check(br(Oa,n)),e.cidrv6=n=>e.check(_r(Pa,n)),e.e164=n=>e.check(kr(Za,n)),e.datetime=n=>e.check(ea(n)),e.date=n=>e.check(ta(n)),e.time=n=>e.check(ra(n)),e.duration=n=>e.check(na(n))});function va(e){return so(It,e)}var A=d("ZodStringFormat",(e,r)=>{T.init(e,r),$a.init(e,r)}),ba=d("ZodEmail",(e,r)=>{ni.init(e,r),A.init(e,r)});function Gd(e){return or(ba,e)}var Or=d("ZodGUID",(e,r)=>{ti.init(e,r),A.init(e,r)});function Wd(e){return ct(Or,e)}var de=d("ZodUUID",(e,r)=>{ri.init(e,r),A.init(e,r)});function Xd(e){return ar(de,e)}function qd(e){return ur(de,e)}function Yd(e){return cr(de,e)}function Qd(e){return lr(de,e)}var Zr=d("ZodURL",(e,r)=>{ii.init(e,r),A.init(e,r)});function Hd(e){return lt(Zr,e)}function em(e){return lt(Zr,m({protocol:/^https?$/,hostname:Q.domain},_.normalizeParams(e)))}var _a=d("ZodEmoji",(e,r)=>{oi.init(e,r),A.init(e,r)});function tm(e){return sr(_a,e)}var ya=d("ZodNanoID",(e,r)=>{ai.init(e,r),A.init(e,r)});function rm(e){return dr(ya,e)}var xa=d("ZodCUID",(e,r)=>{ui.init(e,r),A.init(e,r)});function nm(e){return mr(xa,e)}var ka=d("ZodCUID2",(e,r)=>{ci.init(e,r),A.init(e,r)});function im(e){return fr(ka,e)}var za=d("ZodULID",(e,r)=>{li.init(e,r),A.init(e,r)});function om(e){return pr(za,e)}var Ia=d("ZodXID",(e,r)=>{si.init(e,r),A.init(e,r)});function am(e){return gr(Ia,e)}var wa=d("ZodKSUID",(e,r)=>{di.init(e,r),A.init(e,r)});function um(e){return vr(wa,e)}var Sa=d("ZodIPv4",(e,r)=>{vi.init(e,r),A.init(e,r)});function cm(e){return hr(Sa,e)}var ja=d("ZodIPv6",(e,r)=>{hi.init(e,r),A.init(e,r)});function lm(e){return $r(ja,e)}var Oa=d("ZodCIDRv4",(e,r)=>{$i.init(e,r),A.init(e,r)});function sm(e){return br(Oa,e)}var Pa=d("ZodCIDRv6",(e,r)=>{bi.init(e,r),A.init(e,r)});function dm(e){return _r(Pa,e)}var Ua=d("ZodBase64",(e,r)=>{yi.init(e,r),A.init(e,r)});function mm(e){return yr(Ua,e)}var Na=d("ZodBase64URL",(e,r)=>{xi.init(e,r),A.init(e,r)});function fm(e){return xr(Na,e)}var Za=d("ZodE164",(e,r)=>{ki.init(e,r),A.init(e,r)});function pm(e){return kr(Za,e)}var Da=d("ZodJWT",(e,r)=>{zi.init(e,r),A.init(e,r)});function gm(e){return zr(Da,e)}var wt=d("ZodCustomStringFormat",(e,r)=>{Ii.init(e,r),A.init(e,r)});function vm(e,r,n={}){return Le(wt,e,r,n)}function hm(e){return Le(wt,"hostname",Q.hostname,e)}function $m(e){return Le(wt,"hex",Q.hex,e)}function bm(e,r){var o;let n=(o=r==null?void 0:r.enc)!=null?o:"hex",i="".concat(e,"_").concat(n),t=Q[i];if(!t)throw new Error("Unrecognized hash format: ".concat(i));return Le(wt,i,t,r)}var St=d("ZodNumber",(e,r)=>{var i,t,o,u,l,c,a,s,v;Yt.init(e,r),U.init(e,r),e.gt=(f,h)=>e.check(le(f,h)),e.gte=(f,h)=>e.check(W(f,h)),e.min=(f,h)=>e.check(W(f,h)),e.lt=(f,h)=>e.check(ce(f,h)),e.lte=(f,h)=>e.check(H(f,h)),e.max=(f,h)=>e.check(H(f,h)),e.int=f=>e.check(ha(f)),e.safe=f=>e.check(ha(f)),e.positive=f=>e.check(le(0,f)),e.nonnegative=f=>e.check(W(0,f)),e.negative=f=>e.check(ce(0,f)),e.nonpositive=f=>e.check(H(0,f)),e.multipleOf=(f,h)=>e.check(Ie(f,h)),e.step=(f,h)=>e.check(Ie(f,h)),e.finite=()=>e;let n=e._zod.bag;e.minValue=(o=Math.max((i=n.minimum)!=null?i:Number.NEGATIVE_INFINITY,(t=n.exclusiveMinimum)!=null?t:Number.NEGATIVE_INFINITY))!=null?o:null,e.maxValue=(c=Math.min((u=n.maximum)!=null?u:Number.POSITIVE_INFINITY,(l=n.exclusiveMaximum)!=null?l:Number.POSITIVE_INFINITY))!=null?c:null,e.isInt=((a=n.format)!=null?a:"").includes("int")||Number.isSafeInteger((s=n.multipleOf)!=null?s:.5),e.isFinite=!0,e.format=(v=n.format)!=null?v:null});function kc(e){return $o(St,e)}var Ve=d("ZodNumberFormat",(e,r)=>{wi.init(e,r),St.init(e,r)});function ha(e){return _o(Ve,e)}function _m(e){return yo(Ve,e)}function ym(e){return xo(Ve,e)}function xm(e){return ko(Ve,e)}function km(e){return zo(Ve,e)}var jt=d("ZodBoolean",(e,r)=>{it.init(e,r),U.init(e,r)});function zc(e){return Io(jt,e)}var Ot=d("ZodBigInt",(e,r)=>{var i,t,o;Qt.init(e,r),U.init(e,r),e.gte=(u,l)=>e.check(W(u,l)),e.min=(u,l)=>e.check(W(u,l)),e.gt=(u,l)=>e.check(le(u,l)),e.gte=(u,l)=>e.check(W(u,l)),e.min=(u,l)=>e.check(W(u,l)),e.lt=(u,l)=>e.check(ce(u,l)),e.lte=(u,l)=>e.check(H(u,l)),e.max=(u,l)=>e.check(H(u,l)),e.positive=u=>e.check(le(BigInt(0),u)),e.negative=u=>e.check(ce(BigInt(0),u)),e.nonpositive=u=>e.check(H(BigInt(0),u)),e.nonnegative=u=>e.check(W(BigInt(0),u)),e.multipleOf=(u,l)=>e.check(Ie(u,l));let n=e._zod.bag;e.minValue=(i=n.minimum)!=null?i:null,e.maxValue=(t=n.maximum)!=null?t:null,e.format=(o=n.format)!=null?o:null});function zm(e){return So(Ot,e)}var Ta=d("ZodBigIntFormat",(e,r)=>{Si.init(e,r),Ot.init(e,r)});function Im(e){return Oo(Ta,e)}function wm(e){return Po(Ta,e)}var Ic=d("ZodSymbol",(e,r)=>{ji.init(e,r),U.init(e,r)});function Sm(e){return Uo(Ic,e)}var wc=d("ZodUndefined",(e,r)=>{Oi.init(e,r),U.init(e,r)});function jm(e){return No(wc,e)}var Sc=d("ZodNull",(e,r)=>{Pi.init(e,r),U.init(e,r)});function jc(e){return Zo(Sc,e)}var Oc=d("ZodAny",(e,r)=>{Ui.init(e,r),U.init(e,r)});function Om(){return Do(Oc)}var Pc=d("ZodUnknown",(e,r)=>{Ni.init(e,r),U.init(e,r)});function Ce(){return To(Pc)}var Uc=d("ZodNever",(e,r)=>{Zi.init(e,r),U.init(e,r)});function Ea(e){return Eo(Uc,e)}var Nc=d("ZodVoid",(e,r)=>{Di.init(e,r),U.init(e,r)});function Pm(e){return Ao(Nc,e)}var Dr=d("ZodDate",(e,r)=>{Ti.init(e,r),U.init(e,r),e.min=(i,t)=>e.check(W(i,t)),e.max=(i,t)=>e.check(H(i,t));let n=e._zod.bag;e.minDate=n.minimum?new Date(n.minimum):null,e.maxDate=n.maximum?new Date(n.maximum):null});function Um(e){return Ro(Dr,e)}var Zc=d("ZodArray",(e,r)=>{Ei.init(e,r),U.init(e,r),e.element=r.element,e.min=(n,i)=>e.check($e(n,i)),e.nonempty=n=>e.check($e(1,n)),e.max=(n,i)=>e.check(Ae(n,i)),e.length=(n,i)=>e.check(Re(n,i)),e.unwrap=()=>e.element});function Tr(e,r){return Ko(Zc,e,r)}function Nm(e){let r=e._zod.def.shape;return Ca(Object.keys(r))}var Er=d("ZodObject",(e,r)=>{Ai.init(e,r),U.init(e,r),_.defineLazy(e,"shape",()=>r.shape),e.keyof=()=>Ca(Object.keys(e._zod.def.shape)),e.catchall=n=>e.clone(z(m({},e._zod.def),{catchall:n})),e.passthrough=()=>e.clone(z(m({},e._zod.def),{catchall:Ce()})),e.loose=()=>e.clone(z(m({},e._zod.def),{catchall:Ce()})),e.strict=()=>e.clone(z(m({},e._zod.def),{catchall:Ea()})),e.strip=()=>e.clone(z(m({},e._zod.def),{catchall:void 0})),e.extend=n=>_.extend(e,n),e.safeExtend=n=>_.safeExtend(e,n),e.merge=n=>_.merge(e,n),e.pick=n=>_.pick(e,n),e.omit=n=>_.omit(e,n),e.partial=(...n)=>_.partial(Fa,e,n[0]),e.required=(...n)=>_.required(Ja,e,n[0])});function Zm(e,r){let n=m({type:"object",shape:e!=null?e:{}},_.normalizeParams(r));return new Er(n)}function Dm(e,r){return new Er(m({type:"object",shape:e,catchall:Ea()},_.normalizeParams(r)))}function Tm(e,r){return new Er(m({type:"object",shape:e,catchall:Ce()},_.normalizeParams(r)))}var Aa=d("ZodUnion",(e,r)=>{Ht.init(e,r),U.init(e,r),e.options=r.options});function Ra(e,r){return new Aa(m({type:"union",options:e},_.normalizeParams(r)))}var Dc=d("ZodDiscriminatedUnion",(e,r)=>{Aa.init(e,r),Ri.init(e,r)});function Em(e,r,n){return new Dc(m({type:"union",options:r,discriminator:e},_.normalizeParams(n)))}var Tc=d("ZodIntersection",(e,r)=>{Li.init(e,r),U.init(e,r)});function Ec(e,r){return new Tc({type:"intersection",left:e,right:r})}var Ac=d("ZodTuple",(e,r)=>{er.init(e,r),U.init(e,r),e.rest=n=>e.clone(z(m({},e._zod.def),{rest:n}))});function Rc(e,r,n){let i=r instanceof O,t=i?n:r,o=i?r:null;return new Ac(m({type:"tuple",items:e,rest:o},_.normalizeParams(t)))}var La=d("ZodRecord",(e,r)=>{Ci.init(e,r),U.init(e,r),e.keyType=r.keyType,e.valueType=r.valueType});function Lc(e,r,n){return new La(m({type:"record",keyType:e,valueType:r},_.normalizeParams(n)))}function Am(e,r,n){let i=K(e);return i._zod.values=void 0,new La(m({type:"record",keyType:i,valueType:r},_.normalizeParams(n)))}var Cc=d("ZodMap",(e,r)=>{Vi.init(e,r),U.init(e,r),e.keyType=r.keyType,e.valueType=r.valueType});function Rm(e,r,n){return new Cc(m({type:"map",keyType:e,valueType:r},_.normalizeParams(n)))}var Vc=d("ZodSet",(e,r)=>{Fi.init(e,r),U.init(e,r),e.min=(...n)=>e.check(we(...n)),e.nonempty=n=>e.check(we(1,n)),e.max=(...n)=>e.check(Ee(...n)),e.size=(...n)=>e.check(st(...n))});function Lm(e,r){return new Vc(m({type:"set",valueType:e},_.normalizeParams(r)))}var zt=d("ZodEnum",(e,r)=>{Ji.init(e,r),U.init(e,r),e.enum=r.entries,e.options=Object.values(r.entries);let n=new Set(Object.keys(r.entries));e.extract=(i,t)=>{let o={};for(let u of i)if(n.has(u))o[u]=r.entries[u];else throw new Error("Key ".concat(u," not found in enum"));return new zt(z(m(z(m({},r),{checks:[]}),_.normalizeParams(t)),{entries:o}))},e.exclude=(i,t)=>{let o=m({},r.entries);for(let u of i)if(n.has(u))delete o[u];else throw new Error("Key ".concat(u," not found in enum"));return new zt(z(m(z(m({},r),{checks:[]}),_.normalizeParams(t)),{entries:o}))}});function Ca(e,r){let n=Array.isArray(e)?Object.fromEntries(e.map(i=>[i,i])):e;return new zt(m({type:"enum",entries:n},_.normalizeParams(r)))}function Cm(e,r){return new zt(m({type:"enum",entries:e},_.normalizeParams(r)))}var Fc=d("ZodLiteral",(e,r)=>{Mi.init(e,r),U.init(e,r),e.values=new Set(r.values),Object.defineProperty(e,"value",{get(){if(r.values.length>1)throw new Error("This schema contains multiple valid literal values. Use \`.values\` instead.");return r.values[0]}})});function Vm(e,r){return new Fc(m({type:"literal",values:Array.isArray(e)?e:[e]},_.normalizeParams(r)))}var Jc=d("ZodFile",(e,r)=>{Bi.init(e,r),U.init(e,r),e.min=(n,i)=>e.check(we(n,i)),e.max=(n,i)=>e.check(Ee(n,i)),e.mime=(n,i)=>e.check(ht(Array.isArray(n)?n:[n],i))});function Fm(e){return Go(Jc,e)}var Mc=d("ZodTransform",(e,r)=>{Ki.init(e,r),U.init(e,r),e._zod.parse=(n,i)=>{if(i.direction==="backward")throw new me(e.constructor.name);n.addIssue=o=>{var u,l,c;if(typeof o=="string")n.issues.push(_.issue(o,n.value,r));else{let a=o;a.fatal&&(a.continue=!1),(u=a.code)!=null||(a.code="custom"),(l=a.input)!=null||(a.input=n.value),(c=a.inst)!=null||(a.inst=e),n.issues.push(_.issue(a))}};let t=r.transform(n.value,n);return t instanceof Promise?t.then(o=>(n.value=o,n)):(n.value=t,n)}});function Va(e){return new Mc({type:"transform",transform:e})}var Fa=d("ZodOptional",(e,r)=>{Gi.init(e,r),U.init(e,r),e.unwrap=()=>e._zod.def.innerType});function Pr(e){return new Fa({type:"optional",innerType:e})}var Bc=d("ZodNullable",(e,r)=>{Wi.init(e,r),U.init(e,r),e.unwrap=()=>e._zod.def.innerType});function Ur(e){return new Bc({type:"nullable",innerType:e})}function Jm(e){return Pr(Ur(e))}var Kc=d("ZodDefault",(e,r)=>{Xi.init(e,r),U.init(e,r),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function Gc(e,r){return new Kc({type:"default",innerType:e,get defaultValue(){return typeof r=="function"?r():_.shallowClone(r)}})}var Wc=d("ZodPrefault",(e,r)=>{qi.init(e,r),U.init(e,r),e.unwrap=()=>e._zod.def.innerType});function Xc(e,r){return new Wc({type:"prefault",innerType:e,get defaultValue(){return typeof r=="function"?r():_.shallowClone(r)}})}var Ja=d("ZodNonOptional",(e,r)=>{Yi.init(e,r),U.init(e,r),e.unwrap=()=>e._zod.def.innerType});function qc(e,r){return new Ja(m({type:"nonoptional",innerType:e},_.normalizeParams(r)))}var Yc=d("ZodSuccess",(e,r)=>{Qi.init(e,r),U.init(e,r),e.unwrap=()=>e._zod.def.innerType});function Mm(e){return new Yc({type:"success",innerType:e})}var Qc=d("ZodCatch",(e,r)=>{Hi.init(e,r),U.init(e,r),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function Hc(e,r){return new Qc({type:"catch",innerType:e,catchValue:typeof r=="function"?r:()=>r})}var el=d("ZodNaN",(e,r)=>{eo.init(e,r),U.init(e,r)});function Bm(e){return Co(el,e)}var Ma=d("ZodPipe",(e,r)=>{to.init(e,r),U.init(e,r),e.in=r.in,e.out=r.out});function Nr(e,r){return new Ma({type:"pipe",in:e,out:r})}var Ba=d("ZodCodec",(e,r)=>{Ma.init(e,r),ot.init(e,r)});function Km(e,r,n){return new Ba({type:"pipe",in:e,out:r,transform:n.decode,reverseTransform:n.encode})}var tl=d("ZodReadonly",(e,r)=>{ro.init(e,r),U.init(e,r),e.unwrap=()=>e._zod.def.innerType});function rl(e){return new tl({type:"readonly",innerType:e})}var nl=d("ZodTemplateLiteral",(e,r)=>{no.init(e,r),U.init(e,r)});function Gm(e,r){return new nl(m({type:"template_literal",parts:e},_.normalizeParams(r)))}var il=d("ZodLazy",(e,r)=>{ao.init(e,r),U.init(e,r),e.unwrap=()=>e._zod.def.getter()});function ol(e){return new il({type:"lazy",getter:e})}var al=d("ZodPromise",(e,r)=>{oo.init(e,r),U.init(e,r),e.unwrap=()=>e._zod.def.innerType});function Wm(e){return new al({type:"promise",innerType:e})}var ul=d("ZodFunction",(e,r)=>{io.init(e,r),U.init(e,r)});function Xm(e){var r,n;return new ul({type:"function",input:Array.isArray(e==null?void 0:e.input)?Rc(e==null?void 0:e.input):(r=e==null?void 0:e.input)!=null?r:Tr(Ce()),output:(n=e==null?void 0:e.output)!=null?n:Ce()})}var Ar=d("ZodCustom",(e,r)=>{uo.init(e,r),U.init(e,r)});function qm(e){let r=new R({check:"custom"});return r._zod.check=e,r}function Ym(e,r){return Wo(Ar,e!=null?e:()=>!0,r)}function cl(e,r={}){return Xo(Ar,e,r)}function ll(e){return qo(e)}function Qm(e,r={error:"Input not instance of ".concat(e.name)}){let n=new Ar(m({type:"custom",check:"custom",fn:i=>i instanceof e,abort:!0},_.normalizeParams(r)));return n._zod.bag.Class=e,n}var Hm=(...e)=>Yo({Codec:Ba,Boolean:jt,String:It},...e);function ef(e){let r=ol(()=>Ra([va(e),kc(),zc(),jc(),Tr(r),Lc(va(),r)]));return r}function tf(e,r){return Nr(Va(e),r)}var rf={invalid_type:"invalid_type",too_big:"too_big",too_small:"too_small",invalid_format:"invalid_format",not_multiple_of:"not_multiple_of",unrecognized_keys:"unrecognized_keys",invalid_union:"invalid_union",invalid_key:"invalid_key",invalid_element:"invalid_element",invalid_value:"invalid_value",custom:"custom"};function nf(e){L({customError:e})}function of(){return L().customError}var Ka;Ka||(Ka={});var Rr={};_e(Rr,{bigint:()=>lf,boolean:()=>cf,date:()=>sf,number:()=>uf,string:()=>af});function af(e){return mo(It,e)}function uf(e){return bo(St,e)}function cf(e){return wo(jt,e)}function lf(e){return jo(Ot,e)}function sf(e){return Lo(Dr,e)}L(tr());var bv=Fe.union([Fe.enum(["low","medium","high","always-visible"]),Fe.number()]);var Lr=5;var df=9,be=200,Cr=10;function sl(e,r,n,i,t,o,u="-1"){var N,P;let l=1/0,c=1/0,a=-1/0,s=-1/0,v=new E(-Cr,0,5,n),f=new E(-Cr,0,r,5),h=new E(r-5,0,r+Cr,n),x=new E(0,n-5,r,n+Cr),S=mf(r,n,i,t,o),I=[v,f,h,x],C=new E(-be,-be,r+be*2,n+be*2);for(let w of e){let D,B;for(let V=0;V<w.bboxes.length;V++){if(w.bboxes[V]==null||(D=w.bboxes[V].boundingBox,B=w.bboxes[V].index,w.lockedToStrategyIndex!==-1&&B!==w.lockedToStrategyIndex))continue;let[re,F,ne,Je]=D,[ee,Vr,Ga,ml]=[w.y-re,w.y+F,w.x-ne,w.x+Je],Fr=Ga,Jr=ee,Wa=ml-Ga,Xa=Vr-ee;l=Math.min(l,Fr)-be,c=Math.min(c,Jr)-be,a=Math.max(a,Fr+Wa)+be,s=Math.max(s,Jr+Xa)+be,w.bboxes[V].boundingRect=new E(Fr,Jr,Wa,Xa)}}let j=new Me(new E(l,c,a-l,s-c)),g={msgId:u,colliders:new Array(e.length),staticColliders:[],debug:[]},$=0;for(let w=0;w<e.length;w++){let D=e[w];((P=(N=D.bboxes)==null?void 0:N[0])==null?void 0:P.index)===df&&(g.staticColliders.push(D.bboxes[0].boundingRect),j.insert(D.bboxes[0].boundingRect),$++)}e=e.slice($,e.length);let k;for(let w=0;w<e.length;w++)if(k=e[w],g.colliders[w]=[-1,0],k.enabledAndVisible){let[D,B,V]=[1/0,-1,void 0];for(let{index:re,boundingRect:F}of k.bboxes){if(F==null)continue;let ne=[];if(ne=j.queryRect(F).filter(ee=>F.intersects(ee)),k.shouldCollideWithScreenEdges&&I.forEach(ee=>{F.intersects(ee)&&ne.push(ee)}),F.intersects(S)){g.colliders[w]=[-1,0,F];break}if(ne.length<=D&&(V=F,B=re,D=ne.length),ne.length===0){j.insert(F),g.colliders[w]=[re,C.contains(F)?0:1,F];break}}k.rank===Lr&&V!=null&&(j.insert(V),g.colliders[w]=[B,C.contains(V)?0:1,V])}else g.colliders[w]=[-1,0];return g}function mf(e,r,n,i,t){switch(t){case"top-left":return new E(0,0,n,i);case"top-right":return new E(e-n,0,n,i);case"bottom-left":return new E(0,r-i,n,i);case"bottom-right":return new E(e-n,r-i,n,i);case"center":return new E((e-n)/2,(r-i)/2,n,i);case"top":return new E((e-n)/2,0,n,i);case"bottom":return new E((e-n)/2,r-i,n,i);case"left":return new E(0,(r-i)/2,n,i);case"right":return new E(e-n,(r-i)/2,n,i);default:return new E(0,r-i,n,i)}}function dl(e){let r=e[0].map(n=>{let i=n[0].map(t=>({index:t[4],boundingBox:[t[0],t[1],t[2],t[3]]}));return{enabledAndVisible:n[1]===1,rank:n[2]===1?Lr:0,x:n[3],y:n[4],shouldCollideWithScreenEdges:n[5]===1,bboxes:i,lockedToStrategyIndex:n[6]}});return{msgId:"-1",totalWidth:e[3],totalHeight:e[2],watermarkWidth:e[4],watermarkHeight:e[5],watermarkPosition:e[6],colliders:r,devicePixelRatio:e[1]}}self.onmessage=e=>{let r=dl(e.data);self.postMessage(sl(r.colliders,r.totalWidth,r.totalHeight,r.watermarkWidth,r.watermarkHeight,r.watermarkPosition,r.msgId))};})();
`;C();C();C();C();C();function RGe(t,e){return e.x+e.w<t.x+t.w&&e.x>t.x&&e.y>t.y&&e.y+e.h<t.y+t.h}C();function LGe(t,e){let[r,n]=e;return r>=t.x&&r<=t.x+t.w&&n>=t.y&&n<=t.y+t.h}C();function NGe(t,e){let r=e.x,n=e.y,i=e.x+e.w,a=e.y+e.h,o=t.x,s=t.y,l=t.x+t.w,u=t.y+t.h;return r<l&&o<i&&n<u&&s<a}C();function vh(t,e){for(let r=0;r<e.length;r++)t.push(e[r])}C();var vn=class{constructor(t,e,r,n,i){S(this,"x"),S(this,"y"),S(this,"w"),S(this,"h"),S(this,"userData"),this.userData=typeof i>"u"?null:i,this.x=t,this.y=e,this.w=r,this.h=n}contains(t){return t===this?!1:RGe(this,t)}intersects(t){return NGe(this,t)}intersectsPoint(t){return LGe(this,t)}draw(t){t.fillStyle="rgba(123,222,26, 0.8)",t.fillRect(this.x,this.y,this.w,this.h)}},Wm=class sv{constructor(e,r){S(this,"topLeft"),S(this,"topRight"),S(this,"bottomLeft"),S(this,"bottomRight"),S(this,"divided",!1),S(this,"boundary"),S(this,"capacity",16),S(this,"objects",[]),S(this,"parent"),this.parent=r,this.boundary=e}getSize(){return this.divided?this.objects.length+this.topLeft.getSize()+this.topRight.getSize()+this.bottomLeft.getSize()+this.bottomRight.getSize():this.objects.length}subdivide(){let{x:e,y:r,w:n,h:i}=this.boundary;this.topLeft=new sv(new vn(e,r,n/2,i/2),this),this.topRight=new sv(new vn(e+n/2,r,n/2,i/2),this),this.bottomLeft=new sv(new vn(e,r+i/2,n/2,i/2),this),this.bottomRight=new sv(new vn(e+n/2,r+i/2,n/2,i/2),this),this.divided=!0}queryRect(e){let r=[];if(this.boundary.intersects(e))r.push(...this.objects);else return[];return this.divided&&(vh(r,this.topLeft.queryRect(e)),vh(r,this.topRight.queryRect(e)),vh(r,this.bottomLeft.queryRect(e)),vh(r,this.bottomRight.queryRect(e))),r}queryPoint(e){let r=[];if(this.boundary.intersectsPoint(e))r.push(...this.objects);else return[];return this.divided&&(vh(r,this.topLeft.queryPoint(e)),vh(r,this.topRight.queryPoint(e)),vh(r,this.bottomLeft.queryPoint(e)),vh(r,this.bottomRight.queryPoint(e))),r}insert(e){return(this.parent?!this.boundary.contains(e):!this.boundary.intersects(e))?!1:this.objects.length<this.capacity?(this.objects.push(e),!0):(this.divided||this.subdivide(),(this.topLeft.insert(e)||this.topRight.insert(e)||this.bottomLeft.insert(e)||this.bottomRight.insert(e))===!1&&this.objects.push(e),!0)}drawObjects(e){this.objects.forEach(r=>r.draw(e)),this.divided&&(this.topLeft.drawObjects(e),this.topRight.drawObjects(e),this.bottomLeft.drawObjects(e),this.bottomRight.drawObjects(e))}draw(e){e.rect(this.boundary.x,this.boundary.y,this.boundary.w,this.boundary.h),this.divided&&(this.topLeft.draw(e),this.topRight.draw(e),this.bottomLeft.draw(e),this.bottomRight.draw(e)),e.strokeStyle="black",e.lineWidth=4,e.stroke()}};C();function $Ge(t,e,r){let n,i,a,o=null,s=0;r||(r={});let l=function(){s=r.leading===!1?0:Date.now(),o=null,a=t.apply(n,i),o||(n=i=null)};return function(){let u=Date.now();!s&&r.leading===!1&&(s=u);let c=e-(u-s);return n=globalThis,i=arguments,c<=0||c>e?(o&&(clearTimeout(o),o=null),s=u,a=t.apply(n,i),o||(n=i=null)):!o&&r.trailing!==!1&&(o=setTimeout(l,c)),a}}function UGe(t){let e=t[0].map(r=>{let n=r[0].map(i=>({index:i[4],boundingBox:[i[0],i[1],i[2],i[3]]}));return{enabledAndVisible:r[1]===1,rank:r[2]===1?O3:0,x:r[3],y:r[4],shouldCollideWithScreenEdges:r[5]===1,bboxes:n,lockedToStrategyIndex:r[6]}});return{msgId:"-1",totalWidth:t[3],totalHeight:t[2],watermarkWidth:t[4],watermarkHeight:t[5],watermarkPosition:t[6],colliders:e,devicePixelRatio:t[1]}}C();var Rte=9,_h=200,_b=10;function jGe(t,e,r,n,i,a,o="-1"){var s,l;let u=1/0,c=1/0,h=-1/0,d=-1/0,p=new vn(-_b,0,5,r),m=new vn(-_b,0,e,5),y=new vn(e-5,0,e+_b,r),v=new vn(0,r-5,e,r+_b),_=VGe(e,r,n,i,a),w=[p,m,y,v],b=new vn(-_h,-_h,e+_h*2,r+_h*2);for(let k of t){let D,O;for(let B=0;B<k.bboxes.length;B++){if(k.bboxes[B]==null||(D=k.bboxes[B].boundingBox,O=k.bboxes[B].index,k.lockedToStrategyIndex!==-1&&O!==k.lockedToStrategyIndex))continue;let[L,R,T,N]=D,[$,V,G,ee]=[k.y-L,k.y+R,k.x-T,k.x+N],ie=G,me=$,Me=ee-G,Ae=V-$;u=Math.min(u,ie)-_h,c=Math.min(c,me)-_h,h=Math.max(h,ie+Me)+_h,d=Math.max(d,me+Ae)+_h,k.bboxes[B].boundingRect=new vn(ie,me,Me,Ae)}}let A=new Wm(new vn(u,c,h-u,d-c)),E={msgId:o,colliders:new Array(t.length),staticColliders:[],debug:[]},M=0;for(let k=0;k<t.length;k++){let D=t[k];((l=(s=D.bboxes)==null?void 0:s[0])==null?void 0:l.index)===Rte&&(E.staticColliders.push(D.bboxes[0].boundingRect),A.insert(D.bboxes[0].boundingRect),M++)}t=t.slice(M,t.length);let P;for(let k=0;k<t.length;k++)if(P=t[k],E.colliders[k]=[-1,0],P.enabledAndVisible){let[D,O,B]=[1/0,-1,void 0];for(let{index:L,boundingRect:R}of P.bboxes){if(R==null)continue;let T=[];if(T=A.queryRect(R).filter(N=>R.intersects(N)),P.shouldCollideWithScreenEdges&&w.forEach(N=>{R.intersects(N)&&T.push(N)}),R.intersects(_)){E.colliders[k]=[-1,0,R];break}if(T.length<=D&&(B=R,O=L,D=T.length),T.length===0){A.insert(R),E.colliders[k]=[L,b.contains(R)?0:1,R];break}}P.rank===O3&&B!=null&&(A.insert(B),E.colliders[k]=[O,b.contains(B)?0:1,B])}else E.colliders[k]=[-1,0];return E}function VGe(t,e,r,n,i){switch(i){case"top-left":return new vn(0,0,r,n);case"top-right":return new vn(t-r,0,r,n);case"bottom-left":return new vn(0,e-n,r,n);case"bottom-right":return new vn(t-r,e-n,r,n);case"center":return new vn((t-r)/2,(e-n)/2,r,n);case"top":return new vn((t-r)/2,0,r,n);case"bottom":return new vn((t-r)/2,e-n,r,n);case"left":return new vn(0,(e-n)/2,r,n);case"right":return new vn(t-r,(e-n)/2,r,n);default:return new vn(0,e-n,r,n)}}C();var lL=class{constructor(){S(this,"onerror",()=>{}),S(this,"onmessage",()=>{}),S(this,"postMessage",t=>{let e=UGe(t);this.onmessage({data:jGe(e.colliders,e.totalWidth,e.totalHeight,e.watermarkWidth,e.watermarkHeight,e.watermarkPosition,e.msgId)})}),S(this,"terminate",()=>{})}},Df=!1,GGe=150,ZGe=class extends wi{constructor(t,e,r=!0){super(),S(this,"worker"),S(this,"debugContext"),S(this,"debugCanvas"),S(this,"collidersDirty",!0),S(this,"packedMessage",[[],0,0,0,0,0,"bottom-left"]),S(this,"visibleCollidersQTree",new Wm(new vn(0,0,0,0))),S(this,"interactiveCollidersQTree",new Wm(new vn(0,0,0,0))),S(this,"coreState"),S(this,"postMessage"),S(this,"showCollisionBoxes",()=>{Df=!0,this.debugCanvas.style.display="block"}),S(this,"hideCollisionBoxes",()=>{Df=!1,this.debugContext.clearRect(0,0,this.debugCanvas.width,this.debugCanvas.height),this.debugCanvas.style.display="none"}),S(this,"currentMsgId",""),S(this,"working",!1),S(this,"_postMessage",()=>{this.worker.postMessage(this.packedMessage)}),S(this,"componentArray",[]),S(this,"update",(n,i,a="bottom-left",o=!1,s=[])=>{let l=!1;if(this.collidersDirty){this.packedMessage=[[],0,0,0,0,0,"bottom-left"],this.componentArray=[];let h;for(let d of this.coreState.geometry2DIdsInScene){let p=this.coreState.geometry2DMap.get(d);p&&(h=p.components[0],this.componentArray.push(h))}this.resize(n,i,a),this.collidersDirty=!1,l=!0}else l=this.componentArray.some(h=>h.collisionDirty===!0);l&&this.componentArray.sort((h,d)=>d.rank-h.rank);let u=0;for(let h of s)this.packedMessage[0][u]==null&&(this.packedMessage[0][u]=[]),this.packedMessage[0][u][0]==null&&(this.packedMessage[0][u][0]=[]),this.packedMessage[0][u][0]=[[h.h/2,h.h/2,h.w/2,h.w/2,Rte]],this.packedMessage[0][u][1]=1,this.packedMessage[0][u][2]=1,this.packedMessage[0][u][3]=h.x,this.packedMessage[0][u][4]=h.y,this.packedMessage[0][u][5]=0,this.packedMessage[0][u][6]=-1,u++;let c=0;for(;u<this.componentArray.length+s.length;){if(this.packedMessage){let h=this.componentArray[c].toPackedMessage(o&&!l);this.packedMessage[0][u]==null&&(this.packedMessage[0][u]=[]),this.packedMessage[0][u][0]==null&&(this.packedMessage[0][u][0]=[]),this.packedMessage[0][u][0]=h.bboxes,this.packedMessage[0][u][1]=h.enabled&&this.componentArray[c].visible&&!this.componentArray[c].isOccluded?1:0,this.packedMessage[0][u][2]=h.rank===O3?1:0,this.packedMessage[0][u][3]=h.x,this.packedMessage[0][u][4]=h.y,this.packedMessage[0][u][5]=h.shouldCollideWithScreenEdges?1:0,this.packedMessage[0][u][6]=h.lockedToStrategyIndex}u++,c++}this.working||this.postMessage()}),S(this,"resolve",n=>{if(this.working=!1,this.collidersDirty||!n.data)return;let i=n.data.colliders,a=-1,o,s,l,u=new vn(0,0,this.debugCanvas.width,this.debugCanvas.height);if(this.visibleCollidersQTree=new Wm(u),this.interactiveCollidersQTree=new Wm(u),Df)for(let c of n.data.staticColliders)this.visibleCollidersQTree.insert(new vn(c.x,c.y,c.w,c.h));for(let c=0;c<this.componentArray.length;c++){let h=this.componentArray[c];i[c]!=null&&(a=i[c][0],o=i[c][2],h.offscreen=i[c][1]===1,a!==-1&&o!=null?(l=new vn(o.x,o.y,o.w,o.h,{entityId:h.id}),this.visibleCollidersQTree.insert(l),s=this.coreState.geometry2DMap.get(h.id),s?.components[1]!=null&&this.interactiveCollidersQTree.insert(l),(h.canShow===!1||h.visibilityNeedsUpdate!==!1)&&"visibilityNeedsUpdate"in h&&(h.visibilityNeedsUpdate="show"),a!==-1&&a!==h.currentStrategyIndex&&(h.activeBoundingBox=l,h.onStrategySelected(a))):((h.canShow===!0||h.visibilityNeedsUpdate!==!1)&&"visibilityNeedsUpdate"in h&&(h.visibilityNeedsUpdate="hide"),a!==-1&&a!==h.currentStrategyIndex&&h.onStrategySelected(a)))}Df&&this.drawDebug(),this.publish("visibility-changed")}),S(this,"drawDebug",()=>{Df&&this.visibleCollidersQTree&&(this.debugContext.clearRect(0,0,this.debugCanvas.width,this.debugCanvas.height),this.debugContext.beginPath(),this.visibleCollidersQTree.drawObjects(this.debugContext))}),S(this,"destroy",()=>{this.worker.terminate()}),this.worker=r===!1?new lL:new Worker(URL.createObjectURL(new Blob([FGe],{type:"text/javascript"}))),this.worker.onerror=()=>{this.worker=new lL,this.worker.onmessage=n=>this.resolve(n)},this.coreState=e,this.debugCanvas=t,this.debugContext=t.getContext("2d"),this.worker.onmessage=n=>this.resolve(n),this.postMessage=$Ge(this._postMessage,GGe,!1),Df?this.showCollisionBoxes():this.hideCollisionBoxes()}resize(t,e,r){this.packedMessage[6]=r,this.packedMessage[5]=e,this.packedMessage[4]=t,this.packedMessage[3]=this.debugCanvas.width,this.packedMessage[2]=this.debugCanvas.height}};C();C();C();C();var WGe=class{constructor(t){S(this,"type"),S(this,"event"),this.type=0,this.event=t}get timestamp(){return this.event.timeStamp}},HGe=class{constructor(){S(this,"taps",[])}add(t){this.lastPointerDown&&t.timestamp-this.lastPointerDown.timestamp<50?this.lastPointerDown.type=1:this.taps.push(t)}get lastPointerDown(){return this.taps.length>=1?this.taps[this.taps.length-1]:void 0}get isSingleTapWithTwoFingers(){var t;return this.isSingleTap&&((t=this.lastPointerDown)==null?void 0:t.type)===1}get isSingleTapWithOneFinger(){var t;return this.isSingleTap&&((t=this.lastPointerDown)==null?void 0:t.type)===0}get isDoubleTapWithOneFinger(){var t,e;return this.isDoubleTap&&((t=this.taps[0])==null?void 0:t.type)===0&&((e=this.taps[1])==null?void 0:e.type)===0}get isSingleTap(){return this.taps.length===1}get isDoubleTap(){return this.taps.length===2}discardOutsideOfWaitWindow(t){this.taps=this.taps.filter(e=>t-e.timestamp<300)}flush(){this.taps=[]}get _taps(){return this.taps}destroy(){this.flush()}};C();function uL(t){let e=new Set;for(let r of t){let n=r.object;for(;n.visible&&n.parent&&n.parent.visible===!0&&!e.has(n.parent);)n=n.parent,n instanceof ui&&n.type==="group-container"&&n.visible&&n.components[0]&&e.add(n)}return Array.from(e)}var XGe=class extends wi{constructor(t,e,r,n,i){super(),S(this,"raycaster",new G1),S(this,"state",{hovered3DEntity:void 0,hovered2DEntities:new Set,hovered3DContainers:void 0,lastHover:void 0,interaction:{mouseDownStart:void 0,distanceFromMouseDown:void 0,isPanning:!1}}),S(this,"coreState"),S(this,"camera"),S(this,"worldPlane"),S(this,"_quadtree",new Wm(new vn(0,0,0,0))),S(this,"_container"),S(this,"lastPointerEvent"),S(this,"cursor","grab"),S(this,"touchesCount",0),S(this,"isUserInteracting"),S(this,"hasTouched",!1),S(this,"onPointerMove",ePe(a=>{a&&(a.preventDefault(),this.updateInteractionStateIfPanning(a),(a.pointerType!=="touch"||a.pointerType===void 0&&this.hasTouched)&&this.handleHover(a),this.handleCursor())},Oi.env.NODE_ENV==="test"?0:16,{leading:!0})),S(this,"tapsControl",new HGe),S(this,"onPointerDown",a=>{a.target===this._container&&(this._container.addEventListener("pointerup",this.onPointerUp,!1),this._container.addEventListener("pointercancel",this.onPointerUp,!1),this.state.interaction.mouseDownStart={time:Date.now(),timestamp:a.timeStamp,offsetX:a.offsetX,offsetY:a.offsetY},this.lastPointerEvent=a,this.state.interaction.distanceFromMouseDown=0,this.handleCursor(),a.pointerType==="touch"&&(this.tapsControl.add(new WGe(a)),this.touchesCount=Math.max(0,this.touchesCount+1)))}),S(this,"clickTimeout"),S(this,"onPointerUp",a=>{this.tapsControl.discardOutsideOfWaitWindow(a.timeStamp),this.lastPointerEvent=a,this.touchesCount=Math.max(0,this.touchesCount-1),this.touchesCount===0&&(this._container.removeEventListener("pointerup",this.onPointerUp,!1),this._container.removeEventListener("pointercancel",this.onPointerUp,!1)),this.updateInteractionStateIfPanning(a);let{mouseDownStart:o}=this.state.interaction;!o||this.state.interaction.distanceFromMouseDown==null||(Date.now()<o.time+300&&(this.tapsControl.isSingleTapWithTwoFingers||this.state.interaction.distanceFromMouseDown<=15)&&(a.pointerType==="touch"?this.tapsControl.isSingleTapWithTwoFingers?(this.publish("singletap-with-twofinger",a),this.flush()):this.tapsControl.isSingleTapWithOneFinger&&this.touchesCount===0?(this.clickTimeout&&clearTimeout(this.clickTimeout),this.clickTimeout=window.setTimeout(()=>{this.handleClick(a),this.flush()},300)):this.tapsControl.isDoubleTapWithOneFinger&&(this.publish("doubletap-with-onefinger",a),this.flush()):this.handleClick(a)),this.state.interaction.mouseDownStart=void 0,this.state.interaction.distanceFromMouseDown=void 0,this.state.interaction.isPanning=!1,this.handleCursor())}),S(this,"dirty3D",!0),S(this,"cachedHitBoxes",{entities:[]}),S(this,"ndcPoint",new Je),S(this,"debugPanel"),this.isUserInteracting=i,this.raycaster.layers.enableAll(),this.raycaster.layers.disable(1),this.camera=r,this._container=t,this.coreState=e,this.worldPlane=n,this._container.addEventListener("pointerdown",this.onPointerDown,!1),this._container.addEventListener("pointermove",this.onPointerMove,!1),this._container.classList.add("mappedin-interactive")}updateQuadtree(t){this._quadtree=t}setHovered3DEntityInteractionComponentDirty(){if(this.state.hovered3DEntity){let t=this.state.hovered3DEntity.components[2];t&&(t.dirty=!0)}}getThreeDIntersectsFromXY(t){this.raycaster.setFromCamera(t,this.camera),this.raycaster.layers.enable(0);let e=this.raycaster.intersectObjects(this._hitBoxes.entities,!0).filter(n=>{var i,a;return((i=n.object)==null?void 0:i.name)==="worldPlane"||((a=n.object)==null?void 0:a.visible)}),r=e.findIndex(n=>{var i;return((i=n.object)==null?void 0:i.name)==="worldPlane"});return r!==-1&&e.push(e.splice(r,1)[0]),e}getGroupContainerIntersectsFromXY(t){let e=this.getThreeDIntersectsFromXY(t),r;return e!=null&&e.length>0&&(r=uL(e)),r}flush(){this.tapsControl.flush(),this.clickTimeout!=null&&(clearTimeout(this.clickTimeout),this.clickTimeout=void 0)}handleHover(t){let e=t||this.lastPointerEvent;if(this.state.interaction.mouseDownStart||!e||this.isUserInteracting())return;let{entity3D:r,entity2D:n,position:i,groupContainers:a}=this.intersect(e);(this.detect3DEntityHover(r)||this.detect2DEntityHover(n)||this.detect3DContainerHover(a))&&(this.state.hovered3DEntity=r,this.state.lastHover=r,this.state.hovered2DEntities=new Set(n.map(o=>o.id)),this.state.hovered3DContainers=a,this.publish("hover",{entity2D:n,entity3D:this.state.hovered3DEntity,position:i,groupContainers:a})),this.handleCursor()}handleCursor(){var t;let e=!!(this.state.hovered3DEntity&&(t=this.state.hovered3DEntity)!=null&&t.components[2]||this.state.hovered2DEntities.size>0),r=!!this.state.interaction.mouseDownStart,n=this.state.interaction.isPanning,i=qGe(e,n,r);this.cursor!==i&&(this.cursor=i,i==="pointer"?this._container.classList.add("mappedin-interaction-hover"):this._container.classList.remove("mappedin-interaction-hover"))}detect2DEntityHover(t){if(t.length!==this.state.hovered2DEntities.size)return!0;for(let e=0;e<t.length;e++)if(!this.state.hovered2DEntities.has(t[e].id))return!0;return!1}handleClick(t){let e=this.intersect(t);this.publish("click",{entity2D:e.entity2D,entity3D:e.entity3D,position:e.position,groupContainers:e.groupContainers,pointerEvent:{button:t.button}})}get _hitBoxes(){if(this.dirty3D){this.cachedHitBoxes.entities=[];let t;for(let e of this.coreState.geometry3DIdsInScene)t=this.coreState.geometry3DMap.get(e),(t?.type==="geometry"||t?.type==="model"||t?.type==="path"||t?.type==="custom-geometry")&&t.components[0].mesh&&!this.cachedHitBoxes.entities.includes(t.components[0].mesh)&&this.cachedHitBoxes.entities.push(t.components[0].mesh);return this.dirty3D=!1,this.cachedHitBoxes.entities.push(this.worldPlane),this.cachedHitBoxes}return this.cachedHitBoxes}intersect(t){var e,r,n,i,a;let{offsetX:o,offsetY:s}=t,l=[o,s],u=this._quadtree.queryPoint(l).filter(A=>A.intersectsPoint(l));this.ndcPoint.x=o/this._container.clientWidth*2-1,this.ndcPoint.y=-(s/this._container.clientHeight)*2+1;let c=this.getThreeDIntersectsFromXY(this.ndcPoint),h=(e=c[0])==null?void 0:e.point,d=[],p=[],m=c.filter(A=>A.object.name!=="worldPlane");for(let A of m)A.object instanceof Er&&A.object.material.depthTest===!1?d.push(A):p.push(A);let y=(n=(r=d[0])!=null?r:p[0])!=null?n:void 0,v,_;if(y!=null){if(v=JGe(y.object,this.coreState.geometry3DMap),!v){let A=(i=y?.instanceId)!=null?i:y?.batchId;v=A!=null&&y!=null&&y.object.userData.entities?this.coreState.geometry3DMap.get(y?.object.userData.entities[A]):this.coreState.geometry3DMap.get(y?.object.userData.entityId)}v!=null&&v.components[2]&&(_=v)}let w=uL(m),b=[];for(let A of u)if(((a=A?.userData)==null?void 0:a.entityId)==="watermark")b.push({id:"watermark"});else{let E=this.coreState.geometry2DMap.get(A?.userData.entityId);E&&b.push(E)}return KGe(b),{entity2D:b,entity3D:_,position:h,groupContainers:w.length>0?w:void 0}}detect3DEntityHover(t){return this.state.lastHover!==t&&(this.state.lastHover&&cL(this.state.lastHover,!1,this.coreState),t&&cL(t,!0,this.coreState)),this.state.hovered3DEntity!==t}detect3DContainerHover(t){return!Nme(this.state.hovered3DContainers,t)}updateInteractionStateIfPanning(t){this.state.interaction.mouseDownStart&&(this.state.interaction.distanceFromMouseDown=Math.sqrt(Math.pow(t.offsetX-this.state.interaction.mouseDownStart.offsetX,2)+Math.pow(t.offsetY-this.state.interaction.mouseDownStart.offsetY,2)),!this.state.interaction.isPanning&&this.state.interaction.distanceFromMouseDown>15&&(this.state.interaction.isPanning=!0))}getMouseRayIntersects(){return this.raycaster.intersectObjects([this.worldPlane],!1)}destroy(){this._container.removeEventListener("pointerdown",this.onPointerDown,!1),this._container.removeEventListener("pointermove",this.onPointerMove,!1),this._container.removeEventListener("pointerup",this.onPointerUp,!1),this._container.removeEventListener("pointercancel",this.onPointerUp,!1)}enableDebug(){let t=document.createElement("div");t.style.position="absolute",t.style.top="0",t.style.right="0",t.style.backgroundColor="white",t.style.padding="10px",document.body.append(t),t.id="interaction-debug-panel",this.debugPanel=t,this.on("doubletap-with-onefinger",()=>{this.queueDebugMessage("doubletap-with-onefinger","#ffadad")}),this.on("singletap-with-twofinger",()=>{this.queueDebugMessage("singletap-with-twofinger","#ffd6a5")}),this.on("click",e=>{var r,n,i;this.queueDebugMessage(`CLICK 
3D: `.concat((r=e.entity3D)==null?void 0:r.id,` 
2D: `).concat((n=e.entity2D)==null?void 0:n.map(a=>a.id).join(", "),` 
Pos: `).concat((i=e.position)==null?void 0:i.toArray().join(", ")),"#fdffb6")}),this.on("hover",e=>{var r,n,i;this.queueDebugMessage(`HOVER 
3D: `.concat((r=e.entity3D)==null?void 0:r.id,` 
2D: `).concat((n=e.entity2D)==null?void 0:n.map(a=>a.id).join(", "),` 
Pos: `).concat((i=e.position)==null?void 0:i.toArray().join(", ")),"#caffbf")})}get _state(){return this.state}queueDebugMessage(t,e){var r;let n=document.createElement("pre");n.style.maxWidth="300px",n.style.transition="opacity 500ms cubic-bezier(0.4, 0, 0.2, 1)",n.style.backgroundColor=e,n.textContent=t,(r=this.debugPanel)==null||r.prepend(n),setTimeout(()=>{n.style.opacity="0",setTimeout(()=>{n.remove()},500)},2500)}getCursor(){return this.cursor}};function cL(t,e,r){var n;let i=t.components[2];i&&i.hover!==!0&&(i.hover=e?"user-interaction":!1,i.dirty=!0);let a=(n=t.components[0].textMesh)==null?void 0:n.userData.entityId;if(!a)return;let o=r.geometry3DMap.get(a);o?.type==="text3d"&&(o.components[1].hoverByPolygon=e,o.components[1].dirty=!0)}function qGe(t,e,r){return e?"grabbing":t?"pointer":r?"grabbing":"grab"}function YGe(t){let e=t;for(;e!=null&&e.parent;){if(e instanceof bP)return;if(e.userData.isSingleModel)return e;e=e.parent}}function JGe(t,e){let r=YGe(t);return r?e.get(r.userData.entityId):void 0}function KGe(t){if(t.length<=1)return;let e=[],r=[];for(let i=0;i<t.length;i++){let a=t[i];a.type==="marker"?e.push(a):r.push(a)}if(e.length>1){let i,a;e.sort((o,s)=>{i=o.components[0],a=s.components[0];let l=i.projection.y,u=a.projection.y;return l!==u?u-l:i.markerContainer.compareDocumentPosition(a.markerContainer)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1})}if(r.length>1){let i=[];for(let a=0;a<r.length;a++){let o=r[a],s=o.components[0];i.push({entity:o,y:s.projection.y,idx:a})}i.sort((a,o)=>a.y!==o.y?o.y-a.y:o.idx-a.idx);for(let a=0;a<i.length;a++)r[a]=i[a].entity}let n=0;for(let i=0;i<e.length;i++)t[n++]=e[i];for(let i=0;i<r.length;i++)t[n++]=r[i]}C();C();var Hm,_p,e6,lv,Lte,rw,t6,Nte,$te,nw,r6,iw,hA,n6,QGe=class{constructor(t){K(this,lv),K(this,Hm,null),K(this,_p),S(this,"getCurrentSceneGLTF",async e=>{let r=ae({onlyVisible:!0,binary:!0,light:!0,scale:1},e),n=await ot(this,lv,Lte).call(this),i=f(this,e6).call(this,r),a=await n.parseAsync(i,{trs:!1,maxTextureSize:1/0,onlyVisible:r.onlyVisible,binary:r.binary,scale:r.scale}),o;if(a instanceof ArrayBuffer)o=new Blob([a],{type:"application/octet-stream"});else{let s=JSON.stringify(a,null,2);o=new Blob([s],{type:"text/plain"})}return o}),K(this,e6,e=>{let{scale:r,light:n,onlyVisible:i}=e,a=new bP,o=new qn().setFromObject(f(this,_p).geometryScene);if(f(this,rw).call(this,f(this,_p).geometryScene,a,i),n){let s=new DN(16777215,.3*Math.PI);s.position.set(0,Math.max(o.max.x,o.max.y)*r*.5,o.max.y*r*4),s.lookAt(0,0,-1),s.target.position.set(0,0,-1),s.add(s.target),a.add(s)}return a}),K(this,rw,(e,r,n)=>{e.material&&(e instanceof wP?ot(this,lv,Nte).call(this,e).forEach(i=>r.add(i)):e instanceof AP&&r.add(ot(this,lv,$te).call(this,e))),e.children.forEach(i=>{(!n||i.visible)&&f(this,rw).call(this,i,r,n)})}),K(this,t6,(e,r,n)=>{let i=new l4({color:new jt(e),metalness:0});return i.opacity=r,i.transparent=n,i}),K(this,nw,e=>{let{geometry:r,material:n,position:i,rotation:a,quaternion:o,scale:s}=e;if(!(r!=null&&r.isBufferGeometry))return e;let l=r.attributes.position,u=r.attributes.normal,c=r.attributes.uv;return f(this,r6).call(this,l,u),f(this,hA).call(this,i,s,a,o),c&&f(this,n6).call(this,c),n!=null&&n.map&&r.type==="PlaneGeometry"&&(e.side=po),e}),K(this,r6,(e,r)=>{let n=new Q,i=new Q;for(let a=0;a<e.count;a++)n.fromBufferAttribute(e,a),f(this,iw).call(this,n),e.setXYZ(a,n.x,n.y,n.z),r&&(i.fromBufferAttribute(r,a),f(this,iw).call(this,i),r.setXYZ(a,i.x,i.y,i.z))}),K(this,iw,e=>{let r=e.y;e.y=e.z,e.z=-r}),K(this,hA,(e,r,n,i)=>{let a=e.y;e.y=e.z,e.z=-a;let o=r.y;if(r.y=r.z,r.z=o,n instanceof Vo)n.order="YXZ",n.set(n.x,n.y,n.z,n.order);else{let s=i.y;i.set(i.x,i.z,-s,i.w)}}),K(this,n6,e=>{for(let r=0;r<e.count;r++){let n=e.getX(r),i=e.getY(r);e.setXY(r,n,i)}}),ne(this,_p,t)}destroy(){ne(this,Hm,null)}};Hm=new WeakMap,_p=new WeakMap,e6=new WeakMap,lv=new WeakSet,Lte=async function(){if(!f(this,Hm)){let{GLTFExporter:t}=await N1(()=>import("./GLTFExporter-LWJJKW2X-D4VfamO9.js"),__vite__mapDeps([4,1,2]));ne(this,Hm,new t)}return f(this,Hm)},rw=new WeakMap,t6=new WeakMap,Nte=function(t){var e,r;let n=[],i=((e=t.userData)!=null&&e.entities?Object.values((r=t.userData)==null?void 0:r.entities):[]).map(o=>f(this,_p).geometry3DMap.get(o)),a=new Map;return i.forEach(o=>{var s;if(!o||!(o instanceof Cn))return;let l=o.components[1],u=o.components[2];if(!l.visible||l instanceof ug&&l.opacity===0||l instanceof JM||l instanceof Oq)return;let c=u!=null&&u.hover?l.hoverColor||f(this,_p).hoverColor:l.color,h="".concat(c,"-").concat(l.opacity,"-").concat(Number(l.visible));a.has(h)||a.set(h,[]),(s=a.get(h))==null||s.push(o)}),a.forEach((o,s)=>{let[l,u,c]=s.split("-"),h=o.reduce((y,v)=>{if(v.type==="custom-geometry")return y;let _=v.components[0];return"geometry"in _&&_.geometry instanceof Ja&&y.push(_.geometry),y},[]);if(h.length===0){Be.error("No geometries found for batched mesh");return}let d=f(this,t6).call(this,l,Number(u),t.material.transparent),p=vd(h,!0);if(!p){Be.error("No merged geometry found for batched mesh");return}let m=new Er(p,d);m.position.copy(t.position),m.rotation.copy(t.rotation),m.scale.copy(t.scale),m.visible=!!c,f(this,hA).call(this,m.position,m.scale,m.rotation,m.quaternion),n.push(f(this,nw).call(this,m))}),n},$te=function(t){let e=t.geometry.clone(),r=t.material,n=new Go({color:r.color,side:po});n.opacity=r.opacity,n.transparent=r.transparent;let i=new AP(e,n);return i.position.copy(t.position),i.rotation.copy(t.rotation),i.scale.copy(t.scale),i.visible=t.visible,f(this,nw).call(this,i)},nw=new WeakMap,r6=new WeakMap,iw=new WeakMap,hA=new WeakMap,n6=new WeakMap;C();C();var eZe="gray",tZe=.1,wy=100,xI=new Wa.ClipperOffset;function rZe(t,e){xI.Clear(),e/=2;let r=t.map(i=>({X:i.x*wy,Y:i.y*wy}));xI.AddPath(r,Wa.JoinType.jtMiter,Wa.EndType.etClosedPolygon);let n=new Wa.Paths;return xI.Execute(n,e*wy),n.length?n.map(i=>i.map(a=>({x:a.X/wy,y:a.Y/wy}))):[t]}function Ute(t,e,r){var n,i,a,o,s;let{color:l=eZe,opacity:u=1,altitude:c=0,height:h=tZe}=r||{};Array.isArray(u)&&(u=1);let d={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},p=t.geometry.coordinates[0].map(_=>{let w=e(_[1],_[0]);return d.min.x=Math.min(d.min.x,w.x),d.min.y=Math.min(d.min.y,w.y),d.max.x=Math.max(d.max.x,w.x),d.max.y=Math.max(d.max.y,w.y),w});((i=(n=t.properties)==null?void 0:n.style)==null?void 0:i.edgeOffset)!=null&&t.properties.style.edgeOffset!==0||((a=t.properties)==null?void 0:a.image)!=null?p=rZe(p,((s=(o=t.properties)==null?void 0:o.style)==null?void 0:s.edgeOffset)||0):p=[p];let m=[];for(let _ of p){let w=new j1;w.moveTo(_[0].x,_[0].y),_.slice(1).forEach(M=>w.lineTo(M.x,M.y)),w.lineTo(_[0].x,_[0].y);let b=t.geometry.coordinates.slice(1);w.holes=b.map(M=>{let P=M.map(D=>e(D[1],D[0])),k=new wg;return k.moveTo(P[0].x,P[0].y),P.slice(1).forEach(D=>k.lineTo(D.x,D.y)),k.lineTo(P[0].x,P[0].y),k});let A=VM(r?.bevel,h),E=new EA(w,A);E.userData={style:{color:l,opacity:u},usedBevelSettings:A},m.push(E)}if(m.length===1)return m[0];let y=vd(m);m.forEach(_=>_.dispose());let v=VM(r?.bevel,h);return y.userData={style:{color:l,opacity:u},usedBevelSettings:v,_split:!0},y}C();var nZe="gray",iZe=.1;function jte(t,e,r){let{color:n=nZe,opacity:i=1,altitude:a=0,height:o=iZe}=r||{};Array.isArray(i)&&(i=1);let s={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},l=VM(r?.bevel,o),u=[];t.geometry.coordinates.forEach(h=>{let d=new j1,p=h[0].map(v=>{let _=e(v[1],v[0]);return s.min.x=Math.min(s.min.x,_.x),s.min.y=Math.min(s.min.y,_.y),s.max.x=Math.max(s.max.x,_.x),s.max.y=Math.max(s.max.y,_.y),_});d.moveTo(p[0].x,p[0].y),p.slice(1).forEach(v=>d.lineTo(v.x,v.y)),d.lineTo(p[0].x,p[0].y);let m=h.slice(1);d.holes=m.map(v=>{let _=v.map(b=>e(b[1],b[0])),w=new wg;return w.moveTo(_[0].x,_[0].y),_.slice(1).forEach(b=>w.lineTo(b.x,b.y)),w.lineTo(_[0].x,_[0].y),w});let y=new EA(d,l);u.push(y)});let c=vd(u);return u.forEach(h=>h.dispose()),c.translate(0,0,a||0),c.userData={style:{color:n,opacity:i},usedBevelSettings:l},c}C();var oo=100,aZe=.22,oZe=.01;function sZe(t,e,r={}){let{width:n=aZe,height:i=oZe,color:a="gray",opacity:o=1,altitude:s=0}=r,l={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},u={bevelEnabled:!1,depth:i},c=new Wa.ClipperOffset,h=t.geometry.coordinates.map(y=>y.map(v=>e(v[1],v[0])));c.AddPaths(h.map(y=>y.map(v=>({X:v.x*oo,Y:v.y*oo}))),Wa.JoinType.jsMiter,Wa.EndType.etOpenRound);let d=new Wa.PolyTree;c.Execute(d,n/2*oo);let p=[];for(let y of d.m_AllPolys){let v=new j1;if(y.IsHole())continue;l.min.x=Math.min(l.min.x,y.m_polygon[0].X),l.min.y=Math.min(l.min.y,y.m_polygon[0].Y),l.max.x=Math.max(l.max.x,y.m_polygon[0].X),l.max.y=Math.max(l.max.y,y.m_polygon[0].Y);let _=y.m_polygon;v.moveTo(_[0].X/oo,_[0].Y/oo),_.slice(1).forEach(w=>v.lineTo(w.X/oo,w.Y/oo)),v.lineTo(_[0].X/oo,_[0].Y/oo),v.holes=y.m_Childs.map(w=>{let b=new wg,A=w.m_polygon;return b.moveTo(A[0].X/oo,A[0].Y/oo),A.slice(1).forEach(E=>b.lineTo(E.X/oo,E.Y/oo)),b.lineTo(A[0].X/oo,A[0].Y/oo),b}),p.push(new EA(v,u))}let m=vd(p);return m.translate(0,0,s||0),m.userData={style:{color:a,opacity:o}},c.Clear(),m}C();C();var lB=Nr({type:Pa(["Point"]),coordinates:bo(pt()).min(2).max(3)}),Vte=Nr({rotation:bo(pt()).length(3).optional(),altitude:pt().optional(),scale:bo(pt()).length(3).optional(),interactive:Lr().optional(),verticalOffset:pt().optional(),id:zi([pt(),mr()]).optional()}),lZe=Nr({type:Pa(["Feature"]),geometry:lB,properties:Vte}),uZe=Nr({type:Pa(["FeatureCollection"]),features:bo(lZe)}),Gte=Nr({color:mr()}),cZe=Nr({url:mr(),color:mr().optional(),opacity:pt().optional(),material:ZA(mr(),Gte).optional()});function hZe(t,e,r){zi([pt(),mr()]).parse(t),uZe.parse(e),cZe.parse(r)}var aw,ow,sw,uv,eu,lw=class{constructor(t){S(this,"mesh"),S(this,"type","model"),S(this,"positionDirty",!0),S(this,"outline"),S(this,"geometry"),S(this,"material"),S(this,"feature"),S(this,"instanceIndex",-1),K(this,aw,!0),S(this,"color",new jt),S(this,"clippingPlane"),S(this,"position",new Q),K(this,ow,0),K(this,sw,1),K(this,uv,rd.GEOMETRY),K(this,eu,!1),this.feature=t}get visible(){var t,e;return(e=(t=this.mesh)==null?void 0:t.visible)!=null?e:f(this,aw)}set visible(t){ne(this,aw,t),this.mesh&&(this.mesh.visible=t)}setOpacity(){}setColor(){}get modelScene(){var t;return this.clippingPlane?(t=this.mesh)==null?void 0:t.children.find(e=>e.name!=="hole-fill-mesh"):this.mesh}get altitude(){return f(this,ow)}set altitude(t){this.modelScene&&(this.modelScene.position.z=t,ne(this,ow,t))}getRotation(){return this.modelScene?[this.modelScene.rotation.x,this.modelScene.rotation.y,this.modelScene.rotation.z]:void 0}setRotation(t){this.modelScene&&this.modelScene.rotation.set(In.degToRad(t[0]),In.degToRad(t[1]),In.degToRad(t[2]))}getScale(){return this.modelScene?[this.modelScene.scale.x,this.modelScene.scale.y,this.modelScene.scale.z]:void 0}setScale(t){var e;this.modelScene&&((e=this.modelScene)==null||e.scale.set(t[0],t[1],t[2]))}get opacity(){return f(this,sw)}set opacity(t){var e,r,n;if(this.mesh){if(this.mesh.children[0]instanceof Bm){for(let i of this.mesh.children)if(i instanceof Bm){((e=i.userData)==null?void 0:e.originalOpacity)===void 0&&(i.userData.originalOpacity=i.material.opacity);let a=m5(t,0,(r=i.userData)==null?void 0:r.originalOpacity,0,1);i.material.opacity=a,i.material.transparent=a<1,i.material.needsUpdate=!0}}else(n=this.mesh)==null||n.traverse(i=>{i instanceof Er&&i.material&&(Array.isArray(i.material)?i.material.forEach(a=>{hL(a,t)}):hL(i.material,t))});ne(this,sw,t)}}get renderOrder(){return f(this,uv)}set renderOrder(t){var e;if(!(!this.mesh||t===f(this,uv)))if(ne(this,uv,t),this.mesh.children[0]instanceof Bm){this.mesh.renderOrder=t;for(let r of this.mesh.children)r instanceof Bm&&(r.material.depthWrite=!f(this,eu),r.material.depthTest=!f(this,eu),r.material.needsUpdate=!0)}else(e=this.mesh)==null||e.traverse(r=>{r instanceof Er&&r.material&&(r.renderOrder=t,Array.isArray(r.material)?r.material.forEach(n=>{n.depthWrite=!f(this,eu),n.depthTest=!f(this,eu),n.needsUpdate=!0}):(r.material.depthWrite=!f(this,eu),r.material.depthTest=!f(this,eu),r.material.needsUpdate=!0))})}get visibleThroughGeometry(){return f(this,eu)}set visibleThroughGeometry(t){ne(this,eu,t)}};aw=new WeakMap,ow=new WeakMap,sw=new WeakMap,uv=new WeakMap,eu=new WeakMap;function hL(t,e){t.opacity!==e&&(e===1?(t.opacity=1,t.transparent=!1):(t.opacity=e,t.transparent=!0),t.needsUpdate=!0)}C();function Zte(t){var e,r;let n=t.components[0],i=t.components[1];i.opacity!=null&&i.opacity!==n.opacity&&(n.opacity=i.opacity);let a=i.material,o=i.color;if(a||o){let u=dZe(o,a);(e=n.mesh)==null||e.traverse(c=>{c instanceof Er&&c.material&&(Array.isArray(c.material)?c.material.forEach(h=>{u[h.name]?(h.color.set(u[h.name].color),h.vertexColors=!1):h.color.set(o)}):u[c.material.name]?(c.material.color.set(u[c.material.name].color),c.material.vertexColors=!1):c.material.color.set(o))})}let s=(r=n.feature.geometry.coordinates[2])!=null?r:0,l=i.verticalOffset+s;n.altitude!==l&&(n.altitude=l),i.visible!==n.visible&&(n.visible=i.visible),i.rotation&&n.setRotation(i.rotation),i.scale&&n.setScale(i.scale),i.visibleThroughGeometry!==n.visibleThroughGeometry&&(n.visibleThroughGeometry=i.visibleThroughGeometry)}function dZe(t,e){let r={};if(e)for(let n in e)e[n].color&&(r[n]={color:e[n].color});if(t){let n=["Default","Fabric","Mpdn_Logo","CouchLogo"];for(let i of n)r[i]||(r[i]={color:t})}return r}function pZe(t,e){var r,n;let i=t.components[0],a=(r=t.components[1].verticalOffset)!=null?r:0,o=i.feature.geometry.coordinates.slice();o[2]=((n=o[2])!=null?n:0)+a,i.mesh?i.mesh.position.copy(e(o)):i.position.copy(e(o))}function Jd(t){return t instanceof Xa?t.material:null}function fZe(t){return t.side===xa?"back":t.side===_s?"front":"double"}function mZe(t,e){t.side=e==="back"?xa:e==="front"?_s:po}function gZe(t){let{opacity:e,texture:r,topTexture:n}=t;return"".concat(e).concat(r||"").concat(n||"")}var yZe=class extends wi{constructor(t,e){super(),S(this,"state"),S(this,"convertTo3DMapPosition"),S(this,"loader"),S(this,"optimizePromise",[]),this.state=t,this.convertTo3DMapPosition=e}async getGLTFLoader(){if(this.loader)return this.loader;let{GLTFLoader:t}=await N1(()=>import("./GLTFLoader-EQV4GOIS-CJ5c0SNG.js"),__vite__mapDeps([5,1,2]));return this.loader=new t,this.loader}createEntityFromFeature(t,e,r){var n,i,a,o;let s=new Xa(e),l=(n=e?.properties)==null?void 0:n.bevel,u=r&&"bevel"in r?r.bevel:void 0,c;u?c=ae(ae({},l),u):l&&(c=l);let h=new Cn(s,new ug(lt(ae({},r),{url:(a=(i=e.properties)==null?void 0:i.image)==null?void 0:a.path,bevel:c})));return r!=null&&r.outline&&(h.components[3]=new pq(Nk(r.color))),r!=null&&r.focusable&&(h.components[4]=new j4),((o=e.properties)==null?void 0:o.textures)!=null&&Array.isArray(e.properties.textures)&&e.properties.textures.length>0?h.components[6]=new M1(e.properties.textures.find(d=>d.face==="side"),e.properties.textures.find(d=>d.face==="top")):(r!=null&&"texture"in r&&r.texture!=null||r!=null&&"topTexture"in r&&r.topTexture!=null)&&(h.components[6]=new M1(r.texture,r.topTexture)),h.id=t,h}createModelFromFeature(t,e,r){let n=new lw(e),i=ae({},r);e.properties.verticalOffset!=null&&(i.verticalOffset=e.properties.verticalOffset),e.properties.rotation!=null&&(i.rotation=e.properties.rotation),e.properties.scale!=null&&(i.scale=e.properties.scale);let a=new Oq(i),o=new Cn(n,a);return o.id=t,o}populateEntityMesh(t,e){let r=t.components[0];r.geometry=e,r.batchedProps={range:{start:0,count:1/0,indexCount:1/0,indexStart:0,vertexCount:1/0,vertexStart:0,reservedVertexCount:1/0,reservedIndexCount:1/0},geometryId:-1,positionCount:e.attributes.position.count},r.currentHeight=t.components[1].height,r.dirty=!1}async populateModelGroup(t,e,r){let n=new gr,i=new Vo,a=new Iu,o=new Q,s=new _0,l=await this.getGLTFLoader(),u=new Promise(c=>{let h=d=>{"entities3D"in r.userData&&(r.userData.entities3D.size>1?d.scene.traverse(p=>{let m=p;if("isMesh"in m&&m.isMesh===!0){let y=new Bm(m.geometry,m.material,t.size);y.userData={entities:{}},s.add(y),r.add(s)}}):(d.scene.traverse(p=>{"isMesh"in p&&p.isMesh===!0&&(p.position.set(0,0,0),p.rotation.set(0,0,0),p.scale.set(1,1,1),p.updateMatrix())}),s.add(d.scene),r.add(s),s.userData.isSingleModel=!0,s.userData.entityId=t.values().next().value,s.userData.type="model")),c()};if(e.trimStart().startsWith("{")||e.startsWith("data:")&&e.includes("application/json")){let d=e.startsWith("data:")?atob(e.split(",")[1]):e;l.parse(d,"",h)}else l.load(e,h)});return this.optimizePromise.push(u.then(()=>{var c,h,d,p,m,y,v,_,w,b,A,E;let M=0,P;for(let k of t.values()){if(P=this.state.geometry3DMap.get(k),!P||P?.type!=="model")continue;let D=P.components[0],O=P.components[1],B=P.components[0].feature;D.mesh=s,D.instanceIndex=M,Zte(P),P.components[1].dirty=!1;let{x:L,y:R}=this.convertTo3DMapPosition(B.geometry.coordinates[1],B.geometry.coordinates[0],0);D.position.set(L,R,D.altitude),i.set(In.degToRad((h=(c=O.rotation)==null?void 0:c[0])!=null?h:h2[0]),In.degToRad((p=(d=O.rotation)==null?void 0:d[1])!=null?p:h2[1]),In.degToRad((y=(m=O.rotation)==null?void 0:m[2])!=null?y:h2[2])),o.set((_=(v=O.scale)==null?void 0:v[0])!=null?_:c2[0],(b=(w=O.scale)==null?void 0:w[1])!=null?b:c2[1],(E=(A=O.scale)==null?void 0:A[2])!=null?E:c2[2]),a.setFromEuler(i),n.compose(D.position,a,o),s.children.forEach(T=>{!P||P?.type!=="model"||!(T instanceof Bm)||(T.setMatrixAt(M,n),T.userData.entities[M]=P.id)}),D.mesh.userData.isSingleModel&&(D.mesh.matrix.copy(n),D.mesh.matrix.decompose(D.mesh.position,D.mesh.quaternion,D.mesh.scale)),M++}this.publish("model-loaded")})),s}populateEntityGroup(t){var e;let r,n,i,a;for(let o of t.values())a=this.state.geometry3DMap.get(o),a.components[0]instanceof Xa&&(n=a.components[0].feature,i=a.components[1],n.geometry.type==="Polygon"?(r=Ute(n,this.convertTo3DMapPosition,i),(e=n.properties)!=null&&e.textures&&n.properties.textures.length>0&&d6e(r,n.properties.textures,this.state.naturalBearing,this.convertTo3DMapPosition),this.populateEntityMesh(a,r)):n.geometry.type==="MultiPolygon"?(r=jte(n,this.convertTo3DMapPosition,i),this.populateEntityMesh(a,r)):n.geometry.type==="LineString"?(r=HM(n,this.convertTo3DMapPosition,i),this.populateEntityMesh(a,r)):n.geometry.type==="MultiLineString"&&(r=sZe(n,this.convertTo3DMapPosition,i),this.populateEntityMesh(a,r)));return t}update(){var t;for(let e of this.state.geometryGroupIdsToLoad.values()){let r=this.state.geometry3DMap.get(e);if(r instanceof _o&&r.userData.dirty){if(r.userData.modelURL)r.userData.modelURL&&(this.populateModelGroup(r.userData.entities3D,r.userData.modelURL,r),r.userData.dirty=!1);else try{this.populateEntityGroup(r.userData.entities3D)}catch(a){Be.warn(a)}let n,i={};for(let a of r.userData.entities3D.values()){n=this.state.geometry3DMap.get(a);let o=n?.components[0];if(n?.type==="geometry"){let s=n.components[1],l=gZe(s);i[l]===void 0&&(i[l]={style:s,entities:[]}),i[l].entities.push(n)}else o&&"mesh"in o&&o.mesh&&((t=o.mesh)==null?void 0:t.parent)!==r&&r.add(o.mesh)}for(let a in i){let o=h6e(i[a].entities,i[a].style);r.add(o)}for(let a of r.userData.entities3D.values())if(n=this.state.geometry3DMap.get(a),n!=null&&n.entities2D.size>0)for(let o of n.entities2D.values())o&&(n.attach(o),this.publish("geometry-2d-added"));this.publish("geometry-group-added"),r.userData.dirty=!1}}return Promise.resolve()}};C();var vZe=class{constructor(t,e){S(this,"state"),S(this,"dirty",!0),S(this,"domTree"),this.state=t,this.domTree=e}update(){if(this.dirty){let t;for(let e of Array.from(this.domTree.children))if(t=this.state.geometry2DMap.get(e.userData.entityId),t){let r=t.components[0];(!r.enabled||!r.visible||!this.state.geometry2DIdsInScene.has(e.userData.entityId))&&this.domTree.removeChild(e)}else this.domTree.removeChild(e);for(let e of this.state.geometry2DIdsInScene)if(t=this.state.geometry2DMap.get(e),t){let r=t.components[0];r instanceof Um&&r.enabled&&r.markerContainer&&!this.domTree.contains(r.markerContainer)&&(r.markerContainer.userData={entityId:t.id},this.domTree.appendChild(r.markerContainer),r.updateDimensionsIfZeroWidthHeight())}this.dirty=!1}}};C();var _Ze=class{constructor(t,e){S(this,"state"),S(this,"project"),this.state=t,this.project=e}update(){let t,e=0,r=0,n,i;for(let a of this.state.geometry2DIdsInScene)if(t=this.state.geometry2DMap.get(a),t){i=t.components[0];let o=t.attachedTo?this.state.geometry3DMap.get(t.attachedTo):void 0;if(o instanceof Cn)if(this.state.geometry3DIdsInScene.has(o.id)){n=o.components[1],i=t.components[0],(n.dirty||t.components[0].attachedDirty)&&(e=n.height,r=n.altitude,t.setAltitude(e+r));let s=n.visible;i.visible!==s&&(i.visible=s)}else i.visible===!0&&(i.visible=!1);this.project(t.components[0].projection,t.position),t.components[0].attachedDirty=!1}}};C();C();C();var xZe=(function(){let t,e;return r=>{if((!e||!e)&&(t=document.createElement("canvas"),t.width=500*r,t.height=500*r,t.style.width="500px",t.style.height="500px",e=t.getContext("2d")),!e)throw new Error("Could not get 2D context");return{measureCanvas:t,measureCanvasContext:e}}})(),bZe=({text:t,size:e,maxWidth:r,pixelRatio:n,maxLines:i=2,lineHeight:a=1.2,options:o={strokeText:!0}})=>{let s="bold ".concat(e*n,"px 'InterUI-Regular', Helvetica Neue, Arial, sans-serif"),{measureCanvasContext:l}=xZe(n);l.font=s;let u=[],c=t.split(" "),h=0,d=0,p=0;for(;d<c.length;){let v=c[d];if(h===i&&h>0){u[h-1]+="...";break}if(u[h]==null&&(u[h]=v,d++),c.length===1){u[h]=v;break}if(c[d]==null)break;let{width:_}=l.measureText(u[h]+" "+c[d]);_<=r*n?(u[h]+=" "+c[d],d++):h++}u.forEach(v=>{let{width:_}=l.measureText(v);p=Math.max(_,p)});let m=e*n*a,y=u.length*m;return{maxWidth:p,maxHeight:y,lines:u.length,draw:(v,_,w)=>{u.length===1?(o.strokeText&&v.strokeText(u[0],_,w),v.fillText(u[0],_,w)):(o.strokeText&&(v.strokeText(u[0],_,w-m/2),v.strokeText(u[1],_,w+m/2)),v.fillText(u[0],_,w-m/2),v.fillText(u[1],_,w+m/2))}}};C();function wZe(t){let e=new Image;return t&&(/<svg[\s\S]*>/i.test(t)?e.src="data:image/svg+xml;base64,".concat(btoa(t)):e.src=t),e}var AZe=class extends wi{constructor(t,e,r){super(),S(this,"dirty",!1),S(this,"state"),S(this,"colliderContext"),S(this,"colliderCanvas"),S(this,"transformRequestFunc"),S(this,"transformRequest",async n=>this.transformRequestFunc?await this.transformRequestFunc(n):{url:n}),S(this,"pinCache",{}),S(this,"imageCache",{}),S(this,"imagePromiseCache",{}),S(this,"imageDimensionsCache",{}),S(this,"textCache",{}),S(this,"update",n=>{let i=this.state.pixelRatio;this.colliderContext.clearRect(0,0,this.colliderCanvas.width,this.colliderCanvas.height);let a,o,s,l,u,c,h;for(let d of this.state.geometry2DIdsInScene)if(h=this.state.geometry2DMap.get(d),h!=null&&(c=h.components[0],c instanceof yp&&!h.disposed)){if(u=c.appearance.iconVisible,c.appearance.icon!=null&&u!=null){let m=typeof u=="boolean"?u:n>=u;m!==c.iconVisible&&(c.iconVisible=m,c.dirty=!0)}if((c.pinDirty||c.dirty||this.dirty)&&c.calculatePinSize(),o={active:c.appearance.pinColor,inactive:c.appearance.pinColorInactive},s={active:c.appearance.pinOutlineColor,inactive:c.appearance.pinOutlineColorInactive},l=Ip(c.pinSize,2),a="".concat(o.active,"-").concat(o.inactive,"-").concat(s.active,"-").concat(s.inactive,"-").concat(l,"-").concat(c.iconVisible),c.labelCacheId=a,(!this.pinCache[a]||this.dirty)&&(this.prepare(c,a,this.colliderContext),c.dirty=!0),(c.appearance.icon&&(!c.imageHash||c.pinDirty)||this.dirty)&&this.cacheImage(c),this.textCache[c.id]==null||c.textDirty||this.dirty){c.dirty=!0,this.textCache[c.id]={};let{textDrawFn:m,width:y,height:v}=this.processText(c.text,c.appearance.textSize,c.appearance.maxWidth,c.appearance.maxLines,c.appearance.lineHeight);["left","center","right"].forEach(_=>{this.textCache[c.id][_]=this.textToCanvas(m,c.appearance.textSize,_,y,v,c.appearance.textColor,c.appearance.textOutlineColor)}),c.dimensions={width:Math.ceil(y/i),height:Math.ceil(v/i)}}let p=1;if(c.appearance.iconScale)if(typeof c.appearance.iconScale=="number")p=c.appearance.iconScale;else{let{on:m,input:y,output:v,easing:_}=c.appearance.iconScale;m==="zoom-level"?p=YM(tge(n,y,v,_??"linear")):Be.warn("Unsupported interpolation property: ".concat(m))}c.recomputeCurrentStrategy(c.iconVisible?p:1),c.canShow&&c.visible&&(c.enabled||c.visibilityNeedsUpdate!==!1)&&this.draw(c,a,this.colliderContext),c.textDirty=!1,c.pinDirty=!1}this.dirty=!1}),S(this,"processText",(n,i,a,o,s)=>{let l=this.state.pixelRatio,{draw:u,maxWidth:c,maxHeight:h}=bZe({text:n,size:i,pixelRatio:l,maxWidth:a,maxLines:o,lineHeight:s});return{textDrawFn:u,width:c+2.5*l*2,height:h+2.5*l*2}}),S(this,"textToCanvas",(n,i,a,o,s,l,u)=>{let c=this.state.pixelRatio,h,d=o,p=s;window.OffscreenCanvas!=null&&!nPe()?h=new OffscreenCanvas(d,p):(h=document.createElement("canvas"),h.width=d,h.height=p,h.style.width=d+"px",h.style.height=p+"px");let m=h.getContext("2d",{willReadFrequently:!0});if(!m)return;let y=2.5*c;m.textAlign=a,m.font="bold ".concat(i*c,"px 'InterUI-Regular', Helvetica Neue, Arial, sans-serif"),m.textBaseline="middle",m.lineJoin="miter",m.miterLimit=2,m.strokeStyle="white",m.lineWidth=y,m.fillStyle=l,m.strokeStyle=u;let v=a==="left"?y/2:a==="center"?d/2:d-y/2;return n(m,v,(p+y/2)/2),h}),S(this,"cacheImage",n=>{if(!n.appearance.icon)return;let i=uPe(n.appearance.icon);this.imagePromiseCache[i]||(this.imagePromiseCache[i]=new Promise(a=>{this.transformRequest(n.appearance.icon).then(o=>{let s=wZe(o.url);s.onload=()=>{this.imageCache[i]=s,this.publish("img:loaded"),a(s)}})})),n.imageHash!==i&&(n.imageHash=i,this.imagePromiseCache[i].then(()=>{n.dirty=!0}))}),S(this,"createPinCanvas",(n,i,a,o,s=1)=>{let l,u=this.state.pixelRatio,c=n.totalPinSize*2*u*s;window.OffscreenCanvas!=null?l=new OffscreenCanvas(c,c):(l=document.createElement("canvas"),l.width=c,l.height=c,l.style.width=c/u+"px",l.style.height=c/u+"px");let h=l.getContext("2d");return h.shadowColor="rgba(0,0,0,0.3)",h.shadowOffsetY=2*u,h.shadowBlur=5*u,h.beginPath(),h.arc(c/2,c/2,(i/2+2.5*u/2)*s,0,2*Math.PI),h.fillStyle=a,h.fill(),h.beginPath(),h.arc(c/2,c/2,i/2*s,0,2*Math.PI),h.shadowColor="transparent",h.fillStyle=o,h.fill(),l}),S(this,"prepare",(n,i,a)=>{let o=this.state.pixelRatio;a.lineWidth=4*o;let s=typeof n.appearance.iconScale=="number"?[n.appearance.iconScale]:n.appearance.iconScale==null?[]:n.appearance.iconScale.output,l=s.length>0?Math.max(...s):void 0,u=this.createPinCanvas(n,n.pinSize,n.appearance.pinOutlineColor,n.appearance.pinColor,l),c=this.createPinCanvas(n,3.5*o,n.appearance.pinOutlineColorInactive,n.appearance.pinColorInactive,l);this.pinCache[i]=[u,c]}),this.state=t,this.colliderCanvas=e,this.colliderContext=e.getContext("2d"),this.transformRequestFunc=r}draw(t,e,r){var n;if(!t.canShow||!t.visible)return;r.save(),r.globalAlpha=t.currentOpacity;let i=this.state.pixelRatio,a=t.projection.x*i,o=t.projection.y*i,s=t.style.pinVisibility===1?this.pinCache[e][0]:this.pinCache[e][1],l=t.style.pinVisibility===1?t.scaledPinSize*i:t.totalPinSize*i;if(t.style.pinVisibility!==0&&r.drawImage(s,a-l,o-l,l*2,l*2),t.appearance.icon&&t.iconVisible&&t.imageHash&&t.appearance.iconSize&&this.imageCache[t.imageHash]&&t.style.pinVisibility===1){let u=this.imageCache[t.imageHash],c=(t.scaledPinSize-t.scaledIconPadding)*i,h=t.appearance.iconFit,d=c,p=c,m="".concat(t.imageHash,"_").concat(h);if(this.imageDimensionsCache[m])d=this.imageDimensionsCache[m].width,p=this.imageDimensionsCache[m].height;else{let y=u.width*i,v=u.height*i;if(h==="contain"){let _=Math.sqrt(y**2+v**2),w=c/_;d=y*w,p=v*w}if(h==="cover"){let _=c/y,w=c/v,b=Math.max(_,w);d=y*b,p=v*b}}r.save(),r.beginPath(),r.arc(a,o,c/2,0,2*Math.PI),r.closePath(),((n=t?.appearance)==null?void 0:n.iconOverflow)!=="visible"&&r.clip(),r.drawImage(u,a-d/2,o-p/2,d,p),r.restore()}t.style.textLabelVisible&&t.style.textAlign!=null&&t.style.left!=null&&t.style.top!=null&&r.drawImage(this.textCache[t.id][t.style.textAlign],a+t.style.left*i,o+t.style.top*i),r.restore()}};C();function SZe(t,e){let r=t.components[2],n=t.components[1];return r!=null&&r.hover?[n.hoverColor||e,n.hoverColor||e]:[n.color,n.topColor||n.color]}var EZe=class{constructor(t,e){S(this,"state"),S(this,"convertTo3DMapPosition"),this.convertTo3DMapPosition=e,this.state=t}determineTextureVisiblity(t,e,r){let n=Jd(t);(n?.texture!=null||n?.topTexture!=null)&&(r!=null&&r.hover&&n.texturesVisible?n.hideTextures(t.instanceIndex):n.texturesVisible||n.showTextures(t.instanceIndex),e.texture==null&&n.removeSideTexture(t.instanceIndex),e.topTexture==null&&n.removeTopTexture(t.instanceIndex))}update(){var t,e,r,n,i,a,o,s,l,u,c,h,d,p,m,y,v,_,w,b,A;let E,M,P;for(let k of this.state.geometry3DIdsInScene)if(P=this.state.geometry3DMap.get(k),P&&(P.type==="geometry"||P.type==="custom-geometry")&&((t=P.components[1])!=null&&t.dirty||(e=P.components[2])!=null&&e.dirty)){let D=P.components[0],O=P.components[1];M=P.components[2];let B=SZe(P,this.state.hoverColor);D.setColor(B[0],B[1]);let L=Jd(D);if(O.visible!==D.visible&&(D.visible=O.visible,D instanceof Xa&&D.textMesh)){let T=this.state.geometry3DMap.get(D.textMesh.userData.entityId);T?.type==="text3d"&&T.components[0].polygonEntityId!=null&&(T.components[0].visible=O.visible)}O.altitude!==D.altitude&&(D.altitude=O.altitude);let R=O.opacity*Gk(P);if(R!==D.opacity&&(D.opacity=R),O.renderOrder!==D.renderOrder&&(D.renderOrder=O.renderOrder),L&&O.side!==fZe(L)&&mZe(L,O.side),D instanceof Xa&&O.shading!=null&&(((r=O.shading)==null?void 0:r.start)!==((n=Jd(D))==null?void 0:n.getGradientShading().start)||((i=O.shading)==null?void 0:i.end)!==((a=Jd(D))==null?void 0:a.getGradientShading().end)||((o=O.shading)==null?void 0:o.intensity)!==((s=Jd(D))==null?void 0:s.getGradientShading().intensity))&&((m=Jd(D))==null||m.setGradientShading((u=(l=O.shading)==null?void 0:l.start)!=null?u:0,(h=(c=O.shading)==null?void 0:c.end)!=null?h:0,(p=(d=O.shading)==null?void 0:d.intensity)!=null?p:0)),O.dirty=!1,D instanceof Xa){let T=P.components[6];T instanceof M1&&this.determineTextureVisiblity(D,T,M)}P.components[2]&&(P.components[2].dirty=!1)}else if(P?.type==="model")P.components[1].dirty&&(Zte(P),P.components[1].dirty=!1),P.components[0].positionDirty&&(pZe(P,this.convertTo3DMapPosition),P.components[0].positionDirty=!1);else if(P?.type==="image"&&(y=P.components[1])!=null&&y.dirty){E=P.components[0];let D=P.components[1];D.visible!==E.visible&&(E.visible=D.visible),D.dirty=!1}else if(P?.type==="text3d"&&(v=P.components[1])!=null&&v.dirty&&P.components[0].polygonEntityId!=null){E=P.components[0];let D=P.components[1];D.visible!=null&&D.visible!==E.visible&&(E.visible=D.visible);let{textMesh:O}=E;if(O){Object.assign(O,D.getState());let B=(_=D.hoverColor)!=null?_:this.state.text3dHoverColor;O.color=D.hoverByPolygon?B:(w=D.color)!=null?w:jv.color,O.outlineColor=D.hoverByPolygon?B:(b=D.outlineColor)!=null?b:jv.outlineColor,O.strokeColor=D.hoverByPolygon?B:(A=D.strokeColor)!=null?A:jv.strokeColor}D.dirty=!1}}};C();var IZe=class extends wi{constructor(t){super(),S(this,"state"),S(this,"animating",new Map),S(this,"isAnimating",!1),S(this,"startTime",-1),S(this,"showDuration",300),S(this,"hideDuration",250),S(this,"update",()=>{var e;this.animating.clear();let r,n;for(let i of this.state.geometry2DIdsInScene)r=this.state.geometry2DMap.get(i),r&&(n=r.components[0],n instanceof yp&&(n.visibilityNeedsUpdate==="show"?(n.canShow=!0,this.animating.set(n,[n.currentOpacity,(e=n.appearance.opacity)!=null?e:1])):n.visibilityNeedsUpdate==="hide"&&this.animating.set(n,[n.currentOpacity,0])));this.startTime=performance.now(),this.publish("animate:2d")}),S(this,"playAnimations"),this.state=t,this.playAnimations=this._playAnimations}_playAnimations(){let t=performance.now();for(let[e,[r,n]]of this.animating.entries()){let i=n===1?this.showDuration:this.hideDuration,a=(t-this.startTime)/i;e.currentOpacity=m5(a,0,1,r,n,n===0?f5:IG),t-this.startTime>=i&&(n===1?e.canShow=!0:n===0&&(e.canShow=!1),e.visibilityNeedsUpdate=!1,this.animating.delete(e))}this.publish("draw:2d"),this.animating.size>0&&this.publish("animate:2d")}};C();var CZe=class extends wi{constructor(t,e,r,n,i,a,o){super(),S(this,"state"),S(this,"renderer"),S(this,"mode"),S(this,"scene"),S(this,"cameraObject"),S(this,"viewCamera"),S(this,"systems"),S(this,"needs2DRecompute",!1),S(this,"twoDdirty",!0),S(this,"threeDdirty",!0),S(this,"frameId",null),S(this,"twoDFrameId",null),S(this,"animationFrameId",null),S(this,"nextFrame",null),S(this,"updateEntitiesFrameId",null),S(this,"update",(s=!1)=>{var l;if(((l=this.renderer)==null?void 0:l.renderer)==null)return Promise.resolve();if(s){let u=this.commitRenderState();return this.paint(),u}else return this.frameId?Promise.resolve():new Promise((u,c)=>{this.frameId=requestAnimationFrame(()=>{var h,d;return((h=this.renderer)==null?void 0:h.renderer)==null?u():this.mode==="standalone"?(d=this.commitRenderState())==null?void 0:d.then(()=>{this.paint(),u()}).catch(p=>{c(p)}):u()})})}),S(this,"animate2D",()=>{this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),this.animationFrameId=requestAnimationFrame(()=>{this.animationFrameId=null,this.systems.twoDVisiblitySystem.playAnimations()})}),S(this,"drawEntities2D",()=>{this.twoDFrameId&&(cancelAnimationFrame(this.twoDFrameId),this.twoDFrameId=null),this.twoDFrameId=requestAnimationFrame(()=>{this.twoDFrameId=null,this.systems.twoDDrawSystem.update(this.systems.cameraSystem.getZoomLevel()),this.systems.domDrawSystem.update(this.systems.cameraSystem.isUserInteracting())})}),S(this,"updateEntities2D",()=>{this.updateEntitiesFrameId&&(cancelAnimationFrame(this.updateEntitiesFrameId),this.updateEntitiesFrameId=null),this.updateEntitiesFrameId=requestAnimationFrame(()=>{this.updateEntitiesFrameId=null,this.systems.watermarkSystem.insertIntoQuadTree(this.systems.collisionSystem.interactiveCollidersQTree),this.systems.interactionSystem.updateQuadtree(this.systems.collisionSystem.interactiveCollidersQTree),this.systems.twoDVisiblitySystem.update(),this.drawEntities2D()})}),S(this,"commitRenderState",()=>{try{let s=[];this.frameId=null,this.publish("pre-render"),this.state.internalTweenGroup.update(),this.state.externalTweenGroup.update(),(this.mode==="outdoors-interleaved"||this.mode==="standalone")&&this.systems.cameraSystem.update(),this.state.shouldMeasureCanvas&&(this.state.shouldMeasureCanvas=!1,this.publish("measure-canvas")),this.twoDdirty&&(this.state.geometry2DIdsInScene.clear(),Dq(this.state.geometryScene,this.state.geometry2DIdsInScene),this.systems.domVisiblitySystem.dirty=!0,this.systems.collisionSystem.collidersDirty=!0,this.systems.domMutationSystem.dirty=!0,this.systems.panBoundsSystem.dirty=!0,this.twoDdirty=!1),this.threeDdirty&&(this.state.geometry3DIdsInScene.clear(),this.state.geometryGroupIdsToLoad.clear(),Pq(this.state.geometryScene,this.state.geometry3DIdsInScene,this.state.geometryGroupIdsToLoad),this.systems.interactionSystem.dirty3D=!0,this.systems.panBoundsSystem.dirty=!0,this.systems.outlineInterpolationSystem.geometries3DDirty=!0,this.systems.geometryInFocusSystem.focusablesDirty=!0,this.threeDdirty=!1);let l=this.systems.meshOptimizationSystem.update();l&&s.push(l),this.systems.borderSystem.update(),this.systems.meshModificationSystem.update(),this.systems.meshDetachmentSystem.update(),this.systems.renderOrderSystem.update(),this.systems.clippingPlaneSystem.update(),this.systems.imageSystem.update(this.systems.cameraSystem.getRotation()),s.push(this.systems.text3DSystem.update(this.systems.cameraSystem.getRotation())),this.systems.customGeometrySystem.update(),this.systems.panBoundsSystem.update(),this.systems.geometryInFocusSystem.update(this.systems.cameraSystem.isCameraMoving(),this.systems.cameraSystem.lastCameraStoppedMovingTime()),this.systems.outlineInterpolationSystem.update(this.systems.cameraSystem.getZoomLevel(),this.systems.cameraSystem.zoomDirty),this.systems.pathSystem.update(this.systems.cameraSystem.minZoomAltitude,this.systems.cameraSystem.maxZoomAltitude,this.systems.cameraSystem.getZoomAltitude()),this.systems.cameraSystem.postRender(),this.systems.domVisiblitySystem.update(),this.systems.domMutationSystem.update(),this.systems.twoDProjectionSystem.update(),this.systems.occlusion2DSystem.update(),this.twoDFrameId&&(cancelAnimationFrame(this.twoDFrameId),this.twoDFrameId=null),this.systems.twoDDrawSystem.update(this.systems.cameraSystem.getZoomLevel()),this.systems.domDrawSystem.update(this.systems.cameraSystem.isUserInteracting()),this.systems.watermarkSystem.update();let u=this.needs2DRecompute;return this.nextFrame=requestAnimationFrame(()=>{this.nextFrame=null,this.systems.collisionSystem.update(this.systems.watermarkSystem.width,this.systems.watermarkSystem.height,this.systems.watermarkSystem.options.position,!u&&this.systems.cameraSystem.isCameraMoving(),this.systems.imageSystem.currentImageScreenBBoxes)}),this.systems.textureSystem.update(),this.systems.pluginSystem.update(this.state),this.systems.drawSystem.update(),this.systems.geometryDisposalSystem.update(),this.systems.cameraSystem.dirty=!1,this.systems.cameraSystem.zoomDirty=!1,this.systems.cameraSystem.rotationDirty=!1,this.systems.cameraSystem.stateDirty&&(this.publish("camera-state-change"),this.systems.cameraSystem.stateDirty=!1),this.publish("post-render"),this.needs2DRecompute=!1,Promise.all(s)}catch(s){return Promise.reject(s)}}),this.renderer=t,this.state=e,this.mode=r,this.scene=n,this.cameraObject=i,this.viewCamera=a,this.systems=o,this.systems.collisionSystem.on("visibility-changed",this.updateEntities2D),this.systems.twoDVisiblitySystem.on("draw:2d",this.drawEntities2D),this.systems.twoDVisiblitySystem.on("animate:2d",this.animate2D),this.systems.cameraSystem.on("pan-start",()=>this.needs2DRecompute=!1),this.systems.cameraSystem.on("zoom-start",()=>this.needs2DRecompute=!1),this.systems.cameraSystem.on("zoom-end",()=>this.needs2DRecompute=!0),this.systems.cameraSystem.on("rotate-start",()=>this.needs2DRecompute=!1),this.systems.cameraSystem.on("rotate-end",()=>this.needs2DRecompute=!0)}paint(){var t;(t=this.renderer)!=null&&t.renderer&&(this.mode==="standalone"&&this.renderer.clear(),this.renderer.render(this.scene,this.state.useStandaloneCamera||this.mode==="standalone"?this.cameraObject:this.viewCamera))}destroy(){this.frameId&&cancelAnimationFrame(this.frameId),this.twoDFrameId&&cancelAnimationFrame(this.twoDFrameId),this.animationFrameId&&cancelAnimationFrame(this.animationFrameId),this.nextFrame&&cancelAnimationFrame(this.nextFrame),this.state.geometry2DIdsInScene.clear(),this.state.geometry3DIdsInScene.clear(),this.systems.domVisiblitySystem.dirty=!0,this.systems.collisionSystem.collidersDirty=!0,this.update(),this.systems.collisionSystem.off("visibility-changed",this.updateEntities2D),this.systems.twoDVisiblitySystem.off("draw:2d",this.drawEntities2D),this.systems.twoDVisiblitySystem.off("animate:2d",this.animate2D)}};C();var MZe=Nr({interactive:Lr().optional(),id:mr().optional(),width:zi([pt(),Nr({on:$i("zoom-level").optional(),input:bo(pt()).nonempty(),output:bo(pt()).nonempty(),easing:mr().optional()})]).optional(),accentColor:mr().optional(),displayArrowsOnPath:Lr().optional(),animateArrowsOnPath:Lr().optional(),visibleThroughGeometry:Lr().optional(),dashed:Lr().optional()}),TZe=Nr({type:Pa(["Feature"]),geometry:lB,properties:Nr({parentId:FV().optional()})});function PZe(t,e){Nr({features:bo(TZe)}).parse(t),MZe.parse(e)}var uw,cw=class{constructor(t,e){S(this,"type","path"),S(this,"mesh",new _0),S(this,"material"),S(this,"geometry"),S(this,"outline"),S(this,"feature"),S(this,"options"),S(this,"width",{on:"zoom-level",input:[17,22],output:[.8,.4]}),S(this,"breakpoint",0),S(this,"altitudeBreakpoints"),S(this,"accentColor","blue"),S(this,"completeFraction",1),S(this,"altitudeAdjustment",1),S(this,"displayArrowsOnPath",!1),S(this,"animateArrowsOnPath",!1),S(this,"visibleThroughGeometry",!1),S(this,"highlightStartFraction",0),S(this,"highlightEndFraction",0),S(this,"highlightCompleteFraction",1),S(this,"highlightWidthMultiplier",1.1),S(this,"highlightColor","red"),S(this,"dashed",!1),S(this,"isVertical",!1),S(this,"dirty",!0),S(this,"materialDirty",!0),S(this,"position",new Q),K(this,uw,0);var r,n,i,a,o,s;this.feature=t,this.options=e||{},this.width=(r=e?.width)!=null?r:this.width,this.accentColor=(n=e?.accentColor)!=null?n:this.accentColor,this.displayArrowsOnPath=(i=e?.displayArrowsOnPath)!=null?i:this.displayArrowsOnPath,this.animateArrowsOnPath=(a=e?.animateArrowsOnPath)!=null?a:this.animateArrowsOnPath,this.visibleThroughGeometry=(o=e?.visibleThroughGeometry)!=null?o:this.visibleThroughGeometry,this.dashed=(s=e?.dashed)!=null?s:this.dashed}setColor(){}setOpacity(){}set visible(t){this.mesh&&(this.mesh.visible=t)}get visible(){return this.mesh?this.mesh.visible:!1}get altitude(){return f(this,uw)}set altitude(t){this.mesh&&(this.mesh.position.z=t,ne(this,uw,t))}set complete(t){this.material&&(this.material.uniforms.complete.value=t,this.material.needsUpdate=!0)}};uw=new WeakMap;C();C();C();var wu=Object.freeze({Linear:Object.freeze({None:function(t){return t},In:function(t){return t},Out:function(t){return t},InOut:function(t){return t}}),Quadratic:Object.freeze({In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}}),Cubic:Object.freeze({In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}}),Quartic:Object.freeze({In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}}),Quintic:Object.freeze({In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}}),Sinusoidal:Object.freeze({In:function(t){return 1-Math.sin((1-t)*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return .5*(1-Math.sin(Math.PI*(.5-t)))}}),Exponential:Object.freeze({In:function(t){return t===0?0:Math.pow(1024,t-1)},Out:function(t){return t===1?1:1-Math.pow(2,-10*t)},InOut:function(t){return t===0?0:t===1?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2)}}),Circular:Object.freeze({In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}}),Elastic:Object.freeze({In:function(t){return t===0?0:t===1?1:-Math.pow(2,10*(t-1))*Math.sin((t-1.1)*5*Math.PI)},Out:function(t){return t===0?0:t===1?1:Math.pow(2,-10*t)*Math.sin((t-.1)*5*Math.PI)+1},InOut:function(t){return t===0?0:t===1?1:(t*=2,t<1?-.5*Math.pow(2,10*(t-1))*Math.sin((t-1.1)*5*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin((t-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(t){var e=1.70158;return t===1?1:t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return t===0?0:--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?.5*(t*t*((e+1)*t-e)):.5*((t-=2)*t*((e+1)*t+e)+2)}}),Bounce:Object.freeze({In:function(t){return 1-wu.Bounce.Out(1-t)},Out:function(t){return t<.36363636363636365?7.5625*t*t:t<.7272727272727273?7.5625*(t-=.5454545454545454)*t+.75:t<.9090909090909091?7.5625*(t-=.8181818181818182)*t+.9375:7.5625*(t-=.9545454545454546)*t+.984375},InOut:function(t){return t<.5?wu.Bounce.In(t*2)*.5:wu.Bounce.Out(t*2-1)*.5+.5}}),generatePow:function(t){return t===void 0&&(t=4),t=t<Number.EPSILON?Number.EPSILON:t,t=t>1e4?1e4:t,{In:function(e){return Math.pow(e,t)},Out:function(e){return 1-Math.pow(1-e,t)},InOut:function(e){return e<.5?Math.pow(e*2,t)/2:(1-Math.pow(2-e*2,t))/2+.5}}}}),cv=function(){return performance.now()},i6=(function(){function t(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._tweens={},this._tweensAddedDuringUpdate={},this.add.apply(this,e)}return t.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(r){return e._tweens[r]})},t.prototype.removeAll=function(){this._tweens={}},t.prototype.add=function(){for(var e,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];for(var i=0,a=r;i<a.length;i++){var o=a[i];(e=o._group)===null||e===void 0||e.remove(o),o._group=this,this._tweens[o.getId()]=o,this._tweensAddedDuringUpdate[o.getId()]=o}},t.prototype.remove=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var n=0,i=e;n<i.length;n++){var a=i[n];a._group=void 0,delete this._tweens[a.getId()],delete this._tweensAddedDuringUpdate[a.getId()]}},t.prototype.allStopped=function(){return this.getAll().every(function(e){return!e.isPlaying()})},t.prototype.update=function(e,r){e===void 0&&(e=cv()),r===void 0&&(r=!0);var n=Object.keys(this._tweens);if(n.length!==0)for(;n.length>0;){this._tweensAddedDuringUpdate={};for(var i=0;i<n.length;i++){var a=this._tweens[n[i]],o=!r;a&&a.update(e,o)===!1&&!r&&this.remove(a)}n=Object.keys(this._tweensAddedDuringUpdate)}},t})(),a6={Linear:function(t,e){var r=t.length-1,n=r*e,i=Math.floor(n),a=a6.Utils.Linear;return e<0?a(t[0],t[1],n):e>1?a(t[r],t[r-1],r-n):a(t[i],t[i+1>r?r:i+1],n-i)},Utils:{Linear:function(t,e,r){return(e-t)*r+t}}},Wte=(function(){function t(){}return t.nextId=function(){return t._nextId++},t._nextId=0,t})(),o6=new i6,l0=(function(){function t(e,r){this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=wu.Linear.None,this._interpolationFunction=a6.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=Wte.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1,this._object=e,typeof r=="object"?(this._group=r,r.add(this)):r===!0&&(this._group=o6,o6.add(this))}return t.prototype.getId=function(){return this._id},t.prototype.isPlaying=function(){return this._isPlaying},t.prototype.isPaused=function(){return this._isPaused},t.prototype.getDuration=function(){return this._duration},t.prototype.to=function(e,r){if(r===void 0&&(r=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=r<0?0:r,this},t.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},t.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},t.prototype.start=function(e,r){if(e===void 0&&(e=cv()),r===void 0&&(r=!1),this._isPlaying)return this;if(this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var n in this._valuesStartRepeat)this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||r){if(this._propertiesAreSetUp=!0,!this._isDynamic){var i={};for(var a in this._valuesEnd)i[a]=this._valuesEnd[a];this._valuesEnd=i}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,r)}return this},t.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},t.prototype._setupProperties=function(e,r,n,i,a){for(var o in n){var s=e[o],l=Array.isArray(s),u=l?"array":typeof s,c=!l&&Array.isArray(n[o]);if(!(u==="undefined"||u==="function")){if(c){var h=n[o];if(h.length===0)continue;for(var d=[s],p=0,m=h.length;p<m;p+=1){var y=this._handleRelativeValue(s,h[p]);if(isNaN(y)){c=!1,console.warn("Found invalid interpolation list. Skipping.");break}d.push(y)}c&&(n[o]=d)}if((u==="object"||l)&&s&&!c){r[o]=l?[]:{};var v=s;for(var _ in v)r[o][_]=v[_];i[o]=l?[]:{};var h=n[o];if(!this._isDynamic){var w={};for(var _ in h)w[_]=h[_];n[o]=h=w}this._setupProperties(v,r[o],h,i[o],a)}else(typeof r[o]>"u"||a)&&(r[o]=s),l||(r[o]*=1),c?i[o]=n[o].slice().reverse():i[o]=r[o]||0}}},t.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},t.prototype.end=function(){return this._goToEnd=!0,this.update(this._startTime+this._duration),this},t.prototype.pause=function(e){return e===void 0&&(e=cv()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this)},t.prototype.resume=function(e){return e===void 0&&(e=cv()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this)},t.prototype.stopChainedTweens=function(){for(var e=0,r=this._chainedTweens.length;e<r;e++)this._chainedTweens[e].stop();return this},t.prototype.group=function(e){return e?(e.add(this),this):(console.warn("tween.group() without args has been removed, use group.add(tween) instead."),this)},t.prototype.remove=function(){var e;return(e=this._group)===null||e===void 0||e.remove(this),this},t.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},t.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},t.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},t.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},t.prototype.easing=function(e){return e===void 0&&(e=wu.Linear.None),this._easingFunction=e,this},t.prototype.interpolation=function(e){return e===void 0&&(e=a6.Linear),this._interpolationFunction=e,this},t.prototype.chain=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return this._chainedTweens=e,this},t.prototype.onStart=function(e){return this._onStartCallback=e,this},t.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},t.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},t.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},t.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},t.prototype.onStop=function(e){return this._onStopCallback=e,this},t.prototype.update=function(e,r){var n=this,i;if(e===void 0&&(e=cv()),r===void 0&&(r=t.autoStartOnUpdate),this._isPaused)return!0;var a;if(!this._goToEnd&&!this._isPlaying)if(r)this.start(e,!0);else return!1;if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var o=e-this._startTime,s=this._duration+((i=this._repeatDelayTime)!==null&&i!==void 0?i:this._delayTime),l=this._duration+this._repeat*s,u=function(){if(n._duration===0||o>l)return 1;var y=Math.trunc(o/s),v=o-y*s,_=Math.min(v/n._duration,1);return _===0&&o===n._duration?1:_},c=u(),h=this._easingFunction(c);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,h),this._onUpdateCallback&&this._onUpdateCallback(this._object,c),this._duration===0||o>=this._duration)if(this._repeat>0){var d=Math.min(Math.trunc((o-this._duration)/s)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=d);for(a in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[a]=="string"&&(this._valuesStartRepeat[a]=this._valuesStartRepeat[a]+parseFloat(this._valuesEnd[a])),this._yoyo&&this._swapEndStartRepeatValues(a),this._valuesStart[a]=this._valuesStartRepeat[a];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=s*d,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var p=0,m=this._chainedTweens.length;p<m;p++)this._chainedTweens[p].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},t.prototype._updateProperties=function(e,r,n,i){for(var a in n)if(r[a]!==void 0){var o=r[a]||0,s=n[a],l=Array.isArray(e[a]),u=Array.isArray(s),c=!l&&u;c?e[a]=this._interpolationFunction(s,i):typeof s=="object"&&s?this._updateProperties(e[a],o,s,i):(s=this._handleRelativeValue(o,s),typeof s=="number"&&(e[a]=o+(s-o)*i))}},t.prototype._handleRelativeValue=function(e,r){return typeof r!="string"?r:r.charAt(0)==="+"||r.charAt(0)==="-"?e+parseFloat(r):parseFloat(r)},t.prototype._swapEndStartRepeatValues=function(e){var r=this._valuesStartRepeat[e],n=this._valuesEnd[e];typeof n=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(n):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=r},t.autoStartOnUpdate=!1,t})();Wte.nextId;var Bu=o6;Bu.getAll.bind(Bu);Bu.removeAll.bind(Bu);Bu.add.bind(Bu);Bu.remove.bind(Bu);Bu.update.bind(Bu);C();C();C();var DZe=(t,e)=>(e-t+Math.PI)%(Math.PI*2)+Math.PI*2%(Math.PI*2)-Math.PI,kZe=(t,e)=>new Je(t.clientX-e.offsetLeft,t.clientY-e.offsetTop),dL=(t,e)=>Math.atan2(e.y-t.y,e.x-t.x),xb=(t,e)=>Math.sqrt((e.y-t.y)**2+(e.x-t.x)**2),pL=(t,e)=>new Je((t.x+e.x)/2,(t.y+e.y)/2),fL=t=>{let e=0,{wheelDelta:r,detail:n}=t;return r!==void 0?e=r:n!==void 0&&(e=-n),e},OZe=class{constructor(t,e){S(this,"input1"),S(this,"input2"),S(this,"lastAngle"),S(this,"lastDistance"),S(this,"totalDistance"),S(this,"first"),S(this,"second"),this.input1=t,this.input2=e,this.lastAngle=dL(t,e),this.lastDistance=xb(t,e),this.totalDistance=0,this.first=t,this.second=e}update(t,e){let r=xb(t,e);this.input1=t,this.input2=e;let n=dL(t,e);this.lastAngle=n,this.lastDistance=r,this.totalDistance+=(xb(this.first,t)+xb(this.second,e))/2,this.first=pL(this.first,t),this.second=pL(this.second,e)}};C();var mL=class{constructor(t,e,r){S(this,"touch"),S(this,"camera"),S(this,"cameraPlane"),S(this,"viewCoordinate"),S(this,"snapHolderMatrix"),S(this,"snapCamera"),S(this,"cameraPosition"),S(this,"raycaster"),S(this,"worldCoordinate"),S(this,"snapshotted",!1),this.touch=t,this.camera=e,this.cameraPlane=r,this.viewCoordinate={x:t.x,y:t.y},this.camera.updateMatrixWorld(),this.camera.updateMatrix(),this.snapHolderMatrix=this.camera.matrixWorld.clone(),this.snapCamera=this.camera.clone(),this.snapshotCameraState()}snapshotCameraState(){this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.cameraPosition=this.camera.position.clone();let t=new Je(this.viewCoordinate.x,this.viewCoordinate.y);this.raycaster=this.raycaster||new G1,this.raycaster.setFromCamera(t,this.snapCamera);let e=this.raycaster.intersectObject(this.cameraPlane,!0);this.worldCoordinate=e&&e.length>0?e[0].point:null,this.snapshotted=!0}updateAnchorState(t,e){this.camera=t,this.snapCamera=t.clone(),this.snapHolderMatrix=t.matrixWorld.clone(),this.updateViewCoordinate(e),this.snapshotCameraState()}updateViewCoordinate(t){this.viewCoordinate={x:t.x,y:t.y}}reUnproject(){var t,e;let r=new Je(this.viewCoordinate.x,this.viewCoordinate.y);(t=this.raycaster)==null||t.setFromCamera(r,this.snapCamera);let n=(e=this.raycaster)==null?void 0:e.intersectObject(this.cameraPlane,!0)[0];return n?n.point:void 0}},up={};So(up,{BLOCK_MERCATOR_ZOOM_LEVEL:()=>FZe,CLIPPING_RADIUS:()=>hw,CONTROL_OPTIONS:()=>zZe,DEFAULT_ANIMATION_DURATION:()=>Jte,DEFAULT_BEARING:()=>UZe,DEFAULT_MAX_ZOOM_LEVEL:()=>NZe,DEFAULT_MIN_ZOOM_LEVEL:()=>Kte,DEFAULT_PITCH:()=>$Ze,DEFAULT_ZOOM_LEVEL:()=>LZe,EVENTS:()=>u6,MAPLIBRE_TILE_SIZE:()=>BZe,MAX_LAT:()=>Xte,MAX_MERCATOR_ZOOM_LEVEL:()=>l6,MIN_LAT:()=>Hte,MIN_MERCATOR_ZOOM_LEVEL:()=>s6,ROOM_MERCATOR_ZOOM_LEVEL:()=>RZe,TWO_PI:()=>qte,WHEEL_ZOOM_MULTIPLIER:()=>Yte,ZRANGE:()=>hv});C();var BZe=512,Hte=-85.051129,Xte=85.051129,hw=1e4,zZe={chain:"chain",cancel:"cancel"},qte=Math.PI*2,hv=100,Yte=1e4,s6=0,l6=24,FZe=17,RZe=20,Jte=200,u6=["change","pan-start","pan-end","rotate-start","rotate-end","zoom-start","zoom-end","multi-start","multi-end","multi-cancel","pedestal-start","pedestal-change","pedestal-end","user-pan-start","user-pedestal-start","user-rotate-start","user-dolly-start","user-zoom-start","user-tilt-start","user-pan-end","user-pedestal-end","user-rotate-end","user-dolly-end","user-zoom-end","user-tilt-end","position-updated","zoom-updated","tilt-updated","rotation-updated"],LZe=18,Kte=12,NZe=22,$Ze=0,UZe=0,gL=!1,c6,uB=class extends wi{constructor(t,e,r,n,i){super(),S(this,"dirty",!1),S(this,"zoomDirty",!1),S(this,"rotationDirty",!1),S(this,"panDirty",!1),S(this,"stateDirty",!1),K(this,c6,Kte),S(this,"zoomSpeed",5),S(this,"rotateSpeed",100),S(this,"enabled",!0),S(this,"enableZoom",!0),S(this,"enablePan",!0),S(this,"enablePedestal",!1),S(this,"maxPedestal",1/0),S(this,"minPedestal",0),S(this,"enableRotate",!0),S(this,"minZoomAltitude",0),S(this,"maxZoomAltitude",1/0),S(this,"ignoreZoomLimits",!1),S(this,"zoomFactor",1),S(this,"panBounds",{min:new Q(1/0,1/0),max:new Q(-1/0,-1/0),center:new Q(0,0,0),radius:1/0}),S(this,"minTilt",0),S(this,"maxTilt",1.2),S(this,"MOUSE_BUTTONS",{ORBIT:ES.RIGHT,ZOOM:ES.MIDDLE,PAN:ES.LEFT}),S(this,"camera"),S(this,"scene"),S(this,"renderer"),S(this,"elevation"),S(this,"orbit"),S(this,"cameraPlane"),S(this,"raycaster",new G1),S(this,"rendererState"),S(this,"options"),S(this,"state",-1),S(this,"intersection"),S(this,"viewState",null),S(this,"tweens",new Map),S(this,"clock",new doe(!0)),S(this,"coords",{mouse:new Je,rotateStart:new Je,rotateEnd:new Je,rotateDelta:new Je,panStart:new Q,panCameraStart:new Q,panEnd:new Q,panDelta:new Q,initialShiftPos:new Je,initialPedestal:0,floorAnchor:new Q}),S(this,"touch",{origin:{offsetLeft:0,offsetTop:0},touches:[],anchor1:null,anchor2:null,inputs:null}),S(this,"scrollTimer",null),S(this,"lastWheelTime",0),S(this,"resetZoom",!1),S(this,"zoomStart"),S(this,"pedestalScaleFactor",1),S(this,"isUserZooming",!1),S(this,"stayInsideBounds",!0),S(this,"userInteracting",!1),S(this,"cameraMoving",!1),S(this,"lastCameraMoveTime",Date.now()),S(this,"raycastToFloor",a=>{this.raycaster.setFromCamera(a,this.camera);let o=this.raycaster.intersectObject(this.cameraPlane,!1)[0];return o?o.point:new Q}),S(this,"isUserInteracting",()=>this.userInteracting),S(this,"getPosition",()=>new Q(this.orbit.position.x,this.orbit.position.y,this.orbit.position.z)),S(this,"getPedestal",()=>this.orbit.position.z),S(this,"pan",(a,o)=>{isNaN(a)||isNaN(o)||(this.setPosition(this.orbit.position.x+a,this.orbit.position.y+o),this.publish("position-updated"))}),S(this,"postRender",()=>{(this.state===2||this.state===6)&&(this.raycaster.setFromCamera(this.coords.mouse,this.camera),this.intersection=this.raycaster.intersectObject(this.cameraPlane,!1)[0],this.intersection&&(this.coords.panStart.set(this.intersection.point.x,this.intersection.point.y,0),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0))),this.state===3&&this.resetZoom&&(this.resetZoom=!1,this.zoomStart=this.getZoomAltitude(),this.coords.floorAnchor=this.raycastToFloor(this.coords.mouse),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0)),this.state===7&&this.isAnimating===!1&&(this.state=-1,this.publish("multi-end"))}),S(this,"isCameraMoving",()=>this.cameraMoving),S(this,"lastCameraStoppedMovingTime",()=>this.lastCameraMoveTime),S(this,"setPosition",(a,o)=>{a===void 0||o===void 0||isNaN(a)||isNaN(o)||(this.state===-1&&this.publish("pan-start"),this.updateCameraPosition(a,o),this.publish("position-updated"),this.publish("change"),this.state===-1&&this.publish("pan-end"),this.dirty=!0,this.stateDirty=!0)}),S(this,"updateCameraPosition",(a,o)=>{let s=a-this.panBounds.center.x,l=o-this.panBounds.center.y,u=Math.sqrt(s*s+l*l);if(this.stayInsideBounds&&u>this.panBounds.radius){let c=Math.atan2(l,s),h={x:Math.cos(c)*this.panBounds.radius+this.panBounds.center.x,y:Math.sin(c)*this.panBounds.radius+this.panBounds.center.y};this.orbit.position.x=h.x,this.orbit.position.y=h.y}else this.orbit.position.x=a,this.orbit.position.y=o}),S(this,"tilt",a=>{if(isNaN(a))return;this.state===-1&&this.publish("rotate-start");let o=this.stayInsideBounds?Math.max(Math.min(a+this.getTilt(),this.maxTilt),this.minTilt):a+this.getTilt();o!==this.elevation.rotation.x&&(this.elevation.rotation.x=o,this.publish("tilt-updated")),this.publish("change"),this.state===-1&&this.publish("rotate-end"),this.stateDirty=!0}),S(this,"zoomIn",(a,o,s)=>{let l=this.getZoomAltitude();this.animateCamera({zoom:l/1.5},a,o,s)}),S(this,"zoomOut",(a,o,s)=>{let l=this.getZoomAltitude();this.animateCamera({zoom:l*1.5},a,o,s)}),S(this,"getRotation",()=>(-this.orbit.rotation.z+Math.PI*2)%(Math.PI*2)),S(this,"cancelAnimation",()=>{let a=Array.from(this.tweens.keys());if(a.length<1)return;let o=a[a.length-1];o.state===7&&this.publish("multi-cancel",{zooming:!0,rotating:!0,tilting:!0}),this.completeTween(o)}),S(this,"animateCamera",(a,o,s,l,u,c)=>{let h=ae({interruptible:!0},c),d={},p={},m=this.getPosition();if(a.position!=null&&(a.position.x!==void 0&&(d.x=m.x,p.x=a.position.x),a.position.y!==void 0&&(d.y=m.y,p.y=a.position.y),a.position.z!==void 0&&(d.z=m.z,p.z=a.position.z)),a.zoom!==void 0&&(d.zoom=this.stayInsideBounds?Math.min(Math.max(this.getZoomAltitude(),this.getZoomScaledMin()),this.getZoomScaledMax()):this.getZoomAltitude(),this.viewState==="multi_floor"||!this.stayInsideBounds?p.zoom=a.zoom:p.zoom=Math.min(Math.max(a.zoom,this.getZoomScaledMin()),this.getZoomScaledMax())),a.rotation!==void 0){let{start:M,end:P}=$me(this.getRotation(),a.rotation);d.rotation=M,p.rotation=P}a.tilt!==void 0&&(d.tilt=this.getTilt(),this.viewState==="multi_floor"||!this.stayInsideBounds?p.tilt=a.tilt:p.tilt=Math.max(Math.min(a.tilt,this.maxTilt),this.minTilt));let y=d.zoom!==p.zoom,v=d.rotation!==p.rotation,_=d.tilt!==p.tilt,w=new l0(d).to(p,Oi.env.TESTING?0:o).onUpdate(M=>{this.setMulti({x:M.x,y:M.y,z:M.z},M.zoom,M.rotation,M.tilt)}).onComplete(()=>{this.completeTween(w),this.publish("multi-end",{zooming:y,rotating:v,tilting:_}),l&&l()}).onStart(()=>{this.state!==7&&(this.state=7,w.state=7,this.publish("multi-start",{zooming:y,rotating:v,tilting:_})),this.publish("change")});this.rendererState.internalTweenGroup.add(w);let b=Array.from(this.tweens.entries()),A=b[b.length-1],E=!1;return A!=null&&(A[1].interruptible?(typeof A[1].cancelledCallback=="function"&&A[1].cancelledCallback(),this.completeTween(A[0])):(E=!0,A[0].chain(w))),this.tweens.set(w,{cancelledCallback:u,interruptible:h.interruptible}),s?w.easing(s):w.easing(wu.Quadratic.In),!a.doNotAutoStart&&!E&&(w.start(),this.publish("change")),w.cameraAnimation=!0,w}),S(this,"setMulti",(a,o,s,l,u=!0)=>{this.state===-1&&this.publish("multi-start");let c=!1;a!=null&&(a.x!==void 0&&!isNaN(a.x)&&a.y!==void 0&&!isNaN(a.y)&&(this.updateCameraPosition(a.x,a.y),c=!0),a.z!==void 0&&!isNaN(a.z)&&(this.setPedestal(a.z,!0,!1),c=!0)),c&&this.publish("position-updated");let h={zooming:!1,tilting:!!o,rotating:!1};if(o!==void 0&&!isNaN(o)){let d=this.stayInsideBounds?Math.min(Math.max(o,this.getZoomScaledMin()),this.getZoomScaledMax()):o;d!==this.camera.position.z&&(h.zooming=!0,this.camera.position.z=d,this.publish("zoom-updated"),this.zoomDirty=!0,this.viewState==="multi_floor"?o>hw&&(this.camera.near=o-hw,this.camera.far=o+hw):(this.camera.near=o/hv,this.camera.far=o*hv),this.camera.updateProjectionMatrix())}if(s!==void 0&&!isNaN(s)&&s!==this.getRotation()&&(h.rotating=!0,this.orbit.rotation.z=-s,this.publish("rotation-updated")),l!==void 0&&!isNaN(l)){let d=this.stayInsideBounds?Math.max(Math.min(l,this.maxTilt),this.minTilt):l;d!==this.elevation.rotation.x&&(h.tilting=!0,this.elevation.rotation.x=d,this.publish("tilt-updated"))}u&&this.publish("change"),this.state===-1&&this.publish("multi-end",h),this.stateDirty=!0}),S(this,"getZoomScaledMin",()=>this.minZoomAltitude*this.zoomFactor),S(this,"getZoomScaledMax",()=>{let a=this.minZoomAltitude*this.zoomFactor;return Math.max(this.maxZoomAltitude,a)}),S(this,"setRotation",(a,o)=>{if(isNaN(a))return;this.state===-1&&!o&&this.publish("rotate-start");let s=-(a%qte);s!==this.orbit.rotation.z&&(this.orbit.rotation.z=s,o||this.publish("rotation-updated")),o||this.publish("change"),this.state===-1&&!o&&this.publish("rotate-end"),this.dirty=!0,this.rotationDirty=!0,o||(this.stateDirty=!0)}),S(this,"setZoomAltitude",a=>{if(isNaN(a))return;this.state===-1&&this.publish("zoom-start");let o=this.stayInsideBounds?Math.min(Math.max(a,this.getZoomScaledMin()),this.getZoomScaledMax()):a;o!==this.camera.position.z&&(this.camera.position.z=o,this.publish("zoom-updated"),this.zoomDirty=!0),this.camera.near=o/hv,this.camera.far=o*hv,this.camera.updateProjectionMatrix(),this.publish("change"),this.state===-1&&this.publish("zoom-end"),this.dirty=!0,this.stateDirty=!0}),S(this,"setZoomLevel",a=>{this.setZoomAltitude(this.convertZoomLevelToAltitude(a))}),S(this,"getZoomAltitude",()=>this.camera.position.z),S(this,"getZoomLevel",()=>this.convertAltitudeToZoomLevel(this.getZoomAltitude())),S(this,"setTilt",(a,o)=>{if(isNaN(a))return;this.state===-1&&!o&&this.publish("rotate-start");let s=this.stayInsideBounds?Math.max(Math.min(a,this.maxTilt),this.minTilt):a;s!==this.elevation.rotation.x&&(this.elevation.rotation.x=s,o||this.publish("tilt-updated")),o||this.publish("change"),this.state===-1&&!o&&this.publish("rotate-end"),this.dirty=!0,o||(this.stateDirty=!0)}),S(this,"getTilt",()=>this.elevation.rotation.x),S(this,"setCameraPlaneElevation",a=>{this.cameraPlane.position.z=a}),S(this,"zoom",a=>{if(isNaN(a))return;this.state===-1&&this.publish("zoom-start");let o=this.getZoomAltitude()-a;this.camera.position.z=this.stayInsideBounds?Math.min(Math.max(o,this.minZoomAltitude*this.zoomFactor),this.maxZoomAltitude*this.zoomFactor):o,this.publish("zoom-updated"),this.zoomDirty=!0,this.publish("change"),this.state===-1&&this.publish("zoom-end"),this.stateDirty=!0}),S(this,"getProjectionScaleFactor",(a,o,s)=>Z8(a,o,s)),S(this,"update",()=>{this.orbit.updateMatrixWorld(),this.lastWheelTime>0&&this.state===3&&this.clock.getElapsedTime()-this.lastWheelTime>.2&&(this.lastWheelTime=0,this.state=-1,this.publish("zoom-end"),this.removeMouseMoveEventListeners())}),S(this,"setPedestal",(a,o=!1,s=!0)=>{typeof a=="number"&&!isNaN(a)&&(this.orbit.position.z=a,o&&(this.publishPedestalChangeEvent(a),this.publish("pedestal-change",{pedestal:a})),this.publish("change"),this.dirty=!0,s&&(this.stateDirty=!0))}),S(this,"dispose",()=>{for(let a of u6)a.endsWith("start")?(this.off(a,this.setCameraMoving),a.startsWith("user")&&this.off(a,this.setUserInteracting)):(a.endsWith("end")||a.endsWith("cancel"))&&(this.off(a,this.unsetCameraMoving),a.startsWith("user")&&this.off(a,this.unsetUserInteracting));this.removeEventListeners(),this.scene.remove(this.cameraPlane),this.destroy()}),S(this,"createCameraPlane",()=>{let a=1e10,o=1,s=new yd(a,a,o,o),l=new Go({color:0,wireframe:gL,visible:gL}),u=new Er(s,l);return this.scene.add(u),u}),S(this,"addEventListeners",()=>{let{domElement:a}=this.renderer;for(let o of u6)o.endsWith("start")?(this.on(o,this.setCameraMoving),o.startsWith("user")&&this.on(o,this.setUserInteracting)):(o.endsWith("end")||o.endsWith("cancel"))&&(this.on(o,this.unsetCameraMoving),o.startsWith("user")&&this.on(o,this.unsetUserInteracting));a.addEventListener("contextmenu",this.onContextMenu,!1),a.addEventListener("mousedown",this.onMouseDown,!1),a.addEventListener("wheel",this.onMouseWheel,{passive:!1}),a.addEventListener("touchstart",this.onTouchStart,!1),a.addEventListener("touchend",this.onTouchEnd,!1),a.addEventListener("touchmove",this.onTouchMove,!1)}),S(this,"addMouseEventListeners",()=>{this.addMouseMoveEventListeners(),window.addEventListener("mouseup",this.onMouseUp,!1),window.addEventListener("mouseout",this.onMouseUp,!1)}),S(this,"addMouseMoveEventListeners",()=>{this.renderer.domElement.addEventListener("mousemove",this.onMouseMove,!1)}),S(this,"removeMouseMoveEventListeners",()=>{this.renderer.domElement.removeEventListener("mousemove",this.onMouseMove,!1)}),S(this,"removeEventListeners",()=>{let{domElement:a}=this.renderer;a.removeEventListener("contextmenu",this.onContextMenu,!1),a.removeEventListener("mousedown",this.onMouseDown,!1),a.removeEventListener("wheel",this.onMouseWheel,!1),a.removeEventListener("touchstart",this.onTouchStart,!1),a.removeEventListener("touchend",this.onTouchEnd,!1),a.removeEventListener("touchmove",this.onTouchMove,!1),a.removeEventListener("mousemove",this.onMouseMove,!1),window.removeEventListener("mouseup",this.onMouseUp,!1),window.removeEventListener("mouseout",this.onMouseUp,!1)}),S(this,"removeMouseUpEventListeners",()=>{this.renderer.domElement.removeEventListener("mousemove",this.onMouseMove,!1),window.removeEventListener("mouseup",this.onMouseUp,!1),window.removeEventListener("mouseout",this.onMouseUp,!1)}),S(this,"onContextMenu",a=>{a.preventDefault()}),S(this,"onMouseUp",()=>{if(this.enabled!==!1){switch(this.removeMouseUpEventListeners(),this.state){case 2:this.publish("pan-end"),this.publish("user-pan-end");break;case 1:this.publish("zoom-end"),this.publish("user-dolly-end");break;case 0:this.publish("rotate-end"),this.publish("user-rotate-end");break;case 8:this.publish("pedestal-end"),this.publish("user-pedestal-end");break}this.state=-1,this.panDirty=!1}}),S(this,"onMouseMove",a=>{if(this.enabled!==!1)if(a.preventDefault(),this.mouseToScene(a),this.state===0){if(this.enableRotate===!1)return;this.handleMouseMoveRotate(a)}else if(this.state===2){if(this.enablePan===!1)return;this.handleMouseMovePan()}else this.state===3?(this.resetZoom=!0,this.state=-1):this.state===8&&this.handleMouseMovePedestal(a)}),S(this,"onTouchStart",a=>{if(this.enabled!==!1){switch(this.updateTouchOrigin(),this.touchToScene(a),a.touches.length){case 1:this.enablePedestal?(this.handleTouchStartPedestal(a),this.state=9):this.enablePan&&(this.handleTouchStartPan(a),this.state=6);break;case 2:this.touch.inputs=new OZe(this.touch.touches[0],this.touch.touches[1]);break;default:this.state=-1}this.state}}),S(this,"onTouchMove",a=>{if(this.enabled!==!1)switch(this.touchToScene(a),a.touches.length){case 2:a.preventDefault(),a.stopPropagation();let o=ae({},this.touch.inputs.first),s=ae({},this.touch.inputs.second),l=new Je(this.touch.touches[0].x,this.touch.touches[0].y),u=new Je(this.touch.touches[1].x,this.touch.touches[1].y);if(this.touch.inputs.update(this.touch.touches[0],this.touch.touches[1]),this.enableRotate&&this.state===4)this.handleTouchMoveTilt(a);else if(this.state===5)this.handleTouchMoveDolly();else if(this.state!==5&&this.touch.inputs.totalDistance>.05){let c=o.y<l.y&&s.y<u.y,h=o.y>l.y&&s.y>u.y;this.enableRotate&&this.state!==4&&(h||c)?(this.handleTouchStartTilt(a),this.state=4):(this.handleTouchStartDolly(),this.state=5)}break;case 1:(this.enablePedestal||this.enablePan)&&(a.preventDefault(),a.stopPropagation()),this.enablePedestal&&this.state===9?this.handleTouchMovePedestal(a):this.enablePan&&this.state===6&&this.handleTouchMovePan(a);break;default:this.state=-1}}),S(this,"onTouchEnd",a=>{if(this.enabled!==!1){switch(this.handleTouchEnd(),this.state){case 2:case 6:this.publish("user-pan-end");break;case 4:this.publish("pan-end"),this.publish("user-tilt-end");break;case 1:case 5:this.publish("zoom-end"),this.publish("user-dolly-end");break;case 0:this.publish("rotate-end"),this.publish("user-rotate-end");break;case 8:case 9:this.publish("pedestal-end"),this.publish("user-pedestal-end");break}a.touches.length?this.onTouchStart(a):this.state=-1}}),S(this,"handleTouchMovePan",a=>{let o=Object.hasOwn(a,"x")?new Je(a.x,a.y):this.touch.touches[0],s=this.raycastToFloor(o);this.coords.panEnd.set(s.x,s.y,0),this.coords.panDelta.subVectors(this.coords.panEnd,this.coords.panStart),this.setPosition(this.coords.panCameraStart.x-this.coords.panDelta.x,this.coords.panCameraStart.y-this.coords.panDelta.y),this.publish("change"),this.panDirty=!0}),S(this,"handleTouchStartDolly",()=>{let a=this.touch.touches[0].x-this.touch.touches[1].x,o=this.touch.touches[0].y-this.touch.touches[1].y;this.zoomStart=this.getZoomAltitude();let s=new Je(this.touch.touches[0].x-a/2,this.touch.touches[0].y-o/2);this.coords.floorAnchor=this.raycastToFloor(s),this.orbit.updateMatrixWorld(),this.touch.anchor1=new mL(this.touch.touches[0],this.camera,this.cameraPlane),this.touch.anchor2=new mL(this.touch.touches[1],this.camera,this.cameraPlane),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0),this.publish("user-dolly-start"),this.publish("zoom-start"),this.publish("multi-start")}),S(this,"handleMouseMovePan",()=>{let a=this.raycastToFloor(this.coords.mouse);this.coords.panEnd.set(a.x,a.y,0),this.coords.panDelta.subVectors(this.coords.panEnd,this.coords.panStart),this.setPosition(this.coords.panCameraStart.x-this.coords.panDelta.x,this.coords.panCameraStart.y-this.coords.panDelta.y),this.publish("change"),this.panDirty=!0}),S(this,"handleTouchStartTilt",a=>{this.coords.rotateStart.set(a.touches[1].clientX,a.touches[1].clientY),this.publish("user-tilt-start"),this.publish("rotate-start")}),S(this,"handleTouchMovePedestal",a=>{this.handleMouseMovePedestal(a.touches[0])}),S(this,"handleTouchMoveTilt",a=>{this.coords.rotateEnd.set(a.touches[1].clientX,a.touches[1].clientY),this.coords.rotateDelta.subVectors(this.coords.rotateEnd,this.coords.rotateStart),this.setTilt(this.getTilt()-this.coords.rotateDelta.y/this.rotateSpeed),this.coords.rotateStart.copy(this.coords.rotateEnd)}),S(this,"handleTouchMoveDolly",()=>{let a=this.touch.inputs.first,o=this.touch.inputs.second;this.touch.anchor1.viewCoordinate={x:a.x,y:a.y},this.touch.anchor2.viewCoordinate={x:o.x,y:o.y};let s=this.makeTransformFromTouchAnchors(this.touch.anchor1,this.touch.anchor2);s&&this.setCameraFromTransformMatrix(s),this.orbit.updateMatrixWorld(),this.touch.anchor1.updateAnchorState(this.camera,a),this.touch.anchor2.updateAnchorState(this.camera,o)}),S(this,"handleTouchEnd",()=>{this.state===4||this.state===5?this.publish("multi-end"):this.state===6&&this.publish("pan-end"),this.panDirty=!1}),S(this,"handleTouchStartPan",a=>{let o=Object.hasOwn(a,"x")?new Je(a.x,a.y):this.touch.touches[0],s=this.raycastToFloor(o);this.coords.panStart.set(s.x,s.y,0),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0),this.publish("user-pan-start"),this.publish("pan-start")}),S(this,"handleTouchStartPedestal",a=>{this.handleMouseDownPedestal(a.touches[0])}),S(this,"onMouseDown",a=>{if(this.enabled!==!1){if(this.mouseToScene(a),a.preventDefault(),this.state===3&&this.publish("zoom-end"),a.button===this.MOUSE_BUTTONS.ORBIT){if(this.enableRotate===!1)return;this.handleMouseDownRotate(a),this.state=0}else a.button===this.MOUSE_BUTTONS.PAN&&(this.enablePan?(this.handleMouseDownPan(),this.state=2):this.enablePedestal&&(this.handleMouseDownPedestal(a),this.state=8));this.state!==-1&&this.addMouseEventListeners()}}),S(this,"onMouseWheel",a=>{this.enabled===!1||this.enableZoom===!1||this.state!==-1&&this.state!==3||(a.preventDefault(),a.stopPropagation(),this.mouseToScene(a),this.canScrollZoom(a)&&(this.lastWheelTime=this.clock.getElapsedTime(),this.publishUserZoomEvent()),this.state!==3&&this.canScrollZoom(a)&&(this.addMouseMoveEventListeners(),this.state=3,this.zoomStart=this.getZoomAltitude(),this.coords.floorAnchor=this.raycastToFloor(this.coords.mouse),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0),this.publish("zoom-start")),this.scrollTimer!=null&&clearTimeout(this.scrollTimer),this.scrollTimer=setTimeout(()=>{this.publish("zoom-end")},50),this.handleMouseWheel(a))}),S(this,"handleMouseWheel",a=>{if(this.publish("zoom-start"),!this.canScrollZoom(a)){this.lastWheelTime>0&&this.publish("zoom-end"),this.lastWheelTime=0,this.state=-1;return}let o=this.getZoomAltitude(),s=o-fL(a)*o/Yte*this.zoomSpeed;if(this.setZoomAltitude(s),this.enablePan){let l=s/this.zoomStart;this.coords.panDelta.subVectors(this.coords.floorAnchor,this.coords.panCameraStart).multiplyScalar(1-l),this.setPosition(this.coords.panCameraStart.x+this.coords.panDelta.x,this.coords.panCameraStart.y+this.coords.panDelta.y)}this.publish("change")}),S(this,"setCameraFromTransformMatrix",a=>{this.orbit.updateMatrixWorld();let o=new Vo;o.setFromRotationMatrix(a,"ZYX");let s=(a.elements[14]-this.cameraPlane.position.z)/Math.cos(o.x),l=o.z,u=new Q(0,0,1);u.applyEuler(o),u.setLength(s);let c=new Q;c.setFromMatrixPosition(a),c.sub(u),this.enablePan&&this.setPosition(c.x,c.y),this.enableZoom&&this.setZoomAltitude(s),this.enableRotate&&this.setRotation(-l)}),S(this,"makeTransformFromTouchAnchors",(a,o)=>{this.orbit.updateMatrixWorld(),this.camera.updateProjectionMatrix();let s=this.camera.projectionMatrix.clone(),l=a.worldCoordinate,u=o.worldCoordinate,c=a.reUnproject(),h=o.reUnproject();if(!c||!h||!l||!u)return null;let d=a.viewCoordinate,p=o.viewCoordinate,m=u.x-l.x,y=u.y-l.y,v=Math.atan2(y,m),_=h.x-c.x,w=h.y-c.y,b=Math.atan2(w,_),A=DZe(v,b),E=new gr;E.makeRotationZ(-A);let M=E.clone();M.multiply(a.snapHolderMatrix);let P=(je,tt,Ze)=>je.elements[(tt-1)*4+Ze-1],k=P(s,1,1)*P(M,1,1)-d.x*P(s,3,4)*P(M,3,1),D=P(s,1,1)*P(M,1,2)-d.x*P(s,3,4)*P(M,3,2),O=P(s,1,1)*P(M,1,3)-d.x*P(s,3,4)*P(M,3,3),B=l.x*k+l.y*D+l.z*O,L=P(s,2,2)*P(M,2,1)-d.y*P(s,3,4)*P(M,3,1),R=P(s,2,2)*P(M,2,2)-d.y*P(s,3,4)*P(M,3,2),T=P(s,2,2)*P(M,2,3)-d.y*P(s,3,4)*P(M,3,3),N=l.x*L+l.y*R+l.z*T,$=P(s,1,1)*P(M,1,1)-p.x*P(s,3,4)*P(M,3,1),V=P(s,1,1)*P(M,1,2)-p.x*P(s,3,4)*P(M,3,2),G=P(s,1,1)*P(M,1,3)-p.x*P(s,3,4)*P(M,3,3),ee=u.x*$+u.y*V+u.z*G,ie=P(s,2,2)*P(M,2,1)-p.y*P(s,3,4)*P(M,3,1),me=P(s,2,2)*P(M,2,2)-p.y*P(s,3,4)*P(M,3,2),Me=P(s,2,2)*P(M,2,3)-p.y*P(s,3,4)*P(M,3,3),Ae=u.x*ie+u.y*me+u.z*Me,le=Math.abs($-k),_e=Math.abs(V-D),Le=Math.abs(G-O),Se=Math.abs($-L),Ue=Math.abs(V-R),Y=Math.abs(G-T),we=Math.abs(ie-k),q=Math.abs(me-D),oe=Math.abs(Me-O),ce=Math.abs(ie-L),X=Math.abs(me-R),ke=Math.abs(Me-T),Ce=Math.min(le+_e+Le,Se+Ue+Y),Ee=Math.min(we+q+oe,ce+X+ke);Ce<Ee&&($=ie,V=me,G=Me,ee=Ae);let Ne=L*O-k*T,st=R*O-D*T,Ke=N*O-B*T,J=$*T-L*G,Z=V*T-R*G,fe=ee*T-N*G,Fe=(fe*st-Ke*Z)/(J*st-Ne*Z),Ve=(fe*Ne-Ke*J)/(Z*Ne-st*J),ze=R*k-D*L,Tt=T*k-O*L,ft=N*k-B*L,St=V*L-R*$,nr=G*L-T*$,He=((ee*L-N*$)*ze-ft*St)/(nr*ze-Tt*St),Ge=M.clone();return Ge.elements[12]=Fe,Ge.elements[13]=Ve,Ge.elements[14]=He,He>0?Ge:null}),S(this,"updateTouchOrigin",()=>{let a=this.renderer.domElement;this.touch.origin.offsetLeft=a.getBoundingClientRect().left,this.touch.origin.offsetTop=a.getBoundingClientRect().top}),S(this,"touchToScene",a=>{this.touch.touches=[];for(let o=0,s=a.touches.length;o<s;o++){let l=a.touches[o],u=kZe(l,this.touch.origin);this.touch.touches.push(new Je(u.x/this.renderer.domElement.width*this.rendererState.pixelRatio*2-1,-(u.y/this.renderer.domElement.height*this.rendererState.pixelRatio)*2+1))}this.coords.mouse=this.touch.touches[0]}),S(this,"canScrollZoom",a=>{let o=fL(a),s=this.getZoomAltitude();return!(o<0&&s===this.getZoomScaledMax()||o>0&&s===this.getZoomScaledMin())}),S(this,"mouseToScene",a=>{let o=this.getMousePos(a);return this.coords.mouse.x=o.x/this.renderer.domElement.width*this.rendererState.pixelRatio*2-1,this.coords.mouse.y=-(o.y/this.renderer.domElement.height*this.rendererState.pixelRatio)*2+1,this.coords.mouse}),S(this,"getMousePos",a=>({x:a.offsetX,y:a.offsetY})),S(this,"handleMouseDownRotate",a=>{this.coords.rotateStart.set(a.clientX,a.clientY),this.publish("rotate-start"),this.publish("user-rotate-start")}),S(this,"handleMouseDownPan",()=>{let a=this.raycastToFloor(this.coords.mouse);this.coords.panStart.set(a.x,a.y,0),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0),this.publish("pan-start"),this.publish("user-pan-start")}),S(this,"handleMouseDownPedestal",a=>{let o=new Je(a.clientX,a.clientY);this.coords.initialShiftPos=o,this.coords.initialPedestal=this.getPedestal(),this.pedestalScaleFactor=Z8(this.camera.fov,this.renderer.domElement.clientHeight,this.getZoomAltitude()),this.publish("pedestal-start"),this.publish("user-pedestal-start")}),S(this,"handleMouseMovePedestal",a=>{let o={x:a.clientX,y:a.clientY},s=this.coords.initialPedestal+this.pedestalScaleFactor*(o.y-this.coords.initialShiftPos.y);this.stayInsideBounds&&(s<this.minPedestal?s=Math.max(s,this.minPedestal):s>this.maxPedestal&&(s=Math.min(s,this.maxPedestal))),s!==this.getPedestal()&&this.setPedestal(s,!0)}),S(this,"handleMouseMoveRotate",a=>{this.coords.rotateEnd.set(a.clientX,a.clientY),this.coords.rotateDelta.subVectors(this.coords.rotateEnd,this.coords.rotateStart),this.setRotation(this.getRotation()+this.coords.rotateDelta.x/this.rotateSpeed),this.setTilt(this.getTilt()-this.coords.rotateDelta.y/this.rotateSpeed),this.coords.rotateStart.copy(this.coords.rotateEnd),this.publish("change")}),S(this,"publishUserZoomDebounced",qM(()=>{this.isUserZooming=!1,this.publish("user-zoom-end")},250)),S(this,"publishUserZoomEvent",()=>{this.isUserZooming?this.publishUserZoomDebounced():(this.publish("user-zoom-start"),this.isUserZooming=!0,this.publishUserZoomDebounced())}),S(this,"setCameraMoving",()=>{this.cameraMoving=!0}),S(this,"unsetCameraMoving",()=>{this.cameraMoving=!1,this.lastCameraMoveTime=Date.now()}),S(this,"setUserInteracting",()=>{this.userInteracting=!0}),S(this,"unsetUserInteracting",()=>{this.userInteracting=!1}),S(this,"publishPedestalChangeEvent",a=>{this.publish("pedestal-change",{pedestal:a,scrolledToTop:this.scrolledToTop,scrolledToBottom:this.scrolledToBottom,scrollPercent:this.scrollPercent})}),S(this,"convertAltitudeToZoomLevel",a=>{let[,o]=this.center,s=this.computeMetersPerPixelFromAltitude(a),l=Math.cos(In.degToRad(o))*2*Math.PI*ud/s;return In.clamp(Math.log2(l/512),s6,l6)}),S(this,"convertZoomLevelToAltitude",a=>this.computeMetersPerPixelFromZoomLevel(a)*this.options.canvasHeight/2/Math.tan(In.degToRad(this.camera.fov)/2)),S(this,"completeTween",a=>{a.isPlaying()&&a.stop(),this.rendererState.internalTweenGroup.remove(a),this.tweens.delete(a)}),S(this,"debugContainer",new Yn),this.camera=t,this.renderer=r,this.rendererState=n,this.scene=e,this.options=i,this.elevation=t.parent,this.orbit=this.elevation.parent,this.cameraPlane=this.createCameraPlane(),this.zoomStart=t.position.z,i.mode!=="outdoors-overlay"&&this.addEventListeners()}get maxZoomLevel(){return this.convertAltitudeToZoomLevel(this.minZoomAltitude)}setMaxZoomLevel(t){this.minZoomAltitude=this.convertZoomLevelToAltitude(t),this.stateDirty=!0}get defaultMinZoomLevel(){return f(this,c6)}get minZoomLevel(){return this.convertAltitudeToZoomLevel(this.maxZoomAltitude)}setMinZoomLevel(t){this.maxZoomAltitude=this.convertZoomLevelToAltitude(t),this.stateDirty=!0}get scrollPercent(){let t=this.minPedestal,e=this.maxPedestal,r=this.getPedestal();return r=Math.min(r,e),r=Math.max(r,t),(r-t)/(e-t)*100}get fov(){return this.camera.fov}get scrolledToBottom(){return this.minPedestal===0||Math.floor(this.getPedestal())<=this.minPedestal}get scrolledToTop(){return this.maxPedestal===0||Math.ceil(this.getPedestal())>=this.maxPedestal}get center(){var t,e,r,n;let i=this.getPosition(),{lat:a,lon:o}=Mq((e=(t=this.rendererState.center)==null?void 0:t[1])!=null?e:0,(n=(r=this.rendererState.center)==null?void 0:r[0])!=null?n:0,i.x,i.y);return[o,a]}setCenter(t,e){var r,n,i,a;let{x:o,y:s}=Tq((n=(r=this.rendererState.center)==null?void 0:r[1])!=null?n:0,(a=(i=this.rendererState.center)==null?void 0:i[0])!=null?a:0,e,t);this.setPosition(o,s)}get isAnimating(){return this.rendererState.internalTweenGroup.getAll().some(t=>t.cameraAnimation)}getCameraFrameForCoordinates(t,e){var r,n;let i=e.minZoom!==void 0?e.minZoom:this.minZoomAltitude,a=e.maxZoom!==void 0?e.maxZoom:this.maxZoomAltitude,o=this.options.canvasWidth,s=this.options.canvasHeight,l=this.getRotation(),u=this.getTilt(),c=this.getPosition();this.setRotation((r=e.rotation)!=null?r:l,!0),this.setTilt((n=e.tilt)!=null?n:u,!0);let h=yL(t,{canvasWidth:o,canvasHeight:s,paddingOption:e.padding,verticalPadding:e.verticalPadding,minZoom:i,maxZoom:a,position:c,camera:this.camera,orbit:this.orbit});return this.setRotation(l,!0),this.setTilt(u,!0),{center:h.position,zoomLevel:this.convertAltitudeToZoomLevel(h.zoom)}}focusOn(t,e){let r=e.curve,n=e.callback,i=e.cancelledCallback,a=e.minZoom!==void 0?e.minZoom:this.minZoomAltitude,o=e.maxZoom!==void 0?e.maxZoom:this.maxZoomAltitude,s=this.options.canvasWidth,l=this.options.canvasHeight,u;e.duration!==void 0?u=e.duration:Oi.env.TESTING==="true"?u=0:u=Jte;let c=e.padding,h=this.getRotation(),d=this.getTilt();e.rotation!=null&&this.setRotation(e.rotation),e.tilt!=null&&this.setTilt(e.tilt);let p=yL(t,{canvasHeight:l,paddingOption:c,canvasWidth:s,minZoom:a,maxZoom:o,camera:this.camera,orbit:this.orbit,position:this.getPosition(),verticalPadding:e.verticalPadding});this.setRotation(h),this.setTilt(d),this.animateCamera({position:p.position,tilt:e.tilt,rotation:e.rotation,zoom:p.zoom},u,r,n,i,e)}resize(t,e){this.options.canvasWidth=t,this.options.canvasHeight=e}computeMetersPerPixelFromZoomLevel(t){let[,e]=this.center,r=In.clamp(t,s6,l6),n=Math.pow(2,r),i=In.clamp(e,Hte,Xte),a=n*512;return Math.cos(In.degToRad(i))*Math.PI*2*ud/a}computeMetersPerPixelFromAltitude(t){return t*2*Math.tan(In.degToRad(this.camera.fov)/2)/this.options.canvasHeight}getCurrentMetersPerPixel(){return this.computeMetersPerPixelFromAltitude(this.getZoomAltitude())}};c6=new WeakMap,S(uB,"CAMERA_FRAME_PADDING_SIDES",["top","bottom","left","right"]);function yL(t,{canvasWidth:e,orbit:r,paddingOption:n,verticalPadding:i=0,canvasHeight:a,minZoom:o,maxZoom:s,camera:l,position:u}){let c={zoom:o,position:u};if(t.length===0)return c;for(let X of uB.CAMERA_FRAME_PADDING_SIDES)typeof n[X]!="number"&&(n[X]=0);let h=n.type==="portion"?{top:n.top*a,bottom:n.bottom*a,left:n.left*e,right:n.right*e}:n;if(h.left+h.right>=e||h.top+h.bottom>=a)return c;r.updateMatrixWorld();let d=l.matrixWorldInverse,p=l.fov*(Math.PI/180)/2,m=p,y=Math.atan(Math.tan(p)*(e/a)),v=new Q(1/0,1/0,1/0),_=new Q(-1/0,-1/0,-1/0),w=new qn,b=new Q;for(let X=0,ke=t.length;X<ke;X++)b.copy(t[X]),w.expandByPoint(b),b.applyMatrix4(d),v.min(b),_.max(b),b.copy(t[X]),b.z-=i,b.applyMatrix4(d),v.min(b),_.max(b),b.copy(t[X]),b.z+=i,b.applyMatrix4(d),v.min(b),_.max(b);let A=_.x-v.x,E=_.y-v.y,M=e-h.left-h.right,P=a-h.top-h.bottom,k=(_.x+v.x)/2,D=(_.y+v.y)/2,O=A/M,B=E/P,L=o,R=s,T=L*Math.tan(y)*2,N=R*Math.tan(y)*2,$=T/e,V=N/e,G=Math.max(O,B);G=In.clamp(G,$,V);let ee=M*G,ie=P*G,me={min:{x:k-ee/2-h.left*G,y:D-ie/2-h.bottom*G},max:{x:k+ee/2+h.right*G,y:D+ie/2+h.top*G}},Me=(me.min.x+me.max.x)/2,Ae=(me.min.y+me.max.y)/2,le=w.getCenter(new Q),_e=Math.abs(Me-me.min.x),Le=Math.abs(Ae-me.min.y),Se=_e/Math.tan(y),Ue=Le/Math.tan(m),Y=new Q;Y.set(Me,Ae,_.z+Math.max(Se,Ue)),Y.applyMatrix4(l.matrixWorld);let we=new Q;we.set(Me,Ae,_.z),we.applyMatrix4(l.matrixWorld);let q=new Q().subVectors(we,Y),oe=(le.z-Y.z)/q.z,ce=new Q().copy(Y).add(q.clone().multiplyScalar(oe));return we.set(ce.x,ce.y,ce.z),Y.sub(we),{position:ce,zoom:Y.length()}}C();var jZe=300,dw,pw,VZe=class{constructor(t){S(this,"state"),K(this,dw,new Q),K(this,pw,new Q),this.state=t}update(t){var e;let r,n;this.state.cameraObject.getWorldPosition(f(this,pw));for(let i of this.state.geometry2DIdsInScene)if(r=this.state.geometry2DMap.get(i),r&&(n=r.components[0],n&&"containerEl"in n&&n.markerContainer!=null)){if(n.visibilityNeedsUpdate!==!1&&(n.visibilityNeedsUpdate==="show"?n.canShow=!0:n.canShow=!1),(n.canShow&&n.visible===!0||((e=n.animation)==null?void 0:e.pending)===!0)&&!n.offscreen)if(n.options.zIndex!=null)n.markerContainer.style.transform="translate3D(".concat(n.projection.x,"px, ").concat(n.projection.y,"px, ").concat(n.options.zIndex,"px)");else{r.object3d.getWorldPosition(f(this,dw));let a=f(this,pw).distanceTo(f(this,dw));n.markerContainer.style.transform="translate3D(".concat(n.projection.x,"px, ").concat(n.projection.y,"px, ").concat(-a,"px)")}if(n.canShow===!0&&n.visible===!0?n.markerContainer.style.pointerEvents=t?"none":n.pointerEvents:n.markerContainer.style.pointerEvents="none",n.currentStrategyIndex===-1&&n.visible&&n.visibilityNeedsUpdate==="show")continue;n.visibilityNeedsUpdate!==!1&&!n.offscreen&&(n.visibilityNeedsUpdate==="show"&&(n.markerContainer.style.opacity="0"),n.animation&&n.animation.cancel(),n.animation=n.markerContainer.animate([{opacity:n.canShow&&n.visible?"1":"0"}],{duration:jZe,easing:"ease-in-out",fill:"forwards"}),n.visibilityNeedsUpdate=!1)}}};dw=new WeakMap,pw=new WeakMap;C();var GZe=class extends wi{constructor(t,e){super(),S(this,"state"),S(this,"dirty",!0),S(this,"domTree"),S(this,"observers",new Map),S(this,"updateDimensions",r=>{r.forEach(n=>{var i;let a=(i=n.target.parentElement)==null?void 0:i.getAttribute("data-marker-id");if(a){let o=this.state.geometry2DMap.get(a),s=o?.components[0];o&&s instanceof Um&&(s.updateDimensions(n.contentRect.width,n.contentRect.height),s.collisionDirty=!0)}}),this.publish("dimensions-update")}),this.state=t,this.domTree=e}setupObserver(){var t;if(this.observers){for(let n of this.observers.values())n.disconnect();this.observers.clear()}let e,r;for(let n of this.domTree.children){let i=n.getAttribute("data-marker-id");if(i!=null&&(e=this.state.geometry2DMap.get(i),r=e.components[0],(t=r.options)!=null&&t.dynamicResize)){let a=new ResizeObserver(this.updateDimensions);a.observe(r.containerEl),this.observers.set(n.userData.entityId,a)}}}update(){this.dirty&&(this.setupObserver(),this.dirty=!1)}destroy(){for(let t of this.observers.values())t.disconnect();this.observers.clear()}};C();var ZZe=0,WZe=90;Oi.env.NODE_ENV;var u0={linear:wu.Linear.None,"ease-in":wu.Quadratic.In,"ease-out":wu.Quadratic.Out,"ease-in-out":wu.Quadratic.InOut},HZe=-50,Ht,fr,Oh,fw,mw,h6,XZe=class{constructor(t,e,r){K(this,mw),K(this,Ht),K(this,fr),K(this,Oh),K(this,fw),ne(this,Ht,t),ne(this,fr,e),ne(this,Oh,r),f(this,Ht).map&&f(this,Ht).map.transform.setMinElevationForCurrentTile(HZe),f(this,fr).cameraSystem.on("pedestal-change",({pedestal:n})=>{f(this,fr).cameraSystem.setCameraPlaneElevation(n)})}get center(){var t,e;return f(this,Ht).mode==="outdoors-overlay"&&f(this,Ht).map?(e=(t=f(this,Ht).map).getCenter)==null?void 0:e.call(t).toArray():f(this,fr).cameraSystem.center}setCenter(t){var e;if(f(this,Ht).mode==="outdoors-overlay"&&f(this,Ht).map){(e=f(this,Ht).map)==null||e.setCenter(t),f(this,fr).interactionSystem.handleHover();return}f(this,fr).cameraSystem.setCenter(t[0],t[1]),f(this,fr).interactionSystem.handleHover()}get zoomLevel(){var t;return f(this,Ht).mode==="outdoors-overlay"&&f(this,Ht).map?(t=f(this,Ht).map)==null?void 0:t.getZoom():f(this,fr).cameraSystem.getZoomLevel()}setZoomLevel(t){var e;f(this,Ht).mode==="outdoors-overlay"&&f(this,Ht).map&&((e=f(this,Ht).map)==null||e.setZoom(t)),f(this,fr).cameraSystem.setZoomLevel(wc(t,this.minZoomLevel,this.maxZoomLevel,"zoomLevel was clamped to minZoomLevel/maxZoomLevel bounds. Use mapView.Camera.setMinZoomLevel() and mapView.Camera.setMaxZoomLevel() to adjust limits."))}getState(){return{zoomLevel:this.zoomLevel,minZoomLevel:this.minZoomLevel,maxZoomLevel:this.maxZoomLevel,minPitch:this.minPitch,maxPitch:this.maxPitch,autoMinZoomLevel:this.autoMinZoomLevel,panMode:this.panMode,screenOffsets:this.insetsPadding,center:this.center,bearing:this.bearing,pitch:this.pitch,elevation:this.elevation}}get isAnimating(){return f(this,fr).cameraSystem.isAnimating}cancelAnimation(){f(this,fr).cameraSystem.cancelAnimation()}get maxZoomLevel(){return f(this,fr).cameraSystem.maxZoomLevel}get minZoomLevel(){return f(this,fr).cameraSystem.minZoomLevel}setAutoMinZoomLevel(t){f(this,fr).panBoundsSystem.autoMinZoomLevel=t,t&&(f(this,fr).panBoundsSystem.dirty=!0,f(this,fr).panBoundsSystem.update())}get autoMinZoomLevel(){return f(this,fr).panBoundsSystem.autoMinZoomLevel}setMinZoomLevel(t,e=!1){var r;e&&this.setAutoMinZoomLevel(!1);let n=wc(t,up.MIN_MERCATOR_ZOOM_LEVEL,this.maxZoomLevel,"setMinZoomLevel was clamped. minZoomLevel must be between ".concat(up.MIN_MERCATOR_ZOOM_LEVEL," and maxZoomLevel."));f(this,fr).cameraSystem.setMinZoomLevel(n),this.zoomLevel<n&&this.setZoomLevel(n),(r=f(this,Ht).map)==null||r.setMinZoom(n)}setMaxZoomLevel(t){var e;let r=wc(t,this.minZoomLevel,up.MAX_MERCATOR_ZOOM_LEVEL,"setMaxZoomLevel was clamped. maxZoomLevel must be between minZoomLevel and ".concat(up.MAX_MERCATOR_ZOOM_LEVEL,"."));f(this,fr).cameraSystem.setMaxZoomLevel(r),this.zoomLevel>r&&this.setZoomLevel(r),(e=f(this,Ht).map)==null||e.setMaxZoom(r)}get maxPitch(){var t,e;return f(this,Ht).mode==="outdoors-overlay"&&f(this,Ht).map?(e=(t=f(this,Ht).map)==null?void 0:t.getMaxPitch)==null?void 0:e.call(t):In.radToDeg(f(this,fr).cameraSystem.maxTilt)}get minPitch(){var t,e;return f(this,Ht).mode==="outdoors-overlay"&&f(this,Ht).map?(e=(t=f(this,Ht).map)==null?void 0:t.getMinPitch)==null?void 0:e.call(t):In.radToDeg(f(this,fr).cameraSystem.minTilt)}setMinPitch(t){var e;let r=Math.max(ZZe,t);(e=f(this,Ht).map)==null||e.setMinPitch(r),f(this,fr).cameraSystem.minTilt=In.degToRad(r)}setMaxPitch(t){var e;let r=Math.min(WZe,t);(e=f(this,Ht).map)==null||e.setMaxPitch(r),f(this,fr).cameraSystem.maxTilt=In.degToRad(r)}get bearing(){var t;return f(this,Ht).mode==="outdoors-overlay"&&f(this,Ht).map?(t=f(this,Ht).map)==null?void 0:t.getBearing():In.radToDeg(f(this,fr).cameraSystem.getRotation())}setBearing(t){var e;if(f(this,Ht).mode==="outdoors-overlay"&&f(this,Ht).map){(e=f(this,Ht).map)==null||e.setBearing(t);return}f(this,fr).cameraSystem.setRotation(In.degToRad(t))}get pitch(){var t;return f(this,Ht).mode==="outdoors-overlay"&&f(this,Ht).map?(t=f(this,Ht).map)==null?void 0:t.getPitch():In.radToDeg(f(this,fr).cameraSystem.getTilt())}setPitch(t){var e;if(f(this,Ht).mode==="outdoors-overlay"&&f(this,Ht).map){(e=f(this,Ht).map)==null||e.setPitch(t);return}f(this,fr).cameraSystem.setTilt(In.degToRad(wc(t,this.minPitch,this.maxPitch,"pitch was clamped to minPitch/maxPitch bounds. Use mapView.Camera.setMinPitch() and mapView.Camera.setMaxPitch() to adjust limits.")))}get elevation(){return f(this,fr).cameraSystem.getPedestal()}setElevation(t){f(this,fr).cameraSystem.setPedestal(t,!0)}animateElevation(t,e){return f(this,fw)&&f(this,fw).stop(),new Promise(r=>{var n;f(this,fr).cameraSystem.animateCamera({position:{z:t}},e?.duration||300,u0[e?.easing||"ease-in-out"],r,r,{interruptible:(n=e?.interruptible)!=null?n:!0})})}get insetsPadding(){return f(this,Oh).insetsPadding}get panMode(){return f(this,fr).cameraSystem.enablePan===!1&&f(this,fr).cameraSystem.enablePedestal===!0?"elevation":"default"}setPanMode(t){if(t!=="default"&&t!=="elevation")throw new Error("Invalid pan mode");t!==this.panMode&&(t==="default"?(f(this,fr).cameraSystem.enablePan=!0,f(this,fr).cameraSystem.enablePedestal=!1):(f(this,fr).cameraSystem.enablePan=!1,f(this,fr).cameraSystem.enablePedestal=!0))}setInsetPadding(t){f(this,Oh).insetsPadding=Object.assign({},f(this,Oh).insetsPadding,t)}animateTo(t){var e,r,n,i,a,o;if(f(this,Ht).mode==="outdoors-overlay"&&f(this,Ht).map)return(o=f(this,Ht).map)==null||o.flyTo({center:(e=t.center)!=null?e:this.center,zoom:(r=t.zoomLevel)!=null?r:this.zoomLevel,bearing:(n=t.bearing)!=null?n:this.bearing,pitch:(i=t.pitch)!=null?i:this.pitch,duration:(a=t.duration)!=null?a:600}),Promise.resolve();let s=t.center?f(this,Ht).convertTo3DMapPosition(t.center[1],t.center[0],t.center[2]||this.elevation):void 0,l=t.zoomLevel!==void 0?f(this,fr).cameraSystem.convertZoomLevelToAltitude(wc(t.zoomLevel,this.minZoomLevel,this.maxZoomLevel,"zoomLevel was clamped to minZoomLevel/maxZoomLevel bounds. Use mapView.Camera.setMinZoomLevel() and mapView.Camera.setMaxZoomLevel() to adjust limits.")):void 0,u=t.bearing!==void 0?In.degToRad(t.bearing):void 0,c=t.pitch!==void 0?In.degToRad(wc(t.pitch,this.minPitch,this.maxPitch,"pitch was clamped to minPitch/maxPitch bounds. Use mapView.Camera.setMinPitch() and mapView.Camera.setMaxPitch() to adjust limits.")):void 0;return new Promise(h=>{var d;f(this,fr).cameraSystem.animateCamera({position:s,zoom:l,rotation:u,tilt:c},t.duration||0,u0[t.easing||"ease-in-out"],()=>{f(this,fr).interactionSystem.handleHover(),h()},h,{interruptible:(d=t?.interruptible)!=null?d:!0})})}getCameraFrameForCoordinates(t,e){let r=ot(this,mw,h6).call(this,e||{},()=>Promise.resolve()),{pointCloud:n}=vL(t,f(this,Ht),f(this,Oh).geometry3DMap);if(n.length===0)return Be.error("No valid coordinates found in targets:",t),{center:this.center,zoomLevel:this.zoomLevel};let{center:i,zoomLevel:a}=f(this,fr).cameraSystem.getCameraFrameForCoordinates(n,r);return{center:f(this,Ht).convert3DMapPositionToCoordinate(i),zoomLevel:a}}focusOn(t,e){var r,n,i,a;let{pointCloud:o,geoBounds:s,firstPosition:l}=vL(t,f(this,Ht),f(this,Oh).geometry3DMap);return o.length===0?(Be.error("No valid coordinates found in targets:",t),Promise.resolve()):f(this,Ht).mode==="outdoors-overlay"&&f(this,Ht).map?(o.length===1&&l?(r=f(this,Ht).map)==null||r.flyTo({center:[l[0],l[1]],duration:e?.duration||f(this,Ht).map.getBearing(),animate:!0,bearing:e?.bearing===void 0?f(this,Ht).map.getBearing():e?.bearing,pitch:e?.pitch===void 0?f(this,Ht).map.getPitch():e?.pitch,zoom:e?.maxZoomLevel||f(this,Ht).map.getMaxZoom()}):(a=f(this,Ht).map)==null||a.fitBounds(s,{duration:(n=e?.duration)!=null?n:up.DEFAULT_ANIMATION_DURATION,bearing:e?.bearing===void 0?f(this,Ht).map.getBearing():e?.bearing,pitch:e?.pitch===void 0?f(this,Ht).map.getPitch():e?.pitch,maxZoom:(i=e?.maxZoomLevel)!=null?i:f(this,Ht).map.getMaxZoom()}),f(this,fr).interactionSystem.handleHover(),Promise.resolve()):new Promise(u=>{f(this,fr).cameraSystem.focusOn(o,ot(this,mw,h6).call(this,e||{},u))})}};Ht=new WeakMap,fr=new WeakMap,Oh=new WeakMap,fw=new WeakMap,mw=new WeakSet,h6=function(t,e){var r;return{minZoom:t?.maxZoomLevel===void 0?void 0:f(this,fr).cameraSystem.convertZoomLevelToAltitude(wc(t.maxZoomLevel,this.minZoomLevel,this.maxZoomLevel,"maxZoomLevel was clamped to minZoomLevel/maxZoomLevel bounds. Use mapView.Camera.setMaxZoomLevel() to adjust limits.")),maxZoom:t?.minZoomLevel===void 0?void 0:f(this,fr).cameraSystem.convertZoomLevelToAltitude(wc(t.minZoomLevel,this.minZoomLevel,this.maxZoomLevel,"minZoomLevel was clamped to minZoomLevel/maxZoomLevel bounds. Use mapView.Camera.setMinZoomLevel() to adjust limits.")),padding:t!=null&&t.padding?Object.assign({},fq,t?.padding):this.insetsPadding,curve:u0[t?.easing||"ease-in-out"],rotation:t?.bearing===void 0?void 0:In.degToRad(t.bearing),tilt:t?.pitch!==void 0?In.degToRad(wc(t.pitch,this.minPitch,this.maxPitch,"pitch was clamped to minPitch/maxPitch bounds. Use mapView.Camera.setMinPitch() and mapView.Camera.setMaxPitch() to adjust limits.")):void 0,duration:t?.duration,callback:()=>{f(this,fr).interactionSystem.handleHover(),e()},cancelledCallback:e,interruptible:(r=t?.interruptible)!=null?r:!0,verticalPadding:t?.verticalPadding}};function bI(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function vL(t,e,r){var n;let i=[],a=[1/0,1/0,-1/0,-1/0],o=null;if(!t||!Array.isArray(t)||t.length===0)return{pointCloud:i,geoBounds:a,firstPosition:o};let s=e.getSystems().renderSystem;for(let l of t)if(typeof l=="string"){(s.threeDdirty||s.twoDdirty)&&e.renderSync();let u=r.get(l);if(!u){Be.error("Entity not found with id:",l);continue}let c=new qn;Q6e(e,"userData"in u&&(n=u.userData.entityId)!=null?n:u.id,i,c,u instanceof ui?u.position.z:void 0);let h=e.convert3DMapPositionToCoordinate(c.min),d=e.convert3DMapPositionToCoordinate(c.max);bI(a,h),bI(a,d),o||(o=e.convert3DMapPositionToCoordinate(c.getCenter(new Q)))}else i.push(e.convertTo3DMapPosition(l[1],l[0],l[2]||0)),bI(a,l),o||(o=l);return{pointCloud:i,geoBounds:a,firstPosition:o}}C();C();var qZe=`uniform vec4 uSize;
varying vec2 vUv;
void main() {
  vUv = uv;
  // Scale the position by the size of the quad
  // and shift to top left corner for 0,0
	vec2 transformed = position.xy * uSize.xy - vec2(1.0, -1.0);
  // Apply width .x and height .y of image
  transformed += vec2(uSize.x, -uSize.y);
  // Apply left .w and top .z offset
  transformed += vec2(uSize.w, -uSize.z) * 2.0;
  gl_Position = vec4(transformed, 1.0, 1.0);
}`;C();var YZe=`varying vec2 vUv;
uniform sampler2D uTexture;
uniform float uOpacity;
void main() {
  #ifndef debug
  vec4 texture = texture2D(uTexture, vUv);
  gl_FragColor = vec4(texture.rgb, texture.a * uOpacity);
  #else
  gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);
  #endif
}`;C();var JZe=4.291666666666667,KZe=15,QZe=25,eWe=43/60;C();var _L=["horizontal","icon"],tWe=new Map([[_L[0],`<svg viewBox="0 0 206 48">
      <path d="M27.2678 14.2261H22.3187C21.0695 14.2261 20.4695 14.7801 20.4695 15.9852V31.142L10.3966 15.5591C9.69665 14.4784 9.2475 14.2773 7.8475 14.2261H2.97462C1.67462 14.2261 1.07631 14.7801 1.07631 15.9852V44.7665C1.07631 45.9716 1.67462 46.5256 2.97462 46.5256H7.92377C9.22207 46.5256 9.82207 45.9716 9.82207 44.7665V29.6847L19.9441 45.1926C20.695 46.3244 21.095 46.5256 22.4933 46.5256H27.2933C28.5916 46.5256 29.1916 45.9716 29.1916 44.7665V15.9852C29.1407 14.7801 28.5424 14.2261 27.2678 14.2261Z"/>
      <path d="M5.44915 10.9602C8.45863 10.9602 10.8983 8.50669 10.8983 5.48011C10.8983 2.45353 8.45863 0 5.44915 0C2.43967 0 0 2.45353 0 5.48011C0 8.50669 2.43967 10.9602 5.44915 10.9602Z"/>
      <path d="M61.7899 25.0449C63.2306 23.1903 65.078 22.2051 67.556 22.2051C72.0526 22.2051 74.7611 25.3347 74.7611 29.4511V39.2489C74.8187 39.7125 74.5306 39.9443 74.0695 39.9443H72.5136C72.0526 39.9443 71.7645 39.7125 71.8221 39.2489V29.5091C71.8221 27.1909 69.9187 25.2187 67.4984 25.2187C65.1339 25.2187 63.2323 27.1329 63.2323 29.2773V39.2489C63.2899 39.7125 63.0018 39.9443 62.5407 39.9443H60.9831C60.5221 39.9443 60.2916 39.7125 60.2916 39.2489V29.4511C60.2916 27.1329 58.3899 25.2187 56.0255 25.2187C53.7204 25.2187 51.7594 27.075 51.7594 29.2773V39.3068C51.817 39.7705 51.5289 40.0023 51.0102 40.0023H49.5119C49.0509 40.0023 48.7628 39.7705 48.7628 39.3068V23.25C48.7051 22.7864 48.9933 22.4966 49.5119 22.4966H50.9526C51.356 22.4966 51.5289 22.6704 51.5289 23.0182V24.2352C52.7407 22.9602 54.239 22.2648 56.0255 22.2648C58.4475 22.2068 60.3492 23.192 61.7899 25.0466V25.0449ZM77.1255 31.2477C77.1255 26.3216 81.1018 22.2051 86.1187 22.2051C88.539 22.2051 90.6136 23.1903 92.3441 25.1608V23.1903C92.3441 22.7267 92.5746 22.5528 93.0357 22.5528H94.4187C94.8797 22.5528 95.1102 22.7847 95.1102 23.3062V39.3648C95.1102 39.8284 94.8797 40.0602 94.4187 40.0602H93.0357C92.5746 40.0602 92.3441 39.8284 92.3441 39.4227V37.4523C90.6712 39.3648 88.5967 40.35 86.1746 40.35C81.1018 40.2341 77.1238 36.1773 77.1238 31.2477H77.1255ZM92.1136 31.2477C92.1136 27.8284 89.4611 25.2187 86.0594 25.2187C82.7746 25.2187 80.1221 27.8864 80.1221 31.2477C80.1221 34.6687 82.7746 37.2784 86.1187 37.2784C86.9062 37.2789 87.6861 37.1232 88.4138 36.8202C89.1414 36.5173 89.8026 36.0731 90.3593 35.513C90.9161 34.9528 91.3577 34.2878 91.6587 33.556C91.9597 32.8241 92.1143 32.0397 92.1136 31.2477ZM100.992 37.3943V46.3807C101.049 46.8443 100.761 47.1341 100.298 47.1341H98.7424C98.2814 47.1341 97.9933 46.9023 97.9933 46.3807V23.1903C97.9933 22.7267 98.2238 22.4369 98.7424 22.4369H100.183C100.646 22.379 100.934 22.6687 100.934 23.0744V24.9869C102.605 23.0744 104.68 22.1472 107.044 22.1472C112.002 22.1472 116.037 26.2619 116.037 31.1898C116.037 36.1176 112.059 40.2341 107.044 40.2341C104.622 40.2341 102.603 39.3068 100.992 37.3943ZM106.987 25.2187C103.7 25.2187 101.049 27.8864 101.049 31.2477C101.049 34.6687 103.7 37.2784 107.044 37.2784C110.446 37.2784 113.039 34.6108 113.039 31.2477C113.039 27.8864 110.388 25.2187 106.987 25.2187ZM121.11 37.3943V46.3807C121.168 46.8443 120.88 47.1341 120.419 47.1341H118.861C118.4 47.1341 118.112 46.9023 118.112 46.3807V23.1903C118.112 22.7267 118.342 22.4369 118.861 22.4369H120.302C120.764 22.379 121.053 22.6687 121.053 23.0744V24.9869C122.724 23.0744 124.798 22.1472 127.163 22.1472C132.12 22.1472 136.156 26.2619 136.156 31.1898C136.156 36.1176 132.178 40.2341 127.163 40.2341C124.742 40.2341 122.781 39.3068 121.11 37.3943ZM127.105 25.2187C123.819 25.2187 121.168 27.8864 121.168 31.2477C121.168 34.6687 123.819 37.2784 127.163 37.2784C130.564 37.2784 133.158 34.6108 133.158 31.2477C133.158 27.8864 130.507 25.2187 127.107 25.2187H127.105ZM153.97 32.3506H141.054C141.342 35.2483 143.995 37.4523 147.164 37.4523C148.893 37.4523 150.393 37.0466 151.719 36.0597C152.007 35.8858 152.295 35.7699 152.353 35.7699C152.583 35.7699 152.756 35.8858 152.929 36.1773L153.505 37.1625C153.622 37.3364 153.68 37.4523 153.68 37.5682C153.68 37.8 153.507 38.0318 153.103 38.3216C151.258 39.5966 149.183 40.292 146.992 40.292C141.688 40.292 137.883 36.3511 137.883 31.2477C137.883 26.204 141.803 22.2051 146.703 22.2051C151.546 22.2051 154.717 25.7983 154.717 31.0176C154.717 31.5972 154.717 32.3506 153.968 32.3506H153.97ZM141.056 30.0324H151.72C151.432 26.8432 149.473 24.929 146.648 24.929C145.241 24.8904 143.875 25.3995 142.833 26.3501C141.791 27.3007 141.154 28.6194 141.056 30.0307V30.0324ZM156.332 31.2477C156.332 26.3216 160.31 22.2051 165.326 22.2051C167.748 22.2051 169.707 23.1324 171.32 25.0449V16.2324C171.263 15.7687 171.551 15.479 172.012 15.479H173.57C174.031 15.479 174.319 15.7108 174.319 16.2324V39.3068C174.319 39.7705 174.088 40.0023 173.57 40.0023H172.129C171.666 40.0602 171.378 39.7705 171.378 39.3648V37.3943C169.649 39.3068 167.632 40.292 165.268 40.292C160.31 40.2341 156.332 36.1773 156.332 31.2477ZM171.264 31.2477C171.264 27.8284 168.612 25.2187 165.21 25.2187C161.924 25.2187 159.273 27.8864 159.273 31.2477C159.273 34.6687 161.924 37.2784 165.268 37.2784C166.057 37.2838 166.839 37.1316 167.569 36.8304C168.299 36.5292 168.962 36.0852 169.52 35.5241C170.077 34.963 170.519 34.296 170.818 33.5619C171.117 32.8277 171.268 32.0411 171.263 31.2477H171.264ZM177.72 19.0739C177.715 18.8594 177.754 18.646 177.833 18.4468C177.912 18.2476 178.031 18.0667 178.182 17.915C178.333 17.7633 178.512 17.6439 178.71 17.5642C178.909 17.4845 179.121 17.446 179.334 17.4511C179.546 17.4507 179.756 17.4923 179.952 17.5737C180.148 17.6551 180.326 17.7746 180.476 17.9254C180.626 18.0762 180.745 18.2553 180.826 18.4523C180.907 18.6494 180.948 18.8606 180.948 19.0739C180.953 19.2884 180.914 19.5017 180.835 19.7009C180.756 19.9001 180.637 20.081 180.486 20.2327C180.335 20.3845 180.156 20.5038 179.957 20.5835C179.759 20.6633 179.547 20.7017 179.334 20.6966C178.412 20.7545 177.72 20.0591 177.72 19.0739ZM177.836 39.2489V23.1903C177.836 22.7267 178.066 22.4369 178.527 22.4369H180.083C180.544 22.4369 180.832 22.6687 180.775 23.1903V39.2489C180.832 39.7125 180.544 39.9443 180.083 39.9443H178.527C178.066 39.9443 177.836 39.7125 177.836 39.2489ZM186.944 23.0165V24.1756C188.212 22.8426 189.71 22.2051 191.497 22.2051C195.937 22.2051 198.646 25.2767 198.646 29.3932V39.2489C198.703 39.7125 198.415 39.9443 197.954 39.9443H196.398C195.936 39.9443 195.705 39.7125 195.705 39.2489V29.4511C195.705 27.1329 193.803 25.2187 191.439 25.2187C189.134 25.2187 187.175 27.075 187.175 29.2773V39.3068C187.232 39.7705 186.944 40.0023 186.424 40.0023H184.868C184.407 40.0023 184.119 39.7705 184.119 39.3068V23.1903C184.061 22.7267 184.349 22.4949 184.868 22.4949H186.309C186.712 22.4949 186.944 22.6687 186.944 23.0165Z"/>
      <path d="M204 40C205.115 40 206 39.0857 206 38V37.9886C206 36.9029 205.126 36 204 36C202.885 36 202 36.9143 202 38V38.0114C202 39.0971 202.874 40 204 40ZM204 39.7829C202.989 39.7829 202.23 38.9829 202.23 38.0114V38C202.23 37.0286 203 36.2171 204 36.2171C205.011 36.2171 205.77 37.0171 205.77 37.9886V38C205.77 38.9714 205 39.7829 204 39.7829ZM203.218 38.9714H203.609V38.2743H204.034L204.517 38.9714H204.989L204.448 38.2057C204.724 38.1257 204.92 37.92 204.92 37.5886C204.92 37.1657 204.586 36.9486 204.138 36.9486H203.218V38.9714ZM203.609 37.9543V37.2914H204.103C204.368 37.2914 204.517 37.4057 204.517 37.6229C204.517 37.8171 204.368 37.9543 204.103 37.9543H203.609Z"/>
    </svg>`],[_L[1],`<svg viewBox="0 0 43 60">
      <path d="M14.0291 7.06645C14.0291 10.9691 10.8885 14.1329 7.01453 14.1329C3.14051 14.1329 0 10.9691 0 7.06645C0 3.16376 3.14051 0 7.01453 0C10.8885 0 14.0291 3.16376 14.0291 7.06645Z"/>
      <path d="M28.7335 18.3468H35.1045C36.7455 18.3468 37.5178 19.0599 37.5821 20.6158V57.7309C37.5821 59.2868 36.8099 60 35.1367 60H28.9588C27.1569 60 26.642 59.7406 25.6767 58.282L12.6452 38.282V57.7309C12.6452 59.2868 11.8729 60 10.1997 60H3.82873C2.15554 60 1.3833 59.2868 1.3833 57.7309V20.6158C1.3833 19.0599 2.15554 18.3468 3.82873 18.3468H10.1032C11.9051 18.4116 12.4843 18.671 13.3852 20.0648L26.3524 40.162V20.6158C26.3524 19.0599 27.1247 18.3468 28.7335 18.3468Z"/>
      <path d="M41.5 60C42.3362 60 43 59.3143 43 58.5V58.4914C43 57.6771 42.3448 57 41.5 57C40.6638 57 40 57.6857 40 58.5V58.5086C40 59.3229 40.6552 60 41.5 60ZM41.5 59.8371C40.7414 59.8371 40.1724 59.2371 40.1724 58.5086V58.5C40.1724 57.7714 40.75 57.1629 41.5 57.1629C42.2586 57.1629 42.8276 57.7629 42.8276 58.4914V58.5C42.8276 59.2286 42.25 59.8371 41.5 59.8371ZM40.9138 59.2286H41.2069V58.7057H41.5259L41.8879 59.2286H42.2414L41.8362 58.6543C42.0431 58.5943 42.1897 58.44 42.1897 58.1914C42.1897 57.8743 41.9397 57.7114 41.6034 57.7114H40.9138V59.2286ZM41.2069 58.4657V57.9686H41.5776C41.7759 57.9686 41.8879 58.0543 41.8879 58.2171C41.8879 58.3629 41.7759 58.4657 41.5776 58.4657H41.2069Z"/>
    </svg>`]]),rWe=/<svg([^>]*)>/g;function nWe(t,e,r,n){let i=tWe.get(t);return i?i.replace(rWe,'<svg$1 width="'.concat(r,'" height="').concat(n,'" xmlns="http://www.w3.org/2000/svg" style="fill: ').concat(e,';">')):""}C();var Qte=class dv{constructor(){S(this,"loader"),this.loader=new TN}static getInstance(){return dv.instance||(dv.instance=new dv),dv.instance}getLoader(){return this.loader}load(e){return new Promise((r,n)=>{this.loader.load(e,r,void 0,n)})}};S(Qte,"instance");var iWe=Qte,hS=iWe.getInstance(),xL=!1,On,Bh,pv,da,Fo,vm,tu,mc,aWe=class extends wi{constructor(t,e,r){super(),K(this,On,{padding:16,scale:1,iconOnly:!1,position:"bottom-left",color:"dark",onClick:()=>{window?.open("https://www.mappedin.com")},interactive:!0,visible:!0}),K(this,Bh),K(this,pv),K(this,da),K(this,Fo),K(this,vm),K(this,tu,0),K(this,mc,0),S(this,"dirty",!0),S(this,"getPositionAlignedCanvasCoordinates",(n,i)=>({"top-left":{x:0,y:0},"top-right":{x:n,y:0},"bottom-left":{x:0,y:i},"bottom-right":{x:n,y:i},center:{x:n/2,y:i/2},top:{x:n/2,y:0},bottom:{x:n/2,y:i},left:{x:0,y:i/2},right:{x:n,y:i/2}})[f(this,On).position]),S(this,"getPositionAlignedPadding",()=>{var n,i,a,o;let s=f(this,On).padding;if(typeof s=="number")return{"top-left":{x:s,y:s},"top-right":{x:-s,y:s},"bottom-left":{x:s,y:-s},"bottom-right":{x:-s,y:-s},center:{x:0,y:0},top:{x:0,y:s},bottom:{x:0,y:-s},left:{x:s,y:0},right:{x:-s,y:0}}[f(this,On).position];let l={top:(n=s.top)!=null?n:0,right:(i=s.right)!=null?i:0,bottom:(a=s.bottom)!=null?a:0,left:(o=s.left)!=null?o:0};return{x:l.left-l.right,y:l.top-l.bottom}}),r&&Object.entries(r).forEach(([n,i])=>{i!==void 0&&(f(this,On)[n]=i)}),ne(this,pv,t),ne(this,Bh,e)}get color(){return f(this,On).color==="light"?"white":"#293136"}get iconName(){return f(this,On).iconOnly?"icon":"horizontal"}get minWidth(){return f(this,On).iconOnly?KZe:75}get defaultWidth(){return f(this,On).iconOnly?QZe:150}get aspectRatio(){return f(this,On).iconOnly?eWe:JZe}get options(){return ae({},f(this,On))}set options(t){var e,r;ne(this,On,{padding:t.padding||f(this,On).padding,position:t.position||f(this,On).position,iconOnly:t.iconOnly||f(this,On).iconOnly,color:t.color||f(this,On).color,scale:t.scale||f(this,On).scale,onClick:f(this,On).onClick,interactive:(e=t.interactive)!=null?e:f(this,On).interactive,visible:(r=t.visible)!=null?r:f(this,On).visible})}get icon(){return nWe(this.iconName,this.color,f(this,tu)*f(this,Bh).pixelRatio,f(this,mc)*f(this,Bh).pixelRatio)}setSize(t,e){f(this,Fo)&&(f(this,Fo).uniforms.uSize.value.x=t,f(this,Fo).uniforms.uSize.value.y=e)}setXY(t,e){f(this,Fo)&&(f(this,Fo).uniforms.uSize.value.w=t,f(this,Fo).uniforms.uSize.value.z=e)}get width(){return f(this,tu)}get height(){return f(this,mc)}getPositionAlignedOffset(t,e){return{"top-left":{x:0,y:0},"top-right":{x:-t,y:0},"bottom-left":{x:0,y:-e},"bottom-right":{x:-t,y:-e},center:{x:-(t/2),y:-(e/2)},top:{x:-(t/2),y:0},bottom:{x:-(t/2),y:-e},left:{x:0,y:-(e/2)},right:{x:-t,y:-(e/2)}}[f(this,On).position]}insertIntoQuadTree(t){f(this,vm)!=null&&typeof f(this,On).onClick=="function"&&f(this,On).interactive&&t.insert(f(this,vm))}resize(t,e){if(f(this,On).visible!==!0)return;let r=this.getPositionAlignedCanvasCoordinates(t,e),n=this.getPositionAlignedPadding(),i=this.getPositionAlignedOffset(f(this,tu),f(this,mc)),a=Math.min(t-f(this,tu),Math.max(0,r.x+n.x+i.x)),o=Math.min(e-f(this,mc),Math.max(0,r.y+n.y+i.y));this.setSize(f(this,tu)/t,f(this,mc)/e),this.setXY(a/t,o/e),ne(this,vm,new vn(a,o,f(this,tu),f(this,mc),{entityId:"watermark"}))}update(){this.dirty&&(f(this,On).visible===!0?(ne(this,tu,Math.min(f(this,Bh).canvasWidth,Math.max(this.minWidth,this.defaultWidth*f(this,On).scale))),ne(this,mc,f(this,tu)/this.aspectRatio),hS.getLoader().load("data:image/svg+xml;base64,".concat(btoa(this.icon)),t=>{if(ne(this,Fo,new ys({uniforms:{uTexture:{value:t},uSize:{value:new _n(0,0,0,0)},uOpacity:{value:.7}},vertexShader:qZe,fragmentShader:YZe,depthWrite:!1,depthTest:!1,defines:{debug:xL},wireframe:xL,transparent:!0,visible:!0})),f(this,da))f(this,da).visible=!0,f(this,da).material=f(this,Fo),f(this,da).material.needsUpdate=!0;else{let e=new yd(2,2,1,1);ne(this,da,new Er(e,f(this,Fo))),f(this,da).position.set(0,0,-1),f(this,da).frustumCulled=!1,f(this,da).renderOrder=999;let r=new od(1,1,1),n=new Er(r,new Go({transparent:!0,opacity:0,depthTest:!1,depthWrite:!1}));n.frustumCulled=!1,n.layers.set(1),f(this,da).add(n),f(this,pv).add(f(this,da))}this.resize(f(this,Bh).canvasWidth,f(this,Bh).canvasHeight),this.publish("texture-loaded")})):f(this,da)&&(f(this,da).visible=!1),this.dirty=!1)}destroy(){f(this,da)&&(f(this,pv).remove(f(this,da)),ya(f(this,da))),ne(this,da,void 0),f(this,Fo)&&f(this,Fo).dispose(),ne(this,Fo,void 0),ne(this,vm,void 0)}};On=new WeakMap,Bh=new WeakMap,pv=new WeakMap,da=new WeakMap,Fo=new WeakMap,vm=new WeakMap,tu=new WeakMap,mc=new WeakMap;C();var bb=100,oWe=!1,sWe=class extends wi{constructor(t,e){super(),S(this,"currentTotalBoundingBox"),S(this,"state"),S(this,"cameraSystem"),S(this,"debugMesh",null),S(this,"dirty",!0),S(this,"autoMinZoomLevel",!0),this.state=t,this.cameraSystem=e}update(){if(this.dirty){this.currentTotalBoundingBox==null&&(this.currentTotalBoundingBox=new qn,this.state.geometryScene.children.length===0?this.currentTotalBoundingBox.setFromCenterAndSize(new Q(0,0,0),new Q(bb*2,bb*2,0)):(this.currentTotalBoundingBox.setFromObject(this.state.geometryScene),this.currentTotalBoundingBox.expandByScalar(bb)));let t=new qn().setFromObject(this.state.geometryScene);this.currentTotalBoundingBox.union(t);let e=t.getSize(new Q),r=Math.max(e.x,e.y,e.z);for(let i of this.state.geometry2DMap.values())i.positionDirty===!0&&(this.currentTotalBoundingBox.expandByPoint(i.position),i.positionDirty=!1);let n=wI.copy(this.currentTotalBoundingBox).expandByScalar(Math.max(r,bb)).getBoundingSphere(lWe).radius;this.cameraSystem.panBounds={center:this.currentTotalBoundingBox.getCenter(new Q),min:wI.min,max:wI.max,radius:n},this.publish("update"),this.cameraSystem.dirty=!0,this.dirty=!1}}},wI=new qn,lWe=new jo;C();var AI=" Mappedin",uWe="https://info.mappedin.com/feedback",bL=["top-left","top-right","bottom-left","bottom-right"],cWe=640,hWe=()=>`<svg xmlns='http://www.w3.org/2000/svg' width='15' height='15' fill-rule='evenodd' viewBox='0 0 20 20'>
						<circle cx='10' cy='10' r='5.9' style='fill:rgba(255,255,255,1);'/>
						<path style='fill:rgba(0,0,0,0.7);' d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/>
					</svg>`,SI={custom:[],position:"bottom-right",feedback:!0},fv,dWe=class{constructor(t,e={}){S(this,"controlContainerEl"),S(this,"controlPositions"),S(this,"compact"),K(this,fv),S(this,"attribContainerEl"),S(this,"attribInnerEl"),S(this,"attribButtonEl"),S(this,"feedbackLinkEl"),S(this,"attribHTML",AI),S(this,"customAttributions",[]),S(this,"toggleAttribution",r=>{this.attribContainerEl!=null&&(r.preventDefault(),this.attribContainerEl.classList.contains("mappedin-compact")&&(this.attribContainerEl.classList.contains("mappedin-compact-show")?(this.attribContainerEl.removeAttribute("open"),this.attribContainerEl.classList.remove("mappedin-compact-show")):(this.attribContainerEl.classList.add("mappedin-compact-show"),this.attribContainerEl.setAttribute("open",""))))}),ne(this,fv,!!e.outdoorEnabled),this.controlContainerEl=document.createElement("div"),this.controlContainerEl.classList.add("mappedin-control-container"),t.appendChild(this.controlContainerEl),this.controlPositions=bL.reduce((r,n)=>{let i=document.createElement("div");return i.classList.add("mappedin-ctrl-".concat(n)),this.controlContainerEl.appendChild(i),r[n]=i,r},{})}addAttributionControl(t=SI){var e;let r=t.position&&bL.includes(t.position)?t.position:SI.position;this.attribContainerEl=document.createElement("details"),this.attribContainerEl.classList.add("mappedin-ctrl-attrib","mappedin-ctrl-attrib-".concat(r)),this.attribContainerEl.open=!0,this.attribContainerEl.ariaLabel="Attribution",this.controlPositions[r].appendChild(this.attribContainerEl),this.attribButtonEl=document.createElement("summary"),this.attribButtonEl.addEventListener("click",this.toggleAttribution),this.attribButtonEl.classList.add("mappedin-ctrl-attrib-button"),this.attribButtonEl.title="Toggle attribution",this.attribButtonEl.ariaLabel="Toggle attribution",this.attribButtonEl.tabIndex=0,this.attribButtonEl.innerHTML=hWe(),this.attribContainerEl.appendChild(this.attribButtonEl),this.attribInnerEl=document.createElement("div"),this.attribInnerEl.classList.add("mappedin-ctrl-attrib-inner"),this.attribHTML=f(this,fv)?AI:"",this.attribInnerEl.innerHTML=this.attribHTML,this.attribContainerEl.appendChild(this.attribInnerEl),((e=t.feedback)!=null?e:SI.feedback)&&(this.feedbackLinkEl=document.createElement("a"),this.feedbackLinkEl.href=uWe,this.feedbackLinkEl.target="_blank",this.feedbackLinkEl.rel="noopener",this.feedbackLinkEl.textContent="Provide Feedback",this.feedbackLinkEl.classList.add("mappedin-ctrl-attrib-inner"),this.feedbackLinkEl.classList.add("mappedin-ctrl-attrib-inner-bold"),this.attribContainerEl.appendChild(this.feedbackLinkEl)),t.custom&&(this.customAttributions=t.custom),this.updateAttributionDisplay()}updateAttribution(t){if(!t.style||!this.attribInnerEl||!this.attribContainerEl)return;let e=f(this,fv)?[AI]:[],r=t.style.sourceCaches;for(let n in r){let i=r[n];if(i.used||i.usedForTerrain){let a=i.getSource();a.attribution&&e.indexOf(a.attribution)<0&&e.push(a.attribution)}}e=e.filter(n=>String(n).trim()),e=e.filter((n,i)=>{for(let a=i+1;a<e.length;a++)if(e[a].indexOf(n)>=0)return!1;return!0}),this.attribHTML=e.join(" "),this.updateAttributionDisplay()}updateAttributionDisplay(){let t=[...new Set([this.attribHTML,...this.customAttributions])].filter(Boolean).join(" ");this.attribInnerEl&&(this.attribInnerEl.innerHTML=t)}resizeAttribution(t){this.attribContainerEl&&(t<=cWe||this.compact?this.compact===!1?this.attribContainerEl.setAttribute("open",""):!this.attribContainerEl.classList.contains("mappedin-compact")&&!this.attribContainerEl.classList.contains("mappedin-attrib-empty")&&(this.attribContainerEl.setAttribute("open",""),this.attribContainerEl.classList.add("mappedin-compact","mappedin-compact-show")):(this.attribContainerEl.setAttribute("open",""),this.attribContainerEl.classList.contains("mappedin-compact")&&this.attribContainerEl.classList.remove("mappedin-compact","mappedin-compact-show")))}destroyAttributionControl(){this.attribButtonEl&&this.attribButtonEl.removeEventListener("click",this.toggleAttribution),this.attribContainerEl&&(this.attribContainerEl.remove(),this.attribContainerEl=void 0,this.attribInnerEl=void 0,this.attribButtonEl=void 0)}resize(t){this.resizeAttribution(t)}updateData(t){this.updateAttribution(t)}destroy(){this.destroyAttributionControl(),this.controlContainerEl.remove(),this.compact=void 0}};fv=new WeakMap;C();var gw,yw,EI=class{constructor(t,e){S(this,"mesh"),S(this,"type","custom-geometry"),S(this,"dirty",!0),S(this,"feature"),S(this,"builder"),S(this,"outline"),K(this,gw,1),S(this,"color",new jt),K(this,yw,0),this.mesh=new _0,this.feature=t,this.builder=e}get visible(){return this.mesh.visible}set visible(t){this.mesh.visible=t}set opacity(t){ne(this,gw,t)}get opacity(){return f(this,gw)}setColor(t){this.color.set(t)}get position(){var t;return(t=this.mesh)==null?void 0:t.position}get altitude(){return f(this,yw)}set altitude(t){this.mesh&&(this.mesh.position.z=t,ne(this,yw,t))}get renderOrder(){return this.mesh?this.mesh.renderOrder:0}set renderOrder(t){this.mesh&&(this.mesh.renderOrder=t)}};gw=new WeakMap,yw=new WeakMap;C();var pWe=class{constructor(t,e){S(this,"state"),S(this,"convertTo3DMapPosition"),this.state=t,this.convertTo3DMapPosition=e}update(){let t,e;for(let r of this.state.geometry3DIdsInScene){let n=this.state.geometry3DMap.get(r);n?.type==="custom-geometry"&&(t=n.components[0],e=n.components[1],t.dirty&&e.visible!==!1&&(t.position.copy(this.convertTo3DMapPosition(t.feature.geometry.coordinates[1],t.feature.geometry.coordinates[0],e.altitude)),t.builder.setup(t.mesh),t.mesh.traverse(i=>{i.userData=lt(ae({},i.userData),{entityId:r,type:"custom-geometry"})}),t.dirty=!1),e.visible!==!1&&t.builder.update(t.mesh))}}};C();C();function fWe(t){return t.children.some(e=>e.userData.isOutline)}function mWe(t,e){var r;let n=t.userData.entities3D.values().next().value;return n?((r=e.geometry3DMap.get(n))==null?void 0:r.components[3])!==void 0:!1}function ere(t,e,r,n,i){let a=t.getAttribute("position").array,o=1/0,s=-1/0;for(let u=0;u<e.count;u++){let c=(e.start+u)*3,h=a[c+2];o=Math.min(o,h),s=Math.max(s,h)}let l=s-o;if(!i||i.thickness===0||l===0)for(let u=0;u<e.count;u++){let c=(e.start+u)*3,h=a[c+2];Math.abs(h-s)<1e-4?a[c+2]=Math.max(r+n,2e-4+n):a[c+2]=n}else{let u=i.thickness,c=o+u,h=o+u,d=s-u,p=s-u,m=n-u,y=n,v=n,_=n+r,w=n+r,b=n+r+u;for(let A=0;A<e.count;A++){let E=(e.start+A)*3,M=a[E+2],P;if(M<=c){let k=u>0?(M-o)/u:0;P=m+k*(y-m)}else if(M>=p){let k=u>0?(M-p)/u:0;P=w+k*(b-w)}else{let k=d-h,D=k>0?(M-h)/k:0;P=v+D*(_-v)}a[E+2]=P}}t.attributes.position.needsUpdate=!0}C();function tre(t){var e,r;let n=new Ja,i=(e=t.mesh)==null?void 0:e.geometry;if(!i||!((r=t.batchedProps)!=null&&r.range))return;let a=t.batchedProps.range,o=a.start,s=a.count,l=i.getAttribute("position");if(l){let h=new Float32Array(s*3);for(let d=0;d<s;d++){let p=o+d;h[d*3]=l.array[p*3],h[d*3+1]=l.array[p*3+1],h[d*3+2]=l.array[p*3+2]}n.setAttribute("position",new Xn(h,3))}let u=i.getAttribute("normal");if(u){let h=new Float32Array(s*3);for(let d=0;d<s;d++){let p=o+d;h[d*3]=u.array[p*3],h[d*3+1]=u.array[p*3+1],h[d*3+2]=u.array[p*3+2]}n.setAttribute("normal",new Xn(h,3))}let c=i.getAttribute("uv");if(c){let h=new Float32Array(s*2);for(let d=0;d<s;d++){let p=o+d;h[d*2]=c.array[p*2],h[d*2+1]=c.array[p*2+1]}n.setAttribute("uv",new Xn(h,2))}if(i.index){let h=i.index,d=new Uint32Array(s);for(let p=0;p<s;p++)d[p]=h.array[o+p];n.setIndex(new Xn(d,1))}return n}function gWe(t,e,r){let n=tre(t);if(!n||!t.mesh)return;t.mesh.getMatrixAt(t.instanceIndex,r),t.mesh.deleteInstance(t.instanceIndex),t.mesh.optimize();let i=e.addGeometry(n);e.addInstance(i),e.setMatrixAt(i,r);let a=e.getGeometryIdAt(i),o=e.getGeometryRangeAt(a);return o&&t.batchedProps&&(t.batchedProps.range=o),n.dispose(),i}C();C();var yWe=`// Modified from https://github.com/mrdoob/three.js/blob/dev/src/renderers/shaders/ShaderLib/linedashed.glsl.js
uniform float scale;
attribute float lineDistance;

varying float vLineDistance;
attribute float visibility;
varying vec4 v_color;

#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	vLineDistance = scale * lineDistance;
	v_color = color;

	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
    if (visibility < 0.5) {
        gl_Position = vec4(-2.0, -2.0, -2.0, 1.0);
    }
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>

}`;C();var vWe=`// Modified from https://github.com/mrdoob/three.js/blob/dev/src/renderers/shaders/ShaderLib/linedashed.glsl.js
uniform vec3 diffuse;
uniform float opacity;

uniform float dashSize;
uniform float totalSize;

varying float vLineDistance;
varying vec4 v_color;

#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>

	if ( mod( vLineDistance, totalSize ) > dashSize ) {

		discard;

	}

	vec3 outgoingLight = vec3( 0.0 );

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>

	outgoingLight = diffuseColor.rgb; // simple shader

	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>

	// Discard alpha lower than 0.01 to avoid opacity fighting
    if (v_color.a <= 0.01) { 
		discard;
	}
}
`,_We=class extends hN{constructor(t){super(t),this.onBeforeCompile=e=>{e.vertexShader=yWe,e.fragmentShader=vWe}}};C();var du,pg,xp,bp,dA,d6,p6=class{constructor(){K(this,dA),K(this,du,[]),K(this,pg,!1),K(this,xp),K(this,bp)}get size(){return f(this,du).length}add(t){f(this,du).push(t),f(this,pg)||ot(this,dA,d6).call(this)}onComplete(t){ne(this,xp,t)}clearOnComplete(){ne(this,xp,void 0)}clearAll(){ne(this,du,[]),ne(this,pg,!1),ne(this,xp,void 0),f(this,bp)!==void 0&&(cancelIdleCallback(f(this,bp)),ne(this,bp,void 0))}};du=new WeakMap,pg=new WeakMap,xp=new WeakMap,bp=new WeakMap,dA=new WeakSet,d6=function(){ne(this,pg,!0),ne(this,bp,requestIdleCallback(t=>{let e=0;for(;f(this,du).length>0&&t.timeRemaining()>2;){let r=f(this,du).shift();r&&(r(),e++)}if(e===0&&f(this,du).length>0&&t.timeRemaining()<2){let r=f(this,du).shift();r&&r()}ne(this,bp,void 0),f(this,du).length>0?ot(this,dA,d6).call(this):(ne(this,pg,!1),f(this,xp)&&f(this,xp).call(this))},{timeout:3e3}))};var xWe=80,_m,mv,f6,m6,g6,bWe=class extends wi{constructor(t){super(),S(this,"rendererState"),S(this,"outlineOpacitiesDirty",!0),S(this,"useIdleFramesOnly",!0),K(this,_m,!0),K(this,mv,-1/0),S(this,"idleBuildQueue",new p6),S(this,"idleComputeBoundingSphereQueue",new p6),K(this,f6,new Map),K(this,m6,new _We({vertexColors:!0,linewidth:1,transparent:!0,opacity:1,side:_s})),K(this,g6,()=>{this.publish("needs-render")}),this.rendererState=t,this.idleBuildQueue.onComplete(f(this,g6))}get geometries3DDirty(){return f(this,_m)}set geometries3DDirty(t){ne(this,_m,t)}buildOutlines(t){var e;let r=[];for(let h of t.userData.entities3D.values()){let d=this.rendererState.geometry3DMap.get(h);if(d instanceof Cn&&d.type==="geometry"&&d.components[3]&&d.components[3].dirty===!0&&d.components[0].material!=null){let p=d.components[0].geometry,m=!1;p||(p=tre(d.components[0]),m=!0);let y=d.components[1];r.push([d.components[3],new Iae(p,(e=y.bevel)!=null&&e.enabled?1:xWe)]),m&&(p?.dispose(),p=void 0)}}if(r.length===0)return;let n=vd(r.map(h=>h[1]),!1);if(n==null)return;let i=n.getAttribute("position"),a=new Float32Array(i.count*4),o=new Xn(a,4);n.setAttribute("color",o);let s=new Uint8Array(i.count);s.fill(0);let l=new Xn(s,1,!1);n.setAttribute("visibility",l);let u=0;for(let h=0;h<r.length;h++){let[d,p]=r[h],m=p.getAttribute("position").count;d.edgeColors=o,d.edgeVisibility=l,d.geometry=n,d.ranges={count:m,start:u},u+=m,p.dispose()}let c=new AP(n,f(this,m6));c.userData.isOutline=!0,t.add(c)}update(t,e=!0){var r;let n;if(this.geometries3DDirty){for(let a of this.rendererState.geometry3DIdsInScene){let o=this.rendererState.geometry3DMap.get(a);o instanceof _o&&mWe(o,this.rendererState)&&!fWe(o)&&o.userData.entities3D.size>0&&(this.useIdleFramesOnly?this.idleBuildQueue.add(()=>this.buildOutlines(o)):this.buildOutlines(o))}ne(this,_m,!1),this.outlineOpacitiesDirty=!0}for(let a of this.rendererState.geometry3DIdsInScene){let o=this.rendererState.geometry3DMap.get(a);if(o instanceof Cn&&o.type==="geometry"&&o.components[3]&&o.components[3].dirty===!0&&o.components[0].material!=null&&o.parentObject3D instanceof _o){let s=o.components[3].geometry;if(!s)continue;let l=o.components[3];if(!l)continue;let u=l.enabled&&o.components[1].visible;if(l.visible!==u&&(l.visible=u),!l.visible)continue;let c=l.edgeColors;if(!c||!l.ranges)continue;let h=new jt(l.color);for(let y=0;y<l.ranges.count;y++){let v=l.ranges.start+y;c.setXYZ(v,h.r,h.g,h.b)}let d=o.components[1].height,p=o.components[1].altitude,m=(r=o.components[1])==null?void 0:r.bevel;ere(s,l.ranges,d,p,m),s.attributes.color.needsUpdate=!0,this.idleComputeBoundingSphereQueue.add(()=>s.computeBoundingSphere()),l.dirty=!1}}let i=e?m5(t,16,19,0,1):f(this,mv);if((i!==f(this,mv)||this.outlineOpacitiesDirty)&&this.rendererState.geometry3DIdsInScene.size>0){for(let a of this.rendererState.geometry3DIdsInScene)if(n=this.rendererState.geometry3DMap.get(a),n?.type==="geometry"&&n.components[0]instanceof Xa){let o=n.components[3];if(o&&o.edgeColors&&o.geometry&&o.visible){let s=Math.min(i,n.components[1].opacity*Gk(n));if(o.currentOpacity!==s){for(let l=0;l<o.ranges.count;l++){let u=o.ranges.start+l;o.edgeColors.setW(u,s)}o.geometry.attributes.color.needsUpdate=!0}}}}ne(this,mv,i),ne(this,_m,!1),this.outlineOpacitiesDirty=!1}destroy(){f(this,f6).clear(),this.idleBuildQueue.clearAll(),this.idleComputeBoundingSphereQueue.clearAll()}};_m=new WeakMap,mv=new WeakMap,f6=new WeakMap,m6=new WeakMap,g6=new WeakMap;C();C();var wWe=class extends Er{constructor(){super(...arguments),S(this,"userData",{entityId:""})}},AWe=Nr({flipImageToFaceCamera:Lr().optional(),url:mr()}),SWe=Nr({type:Pa(["Feature"]),properties:Nr({width:pt(),height:pt(),rotation:pt().min(0).max(360).optional(),verticalOffset:pt().optional()}),geometry:lB});function EWe(t,e,r){zi([pt(),mr()]).parse(t),SWe.parse(e),AWe.parse(r)}var IWe=class{constructor(t){S(this,"mesh",new _0),S(this,"imageMesh"),S(this,"outline"),S(this,"type","image"),S(this,"instanceIndex",-1),S(this,"geometry"),S(this,"material"),S(this,"feature"),S(this,"position",new Q),this.feature=t}get visible(){var t,e;return(e=(t=this.mesh)==null?void 0:t.visible)!=null?e:!1}set visible(t){this.mesh&&(this.mesh.visible=t)}};C();function y6(t,e){return{x:t.x*Math.cos(e)-t.y*Math.sin(e),y:t.x*Math.sin(e)+t.y*Math.cos(e)}}function CWe(t,e){return t.map(r=>y6(r,e))}function MWe(t){let e=1/0,r=1/0,n=-1/0,i=-1/0;for(let a of t)e=Math.min(e,a.x),r=Math.min(r,a.y),n=Math.max(n,a.x),i=Math.max(i,a.y);return{minX:e,minY:r,maxX:n,maxY:i}}function TWe(t,e){let r=!1;for(let n=0,i=e.length-1;n<e.length;i=n++){let a=e[n].x,o=e[n].y,s=e[i].x,l=e[i].y;o>t.y!=l>t.y&&t.x<(s-a)*(t.y-o)/(l-o)+a&&(r=!r)}return r}function rre(t,e,r,n,i){for(let a=0;a<i;a++)for(let o=0;o<n;o++)if(t[r+a][e+o]!==1)return!1;return!0}function PWe(t,e,r){let n=t.maxX-t.minX,i=t.maxY-t.minY,a,o,s=ae({},t);return n/i>e?(o=i/r,a=o*e,s.minX+=(n-a*r)/2):(a=n/r,o=a/e,s.minY+=(i-o*r)/2),{dx:a,dy:o,gridBounds:s}}function DWe(t,e,r,n,i){let a=Array(r).fill(0).map(()=>Array(r).fill(0));for(let o=0;o<r;o++)for(let s=0;s<r;s++){let l={x:e.minX+s*n,y:e.minY+o*i};TWe(l,t)&&(a[o][s]=1)}return a}function kWe(t,e){let r=Array(e).fill(0).map(()=>Array(e).fill(0));for(let n=0;n<e;n++)for(let i=0;i<e;i++)if(t[n][i]===1){let a=0;for(let o=1;o<=Math.min(e-i,e-n)&&rre(t,i,n,o,o);o++)a=o;r[n][i]=a}return r}function OWe(t,e,r,n,i,a){let o=0,s=0,l=0;for(let u=0;u<n;u++)for(let c=0;c<n;c++)if(t[u][c]===1){let h=Math.pow(e[u][c],2),d=r.minX+c*i,p=r.minY+u*a;o+=h,s+=d*h,l+=p*h}return{x:s/o,y:l/o}}function BWe(t,e,r,n,i,a,o){let s=-1/0,l=null,u=t.length,c=Math.sqrt(Math.pow(e.maxX-e.minX,2)+Math.pow(e.maxY-e.minY,2));for(let h=0;h<u;h++)for(let d=0;d<u;d++)if(t[h][d]===1)for(let p=1;p<=u-d;p++){let m=p;if(!(m>u-h)&&rre(t,d,h,p,m)){let y=p*m,v=e.minX+(d+p/2)*r,_=e.minY+(h+m/2)*n,w={x:v,y:_},b=Math.sqrt(Math.pow(w.x-i.x,2)+Math.pow(w.y-i.y,2))/c,A=y*(1-a)-b*a*y;A>s&&(s=A,l={center:w,width:p*r*o,height:p*n*o})}}return l}function wL(t,e,r,n={}){let{scaleFactor:i=.9,centerPriority:a=.5,resolution:o=100,minimumSizeRatio:s=.5}=n,l=i1(r),u=t.width/t.height,c=CWe(e,l),h=MWe(c),{dx:d,dy:p,gridBounds:m}=PWe(h,u,o),y=DWe(c,m,o,d,p),v=kWe(y,o),_=OWe(y,v,m,o,d,p),w=BWe(y,m,d,p,_,a,i);return!w||w.width<t.width*s||w.height<t.height*s?t:lt(ae({},w),{center:y6(w.center,-l),rotation:r,polygonCenter:y6(_,-l)})}var Ay=Math.PI*2,zWe=Math.PI/2,FWe=Math.PI*1.5,RWe=Ip(zWe,2),LWe=Ip(FWe,2),NWe=.01,$We=!1,UWe=class extends wi{constructor(t,e,r,n=0,i=0,a={}){super(),S(this,"rendererState"),S(this,"convertTo3DMapPosition"),S(this,"projectToScreen"),S(this,"initialBearing",0),S(this,"naturalBearing",0),S(this,"imagePlacementOptions"),S(this,"cameraFrustum",new h0),S(this,"imageLoadingCache",new Map),S(this,"currentImageScreenBBoxes",[]),S(this,"viewProjectionMatrix",new gr),this.rendererState=t,this.convertTo3DMapPosition=e,this.projectToScreen=r,this.initialBearing=n,this.naturalBearing=i,this.imagePlacementOptions=a}createImageMesh(t,e,r,n=0,i,a){var o,s,l;let u={width:r.width,height:r.height,center:this.convertTo3DMapPosition(i),rotation:(o=r.rotation)!=null?o:0},c=(s=this.imagePlacementOptions.mode)!=null?s:"default",h=(()=>{switch(c){case"fit-nearest-90":let y=(this.initialBearing-this.naturalBearing+360)%180;return y>=45&&y<=135?wL(u,a,u.rotation+90,this.imagePlacementOptions):u;case"fit-initial-bearing":return wL(u,a,this.initialBearing,this.imagePlacementOptions);case"default":case"none":default:return u}})(),d=new PC({transparent:!0,depthWrite:!1,side:po}),p=new yd(h.width,h.height),m=new wWe(p);return m.visible=!1,m.renderOrder=rd.IMAGE_MESH,(l=this.getOrDownloadImage(e))==null||l.then(y=>{d.map=y,d.needsUpdate=!0,d.map.colorSpace=Za,m.visible=!0,this.publish("image-loaded")}),m.userData.entityId=t,m.material=d,m.position.set(h.center.x,h.center.y,n+NWe),m.rotation.z=(-In.degToRad(h.rotation)+Ay)%Ay,m}getOrDownloadImage(t){var e;if(this.imageLoadingCache.has(t))return(e=this.imageLoadingCache.get(t))==null?void 0:e.promise;{let r=new Promise(n=>{hS.getLoader().load(t,i=>{let a=this.imageLoadingCache.get(t);a&&!a.loaded&&(a.loaded=!0),n(i)})});return this.imageLoadingCache.set(t,{loaded:!1,promise:r}),r}}flipIfNeeded(t,e){if(t.imageMesh==null)return;let r=-e,n=t.imageMesh.rotation.z,i=Ip((n-r+Ay)%Ay,2);i>RWe&&i<LWe&&(t.imageMesh.rotation.z=(n+Math.PI)%Ay)}update(t){var e,r,n,i,a;this.currentImageScreenBBoxes=[],this.viewProjectionMatrix.identity().multiply(this.rendererState.cameraObject.projectionMatrix).multiply(this.rendererState.cameraObject.matrixWorldInverse),this.cameraFrustum.setFromProjectionMatrix(this.viewProjectionMatrix);let o,s,l;for(let u of this.rendererState.geometry3DIdsInScene)if(o=this.rendererState.geometry3DMap.get(u),o?.type==="image"){if(s=o.components[0],l=o.components[1],l.url&&s.imageMesh==null){let c=this.convertTo3DMapPosition(s.feature.geometry.coordinates),h={x:c.x,y:c.y};s.imageMesh=this.createImageMesh(o.id,l.url,s.feature.properties,s.feature.properties.verticalOffset,s.feature.geometry.coordinates,[h]),s.mesh.add(s.imageMesh),s.position.copy(s.imageMesh.position)}s.imageMesh&&(l.flipImageToFaceCamera&&this.flipIfNeeded(s,t),s.imageMesh.material instanceof PC&&l.dirty&&(s.imageMesh.material.opacity=l.opacity))}else if(o?.type==="geometry"){if(s=o.components[0],l=o.components[1],l.showImage&&(e=s.feature.properties)!=null&&e.image&&s.imageMesh==null&&s.visible&&s.mesh!=null&&s.mesh.parent!=null&&((r=s.feature.properties)==null?void 0:r.image.position)!=null&&s.feature.geometry.coordinates!=null&&s.feature.geometry.coordinates.length>0){let c=s.feature.geometry.coordinates[0].map(d=>{let p=this.convertTo3DMapPosition(d);return{x:p.x,y:p.y}}),h=this.createImageMesh(u,(n=s.feature.properties)==null?void 0:n.image.path,(i=s.feature.properties)==null?void 0:i.image,l.height,(a=s.feature.properties)==null?void 0:a.image.position,c);s.mesh.parent.add(h),s.imageMesh=h}if(s.imageMesh){if(!s.visible)s.imageMesh.visible=!1;else if(l.showImage&&!s.imageMesh.visible)if(l.url){let c=this.imageLoadingCache.get(l.url);c&&c.loaded&&(s.imageMesh.visible=!0)}else s.imageMesh.visible=!0;else!l.showImage&&s.imageMesh.visible&&(s.imageMesh.visible=!1);l.flipImageToFaceCamera&&this.flipIfNeeded(s,t),l.enableImageCollisions===!0&&this.updateImageScreenBBoxes(s)}}}updateImageScreenBBoxes(t){if(t.imageMesh==null)return;let e=t.imageMesh.geometry.boundingBox;if(e!=null){let r=new Q;if(t.imageMesh.getWorldPosition(r),!this.cameraFrustum.containsPoint(r))return;let n=new Je;this.projectToScreen(n,r);let i=[new Q(e.min.x,e.min.y,e.min.z),new Q(e.max.x,e.min.y,e.min.z),new Q(e.min.x,e.max.y,e.min.z),new Q(e.max.x,e.max.y,e.min.z),new Q(e.min.x,e.min.y,e.max.z),new Q(e.max.x,e.min.y,e.max.z),new Q(e.min.x,e.max.y,e.max.z),new Q(e.max.x,e.max.y,e.max.z)],a=[];for(let h of i){let d=h.clone().applyMatrix4(t.imageMesh.matrixWorld),p=new Je;this.projectToScreen(p,d),a.push(p)}let o=1/0,s=1/0,l=-1/0,u=-1/0;for(let h of a)o=Math.min(o,h.x),s=Math.min(s,h.y),l=Math.max(l,h.x),u=Math.max(u,h.y);let c=new vn(n.x,n.y,l-o,u-s);this.currentImageScreenBBoxes.push(c)}}};C();var jWe=250,Kd,VWe=class extends wi{constructor(t,e){super(),S(this,"cameraDirty",!0),S(this,"focusablesDirty",!0),S(this,"state"),S(this,"camera"),S(this,"debugEl",null),S(this,"raycasters",[]),S(this,"collisions",new Map),S(this,"focusableEntities",new Set),S(this,"debugRaycasters",!1),K(this,Kd),S(this,"update",(r=!1,n=Date.now())=>{this.focusablesDirty&&this.updateFocusableEntities(),!r&&(Date.now()-n>jWe||(f(this,Kd)&&cancelAnimationFrame(f(this,Kd)),ne(this,Kd,requestAnimationFrame(()=>{this.updateRaf()}))))}),this.state=t,this.camera=e,this.buildRaycasters()}resize(){this.buildRaycasters()}buildRaycasters(){this.debugEl&&this.debugEl.remove();let t=new Je(this.state.canvasWidth/2,this.state.canvasHeight/2),e=new Je(t.x/1.2,t.y/1.2),r=new Je(t.x+(t.x-e.x),e.y),n=new Je(e.x,t.y+(t.y-e.y)),i=new Je(r.x,n.y),a=new Je(t.x,t.y/1.5),o=new Je(t.x,t.y+(t.y-a.y));this.debugEl=document.createElement("div"),Object.assign(this.debugEl.style,{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",pointerEvents:"none"}),document.body.append(this.debugEl),this.raycasters=[t,a,o,e,r,n,i].map((s,l)=>{if(this.debugRaycasters){let p=document.createElement("div");p.style.position="absolute",p.style.top=s.y+"px",p.style.left=s.x+"px",p.style.width="10px",p.style.height="10px",p.style.backgroundColor="red",this.debugEl.append(p)}let u=s.x/this.state.canvasWidth*2-1,c=-(s.y/this.state.canvasHeight)*2+1,h=new Je(u,c),d=new G1;return d.setFromCamera(h,this.camera),[d,h,l===0?10:l<7?2:1]})}updateFocusableEntities(){this.focusableEntities.clear();let t,e,r;for(let n of this.state.geometry3DIdsInScene)if(r=this.state.geometry3DMap.get(n),r!=null){if(r.type==="group-container"&&r.components[1]!==void 0&&r.components[1]instanceof j4){if(e=r.components[1],e.dirty===!0||e.focusMesh==null){e.focusMesh&&ya(e.focusMesh);let i=new qn;i.setFromObject(r);let a=i.max.x-i.min.x,o=i.max.y-i.min.y,s=i.max.z-i.min.z;if(!isFinite(a)||!isFinite(o)||!isFinite(s)||isNaN(a)||isNaN(o)||isNaN(s)||a<=0||o<=0||s<=0)continue;let l=new od(a,o,s),u={transparent:!0,opacity:this.debugRaycasters?1:0,visible:this.debugRaycasters};if(this.debugRaycasters){let d=["red","green","blue","yellow","purple","orange","pink","brown","gray","black"];u.color=d[Math.floor(Math.random()*d.length)]}let c=new Go(u),h=new Er(l,c);h.position.set((i.min.x+i.max.x)/2,(i.min.y+i.max.y)/2,0),h.userData={entityId:r.userData.entityId},e.focusMesh=h,r.add(h),r.components[1].dirty=!1}this.focusableEntities.add(e.focusMesh)}else if(r.type==="geometry"&&r.components[4]&&r.components[4]instanceof j4&&(t=r.components[0],e=r.components[4],t instanceof Xa&&t.geometry!=null&&(e.dirty===!0||e.focusMesh==null))){if(e.focusMesh==null){let i=new Er(t.geometry);i.userData={entityId:r.id},e.focusMesh=i}this.focusableEntities.add(e.focusMesh)}}this.focusablesDirty=!1}updateRaf(){if(this.focusableEntities.size===0){this.publish("geometry-in-focus",[]);return}this.cameraDirty&&this.raycast()}raycast(){this.collisions.clear();for(let[e,r]of this.raycasters)e.setFromCamera(r,this.camera);for(let[e,r,n]of this.raycasters)e.intersectObjects(Array.from(this.focusableEntities.values())).forEach(i=>{var a;if(i?.object!=null&&"isMesh"in i.object&&i!=null&&i.object.isMesh){let o=i.object.userData.entityId,s=(a=this.collisions.get(o))!=null?a:0;this.collisions.set(o,s+n)}});let t=Array.from(this.collisions,([e,r])=>({entityId:e,weight:r})).sort((e,r)=>r.weight-e.weight).map(({entityId:e})=>e);this.publish("geometry-in-focus",t),this.cameraDirty=!1}showRaycasters(){this.debugRaycasters=!0,this.buildRaycasters()}hideRaycasters(){this.debugRaycasters=!1,this.buildRaycasters()}destroy(){f(this,Kd)&&cancelAnimationFrame(f(this,Kd)),this.debugEl&&this.debugEl.remove(),this.collisions.clear(),this.focusableEntities.clear(),this.raycasters=[]}};Kd=new WeakMap;C();C();C();C();function v6(t,e){e===void 0&&(e={});var r=oS(t);switch(!e.properties&&t.type==="Feature"&&(e.properties=t.properties),r.type){case"Polygon":return GWe(r,e);case"MultiPolygon":return ZWe(r,e);default:throw new Error("invalid poly")}}function GWe(t,e){e===void 0&&(e={});var r=oS(t),n=r.coordinates,i=e.properties?e.properties:t.type==="Feature"?t.properties:{};return nre(n,i)}function ZWe(t,e){e===void 0&&(e={});var r=oS(t),n=r.coordinates,i=e.properties?e.properties:t.type==="Feature"?t.properties:{},a=[];return n.forEach(function(o){a.push(nre(o,i))}),L4(a)}function nre(t,e){return t.length>1?tTe(t,e):$g(t[0],e)}function WWe(t,e){var r=!0;return Gp(t,function(n){Gp(e,function(i){if(r===!1)return!1;r=HWe(n.geometry,i.geometry)})}),r}function HWe(t,e){switch(t.type){case"Point":switch(e.type){case"Point":return!JWe(t.coordinates,e.coordinates);case"LineString":return!AL(e,t);case"Polygon":return!s0(t,e)}break;case"LineString":switch(e.type){case"Point":return!AL(t,e);case"LineString":return!XWe(t,e);case"Polygon":return!SL(e,t)}break;case"Polygon":switch(e.type){case"Point":return!s0(e,t);case"LineString":return!SL(t,e);case"Polygon":return!qWe(e,t)}}return!1}function AL(t,e){for(var r=0;r<t.coordinates.length-1;r++)if(YWe(t.coordinates[r],t.coordinates[r+1],e.coordinates))return!0;return!1}function XWe(t,e){var r=sS(t,e);return r.features.length>0}function SL(t,e){for(var r=0,n=e.coordinates;r<n.length;r++){var i=n[r];if(s0(i,t))return!0}var a=sS(e,v6(t));return a.features.length>0}function qWe(t,e){for(var r=0,n=t.coordinates[0];r<n.length;r++){var i=n[r];if(s0(i,e))return!0}for(var a=0,o=e.coordinates[0];a<o.length;a++){var s=o[a];if(s0(s,t))return!0}var l=sS(v6(t),v6(e));return l.features.length>0}function YWe(t,e,r){var n=r[0]-t[0],i=r[1]-t[1],a=e[0]-t[0],o=e[1]-t[1],s=n*o-i*a;return s!==0?!1:Math.abs(a)>=Math.abs(o)?a>0?t[0]<=r[0]&&r[0]<=e[0]:e[0]<=r[0]&&r[0]<=t[0]:o>0?t[1]<=r[1]&&r[1]<=e[1]:e[1]<=r[1]&&r[1]<=t[1]}function JWe(t,e){return t[0]===e[0]&&t[1]===e[1]}var KWe=WWe;function QWe(t,e){var r=!1;return Gp(t,function(n){Gp(e,function(i){if(r===!0)return!0;r=!KWe(n.geometry,i.geometry)})}),r}var eHe=5e3,Qd,ga,vw,Zv,Hh,_6,gv,ml,yv,x6,b6,w6,vv,A6,_v,xm,ire,S6,_w,tHe=class{constructor(t){K(this,vv),K(this,Qd,!0),K(this,ga),S(this,"idleQueue",new p6),K(this,vw,""),K(this,Zv,new Set),K(this,Hh,new Set),K(this,_6),K(this,gv),K(this,ml,null),K(this,yv,!1),K(this,x6,e=>{if(!f(this,ga))throw new Error("Map not initialized");let r=[[e[0],e[1]],[e[2],e[1]],[e[2],e[3]],[e[0],e[3]]].map(s=>f(this,ga).project(s)),n=Math.max(...r.map(s=>s.x)),i=Math.min(...r.map(s=>s.x)),a=Math.max(...r.map(s=>s.y)),o=Math.min(...r.map(s=>s.y));return[new E8.default(i,o),new E8.default(n,a)]}),K(this,b6,()=>{f(this,ml)&&(clearTimeout(f(this,ml)),ne(this,ml,null),ne(this,Qd,!1))}),K(this,w6,()=>{f(this,ml)&&(clearTimeout(f(this,ml)),ne(this,ml,null)),ne(this,ml,setTimeout(()=>{f(this,b6).call(this)},eHe))}),K(this,_v,async()=>{if(!(!f(this,ga)||!f(this,yv))&&f(this,Qd)&&!(!f(this,Hh)||f(this,Hh).size===0)&&(f(this,vv,ire)&&f(this,S6).call(this),f(this,gv))){let e=new Set;this.idleQueue.onComplete(()=>{f(this,xm).length>0&&(f(this,Hh).forEach(r=>{var n;(n=f(this,ga))==null||n.setFilter(r,["all",...f(this,xm)])}),ne(this,Qd,!1)),ne(this,xm,[])});for(let r of f(this,gv)){let n=p_(r),i=f(this,x6).call(this,n),a=f(this,ga).queryRenderedFeatures(i,{layers:Array.from(f(this,Hh))});for(let o of a)o.id==null||e.has(o.id)||this.idleQueue.add(()=>{if(o.geometry!=null&&"coordinates"in o.geometry){let s;if(o.geometry.type==="Polygon"?s=rI(o.geometry.coordinates):o.geometry.type==="MultiPolygon"&&(s=rTe(o.geometry.coordinates)),!s)return;QWe(r,s)&&o.id!=null&&(e.add(o.id),f(this,xm).push(["!=",["id"],o.id]))}})}}}),K(this,xm,[]),K(this,S6,()=>{this.idleQueue.clearAll()}),K(this,_w,e=>{var r,n;if(f(this,ga)&&e&&e.dataType==="style"&&e.type==="styledata"&&f(this,Zv).size>0){let i=(n=(r=e?.style)==null?void 0:r.stylesheet)==null?void 0:n.id;(!i||i!==f(this,vw))&&(ne(this,vw,i),ot(this,vv,A6).call(this),ne(this,Qd,!0))}}),t&&(ne(this,ga,t),f(this,ga).on("styledata",f(this,_w)),f(this,ga).on("render",f(this,_v)),ne(this,yv,f(this,ga).loaded()),f(this,ga).on("load",()=>{ne(this,yv,!0)}))}hideLayersIntersectingPolygons(t,e,r){f(this,ml)&&clearTimeout(f(this,ml)),f(this,w6).call(this),ne(this,_6,t),ne(this,gv,e.reduce((n,i)=>{if(i.geometry.type==="Polygon"){let a=rI(i.geometry.coordinates);n.push(a)}else i.geometry.type==="MultiPolygon"&&n.push(...i.geometry.coordinates.map(a=>rI(a)));return n},[]));for(let n of r)f(this,Zv).add(n);ne(this,Qd,!0),ot(this,vv,A6).call(this),f(this,_v).call(this)}destroy(){f(this,ga)&&(f(this,ga).off("styledata",f(this,_w)),f(this,ga).off("render",f(this,_v))),this.idleQueue.clearAll()}};Qd=new WeakMap,ga=new WeakMap,vw=new WeakMap,Zv=new WeakMap,Hh=new WeakMap,_6=new WeakMap,gv=new WeakMap,ml=new WeakMap,yv=new WeakMap,x6=new WeakMap,b6=new WeakMap,w6=new WeakMap,vv=new WeakSet,A6=function(){if(ne(this,Hh,new Set),f(this,ga))for(let t of f(this,Zv))f(this,ga).getLayer(t)&&f(this,Hh).add(t)},_v=new WeakMap,xm=new WeakMap,ire=function(){return this.idleQueue.size!==0},S6=new WeakMap,_w=new WeakMap;C();C();C();C();var II=`attribute float pathDistance;
attribute vec3 pathNormal;
attribute vec3 pathTangent;


uniform vec2 uvScale;
uniform float vertexes;
uniform float complete;
uniform float nearRadius;
uniform float farRadius;
uniform float nearZoom;
uniform float farZoom;
uniform float pulse;
uniform float pulseLength;
uniform bool pathIsVertical;
uniform bool displayArrowsOnPath;
uniform vec2 cameraParameters;

varying float zoomLevel;
varying float radius;
varying vec2 fragTexcoord;
varying float fragTopTextureU;
varying float fragPathDistance;

uniform float highlightStartFraction;
uniform float highlightEndFraction;
uniform float highlightCompleteFraction;
uniform float highlightWidthMultiplier;
uniform vec3 highlightColor;

float flattenFactor = 0.0;
// Map the x value from the range [xMin, xMax] to the range [yMin, yMax] using
// linear interpolation/extrapolation.
//
// This performs a pure linear mapping y = mx + b where
// 'm = (yMax - yMin) / (xMax - xMin)',
// 'b = -xMin * (yMax - yMin) / (xMax - xMin) + yMin'.
float remap(float x, float xMin, float xMax, float yMin, float yMax) {
	return (x - xMin) / (xMax - xMin) * (yMax - yMin) + yMin;
}

// Map the x value from [xMin, xMax] to the range [yMin, yMax] using linear
// interpolation, clamping result values outside [yMin, yMax].
float clampRemap(float x, float xMin, float xMax, float yMin, float yMax) {
	return clamp(remap(x, xMin, xMax, yMin, yMax), yMin, yMax);
}

void main() {
	fragPathDistance = pathDistance;

	// We can get an origin point for the cross-section of the path by
	// subtracting the surface normal times the radius, since the surface normal
	// points strictly away from the centre.
	vec3 origin = position - nearRadius * normal;
	
	// Inflate the path along its surface normal to increase its radius from
	// 'nearRadius' to 'farRadius' when the camera is at 'farZoom'.
	vec3 adjustedPosition = position;
	zoomLevel = clampRemap(cameraParameters.x, nearZoom, farZoom, 0.0, 1.0);

	// expansion factor uses the zoom level to increase/decrease the radius
	// for fixed widths, this number is ZERO
	float expansionFactor = (farRadius - nearRadius) * zoomLevel;

	adjustedPosition += normal * expansionFactor;


	// TODO: optimize by removing branching
	bool isHighlighted = fragPathDistance >= highlightStartFraction && fragPathDistance <= (highlightEndFraction * highlightCompleteFraction);
	// adjust the color based on the highlight but only if the fragment is within the highlight start and end
	if (isHighlighted) {
		// we have to subtract 1., don't ask why
		adjustedPosition += normal * (highlightWidthMultiplier - 1.) / 2.;
	}
	

	// Determine how far the path extends "up" or "down" in the direction of the
	// path normal.
	float height = dot(adjustedPosition - origin, pathNormal);

	// For horizontal paths, flatten the bottom half entirely so that it's flat
	// against the floor. This makes the path look nicer when it's
	// semitransparent behind opaque geometry, so you don't see it
	// peeking through. For vertical paths, preserve the full tube geometry.
	if (!pathIsVertical) {
		float desiredHeight = max(height, 0.0);
		desiredHeight = desiredHeight * flattenFactor;
		float flattenMagnitude = height - desiredHeight;
		adjustedPosition = adjustedPosition - pathNormal * flattenMagnitude;
	}

	// Transform the vertices into NDC.
	vec4 mvPosition = modelViewMatrix * vec4(adjustedPosition, 1.0);
	gl_Position = projectionMatrix * mvPosition;

	fragTexcoord = uv;

	// Compute a texture coordinate for mapping the arrow texture to the path.
	// We don't want to use the u-value that Three.js provides, because the
	// path may end up twisting arbitrarily -- but we want the arrow texture to
	// always be on the top of the path.
	vec3 bitangent = cross(normal, pathTangent);
	fragTopTextureU = -dot(bitangent, pathNormal) * 0.5 + 0.5;
	// adjust the color based on the highlight but only if the fragment is within the highlight start and end
	if (isHighlighted) {
		// TODO: fix scaling
		fragTopTextureU = -dot(bitangent, pathNormal * highlightWidthMultiplier) * 0.5 + 0.5;
	}

	radius = mix(nearRadius, farRadius, zoomLevel);
}
`;C();var EL=`#define ARROW_FADING_POINT 0.15

uniform float complete;
uniform float nearRadius;
uniform float farRadius;
uniform vec2 resolution;
uniform vec2 cameraParameters;
uniform vec3 color;
uniform float pathLength;
uniform bool showPulse;
uniform vec3 pulseColor;
uniform float pulse;
uniform float pulseLength;
uniform bool pathIsVertical;
uniform bool displayArrowsOnPath;
uniform float arrowAnimationTimer;
uniform float opacityMultiplier;
uniform bool dashed;
uniform sampler2D arrowTexture;

varying float zoomLevel;
varying float radius;
varying vec2 fragTexcoord;
varying float fragTopTextureU;
varying float fragPathDistance;


uniform float highlightStartFraction;
uniform float highlightEndFraction;
uniform float highlightCompleteFraction;
uniform vec3 highlightColor;

// How long the arrow should be, as a factor of pathRadius. Since we've
// mostly flattened the top of the path, values near 2.0 (the diameter)
// will probably look best.
const float arrowLength = 2.0;

// How much of a relative margin the arrow texture should have inside the
// area laid out for it. Useful to pull the arrow away from the edges of the
// path, which slope down.
const float arrowMargin = 0.1;

// How many arrow-lengths of space should be between arrows on a short path.
const float arrowSpacingOnShortPath = 6.0;

// How many arrow-lengths of space should be between arrows on a long path.
const float arrowSpacingOnLongPath = 7.5;

// How long a path must be to be considered "long", as a factor of
// the path radius.
const float longPathLength = 200.;

// How long a path must be to be considered "short", as a factor of the
// path radius.
const float shortPathLength = 75.;

// How much of the path's length the fade-in should comprise when going from
// zero opacity to full opacity.
const float completeLength = 0.1;

// Map the x value from the range [xMin, xMax] to the range [yMin, yMax] using
// linear interpolation/extrapolation.
//
// This performs a pure linear mapping 'y = mx + b' where
// 'm = (yMax - yMin) / (xMax - xMin)',
// 'b = -xMin * (yMax - yMin) / (xMax - xMin) + yMin'.
float remap(float x, float xMin, float xMax, float yMin, float yMax) {
	return (x - xMin) / (xMax - xMin) * (yMax - yMin) + yMin;
}

// Map the x value from [xMin, xMax] to the range [yMin, yMax] using linear
// interpolation, clamping result values outside [yMin, yMax].
float clampRemap(float x, float xMin, float xMax, float yMin, float yMax) {
	return clamp(remap(x, xMin, xMax, yMin, yMax), yMin, yMax);
}

void main(void) {
	// Compute the opacity of the path based on the distance from the current
	// fragment to the 'complete' value as it varies from 0.0 to 1.0.
	// Fragments that are at the 'complete' value or past it will be fully
	// transparent, while fragments that are at 'complete - completeLength'
	// or before it will be fully opaque. However, we adjust the 'complete'
	// value here so that it overshoots by one full 'completeLength', so that
	// the entire path will be opaque when the 'complete' value is at 1.0.
	float completeLocation = complete * (1.0 + completeLength);
	float completeAmount = clampRemap(
		fragPathDistance,
		completeLocation - completeLength,
		completeLocation,
		0.0,
		1.0
	);
	float opacity = 1.0 - smoothstep(0.0, 1.0, completeAmount);

	// 2020/01/09 Terence Dickson
	// When we render the background and overlay for the mapbox outdoor context
	// behind everything else in single-buffer rendering, the fact that the path
	// writes to the depth buffer means that the background and overlay will not
	// be drawn behind the path even when the path is still fading in. The effect
	// is subtle and is only visible in single-buffer rendering so this quick fix
	// prevents writes to the depth buffer for zero opacity fragments, which gets
	// rid of the most visually-offensive ghosting.
	if (opacity <= 0.0) {
		discard;
	}

	// Push in the texture coordinates so that they ramp up
	// at 'arrowMargin' instead of at zero; this remapping looks somewhat
	// like this:
	// 1 ^        ___
	//   |       /
	//   |      /
	//   |     /
	//   |    /
	//   |___/
	// 0 +---------->
	//   0   ^      1
	//       arrowMargin
	// Making the arrows narrower on the path.
	float u = fragTopTextureU;
	u = clamp(
		u * (1. / (1. - arrowMargin * 2.)) - (1. / (1. - arrowMargin * 2.) - 1.) / 2.,
		0.0,
		1.0
	);

	float arrowSpacing = clampRemap(
		pathLength,
		shortPathLength * radius,
		longPathLength * radius,
		arrowSpacingOnShortPath,
		arrowSpacingOnLongPath
	);

	// Reduce the spacing between arrows when the camera zooms out, as increasing
	// the path radius will increase the arrow size and thus be able to fit
	// fewer arrows on in total, and this secondary movement of the arrows
	// "zooming off" the end of the path is unpleasant
	float expandAmount = mix(1.0, farRadius / nearRadius, zoomLevel);
	float effectiveArrowSpacing =
		arrowSpacing * 1.0 / expandAmount +
		arrowMargin * 2.0;

	float effectiveArrowLength = arrowLength * radius * (1. - arrowMargin * 2.0);

	// Adjust the slope of the vertical texture coordinate so that it goes
	// from 0 to 1 along the length of the arrow plus the spacing between
	// arrows, and adjust its x-intercept so that one arrow moves to the
	// exact position of the next arrow as 'arrowAnimationTimer' goes
	// from 0 to 1
	float v = (
		fragTexcoord.x * (pathLength / effectiveArrowLength)
		- arrowAnimationTimer * (1. + effectiveArrowSpacing)
	);

	// Compute a "looping sawtooth" wave for determining the vertical texture
	// coordinates of the arrow texture, roughly as follows:
	// 3 ^              /
	//   |          ___/
	// 2 |         /
	//   |     ___/
	// 1 |    /
	//   |___/
	// 0 +--------------->
	//   0   ^ ^
	//   ^   |_|
	//   |   effectiveArrowLength
	//   |___|
	//   effectiveArrowSpacing
	//
	// This is effectively equivalent to this sort of sawtooth wave:
	//   ^
	// 1 |    /    /    /
	//   |___/ ___/ ___/
	// 0 +--------------->
	//
	// Causing the image of the arrow to repeat, with dead space (the bottom
	// edge of the texture stretched out) between the arrows at the provided
	// spacing. The reason why the "looping" design is preferred is because
	// it takes advantage of WebGL's 'GL_REPEAT' texture wrapping behaviour
	// to avoid the discontinuity that can end up causing visual artifacts.
	if (mod(v, (1. + effectiveArrowSpacing)) < 1.) {
		v = v - effectiveArrowSpacing * floor(v / (1. + effectiveArrowSpacing));
	} else {
		v = ceil(v / (1. + effectiveArrowSpacing));
	}

	// Use the r-component of the texture to determine whether the arrow covers
	// this fragment or not
	vec2 sampleTexcoord = vec2(u, v);
	float arrowAmount = 0.0;
	vec3 secondColor = pulseColor;

	vec3 finalColor = color;


	
	// adjust the color based on the highlight but only if the fragment is within the highlight start and end
	// [Anzor] I added 0.005 to make the highlight transition a little smoother when the width multiplier is too high
	if (fragPathDistance >= highlightStartFraction - 0.005 && fragPathDistance <= (highlightEndFraction * highlightCompleteFraction)) {
		finalColor = highlightColor;
	}


	if (displayArrowsOnPath) {
		arrowAmount = texture2D(arrowTexture, sampleTexcoord).r;
		float delta = 1.0 - abs(fragPathDistance * 2.0 - 1.0);
		secondColor = mix(finalColor, pulseColor, 1.0 - smoothstep(ARROW_FADING_POINT, 0.0, delta));
	}

	if (dashed) {
		float dashLength = 0.1; // Adjust this value to change the dash length
		float gapLength = 0.1; // Adjust this value to change the gap length
		float totalLength = dashLength + gapLength;
		float numSegments = ceil(1.0 / totalLength);
		float adjustedTotalLength = 1.0 / numSegments;
		float adjustedDashLength = adjustedTotalLength * (dashLength / (dashLength + gapLength));
		float pattern = mod(fragPathDistance, adjustedTotalLength);
		opacity = pattern < adjustedDashLength ? 1.0 : 0.0;
	}



	if (showPulse) {
		// Add the pulse color to the path by determining how far the current fragment
		// is from 'pulse'
		float pulseLocation = remap(
		pulse,
		0.0,
		1.0,
		-pulseLength,
		1.0 + pulseLength
		);
		float pulseDistance = smoothstep(
		0.0,
		pulseLength,
		abs(fragPathDistance - pulseLocation)
		);

		// Blend the pulse color to the path based on how close this fragment is to
		// the 'pulse' value and whether it's covered by an arrow -- but if it's
		// covered by *both*, then we go back to using the regular path color
		// (making arrows look like "holes" when they're overlapping the pulse.)
		float pulseLevel = abs(1.0 - pulseDistance - arrowAmount);

		
		gl_FragColor = vec4(mix(finalColor, secondColor, pulseLevel), opacity * opacityMultiplier);
	} else if (displayArrowsOnPath) {
		gl_FragColor = vec4(mix(finalColor, pulseColor, arrowAmount), opacity * opacityMultiplier);
	} else {
		
		gl_FragColor = vec4(finalColor, opacity * opacityMultiplier);
	}
	#include <colorspace_fragment>
}
`;C();var rHe=`uniform float complete;
uniform float nearRadius;
uniform float farRadius;
varying float fragPathDistance;
const float completeLength = 0.1;

// Map the x value from the range [xMin, xMax] to the range [yMin, yMax] using
// linear interpolation/extrapolation.
//
// This performs a pure linear mapping 'y = mx + b' where
// 'm = (yMax - yMin) / (xMax - xMin)',
// 'b = -xMin * (yMax - yMin) / (xMax - xMin) + yMin'.
float remap(float x, float xMin, float xMax, float yMin, float yMax) {
	return (x - xMin) / (xMax - xMin) * (yMax - yMin) + yMin;
}

// Map the x value from [xMin, xMax] to the range [yMin, yMax] using linear
// interpolation, clamping result values outside [yMin, yMax].
float clampRemap(float x, float xMin, float xMax, float yMin, float yMax) {
	return clamp(remap(x, xMin, xMax, yMin, yMax), yMin, yMax);
}

void main(void) {
	// this ensures that the stencil mask moves along with the path above it, to avoid the progress bar effect
	float completeLocation = complete * (1.0 + completeLength);
	float completeAmount = clampRemap(
		fragPathDistance,
		completeLocation - completeLength,
		completeLocation,
		0.0,
		1.0
	);
	float opacity = 1.0 - smoothstep(0.0, 1.0, completeAmount);

	// 2020/01/09 Terence Dickson
	// When we render the background and overlay for the mapbox outdoor context
	// behind everything else in single-buffer rendering, the fact that the path
	// writes to the depth buffer means that the background and overlay will not
	// be drawn behind the path even when the path is still fading in. The effect
	// is subtle and is only visible in single-buffer rendering so this quick fix
	// prevents writes to the depth buffer for zero opacity fragments, which gets
	// rid of the most visually-offensive ghosting.
	if (opacity <= 0.0) {
		discard;
	}

	gl_FragColor = vec4(0.0, 1.0, 0.0, opacity);
}`,nHe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAAAAAB5Gfe6AAAQkHpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjarZpZciQ7rkT/uYpeAicQ5HI4mr0dvOX3ATOl0li3q3SVJkUqFMEBcHc4IuX2///fcf/hK7cSXRatpZXi+cott9h5U/3j63EMPt+fL1/h+fPdeff6NnJMHNPjD2U/7+qcl183aH6eH+/PO52PN7E+B3qZ+Tlgspkjb57X1edAKT7Oh+fvrj3v6/nNdp7ftd057abHnz78npVgLGG8FF3cKSTPz2oXJFaQWuocCz9D0mhnEu8Tx54k6dexc98F77vY+f48n96HwvnyvKB8iNHzfJCvY3cj9HZF4dfM7/6QZ4j+7deb2J2z6jn7sbueC5Eq7rmpl63cd1w4GCrd2wov5Vt4r/fVeFW2OMnYIpuD13ShhUi0T8hhhR5O2Pc4w2SJOe5IuGOMM6Z7rhL+FudNSrZXOFFJz3KpkqtJ1hKn4+tawp233flmqMy8AlfGwGCBOz693Fcn/+b1OtA5Bt0QfH2NFeuKFnCWYZmzn1xFQsJ5xlRufO/LvcGNf5PYRAblhrmywe7HY4gh4Re20s1z4jrx2fkHNYKu5wCEiLmFxYREBnwJSUIJXmPUEIhjJT+dlceU4yADQSSu4A65SamQnBptbu7RcK+NEh+nkRYSIZBGSQ0EIlk5C/jRXMFQlyTZiUgRlSpNekklFymlaDGN6po0q2hR1apNe001V6mlaq211d5iS0iYtNLUtdpa651JO0N37u5c0fuII408ZJSho442+gQ+M0+ZZeqss82+4koL+q+y1K262uo7bKC085Zdtu662+4HrJ108pFTjp562umvWXtm9X3WwofM/T5r4Zk1y1i+1+mvrHFa9WWIYHIiljMyFnMg42oZANDRcuZryDla5ixnvkVIIZGsBbHkrGAZI4N5hygnvObuV+Z+mzcn+Y/yFr/LnLPU/RuZc5a6Z+Y+5+2LrK1+K0q6CTIWWkx9OggbF+zaY+1Wk/766H46wF8ONFY+O8hBMEc7oc4Vdh+8JsE+PUSrVjr70Zz1+H56PH3o9sRR1ql5Ha8bUMQxpe89Tki8Sb0tE23cw3DcfEo+ugnj2G3WEmononVfoag71pVjR+EmAE53eT5tqYfEHl/7ThMusaI+St0jktFa9gKnreiQqCNpZ2mJdSkbaiK6DrovYR4/JhJfRsx5d5EVZnEIPetHnU5KynJPTSuCPuC0lOuXH7n1DNq7DpUtHbhM5lDA0c2bnDCJoOObMnyj+aPjPwx0yiDUxKKsg35VnRnBEVhonKwK5hOk5NttUrhr2+tMOXkPJb1RZ+iAelYjL2MuO3pGRQ78GdxwOOaTAcJZcewq7ilB1RJCSozUdSEdwVJVb6asiBsHH1Bqgbiv3Cmkkis6ktVnZGRRwMNJjUA3Ao2127YWdhAIblxF51hzMcZsVZc0r0dJo5Liqfn41Q+q193SGhhkMkgaLJRNnEpqBtyVvbcVffIk+LE9QPFBTMTQe0aWkMXMnx3dy5sfHreDE60Ql50E+SqRcmfK16L2p0Ol8JFATu3qASXy7SvmiGW2cdMBxsty44CvtLogfGlv7WkCSV0WId2270EaD5Ym40cs+SAwZuNjPSTywAvEfLmzQhtLDntfCnhl/fNmUNnzyA2g76Zn0SP+c+I6bCC0FONUQ4L50e95dif+DH/m9htQjBEhPPpOjYjmm2ChbfEMIUaYtAIxmWJHlilLU8ZRs9pCsHbDpFaRgZljz2QandjDIBPZDGTuoZW1KdlYh52ALzisKJRNWSQmLAWx8iv9mGttT15bBc2oxd57bZtVF98CYtK3UH22Yd/A7WaKa+ZjNTOXEzNhMJ5kmQOvfzsbxbZALJ2xwGBjX2HFQybhi7kpbA7DVpS3RxMJwFyHwGk5gs6a4lrRHVqhYT0QTJC9UZcC9Yrelkn6yXch68NKNtG7CiU3vf/zMZAYXPWdrR9XZ/ctMV1sJQ2wJEGxzaHs7LmmHIwnUwbwnNAapBY9xhE19DNJW3ua0dDk/AjwITacR0PqZxkbyJ+E5jYbxI84x1TBE+y90hwDCYZIM0tqAKPZfCzFrbH8kYCm3eqQkZ2+2GovcL8Suokyg8yyCJes6dcouSLiNSLb0ETJU+/N/WFsBBSOXBbm9Cwp4CzlOag7ro7R2vC19nSsCPmAjIEMiobFwaoVXhjTU2XMpgEsDH/L3Sx54OCTMUSXI/IIA2V4QcLQpwVz12pInI0bY56pIQ2BSGRLL+yLfZ7JkiimbK+aepsbwRStpokx5gCqe1hjdMAwcINbkk5jmedrNRAG5pUXPe0sZIoXy1h7lSDxApzheg24JeDNtDS1oBDBUC4iWZFilBPhZx0Kqx2lihpbG9q4sYidksCN4yRYhNM4nxfBbTi4E3AT6B3igbvs9Gv8ZkHsIfdlep+2HelEDbkJdNjqZQ90B7k6OIoFfkkPNoY+z0gzACa1f2qcBYxVJpT2QQgS19dKQlbC24S92xiEAFRKB5Uy1qrBgOtwIge55G0kRPfIytGx0tMOrGfrijB2FHOk/TKcMjDTMPeBo4FnXD5cQ8vtdgoAN0yuzZQHQI09wm/5vAB6RHyI9rYKiZ6YWC6rbaiLmDtoaToC1bViXQFNtgWsOfEEKCleC3GWPSfgQWRQWMgw/9FDgvOZrFAT3SmsA3DLbqlsSppQG5QeOjPXavUUkxF/qgLM05vW5o7UakuBqo2ZW8Nj0LB7imVJC9QSA+wd7RPztIUZ80xQZq0ROrc8CSVncWzkTA/RwmunldCPAQKjqVC7bhRuTIv0plbk7gOX4m5OAi2YesYZ0KBQRToG8iv9x8dgGtgECYRBeEU87OxoSc8epu+s7Mq/MN0VbBT19dii7ekO66UZwdAMtoAVQd13J5nwZe98OgGslmVqAGBkeLZNVNVlWpV18qihntXKnBZvrDIVgFpx4q5poLqREOVplMPSpTF2KvjBAzDpprkruXIaaUmUD4Xo2yrGWcYlixKIwRFjl0jPQhKznUXZAoSjlg9c/NwAI4p3Q/w5bCNfhUZS7bGfqesHqKAlyZZxZgNrhGevZXccaqBys4NEqB3Vqfptji9uUrhCL6yXFqxtm0hhLyYU3Tjd8I/HZaWD1oyVjnG5hhpCN5yHSf8BQUZlVNd00OP4M0TK+JSM7iqWi01SinFkCQXWxiZJLqqAHiEt3G3I2WYd46KU9pIJIOkoRQYCcEAAPguHo0Y4k8Hl6SW50MoW0uZU8jJOUghKo38Nl5ZSwsJNAUC2/lFZWkfMjrU8dFrTjHpJnUrLCILQIxINiYdQlDXaE/razQ4jjQluN5jW1Eh/S7yYvI5gigSjdLYU9TiFXAcHjISiLhQd9obb3OQmwY+YqVwiBMCkOGLXaK/ljBShh56c1g0uyIb2lBRKO7ZTAFncw5c5UGjGSy3CsI1Jt2mtruZkfhBZmbR+842Yu1eDiWEl0V6LZcGem6Ct+LW4Wy3oAjyNObazKBHomhJ3HMKEKHgiGksH+Ig1nTidfNMyA+oYHqVFaRGLiQreVLc9GvQgftKjW9cfUSKNYL80rqU7Um2rwqQJR1ai31Wq7vzKJEsFHDj0bAEMUKXgvfD5bWbaLPBTKz1Nk/Fg+GUZvUzFw80CLaKtPAACVAWrismh863FU4IJ0716SXBUNVb/SDMVvZgDt34CXoOq1JKvg0n08gPHTwXBNgD5W8pZZ8E9EVWcv1DZMB2NFysIwkqBSaH5QRmsAHdkHB+UANvLJvFpQKAahSmYTLEd2AFO+5rsqRRU6sVv5IP0wsSPLcWsbC1Y95mte71CUm6RJJWwkg6Q4k+xWMM0ByElJPQ6j2ED5hY42ALpZRytx9RlgQlJLijzhKi5eX5JBSIRGfo9o2xhd/0aWku8OS+4D9ZnovHDQMPaYo4qm2mlZbUnd7pR6oQj29Z2BqJ9n3LRT+MTLu3IR+ZP2TCPh3EDw8H1NHpoT7FibNYU8WHd9ESHcY12aDOQCUBddi4Ucp+4yuzz8ybcCCu1h8zvzXhDN4HYLq1R+U0xzUqg5QSA3iSBgdDouy55Ifx0DaeEhgezxBRGmoEJ6AJitVuzwtKPlUskHgU2F0LS7AFIwW5jPu0RUL7sp+fkNk0ee8P6uXYgl40WM+cdCOW21r13e0ivt0ff/mYcUfrQZWs2BiN6G+MDTGz1BKORmUTNQp9YGSHFxAeTkQrKd6FoVUogyytW25OLy3OpaO5oZCQp46aPzb5LnJiFEIwAKkmbYVYIjzVv3vj7rA6HignEeQAXTAHKDhoD7Uujh0QjtsB6fTP1NzO7T1Nzq4F1GnfHdXCG1Yxjwdtjf+PGRGTzEtEAUCz7KLfTdItLwCXuSOAzVjaZB6LvbUZhYGWmifSZlcMDnGHPd6gPeiK9erhpiw7ZP9ahTrMhFDa1J53m9ri2DloziqGETTcVSppCbTDDjExg6RrZ6cPEzB8XArEjQSB29odrUoLyoS/65RfM9fprGGjlHpbhGgbYD8MtmW1eFcAWX5dbcMHcl8sUI2k+H7GPW9VrArw3G+BefcCrCaAT/N53YLvP26Uy0kMFnDEZz0DJkmQqEOlL7SlKweYhH8gxpYeAYi0f9magqPbMYZuUI6007lSZQoyoGfYQHsNRzHXR3MMINTSMZpq1KD2A5MDJgtMLdRU6R4CEOJcKGiIJ7K6P/vAM6xpECHI8rRHsaEj6smkngAUjXTzrRoSI48ZpHOqgOY5OejKVdpnmiYUChQnVdIPa6ekGqRSRgEO119oDHOiIUQ5ciYVgaF1oG8Udo8WYtD+DEi8D/w8rAJE2k2PoyV0oMtpauxreaFjpujAvxFlwBhjuNqM9P0IfI5iD8Nh8y1kG4igjJkDNkOijnlLhItAd9lhRd670yNRTu95cR/Xuu0c5WO4DEFk5YQAPtLvU4TYPGRh4APPEDNiuuwR6SC21JoFbQBBMr+zJmT32QplNI6p16PbculN/pCX1wAyTWGTeJ774aln0gvQikw7TmkfsNbdQNs0adutYUDqNtGc0RqngUYdhUYuHSL1/eLrgvqDTC5neu++vufRkEgP9D2T64Kg/c4n+s7k3dDr3me8nOr0c72MRNmgF7D4WySPP0YAI/bI4eixwc7K13QiRiL85A8fnSsUj+mvTrsZtVUEQZ6sTpVafW8nYJZyaZS0U+0xIb6et9PhhtoObozQbjKAoDf6eiFgx1UUvpUYj1GweH0MNMrofhynfWn7+KYu7n5r83hN9aqm+6qjcH7dUlgvZVLV3xqq4fbP16qv+eofuTz43eomAqfS7GBAB9zEE31WJ37eVIPtdGN5A8nMYPvvLt8t2/V/6gM19G4g/hIL7UXf9JgbuLRZ+AoW//AzyMxTcWyz8BAruLRZ+AgX3r3y2+mT/PwfiN1DoVI+QT3CZDmvb8022JeYb6HiQPQpPPvboFB+i1MZdcqWZqthHmix6vttw0UAI1z8oEnGwVe++c7JamxslC+8xKJE41XJmug1npz+6CUAKyURd9gSxo+kWxvtZth848GBlws/0SKjYhmbZ9IiV+mcGBSdWHk8sqSr2zz5J7QME/0yD+z4Pe+JuGn1MV/vUyZwOHojWPlmPXgf9CuoeN9UAT+FGwaLg44v3dWe6QpvuL3Ln/p3k/2AgqNDcfwHgqUmIIqn+hwAAAAJiS0dEAACqjSMyAAAACXBIWXMAAAsSAAALEgHS3X78AAAAB3RJTUUH4wYRESAMujenGAAAB9FJREFUeNrtnWlsFVUUx899fS1gUoKioEY+WBRUEohGkUhAKxgEjSgGoRGB4AJCNKAIJBJZJSiyGYMKKkIoLlEUKhUraxFkKUE2kU1aCrRgW2jpg9f29R2/sBTo67v3zL2zvfP73MzM+XU6mf+5504BGIZhGIZhGIZhGIZhGMZGGq3JvSmR62++BXHH7Ylbf9ouRMT99yVq/e0PICIiHumUmPV3PooXOf5EItafXoCXOdUn8ep/pgjrUDY40ervX4JXUTEiocoXL5/FawiNEwlU/6hzeB3hqQljQIwJYT3UzEkQA2JiGOslsiAhDIgZ1RiD6NIEMBD8NIKxyQr6vv7FtdgQa31uILg0ig2zsZmv4//yePUj7rjNv/U3yUEJ/r7Xr/XfvBmlOPKwT+vfhpIUdvdj/Wm7UZpTz/mv/g4HUYGyQb5r/+SjEhXD/VV/j5OoSGisj16LRe9iVCY8xTcGxIulSKBmtk8MiKHlSMIn8ViMqkQivojHgfcuIJ0VAc/XPzmMVljrcQOBmdVojY1NvVx/8mcRtEqeh+NxypJatM6+ezxb/7Io6uBwR4/e/1moicJunvz956A2ip/1Xv3Nt6JGSgd6rf47/0KtlHssHrfZi5rxVDwWDx5C7XgoHotHC9AANbO8YqBXERohMt8bv/8X/kNDRDM9cA+IgWVojhWuNxAYXo4mWePyeBwYHUKz5Lo6HidNvICmybvVxfXPqEbz7Gvr2vrn1KAdHH7IpX//8yNoD8dcGY+TM6NoF26MxzLTL26Mx0majtM4q5ed7yhNulVsd5WAxqset/mGS6/d5CIBLXI62/7I6ZKyzjUC0rIfsP+hE3zkxt9c8vy7tPnJbiKfuyP+Xdn8ZDeuiMei+zF0juWOGyBNv+iMxw4bEBkl6CzOxmPx6ll0mryWDtb/ViU6z17H4rEYG0I3cMiheByYFEZ34Ew8Dn5UjW7BiXisY/rFDfGYmgWCCwcngXto0q08z1YBSUsy3NWgb5Qe2WSjgJRlfdy2RJPcNXm9bQIarexpsP5VdxHjcbMcm2Q3/5P64i71U8k/ELuLNsVjcct2cnST+rGg+Jo4XmhLPBZ376GOfoOkAIB5NWTHxuu/nzj9ElkA8gLgA+pLlvF43IU4/VI9G1QEAHnIPjfVaP1PnqRdVngKqAkActDMa2Hw/u9zijjjNg5UBcBr1FbD3jbG6h9QSruk8ovfyFESABnUWSNT8VgMI06/lF7aBqomAJ4n3m+G4nHgbeJfZfHljcCKAqDHcWo87m2g/gnE53LhlS+lqQqATv9S4/FL2u//qcT2T34XoAuAdvuJBspf11z/LOKbyYG6q4bqAqDVTqKByjFa21/U6ZfdaWBNADTdTDQQnqSv/pRMYjrZevVLCUUAiF+JBqpnaqv/J2I+zb3mxZwkAMTPDq8ep1A3P/1y3ZOEJABgiaPxuOnvxLN/B7oEwELq/sPl1utvSdz8VPsl6BMAn1AbBKut1t96F+3ENXOFTgFiehXRwAZL8Vi0JW5+qppW7+HIAgDGnyca2G4hHouOh2knvTARdAuAkedsj8cinTj9Ujka9AuAV87YHI/F08TNT2eHgQkB0I/aIDhGmuIU/YnnKxkAZgTAU8SGHC0eDyJufiqKfTKrAqBrPtFAiXo8HlFBO1VBA7ebZQHQifhUVo7H4p2QgQeOdQHQbp8t8Tg4idj+2dPgwJIGAdBqhw3xmDz9EuelQ4cASP3DeDwOziW+ecdbldEiACDbcDxOWkBs/8QNHpoEAPXjLNFMmfpv+IZ4+PjRU5cAWGwwHqcQNz/J2NUmAMgjavHjMfEPTGpvvz4BQH1MrzMkoHoW2CsAppEaBFskemQUA+HJYLcAeJfQINgpNVuvbiA0FuwXAG8qNwh2S07WqxqQ/saPXgEwRDGu7W8te2Q1A6XSH0HWLAD6nVa5zoPS9asZKJb/DLZuAdDzhPx1Hu2gkobkDRQq/J8w7QJAfstevuI3+WQN1F39dkAAtP9H7jpPdFVtiMgZOKC0Z9aAAEiT+mrbScLQjIyBXWngtABokRf/kKefonRF4xvYqrjmYEQApG6Md8SyvrS+eDwDG5QbzUYExL3QMxnUlZGGD5wFbhEADQ7YVwyhr401YCD6LbhHACyK3SA4N9TK6mhMA5EvwE0CYF6sBkFopLXl8exYq9/gLgHwYf3x+PxoqwMC9RoIvw9uE1D/gH3VeOsjItnSq9/OCqhvwL5qAoABA5XU28qsAHjj2tW8mukABgzEXP12WgAMvrpBEPkYwICB2KvfjguAvnUH7GvnARgwUGRhEt24gLoD9tGvAAwYKLDyySzzAqDzpQH76CIAAwYOWtqNYoMAaH9xwP57AAMG9ljbj2SHALhjJyLijwAGDGyzuCPNFgGQuhlxpfw1yR94dfAxi5cmojI/lRyx+rtaX9XDhADr2CVABc//JycWwAJYAAtgASyABbAAFsACWAALYAEsgAWwABbAAlgAC2ABLIAFsAAWwAJYAAtgASyABbAAFsACWAALYAEsgAWwABbAAlgAC2ABLIAFsAAWwAJYAAtgASyABbAAFsACWAALYAEsgAWwABbAAlgAC2ABLIAFsAAWwAJYAAtgASyABbAAFsACWIDToH8FyJUWtVWAALedDoFhGIZhGIZhGIZhGIYxyf+YwEMsIhMo/AAAAABJRU5ErkJggg==",iHe=new TN;function aHe(t,e,r){var n,i;let{breakpoint:a,width:o,accentColor:s,completeFraction:l,isVertical:u,visibleThroughGeometry:c,dashed:h,highlightCompleteFraction:d,highlightStartFraction:p,highlightEndFraction:m,highlightColor:y,highlightWidthMultiplier:v}=e,{color:_}=r,w=0,b=1/0,A=e.displayArrowsOnPath,E=!0,M=A,P=typeof o=="object"?Number(o.output[a])/2:o/2,k=typeof o=="object"?Number((n=o.output[a+1])!=null?n:o.output[a])/2:o/2,D=((i=r.altitude)!=null?i:0)+oHe,O=0;t[0].z+=D;for(let Ce=1;Ce<t.length;++Ce){t[Ce].z+=D;let Ee=t[Ce].x-t[Ce-1].x,Ne=t[Ce].z-t[Ce-1].z;if(u)O+=Math.sqrt(Ee*Ee+Ne*Ne);else{let st=t[Ce].y-t[Ce-1].y;O+=Math.sqrt(Ee*Ee+st*st+Ne*Ne)}}if(!u){let Ce=t[0],Ee=t[t.length-1];t.push(Ee.clone().setZ(Ee.z-.01)),t.unshift(Ce.clone().setZ(Ce.z-.01))}let B=new Ho;M&&(B=iHe.load(nHe),B.colorSpace=Za);let L=new jt(_),R=new jt(s),T={vertexes:{type:"f",value:1},resolution:{type:"v2",value:new Je(1,1)},cameraParameters:{type:"v2",value:new Je(w,0)},complete:{type:"f",value:0},color:{type:"c",value:L},pathLength:{type:"f",value:O},nearRadius:{type:"f",value:P},farRadius:{type:"f",value:k},nearZoom:{type:"f",value:w},farZoom:{type:"f",value:b},pulseColor:{type:"c",value:R},pulse:{type:"f",value:0},pulseLength:{type:"f",value:.075},pathIsVertical:{type:"b",value:u},arrowAnimationTimer:{type:"f",value:0},arrowTexture:{type:"t",value:B},displayArrowsOnPath:{type:"b",value:A},showPulse:{type:"b",value:E},opacityMultiplier:{type:"f",value:1},dashed:{type:"b",value:h},highlightCompleteFraction:{type:"f",value:d},highlightStartFraction:{type:"f",value:p},highlightEndFraction:{type:"f",value:m},highlightColor:{type:"c",value:new jt(y)},highlightWidthMultiplier:{type:"f",value:v}},N=new fN(t);N.curveType="catmullrom",N.tension=0;let $=30,V=8,G=$*t.length,ee=new Wae(N,G,P,V,!1),ie=new Float32Array(ee.attributes.position.count);for(let Ce=t.length;Ce<ie.length;Ce++)ie[Ce]=Ce;ee.setAttribute("vertexIndex",new Xn(ie,1));let me=new Float32Array(ee.attributes.position.count),Me=new Xn(me,1);for(let Ce=0;Ce<=G;Ce++)for(let Ee=0;Ee<=V;++Ee)Me.setX(Ce*(V+1)+Ee,Ce/G);ee.setAttribute("pathDistance",Me);let Ae=new Float32Array(ee.attributes.normal.count*3),le=new Xn(Ae,3);for(let Ce=0;Ce<G;Ce++){let Ee=ee.tangents[Ce];for(let Ne=0;Ne<=V;++Ne)le.setXYZ(Ce*(V+1)+Ne,Ee.x,Ee.y,Ee.z)}ee.setAttribute("pathTangent",le);let _e=new Float32Array(ee.attributes.normal.count*3),Le=new Xn(_e,3);for(let Ce=0;Ce<G;Ce++){let Ee=ee.tangents[Ce];var Se,Ue,Y;u?(Se=Ee.x*Ee.y,Ue=-1+Ee.y*Ee.y,Y=Ee.z*Ee.y):(Se=-Ee.x*Ee.z,Ue=-Ee.y*Ee.z,Y=1-Ee.z*Ee.z);let Ne=Math.sqrt(Se*Se+Ue*Ue+Y*Y);Ne===0&&(Ne=1);let st=Se/Ne,Ke=Ue/Ne,J=Y/Ne;for(let Z=0;Z<=V;++Z)Le.setXYZ(Ce*(V+1)+Z,st,Ke,J)}ee.setAttribute("pathNormal",Le);let we=new ys({uniforms:T,vertexShader:II,fragmentShader:EL});we.transparent=!0,we.alphaTest=.5,T.resolution.value.x=1,T.resolution.value.y=1,T.vertexes.value=ie.length,T.arrowTexture.value.wrapS=Ml,T.arrowTexture.value.wrapT=Ml,T.arrowTexture.value.anisotropy=16;let q=new Er(ee,we),oe=q.clone(),ce=lt(ae({},T),{opacityMultiplier:{type:"f",value:.25},pathIsVertical:{type:"b",value:u}});ce.complete.value=1,oe.material=new ys({uniforms:ce,vertexShader:II,fragmentShader:EL}),oe.material.transparent=!0,oe.material.alphaTest=.5,oe.material.depthWrite=!1,oe.material.depthTest=!1,ce.resolution.value.x=1,ce.resolution.value.y=1,ce.vertexes.value=ie.length,ce.arrowTexture.value.wrapS=Ml,ce.arrowTexture.value.wrapT=Ml,ce.arrowTexture.value.anisotropy=16,ce.complete.value=l,q.userData=oe.userData=e.mesh.userData;let X=e.mesh;if(!c){let Ce=new ys({uniforms:T,vertexShader:II,fragmentShader:rHe}),Ee=new Er(ee,Ce);Ee.name="stencil",Ee.material.colorWrite=!1,Ee.material.stencilWrite=!0,Ee.material.stencilRef=1,Ee.material.stencilFunc=n4,Ee.material.stencilZPass=Jm,Ee.material.stencilZFail=Jm,Ee.material.stencilFail=Jm,Ee.material.depthWrite=!1,Ee.material.depthTest=!1,Ee.userData=e.mesh.userData,X.add(Ee),X.add(oe),oe.renderOrder=0,q.renderOrder=1}if(X.add(q),u){let Ce=new qn().setFromObject(q),Ee=new Q;Ce.getCenter(Ee),X.children.forEach(Ne=>{Ne.geometry.center(),Ne.position.copy(Ee)})}c&&(q.material.stencilWrite=!0,q.material.stencilRef=1,q.material.stencilFunc=W9,q.material.stencilZPass=bc,q.material.stencilZFail=bc,q.material.stencilFail=bc,q.material.needsUpdate=!0,q.layers.disableAll(),q.layers.enable(rd.ALWAYS_ON_TOP_PATHS)),ee.computeBoundingBox();let ke=new Q;return ee.boundingBox.getCenter(ke),{mesh:X,material:we,center:ke}}var oHe=.15,sHe=.5,lHe=class extends wi{constructor(t,e,r,n){super(),S(this,"rendererState"),S(this,"verticalDistanceDirty",!0),S(this,"convertTo3DMapPosition"),S(this,"getParentContainer"),S(this,"convertZoomLevelToAltitude"),this.rendererState=t,this.convertTo3DMapPosition=e,this.getParentContainer=r,this.convertZoomLevelToAltitude=n}update(t,e,r){let n,i=!1;for(let a of this.rendererState.geometry3DIdsInScene)if(n=this.rendererState.geometry3DMap.get(a),n&&n.type==="path"&&n.components[0].type==="path"){let o=n.components[0],s=n.components[1],l=o.isVertical&&this.verticalDistanceDirty;if(!(o instanceof cw))continue;let u=[];if(o.dirty||s.dirty||l){if(o.mesh.parent!=null)for(let c=o.mesh.children.length-1;c>=0;c--)ya(o.mesh.children[0]);if(o.feature.features.length===2&&o.feature.features[0].properties.parentId&&o.feature.features[1].properties.parentId){let c=o.feature.features[0],h=o.feature.features[o.feature.features.length-1],d,p,m=c.geometry.coordinates[2]||0,y=h.geometry.coordinates[2]||0;c.properties.parentId&&(d=this.getParentContainer(c.properties.parentId,!0),d!=null&&d.altitude!=null&&(m+=d.altitude,o.isVertical=!0)),h.properties.parentId&&(p=this.getParentContainer(h.properties.parentId,!0),p!=null&&p.altitude!=null&&(y+=p.altitude,o.isVertical=!0));let v=this.convertTo3DMapPosition(c.geometry.coordinates[1],c.geometry.coordinates[0],m),_=this.convertTo3DMapPosition(h.geometry.coordinates[1],h.geometry.coordinates[0],y);Math.abs(v.z-_.z)>sHe&&d!=null&&d.visible&&p!=null&&p.visible&&(u=[v,_])}else{let c=o.feature.features;for(let h=0;h<c.length;h++)if(h===0||!dPe(c[h].geometry.coordinates,c[h-1].geometry.coordinates)){let d=this.convertTo3DMapPosition(c[h].geometry.coordinates[1],c[h].geometry.coordinates[0],c[h].geometry.coordinates[2]||0);u.push(d)}}if(u.length>1){let{mesh:c,material:h,center:d}=aHe(u,o,{color:s.color,altitude:s.altitude,isVertical:o.isVertical});o.mesh=c,o.material=h,o.position=d}o.dirty&&typeof o.width=="object"&&o.width.on==="zoom-level"&&(o.altitudeBreakpoints=o.width.input.map(c=>this.convertZoomLevelToAltitude(c))),o.dirty=!1}s.dirty&&(o.mesh.children.forEach(c=>{c.name!=="stencil"&&(c.material.uniforms.color.value.set(s.color),c.material.visible=s.visible,c.material.needsUpdate=!0)}),o.mesh.position.z=s.altitude,s.dirty=!1),o.material&&(o.mesh.children.forEach(c=>{var h,d,p,m,y,v,_;let w=c.material.uniforms;if(c.name==="stencil"){o.materialDirty&&IL(o,c.material);return}if(typeof o.width=="object"&&o.width.on==="zoom-level"){o.altitudeBreakpoints&&o.altitudeBreakpoints.length>2&&Be.warn("Path width interpolation does not yet support more than 2 breakpoints! This will be added in a future version. Path width will only use the first two breakpoints.");let b=MG(r,(d=(h=o.altitudeBreakpoints)==null?void 0:h.slice(0,2))!=null?d:[t,e]);o.breakpoint=b,w.nearZoom.value=(m=(p=o.altitudeBreakpoints)==null?void 0:p[b])!=null?m:t,w.farZoom.value=(v=(y=o.altitudeBreakpoints)==null?void 0:y[b+1])!=null?v:e,w.nearRadius.value=Number(o.width.output[b])/2,w.farRadius.value=Number((_=o.width.output[b+1])!=null?_:o.width.output[b])/2}w.cameraParameters.value.x=r,o.materialDirty&&(w.displayArrowsOnPath.value=o.displayArrowsOnPath,w.pulseColor.value.set(o.accentColor),w.complete.value=o.completeFraction,IL(o,c.material),typeof o.width=="number"&&(w.nearZoom.value=t,w.farZoom.value=e,w.nearRadius.value=Number(o.width)/2,w.farRadius.value=Number(o.width)/2))}),o.displayArrowsOnPath&&o.animateArrowsOnPath&&(o.mesh.children.forEach(c=>{c.name!=="stencil"&&(c.material.uniforms.arrowAnimationTimer.value=performance.now()/3e3,c.material.needsUpdate=!0)}),i=!0),o.materialDirty=!1)}this.verticalDistanceDirty=!1,i&&this.publish("animate:path")}};function IL(t,e){let r=e.uniforms;r.highlightCompleteFraction.value=t.highlightCompleteFraction,r.highlightStartFraction.value=t.highlightStartFraction,r.highlightEndFraction.value=t.highlightEndFraction,r.highlightWidthMultiplier.value=t.highlightWidthMultiplier,r.highlightColor.value.set(t.highlightColor)}C();var Zi,xv,zh,E6,uHe=class{constructor(t){S(this,"rendererState"),S(this,"dirty",!1),K(this,Zi),K(this,xv),K(this,zh),K(this,E6,new gr),this.rendererState=t}updateOne(t){if(t instanceof Cn&&t.components[0]instanceof Xa&&t.components[1]instanceof ug&&t.parentObject3D instanceof _o&&(ne(this,Zi,t.components[0]),ne(this,zh,t.components[1]),!f(this,Zi).detached&&f(this,Zi).shouldDetach&&f(this,Zi).mesh!=null&&f(this,Zi).material!=null&&f(this,Zi).batchedProps!=null)){ne(this,xv,t.parentObject3D),f(this,Zi).visible=!1;let e=new jt(f(this,zh).color),r=f(this,zh).opacity*Gk(t),n=new jM({color:e,side:po,opacity:r??1,transparent:r!==void 0?r<1:!1},1,f(this,Zi).material.repeatYFactor),i=new jk(1,f(this,Zi).batchedProps.positionCount,0,n),a=gWe(f(this,Zi),i,f(this,E6));if(a==null)return;i.userData={entities:{0:t.id},detached:!0},f(this,Zi).instanceIndex=a,f(this,Zi).material.setColor(f(this,Zi).instanceIndex,e,f(this,zh).topColor?new jt(f(this,zh).topColor):e),f(this,Zi).mesh=i,f(this,Zi).material=n,f(this,xv).add(i),f(this,Zi).shouldDetach=!1,f(this,Zi).detached=!0}}update(){if(!this.dirty)return;let t;for(let e of this.rendererState.geometry3DIdsInScene)t=this.rendererState.geometry3DMap.get(e),this.updateOne(t);this.dirty=!1,this.cleanup()}cleanup(){ne(this,Zi,void 0),ne(this,xv,void 0),ne(this,zh,void 0)}};Zi=new WeakMap,xv=new WeakMap,zh=new WeakMap,E6=new WeakMap;C();C();function cHe(t,e,r){var n;if((n=t.batchedProps)!=null&&n.range&&t.mesh){let i=e||1e-4,a=i/Math.max(r,1e-4);return ere(t.mesh.geometry,t.batchedProps.range,i,0),t.material&&(t.material.repeatYFactor=a),t.currentHeight=i,!0}return!1}function hHe(t,e,r,n,i,a){return t.mesh&&t.instanceIndex!==-1?(t.mesh.getMatrixAt(t.instanceIndex,r),r.decompose(n,i,a),n.z=e,r.compose(n,i,a),t.mesh.setMatrixAt(t.instanceIndex,r),t.altitude=e,!0):!1}var ru,gc,I6,C6,M6,T6,dHe=class{constructor(t){S(this,"rendererState"),S(this,"dirty",!1),K(this,ru),K(this,gc),K(this,I6,new gr),K(this,C6,new Q),K(this,M6,new Iu),K(this,T6,new Q),this.rendererState=t}updateOne(t){var e;if(t instanceof Cn&&t.type==="geometry"&&(e=t.components[1])!=null&&e.dirty&&(ne(this,ru,t.components[0]),ne(this,gc,t.components[1]),t.type==="geometry")){let r=!1;f(this,gc).height!==f(this,ru).currentHeight&&(r=cHe(f(this,ru),f(this,gc).height,f(this,gc).initialHeight)),f(this,gc).altitude!==f(this,ru).altitude&&(r=hHe(f(this,ru),f(this,gc).altitude,f(this,I6),f(this,C6),f(this,M6),f(this,T6))),r&&f(this,ru).mesh!=null&&f(this,ru).mesh.computeBoundingSphere()}}update(){let t;for(let e of this.rendererState.geometry3DIdsInScene)t=this.rendererState.geometry3DMap.get(e),this.updateOne(t);this.cleanup()}cleanup(){ne(this,ru,void 0),ne(this,gc,void 0)}};ru=new WeakMap,gc=new WeakMap,I6=new WeakMap,C6=new WeakMap,M6=new WeakMap,T6=new WeakMap;C();var pHe={showPolygonLabelTextAreaMesh:!1,showEnvMap:!1,showCollisionBoxes:!1},fHe=class{constructor(t){S(this,"state",pHe),S(this,"core"),this.core=t}update(t){let e={};for(let[r,n]of Object.entries(t))r in this.state&&this.state[r]!==t[r]&&(this.state[r]=n,e[r]=n);this.handleUpdate(e)}handleUpdate(t){t.showPolygonLabelTextAreaMesh!=null&&(t.showPolygonLabelTextAreaMesh?this.core.getSystems().text3DSystem.showTextAreaMesh():this.core.getSystems().text3DSystem.hideTextAreaMesh()),t.showEnvMap!=null&&(t.showEnvMap?this.core.setEnvironment("basic"):this.core.setEnvironment(!1)),t.showCollisionBoxes!=null&&(t.showCollisionBoxes?(this.core.getSystems().collisionSystem.showCollisionBoxes(),this.core.render()):this.core.getSystems().collisionSystem.hideCollisionBoxes())}};C();var wb=9,CL=.1;function mHe(t,e,r){for(let n=0;n<e;n++){let i=(r&16711680)>>16,a=(r&65280)>>8,o=r&255;t[n*3]=i/255,t[n*3+1]=a/255,t[n*3+2]=o/255}}var gHe=class{constructor(t,e,r){if(S(this,"state"),S(this,"renderer"),S(this,"renderService"),S(this,"pickingTexture"),S(this,"pickingMaterial"),S(this,"pixelBuffer"),S(this,"width",0),S(this,"height",0),S(this,"scale",1/2),S(this,"color",1),S(this,"convertTo3DMapPosition"),S(this,"destroyed",!1),S(this,"enabled",!1),S(this,"backgroundId",16777215),S(this,"resize",()=>{let n=this.state.pixelRatio;this.width=Math.floor(this.renderer.domElement.width/n*this.scale),this.height=Math.floor(this.renderer.domElement.height/n*this.scale),this.pixelBuffer=new Uint8Array(4*this.width*this.height),this.pickingTexture=new ad(this.width,this.height,{format:Ha,type:Fl,internalFormat:"RGBA"})}),S(this,"shouldShowByXY",(n,i,a)=>{if(this.pixelBuffer==null)return!1;let o=n+(this.height-i-1)*this.width,s=this.pixelBuffer[o*4],l=this.pixelBuffer[o*4+1],u=this.pixelBuffer[o*4+2],c=s<<16|l<<8|u;return c===a||c===this.backgroundId}),S(this,"activeOccluders",new Set),S(this,"update",()=>{if(!this.enabled||this.destroyed||(this.activeOccluders.clear(),this.activeOccluders.add(this.backgroundId),!this.pickingTexture||!this.pixelBuffer))return;let n,i;for(let o of this.state.geometry3DIdsInScene){let s=this.state.geometry3DMap.get(o);if(s&&s instanceof ui&&s.userData.occluderFeature!=null&&s.userData.occluderId!=null&&(this.activeOccluders.add(s.userData.occluderId),s.userData.occluderDirty)){if(n=s.userData.occluderFeature,n.geometry.type==="Polygon"&&n.geometry.coordinates.length>0){let l=Ute(n,this.convertTo3DMapPosition,{color:"white",height:CL});i=this.createOccluderMesh(l,s.userData.occluderId),s.add(i)}else if(n.geometry.type==="MultiPolygon"){let l=jte(n,this.convertTo3DMapPosition,{color:"white",height:CL});i=this.createOccluderMesh(l,s.userData.occluderId),s?.add(i)}s.userData.occluderDirty=!1}}this.renderer.setRenderTarget(this.pickingTexture);let a=new jt(this.backgroundId);this.renderer.setClearColor(a),this.renderer.clear(),this.state.cameraObject.layers.disableAll(),this.state.cameraObject.layers.enable(wb),this.renderer.render(this.state.geometryScene.parent,this.state.cameraObject),this.renderer.setRenderTarget(null),this.state.cameraObject.layers.disable(wb),this.renderService.enabledLayers.delete(wb),this.renderer.readRenderTargetPixelsAsync(this.pickingTexture,0,0,this.width,this.height,this.pixelBuffer).then(()=>{if(!this.destroyed)for(let o of this.state.geometry2DIdsInScene){let s=this.state.geometry2DMap.get(o);if(s&&s?.occluderId!=null&&this.activeOccluders.has(s?.occluderId)){let l=s.components[0].projection,u=Math.floor(l.x*this.scale),c=Math.floor(l.y*this.scale),h=this.shouldShowByXY(u,c,s.occluderId);s.components[0].isOccluded=!h}}}).catch(o=>{this.destroyed||Be.error(o)})}),this.state=t,this.convertTo3DMapPosition=e,r?.renderer==null)throw new Error("No Renderer");this.renderService=r,this.renderer=r.renderer,this.resize(),this.pickingMaterial=new ys({glslVersion:EC,vertexShader:`
				attribute vec3 color;
				varying vec3 vColor;
				void main() {
					vColor = color;
					gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
				}
			`,fragmentShader:`
				varying vec3 vColor;
				out vec4 fragColor;

				void main() {
					fragColor = vec4(vColor, 1.0);
				}
			`})}applyId(t,e){let r=t.attributes.position,n=new Float32Array(r.count*3);mHe(n,r.count,e),t.setAttribute("color",new Xn(n,3))}createOccluderMesh(t,e){let r=new Er(t,this.pickingMaterial);return r.layers.set(wb),this.applyId(r.geometry,e),r.userData.occluderId=e,r}reserveOccluderId(){return this.color++,this.color}enable(){this.enabled=!0}disable(){this.enabled=!1}destroy(){var t;this.destroyed=!0,(t=this.pickingTexture)==null||t.dispose(),this.pickingMaterial.dispose(),this.pickingTexture=void 0,this.pixelBuffer=void 0}};C();var yHe=class{constructor(t){this.state=t,S(this,"dirty",!0)}update(){var t;if(this.dirty){for(let e of this.state.geometry3DIdsInScene){let r=this.state.geometry3DMap.get(e);if(r instanceof Cn&&r.type==="geometry"&&((t=r.components[0])==null?void 0:t.geometry)!=null){let n=r.components[0];n.geometry&&(n.geometry.dispose(),n.geometry=void 0)}}this.dirty=!1}}};C();var vHe=class extends wi{constructor(t){super(),S(this,"dirty",!0),S(this,"state"),S(this,"texturePromiseCache",new Map),this.state=t}async loadTexture(t){if(this.texturePromiseCache.has(t))return this.texturePromiseCache.get(t);let e=new Promise((r,n)=>{hS.getLoader().load(t,r,void 0,n)});return this.texturePromiseCache.set(t,e),e}update(){for(let t of this.state.geometry3DIdsInScene){let e=this.state.geometry3DMap.get(t);if(!(e instanceof Cn))continue;let r=e.components[6];if(!(r instanceof M1))continue;let n=e.components[0];if(!(n instanceof Xa)||!r.dirty)continue;let i=Jd(n);i!=null&&(r.texture!=null&&(r.texture.path===""?(i.texture=null,i.hideTextures(n.instanceIndex),r.dirty=!1):this.loadTexture(r.texture.path).then(a=>{a&&(r.textureInstance=a,i.texture=a,i.blendTexture=!0,i.showTextures(n.instanceIndex)),this.publish("texture-added")})),r.topTexture!=null&&(r.topTexture.path===""?(i.topTexture=null,i.hideTextures(n.instanceIndex),r.dirty=!1):this.loadTexture(r.topTexture.path).then(a=>{a&&(r.topTextureInstance=a,i.topTexture=a,i.blendTexture=!0,i.showTextures(n.instanceIndex)),this.publish("texture-added")})),r.dirty=!1)}}destroy(){this.texturePromiseCache.forEach(async t=>{(await t).dispose()}),this.texturePromiseCache.clear()}};C();var _He=class{constructor(t){S(this,"currentOrder",rd.ALWAYS_ON_TOP_MODELS),S(this,"assignedOrders",new WeakMap),S(this,"state"),this.state=t}assignOrder(t){return this.assignedOrders.has(t)?this.assignedOrders.get(t):(this.currentOrder+=1,this.assignedOrders.set(t,this.currentOrder),this.currentOrder)}releaseOrder(t){return this.assignedOrders.delete(t),rd.GEOMETRY}getHighestOrder(){return this.currentOrder}getOrder(t){return this.assignedOrders.get(t)}update(){var t;let e,r,n;for(let i of this.state.geometry3DIdsInScene)if(n=this.state.geometry3DMap.get(i),n&&n.type==="model"&&(t=n.components[1])!=null&&t.dirty)if(e=n.components[1],r=n.components[0],e.visibleThroughGeometry===!0){let a=this.assignOrder(r);r.renderOrder!==a&&(r.renderOrder=a)}else r.renderOrder>rd.GEOMETRY&&(r.renderOrder=this.releaseOrder(r))}};C();var ML=1e4,xHe=class{constructor(t){S(this,"rendererState"),S(this,"dirty",!1),this.rendererState=t}update(){var t;let e,r,n;for(let i of this.rendererState.geometry3DIdsInScene)if(e=this.rendererState.geometry3DMap.get(i),e?.type==="model"&&e.components[7]!=null&&(n=e.components[0],r=e.components[7],r.dirty&&n.mesh!=null&&r?.verticalOffset!==1/0&&(r.plane==null&&(r.plane=new jh(new Q(0,0,-1),r.verticalOffset),this.process(n,r)),r.plane.constant!==r.verticalOffset&&(r.plane.constant=r.verticalOffset),r.topColor!=null&&((t=r.holeFillMesh)==null?void 0:t.material)instanceof l4&&r.holeFillMesh.material.color.set(r.topColor),r.topVisible!=null&&r.holeFillMesh!=null&&(r.holeFillMesh.visible=r.topVisible),r.dirty=!1),r.plane!=null&&r.holeFillMesh!=null&&r.topVisible===!0)){let a=r.plane,o=r.holeFillMesh;a.coplanarPoint(o.position),o.lookAt(o.position.x-a.normal.x,o.position.y-a.normal.y,o.position.z-a.normal.z)}}process(t,e){var r;if(t.mesh==null)return;let n=t.mesh.parent,i=[];t.mesh.traverse(d=>{if(d instanceof Er){let p=d.geometry.clone();d.updateWorldMatrix(!0,!1),p.applyMatrix4(d.matrixWorld),i.push(p),p.computeVertexNormals(),d.material.clippingPlanes=[e.plane],d.material.transparent=!1}});let a=vd(i),o=new pp,s=new pp,l=this.createHoleFillGeometry(a,e.plane,1);l.name="hole-fill-group";let u=new l4({color:(r=e.topColor)!=null?r:"#E67B5B",clippingPlanes:[],stencilWrite:!0,stencilFunc:W9,stencilFail:Jm,stencilZFail:Jm,stencilZPass:Jm}),c=new yd(ML,ML),h=new Er(c,u);h.name="hole-fill-mesh",e.holeFillMesh=h,h.renderOrder=1.1,s.add(l),s.add(t.mesh),o.add(s),o.add(h),n?.add(o),t.mesh=o}createHoleFillGeometry(t,e,r=0){let n=new pp,i=new Go;i.depthWrite=!1,i.depthTest=!1,i.colorWrite=!1,i.stencilWrite=!0,i.stencilFunc=n4;let a=i.clone();a.side=xa,a.clippingPlanes=[e],a.stencilFail=MS,a.stencilZFail=MS,a.stencilZPass=MS;let o=new Er(t,a);o.renderOrder=r,n.add(o);let s=i.clone();s.side=_s,s.clippingPlanes=[e],s.stencilFail=TS,s.stencilZFail=TS,s.stencilZPass=TS;let l=new Er(t,s);return l.renderOrder=r,n.add(l),n}};C();var bHe=class{constructor(){S(this,"plugins",new Set)}registerPlugin(t){this.plugins.add(t)}unregisterPlugin(t){this.plugins.delete(t)}update(t){for(let e of this.plugins)e.update(t)}},TL=new G1,{DEFAULT_PITCH:are,DEFAULT_BEARING:ore,DEFAULT_ZOOM_LEVEL:sre,DEFAULT_MIN_ZOOM_LEVEL:wHe,DEFAULT_MAX_ZOOM_LEVEL:AHe}=up,SHe=In.radToDeg(.6435011087932844),Mi,pi,bm,xw,bv,ep,wm,wv,gl,P6,xe,yl,Am,yn,lu,Ci,El,pa,ge,bw,fa,Bn,lre,ure,cre,Gh,ww,Aw,Sw,Ew,Av,D6,Iw,Sv,Cw,Sm,k6,Em,Mw,Tw,Ro,Lo,O6,B6,z6,Ev,Pw,EHe=class extends wi{constructor(t,e={}){var r,n,i,a,o,s,l,u,c,h,d,p,m,y,v,_;if(super(),K(this,gl),S(this,"options"),S(this,"container"),S(this,"Debug"),K(this,Mi),K(this,pi),K(this,bm),K(this,xw),K(this,bv),K(this,ep),K(this,wm),K(this,wv),S(this,"rendererDomElement"),K(this,xe,{geometry3DMap:new Map,geometry2DMap:new Map,geometry2DIdsInScene:new Set,geometry3DIdsInScene:new Set,geometryGroupIdsToLoad:new Set,geometryScene:new ui("__scene"),hoverColor:"#f6efff",text3dHoverColor:"white",insetsPadding:fq,shouldMeasureCanvas:!0,pixelRatio:this.resolutionScale,canvasWidth:0,canvasHeight:0,internalTweenGroup:new i6,externalTweenGroup:new i6,cameraObject:new co,naturalBearing:0,containerOffset:[0,0],useStandaloneCamera:!1,directionalLight:new DN(16777215,.3*Math.PI),ambientLight:new coe(16777215,.741*Math.PI),renderer:void 0,threeJSScene:new bP}),K(this,yl,{}),K(this,Am,new AbortController),S(this,"camera"),K(this,yn),K(this,lu),K(this,Ci),K(this,El),K(this,pa),K(this,ge,{}),K(this,bw,window.matchMedia("screen and (min-resolution: 2dppx)")),S(this,"map"),K(this,fa,()=>{var O;this.aborted||!((O=f(this,ge))!=null&&O.renderSystem)||(f(this,ge).renderSystem.twoDdirty=!0)}),K(this,Bn,()=>{var O;this.aborted||!((O=f(this,ge))!=null&&O.renderSystem)||(f(this,ge).renderSystem.threeDdirty=!0)}),K(this,Gh,"standalone"),K(this,ww,()=>{f(this,ge).geometryDisposalSystem.dirty=!0,this.render()}),K(this,Aw,O=>Math.trunc(O*10)/10),K(this,Sw,()=>{ot(this,gl,P6).call(this,u2()),f(this,ge).twoDDrawSystem.dirty=!0,f(this,Av).call(this,void 0,void 0,!0)}),K(this,Ew,()=>{f(this,Av).call(this)}),K(this,Av,(O,B,L=!1)=>{let R=O??this.rendererDomElement.clientWidth,T=B??this.rendererDomElement.clientHeight;if((R===0||T===0)&&!L)return;f(this,xe).canvasWidth=R,f(this,xe).canvasHeight=T,ot(this,gl,P6).call(this,u2()),f(this,Sm).call(this),ot(this,gl,cre).call(this),f(this,ge).cameraSystem.resize(this.canvasWidth,this.canvasHeight),f(this,ge).cameraSystem.dirty=!0,this.map!=null&&(this.map.setMinZoom(this.camera.minZoomLevel),this.map.setMaxZoom(this.camera.maxZoomLevel)),f(this,ge).watermarkSystem.resize(this.canvasWidth,this.canvasHeight),f(this,ge).htmlControlsSystem.resize(this.canvasWidth),f(this,ge).geometryInFocusSystem.resize(),f(this,ge).occlusion2DSystem.resize();let{top:N,left:$}=this.container.getBoundingClientRect();f(this,xe).containerOffset=[N,$],this.publish("resize"),this.render()}),K(this,D6,()=>{this.renderSync()}),K(this,Iw,new Q),K(this,Sv,(O,B)=>{let L=this.mode==="standalone"?f(this,pi):this.viewCamera;if(f(this,pi).position.z+this.camera.elevation>B.z){f(this,Iw).copy(B);let R=f(this,Iw).project(L),T=(R.x+1)/2*this.canvasWidth-0/2,N=(-R.y+1)/2*this.canvasHeight-0/2,$=f(this,Aw).call(this,T),V=f(this,Aw).call(this,N);O.x=$,O.y=V}else O.x=-1e3,O.y=-1e3}),K(this,Cw,(O,B)=>{f(this,pa).setBufferSize(O,B),f(this,pi).aspect=O/B,f(this,pi).updateProjectionMatrix(),f(this,pi).updateMatrixWorld(!0),f(this,bv).x=O,f(this,bv).y=B}),K(this,Sm,()=>{var O;let B=f(this,xe).canvasWidth=this.rendererDomElement.clientWidth,L=f(this,xe).canvasHeight=this.rendererDomElement.clientHeight,R=Math.floor(B*this.resolutionScale),T=Math.floor(L*this.resolutionScale);f(this,Cw).call(this,R,T),(O=this.map)==null||O.resize(),f(this,xe).shouldMeasureCanvas=!1}),S(this,"getParentContainer",(O,B=!0)=>{if(!O)return B?f(this,xe).geometryScene:void 0;if(typeof O=="string"||typeof O=="number"){let L=f(this,xe).geometry3DMap.get(O);return L instanceof ui?L:(Be.warn("Parent (".concat(typeof O=="object"?O.id:O,") is not a valid container, adding to scene")),B?f(this,xe).geometryScene:void 0)}else if(O.type==="group-container"){let L=f(this,xe).geometry3DMap.get(O.id);if(L instanceof ui)return L}return B?f(this,xe).geometryScene:void 0}),S(this,"showCollisionBoxes",()=>{f(this,ge).collisionSystem.showCollisionBoxes(),this.render()}),S(this,"hideCollisionBoxes",()=>{f(this,ge).collisionSystem.hideCollisionBoxes(),this.render()}),S(this,"projectScreenXYToCoordinate",(O,B,L=!1)=>{var R,T;let N=this.container.getBoundingClientRect(),$=(O-N.left)/f(this,xe).canvasWidth*2-1,V=-((B-N.top)/f(this,xe).canvasHeight)*2+1,G=new Je($,V),ee,ie;if(L)TL.setFromCamera(G,f(this,pi)),ee=(R=TL.intersectObject(f(this,ep),!1)[0])==null?void 0:R.point;else{let me=f(this,ge).interactionSystem.getThreeDIntersectsFromXY(G);ee=(T=me?.[0])==null?void 0:T.point,ie=f(this,ge).interactionSystem.getGroupContainerIntersectsFromXY(G)}if(ee)return{coordinate:this.convert3DMapPositionToCoordinate(ee),groupContainers:ie}}),S(this,"projectCoordinateToScreenXY",O=>{let B=this.convertTo3DMapPosition(O[1],O[0],O[2]||0),L=new Je;return f(this,Sv).call(this,L,B),{x:L.x,y:L.y}}),S(this,"convert3DMapPositionToCoordinate",O=>{var B,L,R,T;let{lat:N,lon:$}=Mq((L=(B=f(this,xe).center)==null?void 0:B[1])!=null?L:0,(T=(R=f(this,xe).center)==null?void 0:R[0])!=null?T:0,O.x,O.y);return[$,N,O.z]}),S(this,"setBackgroundColor",(O,B)=>{f(this,pa).setBackgroundColor(O,B)}),S(this,"getMetersPerPixel",()=>f(this,ge).cameraSystem.getCurrentMetersPerPixel()),S(this,"hideOutdoorLayersIntersectingPolygons",(O,B,L)=>{f(this,ge).outdoorLayersSystem.hideLayersIntersectingPolygons(O,B,L),this.render()}),K(this,Em,new h0),K(this,Mw,new gr),K(this,Tw,O=>{var B;Be.error("Render failed: ",O,(B=O.stack)!=null?B:"No stack trace available"),this.publish("render-error",{error:O})}),S(this,"render",()=>{var O;if(!(((O=f(this,ge))==null?void 0:O.renderSystem)==null||this.aborted))if(this.map&&(this.mode==="outdoors-interleaved"||this.mode==="outdoors-overlay"))this.map.triggerRepaint();else return f(this,ge).renderSystem.update().catch(f(this,Tw))}),S(this,"renderSync",()=>this.aborted?Promise.resolve():f(this,ge).renderSystem.update(!0).catch(f(this,Tw))),K(this,Ro,qM(()=>{this.publish("user-interaction-start",void 0)},0,!0)),K(this,Lo,qM(()=>{this.publish("user-interaction-end",void 0),this.render()},0,!0)),S(this,"on",(O,B)=>{this.aborted||(super.on(O,B),["outdoor-view-loaded","outdoor-style-loaded"].includes(O)&&this.mode==="standalone"&&Oi.env.NODE_ENV!=="test"&&(Be.warn('"'.concat(O,'" was subscribed to but outdoor view is disabled. The event has been triggered immediately. Enable outdoor view or remove the listener.')),this.publish(O)))}),S(this,"off",(O,B)=>{super.off(O,B)}),S(this,"getCursor",()=>f(this,ge).interactionSystem.getCursor()),K(this,B6,()=>{if(f(this,xe).geometryScene.removeEventListener("childadded",f(this,Bn)),f(this,xe).geometryScene.removeEventListener("childadded",f(this,fa)),f(this,xe).geometryScene.removeEventListener("childremoved",f(this,Bn)),f(this,xe).geometryScene.removeEventListener("childremoved",f(this,fa)),window.removeEventListener("resize",f(this,Ew),!1),f(this,bw).removeEventListener("change",f(this,Sw)),this.map){for(let O in f(this,yl))for(let B of f(this,yl)[O])this.map.off(O,B);ne(this,yl,{})}this._subscribers={}}),K(this,z6,()=>{try{f(this,Gh)!=="outdoors-overlay"&&(this.map&&this.map.remove(),this.container&&this.rendererDomElement&&this.container.contains(this.rendererDomElement)&&this.container.removeChild(this.rendererDomElement)),this.container&&(f(this,El)&&this.container.contains(f(this,El))&&this.container.removeChild(f(this,El)),f(this,yn)&&this.container.contains(f(this,yn))&&this.container.removeChild(f(this,yn)))}catch(O){Be.warn("Error during DOM cleanup, some elements may not have been removed:",O)}}),S(this,"destroy",()=>{var O,B;f(this,ge)&&(f(this,ge).textureSystem.destroy(),this.aborted||f(this,Am).abort(),f(this,B6).call(this),(O=globalThis.MappedinDebug)!=null&&O.__idleCallbackInteractionState&&(globalThis.MappedinDebug.__idleCallbackInteractionState.unregisterInteractionChecker(f(this,ge).cameraSystem.isUserInteracting),globalThis.MappedinDebug.__idleCallbackInteractionState.unregisterInteractionChecker(f(this,ge).cameraSystem.isCameraMoving)),this.remove("__scene"),f(this,ge).renderSystem.destroy(),f(this,ge).cameraSystem.dispose(),f(this,ge).exporterSystem.destroy(),f(this,ge).outdoorLayersSystem.destroy(),f(this,ge).borderSystem.destroy(),f(this,wm)&&f(this,wm).disconnect(),f(this,pa).destroy(),(B=f(this,Mi))==null||B.traverse(L=>{ya(L),"dispose"in L&&typeof L.dispose=="function"&&L.dispose()}),ne(this,Mi,void 0),f(this,ge).htmlControlsSystem.destroy(),f(this,ge).collisionSystem.destroy(),f(this,ge).interactionSystem.destroy(),f(this,ge).domMutationSystem.destroy(),f(this,ge).geometryInFocusSystem.destroy(),f(this,ge).occlusion2DSystem.destroy(),ne(this,ge,void 0),f(this,z6).call(this),ne(this,pa,void 0))}),K(this,Ev,new Q),K(this,Pw,new Q),ne(this,Am,new AbortController),f(this,xe).useStandaloneCamera=(r=e.useStandaloneCamera)!=null?r:!1,f(this,xe).naturalBearing=(n=e.naturalBearing)!=null?n:0,this.convertTo3DMapPosition=this.convertTo3DMapPosition.bind(this),!t.clientWidth||!t.clientHeight)throw new Error("[MappedinJS] Container width and height must be greater than 0");this.convertTo3DMapPosition=this.convertTo3DMapPosition.bind(this),(e.mode==="outdoors-interleaved"||e.mode==="outdoors-overlay")&&e.map&&(ne(this,Gh,e.mode),this.map=e.map),f(this,xe).geometryScene.addEventListener("childadded",()=>{f(this,Bn).call(this),f(this,fa).call(this)}),f(this,xe).geometryScene.addEventListener("childremoved",()=>{f(this,Bn).call(this),f(this,fa).call(this)}),f(this,xe).geometry3DMap.set(f(this,xe).geometryScene.userData.entityId,f(this,xe).geometryScene),e.center&&(f(this,xe).center=e.center?[...e.center]:[0,0]),this.options=e,this.container=t,ot(this,gl,lre).call(this),ot(this,gl,ure).call(this),f(this,ge).htmlControlsSystem=new dWe(this.container,{outdoorEnabled:!!this.map}),f(this,Gh)!=="outdoors-overlay"&&f(this,ge).htmlControlsSystem.addAttributionControl(this.options.attribution),window.MappedinDebug||(window.MappedinDebug={}),Oi.env.NODE_ENV==="test"&&(window.MappedinDebug.mapViewCoreInstance=this),ne(this,pa,new zGe({antialias:typeof e.antialias=="boolean"?e.antialias:!0,alpha:!1,canvas:this.mode!=="standalone"?(i=e.gl)==null?void 0:i.canvas:void 0,onWebGLContextCreationError:e.onWebGLContextCreationError,onWebGLContextLost:e.onWebGLContextLost,onWebGLContextRestored:O=>{var B;(B=e.onWebGLContextRestored)==null||B.call(e,O),f(this,fa).call(this),f(this,Bn).call(this),this.render()},onWebGLRendererError:e.onWebGLRendererError,backgroundColor:e.backgroundColor||"#ffffff",backgroundAlpha:(a=e.backgroundAlpha)!=null?a:1})),f(this,xe).renderer=f(this,pa).renderer,ne(this,Mi,f(this,xe).threeJSScene),f(this,Gh)!=="standalone"&&f(this,Mi).add(fPe()),f(this,Mi).add(f(this,xe).geometryScene);let w=window.__THREE_DEVTOOLS__;Oi.env.NODE_ENV==="dev"&&typeof w<"u"&&(w.dispatchEvent(new CustomEvent("observe",{detail:f(this,Mi)})),w.dispatchEvent(new CustomEvent("observe",{detail:f(this,pa)}))),ne(this,pi,new co(SHe,this.aspect,50,1e5)),f(this,xe).cameraObject=f(this,pi),ne(this,xw,new xP),f(this,pi).renderOrder=999;let b=new Yn;b.add(f(this,pi)),ne(this,wv,new Yn),f(this,wv).add(b),f(this,Mi).add(f(this,wv)),f(this,pi).updateProjectionMatrix(),f(this,pi).updateMatrixWorld(!0),this.referenceMap={scale:1,latitude:0,longitude:0,getNorth:()=>0,georeference:[{target:{x:0,y:0}},{target:{x:0,y:0}},{target:{x:0,y:0}},{target:{x:0,y:0}}]},this.rendererDomElement=f(this,pa).domElement(),ne(this,bv,new Je);let A=new yd(1e6,1e6),E=new Go({color:0,visible:!1});ne(this,ep,new Er(A,E)),f(this,ep).name="worldPlane",f(this,Mi).add(f(this,ep)),(o=e.gl)!=null&&o.canvas||t.appendChild(this.rendererDomElement),window.addEventListener("resize",f(this,Ew),!1),f(this,bw).addEventListener("change",f(this,Sw)),typeof ResizeObserver=="function"&&((s=Oi.env)==null?void 0:s.NODE_ENV)!=="test"&&(ne(this,wm,new ResizeObserver(Dk(O=>{f(this,Av).call(this,O[0].contentRect.width,O[0].contentRect.height)},50))),(l=f(this,wm))==null||l.observe(t)),t.classList.add("mappedin-map"),this.rendererDomElement.style.width=(u=globalThis.MappedinDebug)!=null&&u.TEST_IOS?"1080px":"100%",this.rendererDomElement.style.height=(c=globalThis.MappedinDebug)!=null&&c.TEST_IOS?"1920px":"100%",Oi.env.NODE_ENV==="test"&&this.rendererDomElement.setAttribute("data-testid","mappedin-canvas"),this.mode!=="outdoors-overlay"&&this.rendererDomElement.tabIndex!==void 0&&this.rendererDomElement.removeAttribute("tabindex"),f(this,xe).canvasWidth=this.rendererDomElement.clientWidth,f(this,xe).canvasHeight=this.rendererDomElement.clientHeight,this.rendererDomElement.style.touchAction="manipulation";let M=this.canvasWidth,P=this.canvasHeight;f(this,ge).watermarkSystem=new aWe(f(this,pi),f(this,xe),e?.watermark),f(this,ge).watermarkSystem.on("texture-loaded",this.render),f(this,xe).shouldMeasureCanvas=!0,f(this,xe).pixelRatio=this.resolutionScale,f(this,Cw).call(this,Math.floor(M*this.resolutionScale),Math.floor(P*this.resolutionScale)),f(this,xe).directionalLight.position.set(-150,-150,350),f(this,Mi).add(f(this,xe).directionalLight),f(this,Mi).add(f(this,xe).ambientLight),f(this,ge).cameraSystem=new uB(f(this,pi),f(this,Mi),f(this,pa).renderer,f(this,xe),{mode:this.mode,canvasHeight:P,canvasWidth:M}),(h=globalThis.MappedinDebug)!=null&&h.__idleCallbackInteractionState&&(globalThis.MappedinDebug.__idleCallbackInteractionState.registerInteractionChecker(f(this,ge).cameraSystem.isUserInteracting),globalThis.MappedinDebug.__idleCallbackInteractionState.registerInteractionChecker(f(this,ge).cameraSystem.isCameraMoving)),f(this,ge).cameraSystem.on("user-dolly-start",f(this,Ro)),f(this,ge).cameraSystem.on("user-pan-start",f(this,Ro)),f(this,ge).cameraSystem.on("user-rotate-start",f(this,Ro)),f(this,ge).cameraSystem.on("user-zoom-start",f(this,Ro)),f(this,ge).cameraSystem.on("user-tilt-start",f(this,Ro)),f(this,ge).cameraSystem.on("user-pedestal-start",f(this,Ro)),f(this,ge).cameraSystem.on("user-dolly-end",f(this,Lo)),f(this,ge).cameraSystem.on("user-pan-end",f(this,Lo)),f(this,ge).cameraSystem.on("user-rotate-end",f(this,Lo)),f(this,ge).cameraSystem.on("user-zoom-end",f(this,Lo)),f(this,ge).cameraSystem.on("user-tilt-end",f(this,Lo)),f(this,ge).cameraSystem.on("user-pedestal-end",f(this,Lo)),f(this,ge).cameraSystem.on("change",()=>{this.publish("camera-change",this.camera),f(this,ge).geometryInFocusSystem&&(f(this,ge).geometryInFocusSystem.cameraDirty=!0),this.render()}),this.onAbort(()=>{f(this,ge).cameraSystem.off("user-dolly-start",f(this,Ro)),f(this,ge).cameraSystem.off("user-pan-start",f(this,Ro)),f(this,ge).cameraSystem.off("user-rotate-start",f(this,Ro)),f(this,ge).cameraSystem.off("user-zoom-start",f(this,Ro)),f(this,ge).cameraSystem.off("user-tilt-start",f(this,Ro)),f(this,ge).cameraSystem.off("user-pedestal-start",f(this,Ro)),f(this,ge).cameraSystem.off("user-dolly-end",f(this,Lo)),f(this,ge).cameraSystem.off("user-pan-end",f(this,Lo)),f(this,ge).cameraSystem.off("user-rotate-end",f(this,Lo)),f(this,ge).cameraSystem.off("user-zoom-end",f(this,Lo)),f(this,ge).cameraSystem.off("user-tilt-end",f(this,Lo)),f(this,ge).cameraSystem.off("user-pedestal-end",f(this,Lo)),f(this,ge).renderSystem.off("measure-canvas",f(this,Sm)),f(this,ge).cameraSystem.off("change",this.render),f(this,ge).outlineInterpolationSystem.off("needs-render",this.render)}),f(this,ge).pathSystem=new lHe(f(this,xe),this.convertTo3DMapPosition,this.getParentContainer,f(this,ge).cameraSystem.convertZoomLevelToAltitude),f(this,ge).pathSystem.on("animate:path",this.render),this.onAbort(()=>{f(this,ge).pathSystem.off("animate:path",this.render)}),f(this,ge).panBoundsSystem=new sWe(f(this,xe),f(this,ge).cameraSystem);let k=()=>{let{panBounds:O,fov:B,convertAltitudeToZoomLevel:L}=f(this,ge).cameraSystem;if(f(this,ge).panBoundsSystem.autoMinZoomLevel){if(O.radius<=0)return;let R=Math.min(f(this,xe).canvasWidth/f(this,xe).canvasHeight,1),T=B*Math.PI/180*R,N=Math.tan(T/2),{radius:$,center:V}=f(this,ge).cameraSystem.panBounds,G=$/N,ee=this.getThreeCamera().getWorldPosition(new Q),ie=V.distanceTo(ee),me=Math.abs(ee.z-V.z),Me=G*me/ie,Ae=L(Me);hPe(Ae,this.camera.minZoomLevel)&&this.camera.setMinZoomLevel(Ae)}this.publish("pan-bounds-change",f(this,ge).cameraSystem.panBounds)};f(this,ge).panBoundsSystem.on("update",k),this.onAbort(()=>{f(this,ge).panBoundsSystem.off("update",k)}),this.camera=new XZe(this,f(this,ge),f(this,xe)),this.camera.setZoomLevel((d=e.zoomLevel)!=null?d:sre),this.camera.setBearing((p=e.bearing)!=null?p:ore),this.camera.setPitch((m=e.pitch)!=null?m:are),this.camera.setMaxZoomLevel(AHe),this.camera.setMinZoomLevel(wHe),f(this,ge).domVisiblitySystem=new vZe(f(this,xe),f(this,El)),f(this,ge).domMutationSystem=new GZe(f(this,xe),f(this,El)),f(this,ge).domMutationSystem.on("dimensions-update",()=>{f(this,ge).collisionSystem.collidersDirty=!0,this.render()}),f(this,ge).domDrawSystem=new VZe(f(this,xe)),f(this,ge).collisionSystem=new ZGe(f(this,lu),f(this,xe),((y=e.useCollisionWorker)!=null?y:!0)&&((v=e.useWorkers)!=null?v:!0)),f(this,ge).twoDDrawSystem=new AZe(f(this,xe),f(this,Ci),e.transformImageRequest),f(this,ge).twoDDrawSystem.on("img:loaded",this.render),f(this,ge).interactionSystem=new XGe(this.rendererDomElement,f(this,xe),f(this,pi),f(this,ep),f(this,ge).cameraSystem.isUserInteracting),f(this,ge).interactionSystem.on("doubletap-with-onefinger",O=>{var B;f(this,ge).cameraSystem.enableZoom&&this.camera.animateTo({center:(B=this.projectScreenXYToCoordinate(O.clientX,O.clientY))==null?void 0:B.coordinate,zoomLevel:this.camera.zoomLevel+1,duration:R8,easing:"ease-out"})}),f(this,ge).interactionSystem.on("singletap-with-twofinger",()=>{f(this,ge).cameraSystem.enableZoom&&this.camera.animateTo({zoomLevel:this.camera.zoomLevel-1,duration:R8,easing:"ease-out"})}),f(this,ge).interactionSystem.on("hover",this.render),f(this,ge).interactionSystem.on("click",O=>{var B,L,R,T,N,$,V,G,ee;if(O.entity2D.some(Ae=>Ae.id==="watermark")&&typeof f(this,ge).watermarkSystem.options.onClick=="function"&&f(this,ge).watermarkSystem.options.interactive){f(this,ge).watermarkSystem.options.onClick();return}let ie=O.entity3D?[(B=O.entity3D)==null?void 0:B.id]:[];(T=(R=(L=O.entity3D)==null?void 0:L.parentObject3D)==null?void 0:R.userData)!=null&&T.entityId&&ie.push((V=($=(N=O.entity3D)==null?void 0:N.parentObject3D)==null?void 0:$.userData)==null?void 0:V.entityId);let me=[],Me=[];for(let Ae of O.entity2D)Ae.components[0]instanceof Um?me.push(Ae.id):Ae.components[0]instanceof yp&&Me.push(Ae.id);this.publish("click",{coordinate:this.convert3DMapPositionToCoordinate(O.position),geometry:ie,paths:((G=O.entity3D)==null?void 0:G.components[0])instanceof cw?[O.entity3D.id]:[],markers:me,models:((ee=O.entity3D)==null?void 0:ee.components[0])instanceof lw?[O.entity3D.id]:[],labels:Me,containers:Array.isArray(O.groupContainers)?O.groupContainers.map(Ae=>Ae.userData.entityId):[],pointerEvent:O.pointerEvent})}),f(this,ge).interactionSystem.on("hover",O=>{var B,L,R;if(!O.position)return;let T=[],N=[];for(let $ of O.entity2D)$.components[0]instanceof Um?T.push($.id):$.components[0]instanceof yp&&N.push($.id);this.publish("hover",{coordinate:this.convert3DMapPositionToCoordinate(O.position),geometry:O.entity3D?[(B=O.entity3D)==null?void 0:B.id]:[],paths:((L=O.entity3D)==null?void 0:L.components[0])instanceof cw?[O.entity3D.id]:[],markers:T,models:((R=O.entity3D)==null?void 0:R.components[0])instanceof lw?[O.entity3D.id]:[],labels:N,containers:Array.isArray(O.groupContainers)?O.groupContainers.map($=>$.userData.entityId):[]})}),f(this,ge).geometryInFocusSystem=new VWe(f(this,xe),f(this,pi));let D=O=>{this.publish("geometry-in-focus",O)};f(this,ge).geometryInFocusSystem.on("geometry-in-focus",D),this.onAbort(()=>{f(this,ge).geometryInFocusSystem.off("geometry-in-focus",D)}),f(this,ge).twoDVisiblitySystem=new IZe(f(this,xe)),f(this,ge).drawSystem=new EZe(f(this,xe),this.convertTo3DMapPosition),f(this,ge).twoDProjectionSystem=new _Ze(f(this,xe),f(this,Sv)),f(this,ge).exporterSystem=new QGe(f(this,xe)),f(this,ge).meshOptimizationSystem=new yZe(f(this,xe),this.convertTo3DMapPosition),f(this,ge).meshOptimizationSystem.on("model-loaded",this.render),f(this,ge).meshOptimizationSystem.on("geometry-2d-added",this.render),f(this,ge).meshOptimizationSystem.on("geometry-group-added",f(this,ww)),this.onAbort(()=>{f(this,ge).meshOptimizationSystem.off("model-loaded",this.render),f(this,ge).meshOptimizationSystem.off("geometry-2d-added",this.render),f(this,ge).meshOptimizationSystem.off("geometry-group-added",f(this,ww))}),f(this,ge).meshDetachmentSystem=new uHe(f(this,xe)),f(this,ge).meshModificationSystem=new dHe(f(this,xe)),f(this,ge).geometryDisposalSystem=new yHe(f(this,xe)),f(this,ge).textureSystem=new vHe(f(this,xe)),f(this,ge).textureSystem.on("texture-added",this.render),this.onAbort(()=>{f(this,ge).textureSystem.off("texture-added",this.render)}),f(this,ge).borderSystem=new q6e(f(this,xe),this.convertTo3DMapPosition),f(this,ge).clippingPlaneSystem=new xHe(f(this,xe)),f(this,ge).renderOrderSystem=new _He(f(this,xe)),f(this,ge).pluginSystem=new bHe,f(this,ge).customGeometrySystem=new pWe(f(this,xe),this.convertTo3DMapPosition),f(this,ge).outlineInterpolationSystem=new bWe(f(this,xe)),f(this,ge).outlineInterpolationSystem.on("needs-render",this.render),f(this,ge).renderSystem=new CZe(f(this,pa),f(this,xe),this.mode,f(this,Mi),f(this,pi),this.viewCamera,f(this,ge)),f(this,ge).imageSystem=new UWe(f(this,xe),this.convertTo3DMapPosition,f(this,Sv),e.bearing,e.naturalBearing,e.imagePlacementOptions),f(this,ge).text3DSystem=new r6e(f(this,xe),this.convertTo3DMapPosition,(_=e.useWorkers)!=null?_:!0),f(this,ge).text3DSystem.on("render",this.render),f(this,ge).imageSystem.on("image-loaded",this.render),f(this,ge).renderSystem.on("pre-render",()=>this.publish("pre-render")),f(this,ge).renderSystem.on("post-render",()=>this.publish("post-render")),f(this,ge).renderSystem.on("measure-canvas",f(this,Sm)),this.onAbort(()=>{f(this,ge).renderSystem.off("pre-render",()=>this.publish("pre-render")),f(this,ge).renderSystem.off("post-render",()=>this.publish("post-render")),f(this,ge).renderSystem.off("measure-canvas",f(this,Sm))}),f(this,ge).outdoorLayersSystem=new tHe(this.map),f(this,ge).occlusion2DSystem=new gHe(f(this,xe),this.convertTo3DMapPosition,f(this,pa)),e.occlusionEnabled&&f(this,ge).occlusion2DSystem.enable(),this.Debug=new fHe(this),e.environment!==!1&&ne(this,bm,ot(this,gl,O6).call(this)),f(this,D6).call(this)}get viewCamera(){return f(this,xw)}get canvasWidth(){return f(this,xe).canvasWidth}get canvasHeight(){return f(this,xe).canvasHeight}get resolutionScale(){var t,e;return(e=(t=this.map)==null?void 0:t._getClampedPixelRatio(this.canvasWidth,this.canvasHeight))!=null?e:u2()}get aspect(){return this.canvasWidth/this.canvasHeight}get mode(){return f(this,Gh)}addGroupContainer(t,e,r){if(!f(this,xe).geometry3DMap.has(t)&&!f(this,xe).geometry2DMap.has(t)){let n=new ui(t);n.addEventListener("childadded",()=>{f(this,Bn).call(this),f(this,fa).call(this)}),n.addEventListener("childremoved",()=>{f(this,Bn).call(this),f(this,fa).call(this)}),e?.visible!==void 0&&(n.visible=e.visible),e?.altitude!==void 0&&n.setAltitude(e.altitude),e?.interactive!==void 0&&ja(n,e.interactive,f(this,xe)),e?.focusable!==void 0&&sI(n,e.focusable),e?.preloadGeometry!==void 0&&(n.userData.preloadGeometry=e.preloadGeometry),f(this,xe).geometry3DMap.set(t,n);let i=this.getParentContainer(r);i instanceof ui&&i.addEntity(n),f(this,Bn).call(this),this.render()}else Be.error("Group container with ID '".concat(t,"' already exists. The group container cannot be added."));return{id:t,type:"group-container"}}addCustomGeometry(t,e,r,n,i){if(f(this,xe).geometry3DMap.has(t))Be.error("Custom geometry with ID '".concat(t,"' already exists. The custom geometry cannot be added."));else{let a=new EI(e,r),o=new Cn(a,new ug(n));n?.interactive!==void 0&&ja(o,n.interactive,f(this,xe)),o.id=t,a.mesh.userData={entityId:t,type:"custom-geometry"},f(this,xe).geometry3DMap.set(o.id,o);let s=this.getParentContainer(i);i&&s instanceof ui?s.addEntity(o):f(this,xe).geometryScene.addEntity(o),f(this,Bn).call(this),this.render()}return{id:t,type:"custom-geometry"}}registerPlugin(t){f(this,ge).pluginSystem.registerPlugin(t)}unregisterPlugin(t){f(this,ge).pluginSystem.unregisterPlugin(t)}addGeometryGroup(t,e,r,n){var i,a,o;if(!f(this,xe).geometry3DMap.has(t)&&!f(this,xe).geometry2DMap.has(t)){let s=new _o(t);s.addEventListener("childadded",()=>{f(this,Bn).call(this),f(this,fa).call(this)}),s.addEventListener("childremoved",()=>{f(this,Bn).call(this),f(this,fa).call(this)}),s.userData.dirty=!0,f(this,xe).geometry3DMap.set(t,s);let l=typeof r=="function"?r(e.features[0]):r;for(let c of e.features){if(c.geometry==null||!["Polygon","MultiPolygon","LineString","MultiLineString"].includes(c.geometry.type))continue;let h=c?.id||((i=c?.properties)==null?void 0:i.id)||Wn(),d={color:Uv};if(typeof r=="function")d=(a=r(c))!=null?a:{color:Uv};else{let m=r||{color:Uv},{visible:y}=m;d=yu(m,["visible"])}let p=f(this,ge).meshOptimizationSystem.createEntityFromFeature(h,c,ae({outline:!0},d));f(this,xe).geometry3DMap.set(h,p),s.userData.entities3D.add(h),f(this,ge).textureSystem.dirty=!0}s.setVisible((o=l?.visible)!=null?o:!0);let u=this.getParentContainer(n);u instanceof ui&&u.addEntity(s),f(this,Bn).call(this),this.render()}else Be.error("Geometry group with ID '".concat(t,"' already exists. The geometry group cannot be added."));return f(this,ge).outlineInterpolationSystem.geometries3DDirty=!0,{id:t,type:"geometry-group"}}addOccluder(t,e){let r=this.getParentContainer(e),n=f(this,ge).occlusion2DSystem.reserveOccluderId();return r?.addOccluderFeature(t,n),n}addImage(t,e,r,n){try{EWe(t,e,r)}catch(i){Be.error(i);return}if(!f(this,xe).geometry3DMap.has(t)&&!f(this,xe).geometry2DMap.has(t)){let i=new IWe(e),a=new Cn(i,new ug(r));a.id=t||Wn(),i.mesh.userData={entityId:a.id,type:"path"},f(this,xe).geometry3DMap.set(a.id,a);let o=this.getParentContainer(n);o instanceof ui&&o.addEntity(a),f(this,Bn).call(this),this.render()}else Be.error("Image with ID '".concat(t,"' already exists. The image cannot be added."));return{id:t,type:"image"}}addModelGroup(t,e,r,{parent:n,onComplete:i}={}){var a,o;try{hZe(t,e,r)}catch(s){Be.error(s);return}if(!f(this,xe).geometry3DMap.has(t)&&!f(this,xe).geometry2DMap.has(t)){let s=new _o(t);s.addEventListener("childadded",()=>{f(this,Bn).call(this),f(this,fa).call(this)}),s.addEventListener("childremoved",()=>{f(this,Bn).call(this),f(this,fa).call(this)}),f(this,xe).geometry3DMap.set(t,s),s.userData.dirty=!0,s.userData.modelURL=r.url;for(let u of e.features){let c=u.id||u.properties.id||Wn(),h=f(this,ge).meshOptimizationSystem.createModelFromFeature(c,u,ae({},r));(u.properties.interactive!==void 0||r.interactive!=null)&&ja(h,(a=u.properties.interactive)!=null?a:r.interactive,f(this,xe)),r.clippingPlaneZOffset!=null&&(h.components[7]=new gq,h.components[7].verticalOffset=r.clippingPlaneZOffset),h.parentId=s.userData.entityId,f(this,xe).geometry3DMap.set(c,h),s.userData.entities3D.add(c)}let l=this.getParentContainer(n);l instanceof ui&&l.addEntity(s),f(this,Bn).call(this),(o=this.render())==null||o.then(i)}else Be.error("Model group with ID '".concat(t,"' already exists. The model group cannot be added."));return{id:t,type:"geometry-group"}}addMarker2D(t,e,r,n){var i;let a=r?.id;try{t6e(t,e,r||{})}catch(o){Be.error(o);return}if(a===void 0||!f(this,xe).geometry2DMap.has(a)&&!f(this,xe).geometry3DMap.has(a)){let o=ot(this,gl,k6).call(this,t,new Um(e,r),r?.occluderId,r?.verticalOffset);o.id=a||String(o.id),a=o.id,r?.interactive!=null&&r.interactive!=="pointer-events-auto"&&ja(o,r?.interactive,f(this,xe)),r?.enabled!=null&&oI(o,r.enabled);let s=typeof r?.attachTo=="string"||typeof r?.attachTo=="number"?f(this,xe).geometry3DMap.get(r.attachTo):void 0;s instanceof Cn&&s.attach(o),(i=this.getParentContainer(n))==null||i.addEntity(o),this.render()}else Be.error("Marker2D with ID '".concat(a,"' already exists. The marker cannot be added."));return{id:a,type:"marker"}}addText3D(t,e,r,n){if(!f(this,xe).geometry3DMap.has(t)&&!f(this,xe).geometry2DMap.has(t)){let i=new r2(lt(ae({},e),{properties:lt(ae({},e.properties),{id:t,content:e.properties.text})})),a=new Cn(i,new JM(r?.appearance));a.id=t,i.mesh.userData.entityId=t.toString(),i.mesh.userData.type="text3d",f(this,xe).geometry3DMap.set(t,a);let o=this.getParentContainer(n);o instanceof ui&&o.addEntity(a),f(this,Bn).call(this),this.render()}else Be.error("Text3D with ID '".concat(t,"' already exists. The text3d cannot be added."));return{id:t,type:"text3d"}}labelText3D(t,e,r={}){var n,i;try{if(!e||!t)throw new Error("content and meshGeometryId are required");a6e.parse(r)}catch(u){Be.error(u);return}let a=f(this,xe).geometry3DMap.get(t);if(a?.type!=="geometry"){Be.error(".labelText3D failed: target incorrect");return}let o=a?.components[0];if(!o.feature.properties.textArea)return;if(o.textEntityId){let u=f(this,xe).geometry3DMap.get(o.textEntityId);if(u?.type!=="text3d"){Be.error(".labelText3D failed: existing text3d not found");return}return{id:u.id,type:u.type}}let s=new r2({type:"Feature",geometry:{coordinates:(n=o.feature.properties.textArea)==null?void 0:n.position,type:"Point"},properties:{textArea:o.feature.properties.textArea,content:e,id:Wn()}});s.polygonEntityId=t;let l=new Cn(s,new JM(r?.appearance));return o.textEntityId=l.id.toString(),s.mesh.userData.entityId=l.id.toString(),s.mesh.userData.type="text3d",f(this,xe).geometry3DMap.set(l.id.toString(),l),r.parentId&&((i=this.getParentContainer(r.parentId))==null||i.addEntity(l)),this.render(),{id:l.id,type:"text3d"}}addLabel2D(t,e,r,n){var i;let a=r?.id;try{GTe(t,e,r||{})}catch(o){Be.error(o);return}if(a===void 0||!f(this,xe).geometry2DMap.has(a)&&!f(this,xe).geometry3DMap.has(a)){let o=ot(this,gl,k6).call(this,t,new yp(e,r||{},f(this,xe)),r?.occluderId,r?.verticalOffset);o.id=a||String(o.id),a=o.id,r?.interactive!=null&&ja(o,r?.interactive,f(this,xe)),r?.enabled!=null&&oI(o,r.enabled);let s=typeof r?.attachTo=="string"||typeof r?.attachTo=="number"?f(this,xe).geometry3DMap.get(r.attachTo):void 0;s instanceof Cn&&s.attach(o),(i=this.getParentContainer(n))==null||i.addEntity(o),f(this,fa).call(this),this.render()}else Be.error("Label2D with ID '".concat(a,"' already exists. The label cannot be added."));return{id:a,type:"label"}}addPath(t,e={},r){var n,i;try{PZe(t,e||{})}catch(l){Be.error(l);return}let a=new cw(t,bq(e)),o=new Cn(a,new ug({color:(n=e?.color)!=null?n:"#ff834c",altitude:(i=e?.verticalOffset)!=null?i:.1}));o.id=e?.id||Wn(),a.mesh.userData={entityId:o.id,type:"path"},f(this,xe).geometry3DMap.set(o.id,o),e?.interactive!=null&&ja(o,e?.interactive,f(this,xe));let s=this.getParentContainer(r);return s instanceof ui&&s.addEntity(o),f(this,Bn).call(this),this.render(),{id:o.id,type:"path"}}updateWatermark(t){f(this,ge).watermarkSystem.options=t,f(this,ge).watermarkSystem.dirty=!0,f(this,ge).collisionSystem.collidersDirty=!0,this.render()}remove(t){var e,r;let n;if(typeof t=="string"||typeof t=="number"?(n=f(this,xe).geometry2DMap.get(t),n==null&&(n=f(this,xe).geometry3DMap.get(t))):typeof t.id=="string"||typeof t.id=="number"?(n=f(this,xe).geometry2DMap.get(t.id),n==null&&(n=f(this,xe).geometry3DMap.get(t.id))):n=t,n!=null){if(n.type==="custom-geometry")f(this,xe).geometry3DMap.delete(n.id),n.object3d&&ya(n.object3d);else if(n.type==="group-container"){f(this,xe).geometry3DMap.delete(n.userData.entityId);for(let a of n.childrenIds.values())this.remove(a),n.userData.entities2D.delete(a);let i=n.components[1];i&&i.focusMesh&&ya(i.focusMesh),ya(n)}else if(n.type==="geometry-group"){f(this,xe).geometry3DMap.delete(n.userData.entityId);for(let i of n.userData.entities3D.values())this.remove(i),n.userData.entities3D.delete(i);ya(n)}else if(n.type==="geometry"||n.type==="model"||n.type==="path"){let i=n.components[0],a=n.components[4];if(n.entities2D.size>0){for(let s of n.entities2D.values())this.remove(s);n.removeAllEntities()}let o=(r=(e=n.parentObject3D)==null?void 0:e.userData.entityId)!=null?r:n.parentId;if(o){let s=f(this,xe).geometry3DMap.get(o);s instanceof _o&&s.userData.entities3D.delete(n.id)}if(n.object3d&&ya(n.object3d),n.type==="geometry"){let s=n.components[3];s&&(s.enabled=!1,s.dirty=!0)}a&&"focusMesh"in a&&a.focusMesh!=null&&ya(a.focusMesh),"textMesh"in i&&i.textMesh!=null&&this.remove(i.textMesh.userData.entityId),f(this,xe).geometry3DMap.delete(n.id)}else if(n.type==="marker"||n.type==="label"){let i=n.attachedTo;if(i){let a=f(this,xe).geometry3DMap.get(i);a instanceof Cn&&a.detach(n)}n.object3d&&ya(n.object3d),n.type==="label"&&delete f(this,ge).twoDDrawSystem.textCache[n.id],f(this,xe).geometry2DMap.delete(n.id)}else if(n.type==="image")n.object3d&&ya(n.object3d),f(this,xe).geometry3DMap.delete(n.id);else if(n.type==="text3d"){ya(n.object3d);let{batchedText:i,textMesh:a,polygonEntityId:o}=n.components[0];if(a&&(i&&i.removeText(a),ya(a)),o){f(this,ge).text3DSystem.remove(o);let s=f(this,xe).geometry3DMap.get(o);s?.type==="geometry"&&(s.components[0].textMesh=void 0,s.components[0].textEntityId=void 0)}f(this,xe).geometry3DMap.delete(n.id)}f(this,Bn).call(this),f(this,fa).call(this),this.render()}}getScene(){return this.getState("__scene")}getThreeScene(){return f(this,Mi)}getThreeCamera(){return f(this,pi)}async setEnvironment(t){if(f(this,Mi))if(t==="basic"){f(this,bm)||ne(this,bm,ot(this,gl,O6).call(this));let e=await f(this,bm);f(this,Mi).environment=e}else f(this,Mi).environment=null}getEnvironment(){var t;return(t=f(this,Mi))!=null&&t.environment?"basic":!1}getCurrentSceneGLTF(t){return f(this,ge).exporterSystem.getCurrentSceneGLTF(t)}getBoundingArea(t){(f(this,ge).renderSystem.threeDdirty||f(this,ge).renderSystem.twoDdirty)&&this.renderSync();let e=new qn;if(t==null)e.setFromObject(f(this,xe).geometryScene);else{let r=Xf(f(this,xe),t);if(r?.type==="geometry"&&r?.object3d!=null){let n=r.components[0],i=n instanceof Xa?n.geometry:void 0;n.mesh instanceof wP&&i?(i.computeBoundingBox(),i.boundingBox&&e.union(i.boundingBox)):e.setFromObject(r.object3d)}else(r?.type==="geometry-group"||r?.type==="group-container")&&r?.userData.entityId!=null&&e.setFromObject(r)}if(Bv(e))return K6e(e).map(this.convert3DMapPositionToCoordinate)}hasState(t){return Xf(f(this,xe),t)!=null}getState(t){var e,r,n,i,a,o,s,l,u,c,h,d,p,m,y,v,_;if(t==null)return{type:"map-view",hoverColor:f(this,xe).hoverColor,text3dHoverColor:f(this,xe).text3dHoverColor};let w=Xf(f(this,xe),t);if(w?.type==="custom-geometry"){let b=w.components[0],A=w.components[1];return{id:w.id,type:"custom-geometry",visible:A.visible,altitude:A.altitude,parent:(e=w.parentObject3D)==null?void 0:e.userData.entityId,position:this.convert3DMapPositionToCoordinate(b.position)}}else if(w?.type==="geometry-group"){let b=Array.from(w.userData.entities3D.values()),A=b?.[0],E=A?this.getState(A):{};return{id:w.userData.entityId,type:"geometry-group",visible:w.visible,altitude:E?.altitude,initialColor:E?.initialColor,color:E?.color,side:(r=E?.side)!=null?r:"double",opacity:E?.opacity,height:E?.height,texture:E?.texture,topColor:E?.topColor,topTexture:E?.topTexture,interactive:Array.from(w.userData.entities3D.values()).map(M=>f(this,xe).geometry3DMap.get(M)).every(M=>M&&M.components[2]!=null),children:b,bevel:E?.bevel}}else{if(w?.type==="group-container")return{id:w.userData.entityId,type:"group-container",visible:w.visible,altitude:(n=w.getWorldPosition(IHe).z)!=null?n:0,opacity:w.opacity,interactive:!!w.components[0],children:Array.from(w.childrenIds.values()).map(b=>this.getState(b)).filter(Boolean)};if(w?.type==="label"){let b=w.components[0],A=w.object3d.parent,E=A?.userData.entityId;return{id:w.id,type:"label",text:b.text||"",parent:{id:E,type:A?.type},position:this.convert3DMapPositionToCoordinate(w.position),enabled:b.enabled,visible:b.visible,initialRank:ub(b.initialRank),options:{rank:ub(b.rank),appearance:b.appearance,interactive:w.components[1]!=null,verticalOffset:w.verticalOffset,attachTo:w.attachedTo}}}else if(w?.type==="marker"){let b=w.components[0],A=w.object3d.parent,E=A?.userData.entityId;return{id:w.id,type:"marker",enabled:b.enabled,visible:b.visible,placement:b.options.placement,dynamicResize:b.options.dynamicResize,parent:{id:E,type:A?.type},position:this.convert3DMapPositionToCoordinate(w.position),element:b.containerEl,initialRank:ub(b.initialRank),contentHTML:b.contentHtml,options:{rank:ub(b.rank),interactive:w.components[1]!=null||!1,verticalOffset:w.verticalOffset,attachTo:w.attachedTo,lowPriorityPin:b.options.lowPriorityPin}}}else if(w?.type==="geometry"){let{color:b,hoverColor:A,initialColor:E,initialTopColor:M,topColor:P,altitude:k}=w.components[1],D=w.components[0],O=w.components[4],B=w.components[1],L=w.components[6],R=w.components[2],T=w.components[3],N=w.parentObject3D;return{id:w.id,type:"geometry",opacity:B.opacity,initialColor:E,color:b,focusable:O!=null&&O.focusMesh!=null,initialTopColor:M,topColor:P,side:B.side,hoverColor:A,hovered:!!(R!=null&&R.hover),height:B.height,visible:B.visible,outline:T?.enabled,showImage:B.showImage,texture:(i=L?.texture)==null?void 0:i.path,topTexture:(a=L?.topTexture)==null?void 0:a.path,flipImageToFaceCamera:B.flipImageToFaceCamera,enableImageCollisions:B.enableImageCollisions,parent:{id:N?.userData.entityId,type:N?.type},altitude:k,bevel:B.bevel,position:this.convert3DMapPositionToCoordinate(D.position),interactive:w.components[2]!=null,borderVisible:B.borderVisible,borderColor:B.borderColor,borderWidth:B.borderWidth}}else if(w?.type==="model"){let b=w.components[0],A=w.components[1],E=w.components[2];return{id:w.id,type:"model",position:b.mesh?this.convert3DMapPositionToCoordinate((o=b.mesh)==null?void 0:o.getWorldPosition(new Q)):this.convert3DMapPositionToCoordinate(b.position),interactive:E!=null,material:A.material,parent:(s=w.parentObject3D)!=null&&s.parent?{id:w.parentObject3D.parent.userData.entityId,type:w.parentObject3D.parent.type}:void 0,visible:A.visible,verticalOffset:A.verticalOffset,color:A.color,opacity:A.opacity,rotation:(l=A.rotation)!=null?l:h2,scale:(u=A.scale)!=null?u:c2}}else if(w?.type==="path"){let b=w.components[0],A=w.components[2],E=w.components[1];return{id:w.id,type:"path",position:this.convert3DMapPositionToCoordinate(b.position),visible:E.visible,interactive:A!=null,completeFraction:b.completeFraction,color:E.color,accentColor:b.accentColor,width:b.width,animateArrowsOnPath:b.animateArrowsOnPath,displayArrowsOnPath:b.displayArrowsOnPath,verticalOffset:E.altitude,highlightCompleteFraction:b.highlightCompleteFraction,highlightStartFraction:b.highlightStartFraction,highlightEndFraction:b.highlightEndFraction,highlightColor:b.highlightColor,highlightWidthMultiplier:b.highlightWidthMultiplier}}else if(w?.type==="image"){let b=w.components[0];return{id:w.id,type:"image",position:this.convert3DMapPositionToCoordinate(b.position),visible:w.components[1].visible,verticalOffset:(c=b.feature.properties.verticalOffset)!=null?c:0,opacity:w.components[1].opacity,flipImageToFaceCamera:w.components[1].flipImageToFaceCamera,width:(h=b.feature.properties.width)!=null?h:0,height:(d=b.feature.properties.height)!=null?d:0,rotation:(p=b.feature.properties.rotation)!=null?p:0}}else if(w?.type==="text3d"&&w.components[0]instanceof r2&&"textArea"in w.components[0].feature.properties){T6e(w);let b=w.components[0],A=w.components[1],{textMesh:E}=b,M=(m=b.mesh)==null?void 0:m.parent;M instanceof ui&&((y=M.children.find(k=>k.type==="batchedtext"))==null||y.getWorldPosition(f(this,Pw))),f(this,Ev).set(0,0,0);let P=E?E.getWorldPosition(f(this,Ev)):f(this,Ev);return Object.assign({},jv,A.getState(),{id:w.id,type:"text3d",position:this.convert3DMapPositionToCoordinate(P.add(f(this,Pw))),visible:(v=b.visible)!=null?v:!1,content:(_=b.feature.properties.content)!=null?_:""})}else return}}setState(t,e){var r,n;if(typeof t=="object"&&e==null){"hoverColor"in t&&(tg(t.hoverColor)?f(this,xe).hoverColor=(r=t.hoverColor)!=null?r:f(this,xe).hoverColor:Be.warn('Failed to update global hover color. Invalid color "'.concat(t.hoverColor,'".'))),"text3dHoverColor"in t&&(f(this,xe).text3dHoverColor=(n=t.text3dHoverColor)!=null?n:f(this,xe).text3dHoverColor);return}let i=Xf(f(this,xe),t);if(i!=null){if(i.type==="custom-geometry"){let a=f(this,xe).geometry3DMap.get(i.id);if(a instanceof Cn&&a.components[0]instanceof EI){let o=e;_c(i,f(this,xe),o.visible),Wf(i,f(this,xe),o.altitude),L8(i,o.position,this.convertTo3DMapPosition),N8(i,this.getParentContainer(o.parent,!1)),ja(i,o.interactive,f(this,xe))&&f(this,Bn).call(this)}}else if(i.type==="path"){let a=e;ja(i,a.interactive,f(this,xe))&&f(this,Bn).call(this),Wf(i,f(this,xe),a.verticalOffset),C6e(i,f(this,xe),a)}else if(i.type==="model"){let a=e;ja(i,a.interactive,f(this,xe))&&f(this,Bn).call(this),_c(i,f(this,xe),a.visible),O6e(i,a),B6e(i,a)}else if(i.type==="group-container"){let a=e;_c(i,f(this,xe),a.visible)&&(f(this,ge).pathSystem.verticalDistanceDirty=!0,f(this,ge).geometryInFocusSystem.focusablesDirty=!0),Wf(i,f(this,xe),a.altitude)&&(f(this,ge).pathSystem.verticalDistanceDirty=!0),ja(i,a.interactive,f(this,xe))&&f(this,Bn).call(this),n2(i,f(this,xe),a.opacity)&&(f(this,ge).outlineInterpolationSystem.outlineOpacitiesDirty=!0),a.preloadGeometry&&i.userData.preloadGeometry!==!0&&(i.userData.preloadGeometry=!0,f(this,ge).outlineInterpolationSystem.geometries3DDirty=!0),sI(i,a.focusable)&&(f(this,ge).geometryInFocusSystem.focusablesDirty=!0)}else if(i.type==="geometry-group"){let a=e;_c(i,f(this,xe),a.visible),f6e(i,f(this,xe),a),ZM(i,f(this,xe),a.outline),a.height!=null&&GM(i,f(this,xe),a.height),Wf(i,f(this,xe),a.altitude),U8(i,f(this,xe),a)&&(f(this,ge).textureSystem.dirty=!0),U8(i,f(this,xe),a),g6e(i,f(this,xe),a.shading),n2(i,f(this,xe),a.opacity)&&(f(this,ge).outlineInterpolationSystem.outlineOpacitiesDirty=!0),ja(i,a.interactive,f(this,xe))&&(f(this,Bn).call(this),f(this,fa).call(this)),WM(i,f(this,xe),a.side)}else if(i.type==="geometry"){if(i.components[0]instanceof Xa){let a=e;_c(i,f(this,xe),a.visible),ZM(i,f(this,xe),a.outline),y6e(i,a),sI(i,a.focusable)&&(f(this,ge).geometryInFocusSystem.focusablesDirty=!0),E6e(i,a.renderOrder)&&(f(this,ge).meshDetachmentSystem.dirty=!0),S6e(i,a.opacity)&&(f(this,ge).meshDetachmentSystem.dirty=!0,f(this,ge).interactionSystem.dirty3D=!0,f(this,ge).outlineInterpolationSystem.outlineOpacitiesDirty=!0),$8(i,a.flipImageToFaceCamera),A6e(i,a.enableImageCollisions),Wf(i,f(this,xe),a.altitude),a.height!=null&&GM(i,f(this,xe),a.height),xq(i,a)&&(f(this,ge).meshDetachmentSystem.dirty=!0,f(this,ge).textureSystem.dirty=!0),$k(i,a),b6e(i,a.hoverColor),ja(i,a.interactive,f(this,xe)),w6e(i,a.hovered),WM(i,f(this,xe),a.side),I6e(i,a)}f(this,Bn).call(this)}else if(i.type==="label"||i.type==="marker"){let a=e;x6e(i,e,f(this,xe)),v6e(i,e,f(this,xe))&&(f(this,fa).call(this),f(this,ge).domMutationSystem.dirty=!0),L8(i,a.position,this.convertTo3DMapPosition),N8(i,this.getParentContainer(a.parent,!1))&&(f(this,fa).call(this),f(this,ge).panBoundsSystem.dirty=!0),oI(i,a.enabled),_c(i,f(this,xe),a.visible)}else if(i.type==="image"){let a=e;_c(i,f(this,xe),a.visible),n2(i,f(this,xe),a.opacity),$8(i,a.flipImageToFaceCamera)}else if(i.type==="text3d"){let a=e;D6e(i,f(this,xe),a)}this.render()}}convertTo3DMapPosition(t,e,r=0,n){var i,a,o,s,l;if(Array.isArray(t))return this.convertTo3DMapPosition(t[1],t[0],(i=t[2])!=null?i:r,typeof e=="function"?e:void 0);if(typeof e!="number")throw new Error("convertTo3DMapPosition failed: longitude must be a number");let{x:u,y:c}=Tq((o=(a=f(this,xe).center)==null?void 0:a[1])!=null?o:0,(l=(s=f(this,xe).center)==null?void 0:s[0])!=null?l:0,t,e);return n?(n.set(u,c,r),n):new Q(u,c,r)}get backgroundColor(){return typeof f(this,pa).backgroundColor=="string"?f(this,pa).backgroundColor:"#".concat(f(this,pa).backgroundColor.getHexString())}get backgroundAlpha(){return f(this,pa).backgroundAlpha}getThreeRenderer(){return f(this,pa)}getCenter(t){let e=Array.isArray(t)?t:this.getBoundingArea(t);return e?cPe(e):void 0}isInView(t){let e=Xf(f(this,xe),t);if(f(this,Mw).identity().multiply(f(this,pi).projectionMatrix).multiply(f(this,pi).matrixWorldInverse),f(this,Em).setFromProjectionMatrix(f(this,Mw)),e instanceof Ug)return f(this,Em).containsPoint(e.position);if(e instanceof Cn){let r=e?.components[0];if(r instanceof EI||r instanceof lw)return f(this,Em).containsPoint(this.convertTo3DMapPosition(r.feature.geometry.coordinates));if(r instanceof Xa){let n=new qn(this.convertTo3DMapPosition(r.featureBbox[1],r.featureBbox[0],0),this.convertTo3DMapPosition(r.featureBbox[3],r.featureBbox[2],0));return f(this,Em).intersectsBox(n)}}return!1}queryGeometry2DInView(t){let{screenOffsets:e,fullyContains:r}=t??{},[n,i,a,o]=mPe(this.container,e),s=new vn(n,i,a,o);return f(this,ge).collisionSystem.visibleCollidersQTree.queryRect(s).filter(l=>r?s.contains(l):s.intersects(l)).map(l=>f(this,xe).geometry2DMap.get(l.userData.entityId)).filter(l=>l!=null).filter(l=>l.components[0]instanceof yp||l.components[0]instanceof Um).map(l=>l.id.toString())}onMapLibreEvent(t,e){if(!this.map){Be.warn('Tried to add event listener "'.concat(t,'" but MapLibre map is not initialized.'));return}this.map.on(t,e),f(this,yl)[t]=f(this,yl)[t]||[],f(this,yl)[t].push(e)}offMapLibreEvent(t,e){!this.map||!Array.isArray(f(this,yl)[t])||(this.map.off(t,e),f(this,yl)[t]=f(this,yl)[t].filter(r=>r!==e))}get aborted(){return f(this,Am).signal.aborted}onAbort(t){f(this,Am).signal.addEventListener("abort",t,{once:!0})}getSystems(){return f(this,ge)}getInternalState(){return f(this,xe)}getInternalTweenGroup(){return f(this,xe).internalTweenGroup}getExternalTweenGroup(){return f(this,xe).externalTweenGroup}computeMinZOffsetBetweenContainers(t,e,r){if(!t||!e)return-1;x4(t,"group-container"),x4(e,"group-container");let n=uI(t,this.getThreeCamera()),i=e.clone(),a=uI(i,this.getThreeCamera());if(!Bv(n)||!Bv(a))return-1;let o=0,s;r&&this.container.querySelectorAll(".debug-box").forEach(l=>l.remove());do{if(o>1e4)return-1;if(o+=20,i.position.z=o,i.updateMatrixWorld(),a.makeEmpty(),uI(i,f(this,pi),a),s=n.intersectsBox(a),r){let l=X8(n,"blue",this.container),u=X8(a,s?"red":"green",this.container);l.classList.add("debug-box"),u.classList.add("debug-box")}}while(s);return o}};Mi=new WeakMap,pi=new WeakMap,bm=new WeakMap,xw=new WeakMap,bv=new WeakMap,ep=new WeakMap,wm=new WeakMap,wv=new WeakMap,gl=new WeakSet,P6=function(t){var e;f(this,Gh)!=="outdoors-overlay"&&((e=this.map)==null||e.setPixelRatio(t)),f(this,xe).pixelRatio=this.resolutionScale},xe=new WeakMap,yl=new WeakMap,Am=new WeakMap,yn=new WeakMap,lu=new WeakMap,Ci=new WeakMap,El=new WeakMap,pa=new WeakMap,ge=new WeakMap,bw=new WeakMap,fa=new WeakMap,Bn=new WeakMap,lre=function(){ne(this,yn,document.createElement("div")),f(this,yn).classList.add("mappedin__smart-collision-engine__container"),ne(this,lu,document.createElement("canvas")),f(this,lu).classList.add("mappedin__smart-collision-engine-debug__container"),this.container.appendChild(f(this,yn)),ne(this,Ci,document.createElement("canvas")),f(this,Ci).classList.add("mappedin__smart-collision-engine__container"),f(this,Ci).width=f(this,yn).clientWidth*this.resolutionScale,f(this,Ci).height=f(this,yn).clientHeight*this.resolutionScale,f(this,Ci).style.width=f(this,yn).clientWidth+"px",f(this,Ci).style.height=f(this,yn).clientHeight+"px",f(this,yn).appendChild(f(this,lu)),f(this,yn).appendChild(f(this,Ci)),f(this,lu).width=f(this,yn).clientWidth,f(this,lu).height=f(this,yn).clientHeight,f(this,Ci).width=f(this,yn).clientWidth*this.resolutionScale,f(this,Ci).height=f(this,yn).clientHeight*this.resolutionScale,f(this,Ci).style.width=f(this,yn).clientWidth+"px",f(this,Ci).style.height=f(this,yn).clientHeight+"px"},ure=function(){ne(this,El,document.createElement("div")),f(this,El).classList.add("mappedin-2d-entities"),Object.assign(f(this,El).style,{position:"absolute",top:"0",left:"0",bottom:"0",right:"0",pointerEvents:"none","transform-style":"preserve-3d"}),this.container.appendChild(f(this,El))},cre=function(){f(this,Ci).width=f(this,yn).clientWidth*this.resolutionScale,f(this,Ci).height=f(this,yn).clientHeight*this.resolutionScale,f(this,Ci).style.width=f(this,yn).clientWidth+"px",f(this,Ci).style.height=f(this,yn).clientHeight+"px",f(this,lu).width=f(this,yn).clientWidth,f(this,lu).height=f(this,yn).clientHeight,f(this,Ci).width=f(this,yn).clientWidth*this.resolutionScale,f(this,Ci).height=f(this,yn).clientHeight*this.resolutionScale,f(this,Ci).style.width=f(this,yn).clientWidth+"px",f(this,Ci).style.height=f(this,yn).clientHeight+"px",f(this,ge).collisionSystem.collidersDirty=!0},Gh=new WeakMap,ww=new WeakMap,Aw=new WeakMap,Sw=new WeakMap,Ew=new WeakMap,Av=new WeakMap,D6=new WeakMap,Iw=new WeakMap,Sv=new WeakMap,Cw=new WeakMap,Sm=new WeakMap,k6=function(t,e,r,n){let i=new Ug(e,this.convertTo3DMapPosition(t[1],t[0],t[2]||0),n);return i.occluderId=r??f(this,ge).occlusion2DSystem.backgroundId,f(this,xe).geometry2DMap.set(i.id,i),i},Em=new WeakMap,Mw=new WeakMap,Tw=new WeakMap,Ro=new WeakMap,Lo=new WeakMap,O6=async function(){return hS.load(kGe).then(t=>{var e;return f(this,Mi)&&((e=f(this,Mi).environment)==null||e.dispose(),t.mapping=e4,f(this,Mi).environment=t,this.render()),t})},B6=new WeakMap,z6=new WeakMap,Ev=new WeakMap,Pw=new WeakMap;var IHe=new Q,PL=EHe;C();function mit(t,e){CHe(t,e)(t.getScene(),e),MHe(t,e),e.addFolder("Export").add({export:async()=>{let i=await t.getCurrentSceneGLTF({binary:!0}),a=new Blob([i],{type:"application/octet-stream"});var o=document.createElement("a");document.body.appendChild(o),o.style.display="none";let s=window.URL.createObjectURL(a);o.href=s,o.download="scene.glb",o.click(),window.URL.revokeObjectURL(s)}},"export");let r=e.addFolder("Camera"),n={get bearing(){return t.camera.bearing},set bearing(i){t.camera.setBearing(i)},get pitch(){return t.camera.pitch},set pitch(i){t.camera.setPitch(i)},get zoomLevel(){return t.camera.zoomLevel},set zoomLevel(i){t.camera.setZoomLevel(i)}};r.add(n,"bearing",-359,359,1),r.add(n,"pitch",t.camera.minPitch,t.camera.maxPitch,1),r.add(n,"zoomLevel",t.camera.minZoomLevel,t.camera.maxZoomLevel,.1)}function CHe(t,e){let r=e;return function n(i,a){let o=a.addFolder("".concat([i.type]," ").concat(i.id.slice(0,16)));if(a.close(),i.type==="geometry"||i.type==="model"||i.type==="path"||i.type==="image"){let s={get height(){let l=t.getState(i.id);return l?.type==="geometry"?l.height:0},set height(l){let u=t.getState(i.id);u?.type==="geometry"&&t.setState(i,{height:l})},set flipImageToFaceCamera(l){let u=t.getState(i.id);u?.type==="image"&&t.setState(i,{flipImageToFaceCamera:l})},get flipImageToFaceCamera(){let l=t.getState(i.id);return l?.type==="image"?l.flipImageToFaceCamera:!1},set visible(l){let u=t.getState(i.id);(u?.type==="geometry"||u?.type==="path"||u?.type==="image")&&t.setState(i,{visible:l})},get visible(){let l=t.getState(i.id);return l?.type==="geometry"||l?.type==="path"||l?.type==="image"?l.visible:!1},set outline(l){let u=t.getState(i.id);u?.type==="geometry"&&t.setState(i,{outline:l})},get outline(){let l=t.getState(i.id);return l?.type==="geometry"?l.outline:!1},get opacity(){let l=t.getState(i.id);return l?.type==="geometry"?l.opacity:1},set opacity(l){let u=t.getState(i.id);u?.type==="geometry"&&t.setState(u,{opacity:l})},get color(){let l=t.getState(i.id);return l?.type==="geometry"&&l.color?Vt(l.color).toHexString():"#ffffff"},set color(l){let u=t.getState(i.id);u?.type==="geometry"&&t.setState(u,{color:l})},set interactive(l){let u=t.getState(i.id);(u?.type==="geometry"||u?.type==="model"||u?.type==="path")&&(t.setState(i,{interactive:l}),r.controllersRecursive().forEach(c=>c.updateDisplay()))},get interactive(){let l=t.getState(i.id);return l?.type==="geometry"||l?.type==="model"||l?.type==="path"?l.interactive:!1},get completeFraction(){let l=t.getState(i.id);return l?.type==="path"?l.completeFraction:1},set completeFraction(l){let u=t.getState(i.id);u?.type==="path"&&t.setState(u,{completeFraction:l})},focus:()=>{}};o.add(s,"focus").onChange(()=>{let l=t.getState(i.id);l?.type==="model"||l?.type==="path"||l?.type==="image"?t.camera.focusOn([l.position]):l?.type==="geometry"&&t.camera.focusOn(t.getBoundingArea(l))}),o.add(s,"visible"),i.type==="image"?o.add(s,"flipImageToFaceCamera"):(o.add(s,"interactive"),i.type==="path"&&o.add(s,"completeFraction",0,1,.1),i.type!=="model"&&(o.addColor(s,"color"),o.add(s,"outline"))),i.type==="geometry"&&(o.add(s,"height"),o.add(s,"opacity",0,1,.1))}else if(i.type==="marker"){let s={get interactive(){var l;let u=t.getState(i.id);return u?.type==="marker"?(l=u.options)==null?void 0:l.interactive:!1},set interactive(l){let u=t.getState(i.id);u?.type==="marker"&&(t.setState(u,{options:{interactive:l}}),r.controllersRecursive().forEach(c=>c.updateDisplay()))},focus:()=>{}};o.add(s,"focus").onChange(()=>{let l=t.getState(i.id);l?.type==="marker"&&t.camera.focusOn([l.position])}),o.add(s,"interactive")}else if(i.type==="label"){let s={get interactive(){var l;let u=t.getState(i.id);return u?.type==="label"?(l=u.options)==null?void 0:l.interactive:!1},set interactive(l){let u=t.getState(i.id);u?.type==="label"&&(t.setState(u,{options:{interactive:l}}),r.controllersRecursive().forEach(c=>c.updateDisplay()))},get text(){let l=t.getState(i.id);return l?.type==="label"?l.text:""},set text(l){let u=t.getState(i.id);u?.type==="label"&&t.setState(u,{text:l})},get"Text Color"(){var l;let u=t.getState(i.id);return u?.type==="label"?(l=u.options.appearance)==null?void 0:l.textColor:"#000000"},set"Text Color"(l){let u=t.getState(i.id);u?.type==="label"&&t.setState(i.id,{text:s.text,options:{appearance:{textColor:l}}})},get"Text Size"(){var l;let u=t.getState(i.id);return u?.type==="label"?(l=u.options.appearance)==null?void 0:l.textSize:10},set"Text Size"(l){let u=t.getState(i.id);u?.type==="label"&&t.setState(u,{text:s.text,options:{appearance:{textSize:l}}})},get"Icon Size"(){var l;let u=t.getState(i.id);return u?.type==="label"?(l=u.options.appearance)==null?void 0:l.iconSize:10},set"Icon Size"(l){let u=t.getState(i.id);u?.type==="label"&&t.setState(u,{text:s.text,options:{appearance:{iconSize:l}}})},get"Pin Color"(){var l;let u=t.getState(i.id);return u?.type==="label"?(l=u.options.appearance)==null?void 0:l.pinColor:"#000000"},set"Pin Color"(l){let u=t.getState(i.id);u?.type==="label"&&t.setState(u,{text:s.text,options:{appearance:{pinColor:l}}})},get"Pin Color Inactive"(){var l;let u=t.getState(i.id);return u?.type==="label"?(l=u.options.appearance)==null?void 0:l.pinColorInactive:"#000000"},set"Pin Color Inactive"(l){let u=t.getState(i.id);u?.type==="label"&&t.setState(u,{text:s.text,options:{appearance:{pinColorInactive:l}}})},get"Pin Outline Color"(){var l;let u=t.getState(i.id);return u?.type==="label"?(l=u.options.appearance)==null?void 0:l.pinOutlineColor:"#000000"},set"Pin Outline Color"(l){let u=t.getState(i.id);u?.type==="label"&&t.setState(u,{text:s.text,options:{appearance:{pinOutlineColor:l}}})},get"Pin Outline Color Inactive"(){var l;let u=t.getState(i.id);return u?.type==="label"?(l=u.options.appearance)==null?void 0:l.pinOutlineColorInactive:"#000000"},set"Pin Outline Color Inactive"(l){let u=t.getState(i.id);u?.type==="label"&&t.setState(u,{text:s.text,options:{appearance:{pinOutlineColorInactive:l}}})},focus:()=>{}};o.add(s,"focus").onChange(()=>{let l=t.getState(i.id);l?.type==="label"&&t.camera.focusOn([l.position])}),o.add(s,"interactive"),o.add(s,"text"),o.add(s,"Text Size",10,50),o.add(s,"Icon Size",10,50),o.addColor(s,"Text Color"),o.addColor(s,"Active Background Color"),o.addColor(s,"Inactive Background Color"),o.addColor(s,"Active Foreground Color"),o.addColor(s,"Inactive Foreground Color")}else if(i.type==="geometry-group"){let s={get opacity(){let l=t.getState(i.id);return l?.type==="geometry-group"?l.opacity:1},set opacity(l){let u=t.getState(i.id);u?.type==="geometry-group"&&t.setState(i,{opacity:l})},set visible(l){let u=t.getState(i.id);u?.type==="geometry-group"&&t.setState(i,{visible:l})},get visible(){let l=t.getState(i.id);return l?.type==="geometry-group"?l.visible:!1},set outline(l){let u=t.getState(i.id);u?.type==="geometry-group"&&t.setState(i,{outline:l})},get outline(){let l=t.getState(i.id);return l?.type==="geometry-group"?l.outline:!1},set altitude(l){let u=t.getState(i.id);u?.type==="geometry-group"&&t.setState(i,{altitude:l})},get altitude(){let l=t.getState(i.id);return l?.type==="geometry-group"?l.altitude:0},set interactive(l){let u=t.getState(i.id);u?.type==="geometry-group"&&(t.setState(i,{interactive:l}),r.controllersRecursive().forEach(c=>c.updateDisplay()))},get interactive(){let l=t.getState(i.id);return l?.type==="geometry-group"?l.interactive:!1},get shadingStart(){var l,u;let c=t.getState(i.id);return c?.type==="geometry-group"&&(u=(l=c.shading)==null?void 0:l.start)!=null?u:0},set shadingStart(l){let u=t.getState(i.id);u?.type==="geometry-group"&&t.setState(u,{shading:{start:l}})},get shadingEnd(){var l,u;let c=t.getState(i.id);return c?.type==="geometry-group"&&(u=(l=c.shading)==null?void 0:l.end)!=null?u:0},set shadingEnd(l){let u=t.getState(i.id);u?.type==="geometry-group"&&t.setState(u,{shading:{end:l}})},get shadingIntensity(){var l,u;let c=t.getState(i.id);return c?.type==="geometry-group"&&(u=(l=c.shading)==null?void 0:l.intensity)!=null?u:0},set shadingIntensity(l){let u=t.getState(i.id);u?.type==="geometry-group"&&t.setState(u,{shading:{intensity:l}})}};o.add(s,"visible"),o.add(s,"opacity",0,1,.1),o.add(s,"interactive"),o.add(s,"outline"),o.add(s,"altitude",0,100,1),o.add(s,"shadingStart",0,1,.1),o.add(s,"shadingEnd",0,1,.1),o.add(s,"shadingIntensity",0,1,.1)}else if(i.type==="group-container"){let s={set visible(l){let u=t.getState(i.id);u?.type==="group-container"&&t.setState(i,{visible:l})},get visible(){let l=t.getState(i.id);return l?.type==="group-container"?l.visible:!1},set interactive(l){let u=t.getState(i.id);u?.type==="group-container"&&(t.setState(u,{interactive:l}),r.controllersRecursive().forEach(c=>c.updateDisplay()))},get interactive(){let l=t.getState(i.id);return l?.type==="group-container"?l.interactive:!1}};o.add(s,"visible"),o.add(s,"interactive")}if(o.close(),i.children)for(let s of i.children.values())n(s,o)}}function MHe(t,e){let r=e.addFolder("Watermark"),n={padding:16,iconOnly:!1,position:"bottom-left",color:"dark",scale:1};r.add(n,"padding",0,100,1),r.add(n,"scale",.5,1.5,.1),r.add(n,"color",["dark","light"]),r.add(n,"position",["top-left","top-right","bottom-left","bottom-right","center","top","bottom","left","right"]),r.add(n,"iconOnly"),r.onChange(()=>{t.updateWatermark(n)})}var DL="https://tiles-cdn.mappedin.com/styles/mappedin/style.json",THe="https://auth.mappedin.com/oauth2/token";async function PHe(t,e){var r,n,i,a,o,s,l,u;let c=(r=e?.useWorkers)!=null?r:!0,h=lt(ae({},e),{watermark:e?.watermark,attribution:e?.attribution,antialias:e?.antialias,occlusionEnabled:e?.occlusionEnabled,transformImageRequest:e?.transformImageRequest,naturalBearing:(n=e?.naturalBearing)!=null?n:0,imagePlacementOptions:e?.imagePlacementOptions,onWebGLContextCreationError:e?.onWebGLContextCreationError,onWebGLContextLost:e?.onWebGLContextLost,onWebGLContextRestored:e?.onWebGLContextRestored,onWebGLRendererError:e?.onWebGLRendererError,useStandaloneCamera:(i=e?.useStandaloneCamera)!=null?i:!1,useCollisionWorker:(a=e?.useCollisionWorker)!=null?a:!0,useWorkers:c});if(c===!0&&(o=e?.outdoorView)!=null&&o.enabled){let d=e.outdoorView.headers;d==null&&(d=await lPe(THe));let p=e.center||[0,0],m=new eTe({container:t,style:e.outdoorView.style||DL,center:p,attributionControl:!1,zoom:(s=e.zoomLevel)!=null?s:sre,pitch:(l=e.pitch)!=null?l:are,bearing:(u=e.bearing)!=null?u:ore,transformRequest:aPe(d),trackResize:!1,pixelRatio:e.outdoorView.lowDpi?1:u2(),canvasContextAttributes:{antialias:typeof e.antialias=="boolean"?e.antialias:!0,powerPreference:"high-performance"},interactive:!1,validateStyle:!1,centerClampedToGround:!1,boxZoom:!1,doubleClickZoom:!1,scrollZoom:!1,dragPan:!1,dragRotate:!1,keyboard:!1,touchZoomRotate:!1}),y=m.painter.context.gl,v=new PL(t,ae({center:p,zoomLevel:m.getZoom(),pitch:m.getPitch(),bearing:m.getBearing(),gl:y,map:m,mode:"outdoors-interleaved"},h)),_={center:m.getCenter().toArray(),zoom:m.getZoom(),bearing:m.getBearing(),pitch:m.getPitch(),elevation:m.getCenterElevation()};m.setMinZoom(v.camera.minZoomLevel),m.setMaxZoom(v.camera.maxZoomLevel),m.setMaxPitch(v.camera.maxPitch),m.setMinPitch(v.camera.minPitch),v.on("camera-change",B=>{_.center=B.center,_.zoom=B.zoomLevel,_.bearing=B.bearing,_.pitch=B.pitch,_.elevation=B.elevation,m.jumpTo(_)});let w=Mn.fromLngLat(p,0),b=oPe(w,v.viewCamera,()=>{v.renderSync()}),A=async()=>{m&&(m.addLayer(b),v.renderSync())};v.onMapLibreEvent("style.load",A);let E=!1,M=!1,P=()=>{m&&(E||(v.publish("outdoor-view-loaded"),E=!0),M||(M=!0,v.publish("outdoor-style-loaded")))};v.onMapLibreEvent("idle",P);let k=B=>{B&&(B.sourceDataType==="metadata"||B.sourceDataType==="visibility"||B.dataType==="style"||B.type==="terrain")&&v.getSystems().htmlControlsSystem.updateData(m)},D=B=>{m&&B&&B.dataType==="style"&&B.type==="styledata"&&(M=!1),k(B)};v.onMapLibreEvent("styledata",D),v.onMapLibreEvent("sourcedata",k),v.onMapLibreEvent("terrain",k);let O=B=>{var L;if(((L=B.error)==null?void 0:L.url)===DL){Be.error('Failed to load outdoor view style, possibly due to invalid token "'.concat(d["x-mappedin-tiles-key"],'"'));return}Be.warn(B)};return v.onMapLibreEvent("error",O),v}else return new PL(t,h)}C();C();C();C();var hre=class F6{constructor(e,r,n){S(this,"id"),S(this,"text"),S(this,"target"),S(this,"__type",F6.__type),this.id=e,this.text=r,this.target=n}static is(e){return e.__type===F6.__type}get focusTarget(){return this.target.anchorTarget}};S(hre,"__type","label");var pA=hre;C();var Im,dre=class Dw{constructor(e,r,n){S(this,"id"),K(this,Im),S(this,"__type",Dw.__type),S(this,"contentEl"),this.id=e,this.contentEl=r,ne(this,Im,n)}get target(){return f(this,Im)}get coordinate(){return f(this,Im).anchorTarget}toJSON(){return{id:this.id,__type:Dw.__type,target:this.target,coordinate:this.coordinate}}static is(e){return e.__type===Dw.__type}get focusTarget(){return this.target.anchorTarget}updateTarget(e){ne(this,Im,e)}};Im=new WeakMap,S(dre,"__type","marker");var fA=dre;C();var kw,Ow,pre=class R6{constructor(e,r,n){K(this,kw),K(this,Ow),S(this,"target"),S(this,"__type",R6.__type),ne(this,kw,e),ne(this,Ow,r),this.target=n}static is(e){return e.__type===R6.__type}get id(){return f(this,kw)}get url(){return f(this,Ow)}};kw=new WeakMap,Ow=new WeakMap,S(pre,"__type","image-3d");var fre=pre;C();var Cm,mre=class Bw{constructor(e,r,n){S(this,"id"),S(this,"groupId"),S(this,"__type",Bw.__type),K(this,Cm),this.id=e,this.groupId=r,ne(this,Cm,n)}get target(){return f(this,Cm)}static is(e){return e.__type===Bw.__type}updateTarget(e){ne(this,Cm,e)}toJSON(){return{id:this.id,__type:Bw.__type,groupId:this.groupId,target:f(this,Cm)}}};Cm=new WeakMap,S(mre,"__type","model");var gre=mre;C();var Mm,yre=class L6{constructor(e,r){S(this,"id"),S(this,"coordinates"),K(this,Mm),S(this,"__type",L6.__type),this.id=e,this.coordinates=r}static is(e){return e.__type===L6.__type}get isConnectionSegment(){return this.coordinates.length===2&&this.coordinates[0].floorId!==this.coordinates[1].floorId}get distance(){return f(this,Mm)?f(this,Mm):(ne(this,Mm,Yee(this.coordinates)),f(this,Mm))}get focusTarget(){return this.coordinates}};Mm=new WeakMap,S(yre,"__type","path-segment");var cB=yre,Tm,vre=class zw{constructor(e,r,n,i){S(this,"id"),S(this,"animation"),S(this,"coordinates"),S(this,"segments"),K(this,Tm),S(this,"__type",zw.__type),this.id=e,this.animation=r,this.coordinates=n,this.segments=i.map(({id:a,coordinates:o})=>new cB(a.toString(),o))}static is(e){return e.__type===zw.__type}get focusTarget(){return this.coordinates}get distance(){return f(this,Tm)?f(this,Tm):(ne(this,Tm,Yee(this.coordinates)),f(this,Tm))}toJSON(){return{__type:zw.__type,id:this.id,coordinates:this.coordinates,segments:this.segments}}};Tm=new WeakMap,S(vre,"__type","path");var Wv=vre;C();var DHe=7,tp,Pm,kHe=class{constructor(t,e){K(this,tp),K(this,Pm);var r;ne(this,tp,t),ne(this,Pm,(r=e?.precision)!=null?r:DHe)}toJSON(){return{center:this.center,bearing:this.bearing,pitch:this.pitch,zoomLevel:this.zoomLevel}}get center(){let t=f(this,tp).center;if(f(this,Pm)===-1)return t;let e=Ip(t.latitude,f(this,Pm)),r=Ip(t.longitude,f(this,Pm));return new Rr({latitude:e,longitude:r,floorId:t.floorId,verticalOffset:t.verticalOffset})}get bearing(){return f(this,tp).bearing}get pitch(){return f(this,tp).pitch}get zoomLevel(){return Ip(f(this,tp).zoomLevel,5)}};tp=new WeakMap,Pm=new WeakMap;C();var _re=class N6{constructor(e){S(this,"id"),S(this,"__type",N6.__type),this.id=e}static is(e){return e.__type===N6.__type}get focusTarget(){return this}};S(_re,"__type","shape");var Fw=_re;C();var xre=class $6{constructor(e,r){S(this,"id"),S(this,"target"),S(this,"__type",$6.__type),this.id=e,this.target=r}static is(e){return e.__type===$6.__type}};S(xre,"__type","text-3d");var U6=xre;C();C();C();var OHe=new Map([["search-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M1 7C1 3.68629 3.68629 1 7 1C10.3137 1 13 3.68629 13 7C13 8.29583 12.5892 9.49572 11.8907 10.4765L15.4614 14.0472C15.6567 14.2425 15.6567 14.559 15.4614 14.7543L14.7543 15.4614C14.559 15.6567 14.2424 15.6567 14.0472 15.4614L10.4765 11.8907C9.49571 12.5892 8.29583 13 7 13C3.68629 13 1 10.3137 1 7ZM7 11C4.79086 11 3 9.20914 3 7C3 4.79086 4.79086 3 7 3C9.20914 3 11 4.79086 11 7C11 9.20914 9.20914 11 7 11Z"
				stroke="none"
			/>
		</svg>`],["close-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M12.5963 1.98959C12.7916 1.79433 13.1082 1.79433 13.3034 1.98959L14.0105 2.6967C14.2058 2.89196 14.2058 3.20855 14.0105 3.40381L3.40392 14.0104C3.20866 14.2057 2.89208 14.2057 2.69682 14.0104L1.98971 13.3033C1.79445 13.108 1.79445 12.7915 1.98971 12.5962L12.5963 1.98959Z"
				stroke="none"
			/>
			<path
				d="M1.98971 3.40381C1.79445 3.20855 1.79445 2.89196 1.98971 2.6967L2.69682 1.98959C2.89208 1.79433 3.20866 1.79433 3.40392 1.98959L14.0105 12.5962C14.2058 12.7915 14.2058 13.108 14.0105 13.3033L13.3034 14.0104C13.1082 14.2057 12.7916 14.2057 12.5963 14.0104L1.98971 3.40381Z"
				stroke="none"
			/>
		</svg>`],["empty-64x40",`<svg viewBox="0 0 64 40">
			<g>
				<g clipPath="url(#clip0_499_175492)">
					<path
						d="M32 39.7032C49.6731 39.7032 64 36.5925 64 32.7552C64 28.9179 49.6731 25.8071 32 25.8071C14.3269 25.8071 0 28.9179 0 32.7552C0 36.5925 14.3269 39.7032 32 39.7032Z"
						stroke="none"
						fill="#F5F5F5"
					/>
					<path
						d="M55 13.6653L44.854 2.24866C44.367 1.47048 43.656 1 42.907 1H21.093C20.344 1 19.633 1.47048 19.146 2.24767L9 13.6663V22.8367H55V13.6653Z"
						fill="none"
					/>
					<path
						d="M41.613 16.8128C41.613 15.2197 42.607 13.9046 43.84 13.9036H55V31.9059C55 34.0132 53.68 35.7402 52.05 35.7402H11.95C10.32 35.7402 9 34.0122 9 31.9059V13.9036H20.16C21.393 13.9036 22.387 15.2167 22.387 16.8098V16.8317C22.387 18.4248 23.392 19.7111 24.624 19.7111H39.376C40.608 19.7111 41.613 18.4128 41.613 16.8198V16.8128Z"
						fill="#FAFAFA"
					/>
				</g>
				<defs>
					<clipPath id="clip0_499_175492">
						<rect width="64" height="40" fill="white" />
					</clipPath>
				</defs>
			</g>
		</svg>`],["caret-12x12",`<svg viewBox="0 0 12 12">
			<path
				stroke="none"
				d="M8.38828 5.78337L3.92578 1.93493C3.75938 1.79196 3.51562 1.92087 3.51562 2.15173V9.84861C3.51562 10.0795 3.75938 10.2084 3.92578 10.0654L8.38828 6.21696C8.51602 6.10681 8.51602 5.89353 8.38828 5.78337Z"
			/>
		</svg>`],["plus-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M7.5 1C7.22386 1 7 1.22386 7 1.5V7H1.5C1.22386 7 1 7.22386 1 7.5L1 8.5C1 8.77614 1.22386 9 1.5 9H7V14.5C7 14.7761 7.22386 15 7.5 15H8.5C8.77614 15 9 14.7761 9 14.5V9H14.5C14.7761 9 15 8.77614 15 8.5V7.5C15 7.22386 14.7761 7 14.5 7H9V1.5C9 1.22386 8.77614 1 8.5 1H7.5Z"
				stroke="none"
			/>
		</svg>`],["recenter-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M0 2.5C0 2.22386 0.223858 2 0.5 2H1.5C1.77614 2 2 2.22386 2 2.5V13.5C2 13.7761 1.77614 14 1.5 14H0.5C0.223858 14 0 13.7761 0 13.5V2.5Z" />
				<path
					fillRule="evenodd"
					clipRule="evenodd"
					d="M4.5 4C4.22386 4 4 4.22386 4 4.5V11.5C4 11.7761 4.22386 12 4.5 12H11.5C11.7761 12 12 11.7761 12 11.5V4.5C12 4.22386 11.7761 4 11.5 4H4.5ZM6 6V10H10V6H6Z"
				/>
				<path d="M14.5 2C14.2239 2 14 2.22386 14 2.5V13.5C14 13.7761 14.2239 14 14.5 14H15.5C15.7761 14 16 13.7761 16 13.5V2.5C16 2.22386 15.7761 2 15.5 2H14.5Z" />
			</g>
		</svg>`],["minus-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M1.5 9C1.22386 9 1 8.77614 1 8.5L1 7.5C1 7.22386 1.22386 7 1.5 7L14.5 7C14.7761 7 15 7.22386 15 7.5V8.5C15 8.77614 14.7761 9 14.5 9L1.5 9Z"
				stroke="none"
			/>
		</svg>`],["logo-horizontal-206x48",`<svg viewBox="0 0 206 48">
			<path d="M27.2678 14.2261H22.3187C21.0695 14.2261 20.4695 14.7801 20.4695 15.9852V31.142L10.3966 15.5591C9.69665 14.4784 9.2475 14.2773 7.8475 14.2261H2.97462C1.67462 14.2261 1.07631 14.7801 1.07631 15.9852V44.7665C1.07631 45.9716 1.67462 46.5256 2.97462 46.5256H7.92377C9.22207 46.5256 9.82207 45.9716 9.82207 44.7665V29.6847L19.9441 45.1926C20.695 46.3244 21.095 46.5256 22.4933 46.5256H27.2933C28.5916 46.5256 29.1916 45.9716 29.1916 44.7665V15.9852C29.1407 14.7801 28.5424 14.2261 27.2678 14.2261Z" />
			<path d="M5.44915 10.9602C8.45863 10.9602 10.8983 8.50669 10.8983 5.48011C10.8983 2.45353 8.45863 0 5.44915 0C2.43967 0 0 2.45353 0 5.48011C0 8.50669 2.43967 10.9602 5.44915 10.9602Z" />
			<path d="M61.7899 25.0449C63.2306 23.1903 65.078 22.2051 67.556 22.2051C72.0526 22.2051 74.7611 25.3347 74.7611 29.4511V39.2489C74.8187 39.7125 74.5306 39.9443 74.0695 39.9443H72.5136C72.0526 39.9443 71.7645 39.7125 71.8221 39.2489V29.5091C71.8221 27.1909 69.9187 25.2187 67.4984 25.2187C65.1339 25.2187 63.2323 27.1329 63.2323 29.2773V39.2489C63.2899 39.7125 63.0018 39.9443 62.5407 39.9443H60.9831C60.5221 39.9443 60.2916 39.7125 60.2916 39.2489V29.4511C60.2916 27.1329 58.3899 25.2187 56.0255 25.2187C53.7204 25.2187 51.7594 27.075 51.7594 29.2773V39.3068C51.817 39.7705 51.5289 40.0023 51.0102 40.0023H49.5119C49.0509 40.0023 48.7628 39.7705 48.7628 39.3068V23.25C48.7051 22.7864 48.9933 22.4966 49.5119 22.4966H50.9526C51.356 22.4966 51.5289 22.6704 51.5289 23.0182V24.2352C52.7407 22.9602 54.239 22.2648 56.0255 22.2648C58.4475 22.2068 60.3492 23.192 61.7899 25.0466V25.0449ZM77.1255 31.2477C77.1255 26.3216 81.1018 22.2051 86.1187 22.2051C88.539 22.2051 90.6136 23.1903 92.3441 25.1608V23.1903C92.3441 22.7267 92.5746 22.5528 93.0357 22.5528H94.4187C94.8797 22.5528 95.1102 22.7847 95.1102 23.3062V39.3648C95.1102 39.8284 94.8797 40.0602 94.4187 40.0602H93.0357C92.5746 40.0602 92.3441 39.8284 92.3441 39.4227V37.4523C90.6712 39.3648 88.5967 40.35 86.1746 40.35C81.1018 40.2341 77.1238 36.1773 77.1238 31.2477H77.1255ZM92.1136 31.2477C92.1136 27.8284 89.4611 25.2187 86.0594 25.2187C82.7746 25.2187 80.1221 27.8864 80.1221 31.2477C80.1221 34.6687 82.7746 37.2784 86.1187 37.2784C86.9062 37.2789 87.6861 37.1232 88.4138 36.8202C89.1414 36.5173 89.8026 36.0731 90.3593 35.513C90.9161 34.9528 91.3577 34.2878 91.6587 33.556C91.9597 32.8241 92.1143 32.0397 92.1136 31.2477ZM100.992 37.3943V46.3807C101.049 46.8443 100.761 47.1341 100.298 47.1341H98.7424C98.2814 47.1341 97.9933 46.9023 97.9933 46.3807V23.1903C97.9933 22.7267 98.2238 22.4369 98.7424 22.4369H100.183C100.646 22.379 100.934 22.6687 100.934 23.0744V24.9869C102.605 23.0744 104.68 22.1472 107.044 22.1472C112.002 22.1472 116.037 26.2619 116.037 31.1898C116.037 36.1176 112.059 40.2341 107.044 40.2341C104.622 40.2341 102.603 39.3068 100.992 37.3943ZM106.987 25.2187C103.7 25.2187 101.049 27.8864 101.049 31.2477C101.049 34.6687 103.7 37.2784 107.044 37.2784C110.446 37.2784 113.039 34.6108 113.039 31.2477C113.039 27.8864 110.388 25.2187 106.987 25.2187ZM121.11 37.3943V46.3807C121.168 46.8443 120.88 47.1341 120.419 47.1341H118.861C118.4 47.1341 118.112 46.9023 118.112 46.3807V23.1903C118.112 22.7267 118.342 22.4369 118.861 22.4369H120.302C120.764 22.379 121.053 22.6687 121.053 23.0744V24.9869C122.724 23.0744 124.798 22.1472 127.163 22.1472C132.12 22.1472 136.156 26.2619 136.156 31.1898C136.156 36.1176 132.178 40.2341 127.163 40.2341C124.742 40.2341 122.781 39.3068 121.11 37.3943ZM127.105 25.2187C123.819 25.2187 121.168 27.8864 121.168 31.2477C121.168 34.6687 123.819 37.2784 127.163 37.2784C130.564 37.2784 133.158 34.6108 133.158 31.2477C133.158 27.8864 130.507 25.2187 127.107 25.2187H127.105ZM153.97 32.3506H141.054C141.342 35.2483 143.995 37.4523 147.164 37.4523C148.893 37.4523 150.393 37.0466 151.719 36.0597C152.007 35.8858 152.295 35.7699 152.353 35.7699C152.583 35.7699 152.756 35.8858 152.929 36.1773L153.505 37.1625C153.622 37.3364 153.68 37.4523 153.68 37.5682C153.68 37.8 153.507 38.0318 153.103 38.3216C151.258 39.5966 149.183 40.292 146.992 40.292C141.688 40.292 137.883 36.3511 137.883 31.2477C137.883 26.204 141.803 22.2051 146.703 22.2051C151.546 22.2051 154.717 25.7983 154.717 31.0176C154.717 31.5972 154.717 32.3506 153.968 32.3506H153.97ZM141.056 30.0324H151.72C151.432 26.8432 149.473 24.929 146.648 24.929C145.241 24.8904 143.875 25.3995 142.833 26.3501C141.791 27.3007 141.154 28.6194 141.056 30.0307V30.0324ZM156.332 31.2477C156.332 26.3216 160.31 22.2051 165.326 22.2051C167.748 22.2051 169.707 23.1324 171.32 25.0449V16.2324C171.263 15.7687 171.551 15.479 172.012 15.479H173.57C174.031 15.479 174.319 15.7108 174.319 16.2324V39.3068C174.319 39.7705 174.088 40.0023 173.57 40.0023H172.129C171.666 40.0602 171.378 39.7705 171.378 39.3648V37.3943C169.649 39.3068 167.632 40.292 165.268 40.292C160.31 40.2341 156.332 36.1773 156.332 31.2477ZM171.264 31.2477C171.264 27.8284 168.612 25.2187 165.21 25.2187C161.924 25.2187 159.273 27.8864 159.273 31.2477C159.273 34.6687 161.924 37.2784 165.268 37.2784C166.057 37.2838 166.839 37.1316 167.569 36.8304C168.299 36.5292 168.962 36.0852 169.52 35.5241C170.077 34.963 170.519 34.296 170.818 33.5619C171.117 32.8277 171.268 32.0411 171.263 31.2477H171.264ZM177.72 19.0739C177.715 18.8594 177.754 18.646 177.833 18.4468C177.912 18.2476 178.031 18.0667 178.182 17.915C178.333 17.7633 178.512 17.6439 178.71 17.5642C178.909 17.4845 179.121 17.446 179.334 17.4511C179.546 17.4507 179.756 17.4923 179.952 17.5737C180.148 17.6551 180.326 17.7746 180.476 17.9254C180.626 18.0762 180.745 18.2553 180.826 18.4523C180.907 18.6494 180.948 18.8606 180.948 19.0739C180.953 19.2884 180.914 19.5017 180.835 19.7009C180.756 19.9001 180.637 20.081 180.486 20.2327C180.335 20.3845 180.156 20.5038 179.957 20.5835C179.759 20.6633 179.547 20.7017 179.334 20.6966C178.412 20.7545 177.72 20.0591 177.72 19.0739ZM177.836 39.2489V23.1903C177.836 22.7267 178.066 22.4369 178.527 22.4369H180.083C180.544 22.4369 180.832 22.6687 180.775 23.1903V39.2489C180.832 39.7125 180.544 39.9443 180.083 39.9443H178.527C178.066 39.9443 177.836 39.7125 177.836 39.2489ZM186.944 23.0165V24.1756C188.212 22.8426 189.71 22.2051 191.497 22.2051C195.937 22.2051 198.646 25.2767 198.646 29.3932V39.2489C198.703 39.7125 198.415 39.9443 197.954 39.9443H196.398C195.936 39.9443 195.705 39.7125 195.705 39.2489V29.4511C195.705 27.1329 193.803 25.2187 191.439 25.2187C189.134 25.2187 187.175 27.075 187.175 29.2773V39.3068C187.232 39.7705 186.944 40.0023 186.424 40.0023H184.868C184.407 40.0023 184.119 39.7705 184.119 39.3068V23.1903C184.061 22.7267 184.349 22.4949 184.868 22.4949H186.309C186.712 22.4949 186.944 22.6687 186.944 23.0165Z" />
			<path d="M204 40C205.115 40 206 39.0857 206 38V37.9886C206 36.9029 205.126 36 204 36C202.885 36 202 36.9143 202 38V38.0114C202 39.0971 202.874 40 204 40ZM204 39.7829C202.989 39.7829 202.23 38.9829 202.23 38.0114V38C202.23 37.0286 203 36.2171 204 36.2171C205.011 36.2171 205.77 37.0171 205.77 37.9886V38C205.77 38.9714 205 39.7829 204 39.7829ZM203.218 38.9714H203.609V38.2743H204.034L204.517 38.9714H204.989L204.448 38.2057C204.724 38.1257 204.92 37.92 204.92 37.5886C204.92 37.1657 204.586 36.9486 204.138 36.9486H203.218V38.9714ZM203.609 37.9543V37.2914H204.103C204.368 37.2914 204.517 37.4057 204.517 37.6229C204.517 37.8171 204.368 37.9543 204.103 37.9543H203.609Z" />
		</svg>`],["share-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M13 6C14.6569 6 16 4.65685 16 3C16 1.34315 14.6569 0 13 0C11.3431 0 10 1.34315 10 3C10 3.13463 10.0089 3.26719 10.0261 3.39712L6.82972 5.17286C6.10576 4.44825 5.10523 4 4 4C1.79086 4 0 5.79086 0 8C0 10.2091 1.79086 12 4 12C5.10523 12 6.10576 11.5518 6.82972 10.8271L10.0261 12.6029C10.0089 12.7328 10 12.8654 10 13C10 14.6569 11.3431 16 13 16C14.6569 16 16 14.6569 16 13C16 11.3431 14.6569 10 13 10C12.2011 10 11.4752 10.3123 10.9376 10.8214L7.84579 9.1037C7.94622 8.75313 8 8.38284 8 8C8 7.61716 7.94622 7.24687 7.84579 6.8963L10.9376 5.17864C11.4752 5.68775 12.2011 6 13 6ZM13 4C13.5523 4 14 3.55228 14 3C14 2.44772 13.5523 2 13 2C12.4477 2 12 2.44772 12 3C12 3.55228 12.4477 4 13 4ZM4 10C5.10457 10 6 9.10457 6 8C6 6.89543 5.10457 6 4 6C2.89543 6 2 6.89543 2 8C2 9.10457 2.89543 10 4 10ZM14 13C14 13.5523 13.5523 14 13 14C12.4477 14 12 13.5523 12 13C12 12.4477 12.4477 12 13 12C13.5523 12 14 12.4477 14 13Z"
				stroke="none"
			/>
		</svg>`],["checkmark-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M15.387 3.31662C15.6008 3.49148 15.6323 3.80649 15.4574 4.02021L6.77402 14.6332C6.58509 14.8642 6.30292 14.9986 6.00457 15C5.70622 15.0013 5.42285 14.8694 5.23184 14.6402L0.551937 9.02429C0.375155 8.81215 0.403817 8.49687 0.615956 8.32009L1.38418 7.67991C1.59632 7.50312 1.9116 7.53179 2.08838 7.74392L5.99299 12.4295L13.9095 2.75374C14.0844 2.54002 14.3994 2.50852 14.6131 2.68338L15.387 3.31662Z"
				stroke="none"
			/>
		</svg>`],["arrow-right-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M8.35355 1.64645C8.54881 1.45118 8.8654 1.45118 9.06066 1.64645L14.7071 7.29289C15.0976 7.68342 15.0976 8.31658 14.7071 8.70711L9.06066 14.3536C8.8654 14.5488 8.54882 14.5488 8.35355 14.3536L7.64645 13.6464C7.45118 13.4512 7.45118 13.1346 7.64645 12.9393L11.5858 9H0.5C0.223858 9 0 8.77614 0 8.5V7.5C0 7.22386 0.223858 7 0.5 7H11.5858L7.64645 3.06066C7.45118 2.8654 7.45118 2.54882 7.64645 2.35355L8.35355 1.64645Z"
				stroke="none"
			/>
		</svg>`],["arrow-up-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M8.00015 0.5C8.34685 0.5 8.67835 0.642318 8.91714 0.893677L15.6517 7.98267C15.8441 8.18525 15.8359 8.50548 15.6333 8.69793L14.533 9.7433C14.3304 9.93575 14.0101 9.92754 13.8177 9.72496L9.26497 4.93262V15.4249C9.26497 15.7043 9.03846 15.9308 8.75904 15.9308H7.24125C6.96184 15.9308 6.73532 15.7043 6.73532 15.4249V4.93262L2.1826 9.72496C1.99015 9.92754 1.66992 9.93575 1.46734 9.7433L0.366945 8.69793C0.164367 8.50548 0.156156 8.18525 0.348604 7.98267L7.08315 0.893677C7.32194 0.642318 7.65344 0.5 8.00015 0.5Z"
				stroke="none"
			/>
		</svg>`],["connection-stairs-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M1 11.5C1 11.2239 1.22386 11 1.5 11H6V13.5C6 13.7761 5.77614 14 5.5 14H1.5C1.22386 14 1 13.7761 1 13.5V11.5Z" />
				<path d="M4 8.5C4 8.22386 4.22386 8 4.5 8H9V10.5C9 10.7761 8.77614 11 8.5 11H4V8.5Z" />
				<path d="M7 5.5C7 5.22386 7.22386 5 7.5 5H12V7.5C12 7.77614 11.7761 8 11.5 8H7V5.5Z" />
				<path d="M10 2.5C10 2.22386 10.2239 2 10.5 2H14.5C14.7761 2 15 2.22386 15 2.5V4.5C15 4.77614 14.7761 5 14.5 5H10V2.5Z" />
			</g>
		</svg>`],["connection-stairs-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M5.25 12H2.5C2.225 12 2 11.7429 2 11.4286C2 11.1143 2.225 10.8571 2.5 10.8571H4.25V7.91429H6.5V4.94286H8.75V2H11.5C11.775 2 12 2.25714 12 2.57143C12 2.88571 11.775 3.14286 11.5 3.14286H9.75V6.08571H7.5V9.02857H5.25V12Z"
				stroke="none"
			/>
		</svg>`],["connection-stairs-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<path d="M1.625 8.1875C1.625 8.01491 1.76491 7.875 1.9375 7.875H4.75V9.4375C4.75 9.61009 4.61009 9.75 4.4375 9.75H1.9375C1.76491 9.75 1.625 9.61009 1.625 9.4375V8.1875Z" />
			<path d="M3.5 6.3125C3.5 6.13991 3.63991 6 3.8125 6H6.625V7.5625C6.625 7.73509 6.48509 7.875 6.3125 7.875H3.5V6.3125Z" />
			<path d="M5.375 4.4375C5.375 4.26491 5.51491 4.125 5.6875 4.125H8.5V5.6875C8.5 5.86009 8.36009 6 8.1875 6H5.375V4.4375Z" />
			<path d="M7.25 2.5625C7.25 2.38991 7.38991 2.25 7.5625 2.25H10.0625C10.2351 2.25 10.375 2.38991 10.375 2.5625V3.8125C10.375 3.98509 10.2351 4.125 10.0625 4.125H7.25V2.5625Z" />
		</svg>`],["connection-escalator-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M3.63008 12H2C0.895431 12 0 12.8954 0 14C0 15.1046 0.89543 16 2 16H4.63008C4.86879 16 5.09962 15.9146 5.28087 15.7593L11.7191 10.2407C11.9004 10.0854 12.1312 10 12.3699 10H14C15.1046 10 16 9.10457 16 8C16 6.89543 15.1046 6 14 6H11.3699C11.1312 6 10.9004 6.08539 10.7191 6.24074L4.28087 11.7593C4.09962 11.9146 3.86879 12 3.63008 12Z" />
				<path d="M5 6C5 4.89543 5.89543 4 7 4C8.10457 4 9 4.89543 9 6L5 9.5V6Z" />
				<path d="M9 2C9 3.10457 8.10457 4 7 4C5.89543 4 5 3.10457 5 2C5 0.89543 5.89543 0 7 0C8.10457 0 9 0.89543 9 2Z" />
			</g>
		</svg>`],["connection-escalator-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M5.26686 2.98522C5.26686 2.44335 5.71573 2 6.26436 2C6.81299 2 7.26187 2.44335 7.26187 2.98522C7.26187 3.5271 6.81299 3.97045 6.26436 3.97045C5.71573 3.97045 5.26686 3.50246 5.26686 2.98522Z"
				stroke="none"
			/>
			<path
				d="M7.26188 5.48588V5.25125C7.26188 4.85716 6.91275 4.53696 6.48881 4.53696H6.03993C5.61599 4.53696 5.26687 4.88179 5.26687 5.25125V7.66458L4.3192 8.6995H3.67082C2.74813 8.6995 2 9.43842 2 10.3498C2 11.2611 2.74813 12 3.67082 12H4.61845C5.36658 12 6.11471 11.6798 6.61347 11.1133L9.6808 7.76354H10.3292C11.2519 7.76354 12 7.02463 12 6.11329C12 5.20196 11.2519 4.46305 10.3292 4.46305H9.38155C8.60848 4.46305 7.88529 4.78324 7.38653 5.34975L7.26188 5.48588ZM4.61846 11.0148H3.67083C3.29677 11.0148 2.99751 10.7192 2.99751 10.3498C2.99751 9.9803 3.29677 9.68473 3.67083 9.68473H4.61846C4.71821 9.68473 4.81796 9.63547 4.86784 9.56158L8.13467 5.99015C8.45886 5.64532 8.90774 5.44828 9.38155 5.44828H10.3292C10.7032 5.44828 11.0025 5.74384 11.0025 6.1133C11.0025 6.48276 10.7032 6.77833 10.3292 6.77833H9.38155C9.2818 6.77833 9.18205 6.82759 9.13218 6.87685L5.86534 10.4729C5.54115 10.8177 5.09228 11.0148 4.61846 11.0148Z"
				stroke="none"
			/>
		</svg>`],["connection-elevator-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M3 5.5C3 6.32843 2.32843 7 1.5 7C0.671573 7 0 6.32843 0 5.5C0 4.67157 0.671573 4 1.5 4C2.32843 4 3 4.67157 3 5.5Z" />
				<path d="M3 10.5C3 11.3284 2.32843 12 1.5 12C0.671573 12 0 11.3284 0 10.5C0 9.67157 0.671573 9 1.5 9C2.32843 9 3 9.67157 3 10.5Z" />
				<path d="M11 1H14C14.5523 1 15 1.44772 15 2V14C15 14.5523 14.5523 15 14 15H11V1Z" />
				<path d="M9 1H6C5.44772 1 5 1.44772 5 2V14C5 14.5523 5.44772 15 6 15H9V1Z" />
			</g>
		</svg>`],["connection-elevator-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M7.476 2H2.72693C1.77095 2 1 2.72464 1 3.62319V10.3768C1 11.2754 1.77095 12 2.72693 12H7.476C8.43198 12 9.20293 11.2754 9.20293 10.3768V3.62319C9.17209 2.72464 8.40114 2 7.476 2ZM7.476 3.15942C7.75354 3.15942 7.96941 3.36232 7.96941 3.62319V10.3768C7.96941 10.6377 7.75354 10.8406 7.476 10.8406H5.71824V3.15942H7.476ZM4.48472 3.15942V10.8406H2.72693C2.44939 10.8406 2.23352 10.6377 2.23352 10.3768V3.62319C2.23352 3.36232 2.44939 3.15942 2.72693 3.15942H4.48472Z"
				stroke="none"
			/>
			<path
				d="M12.4643 6.19064H10.6638C10.4456 6.19064 10.2546 6.06243 10.1728 5.88294C10.0909 5.70346 10.1455 5.47269 10.2819 5.31884L11.1821 4.47269C11.4004 4.26756 11.755 4.26756 11.946 4.47269L12.8462 5.31884C13.0099 5.47269 13.0371 5.67781 12.9553 5.88294C12.8735 6.08807 12.6825 6.19064 12.4643 6.19064Z"
				stroke="none"
			/>
			<path
				d="M11.564 9.65216C11.4276 9.65216 11.2912 9.60088 11.1821 9.49831L10.2819 8.65216C10.1182 8.49831 10.0909 8.29319 10.1728 8.08806C10.2546 7.90857 10.4456 7.78036 10.6638 7.78036H12.4643C12.6825 7.78036 12.8735 7.90857 12.9553 8.08806C13.0371 8.26754 12.9826 8.49831 12.8462 8.65216L11.9459 9.49831C11.8641 9.60088 11.7004 9.65216 11.564 9.65216Z"
				stroke="none"
			/>
		</svg>`],["connection-elevator-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<circle cx="1.9375" cy="4.4375" r="0.9375" />
			<circle cx="1.9375" cy="7.5625" r="0.9375" />
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M7.6 2H9.4C9.73137 2 10 2.26863 10 2.6V9.41328C10 9.74465 9.73137 10.0133 9.4 10.0133H7.6V2ZM6.4 2H4.6C4.26863 2 4 2.26863 4 2.6V9.41328C4 9.74465 4.26863 10.0133 4.6 10.0133H6.4V2Z"
			/>
		</svg>`],["new-tab-14x14",`<svg viewBox="0 0 14 14">
			<g stroke="none">
				<path d="M2.625 2.625H5.6875C5.92913 2.625 6.125 2.42912 6.125 2.1875V1.3125C6.125 1.07088 5.92913 0.875 5.6875 0.875H1.3125C1.07088 0.875 0.875 1.07088 0.875 1.3125V12.6875C0.875 12.9291 1.07088 13.125 1.3125 13.125H12.6875C12.9291 13.125 13.125 12.9291 13.125 12.6875V8.3125C13.125 8.07088 12.9291 7.875 12.6875 7.875H11.8125C11.5709 7.875 11.375 8.07088 11.375 8.3125V11.375H2.625V2.625Z" />
				<path d="M12.9063 0.875H8.40311C8.20822 0.875 8.11063 1.11062 8.24843 1.24843L9.88124 2.88124L5.8156 6.94688C5.64475 7.11774 5.64475 7.39475 5.8156 7.5656L6.43432 8.18432C6.60517 8.35517 6.88218 8.35517 7.05304 8.18432L11.1187 4.11868L12.7516 5.75157C12.8894 5.88938 13.125 5.79178 13.125 5.59689V1.09375C13.125 0.972938 13.0271 0.875 12.9063 0.875Z" />
			</g>
		</svg>`],["compress-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path
					id="Vector"
					d="M4.67773 10.7154H0.713449C0.556306 10.7154 0.427734 10.844 0.427734 11.0011V11.8583C0.427734 12.0154 0.556306 12.144 0.713449 12.144H3.82059V15.2868C3.82059 15.444 3.94916 15.5725 4.10631 15.5725H4.96345C5.12059 15.5725 5.24916 15.444 5.24916 15.2868V11.2868C5.24916 10.9708 4.99381 10.7154 4.67773 10.7154ZM4.96345 0.429688H4.10631C3.94916 0.429688 3.82059 0.558259 3.82059 0.715402V3.85826H0.713449C0.556306 3.85826 0.427734 3.98683 0.427734 4.14397V5.00112C0.427734 5.15826 0.556306 5.28683 0.713449 5.28683H4.67773C4.99381 5.28683 5.24916 5.03147 5.24916 4.7154V0.715402C5.24916 0.558259 5.12059 0.429688 4.96345 0.429688ZM15.2849 10.7154H11.3206C11.0045 10.7154 10.7492 10.9708 10.7492 11.2868V15.2868C10.7492 15.444 10.8777 15.5725 11.0349 15.5725H11.892C12.0492 15.5725 12.1777 15.444 12.1777 15.2868V12.144H15.2849C15.442 12.144 15.5706 12.0154 15.5706 11.8583V11.0011C15.5706 10.844 15.442 10.7154 15.2849 10.7154ZM15.2849 3.85826H12.1777V0.715402C12.1777 0.558259 12.0492 0.429688 11.892 0.429688H11.0349C10.8777 0.429688 10.7492 0.558259 10.7492 0.715402V4.7154C10.7492 5.03147 11.0045 5.28683 11.3206 5.28683H15.2849C15.442 5.28683 15.5706 5.15826 15.5706 5.00112V4.14397C15.5706 3.98683 15.442 3.85826 15.2849 3.85826Z"
				/>
			</g>
		</svg>`],["washroom-14x14",`<svg viewBox="0 0 14 14" stroke="none">
			<path d="M4.55125 3.09062C4.55125 3.69326 4.07639 4.18176 3.49058 4.18176C2.90525 4.18176 2.43039 3.69326 2.43039 3.09062C2.43039 2.4885 2.90525 2 3.49058 2C4.07639 2 4.55125 2.4885 4.55125 3.09062Z" />
			<path d="M5.1193 5.48047C4.81653 4.83116 4.17252 4.41571 3.47822 4.41571C2.78392 4.41571 2.13986 4.83116 1.83714 5.48047L1.04175 7.22034C0.940664 7.441 1.02893 7.70073 1.24393 7.81791C1.47077 7.90871 1.72324 7.81791 1.82433 7.59725L2.49349 6.15554L2.21587 11.4407C2.20305 11.7263 2.41805 11.9734 2.69567 11.9993C2.97329 12.0124 3.21344 11.7913 3.23859 11.5057L3.4028 8.285H3.567L3.73121 11.5057C3.74403 11.7913 3.97086 11.9993 4.23616 11.9993H4.26131C4.53893 11.9861 4.75343 11.7395 4.74111 11.4407L4.46349 6.15554L5.13265 7.59725C5.20858 7.75298 5.35997 7.85697 5.52418 7.85697C5.5873 7.85697 5.65042 7.84379 5.71354 7.81792C5.92804 7.71393 6.0163 7.44153 5.91572 7.22035L5.1193 5.48047Z" />
			<path d="M12.9582 7.22034L12.1505 5.48047C11.8477 4.83116 11.2037 4.41571 10.5094 4.41571C9.81513 4.41571 9.17107 4.83116 8.86836 5.48047L8.06064 7.22034C7.95955 7.441 8.04782 7.70073 8.26282 7.81791C8.47732 7.9219 8.7298 7.8311 8.84371 7.60993L9.52519 6.12977L9.46207 7.2204L8.57842 8.92184C8.47733 9.11663 8.61638 9.36316 8.83089 9.36316H9.33584L9.22242 11.4668C9.2096 11.7397 9.41177 11.9862 9.68939 11.9994C9.95469 12.0126 10.1943 11.8046 10.2072 11.519L10.3581 9.33723H10.6737L10.7871 11.5058C10.7999 11.7787 11.0144 11.9862 11.2792 11.9862H11.3043C11.5696 11.973 11.7841 11.7396 11.7713 11.4535L11.6579 9.33718H12.1628C12.3773 9.33718 12.5287 9.09066 12.4153 8.89586L11.5317 7.19442L11.4685 6.1038L12.1757 7.5972C12.2516 7.75293 12.403 7.85692 12.5672 7.85692C12.6303 7.85692 12.6934 7.84373 12.7566 7.81786C12.9711 7.70068 13.0593 7.44102 12.9582 7.22034Z" />
			<path d="M11.5696 3.09062C11.5696 3.69326 11.0948 4.18176 10.5094 4.18176C9.92363 4.18176 9.44876 3.69326 9.44876 3.09062C9.44876 2.4885 9.92363 2 10.5094 2C11.0948 2 11.5696 2.4885 11.5696 3.09062Z" />
			<path d="M6.99996 2.00006C6.76031 2.00006 6.57095 2.19485 6.57095 2.44138V11.5575C6.57095 11.804 6.76031 11.9988 6.99996 11.9988C7.2396 11.9988 7.42896 11.804 7.42896 11.5575V2.44138C7.42896 2.19485 7.2396 2.00006 6.99996 2.00006Z" />
		</svg>`],["point-of-interest-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<path
				stroke="none"
				id="Subtract"
				// Do not change these to fillRule or clipRule, since they need to be rendered as actual SVGs in labels, not React SVGs
				fill-rule="evenodd"
				clip-rule="evenodd"
				d="M6.24724 10.7516C7.94597 9.0358 9.85962 6.89195 9.85962 4.85965C9.85962 2.72802 8.13159 1 5.99997 1C3.86834 1 2.14032 2.72802 2.14032 4.85965C2.14032 6.89195 4.05397 9.0358 5.7527 10.7516C5.88904 10.8893 6.1109 10.8893 6.24724 10.7516ZM5.99994 6.26317C6.77508 6.26317 7.40345 5.6348 7.40345 4.85967C7.40345 4.08453 6.77508 3.45616 5.99994 3.45616C5.22481 3.45616 4.59644 4.08453 4.59644 4.85967C4.59644 5.6348 5.22481 6.26317 5.99994 6.26317Z"
			/>
		</svg>`],["flag-20x20",`<svg viewBox="0 0 20 20" stroke="none">
			<path
				d="M16.9987 4.27111C16.936 5.06715 16.3836 5.93162 15.5238 6.57845C14.7549 7.15682 13.0885 8.04927 10.5434 7.55174C8.32167 7.1164 6.82156 8.02129 6.08085 10.2416L8.24615 17.3998C8.31833 17.6471 8.17711 17.9059 7.9292 17.9813C7.88527 17.9938 7.83976 18 7.79426 18C7.58634 18 7.40277 17.8647 7.34236 17.6673L5.1644 10.4686C5.13773 10.4173 5.12125 10.3613 5.11419 10.3038L3.41956 4.70042C3.38112 4.63512 3.35994 4.56127 3.3568 4.48587L3.02101 3.37886C2.98413 3.25992 2.9959 3.13165 3.05553 3.02203C3.11437 2.91242 3.21479 2.83079 3.33482 2.79504C3.45564 2.75928 3.5851 2.7725 3.69494 2.83235C3.80477 2.89144 3.88637 2.99172 3.92167 3.11143L3.9813 3.31355C4.38847 2.85956 4.90472 2.51439 5.48136 2.30915C6.97201 1.75566 8.95216 1.95467 10.6469 2.83156C11.6888 3.36951 14.3374 4.54493 16.3647 3.79553C16.5154 3.74111 16.684 3.76599 16.8127 3.86239C16.9406 3.95879 17.0105 4.11251 16.9987 4.27111Z"
				stroke="none"
			/>
		</svg>`],["link-16x16",`<svg viewBox="0 0 16 16" stroke="none">
			<path
				d="M9.10678 11.2433C9.07993 11.2167 9.04367 11.2018 9.00589 11.2018C8.9681 11.2018 8.93184 11.2167 8.90499 11.2433L6.82999 13.3183C5.86928 14.279 4.24785 14.3808 3.18714 13.3183C2.12464 12.2558 2.22642 10.6362 3.18714 9.67546L5.26214 7.60046C5.31749 7.5451 5.31749 7.45403 5.26214 7.39868L4.55142 6.68796C4.52457 6.66138 4.48832 6.64646 4.45053 6.64646C4.41274 6.64646 4.37649 6.66138 4.34964 6.68796L2.27464 8.76296C0.763923 10.2737 0.763923 12.7183 2.27464 14.2272C3.78535 15.7362 6.22999 15.738 7.73892 14.2272L9.81392 12.1522C9.86928 12.0969 9.86928 12.0058 9.81392 11.9505L9.10678 11.2433ZM13.7246 2.77903C12.2139 1.26832 9.76928 1.26832 8.26035 2.77903L6.18357 4.85403C6.15698 4.88088 6.14207 4.91714 6.14207 4.95493C6.14207 4.99271 6.15698 5.02897 6.18357 5.05582L6.89249 5.76475C6.94785 5.8201 7.03892 5.8201 7.09428 5.76475L9.16928 3.68975C10.13 2.72903 11.7514 2.62725 12.8121 3.68975C13.8746 4.75225 13.7729 6.37189 12.8121 7.3326L10.7371 9.4076C10.7106 9.43445 10.6956 9.47071 10.6956 9.5085C10.6956 9.54628 10.7106 9.58254 10.7371 9.60939L11.4479 10.3201C11.5032 10.3755 11.5943 10.3755 11.6496 10.3201L13.7246 8.2451C15.2336 6.73439 15.2336 4.28975 13.7246 2.77903ZM9.75142 6.00939C9.72457 5.9828 9.68832 5.96789 9.65053 5.96789C9.61275 5.96789 9.57649 5.9828 9.54964 6.00939L5.50499 10.0522C5.47841 10.0791 5.46349 10.1154 5.46349 10.1531C5.46349 10.1909 5.47841 10.2272 5.50499 10.254L6.21214 10.9612C6.26749 11.0165 6.35857 11.0165 6.41392 10.9612L10.4568 6.91832C10.5121 6.86296 10.5121 6.77189 10.4568 6.71653L9.75142 6.00939Z"
				stroke="none"
			/>
		</svg>`]]),BHe=/<svg([^>]*)>/g;function zHe(t,e,r){let n=OHe.get(t);return n?n.replace(BHe,'<svg$1 style="fill:'.concat(e,"; width:").concat(r,"px; height:").concat(r,'px">')):""}var FHe=t=>`
		<div class="pin-shadow" style="background: `.concat(t,`"></div>
		<svg width="`).concat(20*.9,'px" height="').concat(48*.9,`px" viewBox="0 0 20 48">
			<path
				d="M1.37965 29.3246C1.5778 31.2167 2.27661 33.0694 3.83078 33.775C4.0998 37.1861 4.7451 40.2227 5.65918 42.4784C6.14556 43.6787 6.72883 44.71 7.41453 45.4578C8.10027 46.2056 8.97065 46.7527 9.99989 46.7527C11.0292 46.7527 11.8995 46.2055 12.585 45.4576C13.2706 44.7098 13.8536 43.6785 14.3398 42.4783C15.2536 40.2226 15.8988 37.186 16.1688 33.7752C17.7232 33.0697 18.422 31.2169 18.6201 29.3247C18.8386 27.2385 18.5165 24.6502 17.6475 22.0285L17.6473 22.0278C16.9657 19.9761 16.0319 18.1622 14.9848 16.7474C17.0884 15.1587 18.4471 12.5964 18.4471 9.7152C18.4471 4.93539 14.6967 1 9.99966 1C5.30272 1 1.54993 4.93527 1.54993 9.7152C1.54993 12.5961 2.90839 15.1583 5.01167 16.747C3.9635 18.1625 3.03185 19.977 2.3522 22.0286C1.48319 24.6503 1.16118 27.2385 1.37965 29.3246Z"
				fill="`).concat(t,`"
				stroke="white"
				strokeWidth="2"
			/>
		</svg>
	`),RHe=t=>`
		<div class="pin-shadow" style="background: `.concat(t,`"></div>
		<svg width="36" height="42" viewBox="-2 -2 40 46">
			<path
				d="M35.8372 5.86776C35.6765 7.92448 34.2625 10.158 32.0612 11.8292C30.0929 13.3235 25.8269 15.6292 19.3114 14.3438C13.6237 13.219 9.78333 15.5569 7.88708 21.2934L13.4303 39.7879C13.6151 40.4267 13.2536 41.0955 12.6189 41.2903C12.5064 41.3225 12.39 41.3385 12.2735 41.3385C11.7412 41.3385 11.2712 40.989 11.1166 40.4789L5.54093 21.88C5.47265 21.7474 5.43047 21.6028 5.41239 21.4542L1.07409 6.97696C0.975678 6.80825 0.921449 6.61744 0.913417 6.42263L0.053779 3.56251C-0.0406172 3.2552 -0.0104927 2.92379 0.142154 2.64058C0.29279 2.35738 0.549874 2.14649 0.857157 2.05411C1.16646 1.96172 1.49786 1.99587 1.77906 2.15052C2.06025 2.30317 2.26912 2.56226 2.35951 2.87155L2.51215 3.39375C3.55453 2.22081 4.87615 1.32902 6.35237 0.798742C10.1685 -0.631292 15.2377 -0.117113 19.5763 2.14846C22.2435 3.53834 29.0241 6.57524 34.2141 4.63904C34.5998 4.49845 35.0316 4.56272 35.361 4.81178C35.6884 5.06083 35.8673 5.45801 35.8372 5.86776Z"
				fill="none"
				stroke="white"
				strokeWidth="4"
			/>
			<path
				d="M35.8372 5.86776C35.6765 7.92448 34.2625 10.158 32.0612 11.8292C30.0929 13.3235 25.8269 15.6292 19.3114 14.3438C13.6237 13.219 9.78333 15.5569 7.88708 21.2934L13.4303 39.7879C13.6151 40.4267 13.2536 41.0955 12.6189 41.2903C12.5064 41.3225 12.39 41.3385 12.2735 41.3385C11.7412 41.3385 11.2712 40.989 11.1166 40.4789L5.54093 21.88C5.47265 21.7474 5.43047 21.6028 5.41239 21.4542L1.07409 6.97696C0.975678 6.80825 0.921449 6.61744 0.913417 6.42263L0.053779 3.56251C-0.0406172 3.2552 -0.0104927 2.92379 0.142154 2.64058C0.29279 2.35738 0.549874 2.14649 0.857157 2.05411C1.16646 1.96172 1.49786 1.99587 1.77906 2.15052C2.06025 2.30317 2.26912 2.56226 2.35951 2.87155L2.51215 3.39375C3.55453 2.22081 4.87615 1.32902 6.35237 0.798742C10.1685 -0.631292 15.2377 -0.117113 19.5763 2.14846C22.2435 3.53834 29.0241 6.57524 34.2141 4.63904C34.5998 4.49845 35.0316 4.56272 35.361 4.81178C35.6884 5.06083 35.8673 5.45801 35.8372 5.86776Z"
				fill="`).concat(t,`"
			/>
		</svg>
    `),bre="#722ED1",wre="#1890FF",LHe=({type:t="departure",color:e=wre})=>`<div class="dropped-pin-wrapper">
			`.concat(t==="departure"?FHe(e):RHe(e),`
		</div>`),NHe=t=>{switch(t){case"default":return 28;case"selection":return 28;case"navigation":return 32}},$He=({type:t="stairs",color:e=bre,direction:r="up"})=>{let n=NHe("default"),i=n/2+2,a=r&&r!=="none";return`<div class="mappedin-connection-marker">
			<div class="connection-circle"
				role="button"
                style="background:`.concat(e,"; width:").concat(n,"px; height:").concat(n,`px;"
			>
                `).concat(zHe("connection-"+t+"-16x16","white",i)||"",`
			</div>
			`).concat(a?'<div style="margin-left: -'.concat(n*.2,`px;">
					<div class="bouncey">
						<div class="connection-circle"
							role="button"
							style="width: `).concat(n,"px; height: ").concat(n,`px;">
							<div class="`).concat(r==="up"?"":"arrow--down",`">
                                <svg viewBox="0 0 16 16" style="fill: white; width: `).concat(i,"px; height: ").concat(i,`px">
                                    <path
                                        fillRule="evenodd"
                                        clipRule="evenodd"
                                        d="M8.00015 0.5C8.34685 0.5 8.67835 0.642318 8.91714 0.893677L15.6517 7.98267C15.8441 8.18525 15.8359 8.50548 15.6333 8.69793L14.533 9.7433C14.3304 9.93575 14.0101 9.92754 13.8177 9.72496L9.26497 4.93262V15.4249C9.26497 15.7043 9.03846 15.9308 8.75904 15.9308H7.24125C6.96184 15.9308 6.73532 15.7043 6.73532 15.4249V4.93262L2.1826 9.72496C1.99015 9.92754 1.66992 9.93575 1.46734 9.7433L0.366945 8.69793C0.164367 8.50548 0.156156 8.18525 0.348604 7.98267L7.08315 0.893677C7.32194 0.642318 7.65344 0.5 8.00015 0.5Z"
                                        stroke="none"
                                    />
                                </svg>
							</div>
						</div>
					</div>
				</div>`):"",`
		</div>`)};C();var Are=63710088e-1,Ab=new WeakMap,UHe=async t=>new Promise(e=>setTimeout(e,t));function Sb(t,e,r){let n=t.distance,i=GHe(t,e,r);return i?(n-i?.distance)/n:0}function hB(t,e){if(t.coordinates.length===0)return[];if(Ab.has(t)&&Ab.get(t).has(e))return Ab.get(t).get(e);let r=t.coordinates.map(n=>mA(n,e));return Ab.set(t,new Map([[e,r]])),r}function mA(t,e){let r=e.latitude,n=e.longitude,i=t.latitude-r,a=t.longitude-n,o=Math.PI*Are/180,s=o*Math.cos(r*Math.PI/180),l=a*s,u=i*o;return{x:l,y:u}}function jHe(t,e){if(t.length===0)return;let r,n=1/0;for(let i=0;i<t.length;i++){let a=t[i],o=hB(a,e);for(let s=0;s<o.length-1;s++){let l=o[s],u=o[s+1],c=gA(l,u,{x:0,y:0}),h=Math.sqrt(c.x*c.x+c.y*c.y);h<n&&(n=h,r=c)}}if(r)return VHe(r,e)}function gA(t,e,r){let n=e.x-t.x,i=e.y-t.y,a=r.x-t.x,o=r.y-t.y,s=n*n+i*i;if(s===0)return{x:t.x,y:t.y};let l=(a*n+o*i)/s,u=Math.max(0,Math.min(1,l));return{x:t.x+u*n,y:t.y+u*i}}function VHe(t,e){let r=Math.PI*Are/180,n=r*Math.cos(e.latitude*Math.PI/180),i=t.y/r,a=t.x/n,o=e.latitude+i,s=e.longitude+a;return new Rr({latitude:o,longitude:s,floorId:e.floorId,verticalOffset:e.verticalOffset})}function GHe(t,e,r){let n=jHe([t],e);if(!n)return;let i=hB(t,r),a=mA(n,r),o=-1,s=1/0;for(let u=0;u<i.length-1;u++){let c=i[u],h=i[u+1],d=gA(c,h,a),p=d.x-a.x,m=d.y-a.y,y=Math.sqrt(p*p+m*m);y<1&&y<s&&(s=y,o=u)}if(o===-1){let u=0,c=1/0;for(let h=0;h<i.length;h++){let d=i[h],p=d.x-a.x,m=d.y-a.y,y=Math.sqrt(p*p+m*m);y<c&&(c=y,u=h)}o=Math.max(0,u-1)}let l=[n];for(let u=o+1;u<t.coordinates.length;u++)l.push(t.coordinates[u]);return new cB("".concat(t.id,"_remaining"),l)}function Sre(t,e,r,n){var i;let a,o,s=1/0,l=1/0,u=mA(e,n),c=mA(r,n);for(let d of t)for(let p of d.segments){if(p.isConnectionSegment)continue;let m=(i=p.coordinates[0])==null?void 0:i.floorId,y=m===e.floorId,v=m===r.floorId;if(!y&&!v)continue;let _=hB(p,n);if(y){let w=1/0;for(let b=0;b<_.length-1;b++){let A=_[b],E=_[b+1],M=gA(A,E,u),P=M.x-u.x,k=M.y-u.y,D=Math.sqrt(P*P+k*k);D<w&&(w=D)}w<s&&(s=w,a=p)}if(v){let w=1/0;for(let b=0;b<_.length-1;b++){let A=_[b],E=_[b+1],M=gA(A,E,c),P=M.x-c.x,k=M.y-c.y,D=Math.sqrt(P*P+k*k);D<w&&(w=D)}w<l&&(l=w,o=p)}}if(!a||!o)return;let h=[];if(a.id===o.id)return h.push({segment:a,startHighlightFraction:Sb(a,e,n),endHighlightFraction:Sb(o,r,n)}),h;for(let d of t)for(let p of d.segments)p.id===a.id?h.push({segment:p,startHighlightFraction:Sb(p,e,n),endHighlightFraction:1}):p.id===o.id?h.push({segment:p,startHighlightFraction:0,endHighlightFraction:Sb(p,r,n)}):h.push({segment:p,startHighlightFraction:0,endHighlightFraction:1});return h}var kL=.01,OL=.02,ZHe={drawDuration:1e3,color:"#40A9FF",interactive:!1,accentColor:"blue",width:{on:"zoom-level",input:[17,22],output:[2,.5]},displayArrowsOnPath:!1,animateArrowsOnPath:!1},WHe={drawDuration:1e3,color:"#B3DDFF",interactive:!1,accentColor:"#40A9FF",width:{on:"zoom-level",input:[17,22],output:[2,.5]},displayArrowsOnPath:!1,animateArrowsOnPath:!1},Fh={setMapOnConnectionClick:!0,setMapToDeparture:!0,createMarkers:{departure:!0,destination:!0,connection:!0},pathOptions:ZHe,inactivePathOptions:WHe,markerOptions:{departureColor:wre,destinationColor:bre},animatePathDrawing:!0},Xh,Mc,nn,rn,qh,Dm,Wi,us,Al,cp,zn,BL,zL,j6,CI,V6,Ere,G6,Hv,Rw,Xm,Z6,Xv,HHe=class{constructor(t){K(this,zn),K(this,Xh,new Map),K(this,Mc,new Map),K(this,nn),K(this,rn,Fh),K(this,qh),K(this,Dm),K(this,Wi,[]),K(this,us),K(this,Al,new Map),K(this,cp,new Map),K(this,Xv,e=>{var r;if((r=f(this,rn).createMarkers)!=null&&r.connection&&e.markers!=null&&e.markers.length>0){let{instruction:n}=f(this,Xh).get(e.markers[0].id);n!=null&&n.action.toFloor&&(f(this,rn).setMapOnConnectionClick&&f(this,nn).setFloor(n.action.toFloor.id,"navigation-connection-click"),f(this,nn).publish("navigation-connection-click",{instruction:n,fromFloor:n.action.fromFloor,toFloor:n.action.toFloor}))}}),ne(this,nn,t)}get isMultiFloor(){if(!f(this,Wi).length)return!1;let t=new Set;for(let e of f(this,Wi))for(let r of e.coordinates)if(r.floorId&&(t.add(r.floorId),t.size>1))return!0;return!1}getPathById(t){return f(this,nn).Paths.getById(t)}getMarkerById(t){return f(this,Xh).get(t)}get paths(){let t=new Set;return f(this,Mc).forEach(e=>t.add(e)),Array.from(t)}get activeDirections(){return f(this,cp).get(f(this,us))}get activePath(){if(f(this,us))return f(this,Mc).get(f(this,us).id)}get floorStacks(){let t=f(this,nn).getMapData();if(!f(this,Wi).length||!t)return[];let e=new Set;for(let r of f(this,Wi))for(let n of r.coordinates)if(n.floorId){let i=t.getById("floor",n.floorId);i&&e.add(i.floorStack)}return Array.from(e)}get floors(){let t=f(this,nn).getMapData();if(!f(this,Wi).length||!t)return[];let e=new Set;for(let r of f(this,Wi))for(let n of r.coordinates)if(n.floorId){let i=t.getById("floor",n.floorId);i&&e.add(i)}return Array.from(e)}setActivePathByIndex(t){let e=f(this,Wi)[t];if(!f(this,Wi).length){Be.warn("Cannot set an active path before drawing. Call Navigation.draw() first.");return}if(!f(this,Wi)[t]){Be.warn("Direction #".concat(t," does not exist"));return}let r=f(this,Al).get(e);if(!r){Be.warn("The direction is not a part of muli-direcional path");return}ot(this,zn,Rw).call(this,r)}setActivePath(t){if(!f(this,Wi).length){Be.warn("Cannot set an active path before drawing. Call Navigation.draw() first.");return}if(!f(this,cp).get(t)){Be.warn('Path "'.concat(t.id,'" is not a part of muli-direcional path'));return}ot(this,zn,Rw).call(this,t)}setActivePathByDirections(t){if(!f(this,Wi).length){Be.warn("[setActivePathByDirections] Cannot set an active path before drawing. Call Navigation.draw() first.");return}let e=f(this,Al).get(t);if(!e){let r=f(this,Wi).find(n=>n.id===t.id);if(!r){Be.warn("[setActivePathByDirections] Cannot find directions for id");return}e=f(this,Al).get(r)}if(!e){Be.warn("[setActivePathByDirections] Cannot find path for directions");return}ot(this,zn,Rw).call(this,e)}clearHighlightedPathSection(){for(let t of this.paths)for(let e of t.segments)f(this,nn).updateState(e,{highlightCompleteFraction:0})}highlightPathSection(t,e,r){var n;let i=(n=r?.animationDuration)!=null?n:1500,a=f(this,nn).getMapData().mapCenter,o=Sre(this.paths,t,e,a);if(!o)return;this.clearHighlightedPathSection();let s=o.map(c=>{var h,d;return f(this,nn).updateState(c.segment,{highlightStartFraction:c.startHighlightFraction,highlightEndFraction:c.endHighlightFraction,highlightColor:(h=r?.color)!=null?h:"red",highlightWidthMultiplier:(d=r?.widthMultiplier)!=null?d:1}),new l0({fraction:0}).to({fraction:1},i).onUpdate(p=>{f(this,nn).updateState(c.segment,{highlightCompleteFraction:p.fraction})})}),l=()=>{},u=new Promise(c=>{l=c});return s.length>0&&(s.forEach((c,h)=>{h<s.length-1&&c.chain(s[h+1]),f(this,nn).tweenGroup().add(s[h])}),s[0].start(),s[s.length-1].onComplete(()=>{f(this,nn).tweenGroup().remove(s[s.length-1]),l()})),{animation:u}}drawSync(t,e={}){var r,n,i;f(this,Dm)&&this.clear(),ne(this,Dm,!0),ot(this,zn,G6).call(this,e);let a=Array.isArray(t)?t:[t],o=a[0],s=a[a.length-1],l=o.coordinates[0];ne(this,Wi,a),l.floorId&&f(this,rn).setMapToDeparture&&f(this,nn).setFloor(l.floorId),(r=f(this,rn).createMarkers)!=null&&r.departure&&ot(this,zn,Xm).call(this,"departure",o.instructions[0]);for(let u=0;u<a.length;u++){let c=a[u],h=u?ae({},f(this,rn).inactivePathOptions):ae({},f(this,rn).pathOptions);if(c.coordinates.length<2){Be.warn("Directions must have at least 2 coordinates");return}let d=ot(this,zn,j6).call(this,c.coordinates,lt(ae({},h),{animateDrawing:f(this,rn).animatePathDrawing,verticalOffset:ot(this,zn,V6).call(this,u===0?"active":"inactive")}));f(this,Al).set(c,d),f(this,cp).set(d,c),(n=f(this,rn).createMarkers)!=null&&n.connection&&ot(this,zn,Z6).call(this,c.instructions,"connection"),u===0&&(ne(this,us,f(this,Al).get(f(this,Wi)[0])),f(this,nn).externalPubSub.on("click",f(this,Xv)))}(i=f(this,rn).createMarkers)!=null&&i.destination&&ot(this,zn,Xm).call(this,"destination",s.instructions[s.instructions.length-1]),f(this,nn).mapObjects.forEach(u=>{u.processFloorChange(u.currentFloorId)}),ot(this,zn,Hv).call(this)}async draw(t,e={}){f(this,qh)&&this.clear(),ot(this,zn,G6).call(this,e);let r=Array.isArray(t)?t:[t],n=r[0].coordinates[0];return ne(this,Wi,r),n.floorId&&f(this,rn).setMapToDeparture&&f(this,nn).setFloor(n.floorId),ot(this,zn,Ere).call(this,r)}clear(){f(this,Xh).forEach(t=>{t!=null&&t.marker&&f(this,nn).currentMap.Markers.remove(t.marker.id.toString())}),f(this,Xh).clear(),f(this,Mc).forEach(t=>{f(this,nn).currentMap.Paths.remove(t.segments.map(e=>e.id.toString()))}),f(this,Mc).clear(),f(this,qh)&&(f(this,qh).cancel(),ne(this,qh,void 0)),f(this,Dm)&&ne(this,Dm,!1),ne(this,Wi,[]),f(this,Al).clear(),f(this,cp).clear(),ne(this,us,void 0),f(this,nn).externalPubSub.off("click",f(this,Xv)),f(this,nn).mapObjects.forEach(t=>{t.processFloorChange(t.currentFloorId)}),ot(this,zn,Hv).call(this)}};Xh=new WeakMap,Mc=new WeakMap,nn=new WeakMap,rn=new WeakMap,qh=new WeakMap,Dm=new WeakMap,Wi=new WeakMap,us=new WeakMap,Al=new WeakMap,cp=new WeakMap,zn=new WeakSet,BL=function(t){return t!=null&&["TakeConnection","ExitConnection","TakeVortex","ExitVortex"].includes(t.type)},zL=function(){if(!f(this,us))return;let t=f(this,Mc).get(f(this,us).id);if(t){for(let e of f(this,Mc).values())if(e.id.includes("internal-"))if(e.id===f(this,us).id)for(let r of t.segments)f(this,nn).updateState(r,{verticalOffset:OL});else f(this,nn).updateState(e,{verticalOffset:kL})}},j6=function(t,e){var r,n;let i=(n=(r=e.id)==null?void 0:r.toString())!=null?n:Wn(),a=f(this,nn).currentMap.Paths.add(t,e),o=new Wv(i,a.animation,t,a.paths);return f(this,Mc).set(i,o),o},CI=function(t,e,r=!1){let n=f(this,nn).currentMap.Markers.add(t.coordinate,e,{interactive:r,placement:"top",rank:"always-visible"}),i=f(this,nn).currentMap.Markers.getContentEl(n.id.toString());if(!i)throw new Error("marker component should exist");return new fA(n.id.toString(),i,t.coordinate)},V6=function(t){var e,r,n,i;return t==="active"?OL+((r=(e=f(this,rn).pathOptions)==null?void 0:e.verticalOffset)!=null?r:0):kL+((i=(n=f(this,rn).inactivePathOptions)==null?void 0:n.verticalOffset)!=null?i:0)},Ere=function(t){let e=t[0],r=t[t.length-1],n=!1;return ne(this,qh,{promise:new Promise(async i=>{var a,o,s;if(Oi.env.NODE_ENV!=="test"&&await UHe(500),n||!t.length){i();return}(a=f(this,rn).createMarkers)!=null&&a.departure&&ot(this,zn,Xm).call(this,"departure",e.instructions[0]);for(let l=0;l<t.length;l++){let u=t[l],c=l===0?ae({},f(this,rn).pathOptions):ae({},f(this,rn).inactivePathOptions);if(u.coordinates.length<2){Be.warn("Directions must have at least 2 coordinates"),i();return}let h=ot(this,zn,j6).call(this,u.coordinates,lt(ae({},c),{animateDrawing:f(this,rn).animatePathDrawing,verticalOffset:ot(this,zn,V6).call(this,l===0?"active":"inactive")}));if(f(this,Al).set(u,h),f(this,cp).set(h,u),l===0&&(ne(this,us,f(this,Al).get(f(this,Wi)[0])),f(this,nn).externalPubSub.on("click",f(this,Xv))),Oi.env.NODE_ENV!=="test"&&await h.animation,n){i();return}(o=f(this,rn).createMarkers)!=null&&o.connection&&ot(this,zn,Z6).call(this,u.instructions,"connection")}if((s=f(this,rn).createMarkers)!=null&&s.destination&&ot(this,zn,Xm).call(this,"destination",r.instructions[r.instructions.length-1]),n){i();return}f(this,nn).mapObjects.forEach(l=>{l.processFloorChange(l.currentFloorId)}),ot(this,zn,Hv).call(this),i()}),cancel:()=>{n=!0}}),f(this,qh).promise},G6=function(t){var e,r,n;ne(this,rn,{setMapOnConnectionClick:(e=t.setMapOnConnectionClick)!=null?e:Fh.setMapOnConnectionClick,setMapToDeparture:(r=t.setMapToDeparture)!=null?r:Fh.setMapToDeparture,pathOptions:ae(ae({},Fh.pathOptions),t.pathOptions),inactivePathOptions:ae(ae({},Fh.inactivePathOptions),t.inactivePathOptions),createMarkers:ae(ae({},Fh.createMarkers),t.createMarkers),markerOptions:ae(ae({},Fh.markerOptions),t.markerOptions),animatePathDrawing:(n=t.animatePathDrawing)!=null?n:Fh.animatePathDrawing})},Hv=function(){f(this,nn).publish("navigation-state-change",{isMultiFloor:this.isMultiFloor,floorStacks:this.floorStacks,floors:this.floors,activeDirections:this.activeDirections,activePath:this.activePath,paths:this.paths})},Rw=function(t){ne(this,us,t),f(this,Wi).forEach(e=>{let r=f(this,Al).get(e);if(r){let n=r.id===f(this,us).id?ae({},f(this,rn).pathOptions):ae({},f(this,rn).inactivePathOptions);f(this,nn).updateState(r,n)}}),f(this,nn).publish("navigation-active-path-change",{directions:this.activeDirections,path:this.activePath}),ot(this,zn,zL).call(this),ot(this,zn,Hv).call(this)},Xm=function(t,e){var r,n,i,a,o;if(t==="connection"&&e){let s=e.action.type==="ExitConnection"?f(this,rn).markerOptions.departureColor:f(this,rn).markerOptions.destinationColor,l;typeof((r=f(this,rn).createMarkers)==null?void 0:r.connection)=="function"?(l=f(this,rn).createMarkers.connection(e),f(this,nn).updateState(l,{interactive:!0})):l=ot(this,zn,CI).call(this,e,$He({type:(i=(n=e.action.connection)==null?void 0:n.type)!=null?i:e.action.connectionType,color:s,direction:e.action.direction}),!0),f(this,Xh).set(l.id,{instruction:e,marker:l})}else{let s=t==="departure"?f(this,rn).markerOptions.departureColor:f(this,rn).markerOptions.destinationColor,l;typeof((a=f(this,rn).createMarkers)==null?void 0:a.departure)=="function"&&t==="departure"?l=f(this,rn).createMarkers.departure(e):typeof((o=f(this,rn).createMarkers)==null?void 0:o.destination)=="function"&&t==="destination"?l=f(this,rn).createMarkers.destination(e):l=ot(this,zn,CI).call(this,e,LHe({type:t,color:s})),f(this,Xh).set(l.id,{instruction:e,marker:l})}},Z6=function(t,e){t.filter(r=>ot(this,zn,BL).call(this,r.action)).forEach(r=>{ot(this,zn,Xm).call(this,e,r)})},Xv=new WeakMap;C();var sr,yA,wp,Eb,W6,XHe=class{constructor(t){K(this,wp),K(this,sr),K(this,yA),S(this,"interactions",{set:e=>{e?.pan!=null&&(f(this,sr).getSystems().cameraSystem.enablePan=e.pan),e?.zoom!=null&&(f(this,sr).getSystems().cameraSystem.enableZoom=e.zoom),e?.bearingAndPitch!=null&&(f(this,sr).getSystems().cameraSystem.enableRotate=e.bearingAndPitch)},enable:()=>{f(this,sr).getSystems().cameraSystem.enablePan=!0,f(this,sr).getSystems().cameraSystem.enableZoom=!0,f(this,sr).getSystems().cameraSystem.enableRotate=!0},disable:()=>{f(this,sr).getSystems().cameraSystem.enablePan=!1,f(this,sr).getSystems().cameraSystem.enableZoom=!1,f(this,sr).getSystems().cameraSystem.enableRotate=!1}}),S(this,"setMinPitch",e=>{f(this,sr).camera.setMinPitch(e)}),S(this,"setMaxPitch",e=>{f(this,sr).camera.setMaxPitch(e)}),S(this,"setMinZoomLevel",e=>{f(this,sr).camera.setMinZoomLevel(e,!0)}),S(this,"setMaxZoomLevel",e=>{f(this,sr).camera.setMaxZoomLevel(e)}),ne(this,yA,t),ne(this,sr,t.core)}setScreenOffsets(t){f(this,sr).camera.setInsetPadding(t)}get screenOffsets(){return f(this,sr).camera.insetsPadding}get panMode(){return f(this,sr).camera.panMode}setPanMode(t){if(t!=="default"&&t!=="elevation")throw new Error("Invalid pan mode");t!==this.panMode&&f(this,sr).camera.setPanMode(t)}getFocusOnTransform(t,e){var r,n,i;let a=f(this,sr).camera.getCameraFrameForCoordinates(ot(this,wp,W6).call(this,t),{pitch:e?.pitch,bearing:e?.bearing,padding:e?.screenOffsets||this.screenOffsets,maxZoomLevel:e?.maxZoomLevel,verticalPadding:(r=e?.axisAlignedPadding)==null?void 0:r.vertical,minZoomLevel:e?.minZoomLevel,duration:e?.duration,easing:e?.easing});return{center:new Rr(a.center[1],a.center[0]),zoomLevel:a.zoomLevel,bearing:(n=e?.bearing)!=null?n:this.bearing,pitch:(i=e?.pitch)!=null?i:this.pitch}}focusOn(t,e){var r;return f(this,sr).camera.focusOn(ot(this,wp,W6).call(this,t),{pitch:e?.pitch,bearing:e?.bearing,padding:e?.screenOffsets||this.screenOffsets,maxZoomLevel:e?.maxZoomLevel,minZoomLevel:e?.minZoomLevel,duration:e?.duration,verticalPadding:(r=e?.axisAlignedPadding)==null?void 0:r.vertical,easing:e?.easing})}animateTo(t,e){var r;let{center:n,zoomLevel:i,bearing:a,pitch:o}=t,s=n??this.center;return f(this,sr).camera.animateTo({center:n!=null?[s.longitude,s.latitude,f(this,sr).camera.elevation]:void 0,zoomLevel:i,bearing:a,pitch:o,duration:(r=e?.duration)!=null?r:600,easing:e?.easing})}set(t){let{center:e=this.center,zoomLevel:r=this.zoomLevel,bearing:n=this.bearing,pitch:i=this.pitch}=t,a=[e.longitude,e.latitude];f(this,sr).camera.setCenter(a),f(this,sr).camera.setZoomLevel(r),f(this,sr).camera.setBearing(n),f(this,sr).camera.setPitch(i)}get center(){let t=f(this,sr).camera.center;return new Rr(t[1],t[0],void 0)}setAutoMinZoomLevel(t){f(this,sr).camera.setAutoMinZoomLevel(t)}get autoMinZoomLevel(){return f(this,sr).camera.autoMinZoomLevel}get zoomLevel(){return f(this,sr).camera.zoomLevel}get pitch(){return f(this,sr).camera.pitch}get minPitch(){return f(this,sr).camera.minPitch}get maxPitch(){return f(this,sr).camera.maxPitch}get bearing(){let t=f(this,sr).camera.bearing;return(t<0?t+360:t)%360}get minZoomLevel(){return f(this,sr).camera.minZoomLevel}get maxZoomLevel(){return f(this,sr).camera.maxZoomLevel}setElevation(t){f(this,sr).camera.setElevation(t)}get elevation(){return f(this,sr).camera.elevation}animateElevation(t,e){return f(this,sr).camera.animateElevation(t,e)}get bounds(){return pte(f(this,sr).getSystems().cameraSystem.panBounds,f(this,sr).convert3DMapPositionToCoordinate)}get isAnimating(){return f(this,sr).camera.isAnimating}cancelAnimation(){f(this,sr).camera.cancelAnimation()}updateFacadesInView(){f(this,sr).getSystems().geometryInFocusSystem.raycast()}};sr=new WeakMap,yA=new WeakMap,wp=new WeakSet,Eb=function(t){var e,r,n,i,a,o;let s=f(this,sr).camera.elevation;return Rr.is(t)&&t.floorId!=null?(r=(e=f(this,sr).getState(t.floorId))==null?void 0:e.altitude)!=null?r:s:Fc.is(t)?(i=(n=f(this,sr).getState(t.id))==null?void 0:n.altitude)!=null?i:s:"floor"in t&&Fc.is(t.floor)&&(o=(a=f(this,sr).getState(t.floor.id))==null?void 0:a.altitude)!=null?o:s},W6=function(t){var e;let r=[],n=(Array.isArray(t)?t:[t]).flatMap(i=>{var a;return(a=i?.focusTarget)!=null?a:[i]});for(let i of n)if(i!=null)if(Rr.is(i)){let a=ot(this,wp,Eb).call(this,i);r.push([i.longitude,i.latitude,a])}else if(i?.id!=null){let a=ot(this,wp,Eb).call(this,i);if(Fc.is(i)&&(e=f(this,yA).getMapDataInternal())!=null&&e.enterpriseMode){r.push(i.id);continue}else if("geoJSON"in i&&i.geoJSON.geometry.coordinates.length>0){k3(i.geoJSON,s=>{r.push([s[0],s[1],a])});continue}let o=f(this,sr).getBoundingArea(i.id);if(o)r.push(...o.map(s=>[s[0],s[1],a]));else if("geoJSONBoundingBox"in i){let s=ot(this,wp,Eb).call(this,i);if(i.geoJSONBoundingBox!=null){let l=[[i.geoJSONBoundingBox[0],i.geoJSONBoundingBox[1],s],[i.geoJSONBoundingBox[2],i.geoJSONBoundingBox[3],s]];r.push(...l)}}}else Xee(i)&&r.push(i);return r};C();var Iv,qHe=class{constructor({currentMapGetter:t}){K(this,Iv),ne(this,Iv,t)}get currentMap(){return f(this,Iv).call(this)}async getCurrentSceneGLTF(t){let e=f(this,Iv).call(this);return e?e?.Exporter.getCurrentSceneGLTF(t):(Be.error("There is no map to export. Please load a map first."),new Blob)}};Iv=new WeakMap;C();var nu,Lw,YHe=class{constructor({currentMapGetter:t}){K(this,nu,new Map),K(this,Lw),ne(this,Lw,t)}get currentMap(){return f(this,Lw).call(this)}getAll(){return Array.from(f(this,nu).values()).map(t=>t.label)}getById(t){return f(this,nu).get(t)}add(t,e,r){let n=t.anchorTarget,i=this.currentMap;if(!i)throw new Error("currentMap should exist");let a=i.Labels.add(n,e,lt(ae({},r),{attachTo:aB(t),rank:r?.rank==null||r?.rank==="initial"?"medium":r.rank})),o=new pA(a.id.toString(),e,t);return f(this,nu).set(o.id,{label:o,entityId:o.id}),o}__EXPERIMENTAL__all(t){var e;let r=[];return(e=this.currentMap)==null||e.Labels.all({onCreate:(n,i,a)=>{let o=new pA(n.toString(),i,a);f(this,nu).set(o.id,{label:o,entityId:o.id}),r.push(o)},labelOptions:t}),r}remove(t){var e;let r=f(this,nu).get(t.id);r&&((e=this.currentMap)==null||e.Labels.remove(r),f(this,nu).delete(t.id.toString()))}removeAll(){let t=[];return f(this,nu).forEach(({label:e})=>{this.remove(e),t.push(e),f(this,nu).delete(e.id.toString())}),t}};nu=new WeakMap,Lw=new WeakMap;C();C();var JHe={color:"#ffffff",opacity:1},Nw={altitude:0,height:1,color:"#ffffff",opacity:1,width:.15},FL={opacity:.25,color:"#a7d1ec",height:.8,width:.05,altitude:.1,cap:"square",visible:!1},RL={color:"red",opacity:.2,height:Nw.height+.1,visible:!0,borderVisible:!1},LL=.5,sc=class{constructor(t,e,r=new Map){S(this,"containerId"),S(this,"layers"),S(this,"renderer"),this.containerId=e,this.layers=r,this.renderer=t}get visible(){return this.renderer.getState(this.containerId).visible}setVisible(t){this.renderer.setState(this.containerId,{visible:t})}},NL=0,km,$L=class{constructor(t,e,r,n,i,a,o,s){S(this,"id"),S(this,"name"),S(this,"elevation"),S(this,"maxHeight"),S(this,"containerId"),S(this,"externalId"),S(this,"metadata"),S(this,"shortName"),S(this,"subtitle"),S(this,"occluderId"),S(this,"loaded",!1),S(this,"styleMap",{}),S(this,"obstructions"),S(this,"entrances"),S(this,"spaces"),S(this,"floorImages"),S(this,"floorText"),S(this,"areas"),S(this,"renderer"),S(this,"mapObject"),S(this,"options"),S(this,"layers",new Map),S(this,"footprint"),S(this,"floorStackId"),S(this,"multiFloorView"),S(this,"mapDataInternal"),S(this,"facadesByStyleId",new Map),K(this,km),S(this,"load",()=>{var y,v,_,w,b,A,E,M,P,k,D,O,B,L,R,T,N,$,V,G,ee,ie,me;if(this.loaded)return this;((y=this.footprint)==null?void 0:y.geometry)==null&&((v=this.obstructions)==null?void 0:v.features.length)===0&&((_=this.spaces)==null?void 0:_.features.length)===0&&Be.warn("Floor ".concat(this.id," exists in the data but contains no geometry.")),this.loaded=!0;let Me=this.renderer.addGroupContainer("".concat(i0,"-").concat(this.id),{},this.id);this.layers.set(i0,new sc(this.renderer,Me.id.toString()));let Ae=this.renderer.addGroupContainer("".concat(kp,"-").concat(this.id),{},this.id);this.layers.set(kp,new sc(this.renderer,Ae.id.toString()));let le=this.renderer.addGroupContainer("".concat(Ma,"-").concat(this.id),{},this.id);this.layers.set(Ma,new sc(this.renderer,le.id.toString()));let _e=this.renderer.addGroupContainer("".concat(a0,"-").concat(this.id),{},this.id);this.layers.set(a0,new sc(this.renderer,_e.id.toString()));let Le=this.mapObject.getFloorStackAltitudeData(this.floorStackId);if(((w=this.footprint)==null?void 0:w.geometry)!=null&&((b=this.footprint)==null?void 0:b.geometry.coordinates.length)!==0){let Se=Nw;if(this.obstructions!=null&&this.obstructions.features.length>0){let Y=this.obstructions.features.filter(we=>{var q;return we.geometry.type==="LineString"&&((q=we.properties.kind)==null?void 0:q.toLowerCase())==="wall"&&we.properties.footprintComponent===!0});Y!=null&&Y.length>0&&(Se=this.styleMap[(A=Y[0].properties)==null?void 0:A.id])}let Ue=this.renderer.addGeometryGroup("Footprint-".concat(this.id),{features:[{geometry:this.footprint.geometry,properties:{id:"Footprint-Floor-".concat(this.id)}}]},lt(ae({},Se),{height:(P=(E=Le.get(this.elevation))==null?void 0:E.effectiveHeight)!=null?P:o0((M=this.multiFloorView)==null?void 0:M.floorGap,this.maxHeight),altitude:0,outline:(D=(k=this.options.style)==null?void 0:k.outlines)!=null?D:!0,visible:!1,opacity:this.elevation<0?1:.4,side:this.elevation<0?"back":"front",color:this.elevation<0?"#F0EEE8":Se.color,renderOrder:2}),this.id);this.layers.set(nB,new sc(this.renderer,Ue.id.toString()))}if(this.spaces!=null&&this.spaces.features.length>0){let Se=[],Ue=new Map;this.spaces.features.filter(q=>{var oe;return q.geometry.type==="Polygon"&&((oe=q.properties.kind)==null?void 0:oe.toLowerCase())!=="void"}).forEach(q=>{var oe;let ce=(oe=this.mapDataInternal)==null?void 0:oe.facadesBySpaceId[q.properties.id];if(ce){let X=Ue.get(ce.id)||[];Ue.set(ce.id,[...X,q])}else Se.push(q)});let Y=this.renderer.addGroupContainer("spaces-".concat(this.id),{},le),we=this.renderer.addGeometryGroup("Spaces-".concat(this.id,"-0"),{features:Se},q=>{var oe;return((oe=q?.properties)==null?void 0:oe.id)!=null&&this.styleMap[q.properties.id]!=null?by(this.styleMap[q.properties.id],this.options):JHe},Y);if(this.layers.get(Ma).layers.set("Spaces",we.id.toString()),Ue.size>0){let q=this.renderer.addGroupContainer("".concat(Gv,"-").concat(this.id),{},this.id);this.layers.set(Gv,new sc(this.renderer,q.id.toString()));for(let[oe,ce]of Ue){let X=this.renderer.addGroupContainer(oe,{focusable:!0},q),ke=this.renderer.addGroupContainer("".concat(oe,"-geometry"),{},X),Ce=HR(ce,this.styleMap),Ee=0;for(let[Ne,st]of Ce){let Ke=this.renderer.addGeometryGroup("Facades-".concat(this.id,"-").concat(oe,"-").concat(Ee),{features:st},lt(ae({},by(Ne,this.options)),{renderOrder:3}),ke);Ee++;let J=Ne.id||Ke.id.toString();this.layers.get(Gv).layers.set("".concat(oe,"-").concat(J),Ke.id.toString()),this.facadesByStyleId.has(J)?(O=this.facadesByStyleId.get(J))==null||O.push(oe):this.facadesByStyleId.set(J,[oe])}}}}if(this.obstructions!=null&&this.obstructions.features.length>0){let Se=this.obstructions.features.filter(Ce=>Ce.geometry.type==="Polygon"&&(Ce.properties.kind==="object"||Ce.properties.kind==="unknown")),Ue=HR(Se,this.styleMap),Y=this.renderer.addGroupContainer("objects-".concat(this.id),{},le),we=0;for(let[Ce,Ee]of Ue){let Ne=this.renderer.addGeometryGroup("Objects-".concat(this.id,"-").concat(we),{features:Ee},by(Ce,this.options),Y);we++;let st=Y.id.toString();this.layers.get(Ma).layers.set(Ce.id||st,Ne.id.toString())}let q=this.obstructions.features.filter(Ce=>{var Ee;return Ce.geometry.type==="LineString"&&((Ee=Ce.properties.kind)==null?void 0:Ee.toLowerCase())==="wall"&&Ce.properties.footprintComponent===!1}),oe=this.obstructions.features.filter(Ce=>{var Ee;return Ce.geometry.type==="LineString"&&((Ee=Ce.properties.kind)==null?void 0:Ee.toLowerCase())==="wall"&&Ce.properties.footprintComponent===!0}),ce=this.entrances,X=Nw,ke=Nw;if(q!=null&&q.length>0){let Ce=this.styleMap[(B=q[0].properties)==null?void 0:B.id];Ce!=null&&(X=ae({},Ce)),ke=X;let{walls:Ee,entrances:Ne}=WR(q,ce?.features||[]),st=Math.max(X.height-.11,LL),Ke=lt(ae({},FL),{height:st}),J=this.renderer.addGeometryGroup("InteriorDoors-".concat(this.id),Ne,Ke,le);this.layers.get(Ma).layers.set(tB,J.id.toString());let Z=this.renderer.addGeometryGroup("Walls-".concat(this.id),{features:[Ee]},by(X,this.options),le);this.layers.get(Ma).layers.set(cS,Z.id.toString())}if(oe!=null&&oe.length>0){let Ce=this.styleMap[(L=oe[0].properties)==null?void 0:L.id];Ce!=null&&(ke=lt(ae({},Ce),{id:n0}));let{walls:Ee,entrances:Ne}=WR(oe,ce?.features||[]),st=Math.max(ke.height-.11,LL),Ke=lt(ae({},FL),{height:st}),J=this.renderer.addGeometryGroup("ExteriorDoors-".concat(this.id),Ne,Ke,le);this.layers.get(Ma).layers.set(rB,J.id.toString());let Z=this.renderer.addGeometryGroup("ExteriorWalls-".concat(this.id),{features:[Ee]},by(ke,this.options),le);this.layers.get(Ma).layers.set(n0,Z.id.toString())}}if(this.floorImages!=null){let Se=this.renderer.addGroupContainer("images-".concat(this.id),{},this.id);for(let Ue of this.floorImages.features||[])if(!("anchorId"in Ue.properties||"anchorId"in Ue.properties&&((R=Ue.properties)==null?void 0:R.anchorId)==null)){let Y=WVe(Ue,NL);this.mapObject.api.Image3D.add(new Rr({latitude:Ue.geometry.coordinates[1],longitude:Ue.geometry.coordinates[0],floorId:this.id}),Ue.properties.path,ae({id:Y,flipImageToFaceCamera:(T=this.options.flipImagesToFaceCamera)!=null?T:!0},Ue.properties)),NL++}this.layers.set(iB,new sc(this.renderer,Se.id.toString()))}if(this.floorText!=null)for(let Se of this.floorText.features||[]){let Ue=0;"geometryId"in Se.properties?Ue=($=(N=this.renderer.getState(Se.properties.geometryId))==null?void 0:N.height)!=null?$:0:Ue=(V=Se.properties.verticalOffset)!=null?V:0,this.renderer.addText3D(Wn(),lt(ae({},Se),{properties:lt(ae({},Se.properties),{verticalOffset:Ue})}),{},this.id)}if(this.areas!=null){let Se=this.renderer.addGroupContainer("areas-".concat(this.id),{},this.id);this.layers.set(lA,new sc(this.renderer,Se.id.toString()));let Ue=this.renderer.addGeometryGroup("Areas-".concat(this.id),{features:this.areas.features},{color:RL.color},Se);for(let Y of this.areas.features||[])this.renderer.setState(Y.properties.id,lt(ae({},RL),{visible:!1}));this.layers.get(lA).layers.set(Ue.id.toString(),Ue.id.toString())}return(G=this.multiFloorView)!=null&&G.enabled&&this.renderer.setState(this.id,{altitude:(me=(ee=Le.get(this.elevation))==null?void 0:ee.altitude)!=null?me:this.elevation*o0((ie=this.multiFloorView)==null?void 0:ie.floorGap,this.maxHeight)}),this.renderer.render(),this});var l,u,c,h,d,p;this.mapObject=r,this.renderer=r.renderer,this.id=e.id,this.options=i;let m=this.renderer.addGroupContainer(this.id,{visible:!1,interactive:!0,preloadGeometry:(l=i.preloadFloors)==null?void 0:l.map(y=>y.id).includes(e.id)},t);this.containerId=m.id.toString(),this.externalId=e.externalId,this.metadata=e.metadata,this.shortName=e.shortName,this.subtitle=e.subtitle,this.name=e.name,this.maxHeight=e.maxHeight,this.elevation=e.elevation,a!=null&&o!=null&&(this.styleMap=o,this.spaces=a.space[this.id],this.entrances=a.entrance[this.id],this.areas=(u=a.area)==null?void 0:u[this.id],this.obstructions=a.obstruction[this.id],this.floorImages=(c=a.floorImages)==null?void 0:c[this.id],this.floorText=(d=(h=a.enterprise)==null?void 0:h.floorText)==null?void 0:d[this.id],this.footprint=(p=a["floor.geojson"])==null?void 0:p.features.find(y=>y.properties.id===e.id)),this.floorStackId=t,this.multiFloorView=n,this.mapDataInternal=s}get geoJSONBoundingBox(){if(f(this,km))return f(this,km);if(!this.footprint){Be.warn("Attempting to get bounding box with no footprint for floor ".concat(this.id));return}return ne(this,km,dte(this.footprint)),f(this,km)}addOccluder(){var t;if(((t=this.footprint)==null?void 0:t.geometry)==null)return;let e=this.renderer.addGroupContainer("".concat(sA,"-").concat(this.id),{},this.id),r=new sc(this.renderer,e.id.toString());this.layers.set(sA,r),this.occluderId=this.renderer.addOccluder(this.footprint,r.containerId)}get hasFacadeGeometry(){return this.facadesByStyleId.size>0}get visible(){return this.renderer.getState(this.containerId).visible}setVisible(t){this.renderer.setState(this.containerId,{visible:t})}};km=new WeakMap;C();var Cv,UL=class{constructor(t,e,r,n){S(this,"id"),S(this,"externalId"),S(this,"name"),S(this,"type"),S(this,"floorIds"),S(this,"defaultFloorId"),S(this,"floorObjects",[]),S(this,"floorObjectsByElevation",new Map),S(this,"metadata"),S(this,"containerId"),S(this,"facade"),S(this,"renderer"),K(this,Cv);var i;this.id=t.id,this.externalId=t.externalId,this.name=t.name,this.type=t.type,this.metadata=t.metadata,this.floorIds=(i=t.floors)!=null?i:t.maps,this.defaultFloorId=t.defaultFloor,this.renderer=r;let a=r.addGroupContainer(this.id,{visible:!0,interactive:!0},e);this.containerId=a.id.toString(),this.facade=n}get defaultFloor(){if(f(this,Cv)==null){if(this.floorObjects.length===0)throw new ho("No floors in floor stack (".concat(this.id,"). Could not get default floor."));let t;this.defaultFloorId&&(t=this.floorObjects.find(e=>e.id===this.defaultFloorId)),t||(t=this.floorObjects.reduce((e,r)=>Math.abs(r.elevation)<Math.abs(e.elevation)?r:e)),ne(this,Cv,t)}return f(this,Cv)}get isOutdoors(){var t;return((t=this.type)==null?void 0:t.toLowerCase())==="outdoor"?!0:this.facade!=null?!1:this.floorObjects.some(e=>e.hasFacadeGeometry)}addFloor(t){if(this.floorObjectsByElevation.has(t.elevation)){Be.error("Floor with same elevation ".concat(t.elevation," already exists in Stack (").concat(this.id,"). Floor (").concat(t.id,") will not be added."));return}this.floorObjects.push(t),this.floorObjectsByElevation.set(t.elevation,t),this.facade&&this.renderer.setState(t.containerId,{focusable:!0})}loadAllFloors(){for(let t of this.floorObjects)t.load(),!this.isOutdoors&&!t.hasFacadeGeometry&&t.footprint!=null&&t.addOccluder()}};Cv=new WeakMap;C();function KHe(t,e,r="auto",n,i=new Map){var a,o;let s={outdoorOpacity:1,floorStates:[]},l=t.sort((h,d)=>h.elevation-d.elevation),u=t.some(h=>h.elevation===0),c=!0;for(let h of l){let d=(o=(a=i.get(h.elevation))==null?void 0:a.effectiveHeight)!=null?o:o0(r,h.maxHeight),p={floor:h,state:{type:"floor",visible:!1,geometry:{visible:!1},labels:{enabled:!1},markers:{enabled:!1},footprint:{visible:!1},occlusion:{enabled:!1},areas:{visible:!1}}};s.floorStates.push(p),h.id===e.id?(p.state.visible=!0,p.state.geometry.visible=!0,p.state.labels.enabled=!0,p.state.markers.enabled=!0,p.state.occlusion.enabled=!0,p.state.areas.visible=!0,h.elevation<0&&(p.state.footprint.height=d,p.state.footprint.visible=!0,s.outdoorOpacity=.2)):n.includes(h.id)&&h.elevation<e.elevation?(p.state.visible=!0,p.state.geometry.visible=!0,p.state.markers.enabled=!0,p.state.occlusion.enabled=!0,p.state.footprint.visible=!0,p.state.footprint.height=d,h.elevation<0&&(s.outdoorOpacity=.2)):e.elevation>0&&h.elevation<e.elevation&&h.elevation>=0&&(p.state.visible=!0,p.state.footprint.visible=!0,p.state.footprint.height=d),!u&&h.elevation>0&&c&&e.elevation===h.elevation&&(c=!1,p.state.footprint.visible=!1)}return s}var iu,jL=class extends wi{constructor(t,e,r,n){var i,a,o,s;super(),S(this,"floorStacksById",new Map),S(this,"floorsById",new Map),S(this,"startingFloorId",""),S(this,"currentFloorId",""),S(this,"currentFloorStackId",""),S(this,"outdoorFloorStacks",new Set),S(this,"id"),S(this,"renderer"),S(this,"api"),S(this,"mvf"),S(this,"options",{}),S(this,"styleMap"),S(this,"animations",new Map),S(this,"floorStackAltitudeMap",new Map),S(this,"Models",{add:(h,d,p)=>{let m=p,{floorId:y,scale:v}=m,_=yu(m,["floorId","scale"]),w=y?this.floorsById.get(y):void 0,b=ae({},_);v!=null&&(b.scale=Array.isArray(p.scale)?p.scale:[p.scale,p.scale,p.scale]);let A=this.renderer.addModelGroup(h,{type:"FeatureCollection",features:d.map(E=>({type:"Feature",properties:{id:Wn(),rotation:p.rotation,scale:b.scale,interactive:p.interactive},geometry:{type:"Point",coordinates:Sc(E)}}))},b,{parent:w?.id});if(A==null)throw new ho("error creating model");return this.renderer.getState(A).children},remove:(h,d)=>{this.renderer.remove(h),this.renderer.getState(d).children.length===0&&this.renderer.remove(d)}}),S(this,"Image3D",{add:(h,d,p)=>{var m;let y=p,{floorId:v,flipImageToFaceCamera:_}=y,w=yu(y,["floorId","flipImageToFaceCamera"]),b=v?this.floorsById.get(v):this.currentFloor,A={type:"Feature",properties:w,geometry:{type:"Point",coordinates:h}};return this.renderer.addImage((m=p.id)!=null?m:Wn(),A,{url:d,flipImageToFaceCamera:_??!1},b.id)},remove:h=>{this.renderer.remove(h)},removeAll:()=>{}}),S(this,"Markers",{add:(h,d,p)=>{let m=UT(h,this.floorsById,this.api.mapObjects[0].floorsById.get("default-floor")),y=p,{attachTo:v}=y,_=yu(y,["attachTo"]),w=_;_.rank==="initial"&&(w.rank="medium");let b=m.layers.get(kp),A=this.renderer.addMarker2D(Sc(h),d,lt(ae({},w),{occluderId:m?.occluderId,attachTo:v}),b?.containerId);if(!A)throw new ho("Failed to create Marker");return A},remove:h=>{this.renderer.remove(h)},getContentEl:h=>{let d=this.renderer.getState(h);if(d?.type==="marker")return d.element},removeAll:()=>{},setPosition:(h,d,p)=>{var m;let y=this.renderer.getState(h),v=p?this.floorsById.get(p):this.currentFloor;if(!y){Be.error('Failed to retrieve state for Marker with id "'.concat(h,'".'));return}if(y.type!=="marker"){Be.error('Geometry with id "'.concat(h,'" is not of type "marker".'));return}this.renderer.setState(y,{position:d,parent:(m=v?.layers.get(kp))==null?void 0:m.containerId})},animateTo:(h,d,p,m)=>{let y=this.renderer.getState(h),v=p?this.floorsById.get(p):this.currentFloor;if(!y)return Be.error('Failed to retrieve state for Marker with id "'.concat(h,'".')),Promise.resolve();if(y.type!=="marker")return Be.error('Geometry with id "'.concat(h,'" is not of type "marker".')),Promise.resolve();let _=ae({duration:1e3,easing:"ease-in-out"},m);this.cancelAnimation(h);let w=new l0({lon:y.position[0],lat:y.position[1]}).to({lon:d[0],lat:d[1]},_.duration).easing(u0[_.easing]).onUpdate(({lon:b,lat:A})=>{var E;if(!this.renderer.getState(h))this.cancelAnimation(h);else{let M=(E=v?.layers.get(kp))==null?void 0:E.containerId;M&&this.Markers.setPosition(h,[b,A],M)}}).start();return this.renderer.getInternalTweenGroup().add(w),this.renderer.render(),this.animations.set(h,w),XR(w).then(()=>{this.animations.delete(h)})}}),S(this,"Exporter",{getCurrentSceneGLTF:async h=>this.renderer.getCurrentSceneGLTF(h)}),S(this,"Shapes",{add:(h,d,p)=>{let m=p!=null&&p.floorId?this.floorsById.get(p?.floorId):this.currentFloor,y="shape-"+Wn();return this.renderer.addGeometryGroup(y,h,d,m.id),y},remove:h=>(this.renderer.remove(h.id),h.id)}),S(this,"Text3D",{label:(h,d,p)=>{var m;if(!((m=this.api.getMapDataInternal())!=null&&m.enterpriseMode)){Be.warn("Enterprise mode is not enabled, skipping label creation");return}let y=VL(this.renderer,h,d,p);if(y)return{textInfo:y,target:h}},labelAll:(h={})=>{var d;if(!((d=this.api.getMapDataInternal())!=null&&d.enterpriseMode))return Be.warn("Enterprise mode is not enabled, skipping label creation"),[];let p=this.api.getMapData();if(!p)return[];let m=[];return p.getByType("space").forEach(y=>{var v,_;if(y.locations[0]){let w=VL(this.renderer,y,(_=(v=y.locations[0])==null?void 0:v.name)!=null?_:y.name,h);w&&m.push({textInfo:w,target:y})}}),m},remove:h=>{var d;if(!((d=this.api.getMapDataInternal())!=null&&d.enterpriseMode)){Be.warn("Remove text label only works in enterprise mode");return}return this.renderer.remove(h),h}}),S(this,"Labels",{all:({onCreate:h,labelOptions:d={}})=>{for(let p of Object.entries(this.mvf.space)){let[m,y]=p;y&&y.features.forEach(v=>{var _,w,b,A;let E=(_=this.api.getMapData())==null?void 0:_.getById("space",v.properties.id);if(!E)return;let M=(w=this.styleMap[v.properties.id])==null?void 0:w.showImage,P=(b=v.properties.details)==null?void 0:b.images,k=M&&(A=P?.[0])!=null&&A.url?{icon:P[0].url}:{},D=ae({icon:k.icon},d.appearance),O=(m?this.floorsById.get(m):this.currentFloor).layers.get(i0);if(v.properties.center&&E.name!==""){let B=this.renderer.addLabel2D(v.properties.center,E.name,lt(ae({id:v.properties.id+"-label"},d),{appearance:D,rank:d.rank,attachTo:aB(E)}),Xs.is(E)?E.id:O?.containerId);B&&h(B.id,E.name,E)}})}},add:(h,d,p={})=>{let m=p,{attachTo:y}=m,v=yu(m,["attachTo"]),_=UT(h,this.floorsById,this.api.mapObjects[0].floorsById.get("default-floor")),w=_.layers.get(i0),b=this.renderer.addLabel2D(Sc(h),d,lt(ae({},v),{occluderId:_.occluderId,attachTo:y}),w?.containerId);if(!b)throw new ho("label creating failed");return b},remove:({entityId:h})=>{this.renderer.remove(h)},removeAll:()=>{}}),S(this,"Paths",{add:(h,d)=>{var p;let m=(p=d?.animateDrawing)!=null?p:!0,y=[],v=h[0].floorId||"root",_=0;for(let b of h){let{floorId:A="root",latitude:E,longitude:M}=b;A!==v&&(_++,v=A),y[_]==null&&y.push({floorId:A,coordinates:[]});let P=A===b.floorId?b:new Rr({longitude:M,latitude:E,floorId:A});y[_].coordinates.push(P)}let w=y.reduce((b,{floorId:A,coordinates:E},M)=>{var P,k;if(M!==0){let B=y[M-1],L=B.coordinates[B.coordinates.length-1],R=E[0],T=Sc(L),N=Sc(R),$=this.renderer.addPath({type:"FeatureCollection",features:[{type:"Feature",properties:{parentId:B.floorId},geometry:{type:"Point",coordinates:T}},{type:"Feature",properties:{parentId:A},geometry:{type:"Point",coordinates:N}}]},d,this.id);$&&(m&&this.renderer.setState($.id,{completeFraction:0}),b.push(lt(ae({},$),{coordinates:[L,R]})))}if(E.length<2)return b;let D=(k=(P=this.floorsById.get(A))==null?void 0:P.layers.get(a0))==null?void 0:k.containerId,O=this.renderer.addPath({type:"FeatureCollection",features:E.map(B=>({type:"Feature",properties:{},geometry:{type:"Point",coordinates:Sc(B)}}))},d,D??A);return O&&(m&&this.renderer.setState(O.id,{completeFraction:0}),b.push(lt(ae({},O),{coordinates:E}))),b},[]);if(m){let b=[],A=this.api.getMapData();return w.forEach(E=>{var M;let P=ZVe(E,A,this.api);b.push(new l0({fraction:0}).to({fraction:1},P?(M=d?.drawDuration)!=null?M:1500:0).onUpdate(k=>{this.renderer.setState(E.id,{completeFraction:k.fraction})}))}),b.forEach((E,M)=>{M<b.length-1&&E.chain(b[M+1]),this.renderer.getInternalTweenGroup().add(E)}),b[0].start(),this.renderer.render(),this.animations.set(w[0].id.toString(),b[0]),{paths:w,animation:XR(b[b.length-1]).then(()=>{this.animations.delete(w[0].id.toString())})}}else return{paths:w,animation:Promise.resolve()}},remove:h=>{h.forEach(d=>{this.cancelAnimation(d),this.renderer.remove(d)})}}),K(this,iu,{enabled:!1,floorGap:"auto",updateCameraElevationOnFloorChange:!0}),this.renderer=n.core,this.api=n,this.id=t,this.renderer.addGroupContainer(t,{},"root"),this.options=r??{},this.mvf=(i=e?.mvf)!=null?i:{};let l=jVe(this.mvf["styles.json"]||{});if(this.styleMap=l,ne(this,iu,ae({enabled:!1,floorGap:"auto",updateCameraElevationOnFloorChange:!0},r?.multiFloorView)),!e){this.id!=="outdoors-container"&&Be.warn("Map (".concat(this.id,") created with no data."));let h=new UL({id:"default-stack",externalId:"default-stack",name:"Default Stack",maps:["default-floor"]},this.id,this.renderer);this.floorStacksById.set(h.id,h),this.currentFloorStackId=h.id;let d=new $L(h.id,{id:"default-floor",externalId:"default-floor",name:"Default Floor",elevation:0},this,f(this,iu),r??{});this.floorsById.set(d.id,d),h.addFloor(d),this.setFloor(d.id);return}let u=e.getMVFFeatureByType("floor-stack");if(u==null||u.length===0)throw new ho("MVF does not contain any Floor Stacks.");for(let h of u){let d=new UL(h,this.id,this.renderer,(a=this.mvf.facade)==null?void 0:a[h.id]);for(let p of d.floorIds){let m=e.getMVFFeatureById("floor",p);if(m!=null){let y=new $L(d.id,m,this,f(this,iu),r??{},this.mvf,l,e);this.floorsById.set(y.id,y),d.addFloor(y)}}if(d.floorObjects.length<1){Be.warn("Floor stack ".concat(h.id," has no floors. It will not be loaded."));continue}this.floorStacksById.set(h.id,d),this.currentFloorStackId||(this.currentFloorStackId=h.id),this.floorStackAltitudeMap.set(h.id,HVe(d.floorObjects,f(this,iu).floorGap))}for(let[h]of Object.entries(e.facadesBySpaceId)){let d=e.getById("space",h);d&&(this.outdoorFloorStacks.add(d.floor.floorStack.id),(o=this.floorsById.get(d.floor.id))==null||o.setVisible(!0))}let c=(s=this.mvf.enterprise)==null?void 0:s.venue.defaultMap;if(r!=null&&r.initialFloor){let h=RT(r.initialFloor);h&&this.floorsById.has(h)?c=h:Be.error("Invalid initial floor specified (".concat(r.initialFloor,"), using default behavior instead"))}c||(c=this.currentFloorStack.defaultFloor.id),this.startingFloorId=c}get currentFloorStack(){let t=this.floorStacksById.get(this.currentFloorStackId);if(!t)throw new ho('Current floor stack with id "'.concat(this.currentFloorStackId,'" not found'));return t}setFloorStack(t,e){if(this.currentFloorStackId===t)return;let r=this.floorStacksById.get(t);if(r==null){Be.error("Invalid floor stack passed to setFloorStack (".concat(t,"), the floor stack was not changed. Current floor stack is still ").concat(this.currentFloorStack.id,"."));return}if(r.floorObjects.length===0){Be.error("Floor stack (".concat(t,") has no floors. The floor stack was not changed. Current floor stack is still ").concat(this.currentFloorStack.id,"."));return}this.setFloor(r.defaultFloor.id,e)}get currentFloor(){let t=this.floorsById.get(this.currentFloorId);if(!t)throw new ho('Floor with id "'.concat(this.currentFloorId,'" not found'));return t}get floors(){return Array.from(this.floorsById.values())}processFloorChange(t){var e,r,n,i,a,o,s,l,u;if(this.api.manualFloorVisibility===!0)return;let c=(e=this.api.getMapDataInternal())==null?void 0:e.getById("floor",t),h=(r=this.api.getMapDataInternal())==null?void 0:r.getById("floor-stack",this.currentFloorStackId);if(c&&h)if(!((n=f(this,iu))!=null&&n.enabled)||c.floorStack.id!==h?.id)for(let d of this.floorStacksById.values())d.floorObjects.forEach(p=>{p.id!==t&&p.setVisible(!1)});else{let d=KHe(h.floors,c,f(this,iu).floorGap,((a=(i=this.api.Navigation)==null?void 0:i.floors)==null?void 0:a.map(p=>p.id))||[],this.getFloorStackAltitudeData(h.id));if((s=(o=this.api)==null?void 0:o.Outdoor)==null||s.setOpacity(d.outdoorOpacity),d.floorStates.forEach(p=>{var m;if(p.floor){let y=(m=this.api.getMapData())==null?void 0:m.getById("floor",p.floor.id);y&&this.api.updateState(y,p.state)}}),f(this,iu).updateCameraElevationOnFloorChange){let p=this.floorStackAltitudeMap.get(h.id);this.api.Camera.setElevation((u=(l=p.get(c.elevation))==null?void 0:l.altitude)!=null?u:c.elevation*o0(f(this,iu).floorGap,c.maxHeight))}}}setFloor(t,e){if(this.currentFloorId===t)return;if(!this.floorsById.get(t)){Be.error("Invalid floor passed to setFloor (".concat(t,"), the floor was not changed. Current floor is still ").concat(this.currentFloor.id));return}let r=this.currentFloorId;this.publish("floor-change-start",{previousFloorId:r,floorId:t,reason:e}),this.currentFloorStack&&this.processFloorChange(t),this.currentFloorId=t,this.currentFloorStackId=this.currentFloor.floorStackId,this.currentFloor.setVisible(!0),this.updatePathLayersVisibility(),this.publish("floor-change",{reason:e,floorId:this.currentFloor.id,previousFloorId:r})}updatePathLayersVisibility(){var t;let e=this.api.hidePathsNotOnCurrentFloor===!0&&!((t=this.options.multiFloorView)!=null&&t.enabled);for(let r of this.floorsById.values()){let n=r.layers.get(a0);if(!n)continue;let i=!e||r.id===this.currentFloor.id;n.setVisible(i)}}getFloorStackAltitudeData(t){return this.floorStackAltitudeMap.get(t)}cancelAnimation(t){let e=this.animations.get(t);e&&(e.stop(),this.animations.delete(t),this.renderer.getInternalTweenGroup().remove(e))}loadAllFloors(){var t;for(let e of this.floorStacksById.values()){e.loadAllFloors();let r=this.floorStackAltitudeMap.get(e.id);(t=e.facade)==null||t.spaces.forEach(n=>{let i=this.styleMap[n.spaceId];if(i&&i.altitude>=0){let a=r?.get(i.altitude/2);a&&this.renderer.setState(n.spaceId,{altitude:a.altitude,height:a.effectiveHeight})}})}}};iu=new WeakMap;function VL(t,e,r,n){return t.labelText3D(e.id,r??e.name,lt(ae({},n),{parentId:e.floor.id}))}C();var vl,$w,QHe=class{constructor({currentMapGetter:t}){K(this,vl,new Map),K(this,$w),ne(this,$w,t)}get currentMap(){return f(this,$w).call(this)}getAll(){return Array.from(f(this,vl).values()).map(({marker:t})=>t)}getById(t){return f(this,vl).get(t)}add(t,e,r){var n;let i=t.anchorTarget;if(!i)throw new Error("get coordinate failed");let a=this.currentMap;if(!a)throw new Error("currentMap should exist");let o=a.Markers.add(i,e,lt(ae({},r),{rank:r?.rank||"medium",dynamicResize:(n=r?.dynamicResize)!=null?n:!0,attachTo:aB(t)}));if(o==null)throw new Error("error creating marker");let s=a.Markers.getContentEl(o.id.toString());if(!s)throw new Error("marker component should exist");let l=new fA(o.id.toString(),s,t);return f(this,vl).set(l.id,{marker:l,entityId:o.id.toString()}),l}remove(t){var e;let r=f(this,vl).get(t.id);r&&((e=this.currentMap)==null||e.Markers.remove(r.entityId),f(this,vl).delete(t.id.toString()))}removeAll(){let t=[];return f(this,vl).forEach(({marker:e})=>{this.remove(e),t.push(e),f(this,vl).delete(e.id.toString())}),t}setPosition(t,e){var r;let n=e.anchorTarget;if(!n){Be.error("Cannot determine coordinate from target.");return}let i=this.currentMap;if(!i){Be.error("Cannot determine the current map.");return}let a=f(this,vl).get(t.id);if(!a){Be.error('Cannot find the Marker with id "'.concat(t.id,'".'));return}i.Markers.setPosition(a.entityId,Sc(n),(r=n.floorId)!=null?r:i.currentFloorId),a.marker.updateTarget(e)}animateTo(t,e,r){var n;let i=e.anchorTarget;if(!i)return Be.error("Cannot determine coordinate from target."),Promise.resolve();let a=this.currentMap;if(!a)return Be.error("Cannot determine the current map."),Promise.resolve();let o=f(this,vl).get(t.id);return o?(o.marker.updateTarget(e),a.Markers.animateTo(o.entityId,Sc(i),(n=i.floorId)!=null?n:a.currentFloorId,r)):(Be.error('Cannot find the Marker with id "'.concat(t.id,'".')),Promise.resolve())}};vl=new WeakMap,$w=new WeakMap;C();var Rh,Uw,eXe=class{constructor({currentMapGetter:t}){K(this,Rh,new Map),K(this,Uw),ne(this,Uw,t)}get currentMap(){return f(this,Uw).call(this)}getById(t){return f(this,Rh).get(t)}add(t,e,r){var n;let i=t.anchorTarget;if(!i)throw new Error("Target does not implement IAnchorable.");let a=this.currentMap;if(!a)throw new Error("currentMap should exist");let o=a.Image3D.add(Sc(i),e,lt(ae({},r),{floorId:i.floorId,verticalOffset:i.verticalOffset+((n=r.verticalOffset)!=null?n:0)}));if(!o)throw new Error("image component should exist");let s=new fre(o.id.toString(),e,t);return f(this,Rh).set(s.id,{image:s,entityId:o.id.toString()}),s}remove(t){var e;let r=f(this,Rh).get(t.id);r&&((e=this.currentMap)==null||e.Image3D.remove(r.entityId),f(this,Rh).delete(t.id.toString()))}removeAll(){let t=[];return f(this,Rh).forEach(({image:e})=>{this.remove(e),t.push(e),f(this,Rh).delete(e.id.toString())}),t}};Rh=new WeakMap,Uw=new WeakMap;C();var yc,jw,tXe=class{constructor({currentMapGetter:t}){K(this,yc,new Map),K(this,jw),ne(this,jw,t)}get currentMap(){return f(this,jw).call(this)}getById(t){return f(this,yc).get(t)}add(t,e,r){let n=[t],i=n.reduce((s,l)=>{var u,c;if(!l)return Be.error("Cannot determine coordinate from options."),s;let h=(u=UT(l,this.currentMap.floorsById,this.currentMap.floorsById.get("default-floor")))==null?void 0:u.id;return s.has(h)||s.set(h,[]),(c=s.get(h))==null||c.push(l),s},new Map);if(!n.length)throw new Error("targets should not be empty when adding a model");let a=this.currentMap;if(!a)throw new Error("currentMap should exist");let o=[];return i.forEach((s,l)=>{var u;let c=Wn();a.Models.add(c,s,lt(ae({},r),{url:e,floorId:l,verticalOffset:s[0].verticalOffset+((u=r?.verticalOffset)!=null?u:0)})).forEach(h=>{let d=new gre(h.toString(),c,s[0]);f(this,yc).set(d.id,{model:d,entityId:h.toString(),groupId:c}),o.push(d)})}),o[0]}remove(t){var e;let r=f(this,yc).get(t.id);r&&((e=this.currentMap)==null||e.Models.remove(r.entityId,r.groupId),f(this,yc).delete(t.id.toString()))}removeAll(){let t=[];return f(this,yc).forEach(({model:e})=>{var r;let n=f(this,yc).get(e.id);n&&(t.push(e),(r=this.currentMap)==null||r.Models.remove(n.entityId,n.groupId),f(this,yc).delete(e.id.toString()))}),t}};yc=new WeakMap,jw=new WeakMap;C();var au,Vw,rXe=class{constructor({currentMapGetter:t}){K(this,au,new Map),K(this,Vw),ne(this,Vw,t)}get currentMap(){return f(this,Vw).call(this)}getById(t){var e;return(e=f(this,au).get(t))==null?void 0:e.path}add(t,e){let r=this.currentMap;if(!r)throw new Error("currentMap should exist");let n=r.Paths.add(t,e),i=n.paths.map(o=>o.id.toString()),a=new Wv(e?.id||Wn(),n.animation,t,n.paths);for(let o of i)f(this,au).set(o,{path:a,entityIds:i});return f(this,au).set(a.id,{path:a,entityIds:i}),a}highlightPathSection(t,e,r,n){var i,a,o,s;let l=(a=(i=this.currentMap)==null?void 0:i.api.getMapData())==null?void 0:a.mapCenter;if(!l)return;let u=Sre([t],e,r,l);if(!u)return;let c=(o=n?.animationDuration)!=null?o:1500,h=()=>{},d=new Promise(m=>{h=m}),p=new l0({fraction:0}).to({fraction:1},c).onUpdate(m=>{var y;for(let v of u)(y=this.currentMap)==null||y.api.updateState(v.segment,{highlightCompleteFraction:m.fraction})}).onStart(()=>{var m,y,v;for(let _ of u)(v=this.currentMap)==null||v.api.updateState(_.segment,{highlightStartFraction:_.startHighlightFraction,highlightEndFraction:_.endHighlightFraction,highlightColor:(m=n?.color)!=null?m:"red",highlightWidthMultiplier:(y=n?.widthMultiplier)!=null?y:1})}).onComplete(()=>{var m;h(),(m=this.currentMap)==null||m.api.removeTween(p)});return(s=this.currentMap)==null||s.api.tweenGroup().add(p),p.start(),{animation:d}}clearHighlightedPathSection(t){var e;(e=this.currentMap)==null||e.api.updateState(t,{highlightCompleteFraction:0,highlightStartFraction:0,highlightEndFraction:0})}clearAllHighlightedPathSections(){for(let t of f(this,au).values())this.clearHighlightedPathSection(t.path)}remove(t){var e;let r=f(this,au).get(t.id);r&&((e=this.currentMap)==null||e.Paths.remove(r.entityIds),f(this,au).delete(t.id),r.entityIds.forEach(n=>f(this,au).delete(n)))}removeAll(){let t=[];return f(this,au).forEach(({path:e})=>{this.remove(e),t.push(e)}),t}};au=new WeakMap,Vw=new WeakMap;C();var Lh,Gw,nXe=class{constructor({currentMapGetter:t}){K(this,Lh,new Map),K(this,Gw),ne(this,Gw,t)}get currentMap(){return f(this,Gw).call(this)}getById(t){return f(this,Lh).get(t)}add(t,e,r){let n=this.currentMap;if(!n)throw new Error("currentMap should exist");let i=n.Shapes.add(t,e||{},{floorId:r?.id}),a=new Fw(i);return f(this,Lh).set(a.id,a),a}remove(t){var e;f(this,Lh).get(t.id)&&((e=this.currentMap)==null||e.Shapes.remove(t),f(this,Lh).delete(t.id.toString()))}removeAll(){let t=[];return f(this,Lh).forEach(e=>{this.remove(e),t.push(e.id),f(this,Lh).delete(e.id.toString())}),t}};Lh=new WeakMap,Gw=new WeakMap;C();var Zw,iXe=class{constructor({currentMapGetter:t}){K(this,Zw),ne(this,Zw,t)}get currentMap(){return f(this,Zw).call(this)}setFromStyleCollection(t){var e,r,n,i,a;for(let o in t)for(let s of((e=this.currentMap)==null?void 0:e.floors)||[]){if(t[o]==null||!s.layers.has(Ma))continue;let l=s.layers.get(Ma);for(let h of Object.values(t))if(h&&"polygons"in h&&"color"in h)for(let d of h.polygons)(r=this.currentMap)==null||r.renderer.setState(d,{color:h.color});if(l!=null&&l.layers.has(o)&&"color"in t[o]){let h=l.layers.get(o);h&&((n=this.currentMap)==null||n.renderer.setState(h,{color:t[o].color}))}if(l&&o===cS&&!(n0 in t)){let h=l.layers.get(n0);h&&"color"in t[o]&&((i=this.currentMap)==null||i.renderer.setState(h,{color:t[o].color}))}if(!s.layers.has(Gv))continue;let u=s.layers.get(Gv),c=s.facadesByStyleId.get(o);if(c&&c.length>0)for(let h of c){let d=u.layers.get("".concat(h,"-").concat(o));d&&"color"in t[o]&&((a=this.currentMap)==null||a.renderer.setState(d,{color:t[o].color}))}}}};Zw=new WeakMap;C();var MI={opacity:1},lo,Ww,Hw,Ap,Nh,Mv,H6,Ire,aXe=class{constructor(t,e){K(this,Mv),K(this,lo),K(this,Ww,[]),K(this,Hw,{opacity:"initial"}),K(this,Ap,{opacity:new Map}),K(this,Nh,new Set),ne(this,lo,t),ne(this,Ww,e||[]);let r=f(this,lo).map;r&&r.on("idle",()=>{f(this,Ap).opacity.size||ot(this,Mv,H6).call(this,r)})}setStyle(t){var e,r;if(f(this,lo).map){(e=f(this,lo).map)==null||e.setStyle(t),f(this,Nh).size&&(f(this,Nh).clear(),this.hide()),ot(this,Mv,Ire).call(this),ot(this,Mv,H6).call(this,f(this,lo).map),this.setOpacity(f(this,Hw).opacity),(r=f(this,lo).map)==null||r.moveLayer(mq);for(let[n,i,a]of f(this,Ww)||[])f(this,lo).hideOutdoorLayersIntersectingPolygons(n,i,a)}}get map(){return f(this,lo).map}get enabled(){return!!f(this,lo).map}get visible(){return f(this,Nh).size===0}show(){let t=f(this,lo).map;if(!t)return;let e=t.getStyle().layers;e&&(e.forEach(r=>{f(this,Nh).has(r.id)&&t.setLayoutProperty(r.id,"visibility","visible")}),f(this,Nh).clear())}hide(t=[]){let e=f(this,lo).map;if(!e)return;let r=e.getStyle().layers;r&&r.forEach(n=>{let i=e.getLayoutProperty(n.id,"visibility");!t.includes(n.id)&&i!=="none"&&(e.setLayoutProperty(n.id,"visibility","none"),f(this,Nh).add(n.id))})}setOpacity(t,e=[]){var r,n,i;let a=f(this,lo).map;if(!a)return;let o=(i=(n=(r=f(this,lo).map)==null?void 0:r.getStyle)==null?void 0:n.call(r))==null?void 0:i.layers;o&&a.once("idle",()=>{o.forEach(s=>{let l=a.getLayoutProperty(s.id,"visibility");if(!e.includes(s.id)&&l!=="none")try{let u=f(this,Ap).opacity.get(s.id);u!==void 0&&(s.id==="background"||(s.type==="symbol"?(a.setPaintProperty(s.id,"icon-opacity",t==="initial"?u[0]:t),a.setPaintProperty(s.id,"text-opacity",t==="initial"?u[1]:t)):a.setPaintProperty(s.id,"".concat(s.type,"-opacity"),t==="initial"?u[0]:t)),f(this,Hw).opacity=t)}catch(u){Be.warn("Error setting opacity:",u)}})})}};lo=new WeakMap,Ww=new WeakMap,Hw=new WeakMap,Ap=new WeakMap,Nh=new WeakMap,Mv=new WeakSet,H6=function(t){let e=t.getStyle().layers;e&&e.forEach(r=>{var n,i,a;t.getLayoutProperty(r.id,"visibility")!=="none"&&(r.id==="background"||(r.type==="symbol"?f(this,Ap).opacity.set(r.id,[(n=t.getPaintProperty(r.id,"icon-opacity"))!=null?n:MI.opacity,(i=t.getPaintProperty(r.id,"text-opacity"))!=null?i:MI.opacity]):f(this,Ap).opacity.set(r.id,[(a=t.getPaintProperty(r.id,"".concat(r.type,"-opacity")))!=null?a:MI.opacity,void 0])))})},Ire=function(){Object.values(f(this,Ap)).forEach(t=>t.clear())};C();var $h,Uh,rp,oXe=class{constructor({currentMapGetter:t}){K(this,$h),K(this,Uh,new Map),K(this,rp,new Map),ne(this,$h,t)}labelAll(t={}){var e,r;let n=[],i=new Set;return(r=(e=f(this,$h).call(this))==null?void 0:e.Text3D.labelAll(t))==null||r.forEach(({textInfo:a,target:o})=>{let s=a.id.toString(),l=f(this,rp).get(s);if(l){i.has(s)||n.push(l.text3DView),i.add(s);return}i.add(s);let u=new U6(s,o);f(this,Uh).set(u.id,{targetId:o.id,text3d:s,text3DView:u}),f(this,rp).set(s,{text3DView:u}),n.push(u)}),n}label(t,e,r={}){var n;if(f(this,$h).call(this))if(Xs.is(t)){let i=(n=f(this,$h).call(this))==null?void 0:n.Text3D.label(t,e,r);if(!i)return;let a=i.textInfo.id.toString(),o=f(this,rp).get(a);if(o)return o.text3DView;let s=new U6(a,i.target);return f(this,Uh).set(s.id,{targetId:i.target.id,text3d:a,text3DView:s}),f(this,rp).set(a,{text3DView:s}),s}else throw new Error("Non-space target is not supported")}remove(t){var e;let r=typeof t=="string"?t:t.id,n=f(this,Uh).get(r);n&&((e=f(this,$h).call(this))==null||e.Text3D.remove(n.text3d),f(this,Uh).delete(r),f(this,rp).delete(n.text3d))}removeAll(){f(this,Uh).forEach(t=>{var e;(e=f(this,$h).call(this))==null||e.Text3D.remove(t.text3d)}),f(this,Uh).clear()}};$h=new WeakMap,Uh=new WeakMap,rp=new WeakMap;C();C();C();function sXe(t){try{let e=t.shape;if("type"in e){let r=e.type;if(r instanceof WA&&(r=r._def.innerType),"value"in r)return String(r.value);if(r instanceof l5&&"value"in r._def.innerType)return String(r._def.innerType.value)}return"unknown"}catch{return"unknown"}}function lXe(t){if(t.success)return{};let e={};for(let r of t.error.issues)if(r.path.length>0){let n=String(r.path[0]);e[n]||(e[n]=[]),e[n].push(r.message)}return e}function uXe(t,e){let r=Object.entries(t);if(r.length>0){let n=r.map(([i,a])=>"".concat(i,": ").concat(a.join(", "))).join("; ");Be.warn("".concat(r.length," invalid field(s) in ").concat(e??"unknown"," state: [").concat(n,"]"))}}function Vn(t,e,r){if(r!=null&&r.disableValidation)return e;if(e==null||typeof e!="object")return{};let n=t.safeParse(e);if(n.success){let o={};for(let s of Object.keys(e))s in n.data&&(o[s]=e[s]);return o}let i=lXe(n);r!=null&&r.warn&&uXe(i,sXe(t));let a={};for(let o of Object.keys(e))!(o in i)&&o in t.shape&&(a[o]=e[o]);return a}function nh(t,e,r){let n=t.safeParse(e);return n.success?n.data:e}var GL="doors",dB=at.object({type:at.literal(GL).default(GL),color:at.string().default("#ffffff"),topColor:at.string().optional(),texture:at.object({url:at.string().optional()}).optional(),topTexture:at.object({url:at.string().optional()}).optional(),visible:at.boolean().default(!1),opacity:at.number().default(1)}),TI=dB.partial();at.strictObject(dB.shape);function cXe(t){let{color:e,topColor:r,texture:n,topTexture:i,visible:a,opacity:o}=t;return nh(dB,{visible:a,color:e,topColor:r,opacity:o,texture:n?{url:n}:void 0,topTexture:i?{url:i}:void 0})}function PI(t,e){var r,n;let i={};return e==null||(t.color&&(t.color==="initial"?i.color=e.initialColor:i.color=t.color),t.topColor&&(t.topColor==="initial"?i.topColor=e.initialTopColor:i.topColor=t.topColor),t.visible!==void 0&&(i.visible=t.visible),((r=t.texture)==null?void 0:r.url)!==void 0&&(i.texture=t.texture.url),((n=t.topTexture)==null?void 0:n.url)!==void 0&&(i.topTexture=t.topTexture.url),t.opacity!==void 0&&(i.opacity=t.opacity)),i}C();var ZL="facade",pB=Nr({type:$i(ZL).default(ZL),opacity:pt().default(1),visible:Lr().default(!0)}),hXe=pB.partial();_a(pB.shape);function dXe(t){return nh(pB,{opacity:t.opacity,visible:t.visible})}C();var zu="floor",WL="".concat(zu,".footprint"),HL="".concat(zu,".geometry"),XL="".concat(zu,".labels"),qL="".concat(zu,".markers"),YL="".concat(zu,".images"),JL="".concat(zu,".occlusion"),KL="".concat(zu,".paths"),QL="".concat(zu,".areas"),dS=Nr({type:$i(WL).default(WL),altitude:pt().default(0),visible:Lr().default(!1),height:pt().default(0),opacity:pt().default(1),side:Pa(["double","front","back"]),color:mr().default("#ffffff")}),pXe=dS.partial(),pS=Nr({type:$i(HL).default(HL),opacity:pt().default(1),visible:Lr().default(!0)}),fXe=pS.partial(),fS=Nr({type:$i(XL).default(XL),enabled:Lr().default(!0)}),mXe=fS.partial(),mS=Nr({type:$i(qL).default(qL),enabled:Lr().default(!0)}),gXe=mS.partial(),gS=Nr({type:$i(YL).default(YL),visible:Lr().default(!0)}),yXe=gS.partial(),yS=Nr({type:$i(JL).default(JL),enabled:Lr().default(!0)}),vXe=yS.partial(),vS=Nr({type:$i(KL).default(KL),visible:Lr().default(!0)}),_Xe=vS.partial(),_S=Nr({type:$i(zu).default(zu),visible:Lr().default(!1),altitude:pt().default(0)}),xS=Nr({type:$i(QL).default(QL),visible:Lr().default(!0)}),xXe=xS.partial(),bXe=Nr(lt(ae({},_S.shape),{geometry:pS,labels:fS,markers:mS,images:gS,footprint:dS,occlusion:yS,paths:vS,areas:xS})),wXe=_S.partial();Nr(lt(ae({},_S.shape),{geometry:pS.partial(),labels:fS.partial(),markers:mS.partial(),images:gS.partial(),footprint:dS.partial(),occlusion:yS.partial(),paths:vS.partial(),areas:xS.partial()})).partial();_a(lt(ae({},_S.shape),{geometry:_a(pS.shape),labels:_a(fS.shape),markers:_a(mS.shape),images:_a(gS.shape),footprint:_a(dS.shape),occlusion:_a(yS.shape),paths:_a(vS.shape),areas:_a(xS.shape)}));function AXe(t,e,r){if(!e){Be.error("Floor is not defined. Cannot get floor state.");return}let n=e.layers.get(Ma),i=n?r?.getState(n.containerId):void 0,a=e.layers.get(i0),o=e.layers.get(kp),s=e.layers.get(nB),l=s?r?.getState(s.containerId):void 0,u=e.layers.get(sA),c=u?r?.getState(u.containerId):void 0,h=e.layers.get(iB),d=h?r?.getState(h.containerId):void 0,p=e.layers.get(a0),m=p?r?.getState(p.containerId):void 0,y=e.layers.get(lA),v=y?r?.getState(y.containerId):void 0;return nh(bXe,{geometry:{opacity:i?.opacity,visible:i?.visible},labels:{enabled:a?.visible},markers:{enabled:o?.visible},footprint:{altitude:l?.altitude,visible:l?.visible,height:l?.height,opacity:l?.opacity,side:l?.side,color:l?.color},images:{visible:d?.visible},occlusion:{enabled:c?.visible},paths:{visible:m?.visible},areas:{visible:v?.visible},visible:t.visible,altitude:t.altitude})}C();var e9="geometry",fB=Nr({type:$i(e9).default(e9),visible:Lr().default(!0),color:zi([mr(),$i("initial")]).default("#ffffff"),topColor:zi([mr(),$i("initial")]).optional(),hoverColor:zi([mr(),$i("initial")]).optional(),interactive:Lr().default(!1),opacity:pt().default(1),height:pt().default(0),altitude:pt().default(0),texture:Nr({url:mr()}).optional(),topTexture:Nr({url:mr()}).optional(),flipImageToFaceCamera:Lr().default(!1),enableImageCollisions:Lr().default(!1),borderVisible:Lr().default(!1),borderColor:mr().optional(),borderWidth:pt().optional()}),t9=fB.partial();_a(fB.shape);function SXe(t){let{altitude:e,interactive:r,hoverColor:n,color:i,visible:a,opacity:o,height:s,texture:l,topTexture:u,flipImageToFaceCamera:c,enableImageCollisions:h,topColor:d,borderVisible:p,borderColor:m,borderWidth:y}=t;return nh(fB,{interactive:r,hoverColor:n,color:i,visible:a,opacity:o,height:s,texture:l?{url:t.texture}:void 0,topTexture:u?{url:u}:void 0,flipImageToFaceCamera:c,enableImageCollisions:h,topColor:d,altitude:e,borderVisible:p,borderColor:m,borderWidth:y})}function EXe(t,e){var r,n;let i={};return e==null||(t.color&&(t.color==="initial"?i.color=e.initialColor:i.color=t.color),t.topColor&&(t.topColor==="initial"?i.topColor=e.initialTopColor:i.topColor=t.topColor),t.visible!==void 0&&(i.visible=t.visible),((r=t.texture)==null?void 0:r.url)!==void 0&&(i.texture=t.texture.url),((n=t.topTexture)==null?void 0:n.url)!==void 0&&(i.topTexture=t.topTexture.url),t.hoverColor!==void 0&&(i.hoverColor=t.hoverColor),t.interactive!==void 0&&(i.interactive=t.interactive),t.height!==void 0&&(i.height=t.height),t.opacity!==void 0&&(i.opacity=t.opacity),t.flipImageToFaceCamera!==void 0&&(i.flipImageToFaceCamera=t.flipImageToFaceCamera),t.enableImageCollisions!==void 0&&(i.enableImageCollisions=t.enableImageCollisions),t.altitude!==void 0&&(i.altitude=t.altitude),t.borderVisible!==void 0&&(i.borderVisible=t.borderVisible),t.borderColor!==void 0&&(i.borderColor=t.borderColor),t.borderWidth!==void 0&&(i.borderWidth=t.borderWidth)),i}C();var X6="label",IXe=at.object({type:at.literal(X6).default(X6),text:at.string(),rank:at.custom(t=>Fk.safeParse(t).success||t==="initial"),appearance:at.custom(t=>Lk.safeParse(t).success),interactive:at.boolean().default(!1),enabled:at.boolean().default(!0),textPlacement:at.union([at.enum($4),at.array(at.enum($4))]).default(z3)}),CXe=IXe.partial();function MXe(t){var e,r,n,i;let{text:a,enabled:o,options:s}=t;return{type:X6,text:a??"",appearance:nq((e=s?.appearance)!=null?e:{}),rank:(r=s?.rank)!=null?r:"medium",enabled:o??!0,interactive:(n=s?.interactive)!=null?n:!1,textPlacement:(i=s?.textPlacement)!=null?i:z3}}function TXe(t,e){let r={options:{}};if(!r.options)throw new Error("options should exist");return t.text&&(r.text=t.text),t.appearance&&(r.options.appearance=t.appearance),t.textPlacement&&(r.options.textPlacement=t.textPlacement),t.rank!=null&&(t.rank==="initial"?r.options.rank=e.initialRank||2:r.options.rank=t.rank),t.enabled!==void 0&&(r.enabled=t.enabled),t.interactive!==void 0&&(r.options.interactive=t.interactive),t.enabled!==void 0&&(r.enabled=t.enabled),r}C();var q6="marker",PXe=at.object({type:at.literal(q6).default(q6),rank:at.custom(t=>Fk.safeParse(t).success||t==="initial"),placement:at.union([at.enum(U4),at.array(at.enum(U4))]).optional(),interactive:at.union([at.boolean(),at.literal("pointer-events-auto")]).default(!1),dynamicResize:at.boolean().default(!0),enabled:at.boolean().default(!0),zIndex:at.number().optional(),lowPriorityPin:at.object({enabled:at.boolean().optional(),size:at.number().positive().optional(),color:at.string().optional()}).optional(),element:at.custom(t=>t instanceof HTMLElement,{error:"Must be an HTMLElement instance"}),contentHTML:at.string()}),DXe=PXe.omit({element:!0}).partial();function kXe(t,e){var r,n,i,a;let o=e!=null&&e.target?e.target.anchorTarget:void 0,{enabled:s,placement:l,element:u,dynamicResize:c,contentHTML:h,options:d,position:p,parent:m}=t,y=typeof m=="object"?m.id:m;return o==null&&(o=new Rr({latitude:(r=p?.[1])!=null?r:0,longitude:(n=p?.[0])!=null?n:0,floorId:y?.toString()})),{type:q6,rank:(i=d?.rank)!=null?i:"medium",interactive:(a=d?.interactive)!=null?a:!1,enabled:s??!0,element:u,placement:l??[],zIndex:d?.zIndex,dynamicResize:c??!0,lowPriorityPin:d?.lowPriorityPin,contentHTML:h??""}}function OXe(t,e){let r={};return r.options={},t.rank!=null&&(t.rank==="initial"?r.options.rank=e.initialRank||2:r.options.rank=t.rank),t.dynamicResize!=null&&(r.options.dynamicResize=t.dynamicResize),t.enabled!=null&&(r.enabled=t.enabled),t.interactive!=null&&(r.options.interactive=t.interactive),t.enabled!==null&&(r.enabled=t.enabled),t.contentHTML!==void 0&&(r.contentHTML=t.contentHTML),t.placement!=null&&(r.placement=t.placement),r}C();var r9="path",Ib={color:"#4b90e2",completeFraction:0,visible:!0,verticalOffset:.1},mB=at.object({type:at.literal(r9).default(r9),color:at.string().default(Ib.color),width:at.union([at.number(),at.any()]),completeFraction:at.number().default(Ib.completeFraction),visible:at.boolean().default(Ib.visible),verticalOffset:at.number().default(Ib.verticalOffset),highlightStartFraction:at.number().default(0),highlightEndFraction:at.number().default(0),highlightColor:at.string().default("red"),highlightWidthMultiplier:at.number().default(1.1),highlightCompleteFraction:at.number().default(1)}),n9=mB.partial();at.strictObject(mB.shape);function BXe(t){let{color:e,visible:r,width:n,verticalOffset:i,completeFraction:a,highlightStartFraction:o,highlightEndFraction:s,highlightColor:l,highlightWidthMultiplier:u,highlightCompleteFraction:c}=t;return nh(mB,{color:e,visible:r,width:n,verticalOffset:i,completeFraction:a,highlightStartFraction:o,highlightEndFraction:s,highlightColor:l,highlightWidthMultiplier:u,highlightCompleteFraction:c})}C();var i9="shape",gB=Nr({type:$i(i9).default(i9),visible:Lr().default(!0),altitude:pt().default(0),color:mr().default("#ffffff"),height:pt().default(0),opacity:pt().default(1),interactive:Lr().default(!1),bevel:Nr({enabled:Lr().optional(),thickness:pt().optional(),size:pt().optional(),offset:pt().optional(),segments:pt().optional()}).optional()}),Cre=gB.partial();_a(gB.shape);function zXe(t){let{altitude:e,visible:r,color:n,opacity:i,interactive:a,height:o,children:s,bevel:l}=t;if(s==null||s.length<1){Be.error("Expected at least one child for Shape (".concat(t.id,"). Cannot get shape state."));return}return nh(gB,{altitude:e,visible:r,color:n,height:o,opacity:i,interactive:a,bevel:l})}function FXe(t){let e=Vn(Cre,t,{warn:!0}),r={};if(e.visible!==void 0&&(r.visible=e.visible),e.color!==void 0&&(r.color=e.color),e.opacity!==void 0&&(r.opacity=e.opacity),e.altitude!==void 0&&(r.altitude=e.altitude),e.height!==void 0&&(r.height=e.height),e.interactive!==void 0&&(r.interactive=e.interactive),e.bevel!==void 0){let n={enabled:e.bevel.enabled||!1,thickness:e.bevel.thickness,size:e.bevel.size,offset:e.bevel.offset,segments:e.bevel.segments};r.bevel=n}return r}C();var a9="text3d",Mre=at.object({type:at.literal(a9).default(a9),position:at.custom(t=>t instanceof Rr,{error:"Must be a Coordinate instance"})}),Tre=cq.extend(ae({},Mre.shape)),RXe=dq.extend(ae({},Mre.shape)).partial();at.strictObject(Tre.shape);function LXe(t){var e,r;let{position:n,visible:i,color:a,flipToFaceCamera:o,font:s,fontSize:l,outlineColor:u,outlineOpacity:c,outlineBlur:h,outlineWidth:d,outlineOffsetX:p,outlineOffsetY:m,strokeWidth:y,strokeOpacity:v,strokeColor:_,fillOpacity:w,hoverColor:b}=t;return nh(Tre,{position:new Rr({latitude:(e=n?.[1])!=null?e:0,longitude:(r=n?.[0])!=null?r:0}),visible:i,color:a,flipToFaceCamera:o,font:s,fontSize:l,outlineColor:u,outlineOpacity:c,outlineBlur:h,outlineWidth:d,outlineOffsetX:p,outlineOffsetY:m,strokeWidth:y,strokeOpacity:v,strokeColor:_,fillOpacity:w,hoverColor:b})}C();var o9="walls",yB=at.object({type:at.literal(o9).default(o9),color:at.string().default("#ffffff"),topColor:at.string().optional(),texture:at.object({url:at.string()}).or(at.undefined()),topTexture:at.object({url:at.string()}).or(at.undefined()),visible:at.boolean().default(!0),height:at.number().default(0),opacity:at.number().default(1)}),s9=yB.partial();at.strictObject(yB.shape);function NXe(t){let{color:e,topColor:r,texture:n,topTexture:i,visible:a,height:o,opacity:s}=t;return nh(yB,{visible:a,color:e,topColor:r,texture:n?{url:n}:void 0,topTexture:i?{url:i}:void 0,height:o,opacity:s})}function l9(t,e){var r,n;let i={};return e==null||(t.color&&(t.color==="initial"?i.color=e.initialColor:i.color=t.color),t.topColor&&(t.topColor==="initial"?i.topColor=e.initialTopColor:i.topColor=t.topColor),t.visible!==void 0&&(i.visible=t.visible),((r=t.texture)==null?void 0:r.url)!==void 0&&(i.texture=t.texture.url),((n=t.topTexture)==null?void 0:n.url)!==void 0&&(i.topTexture=t.topTexture.url),t.height!==void 0&&(i.height=t.height),t.opacity!==void 0&&(i.opacity=t.opacity)),i}C();var Y6="image3d",$Xe=Nr({type:$i(Y6).default(Y6),visible:Lr().default(!0),opacity:pt().min(0).max(1).default(1),position:d5(t=>t instanceof Rr,{error:"Must be a Coordinate instance"}),width:pt().default(1),height:pt().default(1),rotation:pt().default(0),verticalOffset:pt().default(0),flipImagesToFaceCamera:Lr().default(!1)}),UXe=$Xe.partial();function jXe(t){var e,r,n,i,a,o,s,l,u;let{position:c}=t;return{type:Y6,visible:(e=t.visible)!=null?e:!0,opacity:(r=t.opacity)!=null?r:1,position:new Rr({latitude:(n=c?.[1])!=null?n:0,longitude:(i=c?.[0])!=null?i:0,verticalOffset:c?.[2]}),width:(a=t.width)!=null?a:1,height:(o=t.height)!=null?o:1,rotation:(s=t.rotation)!=null?s:0,verticalOffset:(l=t.verticalOffset)!=null?l:0,flipImagesToFaceCamera:(u=t.flipImageToFaceCamera)!=null?u:!1}}C();var u9="model",vB=Vte.extend({type:$i(u9).default(u9),color:mr().optional(),position:d5(t=>Rr.is(t),{error:"Expected a Coordinate"}),visible:Lr().default(!0),rotation:ld([pt(),pt(),pt()]).default([0,0,0]),scale:ld([pt(),pt(),pt()]).default([1,1,1]),verticalOffset:pt().default(0),opacity:pt().default(1),material:ZA(mr(),Gte).optional(),interactive:Lr().default(!1),clippingPlaneZOffset:pt().default(1/0),clippingPlaneTopColor:mr().default("#E67B5B"),clippingPlaneTopVisible:Lr().default(!0)}),VXe=vB.extend({scale:zi([pt(),ld([pt(),pt(),pt()])]),rotation:zi([pt(),ld([pt(),pt(),pt()])])}).partial();_a(vB.shape);function GXe(t){var e,r,n;let{color:i,position:a,rotation:o,scale:s,visible:l,interactive:u,opacity:c,material:h,verticalOffset:d,parent:p,clippingPlaneZOffset:m,clippingPlaneTopVisible:y}=t,v=typeof p=="object"?(e=p?.id)==null?void 0:e.toString():p?.toString();return nh(vB,{color:i,position:new Rr({latitude:(r=a?.[1])!=null?r:0,longitude:(n=a?.[0])!=null?n:0,verticalOffset:a?.[2],floorId:v}),rotation:o,scale:s,visible:l,interactive:u,opacity:c,material:h,verticalOffset:d,clippingPlaneZOffset:m,clippingPlaneTopVisible:y})}C();C();C();var _B=Zt(FPe());_B.registerHelper({});_B.registerPartial({});var ZXe=_B.template({compiler:[8,">= 4.3.0"],main:function(t,e,r,n,i){var a=t.lambda,o=t.escapeExpression,s=t.lookupProperty||function(l,u){if(Object.prototype.hasOwnProperty.call(l,u))return l[u]};return`<div class='mappedin-annotation-marker'>
	<div style='width: `+o(a(e!=null?s(e,"size"):e,e))+"px; height: "+o(a(e!=null?s(e,"size"):e,e))+`px'>
		<img src='`+o(a(e!=null?s(e,"icon"):e,e))+"' alt='"+o(a(e!=null?s(e,"name"):e,e))+"' width='"+o(a(e!=null?s(e,"size"):e,e))+"' height='"+o(a(e!=null?s(e,"size"):e,e))+`' />
	</div>
</div>`},useData:!0}),WXe=30,HXe=new Set(["annotation"]);function XXe(t){var e,r;return ZXe({size:WXe,icon:(r=(e=t.icon)==null?void 0:e.url)!=null?r:"",name:t.name})}function qXe(t={}){return ae({rank:"high",placement:["center"],interactive:!0},t)}function YXe(t,e){return e.Markers.add(t.coordinate,XXe(t),qXe())}function JXe(t,e){let r=[];for(let n of e)lS(n)&&L_.is(n)&&n.icon!=null&&typeof n.icon.url=="string"&&n.icon.url.length>0&&r.push(YXe(n,t));return r}C();var KXe=new Set(["space","object"]);function QXe(t,e){e.forEach(r=>{zje(r)&&t.updateState(r,{interactive:!0})})}C();C();function eqe(t){return lS(t)?"anchorTarget"in t&&t.anchorTarget!=null:!1}C();C();var{entries:Pre,setPrototypeOf:c9,isFrozen:tqe,getPrototypeOf:rqe,getOwnPropertyDescriptor:nqe}=Object,{freeze:wo,seal:Js,create:Dre}=Object,{apply:J6,construct:K6}=typeof Reflect<"u"&&Reflect;wo||(wo=function(t){return t});Js||(Js=function(t){return t});J6||(J6=function(t,e,r){return t.apply(e,r)});K6||(K6=function(t,e){return new t(...e)});var Cb=Ao(Array.prototype.forEach),iqe=Ao(Array.prototype.lastIndexOf),h9=Ao(Array.prototype.pop),Sy=Ao(Array.prototype.push),aqe=Ao(Array.prototype.splice),Xw=Ao(String.prototype.toLowerCase),DI=Ao(String.prototype.toString),d9=Ao(String.prototype.match),Ey=Ao(String.prototype.replace),oqe=Ao(String.prototype.indexOf),sqe=Ao(String.prototype.trim),xl=Ao(Object.prototype.hasOwnProperty),so=Ao(RegExp.prototype.test),Iy=lqe(TypeError);function Ao(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return J6(t,e,n)}}function lqe(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return K6(t,r)}}function Ur(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Xw;c9&&c9(t,null);let n=e.length;for(;n--;){let i=e[n];if(typeof i=="string"){let a=r(i);a!==i&&(tqe(e)||(e[n]=a),i=a)}t[i]=!0}return t}function uqe(t){for(let e=0;e<t.length;e++)xl(t,e)||(t[e]=null);return t}function vc(t){let e=Dre(null);for(let[r,n]of Pre(t))xl(t,r)&&(Array.isArray(n)?e[r]=uqe(n):n&&typeof n=="object"&&n.constructor===Object?e[r]=vc(n):e[r]=n);return e}function Cy(t,e){for(;t!==null;){let n=nqe(t,e);if(n){if(n.get)return Ao(n.get);if(typeof n.value=="function")return Ao(n.value)}t=rqe(t)}function r(){return null}return r}var p9=wo(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),kI=wo(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),OI=wo(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),cqe=wo(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),BI=wo(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),hqe=wo(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),f9=wo(["#text"]),m9=wo(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),zI=wo(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),g9=wo(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Mb=wo(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),dqe=Js(/\{\{[\w\W]*|[\w\W]*\}\}/gm),pqe=Js(/<%[\w\W]*|[\w\W]*%>/gm),fqe=Js(/\$\{[\w\W]*/gm),mqe=Js(/^data-[\-\w.\u00B7-\uFFFF]+$/),gqe=Js(/^aria-[\-\w]+$/),kre=Js(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),yqe=Js(/^(?:\w+script|data):/i),vqe=Js(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Ore=Js(/^html$/i),_qe=Js(/^[a-z][.\w]*(-[.\w]+)+$/i),y9=Object.freeze({__proto__:null,ARIA_ATTR:gqe,ATTR_WHITESPACE:vqe,CUSTOM_ELEMENT:_qe,DATA_ATTR:mqe,DOCTYPE_NAME:Ore,ERB_EXPR:pqe,IS_ALLOWED_URI:kre,IS_SCRIPT_OR_DATA:yqe,MUSTACHE_EXPR:dqe,TMPLIT_EXPR:fqe}),My={element:1,text:3,progressingInstruction:7,comment:8,document:9},xqe=function(){return typeof window>"u"?null:window},bqe=function(t,e){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let r=null,n="data-tt-policy-suffix";e&&e.hasAttribute(n)&&(r=e.getAttribute(n));let i="dompurify"+(r?"#"+r:"");try{return t.createPolicy(i,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},v9=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Bre(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xqe(),e=se=>Bre(se);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==My.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t,n=r,i=n.currentScript,{DocumentFragment:a,HTMLTemplateElement:o,Node:s,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:p}=t,m=l.prototype,y=Cy(m,"cloneNode"),v=Cy(m,"remove"),_=Cy(m,"nextSibling"),w=Cy(m,"childNodes"),b=Cy(m,"parentNode");if(typeof o=="function"){let se=r.createElement("template");se.content&&se.content.ownerDocument&&(r=se.content.ownerDocument)}let A,E="",{implementation:M,createNodeIterator:P,createDocumentFragment:k,getElementsByTagName:D}=r,{importNode:O}=n,B=v9();e.isSupported=typeof Pre=="function"&&typeof b=="function"&&M&&M.createHTMLDocument!==void 0;let{MUSTACHE_EXPR:L,ERB_EXPR:R,TMPLIT_EXPR:T,DATA_ATTR:N,ARIA_ATTR:$,IS_SCRIPT_OR_DATA:V,ATTR_WHITESPACE:G,CUSTOM_ELEMENT:ee}=y9,{IS_ALLOWED_URI:ie}=y9,me=null,Me=Ur({},[...p9,...kI,...OI,...BI,...f9]),Ae=null,le=Ur({},[...m9,...zI,...g9,...Mb]),_e=Object.seal(Dre(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Le=null,Se=null,Ue=!0,Y=!0,we=!1,q=!0,oe=!1,ce=!0,X=!1,ke=!1,Ce=!1,Ee=!1,Ne=!1,st=!1,Ke=!0,J=!1,Z="user-content-",fe=!0,Fe=!1,Ve={},ze=null,Tt=Ur({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),ft=null,St=Ur({},["audio","video","img","source","image","track"]),nr=null,He=Ur({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ge="http://www.w3.org/1998/Math/MathML",je="http://www.w3.org/2000/svg",tt="http://www.w3.org/1999/xhtml",Ze=tt,At=!1,vt=null,Kt=Ur({},[Ge,je,tt],DI),he=Ur({},["mi","mo","mn","ms","mtext"]),ct=Ur({},["annotation-xml"]),De=Ur({},["title","style","font","a","script"]),qe=null,mt=["application/xhtml+xml","text/html"],Et="text/html",Wt=null,en=null,Ii=r.createElement("form"),Zr=function(se){return se instanceof RegExp||se instanceof Function},Pn=function(){let se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(en&&en===se)){if((!se||typeof se!="object")&&(se={}),se=vc(se),qe=mt.indexOf(se.PARSER_MEDIA_TYPE)===-1?Et:se.PARSER_MEDIA_TYPE,Wt=qe==="application/xhtml+xml"?DI:Xw,me=xl(se,"ALLOWED_TAGS")?Ur({},se.ALLOWED_TAGS,Wt):Me,Ae=xl(se,"ALLOWED_ATTR")?Ur({},se.ALLOWED_ATTR,Wt):le,vt=xl(se,"ALLOWED_NAMESPACES")?Ur({},se.ALLOWED_NAMESPACES,DI):Kt,nr=xl(se,"ADD_URI_SAFE_ATTR")?Ur(vc(He),se.ADD_URI_SAFE_ATTR,Wt):He,ft=xl(se,"ADD_DATA_URI_TAGS")?Ur(vc(St),se.ADD_DATA_URI_TAGS,Wt):St,ze=xl(se,"FORBID_CONTENTS")?Ur({},se.FORBID_CONTENTS,Wt):Tt,Le=xl(se,"FORBID_TAGS")?Ur({},se.FORBID_TAGS,Wt):vc({}),Se=xl(se,"FORBID_ATTR")?Ur({},se.FORBID_ATTR,Wt):vc({}),Ve=xl(se,"USE_PROFILES")?se.USE_PROFILES:!1,Ue=se.ALLOW_ARIA_ATTR!==!1,Y=se.ALLOW_DATA_ATTR!==!1,we=se.ALLOW_UNKNOWN_PROTOCOLS||!1,q=se.ALLOW_SELF_CLOSE_IN_ATTR!==!1,oe=se.SAFE_FOR_TEMPLATES||!1,ce=se.SAFE_FOR_XML!==!1,X=se.WHOLE_DOCUMENT||!1,Ee=se.RETURN_DOM||!1,Ne=se.RETURN_DOM_FRAGMENT||!1,st=se.RETURN_TRUSTED_TYPE||!1,Ce=se.FORCE_BODY||!1,Ke=se.SANITIZE_DOM!==!1,J=se.SANITIZE_NAMED_PROPS||!1,fe=se.KEEP_CONTENT!==!1,Fe=se.IN_PLACE||!1,ie=se.ALLOWED_URI_REGEXP||kre,Ze=se.NAMESPACE||tt,he=se.MATHML_TEXT_INTEGRATION_POINTS||he,ct=se.HTML_INTEGRATION_POINTS||ct,_e=se.CUSTOM_ELEMENT_HANDLING||{},se.CUSTOM_ELEMENT_HANDLING&&Zr(se.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(_e.tagNameCheck=se.CUSTOM_ELEMENT_HANDLING.tagNameCheck),se.CUSTOM_ELEMENT_HANDLING&&Zr(se.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(_e.attributeNameCheck=se.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),se.CUSTOM_ELEMENT_HANDLING&&typeof se.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(_e.allowCustomizedBuiltInElements=se.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),oe&&(Y=!1),Ne&&(Ee=!0),Ve&&(me=Ur({},f9),Ae=[],Ve.html===!0&&(Ur(me,p9),Ur(Ae,m9)),Ve.svg===!0&&(Ur(me,kI),Ur(Ae,zI),Ur(Ae,Mb)),Ve.svgFilters===!0&&(Ur(me,OI),Ur(Ae,zI),Ur(Ae,Mb)),Ve.mathMl===!0&&(Ur(me,BI),Ur(Ae,g9),Ur(Ae,Mb))),se.ADD_TAGS&&(me===Me&&(me=vc(me)),Ur(me,se.ADD_TAGS,Wt)),se.ADD_ATTR&&(Ae===le&&(Ae=vc(Ae)),Ur(Ae,se.ADD_ATTR,Wt)),se.ADD_URI_SAFE_ATTR&&Ur(nr,se.ADD_URI_SAFE_ATTR,Wt),se.FORBID_CONTENTS&&(ze===Tt&&(ze=vc(ze)),Ur(ze,se.FORBID_CONTENTS,Wt)),fe&&(me["#text"]=!0),X&&Ur(me,["html","head","body"]),me.table&&(Ur(me,["tbody"]),delete Le.tbody),se.TRUSTED_TYPES_POLICY){if(typeof se.TRUSTED_TYPES_POLICY.createHTML!="function")throw Iy('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof se.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Iy('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');A=se.TRUSTED_TYPES_POLICY,E=A.createHTML("")}else A===void 0&&(A=bqe(p,i)),A!==null&&typeof E=="string"&&(E=A.createHTML(""));wo&&wo(se),en=se}},Fa=Ur({},[...kI,...OI,...cqe]),Hu=Ur({},[...BI,...hqe]),ah=function(se){let Pt=b(se);(!Pt||!Pt.tagName)&&(Pt={namespaceURI:Ze,tagName:"template"});let bt=Xw(se.tagName),H=Xw(Pt.tagName);return vt[se.namespaceURI]?se.namespaceURI===je?Pt.namespaceURI===tt?bt==="svg":Pt.namespaceURI===Ge?bt==="svg"&&(H==="annotation-xml"||he[H]):!!Fa[bt]:se.namespaceURI===Ge?Pt.namespaceURI===tt?bt==="math":Pt.namespaceURI===je?bt==="math"&&ct[H]:!!Hu[bt]:se.namespaceURI===tt?Pt.namespaceURI===je&&!ct[H]||Pt.namespaceURI===Ge&&!he[H]?!1:!Hu[bt]&&(De[bt]||!Fa[bt]):!!(qe==="application/xhtml+xml"&&vt[se.namespaceURI]):!1},Qi=function(se){Sy(e.removed,{element:se});try{b(se).removeChild(se)}catch{v(se)}},Co=function(se,Pt){try{Sy(e.removed,{attribute:Pt.getAttributeNode(se),from:Pt})}catch{Sy(e.removed,{attribute:null,from:Pt})}if(Pt.removeAttribute(se),se==="is")if(Ee||Ne)try{Qi(Pt)}catch{}else try{Pt.setAttribute(se,"")}catch{}},Mo=function(se){let Pt=null,bt=null;if(Ce)se="<remove></remove>"+se;else{let be=d9(se,/^[\r\n\t ]+/);bt=be&&be[0]}qe==="application/xhtml+xml"&&Ze===tt&&(se='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+se+"</body></html>");let H=A?A.createHTML(se):se;if(Ze===tt)try{Pt=new d().parseFromString(H,qe)}catch{}if(!Pt||!Pt.documentElement){Pt=M.createDocument(Ze,"template",null);try{Pt.documentElement.innerHTML=At?E:H}catch{}}let pe=Pt.body||Pt.documentElement;return se&&bt&&pe.insertBefore(r.createTextNode(bt),pe.childNodes[0]||null),Ze===tt?D.call(Pt,X?"html":"body")[0]:X?Pt.documentElement:pe},Xu=function(se){return P.call(se.ownerDocument||se,se,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Ts=function(se){return se instanceof h&&(typeof se.nodeName!="string"||typeof se.textContent!="string"||typeof se.removeChild!="function"||!(se.attributes instanceof c)||typeof se.removeAttribute!="function"||typeof se.setAttribute!="function"||typeof se.namespaceURI!="string"||typeof se.insertBefore!="function"||typeof se.hasChildNodes!="function")},qu=function(se){return typeof s=="function"&&se instanceof s};function ua(se,Pt,bt){Cb(se,H=>{H.call(e,Pt,bt,en)})}let Yu=function(se){let Pt=null;if(ua(B.beforeSanitizeElements,se,null),Ts(se))return Qi(se),!0;let bt=Wt(se.nodeName);if(ua(B.uponSanitizeElement,se,{tagName:bt,allowedTags:me}),ce&&se.hasChildNodes()&&!qu(se.firstElementChild)&&so(/<[/\w!]/g,se.innerHTML)&&so(/<[/\w!]/g,se.textContent)||se.nodeType===My.progressingInstruction||ce&&se.nodeType===My.comment&&so(/<[/\w]/g,se.data))return Qi(se),!0;if(!me[bt]||Le[bt]){if(!Le[bt]&&oh(bt)&&(_e.tagNameCheck instanceof RegExp&&so(_e.tagNameCheck,bt)||_e.tagNameCheck instanceof Function&&_e.tagNameCheck(bt)))return!1;if(fe&&!ze[bt]){let H=b(se)||se.parentNode,pe=w(se)||se.childNodes;if(pe&&H){let be=pe.length;for(let Te=be-1;Te>=0;--Te){let de=y(pe[Te],!0);de.__removalCount=(se.__removalCount||0)+1,H.insertBefore(de,_(se))}}}return Qi(se),!0}return se instanceof l&&!ah(se)||(bt==="noscript"||bt==="noembed"||bt==="noframes")&&so(/<\/no(script|embed|frames)/i,se.innerHTML)?(Qi(se),!0):(oe&&se.nodeType===My.text&&(Pt=se.textContent,Cb([L,R,T],H=>{Pt=Ey(Pt,H," ")}),se.textContent!==Pt&&(Sy(e.removed,{element:se.cloneNode()}),se.textContent=Pt)),ua(B.afterSanitizeElements,se,null),!1)},To=function(se,Pt,bt){if(Ke&&(Pt==="id"||Pt==="name")&&(bt in r||bt in Ii))return!1;if(!(Y&&!Se[Pt]&&so(N,Pt))&&!(Ue&&so($,Pt))){if(!Ae[Pt]||Se[Pt]){if(!(oh(se)&&(_e.tagNameCheck instanceof RegExp&&so(_e.tagNameCheck,se)||_e.tagNameCheck instanceof Function&&_e.tagNameCheck(se))&&(_e.attributeNameCheck instanceof RegExp&&so(_e.attributeNameCheck,Pt)||_e.attributeNameCheck instanceof Function&&_e.attributeNameCheck(Pt))||Pt==="is"&&_e.allowCustomizedBuiltInElements&&(_e.tagNameCheck instanceof RegExp&&so(_e.tagNameCheck,bt)||_e.tagNameCheck instanceof Function&&_e.tagNameCheck(bt))))return!1}else if(!nr[Pt]&&!so(ie,Ey(bt,G,""))&&!((Pt==="src"||Pt==="xlink:href"||Pt==="href")&&se!=="script"&&oqe(bt,"data:")===0&&ft[se])&&!(we&&!so(V,Ey(bt,G,"")))&&bt)return!1}return!0},oh=function(se){return se!=="annotation-xml"&&d9(se,ee)},sh=function(se){ua(B.beforeSanitizeAttributes,se,null);let{attributes:Pt}=se;if(!Pt||Ts(se))return;let bt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ae,forceKeepAttr:void 0},H=Pt.length;for(;H--;){let pe=Pt[H],{name:be,namespaceURI:Te,value:de}=pe,Ye=Wt(be),Ct=de,_t=be==="value"?Ct:sqe(Ct);if(bt.attrName=Ye,bt.attrValue=_t,bt.keepAttr=!0,bt.forceKeepAttr=void 0,ua(B.uponSanitizeAttribute,se,bt),_t=bt.attrValue,J&&(Ye==="id"||Ye==="name")&&(Co(be,se),_t=Z+_t),ce&&so(/((--!?|])>)|<\/(style|title)/i,_t)){Co(be,se);continue}if(bt.forceKeepAttr)continue;if(!bt.keepAttr){Co(be,se);continue}if(!q&&so(/\/>/i,_t)){Co(be,se);continue}oe&&Cb([L,R,T],or=>{_t=Ey(_t,or," ")});let Ft=Wt(se.nodeName);if(!To(Ft,Ye,_t)){Co(be,se);continue}if(A&&typeof p=="object"&&typeof p.getAttributeType=="function"&&!Te)switch(p.getAttributeType(Ft,Ye)){case"TrustedHTML":{_t=A.createHTML(_t);break}case"TrustedScriptURL":{_t=A.createScriptURL(_t);break}}if(_t!==Ct)try{Te?se.setAttributeNS(Te,be,_t):se.setAttribute(be,_t),Ts(se)?Qi(se):h9(e.removed)}catch{Co(be,se)}}ua(B.afterSanitizeAttributes,se,null)},Pd=function se(Pt){let bt=null,H=Xu(Pt);for(ua(B.beforeSanitizeShadowDOM,Pt,null);bt=H.nextNode();)ua(B.uponSanitizeShadowNode,bt,null),Yu(bt),sh(bt),bt.content instanceof a&&se(bt.content);ua(B.afterSanitizeShadowDOM,Pt,null)};return e.sanitize=function(se){let Pt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},bt=null,H=null,pe=null,be=null;if(At=!se,At&&(se="<!-->"),typeof se!="string"&&!qu(se))if(typeof se.toString=="function"){if(se=se.toString(),typeof se!="string")throw Iy("dirty is not a string, aborting")}else throw Iy("toString is not a function");if(!e.isSupported)return se;if(ke||Pn(Pt),e.removed=[],typeof se=="string"&&(Fe=!1),Fe){if(se.nodeName){let Ye=Wt(se.nodeName);if(!me[Ye]||Le[Ye])throw Iy("root node is forbidden and cannot be sanitized in-place")}}else if(se instanceof s)bt=Mo("<!---->"),H=bt.ownerDocument.importNode(se,!0),H.nodeType===My.element&&H.nodeName==="BODY"||H.nodeName==="HTML"?bt=H:bt.appendChild(H);else{if(!Ee&&!oe&&!X&&se.indexOf("<")===-1)return A&&st?A.createHTML(se):se;if(bt=Mo(se),!bt)return Ee?null:st?E:""}bt&&Ce&&Qi(bt.firstChild);let Te=Xu(Fe?se:bt);for(;pe=Te.nextNode();)Yu(pe),sh(pe),pe.content instanceof a&&Pd(pe.content);if(Fe)return se;if(Ee){if(Ne)for(be=k.call(bt.ownerDocument);bt.firstChild;)be.appendChild(bt.firstChild);else be=bt;return(Ae.shadowroot||Ae.shadowrootmode)&&(be=O.call(n,be,!0)),be}let de=X?bt.outerHTML:bt.innerHTML;return X&&me["!doctype"]&&bt.ownerDocument&&bt.ownerDocument.doctype&&bt.ownerDocument.doctype.name&&so(Ore,bt.ownerDocument.doctype.name)&&(de="<!DOCTYPE "+bt.ownerDocument.doctype.name+`>
`+de),oe&&Cb([L,R,T],Ye=>{de=Ey(de,Ye," ")}),A&&st?A.createHTML(de):de},e.setConfig=function(){let se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Pn(se),ke=!0},e.clearConfig=function(){en=null,ke=!1},e.isValidAttribute=function(se,Pt,bt){en||Pn({});let H=Wt(se),pe=Wt(Pt);return To(H,pe,bt)},e.addHook=function(se,Pt){typeof Pt=="function"&&Sy(B[se],Pt)},e.removeHook=function(se,Pt){if(Pt!==void 0){let bt=iqe(B[se],Pt);return bt===-1?void 0:aqe(B[se],bt,1)[0]}return h9(B[se])},e.removeHooks=function(se){B[se]=[]},e.removeAllHooks=function(){B=v9()},e}var wqe=Bre(),Aqe={"connection-stairs-12x12":`<svg viewBox="0 0 12 12" stroke="none">
		<path d="M1.625 8.1875C1.625 8.01491 1.76491 7.875 1.9375 7.875H4.75V9.4375C4.75 9.61009 4.61009 9.75 4.4375 9.75H1.9375C1.76491 9.75 1.625 9.61009 1.625 9.4375V8.1875Z" />
		<path d="M3.5 6.3125C3.5 6.13991 3.63991 6 3.8125 6H6.625V7.5625C6.625 7.73509 6.48509 7.875 6.3125 7.875H3.5V6.3125Z" />
		<path d="M5.375 4.4375C5.375 4.26491 5.51491 4.125 5.6875 4.125H8.5V5.6875C8.5 5.86009 8.36009 6 8.1875 6H5.375V4.4375Z" />
		<path d="M7.25 2.5625C7.25 2.38991 7.38991 2.25 7.5625 2.25H10.0625C10.2351 2.25 10.375 2.38991 10.375 2.5625V3.8125C10.375 3.98509 10.2351 4.125 10.0625 4.125H7.25V2.5625Z" />
	</svg>`,"connection-elevator-12x12":`<svg viewBox="0 0 12 12" stroke="none">
		<circle cx="1.9375" cy="4.4375" r="0.9375" />
		<circle cx="1.9375" cy="7.5625" r="0.9375" />
		<path
			fillRule="evenodd"
			clipRule="evenodd"
			d="M7.6 2H9.4C9.73137 2 10 2.26863 10 2.6V9.41328C10 9.74465 9.73137 10.0133 9.4 10.0133H7.6V2ZM6.4 2H4.6C4.26863 2 4 2.26863 4 2.6V9.41328C4 9.74465 4.26863 10.0133 4.6 10.0133H6.4V2Z"
		/>
	</svg>`,"point-of-interest-12x12":`<svg viewBox="0 0 12 12" stroke="none">
		<path
			stroke="none"
			id="Subtract"
			fill-rule="evenodd"
			clip-rule="evenodd"
			d="M6.24724 10.7516C7.94597 9.0358 9.85962 6.89195 9.85962 4.85965C9.85962 2.72802 8.13159 1 5.99997 1C3.86834 1 2.14032 2.72802 2.14032 4.85965C2.14032 6.89195 4.05397 9.0358 5.7527 10.7516C5.88904 10.8893 6.1109 10.8893 6.24724 10.7516ZM5.99994 6.26317C6.77508 6.26317 7.40345 5.6348 7.40345 4.85967C7.40345 4.08453 6.77508 3.45616 5.99994 3.45616C5.22481 3.45616 4.59644 4.08453 4.59644 4.85967C4.59644 5.6348 5.22481 6.26317 5.99994 6.26317Z"
		/>
	</svg>`,"door-12x12":`<svg viewBox="0 0 13 12">
			<path
				stroke="none"
				d="M4.02533 0.662341H9.61421C9.95171 0.662341 10.2264 0.937033 10.2264 1.27453V10.726C10.2264 11.0639 9.95218 11.3382 9.61421 11.3382H4.02533C3.69721 11.3382 3.42674 11.078 3.41408 10.7504V1.24696C3.4272 0.919297 3.69721 0.659149 4.02533 0.659149V0.662341ZM5.96969 5.22798H6.64563V6.7725H5.96969V5.22798ZM4.94219 1.39218L7.31267 2.6541C7.43501 2.71973 7.50533 2.84488 7.50533 2.97473C7.50721 4.99181 7.50674 7.00877 7.50674 9.02585C7.50674 9.17679 7.41487 9.30663 7.28361 9.36195L4.94217 10.6084H9.49653V1.39227L4.94219 1.39218Z"
			/>
		</svg>`,"building-12x12":`<svg viewBox="0 0 12 12" stroke="none">
			<path
				d="M11.2374 9.75H10.5V4.5C10.5 4.30109 10.421 4.11032 10.2804 3.96967C10.1397 3.82902 9.94894 3.75 9.75003 3.75H7.68753C7.6378 3.75 7.59011 3.76976 7.55495 3.80492C7.51978 3.84008 7.50003 3.88777 7.50003 3.9375V9.75H6.75003V1.51922C6.75127 1.4024 6.72592 1.28683 6.67589 1.18125C6.62587 1.07567 6.55248 0.982864 6.46128 0.909845C6.33697 0.812924 6.18528 0.757635 6.02776 0.751829C5.87024 0.746023 5.71489 0.789995 5.58378 0.877501L1.83378 3.375C1.73091 3.44364 1.6466 3.53664 1.58837 3.64574C1.53014 3.75484 1.4998 3.87665 1.50003 4.00031V9.75H0.762687C0.66578 9.74857 0.571927 9.78389 0.500006 9.84885C0.428085 9.91382 0.383432 10.0036 0.37503 10.1002C0.371625 10.1515 0.378802 10.2029 0.396116 10.2513C0.413431 10.2997 0.440513 10.344 0.47568 10.3815C0.510847 10.419 0.553349 10.4489 0.600545 10.4693C0.647741 10.4897 0.698623 10.5001 0.75003 10.5H11.25C11.3014 10.5001 11.3523 10.4897 11.3995 10.4693C11.4467 10.4489 11.4892 10.419 11.5244 10.3815C11.5595 10.344 11.5866 10.2997 11.6039 10.2513C11.6213 10.2029 11.6284 10.1515 11.625 10.1002C11.6166 10.0036 11.572 9.91382 11.5001 9.84885C11.4281 9.78389 11.3343 9.74857 11.2374 9.75ZM3.56253 8.625C3.56264 8.67641 3.55219 8.72729 3.53181 8.77449C3.51143 8.82168 3.48156 8.86418 3.44406 8.89935C3.40657 8.93452 3.36224 8.9616 3.31383 8.97892C3.26543 8.99623 3.21398 9.00341 3.16269 9C3.06605 8.99159 2.9762 8.94688 2.91122 8.87485C2.84624 8.80283 2.81098 8.70886 2.81253 8.61188V7.88766C2.81121 7.79078 2.84657 7.69699 2.91151 7.62509C2.97645 7.55319 3.06618 7.50851 3.16269 7.5C3.21398 7.4966 3.26543 7.50377 3.31383 7.52109C3.36224 7.5384 3.40657 7.56548 3.44406 7.60065C3.48156 7.63582 3.51143 7.67832 3.53181 7.72552C3.55219 7.77271 3.56264 7.82359 3.56253 7.875V8.625ZM3.56253 6C3.56264 6.05141 3.55219 6.10229 3.53181 6.14949C3.51143 6.19668 3.48156 6.23918 3.44406 6.27435C3.40657 6.30952 3.36224 6.3366 3.31383 6.35392C3.26543 6.37123 3.21398 6.37841 3.16269 6.375C3.06609 6.36649 2.9763 6.32174 2.91135 6.24974C2.84639 6.17774 2.81109 6.08383 2.81253 5.98688V5.26266C2.81121 5.16578 2.84657 5.07199 2.91151 5.00009C2.97645 4.92819 3.06618 4.88351 3.16269 4.875C3.21398 4.8716 3.26543 4.87877 3.31383 4.89609C3.36224 4.9134 3.40657 4.94048 3.44406 4.97565C3.48156 5.01082 3.51143 5.05332 3.53181 5.10052C3.55219 5.14771 3.56264 5.19859 3.56253 5.25V6ZM5.43753 8.625C5.43764 8.67641 5.42719 8.72729 5.40681 8.77449C5.38643 8.82168 5.35656 8.86418 5.31906 8.89935C5.28157 8.93452 5.23724 8.9616 5.18883 8.97892C5.14043 8.99623 5.08898 9.00341 5.03769 9C4.94122 8.9916 4.8515 8.94702 4.78654 8.8752C4.72159 8.80338 4.68622 8.70964 4.68753 8.61281V7.88766C4.68633 7.79086 4.72174 7.69718 4.78667 7.62539C4.8516 7.55359 4.94126 7.50897 5.03769 7.50047C5.08898 7.49706 5.14043 7.50424 5.18883 7.52156C5.23724 7.53887 5.28157 7.56595 5.31906 7.60112C5.35656 7.63629 5.38643 7.67879 5.40681 7.72598C5.42719 7.77318 5.43764 7.82406 5.43753 7.87547V8.625ZM5.43753 6C5.43764 6.05141 5.42719 6.10229 5.40681 6.14949C5.38643 6.19668 5.35656 6.23918 5.31906 6.27435C5.28157 6.30952 5.23724 6.3366 5.18883 6.35392C5.14043 6.37123 5.08898 6.37841 5.03769 6.375C4.94126 6.3665 4.8516 6.32188 4.78667 6.25008C4.72174 6.17829 4.68633 6.08461 4.68753 5.98781V5.26266C4.68633 5.16586 4.72174 5.07218 4.78667 5.00039C4.8516 4.92859 4.94126 4.88397 5.03769 4.87547C5.08898 4.87206 5.14043 4.87924 5.18883 4.89656C5.23724 4.91387 5.28157 4.94095 5.31906 4.97612C5.35656 5.01129 5.38643 5.05379 5.40681 5.10098C5.42719 5.14818 5.43764 5.19906 5.43753 5.25047V6Z"
				stroke="none"
			/>
		</svg>`,"ladder-12x12":`<svg viewBox="0 0 12 12">
			<g id="surface1">
				<path style=" stroke:none;fill-rule:nonzero;fill:rgb(94.117647%,94.117647%,94.117647%);fill-opacity:1;" d="M 2.34375 0.375 L 2.53125 0.375 L 2.625 11.53125 L 2.34375 11.625 L 2.25 0.46875 Z M 2.34375 0.375 "/>
				<path style=" stroke:none;fill-rule:nonzero;fill:rgb(94.117647%,94.117647%,94.117647%);fill-opacity:1;" d="M 9.46875 0.375 L 9.65625 0.375 L 9.75 11.53125 L 9.46875 11.625 L 9.375 0.46875 Z M 9.46875 0.375 "/>
				<path style=" stroke:none;fill-rule:nonzero;fill:rgb(94.117647%,94.117647%,94.117647%);fill-opacity:1;" d="M 2.25 2.25 L 2.25 1.875 L 9.75 1.875 L 9.75 2.25 Z M 2.25 2.25 "/>
				<path style=" stroke:none;fill-rule:nonzero;fill:rgb(94.117647%,94.117647%,94.117647%);fill-opacity:1;" d="M 2.25 4.875 L 2.25 4.5 L 9.75 4.5 L 9.75 4.875 Z M 2.25 4.875 "/>
				<path style=" stroke:none;fill-rule:nonzero;fill:rgb(94.117647%,94.117647%,94.117647%);fill-opacity:1;" d="M 2.25 7.5 L 2.25 7.125 L 9.75 7.125 L 9.75 7.5 Z M 2.25 7.5 "/>
				<path style=" stroke:none;fill-rule:nonzero;fill:rgb(94.117647%,94.117647%,94.117647%);fill-opacity:1;" d="M 2.25 10.125 L 2.25 9.75 L 9.75 9.75 L 9.75 10.125 Z M 2.25 10.125 "/>
			</g>
		</svg>`},Sqe=/<svg([^>]*)>/g;function Eqe(t,e,r){let n=Aqe[t];return n?n.replace(Sqe,'<svg$1 xmlns="http://www.w3.org/2000/svg" style="fill:'.concat(e,"; width:").concat(r,"px; height:").concat(r,'px">')):null}function Iqe(t){return wqe.sanitize(t,{USE_PROFILES:{svg:!0}})}function Cqe(t,e){let r=new DOMParser().parseFromString(t,"image/svg+xml").documentElement;return r==null||r.tagName==="parsererror"||r.tagName.toLowerCase()!=="svg"?(Be.error("Failed to parse SVG",{svg:t,tagName:r?.tagName}),t):(e!=null&&(r.setAttribute("color",e),r.querySelectorAll("*").forEach(n=>{(n.getAttribute("fill")!=null||n.tagName==="path")&&n.getAttribute("fill")!=="none"&&n.setAttribute("fill","currentColor"),n.getAttribute("stroke")!=null&&n.getAttribute("stroke")!=="none"&&n.setAttribute("stroke","currentColor")})),new XMLSerializer().serializeToString(r))}async function Mqe(t,e){let r="";try{if(t.trim()==="")throw new Error("URL is empty!");e?.style==="fill"&&(t=t.replace(".svg","-fill.svg"));let n=await Wu()(t),i=n.headers.get("content-type");if(i!=null&&i.includes("image/svg+xml")){let a=await n.text();return r=Iqe(a),e?.color!=null&&(r=Cqe(r,e.color)),{icon:r,type:"svg"}}else{if(i!=null&&i.includes("image"))return{icon:t,type:"image"};throw new Error("Expected SVG or Image content, but received: ".concat(i))}}catch(n){return Be.error("Failed to fetch icon from ".concat(t,"."),n),null}}C();function Tqe(t){return t.locationProfiles.some(e=>e.categories.some(r=>r.name.includes("Restroom")))}function Pqe(t){return t.locationProfiles.some(e=>e.categories.some(r=>r.name.includes("Parking")))}var Dqe=new Set(["connection","point-of-interest","space","object","door","facade"]),Ud={default:"#3D5676",connection:"#128387",washroom:"#3161B4",point:"#AD468F",parking:"#418425",door:"#A0552C"},kf={elevator:"connection-elevator-12x12",stairs:"connection-stairs-12x12",point:"point-of-interest-12x12",door:"door-12x12",building:"building-12x12",ladder:"ladder-12x12"};function kqe(t){let e=null;if(Md.is(t))switch(t.type){case"elevator":e=kf.elevator;break;case"ladder":e=kf.ladder;break;case"escalator":case"stairs":default:e=kf.stairs}else cf.is(t)?e=kf.point:Cd.is(t)?e=kf.door:Nl.is(t)&&(e=kf.building);return e!=null?Eqe(e,"#FFFFFF",12):null}function _9(t){return Md.is(t)?Ud.connection:Nl.is(t)?Ud.default:Tqe(t)?Ud.washroom:Pqe(t)?Ud.parking:cf.is(t)?Ud.point:Cd.is(t)?Ud.door:Ud.default}async function Oqe(t,e){var r;let n=null,i="locationProfiles"in t?(r=t.locationProfiles.find(a=>a.icon!=null))==null?void 0:r.icon:null;if(i?.url!=null&&(n=await Mqe(i.url,{color:e.color,style:"fill"})),n==null){let a=kqe(t);a!=null&&(n={icon:a,type:"svg"})}return n}function Bqe(t){return Md.is(t)||Cd.is(t)?"low":cf.is(t)||Nl.is(t)?"high":"medium"}async function zqe(t){let e={appearance:{color:_9(t),pinOutlineColor:_9(t),iconPadding:8,iconSize:24,textSize:12.5,iconScale:{on:"zoom-level",input:[18,20],output:[.7,1]}},rank:Bqe(t),interactive:!0},r=await Oqe(t,{color:"#FFFFFF"});return r!=null&&(e.appearance.icon=r.icon,r.type==="svg"?Nl.is(t)&&(e.appearance.iconSize=30,e.appearance.iconPadding=10):r.type==="image"&&(e.appearance.iconSize=48,e.appearance.iconPadding=2,e.appearance.pinOutlineColor="#FFFFFF",e.rank="high")),e}async function Fqe(t,e){return(await Promise.all(e.map(async r=>{let n=[];if(!lS(r))return n;let i=await zqe(r);return Md.is(r)?n=r.coordinates.map(a=>t.Labels.add(a,r.name,i)):Nl.is(r)?r.spaces.length>0&&r.floorStack.name!=null&&r.floorStack.name!==""&&n.push(t.Labels.add(r.spaces[0],r.floorStack.name,i)):eqe(r)&&Jee(r)&&n.push(t.Labels.add(r,r.name,i)),n}))).flat()}async function Rqe(t,e){let r=t.getMapDataInternal();if(!r)throw new Error("Map data not found");let n=r.getAllOfTypes(Dqe,e),i=r.getAllOfTypes(HXe,e),a=r.getAllOfTypes(KXe,e),[o,s]=await Promise.all([n.length>0?Fqe(t,n):[],i.length>0?JXe(t,i):[],a.length>0?QXe(t,a):[]]);return{labels:o,markers:s}}var Tb=.05,qw,Yw,Lqe=class extends wi{constructor(t,e,r){super(),S(this,"core"),S(this,"mapObjects",[]),S(this,"id"),S(this,"mapDataExternal",{}),S(this,"mapsByFloorId",{}),S(this,"mapData"),S(this,"currentMap"),S(this,"hiddenOutdoorGeometries",[]),S(this,"lastFacadeIntersected"),K(this,qw,!1),K(this,Yw,!1),S(this,"mapView"),S(this,"externalPubSub"),S(this,"Camera"),S(this,"Labels"),S(this,"Text3D"),S(this,"Markers"),S(this,"Models"),S(this,"Paths"),S(this,"Exporter"),S(this,"Navigation"),S(this,"Outdoor"),S(this,"Shapes"),S(this,"Style"),S(this,"Image3D"),S(this,"update",()=>{this.core.render()}),this.core=t,this.mapView=e,this.externalPubSub=r,this.Camera=new XHe(this),this.id=this.core.addGroupContainer("root").id.toString();let n=new jL("outdoors-container",void 0,void 0,this);this.mapObjects.push(n),this.currentMap=n,this.core.on("pre-render",()=>{r.publish("pre-render")}),this.core.on("post-render",()=>{r.publish("post-render")}),this.core.on("resize",()=>{r.publish("resize")}),this.core.on("render-error",({error:l})=>{r.publish("render-error",{error:new Gme(l instanceof Error?l.message:"Unknown error")})});let i=l=>{let u=this.getMapDataObject(l);switch(u?.__type){case"facade":return u;case"floor":return u.floorStack.facade;default:return null}};this.core.on("geometry-in-focus",l=>{let u=new Set;for(let c of l){let h=i(c);h&&u.add(h)}r.publish("facades-in-view-change",{facades:Array.from(u)})}),this.core.getSystems().renderSystem.on("camera-state-change",()=>{r.publish("state-change-internal",{Camera:this.getCameraState()})});let a=new kHe(this.Camera,{precision:7});this.core.on("camera-change",()=>{r.publish("camera-change",a)}),this.core.on("pan-bounds-change",l=>{r.publish("camera-bounds-change",pte(l,this.core.convert3DMapPositionToCoordinate))});let o=l=>u=>{let c=[],h=[],d=[],p=[];u.labels.forEach(E=>{let M=this.Labels.getById(E.toString());M&&c.push(M.label)}),u.markers.forEach(E=>{let M=this.Markers.getById(E.toString())||this.Navigation.getMarkerById(E.toString());M&&h.push(M.marker)}),u.models.forEach(E=>{let M=this.Models.getById(E.toString());M&&d.push(M.model)}),u.paths.forEach(E=>{let M=this.Paths.getById(E.toString());M&&p.push(M)});let m=u.geometry,y;m.length>0&&(y=m.map(E=>{var M;return(M=this.getMapDataInternal())==null?void 0:M.getById("space",E)}).filter(Boolean)[0],y||(y=m.map(E=>{var M;return(M=this.getMapDataInternal())==null?void 0:M.getById("object",E)}).filter(Boolean)[0]),y||(y=m.map(E=>{var M;return(M=this.getMapDataInternal())==null?void 0:M.getById("area",E)}).filter(Boolean)[0]),y||(y=m.map(E=>this.Shapes.getById(E)).filter(Boolean)[0]));let v=u.containers.reduce((E,M)=>{var P;let k=(P=this.getMapDataInternal())==null?void 0:P.getById("floor",M);return k&&Fc.is(k)&&E.push(k),E},[]),_,w=0;if(v.length>0){_=v[0].id;let E=this.core.getState(_);w=u.coordinate[2]?u.coordinate[2]-E.altitude:w}let b;this.lastFacadeIntersected&&this.lastFacadeIntersected.spaces.forEach(E=>{this.core.setState(E.id,{hovered:!1})}),y&&Xs.is(y)&&(b=m.map(E=>{var M;return(M=this.getMapDataInternal())==null?void 0:M.facadesBySpaceId[E]}).filter(Boolean)[0],b&&b.spaces.forEach(E=>{this.core.setState(E.id,{hovered:!0})})),this.lastFacadeIntersected=b;let A={coordinate:new Rr({latitude:u.coordinate[1],longitude:u.coordinate[0],floorId:_,verticalOffset:w}),spaces:y&&Xs.is(y)?[y]:[],objects:y&&Wp.is(y)?[y]:[],areas:y&&r0.is(y)?[y]:[],shapes:y&&Fw.is(y)?[y]:[],markers:h,labels:c,models:d,paths:p,floors:v,facades:b?[b]:[]};"pointerEvent"in u&&(A.pointerEvent=u.pointerEvent),r.publish(l,A)};this.core.on("hover",o("hover")),this.core.on("click",o("click")),this.core.on("user-interaction-start",()=>{r.publish("user-interaction-start")}),this.core.on("user-interaction-end",()=>{r.publish("user-interaction-end")});let s={currentMapGetter:()=>this.currentMap};this.Markers=new QHe(s),this.Models=new tXe(s),this.Labels=new YHe(s),this.Text3D=new oXe(s),this.Exporter=new qHe(s),this.Paths=new rXe(s),this.Navigation=new HHe(this),this.on("navigation-state-change",l=>{this.externalPubSub.publish("state-change-internal",{Navigation:l})}),this.on("navigation-connection-click",l=>{this.externalPubSub.publish("navigation-connection-click",l)}),this.on("navigation-active-path-change",l=>{this.externalPubSub.publish("navigation-active-path-change",l)}),this.Outdoor=new aXe(this.core,this.hiddenOutdoorGeometries),this.Outdoor.enabled&&(this.core.on("outdoor-view-loaded",()=>{r.publish("outdoor-view-loaded")}),this.core.on("outdoor-style-loaded",()=>{r.publish("outdoor-style-loaded")})),this.Image3D=new eXe(s),this.Shapes=new nXe(s),this.Style=new iXe(s)}get manualFloorVisibility(){return f(this,qw)}set manualFloorVisibility(t){ne(this,qw,t),this.externalPubSub.publish("state-change-internal",{manualFloorVisibility:t})}get hidePathsNotOnCurrentFloor(){return f(this,Yw)}set hidePathsNotOnCurrentFloor(t){var e;ne(this,Yw,t),(e=this.currentMap)==null||e.updatePathLayersVisibility()}preloadFloors(t){t.forEach(e=>{e instanceof Fc&&this.core.setState(e.id,{preloadGeometry:!0})})}updateState(t,e){var r,n;if(e==null||typeof e!="object")return;let i=(n=(r=this.currentMap.options)==null?void 0:r.disableUpdateStateValidation)!=null?n:!1;if(t==="interior-walls"){this.currentMap.floors.forEach(o=>{let s=o.layers.get(Ma);if(s){let l=s.layers.get(cS);l&&this.core.hasState(l)&&this.core.setState(l,l9(Vn(s9,e,{warn:!0,disableValidation:i}),this.core.getState(l)))}});return}if(t==="exterior-walls"){this.currentMap.floors.forEach(o=>{let s=o.layers.get(Ma);if(s){let l=s.layers.get(n0);l&&this.core.hasState(l)&&this.core.setState(l,l9(Vn(s9,e,{warn:!0,disableValidation:i}),this.core.getState(l)))}});return}if(t==="interior-doors"){this.currentMap.floors.forEach(o=>{let s=o.layers.get(Ma);if(s){let l=s.layers.get(tB);l&&this.core.hasState(l)&&this.core.setState(l,PI(Vn(TI,e,{warn:!0,disableValidation:i}),this.core.getState(l)))}});return}if(t==="exterior-doors"){this.currentMap.floors.forEach(o=>{let s=o.layers.get(Ma);if(s){let l=s.layers.get(rB);l&&this.core.hasState(l)&&this.core.setState(l,PI(Vn(TI,e,{warn:!0,disableValidation:i}),this.core.getState(l)))}});return}let a=typeof t=="string"?this.getMapDataObject(t):t;if(a){if(a.__type!==Wv.__type&&!this.core.hasState(a.id)){Be.warn('Failed to update state for "'.concat(a.id,'". No ').concat(a.__type," found with that ID."));return}if(pA.is(a))return this.core.setState(a.id,TXe(Vn(CXe,e,{warn:!0,disableValidation:i}),this.core.getState(a.id)));if(fA.is(a))return this.core.setState(a.id,OXe(Vn(DXe,e,{warn:!0,disableValidation:i}),this.core.getState(a.id)));if(Xs.is(a)||Wp.is(a)){let o=this.core.getState(a.id);o!=null&&this.core.setState(a.id,EXe(Vn(t9,e,{warn:!0,disableValidation:i}),o))}if(r0.is(a)&&this.core.setState(a.id,Vn(t9,e,{warn:!0,disableValidation:i})),fre.is(a)&&this.core.setState(a.id,Vn(UXe,e,{warn:!0,disableValidation:i})),Cd.is(a)&&this.core.setState(a.id,PI(Vn(TI,e,{warn:!0,disableValidation:i}),this.core.getState(a.id))),Fw.is(a)&&this.core.setState(a.id,FXe(Vn(Cre,e,{warn:!0,disableValidation:i}))),gre.is(a)){let o=Vn(VXe,e,{warn:!0,disableValidation:i}),{position:s,scale:l,rotation:u}=o,c=yu(o,["position","scale","rotation"]);s&&(c.position=[s.longitude,s.latitude,s.verticalOffset]),l!=null&&(Array.isArray(l)?c.scale=l:c.scale=[l,l,l]),u!=null&&(Array.isArray(u)?c.rotation=u:c.rotation=[u,u,u]),s&&a.updateTarget(s),this.core.setState(a.id,c)}if(Fc.is(a)){let o=this.currentMap.floorsById.get(a.id);if(o==null)return;let s=Vn(wXe,e,{warn:!0,disableValidation:i});this.core.setState(a.id,s);let l=o.layers.get(Ma);l!=null&&"geometry"in e&&e.geometry&&this.core.setState(l.containerId,Vn(fXe,e.geometry,{warn:!0,disableValidation:i}));let u=o.layers.get(i0);if(u!=null&&"labels"in e&&e.labels){let v=Vn(mXe,e.labels,{warn:!0,disableValidation:i});"enabled"in v&&typeof v.enabled=="boolean"&&u.setVisible(v.enabled)}let c=o.layers.get(kp);if(c!=null&&"markers"in e&&e.markers){let v=Vn(gXe,e.markers,{warn:!0,disableValidation:i});"enabled"in v&&typeof v.enabled=="boolean"&&c.setVisible(v.enabled)}let h=o.layers.get(nB);h!=null&&"footprint"in e&&e.footprint&&this.core.setState(h.containerId,Vn(pXe,e.footprint,{warn:!0,disableValidation:i}));let d=o.layers.get(sA);if(d!=null&&"occlusion"in e&&e.occlusion){let v=Vn(vXe,e.occlusion,{warn:!0,disableValidation:i});"enabled"in v&&typeof v.enabled=="boolean"&&d.setVisible(v.enabled)}let p=o.layers.get(iB);if(p!=null&&"images"in e&&e.images){let v=Vn(yXe,e.images,{warn:!0,disableValidation:i});"visible"in v&&typeof v.visible=="boolean"&&p.setVisible(v.visible)}let m=o.layers.get(a0);if(m!=null&&"paths"in e&&e.paths!=null){let v=Vn(_Xe,e.paths,{warn:!0,disableValidation:i});v.visible!=null&&typeof v.visible=="boolean"&&m.setVisible(v.visible)}let y=o.layers.get(lA);if(y!=null&&"areas"in e&&e.areas!=null){let v=Vn(xXe,e.areas,{warn:!0,disableValidation:i});v.visible!=null&&typeof v.visible=="boolean"&&y.setVisible(v.visible)}}if(Nl.is(a)){let o=this.core.getState(a.id);for(let s of o.children)s.type==="group-container"&&this.core.setState(s.id,Vn(hXe,e,{warn:!0,disableValidation:i}))}if(U6.is(a)&&this.core.setState(a.id,Vn(RXe,e,{warn:!0,disableValidation:i})),Wv.is(a))for(let o of a.segments)this.core.setState(o.id,Vn(n9,e,{warn:!0,disableValidation:i}));cB.is(a)&&this.core.setState(a.id,Vn(n9,e,{warn:!0,disableValidation:i}))}}getMapDataObject(t){var e;return(e=this.getMapDataInternal())==null?void 0:e.getMapDataById(t)}getMapDataInternal(){if(this.mapData)return eT(this.mapData)}getMapData(){return this.mapData}addMap(t,e){return new Promise(r=>{var n,i,a,o;let s;try{s=eT(t)}catch(m){Be.error("Error adding map",m),r(t);return}this.mapDataExternal[t.mapName]=t,this.mapData=t;let{mvf:l}=s,u=l["manifest.geojson"].features[0].geometry.coordinates;this.core.mode!=="outdoors-overlay"&&this.Camera.set({center:new Rr(u[1],u[0])});let c=l["manifest.geojson"].features[0].properties.name,h=new jL("mapObject-".concat(c),s,e,this);this.currentMap=h,this.currentMap.loadAllFloors(),this.currentMap.setFloor(this.currentMap.startingFloorId);let d=this.core.getBoundingArea(h.currentFloor.id);d==null&&Be.error("Could not determine bounding box for map:",h.currentFloor.id);let p=(i=(n=e?.outdoorView)==null?void 0:n.layersHiddenByGeometry)!=null?i:[];if(p.length>0){let m,y=[];for(let v of h.floorStacksById.values())if(v.defaultFloor.footprint&&v.defaultFloor.footprint.geometry!=null&&((a=v.defaultFloor.footprint.geometry)==null?void 0:a.coordinates.length)>0){let _=v.defaultFloor.footprint,w=dte(_);m==null?m=w:GVe(m,w),y.push(_)}y.length>0&&m!=null&&(this.core.hideOutdoorLayersIntersectingPolygons(m,y,p),this.hiddenOutdoorGeometries.push([m,y,p]))}if(this.mapObjects.push(h),s.getMVFFeatureByType("floor").forEach(m=>{this.mapsByFloorId[m.id]=h}),h.on("floor-change-start",m=>{var y,v,_,w;this.externalPubSub.publish("floor-change-start",{reason:m.reason,floor:(v=(y=this.getMapDataInternal())==null?void 0:y.getById("floor",m.floorId))!=null?v:this.currentFloor,previousFloor:(w=(_=this.getMapDataInternal())==null?void 0:_.getById("floor",m.previousFloorId))!=null?w:this.currentFloor})}),h.on("floor-change",m=>{var y,v;this.externalPubSub.publish("floor-change",{reason:m.reason,floor:this.currentFloor,previousFloor:(v=(y=this.getMapDataInternal())==null?void 0:y.getById("floor",m.previousFloorId))!=null?v:this.currentFloor}),this.externalPubSub.publish("state-change-internal",{currentFloor:this.currentFloor,currentFloorStack:this.currentFloorStack})}),e?.zoomLevel!=null)this.core.camera.setZoomLevel(e.zoomLevel),r(t);else if(this.core.mode!=="outdoors-overlay"&&d){let m=(o=e?.screenOffsets)!=null?o:{top:Tb*this.core.canvasHeight,left:Tb*this.core.canvasWidth,right:Tb*this.core.canvasWidth,bottom:Tb*this.core.canvasHeight};this.core.camera.focusOn(d,{duration:Gje,padding:m}).then(()=>{this.Camera.setElevation(this.currentFloor.elevation),r(t)})}else r(t)})}setFloor(t,e){return this.currentMap.setFloor(RT(t),e)}setFloorStack(t,e){return this.currentMap.setFloorStack(RT(t),e)}updateWatermark(t){this.core.updateWatermark(t)}get currentFloorStack(){var t;let e=this.currentMap.currentFloorStack.id;if(!e)throw new ho("Missing currentFloorStack.");let r=(t=this.mapData)==null?void 0:t.getById("floor-stack",e);if(!r)throw new ho("FloorStack was not found in map data.");return r}get currentFloor(){var t;let e=this.currentMap.currentFloor.id;if(!e)throw new ho("Missing currentFloor object from GeoJsonApi");let r=(t=this.mapData)==null?void 0:t.getById("floor",e);if(!r)throw new ho("Missing currentFloor");return r}getState(t){var e,r;typeof t=="object"&&Wv.is(t)&&Be.warn("Cannot get state of a Path directly. Use getState() on individual segments within Path.segments[] instead.");let n=VVe(t,this),i=this.core.getState(n);if(i){if(["interior-walls","exterior-walls"].includes(t)&&i.type==="geometry-group")return NXe(i);if(["interior-doors","exterior-doors"].includes(t)&&i.type==="geometry-group")return cXe(i);if(i.type==="geometry")return SXe(i);if(i.type==="label"&&i.options.appearance&&i.options.rank!==void 0&&i.options.interactive!==void 0)return MXe(i);if(i.type==="marker"&&((e=i.options)==null?void 0:e.rank)!==void 0&&i.options.interactive!==void 0)return kXe(i,(r=this.Markers.getById(i.id.toString()))==null?void 0:r.marker);if(i.type==="model")return GXe(i);if(i.type==="image")return jXe(i);if(i.type==="text3d")return LXe(i);if(i.type==="geometry-group"&&t&&typeof t!="string"&&Fw.is(t))return zXe(i);if(i.type==="path")return BXe(i);if(i.type==="group-container"&&typeof t!="string"&&Fc.is(t))return AXe(i,this.currentMap.floorsById.get(t.id),this.core);if(i.type==="group-container"&&i.children.length>0&&typeof t!="string"&&Nl.is(t)){let a=this.core.getState(i.children[0].id);return dXe(a)}}}setHoverColor(t){this.core.setState({hoverColor:t})}getHoverColor(){let t=this.core.getState();return t?.type==="map-view"?t.hoverColor:void 0}createCoordinateFromScreenCoordinate(t,e,r){var n;if(r!=null){let l=this.core.projectScreenXYToCoordinate(t,e,!0);return l?new Rr(l.coordinate[1],l.coordinate[0],r.id):void 0}let i=this.core.projectScreenXYToCoordinate(t,e);if(i==null||i.coordinate==null)return;let{coordinate:a,groupContainers:o}=i,s=(n=o?.find(l=>{let u=l.userData.entityId.toString();return u.includes("f_")||u.includes("m_")}))==null?void 0:n.userData.entityId.toString();return new Rr(a[1],a[0],s)}getScreenCoordinateFromCoordinate(t){var e,r,n;let i=0;if(t.floorId!=null){let a=(e=this.mapData)==null?void 0:e.getById("floor",t.floorId);a!=null&&(i=(n=(r=this.getState(a))==null?void 0:r.altitude)!=null?n:0)}return this.core.projectCoordinateToScreenXY([t.longitude,t.latitude,i])}isInView(t){return this.core.isInView(typeof t=="string"?t:t.id)}getInView(t,e){let r=this.core.queryGeometry2DInView({screenOffsets:e?.screenOffsets,fullyContains:e?.fullyContains});if(r.length===0)return[];let n=[];switch(t){case pA.__type:n=r.map(i=>this.Labels.getById(i)).filter(i=>i!=null).map(i=>i.label);break;case fA.__type:n=r.map(i=>this.Markers.getById(i)).filter(i=>i!=null).map(i=>i.marker)}return n}async __EXPERIMENTAL__auto(t){return await Rqe(this,t)}tween(t){let e=new l0(t);return this.core.getExternalTweenGroup().add(e),this.core.render(),e}removeTween(t){this.core.getExternalTweenGroup().remove(t)}tweenGroup(){return this.core.getExternalTweenGroup()}get __core(){return this.core}getCameraState(){return this.core.camera.getState()}getNavigationState(){return{isMultiFloor:this.Navigation.isMultiFloor,floorStacks:this.Navigation.floorStacks,floors:this.Navigation.floors,activeDirections:this.Navigation.activeDirections,activePath:this.Navigation.activePath,paths:this.Navigation.paths}}getAllState(){return{currentFloor:this.currentFloor,currentFloorStack:this.currentFloorStack,Camera:this.getCameraState(),Navigation:this.getNavigationState(),manualFloorVisibility:this.manualFloorVisibility}}publishAllState(){this.externalPubSub.publish("state-change-internal",this.getAllState())}clear(){this.Navigation.clear(),this.Shapes.removeAll(),this.Paths.removeAll(),this.Models.removeAll(),this.Markers.removeAll(),this.Image3D.removeAll(),this.Labels.removeAll()}destroy(){this.clear(),this.core.destroy()}getOptimalVisualDistanceBetweenFloors(t,e=!1){let r=this.currentMap;if(!r){Be.error("Cannot compute optimal visual distance between floors. Missing current map.");return}if(t.length<2){Be.warn("Cannot compute optimal visual distance between floors. Must provide at least 2 floors.");return}let n=r.renderer.getInternalState().geometry3DMap.get(t[0].id),i=r.renderer.getInternalState().geometry3DMap.get(t[1].id);if(!n||!i){Be.warn("Cannot compute optimal visual distance between floors. Floors not found in current map.");return}if(x4(n,"group-container"),x4(i,"group-container"),e){let o=new qn;o.setFromObject(n);let s=new qn;if(s.setFromObject(i),n.children.forEach(m=>{m instanceof Er&&m.userData.debugBox&&ya(m)}),i.children.forEach(m=>{m instanceof Er&&m.userData.debugBox&&ya(m)}),!Bv(o)||!Bv(s))return;let l=new od(o.max.x-o.min.x,o.max.y-o.min.y,o.max.z-o.min.z),u=new Go({color:255,transparent:!0,opacity:.5}),c=new Er(l,u);c.position.set((o.min.x+o.max.x)/2,(o.min.y+o.max.y)/2,(o.min.z+o.max.z)/2),c.userData.debugBox=!0;let h=new od(s.max.x-s.min.x,s.max.y-s.min.y,s.max.z-s.min.z),d=new Go({color:"cyan",transparent:!0,opacity:.5}),p=new Er(h,d);p.position.set((s.min.x+s.max.x)/2,(s.min.y+s.max.y)/2,(s.min.z+s.max.z)/2),p.userData.debugBox=!0,n.add(c),i.add(p)}let a=r.renderer.computeMinZOffsetBetweenContainers(n,i);if(a!==-1)return a}};qw=new WeakMap,Yw=new WeakMap;C();var Nqe=class{constructor(t){S(this,"state"),S(this,"update"),this.update=t.Debug.update.bind(t.Debug),this.state=t.Debug.state}};C();var $qe=at.strictObject({environment:at.union([at.literal("basic"),at.literal(!1)]).optional(),text3d:at.object({hoverColor:at.string().optional()}).optional(),geometry:at.object({hoverColor:at.string().optional()}).optional(),backgroundColor:at.string().optional(),backgroundAlpha:at.number().optional()});C();var x9=Zt(vG(),1),Uqe=(t,e)=>{let r={},n=(i,a,o)=>{for(let s in a){let l=i[s],u=a[s];typeof u=="object"&&!Array.isArray(u)&&u!==null&&typeof l=="object"&&!Array.isArray(l)&&l!==null?(o[s]={},n(l,u,o[s])):o[s]=l}};return n(t,e,r),r},jqe=(t,e)=>{let r=Uqe(t,e),n=(0,x9.default)({},r,e),i=(0,x9.default)({},r),a=(o,s,l,u=i)=>{for(let c in s){let h=o[c],d=s[c];if(typeof d=="number"&&typeof h=="number")u[c]=h+(d-h)*l;else if(typeof d=="string"&&typeof h=="string"){if(tg(h)&&tg(d)){let p=xz(h),m=xz(d);p&&m?u[c]=Jme([p[0]+(m[0]-p[0])*l,p[1]+(m[1]-p[1])*l,p[2]+(m[2]-p[2])*l]):Be.warn('Color "'.concat(c,'" could not be animated!'))}}else typeof d=="object"&&d!==null&&typeof h=="object"&&h!==null?a(h,d,l,u[c]):Be.warn('Value "'.concat(c,'" could not be animated!'))}};return o=>(o=Math.min(Math.max(o,0),1),o===0?t:o===1?n:(a(r,e,o),i))},Om,Ot,as,Vqe=class{constructor(t){K(this,Om),K(this,Ot),K(this,as),S(this,"Camera"),S(this,"Labels"),S(this,"Text3D"),S(this,"Markers"),S(this,"Image3D"),S(this,"Models"),S(this,"Paths"),S(this,"Exporter"),S(this,"Navigation"),S(this,"Style"),S(this,"Shapes"),S(this,"Outdoor"),S(this,"update",()=>{f(this,Ot).core.render()}),S(this,"__LEGACY_GET_DIRECTIONS_SYNC",(r,n,i)=>{var a,o;return(o=(a=f(this,Ot).getMapData())==null?void 0:a.__LEGACY_GET_DIRECTIONS_SYNC(r,n,i))!=null?o:void 0}),S(this,"getDirections",(r,n,i)=>{var a,o;return(o=(a=f(this,Ot).getMapData())==null?void 0:a.getDirections(r,n,i))!=null?o:Promise.resolve(void 0)}),S(this,"__LEGACY_GET_DIRECTIONS_MULTI_DESTINATION_SYNC",(r,n,i)=>{var a,o;return(o=(a=f(this,Ot).getMapData())==null?void 0:a.__LEGACY_GET_DIRECTIONS_MULTI_DESTINATION_SYNC(r,n,i))!=null?o:void 0}),S(this,"getDirectionsMultiDestination",(r,n,i)=>{var a,o;return(o=(a=f(this,Ot).getMapData())==null?void 0:a.getDirectionsMultiDestination(r,n,i))!=null?o:Promise.resolve(void 0)}),S(this,"on",(r,n)=>{f(this,Om).on(r,n)}),S(this,"off",(r,n)=>{f(this,Om).off(r,n)}),S(this,"Debug"),ne(this,Om,new wi),ne(this,as,t);let e=new Lqe(t,this,f(this,Om));ne(this,Ot,e),this.Camera=f(this,Ot).Camera,this.Markers=f(this,Ot).Markers,this.Models=f(this,Ot).Models,this.Labels=f(this,Ot).Labels,this.Text3D=f(this,Ot).Text3D,this.Exporter=f(this,Ot).Exporter,this.Paths=f(this,Ot).Paths,this.Navigation=f(this,Ot).Navigation,this.Shapes=f(this,Ot).Shapes,this.Style=f(this,Ot).Style,this.Outdoor=f(this,Ot).Outdoor,this.Image3D=f(this,Ot).Image3D,f(this,as).container.dataset.version=Oi.env.npm_package_version,this.Debug=new Nqe(f(this,Ot).core)}updateState(t,e){return f(this,Ot).updateState(t,e)}animateState(t,e,r){var n;let i=f(this,Ot).getState(t);if(i==null)return Be.warn("Cannot animate state of ".concat(t,".")),new Promise(l=>l({result:"completed"}));let a=jqe(i,e),o=f(this,Ot).tween({percent:0}).to({percent:1},(n=r?.duration)!=null?n:1e3).onUpdate(({percent:l})=>{f(this,Ot).updateState(t,a(l))});r!=null&&r.easing&&r.easing in u0&&o.easing(u0[r.easing]);let s=new Promise(l=>{o.onComplete(()=>{f(this,Ot).removeTween(o),l({result:"completed"})}).onStop(()=>{f(this,Ot).removeTween(o),l({result:"cancelled"})}),o.start()});return s.cancel=()=>{o.stop(),f(this,Ot).updateState(t,a(0))},s}updateGlobalState(t){var e,r,n,i;try{$qe.parse(t)}catch(a){Be.error("updateGlobalState",a);return}if(typeof t=="object"){let a={};if((e=t.text3d)!=null&&e.hoverColor&&(a.text3dHoverColor=t.text3d.hoverColor),(r=t.geometry)!=null&&r.hoverColor&&(a.hoverColor=t.geometry.hoverColor),t.backgroundColor||t.backgroundAlpha!==void 0){let o=(n=t.backgroundColor)!=null?n:f(this,Ot).core.backgroundColor,s=(i=t.backgroundAlpha)!=null?i:f(this,Ot).core.backgroundAlpha;f(this,Ot).core.setBackgroundColor(o,s)}t.environment!=null&&f(this,Ot).core.setEnvironment(t.environment),f(this,Ot).core.setState(a)}}get options(){return Jje(f(this,Ot).currentMap.options)}getGlobalState(){let t=f(this,Ot).core.getState();return{backgroundColor:f(this,Ot).core.backgroundColor,backgroundAlpha:f(this,Ot).core.backgroundAlpha,environment:f(this,Ot).core.getEnvironment(),geometry:{hoverColor:t.hoverColor},text3d:{hoverColor:t.text3dHoverColor}}}getMapData(){if(f(this,Ot).mapData==null)throw new ho("MapData not found.");return f(this,Ot).mapData}getDimensions(){return{width:f(this,as).canvasWidth,height:f(this,as).canvasHeight}}addMap(t,e){return f(this,Ot).addMap(t,e)}setFloor(t,e){return f(this,Ot).setFloor(t,e?.context)}setFloorStack(t,e){return f(this,Ot).setFloorStack(t,e?.context)}preloadFloors(t){f(this,Ot).preloadFloors(t)}tween(t){return f(this,Ot).tween(t)}removeTween(t){f(this,Ot).removeTween(t)}get tweenGroup(){return f(this,Ot).tweenGroup()}get currentFloorStack(){return f(this,Ot).currentFloorStack}get currentFloor(){return f(this,Ot).currentFloor}updateWatermark(t){f(this,Ot).updateWatermark(t)}getState(t){return f(this,Ot).getState(t)}setHoverColor(t){f(this,Ot).setHoverColor(t)}getHoverColor(){return f(this,Ot).getHoverColor()}convertAltitudeToMercatorZoomLevel(t){return f(this,Ot).core.getSystems().cameraSystem.convertAltitudeToZoomLevel(t)}convertMercatorZoomLevelToAltitude(t){return f(this,Ot).core.getSystems().cameraSystem.convertZoomLevelToAltitude(t)}isInView(t){return f(this,Ot).isInView(t)}getInView(t,e){return f(this,Ot).getInView(t,e)}getMetersPerPixel(){return f(this,Ot).core.getMetersPerPixel()}getDistance(t,e){var r;return(r=f(this,Ot).getMapData())==null?void 0:r.getDistance(t,e)}createCoordinate(t,e,r){return typeof t=="object"?new Rr(t):new Rr(t,e,r?.id)}createCoordinateFromScreenCoordinate(t,e,r){return f(this,Ot).createCoordinateFromScreenCoordinate(t,e,r)}getScreenCoordinateFromCoordinate(t){return f(this,Ot).getScreenCoordinateFromCoordinate(t)}__EXPERIMENTAL__auto(t){return f(this,Ot).__EXPERIMENTAL__auto(t)}get __core(){if(Oi.env.INTERNAL==="true")return f(this,Ot).core;throw new Error("__core is not available.")}get container(){return f(this,as).container}publishAllState(){f(this,Ot).publishAllState()}clear(){f(this,Ot).clear()}destroy(){f(this,Ot).destroy()}async enableDebug(t={}){let{Inspector:e}=await N1(()=>import("./inspector-IL7LET64-CJpBHuVl.js"),__vite__mapDeps([6,1,2]));await new e(this,f(this,Ot)).enable(t)}async takeScreenshot(t){var e;let r={withOutdoorContext:(e=t?.withOutdoorContext)!=null?e:!1},n=f(this,as).rendererDomElement;if(r.withOutdoorContext){let i=f(this,as).map;if(!i)return await f(this,as).renderSync(),n.toDataURL("image/png");i.loaded()||await new Promise(l=>{i.once("idle",l)});let a=i.getCanvas(),o=document.createElement("canvas"),s=o.getContext("2d");if(o.width=n.width,o.height=n.height,!s)throw new Error("Failed to get 2D context for composite canvas");return s.drawImage(a,0,0,o.width,o.height),s.drawImage(n,0,0,o.width,o.height),o.toDataURL("image/png")}return await f(this,as).renderSync(),n.toDataURL("image/png")}get manualFloorVisibility(){return f(this,Ot).manualFloorVisibility}set manualFloorVisibility(t){f(this,Ot).manualFloorVisibility=t}getOptimalVisualDistanceBetweenFloors(t){return f(this,Ot).getOptimalVisualDistanceBetweenFloors(t)}get __INTERNAL__hidePathsNotOnCurrentFloor(){return f(this,Ot).hidePathsNotOnCurrentFloor}set __INTERNAL__hidePathsNotOnCurrentFloor(t){f(this,Ot).hidePathsNotOnCurrentFloor=!!t}registerPlugin(t){f(this,as).registerPlugin(t)}unregisterPlugin(t){f(this,as).unregisterPlugin(t)}};Om=new WeakMap,Ot=new WeakMap,as=new WeakMap;C();var Gqe=1e3*60*60*2,Sp,qv,ei,Ec,cu,bl,pu,Tv,Pv,Jw,va,b9,w9,fg,vA,Q6,eP,tP,Zqe=class{constructor(t,e){K(this,va),K(this,Sp,new wi),K(this,qv),K(this,ei),K(this,Ec),K(this,cu),K(this,bl),K(this,pu),K(this,Tv),K(this,Pv),K(this,Jw,()=>{"key"in f(this,ei)&&"secret"in f(this,ei)&&ot(this,va,fg).call(this),ot(this,va,vA).call(this)}),S(this,"on",(r,n)=>f(this,Sp).on(r,n)),S(this,"off",(r,n)=>f(this,Sp).off(r,n)),ne(this,qv,t),ne(this,ei,e)}setMapIds(t){ne(this,qv,t)}setEnterprise(t){f(this,ei).enterprise=t}async readySync(){var t;if((!("key"in f(this,ei))||!("secret"in f(this,ei)))&&!("accessToken"in f(this,ei))){Be.error("No API keys or access token provided! Cannot preload tokens.");return}let e=[ot(this,va,fg).call(this),null];f(this,ei).enterprise||(e[1]=this.getSasTokensAsync());let[r,n]=await Promise.all(e);ot(this,va,tP).call(this),ot(this,va,Q6).call(this,r),n!=null&&ot(this,va,eP).call(this,n),$C()&&((t=globalThis.addEventListener)==null||t.call(globalThis,"focus",f(this,Jw)))}async refreshing(){let t=[];return f(this,Ec)!=null&&t.push(f(this,Ec)),f(this,cu)!=null&&t.push(f(this,cu)),Promise.all(t)}getAccessTokenAsync(){return ot(this,va,fg).call(this)}getSasTokensAsync(){return ot(this,va,vA).call(this)}getAccessToken(){return f(this,bl)==null?(Be.error("Tokens must be loaded before reading synchronously! Try awaiting readySync() first."),{token:""}):f(this,bl)}getSasToken(t){return this.isEnterpriseMode()?(Be.error("SAS tokens are not available in the enterprise mode!"),{token:""}):f(this,pu)==null?(Be.error("Tokens must be loaded before reading synchronously! Try awaiting readySync() first."),{token:""}):t in f(this,pu).tokens?f(this,pu).tokens[t]:(Be.error("SAS token for map ".concat(t," not found!")),{token:""})}isEnterpriseMode(){var t;return(t=f(this,ei).enterprise)!=null?t:!1}destroy(){ot(this,va,tP).call(this),f(this,Sp).destroy(),$C()&&globalThis.removeEventListener("focus",f(this,Jw))}};Sp=new WeakMap,qv=new WeakMap,ei=new WeakMap,Ec=new WeakMap,cu=new WeakMap,bl=new WeakMap,pu=new WeakMap,Tv=new WeakMap,Pv=new WeakMap,Jw=new WeakMap,va=new WeakSet,b9=function(t){var e;let r=t.token!==((e=f(this,bl))==null?void 0:e.token);ne(this,bl,t),r&&f(this,Sp).publish("access-token-refreshed",{accessToken:t})},w9=function(t){var e;let r=JSON.stringify(t.tokens)!==JSON.stringify((e=f(this,pu))==null?void 0:e.tokens);ne(this,pu,t),r&&f(this,Sp).publish("sas-tokens-refreshed",{sasTokens:t.tokens})},fg=async function(t=!1){var e;if("accessToken"in f(this,ei)&&typeof f(this,ei).accessToken=="string"){let r={token:f(this,ei).accessToken,expires:Date.now()+72e5};return ne(this,bl,r),r}if(!("key"in f(this,ei))||!("secret"in f(this,ei))||typeof f(this,ei).key!="string"||typeof f(this,ei).secret!="string")throw new Error("No API keys or access token provided!");return f(this,Ec)!=null?f(this,Ec):f(this,bl)!=null&&f(this,bl).expires!=null&&f(this,bl).expires>Date.now()&&!t?f(this,bl):(ne(this,Ec,xUe(lt(ae({},f(this,ei)),{key:f(this,ei).key,secret:f(this,ei).secret}),(e=f(this,ei).enterprise)!=null?e:!1).then(r=>{let n={token:r.accessToken,expires:r.expiresTimestamp*1e3};return ot(this,va,b9).call(this,n),n}).catch(r=>{throw r}).finally(()=>{ne(this,Ec,void 0)})),f(this,Ec))},vA=async function(t=!1){return this.isEnterpriseMode()?{tokens:{},expires:1/0}:f(this,cu)!=null?f(this,cu):f(this,pu)!=null&&f(this,pu).expires>Date.now()&&!t?f(this,pu):(ne(this,cu,new Promise((e,r)=>{ot(this,va,fg).call(this).then(n=>{let i={},a=f(this,qv).map(o=>SUe(lt(ae({},f(this,ei)),{mapId:o}),n.token).then(s=>{i[o]={token:s.token,expires:s.expires}}).catch(s=>{Be.error("Error getting SAS token for map ".concat(o,":"),s)}));Promise.all(a).then(()=>{let o={tokens:i,expires:Math.min(...Object.values(i).map(s=>{var l;return(l=s.expires)!=null?l:1/0}))};ot(this,va,w9).call(this,o),e(o)})}).catch(n=>{r(n)})})),f(this,cu).catch(e=>{throw e}).finally(()=>{ne(this,cu,void 0)}),f(this,cu))},Q6=function(t){if(!("key"in f(this,ei))||!("secret"in f(this,ei)))return;let e=t.expires!=null?t.expires-Date.now():Gqe;isFinite(e)&&ne(this,Tv,setTimeout(()=>{ot(this,va,fg).call(this,!0).then(r=>{ot(this,va,Q6).call(this,r)})},e-_Ue))},eP=function(t){let e=t.expires-Date.now();isFinite(e)&&ne(this,Pv,setTimeout(()=>{ot(this,va,vA).call(this,!0).then(r=>{ot(this,va,eP).call(this,r)})},e-AUe))},tP=function(){f(this,Tv)!=null&&clearTimeout(f(this,Tv)),f(this,Pv)!=null&&clearTimeout(f(this,Pv))};C();C();var Wqe=(t,{id:e}={})=>{let r=Array.isArray(t)?t:[t];if(!r.every(a=>typeof a=="string"))return;let n=r.join(""),i=null;if(e){let a=document.getElementById(e);a instanceof HTMLStyleElement&&(i=a)}i==null&&(i=document.createElement("style")),e&&e!==""&&(i.id=e),i.textContent=n,document.head.appendChild(i)},Hqe=`:root {
	--pin-shadow-hover-scale: 0.9;
	--pin-shadow-width: 12px;
	--pin-shadow-height: 5px;
	--pin-shadow-opacity: 0.35;
	--pin-drop-animation-duration-ms: 250ms;
}

@keyframes drop-pin {
	0% {
		transform: translateY(-200%);
	}

	100% {
		transform: translateY(0);
	}
}

@keyframes pin-shadow {
	0% {
		transform: scale(var(--pin-shadow-hover-scale));
	}

	100% {
		transform: scale(1);
	}
}

.mappedin-dropped-pin-wrapper {
	position: relative;

	width: fit-content;
	height: fit-content;
	width: 36px;
	height: 42px;

	& svg {
		position: absolute;
		left: calc(50% - var(--pin-shadow-width));
		animation: drop-pin var(--pin-drop-animation-duration-ms) ease-in;
	}

	& > .pin-shadow {
		position: absolute;
		left: calc(50% - (var(--pin-shadow-width) / 2));
		bottom: 0;

		height: var(--pin-shadow-height);
		width: var(--pin-shadow-width);
		border-radius: 100%;

		opacity: var(--pin-shadow-opacity);

		animation: pin-shadow 250ms ease-in;
	}
}

@keyframes bounce {
	0% {
		transform: translateY(-10px);
		opacity: 0;
	}
	12.5% {
		transform: translateY(0);
		opacity: 1;
	}
	25% {
		transform: translateY(0);
	}
	37.5% {
		transform: translateY(-10px);
	}
	50% {
		transform: translateY(0);
	}
	62.5% {
		transform: translateY(-10px);
	}
	75% {
		transform: translateY(0);
	}
	87.5% {
		transform: translateY(-10px);
	}
	100% {
		transform: translateY(0);
	}
}

.mappedin-connection-marker {
	position: relative;
	display: flex;

	.bouncey {
		animation: bounce 2.5s linear;
	}

	.arrow--down {
		transform: rotate(180deg);
	}

	.connection-circle {
		display: flex;
		box-sizing: border-box;
		justify-content: center;
		align-items: center;
		border-radius: 50%;
		border: 2px solid white;
		box-shadow: 0px 2px 8px 0px rgba(0, 0, 0, 0.15);
		background: #595959;
	}
}
`,Xqe=`.mappedin-marker {
	font-family: 'InterUI-Regular', Helvetica, Arial, sans-serif;
	font-weight: normal;
	top: 0;
	position: absolute;
	font-weight: bold;
	color: black;
	display: flex;
	flex-direction: row;
	will-change: transform, opacity;
	transition: opacity 150ms ease-in-out;
	justify-content: center;
	opacity: 0;
}

/* Low priority pin strategy styles */

/* Hide child elements as well */
.mappedin-marker[data-placement='hidden'] > .mappedin-marker-content {
	visibility: hidden;
}

/* Create the pin using ::before pseudo-element */
.mappedin-marker::before {
	content: '';
	display: none;
	border-radius: 50%;
	position: relative;
	/* Default values - will be overridden by inline styles */
	width: var(--mappedin-pin-size, 2px);
	height: var(--mappedin-pin-size, 2px);
	background-color: var(--pin-color, #666);
}

.mappedin-marker[data-placement='hidden']::before {
	display: block;
}
`,qqe=`.mappedin__smart-collision-engine__container {
	position: absolute;
	left: 0px;
	top: 0px;
	bottom: 0px;
	right: 0px;
	pointer-events: none;
	/* Enables colliders to use translate3D */
	transform-style: preserve-3d;
	font-family: 'InterUI-Regular', Helvetica, Arial, sans-serif;
}

.mappedin__smart-collision-engine-debug__container {
	position: absolute;
	left: 0px;
	top: 0px;
	bottom: 0px;
	right: 0px;
	transition: opacity 300ms ease-in-out;
	pointer-events: none;
	will-change: opacity;
	&.interacting {
		opacity: 0.2;
	}
}
`,Yqe=`.mappedin-map {
	.mappedin-interactive {
		cursor: grab;

		&:active {
			cursor: grabbing;
		}

		&.mappedin-interaction-hover {
			cursor: pointer;
		}
	}
}
`,Jqe=`.mappedin-map {
	.mappedin-control-container {
		position: absolute;
		left: 0px;
		top: 0px;
		bottom: 0px;
		right: 0px;
		pointer-events: none;
		font-family: 'InterUI-Regular', Helvetica, Arial, sans-serif;

		.mappedin-ctrl-top-left,
		.mappedin-ctrl-top-right,
		.mappedin-ctrl-bottom-left,
		.mappedin-ctrl-bottom-right {
			position: absolute;
			pointer-events: none;
		}

		.mappedin-ctrl-top-left {
			top: 0;
			left: 0;
		}

		.mappedin-ctrl-top-right {
			top: 0;
			right: 0;
		}

		.mappedin-ctrl-bottom-left {
			bottom: 0;
			left: 0;
		}

		.mappedin-ctrl-bottom-right {
			bottom: 0;
			right: 0;
		}

		.mappedin-ctrl-attrib {
			display: block;
			position: relative;
			pointer-events: auto;
			font: 9px/11px 'InterUI-Regular', Helvetica, Arial, sans-serif;
			padding: 3px 5px 1px 5px;
			background-color: rgba(255, 255, 255, 0.5);
			margin: 0;
			min-width: 11px;
			min-height: 11px;
			user-select: none;

			summary.mappedin-ctrl-attrib-button {
				appearance: none;
				list-style: none;
			}

			summary.mappedin-ctrl-attrib-button::-webkit-details-marker {
				display: none;
			}

			&.mappedin-compact .mappedin-ctrl-attrib-button,
			&.mappedin-compact-show .mappedin-ctrl-attrib-inner {
				display: inline-block;
			}

			&.mappedin-compact {
				background-color: transparent;
			}

			&.mappedin-compact-show {
				min-width: 15px;
				min-height: 15px;
				box-sizing: border-box;
				background-color: rgba(255, 255, 255, 0.5);
			}
		}

		.mappedin-ctrl-attrib-top-left {
			float: left;
			border-bottom-right-radius: 4px;
		}

		.mappedin-ctrl-attrib-top-right {
			float: right;
			border-bottom-left-radius: 4px;
		}

		.mappedin-ctrl-attrib-bottom-left {
			float: left;
			border-top-right-radius: 4px;
		}

		.mappedin-ctrl-attrib-bottom-right {
			float: right;
			border-top-left-radius: 4px;
		}
		.mappedin-ctrl-attrib-top-left,
		.mappedin-ctrl-attrib-bottom-left {
			padding: 3px 5px 1px 20px;
		}

		.mappedin-ctrl-attrib-inner {
			display: inline-block;
			margin-right: 12px;
		}

		.mappedin-ctrl-attrib-inner,
		.mappedin-ctrl-attrib-inner a {
			color: rgba(0, 0, 0, 0.75);
			text-decoration: none;
		}

		.mappedin-ctrl-attrib-inner-bold,
		.mappedin-ctrl-attrib-inner-bold a {
			font-weight: bold;
		}

		.mappedin-ctrl-attrib-inner a:hover {
			color: #017ef1;
			text-decoration: underline;
			cursor: pointer;
		}

		.mappedin-ctrl-attrib-button {
			display: none;
			cursor: pointer;
			position: absolute;
			width: 15px;
			height: 15px;
			box-sizing: border-box;
			border-radius: 50%;
			top: 0;
			right: 2px;
			border: 1px;
		}
		.mappedin-ctrl-attrib-top-left .mappedin-ctrl-attrib-button,
		.mappedin-ctrl-attrib-bottom-left .mappedin-ctrl-attrib-button {
			left: 2px;
		}
	}
}
`,Kqe=`.maplibregl-map {
    font: 12px/20px "Helvetica Neue", Arial, Helvetica, sans-serif;
    overflow: hidden;
    position: relative;
    -webkit-tap-highlight-color: rgb(0 0 0 / 0%);
}

.maplibregl-canvas {
    position: absolute;
    left: 0;
    top: 0;
}

.maplibregl-map:fullscreen {
    width: 100%;
    height: 100%;
}

.maplibregl-ctrl-group button.maplibregl-ctrl-compass {
    touch-action: none;
}

.maplibregl-canvas-container.maplibregl-interactive,
.maplibregl-ctrl-group button.maplibregl-ctrl-compass {
    cursor: grab;
    user-select: none;
}

.maplibregl-canvas-container.maplibregl-interactive.maplibregl-track-pointer {
    cursor: pointer;
}

.maplibregl-canvas-container.maplibregl-interactive:active,
.maplibregl-ctrl-group button.maplibregl-ctrl-compass:active {
    cursor: grabbing;
}

.maplibregl-canvas-container.maplibregl-touch-zoom-rotate,
.maplibregl-canvas-container.maplibregl-touch-zoom-rotate .maplibregl-canvas {
    touch-action: pan-x pan-y;
}

.maplibregl-canvas-container.maplibregl-touch-drag-pan,
.maplibregl-canvas-container.maplibregl-touch-drag-pan .maplibregl-canvas {
    touch-action: pinch-zoom;
}

.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan,
.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan .maplibregl-canvas {
    touch-action: none;
}

.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures,
.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures .maplibregl-canvas {
    touch-action: pan-x pan-y;
}

.maplibregl-ctrl-top-left,
.maplibregl-ctrl-top-right,
.maplibregl-ctrl-bottom-left,
.maplibregl-ctrl-bottom-right {
    position: absolute;
    pointer-events: none;
    z-index: 2;
}

.maplibregl-ctrl-top-left {
    top: 0;
    left: 0;
}

.maplibregl-ctrl-top-right {
     top: 0;
     right: 0;
    }

.maplibregl-ctrl-bottom-left {
    bottom: 0;
    left: 0;
}

.maplibregl-ctrl-bottom-right {
     right: 0;
     bottom: 0;
}

.maplibregl-ctrl {
    clear: both;
    pointer-events: auto;

    /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
    transform: translate(0, 0);
}

.maplibregl-ctrl-top-left .maplibregl-ctrl {
    margin: 10px 0 0 10px;
     float: left;
}

.maplibregl-ctrl-top-right .maplibregl-ctrl {
    margin: 10px 10px 0 0;
    float: right;
}

.maplibregl-ctrl-bottom-left .maplibregl-ctrl {
    margin: 0 0 10px 10px;
    float: left;
}

.maplibregl-ctrl-bottom-right .maplibregl-ctrl {
    margin: 0 10px 10px 0;
    float: right;
}

.maplibregl-ctrl-group {
    border-radius: 4px;
    background: #fff;
}

.maplibregl-ctrl-group:not(:empty) {
    box-shadow: 0 0 0 2px rgb(0 0 0 / 10%);
}

@media (forced-colors: active) {
    .maplibregl-ctrl-group:not(:empty) {
        box-shadow: 0 0 0 2px ButtonText;
    }
}

.maplibregl-ctrl-group button {
    width: 29px;
    height: 29px;
    display: block;
    padding: 0;
    outline: none;
    border: 0;
    box-sizing: border-box;
    background-color: transparent;
    cursor: pointer;
}

.maplibregl-ctrl-group button + button {
    border-top: 1px solid #ddd;
}

.maplibregl-ctrl button .maplibregl-ctrl-icon {
    display: block;
    width: 100%;
    height: 100%;
    background-repeat: no-repeat;
    background-position: center center;
}

@media (forced-colors: active) {
    .maplibregl-ctrl-icon {
        background-color: transparent;
    }

    .maplibregl-ctrl-group button + button {
        border-top: 1px solid ButtonText;
    }
}

/* https://bugzilla.mozilla.org/show_bug.cgi?id=140562 */
.maplibregl-ctrl button::-moz-focus-inner {
    border: 0;
    padding: 0;
}

.maplibregl-ctrl-attrib-button:focus,
.maplibregl-ctrl-group button:focus {
    box-shadow: 0 0 2px 2px rgb(0 150 255 / 100%);
}

.maplibregl-ctrl button:disabled {
    cursor: not-allowed;
}

.maplibregl-ctrl button:disabled .maplibregl-ctrl-icon {
    opacity: 0.25;
}

@media (hover: hover) {
    .maplibregl-ctrl button:not(:disabled):hover {
        background-color: rgb(0 0 0/5%);
    }
}

.maplibregl-ctrl button:not(:disabled):active {
    background-color: rgb(0 0 0/5%);
}

.maplibregl-ctrl-group button:focus:focus-visible {
    box-shadow: 0 0 2px 2px rgb(0 150 255 / 100%);
}

.maplibregl-ctrl-group button:focus:not(:focus-visible) {
    box-shadow: none;
}

.maplibregl-ctrl-group button:focus:first-child {
    border-radius: 4px 4px 0 0;
}

.maplibregl-ctrl-group button:focus:last-child {
    border-radius: 0 0 4px 4px;
}

.maplibregl-ctrl-group button:focus:only-child {
    border-radius: inherit;
}

.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon {
    background-image: svg-load("svg/maplibregl-ctrl-zoom-out.svg", fill: #333);
}

.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon {
    background-image: svg-load("svg/maplibregl-ctrl-zoom-in.svg", fill: #333);
}

@media (forced-colors: active) {
    .maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-zoom-out.svg", fill: #fff);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-zoom-in.svg", fill: #fff);
    }
}

@media (forced-colors: active) and (prefers-color-scheme: light) {
    .maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-zoom-out.svg", fill: #000);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-zoom-in.svg", fill: #000);
    }
}

.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon {
    background-image: svg-load("svg/maplibregl-ctrl-fullscreen.svg", fill: #333);
}

.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon {
    background-image: svg-load("svg/maplibregl-ctrl-shrink.svg");
}

@media (forced-colors: active) {
    .maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-fullscreen.svg", fill: #fff);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-shrink.svg", fill: #fff);
    }
}

@media (forced-colors: active) and (prefers-color-scheme: light) {
    .maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-fullscreen.svg", fill: #000);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-shrink.svg", fill: #000);
    }
}

.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon {
    background-image: svg-load("svg/maplibregl-ctrl-compass.svg", fill: #333);
}

@media (forced-colors: active) {
    .maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon {
        @svg-load ctrl-compass-white url("svg/maplibregl-ctrl-compass.svg") {
            fill: #fff;
            #south { fill: #999; }
        }

        background-image: svg-inline(ctrl-compass-white);
    }
}

@media (forced-colors: active) and (prefers-color-scheme: light) {
    .maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-compass.svg", fill: #000);
    }
}

@svg-load ctrl-globe url("svg/maplibregl-ctrl-globe.svg") {
    stroke: #333;
}

@svg-load ctrl-globe-enabled url("svg/maplibregl-ctrl-globe.svg") {
    stroke: #33b5e5;
}

.maplibregl-ctrl button.maplibregl-ctrl-globe .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-globe);
}

.maplibregl-ctrl button.maplibregl-ctrl-globe-enabled .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-globe-enabled);
}

@svg-load ctrl-terrain url("svg/maplibregl-ctrl-terrain.svg") {
    fill: #333;
    
}

@svg-load ctrl-terrain-enabled url("svg/maplibregl-ctrl-terrain.svg") {
    fill: #33b5e5;
    
}

.maplibregl-ctrl button.maplibregl-ctrl-terrain .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-terrain);
}

.maplibregl-ctrl button.maplibregl-ctrl-terrain-enabled .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-terrain-enabled);
}

@svg-load ctrl-geolocate url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #333;
    #stroke { display: none; }
}

@svg-load ctrl-geolocate-white url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #fff;
    #stroke { display: none; }
}

@svg-load ctrl-geolocate-black url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #000;
    #stroke { display: none; }
}

@svg-load ctrl-geolocate-disabled url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #aaa;
    #stroke { fill: #f00; }
}

@svg-load ctrl-geolocate-disabled-white url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #999;
    #stroke { fill: #f00; }
}

@svg-load ctrl-geolocate-disabled-black url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #666;
    #stroke { fill: #f00; }
}

@svg-load ctrl-geolocate-active url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #33b5e5;
    #stroke { display: none; }
}

@svg-load ctrl-geolocate-active-error url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #e58978;
    #stroke { display: none; }
}

@svg-load ctrl-geolocate-background url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #33b5e5;
    #stroke { display: none; }
    #dot { display: none; }
}

@svg-load ctrl-geolocate-background-error url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #e54e33;
    #stroke { display: none; }
    #dot { display: none; }
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-geolocate);
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-geolocate-disabled);
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-geolocate-active);
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-geolocate-active-error);
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-geolocate-background);
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-geolocate-background-error);
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-waiting .maplibregl-ctrl-icon {
    animation: maplibregl-spin 2s infinite linear;
}

@media (forced-colors: active) {
    .maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-white);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-disabled-white);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-active);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-active-error);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-background);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-background-error);
    }
}

@media (forced-colors: active) and (prefers-color-scheme: light) {
    .maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-black);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-disabled-black);
    }
}

@keyframes maplibregl-spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

a.maplibregl-ctrl-logo {
    width: 88px;
    height: 23px;
    margin: 0 0 -4px -4px;
    display: block;
    background-repeat: no-repeat;
    cursor: pointer;
    overflow: hidden;
    background-image: svg-load("svg/maplibregl-ctrl-logo.svg");
}

a.maplibregl-ctrl-logo.maplibregl-compact {
    width: 14px;
}

@media (forced-colors: active) {
    a.maplibregl-ctrl-logo {
        @svg-load ctrl-logo-white url("svg/maplibregl-ctrl-logo.svg") {
            #outline { opacity: 1; }
            #fill { opacity: 1; }
        }

        background-color: transparent;
        background-image: svg-inline(ctrl-logo-white);
    }
}

@media (forced-colors: active) and (prefers-color-scheme: light) {
    a.maplibregl-ctrl-logo {
        @svg-load ctrl-logo-black url("svg/maplibregl-ctrl-logo.svg") {
            #outline { opacity: 1; fill: #fff; stroke: #fff; }
            #fill { opacity: 1; fill: #000; }
        }

        background-image: svg-inline(ctrl-logo-black);
    }
}

.maplibregl-ctrl.maplibregl-ctrl-attrib {
    padding: 0 5px;
    background-color: rgb(255 255 255 / 50%);
    margin: 0;
}

@media screen {
    .maplibregl-ctrl-attrib.maplibregl-compact {
        min-height: 20px;
        padding: 2px 24px 2px 0;
        margin: 10px;
        position: relative;
        background-color: #fff;
        color: #000;
        border-radius: 12px;
        box-sizing: content-box;
    }

    .maplibregl-ctrl-attrib.maplibregl-compact-show {
        padding: 2px 28px 2px 8px;
        visibility: visible;
    }

    .maplibregl-ctrl-top-left > .maplibregl-ctrl-attrib.maplibregl-compact-show,
    .maplibregl-ctrl-bottom-left > .maplibregl-ctrl-attrib.maplibregl-compact-show {
        padding: 2px 8px 2px 28px;
        border-radius: 12px;
    }

    .maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-inner {
        display: none;
    }

    .maplibregl-ctrl-attrib-button {
        display: none;
        cursor: pointer;
        position: absolute;
        background-image: svg-load("svg/maplibregl-ctrl-attrib.svg");
        background-color: rgb(255 255 255 / 50%);
        width: 24px;
        height: 24px;
        box-sizing: border-box;
        border-radius: 12px;
        outline: none;
        top: 0;
        right: 0;
        border: 0;
    }

    .maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button {
        appearance: none;
        list-style: none;
    }

    .maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button::-webkit-details-marker {
        display: none;
    }

    .maplibregl-ctrl-top-left .maplibregl-ctrl-attrib-button,
    .maplibregl-ctrl-bottom-left .maplibregl-ctrl-attrib-button {
        left: 0;
    }

    .maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-button,
    .maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-inner {
        display: block;
    }

    .maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-button {
        background-color: rgb(0 0 0 / 5%);
    }

    .maplibregl-ctrl-bottom-right > .maplibregl-ctrl-attrib.maplibregl-compact::after {
        bottom: 0;
        right: 0;
    }

    .maplibregl-ctrl-top-right > .maplibregl-ctrl-attrib.maplibregl-compact::after {
        top: 0;
        right: 0;
    }

    .maplibregl-ctrl-top-left > .maplibregl-ctrl-attrib.maplibregl-compact::after {
        top: 0;
        left: 0;
    }

    .maplibregl-ctrl-bottom-left > .maplibregl-ctrl-attrib.maplibregl-compact::after {
        bottom: 0;
        left: 0;
    }
}

@media screen and (forced-colors: active) {
    .maplibregl-ctrl-attrib.maplibregl-compact::after {
        background-image: svg-load("svg/maplibregl-ctrl-attrib.svg", fill=#fff);
    }
}

@media screen and (forced-colors: active) and (prefers-color-scheme: light) {
    .maplibregl-ctrl-attrib.maplibregl-compact::after {
        background-image: svg-load("svg/maplibregl-ctrl-attrib.svg");
    }
}

.maplibregl-ctrl-attrib a {
    color: rgb(0 0 0 / 75%);
    text-decoration: none;
}

.maplibregl-ctrl-attrib a:hover {
    color: inherit;
    text-decoration: underline;
}

.maplibregl-attrib-empty {
    display: none;
}

.maplibregl-ctrl-scale {
    background-color: rgb(255 255 255 / 75%);
    font-size: 10px;
    border-width: medium 2px 2px;
    border-style: none solid solid;
    border-color: #333;
    padding: 0 5px;
    color: #333;
    box-sizing: border-box;
}

.maplibregl-popup {
    position: absolute;
    top: 0;
    left: 0;
    display: flex;
    will-change: transform;
    pointer-events: none;
}

.maplibregl-popup-anchor-top,
.maplibregl-popup-anchor-top-left,
.maplibregl-popup-anchor-top-right {
    flex-direction: column;
}

.maplibregl-popup-anchor-bottom,
.maplibregl-popup-anchor-bottom-left,
.maplibregl-popup-anchor-bottom-right {
    flex-direction: column-reverse;
}

.maplibregl-popup-anchor-left {
    flex-direction: row;
}

.maplibregl-popup-anchor-right {
    flex-direction: row-reverse;
}

.maplibregl-popup-tip {
    width: 0;
    height: 0;
    border: 10px solid transparent;
    z-index: 1;
}

.maplibregl-popup-anchor-top .maplibregl-popup-tip {
    align-self: center;
    border-top: none;
    border-bottom-color: #fff;
}

.maplibregl-popup-anchor-top-left .maplibregl-popup-tip {
    align-self: flex-start;
    border-top: none;
    border-left: none;
    border-bottom-color: #fff;
}

.maplibregl-popup-anchor-top-right .maplibregl-popup-tip {
    align-self: flex-end;
    border-top: none;
    border-right: none;
    border-bottom-color: #fff;
}

.maplibregl-popup-anchor-bottom .maplibregl-popup-tip {
    align-self: center;
    border-bottom: none;
    border-top-color: #fff;
}

.maplibregl-popup-anchor-bottom-left .maplibregl-popup-tip {
    align-self: flex-start;
    border-bottom: none;
    border-left: none;
    border-top-color: #fff;
}

.maplibregl-popup-anchor-bottom-right .maplibregl-popup-tip {
    align-self: flex-end;
    border-bottom: none;
    border-right: none;
    border-top-color: #fff;
}

.maplibregl-popup-anchor-left .maplibregl-popup-tip {
    align-self: center;
    border-left: none;
    border-right-color: #fff;
}

.maplibregl-popup-anchor-right .maplibregl-popup-tip {
    align-self: center;
    border-right: none;
    border-left-color: #fff;
}

.maplibregl-popup-close-button {
    position: absolute;
    right: 0;
    top: 0;
    border: 0;
    border-radius: 0 3px 0 0;
    cursor: pointer;
    background-color: transparent;
}

.maplibregl-popup-close-button:hover {
    background-color: rgb(0 0 0 / 5%);
}

.maplibregl-popup-content {
    position: relative;
    background: #fff;
    border-radius: 3px;
    box-shadow: 0 1px 2px rgb(0 0 0 / 10%);
    padding: 15px 10px;
    pointer-events: auto;
}

.maplibregl-popup-anchor-top-left .maplibregl-popup-content {
    border-top-left-radius: 0;
}

.maplibregl-popup-anchor-top-right .maplibregl-popup-content {
    border-top-right-radius: 0;
}

.maplibregl-popup-anchor-bottom-left .maplibregl-popup-content {
    border-bottom-left-radius: 0;
}

.maplibregl-popup-anchor-bottom-right .maplibregl-popup-content {
    border-bottom-right-radius: 0;
}

.maplibregl-popup-track-pointer {
    display: none;
}

.maplibregl-popup-track-pointer * {
    pointer-events: none;
    user-select: none;
}

.maplibregl-map:hover .maplibregl-popup-track-pointer {
    display: flex;
}

.maplibregl-map:active .maplibregl-popup-track-pointer {
    display: none;
}

.maplibregl-marker {
    position: absolute;
    top: 0;
    left: 0;
    will-change: transform;
    transition: opacity 0.2s;
}

.maplibregl-user-location-dot {
    background-color: #1da1f2;
    width: 15px;
    height: 15px;
    border-radius: 50%;
}

.maplibregl-user-location-dot::before {
    background-color: #1da1f2;
    content: "";
    width: 15px;
    height: 15px;
    border-radius: 50%;
    position: absolute;
    animation: maplibregl-user-location-dot-pulse 2s infinite;
}

.maplibregl-user-location-dot::after {
    border-radius: 50%;
    border: 2px solid #fff;
    content: "";
    height: 19px;
    left: -2px;
    position: absolute;
    top: -2px;
    width: 19px;
    box-sizing: border-box;
    box-shadow: 0 0 3px rgb(0 0 0 / 35%);
}

@keyframes maplibregl-user-location-dot-pulse {
    0%   { transform: scale(1); opacity: 1; }
    70%  { transform: scale(3); opacity: 0; }
    100% { transform: scale(1); opacity: 0; }
}

.maplibregl-user-location-dot-stale {
    background-color: #aaa;
}

.maplibregl-user-location-dot-stale::after {
    display: none;
}

.maplibregl-user-location-accuracy-circle {
    background-color: #1da1f233;
    width: 1px;
    height: 1px;
    border-radius: 100%;
}

.maplibregl-crosshair,
.maplibregl-crosshair .maplibregl-interactive,
.maplibregl-crosshair .maplibregl-interactive:active {
    cursor: crosshair;
}

.maplibregl-boxzoom {
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    background: #fff;
    border: 2px dotted #202020;
    opacity: 0.5;
}

.maplibregl-cooperative-gesture-screen {
    background: rgba(0 0 0 / 40%);
    position: absolute;
    inset: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    color: white;
    padding: 1rem;
    font-size: 1.4em;
    line-height: 1.2;
    opacity: 0;
    pointer-events: none;
    transition: opacity 1s ease 1s;
    z-index: 99999;
}

.maplibregl-cooperative-gesture-screen.maplibregl-show {
    opacity: 1;
    transition: opacity 0.05s;
}

.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message {
    display: none;
}

@media (hover: none), (pointer: coarse) {
    .maplibregl-cooperative-gesture-screen .maplibregl-desktop-message {
        display: none;
    }

    .maplibregl-cooperative-gesture-screen .maplibregl-mobile-message {
        display: block;
    }
}

.maplibregl-pseudo-fullscreen {
    position: fixed !important;
    width: 100% !important;
    height: 100% !important;
    top: 0 !important;
    left: 0 !important;
    z-index: 99999;
}
`,Qqe=`.mappedin-annotation-marker {
	--mappedin-annotation-border-radius: 5px;
	--mappedin-annotation-border-width: 2px;
	--mappedin-annotation-background-color: #ffffff;
	--mappedin-annotation-scale: 0.7;

	position: relative;
	box-sizing: border-box;
	border-radius: var(--mappedin-annotation-border-radius);
	border: var(--mappedin-annotation-border-width) solid var(--mappedin-annotation-background-color);

	transform: scale(var(--mappedin-annotation-scale)) translateY(0rem);
	box-shadow: 0px 2px 8px 0px rgba(0, 0, 0, 0.25);

	img {
		position: absolute;
		image-rendering: crisp-edges;
		top: 0px;

		object-fit: contain;
		border-radius: calc(var(--mappedin-annotation-border-radius) - var(--mappedin-annotation-border-width));
	}
}
`;C();function eYe(t){var e,r;if(!(!t.languages||!$C()||!((r=(e=globalThis.navigator)==null?void 0:e.languages)!=null&&r.length)))for(let n=0;n<globalThis.navigator.languages.length;n++){let i=t.languages.find(a=>a.code.toLowerCase()===globalThis.navigator.languages[n].toLowerCase());if(i)return{code:i.code,name:i.name}}}function tYe(t,e){var r,n,i;let a=(r=e?.languageCode)!=null?r:"",o=(n=e?.fallbackToNavigatorLanguage)!=null?n:!0,s=(i=t?.languages)==null?void 0:i.find(u=>u.code.toLowerCase()===a.toLowerCase()),l;if(s)l=s;else if(o==null||o)try{let u=eYe(t);u&&(l=u)}catch(u){Be.error("fallbackToNavigatorLanguage is set, however, there was an error getting the navigator language",u)}return l??t.defaultLanguage}var rYe=[Hqe,Xqe,qqe,Yqe,Jqe,Kqe,Qqe],nYe=!1,iYe=!1;function aYe(){return iYe}var oYe=async t=>{var e,r;let n=nYe,i,a=Vee();a.updateByUserOption(t);let o=lt(ae({prefetchTokens:!0},t),{fallbackToNavigatorLanguage:(e=t.fallbackToNavigatorLanguage)!=null?e:!0}),s=new Zqe([o.mapId],o);if("accessToken"in o&&o.accessToken){i=o.accessToken;let{aud:w,sub:b}=_G(i);(Zje.some(A=>w.includes(A))||b&&b.startsWith("client"))&&(n=!0,a.setEnterprise(n),s.setEnterprise(n))}else if("key"in o&&"secret"in o){if(o.key.startsWith("mipk_"))throw new Error(`Partner API keys detected! 

Partner API keys should not be passed directly to the SDK. See https://developer.mappedin.com/docs/rest-apis/partner for more details.`);o.key.startsWith("mik_")||(n=!0,a.setEnterprise(n),s.setEnterprise(n)),o.baseAuthUri=a.getBaseAuthUri();let w;try{w=await s.getAccessTokenAsync(),i=w?.token}catch(b){throw Be.warn("Get access token failed",b.message),new Error("Get access token failed: "+b.message)}}else throw new Error("Missing key or secret.");o.layoutId!=null&&(n?o.layoutId!=="draft"&&Be.warn('Invalid layoutId! Use "draft" to load draft data or leave unspecified to load live data.'):Be.warn("layoutId is currently unsupported!")),o.baseUri=a.getBaseUri();let l=performance.now(),u,c;if(n){let w=lt(ae({},o),{venue:o.mapId,clientId:o.key,clientSecret:o.secret,version:"1.0.0",perspective:o.viewId,useDraftData:o.layoutId==="draft"}),b=await JUe(w);u=b.compressed,c=b.localePacks}else u=await KUe(o,i);let h=performance.now(),d=await ije(u,o.mvfVersion),p=performance.now();typeof t.onMVFParsed=="function"&&t.onMVFParsed(d);let m=nje(d);if(m.length>0?s.setMapIds(m):s.setMapIds([o.mapId]),o.prefetchTokens)try{await s.readySync()}catch(w){Be.error("Failed to ready token manager!",w)}let y=new DGe(d,{env:a,outdoorViewToken:i,tokenManager:s,enterprise:n,localePacksUrls:c,binaryBundle:u,getMapDataOptions:o}),v=new ZPe(y,{search:t.search});y.Analytics.init(lt(ae({accessToken:i,mapId:o.mapId,key:"key"in o?o.key:void 0,secret:"secret"in o?o.secret:void 0},o.analytics),{baseUri:a.getAnalyticsBaseUri(),context:(r=o.analytics)==null?void 0:r.context})),y.Analytics.sendGetMapDataEvent({parseDuration:p-h,downloadDuration:h-l,viewId:o.viewId});let _=y.findPreferredLanguage({languageCode:o.language,fallbackToNavigatorLanguage:o.fallbackToNavigatorLanguage});if(_)try{await v.changeLanguage(_.code)}catch{}return v},sYe=async()=>!1,lYe=async(t,e,r)=>{var n,i,a,o,s,l,u,c,h,d,p,m,y,v,_,w;let b=performance.now(),A=qje(r,e);A&&Xje(A),((n=A.injectStyles)==null||n)&&Wqe(rYe,{id:"mappedin__styles"});let E=Yje((i=e.outdoorViewToken)!=null?i:""),M=eT(e);(a=A.outdoorView)!=null&&a.style&&M.envControl.updateTileServerBaseUrl((o=A.outdoorView)==null?void 0:o.style);let P=!1,k=!1,D=await sYe();D&&(D.collision||(P=!0),D.maplibre||(k=!0));let O=await PHe(t,{center:[e.mapCenter.longitude,e.mapCenter.latitude],bearing:A.bearing,pitch:A.pitch,zoomLevel:A.zoomLevel,backgroundAlpha:(s=A.style)==null?void 0:s.backgroundAlpha,backgroundColor:(l=A.style)==null?void 0:l.backgroundColor,outdoorView:!k&&(u=A.outdoorView)!=null&&u.token?{headers:{"x-mappedin-tiles-key":(c=A.outdoorView)==null?void 0:c.token},style:e.getEnv().tileServerUri,enabled:!!((h=A.outdoorView)!=null&&h.enabled),lowDpi:(d=A.outdoorView)==null?void 0:d.lowDpi}:void 0,watermark:lt(ae({},A.watermark),{visible:(m=(p=A.watermark)==null?void 0:p.visible)!=null?m:!M.enterpriseMode&&!E.remove_watermark,onClick:void 0}),attribution:A.attribution,antialias:typeof A.antialiasing=="boolean"?A.antialiasing:!!((y=A.antialiasing)!=null&&y.enabled),accessToken:e.outdoorViewToken,occlusionEnabled:!0,transformImageRequest:M.enterpriseMode?void 0:M.transformImageRequest,naturalBearing:e.naturalBearing,imagePlacementOptions:A.imagePlacementOptions,onWebGLContextCreationError:A.onWebGLContextCreationError,onWebGLContextLost:A.onWebGLContextLost,onWebGLContextRestored:A.onWebGLContextRestored,onWebGLRendererError:A.onWebGLRendererError,useStandaloneCamera:(v=A.useStandaloneCamera)!=null?v:!1,useWorkers:!((_=A.disableWorkers)!=null&&_),useCollisionWorker:!P,disableUpdateStateValidation:(w=A.disableUpdateStateValidation)!=null?w:!1}),B=new Vqe(O);return await B.addMap(e,A),M.Analytics.sendMapViewLoadedEvent({firstRenderDuration:performance.now()-b,dimension:B.getDimensions(),collisionWorkerDisabled:P,outdoorsWorkerDisabled:k}),B},uYe=Object.create,bS=Object.defineProperty,cYe=Object.defineProperties,hYe=Object.getOwnPropertyDescriptor,dYe=Object.getOwnPropertyDescriptors,pYe=Object.getOwnPropertyNames,_A=Object.getOwnPropertySymbols,fYe=Object.getPrototypeOf,xB=Object.prototype.hasOwnProperty,zre=Object.prototype.propertyIsEnumerable,A9=(t,e,r)=>e in t?bS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,$c=(t,e)=>{for(var r in e||(e={}))xB.call(e,r)&&A9(t,r,e[r]);if(_A)for(var r of _A(e))zre.call(e,r)&&A9(t,r,e[r]);return t},rP=(t,e)=>cYe(t,dYe(e)),eo=(t,e)=>bS(t,"name",{value:e,configurable:!0}),mYe=(t,e)=>{var r={};for(var n in t)xB.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&_A)for(var n of _A(t))e.indexOf(n)<0&&zre.call(t,n)&&(r[n]=t[n]);return r},gYe=(t,e)=>()=>(t&&(e=t(t=0)),e),yYe=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),vYe=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of pYe(e))!xB.call(t,i)&&i!==r&&bS(t,i,{get:()=>e[i],enumerable:!(n=hYe(e,i))||n.enumerable});return t},Fre=(t,e,r)=>(r=t!=null?uYe(fYe(t)):{},vYe(!t||!t.__esModule?bS(r,"default",{value:t,enumerable:!0}):r,t)),Rre,Ki=gYe(()=>{Rre={env:{NODE_ENV:"production",npm_package_version:"6.3.1"}}}),Lre=yYe((t,e)=>{Ki(),e.exports=eo(function r(n,i){if(n===i)return!0;if(n&&i&&typeof n=="object"&&typeof i=="object"){if(n.constructor!==i.constructor)return!1;var a,o,s;if(Array.isArray(n)){if(a=n.length,a!=i.length)return!1;for(o=a;o--!==0;)if(!r(n[o],i[o]))return!1;return!0}if(n.constructor===RegExp)return n.source===i.source&&n.flags===i.flags;if(n.valueOf!==Object.prototype.valueOf)return n.valueOf()===i.valueOf();if(n.toString!==Object.prototype.toString)return n.toString()===i.toString();if(s=Object.keys(n),a=s.length,a!==Object.keys(i).length)return!1;for(o=a;o--!==0;)if(!Object.prototype.hasOwnProperty.call(i,s[o]))return!1;for(o=a;o--!==0;){var l=s[o];if(!r(n[l],i[l]))return!1}return!0}return n!==n&&i!==i},"equal")});Ki();Ki();var wS=nt.createContext({getCache:eo(()=>{},"getCache"),setCache:eo(()=>{},"setCache")});function Nre({mapData:t,children:e}){let r=nt.useRef(t?{mapData:t,options:{}}:void 0),n=nt.useCallback(()=>r.current,[]),i=nt.useCallback(o=>{r.current=o},[]),a=nt.useMemo(()=>({getCache:n,setCache:i}),[n,i]);return np.createElement(wS.Provider,{value:a},e)}eo(Nre,"MapDataProvider");Ki();var _Ye=Fre(Lre());Ki();var xYe="[MappedinJS]";function $re(t="",{prefix:e=xYe}={}){let r="".concat(e).concat(t?"-".concat(t):""),n=eo((i,a)=>{if(typeof window<"u"&&window.rnDebug){let o=a.map(s=>s instanceof Error&&s.stack?"".concat(s.message,`
`).concat(s.stack):s);window.rnDebug("".concat(t," ").concat(i,": ").concat(o.join(" ")))}},"rnDebug");return{logState:Rre.env.NODE_ENV==="test"?3:0,log(...i){this.logState<=0&&(console.log(r,...i),n("log",i))},warn(...i){this.logState<=1&&(console.warn(r,...i),n("warn",i))},error(...i){this.logState<=2&&(console.error(r,...i),n("error",i))},assert(...i){console.assert(...i)},time(i){console.time(i)},timeEnd(i){console.timeEnd(i)},setLevel(i){0<=i&&i<=3&&(this.logState=i)}}}eo($re,"createLogger");var bYe=$re(),Kw=bYe;Ki();var wYe=Fre(Lre());function ih(t,e){let r=nt.useRef(),n=nt.useRef();return(0,wYe.default)(e,n.current)||(r.current=t(),n.current=e),r.current}eo(ih,"useMemoDeep");function AYe(t){let{getCache:e,setCache:r}=nt.useContext(wS),[n,i]=nt.useState(void 0),[a,o]=nt.useState(!0),[s,l]=nt.useState(void 0),u=nt.useRef(0),c=ih(()=>t&&rP($c({},t),{analytics:$c({context:"reactsdk"},t?.analytics)}),[t]),h=nt.useCallback(d=>{let p=++u.current;o(!0),l(void 0),oYe(d).then(m=>{u.current===p&&i(m)}).catch(m=>{u.current===p&&(Kw.error("Failed to fetch MapData",m),l(m))}).finally(()=>{u.current===p&&o(!1)})},[]);return nt.useEffect(()=>{let d=e?.();if(d!=null&&(c==null||d.mapData.mapId===c.mapId&&(0,_Ye.default)(d.options,c))){i(d.mapData),o(!1),l(void 0);return}if(!c){l(new Error("useMapData requires options if not use within a MapDataProvider or MapView component."));return}h(c)},[h,e,c]),nt.useEffect(()=>{let d=e?.();n!=null&&(d==null||d.mapData.mapId===n.mapId)&&r?.({mapData:n,options:c||{}})},[n,c,e,r]),{mapData:n,isLoading:a,error:s}}eo(AYe,"useMapData");Ki();function SYe(t,e){let{getCache:r}=nt.useContext(wS),n=nt.useCallback(i=>e(i),[e]);nt.useEffect(()=>{var i;let a=(i=r?.())==null?void 0:i.mapData;if(a==null)throw new Error("useMapDataEvent must be used within a MapDataProvider or MapView component.");return a.on(t,n),()=>{a?.off(t,n)}},[r,t,n])}eo(SYe,"useMapDataEvent");Ki();var Zl=nt.createContext({mapView:void 0,extensions:{}}),EYe={width:"100%",height:"100%",position:"relative"},git=nt.forwardRef((t,e)=>{let r=t,{mapData:n,options:i,style:a,fallback:o,children:s}=r,l=mYe(r,["mapData","options","style","fallback","children"]),u=nt.useRef({extensions:{}}).current,[c,h]=nt.useState(!0),[d,p]=nt.useState(!1),m=nt.useRef(null),y=nt.useMemo(()=>n,[n]),v=ih(()=>i,[i]);nt.useImperativeHandle(e,()=>u.mapView);let _=nt.useMemo(()=>({mapView:u.mapView,extensions:u.extensions}),[y,u.mapView,u.extensions]),w=nt.useCallback(A=>{try{let E=Object.keys(A);for(let M of E){let P=A[M];P&&(P.onDeregister(P.instance),delete A[M])}}catch(E){Kw.error("Failed to clean up extensions",E)}return{}},[]),b=nt.useCallback(A=>{var E;let M=A||u.mapView;try{(E=M?.destroy)==null||E.call(M)}catch(P){Kw.error("Failed to destroy MapView",P)}A||(u.extensions=w(u.extensions),u.mapView=void 0,p(!1))},[]);return nt.useEffect(()=>{if(!y||!m.current)return;b();let A=!1;return h(!0),lYe(m.current,y,v).then(E=>{A?b(E):(u.mapView=E,p(!0))}).catch(E=>{Kw.error("Failed to render MapView",E)}).finally(()=>{A||h(!1)}),()=>{A=!0,u.mapView&&b()}},[y,v,b]),np.createElement(Nre,{mapData:y},np.createElement(Zl.Provider,{value:_},np.createElement("div",$c({"data-testid":"mappedin-map",ref:m,style:$c($c({},EYe),a)},l)),c?np.createElement(np.Fragment,null,o):d?s:null))});Ki();Ki();var Ure=class extends Error{constructor(e){super("".concat(e," must be used within a MapView component."))}};eo(Ure,"MapViewNullError");var Td=Ure;function IYe(t,e){let{mapView:r}=nt.useContext(Zl),n=nt.useCallback(i=>e(i),[e]);nt.useEffect(()=>{if(r==null)throw new Td("useMapViewEvent");return r.on(t,n),()=>{r?.off(t,n)}},[r,t,e])}eo(IYe,"useMapViewEvent");Ki();function CYe(t,e){let{extensions:r}=nt.useContext(Zl);if(!(e!=null&&e.onRegister)||!(e!=null&&e.onDeregister))throw new Error("onRegister and onDeregister are required");let n=nt.useCallback(()=>{let a=r[t],o=a?.instance;return o||(o=e.onRegister(),r[t]={instance:o,onDeregister:e.onDeregister}),o},[r,t,e.onRegister]),i=nt.useCallback(()=>{let a=r[t];a&&(a.onDeregister(a.instance),delete r[t])},[r,t,e.onDeregister]);return{register:n,deregister:i}}eo(CYe,"useMapViewExtension");Ki();Ki();function U0(t,e){let r=nt.useRef(!0);nt.useEffect(()=>{if(r.current){r.current=!1;return}return t()},e)}eo(U0,"useUpdateEffect");nt.forwardRef((t,e)=>{let{mapView:r}=nt.useContext(Zl),n=nt.useRef(),i=ih(()=>t.options,[t.options]),[a,o]=nt.useState(!1);return nt.useImperativeHandle(e,()=>n.current,[a]),nt.useEffect(()=>{if(r==null)throw new Td("Path");let s=r.Paths.add(t.coordinate,i);return s.animation.then(()=>{var l;(l=t.onDrawComplete)==null||l.call(t)}),n.current=s,o(!0),()=>{n.current&&r.Paths.remove(n.current),o(!1)}},[r,t.coordinate]),U0(()=>{n.current&&i&&r?.updateState(n.current,i)},[i]),null});Ki();function MYe(t){let{mapView:e}=nt.useContext(Zl),r=ih(()=>t.options,[t.options]);return nt.useEffect(()=>{if(e==null)throw new Td("Navigation");return e.Navigation.draw(t.directions,r).then(()=>{var n;(n=t.onDrawComplete)==null||n.call(t)}),()=>{e.Navigation.clear()}},[e,t.directions,r]),null}eo(MYe,"Navigation");Ki();nt.forwardRef((t,e)=>{let{mapView:r}=nt.useContext(Zl),n=nt.useRef(),i=ih(()=>t.style,[t.style]),[a,o]=nt.useState(!1);return nt.useImperativeHandle(e,()=>n.current,[a]),nt.useEffect(()=>{if(r==null)throw new Error("MapView not initialized");return n.current=r.Shapes.add(t.geometry,t.style,t.floor),o(!0),()=>{r==null||n.current==null||(r.Shapes.remove(n.current),o(!1))}},[r,t.geometry,t.style,t.floor]),U0(()=>{n.current&&i&&r?.updateState(n.current,i)},[i]),null});Ki();nt.forwardRef((t,e)=>{let{mapView:r}=nt.useContext(Zl),n=nt.useRef(),i=ih(()=>t.options,[t.options]),[a,o]=nt.useState(!1);return nt.useImperativeHandle(e,()=>n.current,[a]),nt.useEffect(()=>{if(r==null)throw new Td("Model");return n.current=r.Models.add(t.coordinate,t.url,i),o(!0),()=>{r==null||n.current==null||(r.Models.remove(n.current),o(!1))}},[r,t.url]),U0(()=>{n.current&&r?.updateState(n.current,$c({position:t.coordinate},i))},[t.coordinate,i]),null});Ki();function TYe(){var t;let{mapView:e}=nt.useContext(Zl),{getCache:r}=nt.useContext(wS);if(!e)throw new Td("useMap");return{mapData:((t=r?.())==null?void 0:t.mapData)||e.getMapData(),mapView:e}}eo(TYe,"useMap");Ki();Ki();var FI=[0,4,6,8,10],PYe=eo(()=>{let t=new Array(16).fill(0),e=Math.random()*4294967296;for(let n=0;n<t.length;n++)n>0&&(n&3)===0&&(e=Math.random()*4294967296),t[n]=e>>>((n&3)<<3)&255;let r=t.map(n=>n.toString(16).padStart(2,"0"));return r[6]="4"+r[6][1],r[8]=["8","9","a","b"].includes(r[7][0])?r[7]:"a"+r[7][1],FI.map((n,i)=>r.slice(n,i===FI.length-1?void 0:FI[i+1]).join("")).join("-")},"randomId"),DYe=nt.forwardRef((t,e)=>{let{mapView:r}=nt.useContext(Zl),n=nt.useRef(),[i,a]=nt.useState(!1),o=ih(()=>t.options,[t.options]);return nt.useImperativeHandle(e,()=>n.current,[i]),nt.useEffect(()=>{if(r==null)throw new Td("Marker");return n.current=r.Markers.add(t.target,"",o),a(!0),()=>{r==null||n.current==null||(r.Markers.remove(n.current),a(!1))}},[r,t.target]),U0(()=>{n.current&&o&&r?.updateState(n.current,o)},[o]),r==null||n.current==null?null:une.createPortal(t.children,n.current.contentEl,n.current.id)});nt.forwardRef((t,e)=>{let{mapView:r}=nt.useContext(Zl),n=nt.useRef(PYe()),i=nt.useRef(),[a,o]=nt.useState(!1),s=nt.useRef(t.target);nt.useImperativeHandle(e,()=>i.current,[a]);let l=nt.useCallback(c=>{i.current=c||void 0,o(!!c)},[]);nt.useEffect(()=>{if(r==null)throw new Td("Marker");if(i.current&&i.current.target!==t.target){let{duration:c=300,easing:h="linear"}=t;r.Markers.animateTo(i.current,t.target,{duration:c,easing:h})}return()=>{o(!1)}},[r,t.target]);let u=nt.useMemo(()=>rP($c({},t),{duration:void 0,easing:void 0}),[t.duration,t.easing]);return np.createElement(DYe,rP($c({},u),{key:n.current,target:s.current,ref:l}))});Ki();nt.forwardRef((t,e)=>{let{mapView:r}=nt.useContext(Zl),n=nt.useRef(),[i,a]=nt.useState(!1),o=ih(()=>t.options,[t.options]);return nt.useImperativeHandle(e,()=>n.current,[i]),nt.useEffect(()=>{if(r==null)throw new Td("Label");return n.current=r.Labels.add(t.target,t.text,o),a(!0),()=>{r==null||n.current==null||(r.Labels.remove(n.current),a(!1))}},[r,t.target]),U0(()=>{n.current&&r?.updateState(n.current,$c({text:t.text},o))},[t.text,o]),null});const kYe=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),OYe=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),S9=t=>{const e=OYe(t);return e.charAt(0).toUpperCase()+e.slice(1)},jre=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),BYe=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var zYe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const FYe=nt.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:a,iconNode:o,...s},l)=>nt.createElement("svg",{ref:l,...zYe,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:jre("lucide",i),...!a&&!BYe(s)&&{"aria-hidden":"true"},...s},[...o.map(([u,c])=>nt.createElement(u,c)),...Array.isArray(a)?a:[a]]));const vit=(t,e)=>{const r=nt.forwardRef(({className:n,...i},a)=>nt.createElement(FYe,{ref:a,iconNode:e,className:jre(`lucide-${kYe(S9(t))}`,`lucide-${t}`,n),...i}));return r.displayName=S9(t),r};function E9(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function Vre(...t){return e=>{let r=!1;const n=t.map(i=>{const a=E9(i,e);return!r&&typeof a=="function"&&(r=!0),a});if(r)return()=>{for(let i=0;i<n.length;i++){const a=n[i];typeof a=="function"?a():E9(t[i],null)}}}}function _it(...t){return nt.useCallback(Vre(...t),t)}function Gre(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=Gre(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function Zre(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=Gre(t))&&(n&&(n+=" "),n+=e);return n}const bB="-",RYe=t=>{const e=NYe(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:o=>{const s=o.split(bB);return s[0]===""&&s.length!==1&&s.shift(),Wre(s,e)||LYe(o)},getConflictingClassGroupIds:(o,s)=>{const l=r[o]||[];return s&&n[o]?[...l,...n[o]]:l}}},Wre=(t,e)=>{if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),i=n?Wre(t.slice(1),n):void 0;if(i)return i;if(e.validators.length===0)return;const a=t.join(bB);return e.validators.find(({validator:o})=>o(a))?.classGroupId},I9=/^\[(.+)\]$/,LYe=t=>{if(I9.test(t)){const e=I9.exec(t)[1],r=e?.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},NYe=t=>{const{theme:e,classGroups:r}=t,n={nextPart:new Map,validators:[]};for(const i in r)nP(r[i],n,i,e);return n},nP=(t,e,r,n)=>{t.forEach(i=>{if(typeof i=="string"){const a=i===""?e:C9(e,i);a.classGroupId=r;return}if(typeof i=="function"){if($Ye(i)){nP(i(n),e,r,n);return}e.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([a,o])=>{nP(o,C9(e,a),r,n)})})},C9=(t,e)=>{let r=t;return e.split(bB).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},$Ye=t=>t.isThemeGetter,UYe=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const i=(a,o)=>{r.set(a,o),e++,e>t&&(e=0,n=r,r=new Map)};return{get(a){let o=r.get(a);if(o!==void 0)return o;if((o=n.get(a))!==void 0)return i(a,o),o},set(a,o){r.has(a)?r.set(a,o):i(a,o)}}},iP="!",aP=":",jYe=aP.length,VYe=t=>{const{prefix:e,experimentalParseClassName:r}=t;let n=i=>{const a=[];let o=0,s=0,l=0,u;for(let m=0;m<i.length;m++){let y=i[m];if(o===0&&s===0){if(y===aP){a.push(i.slice(l,m)),l=m+jYe;continue}if(y==="/"){u=m;continue}}y==="["?o++:y==="]"?o--:y==="("?s++:y===")"&&s--}const c=a.length===0?i:i.substring(l),h=GYe(c),d=h!==c,p=u&&u>l?u-l:void 0;return{modifiers:a,hasImportantModifier:d,baseClassName:h,maybePostfixModifierPosition:p}};if(e){const i=e+aP,a=n;n=o=>o.startsWith(i)?a(o.substring(i.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:o,maybePostfixModifierPosition:void 0}}if(r){const i=n;n=a=>r({className:a,parseClassName:i})}return n},GYe=t=>t.endsWith(iP)?t.substring(0,t.length-1):t.startsWith(iP)?t.substring(1):t,ZYe=t=>{const e=Object.fromEntries(t.orderSensitiveModifiers.map(n=>[n,!0]));return n=>{if(n.length<=1)return n;const i=[];let a=[];return n.forEach(o=>{o[0]==="["||e[o]?(i.push(...a.sort(),o),a=[]):a.push(o)}),i.push(...a.sort()),i}},WYe=t=>({cache:UYe(t.cacheSize),parseClassName:VYe(t),sortModifiers:ZYe(t),...RYe(t)}),HYe=/\s+/,XYe=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i,sortModifiers:a}=e,o=[],s=t.trim().split(HYe);let l="";for(let u=s.length-1;u>=0;u-=1){const c=s[u],{isExternal:h,modifiers:d,hasImportantModifier:p,baseClassName:m,maybePostfixModifierPosition:y}=r(c);if(h){l=c+(l.length>0?" "+l:l);continue}let v=!!y,_=n(v?m.substring(0,y):m);if(!_){if(!v){l=c+(l.length>0?" "+l:l);continue}if(_=n(m),!_){l=c+(l.length>0?" "+l:l);continue}v=!1}const w=a(d).join(":"),b=p?w+iP:w,A=b+_;if(o.includes(A))continue;o.push(A);const E=i(_,v);for(let M=0;M<E.length;++M){const P=E[M];o.push(b+P)}l=c+(l.length>0?" "+l:l)}return l};function qYe(){let t=0,e,r,n="";for(;t<arguments.length;)(e=arguments[t++])&&(r=Hre(e))&&(n&&(n+=" "),n+=r);return n}const Hre=t=>{if(typeof t=="string")return t;let e,r="";for(let n=0;n<t.length;n++)t[n]&&(e=Hre(t[n]))&&(r&&(r+=" "),r+=e);return r};function YYe(t,...e){let r,n,i,a=o;function o(l){const u=e.reduce((c,h)=>h(c),t());return r=WYe(u),n=r.cache.get,i=r.cache.set,a=s,s(l)}function s(l){const u=n(l);if(u)return u;const c=XYe(l,r);return i(l,c),c}return function(){return a(qYe.apply(null,arguments))}}const ta=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},Xre=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,qre=/^\((?:(\w[\w-]*):)?(.+)\)$/i,JYe=/^\d+\/\d+$/,KYe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,QYe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,eJe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,tJe=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,rJe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Of=t=>JYe.test(t),Or=t=>!!t&&!Number.isNaN(Number(t)),xh=t=>!!t&&Number.isInteger(Number(t)),RI=t=>t.endsWith("%")&&Or(t.slice(0,-1)),lc=t=>KYe.test(t),nJe=()=>!0,iJe=t=>QYe.test(t)&&!eJe.test(t),Yre=()=>!1,aJe=t=>tJe.test(t),oJe=t=>rJe.test(t),sJe=t=>!Lt(t)&&!Nt(t),lJe=t=>j0(t,Qre,Yre),Lt=t=>Xre.test(t),jd=t=>j0(t,ene,iJe),LI=t=>j0(t,pJe,Or),M9=t=>j0(t,Jre,Yre),uJe=t=>j0(t,Kre,oJe),Pb=t=>j0(t,tne,aJe),Nt=t=>qre.test(t),Ty=t=>V0(t,ene),cJe=t=>V0(t,fJe),T9=t=>V0(t,Jre),hJe=t=>V0(t,Qre),dJe=t=>V0(t,Kre),Db=t=>V0(t,tne,!0),j0=(t,e,r)=>{const n=Xre.exec(t);return n?n[1]?e(n[1]):r(n[2]):!1},V0=(t,e,r=!1)=>{const n=qre.exec(t);return n?n[1]?e(n[1]):r:!1},Jre=t=>t==="position"||t==="percentage",Kre=t=>t==="image"||t==="url",Qre=t=>t==="length"||t==="size"||t==="bg-size",ene=t=>t==="length",pJe=t=>t==="number",fJe=t=>t==="family-name",tne=t=>t==="shadow",mJe=()=>{const t=ta("color"),e=ta("font"),r=ta("text"),n=ta("font-weight"),i=ta("tracking"),a=ta("leading"),o=ta("breakpoint"),s=ta("container"),l=ta("spacing"),u=ta("radius"),c=ta("shadow"),h=ta("inset-shadow"),d=ta("text-shadow"),p=ta("drop-shadow"),m=ta("blur"),y=ta("perspective"),v=ta("aspect"),_=ta("ease"),w=ta("animate"),b=()=>["auto","avoid","all","avoid-page","page","left","right","column"],A=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],E=()=>[...A(),Nt,Lt],M=()=>["auto","hidden","clip","visible","scroll"],P=()=>["auto","contain","none"],k=()=>[Nt,Lt,l],D=()=>[Of,"full","auto",...k()],O=()=>[xh,"none","subgrid",Nt,Lt],B=()=>["auto",{span:["full",xh,Nt,Lt]},xh,Nt,Lt],L=()=>[xh,"auto",Nt,Lt],R=()=>["auto","min","max","fr",Nt,Lt],T=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],N=()=>["start","end","center","stretch","center-safe","end-safe"],$=()=>["auto",...k()],V=()=>[Of,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...k()],G=()=>[t,Nt,Lt],ee=()=>[...A(),T9,M9,{position:[Nt,Lt]}],ie=()=>["no-repeat",{repeat:["","x","y","space","round"]}],me=()=>["auto","cover","contain",hJe,lJe,{size:[Nt,Lt]}],Me=()=>[RI,Ty,jd],Ae=()=>["","none","full",u,Nt,Lt],le=()=>["",Or,Ty,jd],_e=()=>["solid","dashed","dotted","double"],Le=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Se=()=>[Or,RI,T9,M9],Ue=()=>["","none",m,Nt,Lt],Y=()=>["none",Or,Nt,Lt],we=()=>["none",Or,Nt,Lt],q=()=>[Or,Nt,Lt],oe=()=>[Of,"full",...k()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[lc],breakpoint:[lc],color:[nJe],container:[lc],"drop-shadow":[lc],ease:["in","out","in-out"],font:[sJe],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[lc],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[lc],shadow:[lc],spacing:["px",Or],text:[lc],"text-shadow":[lc],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Of,Lt,Nt,v]}],container:["container"],columns:[{columns:[Or,Lt,Nt,s]}],"break-after":[{"break-after":b()}],"break-before":[{"break-before":b()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:E()}],overflow:[{overflow:M()}],"overflow-x":[{"overflow-x":M()}],"overflow-y":[{"overflow-y":M()}],overscroll:[{overscroll:P()}],"overscroll-x":[{"overscroll-x":P()}],"overscroll-y":[{"overscroll-y":P()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:D()}],"inset-x":[{"inset-x":D()}],"inset-y":[{"inset-y":D()}],start:[{start:D()}],end:[{end:D()}],top:[{top:D()}],right:[{right:D()}],bottom:[{bottom:D()}],left:[{left:D()}],visibility:["visible","invisible","collapse"],z:[{z:[xh,"auto",Nt,Lt]}],basis:[{basis:[Of,"full","auto",s,...k()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Or,Of,"auto","initial","none",Lt]}],grow:[{grow:["",Or,Nt,Lt]}],shrink:[{shrink:["",Or,Nt,Lt]}],order:[{order:[xh,"first","last","none",Nt,Lt]}],"grid-cols":[{"grid-cols":O()}],"col-start-end":[{col:B()}],"col-start":[{"col-start":L()}],"col-end":[{"col-end":L()}],"grid-rows":[{"grid-rows":O()}],"row-start-end":[{row:B()}],"row-start":[{"row-start":L()}],"row-end":[{"row-end":L()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":R()}],"auto-rows":[{"auto-rows":R()}],gap:[{gap:k()}],"gap-x":[{"gap-x":k()}],"gap-y":[{"gap-y":k()}],"justify-content":[{justify:[...T(),"normal"]}],"justify-items":[{"justify-items":[...N(),"normal"]}],"justify-self":[{"justify-self":["auto",...N()]}],"align-content":[{content:["normal",...T()]}],"align-items":[{items:[...N(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...N(),{baseline:["","last"]}]}],"place-content":[{"place-content":T()}],"place-items":[{"place-items":[...N(),"baseline"]}],"place-self":[{"place-self":["auto",...N()]}],p:[{p:k()}],px:[{px:k()}],py:[{py:k()}],ps:[{ps:k()}],pe:[{pe:k()}],pt:[{pt:k()}],pr:[{pr:k()}],pb:[{pb:k()}],pl:[{pl:k()}],m:[{m:$()}],mx:[{mx:$()}],my:[{my:$()}],ms:[{ms:$()}],me:[{me:$()}],mt:[{mt:$()}],mr:[{mr:$()}],mb:[{mb:$()}],ml:[{ml:$()}],"space-x":[{"space-x":k()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":k()}],"space-y-reverse":["space-y-reverse"],size:[{size:V()}],w:[{w:[s,"screen",...V()]}],"min-w":[{"min-w":[s,"screen","none",...V()]}],"max-w":[{"max-w":[s,"screen","none","prose",{screen:[o]},...V()]}],h:[{h:["screen","lh",...V()]}],"min-h":[{"min-h":["screen","lh","none",...V()]}],"max-h":[{"max-h":["screen","lh",...V()]}],"font-size":[{text:["base",r,Ty,jd]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,Nt,LI]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",RI,Lt]}],"font-family":[{font:[cJe,Lt,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[i,Nt,Lt]}],"line-clamp":[{"line-clamp":[Or,"none",Nt,LI]}],leading:[{leading:[a,...k()]}],"list-image":[{"list-image":["none",Nt,Lt]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Nt,Lt]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:G()}],"text-color":[{text:G()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[..._e(),"wavy"]}],"text-decoration-thickness":[{decoration:[Or,"from-font","auto",Nt,jd]}],"text-decoration-color":[{decoration:G()}],"underline-offset":[{"underline-offset":[Or,"auto",Nt,Lt]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:k()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Nt,Lt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Nt,Lt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:ee()}],"bg-repeat":[{bg:ie()}],"bg-size":[{bg:me()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},xh,Nt,Lt],radial:["",Nt,Lt],conic:[xh,Nt,Lt]},dJe,uJe]}],"bg-color":[{bg:G()}],"gradient-from-pos":[{from:Me()}],"gradient-via-pos":[{via:Me()}],"gradient-to-pos":[{to:Me()}],"gradient-from":[{from:G()}],"gradient-via":[{via:G()}],"gradient-to":[{to:G()}],rounded:[{rounded:Ae()}],"rounded-s":[{"rounded-s":Ae()}],"rounded-e":[{"rounded-e":Ae()}],"rounded-t":[{"rounded-t":Ae()}],"rounded-r":[{"rounded-r":Ae()}],"rounded-b":[{"rounded-b":Ae()}],"rounded-l":[{"rounded-l":Ae()}],"rounded-ss":[{"rounded-ss":Ae()}],"rounded-se":[{"rounded-se":Ae()}],"rounded-ee":[{"rounded-ee":Ae()}],"rounded-es":[{"rounded-es":Ae()}],"rounded-tl":[{"rounded-tl":Ae()}],"rounded-tr":[{"rounded-tr":Ae()}],"rounded-br":[{"rounded-br":Ae()}],"rounded-bl":[{"rounded-bl":Ae()}],"border-w":[{border:le()}],"border-w-x":[{"border-x":le()}],"border-w-y":[{"border-y":le()}],"border-w-s":[{"border-s":le()}],"border-w-e":[{"border-e":le()}],"border-w-t":[{"border-t":le()}],"border-w-r":[{"border-r":le()}],"border-w-b":[{"border-b":le()}],"border-w-l":[{"border-l":le()}],"divide-x":[{"divide-x":le()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":le()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[..._e(),"hidden","none"]}],"divide-style":[{divide:[..._e(),"hidden","none"]}],"border-color":[{border:G()}],"border-color-x":[{"border-x":G()}],"border-color-y":[{"border-y":G()}],"border-color-s":[{"border-s":G()}],"border-color-e":[{"border-e":G()}],"border-color-t":[{"border-t":G()}],"border-color-r":[{"border-r":G()}],"border-color-b":[{"border-b":G()}],"border-color-l":[{"border-l":G()}],"divide-color":[{divide:G()}],"outline-style":[{outline:[..._e(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Or,Nt,Lt]}],"outline-w":[{outline:["",Or,Ty,jd]}],"outline-color":[{outline:G()}],shadow:[{shadow:["","none",c,Db,Pb]}],"shadow-color":[{shadow:G()}],"inset-shadow":[{"inset-shadow":["none",h,Db,Pb]}],"inset-shadow-color":[{"inset-shadow":G()}],"ring-w":[{ring:le()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:G()}],"ring-offset-w":[{"ring-offset":[Or,jd]}],"ring-offset-color":[{"ring-offset":G()}],"inset-ring-w":[{"inset-ring":le()}],"inset-ring-color":[{"inset-ring":G()}],"text-shadow":[{"text-shadow":["none",d,Db,Pb]}],"text-shadow-color":[{"text-shadow":G()}],opacity:[{opacity:[Or,Nt,Lt]}],"mix-blend":[{"mix-blend":[...Le(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Le()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Or]}],"mask-image-linear-from-pos":[{"mask-linear-from":Se()}],"mask-image-linear-to-pos":[{"mask-linear-to":Se()}],"mask-image-linear-from-color":[{"mask-linear-from":G()}],"mask-image-linear-to-color":[{"mask-linear-to":G()}],"mask-image-t-from-pos":[{"mask-t-from":Se()}],"mask-image-t-to-pos":[{"mask-t-to":Se()}],"mask-image-t-from-color":[{"mask-t-from":G()}],"mask-image-t-to-color":[{"mask-t-to":G()}],"mask-image-r-from-pos":[{"mask-r-from":Se()}],"mask-image-r-to-pos":[{"mask-r-to":Se()}],"mask-image-r-from-color":[{"mask-r-from":G()}],"mask-image-r-to-color":[{"mask-r-to":G()}],"mask-image-b-from-pos":[{"mask-b-from":Se()}],"mask-image-b-to-pos":[{"mask-b-to":Se()}],"mask-image-b-from-color":[{"mask-b-from":G()}],"mask-image-b-to-color":[{"mask-b-to":G()}],"mask-image-l-from-pos":[{"mask-l-from":Se()}],"mask-image-l-to-pos":[{"mask-l-to":Se()}],"mask-image-l-from-color":[{"mask-l-from":G()}],"mask-image-l-to-color":[{"mask-l-to":G()}],"mask-image-x-from-pos":[{"mask-x-from":Se()}],"mask-image-x-to-pos":[{"mask-x-to":Se()}],"mask-image-x-from-color":[{"mask-x-from":G()}],"mask-image-x-to-color":[{"mask-x-to":G()}],"mask-image-y-from-pos":[{"mask-y-from":Se()}],"mask-image-y-to-pos":[{"mask-y-to":Se()}],"mask-image-y-from-color":[{"mask-y-from":G()}],"mask-image-y-to-color":[{"mask-y-to":G()}],"mask-image-radial":[{"mask-radial":[Nt,Lt]}],"mask-image-radial-from-pos":[{"mask-radial-from":Se()}],"mask-image-radial-to-pos":[{"mask-radial-to":Se()}],"mask-image-radial-from-color":[{"mask-radial-from":G()}],"mask-image-radial-to-color":[{"mask-radial-to":G()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":A()}],"mask-image-conic-pos":[{"mask-conic":[Or]}],"mask-image-conic-from-pos":[{"mask-conic-from":Se()}],"mask-image-conic-to-pos":[{"mask-conic-to":Se()}],"mask-image-conic-from-color":[{"mask-conic-from":G()}],"mask-image-conic-to-color":[{"mask-conic-to":G()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:ee()}],"mask-repeat":[{mask:ie()}],"mask-size":[{mask:me()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Nt,Lt]}],filter:[{filter:["","none",Nt,Lt]}],blur:[{blur:Ue()}],brightness:[{brightness:[Or,Nt,Lt]}],contrast:[{contrast:[Or,Nt,Lt]}],"drop-shadow":[{"drop-shadow":["","none",p,Db,Pb]}],"drop-shadow-color":[{"drop-shadow":G()}],grayscale:[{grayscale:["",Or,Nt,Lt]}],"hue-rotate":[{"hue-rotate":[Or,Nt,Lt]}],invert:[{invert:["",Or,Nt,Lt]}],saturate:[{saturate:[Or,Nt,Lt]}],sepia:[{sepia:["",Or,Nt,Lt]}],"backdrop-filter":[{"backdrop-filter":["","none",Nt,Lt]}],"backdrop-blur":[{"backdrop-blur":Ue()}],"backdrop-brightness":[{"backdrop-brightness":[Or,Nt,Lt]}],"backdrop-contrast":[{"backdrop-contrast":[Or,Nt,Lt]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Or,Nt,Lt]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Or,Nt,Lt]}],"backdrop-invert":[{"backdrop-invert":["",Or,Nt,Lt]}],"backdrop-opacity":[{"backdrop-opacity":[Or,Nt,Lt]}],"backdrop-saturate":[{"backdrop-saturate":[Or,Nt,Lt]}],"backdrop-sepia":[{"backdrop-sepia":["",Or,Nt,Lt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":k()}],"border-spacing-x":[{"border-spacing-x":k()}],"border-spacing-y":[{"border-spacing-y":k()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Nt,Lt]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Or,"initial",Nt,Lt]}],ease:[{ease:["linear","initial",_,Nt,Lt]}],delay:[{delay:[Or,Nt,Lt]}],animate:[{animate:["none",w,Nt,Lt]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[y,Nt,Lt]}],"perspective-origin":[{"perspective-origin":E()}],rotate:[{rotate:Y()}],"rotate-x":[{"rotate-x":Y()}],"rotate-y":[{"rotate-y":Y()}],"rotate-z":[{"rotate-z":Y()}],scale:[{scale:we()}],"scale-x":[{"scale-x":we()}],"scale-y":[{"scale-y":we()}],"scale-z":[{"scale-z":we()}],"scale-3d":["scale-3d"],skew:[{skew:q()}],"skew-x":[{"skew-x":q()}],"skew-y":[{"skew-y":q()}],transform:[{transform:[Nt,Lt,"","none","gpu","cpu"]}],"transform-origin":[{origin:E()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:oe()}],"translate-x":[{"translate-x":oe()}],"translate-y":[{"translate-y":oe()}],"translate-z":[{"translate-z":oe()}],"translate-none":["translate-none"],accent:[{accent:G()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:G()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Nt,Lt]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":k()}],"scroll-mx":[{"scroll-mx":k()}],"scroll-my":[{"scroll-my":k()}],"scroll-ms":[{"scroll-ms":k()}],"scroll-me":[{"scroll-me":k()}],"scroll-mt":[{"scroll-mt":k()}],"scroll-mr":[{"scroll-mr":k()}],"scroll-mb":[{"scroll-mb":k()}],"scroll-ml":[{"scroll-ml":k()}],"scroll-p":[{"scroll-p":k()}],"scroll-px":[{"scroll-px":k()}],"scroll-py":[{"scroll-py":k()}],"scroll-ps":[{"scroll-ps":k()}],"scroll-pe":[{"scroll-pe":k()}],"scroll-pt":[{"scroll-pt":k()}],"scroll-pr":[{"scroll-pr":k()}],"scroll-pb":[{"scroll-pb":k()}],"scroll-pl":[{"scroll-pl":k()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Nt,Lt]}],fill:[{fill:["none",...G()]}],"stroke-w":[{stroke:[Or,Ty,jd,LI]}],stroke:[{stroke:["none",...G()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},gJe=YYe(mJe);function xit(...t){return gJe(Zre(t))}var yJe=Symbol.for("react.lazy"),xA=lne[" use ".trim().toString()];function vJe(t){return typeof t=="object"&&t!==null&&"then"in t}function rne(t){return t!=null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===yJe&&"_payload"in t&&vJe(t._payload)}function _Je(t){const e=xJe(t),r=nt.forwardRef((n,i)=>{let{children:a,...o}=n;rne(a)&&typeof xA=="function"&&(a=xA(a._payload));const s=nt.Children.toArray(a),l=s.find(wJe);if(l){const u=l.props.children,c=s.map(h=>h===l?nt.Children.count(u)>1?nt.Children.only(null):nt.isValidElement(u)?u.props.children:null:h);return IB.jsx(e,{...o,ref:i,children:nt.isValidElement(u)?nt.cloneElement(u,void 0,c):null})}return IB.jsx(e,{...o,ref:i,children:a})});return r.displayName=`${t}.Slot`,r}var bit=_Je("Slot");function xJe(t){const e=nt.forwardRef((r,n)=>{let{children:i,...a}=r;if(rne(i)&&typeof xA=="function"&&(i=xA(i._payload)),nt.isValidElement(i)){const o=SJe(i),s=AJe(a,i.props);return i.type!==nt.Fragment&&(s.ref=n?Vre(n,o):o),nt.cloneElement(i,s)}return nt.Children.count(i)>1?nt.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var bJe=Symbol("radix.slottable");function wJe(t){return nt.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===bJe}function AJe(t,e){const r={...e};for(const n in e){const i=t[n],a=e[n];/^on[A-Z]/.test(n)?i&&a?r[n]=(...s)=>{const l=a(...s);return i(...s),l}:i&&(r[n]=i):n==="style"?r[n]={...i,...a}:n==="className"&&(r[n]=[i,a].filter(Boolean).join(" "))}return{...t,...r}}function SJe(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}const P9=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,D9=Zre,wit=(t,e)=>r=>{var n;if(e?.variants==null)return D9(t,r?.class,r?.className);const{variants:i,defaultVariants:a}=e,o=Object.keys(i).map(u=>{const c=r?.[u],h=a?.[u];if(c===null)return null;const d=P9(c)||P9(h);return i[u][d]}),s=r&&Object.entries(r).reduce((u,c)=>{let[h,d]=c;return d===void 0||(u[h]=d),u},{}),l=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((u,c)=>{let{class:h,className:d,...p}=c;return Object.entries(p).every(m=>{let[y,v]=m;return Array.isArray(v)?v.includes({...a,...s}[y]):{...a,...s}[y]===v})?[...u,h,d]:u},[]);return D9(t,o,l,r?.class,r?.className)};export{C as $,AYe as A,Ha as B,Q as C,po as D,ae as E,lt as F,Ti as G,t4 as H,FYe as I,Ir as J,bP as K,Zt as L,S as M,jme as N,K as O,ne as P,ot as Q,Zh as R,bit as S,Za as T,gs as U,TYe as V,$_ as W,Kne as X,IYe as Y,vu as Z,IS as _,xit as a,Br as a$,dp as a0,hp as a1,Ml as a2,YI as a3,AC as a4,V1 as a5,CQe as a6,hQe as a7,VKe as a8,Je as a9,PN as aA,cKe as aB,oQe as aC,nae as aD,aKe as aE,c4 as aF,u4 as aG,CA as aH,an as aI,_s as aJ,IA as aK,qn as aL,jo as aM,tie as aN,FB as aO,mit as aP,Xs as aQ,Rr as aR,wi as aS,X6 as aT,q6 as aU,eg as aV,ps as aW,CJe as aX,jv as aY,bz as aZ,TQe as a_,Op as aa,vQe as ab,bQe as ac,DN as ad,Bm as ae,s7 as af,Yn as ag,TN as ah,DQe as ai,nKe as aj,Ho as ak,fae as al,gd as am,hN as an,l4 as ao,Go as ap,Ja as aq,oKe as ar,Er as as,XQe as at,AP as au,dN as av,xKe as aw,AKe as ax,pp as ay,co as az,Zre as b,_n as b0,yd as b1,N1 as b2,Xae as b3,Hae as b4,nie as b5,Yie as b6,Mr as b7,Oi as b8,vit as c,wit as d,_Je as e,DYe as f,Vre as g,f as h,Lr as i,t0 as j,nVe as k,Nl as l,L1 as m,pt as n,Nr as o,jt as p,git as q,gr as r,Iu as s,uP as t,_it as u,EKe as v,J9 as w,Xn as x,TVe as y,In as z};
