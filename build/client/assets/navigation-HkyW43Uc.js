import{a as p,p as e,w as S}from"./chunk-C37GKA54-Cea7C6Y9.js";import{S as k,a as N,b as C,c as T,f as w,g as b,d as _}from"./select-BEBrtXCQ.js";import{c as v,q as j,i as L}from"./index-DfcVe7ae.js";import{B as M}from"./button-DJetx3yc.js";import{T as E,l as B,b as F}from"./tooltip-DUEL9n3J.js";import{P}from"./PageHeader-Bap54-zD.js";import{A as q}from"./AppContext-BLNfiFX6.js";import"./index-Ctv2K4ti.js";import"./Combination-D9nqUL6g.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M12 2v3",key:"qbqxhf"}],["path",{d:"M18.89 13.24a7 7 0 0 0-8.13-8.13",key:"1v9jrh"}],["path",{d:"M19 12h3",key:"osuazr"}],["path",{d:"M2 12h3",key:"1wrr53"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M7.05 7.05a7 7 0 0 0 9.9 9.9",key:"rc5l2e"}]],D=v("locate-off",z);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}]],V=v("locate",I);function u({location:c,onLocationSelect:r}){const{mapData:o}=j(),s=o.getByType("floor").sort((t,a)=>t.elevation-a.elevation),l=o.getByType("space").filter(({name:t})=>t.length),n=s.map(t=>({floor:t,spaces:l.filter(a=>a.floor.id===t.id).sort((a,i)=>a.name.localeCompare(i.name))})),[m,d]=p.useState(c?.__type==="space"?c.id:" "),[x,f]=p.useState(c?.__type==="coordinate"?c:void 0);function y(t){d(t),f(void 0);const a=l.find(({id:i})=>i===t);a&&r(a)}const[h,g]=p.useState(!1);return L("click",({spaces:t,coordinate:a})=>{h&&(t.length?y(t[0].id):(d(" "),f(a),r(a)),g(!1))}),e.jsxs("div",{className:"flex items-center gap-2 w-full *:min-w-0",children:[e.jsxs(k,{value:m,onValueChange:y,children:[e.jsx(N,{className:"grow",children:e.jsx(C,{placeholder:"Select a space",className:"truncate",children:x?x.latitude+" "+x.longitude:l.find(({id:t})=>t===m)?.name})}),e.jsx(T,{children:n.map(({floor:t,spaces:a})=>e.jsxs(w,{children:[e.jsx(b,{children:t.name}),a.map(i=>e.jsx(_,{value:i.id,children:i.name},i.id))]},t.id))})]}),e.jsxs(E,{children:[e.jsx(B,{asChild:!0,children:e.jsx(M,{size:"icon",variant:"ghost",className:"size-8 shrink-0",onClick:()=>g(!h),children:h?e.jsx(D,{}):e.jsx(V,{})})}),e.jsx(F,{side:"right",children:"Select on map"})]})]})}const U=S(function(){const{mapData:r,mapView:o}=j(),{navigationFrom:s,setNavigationFrom:l,navigationTo:n,setNavigationTo:m}=p.useContext(q);return p.useEffect(()=>{if(s&&n){const d=r.getDirections(s,n);if(!d)return;o.Navigation.clear(),o.Navigation.draw(d)}},[s,n,r,o.Navigation]),e.jsxs(e.Fragment,{children:[e.jsx(P,{title:"Navigation"}),e.jsxs("div",{className:"space-y-2 py-2",children:[e.jsx(u,{location:s,onLocationSelect:l}),e.jsx(u,{location:n,onLocationSelect:m})]})]})});export{U as default};
