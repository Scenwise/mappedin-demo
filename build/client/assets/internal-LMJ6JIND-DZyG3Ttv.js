import{O as mt,M as Ie,P as rr,N as nr,Q as sr,o as L,L as or,h as ar,n as Ae,i as T,J as lr,j as ur,k as cr,l as hr,m as dr,y as fr,F as Oe,E as F,$ as qe}from"./index-CTgVHcLT.js";import"./chunk-UIGDSWPH-74DChMva.js";import"./index-Boai_r5o.js";var pr=lr((s,t)=>{qe();var i=200,n="__lodash_hash_undefined__",a=800,l=16,u=9007199254740991,c="[object Arguments]",h="[object Array]",d="[object AsyncFunction]",f="[object Boolean]",g="[object Date]",m="[object Error]",v="[object Function]",I="[object GeneratorFunction]",z="[object Map]",y="[object Number]",O="[object Null]",k="[object Object]",U="[object Proxy]",Q="[object RegExp]",N="[object Set]",V="[object String]",W="[object Undefined]",Ot="[object WeakMap]",kt="[object ArrayBuffer]",Ct="[object DataView]",Mt="[object Float32Array]",Tt="[object Float64Array]",Lt="[object Int8Array]",Vt="[object Int16Array]",Dt="[object Int32Array]",Et="[object Uint8Array]",Bt="[object Uint8ClampedArray]",Wt="[object Uint16Array]",Rt="[object Uint32Array]",qt=/[\\^$.*+?()[\]{}|]/g,Nt=/^\[object .+?Constructor\]$/,Pt=/^(?:0|[1-9]\d*)$/,x={};x[Mt]=x[Tt]=x[Lt]=x[Vt]=x[Dt]=x[Et]=x[Bt]=x[Wt]=x[Rt]=!0,x[c]=x[h]=x[kt]=x[f]=x[Ct]=x[g]=x[m]=x[v]=x[z]=x[y]=x[k]=x[Q]=x[N]=x[V]=x[Ot]=!1;var $e=typeof global=="object"&&global&&global.Object===Object&&global,$t=typeof self=="object"&&self&&self.Object===Object&&self,G=$e||$t||Function("return this")(),Je=typeof s=="object"&&s&&!s.nodeType&&s,Y=Je&&typeof t=="object"&&t&&!t.nodeType&&t,Ue=Y&&Y.exports===Je,pe=Ue&&$e.process,Qe=(function(){try{var e=Y&&Y.require&&Y.require("util").types;return e||pe&&pe.binding&&pe.binding("util")}catch{}})(),Ge=Qe&&Qe.isTypedArray;function Ye(e,r,o){switch(o.length){case 0:return e.call(r);case 1:return e.call(r,o[0]);case 2:return e.call(r,o[0],o[1]);case 3:return e.call(r,o[0],o[1],o[2])}return e.apply(r,o)}function Jt(e,r){for(var o=-1,p=Array(e);++o<e;)p[o]=r(o);return p}function Ut(e){return function(r){return e(r)}}function Qt(e,r){return e?.[r]}function Gt(e,r){return function(o){return e(r(o))}}var Yt=Array.prototype,Kt=Function.prototype,ee=Object.prototype,me=G["__core-js_shared__"],te=Kt.toString,B=ee.hasOwnProperty,Ke=(function(){var e=/[^.]+$/.exec(me&&me.keys&&me.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""})(),Ze=ee.toString,Zt=te.call(Object),Ht=RegExp("^"+te.call(B).replace(qt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ie=Ue?G.Buffer:void 0,He=G.Symbol,Xe=G.Uint8Array;ie&&ie.allocUnsafe;var et=Gt(Object.getPrototypeOf,Object),tt=Object.create,Xt=ee.propertyIsEnumerable,ei=Yt.splice,R=He?He.toStringTag:void 0,re=(function(){try{var e=ve(Object,"defineProperty");return e({},"",{}),e}catch{}})(),ti=ie?ie.isBuffer:void 0,it=Math.max,ii=Date.now,rt=ve(G,"Map"),K=ve(Object,"create"),ri=(function(){function e(){}return function(r){if(!E(r))return{};if(tt)return tt(r);e.prototype=r;var o=new e;return e.prototype=void 0,o}})();function q(e){var r=-1,o=e==null?0:e.length;for(this.clear();++r<o;){var p=e[r];this.set(p[0],p[1])}}function ni(){this.__data__=K?K(null):{},this.size=0}function si(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}function oi(e){var r=this.__data__;if(K){var o=r[e];return o===n?void 0:o}return B.call(r,e)?r[e]:void 0}function ai(e){var r=this.__data__;return K?r[e]!==void 0:B.call(r,e)}function li(e,r){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=K&&r===void 0?n:r,this}q.prototype.clear=ni,q.prototype.delete=si,q.prototype.get=oi,q.prototype.has=ai,q.prototype.set=li;function D(e){var r=-1,o=e==null?0:e.length;for(this.clear();++r<o;){var p=e[r];this.set(p[0],p[1])}}function ui(){this.__data__=[],this.size=0}function ci(e){var r=this.__data__,o=ne(r,e);if(o<0)return!1;var p=r.length-1;return o==p?r.pop():ei.call(r,o,1),--this.size,!0}function hi(e){var r=this.__data__,o=ne(r,e);return o<0?void 0:r[o][1]}function di(e){return ne(this.__data__,e)>-1}function fi(e,r){var o=this.__data__,p=ne(o,e);return p<0?(++this.size,o.push([e,r])):o[p][1]=r,this}D.prototype.clear=ui,D.prototype.delete=ci,D.prototype.get=hi,D.prototype.has=di,D.prototype.set=fi;function P(e){var r=-1,o=e==null?0:e.length;for(this.clear();++r<o;){var p=e[r];this.set(p[0],p[1])}}function pi(){this.size=0,this.__data__={hash:new q,map:new(rt||D),string:new q}}function mi(e){var r=oe(this,e).delete(e);return this.size-=r?1:0,r}function _i(e){return oe(this,e).get(e)}function gi(e){return oe(this,e).has(e)}function yi(e,r){var o=oe(this,e),p=o.size;return o.set(e,r),this.size+=o.size==p?0:1,this}P.prototype.clear=pi,P.prototype.delete=mi,P.prototype.get=_i,P.prototype.has=gi,P.prototype.set=yi;function $(e){var r=this.__data__=new D(e);this.size=r.size}function vi(){this.__data__=new D,this.size=0}function bi(e){var r=this.__data__,o=r.delete(e);return this.size=r.size,o}function wi(e){return this.__data__.get(e)}function zi(e){return this.__data__.has(e)}function xi(e,r){var o=this.__data__;if(o instanceof D){var p=o.__data__;if(!rt||p.length<i-1)return p.push([e,r]),this.size=++o.size,this;o=this.__data__=new P(p)}return o.set(e,r),this.size=o.size,this}$.prototype.clear=vi,$.prototype.delete=bi,$.prototype.get=wi,$.prototype.has=zi,$.prototype.set=xi;function Si(e,r){var o=ze(e),p=!o&&we(e),_=!o&&!p&&ut(e),b=!o&&!p&&!_&&ht(e),S=o||p||_||b,w=S?Jt(e.length,String):[],j=w.length;for(var M in e)!(S&&(M=="length"||_&&(M=="offset"||M=="parent")||b&&(M=="buffer"||M=="byteLength"||M=="byteOffset")||at(M,j)))&&w.push(M);return w}function _e(e,r,o){(o!==void 0&&!ae(e[r],o)||o===void 0&&!(r in e))&&ge(e,r,o)}function ji(e,r,o){var p=e[r];(!(B.call(e,r)&&ae(p,o))||o===void 0&&!(r in e))&&ge(e,r,o)}function ne(e,r){for(var o=e.length;o--;)if(ae(e[o][0],r))return o;return-1}function ge(e,r,o){r=="__proto__"&&re?re(e,r,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[r]=o}var Fi=Bi();function se(e){return e==null?e===void 0?W:O:R&&R in Object(e)?Wi(e):Ji(e)}function nt(e){return Z(e)&&se(e)==c}function Ii(e){if(!E(e)||Pi(e))return!1;var r=Se(e)?Ht:Nt;return r.test(Yi(e))}function Ai(e){return Z(e)&&ct(e.length)&&!!x[se(e)]}function Oi(e){if(!E(e))return $i(e);var r=lt(e),o=[];for(var p in e)p=="constructor"&&(r||!B.call(e,p))||o.push(p);return o}function ye(e,r,o,p,_){e!==r&&Fi(r,function(b,S){if(_||(_=new $),E(b))ki(e,r,S,o,ye,p,_);else{var w=p?p(be(e,S),b,S+"",e,r,_):void 0;w===void 0&&(w=b),_e(e,S,w)}},dt)}function ki(e,r,o,p,_,b,S){var w=be(e,o),j=be(r,o),M=S.get(j);if(M){_e(e,o,M);return}var C=b?b(w,j,o+"",e,r,S):void 0,H=C===void 0;if(H){var je=ze(j),Fe=!je&&ut(j),pt=!je&&!Fe&&ht(j);C=j,je||Fe||pt?ze(w)?C=w:Ki(w)?C=Vi(w):Fe?(H=!1,C=Mi(j)):pt?(H=!1,C=Li(j)):C=[]:Zi(j)||we(j)?(C=w,we(w)?C=Hi(w):(!E(w)||Se(w))&&(C=Ri(j))):H=!1}H&&(S.set(j,C),_(C,j,p,b,S),S.delete(j)),_e(e,o,C)}function st(e,r){return Qi(Ui(e,r,ft),e+"")}var Ci=re?function(e,r){return re(e,"toString",{configurable:!0,enumerable:!1,value:tr(r),writable:!0})}:ft;function Mi(e,r){return e.slice()}function Ti(e){var r=new e.constructor(e.byteLength);return new Xe(r).set(new Xe(e)),r}function Li(e,r){var o=Ti(e.buffer);return new e.constructor(o,e.byteOffset,e.length)}function Vi(e,r){var o=-1,p=e.length;for(r||(r=Array(p));++o<p;)r[o]=e[o];return r}function Di(e,r,o,p){var _=!o;o||(o={});for(var b=-1,S=r.length;++b<S;){var w=r[b],j=void 0;j===void 0&&(j=e[w]),_?ge(o,w,j):ji(o,w,j)}return o}function Ei(e){return st(function(r,o){var p=-1,_=o.length,b=_>1?o[_-1]:void 0,S=_>2?o[2]:void 0;for(b=e.length>3&&typeof b=="function"?(_--,b):void 0,S&&qi(o[0],o[1],S)&&(b=_<3?void 0:b,_=1),r=Object(r);++p<_;){var w=o[p];w&&e(r,w,p,b)}return r})}function Bi(e){return function(r,o,p){for(var _=-1,b=Object(r),S=p(r),w=S.length;w--;){var j=S[++_];if(o(b[j],j,b)===!1)break}return r}}function ot(e,r,o,p,_,b){return E(e)&&E(r)&&(b.set(r,e),ye(e,r,void 0,ot,b),b.delete(r)),e}function oe(e,r){var o=e.__data__;return Ni(r)?o[typeof r=="string"?"string":"hash"]:o.map}function ve(e,r){var o=Qt(e,r);return Ii(o)?o:void 0}function Wi(e){var r=B.call(e,R),o=e[R];try{e[R]=void 0;var p=!0}catch{}var _=Ze.call(e);return p&&(r?e[R]=o:delete e[R]),_}function Ri(e){return typeof e.constructor=="function"&&!lt(e)?ri(et(e)):{}}function at(e,r){var o=typeof e;return r=r??u,!!r&&(o=="number"||o!="symbol"&&Pt.test(e))&&e>-1&&e%1==0&&e<r}function qi(e,r,o){if(!E(o))return!1;var p=typeof r;return(p=="number"?xe(o)&&at(r,o.length):p=="string"&&r in o)?ae(o[r],e):!1}function Ni(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}function Pi(e){return!!Ke&&Ke in e}function lt(e){var r=e&&e.constructor,o=typeof r=="function"&&r.prototype||ee;return e===o}function $i(e){var r=[];if(e!=null)for(var o in Object(e))r.push(o);return r}function Ji(e){return Ze.call(e)}function Ui(e,r,o){return r=it(r===void 0?e.length-1:r,0),function(){for(var p=arguments,_=-1,b=it(p.length-r,0),S=Array(b);++_<b;)S[_]=p[r+_];_=-1;for(var w=Array(r+1);++_<r;)w[_]=p[_];return w[r]=o(S),Ye(e,this,w)}}function be(e,r){if(!(r==="constructor"&&typeof e[r]=="function")&&r!="__proto__")return e[r]}var Qi=Gi(Ci);function Gi(e){var r=0,o=0;return function(){var p=ii(),_=l-(p-o);if(o=p,_>0){if(++r>=a)return arguments[0]}else r=0;return e.apply(void 0,arguments)}}function Yi(e){if(e!=null){try{return te.call(e)}catch{}try{return e+""}catch{}}return""}function ae(e,r){return e===r||e!==e&&r!==r}var we=nt((function(){return arguments})())?nt:function(e){return Z(e)&&B.call(e,"callee")&&!Xt.call(e,"callee")},ze=Array.isArray;function xe(e){return e!=null&&ct(e.length)&&!Se(e)}function Ki(e){return Z(e)&&xe(e)}var ut=ti||ir;function Se(e){if(!E(e))return!1;var r=se(e);return r==v||r==I||r==d||r==U}function ct(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=u}function E(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}function Z(e){return e!=null&&typeof e=="object"}function Zi(e){if(!Z(e)||se(e)!=k)return!1;var r=et(e);if(r===null)return!0;var o=B.call(r,"constructor")&&r.constructor;return typeof o=="function"&&o instanceof o&&te.call(o)==Zt}var ht=Ge?Ut(Ge):Ai;function Hi(e){return Di(e,dt(e))}var Xi=st(function(e){return e.push(void 0,ot),Ye(er,void 0,e)});function dt(e){return xe(e)?Si(e):Oi(e)}var er=Ei(function(e,r,o,p){ye(e,r,o,p)});function tr(e){return function(){return e}}function ft(e){return e}function ir(){return!1}t.exports=Xi});qe();qe();var mr="ENTRIES",wt="KEYS",zt="VALUES",A="",ke=class{constructor(s,t){let i=s._tree,n=Array.from(i.keys());this.set=s,this._type=t,this._path=n.length>0?[{node:i,keys:n}]:[]}next(){let s=this.dive();return this.backtrack(),s}dive(){if(this._path.length===0)return{done:!0,value:void 0};let{node:s,keys:t}=J(this._path);if(J(t)===A)return{done:!1,value:this.result()};let i=s.get(J(t));return this._path.push({node:i,keys:Array.from(i.keys())}),this.dive()}backtrack(){if(this._path.length===0)return;let s=J(this._path).keys;s.pop(),!(s.length>0)&&(this._path.pop(),this.backtrack())}key(){return this.set._prefix+this._path.map(({keys:s})=>J(s)).filter(s=>s!==A).join("")}value(){return J(this._path).node.get(A)}result(){switch(this._type){case zt:return this.value();case wt:return this.key();default:return[this.key(),this.value()]}}[Symbol.iterator](){return this}},J=s=>s[s.length-1],_r=(s,t,i)=>{let n=new Map;if(t===void 0)return n;let a=t.length+1,l=a+i,u=new Uint8Array(l*a).fill(i+1);for(let c=0;c<a;++c)u[c]=c;for(let c=1;c<l;++c)u[c*a]=c;return xt(s,t,i,n,u,1,a,""),n},xt=(s,t,i,n,a,l,u,c)=>{let h=l*u;e:for(let d of s.keys())if(d===A){let f=a[h-1];f<=i&&n.set(c,[s.get(d),f])}else{let f=l;for(let g=0;g<d.length;++g,++f){let m=d[g],v=u*f,I=v-u,z=a[v],y=Math.max(0,f-i-1),O=Math.min(u-1,f+i);for(let k=y;k<O;++k){let U=m!==t[k],Q=a[I+k]+ +U,N=a[I+k+1]+1,V=a[v+k]+1,W=a[v+k+1]=Math.min(Q,N,V);W<z&&(z=W)}if(z>i)continue e}xt(s.get(d),t,i,n,a,f,u,c+d)}},Ce=class X{constructor(t=new Map,i=""){this._size=void 0,this._tree=t,this._prefix=i}atPrefix(t){if(!t.startsWith(this._prefix))throw new Error("Mismatched prefix");let[i,n]=fe(this._tree,t.slice(this._prefix.length));if(i===void 0){let[a,l]=Ne(n);for(let u of a.keys())if(u!==A&&u.startsWith(l)){let c=new Map;return c.set(u.slice(l.length),a.get(u)),new X(c,t)}}return new X(i,t)}clear(){this._size=void 0,this._tree.clear()}delete(t){return this._size=void 0,gr(this._tree,t)}entries(){return new ke(this,mr)}forEach(t){for(let[i,n]of this)t(i,n,this)}fuzzyGet(t,i){return _r(this._tree,t,i)}get(t){let i=Ee(this._tree,t);return i!==void 0?i.get(A):void 0}has(t){let i=Ee(this._tree,t);return i!==void 0&&i.has(A)}keys(){return new ke(this,wt)}set(t,i){if(typeof t!="string")throw new Error("key must be a string");return this._size=void 0,Me(this._tree,t).set(A,i),this}get size(){if(this._size)return this._size;this._size=0;let t=this.entries();for(;!t.next().done;)this._size+=1;return this._size}update(t,i){if(typeof t!="string")throw new Error("key must be a string");this._size=void 0;let n=Me(this._tree,t);return n.set(A,i(n.get(A))),this}fetch(t,i){if(typeof t!="string")throw new Error("key must be a string");this._size=void 0;let n=Me(this._tree,t),a=n.get(A);return a===void 0&&n.set(A,a=i()),a}values(){return new ke(this,zt)}[Symbol.iterator](){return this.entries()}static from(t){let i=new X;for(let[n,a]of t)i.set(n,a);return i}static fromObject(t){return X.from(Object.entries(t))}},fe=(s,t,i=[])=>{if(t.length===0||s==null)return[s,i];for(let n of s.keys())if(n!==A&&t.startsWith(n))return i.push([s,n]),fe(s.get(n),t.slice(n.length),i);return i.push([s,t]),fe(void 0,"",i)},Ee=(s,t)=>{if(t.length===0||s==null)return s;for(let i of s.keys())if(i!==A&&t.startsWith(i))return Ee(s.get(i),t.slice(i.length))},Me=(s,t)=>{let i=t.length;e:for(let n=0;s&&n<i;){for(let l of s.keys())if(l!==A&&t[n]===l[0]){let u=Math.min(i-n,l.length),c=1;for(;c<u&&t[n+c]===l[c];)++c;let h=s.get(l);if(c===l.length)s=h;else{let d=new Map;d.set(l.slice(c),h),s.set(t.slice(n,n+c),d),s.delete(l),s=d}n+=c;continue e}let a=new Map;return s.set(t.slice(n),a),a}return s},gr=(s,t)=>{let[i,n]=fe(s,t);if(i!==void 0){if(i.delete(A),i.size===0)St(n);else if(i.size===1){let[a,l]=i.entries().next().value;jt(n,a,l)}}},St=s=>{if(s.length===0)return;let[t,i]=Ne(s);if(t.delete(i),t.size===0)St(s.slice(0,-1));else if(t.size===1){let[n,a]=t.entries().next().value;n!==A&&jt(s.slice(0,-1),n,a)}},jt=(s,t,i)=>{if(s.length===0)return;let[n,a]=Ne(s);n.set(a+t,i),n.delete(a)},Ne=s=>s[s.length-1],Pe="or",Ft="and",yr="and_not",ce=class he{constructor(t){if(t?.fields==null)throw new Error('MiniSearch: option "fields" must be provided');let i=t.autoVacuum==null||t.autoVacuum===!0?Ve:t.autoVacuum;this._options=Oe(F(F({},Le),t),{autoVacuum:i,searchOptions:F(F({},_t),t.searchOptions||{}),autoSuggestOptions:F(F({},xr),t.autoSuggestOptions||{})}),this._index=new Ce,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldIds={},this._fieldLength=new Map,this._avgFieldLength=[],this._nextId=0,this._storedFields=new Map,this._dirtCount=0,this._currentVacuum=null,this._enqueuedVacuum=null,this._enqueuedVacuumConditions=We,this.addFields(this._options.fields)}add(t){let{extractField:i,stringifyField:n,tokenize:a,processTerm:l,fields:u,idField:c}=this._options,h=i(t,c);if(h==null)throw new Error('MiniSearch: document does not have ID field "'.concat(c,'"'));if(this._idToShortId.has(h))throw new Error("MiniSearch: duplicate ID ".concat(h));let d=this.addDocumentId(h);this.saveStoredFields(d,t);for(let f of u){let g=i(t,f);if(g==null)continue;let m=a(n(g,f),f),v=this._fieldIds[f],I=new Set(m).size;this.addFieldLength(d,v,this._documentCount-1,I);for(let z of m){let y=l(z,f);if(Array.isArray(y))for(let O of y)this.addTerm(v,d,O);else y&&this.addTerm(v,d,y)}}}addAll(t){for(let i of t)this.add(i)}addAllAsync(t,i={}){let{chunkSize:n=10}=i,a={chunk:[],promise:Promise.resolve()},{chunk:l,promise:u}=t.reduce(({chunk:c,promise:h},d,f)=>(c.push(d),(f+1)%n===0?{chunk:[],promise:h.then(()=>new Promise(g=>setTimeout(g,0))).then(()=>this.addAll(c))}:{chunk:c,promise:h}),a);return u.then(()=>this.addAll(l))}remove(t){let{tokenize:i,processTerm:n,extractField:a,stringifyField:l,fields:u,idField:c}=this._options,h=a(t,c);if(h==null)throw new Error('MiniSearch: document does not have ID field "'.concat(c,'"'));let d=this._idToShortId.get(h);if(d==null)throw new Error("MiniSearch: cannot remove document with ID ".concat(h,": it is not in the index"));for(let f of u){let g=a(t,f);if(g==null)continue;let m=i(l(g,f),f),v=this._fieldIds[f],I=new Set(m).size;this.removeFieldLength(d,v,this._documentCount,I);for(let z of m){let y=n(z,f);if(Array.isArray(y))for(let O of y)this.removeTerm(v,d,O);else y&&this.removeTerm(v,d,y)}}this._storedFields.delete(d),this._documentIds.delete(d),this._idToShortId.delete(h),this._fieldLength.delete(d),this._documentCount-=1}removeAll(t){if(t)for(let i of t)this.remove(i);else{if(arguments.length>0)throw new Error("Expected documents to be present. Omit the argument to remove all documents.");this._index=new Ce,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldLength=new Map,this._avgFieldLength=[],this._storedFields=new Map,this._nextId=0}}discard(t){let i=this._idToShortId.get(t);if(i==null)throw new Error("MiniSearch: cannot discard document with ID ".concat(t,": it is not in the index"));this._idToShortId.delete(t),this._documentIds.delete(i),this._storedFields.delete(i),(this._fieldLength.get(i)||[]).forEach((n,a)=>{this.removeFieldLength(i,a,this._documentCount,n)}),this._fieldLength.delete(i),this._documentCount-=1,this._dirtCount+=1,this.maybeAutoVacuum()}maybeAutoVacuum(){if(this._options.autoVacuum===!1)return;let{minDirtFactor:t,minDirtCount:i,batchSize:n,batchWait:a}=this._options.autoVacuum;this.conditionalVacuum({batchSize:n,batchWait:a},{minDirtCount:i,minDirtFactor:t})}discardAll(t){let i=this._options.autoVacuum;try{this._options.autoVacuum=!1;for(let n of t)this.discard(n)}finally{this._options.autoVacuum=i}this.maybeAutoVacuum()}replace(t){let{idField:i,extractField:n}=this._options,a=n(t,i);this.discard(a),this.add(t)}vacuum(t={}){return this.conditionalVacuum(t)}conditionalVacuum(t,i){return this._currentVacuum?(this._enqueuedVacuumConditions=this._enqueuedVacuumConditions&&i,this._enqueuedVacuum!=null?this._enqueuedVacuum:(this._enqueuedVacuum=this._currentVacuum.then(()=>{let n=this._enqueuedVacuumConditions;return this._enqueuedVacuumConditions=We,this.performVacuuming(t,n)}),this._enqueuedVacuum)):this.vacuumConditionsMet(i)===!1?Promise.resolve():(this._currentVacuum=this.performVacuuming(t),this._currentVacuum)}async performVacuuming(t,i){let n=this._dirtCount;if(this.vacuumConditionsMet(i)){let a=t.batchSize||Be.batchSize,l=t.batchWait||Be.batchWait,u=1;for(let[c,h]of this._index){for(let[d,f]of h)for(let[g]of f)this._documentIds.has(g)||(f.size<=1?h.delete(d):f.delete(g));this._index.get(c).size===0&&this._index.delete(c),u%a===0&&await new Promise(d=>setTimeout(d,l)),u+=1}this._dirtCount-=n}await null,this._currentVacuum=this._enqueuedVacuum,this._enqueuedVacuum=null}vacuumConditionsMet(t){if(t==null)return!0;let{minDirtCount:i,minDirtFactor:n}=t;return i=i||Ve.minDirtCount,n=n||Ve.minDirtFactor,this.dirtCount>=i&&this.dirtFactor>=n}get isVacuuming(){return this._currentVacuum!=null}get dirtCount(){return this._dirtCount}get dirtFactor(){return this._dirtCount/(1+this._documentCount+this._dirtCount)}has(t){return this._idToShortId.has(t)}getStoredFields(t){let i=this._idToShortId.get(t);if(i!=null)return this._storedFields.get(i)}search(t,i={}){let{searchOptions:n}=this._options,a=F(F({},n),i),l=this.executeQuery(t,i),u=[];for(let[c,{score:h,terms:d,match:f}]of l){let g=d.length||1,m={id:this._documentIds.get(c),score:h*g,terms:Object.keys(f),queryTerms:d,match:f};Object.assign(m,this._storedFields.get(c)),(a.filter==null||a.filter(m))&&u.push(m)}return t===he.wildcard&&a.boostDocument==null||u.sort(yt),u}autoSuggest(t,i={}){i=F(F({},this._options.autoSuggestOptions),i);let n=new Map;for(let{score:l,terms:u}of this.search(t,i)){let c=u.join(" "),h=n.get(c);h!=null?(h.score+=l,h.count+=1):n.set(c,{score:l,terms:u,count:1})}let a=[];for(let[l,{score:u,terms:c,count:h}]of n)a.push({suggestion:l,terms:c,score:u/h});return a.sort(yt),a}get documentCount(){return this._documentCount}get termCount(){return this._index.size}static loadJSON(t,i){if(i==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return this.loadJS(JSON.parse(t),i)}static async loadJSONAsync(t,i){if(i==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return this.loadJSAsync(JSON.parse(t),i)}static getDefault(t){if(Le.hasOwnProperty(t))return Te(Le,t);throw new Error('MiniSearch: unknown option "'.concat(t,'"'))}static loadJS(t,i){let{index:n,documentIds:a,fieldLength:l,storedFields:u,serializationVersion:c}=t,h=this.instantiateMiniSearch(t,i);h._documentIds=le(a),h._fieldLength=le(l),h._storedFields=le(u);for(let[d,f]of h._documentIds)h._idToShortId.set(f,d);for(let[d,f]of n){let g=new Map;for(let m of Object.keys(f)){let v=f[m];c===1&&(v=v.ds),g.set(parseInt(m,10),le(v))}h._index.set(d,g)}return h}static async loadJSAsync(t,i){let{index:n,documentIds:a,fieldLength:l,storedFields:u,serializationVersion:c}=t,h=this.instantiateMiniSearch(t,i);h._documentIds=await ue(a),h._fieldLength=await ue(l),h._storedFields=await ue(u);for(let[f,g]of h._documentIds)h._idToShortId.set(g,f);let d=0;for(let[f,g]of n){let m=new Map;for(let v of Object.keys(g)){let I=g[v];c===1&&(I=I.ds),m.set(parseInt(v,10),await ue(I))}++d%1e3===0&&await It(0),h._index.set(f,m)}return h}static instantiateMiniSearch(t,i){let{documentCount:n,nextId:a,fieldIds:l,averageFieldLength:u,dirtCount:c,serializationVersion:h}=t;if(h!==1&&h!==2)throw new Error("MiniSearch: cannot deserialize an index created with an incompatible version");let d=new he(i);return d._documentCount=n,d._nextId=a,d._idToShortId=new Map,d._fieldIds=l,d._avgFieldLength=u,d._dirtCount=c||0,d._index=new Ce,d}executeQuery(t,i={}){if(t===he.wildcard)return this.executeWildcardQuery(i);if(typeof t!="string"){let f=Oe(F(F({},i),t),{queries:void 0}),g=t.queries.map(m=>this.executeQuery(m,f));return this.combineResults(g,f.combineWith)}let{tokenize:n,processTerm:a,searchOptions:l}=this._options,u=F(F({tokenize:n,processTerm:a},l),i),{tokenize:c,processTerm:h}=u,d=c(t).flatMap(f=>h(f)).filter(f=>!!f).map(zr(u)).map(f=>this.executeQuerySpec(f,u));return this.combineResults(d,u.combineWith)}executeQuerySpec(t,i){let n=F(F({},this._options.searchOptions),i),a=(n.fields||this._options.fields).reduce((z,y)=>Oe(F({},z),{[y]:Te(n.boost,y)||1}),{}),{boostDocument:l,weights:u,maxFuzzy:c,bm25:h}=n,{fuzzy:d,prefix:f}=F(F({},_t.weights),u),g=this._index.get(t.term),m=this.termResults(t.term,t.term,1,t.termBoost,g,a,l,h),v,I;if(t.prefix&&(v=this._index.atPrefix(t.term)),t.fuzzy){let z=t.fuzzy===!0?.2:t.fuzzy,y=z<1?Math.min(c,Math.round(t.term.length*z)):z;y&&(I=this._index.fuzzyGet(t.term,y))}if(v)for(let[z,y]of v){let O=z.length-t.term.length;if(!O)continue;I?.delete(z);let k=f*z.length/(z.length+.3*O);this.termResults(t.term,z,k,t.termBoost,y,a,l,h,m)}if(I)for(let z of I.keys()){let[y,O]=I.get(z);if(!O)continue;let k=d*z.length/(z.length+O);this.termResults(t.term,z,k,t.termBoost,y,a,l,h,m)}return m}executeWildcardQuery(t){let i=new Map,n=F(F({},this._options.searchOptions),t);for(let[a,l]of this._documentIds){let u=n.boostDocument?n.boostDocument(l,"",this._storedFields.get(a)):1;i.set(a,{score:u,terms:[],match:{}})}return i}combineResults(t,i=Pe){if(t.length===0)return new Map;let n=i.toLowerCase(),a=vr[n];if(!a)throw new Error("Invalid combination operator: ".concat(i));return t.reduce(a)||new Map}toJSON(){let t=[];for(let[i,n]of this._index){let a={};for(let[l,u]of n)a[l]=Object.fromEntries(u);t.push([i,a])}return{documentCount:this._documentCount,nextId:this._nextId,documentIds:Object.fromEntries(this._documentIds),fieldIds:this._fieldIds,fieldLength:Object.fromEntries(this._fieldLength),averageFieldLength:this._avgFieldLength,storedFields:Object.fromEntries(this._storedFields),dirtCount:this._dirtCount,index:t,serializationVersion:2}}termResults(t,i,n,a,l,u,c,h,d=new Map){if(l==null)return d;for(let f of Object.keys(u)){let g=u[f],m=this._fieldIds[f],v=l.get(m);if(v==null)continue;let I=v.size,z=this._avgFieldLength[m];for(let y of v.keys()){if(!this._documentIds.has(y)){this.removeTerm(m,y,i),I-=1;continue}let O=c?c(this._documentIds.get(y),i,this._storedFields.get(y)):1;if(!O)continue;let k=v.get(y),U=this._fieldLength.get(y)[m],Q=wr(k,I,this._documentCount,U,z,h),N=n*a*g*O*Q,V=d.get(y);if(V){V.score+=N,Sr(V.terms,t);let W=Te(V.match,i);W?W.push(f):V.match[i]=[f]}else d.set(y,{score:N,terms:[t],match:{[i]:[f]}})}}return d}addTerm(t,i,n){let a=this._index.fetch(n,vt),l=a.get(t);if(l==null)l=new Map,l.set(i,1),a.set(t,l);else{let u=l.get(i);l.set(i,(u||0)+1)}}removeTerm(t,i,n){if(!this._index.has(n)){this.warnDocumentChanged(i,t,n);return}let a=this._index.fetch(n,vt),l=a.get(t);l==null||l.get(i)==null?this.warnDocumentChanged(i,t,n):l.get(i)<=1?l.size<=1?a.delete(t):l.delete(i):l.set(i,l.get(i)-1),this._index.get(n).size===0&&this._index.delete(n)}warnDocumentChanged(t,i,n){for(let a of Object.keys(this._fieldIds))if(this._fieldIds[a]===i){this._options.logger("warn","MiniSearch: document with ID ".concat(this._documentIds.get(t),' has changed before removal: term "').concat(n,'" was not present in field "').concat(a,'". Removing a document after it has changed can corrupt the index!'),"version_conflict");return}}addDocumentId(t){let i=this._nextId;return this._idToShortId.set(t,i),this._documentIds.set(i,t),this._documentCount+=1,this._nextId+=1,i}addFields(t){for(let i=0;i<t.length;i++)this._fieldIds[t[i]]=i}addFieldLength(t,i,n,a){let l=this._fieldLength.get(t);l==null&&this._fieldLength.set(t,l=[]),l[i]=a;let u=(this._avgFieldLength[i]||0)*n+a;this._avgFieldLength[i]=u/(n+1)}removeFieldLength(t,i,n,a){if(n===1){this._avgFieldLength[i]=0;return}let l=this._avgFieldLength[i]*n-a;this._avgFieldLength[i]=l/(n-1)}saveStoredFields(t,i){let{storeFields:n,extractField:a}=this._options;if(n==null||n.length===0)return;let l=this._storedFields.get(t);l==null&&this._storedFields.set(t,l={});for(let u of n){let c=a(i,u);c!==void 0&&(l[u]=c)}}};ce.wildcard=Symbol("*");var Te=(s,t)=>Object.prototype.hasOwnProperty.call(s,t)?s[t]:void 0,vr={[Pe]:(s,t)=>{for(let i of t.keys()){let n=s.get(i);if(n==null)s.set(i,t.get(i));else{let{score:a,terms:l,match:u}=t.get(i);n.score=n.score+a,n.match=Object.assign(n.match,u),gt(n.terms,l)}}return s},[Ft]:(s,t)=>{let i=new Map;for(let n of t.keys()){let a=s.get(n);if(a==null)continue;let{score:l,terms:u,match:c}=t.get(n);gt(a.terms,u),i.set(n,{score:a.score+l,terms:a.terms,match:Object.assign(a.match,c)})}return i},[yr]:(s,t)=>{for(let i of t.keys())s.delete(i);return s}},br={k:1.2,b:.7,d:.5},wr=(s,t,i,n,a,l)=>{let{k:u,b:c,d:h}=l;return Math.log(1+(i-t+.5)/(t+.5))*(h+s*(u+1)/(s+u*(1-c+c*n/a)))},zr=s=>(t,i,n)=>{let a=typeof s.fuzzy=="function"?s.fuzzy(t,i,n):s.fuzzy||!1,l=typeof s.prefix=="function"?s.prefix(t,i,n):s.prefix===!0,u=typeof s.boostTerm=="function"?s.boostTerm(t,i,n):1;return{term:t,fuzzy:a,prefix:l,termBoost:u}},Le={idField:"id",extractField:(s,t)=>s[t],stringifyField:(s,t)=>s.toString(),tokenize:s=>s.split(jr),processTerm:s=>s.toLowerCase(),fields:void 0,searchOptions:void 0,storeFields:[],logger:(s,t)=>{typeof console?.[s]=="function"&&console[s](t)},autoVacuum:!0},_t={combineWith:Pe,prefix:!1,fuzzy:!1,maxFuzzy:6,boost:{},weights:{fuzzy:.45,prefix:.375},bm25:br},xr={combineWith:Ft,prefix:(s,t,i)=>t===i.length-1},Be={batchSize:1e3,batchWait:10},We={minDirtFactor:.1,minDirtCount:20},Ve=F(F({},Be),We),Sr=(s,t)=>{s.includes(t)||s.push(t)},gt=(s,t)=>{for(let i of t)s.includes(i)||s.push(i)},yt=({score:s},{score:t})=>t-s,vt=()=>new Map,le=s=>{let t=new Map;for(let i of Object.keys(s))t.set(parseInt(i,10),s[i]);return t},ue=async s=>{let t=new Map,i=0;for(let n of Object.keys(s))t.set(parseInt(n,10),s[n]),++i%1e3===0&&await It(0);return t},It=s=>new Promise(t=>setTimeout(t,s)),jr=new RegExp("[\\n\\r\\p{Z}\\p{P}]+","u"),Fr=or(pr(),1),de,Re,At,Dr=class{constructor(s){mt(this,Re),Ie(this,"mapData"),Ie(this,"indexes"),Ie(this,"ready"),mt(this,de),this.mapData=s,this.indexes=Or(s),this.ready=this.populate(),rr(this,de,nr(sr(this,Re,At).bind(this),2e3))}async populate(){let{places:s,enterpriseLocations:t,enterpriseCategories:i}=this.indexes,n=this.mapData,a=[];return s.removeAll(),a=a.concat([s.addAllAsync(n.getByType("space")),s.addAllAsync(n.getByType("point-of-interest")),s.addAllAsync(n.getByType("object")),s.addAllAsync(n.getByType("connection")),s.addAllAsync(n.getByType("floor")),s.addAllAsync(n.getByType("door")),s.addAllAsync(n.getByType("annotation")),s.addAllAsync(n.getByType("area"))]),t&&(t?.removeAll(),a.push(t.addAllAsync(n.getByType("enterprise-location")))),i&&(i?.removeAll(),a.push(i.addAllAsync(n.getByType("enterprise-category")))),Promise.all(a)}async search(s,t={}){var i,n;await this.ready,kr.parse(t);let a=(0,Fr.default)({},t,Ar),l=this.indexes.places.search(s,{fields:Object.keys(a.places.fields).filter(d=>a.places.fields[d])});a.places.limit&&(l=l.slice(0,a.places.limit));let u=(i=this.indexes.enterpriseLocations)==null?void 0:i.search(s,{fields:Object.keys(a.enterpriseLocations.fields).filter(d=>a.enterpriseLocations.fields[d])});u&&a.enterpriseLocations.limit&&(u=u.slice(0,a.enterpriseLocations.limit));let c=(n=this.indexes.enterpriseCategories)==null?void 0:n.search(s,{fields:Object.keys(a.enterpriseCategories.fields).filter(d=>a.enterpriseCategories.fields[d])});c&&a.enterpriseCategories.limit&&(c=c.slice(0,a.enterpriseCategories.limit));let h=Ir(this.mapData,{placesResult:l,locationsResult:u,categoriesResult:c});return ar(this,de).call(this,s),h}async suggest(s,t={}){await this.ready,Cr.parse(t);let i=[],{places:{enabled:n=!0}={},enterpriseLocations:{enabled:a=!0}={}}=t;return a&&this.indexes.enterpriseLocations&&this.indexes.enterpriseLocations.autoSuggest(s,{fields:["name","tags"],combineWith:"AND",prefix:!0,boost:{name:2,tags:1}}).forEach(l=>i.push(l)),n&&this.indexes.places.autoSuggest(s,{fields:["name"],combineWith:"AND",prefix:!0}).forEach(l=>i.push(l)),i.sort((l,u)=>u.score-l.score),this.mapData.Analytics.capture("$query-suggest",{query:s,suggestions:i.map(l=>l.suggestion)}),i}};de=new WeakMap,Re=new WeakSet,At=function(s){this.mapData.Analytics.capture("$query-search",{query:s})};function Ir(s,{placesResult:t,locationsResult:i,categoriesResult:n}){let a=t.reduce((c,{id:h,match:d,score:f,__type:g})=>{let m=s.getById(g,h);return m!=null&&!ur.is(m)&&!cr.is(m)&&!hr.is(m)&&!dr.is(m)&&!fr.is(m)&&c.push({type:m.__type,match:d,score:f,item:m}),c},[]),l;if(i){l=[];for(let{id:c,match:h,score:d}of i){let f=s.getById("enterprise-location",c);f&&l.push({type:f.__type,match:h,score:d,item:f})}}let u;if(n){u=[];for(let{id:c,match:h,score:d}of n){let f=s.getById("enterprise-category",c);f&&u.push({type:f.__type,match:h,score:d,item:f})}}return{places:a,enterpriseLocations:l,enterpriseCategories:u}}var Ar={places:{fields:{name:!0,description:!0}},enterpriseCategories:{fields:{name:!0,description:!1,"locations.name":!0}},enterpriseLocations:{fields:{name:!0,tags:!0,description:!0}}};function De(s){return s.normalize("NFD").replace(/[\u0300-\u036f|\u2019|\u0027|\']/g,"").toLowerCase()}function Or(s){let t=new ce({fields:["name","description"],storeFields:["id","__type"],searchOptions:{fuzzy:.2,prefix:!0,boost:{name:2},combineWith:"AND"},extractField:(u,c)=>{let h=u[c];return typeof h=="string"?De(h):u[c]},processTerm:u=>Mr.has(u)?"":u.toLowerCase()}),i=s.getByType("enterprise-location"),n;i&&(n=new ce({fields:["name","tags","description"],storeFields:["id","__type"],searchOptions:{combineWith:"OR",prefix:!0,fuzzy:.2,boost:{name:3,tags:2,description:1}},extractField:(u,c)=>Array.isArray(u[c])?u[c].join(" "):typeof u[c]=="string"?De(u[c]):u[c]}));let a=s.getByType("enterprise-category"),l;return a&&(l=new ce({fields:["name","description","locations.name"],storeFields:["id","__type"],extractField(u,c){return c==="locations.name"?u.locations.reduce((h,d)=>h+" ".concat(bt," ")+d.name,"")+" ".concat(bt):typeof u[c]=="string"?De(u[c]):u[c]},searchOptions:{combineWith:"OR",prefix:!0,fuzzy:.2,boost:{name:2,"locations.name":2}}})),{enterpriseCategories:l,enterpriseLocations:n,places:t}}var kr=L({places:L({fields:L({name:T().optional(),description:T().optional()}).optional(),limit:Ae().positive().optional()}).optional(),enterpriseCategories:L({fields:L({name:T().optional(),description:T().optional(),"locations.name":T().optional()}).optional(),limit:Ae().positive().optional()}).optional(),enterpriseLocations:L({fields:L({name:T().optional(),tags:T().optional(),description:T().optional()}).optional(),limit:Ae().positive().optional()}).optional()}),Cr=L({places:L({enabled:T().optional()}).optional(),enterpriseLocations:L({enabled:T().optional()}).optional()}),Mr=new Set(["the","an","and","or","of","in","on","at","to","from","with","by","for"]),bt="";export{Dr as InternalSearch,De as removeAccents};
